[{"tags": ["c++", "c", "alsa"], "comments": [{"owner": {"reputation": 1542, "user_id": 1284258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2777bcec2428f4ab02612af25abaa836?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/1284258/jason"}, "edited": false, "score": 3, "creation_date": 1463611910, "post_id": 37311263, "comment_id": 62143567, "body": "40 ms is an incredibly short time and you would at most hear a pop or click."}, {"owner": {"reputation": 708, "user_id": 1743985, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/20cqM.jpg?s=128&g=1", "display_name": "kburbach", "link": "https://stackoverflow.com/users/1743985/kburbach"}, "reply_to_user": {"reputation": 1542, "user_id": 1284258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2777bcec2428f4ab02612af25abaa836?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/1284258/jason"}, "edited": false, "score": 0, "creation_date": 1463614505, "post_id": 37311263, "comment_id": 62144244, "body": "I still don&#39;t hear anything with a 250ms duration, so 12,000 frames"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1463615237, "post_id": 37311263, "comment_id": 62144404, "body": "Try decreasing the FRAMES_LEN from 48,000 down to 2,000 or so in decrements of perhaps 2,000 and see when you stop hearing what is produced."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1463618935, "post_id": 37311263, "comment_id": 62145308, "body": "Can you attach an oscilloscope to the output instead of the speaker and measure the partial sound wave that comes out?"}, {"owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1463639239, "post_id": 37311263, "comment_id": 62150868, "body": "What is the period size? Are you ever calling <code>snd_pcm_drain()</code>?"}, {"owner": {"reputation": 1542, "user_id": 1284258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2777bcec2428f4ab02612af25abaa836?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/1284258/jason"}, "edited": false, "score": 0, "creation_date": 1463695519, "post_id": 37311263, "comment_id": 62187409, "body": "See this for a discussion of perceptible sounds as it relates to frequency and duration. <a href=\"http://sound.stackexchange.com/q/28163\">sound.stackexchange.com/q/28163</a>"}], "answers": [{"tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 0, "last_activity_date": 1463651696, "creation_date": 1463651696, "answer_id": 37319772, "question_id": 37311263, "link": "https://stackoverflow.com/questions/37311263/large-buffer-sizes-plays-small-size-doesnt/37319772#37319772", "title": "Large buffer sizes plays, small size doesn&#39;t", "body": "<p>This is reasonable if there is any kind of post-processing going on with a filter of length >= 1920 frames. Such filtering can drop any click sounds, for instance. The whole reason for using ALSA instead of just talking to a D/A converter is to have audio-specific processing.</p>\n"}, {"tags": [], "owner": {"reputation": 1542, "user_id": 1284258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2777bcec2428f4ab02612af25abaa836?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/1284258/jason"}, "is_accepted": false, "score": 0, "last_activity_date": 1463695586, "last_edit_date": 1492088341, "creation_date": 1463695586, "answer_id": 37334841, "question_id": 37311263, "link": "https://stackoverflow.com/questions/37311263/large-buffer-sizes-plays-small-size-doesnt/37334841#37334841", "title": "Large buffer sizes plays, small size doesn&#39;t", "body": "<p>Your logging is not lying to you. You asked it to write 1920 samples to the device and it did. Since your 48000 sample experiment played a sound that lasted for one second, your hardware must be running at 48 kHz. Assuming that, 1920 frames would last four hundredths of a second. Depending on the frequency of the sine in your sine buffer, you may not hear that. </p>\n\n<p>Here's a deeper discussion: <a href=\"https://sound.stackexchange.com/q/28163\">https://sound.stackexchange.com/q/28163</a></p>\n"}], "owner": {"reputation": 708, "user_id": 1743985, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/20cqM.jpg?s=128&g=1", "display_name": "kburbach", "link": "https://stackoverflow.com/users/1743985/kburbach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1463695586, "creation_date": 1463611502, "question_id": 37311263, "link": "https://stackoverflow.com/questions/37311263/large-buffer-sizes-plays-small-size-doesnt", "title": "Large buffer sizes plays, small size doesn&#39;t", "body": "<p>I'm having a problem getting sound output when I have a small buffer size (1920 frames). If I sample at <code>48kHz</code> and make the buffer size <code>480000</code> the sine wave plays correctly for 1 second. What I want to do it only play the sine wave for <code>40ms</code>. </p>\n\n<p>I've calculate that to be <code>48000 samples/sec * 1sec/1000ms * 40ms = 1920 frames</code>. However, when I try to call <code>snd_pcm_writei</code> with only 1920 frames nothing comes out!</p>\n\n<p>Here's the code in question:</p>\n\n<pre><code>void PCM::playSound(float freqHz, uint16_t durationMs)\n{ \n    int FRAMES_LEN=48000;\n\n    //Send the sine_buffer to sound card, with correct buffer length\n    snd_pcm_sframes_t frames = snd_pcm_writei(handle, sine_buffer, FRAMES_LEN);\n\n    if (frames &lt; 0){\n        HW_INFO() &lt;&lt; \"PCM::playSound-- snd_pcm_writei failed,trying to recover:\" \n                  &lt;&lt; snd_strerror(frames);\n        frames = snd_pcm_recover(handle, frames, 0);\n    }\n    if (frames &lt; 0) {\n        HW_INFO() &lt;&lt; \"PCM::playSound-- snd_pcm_writei recovery failed: \" \n                  &lt;&lt; snd_strerror(frames);\n    }\n    HW_INFO() &lt;&lt; \"Wrote \" &lt;&lt; frames &lt;&lt; \" frames\";\n\n    return;\n}\n</code></pre>\n\n<p>If <code>FRAMES_LEN</code> is <code>48000</code>, this code works fine and produces a sine wave that last 1 second.</p>\n\n<p>If <code>FRAMES_LEN</code> is <code>1920</code>, I cannot hear a sine wave at all, but the log states that <code>Wrote 1920 frames</code>.</p>\n\n<p>What is happening?</p>\n"}, {"tags": ["c", "overflow", "long-integer"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1463608647, "post_id": 37310759, "comment_id": 62142514, "body": "Why is result overflowing?"}, {"owner": {"reputation": 1537, "user_id": 4829166, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dc46c31282003b3201d0d5b3be78d553?s=128&d=identicon&r=PG&f=1", "display_name": "Nimitz14", "link": "https://stackoverflow.com/users/4829166/nimitz14"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1463608708, "post_id": 37310759, "comment_id": 62142542, "body": "Because using python: <code>math.factorial(13)-2**32 == 1932053504</code>"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1463608796, "post_id": 37310759, "comment_id": 62142585, "body": "Read my answer please."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1463609119, "post_id": 37310759, "comment_id": 62142704, "body": "Enable compiler warnings (-Wall on gcc) and do something to fix them."}], "answers": [{"comments": [{"owner": {"reputation": 1537, "user_id": 4829166, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dc46c31282003b3201d0d5b3be78d553?s=128&d=identicon&r=PG&f=1", "display_name": "Nimitz14", "link": "https://stackoverflow.com/users/4829166/nimitz14"}, "edited": false, "score": 0, "creation_date": 1463608879, "post_id": 37310777, "comment_id": 62142618, "body": "Ah, okay thanks. But could you explain why you are using two different specifiers in your solution?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 1537, "user_id": 4829166, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dc46c31282003b3201d0d5b3be78d553?s=128&d=identicon&r=PG&f=1", "display_name": "Nimitz14", "link": "https://stackoverflow.com/users/4829166/nimitz14"}, "edited": false, "score": 0, "creation_date": 1463608943, "post_id": 37310777, "comment_id": 62142638, "body": "Because <code>sizeof</code> would give a <code>size_t</code> which requires the <code>&quot;%zu&quot;</code> specifier. It&#39;s not a <code>long long int</code>. You have to be very strict with the specifiers and the passed types because there is no other way to guarantee type safety."}, {"owner": {"reputation": 1537, "user_id": 4829166, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dc46c31282003b3201d0d5b3be78d553?s=128&d=identicon&r=PG&f=1", "display_name": "Nimitz14", "link": "https://stackoverflow.com/users/4829166/nimitz14"}, "edited": false, "score": 0, "creation_date": 1463608980, "post_id": 37310777, "comment_id": 62142654, "body": "Makes sense. Thanks !"}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 6, "last_activity_date": 1463608968, "last_edit_date": 1463608968, "creation_date": 1463608683, "answer_id": 37310777, "question_id": 37310759, "link": "https://stackoverflow.com/questions/37310759/sizeoflong-long-gives-8-but-number-overflows-at-232/37310777#37310777", "title": "sizeof(long long) gives 8 but number overflows at 2**32", "body": "<p>You have to use the correct specifier. The <code>\"%d\"</code> specifier expects an <code>int</code> and you passed a <code>long long int</code>. According to the <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> standard this will invoke undefined behavior. The observed behavior might be explicable but that doesn't mean it isn't rigorously <em>undefined behavior</em>.</p>\n\n<p>Fix the code like this</p>\n\n<pre><code>printf(\"%lld\\n\", prod);\nprintf(\"%zu\\n\", sizeof(long long)); \n</code></pre>\n\n<p>and it should work as intended.</p>\n\n<p>NOTE: enable compilation warnings and you should find out this kind of mistake very quickly.</p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1463610198, "creation_date": 1463610198, "answer_id": 37311065, "question_id": 37310759, "link": "https://stackoverflow.com/questions/37310759/sizeoflong-long-gives-8-but-number-overflows-at-232/37311065#37311065", "title": "sizeof(long long) gives 8 but number overflows at 2**32", "body": "<blockquote>\n  <p>Result is clearly overflowing.</p>\n</blockquote>\n\n<p>That's a wrong conclusion. You are getting a truncated result.</p>\n\n<p>When I run:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n   long long n, prod, i;\n   n = 13;\n   prod = 1;\n\n   for (i = 1 ; i &lt;= n ; i++) {\n      prod *= i;\n   }\n   int truncated_value = prod;\n\n   printf(\"%d\\n\", prod);\n   printf(\"%d\\n\", truncated_value);\n}\n</code></pre>\n\n<p>I get</p>\n\n<pre><code>1932053504\n1932053504\n</code></pre>\n\n<p>The truncation happens due to the use of the <code>%d</code> format specifier.</p>\n\n<p>You can fix that by using the correct format specifier.</p>\n\n<pre><code>   printf(\"%lld\\n\", prod);\n</code></pre>\n"}], "owner": {"reputation": 1537, "user_id": 4829166, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dc46c31282003b3201d0d5b3be78d553?s=128&d=identicon&r=PG&f=1", "display_name": "Nimitz14", "link": "https://stackoverflow.com/users/4829166/nimitz14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "accepted_answer_id": 37310777, "answer_count": 2, "score": -1, "last_activity_date": 1463610198, "creation_date": 1463608590, "last_edit_date": 1463608627, "question_id": 37310759, "link": "https://stackoverflow.com/questions/37310759/sizeoflong-long-gives-8-but-number-overflows-at-232", "title": "sizeof(long long) gives 8 but number overflows at 2**32", "body": "<pre><code>long long n, prod, i;\nn = 13;\nprod = 1;\n\nfor (i = 1 ; i &lt;= n ; i++) {\n    prod *= i;\n}\nprintf(\"%d\\n\", prod);\nprintf(\"%d\\n\", sizeof(long long));\n</code></pre>\n\n<p>returns </p>\n\n<pre><code>$ 1932053504\n$ 8\n</code></pre>\n\n<p>Result is clearly overflowing. But I don't get why this is happening with <code>long long</code>. <code>sizeof(int)</code> returns 4 [bytes] but the product is the same. What am I doing wrong?</p>\n"}, {"tags": ["c", "arrays", "string", "pointers", "character"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463608099, "post_id": 37310631, "comment_id": 62142297, "body": "What&#39;s not clear? Why a string format specifier works with a string? Because it is defined to work..."}, {"owner": {"reputation": 56, "user_id": 6353278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c00423fb36db1787fa6f743a0b0c5c9?s=128&d=identicon&r=PG&f=1", "display_name": "op.dare7", "link": "https://stackoverflow.com/users/6353278/op-dare7"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463608184, "post_id": 37310631, "comment_id": 62142331, "body": "I am not able to understand the first print. I think if the first print works the last print in the comment should also work but thats not true so thats my question, thanks."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1463608185, "post_id": 37310631, "comment_id": 62142332, "body": "Why shouldn&#39;t <code>printf(&quot;%d&quot;, b);</code> give error?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1463608217, "post_id": 37310631, "comment_id": 62142349, "body": "@user6353278 What exactly you don&#39;t understand? How come <code>str</code> being an array <code>hello</code> is printed?"}, {"owner": {"reputation": 56, "user_id": 6353278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c00423fb36db1787fa6f743a0b0c5c9?s=128&d=identicon&r=PG&f=1", "display_name": "op.dare7", "link": "https://stackoverflow.com/users/6353278/op-dare7"}, "edited": false, "score": 0, "creation_date": 1463608277, "post_id": 37310631, "comment_id": 62142372, "body": "yes why is that error happening and whydoes the first print work."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463608311, "post_id": 37310631, "comment_id": 62142387, "body": "Why do you think it <i>shouldn&#39;t</i> work?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463608337, "post_id": 37310631, "comment_id": 62142397, "body": "The error is due to the format specifier is not matching the actual parameter type."}, {"owner": {"reputation": 56, "user_id": 6353278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c00423fb36db1787fa6f743a0b0c5c9?s=128&d=identicon&r=PG&f=1", "display_name": "op.dare7", "link": "https://stackoverflow.com/users/6353278/op-dare7"}, "edited": false, "score": 0, "creation_date": 1463608473, "post_id": 37310631, "comment_id": 62142451, "body": "I understand str is a pointer to the array s, so it points to the first character which is h. Thats why *str prints h and *(str+1) prints e."}, {"owner": {"reputation": 56, "user_id": 6353278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c00423fb36db1787fa6f743a0b0c5c9?s=128&d=identicon&r=PG&f=1", "display_name": "op.dare7", "link": "https://stackoverflow.com/users/6353278/op-dare7"}, "edited": false, "score": 0, "creation_date": 1463608535, "post_id": 37310631, "comment_id": 62142473, "body": "Thanks eugene agreed but can you explain the first print ?"}, {"owner": {"reputation": 56, "user_id": 6353278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c00423fb36db1787fa6f743a0b0c5c9?s=128&d=identicon&r=PG&f=1", "display_name": "op.dare7", "link": "https://stackoverflow.com/users/6353278/op-dare7"}, "edited": false, "score": 0, "creation_date": 1463608635, "post_id": 37310631, "comment_id": 62142512, "body": "I searched resource I had I studied the pointer chapter on the deitel book I searched on other programming websites but i couldnt figure it out. So I asked it here."}, {"owner": {"reputation": 56, "user_id": 6353278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c00423fb36db1787fa6f743a0b0c5c9?s=128&d=identicon&r=PG&f=1", "display_name": "op.dare7", "link": "https://stackoverflow.com/users/6353278/op-dare7"}, "edited": false, "score": 0, "creation_date": 1463609045, "post_id": 37310631, "comment_id": 62142674, "body": "The thing that i can&#39;t understand is that str being a pointer should contain an address but when i print str with %s it prints hello."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 2, "creation_date": 1463651766, "post_id": 37310631, "comment_id": 62159140, "body": "<code>%s</code> means: retrieve a <code>char*</code> argument. Dereference the pointer and print the character, and subsequent characters until a <code>\\0</code> is encountered."}, {"owner": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "edited": false, "score": 0, "creation_date": 1463654332, "post_id": 37310631, "comment_id": 62160940, "body": "<a href=\"http://stackoverflow.com/questions/9053658/correct-format-specifier-to-print-pointer-address\" title=\"correct format specifier to print pointer address\">stackoverflow.com/questions/9053658/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1463623738, "post_id": 37311085, "comment_id": 62146451, "body": "<code>printf(&quot;%c\\n&quot;, *str);</code> prints the first character. <code>*str</code> is the simplified result of <code>*(str + 0));</code> (where obviously <code>+ 0</code> does nothing). `"}], "tags": [], "owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "is_accepted": true, "score": 4, "last_activity_date": 1463610324, "creation_date": 1463610324, "answer_id": 37311085, "question_id": 37310631, "link": "https://stackoverflow.com/questions/37310631/explanation-regarding-character-pointer-for-string/37311085#37311085", "title": "Explanation regarding character pointer for string", "body": "<pre><code>char s[] = \"hello\";\n</code></pre>\n\n<p>Declares an array of zero-terminated characters called s. Its the same as writing</p>\n\n<pre><code>char s[6] = { 'h', 'e', 'l', 'l', 'o', '\\0' };\n</code></pre>\n\n<p>As you can see, the quotation marks are a shorthand.</p>\n\n<hr>\n\n<pre><code>char *str = s;\n</code></pre>\n\n<p>This declares <code>str</code> to be a pointer to a character. It then makes <code>str</code> point to the first character in <code>s</code>. In other words, <code>str</code> contains the address of the first character in <code>s</code>.</p>\n\n<hr>\n\n<pre><code>int a[] = {1, 2, 3, 4, 5};\n</code></pre>\n\n<p>Declares an array of integers. It initializes them to the values 1-5, inclusive.</p>\n\n<hr>\n\n<pre><code>int *b = a;\n</code></pre>\n\n<p>Declares <code>b</code> to be a pointer to an int. It then makes <code>b</code> point to the first int in <code>a</code>.</p>\n\n<hr>\n\n<pre><code>printf(\"%s\\n\", str);\n</code></pre>\n\n<p>The <code>%s</code> specifier accepts the address of the first character in the string. <code>printf</code> then walks from that address, printing the characters it sees, until it sees the <code>\\0</code> character at the end.</p>\n\n<hr>\n\n<pre><code>printf(\"%c\\n\", *str);\n</code></pre>\n\n<p>This prints the first character in <code>str</code>. Since <code>str</code> is pointing to a character (the first character in the string), then <code>*str</code> should obtain the character being pointed at (the first character in the string).</p>\n\n<hr>\n\n<pre><code>printf(\"%c\\n\", *(str + 1));\n</code></pre>\n\n<p>This prints the second character in <code>str</code>. This is the long way of writing <code>str[1]</code>. The logic behind this is pointer arithmetic. If <code>str</code> is the address of a character, then <code>str + 1</code> is the address of the next character in the array. Since <code>(str + 1)</code> is an address, it may be dereferenced. Thus, the <code>*</code> obtains the character 1 character past the first character of the array.</p>\n\n<hr>\n\n<pre><code>printf(\"%p\\n\",str);\n</code></pre>\n\n<p>The <code>%p</code> specifier expects a pointer, just like <code>%s</code> would, but it does something else. Instead of printing the contents of a string, it simply prints the address the pointer is containing, in hex.</p>\n\n<hr>\n\n<pre><code>printf(\"%d\\n\",*b);\n</code></pre>\n\n<p>This prints the first <code>int</code> in the array pointed to by <code>b</code>. This is equivalent to writing <code>b[0]</code>.</p>\n\n<hr>\n\n<pre><code>printf(\"%d\",b);\n</code></pre>\n\n<p><code>b</code> is an <code>int *</code>, not an <code>int</code>, which is what <code>%d</code> expects. If you were trying to print the address of the first element of the array, the specifier would be <code>%p</code>, not <code>%d</code>. Also, this line should not generate a compiler error. Instead, it should have been a runtime undefined behavior, since the compiler does not know what a <code>printf</code> format string is.</p>\n"}], "owner": {"reputation": 56, "user_id": 6353278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c00423fb36db1787fa6f743a0b0c5c9?s=128&d=identicon&r=PG&f=1", "display_name": "op.dare7", "link": "https://stackoverflow.com/users/6353278/op-dare7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 1, "accepted_answer_id": 37311085, "answer_count": 1, "score": 1, "last_activity_date": 1463660902, "creation_date": 1463608017, "last_edit_date": 1463659156, "question_id": 37310631, "link": "https://stackoverflow.com/questions/37310631/explanation-regarding-character-pointer-for-string", "title": "Explanation regarding character pointer for string", "body": "<p>Hi I'm new to programming.\nIn the following code <code>str</code> is a pointer to a character, so <code>str</code> should contain the address of the character 'h'. Therefore %p should be used to print that address.  But I don't understand how %s is used for printing a pointer parameter.</p>\n\n<pre><code>    #include&lt;stdio.h&gt;\n\n    int main (){\n    char s[] = \"hello\";\n    char *str = s;\n    int a[] = {1, 2, 3, 4, 5};\n    int *b = a;\n    printf(\"%s\\n\", str);        // I don't understand how this works ? \n    printf(\"%c\\n\", *str);       // This statement makes sense\n    printf(\"%c\\n\", *(str + 1)); // This statement also makes sense.\n    printf(\"%p\\n\",str);         // This prints the address of the pointer str. This too makes sense.\n    printf(\"%d\\n\",*b);          // makes sense, is the same as the second print.\n    //      printf(\"%d\",b);     // I don't understand why str pointer works but this gives a compile error\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "matrix", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1463607339, "post_id": 37310401, "comment_id": 62142011, "body": "reverse the order of the k and c loop"}, {"owner": {"reputation": 540, "user_id": 4980088, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/10205926413416055/picture?type=large", "display_name": "Juan Fernandez Sosa", "link": "https://stackoverflow.com/users/4980088/juan-fernandez-sosa"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1463607564, "post_id": 37310401, "comment_id": 62142094, "body": "Hi @user3528438 what do you mean?"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1463607716, "post_id": 37310401, "comment_id": 62142156, "body": "re-arrange <code>for(c=0;c&lt;N;c++)</code> to be the inner-most loop"}, {"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 0, "creation_date": 1463621939, "post_id": 37310401, "comment_id": 62146040, "body": "Optimizing compilers may skip more redundant loops in the absence of openmp."}, {"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 0, "creation_date": 1463622050, "post_id": 37310401, "comment_id": 62146065, "body": "If you&#39;re trying to maximize performance quickly you would use one of the available libraries such as mkl"}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 4, "creation_date": 1463638651, "post_id": 37310401, "comment_id": 62150607, "body": "I think <code>val</code> should be private."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1463656514, "post_id": 37310401, "comment_id": 62162481, "body": "I&#39;m afraid your code is a mess and much needed information is missing in this question. Please 1) Provide information about the expected and actual performance 2) Provide information about the hardware and configuration, 3) Provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and format it properly, with relevant comments in english language and remove redundant comments."}], "answers": [{"tags": [], "owner": {"reputation": 540, "user_id": 4980088, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/10205926413416055/picture?type=large", "display_name": "Juan Fernandez Sosa", "link": "https://stackoverflow.com/users/4980088/juan-fernandez-sosa"}, "is_accepted": false, "score": 1, "last_activity_date": 1463661657, "creation_date": 1463661657, "answer_id": 37323526, "question_id": 37310401, "link": "https://stackoverflow.com/questions/37310401/openmp-poor-performance/37323526#37323526", "title": "OpenMP poor performance", "body": "<p>I found a solution!, first, I didn't pay attention to the way I stored the data into the matrixes, and I had a lot of cache fails. So the RES Matrix stored by rows and the others by column.</p>\n\n<p>Also, i put private the \"val\" variable. and the performance was improved. </p>\n"}], "owner": {"reputation": 540, "user_id": 4980088, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/10205926413416055/picture?type=large", "display_name": "Juan Fernandez Sosa", "link": "https://stackoverflow.com/users/4980088/juan-fernandez-sosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1463661657, "creation_date": 1463606936, "last_edit_date": 1463607481, "question_id": 37310401, "link": "https://stackoverflow.com/questions/37310401/openmp-poor-performance", "title": "OpenMP poor performance", "body": "<p>I have this issue, I wrote an OpenMP program which has to calculate the products of <code>m</code> matrices. I want to give to each thread <code>N</code> rows to process.</p>\n\n<p>This is my code:</p>\n\n<pre><code>double val;\n    omp_set_num_threads(4);\n    for(i=0;i&lt;m;i++){\n        #pragma omp parallel for private(f,c,k)\n        for(f=0;f&lt;N;f++){ //cada thread trabaja con sus 2 filas asignadas\n            //printf(\"Thread %d, fila %d matriz %d \\n\",omp_get_thread_num(),f,i);\n            for(c=0;c&lt;N;c++){ //cada fila trabaja con todas las columnas de la matriz principal\n                val=0;\n                for(k=0;k&lt;N;k++){\n                    /*if(k==0){\n                        AUX[f*N+c]=RES[f*N+k]*A[i][k*N+c];\n                    }*/\n                    //else{\n                        AUX[f*N+c]=val+RES[f*N+k]*A[i][k*N+c];\n                    val=AUX[f*N+c];\n\n                    //}\n                }\n            }\n           for(c=0;c&lt;N;c++){\n                RES[f*N+c]=AUX[f*N+c];\n            }\n        }\n    } \n</code></pre>\n\n<p>The result is OK, but in performance a sequential algorithm is better...</p>\n\n<p>I also made  a Pthread solution and it works fine so I think I have some mistake when I parallelized the solution...</p>\n"}, {"tags": ["c", "date", "comparison", "time.h"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1463605762, "post_id": 37310050, "comment_id": 62141296, "body": "You can choose any format you wish for how the user enters dates as long as you can convert those inputs to the time representation the <code>time.h</code> functions you plan to use understand. The user shouldn&#39;t enter <code>time_t</code> values anyway since they are non-intuitive to the user as date representations. By the way, you can just read the <code>time.h</code> header to know what the base type of <code>time_t</code> is to determine what <code>scanf</code> format to use if you still think you want to go that route."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1463605984, "post_id": 37310050, "comment_id": 62141383, "body": "looks like most of the values are <code>int</code>s, <code>scanf(%d)</code> for those: <a href=\"http://pubs.opengroup.org/onlinepubs/007908775/xsh/time.h.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/007908775/xsh/time.h.html</a>. <code>time_t</code> is not a specified type, so you&#39;ll have to find what that is for your system: <a href=\"http://stackoverflow.com/questions/471248/what-is-ultimately-a-time-t-typedef-to\" title=\"what is ultimately a time t typedef to\">stackoverflow.com/questions/471248/&hellip;</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463616223, "post_id": 37310050, "comment_id": 62144665, "body": "With a little care, you can use <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/mktime.html\" rel=\"nofollow noreferrer\"><code>mktime()</code></a> and perhaps <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strftime.html\" rel=\"nofollow noreferrer\"><code>strftime()</code></a> \u2014 and maybe <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strptime.html\" rel=\"nofollow noreferrer\"><code>strptime()</code></a> if you have a POSIX-ish system, but <code>strptime()</code> is a little tricky to use (but then most things related to dates are a little tricky)."}], "answers": [{"tags": [], "owner": {"reputation": 1139, "user_id": 6266602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0fa60ab2c1ac1b185db45679cabe8c9?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas B Preusser", "link": "https://stackoverflow.com/users/6266602/thomas-b-preusser"}, "is_accepted": false, "score": 0, "last_activity_date": 1463605920, "creation_date": 1463605920, "answer_id": 37310171, "question_id": 37310050, "link": "https://stackoverflow.com/questions/37310050/date-comparison-in-c/37310171#37310171", "title": "Date comparison in C", "body": "<p>The type <code>time_t</code> is just a counter of seconds. You want to convert it into a <code>struct tm*</code> calling <code>localtime(time_t*)</code>. <code>char *ctime(time_t*)</code> will give you a string representation. For formatted input and output you must work with the individual members of <code>struct tm</code> yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 3259, "user_id": 1639359, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oJzTJ.jpg?s=128&g=1", "display_name": "Daniel Goldfarb", "link": "https://stackoverflow.com/users/1639359/daniel-goldfarb"}, "is_accepted": true, "score": 0, "last_activity_date": 1463963006, "last_edit_date": 1463963006, "creation_date": 1463624472, "answer_id": 37312915, "question_id": 37310050, "link": "https://stackoverflow.com/questions/37310050/date-comparison-in-c/37312915#37312915", "title": "Date comparison in C", "body": "<p>I am assuming you only want number of days between two dates (not time).  As mentioned in one of the comments, choose any format you want for the user input, and then parse it.  </p>\n\n<p>One of the simplest formats to ask for as input for a date, is as an integer in the form of yyyymmdd.  </p>\n\n<p>So for example if I wanted to find the number of days from my birthday this year (May 27, 2016) to Independence Day (July 4), I would enter into the program 20160527 and 20160704.  </p>\n\n<p>As integers these are relatively easy to convert into month, day and year.</p>\n\n<p>Declare a struct tm and set the month day and year for each of these:</p>\n\n<pre><code>// Lets say the above dates were read into integers indate1 and indate2,\n// so indate1 = 20160527 and indate2 = 20160704\n\n#include &lt;time.h&gt;\n\nstruct tm dt = {0};\ndt.tm_year = (indate1/10000) - 1900;\ndt.tm_mon  = (indate1/100)%100;\ndt.tm_mday = (indate1%100);\n\n// Now convert to time_t:\ntime_t dt1 = mktime(&amp;dt);\n\n// Now do the same for indate2:\ndt.tm_year = (indate2/10000) - 1900;\ndt.tm_mon  = (indate2/100)%100;\ndt.tm_mday = (indate2%100);\ntime_t dt2 = mktime(&amp;dt);\n\n// Now take the difference between the two dates:\ndouble seconds = difftime( dt2, dt1 );\n\n// Now convert to number of days:\nunsigned long days = ( seconds / (60*60*24) );\nfprintf( stdout, \"The number of days between those two dates is %ld\\n\", days);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1463973558, "creation_date": 1463973558, "answer_id": 37382152, "question_id": 37310050, "link": "https://stackoverflow.com/questions/37310050/date-comparison-in-c/37382152#37382152", "title": "Date comparison in C", "body": "<p>In addition to manually packing the <code>struct tm</code> based on an integer input, you can work directly with <code>string</code> input using <code>strptime</code>. <code>strptime</code> will convert the character string provided as its first parameter to <code>struct tm</code> according to the provided <code>format</code> string.</p>\n\n<p>You may find this more convenient depending on the type of input you are dealing with. A short example would be:</p>\n\n<pre><code>#define _XOPEN_SOURCE\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main (int argc, char **argv) {\n\n    char *dtstr1 = argc &gt; 1 ? argv[1] : \"20160527\";\n    char *dtstr2 = argc &gt; 2 ? argv[2] : \"20160704\";\n    struct tm dt = {0};\n    time_t dt1 = 0, dt2 = 0;\n\n    /* convert input strings to struct tm */\n    strptime (dtstr2, \"%Y%m%d\", &amp;dt);    \n    dt2 = mktime (&amp;dt);\n\n    strptime (dtstr1, \"%Y%m%d\", &amp;dt);    \n    dt1 = mktime (&amp;dt);\n\n    /* get difference in calendar time */\n    double seconds = difftime (dt2, dt1);\n\n    /* convert to number of days */\n    long days = (seconds/(60*60*24));\n\n    if (seconds &lt; 0) /* output difference with occurrence orientation */\n        printf (\"%s occurs %ld days after %s\\n\", dtstr1, -days, dtstr2);\n    else if (seconds &gt; 0)\n        printf (\"%s occurs %ld days before %s\\n\", dtstr1, days, dtstr2);\n    else\n        printf (\"%s and %s are contemporaneous\\n\", dtstr1, dtstr2);\n\n    return 0;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> while unlikely, you can check for overflow in your <code>days</code> conversion)</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/time_diff_days\n20160527 occurs 38 days before 20160704\n\n$ ./bin/time_diff_days 20160101 20150101\n20160101 occurs 365 days after 20150101\n\n$ ./bin/time_diff_days 20150101 20150101\n20150101 and 20150101 are contemporaneous\n</code></pre>\n\n<p>Let me know if you have any questions.</p>\n"}], "owner": {"reputation": 79, "user_id": 6298002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/992b2959f9b985fe7aa4f685b24061c9?s=128&d=identicon&r=PG&f=1", "display_name": "Deja123", "link": "https://stackoverflow.com/users/6298002/deja123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2616, "favorite_count": 0, "accepted_answer_id": 37312915, "answer_count": 3, "score": 0, "last_activity_date": 1463973558, "creation_date": 1463605331, "question_id": 37310050, "link": "https://stackoverflow.com/questions/37310050/date-comparison-in-c", "title": "Date comparison in C", "body": "<p>I have some kind of task to make a C program that compares two dates and returns how many days are in between.</p>\n\n<p>The thing is, identifier for variables should be one from time.h library, so I can't use strings or integers for those 2 dates.\nI know there is time_t identifier for variables in time.h but how do I go on to ask user input for variable with that type? I don't know % what should I put in printf or scanf for this type. Also, is there some way I could check if user input is valid?</p>\n\n<p>And to compare those two, I guess I should be using difftime() function that is also contained in time.h, but then again, I am not sure. I read somewhere it shows difference in seconds, not sure if that source is legit, but I don't really need that. I need days, since I am working with dates.</p>\n\n<p>There is not much material about this online, that is why I am asking for help. Thanks in advance!</p>\n"}, {"tags": ["c++", "c", "gcc"], "comments": [{"owner": {"reputation": 20747, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 0, "creation_date": 1463605205, "post_id": 37309971, "comment_id": 62141007, "body": "By locations, do you mean machines, or just file system paths to the source?"}, {"owner": {"reputation": 178, "user_id": 249266, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b2d900524d894648e01c6c21e9a097d6?s=128&d=identicon&r=PG", "display_name": "LordOphidian", "link": "https://stackoverflow.com/users/249266/lordophidian"}, "reply_to_user": {"reputation": 20747, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 0, "creation_date": 1463605312, "post_id": 37309971, "comment_id": 62141054, "body": "Just different file system paths. So for instance if I pull the source code out of our CM tool into directory A and build I get one checksum, but then if I pull another copy into directory B the checksum will be different, only in this one spot."}, {"owner": {"reputation": 14053, "user_id": 2189130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/trlri.png?s=128&g=1", "display_name": "kmdreko", "link": "https://stackoverflow.com/users/2189130/kmdreko"}, "edited": false, "score": 0, "creation_date": 1463605400, "post_id": 37309971, "comment_id": 62141102, "body": "Typically, you will have a build system that produces an &quot;official&quot; binary so you can just distribute and compare to that one. But, I too would like to know why the binaries are different"}, {"owner": {"reputation": 3256, "user_id": 6292850, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/86iZy.jpg?s=128&g=1", "display_name": "uh oh somebody needs a pupper", "link": "https://stackoverflow.com/users/6292850/uh-oh-somebody-needs-a-pupper"}, "edited": false, "score": 3, "creation_date": 1463606294, "post_id": 37309971, "comment_id": 62141532, "body": "@LordOphidian My magic ball tells me the differing section you left out of your question is <code>.note.gnu.build-id</code>. The whole point of <a href=\"https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Developer_Guide/compiling-build-id.html\" rel=\"nofollow noreferrer\">build-id</a> is to solve the exact problem you mention. If <code>eu-readelf -n</code> produces different build-id&#39;s for your binaries, then you have a problem."}, {"owner": {"reputation": 178, "user_id": 249266, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b2d900524d894648e01c6c21e9a097d6?s=128&d=identicon&r=PG", "display_name": "LordOphidian", "link": "https://stackoverflow.com/users/249266/lordophidian"}, "reply_to_user": {"reputation": 3256, "user_id": 6292850, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/86iZy.jpg?s=128&g=1", "display_name": "uh oh somebody needs a pupper", "link": "https://stackoverflow.com/users/6292850/uh-oh-somebody-needs-a-pupper"}, "edited": false, "score": 0, "creation_date": 1463607237, "post_id": 37309971, "comment_id": 62141965, "body": "@sleeptightpupper That seems to be it. Thanks! Now I just need to find a way to prevent it from being different so when my QA builds it they get the same checksum."}, {"owner": {"reputation": 3256, "user_id": 6292850, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/86iZy.jpg?s=128&g=1", "display_name": "uh oh somebody needs a pupper", "link": "https://stackoverflow.com/users/6292850/uh-oh-somebody-needs-a-pupper"}, "edited": false, "score": 0, "creation_date": 1463607429, "post_id": 37309971, "comment_id": 62142046, "body": "No way to tell without more information about your build process."}], "answers": [{"tags": [], "owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "is_accepted": true, "score": 4, "last_activity_date": 1463617996, "creation_date": 1463617996, "answer_id": 37312123, "question_id": 37309971, "link": "https://stackoverflow.com/questions/37309971/differences-in-binaries-produced-by-gcc-for-the-same-code-base-for-different-pat/37312123#37312123", "title": "Differences in binaries produced by gcc for the same code base for different paths", "body": "<p>As sleep tight pupper said, the differing section is the <code>build-id</code>.</p>\n\n<p>You could avoid having the <code>build-id</code> section generated by passing <code>-Wl,--build-id=none</code> on linking or you could strip it from the ELF with <code>strip --remove-section=.note.gnu.build-id</code>.</p>\n"}], "owner": {"reputation": 178, "user_id": 249266, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b2d900524d894648e01c6c21e9a097d6?s=128&d=identicon&r=PG", "display_name": "LordOphidian", "link": "https://stackoverflow.com/users/249266/lordophidian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 916, "favorite_count": 0, "accepted_answer_id": 37312123, "answer_count": 1, "score": 2, "last_activity_date": 1463617996, "creation_date": 1463605029, "question_id": 37309971, "link": "https://stackoverflow.com/questions/37309971/differences-in-binaries-produced-by-gcc-for-the-same-code-base-for-different-pat", "title": "Differences in binaries produced by gcc for the same code base for different paths", "body": "<p>I've got a code base (C and C++) that when compiled will produce binaries with different checksums, even after <code>strip</code> has been run on the binaries.</p>\n\n<p>Doing a diff of the binaries in hex produced the following lines as the only difference:</p>\n\n<p>Binary from Location 1:</p>\n\n<pre><code>00000170: 0300 0000 474e 5500 7645 15ec 09f5 2b56  ....GNU.vE....+V\n00000180: 0679 e9a4 d49d 29e0 7de8 fb5b 0300 0000  .y....).}..[....\n</code></pre>\n\n<p>Binary from Location 2:</p>\n\n<pre><code>00000170: 0300 0000 474e 5500 cf2a 4316 2262 679d  ....GNU..*C.\"bg.\n00000180: 5691 b91a 52a8 29d2 45e8 c204 0300 0000  V...R.).E.......\n</code></pre>\n\n<p>Seems to me like this must be a checksum or something like that. I would suspect a timestamp, except if I clean and then do a rebuild in the same directory, the binaries will have the same checksum.</p>\n\n<p>Does anyone know what this could be? I'd like to make sure my binaries have the same checksum even when build in different locations so they can be verified by my QA organization.</p>\n"}, {"tags": ["c", "string", "macros", "variable-assignment"], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1463604627, "creation_date": 1463604627, "answer_id": 37309879, "question_id": 37309828, "link": "https://stackoverflow.com/questions/37309828/error-when-trying-to-assign-array-of-strings-to-a-variable-using-define-invali/37309879#37309879", "title": "Error when trying to assign array of strings to a variable using #define (invalid initializer error)", "body": "<p>You need curly braces around your initializer.  Because what you're initializing is an array, the braces signify that you're setting multiple elements of the array:</p>\n\n<pre><code>#define CPU_GPREG_NAMES {                                          \\\n\"zero\", \"at\", \"v0\", \"v1\", \"a0\", \"a1\", \"a2\", \"a3\",                  \\\n\"t0\", \"t1\", \"t2\", \"t3\", \"t4\", \"t5\", \"t6\", \"t7\",                    \\\n\"s0\", \"s1\", \"s2\", \"s3\", \"s4\", \"s5\", \"s6\", \"s7\",                    \\\n\"t8\", \"t9\", \"k0\", \"k1\", \"gp\", \"sp\", \"fp\", \"ra\" }   \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 2, "last_activity_date": 1463604641, "creation_date": 1463604641, "answer_id": 37309884, "question_id": 37309828, "link": "https://stackoverflow.com/questions/37309828/error-when-trying-to-assign-array-of-strings-to-a-variable-using-define-invali/37309884#37309884", "title": "Error when trying to assign array of strings to a variable using #define (invalid initializer error)", "body": "<p>You forget to put curly braces:</p>\n\n<pre><code>#define CPU_GPREG_NAMES  {                              \\\n    \"zero\", \"at\", \"v0\", \"v1\", \"a0\", \"a1\", \"a2\", \"a3\",   \\\n    \"t0\", \"t1\", \"t2\", \"t3\", \"t4\", \"t5\", \"t6\", \"t7\",     \\\n    \"s0\", \"s1\", \"s2\", \"s3\", \"s4\", \"s5\", \"s6\", \"s7\",     \\\n    \"t8\", \"t9\", \"k0\", \"k1\", \"gp\", \"sp\", \"fp\", \"ra\"      \\\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>static const char *reg_names[] = {CPU_GPREG_NAMES};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1463605204, "post_id": 37309898, "comment_id": 62141005, "body": "You need to escape the newline on the first line, too."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1463605258, "post_id": 37309898, "comment_id": 62141030, "body": "@Barmar Thanks, fixed now."}], "tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": true, "score": 2, "last_activity_date": 1463605234, "last_edit_date": 1463605234, "creation_date": 1463604694, "answer_id": 37309898, "question_id": 37309828, "link": "https://stackoverflow.com/questions/37309828/error-when-trying-to-assign-array-of-strings-to-a-variable-using-define-invali/37309898#37309898", "title": "Error when trying to assign array of strings to a variable using #define (invalid initializer error)", "body": "<p>You need curly braces to define your array for the initializer. You can either do:</p>\n\n<pre><code>#define CPU_GPREG_NAMES { \\\n     \"zero\", ... \\\n     ... \\\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>static const char *reg_names[] = {CPU_GPREG_NAMES};     \n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 2407119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2502ee1f5404d7af2906aca03d96c82c?s=128&d=identicon&r=PG", "display_name": "Jos&#233; Eduardo Bueno", "link": "https://stackoverflow.com/users/2407119/jos%c3%a9-eduardo-bueno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 37309898, "answer_count": 3, "score": 0, "last_activity_date": 1463605234, "creation_date": 1463604380, "last_edit_date": 1463604861, "question_id": 37309828, "link": "https://stackoverflow.com/questions/37309828/error-when-trying-to-assign-array-of-strings-to-a-variable-using-define-invali", "title": "Error when trying to assign array of strings to a variable using #define (invalid initializer error)", "body": "<p>I'm trying to compile a C code that contains the following lines:</p>\n\n<pre><code>//...\n#ifdef CPU_GPREG_NAMES\nstatic const char *reg_names[] = CPU_GPREG_NAMES;\n#endif\n//...\n</code></pre>\n\n<p>where the macro <code>CPU_GPREG_NAMES</code> is defined as:</p>\n\n<pre><code>#define CPU_GPREG_NAMES                                            \\\n\"zero\", \"at\", \"v0\", \"v1\", \"a0\", \"a1\", \"a2\", \"a3\",                  \\\n\"t0\", \"t1\", \"t2\", \"t3\", \"t4\", \"t5\", \"t6\", \"t7\",                    \\\n\"s0\", \"s1\", \"s2\", \"s3\", \"s4\", \"s5\", \"s6\", \"s7\",                    \\\n\"t8\", \"t9\", \"k0\", \"k1\", \"gp\", \"sp\", \"fp\", \"ra\"                     \\\n</code></pre>\n\n<p>However there seems to be a problem with the assignment in the first code snippet above, since I'm getting the following error on that specific line:</p>\n\n<pre><code>error: invalid initializer\nerror: expected identifier or '(' before string constant\n</code></pre>\n\n<p><strong>What is the cause of this error?</strong></p>\n"}, {"tags": ["c", "file", "io", "fgets"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1463602612, "post_id": 37309256, "comment_id": 62139730, "body": "You MUST check the return value of <code>sscanf()</code>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1463602622, "post_id": 37309256, "comment_id": 62139733, "body": "<code>sscanf(a,&quot;%d %d&quot;,&amp;s[i].time.min,&amp;s[i++].time.sec);</code> --&gt; <code>sscanf(a,&quot;%d %d&quot;,&amp;s[i].time.min,&amp;s[i].time.sec);++i;</code> and <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">why-is-while-feof-file-always-wrong</a>"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1463602726, "post_id": 37309256, "comment_id": 62139791, "body": "You have 2 very common mistakes, the first one is not severe while having <code>i</code> and <code>i++</code> together is very bad. <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Read here for <code>while(!feof())</code></a> and <a href=\"http://stackoverflow.com/questions/949433/why-are-these-constructs-using-undefined-behavior\">Read this for the other problem</a>"}, {"owner": {"reputation": 610, "user_id": 5241640, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/236b4bea72e0e1f6cc5be18ab06f1b67?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/5241640/stefan"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463602922, "post_id": 37309256, "comment_id": 62139898, "body": "@BLUEPIXY Wow , this worked. Can you put it as an answer, so I can label it as correct? Also, can you try and explain a little bit as to why this happens only on <code>.min</code> in the first read?"}, {"owner": {"reputation": 610, "user_id": 5241640, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/236b4bea72e0e1f6cc5be18ab06f1b67?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/5241640/stefan"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1463603192, "post_id": 37309256, "comment_id": 62140023, "body": "@iharob Thanks on pointing that out, if you have any books you would recommend on good/bad practices like this with examples, exercises, please do suggest!"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1463603211, "post_id": 37309256, "comment_id": 62140033, "body": "Remove the <code>while (!feof())</code> too please."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1463606562, "post_id": 37309256, "comment_id": 62141659, "body": "@Stefan The order of evaluation of arguments of function  must be not to have decided."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1463616389, "post_id": 37309256, "comment_id": 62144701, "body": "Unless the maximum title is very long, you might want to ensure that the <code>fgets()</code> calls read a newline before continuing.  You should check that each <code>fgets()</code> works as well as <code>sscanf()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 610, "user_id": 5241640, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/236b4bea72e0e1f6cc5be18ab06f1b67?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/5241640/stefan"}, "edited": false, "score": 0, "creation_date": 1463668629, "post_id": 37309664, "comment_id": 62172074, "body": "Looks like the problem was (aside from bad practice for while(!feof(file))), that I was parsing with <code>sscanf</code> and incrementing i inside the function call. When I put the <code>i++</code> in the next line, it worked well."}], "tags": [], "owner": {"reputation": 3259, "user_id": 1639359, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oJzTJ.jpg?s=128&g=1", "display_name": "Daniel Goldfarb", "link": "https://stackoverflow.com/users/1639359/daniel-goldfarb"}, "is_accepted": false, "score": 0, "last_activity_date": 1463620848, "last_edit_date": 1463620848, "creation_date": 1463603834, "answer_id": 37309664, "question_id": 37309256, "link": "https://stackoverflow.com/questions/37309256/reading-multiple-lines-with-different-data-types-in-c/37309664#37309664", "title": "Reading multiple lines with different data types in C", "body": "<p>Instead of sscanf(), I would use strtok() and atoi().</p>\n\n<p>Just curious, why only 10 bytes for the two integers?  Are you sure they are always that small?</p>\n\n<p>By the way, I apologize for such a short answer.  I'm sure there is a way to get sscanf() to work for you, but in my experience sscanf() can be rather finicky so I'm not a big fan.  When parsing input with C, I have just found it a lot more efficient (in terms of how long it takes to write and debug the code) to just tokenize the input with strtok() and convert each piece individually with the various ato? functions (atoi, atof, atol, strtod, etc.; see stdlib.h).  It keeps things simpler, because each piece of input is handled individually, which makes debugging any problems (should they arise) much easier.  In the end I typically spend a lot less time getting such code to work reliably than I did when I used to try to use sscanf().</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463640133, "post_id": 37313038, "comment_id": 62151295, "body": "Should the code check that newlines were read by the first two (all three?) <code>fgets()</code> calls?  You remove the trailing characters if present, but you don&#39;t seem to ensure that they are present (and the synchronization will be all wrong if they aren&#39;t present).  Other than that, your code is pretty similar to what I&#39;d&#39;ve produced."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463664574, "post_id": 37313038, "comment_id": 62168631, "body": "Yes, you are 100% correct on that point. Additional validation can be done to insure that the last character in both <code>title</code> and <code>artist</code> are both <code>&#39;\\n&#39;</code> to insure all characters fit within <code>MAX_TITLE</code> and <code>MAX_ARTIST</code> and if not, handle that error. I&#39;ve got to run to a site inspection, will update when I return."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463711178, "post_id": 37313038, "comment_id": 62191448, "body": "@JonathanLeffler, today took quite a bit longer than expected... Regardless, I have tweaked the input routine to protect against a short-read while maintaining the sync of the 3-line read. Doing so significantly changed what was required as far as the validation checks go and I would welcome your thoughts on the result."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463715560, "post_id": 37313038, "comment_id": 62192411, "body": "Looks good to me \u2014 sorry, it wasn&#39;t meant to be quite so demanding.  And I&#39;ve already given the only up-vote I&#39;m allowed to give. There are a few other options that could be considered/mentioned.  One would be to use POSIX <code>getline()</code>, which always reads a full line unless it runs out of memory.  Another would be a specialized wrapper around <code>fgets()</code> that uses a local long input buffer (<code>char buffer[4096];</code> for example) for the call to <code>fgets()</code>, finds the newline (uses <code>getc()</code> to read to the newline if there wasn&#39;t one), then copies and truncates the data to fit the passed arrays."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463715662, "post_id": 37313038, "comment_id": 62192430, "body": "One minor benefit of these is that you&#39;d be able to use all the space for the title and artist; as it stands, the newline has to be read into the space for the title/artist and then removed, so you effectively lose (waste?) one character."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463716967, "post_id": 37313038, "comment_id": 62192757, "body": "Agreed as to all. It is a trade-off, as everything in life or coding is. With a <i>title, artist, time</i>  file, odds are the maximum line length is known before hand, maybe not, but in the event it is, the buffer can be sized accordingly to avoid the potential for a <i>short-read</i>. For any unknown lengths, I&#39;ve always advocated <code>getline</code>, but its strength in dynamic allocation, is ironically also its greatest weakness in not offering a way to limit the read. Either way, the flexibility of C allows you to weight the competing requirements and craft a number of ways to skin the same cat."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 2, "last_activity_date": 1463712341, "last_edit_date": 1495542706, "creation_date": 1463625422, "answer_id": 37313038, "question_id": 37309256, "link": "https://stackoverflow.com/questions/37309256/reading-multiple-lines-with-different-data-types-in-c/37313038#37313038", "title": "Reading multiple lines with different data types in C", "body": "<p><strong>Note</strong>, I take your post to be reading values from 3 different lines, e.g.:</p>\n\n<pre><code>%s\n%s\n%d %d\n</code></pre>\n\n<p>(primarily evidenced by your use of <code>fgets</code>, a <em>line-oriented</em> input function, which reads a line of input (up to and <em>including</em> the <code>'\\n'</code>) each time it is called.) If that is not the case, then the following does not apply (and can be greatly simplified)</p>\n\n<p>Since you are reading multiple values into a single element in an array of struct, you may find it better (and more robust), to read each value and validate each value using temporary values before you start copying information into your structure members themselves. This allows you to (1) validate the read of all values, and (2) validate the parse, or conversion, of all required values before storing members in your struct and incrementing your array index. </p>\n\n<p>Additionally, you will need to remove the tailing <code>'\\n'</code> from both <code>title</code> and <code>artist</code> to prevent having embedded newlines dangling off the end of your strings (which will cause havoc with searching for either a <code>title</code> or <code>artist</code>). For instance, putting it all together, you could do something like: </p>\n\n<pre><code>void rmlf (char *s);\n....\nchar title[MAX_TITLE] = \"\";\nchar artist[MAX_ARTIST = \"\";\nchar a[10] = \"\";\nint min, sec;\n...\nwhile (fgets (title, MAX_TITLE, file) &amp;&amp;     /* validate read of values */\n       fgets (artist, MAX_ARTIST, file) &amp;&amp;\n       fgets (a, 10, file)) {\n\n    if (sscanf (a, \"%d %d\", &amp;min, &amp;sec) != 2) {  /* validate conversion */\n        fprintf (stderr, \"error: failed to parse 'min' 'sec'.\\n\");\n        continue;  /* skip line - tailor to your needs */\n    }\n\n    rmlf (title);   /* remove trailing newline */\n    rmlf (artist);\n\n    s[i].time.min = min;    /* copy to struct members &amp; increment index */\n    s[i].time.sec = sec;\n    strncpy (s[i].title, title, MAX_TITLE);\n    strncpy (s[i++].artist, artist, MAX_ARTIST);\n}\n\n/** remove tailing newline from 's'. */\nvoid rmlf (char *s)\n{\n    if (!s || !*s) return;\n    for (; *s &amp;&amp; *s != '\\n'; s++) {}\n    *s = 0;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> this will also read all values until an <code>EOF</code> is encountered <em>without</em> using <code>feof</code> (see Related link: <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong?lq=1\"><strong>Why is \u201cwhile ( !feof (file) )\u201d always wrong?</strong></a>))</p>\n\n<hr>\n\n<p><strong>Protecting Against a Short-Read with</strong> <code>fgets</code></p>\n\n<p>Following on from Jonathan's comment, when using <code>fgets</code> you should really check to insure you have actually read the entire line, and not experienced a <em>short read</em> where the maximum character value you supply is not sufficient to read the entire line (e.g. a <em>short read</em> because characters in that line remain unread)</p>\n\n<p>If a <em>short read</em> occurs, that will completely destroy your ability to read any further lines from the file, unless you handle the failure correctly. This is because the next attempt to read will NOT start reading on the line you think it is reading and instead attempt to read the remaining characters of the line where the <em>short read</em> occurred.</p>\n\n<p>You can validate a read by <code>fgets</code> by validating the last character read into your buffer is in fact a <code>'\\n'</code> character. (if the line is longer than the max you specify, the last character before the <em>nul-terminating</em> character will be an ordinary character instead.) If a <em>short read</em> is encountered, you must then <em>read and discard</em> the remaining characters in the long line before continuing with your next read. (unless you are using a dynamically allocated buffer where you can simply <code>realloc</code> as required to read the remainder of the line, and your data structure) </p>\n\n<p>Your situation complicates the validation by requiring data from 3 lines from the input file for each struct element. You must always maintain your 3-line read in sync reading all 3 lines as a group during each iteration of your read loop (even if a short read occurs). That means you must validate that all 3 lines were read and that no short read occurred in order to handle any one <em>short read</em> without exiting your input loop. (you can validate each individually if you just want to terminate input on any one <em>short read</em>, but that leads to a very inflexible input routine.</p>\n\n<p>You can tweak the <code>rmlf</code> function above to a function that validates each read by <code>fgets</code> in addition to removing the trailing newline from the input. I have done that below in a function called, surprisingly, <code>shortread</code>. The tweaks to the original function and read loop could be coded something like this:</p>\n\n<pre><code>int shortread (char *s, FILE *fp);\n...\n    for (idx = 0; idx &lt; MAX_SONGS;) {\n\n        int t, a, b;\n        t = a = b = 0;\n\n        /* validate fgets read of complete line */\n        if (!fgets (title, MAX_TITLE, fp)) break;\n        t = shortread (title, fp);\n\n        if (!fgets (artist, MAX_ARTIST, fp)) break;\n        a = shortread (artist, fp);\n\n        if (!fgets (buf, MAX_MINSEC, fp)) break;\n        b = shortread (buf, fp);\n\n        if (t || a || b) continue;  /* if any shortread, skip */\n\n        if (sscanf (buf, \"%d %d\", &amp;min, &amp;sec) != 2) { /* validate conversion */\n            fprintf (stderr, \"error: failed to parse 'min' 'sec'.\\n\");\n            continue;  /* skip line - tailor to your needs */\n        }\n\n        s[idx].time.min = min;   /* copy to struct members &amp; increment index */\n        s[idx].time.sec = sec;\n        strncpy (s[idx].title, title, MAX_TITLE);\n        strncpy (s[idx].artist, artist, MAX_ARTIST);\n        idx++;\n    }\n...\n/** validate complete line read, remove tailing newline from 's'.\n *  returns 1 on shortread, 0 - valid read, -1 invalid/empty string.\n *  if shortread, read/discard remainder of long line.\n */\nint shortread (char *s, FILE *fp)\n{\n    if (!s || !*s) return -1;\n    for (; *s &amp;&amp; *s != '\\n'; s++) {}\n    if (*s != '\\n') {\n        int c;\n        while ((c = fgetc (fp)) != '\\n' &amp;&amp; c != EOF) {}\n        return 1;\n    }\n    *s = 0;\n    return 0;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> in the example above the result of the <code>shortread</code> check for each of the lines that make up and <em>title, artist, time</em> group.)</p>\n\n<p>To validate the approach I put together a short example that will help put it all in context. Look over the example and let me know if you have any further questions.</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n/* constant definitions */\nenum { MAX_MINSEC = 10, MAX_ARTIST = 32, MAX_TITLE = 48, MAX_SONGS = 64 };\n\ntypedef struct {\n    int min;\n    int sec;\n} stime;\n\ntypedef struct {\n    char title[MAX_TITLE];\n    char artist[MAX_ARTIST];\n    stime time;\n} songs;\n\nint shortread (char *s, FILE *fp);\n\nint main (int argc, char **argv) {\n\n    char title[MAX_TITLE] = \"\";\n    char artist[MAX_ARTIST] = \"\";\n    char buf[MAX_MINSEC] = \"\";\n    int  i, idx, min, sec;\n    songs s[MAX_SONGS] = {{ .title = \"\", .artist = \"\" }};\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        fprintf (stderr, \"error: file open failed '%s'.\\n\", argv[1]);\n        return 1;\n    }\n\n    for (idx = 0; idx &lt; MAX_SONGS;) {\n\n        int t, a, b;\n        t = a = b = 0;\n\n        /* validate fgets read of complete line */\n        if (!fgets (title, MAX_TITLE, fp)) break;\n        t = shortread (title, fp);\n\n        if (!fgets (artist, MAX_ARTIST, fp)) break;\n        a = shortread (artist, fp);\n\n        if (!fgets (buf, MAX_MINSEC, fp)) break;\n        b = shortread (buf, fp);\n\n        if (t || a || b) continue;  /* if any shortread, skip */\n\n        if (sscanf (buf, \"%d %d\", &amp;min, &amp;sec) != 2) { /* validate conversion */\n            fprintf (stderr, \"error: failed to parse 'min' 'sec'.\\n\");\n            continue;  /* skip line - tailor to your needs */\n        }\n\n        s[idx].time.min = min;   /* copy to struct members &amp; increment index */\n        s[idx].time.sec = sec;\n        strncpy (s[idx].title, title, MAX_TITLE);\n        strncpy (s[idx].artist, artist, MAX_ARTIST);\n        idx++;\n    }\n    if (fp != stdin) fclose (fp);   /* close file if not stdin */\n\n    for (i = 0; i &lt; idx; i++)\n        printf (\" %2d:%2d  %-32s  %s\\n\", s[i].time.min, s[i].time.sec, \n                s[i].artist, s[i].title);\n\n    return 0;\n}\n\n/** validate complete line read, remove tailing newline from 's'.\n *  returns 1 on shortread, 0 - valid read, -1 invalid/empty string.\n *  if shortread, read/discard remainder of long line.\n */\nint shortread (char *s, FILE *fp)\n{\n    if (!s || !*s) return -1;\n    for (; *s &amp;&amp; *s != '\\n'; s++) {}\n    if (*s != '\\n') {\n        int c;\n        while ((c = fgetc (fp)) != '\\n' &amp;&amp; c != EOF) {}\n        return 1;\n    }\n    *s = 0;\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Input</strong></p>\n\n<pre><code>$ cat ../dat/titleartist.txt\nFirst Title I Like\nFirst Artist I Like\n3 40\nSecond Title That Is Way Way Too Long To Fit In MAX_TITLE Characters\nSecond Artist is Fine\n12 43\nThird Title is Fine\nThird Artist is Way Way Too Long To Fit in MAX_ARTIST\n3 23\nFourth Title is Good\nFourth Artist is Good\n32274 558212 (too long for MAX_MINSEC)\nFifth Title is Good\nFifth Artist is Good\n4 27\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/titleartist &lt;../dat/titleartist.txt\n  3:40  First Artist I Like               First Title I Like\n  4:27  Fifth Artist is Good              Fifth Title is Good\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1463627429, "post_id": 37313290, "comment_id": 62147271, "body": "I see what you are saying, but I took the post as meaning he was reading from 3 different lines (that will make a difference for me as well)"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1463627785, "post_id": 37313290, "comment_id": 62147354, "body": "Probably. In that case, he needs to understand what %s really denotes, so he can avoid making that mistake in production code..."}, {"owner": {"reputation": 610, "user_id": 5241640, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/236b4bea72e0e1f6cc5be18ab06f1b67?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/5241640/stefan"}, "edited": false, "score": 0, "creation_date": 1463668496, "post_id": 37313290, "comment_id": 62171970, "body": "I was reading the first 2 lines entirely and as you can see I wasn&#39;t expecting <code>sscanf</code> to magically skip the lines, since I read the 2 integers in the <code>char a[]</code> and use sscanf to parse the chars inside. Thank you for reply!"}], "tags": [], "owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "is_accepted": false, "score": 0, "last_activity_date": 1463627251, "creation_date": 1463627251, "answer_id": 37313290, "question_id": 37309256, "link": "https://stackoverflow.com/questions/37309256/reading-multiple-lines-with-different-data-types-in-c/37313290#37313290", "title": "Reading multiple lines with different data types in C", "body": "<p>Use <code>\"%*s %*s %d %d\"</code> as your format string, instead...</p>\n\n<p>You seem to be expecting <code>sscanf</code> to automagically skip the two tokens leading up to the decimal digit fields. It doesn't do that unless you explicitly tell it to (hence the pair of <code>%*s</code>).</p>\n\n<p>You can't expect the people who designed C to have designed it the same way as you would. You NEED to check the return value, as iharob said.</p>\n\n<p>That's not all. You NEED to read (and understand reelatively well) the entire <code>scanf</code> manual (the one written by OpenGroup is okay). That way you know how to use the function (including all of the subtle nuances of format strings) and what to do with the return vale.</p>\n\n<p>As a programmer, <strong>you need to read</strong>. Remember that well.</p>\n"}], "owner": {"reputation": 610, "user_id": 5241640, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/236b4bea72e0e1f6cc5be18ab06f1b67?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/5241640/stefan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1249, "favorite_count": 0, "accepted_answer_id": 37313038, "answer_count": 3, "score": 0, "last_activity_date": 1463712341, "creation_date": 1463602394, "question_id": 37309256, "link": "https://stackoverflow.com/questions/37309256/reading-multiple-lines-with-different-data-types-in-c", "title": "Reading multiple lines with different data types in C", "body": "<p>I have a very strange problem, I'm trying to read a .txt file with C, and the data is structured like this:\n<code>\n%s\n%s\n%d %d\n</code>\nSince I have to read the strings <code>all the way to \\n</code> I'm reading it like this:</p>\n\n<pre><code>while(!feof(file)){\n        fgets(s[i].title,MAX_TITLE,file);\n        fgets(s[i].artist,MAX_ARTIST,file);\n        char a[10];\n        fgets(a,10,file);\n        sscanf(a,\"%d %d\",&amp;s[i].time.min,&amp;s[i++].time.sec);\n    }\n</code></pre>\n\n<p>However, the <code>very first</code> integer I read in <code>s.time.min</code> shows a random big number.</p>\n\n<p>I'm using the sscanf right now since a few people had a similar issue, but it doesn't help.</p>\n\n<p>Thanks!</p>\n\n<p>EDIT: The integers represent time, they will never exceed 5 characters combined, including the white space between.</p>\n"}, {"tags": ["c", "debugging", "visual-c++", "assembly", "reverse-engineering"], "comments": [{"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 9208, "user_id": 3298930, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000448921471/picture?type=large", "display_name": "Jose Manuel Abarca Rodr&#237;guez", "link": "https://stackoverflow.com/users/3298930/jose-manuel-abarca-rodr%c3%adguez"}, "edited": false, "score": 1, "creation_date": 1463602028, "post_id": 37309076, "comment_id": 62139434, "body": "@JoseManuelAbarcaRodr&#237;guez This is about C here, not sure the linked question helps..."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1463602124, "post_id": 37309076, "comment_id": 62139488, "body": "The compiler is being defensive. It allocated an extra 208 bytes for your string, so that when you overrun the buffer, it won&#39;t do any real damage. I have a feeling that there&#39;s a compiler option to turn that feature off."}, {"owner": {"reputation": 573, "user_id": 2796343, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/dzC4C.jpg?s=128&g=1", "display_name": "Dhayalan Pro", "link": "https://stackoverflow.com/users/2796343/dhayalan-pro"}, "reply_to_user": {"reputation": 9208, "user_id": 3298930, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000448921471/picture?type=large", "display_name": "Jose Manuel Abarca Rodr&#237;guez", "link": "https://stackoverflow.com/users/3298930/jose-manuel-abarca-rodr%c3%adguez"}, "edited": false, "score": 0, "creation_date": 1463602148, "post_id": 37309076, "comment_id": 62139498, "body": "@JoseManuelAbarcaRodr&#237;guez C doesn&#39;t have a native String data type actually , thats more related to C++"}, {"owner": {"reputation": 573, "user_id": 2796343, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/dzC4C.jpg?s=128&g=1", "display_name": "Dhayalan Pro", "link": "https://stackoverflow.com/users/2796343/dhayalan-pro"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1463602280, "post_id": 37309076, "comment_id": 62139564, "body": "@user3386109 Even i was thinking that , but another thought hit me - is that really it ?  How do they calculate the extra spaces ?  like for a char it allocates cc[204 bytes]   Any link to other  references or questions   Thanks for the info :D"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1463602514, "post_id": 37309076, "comment_id": 62139681, "body": "A quick search for <code>[c] stack guard</code> here on SO turned up <a href=\"https://stackoverflow.com/questions/33708568/overflowed-buffer-data-does-not-get-stored-contiguously/33708641#33708641\">this</a>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1463602645, "post_id": 37309076, "comment_id": 62139745, "body": "What if you don&#39;t define anything? Will this stack allocation still be there? Perhaps you are not looking at the right thing..."}, {"owner": {"reputation": 573, "user_id": 2796343, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/dzC4C.jpg?s=128&g=1", "display_name": "Dhayalan Pro", "link": "https://stackoverflow.com/users/2796343/dhayalan-pro"}, "edited": false, "score": 1, "creation_date": 1463602800, "post_id": 37309076, "comment_id": 62139839, "body": "Yes even if we don&#39;t  have char var =&#39;a&#39; ; instead we have just char var; sub esp,0cch ; for both declaration and without declaration"}, {"owner": {"reputation": 573, "user_id": 2796343, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/dzC4C.jpg?s=128&g=1", "display_name": "Dhayalan Pro", "link": "https://stackoverflow.com/users/2796343/dhayalan-pro"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1463602896, "post_id": 37309076, "comment_id": 62139882, "body": "@user3386109 Could you say whats the option to turn the buffer overflow option in vs 2015 ?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1463603208, "post_id": 37309076, "comment_id": 62140032, "body": "According to a comment in that thread, it&#39;s <code>&#47;GS</code>, but I can neither confirm nor deny that."}, {"owner": {"reputation": 573, "user_id": 2796343, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/dzC4C.jpg?s=128&g=1", "display_name": "Dhayalan Pro", "link": "https://stackoverflow.com/users/2796343/dhayalan-pro"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1463603357, "post_id": 37309076, "comment_id": 62140104, "body": "@user3386109 Cool man , Figured it out :D  Did some googling with your input changed some setting&#39;s now its only 12bytes are getting allocated :D"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1463640049, "post_id": 37309076, "comment_id": 62151253, "body": "Well that&#39;s interesting... Visual Studio by default assumes that every programmer using that tool it is incompetent?"}, {"owner": {"reputation": 573, "user_id": 2796343, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/dzC4C.jpg?s=128&g=1", "display_name": "Dhayalan Pro", "link": "https://stackoverflow.com/users/2796343/dhayalan-pro"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1463644953, "post_id": 37309076, "comment_id": 62154316, "body": "@lundin  Haha no , Buffer overflow was common back in the days when developers has no idea about security , so around 2003 they introduced this to help the developers with no idea on security to avoid these kind of bugs by default :D"}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1463642235, "post_id": 37309601, "comment_id": 62152603, "body": "Also note that if you&#39;d written <code>const char *greeting = &quot;a string literal&quot;;</code>, the string literal would be stored in a read-only section of your executable, and the function would only store a pointer to it on the stack.  Unless you need to modify a string, just use pointers to them, not arrays."}], "tags": [], "owner": {"reputation": 573, "user_id": 2796343, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/dzC4C.jpg?s=128&g=1", "display_name": "Dhayalan Pro", "link": "https://stackoverflow.com/users/2796343/dhayalan-pro"}, "is_accepted": true, "score": 2, "last_activity_date": 1463603603, "creation_date": 1463603603, "answer_id": 37309601, "question_id": 37309076, "link": "https://stackoverflow.com/questions/37309076/why-does-initializing-a-string-in-a-function-doesnt-work-like-int-while-debuggi/37309601#37309601", "title": "Why does initializing a string in a function doesn&#39;t work like int while debugging", "body": "<p>As  @user3386109 pointed out  , The issue is to prevent overflow the default security check in visual studio is enabled ,  and it provides extra space in order to prevent overflows , so turning it off , made the compiler allocate only 12 bytes :D </p>\n\n<p>To turn this security measure ( Buffer Security Checks GS)  off\nProject settings ->  C/C++ -> Code generation -> security check = disable GS </p>\n\n<p>Some post related to GS </p>\n\n<p><a href=\"http://preshing.com/20110807/the-cost-of-buffer-security-checks-in-visual-c/\" rel=\"nofollow\">http://preshing.com/20110807/the-cost-of-buffer-security-checks-in-visual-c/</a></p>\n"}], "owner": {"reputation": 573, "user_id": 2796343, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/dzC4C.jpg?s=128&g=1", "display_name": "Dhayalan Pro", "link": "https://stackoverflow.com/users/2796343/dhayalan-pro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 1, "accepted_answer_id": 37309601, "answer_count": 1, "score": 1, "last_activity_date": 1463642069, "creation_date": 1463601756, "last_edit_date": 1463642069, "question_id": 37309076, "link": "https://stackoverflow.com/questions/37309076/why-does-initializing-a-string-in-a-function-doesnt-work-like-int-while-debuggi", "title": "Why does initializing a string in a function doesn&#39;t work like int while debugging", "body": "<p>So I tried debugging some simple C programs today ; </p>\n\n<p>First one being </p>\n\n<pre><code>int main(){\n\n int a ,b ;\n return 0 ;\n\n}\n</code></pre>\n\n<p>Which when de-compiled gave me  </p>\n\n<pre><code>  push        ebp  \n  mov         ebp,esp  \n  sub         esp,008h \n</code></pre>\n\n<p>because I need to have 8 bytes to store a and b in the current stack frame since they are local variable !</p>\n\n<p>But when I try the same with Strings say </p>\n\n<pre><code>int main() {\n\n    char greeting[12] = \"Pwnit2Ownit\";\n    return 0;\n}\n</code></pre>\n\n<p>Which when de-compiled gave me  </p>\n\n<pre><code> push        ebp  \n  mov         ebp,esp  \n  sub         esp,0DCh \n</code></pre>\n\n<p>0DCh is 220 ,\nBut since the string is only 12 bytes long shouldn't the  </p>\n\n<blockquote>\n  <p>sub   esp,0DCh</p>\n</blockquote>\n\n<p>be </p>\n\n<blockquote>\n  <p>sub         esp,00ch</p>\n</blockquote>\n\n<p>instead ? </p>\n\n<p>And can anyone share some links on how the strings are stored in the memory and accessed later via assembly [preferebly instruction] , like hows the string greetings stored in memory if it's length is large since we can't store all in the stack itself </p>\n"}, {"tags": ["c", "pointers", "struct", "malloc", "free"], "comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 1, "creation_date": 1463601004, "post_id": 37308857, "comment_id": 62138922, "body": "Did you check for what <code>malloc()</code> returns?"}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 3, "creation_date": 1463602605, "post_id": 37308857, "comment_id": 62139727, "body": "Let&#39;s save keystrokes with one-letter struct member names and then waste two characters on <code>(*img).w</code> instead of <code>img-&gt;w</code>! Brilliant."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 3745172, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/n1dWN.jpg?s=128&g=1", "display_name": "Maschs", "link": "https://stackoverflow.com/users/3745172/maschs"}, "edited": false, "score": 0, "creation_date": 1463601399, "post_id": 37308910, "comment_id": 62139128, "body": "Thanks. But the calls of image_init and the prototype of it were given to us to implement so I thought we can&#39;t change it. Are there solutions that don&#39;t change it?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463601400, "post_id": 37308910, "comment_id": 62139129, "body": "Or alternatively you can keep the structure similar to the original, but pass <code>struct image **img</code> as a parameter and assign <code>*img</code> with the <code>malloc</code>ed pointer."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 25, "user_id": 3745172, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/n1dWN.jpg?s=128&g=1", "display_name": "Maschs", "link": "https://stackoverflow.com/users/3745172/maschs"}, "edited": false, "score": 0, "creation_date": 1463601443, "post_id": 37308910, "comment_id": 62139156, "body": "@user3745172 In this case you don&#39;t need <code>malloc</code>. The function should be provided with an already allocated structure pointer. As you do in the question. Just remove the <code>malloc</code> line and you are done."}, {"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "reply_to_user": {"reputation": 25, "user_id": 3745172, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/n1dWN.jpg?s=128&g=1", "display_name": "Maschs", "link": "https://stackoverflow.com/users/3745172/maschs"}, "edited": false, "score": 0, "creation_date": 1463601444, "post_id": 37308910, "comment_id": 62139158, "body": "@user3745172 In that case you might need to use pointer to pointer. Refer to google please, check how to initialize a struct using pointer to pointer."}, {"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "reply_to_user": {"reputation": 25, "user_id": 3745172, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/n1dWN.jpg?s=128&g=1", "display_name": "Maschs", "link": "https://stackoverflow.com/users/3745172/maschs"}, "edited": false, "score": 0, "creation_date": 1463601533, "post_id": 37308910, "comment_id": 62139195, "body": "@user3745172 see update, if you can&#39;t change prototype"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463601681, "post_id": 37308910, "comment_id": 62139263, "body": "@Giorgi No need for <code>malloc</code> in main. It can be statically allocated as in the question..."}, {"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463601873, "post_id": 37308910, "comment_id": 62139365, "body": "@EugeneSh. No in that case he won&#39;t be able to use destroy function"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1463601950, "post_id": 37308910, "comment_id": 62139400, "body": "Maybe <code>image_init</code> is supposed to <code>malloc</code> the <code>data</code> pointer."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463602058, "post_id": 37308910, "comment_id": 62139450, "body": "Well, yeah. The interface lacks consistency."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463617471, "post_id": 37308910, "comment_id": 62144940, "body": "Don&#39;t forget that it is a good idea to ensure that all elements of the structure are properly initialized.  If you don&#39;t set the <code>data</code> element to NULL, you won&#39;t know whether the memory has been allocated for it or not \u2014 in general.  Your revised version does this by assigning to <code>data</code>, of course."}, {"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463648962, "post_id": 37308910, "comment_id": 62157095, "body": "@JonathanLeffler I made a change if I correctly understood your suggestion, initially I missed there was data pointer inside the structure in the first place :)"}], "tags": [], "owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "is_accepted": true, "score": 5, "last_activity_date": 1463648935, "last_edit_date": 1463648935, "creation_date": 1463601069, "answer_id": 37308910, "question_id": 37308857, "link": "https://stackoverflow.com/questions/37308857/c-usage-of-malloc-on-struct/37308910#37308910", "title": "C usage of malloc on struct", "body": "<p>First here</p>\n\n<pre><code>void image_init(struct image* img, int w, int h) {\n    img = malloc(sizeof(struct image));\n    (*img).w = w;\n    (*img).h = h;\n}\n</code></pre>\n\n<p><code>img</code> is a <em>copy</em> of the original pointer passed to it, hence the code on first line inside function has no effect, since it makes the <em>copy</em> point somewhere - not the original object.</p>\n\n<p>This:</p>\n\n<pre><code>struct image img;\nimage_init(&amp;img,100,100);\nimage_destroy(&amp;img);\n</code></pre>\n\n<p>doesn't make sense either (assuming you expected <code>img</code> to point somewhere after call to <code>init</code>). <code>img</code> isn't a pointer, how you expect it to point somewhere?</p>\n\n<hr>\n\n<p>One way you could solve this could be</p>\n\n<pre><code>struct image *img = image_init(100,100);\n</code></pre>\n\n<p>where</p>\n\n<pre><code>struct image* image_init(int w, int h) {\n    img = malloc(sizeof(struct image));\n    (*img).data = NULL;\n    (*img).w = w;\n    (*img).h = h;\n    return img;\n}\n</code></pre>\n\n<p>Don't forget to call <code>free</code> on the pointer returned by above function - you will need to free <code>data</code> pointer separately too, in case you allocate it too.</p>\n\n<hr>\n\n<p><strong>NOTE</strong>: My best guess (if you also can't change prototype) is you want something like this:</p>\n\n<pre><code>void image_init(struct image* img, int w, int h) {\n    img-&gt;data = malloc(sizeof(int) * w * h);\n    img-&gt;w = w;\n    img-&gt;h = h;\n}\n</code></pre>\n\n<p>destroy:</p>\n\n<pre><code>void image_destroy(struct image* img) {\n    free(img-&gt;data);\n    free(img);\n}\n</code></pre>\n\n<p>In main</p>\n\n<pre><code>struct image* img = malloc(sizeof(struct image));\nimage_init(img, 100, 100);\nimage_destroy(img);\n</code></pre>\n\n<p>PS. Or if you want the usage of those functions remain as you had in main go with the answer of Johnny Mopp.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463617612, "post_id": 37308938, "comment_id": 62144978, "body": "Beware of applying rules enforced by C++ compilers to C code.  They&#39;re different languages, and this is one place where there&#39;s a crucial difference."}], "tags": [], "owner": {"reputation": 1, "user_id": 6352927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e15a0b72a1afa509166c37e14137c63?s=128&d=identicon&r=PG&f=1", "display_name": "trench224", "link": "https://stackoverflow.com/users/6352927/trench224"}, "is_accepted": false, "score": -4, "last_activity_date": 1463601204, "creation_date": 1463601204, "answer_id": 37308938, "question_id": 37308857, "link": "https://stackoverflow.com/questions/37308857/c-usage-of-malloc-on-struct/37308938#37308938", "title": "C usage of malloc on struct", "body": "<p>You need to cast the malloc to struct because the return value of malloc is of type void. </p>\n"}, {"tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 0, "last_activity_date": 1463602348, "creation_date": 1463602348, "answer_id": 37309242, "question_id": 37308857, "link": "https://stackoverflow.com/questions/37308857/c-usage-of-malloc-on-struct/37309242#37309242", "title": "C usage of malloc on struct", "body": "<pre><code>struct image img;\nimage_init(&amp;img,100,100);\nimage_destroy(&amp;img);\n</code></pre>\n\n<p>allocates an image struct on your stack. Why are you trying to malloc one? If you really want one on the heap then do</p>\n\n<pre><code>    struct image * image_init( int w, int h) {\n        struct image *img = malloc(sizeof(struct image));\n        img-&gt;w = w;\n        img-&gt;h = h;\n        return img;\n    }\n...  \n    struct image *img = image_init(100,100);\n</code></pre>\n\n<p>Note the more idiomatic '->' use</p>\n\n<p>if you want the one on the stack then do</p>\n\n<pre><code>void image_init(struct image* img, int w, int h) {\n    img-&gt;w = w;\n    img-&gt;h = h;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463602784, "post_id": 37309301, "comment_id": 62139825, "body": "This makes a perfect sense."}], "tags": [], "owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "is_accepted": false, "score": 3, "last_activity_date": 1463602532, "creation_date": 1463602532, "answer_id": 37309301, "question_id": 37308857, "link": "https://stackoverflow.com/questions/37308857/c-usage-of-malloc-on-struct/37309301#37309301", "title": "C usage of malloc on struct", "body": "<p>I think your assignment is not to allocate the <code>img</code> but the <code>data</code> ptr:</p>\n\n<pre><code>void image_init(struct image* img, int w, int h) {\n    img-&gt;data = malloc(sizeof(int) * w * h);// Check for failure...\n    img-&gt;w = w;\n    img-&gt;h = h;\n}\nvoid image_destroy(struct image* img) {\n    free(img-&gt;data);\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 3745172, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/n1dWN.jpg?s=128&g=1", "display_name": "Maschs", "link": "https://stackoverflow.com/users/3745172/maschs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 37308910, "answer_count": 4, "score": 0, "last_activity_date": 1463648935, "creation_date": 1463600857, "question_id": 37308857, "link": "https://stackoverflow.com/questions/37308857/c-usage-of-malloc-on-struct", "title": "C usage of malloc on struct", "body": "<p>I'm trying to use malloc on a struct called image. The function is:</p>\n\n<pre><code>void image_init(struct image* img, int w, int h) {\n    img = malloc(sizeof(struct image));\n    (*img).w = w;\n    (*img).h = h;\n}\n</code></pre>\n\n<p>And the function to free the image again is:</p>\n\n<pre><code>void image_destroy(struct image* img) {\n    free(img);\n}\n</code></pre>\n\n<p>But whenever I try to free the malloc-ed data I'm getting the error that the adress I'm trying to free was not malloc-ed before.</p>\n\n<p>The struct of image is:</p>\n\n<pre><code>struct image {\n    int w,h;\n    int* data;\n}\n</code></pre>\n\n<p>I call the functions with:</p>\n\n<pre><code>struct image img;\nimage_init(&amp;img,100,100);\nimage_destroy(&amp;img);\n</code></pre>\n"}, {"tags": ["c", "c-preprocessor"], "comments": [{"owner": {"reputation": 2863, "user_id": 415823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2c57689ce574b5988334b777e774bb3?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/415823/adam"}, "edited": false, "score": 0, "creation_date": 1463600438, "post_id": 37308664, "comment_id": 62138631, "body": "The nomenclature is <a href=\"https://en.wikipedia.org/wiki/Include_guard\" rel=\"nofollow noreferrer\">Include guard</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1463600447, "post_id": 37308664, "comment_id": 62138638, "body": "First to learn is to use the word &quot;function&quot; very carefully. It has a specific meaning and the preprocessor commands are verry far away from it."}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1463600544, "post_id": 37308664, "comment_id": 62138692, "body": "many modern compilers support <code>#pragma once</code> which does the same thing, and is generally easier to read.  Its not standard (yet), but is fairly widely supported."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1463601179, "post_id": 37308664, "comment_id": 62139008, "body": "You can change the code file templates in Eclipse if you wish. Window -&gt; Preferences -&gt; C/C++ -&gt; Code Style -&gt; Code Templates"}], "answers": [{"comments": [{"owner": {"reputation": 7573, "user_id": 1601882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5f4e8acebc2b429de1f513f4d03ba07b?s=128&d=identicon&r=PG", "display_name": "Andy Braham", "link": "https://stackoverflow.com/users/1601882/andy-braham"}, "edited": false, "score": 0, "creation_date": 1463661470, "post_id": 37308728, "comment_id": 62166140, "body": "Thanks for the explanation, that&#39;s what I thought but wasn&#39;t sure. This brings up another question about this, should you put your #include&#39;s in the statement or outside? I would assume that you would want everything in the file inside the statement but I could be wrong."}, {"owner": {"reputation": 8147, "user_id": 2149741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1374188e1ceb9d62123af4aece7c4ee4?s=128&d=identicon&r=PG", "display_name": "Jeremy West", "link": "https://stackoverflow.com/users/2149741/jeremy-west"}, "reply_to_user": {"reputation": 7573, "user_id": 1601882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5f4e8acebc2b429de1f513f4d03ba07b?s=128&d=identicon&r=PG", "display_name": "Andy Braham", "link": "https://stackoverflow.com/users/1601882/andy-braham"}, "edited": false, "score": 0, "creation_date": 1463677647, "post_id": 37308728, "comment_id": 62178347, "body": "That is the standard approach yes: put the include guards on the absolute outside of the file with everything else inside. But in practice, it probably doesn&#39;t matter much. If you have include guards in all your header files, then including a header twice will try to include all its dependencies twice, which will do nothing. Although that is probably slightly less efficient."}], "tags": [], "owner": {"reputation": 8147, "user_id": 2149741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1374188e1ceb9d62123af4aece7c4ee4?s=128&d=identicon&r=PG", "display_name": "Jeremy West", "link": "https://stackoverflow.com/users/2149741/jeremy-west"}, "is_accepted": true, "score": 0, "last_activity_date": 1463600419, "creation_date": 1463600419, "answer_id": 37308728, "question_id": 37308664, "link": "https://stackoverflow.com/questions/37308664/why-do-eclipse-generated-header-files-start-with-ifndef-and-define/37308728#37308728", "title": "Why do Eclipse-generated header files start with #ifndef and #define?", "body": "<p>Yes, this is very similar to PHP #INCLUDE_ONCE. The idea is that a header files contains declarations for functions and variables that are used in other modules. Those modules must #include the header file to be able to access those functions and variables. But if a source file #include's a header and then #include's another header that also #include's that header, you get two copies of those declarations, which causes all sorts of problems.</p>\n\n<p>This common technique prevents duplicate inclusion. It insures that any code unit that #include's a header gets a copy of it the first time it is requested, but not again.</p>\n"}], "owner": {"reputation": 7573, "user_id": 1601882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5f4e8acebc2b429de1f513f4d03ba07b?s=128&d=identicon&r=PG", "display_name": "Andy Braham", "link": "https://stackoverflow.com/users/1601882/andy-braham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "closed_date": 1463600698, "accepted_answer_id": 37308728, "answer_count": 1, "score": -1, "last_activity_date": 1463666704, "creation_date": 1463600183, "last_edit_date": 1463666704, "question_id": 37308664, "link": "https://stackoverflow.com/questions/37308664/why-do-eclipse-generated-header-files-start-with-ifndef-and-define", "closed_reason": "Duplicate", "title": "Why do Eclipse-generated header files start with #ifndef and #define?", "body": "<p>I understand that the #define function is a pre-processor command that basically copies and pastes chunks of code for the lack of a better explanation. What I am not clear about is in the templates for Eclipse header files it inserts:</p>\n\n<pre><code>#ifndef &lt;FileName&gt;_H\n#define &lt;FileName&gt;_H\n\n//Code, definitions etc....\n\n#endif\n</code></pre>\n\n<p>I understand that it is defining a variable to tell something that the file was defined, what I don't know is why? Is this sort of the same thing in PHP as #INCLUDE_ONCE? I tried to search for this on here and Google but I am not quite sure what the nomenclature is for what I want, everything that I found explains what it is, how it works etc...</p>\n\n<h2><strong>EDIT</strong></h2>\n\n<p>Since this is similar to a #include once in PHP, what is the best practice for putting #include statements? I would assume that you would want them inside the #define so they didn't get included if the file was already included is this also correct? If the included files were outside of the #define command wouldn't they be included regardless?</p>\n"}, {"tags": ["c", "arrays", "string", "pointers"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1463600370, "post_id": 37308498, "comment_id": 62138591, "body": "There is no string type in C. It is an array of <code>char</code> with specific conventions. However, your code does not use an array of that, but <b>pointers</b>. A pointer is not an array (nor a &quot;string&quot;)."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1463601133, "post_id": 37308498, "comment_id": 62138978, "body": "@Unknown  It is unclear if the two cities are equal each other do you need to add one of them?"}, {"owner": {"reputation": 108, "user_id": 5523649, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RJmgM.jpg?s=128&g=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/5523649/unknown"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1463601434, "post_id": 37308498, "comment_id": 62139150, "body": "@Olaf I understand that. I could say I use array of pointers to char, I just named it so to be simplier to read :)"}, {"owner": {"reputation": 108, "user_id": 5523649, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RJmgM.jpg?s=128&g=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/5523649/unknown"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1463601619, "post_id": 37308498, "comment_id": 62139235, "body": "@VladfromMoscow Basically, I give to the function two cities which are NOT equal and I have to include them both (if they&#39;re not existing in array yet)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1463602971, "post_id": 37308498, "comment_id": 62139924, "body": "Problem is that beginners tend to adopt such bad habits."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463616957, "post_id": 37308498, "comment_id": 62144829, "body": "Doesn&#39;t that repeated chunk of code cry out for the use of a function from within the function you&#39;ve just written?  It should \u2014 though maybe you&#39;ve not yet got attuned to such refinements in style.  You also seem to be double incrementing <code>toReturn</code> \u2014 once while adding a city and again afterwards when you check whether a city was added.  You only need one of the two.  If you use a (sub)function, it can return 0 if it was not added and 1 if it was (the function would return the number of added city names, in other words).  And you aren&#39;t incrementing <code>amount</code> when you need to."}], "answers": [{"comments": [{"owner": {"reputation": 108, "user_id": 5523649, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RJmgM.jpg?s=128&g=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/5523649/unknown"}, "edited": false, "score": 0, "creation_date": 1463601062, "post_id": 37308566, "comment_id": 62138951, "body": "I am reading these (city1, city1) from file while !EOF and calling this function everytime. My intention is that each name would be represented in array without repetition. Maybe I should use memmory allocation and strcpy in this case?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 108, "user_id": 5523649, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RJmgM.jpg?s=128&g=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/5523649/unknown"}, "edited": false, "score": 1, "creation_date": 1463601889, "post_id": 37308566, "comment_id": 62139373, "body": "@Unknown, that is useful information but not enough to suggest a solution."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463617199, "post_id": 37308566, "comment_id": 62144884, "body": "Another distinctly plausible alternative treatment is <code>arr[amount++] = strdup(city1);</code> \u2014 but there isn&#39;t enough information to  be sure that it is correct either."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1463599855, "creation_date": 1463599855, "answer_id": 37308566, "question_id": 37308498, "link": "https://stackoverflow.com/questions/37308498/updating-string-array-in-function-c/37308566#37308566", "title": "Updating string array in function - C", "body": "<pre><code>    if (strcmp(arr[i], city1) == NULL) {\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>    if (strcmp(arr[i], city1) == 0 ) {\n</code></pre>\n\n<p>Similarly, use</p>\n\n<pre><code>    if (strcmp(arr[i], city2) == 0 ) {\n</code></pre>\n\n<hr>\n\n<p>Whether you should use</p>\n\n<pre><code>    arr[amount] = city1;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>    strcpy(arr[amount], city1);\n</code></pre>\n\n<p>depends on how memory for those two objects are managed. It's hard to suggest anything on that without seeing the rest of your code.</p>\n"}, {"comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 108, "user_id": 5523649, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RJmgM.jpg?s=128&g=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/5523649/unknown"}, "edited": false, "score": 0, "creation_date": 1463602740, "post_id": 37309085, "comment_id": 62139802, "body": "@Unknown No at all. Do not forget to free the allocated memory when the array will not be needed any more."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1463603293, "last_edit_date": 1463603293, "creation_date": 1463601782, "answer_id": 37309085, "question_id": 37308498, "link": "https://stackoverflow.com/questions/37308498/updating-string-array-in-function-c/37309085#37309085", "title": "Updating string array in function - C", "body": "<p>It seems what you need is the following</p>\n\n<pre><code>char *cities[100];\n\n/* adds 2 names if they're unique instances and updates total number of cities names\nif necessary */\n\nint addCity( const char *city1, const char *city2, char **arr, int amount ) \n{\n    int i;\n\n    // checking whether first city already exists\n    i = 0;\n    while ( i &lt; amount &amp;&amp; strcmp( arr[i], city1 ) != 0 ) i++;\n\n    if ( i == amount )\n    {\n        arr[amount] = malloc( strlen( city1 ) + 1 );\n        if ( arr[amount] ) strcpy( arr[amount++], city1 );\n    }\n\n    // 2nd city\n    i = 0;\n    while ( i &lt; amount &amp;&amp; strcmp( arr[i], city2 ) != 0 ) i++;\n\n    if ( i == amount )\n    {\n        arr[amount] = malloc( strlen( city2 ) + 1 );\n        if ( arr[amount] ) strcpy( arr[amount++], city2 );\n    }\n\n    return amount;\n}\n</code></pre>\n\n<p>As for your code then these conditions in the if statements</p>\n\n<pre><code>if (strcmp(arr[i], city1) == NULL)\nif (strcmp(arr[i], city2) == NULL)\n</code></pre>\n\n<p>are wrong. There should be</p>\n\n<pre><code>if (strcmp(arr[i], city1) == 0)\nif (strcmp(arr[i], city2) == 0)\n</code></pre>\n\n<p>Also after this code block</p>\n\n<pre><code>if (flag1 == 0) {\n    arr[amount] = city1;\n    toReturn++;\n}\n</code></pre>\n\n<p>you should also increase <code>amount</code> because it is used below as an index in the array of pointers.</p>\n\n<p>These two conditions</p>\n\n<pre><code>if (flag2 == 0 &amp;&amp; flag1 == 1) {\nif (flag2 == 0 &amp;&amp; flag1 == 0) {\n</code></pre>\n\n<p>are equivalent to condition</p>\n\n<pre><code>if (flag2 == 0) {\n</code></pre>\n\n<p>And it seems you should dynamically allocate memory for each added city.</p>\n\n<p>As for me then I would use the following order of the function parameters</p>\n\n<pre><code>int addCity( char **arr, int amount, const char *city1, const char *city2 );\n</code></pre>\n\n<p>Or even the function could be defined the following way</p>\n\n<pre><code>int addCity( char **arr, int amount, const char *city )\n{\n    int i;\n\n    // checking whether the city already exists\n    i = 0;\n    while ( i &lt; amount &amp;&amp; strcmp( arr[i], city ) != 0 ) i++;\n\n    if ( i == amount )\n    {\n        arr[amount] = malloc( strlen( city ) + 1 );\n        if ( arr[amount] ) strcpy( arr[amount++], city );\n    }\n\n    return amount;\n}\n</code></pre>\n\n<p>and called separatly two times for each added city.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463617237, "post_id": 37309114, "comment_id": 62144893, "body": "And don&#39;t forget to check for successful allocation before copying.  Or consider using <code>strdup()</code>."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1463601904, "creation_date": 1463601904, "answer_id": 37309114, "question_id": 37308498, "link": "https://stackoverflow.com/questions/37308498/updating-string-array-in-function-c/37309114#37309114", "title": "Updating string array in function - C", "body": "<p>First <code>strcmp</code> return an integer. So don't compare it to <code>NULL</code>. <code>NULL</code> is a pointer value. So instead do a compare to <code>0</code>.</p>\n\n<pre><code>if (strcmp(arr[i], city1) == 0)\n</code></pre>\n\n<p>Your main problem is however that you assign pointers passed as arguments into your <code>cities</code>. That is a major problem as the pointers will (likely) go out of scope soon. </p>\n\n<p>You need to allocate memory and then do a <code>strcpy</code>. Something like:</p>\n\n<pre><code>if (flag1 == 0) {\n    char* tmp = malloc(strlen(city) + 1); // add 1 for zero termination\n    strcpy(tmp, city);\n    arr[amount] = tmp;\n    toReturn++;\n}\n</code></pre>\n\n<p>And... don't forget to <code>free</code> the memory when done with it.</p>\n"}], "owner": {"reputation": 108, "user_id": 5523649, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RJmgM.jpg?s=128&g=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/5523649/unknown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1463603293, "creation_date": 1463599590, "last_edit_date": 1463601325, "question_id": 37308498, "link": "https://stackoverflow.com/questions/37308498/updating-string-array-in-function-c", "title": "Updating string array in function - C", "body": "<p>I am writing C function, which updates array of strings, only if given elements are unique. I have implemented this function like this:</p>\n\n<pre><code>char *cities[100];\n\n/* adds 2 names if they're unique instances and updates total number of cities names\nif necessary */\n\nint addCity(char* city1, char* city2, char** arr, int amount) {\n    int toReturn = amount;\n    int i;\n    int flag1 = 0;\n    int flag2 = 0;\n\n    // checking whether first city already exists\n    for (i = 0; i &lt; amount; i++ ) {\n        if (strcmp(arr[i], city1) == NULL) {\n            flag1 = 1;\n            break;\n        }\n    }\n    if (flag1 == 0) {\n        arr[amount] = city1;\n        toReturn++;\n    }\n    // 2nd city\n    for (i = 0; i &lt; amount; i++ ) {\n        if (strcmp(arr[i], city2) == NULL) {\n            flag2 = 1;\n            break;\n        }\n    }\n    if (flag2 == 0 &amp;&amp; flag1 == 1) {\n        arr[amount] = city2;\n        toReturn++;\n    }\n    if (flag2 == 0 &amp;&amp; flag1 == 0) {\n        arr[amount+1] = city2;\n        toReturn++;\n    }\n    return toReturn;\n}\n</code></pre>\n\n<p>It looks that I get some warnings(comparison between pointer and integer) when trying to compare element of String array and String itself. How can I get rid of that? And overall, what else can be improved in this function?</p>\n\n<p>In addition, I doubt about arr[amount] = city1, but when i use strcpy() program does not work at all.</p>\n"}, {"tags": ["c", "windows", "winapi", "assembly", "msdn"], "comments": [{"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 8, "creation_date": 1463599662, "post_id": 37308438, "comment_id": 62138198, "body": "The standard says the size of <code>short</code> is at least 16 bits. The exact size is to be decided by the implementation. Microsoft <b><i>is</i></b> the implementation and they chose 16."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 4, "creation_date": 1463599734, "post_id": 37308438, "comment_id": 62138237, "body": "If Microsoft defines ABI&#39;s for their platform where <code>short</code> is always 16 bit long, <code>short</code> is always 16-bit long on Microsoft platforms. It&#39;s their decision."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1463600677, "post_id": 37308438, "comment_id": 62138763, "body": "AFAIK the types <code>WORD</code> and <code>DWORD</code> predate <code>uint16_t</code> and <code>uint32_t</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463604297, "post_id": 37308438, "comment_id": 62140563, "body": "Please try and stick to one question per post... you have 5 different questions in your question"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1463605450, "post_id": 37308438, "comment_id": 62141124, "body": "All those questions are part of a narrative. Read the final paragraph."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1463605534, "post_id": 37308438, "comment_id": 62141177, "body": "@WeatherVane: I wonder if there&#39;s any guarantee that &quot;DWORD&quot; and &quot;uint32_t&quot; will be alias-compatible?  If a platform with 32-bit <code>int</code> and <code>long</code> were to use <code>unsigned int</code> for <code>uint32_t</code> and <code>unsigned long</code> for <code>DWORD</code>, modern versions of gcc would assume that a write via <code>DWORD*</code> can never modify a <code>uint32_t</code>, and a write via <code>uint32_t*</code> can never modify a <code>DWORD</code>."}, {"owner": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "edited": false, "score": 1, "creation_date": 1463644242, "post_id": 37308438, "comment_id": 62153914, "body": "MS is saying <code>WORD</code> is 16-bits. It&#39;s not saying <code>short</code> is of given size."}], "answers": [{"comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1463602174, "post_id": 37308533, "comment_id": 62139511, "body": "The question is how MS can be sure that short is 16 bits when the C standard does not mandate that."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1463604071, "post_id": 37308533, "comment_id": 62140433, "body": "@DavidHeffernan there are a lot of questions in OP  post, there is more emphasis on the question &quot;How can MS say that WORD is 16-bit&quot;"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1463605194, "post_id": 37308533, "comment_id": 62140996, "body": "@DavidHeffernan read the title, note the question mark on the end"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1463605747, "post_id": 37308533, "comment_id": 62141293, "body": "@DavidHeffernan there are 4 different questions in the body. For example, &quot; But who decides what bit sizes are going to be used anyway?&quot;"}], "tags": [], "owner": {"reputation": 31053, "user_id": 566608, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bf8ff77ca000b80a2b19d07dbb257645?s=128&d=identicon&r=PG", "display_name": "Felice Pollano", "link": "https://stackoverflow.com/users/566608/felice-pollano"}, "is_accepted": false, "score": 2, "last_activity_date": 1463599738, "creation_date": 1463599738, "answer_id": 37308533, "question_id": 37308438, "link": "https://stackoverflow.com/questions/37308438/how-can-microsoft-say-the-size-of-a-word-in-winapi-is-16-bits/37308533#37308533", "title": "How can Microsoft say the size of a word in WinAPI is 16 bits?", "body": "<p>In the windows headers there is a lot of #define that based on the platform can ensure a WORD is 16 bit a DWORD is 32 etc etc. In some case in the past, I know they distribuite a proper SDK for each platform. In any case nothing magic, just a mixture of proper #defines and headers.</p>\n"}, {"comments": [{"owner": {"reputation": 124, "user_id": 6352415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67b86006e10ddfc6dbf8494563323f3e?s=128&d=identicon&r=PG&f=1", "display_name": "codegrumps", "link": "https://stackoverflow.com/users/6352415/codegrumps"}, "edited": false, "score": 0, "creation_date": 1463600825, "post_id": 37308599, "comment_id": 62138824, "body": "Some research has told me that 16 bits is called a word for historical reasons, and that it hasn&#39;t been changed because of compatibility issues. I was thrown off by that as well but it was easier for me to understand than the actual typedef statement."}, {"owner": {"reputation": 4411, "user_id": 751579, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/iux9g.png?s=128&g=1", "display_name": "davidbak", "link": "https://stackoverflow.com/users/751579/davidbak"}, "reply_to_user": {"reputation": 124, "user_id": 6352415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67b86006e10ddfc6dbf8494563323f3e?s=128&d=identicon&r=PG&f=1", "display_name": "codegrumps", "link": "https://stackoverflow.com/users/6352415/codegrumps"}, "edited": false, "score": 3, "creation_date": 1463601055, "post_id": 37308599, "comment_id": 62138947, "body": "@brokyle - exactly.  In the future when we&#39;re running on 128-bit von Neumann machines or 8 qubit quantum machines, our <i>Windows code</i> will still be using 16 bit WORDs and 32 bit DWORDs.  Because: 80286."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1463626215, "post_id": 37308599, "comment_id": 62147057, "body": "&quot;word=16bits, dword=32bits, qword=64bits&quot; is everywhere in Intel&#39;s <a href=\"http://www.felixcloutier.com/x86/\" rel=\"nofollow noreferrer\">asm documentation and syntax</a>. e.g. the <code>pshufd</code> insn mnemonic (<code>_mm_shuffle_epi32</code>) is Packed (integer) Shuffle Dword.  <code>psraw</code> is Packed Shift Right Arithmetic Word.  (packed-FP insns use a ps or pd suffix instead of <code>p</code> prefix.)  See also the <a href=\"http://stackoverflow.com/tags/x86/info\">x86 tag wiki for more links</a>. The original reason for the terminology: 8086.  instructions like <code>cbw</code> (sign extend al into ax) vs. <code>cwd</code> (sign extend ax into dx:ax).  386 added <code>cwde</code> (sign-extend ax into eax)"}], "tags": [], "owner": {"reputation": 4411, "user_id": 751579, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/iux9g.png?s=128&g=1", "display_name": "davidbak", "link": "https://stackoverflow.com/users/751579/davidbak"}, "is_accepted": false, "score": 8, "last_activity_date": 1463599996, "creation_date": 1463599996, "answer_id": 37308599, "question_id": 37308438, "link": "https://stackoverflow.com/questions/37308438/how-can-microsoft-say-the-size-of-a-word-in-winapi-is-16-bits/37308599#37308599", "title": "How can Microsoft say the size of a word in WinAPI is 16 bits?", "body": "<p>There was originally an assumption that all code intended to run on Windows would be compiled with Microsoft's own compiler - or a fully compatible compiler.  And that's the way it worked.  Borland C: Matched Microsoft C. Zortech's C: Matched Microsoft C.  gcc: not so much, so you didn't even try (not to mention there were no runtimes, etc.).</p>\n\n<p>Over time this concept got codified and extended to other operating systems (or perhaps the other operating systems got it first) and now it is known as an ABI - <a href=\"https://en.wikipedia.org/wiki/Application_binary_interface\"><em>Application Binary Interface</em></a> - for a platform, and all compilers <em>for that platform</em> are assumed (in practice, required) to match the ABI.  And that means matching expectations for the sizes of integral types (among other things).</p>\n\n<p>An interesting related question you didn't ask is: So why is 16-bits called a <em>word</em>?  Why is 32-bits a <em>dword</em> (double word) on our 32- and now 64-bit architectures where the native machine \"word\" size is 32- or 64-, not 16?  Because: 80286.</p>\n"}, {"comments": [{"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1463614371, "post_id": 37308678, "comment_id": 62144221, "body": "@DavidHeffernan they can&#39;t, but they can document that the compiler vendor needs to ensure that the appropriate datatype gets mapped to the Windows type for each size.  The Windows libraries are built under a certain set of assumptions (the ABI) that must be met by the toolchains used to develop against it."}, {"owner": {"reputation": 30593, "user_id": 27491, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/48cc12ad73f816bc5b115a9ca6965328?s=128&d=identicon&r=PG", "display_name": "Chris Becke", "link": "https://stackoverflow.com/users/27491/chris-becke"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1463645872, "post_id": 37308678, "comment_id": 62154928, "body": "@DavidHeffernan That&#39;s not the question. Thats a piece of misdirection the OP has included in the exposition around the question. But the question itself relates to the size of WORD."}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 0, "creation_date": 1558723375, "post_id": 37308678, "comment_id": 99208398, "body": "Funny these could be implemented portably now. <code>#include &lt;stdint.h&gt; typedef uint16_t WORD;</code>"}], "tags": [], "owner": {"reputation": 30593, "user_id": 27491, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/48cc12ad73f816bc5b115a9ca6965328?s=128&d=identicon&r=PG", "display_name": "Chris Becke", "link": "https://stackoverflow.com/users/27491/chris-becke"}, "is_accepted": false, "score": 9, "last_activity_date": 1463652836, "last_edit_date": 1463652836, "creation_date": 1463600215, "answer_id": 37308678, "question_id": 37308438, "link": "https://stackoverflow.com/questions/37308438/how-can-microsoft-say-the-size-of-a-word-in-winapi-is-16-bits/37308678#37308678", "title": "How can Microsoft say the size of a word in WinAPI is 16 bits?", "body": "<p>Simply put, a <code>WORD</code> is always 16 bits.</p>\n\n<p>As a <code>WORD</code> is always 16 bits, but an <code>unsigned short</code> is not, a <code>WORD</code> is not always an <code>unsigned short</code>.</p>\n\n<p>For every platform that the Windows SDK supports, the windows header file contains <code>#ifdef</code> style macros that can detect the compiler and its platform, and associate the Windows SDK defined types (<code>WORD</code>, <code>DWORD</code>, etc) to the appropriately sized platform types.</p>\n\n<p>This is WHY the Windows SDK actually uses internally defined types, such as <code>WORD</code>, rather than using language types: so that they can ensure that their definitions are always correct.</p>\n\n<p>The Windows SDK that ships with Microsoft toolchains, is possibly lazy, as Microsoft c++ toolchains always use 16bit unsigned shorts.</p>\n\n<p>I would not expect the windows.h that ships with Visual Studio C++ to work correctly if dropped into GCC, clang etc. as so many details, including the mechanism of importing dll's using .iib files that the Platform SDK distribute, is a Microsoft specific implementation.</p>\n\n<hr>\n\n<p>A different interpretation is that:</p>\n\n<p>Microsoft says a <code>WORD</code> is 16 bits. If \"someone\" wants to call a windows API, they must pass a 16 bit value where the API defines the field as a WORD.\nMicrosoft also possibly says, in order to build a valid windows program, using the windows header files present in their Windows SDK, the user MUST choose a compiler that has a 16bit <code>short</code>.</p>\n\n<p>The c++ spec does not say that compilers must implement <code>short</code>s as 16 bits - Microsoft says the compiler you choose to build windows executables must.</p>\n"}, {"comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1463624507, "post_id": 37309860, "comment_id": 62146649, "body": "almost all compiler implementations on other platforms also have 16-bit short."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1463638720, "post_id": 37309860, "comment_id": 62150647, "body": "<i>&quot;You can think of MSDN pages as describing typical behaviour for MSVC++&quot;</i> - The MSDN describes Windows&#39; ABI. This is not strictly limited to Microsoft&#39;s compiler, but any compiler targeting that platform."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1463604549, "creation_date": 1463604549, "answer_id": 37309860, "question_id": 37308438, "link": "https://stackoverflow.com/questions/37308438/how-can-microsoft-say-the-size-of-a-word-in-winapi-is-16-bits/37309860#37309860", "title": "How can Microsoft say the size of a word in WinAPI is 16 bits?", "body": "<p>Currently there are no platforms that support Windows API but have <code>unsigned short</code> as not 16-bit.</p>\n\n<p>If someone ever did make such a platform, the Windows API headers for that platform would not include the line <code>typedef unsigned short WORD;</code>.</p>\n\n<p>You can think of MSDN pages as describing typical behaviour for MSVC++ on x86/x64 platforms. </p>\n"}, {"tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": false, "score": 0, "last_activity_date": 1463622884, "last_edit_date": 1463622884, "creation_date": 1463622407, "answer_id": 37312652, "question_id": 37308438, "link": "https://stackoverflow.com/questions/37308438/how-can-microsoft-say-the-size-of-a-word-in-winapi-is-16-bits/37312652#37312652", "title": "How can Microsoft say the size of a word in WinAPI is 16 bits?", "body": "<p>The legacy for types like WORD predates Windows back to the days of MSDOS following the types defined by MASM (later the name was changed to ML). Not adopted by Windows API are MASM's signed types, such as SBYTE, SWORD, SDWORD, SQWORD.</p>\n\n<p>QWORD / SQWORD in MASM probably wasn't defined until MASM / ML supported 80386.</p>\n\n<p>A current reference:</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/8t163bt0.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/8t163bt0.aspx</a></p>\n\n<p>Windows added types such as HANDLE, WCHAR, TCHAR, ... .</p>\n\n<p>For Windows / Microsoft compilers, size_t is an unsigned integer the same size as a poitner, 32 bits if in 32 bit mode, 64 bits if in 64 bit mode.</p>\n\n<p>The DB and DW data directives in MASM go back to the days of Intel's 8080 assembler.</p>\n"}, {"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 1, "last_activity_date": 1463660444, "last_edit_date": 1495535625, "creation_date": 1463660444, "answer_id": 37323062, "question_id": 37308438, "link": "https://stackoverflow.com/questions/37308438/how-can-microsoft-say-the-size-of-a-word-in-winapi-is-16-bits/37323062#37323062", "title": "How can Microsoft say the size of a word in WinAPI is 16 bits?", "body": "<p>The <code>BYTE=8bits</code>, <code>WORD=16bits</code>, and <code>DWORD=32bits</code> (double-word) terminology comes from Intel's instruction mnemonics and documentation for 8086.  It's just terminology, and at this point doesn't imply anything about <a href=\"https://en.wikipedia.org/wiki/Word_(computer_architecture)\" rel=\"nofollow noreferrer\">the size of the \"machine word\"</a> on the actual machine running the code.</p>\n\n<p>My guess:</p>\n\n<p>Those C type names were probably originally introduced for the same reason that <a href=\"https://en.wikibooks.org/wiki/C_Programming/C_Reference/stdint.h\" rel=\"nofollow noreferrer\">C99 standardized <code>uint8_t</code>, <code>uint16_t</code>, and <code>uint32_t</code></a>.  The idea was probably to allow C implementations with an incompatible ABI (e.g. 16bit <code>int</code> or 32bit <code>short</code>) to still compile code that uses the WinAPI, because the ABI uses <code>DWORD</code> rather than <code>long</code> or <code>int</code> in <code>struct</code>s, and function args / return values.</p>\n\n<p>Probably as Windows evolved, enough code started depending in various ways on the exact definition of WORD and DWORD that MS decided to <a href=\"https://msdn.microsoft.com/en-ca/library/windows/desktop/aa383751(v=vs.85).aspx\" rel=\"nofollow noreferrer\">standardize the exact <code>typedef</code>s</a>.  This diverges from the C99 <code>uint16_t</code> idea, where you can't assume that it's <code>unsigned short</code>.</p>\n\n<p>As <a href=\"https://stackoverflow.com/questions/37308438/how-can-microsoft-say-the-size-of-a-word-in-winapi-is-16-bits#comment62141177_37308438\">@supercat points out</a>, this can matter for aliasing rules.  e.g. if you modify an array of <code>unsigned long[]</code> through a <code>DWORD*</code>, it's guaranteed that it will work as expected.  But if you modify an array of <code>unsigned int[]</code> through a <code>DWORD*</code>, the compiler might assume that didn't affect array values that it already had in registers.  This also matters for <code>printf</code> format strings.  (C99's <code>&lt;stdint.h&gt;</code> solution to that is <a href=\"https://stackoverflow.com/questions/3168275/printf-format-specifiers-for-uint32-t-and-size-t\">preprocessor macros like <code>PRIu32</code></a>.)</p>\n\n<p><strong>Or maybe the idea was just to use names that match the asm</strong>, to make sure nobody was confused about the width of types.  In the very early days of Windows, writing programs in asm directly, instead of C, was popular.  WORD/DWORD makes the documentation clearer for people writing in asm.</p>\n\n<p><strong>Or maybe the idea was just to provide a fixed-width types for portable code</strong>.  e.g. <code>#ifdef SUNOS</code>: define it to an appropriate type for that platform.  This is all it's good for at this point, as you noticed:</p>\n\n<blockquote>\n  <p>How is it that the Windows API can typedef unsigned short WORD; and then say WORD is a 16-bit unsigned integer when the C Standard itself does not guarantee that a short is always 16 bits?</p>\n</blockquote>\n\n<p>You're correct, documenting the exact <code>typedef</code>s means that it's impossible to correctly implement the WinAPI headers in a system using a different ABI (e.g. one where <code>long</code> is 64bit or <code>short</code> is 32bit).  This is part of the reason why the x86-64 Windows ABI makes <code>long</code> a 32bit type.  The x86-64 System V ABI (Linux, OS X, etc.) makes <code>long</code> a 64bit type.</p>\n\n<p><strong>Every platform does need a standard ABI, though</strong>.  <code>struct</code> layout, and even interpretation of function args, requires all code to agree on the size of the types used.  Code from different version of the same C compiler can interoperate, and even other compilers that follow the same ABI.  (However, C++ ABIs aren't stable enough to standardize.  For example, <code>g++</code> has never standardized an ABI, and new versions do break ABI compatibility.)</p>\n\n<p>Remember that the C standard only tells you what you can assume across every conforming C implementation.  The C standard also says that signed integers might be sign/magnitude, one's complement, or two's complement.  Any specific platform will use whatever representation the hardware does, though.</p>\n\n<p>Platforms are free to standardize anything that the base C standard leaves undefined or implementation-defined.  e.g. x86 C implementations allow creating unaligned pointers to exist, and even to dereference them.  This happens a lot with <code>__m128i</code> vector types.</p>\n\n<hr>\n\n<p>The actual names chosen tie the WinAPI to its x86 heritage, and are unfortunately confusing to anyone not familiar with x86 asm, or at least Windows's 16bit DOS heritage.</p>\n\n<hr>\n\n<p>The 8086 instruction mnemonics that include <code>w</code> for word and <code>d</code> for dword  were commonly used as setup for <a href=\"http://www.felixcloutier.com/x86/IDIV.html\" rel=\"nofollow noreferrer\"><code>idiv</code> signed division</a>.</p>\n\n<ul>\n<li><a href=\"http://www.felixcloutier.com/x86/CBW:CWDE:CDQE.html\" rel=\"nofollow noreferrer\"><code>cbw</code>: sign extend AL (byte) into AX (word)</a></li>\n<li><a href=\"http://www.felixcloutier.com/x86/CWD:CDQ:CQO.html\" rel=\"nofollow noreferrer\"><code>cwd</code>: sign extend AX (word) into DX:AX (dword)</a>, i.e. copy the sign bit of <code>ax</code> into every bit of <code>dx</code>.</li>\n</ul>\n\n<p>These insns still exist and do exactly the same thing in 32bit and 64bit mode.  (386 and x86-64 added extended versions, as you can see in those extracts from Intel's insn set reference.)  There's also <a href=\"http://www.felixcloutier.com/x86/LODS:LODSB:LODSW:LODSD:LODSQ.html\" rel=\"nofollow noreferrer\"><code>lodsw</code></a>, <code>rep movsw</code>, etc. string instructions.</p>\n\n<p>Besides those mnemonics, operand-size needs to be explicitly specified in some cases, e.g.<br>\n<code>mov dword ptr [mem], -1</code>, where neither operand is a register that can imply the operand-size.  (To see what assembly language looks like, just disassemble something.  e.g. on a Linux system, <code>objdump -Mintel -d /bin/ls | less</code>.)</p>\n\n<p><strong>So the terminology is all over the place in x86 asm, which is something you need to be familiar with when <a href=\"https://en.wikipedia.org/wiki/Application_binary_interface#Description\" rel=\"nofollow noreferrer\">developing an ABI</a>.</strong></p>\n\n<hr>\n\n<h1>More x86 asm background, history, and current naming schemes</h1>\n\n<p>Nothing below this point has anything to do with WinAPI or the original question, but I thought it was interesting.</p>\n\n<hr>\n\n<p>See also the <a href=\"/questions/tagged/x86\" class=\"post-tag\" title=\"show questions tagged &#39;x86&#39;\" rel=\"tag\">x86</a> tag wiki for links to Intel's official PDFs (and lots of other good stuff).  This terminology is still ubiquitous in Intel and AMD documentation and instruction mnemonics, because it's completely unambiguous in a document for a <em>specific</em> architecture that uses it consistently.</p>\n\n<p>386 extended register sizes to 32bits, and introduced the <code>cdq</code> instruction: <code>cdq</code> (eax (dword) -> edx:eax (qword)).  (Also introduced <code>movsx</code> and <code>movzx</code>, to sign- or zero-extend without without needing to get the data into <code>eax</code> first.)  Anyway, quad-word is 64bits, and was used even in pre-386 for <code>double</code>-precision memory operands for <a href=\"http://www.felixcloutier.com/x86/FLD.html\" rel=\"nofollow noreferrer\"><code>fld qword ptr [mem]</code></a> / <code>fst qword ptr [mem]</code>.</p>\n\n<p><strong>Intel still uses this b/w/d/q/dq convention for vector instruction naming</strong>, so it's not at all something they're trying to phase out.</p>\n\n<p>e.g. the <a href=\"http://www.felixcloutier.com/x86/PSHUFD.html\" rel=\"nofollow noreferrer\"><code>pshufd</code> insn</a> mnemonic (<a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#text=pshufd&amp;expand=4690\" rel=\"nofollow noreferrer\"><code>_mm_shuffle_epi32</code> C intrinsic</a>) is Packed (integer) Shuffle Dword.  <code>psraw</code> is Packed Shift Right Arithmetic Word.  (FP vector insns use a <code>ps</code> (packed single) or <code>pd</code> (packed double) suffix instead of <code>p</code> prefix.)</p>\n\n<p>As vectors get wider and wider, the naming starts to get silly: e.g. <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#expand=4690,5595&amp;text=punpcklqdq\" rel=\"nofollow noreferrer\"><code>_mm_unpacklo_epi64</code> is the intrinsic</a> for the <a href=\"http://www.felixcloutier.com/x86/PUNPCKLBW:PUNPCKLWD:PUNPCKLDQ:PUNPCKLQDQ.html\" rel=\"nofollow noreferrer\"><code>punpcklqdq</code> instruction</a>: Packed-integer Unpack L Quad-words to Double-Quad.  (i.e. interleave 64bit low halves into one 128b).  Or <code>movdqu</code> for Move Double-Quad Unaligned loads/stores (16 bytes).  Some assemblers use <code>o</code> (oct-word) for declaring 16 byte integer constants, but Intel mnemonics and documentation always use <code>dq</code>.</p>\n\n<p>Fortunately for our sanity, the AVX 256b (32B) instructions still use the SSE mnemonics, so <code>vmovdqu  ymm0, [rsi]</code> is a 32B load, but there's no quad-quad terminology.  Disassemblers that include operand-sizes even when it's not ambiguous would print <code>vmovdqu ymm0, ymmword ptr [rsi]</code>.</p>\n\n<hr>\n\n<p>Even the names of some AVX-512 extensions use the b/w/d/q terminology.  AVX-512F (foundation) doesn't include all element-size versions of every instruction.  The 8bit and 16bit element size versions of some instructions are only available on hardware that <a href=\"https://en.wikipedia.org/wiki/AVX-512#New_instructions_in_AVX-512_BW_and_DQ\" rel=\"nofollow noreferrer\">supports the <strong>AVX-512BW</strong></a> extension.  There's also <strong>AVX-512DQ</strong> for extra dword and qword element-size instructions, including conversion between float/double and 64bit integers and <a href=\"https://stackoverflow.com/questions/37296289/fastest-way-to-multiply-an-array-of-long-long/37320416#37320416\">a multiply with 64b x 64b => 64b element size</a>.</p>\n\n<hr>\n\n<h3>A few new instructions use numeric sizes in the mnemonic</h3>\n\n<p><a href=\"http://www.felixcloutier.com/x86/VINSERTF128.html\" rel=\"nofollow noreferrer\">AVX's <code>vinsertf128</code></a> and similar for extracting the high 128bit lane of an 256bit vector could have used <code>dq</code>, but instead uses <code>128</code>.</p>\n\n<p>AVX-512 introduces a few insn mnemonics with names like <code>vmovdqa64</code> (vector load with masking at 64bit element granularity) or <code>vshuff32x4</code> (shuffle 128b elements, with masking at 32bit element granularity).</p>\n\n<p>Note that since AVX-512 has merge-masking or zero-masking for almost all instructions, even instructions that didn't used to care about element size (like <code>pxor</code> / <code>_mm_xor_si128</code>) now come in different sizes: <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#expand=4690,5595,5646,5676,5653&amp;text=vpxor\" rel=\"nofollow noreferrer\"><code>_mm512_mask_xor_epi64</code> (<code>vpxorq</code>)</a> (each mask bit affects a 64bit element), or <code>_mm512_mask_xor_epi32</code> (<code>vpxord</code>).  The no-mask intrinsic <code>_mm512_xor_si512</code> could compile to either <code>vpxorq</code> or <code>vpxord</code>; it doesn't matter.</p>\n\n<p>Most AVX512 new instructions still use b/w/d/q in their mnemonics, though, like <code>VPERMT2D</code> (full permute selecting elements from two source vectors).</p>\n"}], "owner": {"reputation": 124, "user_id": 6352415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67b86006e10ddfc6dbf8494563323f3e?s=128&d=identicon&r=PG&f=1", "display_name": "codegrumps", "link": "https://stackoverflow.com/users/6352415/codegrumps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1055, "favorite_count": 0, "answer_count": 6, "score": 8, "last_activity_date": 1463660444, "creation_date": 1463599410, "last_edit_date": 1495542897, "question_id": 37308438, "link": "https://stackoverflow.com/questions/37308438/how-can-microsoft-say-the-size-of-a-word-in-winapi-is-16-bits", "title": "How can Microsoft say the size of a word in WinAPI is 16 bits?", "body": "<p>I've just started learning the WinAPI. In the MSDN, the following explanation is provided for the WORD data type.</p>\n\n<blockquote>\n  <p>WORD<br>\n  A 16-bit unsigned integer. The range is 0 through 65535 decimal.<br>\n  This type is declared in WinDef.h as follows: <br>\n  typedef unsigned short WORD;</p>\n</blockquote>\n\n<p>Simple enough, and it matches with the other resources I've been using for learning, but how can it can definitively said that it is 16 bits? The <a href=\"https://en.wikipedia.org/wiki/C_data_types\" rel=\"nofollow noreferrer\">C data types</a> page on Wikipedia specifies </p>\n\n<blockquote>\n  <p>short / short int / signed short / signed short int <br>\n  Short signed integer\n  type. <br>Capable of containing at least the [\u221232767, +32767] range; thus,\n  it is <strong>at least</strong> 16 bits in size.</p>\n</blockquote>\n\n<p>So the size of a <code>short</code> could very well be 32 bits according to the C Standard. But who decides what bit sizes are going to be used anyway? I found a <a href=\"https://stackoverflow.com/questions/2331751/does-the-size-of-an-int-depend-on-the-compiler-and-or-processor\">practical explanation</a> here. Specifically, the line:</p>\n\n<blockquote>\n  <p>...it depends on both processors (more specifically, ISA, instruction\n  set architecture, e.g., x86 and x86-64) and compilers including\n  programming model.</p>\n</blockquote>\n\n<p>So it's the ISA then, which makes sense I suppose. This is where I get lost. Taking a look at the <a href=\"https://en.wikipedia.org/wiki/Microsoft_Windows\" rel=\"nofollow noreferrer\">Windows page</a> on Wikipedia, I see this in the side bar:</p>\n\n<blockquote>\n  <p>Platforms \n  ARM, IA-32, Itanium, x86-64, DEC Alpha, MIPS, PowerPC</p>\n</blockquote>\n\n<p>I don't really know what these are but I think these are processors, each which would have an ISA. Maybe Windows supports these platforms because all of them are guaranteed to use 16 bits for an <code>unsigned short</code>? This doesn't sound quite right, but I don't really know enough about this stuff to research any further.</p>\n\n<p>Back to my question: How is it that the Windows API can <code>typedef unsigned short WORD;</code> and then say <code>WORD</code> is a 16-bit unsigned integer when the C Standard itself does not guarantee that a <code>short</code> is always 16 bits?</p>\n"}, {"tags": ["c", "arrays", "pointers", "malloc"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1463599414, "post_id": 37308419, "comment_id": 62138052, "body": "<a href=\"http://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>."}, {"owner": {"reputation": 737, "user_id": 2005732, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7b58a013e1a1a5d6d824502d3f251448?s=128&d=identicon&r=PG", "display_name": "galois", "link": "https://stackoverflow.com/users/2005732/galois"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1463599495, "post_id": 37308419, "comment_id": 62138093, "body": "In Visual Studio, since it&#39;s compiling as C++, I get an error (the build fails) when I don&#39;t cast: <code>error C2440: &#39;=&#39; : cannot convert from &#39;void *&#39; to &#39;int *&#39;</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463599553, "post_id": 37308419, "comment_id": 62138132, "body": "Have you included <code>stdlib</code>?"}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 2, "creation_date": 1463599561, "post_id": 37308419, "comment_id": 62138140, "body": "<code>*arr[i]</code> -&gt; <code>(*arr)[i]</code> because postfix has higher precedence. The former lhs does not make sense in your context."}, {"owner": {"reputation": 737, "user_id": 2005732, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7b58a013e1a1a5d6d824502d3f251448?s=128&d=identicon&r=PG", "display_name": "galois", "link": "https://stackoverflow.com/users/2005732/galois"}, "edited": false, "score": 0, "creation_date": 1463599605, "post_id": 37308419, "comment_id": 62138168, "body": "I have included <code>stdlib</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1463599670, "post_id": 37308419, "comment_id": 62138202, "body": "Anyway, I believe you can force VS to compile it as C. And @GrzegorzSzpetkowski gave you the answer."}, {"owner": {"reputation": 737, "user_id": 2005732, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7b58a013e1a1a5d6d824502d3f251448?s=128&d=identicon&r=PG", "display_name": "galois", "link": "https://stackoverflow.com/users/2005732/galois"}, "reply_to_user": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1463599706, "post_id": 37308419, "comment_id": 62138219, "body": "@GrzegorzSzpetkowski, actually I should have mentioned that I tried that, and the function doesn&#39;t break, but when it returns, the array only has one value."}, {"owner": {"reputation": 737, "user_id": 2005732, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7b58a013e1a1a5d6d824502d3f251448?s=128&d=identicon&r=PG", "display_name": "galois", "link": "https://stackoverflow.com/users/2005732/galois"}, "edited": false, "score": 0, "creation_date": 1463599868, "post_id": 37308419, "comment_id": 62138307, "body": "Edited main post with his advice"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1463600015, "post_id": 37308419, "comment_id": 62138394, "body": "Your function is nonsense anyway. If the size of the allocation you create is random, and you don&#39;t have any way of informing the caller about it, the allocation <i>cannot</i> be safely accessed once the function returns."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463600083, "post_id": 37308419, "comment_id": 62138432, "body": "@jaska How do you know it has one value? You don&#39;t know what was allocated and the items are random."}, {"owner": {"reputation": 737, "user_id": 2005732, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7b58a013e1a1a5d6d824502d3f251448?s=128&d=identicon&r=PG", "display_name": "galois", "link": "https://stackoverflow.com/users/2005732/galois"}, "edited": false, "score": 0, "creation_date": 1463600249, "post_id": 37308419, "comment_id": 62138531, "body": "I&#39;m guessing now that it&#39;s the wrong way to do it, but just by: <code>#define length(x) sizeof(x) &#47; sizeof(x[0])</code>. It works fine for another (statically allocated) array in the calling function."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463600300, "post_id": 37308419, "comment_id": 62138558, "body": "It can work only for static arrays."}, {"owner": {"reputation": 737, "user_id": 2005732, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7b58a013e1a1a5d6d824502d3f251448?s=128&d=identicon&r=PG", "display_name": "galois", "link": "https://stackoverflow.com/users/2005732/galois"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1463600449, "post_id": 37308419, "comment_id": 62138640, "body": "@EOF - okay, but, could you explain why not? How would it be different than doing the same thing in the calling function?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463600517, "post_id": 37308419, "comment_id": 62138677, "body": "In calling function you would have the <code>size</code> variable accessible... Just make it a return value, so the caller knows how large is the array."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1463600597, "post_id": 37308419, "comment_id": 62138721, "body": "@jaska: How does the caller of this function know <i>how many elements it is allowed to access</i>? C doesn&#39;t have bounds-checking, if the caller of this function tries to access an element of the array beyond the end of the allocation, the behavior is <i>undefined</i>."}, {"owner": {"reputation": 737, "user_id": 2005732, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7b58a013e1a1a5d6d824502d3f251448?s=128&d=identicon&r=PG", "display_name": "galois", "link": "https://stackoverflow.com/users/2005732/galois"}, "edited": false, "score": 0, "creation_date": 1463601258, "post_id": 37308419, "comment_id": 62139053, "body": "Gotcha - I see. I updated the post with your suggestion: I changed the function to return the size."}], "answers": [{"tags": [], "owner": {"reputation": 438, "user_id": 3061838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d84ad422475a26a7527bd903b2c3072?s=128&d=identicon&r=PG&f=1", "display_name": "mrtnlrsn", "link": "https://stackoverflow.com/users/3061838/mrtnlrsn"}, "is_accepted": true, "score": 2, "last_activity_date": 1463599947, "creation_date": 1463599947, "answer_id": 37308588, "question_id": 37308419, "link": "https://stackoverflow.com/questions/37308419/passing-pointer-to-function-creating-randomly-sized-array-filled-with-random-i/37308588#37308588", "title": "Passing pointer to function creating (randomly sized) array filled with random integers in C", "body": "<p>Please check operator precence of * and []\n<a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow\">http://en.cppreference.com/w/c/language/operator_precedence</a></p>\n\n<pre><code>*arr[i] = rand() % 1001;\n</code></pre>\n\n<p>means</p>\n\n<pre><code>*(arr[i]) = rand() % 1001;\n</code></pre>\n\n<p>but you want</p>\n\n<pre><code>(*arr)[i] = rand() % 1001;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": false, "score": 0, "last_activity_date": 1463599951, "creation_date": 1463599951, "answer_id": 37308590, "question_id": 37308419, "link": "https://stackoverflow.com/questions/37308419/passing-pointer-to-function-creating-randomly-sized-array-filled-with-random-i/37308590#37308590", "title": "Passing pointer to function creating (randomly sized) array filled with random integers in C", "body": "<p>Only one error is immediately obvious to me: when you initialize the array, you need <code>(*arr)[i] =</code>, not <code>*arr[i] =</code>.</p>\n"}], "owner": {"reputation": 737, "user_id": 2005732, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7b58a013e1a1a5d6d824502d3f251448?s=128&d=identicon&r=PG", "display_name": "galois", "link": "https://stackoverflow.com/users/2005732/galois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 37308588, "answer_count": 2, "score": 0, "last_activity_date": 1463601222, "creation_date": 1463599348, "last_edit_date": 1463601222, "question_id": 37308419, "link": "https://stackoverflow.com/questions/37308419/passing-pointer-to-function-creating-randomly-sized-array-filled-with-random-i", "title": "Passing pointer to function creating (randomly sized) array filled with random integers in C", "body": "<h1>Problem:</h1>\n\n<p>I'm rather sure my issue here is a typical misunderstanding of what's happening with pointers. I'll post what's happening in memory below, because my main goal here is to learn how to debug properly, so this is probably a long post about an otherwise trivial problem.</p>\n\n<p>Here's the code, first:</p>\n\n<pre><code>/*Generate array with 500 to 1000 elements*/\n/*In the calling function, I create something like 'int* x;' and pass '&amp;x'*/\n\nvoid gen_array(int** arr){\n    int size = rand() % (1001 - 500) + 500;\n    int i;\n\n    *arr = (int*) malloc(size*sizeof(int));\n\n    if (*arr == NULL){\n        printf(\"Allocation failed\\n\");\n        exit(1); //I know this is probably bad form\n    }\n\n    //Fill with some random numbers from 1 to 1000\n    for (i = 0; i &lt; size; ++i)\n        *arr[i] = rand() % 1001;\n}\n</code></pre>\n\n<p>It breaks after the first iteration in the <code>for</code> loop (that is, when <code>i==1</code>). I'm not sure if I'm allocating wrong with <code>malloc</code>, or assigning wrong in the loop. </p>\n\n<p>Calling like this:</p>\n\n<pre><code>int* x = NULL; //Tried without '= NULL' as well\ngen_array(&amp;x);\n</code></pre>\n\n<h1>The specific error:</h1>\n\n<pre><code>Unhandled exception at 0x00265E55 in test.exe: 0xC0000005: Access violation writing location 0xCCCCCCCC.\n</code></pre>\n\n<p>This is <em>after</em> a <a href=\"https://blogs.msdn.microsoft.com/davidklinems/2005/07/12/what-is-a-first-chance-exception/\" rel=\"nofollow\">first-chance exception</a> at the exact same place, but they are generated at the same line of code (and on the same iteration during execution).</p>\n\n<hr>\n\n<hr>\n\n<h1>My attempt at analyzing:</h1>\n\n<p>If it helps, here's the (relevant) step-by-step from debugging on one attempt (I'm compiling in Visual Studio). I'd like to know how to use this info to help me debug in the future.</p>\n\n<ul>\n<li>At the start of the calling function, <code>x = 0xcccccccc</code> (<code>0xcccccccc=-842150451</code> seems to be what the compiler uses to fill uninitialized values). After set to <code>NULL</code>, it's equal to <code>0x00000000</code> of course.</li>\n<li>Calling <code>gen_array(int** arr)</code>, since I'm passing a pointer to a pointer, the local 'double pointer' is an address pointing to the NULL pointer: <code>arr=0x0018facc {0x00000000 {???}}</code>. (This is showing the values of what's being pointed to, since the NULL pointer is pointing to nothing, there's <code>???</code>)</li>\n<li>Call to <code>malloc</code>: now <code>arr=0x0018facc {0x00e97048 {-842150451}}</code>, so <code>*arr</code> is pointing to an uninitialized value</li>\n<li>First iteration (<code>i==0</code>), the number generated is <code>588</code>, so now <code>arr=0x0018facc {0x00e97048 {588}}</code> (that is, the value that <code>*arr</code> is pointing at is <code>588</code>)</li>\n</ul>\n\n<p>The next iteration crashes after <code>i</code> is increased to <code>1</code>. Since it's an access violation, I would typically guess that <code>arr+1</code> isn't expecting to be written to. But the violation location is at <code>0xCCCCCCCC</code>, the value that this compiler uses for uninitialized data. Is this because <code>arr+1</code> is technically uninitialized?</p>\n\n<p><strong>Edit:</strong> as @GrzegorzSzpetkowski advised, I tried changing <code>*arr[i]</code> to <code>(*arr)[i]</code>. It stopped breaking! but, no new random values are being created/placed into the array (which is why I'm concerned that an array isn't being created at all).</p>\n\n<p><strong>Edit 2:</strong> To @EOF's suggestion, I changed the function to return the size so I can call with something like <code>int length = gen_array(&amp;x);</code></p>\n\n<hr>\n\n<p>I know I can also try returning an <code>int*</code> from the function, but I'd like to know what's going on specifically here in the case of passing the pointer from a calling function to be initialized.</p>\n"}, {"tags": ["c", "linux", "memory-management", "linux-kernel"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1463596854, "post_id": 37307665, "comment_id": 62136687, "body": "Well, having a look at the crystal ball, I hindsight your machine has some 32 bit signed limit. IOW: See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and follow the advice."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1463598816, "post_id": 37307665, "comment_id": 62137725, "body": "I&#39;d start by looking at <code>ulimit</code>. Also make sure you&#39;re actually compiling for 64-bit, so <code>printf(&quot;%zu&quot;, sizeof(void*))</code> might interesting."}, {"owner": {"reputation": 519, "user_id": 928996, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ew8vD.jpg?s=128&g=1", "display_name": "JC1", "link": "https://stackoverflow.com/users/928996/jc1"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1463634678, "post_id": 37307665, "comment_id": 62149108, "body": "@EOF Yes, I have checked it is compiling in 64 bits. I have pasted the output of <code>ulimit</code> up there, everything seems fine to me."}, {"owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "edited": false, "score": 0, "creation_date": 1463643516, "post_id": 37307665, "comment_id": 62153443, "body": "The problem might not be the total size, but the number of mmap sections. Have you tried to allocate bigger chunks instead?"}], "answers": [{"tags": [], "owner": {"reputation": 311, "user_id": 5091340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OMKue.png?s=128&g=1", "display_name": "yayg", "link": "https://stackoverflow.com/users/5091340/yayg"}, "is_accepted": true, "score": 3, "last_activity_date": 1463647679, "last_edit_date": 1463647679, "creation_date": 1463647300, "answer_id": 37318115, "question_id": 37307665, "link": "https://stackoverflow.com/questions/37307665/mmap-cant-allocate-more-than-2gb-of-contiguous-data/37318115#37318115", "title": "Mmap can&#39;t allocate more than 2GB of contiguous data", "body": "<p>Your are overflowing your <code>base_address</code> with <code>PAGE_SIZE * i</code>.</p>\n\n<p>Thus you are trying to allocate on address near <code>0xffffffff86000000</code>.</p>\n\n<p>Put a long long instead for <code>i</code> and it will work.</p>\n"}], "owner": {"reputation": 519, "user_id": 928996, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ew8vD.jpg?s=128&g=1", "display_name": "JC1", "link": "https://stackoverflow.com/users/928996/jc1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "closed_date": 1463671774, "accepted_answer_id": 37318115, "answer_count": 1, "score": 2, "last_activity_date": 1463647679, "creation_date": 1463596689, "last_edit_date": 1463634451, "question_id": 37307665, "link": "https://stackoverflow.com/questions/37307665/mmap-cant-allocate-more-than-2gb-of-contiguous-data", "closed_reason": "Duplicate", "title": "Mmap can&#39;t allocate more than 2GB of contiguous data", "body": "<p>I am having trouble allocating more than 2GB of contiguous memory with mmap in a 64-bit machine with plenty of memory.\nThe following code happily runs. But when increasing the number of contiguously mmap'ed pages to slightly above 2GB mmap fails in my machine. </p>\n\n<pre><code>#include &lt;sys/mman.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;unistd.h&gt;\n\n#define PAGE_SIZE (4*1024)\n#define START_ADDRESS 0x8000000\n#define START_ADDRESS2 0x800000000\n#define N_ITERATIONS 524288\n\n// one more iteration and mmap fails\n//#define N_ITERATIONS 524289\n\nvoid allocate(void* base_address)\n{\n    int i;\n    for (i = 0; i &lt; N_ITERATIONS; ++i) {\n        void* current_addr = base_address + PAGE_SIZE * i;\n        void* ret = mmap((void*)current_addr, PAGE_SIZE, PROT_EXEC|PROT_READ|PROT_WRITE, \n                MAP_NORESERVE | MAP_FIXED | MAP_PRIVATE|MAP_ANONYMOUS, 0, 0); \n        if (ret == MAP_FAILED) {\n            fprintf(stderr, \"Error mmap. errno: %d\\n\", errno);\n            exit(-1);\n        }   \n        printf(\"%d\\n\", i); \n    }   \n}\n\nint main()\n{\n    allocate((void*)START_ADDRESS);\n    allocate((void*)START_ADDRESS2);\n    return 0;\n}\n</code></pre>\n\n<p>ulimit -a</p>\n\n<pre><code>-t: cpu time (seconds)              unlimited\n-f: file size (blocks)              unlimited\n-d: data seg size (kbytes)          unlimited\n-s: stack size (kbytes)             8192\n-c: core file size (blocks)         unlimited\n-m: resident set size (kbytes)      unlimited\n-u: processes                       515550\n-n: file descriptors                65535\n-l: locked-in-memory size (kbytes)  unlimited\n-v: address space (kbytes)          unlimited\n-x: file locks                      unlimited\n-i: pending signals                 515550\n-q: bytes in POSIX msg queues       819200\n-e: max nice                        0\n-r: max rt priority                 0\n-N 15:                              unlimited\n</code></pre>\n\n<p><strong>What prevents the kernel from allocating more than 2GB of contiguous data?</strong></p>\n"}, {"tags": ["c", "gcc", "stack-overflow", "tail-recursion"], "comments": [{"owner": {"reputation": 1338, "user_id": 1772510, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/507de10a282f571a93a2ad2193b5b9e0?s=128&d=identicon&r=PG", "display_name": "dreadiscool", "link": "https://stackoverflow.com/users/1772510/dreadiscool"}, "edited": false, "score": 0, "creation_date": 1463596593, "post_id": 37307624, "comment_id": 62136545, "body": "Perhaps the correct answer has something to do with tail call recursion. iirc GCC will implement tail call recursion, i.e. optimizing away recursive calls, when possible"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1463596669, "post_id": 37307624, "comment_id": 62136582, "body": "Because the C standard does not require a specific optimisation. (It does not even require using a stack for local variables). And use a correct prototype-style function declarator: <code>main(void)</code>."}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1463596789, "post_id": 37307624, "comment_id": 62136652, "body": "it definitely makes sense to try gcc with different optimization flags and probably some combination will give you infinite loop you want"}, {"owner": {"reputation": 51908, "user_id": 702361, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e2a400cef6dbb94a8777c161d5b43d0c?s=128&d=identicon&r=PG", "display_name": "phoxis", "link": "https://stackoverflow.com/users/702361/phoxis"}, "edited": false, "score": 0, "creation_date": 1463597398, "post_id": 37307624, "comment_id": 62136964, "body": "gcc or g++ ? Then there can be a difference."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 5, "creation_date": 1463597880, "post_id": 37307624, "comment_id": 62137207, "body": "Use <code>-O2</code>, <code>-O3</code>, or <code>-O1 -foptimize-sibling-calls</code>"}, {"owner": {"reputation": 944, "user_id": 2440950, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6b946445be153c07fe8dfcd514e6cd3d?s=128&d=identicon&r=PG", "display_name": "Mark Evans", "link": "https://stackoverflow.com/users/2440950/mark-evans"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1463599819, "post_id": 37307624, "comment_id": 62138282, "body": "@MarkPlotnick It worked! I tried with all optimizations you suggested and it didn&#39;t cause stackoverflow. Why did it cause stackoverflow the first time?"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 1, "creation_date": 1463600504, "post_id": 37307624, "comment_id": 62138666, "body": "gcc doesn&#39;t perform tail recursion optimization by default, possibly because it makes programs harder to debug and unwind after exceptions. So your unoptimized program used up a bit of stack space every time it did a call (<code>callq main</code> followed by <code>push   %rbp</code>), until it reached the limit imposed by the OS. An optimized program would do something like <code>jmp   main</code>. I don&#39;t have gcc on Windows so can&#39;t provide a comprehensive answer, but someone else will do so."}], "answers": [{"tags": [], "owner": {"reputation": 51908, "user_id": 702361, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e2a400cef6dbb94a8777c161d5b43d0c?s=128&d=identicon&r=PG", "display_name": "phoxis", "link": "https://stackoverflow.com/users/702361/phoxis"}, "is_accepted": true, "score": 2, "last_activity_date": 1463648150, "last_edit_date": 1463648150, "creation_date": 1463599279, "answer_id": 37308404, "question_id": 37307624, "link": "https://stackoverflow.com/questions/37307624/why-does-int-main-return-main-cause-stackoverflow-and-not-tail-recursio/37308404#37308404", "title": "Why does int main() { return main(); } cause stackoverflow and not tail recursion?", "body": "<p>The code you have shown will call <code>main</code> infinitely, and therefore will result a stack overflow. This is true in the case of any function and not specific to main. Each function call a stack frame is created in memory, and as infinite such frames is created as the recursion goes deep, you get a stackoverflow.</p>\n\n<p>But if you make a proper base termination like the example as follows, for recursive calls in <code>main</code> then there is an interesting thing.</p>\n\n<pre><code>int main (void)\n{\n  static int x = 100;\n\n  if (x == 0)\n  {\n    return 0;\n  }\n  x--;\n  printf (\"%d\\n\", x);\n  main ();\n  return 0;\n}\n</code></pre>\n\n<p>There is a difference in calling <code>main</code> recursively in C and C++ Language, and I think it is interesting to point that out. Here is a <a href=\"https://phoxis.org/2012/10/06/c-qa-4-calling-main-recursively/\" rel=\"nofollow\">post</a> I wrote, I am giving some explanation about it.</p>\n\n<p>C++ Standards talk about these in</p>\n\n<p>Section 3.6.1 Paragraph 3</p>\n\n<pre><code>Recursive calls are permitted, except to the function named main. \n</code></pre>\n\n<p>and Section 5.2.2 Paragraph 9</p>\n\n<pre><code>The function main shall not be used within the program. \u2026 \u2026 \u2026 \n</code></pre>\n\n<p>I did not find any such restriction in the C standards. What I found about recursive calls in the C99 standards in Section 6.5.2.2 Paragraph 11 is as follows</p>\n\n<pre><code>Recursive function calls shall be permitted, both directly and indirectly through any chain of other functions. \n</code></pre>\n\n<p>Therefore calling main recursively in C Language is deterministic. But as per C++ standards calling main from any function or recursively is not allowed.</p>\n"}], "owner": {"reputation": 944, "user_id": 2440950, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6b946445be153c07fe8dfcd514e6cd3d?s=128&d=identicon&r=PG", "display_name": "Mark Evans", "link": "https://stackoverflow.com/users/2440950/mark-evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 37308404, "answer_count": 1, "score": -6, "last_activity_date": 1463650299, "creation_date": 1463596520, "last_edit_date": 1463650299, "question_id": 37307624, "link": "https://stackoverflow.com/questions/37307624/why-does-int-main-return-main-cause-stackoverflow-and-not-tail-recursio", "title": "Why does int main() { return main(); } cause stackoverflow and not tail recursion?", "body": "<p>Compiled this on Windows using GCC. It crashed immediately with <code>Exception Code:  c00000fd</code>.</p>\n\n<p>Edit : Tried compiling following code (for visible output) and it causes stackoverflow. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main(void)\n{\nprintf(\"Hello World\\n\");\nreturn main();\n}\n</code></pre>\n\n<p>Output - </p>\n\n<pre><code>&gt;gcc trailORoverflow.c -o trailORoverflow.exe\n\nHello World\nHello World\nHello World\nHello World\nHello World\nHello World\n</code></pre>\n\n<p>It keeps printing Hello World for sometime and crashes.</p>\n\n<p>Edit: Didn't crash with <code>O2</code>, <code>O3</code> and <code>-O1 -foptimize-sibling-calls</code> optimizations.</p>\n"}, {"tags": ["c++", "c", "mpi"], "comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 1, "creation_date": 1463601413, "post_id": 37307026, "comment_id": 62139134, "body": "Before diving into the excellent linked question/answer, I would strongly encourage you to familiarize yourself with the basic principles of MPI: independent processes and explicit communication via messages. Think if you can design your application around these principles, or ask if you are stuck."}, {"owner": {"reputation": 331, "user_id": 5565262, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f59e2578cecb7dc62aa09467bc6291a5?s=128&d=identicon&r=PG&f=1", "display_name": "mnmbs", "link": "https://stackoverflow.com/users/5565262/mnmbs"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1463603329, "post_id": 37307026, "comment_id": 62140091, "body": "I am trying to calculate pi in a master-slave like way. The result i am getting is 4 times the expected result as i am using 4 processes and i think that the problem is that the task counter is increased by every process."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1463604928, "post_id": 37307026, "comment_id": 62140863, "body": "There are actually many examples on how to use MPI for computing pi out there."}, {"owner": {"reputation": 331, "user_id": 5565262, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f59e2578cecb7dc62aa09467bc6291a5?s=128&d=identicon&r=PG&f=1", "display_name": "mnmbs", "link": "https://stackoverflow.com/users/5565262/mnmbs"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1463605078, "post_id": 37307026, "comment_id": 62140933, "body": "Yes but not using a master slave and i cannot figure out how to keep the master process out of the calculation and still get the correct result"}], "answers": [{"tags": [], "owner": {"reputation": 1848, "user_id": 2290151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7491ff3c0c23e578432bb1ebd93e2c?s=128&d=identicon&r=PG", "display_name": "renefritze", "link": "https://stackoverflow.com/users/2290151/renefritze"}, "is_accepted": false, "score": 0, "last_activity_date": 1463597096, "creation_date": 1463597096, "answer_id": 37307774, "question_id": 37307026, "link": "https://stackoverflow.com/questions/37307026/mpi-one-counter-for-all-the-process/37307774#37307774", "title": "MPI one counter for all the process", "body": "<p>There is no automatically global counter with MPI. I think you will have to communicate the increments to the counter manually. </p>\n"}], "owner": {"reputation": 331, "user_id": 5565262, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f59e2578cecb7dc62aa09467bc6291a5?s=128&d=identicon&r=PG&f=1", "display_name": "mnmbs", "link": "https://stackoverflow.com/users/5565262/mnmbs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 0, "closed_date": 1463599118, "answer_count": 1, "score": 0, "last_activity_date": 1463598332, "creation_date": 1463594430, "last_edit_date": 1463598332, "question_id": 37307026, "link": "https://stackoverflow.com/questions/37307026/mpi-one-counter-for-all-the-process", "closed_reason": "Duplicate", "title": "MPI one counter for all the process", "body": "<p>I am experimenting with MPI and so far I have this small program that computes a simple sum:</p>\n\n<pre><code>#include &lt;mpi.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[]){\nint i=0, myid, nproc,N=5;\ndouble result=0.0,res;\n\nMPI_Init(&amp;argc, &amp;argv);\nMPI_Comm_rank(MPI_COMM_WORLD, &amp;myid);\nMPI_Comm_size(MPI_COMM_WORLD, &amp;nproc);\n\nMPI_Bcast(&amp;N, 1, MPI_INT, 0, MPI_COMM_WORLD);\n\nwhile (i&lt;N) { \n    result += i;\n    i++;\n\n    printf(\"process %d i %d\\n\",myid,i);\n    MPI_Reduce(&amp;result, &amp;res, 1, MPI_DOUBLE,MPI_SUM, 0, MPI_COMM_WORLD);\n}\nif (myid == 0)\n{\n    printf(\"result = %lf\\n\", res);\n}\nMPI_Finalize();\n\n}\n</code></pre>\n\n<p>Based on the results from the print, I can see that <code>i</code> reaches the limit (5) for every process. How can I configure it to keep something like a global counter so that <code>i</code> reaches the limit only one time for all processes?</p>\n"}, {"tags": ["c", "audio", "wav", "libsndfile"], "comments": [{"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1463594473, "post_id": 37306925, "comment_id": 62135363, "body": "What sample format does the file contain?  They might be floats?"}, {"owner": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "reply_to_user": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1463594551, "post_id": 37306925, "comment_id": 62135414, "body": "I&#39;ll be honest with you, I have no idea how to check that. I converted a simple mp3 to a wav file online and used that as the file. Although, when I try sf_read_float(), my output is all 0&#39;s."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 1, "creation_date": 1463594563, "post_id": 37306925, "comment_id": 62135420, "body": "<a href=\"http://soundfile.sapp.org/doc/WaveFormat/\" rel=\"nofollow noreferrer\">soundfile.sapp.org/doc/WaveFormat</a>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1463595038, "post_id": 37306925, "comment_id": 62135665, "body": "You need to look at the header of the wave file to determine the sample format. From <a href=\"https://en.wikipedia.org/wiki/WAV\" rel=\"nofollow noreferrer\">this</a>: <i>&quot;The format chunk includes information such as the sample encoding, number of bits per channel, the number of channels, the sample rate.&quot;</i> Values in the millions indicate that the samples are 24 bits (or at least your software thinks they&#39;re 24 bits)."}, {"owner": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "edited": false, "score": 0, "creation_date": 1463595263, "post_id": 37306925, "comment_id": 62135786, "body": "I thought SF_INFO had all those properties. Most of the values you listed have been outputted on the first picture. I tried getting the format as well, but I retrieved 65538"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1463595524, "post_id": 37306925, "comment_id": 62135932, "body": "The most important one, number of bits per sample, was not shown. You can sort of guess it based on the file size. What&#39;s your file size in bytes?"}, {"owner": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "edited": false, "score": 0, "creation_date": 1463595708, "post_id": 37306925, "comment_id": 62136026, "body": "It&#39;s 2,506,830 bytes."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1463596453, "post_id": 37306925, "comment_id": 62136464, "body": "Hmm, the <code>num_items</code> is 17,254,656 and the file size is 2,506,830. The only way that can happen is if the file is compressed, e.g. using MP3 compression. I can&#39;t help you with that. The whole point of a WAV file is that it&#39;s uncompressed (usually) and therefore easy to read."}, {"owner": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "edited": false, "score": 0, "creation_date": 1463598725, "post_id": 37306925, "comment_id": 62137678, "body": "I think there was an error on that part. I recomputed the values and got num_items to be 1253376. I&#39;ll update the image again. Turns out multiplying that value by two is almost the file size."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1463600645, "post_id": 37306925, "comment_id": 62138747, "body": "Samples are scaled to the size of the integer with which they are represented. The values represent the density of air molecules at the recording point at each slice of time. They are not in any particular unit of measurement."}], "answers": [{"tags": [], "owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "is_accepted": true, "score": 3, "last_activity_date": 1463602116, "last_edit_date": 1592644375, "creation_date": 1463599365, "answer_id": 37308424, "question_id": 37306925, "link": "https://stackoverflow.com/questions/37306925/values-of-a-wav-file/37308424#37308424", "title": "Values of a wav file", "body": "<p>in <code>limits.h</code> you can probably find two such definitions (among other stuff):</p>\n<pre><code>#define INT_MAX 0x7FFFFFFF\n#define INT_MIN 0x80000000\n</code></pre>\n<p>which correspond to the decimal range between  -2147483648 and 2147483647.</p>\n<p><strong>Libsndfile manual</strong> says:</p>\n<pre><code>sf_count_t  sf_read_int(SNDFILE *sndfile, int *ptr, sf_count_t items);\n</code></pre>\n<p>i.e., reads sound file content into <strong>integer</strong> values pointed to by <code>int *ptr</code>. Whichever value falls between <code>INT_MIN</code> and <code>INT_MAX</code> is a legitimate value. In <code>libsndfile API</code> the data type used by the calling program and the data format of the file do not need to be the same.</p>\n<p>Please also observe there's no such thing as &quot;frequency&quot; in a sound file. Linear PCM files only consist of <strong>raw</strong> sample data preceded by a header, whereas &quot;frequency&quot; is a mathematical abstraction or analysis result.</p>\n<p>This might be of your interest:</p>\n<blockquote>\n<p>When converting between integer PCM formats of differing size (e.g. using sf_read_int() to read a 16 bit PCM encoded WAV file) libsndfile obeys one simple rule:</p>\n<p>Whenever integer data is moved from one sized container to another sized container, the most significant bit in the source container will become the most significant bit in the destination container.</p>\n</blockquote>\n<p>Be sure to thoroughly read the manual, especially when it is clearly written.</p>\n"}], "owner": {"reputation": 475, "user_id": 4447208, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a262c5d77d0917a01602cd0e75238259?s=128&d=identicon&r=PG&f=1", "display_name": "VedhaR", "link": "https://stackoverflow.com/users/4447208/vedhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1073, "favorite_count": 0, "closed_date": 1464300338, "accepted_answer_id": 37308424, "answer_count": 1, "score": 2, "last_activity_date": 1463602116, "creation_date": 1463594074, "last_edit_date": 1463598086, "question_id": 37306925, "link": "https://stackoverflow.com/questions/37306925/values-of-a-wav-file", "closed_reason": "Needs more focus", "title": "Values of a wav file", "body": "<p>In C, I am using the Libsndfile library to help me read the values of a wav file so that I can do some computations to them after. Although, when I get the output of the file, I am not sure what these numbers mean. Why are the numbers in the millions? At first I thought it was Hz, but it did not make sense in my mind. The information regarding the wav file can be seen below. Under that, I am using the function sf_read_int() to write the values into memory.</p>\n\n<p><strong>What does sf_read_int() do?</strong> This was obtained from the api documentation of libsndfile:</p>\n\n<ul>\n<li>The file write items functions write the data in the array pointed to by ptr to the file. The items parameter must be an integer product of the number of channels or an error will occur.</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/oT3wE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oT3wE.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/IacIB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IacIB.png\" alt=\"Suspected values of the wav file\"></a></p>\n\n<p>I decided to plot some of these huge values on a graph, and it looks very similar to what the wav file should look like (If I imported into audacity and zoomed in on a specific location, I would see this). Note that the values shown are not the same values on the graph, I sampled the values at a random point in time. <strong>So I guess the real question is, why are these values so big (in the millions)? And what do they represent? (Are they bytes?)</strong> </p>\n\n<p><a href=\"https://i.stack.imgur.com/8exHh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8exHh.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1463593483, "post_id": 37306752, "comment_id": 62134843, "body": "You have an <i>answer</i>? What?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1463593520, "post_id": 37306752, "comment_id": 62134870, "body": "A question, I guess? Try it."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1463593640, "post_id": 37306752, "comment_id": 62134949, "body": "You may want to learn more about pointers. Take several days to read some good C programming book."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463593839, "post_id": 37306752, "comment_id": 62135064, "body": "It&#39;s  possible later in C99."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1463595583, "post_id": 37306752, "comment_id": 62135967, "body": "There are two Answers and the OP still get downvoted. Why should one bother to Answer if the Question is not proper?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1463595662, "post_id": 37306752, "comment_id": 62135997, "body": "@Michi - To help, maybe...."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1463595738, "post_id": 37306752, "comment_id": 62136042, "body": "@4386427 You are Funny :)))"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1463595910, "post_id": 37306752, "comment_id": 62136133, "body": "@4386427 please see my Comment to Richard&#39;s Answer"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1463596023, "post_id": 37306752, "comment_id": 62136200, "body": "@Michi - agree... that was exactly why I put both in my answer"}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 6, "last_activity_date": 1463595550, "last_edit_date": 1463595550, "creation_date": 1463594276, "answer_id": 37306992, "question_id": 37306752, "link": "https://stackoverflow.com/questions/37306752/is-this-possible-array-in-c/37306992#37306992", "title": "Is this possible? Array in C", "body": "<p>It depends where you have the code.</p>\n\n<p>If it is as global variables like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint var1 = 20;\nint var2 = 200;\nint var20 = 100;\n\nint array[3] = { var1, var2, var20 };\n\nint main(void) {\n\n     return 0;\n}\n</code></pre>\n\n<p>it is illegal because the initializer isn't constant.</p>\n\n<p>If you put it in a function like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    int var1 = 20;\n    int var2 = 200;\n    int var20 = 100;\n\n    int array[3] = { var1, var2, var20 };\n\n    return 0;\n}\n</code></pre>\n\n<p>it is valid code.</p>\n\n<p>If you want you can also build the array from arguments passed to a function. Like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid someFunc(int var1, int var2, int var3)\n{\n    int array[3] = { var1, var2, var3 };\n    for (int i=0; i &lt; 3; ++i)\n    {\n        printf(\"%d\\n\", array[i]);\n    }\n}\n\nint main(void) {\n    int var1 = 20;\n    int var2 = 200;\n    int var20 = 100;\n\n    someFunc(var1, var2, var20);\n\n    return 0;   return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5540253, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10206116275044713/picture?type=large", "display_name": "Nicolas Mozo", "link": "https://stackoverflow.com/users/5540253/nicolas-mozo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "closed_date": 1464295660, "answer_count": 1, "score": -9, "last_activity_date": 1463595550, "creation_date": 1463593424, "last_edit_date": 1463593895, "question_id": 37306752, "link": "https://stackoverflow.com/questions/37306752/is-this-possible-array-in-c", "closed_reason": "Needs details or clarity", "title": "Is this possible? Array in C", "body": "<p>I have a question, can i do this? Store variables in a same array.</p>\n\n<pre><code>int var1 = 20;\nint var2 = 200;\nint var20 = 100;\n\nint array[3] = { var1, var2, var20 };\n\nreturn 0;\n</code></pre>\n"}, {"tags": ["c", "avr", "avr-gcc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463593478, "post_id": 37306493, "comment_id": 62134841, "body": "It&#39;s not clear what is the relation between the numbers in the question..."}, {"owner": {"reputation": 101, "user_id": 5671860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/033652c43201c99e52c6444c208f39e0?s=128&d=identicon&r=PG&f=1", "display_name": "Nollie", "link": "https://stackoverflow.com/users/5671860/nollie"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463593846, "post_id": 37306493, "comment_id": 62135067, "body": "Im doing short circuit tester. I want to know which pins are shorted with which pins. In first iteration I will set only one pin of PORTD to &quot;1&quot; and then check other pins from PORTD if they are &quot;high&quot;. If so, they are shorted with this exact pin that I set as &quot;1&quot; in this iteration. In next iteration I will change pin set as &quot;1&quot; to next pin and check again. If some pins will be &quot;high&quot; I want to mark them again. If not, I want them to remain 0. I need to multiple them by the number of iteration because I need to know which pins are shorted with which pins so they cant be all just 0 or 1."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463593943, "post_id": 37306493, "comment_id": 62135118, "body": "Many words, no clarification. What is the relation between <code>0b00110011</code>, <code>0b10001000</code>, <code>0b01000100</code> and <code>23112311</code>???"}, {"owner": {"reputation": 101, "user_id": 5671860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/033652c43201c99e52c6444c208f39e0?s=128&d=identicon&r=PG&f=1", "display_name": "Nollie", "link": "https://stackoverflow.com/users/5671860/nollie"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463594294, "post_id": 37306493, "comment_id": 62135285, "body": "<code>0b00110011</code> - first loop ( I multiple it *1 and get <code>00110011</code>) ; <code>0b10001000</code> - second loop ( I multiple it *2 and get <code>2002000</code>); <code>0b01000100</code> - third loop (I multiple it *3 and get <code>03000300</code>); After all iterations I want to &quot;sum&quot; numbers to get output - <code>23112311</code>"}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463670135, "post_id": 37307157, "comment_id": 62173271, "body": "Would be really nice if the downvoter commented their view."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 0, "last_activity_date": 1463594869, "creation_date": 1463594869, "answer_id": 37307157, "question_id": 37306493, "link": "https://stackoverflow.com/questions/37306493/remember-the-iteration-when-a-condition-was-met/37307157#37307157", "title": "Remember the iteration when a condition was met", "body": "<p>Although the idea looks awkward to me, the requirement can be fulfilled using the following code:</p>\n\n<pre><code>char arr[]=\"00000000\";\nuint8_t p;\n\nfor (i=1; i&lt;=ITERATIONS; i++)\n{\n    p = PIND;\n    for (j=0; j&lt;8; j++)\n    {\n        if ( (p &gt;&gt; j) &amp; 1) // Check the `j`s bit\n        {\n            arr[j] = i + '0'; // Convert number `i` into a char representing it\n        }\n    }\n}\n</code></pre>\n\n<p>** You might want to reverse the order array is written..</p>\n"}, {"tags": [], "owner": {"reputation": 7997, "user_id": 66363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dd2a69d2d8c93796e3f4a55d70db00d?s=128&d=identicon&r=PG", "display_name": "uncleO", "link": "https://stackoverflow.com/users/66363/uncleo"}, "is_accepted": false, "score": 0, "last_activity_date": 1463620049, "last_edit_date": 1463620049, "creation_date": 1463619555, "answer_id": 37312298, "question_id": 37306493, "link": "https://stackoverflow.com/questions/37306493/remember-the-iteration-when-a-condition-was-met/37312298#37312298", "title": "Remember the iteration when a condition was met", "body": "<pre><code>int shorted[8] = {0}; // hold results    \nint i, pin = 0, iter = 1;\n\nwhile(pin &lt; 8)\n{\n    PORTD = 1 &lt;&lt; pin;\n\n    // find all the pins that are shorted to the pin on this iteration\n    for(i = 0; i &lt; 8; ++i)\n    {\n         if(PIND &amp; (1 &lt;&lt; i))\n         {\n              shorted[i] = iter;\n         }\n    }\n\n    // Look for the next pin never shorted. Break while loop if all are done\n    pin = 8;\n    for(i = 0; i &lt; 8; ++i)\n    {\n         if(shorted[i] == 0)\n         {\n             pin = i;\n             break;\n         }\n    }  \n\n    ++iter;\n}    \n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 5671860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/033652c43201c99e52c6444c208f39e0?s=128&d=identicon&r=PG&f=1", "display_name": "Nollie", "link": "https://stackoverflow.com/users/5671860/nollie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1463620049, "creation_date": 1463592632, "last_edit_date": 1463599559, "question_id": 37306493, "link": "https://stackoverflow.com/questions/37306493/remember-the-iteration-when-a-condition-was-met", "title": "Remember the iteration when a condition was met", "body": "<p>I'm working on AtMega8 in Eclipse.</p>\n\n<p>In a for loop I want to check if pins of <code>PIND</code> are <code>1</code>. If so I want to have a char array of pins that were <code>1</code> in a certain iteration with the number of that iteration. </p>\n\n<p>If some pin of <code>PIND</code> was <code>1</code> in a certain iteration, it will not be <code>1</code> in any other iteration.</p>\n\n<p>For example:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>1. PIND = 0b00110011\n2. PIND = 0b10001000\n3. PIND = 0b01000100\nResult      23112311\n</code></pre>\n"}, {"tags": ["python", "c", "swig", "handle", "void-pointers"], "comments": [{"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1463598482, "post_id": 37306096, "comment_id": 62137536, "body": "What is your question?"}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "reply_to_user": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1463598662, "post_id": 37306096, "comment_id": 62137645, "body": "@Rob\u1d69  I am trying to figure out the typemap for the hmod input such that run_module will work.  Currently it does not."}, {"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1463599086, "post_id": 37306096, "comment_id": 62137864, "body": "I gathered as much. But I still don&#39;t see a question. Do you have a specific question?"}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "reply_to_user": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1463602026, "post_id": 37306096, "comment_id": 62139433, "body": "I seem to be able to load with load_library (no errors, and something seems to be there) but when running get_api, it things the input is null."}], "answers": [{"comments": [{"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1463599729, "post_id": 37308401, "comment_id": 62138233, "body": "OK, trying this out -- I hope it will be this easy."}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1463600609, "post_id": 37308401, "comment_id": 62138729, "body": "OK, I think I see the current problem.  Since my actual pointer is an HMODULE, my load_module needs to be defined to return that in both instances.  It stores it OK as a PyObject in Python, but when it comes time to send it back, it is not read, or read as null."}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1463600722, "post_id": 37308401, "comment_id": 62138785, "body": "Type returned is &lt;class &#39;SwigPyObject&#39;&gt;"}, {"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "reply_to_user": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 1, "creation_date": 1463601648, "post_id": 37308401, "comment_id": 62139250, "body": "Can you provide a short, complete example, including the actual and expected output? Please post that example into your question. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for more info."}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1463604048, "post_id": 37308401, "comment_id": 62140425, "body": "Shoot.  It seems to be the string name input.  LoadLibrary isn&#39;t working, which is why the null is there.  So I gotta check that...."}, {"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "reply_to_user": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1463739391, "post_id": 37308401, "comment_id": 62204518, "body": "@jim Once someone has taken the time to answer your question please don&#39;t edit it into a completely different one that makes their efforts wasted."}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1463750491, "post_id": 37308401, "comment_id": 62211814, "body": "It ended up being a completely different problem.  I didn&#39;t remove the answer."}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "edited": false, "score": 0, "creation_date": 1463750932, "post_id": 37308401, "comment_id": 62212166, "body": "I thought the real problem was worth noting -- I&#39;d have liked to have seen it 24 hours ago!  I meant no disrespect to Robphi."}], "tags": [], "owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "is_accepted": true, "score": 2, "last_activity_date": 1463599267, "creation_date": 1463599267, "answer_id": 37308401, "question_id": 37306096, "link": "https://stackoverflow.com/questions/37306096/swig-python-passing-pointer-into-function/37308401#37308401", "title": "SWIG/Python: Passing pointer into function", "body": "<p>Swig supports that usage directly, with no typemaps required.</p>\n\n<p>One way to get your code snippet to work is as follows:</p>\n\n<pre><code>/* File : example.c */\n\nvoid *\nload_module(const char* name)\n{\n    static int module_handle = 12;\n    printf(\"Hoory, loaded %s\\n\", name);\n    return &amp;module_handle;\n}\nvoid\nexample_run_module(void* handle, int par1, int par2)\n{\n    printf(\"Yay! Running module %d: %d %d\\n\",\n        *(int*)handle, par1, par2);\n}\n</code></pre>\n\n<p>&nbsp;</p>\n\n<pre><code>/* example.i */\n%module example\n%{\nvoid * load_module(const char* name);\nvoid example_run_module(void* handle, int par1, int par2);\n%}  \n\nvoid * load_module(const char* name);\nvoid example_run_module(void* handle, int par1, int par2);\n</code></pre>\n\n<p>&nbsp;</p>\n\n<pre><code># SConscript\nImport('env')\nenv.Replace(SWIGFLAGS=['-python'])\nenv.ParseConfig('/usr/bin/python-config --cflags --ldflags')\nlib = env.SharedLibrary('_example.so', ['example.c', 'example.i'])\nenv.Clean(lib, 'example.pyc')\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>In [5]: import example\n\nIn [6]: example.load_module(\"hayhay\")\nHoory, loaded hayhay\nOut[6]: &lt;Swig Object of type 'void *' at 0x7f18cca05180&gt;\n\nIn [7]: import example\n\nIn [8]: x=example.load_module(\"hayhay\")\nHoory, loaded hayhay\n\nIn [9]: example.example_run_module(x, 3, 4)\nYay! Running module 12: 3 4\n</code></pre>\n"}], "owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1521, "favorite_count": 0, "accepted_answer_id": 37308401, "answer_count": 1, "score": -2, "last_activity_date": 1463750738, "creation_date": 1463591361, "last_edit_date": 1495539845, "question_id": 37306096, "link": "https://stackoverflow.com/questions/37306096/swig-python-passing-pointer-into-function", "title": "SWIG/Python: Passing pointer into function", "body": "<p>I basically want to do exactly this:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/15216447/swig-how-to-pass-void-into-generic-function\">swig: how to pass void* into generic function</a></p>\n\n<p>I seem to be able to get a value that Python can hold, but when I pass it back in, it is deemed null and causes a fail.  So I'm thinking I need some kind of PyObject conversion.  I don't know why void pointers should be so hard to handle.</p>\n\n<p>(I'm actually working with HMODULE, but I think if I can get void pointers to work, I can get them to work as well.</p>\n\n<p>Basically, I just want to:</p>\n\n<pre><code>&gt;&gt;hmod = example.load_module(\"fooModName\")\n&gt;&gt;example.run_module(hmod, par1, par2)\n</code></pre>\n\n<p>How do I define the input and output typemaps such that these two calls can be supported?</p>\n\n<p>I am trying to work with HMODULE  (defined in Windows.h , eventually as a void pointer)</p>\n\n<pre><code>HMODULE load_library(char *pathDLL);\nint     get_api(HMODULE dll);   // loads/updates api\n</code></pre>\n\n<p>===========================================================</p>\n\n<p>I have figured out my actual problem.</p>\n\n<p>My routines when wrapped would be:</p>\n\n<pre><code>&gt;&gt;ModuleName = example.find_module_name(\"lookDir\")\n&gt;&gt;HModule = example.load_module(ModuleName)\n</code></pre>\n\n<p>The problem is that the returned name is a char string (char *) but the LoadLibrary() MSDN routine needs a LPCWSTR. I can readily convert the string within the routine, but that breaks it for other use, so I'd really like to convert the string within an input wrapper.</p>\n\n<p>I think the solution is a typemap of some sort.</p>\n\n<p>I am trying this:</p>\n\n<pre><code>%typemap(in) char* inpathDLL {\nstatic wchar_t LpathDLL[2048];\nMultiByteToWideChar(CP_ACP, 0, $input, -1, LpathDLL, 2048);\n$1 = LpathDLL;\n}\n</code></pre>\n\n<p>This is failing. It seems to thing the input is a python string object, so I somehow have to get it to convert it to a char * before applying the next conversion.</p>\n\n<p>How do I get this input string converted?</p>\n\n<p>ANSWER:</p>\n\n<p>OK, I found a (the?) fix. The trick is to use 'check' which adds code after the default conversion:</p>\n\n<pre><code>%typemap(check)char* inpathDLL {\n  if ($1 != NULL) {\n    static wchar_t LpathDLL[2048];\n    MultiByteToWideChar(CP_ACP, 0, $1, -1, LpathDLL, 2048);\n    $1 = (char *)LpathDLL;\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "web-services", "server", "client", "recv"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1463592143, "post_id": 37306061, "comment_id": 62134107, "body": "You&#39;re probably missing the NUL terminator. You need to get the count from <code>recv</code>, and use that to add the NUL. Also, if you&#39;re using TCP, <code>recv</code> may not get the whole message in a single call. So you need some way to know when the whole message has been received, e.g. send the length first, or send the NUL as part of the message."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1463592145, "post_id": 37306061, "comment_id": 62134108, "body": "recv() returns a value.  You must handle that value correctly and completely.  Essentially, what @user3386109 says above."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1463592366, "post_id": 37306061, "comment_id": 62134234, "body": "&#39;The definitions of two variables both char array&#39; yes, but not null-terminated!  Nearly all C network code posted here has this same problem of being unable to handle C-syle null-terminated char arrays correctly:(("}, {"owner": {"reputation": 805, "user_id": 3857473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fef4a561dd16de766dce81f87f345e74?s=128&d=identicon&r=PG&f=1", "display_name": "Vikash Kesarwani", "link": "https://stackoverflow.com/users/3857473/vikash-kesarwani"}, "edited": false, "score": 0, "creation_date": 1463593311, "post_id": 37306061, "comment_id": 62134746, "body": "Try to print to <code>server_reply</code> and check if it is a valid path"}, {"owner": {"reputation": 366, "user_id": 2364220, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/751833858/picture?type=large", "display_name": "Emel Uras", "link": "https://stackoverflow.com/users/2364220/emel-uras"}, "edited": false, "score": 0, "creation_date": 1463594925, "post_id": 37306061, "comment_id": 62135615, "body": "i print both path and server_reply they are the same and correct path"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1463599635, "post_id": 37306061, "comment_id": 62138182, "body": "If the are the same, they would behave the same.  They don&#39;t behave the same, so they are not the same.  Doesn&#39;t matter what you see when you print stuff, only the char values between the start of the array and the first nul char matter to the file open call.  The recv() call loads some number of bytes between 1 and 2000 into your &#39;server_reply&#39; array and returns the exact number loaded, irrespective of whether those bytes can be printed or end in a null.  YOU have to ensure that the TCP octet/byte stream gets parsed into a valid path specification with its null terminator."}, {"owner": {"reputation": 366, "user_id": 2364220, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/751833858/picture?type=large", "display_name": "Emel Uras", "link": "https://stackoverflow.com/users/2364220/emel-uras"}, "edited": false, "score": 0, "creation_date": 1463600214, "post_id": 37306061, "comment_id": 62138511, "body": "Thanks a lot, i focused on solving null-terminated char array. I am using telnet as client, is it possible to send non null-terminated string or do i have to handle it after receiving it?"}], "answers": [{"tags": [], "owner": {"reputation": 531, "user_id": 4066038, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/90268512e8c68063cb7b0ccecc05081d?s=128&d=identicon&r=PG&f=1", "display_name": "deadbeef", "link": "https://stackoverflow.com/users/4066038/deadbeef"}, "is_accepted": false, "score": 0, "last_activity_date": 1463593285, "creation_date": 1463593285, "answer_id": 37306698, "question_id": 37306061, "link": "https://stackoverflow.com/questions/37306061/how-to-use-revieced-message-from-client-as-file-path-in-server-side-in-c/37306698#37306698", "title": "How to use revieced message from client as file path in server side in C?", "body": "<p>I would like to give following recommendations.</p>\n\n<p>1) make sure you receive absolute path.</p>\n\n<p>2)From client make sure you send a null terminated string.</p>\n\n<p>3) Try to use udp protocol, to get complete information in one shot/ or use your own protocol over tcp(say you encode string length and type(tlv encoding))</p>\n"}, {"tags": [], "owner": {"reputation": 3543, "user_id": 6329118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a20c0ed8a82fd967952e2539203af9?s=128&d=identicon&r=PG&f=1", "display_name": "CWLiu", "link": "https://stackoverflow.com/users/6329118/cwliu"}, "is_accepted": false, "score": 0, "last_activity_date": 1463624717, "creation_date": 1463624717, "answer_id": 37312944, "question_id": 37306061, "link": "https://stackoverflow.com/questions/37306061/how-to-use-revieced-message-from-client-as-file-path-in-server-side-in-c/37312944#37312944", "title": "How to use revieced message from client as file path in server side in C?", "body": "<p>Make sure the file <code>server_reply</code> exists first. <code>fopen()</code> will return NULL if the pointed file path does not exist. It's a simple way to check if the file exists:</p>\n\n<pre><code>FILE* fptr = fopen(filename, \"r\");\nif (fptr != NULL)\n{\n    fclose(fptr);\n    printf(\"File exists\\n\");\n} else {\n    printf(\"File doesnt exist\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 366, "user_id": 2364220, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/751833858/picture?type=large", "display_name": "Emel Uras", "link": "https://stackoverflow.com/users/2364220/emel-uras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1463624717, "creation_date": 1463591249, "question_id": 37306061, "link": "https://stackoverflow.com/questions/37306061/how-to-use-revieced-message-from-client-as-file-path-in-server-side-in-c", "title": "How to use revieced message from client as file path in server side in C?", "body": "<p>I am trying to write a server app in C that gets file path from client and sends the file content back to the client. When i receive the client message and try to use as file path, file becomes NULL and it can not be read.</p>\n\n<pre><code>char server_reply[2000];\nif( recv(sock , server_reply , 2000 , 0) &lt; 0)\n    {\n        puts(\"recv failed\");\n       break;\n    }\n\nFILE *fp = fopen(server_reply,\"rb\");\n\n    if(fp==NULL)\n    {\n        printf(\"File open error\");\n        return 1;\n    }\n</code></pre>\n\n<p>I test my code getting file path via scanf and it works.</p>\n\n<pre><code>char path[2000];\nprintf(\"Enter path : \");\nscanf(\"%s\" , path);\n\nFILE *fp = fopen(path,\"rb\");\n\nif(fp==NULL)\n   {\n      printf(\"File open error\");\n      return 1;\n   }\n</code></pre>\n\n<p>i couldn't figure out what is the difference between server_reply and path. The definitions of two variables both char array. I will appreciate if i can get any clue about it, thanks.</p>\n"}, {"tags": ["c", "performance", "x86"], "comments": [{"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1463591236, "post_id": 37306000, "comment_id": 62133570, "body": "Type-casting is mostly done during compilation-time (not sure about fixed-point to floating-point and vice-versa, but most definitely for pointer types), so there are no runtime implications whatsoever."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463591634, "post_id": 37306000, "comment_id": 62133820, "body": "Common sense suggests that conversion to/from floating point should take some CPU cycles..."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1463591746, "post_id": 37306000, "comment_id": 62133877, "body": "@iharob: You deleted your answer, so I will refer to your last comment here. Floating-point types are typically represented in IEEE-754 format (not sure whether or not the C-language standard dictates that). For example, 4.0 and 4 are potentially represented with &quot;completely different bits&quot;. So casting between them mandates some sort of operation that would be executed during runtime."}, {"owner": {"reputation": 531, "user_id": 4066038, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/90268512e8c68063cb7b0ccecc05081d?s=128&d=identicon&r=PG&f=1", "display_name": "deadbeef", "link": "https://stackoverflow.com/users/4066038/deadbeef"}, "edited": false, "score": 0, "creation_date": 1463591784, "post_id": 37306000, "comment_id": 62133904, "body": "Think in terms of assembly also, for example in x86, uint16_t assigned to to uint32_t. Now I vaguely remember, the move instruction need to zero the upper 2 bytes. What about that overhead?."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463591843, "post_id": 37306000, "comment_id": 62133935, "body": "Moreover, with signed integral types it might involve sign extension.."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1463591885, "post_id": 37306000, "comment_id": 62133962, "body": "@deadbeef: OP asks about pointer-type casting. Those cannot possibly be different in size."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 1, "creation_date": 1463592022, "post_id": 37306000, "comment_id": 62134035, "body": "@barakmanos Pointers to different types <i>are not restricted</i> to be equal size."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463592079, "post_id": 37306000, "comment_id": 62134074, "body": "@EugeneSh.: By language standard or in practice (and if in practice, then could you say what platform)?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1463592164, "post_id": 37306000, "comment_id": 62134121, "body": "@barakmanos By the standard - definitely. And I am pretty sure I&#39;ve heard about a specific platform. Let me see if I can find it."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1463592329, "post_id": 37306000, "comment_id": 62134213, "body": "@barakmanos Take a look <a href=\"http://www.techanswering.com/question/show/are-there-any-platforms-where-pointers-to-different-types-have-different-sizes\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463592542, "post_id": 37306000, "comment_id": 62134330, "body": "@EugeneSh.: This, in conjunction with the notion that casting to a bigger type requires an additional runtime operation (padding with zeros), could serve as a very good answer IMO."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 1, "creation_date": 1463592762, "post_id": 37306000, "comment_id": 62134450, "body": "@barakmanos If you can consolidate it into an answer - the community will be thankful :) I am too lazy.."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1463593540, "post_id": 37306000, "comment_id": 62134884, "body": "<i>I tend to typecast lot of times mostly to avoid compiler warning.</i>  You&#39;re doing it wrong.  That&#39;s just papering over real problems.  Think about it like this:  the people who wrote the compiler you&#39;re using to turn your source code into a runnable binary <i>took extra time to tell you they think what you&#39;re doing is dodgy</i>.  Don&#39;t ignore that - they know a lot more about turning code into a running binary than you do."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1463596120, "post_id": 37306000, "comment_id": 62136262, "body": "This is not a matter of performance, but letting the compiler help you find errors. Thus: <b>only</b> typecast iff 1) There is no other way - considering all aspects, <b>and</b> 2) You fully understand <i>all</i> implications <b>and</b> 3) You completely accept them."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 18, "last_activity_date": 1463605670, "last_edit_date": 1463605670, "creation_date": 1463594936, "answer_id": 37307174, "question_id": 37306000, "link": "https://stackoverflow.com/questions/37306000/performance-overhead-of-typecasting-variables-in-c/37307174#37307174", "title": "performance overhead of typecasting variables in C", "body": "<blockquote>\n  <p>Does [casting] have any implications on performance?</p>\n</blockquote>\n\n<p>Not directly.  A type cast expresses an explicit <em>conversion</em> of a value from one data type to another.  It is really the conversion that has the potential for a performance impact, and if such a conversion is going to be performed whether you cast or not, then the cast has no performance impact whatever.</p>\n\n<p>For example, some compilers can be set to warn about implicit conversions from floating-point types to integer types, and often these warnings can be silenced by making the conversion explicit with a cast.  That does not change the fact that a conversion will be performed, and that such conversions are not free, but the cast doesn't make the conversion any more expensive than it otherwise would be.</p>\n\n<p>Additionally, some conversions can be implemented for free.  For example, on most machines, signed and unsigned integer types with of the same width have compatible representations, so converting values between these types is a no-op.  Casts that only add or remove type qualifiers other than <code>_Atomic</code> are also in this category.</p>\n\n<p>With regard to your specific examples:</p>\n\n<blockquote>\n  <p>1) <code>struct X *</code> pass to a function which takes <code>void *</code></p>\n</blockquote>\n\n<p>C does not require compatible representations for different pointer types, but in practice it is rare these days for different object pointer types to have different representations.  Therefore, conversions between pointer types are usually free.  That hardly matters, however, because the specific case you ask about is one in which the conversion will be performed whether you insert an explicit cast or not.</p>\n\n<blockquote>\n  <p>2) <code>uint16_t</code> typecasted to <code>uint32_t</code></p>\n</blockquote>\n\n<p>This may be free, depending on specific circumstances and compiler implementation.  For example, if the value being converted was already being held in a 32-bit register, then it is a no-op.  Additionally, the compiler might be able to implement it as a no-op in the specific expression in which it appears.  Note also that if <code>uint32_t</code> is the same as <code>unsigned int</code>, as is common, then C semantics require this particular conversion to be performed <em>routinely</em> in the evaluation of arithmetic expressions, so many of these fall into the category of conversions that will happen whether you cast or not.</p>\n"}], "owner": {"reputation": 531, "user_id": 4066038, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/90268512e8c68063cb7b0ccecc05081d?s=128&d=identicon&r=PG&f=1", "display_name": "deadbeef", "link": "https://stackoverflow.com/users/4066038/deadbeef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3955, "favorite_count": 2, "closed_date": 1463683342, "answer_count": 1, "score": 12, "last_activity_date": 1463605670, "creation_date": 1463591089, "question_id": 37306000, "link": "https://stackoverflow.com/questions/37306000/performance-overhead-of-typecasting-variables-in-c", "closed_reason": "Needs more focus", "title": "performance overhead of typecasting variables in C", "body": "<p>I have seen people recommending to avoid typecasting of variables as much as possible in high performing applications. I never understood the reason for this and I tend to typecast lot of times mostly to avoid compiler warning. Does this have any implications on performance?.\nCommonly seen code:</p>\n\n<p>1) <code>struct X *</code> pass to a function which takes <code>void *</code></p>\n\n<p>2)<code>uint16_t</code> typecasted to <code>uint32_t</code> </p>\n"}, {"tags": ["c", "vhdl"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1463591461, "post_id": 37305863, "comment_id": 62133714, "body": "Short answer: you can&#39;t. About all you can do is launch a simulation using the <code>system</code> function, or you could <code>fork</code> and <code>exec</code> a simulation. This assumes, of course, that you have a command-line-driven simulator on your system."}, {"owner": {"reputation": 13176, "user_id": 3719459, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sBD6F.jpg?s=128&g=1", "display_name": "Paebbels", "link": "https://stackoverflow.com/users/3719459/paebbels"}, "edited": false, "score": 1, "creation_date": 1463591827, "post_id": 37305863, "comment_id": 62133920, "body": "Why do you want to call a C function from VHDL? VHDL is no programming language ... If you are looking for the VHPI interface, which allows you to bind external sub programs to the simulator and interact with your hardware model, then please clarify your question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6352271"}, "edited": false, "score": 0, "creation_date": 1463592012, "post_id": 37305863, "comment_id": 62134029, "body": "can i include the VHDL code i want to implement  in a device driver.Using a tool like xilinx XPS  a device driver can be made and the  bitstream can be downloaded to an FPGA to make the hardware configurations .So in the end the C files will  run in the microblaze and the VHDL  implementation will be  in the FPGA as device driver.Can i call the driver then to the C file? because what i wanna do is to implement part of a C code in VHDL the rest of course in C and offload it to an FPGA and check whether the latency is reduced."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6352271"}, "edited": false, "score": 0, "creation_date": 1463592344, "post_id": 37305863, "comment_id": 62134223, "body": "what  i wanna do is to implement part of the pppd source code in VHDL and keep the rest in C as it is and put the whole thing to an FPGA and check whether the latency is reduced"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1463593613, "post_id": 37305863, "comment_id": 62134934, "body": "@Deepal Yes, if the C code is running on the FPGA, then you can certainly use VHDL to design the rest of the FPGA. You&#39;ll need to define a set of registers that the C code uses to send/retrieve information to/from the hardware. Typically, those are memory mapped registers, but I don&#39;t have any detailed information about how that works with the MicroBlaze architecture."}, {"owner": {"reputation": 12041, "user_id": 5900011, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TOH6T.jpg?s=128&g=1", "display_name": "Matthew Taylor", "link": "https://stackoverflow.com/users/5900011/matthew-taylor"}, "reply_to_user": {"reputation": 13176, "user_id": 3719459, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sBD6F.jpg?s=128&g=1", "display_name": "Paebbels", "link": "https://stackoverflow.com/users/3719459/paebbels"}, "edited": false, "score": 0, "creation_date": 1463598317, "post_id": 37305863, "comment_id": 62137444, "body": "@Paebbels I have to disagree. Your design is hardware, no question, but I would say (and teach) that your testbench is software (it never leaves your computer). Look at SystemVerilog: the majority of that language has nothing to do with hardware (eg OO for a start). There are many reasons to call a C function from your testbench: you have a reference model in C; you want better file I/O; you want to interact with the OS; you want graphical output... Look again at SystemVerilog: it&#39;s very easy to call C from SystemVerilog; it&#39;s pretty easy to call SystemVerilog functions and tasks from C."}, {"owner": {"reputation": 13176, "user_id": 3719459, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sBD6F.jpg?s=128&g=1", "display_name": "Paebbels", "link": "https://stackoverflow.com/users/3719459/paebbels"}, "reply_to_user": {"reputation": 12041, "user_id": 5900011, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TOH6T.jpg?s=128&g=1", "display_name": "Matthew Taylor", "link": "https://stackoverflow.com/users/5900011/matthew-taylor"}, "edited": false, "score": 0, "creation_date": 1463606283, "post_id": 37305863, "comment_id": 62141528, "body": "@MatthewTaylor I know that, but VHDL is no general purpose programming language and the question is pointing in the direction of using VHDL like C... The second part of my comment focuses on testbench use cases ;)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6352271"}, "reply_to_user": {"reputation": 12041, "user_id": 5900011, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TOH6T.jpg?s=128&g=1", "display_name": "Matthew Taylor", "link": "https://stackoverflow.com/users/5900011/matthew-taylor"}, "edited": false, "score": 0, "creation_date": 1463646276, "post_id": 37305863, "comment_id": 62155196, "body": "@Matthew Taylor -any document that has simple examples of SystemVerilog functions being called from C would be helpful."}, {"owner": {"reputation": 12041, "user_id": 5900011, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TOH6T.jpg?s=128&g=1", "display_name": "Matthew Taylor", "link": "https://stackoverflow.com/users/5900011/matthew-taylor"}, "edited": false, "score": 0, "creation_date": 1463647989, "post_id": 37305863, "comment_id": 62156408, "body": "We can only comment now, because 5 people WHO APPEAR TO HAVE NO KNOWLEDGE OF THE SUBJECT have deemed it &quot;too broad&quot;. You can call C functions from SystemVerilog using the DPI: you need to <code>import</code> your C function: If you do that, you can <code>export</code> any SystemVerilog function or task and can call that from the C function you imported (which must be imported using <code>context</code>). Here&#39;s a <a href=\"https://www.doulos.com/knowhow/sysverilog/tutorial/dpi/\" rel=\"nofollow noreferrer\">document</a>."}, {"owner": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "edited": false, "score": 1, "creation_date": 1463654536, "post_id": 37305863, "comment_id": 62161077, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/30926630/using-c-programming-to-call-vhdl-implementation\" title=\"using c programming to call vhdl implementation\">stackoverflow.com/questions/30926630/&hellip;</a>"}, {"owner": {"reputation": 12041, "user_id": 5900011, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TOH6T.jpg?s=128&g=1", "display_name": "Matthew Taylor", "link": "https://stackoverflow.com/users/5900011/matthew-taylor"}, "edited": false, "score": 0, "creation_date": 1463658869, "post_id": 37305863, "comment_id": 62164121, "body": "Your extra edit suggests you have a fundamental misunderstanding about what is going on here (and we had a fundamental misunderstanding of what you were asking and why). I suggest you look at the duplicate linked above."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6352271"}, "edited": false, "score": 0, "creation_date": 1463681004, "post_id": 37305863, "comment_id": 62180188, "body": "Yeah thankx got it"}], "answers": [{"comments": [{"owner": {"reputation": 13176, "user_id": 3719459, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sBD6F.jpg?s=128&g=1", "display_name": "Paebbels", "link": "https://stackoverflow.com/users/3719459/paebbels"}, "edited": false, "score": 1, "creation_date": 1463606392, "post_id": 37306683, "comment_id": 62141580, "body": "Are you experienced in VHPI? The IEEE P1076 working group seeks for knowledge in extending VHPI..."}, {"owner": {"reputation": 1074, "user_id": 4367824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc0e0b1a6eb622c2e02ea583e04bb68?s=128&d=identicon&r=PG&f=1", "display_name": "PlayDough", "link": "https://stackoverflow.com/users/4367824/playdough"}, "reply_to_user": {"reputation": 13176, "user_id": 3719459, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sBD6F.jpg?s=128&g=1", "display_name": "Paebbels", "link": "https://stackoverflow.com/users/3719459/paebbels"}, "edited": false, "score": 0, "creation_date": 1463642478, "post_id": 37306683, "comment_id": 62152768, "body": "@Paebbels I do.  In fact, prior to cocotb, I had implemented an internal tool for my company to integrate Python (and optionally Lua) into VHDL testbenches.  But as I pointed out in my answer (which somebody strangely downvoted), there was no way to call into VHDL from a foreign language.  Rather, the workaround was to register foreign subprograms and certain callbacks.   There is no VHPI method to invoke a subprogram."}, {"owner": {"reputation": 12041, "user_id": 5900011, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TOH6T.jpg?s=128&g=1", "display_name": "Matthew Taylor", "link": "https://stackoverflow.com/users/5900011/matthew-taylor"}, "edited": false, "score": 0, "creation_date": 1463646932, "post_id": 37306683, "comment_id": 62155667, "body": "@PlayDough I have been trying to contact the man responsible for cocotb re upgrading the version on EDA Playground following a request for me to do so, but since the initial request have received no further replies."}, {"owner": {"reputation": 1074, "user_id": 4367824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc0e0b1a6eb622c2e02ea583e04bb68?s=128&d=identicon&r=PG&f=1", "display_name": "PlayDough", "link": "https://stackoverflow.com/users/4367824/playdough"}, "reply_to_user": {"reputation": 12041, "user_id": 5900011, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TOH6T.jpg?s=128&g=1", "display_name": "Matthew Taylor", "link": "https://stackoverflow.com/users/5900011/matthew-taylor"}, "edited": false, "score": 0, "creation_date": 1463682234, "post_id": 37306683, "comment_id": 62180920, "body": "@MatthewTaylor I think previous comment was unclear. I am not affiliated with cocotb.  What I meant to say was &quot;Prior to somebody creating cocotb, I had implemented ....&quot;  I don&#39;t have any knowledge of the state of cocotb or its maintenance."}], "tags": [], "owner": {"reputation": 1074, "user_id": 4367824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc0e0b1a6eb622c2e02ea583e04bb68?s=128&d=identicon&r=PG&f=1", "display_name": "PlayDough", "link": "https://stackoverflow.com/users/4367824/playdough"}, "is_accepted": false, "score": 1, "last_activity_date": 1463593224, "creation_date": 1463593224, "answer_id": 37306683, "question_id": 37305863, "link": "https://stackoverflow.com/questions/37305863/how-to-call-a-vhdl-function-written-in-a-seperate-file-to-a-c-program/37306683#37306683", "title": "How to call a VHDL function written in a seperate file to a C program", "body": "<p>The only standard interface between VHDL and other languages is the VHPI (new in the VHDL-2008 standard).  There is a Modelsim specific interface called the FLI.</p>\n\n<p>However, all of these languages are for VHDL to C/C++.  As far as I can tell, there is no mechanism to call a subprogram from C/C++ into VHDL.  And I have researched it extensively.</p>\n\n<p>Depending upon the tool in use, it may be possible to call VHDL subprograms from SystemC or SystemVerilog (via <code>SC_IMPORT</code> or <code>import \"DPI-C\"</code>, respectively), in my experience this support is very limited and very tool dependent (usually only available in very high-end commercial tools).</p>\n\n<p>Now, if you want to implement some of pppd, you'd be better off implementing it via an <code>entity</code>/<code>architecture</code> pair, and then instantiating it in a SystemVerilog or SystemC environment and passing data into the VHDL entity via the given ports.  Or if you insist on it being as a subprogram, use SystemVerilog or SystemC instead for implementation.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6352271"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 901, "favorite_count": 0, "closed_date": 1463645914, "answer_count": 1, "score": 0, "last_activity_date": 1463648779, "creation_date": 1463590709, "last_edit_date": 1463648779, "question_id": 37305863, "link": "https://stackoverflow.com/questions/37305863/how-to-call-a-vhdl-function-written-in-a-seperate-file-to-a-c-program", "closed_reason": "Needs more focus", "title": "How to call a VHDL function written in a seperate file to a C program", "body": "<p>Say I have a function written in VHDL and I want to call it from C and execute it in the C program. How would I do that?</p>\n\n<p>A simple example would be helpful. I searched and found <a href=\"https://books.google.lk/books?id=uAIwcAKo_VIC&amp;pg=PA319&amp;lpg=PA319&amp;dq=linking%20C%20and%20HDL%20files&amp;source=bl&amp;ots=e02fP1FN2B&amp;sig=CGLceDC1pXzJkP1ZM1ALXkVxFeY&amp;hl=en&amp;sa=X&amp;ved=0ahUKEwizoJ-IheTMAhUHuRQKHaJwCnMQ6AEINjAE#v=onepage&amp;q=linking%20C%20and%20HDL%20files&amp;f=false\" rel=\"nofollow\">this book</a>, but it only shows how to call C functions from VHDL, not the other way round.</p>\n\n<p>Can I include the VHDL code i want to implement in a device driver?.Using a tool like xilinx XPS a device driver can be made and the bitstream can be downloaded to an FPGA to make the hardware configurations .So in the end the C files will run in the microblaze and the VHDL implementation will be in the FPGA as a device driver.Can I call the driver then to the C file? because what i wanna do is to implement part of a C code in VHDL the rest of course in C and offload it to an FPGA and check whether the latency is reduced.Im using the pppd source code for this project.</p>\n"}, {"tags": ["c", "pointers", "operators", "dereference"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1463589967, "post_id": 37305611, "comment_id": 62132878, "body": "It&#39;s returning the first element <code>name</code> points to. It&#39;s like <code>row-&gt;name[0]</code> which should be used instead to avoid &quot;<i>confusion</i>&quot;."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1463590045, "post_id": 37305611, "comment_id": 62132924, "body": "Learn about <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\"><i>operator precedence</i></a>."}, {"owner": {"reputation": 41, "user_id": 4852498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea797018a40a7b16fa98212960810144?s=128&d=identicon&r=PG&f=1", "display_name": "don", "link": "https://stackoverflow.com/users/4852498/don"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1463590368, "post_id": 37305611, "comment_id": 62133100, "body": "@iharob if name is not initialized then what would get passed to sizeof(*row-&gt;name)?"}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 1, "creation_date": 1463590412, "post_id": 37305611, "comment_id": 62133130, "body": "@don sizeof is calculated at compile time using only type information."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1463590806, "post_id": 37305611, "comment_id": 62133345, "body": "@don As others said, <a href=\"http://stackoverflow.com/questions/8225776/why-does-sizeofx-not-increment-x\"><code>sizeof</code> does not &quot;<i>evaluate</i>&quot; it&#39;s operand</a> so nothing bad would happen, and it&#39;s actually a good way of passing the size to <code>malloc()</code> for example, for many reasons. For example, if you change the type of <code>name</code> you don&#39;t need to change <i>every</i> <code>malloc()</code> and also because it helps you allocate the correct size since it&#39;s always correct."}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 0, "creation_date": 1463590954, "post_id": 37305611, "comment_id": 62133425, "body": "@don <code>so 1 byte?</code> size_t (i.e. unsigned int) to be exact."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1463596277, "post_id": 37305611, "comment_id": 62136353, "body": "Questions are required to contain all relevant information <b>in the question itself</b>! Not a a link, nor as an image."}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 3, "last_activity_date": 1463590241, "creation_date": 1463590241, "answer_id": 37305730, "question_id": 37305611, "link": "https://stackoverflow.com/questions/37305611/c-how-do-i-read-and-together/37305730#37305730", "title": "C - how do I read * and -&gt; together?", "body": "<p>First the <code>-&gt;</code> operator is evaluated and then the resulting pointer which is pointing to what <code>name</code> points to is dereferenced with <code>*</code>. So it's the same as</p>\n\n<pre><code>row-&gt;name[0]\n</code></pre>\n\n<p>and IMHO this is a better way of expressing the same (<em>althought sometimes using the indirection operator <code>*</code> is clearer</em>).</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1463594159, "creation_date": 1463594159, "answer_id": 37306948, "question_id": 37305611, "link": "https://stackoverflow.com/questions/37305611/c-how-do-i-read-and-together/37306948#37306948", "title": "C - how do I read * and -&gt; together?", "body": "<p>The <code>-&gt;</code> component selection operator has higher precedence than the unary <code>*</code> operator, so <code>*row-&gt;name</code> is parsed as <code>*(row-&gt;name)</code>; you're dereferencing the <code>row-&gt;name</code> member.  </p>\n\n<p>The same is true for all other postfix<sup>1</sup> operators:</p>\n\n<pre><code>*arr[i] == *(arr[i])\n*foo()  == *(foo())\n*a.p    == *(a.p)\n*p++    == *(p++)\n*q--    == *(q--)\n</code></pre>\n\n<p><hr>\n<sup></p>\n\n<ol>\n<li> Component selection operators `.` and `->` are grouped with postfix operators even though they look like infix operators.\n</ol>\n\n<p></sup></p>\n"}], "owner": {"reputation": 41, "user_id": 4852498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea797018a40a7b16fa98212960810144?s=128&d=identicon&r=PG&f=1", "display_name": "don", "link": "https://stackoverflow.com/users/4852498/don"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "closed_date": 1464300318, "accepted_answer_id": 37305730, "answer_count": 2, "score": 3, "last_activity_date": 1534336439, "creation_date": 1463589861, "last_edit_date": 1534336439, "question_id": 37305611, "link": "https://stackoverflow.com/questions/37305611/c-how-do-i-read-and-together", "closed_reason": "Needs details or clarity", "title": "C - how do I read * and -&gt; together?", "body": "<p>If I have :</p>\n\n<pre><code>char *name; //this is in a struct\n\n*row-&gt;name //row is able to get in the struct\n</code></pre>\n\n<p>How do I read *row->name and what is it returning? </p>\n\n<p>I'll link the code I am reading: <a href=\"http://pastebin.com/MvLXkDCz\" rel=\"nofollow\">http://pastebin.com/MvLXkDCz</a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1463589877, "post_id": 37305584, "comment_id": 62132830, "body": "In <code>Cat**</code> it means that the author has bad taste."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1463589909, "post_id": 37305584, "comment_id": 62132845, "body": "&quot;If it&#39;s a pointer to a pointer, shouldn&#39;t there be a space?&quot;:  No space needed. <code>**</code> is not a token, so that parser recognizes it as two separate <code>*</code> tokens."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1463590517, "post_id": 37305584, "comment_id": 62133186, "body": "This is not a dup of the proposed question.  OP knows what the <code>**</code> operator is for, he just doesn&#39;t understand what it means when there&#39;s no space between it and the type name."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 36413, "user_id": 2301450, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/4xgoZ.png?s=128&g=1", "display_name": "vaultah", "link": "https://stackoverflow.com/users/2301450/vaultah"}, "edited": false, "score": 0, "creation_date": 1463591209, "post_id": 37305584, "comment_id": 62133551, "body": "@vaultah No is not a duplicate. The OP doesn&#39;t ask what <code>**</code> means. Please read the Question Again. =&gt;&gt; <code>shouldn&#39;t there be a space?</code>"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 4, "last_activity_date": 1463590022, "creation_date": 1463590022, "answer_id": 37305666, "question_id": 37305584, "link": "https://stackoverflow.com/questions/37305584/what-does-type-variable-mean/37305666#37305666", "title": "What does &quot;Type** variable&quot; mean?", "body": "<p>This:</p>\n\n<pre><code>Cat** cat_array\n</code></pre>\n\n<p>Is the same as this:</p>\n\n<pre><code>Cat **cat_array\n</code></pre>\n\n<p>The latter is preferred because it's more clear what the pointers refer to.  For example, if you had a declaration like this:</p>\n\n<pre><code>int* a, b;\n</code></pre>\n\n<p>At first glance it might appear that <code>a</code> and <code>b</code> are both pointers, when in fact only <code>a</code> is a pointer.  By formatting it the following way it's more apparent:</p>\n\n<pre><code>int *a, b;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6352204, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DhsWcjUASEE/AAAAAAAAAAI/AAAAAAAAADE/uD89pSAPHZE/photo.jpg?sz=128", "display_name": "Bhavin Gala", "link": "https://stackoverflow.com/users/6352204/bhavin-gala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1463610417, "creation_date": 1463589763, "last_edit_date": 1463610417, "question_id": 37305584, "link": "https://stackoverflow.com/questions/37305584/what-does-type-variable-mean", "title": "What does &quot;Type** variable&quot; mean?", "body": "<p>Can someone explain to me what the <code>**</code> after Cat is for?  If it's a pointer to a pointer, shouldn't there be a space?</p>\n\n<pre><code>    Cat fetch_and_kill_oldest(Cat** cat_array, int length){\n    //This function tries to find the oldest cat, take away one life,\n        Cat temp = cat_array[0];\n        for(int i = 1; i &lt; length; i++){\n            if (cat_array[i].age &gt; temp.age){\n                temp = cat_array[i];\n            }\n        }\n        temp.lives -= 1;\n        return temp;\n        //stop here\n    }\n</code></pre>\n"}, {"tags": ["c", "floating-point", "llvm", "llvm-ir", "comparison-operators"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463589516, "post_id": 37305326, "comment_id": 62132634, "body": "<a href=\"http://www.gnu.org/software/libc/manual/html_node/FP-Comparison-Functions.html\" rel=\"nofollow noreferrer\">hm</a>?"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 3, "creation_date": 1463589781, "post_id": 37305326, "comment_id": 62132779, "body": "You&#39;re a little mixed up about the terminology here. It&#39;s not a matter of &quot;ordered&quot; or &quot;unordered&quot; versions of comparions. <code>fcmp</code> keywords like <code>uge</code> mean &quot;unordered <i>or</i> greater than or equal&quot;, not an &quot;unordered&quot; greater than or equal comparison. Calling it an &quot;unordered&quot; version of &gt;= is like calling &gt;= an &quot;equal&quot; version of &gt;."}, {"owner": {"reputation": 39406, "user_id": 371250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WKvHm.png?s=128&g=1", "display_name": "ninjalj", "link": "https://stackoverflow.com/users/371250/ninjalj"}, "edited": false, "score": 0, "creation_date": 1463593251, "post_id": 37305326, "comment_id": 62134713, "body": "C99 also has <code>isunordered(x, y)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2856, "user_id": 404483, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f14616044849aa0f2bc89a7c9a53e744?s=128&d=identicon&r=PG", "display_name": "box", "link": "https://stackoverflow.com/users/404483/box"}, "edited": false, "score": 0, "creation_date": 1463596755, "post_id": 37306454, "comment_id": 62136633, "body": "Yes, I agree that I should have come up with a better name. How would you address what I named ordered and unordered floating point comparisons, e.g., to discriminate the two classes of LLVM IR floating point comparisons (<a href=\"http://llvm.org/docs/LangRef.html#fcmp-instruction\" rel=\"nofollow noreferrer\">llvm.org/docs/LangRef.html#fcmp-instruction</a>)?  Also, it is not uncommon that GNU C extensions provide some functionality that standard C does not. For example, it also has some macros posted by @Eugene Sh. above to provide some guaranteed behavior for cases that standard C leaves undefined."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "reply_to_user": {"reputation": 2856, "user_id": 404483, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f14616044849aa0f2bc89a7c9a53e744?s=128&d=identicon&r=PG", "display_name": "box", "link": "https://stackoverflow.com/users/404483/box"}, "edited": false, "score": 1, "creation_date": 1463603609, "post_id": 37306454, "comment_id": 62140222, "body": "@box: Those macros are part of the standard, not an extension."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1463606171, "last_edit_date": 1463606171, "creation_date": 1463592504, "answer_id": 37306454, "question_id": 37305326, "link": "https://stackoverflow.com/questions/37305326/unordered-floating-point-comparisons-in-c/37306454#37306454", "title": "Unordered floating point comparisons in C", "body": "<blockquote>\n  <p>However, apart from that I did not find other unordered comparison operations. Are there any GNU extensions (or other standard library functions) that offer unordered floating point comparisons?</p>\n</blockquote>\n\n<p>As @user2357112 observed in comments, \"unordered floating-point comparisons\" aren't a thing.  The term doesn't even make sense.  What you seem to want to evaluate are predicates of the form \"x is less than y or the two are unordered\".</p>\n\n<p>Conforming C implementations are not at liberty to add operators, even as extensions.  They can, in principle, define additional meanings for existing operators, but I don't know any implementation that provides the specific operations you are looking for that way.  As you've already discovered, it's pretty trivial to use C's existing operators for the purpose:</p>\n\n<blockquote>\n  <p>So far, I only could implement them by checking for the opposite condition. For example, to implement an unordered <code>a &gt;= b</code> comparison, I instead wrote an ordered <code>!(a &lt; b)</code></p>\n</blockquote>\n\n<p><em>Update</em>: The problem with that is that these comparisons will raise a floating-point exception when one of the operands is NaN (and FP exceptions are not disabled).  But you're in luck!  Since C99, there are <a href=\"http://man7.org/linux/man-pages/man3/isgreater.3.html\" rel=\"nofollow\">standard macros implementing the comparisons you seek</a>.  These are guaranteed to evaluate their arguments only once, and they do not raise floating-point exceptions.</p>\n\n<p><s>And, of course, if you want to be able to express more clearly in your code that you are explicitly accommodating NaNs, then you could always write macros for it:</p>\n\n<pre><code>#define GE_OR_UNORDERED(x, y) (!((x) &lt; (y)))\n\n// ...\n\nif (GE_OR_UNORDERED(a, b)) // ...\n</code></pre>\n\n<p>Note also that all of this relies heavily on the implementation details.  Although C recognizes the <em>possibility</em> that real types can accommodate values, such as NaNs, that do not represent floating-point numbers, it does not require them to do so, nor does it define the behavior of relational or arithmetic operations on such values.  Though most implementations these days use IEEE-754 floating point formats and operations, they are not required to do so, and historically, some have not.</s></p>\n"}], "owner": {"reputation": 2856, "user_id": 404483, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f14616044849aa0f2bc89a7c9a53e744?s=128&d=identicon&r=PG", "display_name": "box", "link": "https://stackoverflow.com/users/404483/box"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 921, "favorite_count": 0, "accepted_answer_id": 37306454, "answer_count": 1, "score": 1, "last_activity_date": 1463606171, "creation_date": 1463589048, "question_id": 37305326, "link": "https://stackoverflow.com/questions/37305326/unordered-floating-point-comparisons-in-c", "title": "Unordered floating point comparisons in C", "body": "<p>The default floating point comparisons (e.g., 3.0 &lt; 5.0) in C are ordered, i.e., the produce <code>false</code> if one of the argument is NaN. However, compilers and processors also have unordered comparisons. For example, in LLVM IR the <a href=\"http://llvm.org/docs/LangRef.html#fcmp-instruction\" rel=\"nofollow\"><code>fcmp</code> instruction</a> both has ordered and unordered variants. C99 has some functions to test for NaN. However, apart from that I did not find other unordered comparison operations. Are there any GNU extensions (or other standard library functions) that offer unordered floating point comparisons?</p>\n\n<p>So far, I only could implement them by checking for the opposite condition. For example, to implement an unordered <code>a &gt;= b</code> comparison, I instead wrote an ordered <code>!(a &lt; b)</code> that LLVM eventually simplifies to an unordered comparison <code>fcmp uge double %1, %2</code>.</p>\n"}, {"tags": ["c++", "c", "runtime"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1463588614, "post_id": 37305124, "comment_id": 62132108, "body": "Totally depends on how the OS is providing the arguments to the process. If you don&#39;t have an OS, just provide <code>argc</code> as <code>0</code> and <code>argv</code> as <code>NULL</code>."}, {"owner": {"reputation": 1659, "user_id": 4767670, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dda5bf53c264228a2cd807e9167dc9c?s=128&d=identicon&r=PG", "display_name": "NoImaginationGuy", "link": "https://stackoverflow.com/users/4767670/noimaginationguy"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1463588744, "post_id": 37305124, "comment_id": 62132185, "body": "How can I figure out what value I should use for each OS? Is there something which explains it? Like a list or something like that"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1463588800, "post_id": 37305124, "comment_id": 62132233, "body": "Providing a <code>_start</code> at all is not portable in the first place. Good luck making it work for every OS."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1463588831, "post_id": 37305124, "comment_id": 62132252, "body": "This is not for the weak of heart. Imagine the multitutde of tasks you need to perform in _start! Calling constructors is just of them. How about binding dynamic objects?"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 3, "creation_date": 1463588834, "post_id": 37305124, "comment_id": 62132255, "body": "You are deep into compiler-specific stuff. What is the actual problem that you&#39;re trying to solve?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1463589042, "post_id": 37305124, "comment_id": 62132369, "body": "@osnapitzkindle May be <a href=\"http://learningpearls.blogspot.de/2011/02/start-function-inside-c.html\" rel=\"nofollow noreferrer\">this</a> helps a bit."}, {"owner": {"reputation": 1659, "user_id": 4767670, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dda5bf53c264228a2cd807e9167dc9c?s=128&d=identicon&r=PG", "display_name": "NoImaginationGuy", "link": "https://stackoverflow.com/users/4767670/noimaginationguy"}, "edited": false, "score": 0, "creation_date": 1463589085, "post_id": 37305124, "comment_id": 62132395, "body": "I&#39;m writing a compiler and I need to write the runtime library my programs will link against. It&#39;s just normal it&#39;s not portable lol, providing a _start for each platform is not a problem. I already knew it and I&#39;ll definitely do it. I just need to know if I can maybe write it in C just to try before writing it in assembly for each platform."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1463589086, "post_id": 37305124, "comment_id": 62132397, "body": "@PeteBecker Sounds like the OP want&#39;s to solve the static initialization fiasko."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1463589386, "post_id": 37305124, "comment_id": 62132565, "body": "@osnapitzkindle - okay, so you&#39;re legitimately deep into compiler-specific stuff. &lt;g&gt;"}, {"owner": {"reputation": 1659, "user_id": 4767670, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dda5bf53c264228a2cd807e9167dc9c?s=128&d=identicon&r=PG", "display_name": "NoImaginationGuy", "link": "https://stackoverflow.com/users/4767670/noimaginationguy"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1463589654, "post_id": 37305124, "comment_id": 62132709, "body": "@PeteBecker yes, I&#39;m developing a new language and I&#39;m really interested in such things"}], "owner": {"reputation": 1659, "user_id": 4767670, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9dda5bf53c264228a2cd807e9167dc9c?s=128&d=identicon&r=PG", "display_name": "NoImaginationGuy", "link": "https://stackoverflow.com/users/4767670/noimaginationguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1463590234, "creation_date": 1463588429, "last_edit_date": 1463590200, "question_id": 37305124, "link": "https://stackoverflow.com/questions/37305124/how-to-get-arg0-from-start-implementation", "title": "How to get arg0 from _start() implementation?", "body": "<p>I need to implement my <code>_start()</code> function in C, so I can manage my own global constructors and call my <code>main()</code> function as I want.</p>\n\n<p>My problem is when I have to get command line arguments and the <code>argc</code> value. Some time ago I saw something like this using an <code>arg0</code> value which should point to the first arg:</p>\n\n<pre><code>extern int main(int argc, const char *argv[]);\n\nvoid _start() {\n  // calling all the global ctors here\n\n  exit(main(/* something i don't rememebr as argc */, &amp;arg0));\n}\n</code></pre>\n\n<p>How can I get that <code>arg0</code>? And how do I get the <code>argc</code> value from the command line?</p>\n\n<p><strong>UPDATE:</strong>\nWith \"global constructors\" I mean functions which initializes any global variable. Like <code>int x = doit();</code> the call to function <code>doit()</code> is enclosed in a global constructor which will be called before <code>main</code> (in the <code>_start()</code> actually).</p>\n"}, {"tags": ["c", "arrays", "matrix"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1463587549, "post_id": 37304792, "comment_id": 62131380, "body": "You know the array size, <code>3x3</code> so check that you indexes are always in a legal range..."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1463587687, "post_id": 37304792, "comment_id": 62131462, "body": "Use nested loops but limit your boundary conditions appropriately. Start at index 1 and stop at row - 2 or height - 2. In the case of the 3X3 in your example, only the [2] in the dead center will be a candidate for checking."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1463588153, "post_id": 37304792, "comment_id": 62131792, "body": "In the scope where the array is declared, you can use <code>sizeof()</code> to get the size of the array. But if you pass the array to a function, it just passes a pointer. You need to pass the size information as well, there&#39;s no way for the function to get it by itself."}], "answers": [{"tags": [], "owner": {"reputation": 148, "user_id": 3795226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ajnwj.jpg?s=128&g=1", "display_name": "vladimir", "link": "https://stackoverflow.com/users/3795226/vladimir"}, "is_accepted": true, "score": 0, "last_activity_date": 1463696355, "last_edit_date": 1463696355, "creation_date": 1463596856, "answer_id": 37307709, "question_id": 37304792, "link": "https://stackoverflow.com/questions/37304792/how-to-detect-overflow-in-two-dimensional-array-of-c/37307709#37307709", "title": "How to detect overflow in two-dimensional array of C?", "body": "<p>You need to use GNU Scientific Libra\u0433y or implement 2dimm array with get/set functions. Something like this:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;assert.h&gt;\n    #include&lt;stdlib.h&gt;\n\n    struct Arr {\n        double* arr;\n        int max_x;\n        int max_y;\n    } typedef Arr;\n\n    Arr* Arr_new(int x, int y){\n        Arr* result = (Arr*)malloc(sizeof(Arr));\n        if (result){\n            result-&gt;arr = (double*)malloc(x*y*sizeof(double));\n            result-&gt;max_x = x;\n            result-&gt;max_y = y;\n        }\n        return result;\n    }\n\n    void Arr_free(Arr* arr){\n        free(arr-&gt;arr);\n        free(arr);\n    }\n\n    // Arr_set(arr, 0, 0, 3.14) is correct.\n    void Arr_set(Arr* arr, int i, int j, double val){\n        //replace your code if needed:\n        assert(arr-&gt;max_x &gt; i);\n        assert(arr-&gt;max_y &gt; j);\n        arr-&gt;arr[i + j*arr-&gt;max_x] = val;\n    }\n\n    // Arr_get(arr, 0, 0) is correct.\n    double Arr_get(Arr* arr, int i, int j){\n        //replace your code if needed:\n        assert(arr-&gt;max_x &gt; i);\n        assert(arr-&gt;max_y &gt; j);\n        return arr-&gt;arr[ i + j*arr-&gt;max_x];\n    }\n\n\n    int main(void)\n    {\n        Arr* a = Arr_new(3,3);\n        Arr_set(a, 2, 2, 1.234) ;\n        double val = Arr_get(a,2,2);\n        printf(\"val = %f\\n\",val);\n\n        Arr_free(a);\n        return 0;\n    }\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5540253, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10206116275044713/picture?type=large", "display_name": "Nicolas Mozo", "link": "https://stackoverflow.com/users/5540253/nicolas-mozo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "closed_date": 1464300334, "accepted_answer_id": 37307709, "answer_count": 1, "score": 0, "last_activity_date": 1463696355, "creation_date": 1463587468, "question_id": 37304792, "link": "https://stackoverflow.com/questions/37304792/how-to-detect-overflow-in-two-dimensional-array-of-c", "closed_reason": "Needs more focus", "title": "How to detect overflow in two-dimensional array of C?", "body": "<p>I have a two-dimensional array like this:</p>\n\n<pre><code>[1][0][3]\n[0][2][0]\n[1][0][0]\n</code></pre>\n\n<p>I should to analyze each position if around it there is a '0', and get that position. After that, I must complete this position with another numbers. The problem is, how detect if the position that i'm analizing not exist, that is if is overlflow?. I know that C has no bounds checking , but there must be a way to check that position.</p>\n"}, {"tags": ["c", "swap", "endianness", "unions"], "comments": [{"owner": {"reputation": 1139, "user_id": 6266602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0fa60ab2c1ac1b185db45679cabe8c9?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas B Preusser", "link": "https://stackoverflow.com/users/6266602/thomas-b-preusser"}, "edited": false, "score": 1, "creation_date": 1463587367, "post_id": 37304481, "comment_id": 62131254, "body": "All members of the union share the very same memory region. They only provide different interpretations when accessed. The byte-array abstraction allows an easy shuffle of the individual bytes. Doing so directly effects the value of the overlaid <code>int</code> because they do reference the same memory."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1463587574, "creation_date": 1463587574, "answer_id": 37304828, "question_id": 37304481, "link": "https://stackoverflow.com/questions/37304481/endian-swap-in-c-union/37304828#37304828", "title": "Endian Swap in C Union", "body": "<p>If you look at the hex representation of <code>2048327680</code>, you'll see it is <code>7A 17 00 00</code>.  So if your machine stores this value in little endian format, the LSB is stored first.</p>\n\n<p>If we add extra debugging to <code>endianSwap4int</code> as follows:</p>\n\n<pre><code>  int endianSwap4int(int a) {\n      union byte4 un;\n      int i;\n      un.numint = a;\n\n      printf(\"before:\\n\");\n      for (i=0;i&lt;4;i++) {\n          printf(\"un[%d]=%02X\\n\", i, un.byte[i]);\n      }\n\n      // swap\n      char c1 = un.byte[0];\n      un.byte[0] = un.byte[3];\n      un.byte[3] = c1;\n      c1 = un.byte[1];\n      un.byte[1] = un.byte[2];\n      un.byte[2] = c1;\n\n      printf(\"after:\\n\");\n      for (i=0;i&lt;4;i++) {\n          printf(\"un[%d]=%02X\\n\", i, un.byte[i]);\n      }\n      return un.numint;\n  }\n</code></pre>\n\n<p>You'll see the following output:</p>\n\n<pre><code>before:\nun[0]=00\nun[1]=00\nun[2]=17\nun[3]=7A\nafter:\nun[0]=7A\nun[1]=17\nun[2]=00\nun[3]=00\n</code></pre>\n\n<p>Here, you can see that the LSB of the original number is first before the swap, and the MSB of the original number is first after the swap.  So now the <code>int</code> portion of the union contains the value <code>00 00 17 7A</code> which in decimal is <code>6010</code>.</p>\n"}], "owner": {"reputation": 736, "user_id": 5518510, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-SWxmZSBk6X4/AAAAAAAAAAI/AAAAAAAABUo/IYVOQ29qXu0/photo.jpg?sz=128", "display_name": "James Mchugh", "link": "https://stackoverflow.com/users/5518510/james-mchugh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4040, "favorite_count": 0, "accepted_answer_id": 37304828, "answer_count": 1, "score": 2, "last_activity_date": 1490544162, "creation_date": 1463586614, "last_edit_date": 1490544162, "question_id": 37304481, "link": "https://stackoverflow.com/questions/37304481/endian-swap-in-c-union", "title": "Endian Swap in C Union", "body": "<p>I am trying to understand the way an endian swap works when done within a union in C. I understand that a union has the ability to hold multiple types of data, but can only hold one type at a time. The code I am trying to understand looks like this, this is the union definition:</p>\n\n<pre><code>  union byte4 {\n          char byte[4];\n          int numint;\n          float numfloat;\n  };\n</code></pre>\n\n<p>This is the function.</p>\n\n<pre><code>  int endianSwap4int(int a) {\n      union byte4 un;\n      un.numint = a;\n\n      // swap\n      char c1 = un.byte[0];\n      un.byte[0] = un.byte[3];\n      un.byte[3] = c1;\n      c1 = un.byte[1];\n      un.byte[1] = un.byte[2];\n      un.byte[2] = c1;\n\n      return un.numint;\n  }\n</code></pre>\n\n<p>In the function, if the input <code>a</code> is 2048327680, the function returns 6010 when <code>un.numint</code> is returned. I understand that manipulating <code>un.byte</code> is indirectly manipulating <code>un.numint</code> as well because unions can only hold one thing at a time, but I don't understand exactly how they affect each other, so my question is, how exactly do they affect each other?</p>\n"}, {"tags": ["c", "robotics"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1463585287, "post_id": 37303953, "comment_id": 62129822, "body": "I&#39;d start using a matrix of a structure that holds info about N,S,W,E walls."}, {"owner": {"reputation": 273, "user_id": 3722559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ae714cac6c3fe6897729aca735eaea?s=128&d=identicon&r=PG&f=1", "display_name": "schil227", "link": "https://stackoverflow.com/users/3722559/schil227"}, "edited": false, "score": 0, "creation_date": 1463585699, "post_id": 37303953, "comment_id": 62130126, "body": "As someone who has worked with robots in a similar scenario, I hope that yours can turn exactly 90 degrees."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1463585736, "post_id": 37303953, "comment_id": 62130152, "body": "@LPs This info can be stored nicely within 4 bits.."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 273, "user_id": 3722559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ae714cac6c3fe6897729aca735eaea?s=128&d=identicon&r=PG&f=1", "display_name": "schil227", "link": "https://stackoverflow.com/users/3722559/schil227"}, "edited": false, "score": 0, "creation_date": 1463585767, "post_id": 37303953, "comment_id": 62130178, "body": "@schil227 Weel, it depends on the platform. On embedded I&#39;d use bitfileds  flags. ;)"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463585822, "post_id": 37303953, "comment_id": 62130226, "body": "@EugeneSh. For sure, as pmg already answered."}, {"owner": {"reputation": 408, "user_id": 2094848, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/354397a15b54dab3d84cb291aa38f1a5?s=128&d=identicon&r=PG", "display_name": "DanBennett", "link": "https://stackoverflow.com/users/2094848/danbennett"}, "edited": false, "score": 0, "creation_date": 1463585823, "post_id": 37303953, "comment_id": 62130229, "body": "This isn&#39;t really C specific. It&#39;s a design problem. The best solution is going to be highly dependent on what your aims are. Both solutions below are nice for different reasons, but it&#39;s really worth trying to find a solution yourself, based on context of your problem. Nobody here can give the &quot;best&quot; answer to that."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1463585889, "post_id": 37303953, "comment_id": 62130281, "body": "Note : you can simplify all of the logic quite a bit by storing only the top and left walls of each cell, and adding a 1-cell wide border to the right and the bottom of your map."}], "answers": [{"comments": [{"owner": {"reputation": 19923, "user_id": 66519, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/83ea6683f15edb2087f6a3ad4f42605b?s=128&d=identicon&r=PG", "display_name": "ojblass", "link": "https://stackoverflow.com/users/66519/ojblass"}, "edited": false, "score": 1, "creation_date": 1463586071, "post_id": 37304048, "comment_id": 62130407, "body": "Generally speaking you might also want to specify one of the points as the   ROOM_EXIT for the destination."}, {"owner": {"reputation": 71, "user_id": 6262982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d591ceb609bb526228030aeac7d6812f?s=128&d=identicon&r=PG&f=1", "display_name": "emuterisa", "link": "https://stackoverflow.com/users/6262982/emuterisa"}, "edited": false, "score": 0, "creation_date": 1463586384, "post_id": 37304048, "comment_id": 62130613, "body": "I like this idea! quite concise, though I know define is used mainly to define constants, though I&#39;m unfamiliar with the syntax stated above about (1 &lt;&lt; 0) (1 &lt;&lt; 1) etc, what does this mean?"}, {"owner": {"reputation": 596, "user_id": 5577386, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0291b7c6b3bac6db3bc83953a50765ad?s=128&d=identicon&r=PG&f=1", "display_name": "Shaun Barney", "link": "https://stackoverflow.com/users/5577386/shaun-barney"}, "edited": false, "score": 1, "creation_date": 1463586664, "post_id": 37304048, "comment_id": 62130802, "body": "It&#39;s a <a href=\"http://www.c4learn.com/c-programming/c-bitwise-left-shift-operator/\" rel=\"nofollow noreferrer\">bitwise left shift operator</a>"}, {"owner": {"reputation": 408, "user_id": 2094848, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/354397a15b54dab3d84cb291aa38f1a5?s=128&d=identicon&r=PG", "display_name": "DanBennett", "link": "https://stackoverflow.com/users/2094848/danbennett"}, "edited": false, "score": 1, "creation_date": 1463586732, "post_id": 37304048, "comment_id": 62130862, "body": "<a href=\"http://www.tutorialspoint.com/cprogramming/c_operators.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/cprogramming/c_operators.htm</a>"}, {"owner": {"reputation": 71, "user_id": 6262982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d591ceb609bb526228030aeac7d6812f?s=128&d=identicon&r=PG&f=1", "display_name": "emuterisa", "link": "https://stackoverflow.com/users/6262982/emuterisa"}, "edited": false, "score": 0, "creation_date": 1463586808, "post_id": 37304048, "comment_id": 62130916, "body": "Thank you guys, will look into it :)"}], "tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 7, "last_activity_date": 1463585399, "creation_date": 1463585399, "answer_id": 37304048, "question_id": 37303953, "link": "https://stackoverflow.com/questions/37303953/robotics-maze-representation-in-c/37304048#37304048", "title": "Robotics Maze Representation in C", "body": "<p>use specific bits for specific properties of the room</p>\n\n<pre><code>#define ROOM_WALL_ABOVE (1 &lt;&lt; 0)\n#define ROOM_WALL_LEFT  (1 &lt;&lt; 1)\n#define ROOM_WALL_BELOW (1 &lt;&lt; 2)\n#define ROOM_WALL_RIGHT (1 &lt;&lt; 3)\n#define ROOM_DOOR       (1 &lt;&lt; 4)\n\nint a[5][4] = {0};\na[0][0] = ROOM_WALL_ABOVE | ROOM_WALL_LEFT;\n\nif (a[x][y] &amp; ROOM_WALL_RIGHT) printf(\"Cannot walk right.\\n\");\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 6262982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d591ceb609bb526228030aeac7d6812f?s=128&d=identicon&r=PG&f=1", "display_name": "emuterisa", "link": "https://stackoverflow.com/users/6262982/emuterisa"}, "edited": false, "score": 0, "creation_date": 1463586243, "post_id": 37304184, "comment_id": 62130506, "body": "Wow thats amazing! makes alot of sense thanks! Only problem I have now is understanding what the reset part does? (new syntax to me T_T)"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 71, "user_id": 6262982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d591ceb609bb526228030aeac7d6812f?s=128&d=identicon&r=PG&f=1", "display_name": "emuterisa", "link": "https://stackoverflow.com/users/6262982/emuterisa"}, "edited": false, "score": 0, "creation_date": 1463586306, "post_id": 37304184, "comment_id": 62130552, "body": "It resets to <code>0</code> all bytes of <code>maze</code> matrix, no more than that."}, {"owner": {"reputation": 71, "user_id": 6262982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d591ceb609bb526228030aeac7d6812f?s=128&d=identicon&r=PG&f=1", "display_name": "emuterisa", "link": "https://stackoverflow.com/users/6262982/emuterisa"}, "edited": false, "score": 0, "creation_date": 1463586553, "post_id": 37304184, "comment_id": 62130732, "body": "Why would you need to do that? I think I&#39;m lacking understanding in the memory department. If that was me, I probably would have excluded, with my current understanding of structs. Thanks!"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 71, "user_id": 6262982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d591ceb609bb526228030aeac7d6812f?s=128&d=identicon&r=PG&f=1", "display_name": "emuterisa", "link": "https://stackoverflow.com/users/6262982/emuterisa"}, "edited": false, "score": 1, "creation_date": 1463586818, "post_id": 37304184, "comment_id": 62130924, "body": "You need that if you want to start from a clean matrix with all values set to false. Otherwise, due to its local scope (stack allocation),  it will holds random values. BTW if your code assure to fill the whole structure with a correct initialization you could avoid it."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 3, "last_activity_date": 1463585695, "creation_date": 1463585695, "answer_id": 37304184, "question_id": 37303953, "link": "https://stackoverflow.com/questions/37303953/robotics-maze-representation-in-c/37304184#37304184", "title": "Robotics Maze Representation in C", "body": "<p>You could use a struct matrix</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n\nstruct walls\n{\n    bool N; // true = wall false = no wall\n    bool S; // true = wall false = no wall\n    bool W; // true = wall false = no wall\n    bool E; // true = wall false = no wall\n};\n\nint main()\n{\n    struct walls maze[5][4];\n\n    // reset\n    memset(maze, 0x00, sizeof(maze));\n\n    // init\n    maze[0][0].N = false;\n    maze[0][0].S = true;\n    maze[0][0].W = true;\n    maze[0][0].E = false;\n\n    // YOUR STUFF\n\n   return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 6262982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d591ceb609bb526228030aeac7d6812f?s=128&d=identicon&r=PG&f=1", "display_name": "emuterisa", "link": "https://stackoverflow.com/users/6262982/emuterisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "closed_date": 1464300342, "answer_count": 2, "score": 2, "last_activity_date": 1463585695, "creation_date": 1463585127, "question_id": 37303953, "link": "https://stackoverflow.com/questions/37303953/robotics-maze-representation-in-c", "closed_reason": "Needs details or clarity", "title": "Robotics Maze Representation in C", "body": "<p>So I'd like to represent a rectangular maze of say dimensions 5x4 (rows x columns) using a 2D array in C language. However I am having trouble specifying what actually needs to be put into the 2D array.</p>\n\n<pre><code>int a[5][4] = {\n    {},\n    {},\n    {},\n    {},\n    {}, \n};\n</code></pre>\n\n<p>Here is the skeleton of the 2D array, in each row there will be 4 values, I assume that each of these values is a single integer that tells us the properties of a cell in the maze. My problem is, is that really enough? How does a single value tell a robot weather there are 3 walls, 2 walls etc</p>\n\n<p>Someone please enlighten me D:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EojXM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EojXM.png\" alt=\"Maze\"></a></p>\n"}, {"tags": ["c", "parallel-processing", "message-passing", "mpich", "numactl"], "comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1463586226, "post_id": 37303778, "comment_id": 62130493, "body": "Are you using a batch system? Usually these things involve the batch system..."}], "answers": [{"tags": [], "owner": {"reputation": 302, "user_id": 1262426, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pgMzS.jpg?s=128&g=1", "display_name": "Sidharth N. Kashyap", "link": "https://stackoverflow.com/users/1262426/sidharth-n-kashyap"}, "is_accepted": false, "score": 1, "last_activity_date": 1463586132, "creation_date": 1463586132, "answer_id": 37304337, "question_id": 37303778, "link": "https://stackoverflow.com/questions/37303778/core-binding-for-particular-rank-execution-in-mpich2-says-sched-setaffinity-inv/37304337#37304337", "title": "Core binding for particular rank execution in MPICH2 says sched_setaffinity: Invalid argument.", "body": "<p>What you are looking for is 'Process Affinity'. </p>\n\n<p>The affinity paradigm chosen guides the implementation to map the process to the scheme you opted for, you have the option to map the process to socket/core/hwthread. </p>\n\n<p>Mpich has a '-bind-to' switch that enables this. For example: </p>\n\n<pre><code>mpiexec -bind-to core:144 -n ...\n</code></pre>\n\n<p>should bind your processes to 144 exclusive cores. </p>\n\n<p>try <code>mpiexec -bind-to -help</code> for more information about this. </p>\n\n<p>Here is the <a href=\"https://wiki.mpich.org/mpich/index.php/Using_the_Hydra_Process_Manager\" rel=\"nofollow\">user guide</a>. </p>\n"}], "owner": {"reputation": 1, "user_id": 5594372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9087l.jpg?s=128&g=1", "display_name": "Krunal", "link": "https://stackoverflow.com/users/5594372/krunal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 552, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1473312892, "creation_date": 1463584605, "last_edit_date": 1473312892, "question_id": 37303778, "link": "https://stackoverflow.com/questions/37303778/core-binding-for-particular-rank-execution-in-mpich2-says-sched-setaffinity-inv", "title": "Core binding for particular rank execution in MPICH2 says sched_setaffinity: Invalid argument.", "body": "<p><br>I'm working on HPC that has 144 cores. <br>I have 24 nodes and every node has 6cpus. like <br>node 0:0,1,2,3,4,5<br>node 1: 6,7,8,9,10,11<br>...<br> Using Mpich2. I'm running my c ecxecutable like this.<b>  mpiexec -n 25 ./a.out</b> <br>\nIn the a.out it will work as rank 0 makes a master rank 1 (which is free), and the master rank 1 makes X=6 numbers(it will change sometime 3,6,7) execs parallel. on the rank 2,3,4,5,6,7 rank using <b>numaactl -l --phycpubind = %d x.out</b> it is working but the thing is that I get the error <b>sched_setaffinity: Invalid argument.</b><br>ps -aF prints the write binding in PSR for x.out. <br>sched_setaffinity: Invalid argument.in future makes a problem or is it making a problem now. <br>Thank you. </p>\n"}, {"tags": ["c", "compilation", "c-preprocessor"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463584820, "post_id": 37303730, "comment_id": 62129478, "body": "What are the usecases for such a feature? You can always re-<code>#define</code> the blocked functions/types."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1463585240, "post_id": 37303730, "comment_id": 62129781, "body": "If you&#39;re using GCC, <a href=\"https://gcc.gnu.org/onlinedocs/gcc-3.3/cpp/Pragmas.html\" rel=\"nofollow noreferrer\"><code>#pragma GCC poison</code></a> can be useful to block specific functions. It won&#39;t help for whole headers though."}, {"owner": {"reputation": 73, "user_id": 2539544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/723ec099f24f2865eabe14ba486b8826?s=128&d=identicon&r=PG", "display_name": "PolkaPunk", "link": "https://stackoverflow.com/users/2539544/polkapunk"}, "edited": false, "score": 2, "creation_date": 1463585289, "post_id": 37303730, "comment_id": 62129825, "body": "I&#39;m trying to write a program which teaches people the C language. They type in code, it passes their code to a compiler and runs it, piping the output to a file which is then read by my program.I want to make sure they can&#39;t shoot themselves in the foot by blocking access to some of the more dangerous functions and also make sure they can&#39;t redirect the output elsewhere than I intend."}, {"owner": {"reputation": 73, "user_id": 2539544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/723ec099f24f2865eabe14ba486b8826?s=128&d=identicon&r=PG", "display_name": "PolkaPunk", "link": "https://stackoverflow.com/users/2539544/polkapunk"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1463585971, "post_id": 37303730, "comment_id": 62130342, "body": "@Quentin <code>#pragma GCC poison</code> does exactly what I&#39;m looking for! Thanks Quentin!"}, {"owner": {"reputation": 17102, "user_id": 1022889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WZOSZ.jpg?s=128&g=1", "display_name": "Cloud", "link": "https://stackoverflow.com/users/1022889/cloud"}, "edited": false, "score": 0, "creation_date": 1463586459, "post_id": 37303730, "comment_id": 62130660, "body": "@PolkaPunk You might be better off using something pre-made like Ideone.com and finding an API for it."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 2539544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/723ec099f24f2865eabe14ba486b8826?s=128&d=identicon&r=PG", "display_name": "PolkaPunk", "link": "https://stackoverflow.com/users/2539544/polkapunk"}, "edited": false, "score": 0, "creation_date": 1463586023, "post_id": 37304043, "comment_id": 62130375, "body": "<code>pragma GCC poison</code> does exactly what I&#39;m looking for! Thanks PSkocik!"}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 4, "last_activity_date": 1463585380, "creation_date": 1463585380, "answer_id": 37304043, "question_id": 37303730, "link": "https://stackoverflow.com/questions/37303730/are-there-any-c-compilers-which-let-you-block-the-usage-of-specific-libraries-an/37304043#37304043", "title": "Are there any C compilers which let you block the usage of specific libraries and functions?", "body": "<p>With e.g., gcc, you can do the following to prevent certain includes:</p>\n\n<ol>\n<li>Create a failing stub for each header include that you want to fail:</li>\n</ol>\n\n<p><strong>float.h:</strong></p>\n\n<pre><code>#error \"You must not include me\"\n</code></pre>\n\n<ol start=\"2\">\n<li><p>Make sure those stubs will override your system libraries:</p>\n\n<pre><code>$ export CPATH=$PWD\n</code></pre></li>\n</ol>\n\n<p>Compiling a c-file that tries to include <code>\"float.h\"</code> or <code>&lt;float.h&gt;</code> in this environment will then fail.</p>\n\n<p>Of course, this is circumventable. All you need is declare the functions declared in the missing headers manually.</p>\n\n<p>A better option might be to create a global include (<code>-include</code>) where you \n<code>#pragma GCC poison</code> all symbols that should not be used anywhere in your programs.</p>\n\n<p>You can also inspect crated object files with <code>nm</code> for the unresolved symbols that you don't want resolved by the c librard and stop the build if such symbols are found.</p>\n"}], "owner": {"reputation": 73, "user_id": 2539544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/723ec099f24f2865eabe14ba486b8826?s=128&d=identicon&r=PG", "display_name": "PolkaPunk", "link": "https://stackoverflow.com/users/2539544/polkapunk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 37304043, "answer_count": 1, "score": 2, "last_activity_date": 1463585380, "creation_date": 1463584473, "question_id": 37303730, "link": "https://stackoverflow.com/questions/37303730/are-there-any-c-compilers-which-let-you-block-the-usage-of-specific-libraries-an", "title": "Are there any C compilers which let you block the usage of specific libraries and functions?", "body": "<p>Does anyone know if there are any C compilers which let you block the usage of specific libraries and functions?</p>\n\n<p>For instance, let's say I wanted to block access to float.h and tried to compile a program that had \"#include \". I'd want the compile to fail and some sort of message indicating it was because float.h cannot be included.</p>\n\n<p>Or, if I wanted to block access to sqrt() and pow() in math.h, but include all the other functions in that library, so a program that had the line \"double hold = pow(2.0, 3.0);\" wouldn't compile and would worn that a blocked function was being called.</p>\n\n<p>I've tried searching online for something like this but I don't think I know the correct terms to search for because I can't seem to find any results pertaining to what I'm actually looking for.</p>\n"}, {"tags": ["c", "redirect", "exec", "stdout", "dup"], "answers": [{"tags": [], "owner": {"reputation": 819, "user_id": 6086833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/060138486ddeff3186d29262a5852c76?s=128&d=identicon&r=PG&f=1", "display_name": "T Johnson", "link": "https://stackoverflow.com/users/6086833/t-johnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1463595502, "creation_date": 1463595502, "answer_id": 37307304, "question_id": 37303570, "link": "https://stackoverflow.com/questions/37303570/c-redirecting-stdout-to-a-file-for-process-called-by-exec-in-child-process/37307304#37307304", "title": "C Redirecting stdout to a file for process called by exec in child process", "body": "<p>I just ran the following code based upon your code and it worked for me. I would suggest that you may have a problem with running appc1 and you should add a printf() after the execl() that should never print unless the execl() fails to process properly.</p>\n\n<p>appc1.c</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main()\n{\n   printf(\"Output from appc1\\n\" );\n}\n</code></pre>\n\n<p>pipes.c</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main ()\n{\n  int ret;\n  int num1, num2;\n  pid_t reader;\n  pid_t writer;\n  int pipefd[2];\n  FILE *file;\n\n  printf( \"PARENT: creating pipe\\n\" );\n\n  ret = pipe( pipefd );\n  if ( ret == -1 ) {\n      printf( \"Error creating pipe - %s\", strerror( errno ) );\n      exit (1);\n  }\n\n  printf( \"PARENT: forking reader\\n\" );\n\n  reader = fork();\n\n  if ( reader == -1 ) {\n      printf( \"failed to fork reader\\n\" );\n      exit (1);\n\n  } else if ( reader == 0 ) {\n      printf( \"READER CHILD\\n\" );\n      ret = dup2( pipefd[0], STDIN_FILENO );\n      if ( ret == -1 ) {\n         printf( \"dup2 failed on pipefd[0] %s\" , strerror( errno ) );\n         exit (1);\n      }\n\n      file = fopen( \"out.txt\", \"w\" );\n      if ( file == NULL ) {\n         fputs( \"Could not open file\", stderr );\n         exit (1);\n      }\n\n      ret = dup2( fileno( file ), STDOUT_FILENO );\n      if ( ret == -1 ) {\n         printf( \"dup2 failed on fileno() %s\" , strerror( errno ) );\n         exit (1);\n      }\n\n      fclose( file );\n\n      printf( \"Test values: %d %d\\n\\n\", 234, 598 );\n\n      execl( \"appc1\", \"appc1\", NULL );\n\n      printf( \"execl failed - %s\\n\", strerror( errno ) );\n\n  } else {\n      printf( \"PARENT: forking writer\\n\" );\n\n      writer = fork();\n\n      if ( writer == -1 ) {\n         printf( \"Failed forking writer\\n\" );\n         exit (1);\n\n      } else if ( writer == 0 ) {\n          printf( \"WRITER CHILD\\n\" );\n          sleep( 1 );\n          ret = dup2( pipefd[1], STDOUT_FILENO );\n          if ( ret == -1 ) {\n             printf( \"dup2 failed on pipefd[1] %s\" , strerror( errno ) );\n             exit (1);\n          }\n\n          while( 1 ) {\n              num1 = rand () % 1000 + 1;\n              num2 = rand () % 1000 + 1;\n              printf( \"WRITER CHILD %d %d\\n\", num1, num2 );\n              sleep( 1 );\n          }\n\n      } else {\n          printf( \"PARENT: sleeping\\n\" );\n          sleep( 5 );\n          printf( \"PARENT: sending SIGUSR1 to reader\\n\" );\n          kill( reader, SIGUSR1 );\n          printf( \"PARENT: sending SIGUSR1 to writer\\n\" );\n          kill( writer, SIGUSR1 );\n          wait( NULL );\n          exit( 0 );\n        }\n    }\n}\n</code></pre>\n\n<p>console output:</p>\n\n<pre><code>pipes\nPARENT: creating pipe\nPARENT: forking reader\nPARENT: forking writer\nREADER CHILD\nPARENT: sleeping\nWRITER CHILD\nPARENT: sending SIGUSR1 to reader\nPARENT: sending SIGUSR1 to writer\n</code></pre>\n\n<p>out.txt content:</p>\n\n<pre><code>Test values: 234 598\n\nOutput from appc1\n</code></pre>\n\n<p>When I changed appc1 execl() call to a appc1x (which does not exist) then out.txt contains:</p>\n\n<pre><code>Test values: 234 598\n\nexecl failed - No such file or directory\n</code></pre>\n"}], "owner": {"reputation": 439, "user_id": 2882778, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1785723595/picture?type=large", "display_name": "Jura Brazdil", "link": "https://stackoverflow.com/users/2882778/jura-brazdil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1543, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463595502, "creation_date": 1463584036, "question_id": 37303570, "link": "https://stackoverflow.com/questions/37303570/c-redirecting-stdout-to-a-file-for-process-called-by-exec-in-child-process", "title": "C Redirecting stdout to a file for process called by exec in child process", "body": "<p>I am unable to redirect STDOUT to a file.</p>\n\n<p><strong>I have two processes.</strong> These should run for 5 seconds and then be killed.</p>\n\n<p><strong>Process 1:</strong> redirects its STDOUT to a pipe and then prints random nubers.</p>\n\n<p><strong>Process 2:</strong> redirects its STDIN to the pipe and its STDOUT to file. Then it calls procedure appc1 by execl(). This procedure prints to STDOUT.</p>\n\n<p><strong>Problem:</strong> File out.txt contains the test print done by reader process, but nothing else from the appc1 procedure. If I skip the redirection and print to console, everything works fine.</p>\n\n<p>Could it be an issue caused by killing the processes? Do I close the file too soon? Thank you very much for any advice, I am unable to solve this for quite some time.</p>\n\n<pre><code>ret = pipe(pipefd);\n\nif (ret == -1) {\n    printf(\"Error creating pipe\");\n    exit(1);\n}\n\nreader = fork();\n\nif (reader == 0) {  \n    dup2(pipefd[0], STDIN_FILENO);\n\n    file = fopen(\"out.txt\", \"w\");\n    if(file == NULL) fputs(\"Could not open file\",stderr);\n\n    dup2(fileno(file), STDOUT_FILENO);\n    fclose(file);\n\n    printf(\"Test values: %d %d\\n\\n\", 234, 598);\n\n    execl(\"appc1\",\"appc1\", NULL);\n}\n\nelse {\n    printf(\"PARENT: forking writer\\n\");\n    writer = fork();\n\n    if (writer == 0) {\n        sleep(1);\n        dup2(pipefd[1], STDOUT_FILENO);\n\n        while (1) {\n            num1 = rand() % 1000 + 1;\n            num2 = rand() % 1000 + 1;\n            printf(\"%d %d\\n\", num1, num2);\n            sleep(1);\n        }   \n    }\n    else {\n        sleep(5);\n        kill(reader, SIGUSR1);\n        kill(writer, SIGUSR1);\n        wait(NULL);\n        exit(0);\n    }\n}\n</code></pre>\n\n<p>This is the code.</p>\n\n<p>Thank you guys.</p>\n"}, {"tags": ["c", "recursion", "flood-fill"], "answers": [{"comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1463613248, "post_id": 37305034, "comment_id": 62143946, "body": "note : Cost of a point might not be the shortest since it is a depth-first search."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1463613361, "post_id": 37305034, "comment_id": 62143977, "body": "Right.  If there is a circuit in the maze, the depth-first algorithm may fill in a high value before a lower one.  You&#39;d need to check for an existing value before assigning."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 1, "creation_date": 1463617648, "post_id": 37305034, "comment_id": 62144994, "body": "Right.  You have all the data at your &quot;fingertips&quot; when you print the maze.  With the cost filled in, you can check at each maze location and decide whether you want to print <b>++</b> or a numeric value.  I can&#39;t give specific changes, since you didn&#39;t include maze-printing code.  I expect you can do that part on your own ... ?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1463620001, "post_id": 37305034, "comment_id": 62145586, "body": "There is a need to change <code>if (maze-&gt;M[row][col].type != &#39;.&#39;) return; maze-&gt;M[row][col].type = &#39;+&#39;;</code>."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1463674308, "post_id": 37305034, "comment_id": 62176460, "body": "Actually, you probably want to use MAXINT, a cost larger than anything you&#39;ll generate in a maze.  That way, any actual cost will be cheaper, and you fill it in automatically.  Then there&#39;s no need to check for a marker value."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1463674605, "post_id": 37305034, "comment_id": 62176643, "body": "I don&#39;t see a problem with multiple entries -- literally, because you haven&#39;t provided the logic you use to flood_fill from different starting points.  &quot;It doesn&#39;t work&quot; is not a problem statement.  Also, consider that this may qualify as a separate question."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1463698677, "post_id": 37305034, "comment_id": 62188466, "body": "For every maze location (all rows &amp; cols) set <b>maze-&gt;M[row][col].cost = MAXINT</b>.  If grabbing MAXINT from <b>limits.h</b> is too much trouble, just pick a large number that&#39;s easy to recognize, such as 987654321.  All you need is to have it larger than any path length you&#39;ll generate."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1463760246, "post_id": 37305034, "comment_id": 62217751, "body": "Start at the end and work backwards, going to the neighboring square with a cost one less than the one you&#39;re on.  If there&#39;s more than one such neighbor, either choice is a shortest path.  You might want to look up basic graph traversal algorithms; that&#39;s what you have with a maze."}], "tags": [], "owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "is_accepted": true, "score": 1, "last_activity_date": 1463674250, "last_edit_date": 1463674250, "creation_date": 1463588181, "answer_id": 37305034, "question_id": 37303378, "link": "https://stackoverflow.com/questions/37303378/finding-a-cost-for-a-maze-path/37305034#37305034", "title": "Finding a cost for a maze path", "body": "<p>Pass an extra parameter that is the path cost so far.</p>\n\n<pre><code>flood_fill(m_t * maze, int row, int col, int cost)\n</code></pre>\n\n<p>Each maze location gets an additional attribute, <strong>.cost</strong>, which you update as you flood-fill the maze.  Initialize the cost to MAXINT as a marker.\nFor instance,</p>\n\n<pre><code>    if (maze-&gt;M[row][col].cost &gt; cost)\n      maze-&gt;M[row][col].cost = cost\n\n    // Go LEFT\n    flood_fill(maze, row, col - 1, cost+1);\n    // repeat for the other 3 directions\n</code></pre>\n\n<p>In any case, you now have the cost to each square.  Display as desired when you dump the maze to the screen.</p>\n"}], "owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "accepted_answer_id": 37305034, "answer_count": 1, "score": -2, "last_activity_date": 1463674250, "creation_date": 1463583586, "question_id": 37303378, "link": "https://stackoverflow.com/questions/37303378/finding-a-cost-for-a-maze-path", "title": "Finding a cost for a maze path", "body": "<p>I have this maze:</p>\n\n<pre><code>    ##++##############\n    ##++++++++++++++##\n    ########++########\n    ##++++++++##----##\n    ##++########--####\n</code></pre>\n\n<p>The \"#\" symbols are walls in the maze.</p>\n\n<p>The \"+\" regions of the maze are reachable regions of the maze from the entry point, and the \"-\" region of the maze are unreachable from the entry point. The entry point is located at the top of the maze. </p>\n\n<p>What I would like to do now is plot a cost of the reachable regions in the maze, which will look like this:</p>\n\n<pre><code>    ##00##############\n    ##++02++04++06++##\n    ########++########\n    ##++08++06##----##\n    ##10########--####\n</code></pre>\n\n<p>This shows that the maze has a cost of 10 from entry to exit. </p>\n\n<p>The maze up top is stored in a 2d array and I used recursion to solve the reachable zones. How can I label costs of the paths using my recursive function, which looks like this:</p>\n\n<pre><code>    void\n    flood_fill(m_t * maze, int row, int col) {\n        // If row,col is outside maze\n        if ( row &lt; 0 || row &gt;= maze-&gt;height || col &lt; 0 || col &gt;= maze-&gt;width) return;\n        // If row,col is not open\n        if (maze-&gt;M[row][col].type != '.') return;\n\n        // Mark row,col as part of path.\n        maze-&gt;M[row][col].type = '+';\n\n        // Go LEFT\n        flood_fill(maze, row, col - 1);\n        // Go DOWN\n        flood_fill(maze, row + 1, col);\n        // Go RIGHT\n        flood_fill(maze, row, col + 1);\n        // Go UP\n        flood_fill(maze, row - 1, col);\n\n        return;\n    }\n</code></pre>\n\n<p>For the first maze, I used this recursive function at the top of the maze, and it flood filled all the reachable cells with \"+\". </p>\n\n<p>Are there any suggestions as to how I can do something similar to this but with the path costs instead. I'm just looking for some examples or suggestions as to how I might go about it. Any help on how I can go about achieving the second maze example would be helpful. </p>\n"}, {"tags": ["c", "linux"], "answers": [{"comments": [{"owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1463583949, "post_id": 37303479, "comment_id": 62128872, "body": "I was hoping to avoid a library, but your link tipped me off to kqueue, so perhaps I can just write a monitor using that API and #ifdef to it when I&#39;m not on Linux..."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "reply_to_user": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "edited": false, "score": 0, "creation_date": 1463584184, "post_id": 37303479, "comment_id": 62129032, "body": "fswatch needs N different backends because there <i>isn&#39;t</i> a single efficient, portable approach -- if there were, the tooling for the job would be much simpler."}], "tags": [], "owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "is_accepted": false, "score": 2, "last_activity_date": 1463583809, "creation_date": 1463583809, "answer_id": 37303479, "question_id": 37303370, "link": "https://stackoverflow.com/questions/37303370/portable-way-to-wait-for-process-to-open-file/37303479#37303479", "title": "Portable way to wait for process to open file?", "body": "<p>There are several available libraries or command-line tools suitable for this purpose with backends that span Linux and MacOS.</p>\n\n<p>Consider <A HREF=\"https://github.com/emcrisostomo/fswatch\" rel=\"nofollow\">fswatch</A>, or one of its competitors (if we got down to debating individual libraries, this would be in explicitly-off-topic territory).</p>\n"}], "owner": {"reputation": 12864, "user_id": 157525, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5820228fd7aefaba2a8bfb0503b9e2a8?s=128&d=identicon&r=PG", "display_name": "gct", "link": "https://stackoverflow.com/users/157525/gct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463583809, "creation_date": 1463583573, "question_id": 37303370, "link": "https://stackoverflow.com/questions/37303370/portable-way-to-wait-for-process-to-open-file", "title": "Portable way to wait for process to open file?", "body": "<p>Is there a way in Linux, that's reasonably portable (mainly to OSX/BSDs) to wait for a process to open a file?  I know I can use inotify for this, but OSX doesn't support it.  One caveat is that I won't actually know the PID of the process, so it's exec()-ed via /bin/sh like popen, so just monitoring it's /proc//fd directory won't work either.</p>\n"}, {"tags": ["c", "struct", "int"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1463583374, "post_id": 37303239, "comment_id": 62128384, "body": "<code>for(i=1;i&lt;=n;i++)</code> is probably fishy..............."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1463583497, "post_id": 37303239, "comment_id": 62128489, "body": "Defining types in <code>main</code>? hm.."}, {"owner": {"reputation": 355, "user_id": 6194673, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh3.googleusercontent.com/-7NIITuVcetA/AAAAAAAAAAI/AAAAAAAAABo/gR9j9BARous/photo.jpg?sz=128", "display_name": "Lame Fanello", "link": "https://stackoverflow.com/users/6194673/lame-fanello"}, "edited": false, "score": 0, "creation_date": 1463583501, "post_id": 37303239, "comment_id": 62128492, "body": "I did the same statement in my previous program. I did not have this kind of problem."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1463583527, "post_id": 37303239, "comment_id": 62128526, "body": "also, type of <code>val</code> will cause pain later...oops, see the <code>strcmp()</code>."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1463583651, "post_id": 37303239, "comment_id": 62128619, "body": "<code>printf(&quot;Codul produsului: %i\\n&quot;, a[i].cod);</code> - cod is an array. I don&#39;t think you want the <code>ints</code> in <code>elemente</code> to be arrays."}, {"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 0, "creation_date": 1463583664, "post_id": 37303239, "comment_id": 62128629, "body": "Not testing the return value from <code>scanf</code> is a sure recipe for surprises."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1463583710, "post_id": 37303239, "comment_id": 62128673, "body": "Your struct declares <i>arrays</i> of <code>int</code>s and an <i>array</i> of <code>char *</code>.  Do you mean it to have a single one of each, and then declare an array of such structs?"}, {"owner": {"reputation": 566, "user_id": 4667104, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-rGRu3uu46Vg/AAAAAAAAAAI/AAAAAAAAAS4/sFeLdQuPwdU/photo.jpg?sz=128", "display_name": "Elvis Teixeira", "link": "https://stackoverflow.com/users/4667104/elvis-teixeira"}, "edited": false, "score": 0, "creation_date": 1463583924, "post_id": 37303239, "comment_id": 62128849, "body": "to the name of the product use char prod[20]; no need for * here, since you probably don&#39;t want an array of pointers."}, {"owner": {"reputation": 566, "user_id": 4667104, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-rGRu3uu46Vg/AAAAAAAAAAI/AAAAAAAAAS4/sFeLdQuPwdU/photo.jpg?sz=128", "display_name": "Elvis Teixeira", "link": "https://stackoverflow.com/users/4667104/elvis-teixeira"}, "edited": false, "score": 0, "creation_date": 1463583992, "post_id": 37303239, "comment_id": 62128909, "body": "the <code>int</code> variables doesn&#39;t need to be declared as arrays since you will use an array of structs."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1463585185, "creation_date": 1463585185, "answer_id": 37303984, "question_id": 37303239, "link": "https://stackoverflow.com/questions/37303239/int-doesnt-work-in-struct/37303984#37303984", "title": "Int doesn&#39;t work in struct", "body": "<p>The problem is that your <code>struct</code> contains arrays of each element instead of a single one.  This is also why the multiplication <code>a[i].cant*a[i].pret</code> won't compile, because you're attempting to multiply two <code>int [20]</code> instead of 2 <code>int</code>.</p>\n\n<p>Since you create an array of <code>struct elemente</code>, you only need to input one element in each one:</p>\n\n<pre><code>struct elemente {\n    char prod[50];\n    int cod;\n    int cant;\n    int pret;\n};\n</code></pre>\n\n<p>You would then change the <code>scanf</code> call to read in <code>prod</code> as follows to make sure you don't read more characters than the value can handle:</p>\n\n<pre><code>scanf(\"%49s\",a[i].prod);\n</code></pre>\n\n<p>Also, be sure to check the return value of <code>scanf</code> to see whether a value was actually read in.</p>\n"}, {"tags": [], "owner": {"reputation": 3543, "user_id": 6329118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a20c0ed8a82fd967952e2539203af9?s=128&d=identicon&r=PG&f=1", "display_name": "CWLiu", "link": "https://stackoverflow.com/users/6329118/cwliu"}, "is_accepted": false, "score": 0, "last_activity_date": 1463587515, "creation_date": 1463587515, "answer_id": 37304807, "question_id": 37303239, "link": "https://stackoverflow.com/questions/37303239/int-doesnt-work-in-struct/37304807#37304807", "title": "Int doesn&#39;t work in struct", "body": "<p>The strange code, in\n<code>printf(\"Codul produsului: %i\\n\", a[i].cod)</code> case, is because you try to print the address of <code>a[i].cod</code> instead of the value of integer.</p>\n\n<p>The easiest way to fix this is modify your struct to:</p>\n\n<pre><code>struct elemente {\n   char *prod[20];\n   int cod;\n   int cant;\n   int pret;\n};\n</code></pre>\n\n<p>It seems there's no requirement to assign int arrays in your struct, int variables are sufficient.\nAfter this modification,</p>\n\n<pre><code>p[i]=a[i].cant*a[i].pret;\nprintf(\"Valoarea totala a elementelor %i\\n\",p[i]);\n</code></pre>\n\n<p>should be ok to work.</p>\n"}], "owner": {"reputation": 355, "user_id": 6194673, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh3.googleusercontent.com/-7NIITuVcetA/AAAAAAAAAAI/AAAAAAAAABo/gR9j9BARous/photo.jpg?sz=128", "display_name": "Lame Fanello", "link": "https://stackoverflow.com/users/6194673/lame-fanello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "closed_date": 1464300329, "accepted_answer_id": 37303984, "answer_count": 2, "score": -2, "last_activity_date": 1463587515, "creation_date": 1463583288, "last_edit_date": 1463585988, "question_id": 37303239, "link": "https://stackoverflow.com/questions/37303239/int-doesnt-work-in-struct", "closed_reason": "Not suitable for this site", "title": "Int doesn&#39;t work in struct", "body": "<p><code>int</code> doesn't seem to work with <code>struct</code> and I don't know why. I did the same thing as before and it worked but now it doesn't.</p>\n\n<p>This is the main code.</p>\n\n<pre><code>int main()\n{\n    struct elemente {\n    char *prod[20];\n    int cod[20];\n    int cant[20];\n    int pret[20];\n    };\n\n    struct elemente a[20];\n    int i,n=1,p[20];\n    char *val[20];\n    for(i=1;i&lt;=n;i++){\n        puts(\"Numele produsului\");\n        scanf(\"%s\",&amp;a[i].prod);\n        puts(\"Codul\");\n        scanf(\"%i\",&amp;a[i].cod);\n        puts(\"Cantitatea\");\n        scanf(\"%i\",&amp;a[i].cant);\n        puts(\"Pretul\");\n        scanf(\"%i\",&amp;a[i].pret);\n    }\n</code></pre>\n\n<p>It works and I dont see it having problems.</p>\n\n<p>This is where the problem is.</p>\n\n<pre><code>puts(\"Scrieti numele produsului\");scanf(\"%s\", &amp;val);\n\n    for(i=1;i&lt;=n;i++){\n        if(strcmp(val,a[i].prod)==0){\n            printf(\"Codul produsului: %i\\n\", a[i].cod);\n            printf(\"Cantitatea: %i\\n\", a[i].cant);\n            printf(\"Pretul: %i\\n\", a[i].pret);\n            //p[i]=a[i].cant*a[i].pret;\n            //printf(\"Valoarea totala a elementelor %i\\n\",p[i]);\n        }\n    }\n</code></pre>\n\n<p>The <code>strcmp</code> works fine. But it cannot find the integer numbers I have input with my <code>scanf</code>. It shows a strange code like \"2303134\". What did I do wrong?\nAlso as you can see I need to multiply 2 functions but CodeBlocks has problems with the <code>*</code> symbol. How can I fix this?</p>\n"}, {"tags": ["c", "encryption", "cryptography"], "comments": [{"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1463583715, "post_id": 37303176, "comment_id": 62128681, "body": "Don&#39;t you need to use the inverse sbox in the decrypt function?"}, {"owner": {"reputation": 13, "user_id": 6334721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e84cd35c266e5411c78386306bd50f7a?s=128&d=identicon&r=PG&f=1", "display_name": "Wdghd", "link": "https://stackoverflow.com/users/6334721/wdghd"}, "reply_to_user": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1463583974, "post_id": 37303176, "comment_id": 62128896, "body": "@KlasLindb&#228;ck, I&#39;ve already tried that, still gives incorrect results - hence I was questioning my implementation. Also, there&#39;s no mention of an inverse sbox in any of the (rather lacking) documentation on Treyfer"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463584043, "post_id": 37303176, "comment_id": 62128939, "body": "<code>void encrypt (uint8_t text[8], uint8_t key[8]) { ....  text[8] = text[0];</code> is suspicious.  <code>text[8]</code> may be out of bounds depending on what is truly passed."}, {"owner": {"reputation": 13, "user_id": 6334721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e84cd35c266e5411c78386306bd50f7a?s=128&d=identicon&r=PG&f=1", "display_name": "Wdghd", "link": "https://stackoverflow.com/users/6334721/wdghd"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463584212, "post_id": 37303176, "comment_id": 62129048, "body": "@chux will look into that, use a temp variable like wikipedia - that&#39;s based off of another encryption implementation I&#39;ve seen"}, {"owner": {"reputation": 16685, "user_id": 2289509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F51FU.jpg?s=128&g=1", "display_name": "Elazar", "link": "https://stackoverflow.com/users/2289509/elazar"}, "edited": false, "score": 1, "creation_date": 1463584232, "post_id": 37303176, "comment_id": 62129074, "body": "You reversed the encrypt loop incorrectly, and you are out of bounds by 2"}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1463584488, "post_id": 37303176, "comment_id": 62129268, "body": "If you are looking for secure encryption just use AES."}, {"owner": {"reputation": 13, "user_id": 6334721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e84cd35c266e5411c78386306bd50f7a?s=128&d=identicon&r=PG&f=1", "display_name": "Wdghd", "link": "https://stackoverflow.com/users/6334721/wdghd"}, "reply_to_user": {"reputation": 16685, "user_id": 2289509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F51FU.jpg?s=128&g=1", "display_name": "Elazar", "link": "https://stackoverflow.com/users/2289509/elazar"}, "edited": false, "score": 0, "creation_date": 1463584518, "post_id": 37303176, "comment_id": 62129290, "body": "@Elazar mind giving me a nudge in the right direction w/r/t the encrypt loop?"}, {"owner": {"reputation": 13, "user_id": 6334721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e84cd35c266e5411c78386306bd50f7a?s=128&d=identicon&r=PG&f=1", "display_name": "Wdghd", "link": "https://stackoverflow.com/users/6334721/wdghd"}, "reply_to_user": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1463584534, "post_id": 37303176, "comment_id": 62129304, "body": "@zaph I&#39;m specifically looking for insecure encryption."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463584702, "post_id": 37303176, "comment_id": 62129401, "body": "<code>text[8]</code> as used in <code>encrypt ()</code> and <code>decrypt()</code> really only needs to be a local variable to the function and need not be passed in.  I do not think that part of code is as problem as you pass in a 9 byte array"}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1463584736, "post_id": 37303176, "comment_id": 62129427, "body": "Then consider <a href=\"https://en.wikipedia.org/wiki/Tiny_Encryption_Algorithm\" rel=\"nofollow noreferrer\">Tiny Encryption Algorithm</a> but it many not be insecure enough, in that case there is always <a href=\"https://en.wikipedia.org/wiki/Caesar_cipher\" rel=\"nofollow noreferrer\">Caesar cipher</a> ;-)."}, {"owner": {"reputation": 13, "user_id": 6334721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e84cd35c266e5411c78386306bd50f7a?s=128&d=identicon&r=PG&f=1", "display_name": "Wdghd", "link": "https://stackoverflow.com/users/6334721/wdghd"}, "reply_to_user": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 1, "creation_date": 1463584790, "post_id": 37303176, "comment_id": 62129459, "body": "@zaph I&#39;m specifically looking for a slide attack, which treyfer happens to be a more or less perfect example for ;)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463584818, "post_id": 37303176, "comment_id": 62129476, "body": "In decrypt, don&#39;t you want to start with <code>text[0] = text[8];</code> .... <code>text[8] = text[0];</code>?  You are shifting the other way than encrypt."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1463584949, "post_id": 37303176, "comment_id": 62129580, "body": "<code>for (i=8; i&gt;=0; --i)</code> does 9 loops."}, {"owner": {"reputation": 13, "user_id": 6334721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e84cd35c266e5411c78386306bd50f7a?s=128&d=identicon&r=PG&f=1", "display_name": "Wdghd", "link": "https://stackoverflow.com/users/6334721/wdghd"}, "edited": false, "score": 0, "creation_date": 1463585036, "post_id": 37303176, "comment_id": 62129634, "body": "that wouldn&#39;t quite work, chux - text[8] is just a temporary value which wouldn&#39;t be set going into that loop"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463585281, "post_id": 37303176, "comment_id": 62129820, "body": "When <code>i=7</code>, the decrypt loop is <code>text[7+1] = ...</code>.  Is this your intent?"}], "answers": [{"tags": [], "owner": {"reputation": 1210, "user_id": 4849753, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8Wn2Od4mruA/AAAAAAAAAAI/AAAAAAAAADw/tviPWulv0sc/photo.jpg?sz=128", "display_name": "Marek Klein", "link": "https://stackoverflow.com/users/4849753/marek-klein"}, "is_accepted": true, "score": 6, "last_activity_date": 1463692085, "last_edit_date": 1463692085, "creation_date": 1463689750, "answer_id": 37333413, "question_id": 37303176, "link": "https://stackoverflow.com/questions/37303176/encryption-implementation-confusing-results/37333413#37333413", "title": "Encryption Implementation - Confusing results", "body": "<p>I assume your implementation is based on this: <a href=\"https://en.wikipedia.org/wiki/Treyfer\" rel=\"noreferrer\">https://en.wikipedia.org/wiki/Treyfer</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdint.h&gt;\n\n#define NUMROUNDS 100\n\nstatic const uint8_t sbox[256] =   {\n  //0     1    2      3     4    5     6     7      8    9     A      B    C     D     E     F\n  0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76,\n  0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0,\n  0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc, 0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15,\n  0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75,\n  0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84,\n  0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf,\n  0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85, 0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8,\n  0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2,\n  0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73,\n  0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb,\n  0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79,\n  0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08,\n  0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a,\n  0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e,\n  0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf,\n  0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68, 0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16 };\n\nvoid treyfer_encrypt(uint8_t text[8], uint8_t const key[8])\n{\n    unsigned i;\n    uint8_t t = text[0];\n    for (i = 0; i &lt; 8*NUMROUNDS; i++) {\n        t += key[i%8];\n        t = sbox[t] + text[(i+1)%8];\n        text[(i+1) % 8] = t = (t &lt;&lt; 1) | (t &gt;&gt; 7);        /* Rotate left 1 bit */\n    }\n}\n\nvoid encrypt(uint8_t text[8], uint8_t const key[8])\n{\n    unsigned int i = 0;\n    unsigned int j = 0;\n    uint8_t t = 0;\n\n    t = text[0];\n\n    for (j = 0; j &lt; NUMROUNDS; j++)\n    {\n        for (i = 0; i &lt; 8; i++)\n        {\n            t = t + key[i];\n            t = sbox[t] + text[(i + 1) % 8];\n            t = (t &lt;&lt; 1) | (t &gt;&gt; 7);\n            text[(i + 1) % 8] = t;\n        }\n    }\n}\n\nvoid decrypt(uint8_t text[8], uint8_t const key[8])\n{\n    int i = 0;\n    int j = 0;\n    uint8_t top = 0;\n    uint8_t bottom = 0;\n\n    for (j = 0; j &lt; NUMROUNDS; j++)\n    {\n        for (i = 7; i &gt;= 0; i--)\n        {\n            top = text[i] + key[i];\n            top = sbox[top];\n\n            bottom = text[(i + 1) % 8];\n            bottom = (bottom &gt;&gt; 1) | (bottom &lt;&lt; 7);\n\n            text[(i + 1) % 8] = bottom - top;\n        }\n    }\n}\n\n\nvoid printhex(uint8_t text[8]) {\n    int i;\n    for(i = 0; i &lt; 8; i++) {\n        printf(\"%02x\", text[i]);\n    }\n}\nint main() {\n    uint8_t text[8] = \"AAAAAAAA\";\n    uint8_t text2[8] = \"AAAAAAAA\";\n    uint8_t key[8] = \"AAAAAAAA\";\n\n    puts(\"plaintext:\");\n    printhex(text);\n\n    puts(\"\\nkey:\");\n    printhex(key);\n\n    puts(\"\\n\\nref encrypted:\");\n    treyfer_encrypt(text, key);\n    printhex(text);\n\n    puts(\"\\n\\nencrypted:\");\n    encrypt(text2, key);\n    printhex(text2);\n\n    puts(\"\\n\\ndecrypted:\");\n    decrypt(text2, key);\n    printhex(text2);\n    puts(\"\\n\");\n}\n</code></pre>\n\n<p>results</p>\n\n<pre><code>plaintext:\n4141414141414141\nkey:\n4141414141414141\n\nref encrypted:\ncc3121ccab578d93\n\nencrypted:\ncc3121ccab578d93\n\ndecrypted:\n4141414141414141\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6334721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e84cd35c266e5411c78386306bd50f7a?s=128&d=identicon&r=PG&f=1", "display_name": "Wdghd", "link": "https://stackoverflow.com/users/6334721/wdghd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 37333413, "answer_count": 1, "score": 1, "last_activity_date": 1463692085, "creation_date": 1463583114, "last_edit_date": 1463583869, "question_id": 37303176, "link": "https://stackoverflow.com/questions/37303176/encryption-implementation-confusing-results", "title": "Encryption Implementation - Confusing results", "body": "<p>I'm trying to use simple encryption/decryption (treyfer) for a project of mine, but there's no reference implementation of decryption available. What I've got (based off of the Wikipedia implementation) is:</p>\n\n<pre><code>uint8_t rotl(uint8_t x) {\n  return (x &lt;&lt; 1) | (x &gt;&gt; 7);\n}\n\nuint8_t rotr(uint8_t x) {\n  return (x &gt;&gt; 1) | (x &lt;&lt; 7);\n}\n\nvoid encrypt (uint8_t text[8], uint8_t key[8]) {\n  int r, i;\n  uint8_t t;\n\n  for (r=0; r&lt;NUMROUNDS; r++) {\n      text[8] = text[0];\n      for (i=0; i&lt;8; i++) {\n          text[i+1] = rotl((text[i+1] + sbox[(key[i] + text[i]) % 256]));\n      }\n      text[0] = text[8];\n  }\n}\n\nvoid decrypt (uint8_t text[8], uint8_t key[8]) {\n    int r, i;\n    uint8_t t;\n\n    for (r=0; r&lt;NUMROUNDS; r++) {\n        text[8] = text[0];\n        for (i=8; i&gt;=0; --i) {\n            text[i+1] = rotr(text[i+1]) - sbox[(key[i] + text[i]) % 256];\n        }\n        text[0] = text[8];\n    }\n}\n\n\nvoid printhex(uint8_t text[8]) {\n    for(int i = 0; i &lt; 8; i++) {\n        printf(\"%02x\", text[i]);\n    }\n}\nint main() { \n    char text[8+1] = \"AAAAAAAA\";\n    char key[8+1] = \"AAAAAAAA\";\n    puts(\"plaintext:\");\n    printhex(text);\n    puts(\"\\nkey:\");\n    printhex(key);\n    puts(\"\\nencrypted:\");\n    encrypt(text, key);\n         printhex(text);\n         puts(\"\\ndecrypted:\");\n        decrypt(text, key);\n        printhex(text);\n    }\n</code></pre>\n\n<p>Where Sbox is the AES S-box, and NUMROUNDS = 128\nHowever, when I run this, I get wildly different results for the plaintext and the decrypted value, suggesting either my encryption or decryption is incorrect, but I can't quite see how. Hoping I haven't missed anything too painful.\nThe output I get is:</p>\n\n<pre><code>plaintext:\n4141414141414141\nkey:\n4141414141414141\nencrypted:\n658ed27d394127a0\ndecrypted:\na0460a65d755953f\n</code></pre>\n"}, {"tags": ["c", "tcl", "tk"], "comments": [{"owner": {"reputation": 119001, "user_id": 301832, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/965220a70d38e6a29466f44cdb4f804e?s=128&d=identicon&r=PG", "display_name": "Donal Fellows", "link": "https://stackoverflow.com/users/301832/donal-fellows"}, "edited": false, "score": 0, "creation_date": 1463601553, "post_id": 37302945, "comment_id": 62139205, "body": "Any reason for using 8.4? The current long-term support option is 8.5 and the current release recommended for new code is 8.6. 8.4 has been out of support for a few years now."}, {"owner": {"reputation": 63, "user_id": 6351582, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-drWrcAhthMk/AAAAAAAAAAI/AAAAAAAAALA/ixXZOhQqDII/photo.jpg?sz=128", "display_name": "ali rasteh", "link": "https://stackoverflow.com/users/6351582/ali-rasteh"}, "reply_to_user": {"reputation": 119001, "user_id": 301832, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/965220a70d38e6a29466f44cdb4f804e?s=128&d=identicon&r=PG", "display_name": "Donal Fellows", "link": "https://stackoverflow.com/users/301832/donal-fellows"}, "edited": false, "score": 0, "creation_date": 1463635858, "post_id": 37302945, "comment_id": 62149512, "body": "@DonalFellows : thanks for your comment; actually there is not any need to use 8.4 version, I have already installed 8.5 and 8.6 packages and all of these 3 packages work with tclsh but the problem with C wrapping persists."}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1463646889, "post_id": 37302945, "comment_id": 62155635, "body": "What does happend if you replace <code>code = Tcl_Eval(interp, &quot;source mainTCL.tcl&quot;);</code> by <code>code = Tcl_Eval(interp, &quot;&#47;usr&#47;share&#47;tcltk&#47;tkcon2.7&#47;tkcon.tcl&quot;);</code>? Can you locate the error in <code>tkcon.tcl</code> file?"}, {"owner": {"reputation": 63, "user_id": 6351582, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-drWrcAhthMk/AAAAAAAAAAI/AAAAAAAAALA/ixXZOhQqDII/photo.jpg?sz=128", "display_name": "ali rasteh", "link": "https://stackoverflow.com/users/6351582/ali-rasteh"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1463656708, "post_id": 37302945, "comment_id": 62162605, "body": "@purplepsycho : It shows same error and I realized that the error is located at below command in tkcon.tcl file: &quot;package require Tk 8.4&quot; ; I tried to replace the command to use TK 8.5 or TK 8.6 packages but the problem isn&#39;t resolved."}], "owner": {"reputation": 63, "user_id": 6351582, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-drWrcAhthMk/AAAAAAAAAAI/AAAAAAAAALA/ixXZOhQqDII/photo.jpg?sz=128", "display_name": "ali rasteh", "link": "https://stackoverflow.com/users/6351582/ali-rasteh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 818, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1463640541, "creation_date": 1463582562, "last_edit_date": 1495540364, "question_id": 37302945, "link": "https://stackoverflow.com/questions/37302945/error-in-script-cant-find-package-tk-8-4-c-wrapped-tcl", "title": "ERROR in script: can&#39;t find package Tk 8.4 (c wrapped tcl)", "body": "<p>I've encountered the above mentioned error while I was trying to run a Tcl script embedded in C code:</p>\n\n<pre><code>Tcl_FindExecutable(argv[0]);\ninterp = Tcl_CreateInterp();\ncode = Tcl_Eval(interp, \"source mainTCL.tcl\");\n\n/* Retrieve the result... */\nresult = Tcl_GetString(Tcl_GetObjResult(interp));\n\n/* Check for error! If an error, message is result. */\nif (code == TCL_ERROR) {\n    fprintf(stderr, \"ERROR in script: %s\\n\", result);\n    exit(1);\n}\n</code></pre>\n\n<p>As suggested here: <a href=\"https://stackoverflow.com/questions/13853770/how-to-use-tcl-apis-in-a-c-code\">how-to-use-tcl-apis-in-a-c-code</a>.</p>\n\n<p>When running this script from tclsh there is no error. I also tried setting <code>$auto_path</code> but it is not working.\nI traced where error is happening by adding <code>puts</code> and it is here:</p>\n\n<pre><code>source \"/usr/share/tcltk/tkcon2.7/tkcon.tcl\"\n</code></pre>\n\n<p>What is the problem? Any help is appreciated... What is the difference between tclsh and C instance of Tcl interpreter?</p>\n"}, {"tags": ["c", "pointers", "segmentation-fault", "pthreads"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1463582972, "post_id": 37302936, "comment_id": 62128058, "body": "<code>NVALORES</code> not defined."}, {"owner": {"reputation": 382, "user_id": 6341202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lHob9.jpg?s=128&g=1", "display_name": "Daniel Almeida", "link": "https://stackoverflow.com/users/6341202/daniel-almeida"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463583510, "post_id": 37302936, "comment_id": 62128505, "body": "It&#39;s actually defined, just didn&#39;t include it here."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463583553, "post_id": 37302936, "comment_id": 62128550, "body": "It could be important if not the real problem answered by Fred."}, {"owner": {"reputation": 382, "user_id": 6341202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lHob9.jpg?s=128&g=1", "display_name": "Daniel Almeida", "link": "https://stackoverflow.com/users/6341202/daniel-almeida"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463583625, "post_id": 37302936, "comment_id": 62128596, "body": "I just said it is defined, I just didn&#39;t copy paste the whole code on here. Either way, Fred&#39;s answer solved it for me. Thanks anyway."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1463583692, "post_id": 37302936, "comment_id": 62128661, "body": "Technically, this question could be closed as off topic because it does not include an <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>. It is not complete because (among other things) <code>NVALORES</code> is not defined."}, {"owner": {"reputation": 382, "user_id": 6341202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lHob9.jpg?s=128&g=1", "display_name": "Daniel Almeida", "link": "https://stackoverflow.com/users/6341202/daniel-almeida"}, "edited": false, "score": 0, "creation_date": 1463583878, "post_id": 37302936, "comment_id": 62128812, "body": "I edited <code>NVALORES</code> in to make it complete, what else is missing besides it ? Sorry for the newbie question, fairly new to stackoverflow."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1463583960, "post_id": 37302936, "comment_id": 62128878, "body": "I should be able to copy and paste your example into my editor or IDE and reproduce the problem. This should include the required header files, and I think you need a prototype of <code>run</code>."}, {"owner": {"reputation": 382, "user_id": 6341202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lHob9.jpg?s=128&g=1", "display_name": "Daniel Almeida", "link": "https://stackoverflow.com/users/6341202/daniel-almeida"}, "edited": false, "score": 0, "creation_date": 1463584075, "post_id": 37302936, "comment_id": 62128961, "body": "Should I edit them in now or just leave it be since the I closed the question ?"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1463584130, "post_id": 37302936, "comment_id": 62128998, "body": "It would be better to have it complete. I also find that <code>vetor</code> is not defined."}, {"owner": {"reputation": 382, "user_id": 6341202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lHob9.jpg?s=128&g=1", "display_name": "Daniel Almeida", "link": "https://stackoverflow.com/users/6341202/daniel-almeida"}, "edited": false, "score": 0, "creation_date": 1463584413, "post_id": 37302936, "comment_id": 62129206, "body": "Okay, done, I think it&#39;s all set now, thanks again for all your help!"}], "answers": [{"comments": [{"owner": {"reputation": 382, "user_id": 6341202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lHob9.jpg?s=128&g=1", "display_name": "Daniel Almeida", "link": "https://stackoverflow.com/users/6341202/daniel-almeida"}, "edited": false, "score": 0, "creation_date": 1463583429, "post_id": 37303124, "comment_id": 62128421, "body": "Btw, one more question, on my friends computer running Netbeans 8.1 on Ubuntu the program works and it&#39;s exactly copy pasted from mine running on Geany 1.25, any valid reason for this ? The compiler used is gcc btw. Thanks in advance."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 382, "user_id": 6341202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lHob9.jpg?s=128&g=1", "display_name": "Daniel Almeida", "link": "https://stackoverflow.com/users/6341202/daniel-almeida"}, "edited": false, "score": 1, "creation_date": 1463583597, "post_id": 37303124, "comment_id": 62128582, "body": "Most likely undefined behavior. One of the nifty things about UB is that it includes the possibility of working just fine, seg faulting, or summoning <a href=\"http://www.catb.org/jargon/html/N/nasal-demons.html\" rel=\"nofollow noreferrer\">nasal demons</a>."}, {"owner": {"reputation": 267, "user_id": 6306927, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/KzgRF.jpg?s=128&g=1", "display_name": "Xavier Silva", "link": "https://stackoverflow.com/users/6306927/xavier-silva"}, "edited": false, "score": 0, "creation_date": 1463584154, "post_id": 37303124, "comment_id": 62129009, "body": "@FredLarson It is strange because the assertion of <code>threads[i]</code> when calling <code>pthread_create</code> could not be in another order, could it? Do you think their compilers are making the assertion in different orders?  Since the code uses the array again (in order to join threads) I don&#39;t think the compiler could act differently. If they didn&#39;t use the array it could, in my opinion, be explained by not performing the assertion (since it would not be used), this way it is really weird. What do you think?"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 267, "user_id": 6306927, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/KzgRF.jpg?s=128&g=1", "display_name": "Xavier Silva", "link": "https://stackoverflow.com/users/6306927/xavier-silva"}, "edited": false, "score": 0, "creation_date": 1463584857, "post_id": 37303124, "comment_id": 62129504, "body": "@XavierSilva: I am having trouble understanding your question, especially your use of the word &quot;assertion&quot;. But what I believe is happening is that the use of <code>thread[i]</code> to receive the return value is replacing the thread id (set by <code>pthread_create</code> through the pointer in the first argument) with the error code returned by <code>pthread_create</code>. This value is then used in <code>pthread_join</code>, leading to undefined behavior because it is not a valid thread id. Nasal demons."}, {"owner": {"reputation": 267, "user_id": 6306927, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/KzgRF.jpg?s=128&g=1", "display_name": "Xavier Silva", "link": "https://stackoverflow.com/users/6306927/xavier-silva"}, "edited": false, "score": 0, "creation_date": 1463585347, "post_id": 37303124, "comment_id": 62129868, "body": "Basically, what I&#39;m asking is, since he&#39;s using the <code>thread[i]</code>to receive the return value of <code>pthread_create</code> and then using it in <code>pthread_join</code>, how does the compiler still figure it out and runs the program? I don&#39;t think this can fall under the category of undefined behaviour because given that the value is used again, the compiler shouldn&#39;t be able to discard the use of the variable and work in one system but not the other."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 1, "creation_date": 1463585827, "post_id": 37303124, "comment_id": 62130235, "body": "I see no reason to expect that from the compiler. The double-edged sword of C is that it assumes the programmer knows what (s)he is doing and uses that assumption to avoid a lot of overhead. This leads to very efficient code and short compile times. It also leads to a lot of undefined behavior when that basic assumption is incorrect."}], "tags": [], "owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "is_accepted": true, "score": 5, "last_activity_date": 1463582967, "creation_date": 1463582967, "answer_id": 37303124, "question_id": 37302936, "link": "https://stackoverflow.com/questions/37302936/segmentation-fault-when-using-pthread-join-in-c/37303124#37303124", "title": "Segmentation fault when using pthread_join in C", "body": "<p>You're misusing the return value of <code>pthread_create</code>. It does not return a thread id. It returns an error code, so you're clobbering the thread id and making your <code>pthread_join</code> call invalid.</p>\n"}], "owner": {"reputation": 382, "user_id": 6341202, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lHob9.jpg?s=128&g=1", "display_name": "Daniel Almeida", "link": "https://stackoverflow.com/users/6341202/daniel-almeida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 37303124, "answer_count": 1, "score": 2, "last_activity_date": 1463584390, "creation_date": 1463582536, "last_edit_date": 1463584390, "question_id": 37302936, "link": "https://stackoverflow.com/questions/37302936/segmentation-fault-when-using-pthread-join-in-c", "title": "Segmentation fault when using pthread_join in C", "body": "<p>So, I was working on some of my homework and I'm stuck on this seg. fault I got when trying to call pthread_join.</p>\n\n<p>I have tried different solutions including creating a void pointer to send to the pthread_join call. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;sys/mman.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;time.h&gt;\n#include &lt;pthread.h&gt;\n\n#define NTHREADS 5\n#define NVALORES 1000\n#define NUMBER_PROCURADO 890\n\nvoid * run(void *arg);\nvoid fillVector();\nint vetor[NVALORES];\n\nint main(){\n\n    int i, vetor2[NTHREADS];\n    pthread_t threads[NTHREADS];\n    fillVector();\n    for (i = 0; i &lt; NTHREADS; i++){\n        vetor2[i]=i;\n        threads[i]= pthread_create(&amp;threads[i], NULL, run, &amp;vetor2[i]);\n    }\n\n    for (i = 0; i &lt; NTHREADS; i++){\n        pthread_join(threads[i], NULL);\n    }\n\n    return 0;\n}\n\nvoid * run(void * arg){\n    int *pos = (int *) arg;\n\n    int i;\n    for (i = NVALORES/NTHREADS*(*pos); i &lt; NVALORES/NTHREADS*((*pos)+1); i++){\n        if(vetor[i]==NUMBER_PROCURADO){\n            printf(\"Found it! Position: %d\\n\",i);\n        }\n        pthread_exit( (void*)pos);\n    }\n    pthread_exit( (void*)NULL);\n}\n\nvoid fillVector(){\n    int i;\n    for (i = 0; i &lt; NVALORES; i++){\n        vetor[i] = i+1;\n    }    \n}\n</code></pre>\n"}, {"tags": ["c++", "c", "visual-studio-2010", "visual-studio-2013", "systemc"], "answers": [{"tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 1, "last_activity_date": 1463581901, "creation_date": 1463581901, "answer_id": 37302645, "question_id": 37302459, "link": "https://stackoverflow.com/questions/37302459/systemc-library-cant-be-opened-with-vs-2013/37302645#37302645", "title": "systemc library can&#39;t be opened with vs 2013", "body": "<p>From your second link, the reason why you don't have the library is simple: because you didn't build it. You should have the source files to build the library.</p>\n"}], "owner": {"reputation": 132, "user_id": 4326134, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9113a261c134dd228e6cd7a4e016f9a1?s=128&d=identicon&r=PG&f=1", "display_name": "akaAlso", "link": "https://stackoverflow.com/users/4326134/akaalso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463581901, "creation_date": 1463581424, "question_id": 37302459, "link": "https://stackoverflow.com/questions/37302459/systemc-library-cant-be-opened-with-vs-2013", "title": "systemc library can&#39;t be opened with vs 2013", "body": "<p>I am new to systemc programming.For the installation, <a href=\"https://www.youtube.com/watch?v=0N7571XnkRQ\" rel=\"nofollow\">I followed this tutorial to install and startup.</a> I am trying to build a simple main program. However I am getting the error</p>\n\n<blockquote>\n  <p>error LNK1104: cannot open file \"systemc.lib\".</p>\n</blockquote>\n\n<p>Now with a simple directory search, I am not finding the file. However it seems that removing it causes more damages. \n <a href=\"http://forums.accellera.org/topic/2237-systemc-using-visual-studio-2013/\" rel=\"nofollow\">According to this poste</a> The fact that the tutorial is for vs2010 and I am using vs2013 shouldn't be a problem.</p>\n\n<p>How do I move foward. What should I do. Here is the code:</p>\n\n<pre><code>// Hello_world is module name\nSC_MODULE(hello_world) {\n SC_CTOR(hello_world) {\n    // Nothing in constructor \n }\n void say_hello() {\n    //Print \"Hello World\" to the console.\n    cout &lt;&lt; \"Hello World.\\n\";\n    }\n};\n\n// sc_main in top level function like in C++ main \nint sc_main(int argc, char* argv[]) {\nhello_world hello(\"HELLO\");\n// Print the hello world\n hello.say_hello();\n return(0);\n}\n</code></pre>\n"}, {"tags": ["c", "function-pointers"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 5, "creation_date": 1463581296, "post_id": 37302220, "comment_id": 62126726, "body": "Where is the problem ? Your code looks more or less fine."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463581319, "post_id": 37302220, "comment_id": 62126747, "body": "Declare a function pointer type <i>with a parameter</i>. Make array of this function pointer type. Iterate the array and pass the iteration-specific parameter (e.g. string with number). Profit. BTW, why not just use a <i>single</i> function with different parameters?"}, {"owner": {"reputation": 734, "user_id": 3235081, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/iSyXb.png?s=128&g=1", "display_name": "Shady Programmer", "link": "https://stackoverflow.com/users/3235081/shady-programmer"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1463583542, "post_id": 37302220, "comment_id": 62128539, "body": "@MichaelWalz - There is no problem, I was curious if for some reason I had a 100 functions like that if then I&#39;d be able to initialize my menu array using a loop instead of manually writing each functions name"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1463583788, "post_id": 37302220, "comment_id": 62128745, "body": "@ShadyProgrammer OK; now I understand. The answer is NO. If you have 100 different functions, it&#39;s not a big deal to put all of them in an array. BTW how would you determine the order of the functions in the menu and which functino to put there ? The answer below maybe what you want, but this only works if the functions have names like <code>funcX</code> where X varies from 1 to N and you still need to do one bug #define containing all <code>EXEC(x)</code>."}, {"owner": {"reputation": 734, "user_id": 3235081, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/iSyXb.png?s=128&g=1", "display_name": "Shady Programmer", "link": "https://stackoverflow.com/users/3235081/shady-programmer"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1463583948, "post_id": 37302220, "comment_id": 62128871, "body": "@EugeneSh. I can&#39;t wrap my head around your suggestion, could you post an answer to demonstrate please ?"}, {"owner": {"reputation": 734, "user_id": 3235081, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/iSyXb.png?s=128&g=1", "display_name": "Shady Programmer", "link": "https://stackoverflow.com/users/3235081/shady-programmer"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1463584182, "post_id": 37302220, "comment_id": 62129029, "body": "@MichaelWalz Let&#39;s say I wanted to put all functions that come before main in order from top to bottom and each had a different name but all return void and take void, still no ?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1463586264, "post_id": 37302220, "comment_id": 62130518, "body": "@ShadyProgrammer No, the C language doesn&#39;t offer such a thing. Your qustion is really a non issue. Putting the function addresses in an a array is not a big deal."}], "answers": [{"tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": true, "score": 2, "last_activity_date": 1463581940, "creation_date": 1463581940, "answer_id": 37302660, "question_id": 37302220, "link": "https://stackoverflow.com/questions/37302220/how-to-initialize-an-array-of-pointers-to-functions-with-a-loop/37302660#37302660", "title": "How to initialize an array of pointers to functions with a loop", "body": "<blockquote>\n  <p>Is there a way to obtain all the adresses of func1 to func4</p>\n</blockquote>\n\n<p>No, the addresses of such functions could be in non contiguous areas</p>\n\n<blockquote>\n  <p>I have a feeling this could be possible with some sort of macro\n  trickery.</p>\n</blockquote>\n\n<p>Are you looking for a way to declare and assign at once?</p>\n\n<p>In this case:</p>\n\n<pre><code>#define PROTO(name) static void func##name(void) { printf(\"func\"#name\"\\n\"); }\n#define EVENT(name) func##name,\n\n#define EVENTS(EXEC) \\\n    EXEC(1) \\\n    EXEC(2) \\\n    EXEC(3) \\\n    EXEC(4)\n\nEVENTS(PROTO)\n\nint main(void)\n{\n    void (*menu[])(void) = {EVENTS(EVENT)};\n\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>static void func1(void) { printf(\"func\"\"1\"\"\\n\"); }\nstatic void func2(void) { printf(\"func\"\"2\"\"\\n\"); }\nstatic void func3(void) { printf(\"func\"\"3\"\"\\n\"); }\nstatic void func4(void) { printf(\"func\"\"4\"\"\\n\"); }\n\nint main(void)\n{\n    void (*menu[])(void) = {func1, func2, func3, func4,};\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 734, "user_id": 3235081, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/iSyXb.png?s=128&g=1", "display_name": "Shady Programmer", "link": "https://stackoverflow.com/users/3235081/shady-programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "closed_date": 1463584939, "accepted_answer_id": 37302660, "answer_count": 1, "score": 1, "last_activity_date": 1463581940, "creation_date": 1463580795, "question_id": 37302220, "link": "https://stackoverflow.com/questions/37302220/how-to-initialize-an-array-of-pointers-to-functions-with-a-loop", "closed_reason": "Needs details or clarity", "title": "How to initialize an array of pointers to functions with a loop", "body": "<p>Is there a way to obtain all the adresses of func1 to func4 so that I could use them inside a for loop to initialize my menu ? I have a feeling this could be possible with some sort of macro trickery. I've looked through google and SO but I didn't find any help.</p>\n\n<pre><code>...\nvoid func1(void) { printf(\"func1\\n\"); }\nvoid func2(void) { printf(\"func2\\n\"); }\nvoid func3(void) { printf(\"func3\\n\"); }\nvoid func4(void) { printf(\"func4\\n\"); }\n\nint main(int argc, char** argv)\n    {\n    int num=0;\n    printf(\"Scanf: 0 - 4\\n\");\n    scanf(\" %d\", &amp;num);\n\n    void (*menu[])(void) = {func1,\n                            func2,\n                            func3,\n                            func4};\n\n    if(num &lt;= 4) (*menu[num-1])();\n...\n</code></pre>\n"}, {"tags": ["ios", "objective-c", "c", "nsstring"], "answers": [{"comments": [{"owner": {"reputation": 1056, "user_id": 1181390, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5459239ecaf17173c5731eed1fb2522b?s=128&d=identicon&r=PG", "display_name": "Luke Smith", "link": "https://stackoverflow.com/users/1181390/luke-smith"}, "edited": false, "score": 0, "creation_date": 1463582529, "post_id": 37302437, "comment_id": 62127658, "body": "That is fantastic, thanks.  Trying now.  BTW yes - need to pass in an array of pointers, so looking at that also."}], "tags": [], "owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "is_accepted": true, "score": 3, "last_activity_date": 1463582729, "last_edit_date": 1463582729, "creation_date": 1463581360, "answer_id": 37302437, "question_id": 37301937, "link": "https://stackoverflow.com/questions/37301937/converting-nsstrings-to-c-chars-and-calling-a-c-function-from-objective-c/37302437#37302437", "title": "Converting NSStrings to C chars and calling a C function from Objective-C", "body": "<p><code>strdup()</code> is your friend here as that both <code>malloc()</code>s and <code>strcpy()</code>s for you in one simple step.  It's memory is also released using <code>free()</code> and it does your <code>const char *</code> to <code>char *</code> conversion for you!</p>\n\n<pre><code>NSString *code = ..., *effectiveRevId = ..., *revId = ...;\nstruct libannotate_baseManual *abm = malloc(sizeof(struct libannotate_baseManual));\nabm-&gt;la_bm_code = strdup([code UTF8String]);\nabm-&gt;la_bm_effectiveRevisionId = strdup([effectiveRevId UTF8String]);\nconst unsigned numRevIds = 1;\nabm-&gt;la_bm_effectiveRevisionId = malloc(sizeof(char *) * (numRevIds + 1));\nabm-&gt;la_bm_effectiveRevisionId[0] = strdup([revId UTF8String]);\nabm-&gt;la_bm_effectiveRevisionId[1] = NULL;\n\nconst unsigned numAbms = 1;    \nstruct libannotate_baseManual **abms = malloc(sizeof(struct libannotate_baseManual *) * (numAbms + 1));\nabms[0] = abm;\nabms[1] = NULL;\nlibannotate_setManualLibrary(abms);\n</code></pre>\n\n<p>Good luck, you'll need it.  It's one of the worst interfaces I've ever seen.</p>\n"}], "owner": {"reputation": 1056, "user_id": 1181390, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5459239ecaf17173c5731eed1fb2522b?s=128&d=identicon&r=PG", "display_name": "Luke Smith", "link": "https://stackoverflow.com/users/1181390/luke-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 37302437, "answer_count": 1, "score": 1, "last_activity_date": 1463594234, "creation_date": 1463580161, "last_edit_date": 1463594234, "question_id": 37301937, "link": "https://stackoverflow.com/questions/37301937/converting-nsstrings-to-c-chars-and-calling-a-c-function-from-objective-c", "title": "Converting NSStrings to C chars and calling a C function from Objective-C", "body": "<p>I'm in an Objective-C method with various <code>NSString</code>s that I want to pass to a C function.  The C function requires a <code>struct</code> object be <code>malloc</code>'d so that it can be passed in - this struct contains <code>char</code> fields.  So the <code>struct</code> is defined like this:</p>\n\n<pre><code>struct libannotate_baseManual {\n    char *la_bm_code;  // The base code for this manual (pointer to malloc'd memory)\n    char *la_bm_effectiveRevisionId; // The currently effective revision ID (pointer to malloc'd memory or null if none effective)\n    char **la_bm_revisionId; // The null-terminated list of revision IDs in the library for this manual (pointer to malloc'd array of pointers to malloc'd memory)\n};\n</code></pre>\n\n<p>This struct is then used in the following C function definition:</p>\n\n<pre><code>void libannotate_setManualLibrary(struct libannotate_baseManual **library) { ..\n</code></pre>\n\n<p>So that's the function I need to call from Objective-C.</p>\n\n<p>So I have various <code>NSString</code>s that I basically want to pass in there, to represent the chars - <code>la_bm_code</code>, <code>la_bm_effectiveRevisionId</code>, <code>la_bm_revision</code>.  I could convert those to <code>const char</code>s by using <code>[NSString UTF8String]</code>, but I need <code>char</code>s, not <code>const char</code>s.</p>\n\n<p>Also I need to do suitable <code>malloc</code>'s for these fields, though apparently I don't need to worry about freeing the memory afterwards.  C is not my strong point, though I know Objective-C well.</p>\n"}, {"tags": ["c", "pointers", "double-pointer"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1463580140, "post_id": 37301901, "comment_id": 62125857, "body": "Nitpick: It&#39;s not really a <i>double pointer</i>, it&#39;s a pointer-to pointer. :)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1463580203, "post_id": 37301901, "comment_id": 62125901, "body": "<code>fflush( stdin );</code> is undefined behavior."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1463580203, "post_id": 37301901, "comment_id": 62125902, "body": "<code>fflush( stdin );</code> is UB."}, {"owner": {"reputation": 3852, "user_id": 921723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38e3b1e32ece685d794a2d839300166c?s=128&d=identicon&r=PG", "display_name": "Jite", "link": "https://stackoverflow.com/users/921723/jite"}, "edited": false, "score": 1, "creation_date": 1463580250, "post_id": 37301901, "comment_id": 62125939, "body": "See: <a href=\"http://stackoverflow.com/questions/15244429/pointer-of-a-pointer-in-linked-list-append/15244654#15244654\" title=\"pointer of a pointer in linked list append\">stackoverflow.com/questions/15244429/&hellip;</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1463580816, "post_id": 37301901, "comment_id": 62126366, "body": "There are no global variables in the code presented.  Variables declared in <code>main()</code> are local variables of that function."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1463581056, "post_id": 37301901, "comment_id": 62126550, "body": "Related: <a href=\"http://stackoverflow.com/questions/5580761/why-use-double-pointer-or-why-use-pointers-to-pointers\" title=\"why use double pointer or why use pointers to pointers\">stackoverflow.com/questions/5580761/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "is_accepted": false, "score": 4, "last_activity_date": 1463581386, "last_edit_date": 1463581386, "creation_date": 1463580436, "answer_id": 37302063, "question_id": 37301901, "link": "https://stackoverflow.com/questions/37301901/query-with-double-pointers-in-c/37302063#37302063", "title": "Query with Double Pointers in C", "body": "<p>If you don't like pointers-to-pointers, you could always modify the function's signature so that it returns the new pointer-value to assign to A, and sets the dimension value via a pointer instead:</p>\n\n<pre><code>[...]\nint dimension;\nint * A = cargaArreglo(&amp;dimension);\n[...]\n\n\nint * cargaArreglo(int * retDimension){\n   int i = 0;\n   char bandera = 's';\n   int * B = malloc( 1*sizeof(int) );\n\n   while( bandera != 'n' ){\n        printf( \"Ingrese un numero\" );\n        scanf( \"%d\", &amp;B[i] );\n        printf( \"Desea seguir ingresando?\" );\n        i++;\n        fflush( stdout ); /* fflush( stdin ) is UB */\n        scanf( \"%c\", &amp;bandera );\n        if( bandera != 'n' )\n           B = realloc( B, (i+1)*sizeof(int) );\n   }\n   *retDimension = i;\n\n   return B;\n}\n</code></pre>\n\n<blockquote>\n  <p>I mean, the teacher said that is impossible, because without the\n  double pointer I cant change the value of the global variable. This\n  made me confuse respect to the pointers.</p>\n</blockquote>\n\n<p>What the teacher meant was that when you call a function in C, a temporary copy of each argument is pushed onto the stack for use inside the function.  So if you change the value of the argument inside the called function, it doesn't change the value back in the calling function... for example, running this code:</p>\n\n<pre><code>void foo(int x, int * A)\n{\n   x = 6;\n   A = NULL;\n}\n\nint x = 5;\nint * A = &amp;x;\nprintf(\"BEFORE x=%i A=%p &amp;x=%p\\n\", x, A, &amp;x);\nfoo(x, A);\nprintf(\"AFTER x=%i A=%p &amp;x=%p\\n\", x, A, &amp;x);\n</code></pre>\n\n<p>... will print out:</p>\n\n<pre><code>BEFORE x=5 A=0x2345678 &amp;x=0x2345678\nAFTER x=5 A=0x2345678 &amp;x=0x2345678\n</code></pre>\n\n<p>... which is to say that foo() did not actually change the value of either x or A in the calling function, because foo() modified only the copy of x and the copy of A that were passed to it, and not the original variables.</p>\n\n<p>However, foo() <em>can</em> use the A pointer to (indirectly) modify the value of calling function's x, because the function's copy of A still points to the calling function's x, so you could implement foo do this:</p>\n\n<pre><code>void foo(int * A)\n{\n   *A = 666;\n}\n\nint x = 5;\nprintf(\"BEFORE x=%i\\n\", x);\nfoo(&amp;x);\nprintf(\"AFTER x=%i\\n\", x);\n</code></pre>\n\n<p>... and you'd get this output:</p>\n\n<pre><code>BEFORE x=5\nAFTER x=666\n</code></pre>\n\n<p>... and if the above makes sense to you, then the pointer-to-a-pointer case is really just the same thing as above, except that instead of A pointing to an int, the type of the value it is pointing to is a pointer:</p>\n\n<pre><code>void foo(int ** x)\n{\n    *x = NULL;\n}\n\nint y = 5;\nint * x = &amp;y;\nint ** A = &amp;x;\nprintf(\"BEFORE x=%p\\n\", x);\nfoo(A);\nprintf(\"AFTER x=%p\\n\", x);\n</code></pre>\n\n<p>... would print out:</p>\n\n<pre><code>BEFORE x=0x2345845  (actual value will vary depending on your computer)  \nAFTER x=NULL\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1463583078, "creation_date": 1463583078, "answer_id": 37303165, "question_id": 37301901, "link": "https://stackoverflow.com/questions/37301901/query-with-double-pointers-in-c/37303165#37303165", "title": "Query with Double Pointers in C", "body": "<blockquote>\n  <p>exist any posibility of to convert this in a simple pointer?</p>\n</blockquote>\n\n<p>It <em>is</em> a simple pointer.  C has no other kind.</p>\n\n<p>Understanding that point is one of the keys to C mastery.  Another way to look at it is that pointers are just one kind of value the C supports.  Valid pointer values have significance as addresses (in some sense) of functions or objects in the program, but that does not make them in any way magical.  They are first-class values.  In particular, pointers can point objects of pointer type as a <em>natural consequence</em> of the language's type system.  That a pointer points to another pointer does not make it non-simple.</p>\n\n<p>I think some people get confused by pointers because they read the type from left to right, so they see the name of some base type first (<code>int</code> in your case) and attribute the most significance to that.  But although the <code>int *</code>, <code>int **</code>, <em>etc.</em> <strong>types</strong> are related to the <code>int</code> <strong>type</strong>, <em>values</em> of those pointer types are not much related to <code>int</code>s at all.  Instead of reading types from left to right, you should read them from the inside out, which in many common cases is right-to-left.  Reading <code>int **A</code> as \"A is a pointer to pointer to <code>int</code>\" emphasizes that its value is a pointer, which is the most significant thing about it.</p>\n\n<p>As for specific ways in which you could restructure your program, @JeremyFriesner has already covered the matter very well.  The key thing to understand in this area is why you (may) want to use a pointer argument in the first place.</p>\n\n<p>In general, there are several reasons why you might want to do so, but the main one and the one applicable to your particular code is the one your instructor gave you: so that the function can modify an object declared in a different scope or allocated dynamically.  In this case, that object is a pointer to the address of your dynamically-allocated array.  (Remember:  pointers are objects in their own right.)</p>\n\n<p>Additionally, C functions have only one return value.  If you want a function to communicate several pieces of data to its caller then either you must provide pointer arguments by which it can do so, or you must return a value of a suitable structure type (which you might not have studied yet), or you must return a pointer to a structure or array containing all the data.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1463583538, "creation_date": 1463583538, "answer_id": 37303354, "question_id": 37301901, "link": "https://stackoverflow.com/questions/37301901/query-with-double-pointers-in-c/37303354#37303354", "title": "Query with Double Pointers in C", "body": "<p>If you don't like the way the syntax looks, you can use a local pointer variable when doing the work inside of the function and assign that back to the dereferenced pointer-to-pointer at the end:</p>\n\n<pre><code>int cargaArreglo(int **A){\n\n    int i = 0;\n    char bandera = 's';\n    int *B;\n    B = malloc( 1*sizeof(int) );\n\n    while( bandera != 'n' ){\n         printf( \"Ingrese un numero\" );\n         scanf( \"%d\", &amp;B[i] );\n         printf( \"Desea seguir ingresando?\" );\n         i++;\n         fflush( stdin );\n         scanf( \"%c\", &amp;bandera );\n         if( bandera != 'n' )\n         B = realloc( B, (i+1)*sizeof(int) );\n    }\n    *A = B;\n    return i;\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5540253, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10206116275044713/picture?type=large", "display_name": "Nicolas Mozo", "link": "https://stackoverflow.com/users/5540253/nicolas-mozo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1463583538, "creation_date": 1463580074, "question_id": 37301901, "link": "https://stackoverflow.com/questions/37301901/query-with-double-pointers-in-c", "title": "Query with Double Pointers in C", "body": "<p>In the university we did this code:</p>\n\n<pre><code>int cargaArreglo(int ** A);\n\nint main(){\n\nint * A = NULL;\nint i = 0;\nint dimension = cargaArreglo(&amp;A);\n\nfor( i = 0; i &lt; dimension; i++ )\n     printf( \"[%d]\", A[i] );\n\nfree( A );\nreturn 0;\n}\n\nint cargaArreglo(int ** A){\n\nint i = 0;\nchar bandera = 's';\n(*A) = malloc( 1*sizeof(int) );\n\nwhile( bandera != 'n' ){\n     printf( \"Ingrese un numero\" );\n     scanf( \"%d\", &amp;(*A)[i] );\n     printf( \"Desea seguir ingresando?\" );\n     i++;\n     fflush( stdin );\n     scanf( \"%c\", &amp;bandera );\n     if( bandera != 'n' )\n     (*A) = realloc( (*A), (i+1)*sizeof(int) );\n}\nreturn i;\n}\n</code></pre>\n\n<p>We tried to load a dinamic array, and add values without a limit. The code works very fine but in the functions we need to declare the parameters with Double Pointers, exist any posibility of to convert this in a simple pointer? I mean, the teacher said that is impossible, because without the double pointer I cant change the value of the global variable. This made me confuse respect to the pointers.</p>\n\n<p>Thank you for your time!</p>\n\n<p>PD: If you find a mistake respect a my english, please tell me because I would help me much with my studies.</p>\n"}, {"tags": ["c", "c99", "undefined-behavior", "c89"], "comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1463591959, "post_id": 37301078, "comment_id": 62133992, "body": "Answer 2 of this will helps you <a href=\"http://stackoverflow.com/questions/8917233/why-does-int-min-int-min-in-a-signed-twos-complement-representation\" title=\"why does int min int min in a signed twos complement representation\">stackoverflow.com/questions/8917233/&hellip;</a>"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1463606700, "post_id": 37301078, "comment_id": 62141726, "body": "If you try to generate a rvalue that it&#39;s type can not represent, then it&#39;s UB."}, {"owner": {"reputation": 1961, "user_id": 7022459, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/646lY.png?s=128&g=1", "display_name": "Apollys supports Monica", "link": "https://stackoverflow.com/users/7022459/apollys-supports-monica"}, "edited": false, "score": 0, "creation_date": 1552612721, "post_id": 37301078, "comment_id": 97087356, "body": "Short answer: <b>Yes, it is undefined behavior</b>.  The answers below provide nice details but kind of beat around the bush."}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463605366, "post_id": 37307948, "comment_id": 62141081, "body": "The last paragraph seems unclear to me, I think you are trying to say that if <code>INT_MIN == -INT_MAX</code> then <code>-INT_MIN == INT_MAX</code>, otherwise <code>-INT_MIN</code> is undefined behaviour"}, {"owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463618116, "post_id": 37307948, "comment_id": 62145110, "body": "@M.M What I&#39;m trying to say is under which conditions exactly <code>INT_MIN == -INT_MAX</code> and that this condition can even be true on a two&#39;s complement platform (at least theoretically)."}, {"owner": {"reputation": 3495, "user_id": 36585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0ccd55542e51b1b98f5a72b30c815dc?s=128&d=identicon&r=PG", "display_name": "pnkfelix", "link": "https://stackoverflow.com/users/36585/pnkfelix"}, "edited": false, "score": 0, "creation_date": 1475097449, "post_id": 37307948, "comment_id": 66811630, "body": "I spent a while looking in the wrong parts of sections 6.2.6.2 and 6.5 searching for the statement that <code>-INT_MIN</code>  is undefined behavior. I did eventually find it (I think), in item 6.5-5, which says &quot;If an exceptional condition occurs during the evaluation of an expression (that is, if the result is not mathematically defined or not in the range of representable values for its type), the behavior is undefined.&quot;"}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "reply_to_user": {"reputation": 3495, "user_id": 36585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0ccd55542e51b1b98f5a72b30c815dc?s=128&d=identicon&r=PG", "display_name": "pnkfelix", "link": "https://stackoverflow.com/users/36585/pnkfelix"}, "edited": false, "score": 1, "creation_date": 1555021129, "post_id": 37307948, "comment_id": 97974113, "body": "@pnkfelix that only matters if <code>-INT_MIN</code> falls outside the range of values an integer can represent. If you&#39;re using sign-magnitude or ones-complement, <code>-INT_MIN</code> is within the range of values an integer can represent, so <code>-INT_MIN</code> is perfectly fine. Of course, it&#39;s undefined behaviour if it overflows, as it would with twos-complement."}], "tags": [], "owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "is_accepted": true, "score": 12, "last_activity_date": 1544094880, "last_edit_date": 1544094880, "creation_date": 1463597638, "answer_id": 37307948, "question_id": 37301078, "link": "https://stackoverflow.com/questions/37301078/is-negating-int-min-undefined-behaviour/37307948#37307948", "title": "Is negating INT_MIN undefined behaviour?", "body": "<p>It depends on the platform. C supports three representations for negative numbers (see <a href=\"http://port70.net/~nsz/c/c99/n1256.html#6.2.6.2\" rel=\"noreferrer\">section 6.2.6.2</a> of the C99 standard):</p>\n\n<ul>\n<li>Two's complement.</li>\n<li>One's complement.</li>\n<li>Sign and magnitude.</li>\n</ul>\n\n<p>With one's complement and sign and magnitude, <code>-INT_MIN</code> is defined (and equal to <code>INT_MAX</code>). With two's complement, it depends on whether the value with sign bit 1 and all value bits zero is a trap representation or a normal value. If it's a normal value, <code>-INT_MIN</code> overflows, resulting in undefined behavior (see <a href=\"http://port70.net/~nsz/c/c99/n1256.html#6.5p5\" rel=\"noreferrer\">section 6.5</a> of the C99 standard). If it's a trap representation, <code>-INT_MIN</code> equals <code>INT_MAX</code>.</p>\n\n<p>That said, most modern platforms use two's complement without trap representations, so <code>-INT_MIN</code> typically results in undefined behavior.</p>\n"}, {"comments": [{"owner": {"reputation": 3782, "user_id": 1292652, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6b4416f70b90ac9259fca725a1563dd0?s=128&d=identicon&r=PG", "display_name": "Yatharth Agarwal", "link": "https://stackoverflow.com/users/1292652/yatharth-agarwal"}, "edited": false, "score": 0, "creation_date": 1517155874, "post_id": 37309998, "comment_id": 83969672, "body": "Do you have supporting evidence for the hypothesis for hyper-modern compilers?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 3782, "user_id": 1292652, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6b4416f70b90ac9259fca725a1563dd0?s=128&d=identicon&r=PG", "display_name": "Yatharth Agarwal", "link": "https://stackoverflow.com/users/1292652/yatharth-agarwal"}, "edited": false, "score": 0, "creation_date": 1517181781, "post_id": 37309998, "comment_id": 83978020, "body": "@YatharthAgarwal: I have identified situations where evaluation of an expressions that would cause overflow with certain argument values will cause compilers to infer that such arguments will not be received.  I haven&#39;t identified cases in today&#39;s compilers where negation of INT_MIN in particular would cause that, but the authors of compilers like gcc make very clear that they make no promises about future behavior in cases not mandated by the Standard and aren&#39;t explicitly documented."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 3782, "user_id": 1292652, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6b4416f70b90ac9259fca725a1563dd0?s=128&d=identicon&r=PG", "display_name": "Yatharth Agarwal", "link": "https://stackoverflow.com/users/1292652/yatharth-agarwal"}, "edited": false, "score": 1, "creation_date": 1544219744, "post_id": 37309998, "comment_id": 94212555, "body": "@YatharthAgarwal: I added an example of a function where attempting to negate a value equal to <code>INT_MIN</code> in gcc 8.2 will affect the stored value of another object."}, {"owner": {"reputation": 3782, "user_id": 1292652, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6b4416f70b90ac9259fca725a1563dd0?s=128&d=identicon&r=PG", "display_name": "Yatharth Agarwal", "link": "https://stackoverflow.com/users/1292652/yatharth-agarwal"}, "edited": false, "score": 0, "creation_date": 1544261272, "post_id": 37309998, "comment_id": 94219535, "body": "Woah\u2014nice example!"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 3782, "user_id": 1292652, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6b4416f70b90ac9259fca725a1563dd0?s=128&d=identicon&r=PG", "display_name": "Yatharth Agarwal", "link": "https://stackoverflow.com/users/1292652/yatharth-agarwal"}, "edited": false, "score": 0, "creation_date": 1544390125, "post_id": 37309998, "comment_id": 94248877, "body": "@YatharthAgarwal: Even more interesting is the compiler&#39;s behavior if <code>q</code> is changed to <code>-2147483646-i</code>.  The generated code ends up being less efficient than if the <code>rr=-rr</code> line were replaced with <code>rr=-(unsigned)rr</code>, so the compiler&#39;s treatment of UB doesn&#39;t even improve code efficiency."}], "tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 3, "last_activity_date": 1544219670, "last_edit_date": 1544219670, "creation_date": 1463605150, "answer_id": 37309998, "question_id": 37301078, "link": "https://stackoverflow.com/questions/37301078/is-negating-int-min-undefined-behaviour/37309998#37309998", "title": "Is negating INT_MIN undefined behaviour?", "body": "<p>Platforms may choose to define the behavior, but the C Standard does not require that they guarantee anything about it.  While historically microcomputer compilers have relatively consistently behaved as though -INT_MIN would yield INT_MIN or in some cases a number that behaves like a value one larger than INT_MAX, it has become more fashionable to instead have it <em>retroactively</em> change the value of whatever was being negated.  Thus, given:</p>\n\n<pre><code>int wowzers(int x)\n{\n  if (x != INT_MIN) printf(\"Not int min!\");\n  return -x;\n}\n</code></pre>\n\n<p>a hyper-modern compiler may use the expression -x to determine that x can't\nhave been equal to INT_MIN when the previous comparison was performed, and\nmay thus perform the printf unconditionally.</p>\n\n<p>Incidentally, gcc 8.2 will use the UB-ness of negating INT_MIN to \"optimize\" the following</p>\n\n<pre><code>int qq,rr;\nvoid test(unsigned short q)\n{\n    for (int i=0; i&lt;=q; i++)\n    {\n        qq=-2147483647-i;\n        rr=qq;\n        rr=-rr;\n    }\n}\n</code></pre>\n\n<p>into code that unconditionally stores -2147483647 to <code>qq</code> and 2147483647 to <code>rr</code>.  Removing the <code>rr=-rr</code> line will make the code store -2147483647 or -2147483648 into both <code>qq</code> and <code>rr</code>, depending upon whether <code>q</code> is zero.</p>\n"}, {"comments": [{"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1579145437, "post_id": 55641296, "comment_id": 105670286, "body": "May be not important but <code>fprintf(</code> need <code>)</code> before <code>;</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1579146519, "post_id": 55641296, "comment_id": 105670500, "body": "@EsmaeelE Yes, Code amended."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1579146496, "last_edit_date": 1579146496, "creation_date": 1555017373, "answer_id": 55641296, "question_id": 37301078, "link": "https://stackoverflow.com/questions/37301078/is-negating-int-min-undefined-behaviour/55641296#55641296", "title": "Is negating INT_MIN undefined behaviour?", "body": "<blockquote>\n  <p>Is negating INT_MIN undefined behaviour?</p>\n</blockquote>\n\n<p>Yes, when <code>INT_MIN &lt; -INT_MAX</code> - which is <strong>very</strong> common (2's complement). It is <em>integer overflow</em>.</p>\n\n<pre><code>int i = get_i();\n\n#if INT_MIN &lt; -INT_MAX\nif (i == INT_MIN) {\n  fprintf(stderr, \"Houston, we have a problem\\n\");\n  // Maybe return or exit here.\n}\n#endif \n\nint j = -i;\n</code></pre>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Houston,_we_have_a_problem\" rel=\"nofollow noreferrer\">Houston, we have a problem</a></p>\n"}], "owner": {"reputation": 1434, "user_id": 3691554, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2479edc9e2237ac67d4df87105fbc656?s=128&d=identicon&r=PG&f=1", "display_name": "SoniEx2", "link": "https://stackoverflow.com/users/3691554/soniex2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1164, "favorite_count": 3, "accepted_answer_id": 37307948, "answer_count": 3, "score": 4, "last_activity_date": 1579146496, "creation_date": 1463578050, "last_edit_date": 1463591250, "question_id": 37301078, "link": "https://stackoverflow.com/questions/37301078/is-negating-int-min-undefined-behaviour", "title": "Is negating INT_MIN undefined behaviour?", "body": "<p>Let's say I have a variable <code>i</code> that comes from external sources:</p>\n\n<pre><code>int i = get_i();\n</code></pre>\n\n<p>Assuming <code>i</code> is <code>INT_MIN</code> and two's complement representation, is <code>-i</code> undefined?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1220, "user_id": 2172854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hm0Q1.png?s=128&g=1", "display_name": "abhishek_naik", "link": "https://stackoverflow.com/users/2172854/abhishek-naik"}, "edited": false, "score": 1, "creation_date": 1463573572, "post_id": 37299208, "comment_id": 62120982, "body": "<code>frames_video1[]</code> has been declared, not initialized.  So you cannot do <code>frames_video1[i]-&gt;pkt_size</code>."}, {"owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "reply_to_user": {"reputation": 1220, "user_id": 2172854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hm0Q1.png?s=128&g=1", "display_name": "abhishek_naik", "link": "https://stackoverflow.com/users/2172854/abhishek-naik"}, "edited": false, "score": 0, "creation_date": 1463577366, "post_id": 37299208, "comment_id": 62123801, "body": "@BatCoder but in the decode_packet function, frames_video1 items are assigned by frame, meaning frames_video1[0] points to a frame, frames_video1[1] points to an other frame, and so on. They are not NULL"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1463579774, "post_id": 37299208, "comment_id": 62125600, "body": "&quot;Array pointer&quot; or &quot;array <b>of</b> pointer<b>s</b>&quot; is a great difference!"}, {"owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1463580304, "post_id": 37299208, "comment_id": 62125978, "body": "@Olaf don&#39;t be that literal :)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1463582145, "post_id": 37299208, "comment_id": 62127376, "body": "@Kindermann There is a specific, technical term in C called <i>array pointer</i>. It is different from regular pointers only in one way, namely that it can point at a whole array, rather than just pointing at the first object. Therefore your question is a bit strangely worded, as there is no array pointer in this code."}], "answers": [{"comments": [{"owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "edited": false, "score": 1, "creation_date": 1463573701, "post_id": 37299300, "comment_id": 62121089, "body": "That is not true. <code>AVFrame *frames_video1[3];</code> is a valid definition of a variable. Had that been true, it would not be an undefined behavior. It would be a linker error."}, {"owner": {"reputation": 1220, "user_id": 2172854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hm0Q1.png?s=128&g=1", "display_name": "abhishek_naik", "link": "https://stackoverflow.com/users/2172854/abhishek-naik"}, "reply_to_user": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "edited": false, "score": 0, "creation_date": 1463573975, "post_id": 37299300, "comment_id": 62121298, "body": "@ShacharShemesh, by writing <code>AVFrame *frames_video1[3];</code>, the OP has just declared the array.  It has not been initialized so he cannot access <code>pkt_size</code>"}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1463574860, "post_id": 37299300, "comment_id": 62121927, "body": "<code>AVFrame *frames_video1[3];</code> is a definition of an array of pointers to AVFrame structures. These structures have never been defined. frames_video1 is a valid variable - a variable that contains an array of uninitialized pointers. Dereferencing these pointers (through <code>-&gt;</code>) causes undefined behavior."}, {"owner": {"reputation": 1220, "user_id": 2172854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hm0Q1.png?s=128&g=1", "display_name": "abhishek_naik", "link": "https://stackoverflow.com/users/2172854/abhishek-naik"}, "reply_to_user": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1463576026, "post_id": 37299300, "comment_id": 62122801, "body": "@SF., I totally agree with you.  But I am not sure what you are trying to imply with your comment.  Feel free to edit the answer, if that is what you expect."}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1463576538, "post_id": 37299300, "comment_id": 62123195, "body": "@BatCoder: <a href=\"http://stackoverflow.com/questions/1410563/what-is-the-difference-between-a-definition-and-a-declaration\">Declaration vs Definition</a>. Initialization is often performed together with definition, and the definition can serve as declaration, but a variable that&#39;s been just declared but not defined can&#39;t be initialized. In this case the variable is defined. If it was anything else than pointers, reading it would yield an unpredictable value but not cause undefined behavior. But it&#39;s not being read - it&#39;s being dereferenced. This causes the undefined behavior - or specifically, crash."}, {"owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "edited": false, "score": 0, "creation_date": 1463576723, "post_id": 37299300, "comment_id": 62123342, "body": "@BatCoder, you are confusing definition and declaration. Your original, pre-edit, answer said the array was declared but not defined. That was not true. The array was defined, but was not initialized. Also, the answer currently states that this means its values are invoking UD. This is not so. Uninitialized global (as opposed to automatic) vars in C are well defined to be zero initialized."}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "reply_to_user": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "edited": false, "score": 0, "creation_date": 1463577355, "post_id": 37299300, "comment_id": 62123793, "body": "@ShacharShemesh: Dereferencing a NULL pointer, in practice universally means causing segfault and nothing else, but the standard doesn&#39;t differentiate it from dereferencing any invalid pointer - it&#39;s still considered Undefined Behavior. Did I clarify it with my edit better?"}, {"owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "reply_to_user": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 0, "creation_date": 1463577522, "post_id": 37299300, "comment_id": 62123908, "body": "@SF. I will concede that point. Dereferencing a NULL pointer is, indeed, UD. I just wanted to to point out that it is a NULL, and not something else."}, {"owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "edited": false, "score": 0, "creation_date": 1463577531, "post_id": 37299300, "comment_id": 62123913, "body": "how to initialize frames_video1[3] in this context?"}, {"owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "reply_to_user": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "edited": false, "score": 0, "creation_date": 1463577594, "post_id": 37299300, "comment_id": 62123962, "body": "@Kindermann, that completely depends on what you are trying to do. You did not give us enough context to answer that. You might want to allocate them with malloc, or something."}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "reply_to_user": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "edited": false, "score": 1, "creation_date": 1463577611, "post_id": 37299300, "comment_id": 62123976, "body": "@Kindermann: <code>AVFrame f;  frames_video1[3] = &amp;f;</code> initializes the third element. If you want dynamic initialization, <code>video1[3] = malloc(sizeof(AVFrame));</code> (then handle <code>malloc</code> returning NULL on failed allocation, a possible runtime error)."}, {"owner": {"reputation": 12300, "user_id": 249618, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81060fe344980bc9a3273a48b8f3e31c?s=128&d=identicon&r=PG", "display_name": "SF.", "link": "https://stackoverflow.com/users/249618/sf"}, "edited": false, "score": 1, "creation_date": 1463578054, "post_id": 37299300, "comment_id": 62124346, "body": "...personally, I&#39;d entirely drop one layer of indirection. <code>AVFrame frames_video1[3];</code>, <code>int decode_packet(int got_frame, int cached, AVFrame frames_video[])</code>, <code>memcpy(frames_video[video_frame_count], frame, sizeof(frame));</code> <code>frames_video1[i].pkt_size</code>. Arrays behave as pointers in so many ways that you&#39;re getting drowned in pointer-to-pointer bog."}, {"owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "edited": false, "score": 0, "creation_date": 1463578716, "post_id": 37299300, "comment_id": 62124808, "body": "I still don&#39;t quite understand: frames_video1[] is firstly passed to decode_video(), there it&#39;s further passed to decode_packet(), and finally it&#39;s supposed to be assigned by frame. Is the passing of frames_video1[] from main function all the way to decode_packet function where each item of it shall be assigned by frame variable clear to you?"}, {"owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "edited": false, "score": 0, "creation_date": 1463579108, "post_id": 37299300, "comment_id": 62125074, "body": "or do you mean that before each item of frams_video1[] can be assigned by frame, it must be initialized? frames_video1[] is NOT null at the end of the day unless it&#39;s wrongly passed..."}, {"owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "edited": false, "score": 0, "creation_date": 1463579206, "post_id": 37299300, "comment_id": 62125151, "body": "I&#39;m more concerned with whether frams_video1[] was actually correctly passed to decode_packet()..."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1463579229, "post_id": 37299300, "comment_id": 62125176, "body": "All the debate over initialization misses the fact that the variables in question are declared at file scope, and therefore have static duration.  Supposing that there is no other declaration that provides an explicit initializer, these objects are subject to default initialization.  This will initialize all the pointers to NULL, including those that are array elements.  This is <i>totally different</i> from those values being unintialized."}, {"owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "edited": false, "score": 0, "creation_date": 1463579476, "post_id": 37299300, "comment_id": 62125374, "body": "firstly forget about initialization issues. I wonder if *frame_video1[] can be passed into decode_packet() correctly... I want to get back a *frame_video1[] variable full with pointers to frames..."}], "tags": [], "owner": {"reputation": 1220, "user_id": 2172854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hm0Q1.png?s=128&g=1", "display_name": "abhishek_naik", "link": "https://stackoverflow.com/users/2172854/abhishek-naik"}, "is_accepted": false, "score": 4, "last_activity_date": 1463577474, "last_edit_date": 1463577474, "creation_date": 1463573652, "answer_id": 37299300, "question_id": 37299208, "link": "https://stackoverflow.com/questions/37299208/array-of-pointers-as-argument-in-c-functions/37299300#37299300", "title": "array of pointers as argument in c functions", "body": "<p>In your code, <code>frames_video1[]</code> has just been defined, but its values (pointers) were not explicitly initialized<sup>*</sup>.  So you cannot dereference them - do <code>frames_video1[i]-&gt;pkt_size</code>.  This results in <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.</p>\n\n<p><sup>* they were implicitly initialized to NULL, attempting dereferencing which still causes UD.</sup></p>\n"}, {"comments": [{"owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "reply_to_user": {"reputation": 1220, "user_id": 2172854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hm0Q1.png?s=128&g=1", "display_name": "abhishek_naik", "link": "https://stackoverflow.com/users/2172854/abhishek-naik"}, "edited": false, "score": 0, "creation_date": 1463576425, "post_id": 37299356, "comment_id": 62123089, "body": "@BatCoder, Global variables in C are defined to be zero initialized if not otherwise explicitly initialized. So, no, it is necessarily an array of NULLs."}, {"owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "edited": false, "score": 0, "creation_date": 1463579701, "post_id": 37299356, "comment_id": 62125540, "body": "how can I provide you entire code? can i post the entire code here?"}], "tags": [], "owner": {"reputation": 7371, "user_id": 1510211, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4acda0216d7fd2ea07c31c0cfc53a714?s=128&d=identicon&r=PG", "display_name": "Shachar Shemesh", "link": "https://stackoverflow.com/users/1510211/shachar-shemesh"}, "is_accepted": false, "score": 1, "last_activity_date": 1463573768, "creation_date": 1463573768, "answer_id": 37299356, "question_id": 37299208, "link": "https://stackoverflow.com/questions/37299208/array-of-pointers-as-argument-in-c-functions/37299356#37299356", "title": "array of pointers as argument in c functions", "body": "<p>You did not provide the entire code, but I believe your problem is that you are sending the function an array of pointers, but your not initializing that array. You are probably passing an array of NULLs, and then trying to dreference them.</p>\n"}, {"tags": [], "owner": {"reputation": 1505, "user_id": 2641513, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bGWLp.jpg?s=128&g=1", "display_name": "zoska", "link": "https://stackoverflow.com/users/2641513/zoska"}, "is_accepted": false, "score": 0, "last_activity_date": 1463573919, "creation_date": 1463573919, "answer_id": 37299420, "question_id": 37299208, "link": "https://stackoverflow.com/questions/37299208/array-of-pointers-as-argument-in-c-functions/37299420#37299420", "title": "array of pointers as argument in c functions", "body": "<p>First of all, all pointers must be initialized properly before they can be dereferenced. So to write <code>frames_video1[i]-&gt;pkt_size</code> you must somehow initialize pointer under <code>frames_video1[i]</code> (either using <code>malloc</code> or storing address to already existing structure <code>AVFrame</code> with the right scope). </p>\n\n<p>Secondly, after passing array to function you are losing information about it's size, so it has to be passed as argument together with an array, so e.g.:</p>\n\n<pre><code>int decode_video(char *src_filename, AVFrame *frames_video[])\n</code></pre>\n\n<p>should be changed to:</p>\n\n<pre><code>int decode_video(char *src_filename, AVFrame *frames_video[],\n                 int frames_count)\n</code></pre>\n\n<p><code>frames_count</code> gives you information how far can you iterate other <code>frames_video</code> (e.g. index <code>i = 3</code> is already too big, <code>frames_video</code> doesn't contain such element). So in your case to those functions you pass <code>frames_count = 3</code> and iterate from <code>0</code> to <code>i &lt; 3</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "edited": false, "score": 0, "creation_date": 1463644512, "post_id": 37302162, "comment_id": 62154057, "body": "I believe your second explanation hit the issue. I&#39;ll work on it further to find it out the exact cause any way."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1463663592, "last_edit_date": 1463663592, "creation_date": 1463580656, "answer_id": 37302162, "question_id": 37299208, "link": "https://stackoverflow.com/questions/37299208/array-of-pointers-as-argument-in-c-functions/37302162#37302162", "title": "array of pointers as argument in c functions", "body": "<blockquote>\n  <p>How shall I pass arguments in this context?</p>\n</blockquote>\n\n<p>The code you presented is fine, as far as it goes.  The arguments to the function calls agree with the functions' parameters (and surely you could induce your compiler to warn you of any cases where that was not so).  Moreover, if you pass an array as a function argument then the called function will see the same element values as the caller, and if it sets different values for any of that array's elements then the effect will be visible to the caller.</p>\n\n<p>I'm uncertain why you are confident that the segmentation fault arises from evaluating the expression <code>frames_video1[i]-&gt;pkt_size</code>, but perhaps you determined it via a debugger.  In that case, there are only two likely explanations:</p>\n\n<ol>\n<li><p>variable <code>i</code> is either less than 0 or greater than 2, so that you are trying to access an out-of-bounds array element.  Check your loop bounds, and be especially aware that the maximum index for an <em>N</em>-element array is <em>N-1</em>, not <em>N</em>.</p></li>\n<li><p><code>frames_video1[i]</code> is not a valid pointer.  It might never have been set to a valid pointer, or it might be a pointer to dynamic memory that since has been freed, or its value may have been corrupted.  Certainly the initialization issues discussed in the other answers and in the comments on them point to one avenue by which this alternative could be exercised, but since you seem to discount that as a possible cause, I will not cover that ground again.  </p></li>\n</ol>\n\n<p>Overall, you present only skeleton code, not a working example by which the problem can actually be demonstrated.  The answers you will receive are necessarily constrained by that.</p>\n"}], "owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 37302162, "answer_count": 4, "score": -1, "last_activity_date": 1463663592, "creation_date": 1463573429, "last_edit_date": 1463648197, "question_id": 37299208, "link": "https://stackoverflow.com/questions/37299208/array-of-pointers-as-argument-in-c-functions", "title": "array of pointers as argument in c functions", "body": "<p>I'm stuck in C array pointer and passing it as argument into c functions. Here is the code where issues are involved: </p>\n\n<pre><code>char *src_filename1 = NULL;\nAVFrame *frame = NULL;\nAVFrame *frames_video1[3];\nAVFrame *frames_video2[3];\n\nint decode_packet(int *got_frame, int cached, AVFrame *frames_video[])\n{\n    ...\n    frames_video[video_frame_count] = frame; //video_frame_count is 2 at the moment\n    ...\n}\n\nint main()\n{\n    decode_video(src_filename1, frames_video1);\n    ...\n    printf(\"frames_video1[i]-&gt;pkt_size: %d\\n\", frames_video1[i]-&gt;pkt_size);\n    ...\n}\nint decode_video(char *src_filename, AVFrame *frames_video[])\n{\n    ...\n    decode_packet(&amp;got_frame, 0, frames_video);\n    ...\n}\n</code></pre>\n\n<p>I could compile the code, but when I executed it, I encountered segmentation fault caused by <code>frames_video1[i]-&gt;pkt_size</code>\nHow shall I pass arguments in this context? I find when dealing with char*[] and char** especially when using them as function arguments, my hands always get dirty...</p>\n\n<p><strong>EDIT NEW CODE:</strong> (which works!)</p>\n\n<pre><code>char *src_filename1 = NULL;\nAVFrame *frame = NULL;\nAVFrame frames_video1[3];\nAVFrame frames_video2[3];\n\nint decode_packet(int *got_frame, int cached, AVFrame frames_video[])\n{\n    ...\n    AVFrame tmp;\n    tmp = *frame;\n    frames_video[video_frame_count] = tmp;\n    ...\n}\n\nint main()\n{\n    decode_video(src_filename1, frames_video1);\n    ...\n    printf(\"frames_video1[i].pkt_size: %d\\n\", frames_video1[i].pkt_size);\n    ...\n}\nint decode_video(char *src_filename, AVFrame frames_video[])\n{\n    ...\n    decode_packet(&amp;got_frame, 0, frames_video);\n    ...\n}\n</code></pre>\n\n<p>Let me briefly summarize the main issue of the old code: It had little to do with initialization, the main problem was the passing array of pointers as argument, was really about passing argument all the way properly: after hearing the suggestion from @SF., I changed the argument from AVFrame *frames_video[] to AVFrame frames_video[], and supprisingly everything worked well! It also means <code>AVFrame frames_video1[]</code> has been finally successfully \"received\" by <code>decode_packet</code> function... \"Arrays behave as pointers in so many ways that you're getting drowned in pointer-to-pointer bog.\", that's what he said. Actually, I still don't quite really understand how c pointers (especially when associated with arrays) work in a deeply sense...</p>\n"}, {"tags": ["c", "linux", "makefile"], "answers": [{"tags": [], "owner": {"reputation": 579, "user_id": 4371177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0deb2a7b0ef3f1264fab392cb1584f72?s=128&d=identicon&r=PG&f=1", "display_name": "Mazhar", "link": "https://stackoverflow.com/users/4371177/mazhar"}, "is_accepted": false, "score": 3, "last_activity_date": 1463572384, "last_edit_date": 1463572384, "creation_date": 1463570962, "answer_id": 37298289, "question_id": 37297983, "link": "https://stackoverflow.com/questions/37297983/makefile-dependicies/37298289#37298289", "title": "Makefile Dependicies", "body": "<p>I don't know why are you getting this linker/loader error, may be you are not mentioning <code>v.h</code> with <code>v.c</code> but this is a sample your Makefile should look like which I used to use once. </p>\n\n<p>Consider you have a directory name <code>folder</code> and you have placed all your files <code>main.c , v.h and v.c</code> in that directory. Then create a file by name <code>Makefile</code> in that directory. Contents of the Makefile should be as follow </p>\n\n<pre><code>all: main.out \n\nmain.out: main.c v.o\n      gcc -o main.out main.c v.o\n\nv.o:   v.c v.h\n     gcc -c v.c \n\nclean: \n     rm -rf main.out *.o \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1087, "user_id": 6216412, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-VBq_1GQLaPo/AAAAAAAAAAI/AAAAAAAAACM/IhU9o5yTRhc/photo.jpg?sz=128", "display_name": "Tirafesi", "link": "https://stackoverflow.com/users/6216412/tirafesi"}, "edited": false, "score": 0, "creation_date": 1463589006, "post_id": 37299721, "comment_id": 62132339, "body": "Thank you! This solved one of the problems, which made me able to solve the other ones my makefile had. Everything is good now :D"}], "tags": [], "owner": {"reputation": 173, "user_id": 4983935, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A53GtLDKiLY/AAAAAAAAAAI/AAAAAAAAAIM/vNOrQrWqdo8/photo.jpg?sz=128", "display_name": "Lucky Sharma", "link": "https://stackoverflow.com/users/4983935/lucky-sharma"}, "is_accepted": true, "score": 1, "last_activity_date": 1463574629, "creation_date": 1463574629, "answer_id": 37299721, "question_id": 37297983, "link": "https://stackoverflow.com/questions/37297983/makefile-dependicies/37299721#37299721", "title": "Makefile Dependicies", "body": "<p>because you are trying to generate an executable when you are doing </p>\n\n<pre><code>bin/v: v.c\n    cc v.c -o bin/v -Wall\n</code></pre>\n\n<p>You need to give flag -c to just compile , since v.c  doesn't contain any main that's why Linker  is giving error.\nIn layman terms,\nLinker &amp; loaders comes into the picture of compilation when then need to generate executable</p>\n"}], "owner": {"reputation": 1087, "user_id": 6216412, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-VBq_1GQLaPo/AAAAAAAAAAI/AAAAAAAAACM/IhU9o5yTRhc/photo.jpg?sz=128", "display_name": "Tirafesi", "link": "https://stackoverflow.com/users/6216412/tirafesi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 37299721, "answer_count": 2, "score": 0, "last_activity_date": 1463574629, "creation_date": 1463570173, "question_id": 37297983, "link": "https://stackoverflow.com/questions/37297983/makefile-dependicies", "title": "Makefile Dependicies", "body": "<p>I need help creating a Makefile.</p>\n\n<p>My files:</p>\n\n<p>g.c</p>\n\n<p>v.h</p>\n\n<p>v.c</p>\n\n<p>main() is inside g.c, which includes v.h</p>\n\n<p>My Makefile looks like this:</p>\n\n<pre><code>all: bin/v bin/g\n\nbin/v: v.c\n    cc v.c -o bin/v -Wall\n\nbin/g: g.c\n    cc g.c -o bin/g -D_REENTRANT -lpthread -Wall\n\nPHONY: all\n</code></pre>\n\n<p>When running make all, I get tons of errors:</p>\n\n<p>relocation X has invalid symbol index Y</p>\n\n<p>followed by</p>\n\n<p>/usr/lib/gcc/x86_64-linux-gnu/4.8/../../../x86_64-linux-gnu/crt1.o: In function `_start':</p>\n\n<p>(.text+0x20): undefined reference to `main'\ncollect2: error: ld returned 1 exit status</p>\n\n<p>What should my Makefile look like?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c", "windbg", "symbols"], "comments": [{"owner": {"reputation": 2173, "user_id": 1317574, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e67222870db5dfc5194cdca848c59818?s=128&d=identicon&r=PG", "display_name": "Marc Sherman", "link": "https://stackoverflow.com/users/1317574/marc-sherman"}, "edited": false, "score": 0, "creation_date": 1463578102, "post_id": 37297969, "comment_id": 62124382, "body": "It&#39;s weird that the local path to your symbols is different in the expanded symbol path."}, {"owner": {"reputation": 1657, "user_id": 812032, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cd59937927787b5a008cf99af6147663?s=128&d=identicon&r=PG", "display_name": "bhavs", "link": "https://stackoverflow.com/users/812032/bhavs"}, "reply_to_user": {"reputation": 2173, "user_id": 1317574, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e67222870db5dfc5194cdca848c59818?s=128&d=identicon&r=PG", "display_name": "Marc Sherman", "link": "https://stackoverflow.com/users/1317574/marc-sherman"}, "edited": false, "score": 0, "creation_date": 1463633805, "post_id": 37297969, "comment_id": 62148873, "body": "@MarcSherman I have manually edited some of the paths to shorten them when I  posted the query, I had updated the correct paths."}, {"owner": {"reputation": 2173, "user_id": 1317574, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e67222870db5dfc5194cdca848c59818?s=128&d=identicon&r=PG", "display_name": "Marc Sherman", "link": "https://stackoverflow.com/users/1317574/marc-sherman"}, "edited": false, "score": 0, "creation_date": 1463663857, "post_id": 37297969, "comment_id": 62168008, "body": "Looks like icl.exe is the Intel compiler/linker. I don&#39;t have any experience with how it generates symbols."}, {"owner": {"reputation": 7454, "user_id": 3622813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ndlyo.jpg?s=128&g=1", "display_name": "blabb", "link": "https://stackoverflow.com/users/3622813/blabb"}, "edited": false, "score": 0, "creation_date": 1463731786, "post_id": 37297969, "comment_id": 62199413, "body": "google says icl upto v11 didnt create a renamed pdb file with /Fd switch and was fixed in some version &gt; 12   the dbghelp messages doesnt even look for a pdb and showing cannot fetch pdb  files so does the xxx.pdb exist for xxx.exe ?  at the given path ? does a DebugDirectory Exist in the executables PEHeader and does it point to a pdb path"}, {"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 0, "creation_date": 1464008352, "post_id": 37297969, "comment_id": 62292562, "body": "You say a PDB was generated, but the debugger looks for DBG files only. Is it really this way? I never managed to get good results from DBG files."}, {"owner": {"reputation": 1657, "user_id": 812032, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cd59937927787b5a008cf99af6147663?s=128&d=identicon&r=PG", "display_name": "bhavs", "link": "https://stackoverflow.com/users/812032/bhavs"}, "edited": false, "score": 0, "creation_date": 1464081199, "post_id": 37297969, "comment_id": 62325183, "body": "It seemed like the pdb file was actually not being generated properly, once the pdb file was generated and the path pointed to correctly I got this working but looks like the pdb file did not have any private symbols in it which is still not very helpful"}], "owner": {"reputation": 1657, "user_id": 812032, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cd59937927787b5a008cf99af6147663?s=128&d=identicon&r=PG", "display_name": "bhavs", "link": "https://stackoverflow.com/users/812032/bhavs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1463633746, "creation_date": 1463570139, "last_edit_date": 1463633746, "question_id": 37297969, "link": "https://stackoverflow.com/questions/37297969/unable-to-load-symbol-table-with-windbg", "title": "unable to load symbol table with windbg", "body": "<p>Newbie question when trying to debug a enterprise level executable. The c code is compiled using the following option</p>\n\n<pre><code>        icl.exe /nologo /MTd /W3 /Gm /GX /Zi /Od /D \"WIN64\" /D \"_DEBUG\" /D \"_WINDOWS\" /Fp\".\\win64\\debug\\setup.pch\" /YX /Fo\".\\win64\\debug\\\\\" /Fd\".\\win64\\debug\\\\\" /c ..\\c\\runInstaller.c\n</code></pre>\n\n<p>I have added a <code>DebugBreak()</code> in the code to perform a hard - break point when the executable is loaded into windbg. I am able to load the source file, but unable to watch any of the variables.</p>\n\n<p>The Symbol path looks like this; points to the pdb file and the microsoft symbols as well</p>\n\n<p><code>0:000&gt; .sympath\nSymbol search path is: srv*c:\\Symbols*http://msdl.microsoft.com/download/symbols;C:\\oii\\oiib\\bin\\win64\\debug\nExpanded Symbol search path is: srv*c:\\symbols*http://msdl.microsoft.com/download/symbols;c:\\oii\\oiib\\bin\\win64\\debug</code></p>\n\n<p>When I try the following </p>\n\n<pre><code>!sym noisy\n.reload\nSYMSRV:  http://msdl.microsoft.com/download/symbols/image00000001`3f2d0000.dbg/573C41C963000/image00000001`3f2d0000.dbg not found\nDBGHELP: c:\\oii\\oiib\\bin\\win64\\debug\\image00000001`3f2d0000.dbg - file not found\nDBGHELP: c:\\oii\\oiib\\bin\\win64\\debug\\.exe\\image00000001`3f2d0000.dbg - path not found\nDBGHELP: c:\\oii\\oiib\\bin\\win64\\debug\\symbols\\.exe\\image00000001`3f2d0000.dbg - path not found\nDBGHELP: C:\\oii\\oiib\\bin\\win64\\image00000001`3f2d0000.dbg - file not found\nDBGHELP: C:\\oii\\oiib\\bin\\win64\\.exe\\image00000001`3f2d0000.dbg - path not found\nDBGHELP: C:\\oii\\oiib\\bin\\win64\\symbols\\.exe\\image00000001`3f2d0000.dbg - path not found\n</code></pre>\n\n<p>Do I have to generate the symbols in any other way ?  Also I am unable to watch any of the variables/set breakpoints in the code. I am suspecting that I am missing something vital here. </p>\n\n<p>Edited the symbol paths </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 5, "creation_date": 1463566878, "post_id": 37296642, "comment_id": 62116305, "body": "Your code is not standard C."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1463571465, "post_id": 37296642, "comment_id": 62119445, "body": "Out of curiosity, which compiler allows this switch?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1463574892, "post_id": 37296642, "comment_id": 62121961, "body": "@Lundin <code>gcc</code> as an <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Case-Ranges.html\" rel=\"nofollow noreferrer\">extension</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 6350267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf437786b682520f118648ca32c67576?s=128&d=identicon&r=PG&f=1", "display_name": "abdelrahman", "link": "https://stackoverflow.com/users/6350267/abdelrahman"}, "edited": false, "score": 0, "creation_date": 1463567349, "post_id": 37296779, "comment_id": 62116649, "body": "so it will not check the condition of the next case, just continue no matter what is the condition"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 7, "user_id": 6350267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf437786b682520f118648ca32c67576?s=128&d=identicon&r=PG&f=1", "display_name": "abdelrahman", "link": "https://stackoverflow.com/users/6350267/abdelrahman"}, "edited": false, "score": 0, "creation_date": 1463568002, "post_id": 37296779, "comment_id": 62117123, "body": "@abdelrahman, yes, consider using <code>do {grade=get_grade();} while (grade &gt; 100);</code> instead of <code>grade=get_grade();</code> before the <code>switch</code> and remove the <code>case 101 ... 999 :</code> block"}], "tags": [], "owner": {"reputation": 16916, "user_id": 1562138, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/qwj5I.png?s=128&g=1", "display_name": "fvgs", "link": "https://stackoverflow.com/users/1562138/fvgs"}, "is_accepted": true, "score": 1, "last_activity_date": 1463566987, "creation_date": 1463566987, "answer_id": 37296779, "question_id": 37296642, "link": "https://stackoverflow.com/questions/37296642/switch-and-case-with-fall-through-odd-behaviour/37296779#37296779", "title": "switch and case with fall-through, odd behaviour", "body": "<p>As the comment in the code you posted specifies, there is fall through from the first case to the second case in the switch block. Therefore, after calling <code>get_grade()</code> for the second time, the code proceeds into the second case.</p>\n"}], "owner": {"reputation": 7, "user_id": 6350267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf437786b682520f118648ca32c67576?s=128&d=identicon&r=PG&f=1", "display_name": "abdelrahman", "link": "https://stackoverflow.com/users/6350267/abdelrahman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 37296779, "answer_count": 1, "score": -3, "last_activity_date": 1463567022, "creation_date": 1463566631, "last_edit_date": 1463567022, "question_id": 37296642, "link": "https://stackoverflow.com/questions/37296642/switch-and-case-with-fall-through-odd-behaviour", "title": "switch and case with fall-through, odd behaviour", "body": "<p>I wrote the following code and I don't seem to why its behaving this way, can you help me, simple the code request from user to enter grade between 1 and 100, if user entered value greater than 100, the code prompt the user to try again, the odd behavior is when the user at his second entry, he entered again value greater than 100, the code evaluate result as Grade A, why its doing that:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint get_grade(void){\nint grade;\nscanf (\"%3d\",&amp;grade);\nreturn grade;\n}\n\nint main (){\nint grade=0;\nprintf (\"please Enter your Grade \\n\");\ngrade=get_grade();\nswitch (grade){\n    case 101 ... 999 :\n    printf (\"the score is out of 100 and you entered %d, please enter new Grade :\",grade);\n    grade=get_grade();\n    // we removed break to continue with next case, this step is called fall through in programming\n    case 80 ... 100:\n    printf (\"your grade is A %d\\n\",grade);\n    break;\n    case 60 ... 79:\n    printf(\"your grade is B \\n\");\n    break;\n    case 50 ... 59:\n    printf (\"your grade is C \\n\");\n    break;\n    default:\n    printf (\"we consider you failed \\n\");\n}\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "linker", "libgcrypt"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1463566584, "post_id": 37296524, "comment_id": 62116094, "body": "Did the person telling to do that also mention it may be worth your time to investigate whether you&#39;re trying to link non-matching <i>architectures</i> (i.e. 64bit lib against a 32bit process, or vice-versa) ? And fyi, the libgcrypt-config is a utility that should be executed inside ticks, not quotes. <code>`</code> vs <code>&#39;</code>. The key to the left of your keyboard top-row numeric <code>1</code>. Ex: <code>gcc -o foo foo.c `libgcrypt-config --cflags --libs`</code>"}, {"owner": {"reputation": 43, "user_id": 1342891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36cd6580ed4ba793044573dfaaf0848?s=128&d=identicon&r=PG&f=1", "display_name": "zodkc", "link": "https://stackoverflow.com/users/1342891/zodkc"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1463567429, "post_id": 37296524, "comment_id": 62116723, "body": "Sorry for the trouble. I did come across the non-matching architectures in my research. I could barely understand them though. However, I used sudo apt-get install to install libgcrypt, I don&#39;t know if that&#39;s going to have problems.   And Boy, oh boy, do I feel stupid. I was looking at images from two differents .pdfs. which uses fonts that make &#39; and ` look ridiculously similar. Thank you. That resolved my problem."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 1342891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36cd6580ed4ba793044573dfaaf0848?s=128&d=identicon&r=PG&f=1", "display_name": "zodkc", "link": "https://stackoverflow.com/users/1342891/zodkc"}, "edited": false, "score": 1, "creation_date": 1463567523, "post_id": 37296733, "comment_id": 62116796, "body": "Yes, this resolved my problem. Thank you. The images I looked at which were from .pdfs used fonts that made &#39; and ` look very similar... Now I feel like an idiot.  On that note though. what does text started and ended with ` signify when you&#39;re using it in this context? I would like to know. Thank you."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 43, "user_id": 1342891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36cd6580ed4ba793044573dfaaf0848?s=128&d=identicon&r=PG&f=1", "display_name": "zodkc", "link": "https://stackoverflow.com/users/1342891/zodkc"}, "edited": false, "score": 0, "creation_date": 1463574427, "post_id": 37296733, "comment_id": 62121613, "body": "You are welcome, everything you type between backticks is evaluated (executed) by the shell before the main command: <a href=\"http://unix.stackexchange.com/questions/27428/what-does-backquote-backtick-mean-in-bash\" title=\"what does backquote backtick mean in bash\">unix.stackexchange.com/questions/27428/&hellip;</a>"}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": true, "score": 3, "last_activity_date": 1463566851, "creation_date": 1463566851, "answer_id": 37296733, "question_id": 37296524, "link": "https://stackoverflow.com/questions/37296524/newbie-ld-exit-return-1-and-libgcrypt/37296733#37296733", "title": "(Newbie) ld exit return 1, and libgcrypt", "body": "<p>Try:</p>\n\n<pre><code>$ gcc -o foo foo.c `libgcrypt-config --cflags --libs`\n</code></pre>\n\n<p>` instead of '</p>\n"}], "owner": {"reputation": 43, "user_id": 1342891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36cd6580ed4ba793044573dfaaf0848?s=128&d=identicon&r=PG&f=1", "display_name": "zodkc", "link": "https://stackoverflow.com/users/1342891/zodkc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 37296733, "answer_count": 1, "score": 1, "last_activity_date": 1463566877, "creation_date": 1463566299, "question_id": 37296524, "link": "https://stackoverflow.com/questions/37296524/newbie-ld-exit-return-1-and-libgcrypt", "title": "(Newbie) ld exit return 1, and libgcrypt", "body": "<p>After much research, trying to find out how to link libraries to gcc, going to /usr/bin and /usr/lib confirming the stuff are there. When I try to compile my keygen file, this is the error it blurts out. </p>\n\n<pre><code>$ gcc keygen.c -W -Wall /usr/bin/libgcrypt-config\n/usr/bin/libgcrypt-config: file not recognized: File format not recognized\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>I've been told by numerous sources that I should compile this way to check if libgcrypt installed correctly.</p>\n\n<pre><code>$ gcc -o foo foo.c 'libgcrypt-config --cflags --libs'\n</code></pre>\n\n<p>But everytime I try to do that this is what it blurts out:</p>\n\n<pre><code>gcc: error: libgcrypt-config --cflags --libs: No such file or directory\n</code></pre>\n\n<p>I've confirmed that libgcrypt20 and libgcrypt20-dev are installed using dpkg --get-selections>installed. But I am just so utterly confused as to what may be wrong. </p>\n\n<p>Any form of help would be much appreciated.</p>\n"}, {"tags": ["c", "vectorization", "multiplication", "avx", "avx2"], "comments": [{"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 2, "creation_date": 1463566328, "post_id": 37296289, "comment_id": 62115940, "body": "If you do it this way you are taking a huge penalty of moving from simd register to alu register. Just doesn&#39;t worth it."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1463574106, "post_id": 37296289, "comment_id": 62121386, "body": "gcc generates Karatsuba-ish code using 3 32x32\u219264 multiplications, 3 32-bit-shifts and two adds. Looks to be fairly good for ILP, too."}, {"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1463584349, "post_id": 37296289, "comment_id": 62129160, "body": "@EOF It isn&#39;t quite Karatsuba-ish. The 64x64 to low 64-bit multiply doesn&#39;t need the top half. So you don&#39;t need the high x high multiply at all. That leaves the other 3."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1463653760, "post_id": 37296289, "comment_id": 62160511, "body": "@EOF: I only see two 64bit shifts (with a count of 32) in gcc5.3&#39;s auto-vectorized output.  There are two adds, though.  (The sub in the output is from the <code>-=</code>).  Anyway, on Haswell, it&#39;s potentially slower than an unrolled hand-tuned scalar asm loop (load/<code>imul</code>/<code>sub</code>-with-memory-dest), bottlenecking on load/store throughput after unrolling.  With C intrinsics and compiler output, you&#39;re probably going to get faster code with vectors, though."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1463654735, "post_id": 37296289, "comment_id": 62161224, "body": "@davmac: for gcc, <code>__m256i</code> is defined with a &quot;may alias&quot; attribute, which is why it does what the user expects with gcc.  You&#39;re absolutely right that it&#39;s not safe or a good idea in general.  A union with a struct is a better idea."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1463657137, "post_id": 37296289, "comment_id": 62162905, "body": "<a href=\"http://stackoverflow.com/questions/28807341/simd-signed-with-unsigned-multiplication-for-64-bit-64-bit-to-128-bit\">This</a> may be of interest."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 2, "creation_date": 1463657960, "post_id": 37296289, "comment_id": 62163465, "body": "It&#39;s not clear to me if you want a AVX or AVX2 solution (or both). It makes a big difference."}, {"owner": {"reputation": 671, "user_id": 4544687, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-fRQn7I2YY9M/AAAAAAAAAAI/AAAAAAAAAdI/K8vhsr0XtPM/photo.jpg?sz=128", "display_name": "H&#233;lder Gon&#231;alves", "link": "https://stackoverflow.com/users/4544687/h%c3%a9lder-gon%c3%a7alves"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1463667710, "post_id": 37296289, "comment_id": 62171351, "body": "@user3528438 Thank you for the note.  @PeterCordes I substitute the <code>-=</code> by the C intrisic <code>_mm256_sub_epi64</code> after the multiplication loop-unroll. Right now I have <code>ptr_J[0] *= q;</code>. I get a speedup from this. @Zboson I&#39;m using a Haswell microarchitecture, so I can use both."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1463672353, "post_id": 37296289, "comment_id": 62175068, "body": "@H&#233;lderGon&#231;alves: you&#39;ll get a bigger speedup from letting gcc auto-vectorize the whole thing, or using the intrinsics code from my answer.  Or even from plain scalar code without vectorization.  Your code still has to extract and insert into the ymm vector.  (<b>It&#39;s probably a slowdown.  Did you test vs. a baseline?</b>)  Also, don&#39;t use <code>__int64_t</code> directly.  Just <code>#include &lt;stdint.h&gt;</code> and use <code>int64_t</code> so your code is portable.  Fortunately, the low 64bits result of a 64bx64b multiply is the same whether the input is signed or unsigned, so the code gives identical results either way."}], "answers": [{"comments": [{"owner": {"reputation": 1026, "user_id": 4068338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y8uJJ.png?s=128&g=1", "display_name": "Matsmath", "link": "https://stackoverflow.com/users/4068338/matsmath"}, "edited": false, "score": 0, "creation_date": 1463653816, "post_id": 37320416, "comment_id": 62160554, "body": "This is a very helpful post. While this site does not encourage questions to ask about recommended resources, perhaps a comment about <i>Where can I learn about this stuff step-by-step in a tutorial way?</i> could be much appreciated."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1026, "user_id": 4068338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y8uJJ.png?s=128&g=1", "display_name": "Matsmath", "link": "https://stackoverflow.com/users/4068338/matsmath"}, "edited": false, "score": 1, "creation_date": 1463654174, "post_id": 37320416, "comment_id": 62160816, "body": "@Matsmath: No worries.  updated to link to Agner Fog&#39;s guides and the x86 tag wiki.  I learned this stuff by reading Agner Fog&#39;s guides, and reading the <a href=\"http://realworldtech.com/\" rel=\"nofollow noreferrer\">realworldtech.com</a> forums and microarchitecture writeups.  (Just reading, though; I&#39;ve only posted once or twice there).  If you don&#39;t know how a simple pipelined CPU works, maybe read about RISC pipelines."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1463657005, "post_id": 37320416, "comment_id": 62162816, "body": "I think you could be more precise when you write &quot;Modern Intel CPUs&quot;.  Maybe &quot;Since Haswell (2013)...&quot; Because before Haswell Intel CPUs could not do two SIMD loads and one SIMD store per cycle. Very few people at my work have anything as modern as Haswell."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1463657273, "post_id": 37320416, "comment_id": 62162996, "body": "@Zboson: That was a sloppy edit after I noticed that the algorithm was a read-modify-write.  (<code>-=</code> not <code>=</code>).  Updated to apply to Sandybridge-family and AMD Bulldozer-family."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 1, "creation_date": 1463657653, "post_id": 37320416, "comment_id": 62163260, "body": "This may be iteresting to you.  For 128bx128b to 128b (lower) for unsigned you only need 32bx32b-&gt;64b.  I mean 64bx64b -&gt;64b (lower) does not help. But for signed 128bx128b to 128b (lower) you need a few more instructions if you don&#39;t have 64bx64b -&gt;64b (lower).  That&#39;s one reason why <code>vpmullq</code> (if it is not to slow) could be interesting."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1463658388, "post_id": 37320416, "comment_id": 62163770, "body": "Oh, never mind, I forgot that <code>mulx</code> will still beat SIMD 128-bit mul anyway so <code>vpmullq</code> is probably only interesting for 64bx64b -&gt;64b (lower)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1463661247, "post_id": 37320416, "comment_id": 62165958, "body": "@Zboson: fun fact: <code>mulx</code> has 4 cycle latency vs. 3 cycle latency for <code>mul</code>.  IDK why.  They&#39;re both 2 uops (p1+p5 vs. p1+p6).  I keep forgetting that <code>mulx</code> produces a 128b result, though.  But of course it does, that&#39;s what makes it useful to interleave with <code>adc</code>.  (And otherwise its only purpose would be a 3-operand non-destructive <code>imul r,r&#47;m</code>: useful in this case to save one fused-domain uop for load+mul.)"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1463661783, "post_id": 37320416, "comment_id": 62166373, "body": "Agner Fog&#39;s tables place <code>[V]PS[L&#47;R]LDQ</code> on port 5 on Haswell, staying out of the way of the multiplies."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1463662051, "post_id": 37320416, "comment_id": 62166602, "body": "@EOF: That&#39;s the byte-shift instruction (for one 128b element).  We need to shift in zeros into the high 32 of each 64bit element.  <code>pshufb</code> will do the trick, but <code>psrldq</code> won&#39;t."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1463662201, "post_id": 37320416, "comment_id": 62166713, "body": "@PeterCordes Fair point. On the other hand <code>[V]PAND</code> can run on ports 0,1,5 and is has a single cycle latency."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1463664613, "post_id": 37320416, "comment_id": 62168663, "body": "@EOF: We&#39;re bottlenecked on fused-domain uop throughput on Skylake, so more instructions hurts there.  Using a shuffle-immediate + AND isn&#39;t worth it to avoid needing a 16B <code>pshufb</code> shuffle control mask.  Even on Haswell, an extra <code>vpand</code> will probably steal some port0 cycles, reducing total throughput."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1463724205, "post_id": 37320416, "comment_id": 62195092, "body": "So the &quot;moral of the story&quot; is that for AVX you can&#39;t beat 64-bit scalar mult but with AVX2 you can maybe marginally beat 64-bit scalar mult?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1463725734, "post_id": 37320416, "comment_id": 62195870, "body": "@Zboson: I think the intrinsic AVX2 version is a bit faster than scalar on Haswell.  Both versions will be much faster on Skylake.  Also note that getting a compiler to make the &quot;ideal&quot; scalar code is probably really hard, so the penalty for compilers being dumb will be worse than for vectors.  It requires one-register addressing modes for the dst, but not src.  With a big unroll, wasting an insn on src inc is ok.  An AVX version on IvyBridge is not quite as bad as Haswell, but prob. still worse than scalar.  <code>pmulld</code> is only 1 uop there.  Emulating the shift with <code>pshufb</code> would still help."}, {"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 1, "creation_date": 1465843769, "post_id": 37320416, "comment_id": 63060208, "body": "I have a very strong feeling that <code>vpmullq</code> is not going to be 1 per clock. (2 if you include both ports.) The existence of the IFMA52 instructions basically says that the chip is not going to have a native SIMD 64-bit multiplier. And to be fair, going full 64-bit multipliers in the SIMD unit is lot of extra area."}, {"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 2, "creation_date": 1498850034, "post_id": 37320416, "comment_id": 76687656, "body": "@Zboson <a href=\"https://github.com/InstLatx64/InstLatx64/blob/master/GenuineIntel0050654_SkylakeX_InstLatX64.txt\" rel=\"nofollow noreferrer\">Some latency #&#39;s are out for Skylake Purley.</a> As I expected, <code>vpmullq</code> is not 1 uop. It appears to be 3 with a latency of about 15 cycles (3 x 5 cycle multiply). I actually <a href=\"https://stackoverflow.com/questions/41403718/can-i-use-the-avx-fma-units-to-do-bit-exact-52-bit-integer-multiplications#comment70110790_41403718\">predicted it could be 3 a while back.</a>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1498864105, "post_id": 37320416, "comment_id": 76692518, "body": "@Mysticial: Thanks!  Those numbers don&#39;t say what port instructions run on, so you can&#39;t tell which throughput=1 instructions conflict with each other.  I did some testing a while ago on a Google Cloud SKL-AVX512 VM.  I think my conclusion was that mask instructions (<code>kand</code> / <code>kunpck</code> etc.) run on port5, conflicting with shuffles, but that was a while ago and GCE doesn&#39;t expose perf counters so it was guesswork.  I might be mis-remembering, and I don&#39;t remember if I made notes."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1498864365, "post_id": 37320416, "comment_id": 76692565, "body": "@Mysticial:  BTW, <a href=\"http://www.anandtech.com/show/11550/the-intel-skylakex-review-core-i9-7900x-i7-7820x-and-i7-7800x-tested/3\" rel=\"nofollow noreferrer\">Anandtech says</a> the 6 and 8-core part will have half-throughput for AVX512 FMA, with some weird execution-unit sharing, and having an FMA unit on port5.  (Maybe not execution <i>port</i> sharing though; hopefully ZMM FMA is still only 1 uop and can issue at the same time as a non-FP instruction for port0 or port1)   That report confirms that the 10-core part has full-throughput for 512b FMA, but doesn&#39;t shed any light on the execution-port/unit possible weirdness."}, {"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 1, "creation_date": 1498883635, "post_id": 37320416, "comment_id": 76695021, "body": "@PeterCordes <a href=\"http://www.overclock.net/t/1632638/just-a-heads-up-for-anyone-buying-x299-if-you-want-full-avx-capability-you-need-to-buy-the-7900x-and-up/20#post_26181442\" rel=\"nofollow noreferrer\">Here&#39;s a benchmark that shows an ES 6-core having full-throughput AVX512.</a> But I have yet to find out if retail 6 and 8-cores have half or full-throughput. I literally just finished assembling a 7900X system which is sitting on my kitchen counter right now running updates. So I have yet to run any proper tests on it. But that won&#39;t answer the question of whether the 6 and 8 cores will have full-throughput AVX512."}, {"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1498883723, "post_id": 37320416, "comment_id": 76695039, "body": "Right away I can tell that most of my AVX512 code has some severe bottlenecks from yet-to-be-determined sources. But I don&#39;t want to run too many tests while the system is updating since there seems to be a hint of instability that I&#39;ll need to sort out later. The motherboard seems to be overclocking it to 4 GHz without me asking it to do so. 4 GHz on all cores is a bit too high to be the normal turbo. I&#39;m gonna be busy this weekend."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1498883952, "post_id": 37320416, "comment_id": 76695077, "body": "@Mysticial: Looking forward to finding out the full details once the dust settles. :)  Hopefully someone will give Agner Fog remote access to a system so he can update his insn tables, too."}, {"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1498884231, "post_id": 37320416, "comment_id": 76695108, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/148101/discussion-between-mysticial-and-peter-cordes\">continue this discussion in chat</a>."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "reply_to_user": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1499063924, "post_id": 37320416, "comment_id": 76736420, "body": "@Mysticial from what I read on <a href=\"http://www.anandtech.com/show/11550/the-intel-skylakex-review-core-i9-7900x-i7-7820x-and-i7-7800x-tested\" rel=\"nofollow noreferrer\">anandtech</a> the i7-7800X and i7-7820X don&#39;t increase the throughput of AVX512 compared to AVX. They split a 512-bit operation between two 256-bit ports (similar to how AMD splits AVX between two 128-bit ports). However, the 7900X has a dedicated AVX512 port so it does double the throughput. Though it seems it by be complicated to optimized with one 512-bit port and two 256-bit ports to get max throughput (two 512-bit ports would be simpler)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1499064303, "post_id": 37320416, "comment_id": 76736634, "body": "@Zboson: My guess is that they have the weird multi-port stuff so flaws in the silicon somewhere in an FMA unit let them still use that core with full throughput for 256b and 128b FMA.  So they can fuse off a couple whole cores, <i>and</i> parts of the FMA units in some other cores, and sell it as an 8-core i7-7820X.  On the high-core and extreme-core silicon, where all the SKUs must have full-throughput FMA units, they might (I hope) just widen the FMA units on p0/p1 to 512b, since any flaw anywhere in an FMA unit means the core is ruined."}, {"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 1, "creation_date": 1499093120, "post_id": 37320416, "comment_id": 76754905, "body": "@Zboson If you read the chat transcript between me and Peter, you&#39;ll notice that I&#39;ve been observing a sort of &quot;AVX512 throttle&quot; that kicks in when the TDP is exceeded. I strongly suspect that this involves turning off that port5 dedicated FMA. I don&#39;t have enough evidence to confirm this theory, but so far everything I&#39;ve seen agrees with it."}, {"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1499093631, "post_id": 37320416, "comment_id": 76755216, "body": "@PeterCordes They bin them differently. If there&#39;s anything wrong with the core (bad FMA, low clock speeds), they simply disable the entire core and sell it a lower core-count part. Every single activated core on these chips are required to hit a minimum of 4.3 GHz. That&#39;s high enough that there&#39;s almost no room for any errors."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1499095595, "post_id": 37320416, "comment_id": 76756453, "body": "@Mysticial: My thinking is that the routing from ports to actual FMA execution units could be chosen after testing for defects.  With 4 x 256b  &quot;lanes&quot; of FMA units, only 2 of them need to be defect-free for the core to be usable.  p0 and p1 get wired up to lanes that work.  If all 4 work, then that core can be used in a full-FMA-throughput SKU with p5 wired too.  This design would let them fuse off defects with smaller granularity than at the core level.  If they weren&#39;t doing something like this, why the heck would they complicate things instead of just widening the p0 / p1 FMAs to 512b?"}, {"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1499096124, "post_id": 37320416, "comment_id": 76756769, "body": "@PeterCordes I&#39;m tempted to think that it&#39;s not that simple to &quot;simply rewire the working 256-bit lanes&quot;. The logic there is probably not trivial. Since each 256-bit lane would need to be designed to be either the bottom or top half of the 512-bit unit. And that probably complicates a lot of the routing as well. The way it&#39;s designed now, that port5 FMA is the one and only &quot;optional&quot; feature that can be disabled without turning off the entire core. And based on the throttling that I&#39;m seeing, they made it run-time toggleable."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1499096997, "post_id": 37320416, "comment_id": 76757292, "body": "@Mysticial: oh right.  That makes much more sense.  Anyway, that still lets them fuse off an FMA but keep the core (for a 512b-half-throughput SKU), if there&#39;s a defect in the p5 FMA but the core is otherwise fine.  They couldn&#39;t do that nearly as easily if they just widened the p0 and p1 FMA units.  But they might just widen p01 in the higher core-count silicon since there are no 512b-half-throughput SKUs that use that silicon, so a defect anywhere in any FMA unit kills the core."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "reply_to_user": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1499151044, "post_id": 37320416, "comment_id": 76775119, "body": "@Mysticial, why did Intel bother implementing <code>vpmullq</code>? Is this for forward planning? A future processor could implement it as a single uop. That&#39;s the only good reason I can see for them to implement <code>vpmullq</code> now."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 1, "creation_date": 1499151831, "post_id": 37320416, "comment_id": 76775591, "body": "@Zboson: One per 1.5 cycles is <i>much</i> better throughput than our AVX2 32-bit-chunks implementations achieve, and probably also better latency.  3 uops is not bad at all.  <code>vpmulld</code> is still 2 uops on Haswell and later, including Skylake. (up from 1 uop on SnB/IvB)."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 19, "last_activity_date": 1499166077, "last_edit_date": 1499166077, "creation_date": 1463653463, "answer_id": 37320416, "question_id": 37296289, "link": "https://stackoverflow.com/questions/37296289/fastest-way-to-multiply-an-array-of-int64-t/37320416#37320416", "title": "Fastest way to multiply an array of int64_t?", "body": "<p>You seem to be assuming <code>long</code> is 64bits in your code, but then using <code>__uint64_t</code> as well.  In 32bit, the <a href=\"https://en.wikipedia.org/wiki/X32_ABI\" rel=\"nofollow noreferrer\">x32 ABI</a>, and on Windows, <code>long</code> is a 32bit type.  Your title mentions <code>long long</code>, but then your code ignores it.  I was wondering for a while if your code was assuming that <code>long</code> was 32bit.</p>\n\n<p>You're completely shooting yourself in the foot by using AVX256 loads but then aliasing a pointer onto the <code>__m256i</code> to do scalar operations.  gcc just gives up and gives you the terrible code you asked for: vector load and then a bunch of <code>extract</code> and <code>insert</code> instructions.  Your way of writing it means that <strong>both</strong> vectors have to be unpacked to do the <code>sub</code> in scalar as well, instead of using <code>vpsubq</code>.</p>\n\n<p><a href=\"http://agner.org/optimize/\" rel=\"nofollow noreferrer\">Modern x86 CPUs have very fast L1 cache that can handle two operations per clock</a>.  (Haswell and later: two loads and one store per clock).  Doing multiple scalar loads from the same cache line is better than a vector load and unpacking.  (Imperfect uop scheduling reduces the throughput to about 84% of that, though: see below)</p>\n\n<hr>\n\n<p><a href=\"http://gcc.godbolt.org/#compilers:!((compiler:g530,options:&#39;-xc++-O3+-Wall+-Wextra+-fverbose-asm+-march%3Dhaswell&#39;,sourcez:MQSwdgxgNgrgJgUwAQB4QFt3gC4CdwB0AFgHwBQZwiAZuMgEICCAygKID6AaqwBrvMAVAPIAFJAEYADACYALJRp0kTNuwAiASQCyrAHLMNQ3RJkAOCqEixEqAM7Y4OYiSRIA9G6QB3IgE8kYAD22EgwtsjYRCC2SFAgANbIAIYBgbjoSVBIAA4IuLaBYAD8FB5IuAj2%2BBAhUAjYMZHIEIHo2SB1uEjxQV5ITUhJuLhJvjFwhQDkIYEAbnlQSdkANGRlBUggIROVYNNIREnz/YFIAOYIYHlJ2MlIthCZQ0jUmVAARkkQ8UiP4WSzQIgOBIdAwKDYEDZKC%2Bdi2DDQhAAChgOAAbLJ2CEAFQVKogGpIADiIHY8wgy1C6MxIQAjpSWmB7FSwNgMVikLjKngCSEiQArMkICAASgA3mRXK5qGkkEioIUzptWZsALySADcmxQKg4mh0%2BkMui1IAA1KaRZKpdaSUKIABtEAAXSQAFpVcTBeTHS7sUhaRqyABfCilTwATUCMHuCAQ6BOSHeyVsthgWDAStiitc0SQGPeW0pMq6BXQyAqSQKYAIAKBILBEKhMKFAA95dnsbbyZSFRn/T2OwK7eKKNacJtA9b2Ox0NIAKxokBIOA3JLsfmUlfYNcgSdS6eo1nsnHZPDsABSSA9SIP1Kx2JFADIt2v%2BXvXLejzTOafcOwNFecqfmyNIPs%2Bq7sLuobWsWcogOqJo6iwHDcHwgiiCapqqrIIpIBK1rWi%2BkGATOs4LuwCpJHAcIgPOaJIjeM50SAYFdsKPoiu%2BBFEfyJGYHRFGBFRNF0Qx05kYurFeuxzqcaOBGuL%2B/72pILrujkZ7nipvr%2Blx1pKRo9riGpHpKVpxmcrpVoKQZ9rSCZGl/lp9mWQG1kEbZADMDlmfa3muYG7lTvx5H2GkCAiQuYlMQuLFPmxDrOpuEEgHJ1ohmsfoCFEMTZEMIRJDA2CBK65LFfgABelQ1pZADCrRliqWxIFGIQbAMlbxq12RFS8sqRLm1AwJAkKFJsMT8mEIQDDg%2BBMgSMQKoEgTZO5sFIohurqNoegGEYmEWkFUoJT6boekO3rOgFZDYm4wZkEAA)),filterAsm:(commentOnly:!t,directives:!t,intel:!t,labels:!t),version:3\" rel=\"nofollow noreferrer\">gcc 5.3 -O3 -march=haswell (Godbolt compiler explorer)</a> auto-vectorizes a simple scalar implementation pretty well.  <strong>When AVX2 isn't available, gcc foolishly still auto-vectorizes with 128b vectors: On Haswell, this will actually be about 1/2 the speed of ideal scalar 64bit code.</strong>  (See the perf analysis below, but substitute 2 elements per vector instead of 4).</p>\n\n<pre><code>#include &lt;stdint.h&gt;    // why not use this like a normal person?\n#define BASE_VEX_STOP 1024\n#define BASE_DIMENSION 1028\n\n// restrict lets the compiler know the arrays don't overlap,\n// so it doesn't have to generate a scalar fallback case\nvoid multiply_simple(uint64_t *restrict Gi_vec, uint64_t q, const uint64_t *restrict Gj_vec){\n    for (intptr_t i=0; i&lt;BASE_DIMENSION; i++)   // gcc doesn't manage to optimize away the sign-extension from 32bit to pointer-size in the scalar epilogue to handle the last less-than-a-vector elements\n        Gi_vec[i] -= Gj_vec[i] * q;\n}\n</code></pre>\n\n<p>inner loop:</p>\n\n<pre><code>.L4:\n    vmovdqu ymm1, YMMWORD PTR [r9+rax]        # MEM[base: vectp_Gj_vec.22_86, index: ivtmp.32_76, offset: 0B], MEM[base: vectp_Gj_vec.22_86, index: ivtmp.32_76, offset: 0B]\n    add     rcx, 1    # ivtmp.30,\n    vpsrlq  ymm0, ymm1, 32      # tmp174, MEM[base: vectp_Gj_vec.22_86, index: ivtmp.32_76, offset: 0B],\n    vpmuludq        ymm2, ymm1, ymm3        # tmp173, MEM[base: vectp_Gj_vec.22_86, index: ivtmp.32_76, offset: 0B], vect_cst_.25\n    vpmuludq        ymm0, ymm0, ymm3        # tmp176, tmp174, vect_cst_.25\n    vpmuludq        ymm1, ymm4, ymm1        # tmp177, tmp185, MEM[base: vectp_Gj_vec.22_86, index: ivtmp.32_76, offset: 0B]\n    vpaddq  ymm0, ymm0, ymm1    # tmp176, tmp176, tmp177\n    vmovdqa ymm1, YMMWORD PTR [r8+rax]        # MEM[base: vectp_Gi_vec.19_81, index: ivtmp.32_76, offset: 0B], MEM[base: vectp_Gi_vec.19_81, index: ivtmp.32_76, offset: 0B]\n    vpsllq  ymm0, ymm0, 32      # tmp176, tmp176,\n    vpaddq  ymm0, ymm2, ymm0    # vect__13.24, tmp173, tmp176\n    vpsubq  ymm0, ymm1, ymm0    # vect__14.26, MEM[base: vectp_Gi_vec.19_81, index: ivtmp.32_76, offset: 0B], vect__13.24\n    vmovdqa YMMWORD PTR [r8+rax], ymm0        # MEM[base: vectp_Gi_vec.19_81, index: ivtmp.32_76, offset: 0B], vect__14.26\n    add     rax, 32   # ivtmp.32,\n    cmp     rcx, r10  # ivtmp.30, bnd.14\n    jb      .L4 #,\n</code></pre>\n\n<p>Translate that back to intrinsics if you want, but it's going to be a lot easier to just let the compiler autovectorize.  I didn't try to analyse it to see if it's optimal.</p>\n\n<p>If you don't usually compile with <code>-O3</code>, you could use <code>#pragma omp simd</code> before the loop (and <code>-fopenmp</code>).</p>\n\n<p>Of course, instead of a scalar epilogue, it would prob. be faster to do an unaligned load of the last 32B of Gj_vec, and store into the last 32B of Gi_vec, potentially overlapping with the last store from the loop.  (A scalar fallback is still needed if the arrays are smaller than 32B.)</p>\n\n<hr>\n\n<h3>Improved vector intrinsic version for Haswell</h3>\n\n<p>From my comments on Z Boson's answer.  Based on <a href=\"http://www.agner.org/optimize/#vectorclass\" rel=\"nofollow noreferrer\">Agner Fog's vector class library code</a>.</p>\n\n<p>Agner Fog's version saves an instruction but bottlenecks on the shuffle port by using phadd + pshufd where I use psrlq / paddq / pand.</p>\n\n<p>Since one of your operands is constant, make sure to pass <code>set1(q)</code> as <code>b</code>, not <code>a</code>, so the \"bswap\" shuffle can be hoisted.</p>\n\n<pre><code>// replace hadd -&gt; shuffle (4 uops) with shift/add/and (3 uops)\n// The constant takes 2 insns to generate outside a loop.\n__m256i mul64_haswell (__m256i a, __m256i b) {\n    // instruction does not exist. Split into 32-bit multiplies\n    __m256i bswap   = _mm256_shuffle_epi32(b,0xB1);           // swap H&lt;-&gt;L\n    __m256i prodlh  = _mm256_mullo_epi32(a,bswap);            // 32 bit L*H products\n\n    // or use pshufb instead of psrlq to reduce port0 pressure on Haswell\n    __m256i prodlh2 = _mm256_srli_epi64(prodlh, 32);          // 0  , a0Hb0L,          0, a1Hb1L\n    __m256i prodlh3 = _mm256_add_epi32(prodlh2, prodlh);      // xxx, a0Lb0H+a0Hb0L, xxx, a1Lb1H+a1Hb1L\n    __m256i prodlh4 = _mm256_and_si256(prodlh3, _mm256_set1_epi64x(0x00000000FFFFFFFF)); // zero high halves\n\n    __m256i prodll  = _mm256_mul_epu32(a,b);                  // a0Lb0L,a1Lb1L, 64 bit unsigned products\n    __m256i prod    = _mm256_add_epi64(prodll,prodlh4);       // a0Lb0L+(a0Lb0H+a0Hb0L)&lt;&lt;32, a1Lb1L+(a1Lb1H+a1Hb1L)&lt;&lt;32\n    return  prod;\n}\n</code></pre>\n\n<p><a href=\"http://gcc.godbolt.org/#compilers:!((compiler:g530,options:&#39;-O3+-Wall+-Wextra+-fverbose-asm+-march%3Dhaswell&#39;,sourcez:MQSwdgxgNgrgJgUwAQB4QFt3gC4CdwB0AFgHwBQZwiAZuMgGoIQAsAjkgPofoBMArADYQFAPQikANybYA9riQyADglwBDWfIBUSAFxJ0MKNhCKoATyQIoCdAjDYkAIwtWbd7GUYt2BqAOZIABRebEgQMmAAzg4AZEiqADRIIezhUbFOAJRIAN5kSAVIYkjg0bgwEMYRSHAyCJFIYDIOCAAeINEESADKpiAOODJIAMw8ALSO/fqGxn31%2BYVcvIIgTpEA7qqKhQC8nJj8AhyRRDDU1NYcCIogo4GOCQAMrQBCAIyZANyFPz/FG1skAAJFBjEgAGQWBSWh1WilwMjgUCIBT23GWR18UBkVxud0SjgBii%2Bv1JRXEoycU3BmiBSHhiIq2EiUM43FhSAAXiohrt9hjjghsNyEccQIdAiSydLyUhHqyYSt6QikUQeEg0QdBBwiKo4HBcbceIEGaqEiKZFKycVVI9wY5HkCANS2oEO8EJVRve1vZ1et3ep5PBXspWm5HDDX8w7HU7nS7XI0mlXInhPVoAdmGVoKxUeSVt9sdLsd7qS%2Bfi3scvpdvurkJ%2BiqEysRUCgqOj2t8uJg%2BISjhzMt%2BNrtZa9Po9SH8VIcMCiIAA5mAEHAW3AmSzG6Hm6afpqBXqDYn/MnW1AEuGiNnvqSR0XwU7AoWHX7S3bMigUKMC1XvY/x9Wfp1t6H5fjwrK4EKMC4GABSmp8ZAAL4UGQxSQaYqgQMgur6kgYJICcZwXMggQBDASiRNk6z9CiJwgNQ2AiIeTFgKugSRuRiiUah4gACpEMgaTRKo9hINgqgANb1Eg6qlFEYlDAudgqOoyAyDAzIgIg8RINiSgEJ4TChL4/g6qoGxWO2wRGakETREgcSJMkNlhHZGQDrkrLFKUeBMiA1S1NJTQtO0nQ9H0Az2EMowTFMvizFAIDzFuGKrISmzbB26IxoR8YIIadwPM87yDre4hEsCoIQiGqVrsiWVapihjYgVxoEkSpVlSM6qTA4NJ0qaG4LDVHKXuq%2B45bgiWGiel5JKMnWFHmBQFm%2Bk4yhW/r1iNYYpleUbZdqh6taeqppnVRClcUrQ3atRavm6dpJDdrQ/j6QEBg2izbnCe0BBNR2sWKEqXsMSSHUckRCm8M3MK0gTPI8SPI0jABi6MY%2BjmQksUFpIEQi4orqUBSCyO07im7YHY13CGD2fYDjeQ5dc%2BT0AYGU4BL1SBzpEi7Lqug2VJu321bufIQxwx3Hswp1thef2dXe7r/qOxauu6oHfpWE7/r%2BH31lr4E/JB2DQbBa4IchPGNM02EyOsYkCQRcbESUDREDIHTYCuZASF7q6%2BMaTarDEr1srVMRmAkIdIKw2R5AUrRRiZzBmRZbaBK98cIQUFh7Kn6frJZgTRznSFAA%3D)),filterAsm:(commentOnly:!t,directives:!t,intel:!t,labels:!t),version:3\" rel=\"nofollow noreferrer\">See it on Godbolt</a>.</p>\n\n<p>Note that this doesn't include the final subtract, only the multiply.</p>\n\n<p>This version should perform a bit better on Haswell than gcc's autovectorized version.  (like maybe one vector per 4 cycles instead of one vector per 5 cycles, bottlenecked on port0 throughput.  I didn't consider other bottlenecks for the full problem, since this was a late addition to the answer.)</p>\n\n<p>An AVX1 version (two elements per vector) would suck, and probably still be worse than 64bit scalar.  Don't do it unless you already have your data in vectors, and want the result in a vector (extracting to scalar and back might not be worth it).</p>\n\n<hr>\n\n<h3>Perf analysis of GCC's autovectorized code (not the intrinsic version)</h3>\n\n<p>Background: see <a href=\"http://www.agner.org/optimize/\" rel=\"nofollow noreferrer\">Agner Fog's insn tables and microarch guide</a>, and other links in the <a href=\"/questions/tagged/x86\" class=\"post-tag\" title=\"show questions tagged &#39;x86&#39;\" rel=\"tag\">x86</a> tag wiki.</p>\n\n<p>Until AVX512 (see below), this is probably only barely faster than scalar 64bit code:  <code>imul r64, m64</code> has a throughput of one per clock on Intel CPUs (but one per 4 clocks on AMD Bulldozer-family).  load/imul/sub-with-memory-dest is 4 fused-domain uops on Intel CPUs (with an addressing mode that can micro-fuse, which gcc fails to use).  The pipeline width is 4 fused-domain uops per clock, so even a large unroll can't get this to issue at one-per-clock.  With enough unrolling, we'll bottleneck on load/store throughput.  2 loads and one store per clock is possible on Haswell, but stores-address uops stealing load ports will <a href=\"https://stackoverflow.com/questions/36247281/why-the-speedup-is-lower-than-expected-by-using-avx2#comment60185682_36279080\">lower the throughput to about 81/96 = 84% of that, according to Intel's manual</a>.</p>\n\n<p>So perhaps the best way for Haswell would load and multiply with scalar, (2 uops), then <code>vmovq</code> / <code>pinsrq</code> / <code>vinserti128</code> so you can do the subtract with a <code>vpsubq</code>.  That's 8 uops to load&amp;multiply all 4 scalars, 7 shuffle uops to get the data into a __m256i (2 (movq) + 4 (pinsrq is 2 uops) + 1 vinserti128), and 3 more uops to do a vector load / vpsubq / vector store.  So that's 18 fused-domain uops per 4 multiplies (4.5 cycles to issue), but 7 shuffle uops (7 cycles to execute).  So nvm, this is no good compared to pure scalar.</p>\n\n<hr>\n\n<p>The autovectorized code is using 8 vector ALU instructions for each vector of four values.  On Haswell, 5 of those uops (multiplies and shifts) can only run on port 0, so no matter how you unroll this algorithm it will achieve at best one vector per 5 cycles (i.e. one multiply per 5/4 cycles.)</p>\n\n<p>The shifts could be replaced with <code>pshufb</code> (port 5) to move the data and shift in zeros.  (Other shuffles don't support zeroing instead of copying a byte from the input, and there aren't any known-zeros in the input that we could copy.)</p>\n\n<p><code>paddq</code> / <code>psubq</code> can run on ports 1/5 on Haswell, or p015 on Skylake.</p>\n\n<p>Skylake runs <code>pmuludq</code> and immediate-count vector shifts on on p01, so it could in theory manage a throughput of one vector per max(5/2, 8/3, 11/4) = 11/4 = 2.75 cycles.  So it bottlenecks on total fused-domain uop throughput (including the 2 vector loads and 1 vector store).  So a bit of loop unrolling will help.  Probably resource conflicts from imperfect scheduling will bottleneck it to slightly less than 4 fused-domain uops per clock.  The loop overhead can hopefully run on port 6, which can only handle some scalar ops, including <code>add</code> and compare-and-branch, leaving ports 0/1/5 for vector ALU ops, since they're close to saturating (8/3 = 2.666 clocks).  The load/store ports are nowhere near saturating, though.</p>\n\n<p>So, <strong>Skylake can theoretically manage one vector per 2.75 cycles (plus loop overhead), or one multiply per ~0.7 cycles</strong>, vs. Haswell's best option (one per ~1.2 cycles in theory with scalar, or one per 1.25 cycles in theory with vectors).  The scalar one per ~1.2 cycles would probably require a hand-tuned asm loop, though, because compilers don't know how to use a one-register addressing mode for stores, and a two-register addressing mode for loads (<code>dst + (src-dst)</code> and increment <code>dst</code>).</p>\n\n<p><strong>Also, if your data isn't hot in L1 cache, getting the job done with fewer instructions lets the frontend get ahead of the execution units, and get started on the loads before the data is needed.  Hardware prefetch doesn't cross page lines, so a vector loop will probably beat scalar in practice for large arrays, and maybe even for smaller arrays</strong>.</p>\n\n<hr>\n\n<h2>AVX-512DQ introduces a 64bx64b->64b vector multiply</h2>\n\n<p>gcc can auto-vectorize using it, if you add <code>-mavx512dq</code>.</p>\n\n<pre><code>.L4:\n    vmovdqu64       zmm0, ZMMWORD PTR [r8+rax]    # vect__11.23, MEM[base: vectp_Gj_vec.22_86, index: ivtmp.32_76, offset: 0B]\n    add     rcx, 1    # ivtmp.30,\n    vpmullq zmm1, zmm0, zmm2  # vect__13.24, vect__11.23, vect_cst_.25\n    vmovdqa64       zmm0, ZMMWORD PTR [r9+rax]    # MEM[base: vectp_Gi_vec.19_81, index: ivtmp.32_76, offset: 0B], MEM[base: vectp_Gi_vec.19_81, index: ivtmp.32_76, offset: 0B]\n    vpsubq  zmm0, zmm0, zmm1    # vect__14.26, MEM[base: vectp_Gi_vec.19_81, index: ivtmp.32_76, offset: 0B], vect__13.24\n    vmovdqa64       ZMMWORD PTR [r9+rax], zmm0    # MEM[base: vectp_Gi_vec.19_81, index: ivtmp.32_76, offset: 0B], vect__14.26\n    add     rax, 64   # ivtmp.32,\n    cmp     rcx, r10  # ivtmp.30, bnd.14\n    jb      .L4 #,\n</code></pre>\n\n<p>So AVX512DQ (<a href=\"https://en.wikipedia.org/wiki/AVX-512#CPUs_with_AVX-512\" rel=\"nofollow noreferrer\">expected to be part of Skylake multi-socket Xeon (Purley) in ~2017</a>) will give a much larger than 2x  speedup (from wider vectors) if these instructions are pipelined at one per clock.</p>\n\n<p>Update: Skylake-AVX512 (aka SKL-X or SKL-SP) runs VPMULLQ at one per 1.5 cycles for xmm, ymm, or zmm vectors.  It's 3 uops with 15c latency.  (With maybe an extra 1c of latency for the zmm version, if that's not a measurement glitch <a href=\"https://github.com/InstLatx64/InstLatx64/blob/master/GenuineIntel0050654_SkylakeX_InstLatX64.txt\" rel=\"nofollow noreferrer\">in the AIDA results</a>.)</p>\n\n<p><code>vpmullq</code> is much faster than anything you can build out of 32-bit chunks, so it's very much worth having an instruction for this even if current CPUs don't have 64-bit-element vector-multiply hardware.  (Presumably they use the mantissa multipliers in the FMA units.)</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1463662881, "post_id": 37322570, "comment_id": 62167284, "body": "Those are 9 fused-domain uops on Haswell/SKL (where <code>[v]pmulld</code> is 2 uops, vs. 1 on SnB).  In the unfused domain: 4 shuffle uops (p5), 3 mul uops (p0), and 2 add uops (one p1-only, one p15).  So with good scheduling, it runs at one per 4c on Haswell and Skylake.  (vs. one per 5c on Haswell or one per 2.5c on Skylake.)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1463664105, "post_id": 37322570, "comment_id": 62168212, "body": "Couldn&#39;t hadd/pshufd be replaced with something?  <a href=\"https://godbolt.org/g/3MoJmL\" rel=\"nofollow noreferrer\">Yeah, we can use shift/add/and</a>.  1 shuffle uop (p5), 3 mul+1 shift (p0), 2 ADD (p15), 1 AND (p015).  We could replace the shift with a <code>pshufb</code> to reduce p0 pressure.  Generating the constant now takes 2 insns (so compilers will choose to load it from memory), but I&#39;m not counting that or the xor, since it can be hoisted after inlining."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1463664818, "post_id": 37322570, "comment_id": 62168833, "body": "With <code>b</code> as the same-every-time operand, yeah it can hoist the <code>bswap</code> shuffle.  Interesting point.  Everything else depends on <code>a*b</code>, though, so that&#39;s all.  Make sure you use <code>b=q</code>, not <code>a=q</code>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1463665484, "post_id": 37322570, "comment_id": 62169451, "body": "edited this into my answer.  Thanks again for suggesting a different algorithm that can be optimized better.  I didn&#39;t take the time to consider anything but gcc&#39;s autovectorized output."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1463724319, "post_id": 37322570, "comment_id": 62195140, "body": "@PeterCordes, cool that you improved Agner&#39;s solution. I would send Agner an email with your suggestion. If he likes it he probably will put it into the next version of his vector class library."}, {"owner": {"reputation": 3558, "user_id": 862391, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/982465269bdfd8f6e1790677fa3aed41?s=128&d=identicon&r=PG", "display_name": "A Fog", "link": "https://stackoverflow.com/users/862391/a-fog"}, "edited": false, "score": 2, "creation_date": 1464108318, "post_id": 37322570, "comment_id": 62344467, "body": "Thank you. I will put this in the next update of my Vector class library"}], "tags": [], "owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "is_accepted": false, "score": 3, "last_activity_date": 1463659165, "last_edit_date": 1495542271, "creation_date": 1463659165, "answer_id": 37322570, "question_id": 37296289, "link": "https://stackoverflow.com/questions/37296289/fastest-way-to-multiply-an-array-of-int64-t/37322570#37322570", "title": "Fastest way to multiply an array of int64_t?", "body": "<p>If you're interested in SIMD 64bx64b to 64b (lower) operations here are the AVX and AVX2 solutions from Agner Fog's <a href=\"http://www.agner.org/optimize/#vectorclass\" rel=\"nofollow noreferrer\">Vector Class Library</a>.  I would test these with arrays and see how it compares to what GCC does with a generic loop such as the one in Peter Cordes' <a href=\"https://stackoverflow.com/a/37320416/2542702\">answer</a>.</p>\n\n<p>AVX (use SSE - you can still compile with <code>-mavx</code> to get vex encoding). </p>\n\n<pre><code>// vector operator * : multiply element by element\nstatic inline Vec2q operator * (Vec2q const &amp; a, Vec2q const &amp; b) {\n#if INSTRSET &gt;= 5   // SSE4.1 supported\n    // instruction does not exist. Split into 32-bit multiplies\n    __m128i bswap   = _mm_shuffle_epi32(b,0xB1);           // b0H,b0L,b1H,b1L (swap H&lt;-&gt;L)\n    __m128i prodlh  = _mm_mullo_epi32(a,bswap);            // a0Lb0H,a0Hb0L,a1Lb1H,a1Hb1L, 32 bit L*H products\n    __m128i zero    = _mm_setzero_si128();                 // 0\n    __m128i prodlh2 = _mm_hadd_epi32(prodlh,zero);         // a0Lb0H+a0Hb0L,a1Lb1H+a1Hb1L,0,0\n    __m128i prodlh3 = _mm_shuffle_epi32(prodlh2,0x73);     // 0, a0Lb0H+a0Hb0L, 0, a1Lb1H+a1Hb1L\n    __m128i prodll  = _mm_mul_epu32(a,b);                  // a0Lb0L,a1Lb1L, 64 bit unsigned products\n    __m128i prod    = _mm_add_epi64(prodll,prodlh3);       // a0Lb0L+(a0Lb0H+a0Hb0L)&lt;&lt;32, a1Lb1L+(a1Lb1H+a1Hb1L)&lt;&lt;32\n    return  prod;\n#else               // SSE2\n    int64_t aa[2], bb[2];\n    a.store(aa);                                           // split into elements\n    b.store(bb);\n    return Vec2q(aa[0]*bb[0], aa[1]*bb[1]);                // multiply elements separetely\n#endif\n}\n</code></pre>\n\n<p>AVX2</p>\n\n<pre><code>// vector operator * : multiply element by element\nstatic inline Vec4q operator * (Vec4q const &amp; a, Vec4q const &amp; b) {\n    // instruction does not exist. Split into 32-bit multiplies\n    __m256i bswap   = _mm256_shuffle_epi32(b,0xB1);           // swap H&lt;-&gt;L\n    __m256i prodlh  = _mm256_mullo_epi32(a,bswap);            // 32 bit L*H products\n    __m256i zero    = _mm256_setzero_si256();                 // 0\n    __m256i prodlh2 = _mm256_hadd_epi32(prodlh,zero);         // a0Lb0H+a0Hb0L,a1Lb1H+a1Hb1L,0,0\n    __m256i prodlh3 = _mm256_shuffle_epi32(prodlh2,0x73);     // 0, a0Lb0H+a0Hb0L, 0, a1Lb1H+a1Hb1L\n    __m256i prodll  = _mm256_mul_epu32(a,b);                  // a0Lb0L,a1Lb1L, 64 bit unsigned products\n    __m256i prod    = _mm256_add_epi64(prodll,prodlh3);       // a0Lb0L+(a0Lb0H+a0Hb0L)&lt;&lt;32, a1Lb1L+(a1Lb1H+a1Hb1L)&lt;&lt;32\n    return  prod;\n}\n</code></pre>\n\n<p>These functions work for signed and unsigned 64-bit integers. In your case since <code>q</code> is constant within the loop you don't need to recalculate some things every iteration but your compiler will probably figure that out anyway.</p>\n"}], "owner": {"reputation": 671, "user_id": 4544687, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-fRQn7I2YY9M/AAAAAAAAAAI/AAAAAAAAAdI/K8vhsr0XtPM/photo.jpg?sz=128", "display_name": "H&#233;lder Gon&#231;alves", "link": "https://stackoverflow.com/users/4544687/h%c3%a9lder-gon%c3%a7alves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2200, "favorite_count": 7, "accepted_answer_id": 37320416, "answer_count": 2, "score": 20, "last_activity_date": 1499166077, "creation_date": 1463565694, "last_edit_date": 1463668715, "question_id": 37296289, "link": "https://stackoverflow.com/questions/37296289/fastest-way-to-multiply-an-array-of-int64-t", "title": "Fastest way to multiply an array of int64_t?", "body": "<p>I want to vectorize the multiplication of two memory aligned arrays. \nI didn't find any way to multiply 64*64 bit in AVX/AVX2, so I just did loop-unroll and AVX2 loads/stores. Is there a faster way to do this?</p>\n\n<p><strong>Note:</strong> I don't want to save the high-half result of each multiplication.</p>\n\n<pre><code>void multiply_vex(long *Gi_vec, long q, long *Gj_vec){\n\n    int i;\n    __m256i data_j, data_i;\n    __uint64_t *ptr_J = (__uint64_t*)&amp;data_j;\n    __uint64_t *ptr_I = (__uint64_t*)&amp;data_i;\n\n\n    for (i=0; i&lt;BASE_VEX_STOP; i+=4) {\n        data_i = _mm256_load_si256((__m256i*)&amp;Gi_vec[i]);\n        data_j = _mm256_load_si256((__m256i*)&amp;Gj_vec[i]);\n\n        ptr_I[0] -= ptr_J[0] * q;\n        ptr_I[1] -= ptr_J[1] * q;\n        ptr_I[2] -= ptr_J[2] * q;\n        ptr_I[3] -= ptr_J[3] * q;\n\n        _mm256_store_si256((__m256i*)&amp;Gi_vec[i], data_i);\n    }\n\n\n    for (; i&lt;BASE_DIMENSION; i++)\n        Gi_vec[i] -= Gj_vec[i] * q;\n}\n</code></pre>\n\n<hr>\n\n<p><strong>UPDATE:</strong>\nI'm using the Haswell microarchitecture with both ICC/GCC compilers. So both AVX and AVX2 is fine. \nI substitute the <code>-=</code> by the C intrisic <code>_mm256_sub_epi64</code> after the multiplication loop-unroll, where it get some speedup. Currently, it is <code>ptr_J[0] *= q; ...</code></p>\n\n<p>I use <code>__uint64_t</code> but is a <strong>error</strong>. The right data type is <code>__int64_t</code>.</p>\n"}, {"tags": ["c", "linux", "debugging", "gdb"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1463606978, "post_id": 37296267, "comment_id": 62141840, "body": "Use <code>step</code> earlier.  The <code>printf(&quot;Loading catalogue...&quot;)</code> is almost certainly coming from the function you are trying to step into.  The first &#39;next&#39; in your sample session should probably be &#39;step&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4721173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e186dd8f2d1d689fd97d8c9599c1cd3?s=128&d=identicon&r=PG&f=1", "display_name": "lyke", "link": "https://stackoverflow.com/users/4721173/lyke"}, "edited": false, "score": 0, "creation_date": 1463569875, "post_id": 37296318, "comment_id": 62118390, "body": "i used step but.... it just goes next line. want to get into line260 function loadCatalogue, but couldnt get into function thats why im asking any way to handle this...."}, {"owner": {"reputation": 2039, "user_id": 6099429, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5ExNb.png?s=128&g=1", "display_name": "zhenguoli", "link": "https://stackoverflow.com/users/6099429/zhenguoli"}, "edited": false, "score": 0, "creation_date": 1463572706, "post_id": 37296318, "comment_id": 62120320, "body": "can <code>stepi</code> works? I haven&#39;t test for it, but I have found the <code>gdb</code> have the command, it means <code>Step one instruction exactly</code>, not <code>Step program until it reaches a different source line</code> which is the description of <code>s</code> command."}, {"owner": {"reputation": 2039, "user_id": 6099429, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5ExNb.png?s=128&g=1", "display_name": "zhenguoli", "link": "https://stackoverflow.com/users/6099429/zhenguoli"}, "edited": false, "score": 0, "creation_date": 1463573921, "post_id": 37296318, "comment_id": 62121265, "body": "I have test for the <code>s</code> command, and I found it can step into the function in the if condition, why yours can&#39;t?"}], "tags": [], "owner": {"reputation": 11342, "user_id": 1144157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d05077a347e63679d43bfbdaf5e7b9ab?s=128&d=identicon&r=PG", "display_name": "Steephen", "link": "https://stackoverflow.com/users/1144157/steephen"}, "is_accepted": false, "score": 0, "last_activity_date": 1463565771, "creation_date": 1463565771, "answer_id": 37296318, "question_id": 37296267, "link": "https://stackoverflow.com/questions/37296267/can-gdb-step-into-if-s-condition-function/37296318#37296318", "title": "Can gdb step into if &#39;s condition function?", "body": "<p>You have to use 'step' or 's' command in gdb  to get into the function definition.</p>\n"}, {"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 3, "last_activity_date": 1463606000, "creation_date": 1463606000, "answer_id": 37310194, "question_id": 37296267, "link": "https://stackoverflow.com/questions/37296267/can-gdb-step-into-if-s-condition-function/37310194#37310194", "title": "Can gdb step into if &#39;s condition function?", "body": "<p>The <code>step</code> or <code>s</code> instruction will step a single line into the function as you desire.  If it appears to skip over the line (as you describe), that means that there are no \"lines\" in the function to step to -- either because the function is inlined, or because it is in another compilation unit with no debugging information.</p>\n\n<p>In this latter case, you may find the <code>stepi</code> (<code>si</code>) command useful -- this steps by a single machine instruction.  When you do this, the source line will remain the same, but you are actually part-way into that line.</p>\n\n<p>I find it useful to define an alias in my <code>.gdbinit</code> file:</p>\n\n<pre><code>define sx\n  si\n  x /1i $pc\nend\ndocument sx\n    Step one instruction and print next instruction\nend\n</code></pre>\n\n<p>which defines an <code>sx</code> command which works just like <code>si</code>, but also disassembles the next machine instruction to run afterwards.  So its more like <code>step</code> at the machine code level.  Having <code>nx</code> which uses <code>nexti</code> is also useful.</p>\n"}], "owner": {"reputation": 31, "user_id": 4721173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e186dd8f2d1d689fd97d8c9599c1cd3?s=128&d=identicon&r=PG&f=1", "display_name": "lyke", "link": "https://stackoverflow.com/users/4721173/lyke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 700, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1463606000, "creation_date": 1463565649, "last_edit_date": 1463593216, "question_id": 37296267, "link": "https://stackoverflow.com/questions/37296267/can-gdb-step-into-if-s-condition-function", "title": "Can gdb step into if &#39;s condition function?", "body": "<p>I just wonder how to access if condition function with gdb</p>\n\n<h2>The code is like that:</h2>\n\n<pre><code>if(loadCatalogue(cat, filename)) {\n    printf(\"Success.\\n\");\n}\nelse {\n    perror(\"Unable to load catalogue\");\n}\n</code></pre>\n\n<h2>And gdb shows like that:</h2>\n\n<pre><code>256     readLine(\"Enter name of catalogue file to load: \",\n\n(gdb) next\n\nEnter name of catalogue file to load: cat.txt\n\n259     printf(\"Loading catalogue '%s'...\\n\", filename);\n\n(gdb) next\n\nLoading catalogue 'cat.txt'...\n\n260     if(loadCatalogue(cat, filename)) {\n\n(gdb) step\n\n261         printf(\"Success.\\n\");\n\n(gdb) \n</code></pre>\n\n<p>I want to access that if's condition <code>loadCatalogue()</code> but I couldnt do that\nis there any way to access that function?</p>\n\n<p>Please let me know how do I handle this.</p>\n"}, {"tags": ["java", "c++", "c", "java-native-interface", "native"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1463567605, "post_id": 37295925, "comment_id": 62116855, "body": "It&#39;d be a lot easier to create a Java <code>CheqDtl</code> class with fields like <code>long irno</code> and <code>String bank_accno1</code>, pass that object to your JNI call, and just fill in the fields in that one object:  <code>protected static native void FillCheqDtl( CheqDtl dtl);... CheqDtl dtl = new CheqDtl(); FillCheqDtl( dtl );...</code>  See <a href=\"http://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/functions.html#wp16536\" rel=\"nofollow noreferrer\">docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/&hellip;</a>"}, {"owner": {"reputation": 1498, "user_id": 3425489, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/pvkCq.jpg?s=128&g=1", "display_name": "Shantaram Tupe", "link": "https://stackoverflow.com/users/3425489/shantaram-tupe"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1463568213, "post_id": 37295925, "comment_id": 62117260, "body": "I have done with creating class, then fill its value , I just want to give try like this without class...ty"}], "answers": [{"comments": [{"owner": {"reputation": 1498, "user_id": 3425489, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/pvkCq.jpg?s=128&g=1", "display_name": "Shantaram Tupe", "link": "https://stackoverflow.com/users/3425489/shantaram-tupe"}, "edited": false, "score": 0, "creation_date": 1463568396, "post_id": 37296627, "comment_id": 62117393, "body": "@ gudok I&#39;ll try  and let u know ...ty"}, {"owner": {"reputation": 1498, "user_id": 3425489, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/pvkCq.jpg?s=128&g=1", "display_name": "Shantaram Tupe", "link": "https://stackoverflow.com/users/3425489/shantaram-tupe"}, "edited": false, "score": 0, "creation_date": 1463579819, "post_id": 37296627, "comment_id": 62125643, "body": "I&#39;m not able to convert unsigned long to (jvalue *) , in NewObjectA method any idea ...? getting wrong value at Java side..."}, {"owner": {"reputation": 3574, "user_id": 5793987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a057299226b268d59f2faa0b3f1d1112?s=128&d=identicon&r=PG", "display_name": "gudok", "link": "https://stackoverflow.com/users/5793987/gudok"}, "reply_to_user": {"reputation": 1498, "user_id": 3425489, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/pvkCq.jpg?s=128&g=1", "display_name": "Shantaram Tupe", "link": "https://stackoverflow.com/users/3425489/shantaram-tupe"}, "edited": false, "score": 0, "creation_date": 1463580897, "post_id": 37296627, "comment_id": 62126424, "body": "Use NewObject: <code>NewObject(env, class_id, constructor_id, cheqdtl-&gt;irno)</code>"}, {"owner": {"reputation": 1498, "user_id": 3425489, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/pvkCq.jpg?s=128&g=1", "display_name": "Shantaram Tupe", "link": "https://stackoverflow.com/users/3425489/shantaram-tupe"}, "edited": false, "score": 0, "creation_date": 1463640968, "post_id": 37296627, "comment_id": 62151773, "body": "I am still getting memory address of long variable, While accessing IRNO from structure. NewObject(env, class_id, constructor_id, cheqdtl-&gt;irno) This is not working, not able to access IRNO like this."}, {"owner": {"reputation": 1498, "user_id": 3425489, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/pvkCq.jpg?s=128&g=1", "display_name": "Shantaram Tupe", "link": "https://stackoverflow.com/users/3425489/shantaram-tupe"}, "edited": false, "score": 0, "creation_date": 1463650377, "post_id": 37296627, "comment_id": 62158103, "body": "I have solved problem by type casting &quot;cq_dtl[i].irno&quot; to (jlong) in last parameter of NewObject(); thank u for guidance..."}], "tags": [], "owner": {"reputation": 3574, "user_id": 5793987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a057299226b268d59f2faa0b3f1d1112?s=128&d=identicon&r=PG", "display_name": "gudok", "link": "https://stackoverflow.com/users/5793987/gudok"}, "is_accepted": true, "score": 1, "last_activity_date": 1463566596, "creation_date": 1463566596, "answer_id": 37296627, "question_id": 37295925, "link": "https://stackoverflow.com/questions/37295925/jni-convert-primitive-type-to-jobject-or-setobjectarrayelement-of-object-type/37296627#37296627", "title": "JNI : convert Primitive type to jobject Or SetObjectArrayElement of Object type after casting", "body": "<p>You can't achieve this by simply converting to <code>jobject</code>. C++ has absolutely no knowledge of java autoboxing. You will need to instantiate appropriate java objects manually.</p>\n\n<p>For example, <code>irno</code> needs to be converted to instance of java Long class (assuming 64-bit OS). In order to do so, you need:</p>\n\n<ol>\n<li>Locate identifier of Long class with <a href=\"https://docs.oracle.com/javase/8/docs/technotes/guides/jni/spec/functions.html#FindClass\" rel=\"nofollow\">FindClass</a></li>\n<li>Locate identifier of its constructor which accepts primitive type long with <a href=\"https://docs.oracle.com/javase/8/docs/technotes/guides/jni/spec/functions.html#GetMethodID\" rel=\"nofollow\">GetMethodID</a></li>\n<li>Create new java Long object by passing <code>irno</code> as argument to its constructor with <a href=\"https://docs.oracle.com/javase/8/docs/technotes/guides/jni/spec/functions.html#NewObject\" rel=\"nofollow\">NewObjectA</a></li>\n</ol>\n\n<p>Other variables must be converted to their corresponding java types: c++ double to java Double, c++ char[] to java String or to java char[] and so on.</p>\n\n<p>If you are going to pass a lot of such primitive objects to and from java, then I suggest that you use some serialization library, such as google protobuf. You fill in protobuf message in java, serialize it into byte array and pass this byte array into java. In java, you deserialize it and get nice java object. When you need to add more fields, then you won't need to write any more error-prone JNI code.</p>\n"}], "owner": {"reputation": 1498, "user_id": 3425489, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/pvkCq.jpg?s=128&g=1", "display_name": "Shantaram Tupe", "link": "https://stackoverflow.com/users/3425489/shantaram-tupe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1574, "favorite_count": 0, "accepted_answer_id": 37296627, "answer_count": 1, "score": 0, "last_activity_date": 1463566596, "creation_date": 1463564790, "question_id": 37295925, "link": "https://stackoverflow.com/questions/37295925/jni-convert-primitive-type-to-jobject-or-setobjectarrayelement-of-object-type", "title": "JNI : convert Primitive type to jobject Or SetObjectArrayElement of Object type after casting", "body": "<p>I'm have following code to return Array of Object Array filled with struct elements of primitive types , I don't know how to convert primitive types to jobject, and then set to ObjectArray using SetObjectArrayElement method,</p>\n\n<p>Here is my C struct info </p>\n\n<pre><code>struct cheqdtl {\nunsigned long irno;\nchar bank_accno1 [16];\nunsigned long bank_id;\nunsigned long outlet_id;\nchar bank_accno [16];\nchar cheque_num [41];\ndouble deposit_amt;\nchar chq_date [4]; };\n</code></pre>\n\n<p>My JNI code </p>\n\n<pre><code>JNIEXPORT jobjectArray JNICALL Java_nativeclass_Jmain_getChequeList (JNIEnv *env,jobject jobj,jint ch,jstring benAccNo,jstring fromDate,jstring toDate){\nclientlist *cl = new clientlist();\nShortInt lcount = 0;\nint i;\njmp_buf jmpb;\nconst char *ben_acc_no = env-&gt;GetStringUTFChars(benAccNo, NULL);\nconst char *from_date = env-&gt;GetStringUTFChars(fromDate, NULL);\nconst char *to_date = env-&gt;GetStringUTFChars(toDate, NULL);\n\nstruct b_date f_date, t_date;\nchar temp_date[10];\n\nmov_mem((char *)from_date, temp_date, 2);\ntemp_date[2] = '\\0';\nf_date.day = atoi(temp_date);\nmov_mem((char *)from_date + 3, temp_date, 2);\ntemp_date[2] = '\\0';\nf_date.month = atoi(temp_date);\nmov_mem((char *)from_date+6, temp_date, 4);\ntemp_date[4] = '\\0';    \nf_date.year = atoi(temp_date);\n\nmov_mem((char *)to_date, temp_date, 2);\ntemp_date[2] = '\\0';\nt_date.year = atoi(temp_date);\nmov_mem((char *)to_date + 3, temp_date, 2);\ntemp_date[2] = '\\0';\nt_date.month = atoi(temp_date);\nmov_mem((char *)to_date + 6, temp_date, 4);\ntemp_date[4] = '\\0';\nt_date.year = atoi(temp_date);\n\nstruct cheqdtl *cq_dtl = NULL;\ncq_dtl = (struct cheqdtl *)malloc( sizeof( struct cheqdtl) );\n\ncl-&gt;get_cheque_list((int)ch,(char *)ben_acc_no, &amp;f_date, &amp;t_date, &amp;cq_dtl, &amp;lcount);\n\njclass objCls= env-&gt;FindClass(\"java/lang/Object\");\nif( objCls == NULL )\n    return NULL;\n\njobjectArray outObjArr = env-&gt;NewObjectArray( lcount, objCls, NULL );\njmethodID jobjConstrId = env-&gt;GetMethodID( objCls, \"&lt;init&gt;\", \"()V\" );\nif( jobjConstrId == 0)\n    return NULL;\njobjectArray rowObjArr ;\n\nif( !lcount )\n    return NULL;\nfor( i = 0; i &lt; lcount; ++i ) {\n    rowObjArr = env-&gt;NewObjectArray(8, objCls, NULL);\n    cout&lt;&lt;\"\\n Get Array Length:- \"&lt;&lt;env-&gt;GetArrayLength(rowObjArr)&lt;&lt;endl;   \n\n    std::cout&lt;&lt;cq_dtl[i].irno&lt;&lt;\"\\n\";\n    std::cout&lt;&lt;cq_dtl[i].bank_accno1&lt;&lt;\"\\n\";\n    std::cout&lt;&lt;cq_dtl[i].bank_id&lt;&lt;\"\\n\";\n    std::cout&lt;&lt;cq_dtl[i].outlet_id&lt;&lt;\"\\n\";\n    std::cout&lt;&lt;cq_dtl[i].bank_accno&lt;&lt;\"\\n\";\n    std::cout&lt;&lt;cq_dtl[i].cheque_num&lt;&lt;\"\\n\";\n    std::cout&lt;&lt;cq_dtl[i].deposit_amt&lt;&lt;\"\\n\";\n    std::cout&lt;&lt;cq_dtl[i].chq_date&lt;&lt;\"\\n\";\n\n    env-&gt;SetObjectArrayElement(rowObjArr, 0, (jobject) cq_dtl[i].irno);\n    env-&gt;SetObjectArrayElement(rowObjArr, 1, (jobject) cq_dtl[i].bank_accno1);\n    env-&gt;SetObjectArrayElement(rowObjArr, 2, (jobject) cq_dtl[i].bank_id);\n    env-&gt;SetObjectArrayElement(rowObjArr, 3, (jobject) cq_dtl[i].outlet_id);\n    env-&gt;SetObjectArrayElement(rowObjArr, 4, (jobject) cq_dtl[i].bank_accno);\n    env-&gt;SetObjectArrayElement(rowObjArr, 5, (jobject) cq_dtl[i].cheque_num);\n    env-&gt;SetObjectArrayElement(rowObjArr, 6, (jobject) cq_dtl[i].deposit_amt);\n    env-&gt;SetObjectArrayElement(rowObjArr, 7, (jobject) cq_dtl[i].chq_date);\n\n    if( rowObjArr )\n        env-&gt;SetObjectArrayElement( outObjArr, i, rowObjArr );\n    env-&gt;DeleteLocalRef( rowObjArr );\n}\nenv-&gt;DeleteLocalRef( objCls );\nfree( cq_dtl );\ndelete cl;\nreturn outObjArr;      }\n</code></pre>\n\n<p>The Error I got is </p>\n\n<pre><code> A fatal error has been detected by the Java Runtime Environment:\n</code></pre>\n\n<p>SIGSEGV (0xb) at pc=0x010290e5, pid=4754, tid=4152195952</p>\n\n<p>JRE version: 7.0_09-b05\n Java VM: Java HotSpot(TM) Client VM (23.5-b02 mixed mode linux-x86 )\n Problematic frame:\n V  [libjvm.so+0x2a80e5]  jni_SetObjectArrayElement+0x1c5</p>\n\n<p>Failed to write core dump. Core dumps have been disabled. To enable core dumping, try \"ulimit -c unlimited\" before starting Java again</p>\n\n<p>An error report file with more information is saved as:\n /DATA1/home/user1/Myname/myproject/hs_err_pid4754.log</p>\n\n<p>If you would like to submit a bug report, please visit:\n   <a href=\"http://bugreport.sun.com/bugreport/crash.jsp\" rel=\"nofollow\">http://bugreport.sun.com/bugreport/crash.jsp</a></p>\n\n<p>My questions are </p>\n\n<ol>\n<li>Can I return Array Of Object array like above</li>\n<li>If yes how to convert primitive type to jobject</li>\n</ol>\n\n<p>What is wrong with above JNI code ....???\nThank you...</p>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1463563985, "post_id": 37295398, "comment_id": 62114327, "body": "Can you change the format of the file to start with two values (width and height) for the size of the maze, followed by the maze data ? That way, you only need one pass on the file."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 6344678, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6475c8d60e3dc4112630e745921ffe13?s=128&d=identicon&r=PG&f=1", "display_name": "user6344678", "link": "https://stackoverflow.com/users/6344678/user6344678"}, "edited": false, "score": 0, "creation_date": 1463564739, "post_id": 37295535, "comment_id": 62114838, "body": "Angew can you please help me to understand how to store the data into buffer."}, {"owner": {"reputation": 63, "user_id": 6344678, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6475c8d60e3dc4112630e745921ffe13?s=128&d=identicon&r=PG&f=1", "display_name": "user6344678", "link": "https://stackoverflow.com/users/6344678/user6344678"}, "edited": false, "score": 0, "creation_date": 1463564855, "post_id": 37295535, "comment_id": 62114926, "body": "my maze file is like &lt;br/&gt;#.#######&lt;br/&gt; #.......#&lt;br/&gt; ####.####&lt;br/&gt; #....#..#&lt;br/&gt; #.####.## &lt;br/&gt; No space in between"}, {"owner": {"reputation": 253206, "user_id": 12960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53d539b59c19087182f0b1c53bb52de?s=128&d=identicon&r=PG", "display_name": "Brian Agnew", "link": "https://stackoverflow.com/users/12960/brian-agnew"}, "reply_to_user": {"reputation": 63, "user_id": 6344678, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6475c8d60e3dc4112630e745921ffe13?s=128&d=identicon&r=PG&f=1", "display_name": "user6344678", "link": "https://stackoverflow.com/users/6344678/user6344678"}, "edited": false, "score": 0, "creation_date": 1463565830, "post_id": 37295535, "comment_id": 62115599, "body": "I would just dump it directly in a char * buffer. Sorry, my C is a little rusty"}], "tags": [], "owner": {"reputation": 253206, "user_id": 12960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53d539b59c19087182f0b1c53bb52de?s=128&d=identicon&r=PG", "display_name": "Brian Agnew", "link": "https://stackoverflow.com/users/12960/brian-agnew"}, "is_accepted": false, "score": 5, "last_activity_date": 1463563865, "creation_date": 1463563865, "answer_id": 37295535, "question_id": 37295398, "link": "https://stackoverflow.com/questions/37295398/how-to-read-data-from-stdin-mutiple-times-in-c-program/37295535#37295535", "title": "How to read data from stdin mutiple times in C program", "body": "<p>You're going to have to store that in a buffer as you read it. Once you've read <code>stdin</code>, you can't rewind it and/or read it again.</p>\n"}, {"tags": [], "owner": {"reputation": 10297, "user_id": 2425366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5z1Nm.jpg?s=128&g=1", "display_name": "Shreevardhan", "link": "https://stackoverflow.com/users/2425366/shreevardhan"}, "is_accepted": false, "score": 0, "last_activity_date": 1463564089, "creation_date": 1463564089, "answer_id": 37295642, "question_id": 37295398, "link": "https://stackoverflow.com/questions/37295398/how-to-read-data-from-stdin-mutiple-times-in-c-program/37295642#37295642", "title": "How to read data from stdin mutiple times in C program", "body": "<p>If you want to read a file again, <a href=\"http://linux.die.net/man/3/rewind\" rel=\"nofollow\"><code>rewind</code></a> can be used.</p>\n\n<pre><code>FILE * fp;\n\n// Open and read the file\n\nrewind(fp);\n\n// Read it again\n\nfclose(fp);\n</code></pre>\n\n<p>But, with <code>stdin</code>, this doesn't work. You must store the contents read from <code>stdin</code>.</p>\n"}], "owner": {"reputation": 63, "user_id": 6344678, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6475c8d60e3dc4112630e745921ffe13?s=128&d=identicon&r=PG&f=1", "display_name": "user6344678", "link": "https://stackoverflow.com/users/6344678/user6344678"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1463564357, "creation_date": 1463563526, "question_id": 37295398, "link": "https://stackoverflow.com/questions/37295398/how-to-read-data-from-stdin-mutiple-times-in-c-program", "title": "How to read data from stdin mutiple times in C program", "body": "<p>I am writing a program in C to solve a maze game. The input maze file will be read from stdin. I have written below program which read the maze from stdin and prints no. of rows and columns. But once I read my input file completely how can I access it again so that I can perform the next steps?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\n#define BUFFERSIZE (1000)\n\n\nstruct maze {\n    char ** map;\n    int startx, starty;\n    int numrows;\n    int initdir;\n};\n\nvoid ReadMaze(char * filename, struct maze * maze);\n\nint main(int argc, char *argv[]) {\n    struct maze maze;\n\n\n    ReadMaze(argv[1], &amp;maze);\n\n    return EXIT_SUCCESS;\n}\n\n\n/*  Creates a maze from a file  */\n\nvoid ReadMaze(char * filename, struct maze * maze) {\n    char buffer[BUFFERSIZE];\n    char mazeValue [BUFFERSIZE][BUFFERSIZE];\n    char ** map;\n    int rows = 0, foundentrance = 0, foundexit = 0;\n    int columns = 0;\n\n    /*  Determine number of rows in maze  */\n\n\n    while ( fgets(buffer, BUFFERSIZE, stdin) ){\n       ++rows;\n       puts(buffer);\n       columns = strlen(buffer);\n\n    }\n\n    printf(\"No of rows:  %d\\n\", rows);\n    printf(\"No of columns: %d\\n\", columns);\n\n    if ( !(map = malloc(rows * sizeof *map)) ) {\n        fputs(\"Couldn't allocate memory for map\\n\", stderr);\n        exit(EXIT_FAILURE);\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "struct", "structure"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1463582698, "post_id": 37295298, "comment_id": 62127809, "body": "<code>(void*)data+i</code> This cast is fishy. First of all, arithmetic on void pointers is not allowed in standard C, so your compiler is (mis)configured to use non-standard extensions. And there is no need for the cast in the first place! If you added this cast to sate the compiler, you might be using a C++ compiler to compile C code, which is a very bad idea. Overall you need to look over your tool chain, seems you have some problems there."}, {"owner": {"reputation": 79, "user_id": 6108576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05181c0a2a13c62d5df1263f016a2efb?s=128&d=identicon&r=PG&f=1", "display_name": "AimForNuts", "link": "https://stackoverflow.com/users/6108576/aimfornuts"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1463664618, "post_id": 37295298, "comment_id": 62168668, "body": "I changed to this (void*)&amp;data[i]  Is this in some way better?  As I stated under I&#39;m using Oracle VM VirtuaBox with Porteus. I use Geany to edit"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1463666993, "post_id": 37295298, "comment_id": 62170693, "body": "Well, it is not a bug any longer, but it still doesn&#39;t make any sense. You don&#39;t need the cast at all. Your compiler is apparently GCC, compile the code as shown in the answer by Kerrek."}, {"owner": {"reputation": 79, "user_id": 6108576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05181c0a2a13c62d5df1263f016a2efb?s=128&d=identicon&r=PG&f=1", "display_name": "AimForNuts", "link": "https://stackoverflow.com/users/6108576/aimfornuts"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1463734531, "post_id": 37295298, "comment_id": 62201163, "body": "From what my teacher explained us the cast is so the compiler gives no warnings.  I already changed my Makefile to what Kerrek told! And as you can see it gives me no warnings whatsoever: <a href=\"http://img.prntscr.com/img?url=http://i.imgur.com/jUz0yTK.png\" rel=\"nofollow noreferrer\">img.prntscr.com/img?url=http://i.imgur.com/jUz0yTK.png</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1463741967, "post_id": 37295298, "comment_id": 62206184, "body": "Your teacher is confused, the cast is superfluous. In would have been needed in C++ but not in C."}, {"owner": {"reputation": 79, "user_id": 6108576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05181c0a2a13c62d5df1263f016a2efb?s=128&d=identicon&r=PG&f=1", "display_name": "AimForNuts", "link": "https://stackoverflow.com/users/6108576/aimfornuts"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1464013395, "post_id": 37295298, "comment_id": 62296023, "body": "Ok thanks for the info :)"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 6108576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05181c0a2a13c62d5df1263f016a2efb?s=128&d=identicon&r=PG&f=1", "display_name": "AimForNuts", "link": "https://stackoverflow.com/users/6108576/aimfornuts"}, "edited": false, "score": 0, "creation_date": 1463563871, "post_id": 37295384, "comment_id": 62114252, "body": "I understand why the change on (data+i). It keeps behaving like no thread is created.  I was only using the -Wall, but even with all those flags it gives me no errors!  I can get it to work if I send the structure from the main, but not from the fill_vector fuction. I&#39;ve been searching through the answers and I can&#39;t seem to find an answer to why it&#39;s not at least showing the first print from the thread..."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 79, "user_id": 6108576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05181c0a2a13c62d5df1263f016a2efb?s=128&d=identicon&r=PG&f=1", "display_name": "AimForNuts", "link": "https://stackoverflow.com/users/6108576/aimfornuts"}, "edited": false, "score": 0, "creation_date": 1463564331, "post_id": 37295384, "comment_id": 62114575, "body": "@AimForNuts: That can&#39;t be true. There is no void pointer arithmetic in C, and if your compiler doesn&#39;t catch that, then it&#39;s not set up correctly. <a href=\"https://ideone.com/FUupzn\" rel=\"nofollow noreferrer\">Demo</a>"}, {"owner": {"reputation": 79, "user_id": 6108576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05181c0a2a13c62d5df1263f016a2efb?s=128&d=identicon&r=PG&f=1", "display_name": "AimForNuts", "link": "https://stackoverflow.com/users/6108576/aimfornuts"}, "edited": false, "score": 0, "creation_date": 1463565325, "post_id": 37295384, "comment_id": 62115262, "body": "I&#39;m using Oracle VM VirtualBox with Porteus and it gives me no errors... And with @Santiago Regojo fix everything works just fine.  But how would you do it? Because I&#39;m learning this now and that&#39;s how I&#39;m learning :S"}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": false, "score": 2, "last_activity_date": 1463563471, "creation_date": 1463563471, "answer_id": 37295384, "question_id": 37295298, "link": "https://stackoverflow.com/questions/37295298/sending-structure-to-a-thread-in-c/37295384#37295384", "title": "Sending structure to a thread in C", "body": "<p>Change <code>(void*)data+i</code> to <code>(void*)(data+i)</code>.</p>\n\n<p>The former is ill-formed (there's no pointer arithmetic on void pointers), and if your compiler lets you get away with it, then a) you've not taught your compiler to behave well and it's wasting your time, and b) you'll probably end up with something you didn't mean.</p>\n\n<p>Upshot: It pays to use a high-quality compiler that helps <em>you</em> understand C better. Examples of good compilers:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>gcc -W -Wall -Wextra -pedantic -std=c11\nclang -W -Wall -Wextra -pedantic -std=c11\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 6108576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05181c0a2a13c62d5df1263f016a2efb?s=128&d=identicon&r=PG&f=1", "display_name": "AimForNuts", "link": "https://stackoverflow.com/users/6108576/aimfornuts"}, "edited": false, "score": 0, "creation_date": 1463565002, "post_id": 37295596, "comment_id": 62115035, "body": "Ok that worked!! Just one more question related to this, if I do the pthread_join right after the thread creation(not waiting for all threads creation) I would be stopping the program on that point right?  Thanks for the help mate!!"}], "tags": [], "owner": {"reputation": 380, "user_id": 2383403, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YUB0T.png?s=128&g=1", "display_name": "Santiago Regojo", "link": "https://stackoverflow.com/users/2383403/santiago-regojo"}, "is_accepted": true, "score": 1, "last_activity_date": 1463563994, "creation_date": 1463563994, "answer_id": 37295596, "question_id": 37295298, "link": "https://stackoverflow.com/questions/37295298/sending-structure-to-a-thread-in-c/37295596#37295596", "title": "Sending structure to a thread in C", "body": "<p>Basically the main() function is not waiting for the threads to finish.\nYou need some syncronization mechanism.\nYou could fix it by calling pthread_join in fills_vector after creating all the threads.</p>\n"}], "owner": {"reputation": 79, "user_id": 6108576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05181c0a2a13c62d5df1263f016a2efb?s=128&d=identicon&r=PG&f=1", "display_name": "AimForNuts", "link": "https://stackoverflow.com/users/6108576/aimfornuts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 37295596, "answer_count": 2, "score": -2, "last_activity_date": 1463563994, "creation_date": 1463563248, "question_id": 37295298, "link": "https://stackoverflow.com/questions/37295298/sending-structure-to-a-thread-in-c", "title": "Sending structure to a thread in C", "body": "<p>I'm learning how to use threads and from what I understand and from what I've read I'm doing everything right(obviously I'm not). The program compiles and gives no errors, although it seems like the threads are not being created.</p>\n\n<p>I have a header file with all the includes and the structure. I want to keep the program as it is(main sending to another function the structure and creating the threads on that function)</p>\n\n<p>Here is the code I've come so far:</p>\n\n<p>Thread</p>\n\n<pre><code>void * print_data(void *arg){\n    Vector *data= (Vector*)arg;\n\n    printf(\"THREAD\\n\");\n    printf(\"Number: %d\\n\",data-&gt;number);\n    printf(\"Name: %s\\n\",data-&gt;name);\n    printf(\"Address: %s\\n\", data-&gt;address);\n    printf(\"\\n\");\n\n    pthread_exit(NULL); \n}\n</code></pre>\n\n<p>Function that creates/calls the threads</p>\n\n<pre><code>void fills_vector(Vector *dados){\n    pthread_t threads[VECSIZE];\n    int i, s;\n\n    for(i = 0; i &lt; VECSIZE; i++){\n\n        printf(\"Creating thread %d...\\n\", i);\n\n        s = pthread_create(&amp;threads[i], NULL, print_data, (void*)data+i);\n\n        if(s &lt; 0){\n            perror(\"Error creating the thread\");\n            exit(-1);\n        }\n    }\n\n}\n</code></pre>\n\n<p>Main</p>\n\n<pre><code>int main(void){\n    Vector data[VECSIZE];\n\n        data[0].number=1; data[0].name=\"Jo\u00e3o\" ; data[0].address=\"Rua A\";\n        data[1].number=2; data[1].name=\"Ana\" ; data[1].address=\"Rua B\";\n        data[2].number=3; data[2].name=\"Pedro\" ; data[2].address=\"Rua C\";\n        data[3].number=4; data[3].name=\"Clara\" ; data[3].address=\"Rua D\";\n        data[4].number=5; data[4].name=\"Manuel\" ; data[4].address=\"Rua E\";\n\n    fills_vector(data);\n\n    return 0;\n}\n</code></pre>\n\n<p>With the structure being</p>\n\n<pre><code>typedef struct Vector{\n\n    int number;\n    char *name;\n    char *address;\n\n} Vector;\n</code></pre>\n\n<p>and VECSIZE = 5</p>\n\n<p>What am I doing wrong?? The threads don't even print the first line but it gives no error creating them.</p>\n\n<p>If you need any more info feel free to ask and thanks in advance</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1220, "user_id": 2172854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hm0Q1.png?s=128&g=1", "display_name": "abhishek_naik", "link": "https://stackoverflow.com/users/2172854/abhishek-naik"}, "edited": false, "score": 0, "creation_date": 1463562833, "post_id": 37295107, "comment_id": 62113520, "body": "Because variables are variables - they can change anytime in the program."}, {"owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "reply_to_user": {"reputation": 8251, "user_id": 2912665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XrRhd.jpg?s=128&g=1", "display_name": "CinCout", "link": "https://stackoverflow.com/users/2912665/cincout"}, "edited": false, "score": 3, "creation_date": 1463562952, "post_id": 37295107, "comment_id": 62113607, "body": "@CinCout C supports VLA. But doesn&#39;t support the initialization of such arrays using braces initalizer list."}, {"owner": {"reputation": 356, "user_id": 4927569, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/17463e7b2c0eb564ed2742aa3637993f?s=128&d=identicon&r=PG&f=1", "display_name": "David Milanese", "link": "https://stackoverflow.com/users/4927569/david-milanese"}, "reply_to_user": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "edited": false, "score": 0, "creation_date": 1463563076, "post_id": 37295107, "comment_id": 62113711, "body": "@MohitJain, yes. But why?"}, {"owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "edited": false, "score": 0, "creation_date": 1463563188, "post_id": 37295107, "comment_id": 62113795, "body": "You don&#39;t know the count of element, how would you prepare initializer list. If you know at compile time, you don&#39;t need VLA feature. Rule is documented in section 6.7.8/3."}, {"owner": {"reputation": 356, "user_id": 4927569, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/17463e7b2c0eb564ed2742aa3637993f?s=128&d=identicon&r=PG&f=1", "display_name": "David Milanese", "link": "https://stackoverflow.com/users/4927569/david-milanese"}, "reply_to_user": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "edited": false, "score": 0, "creation_date": 1463563335, "post_id": 37295107, "comment_id": 62113903, "body": "@MohitJain, can you provide a link please."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1463563358, "post_id": 37295107, "comment_id": 62113922, "body": "Are you asking for a <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/C99RationaleV5.10.pdf\" rel=\"nofollow noreferrer\">design rationale</a> for the C language?"}, {"owner": {"reputation": 356, "user_id": 4927569, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/17463e7b2c0eb564ed2742aa3637993f?s=128&d=identicon&r=PG&f=1", "display_name": "David Milanese", "link": "https://stackoverflow.com/users/4927569/david-milanese"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1463563848, "post_id": 37295107, "comment_id": 62114239, "body": "@KerrekSB. A little. It comes down to understanding at what point does the compiler initialize the array, b? Is this done during preprocessing or runtime?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1463564425, "post_id": 37295107, "comment_id": 62114637, "body": "I still don&#39;t understand the heart of your question. Are you asking <i>how C works</i>, or <i>why C works the way it does</i>? The first one is easy (<code>a</code> is not a constant expression)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463564890, "post_id": 37295107, "comment_id": 62114951, "body": "&quot;historical reasons&quot;"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463565023, "post_id": 37295107, "comment_id": 62115051, "body": "@DavidMilanese obviously this initialization could not be carried out until the size is known, e.g. what if the size at runtime is 3, or 7. we would have to discard some initializers, or insert some zeroes ..."}, {"owner": {"reputation": 356, "user_id": 4927569, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/17463e7b2c0eb564ed2742aa3637993f?s=128&d=identicon&r=PG&f=1", "display_name": "David Milanese", "link": "https://stackoverflow.com/users/4927569/david-milanese"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1463581405, "post_id": 37295107, "comment_id": 62126800, "body": "@KerrekSB, Both are valid questions, but I am more interested in how C looks at that code and in what order processes it. The next step would be to look at why (if it&#39;s not obvious)."}, {"owner": {"reputation": 356, "user_id": 4927569, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/17463e7b2c0eb564ed2742aa3637993f?s=128&d=identicon&r=PG&f=1", "display_name": "David Milanese", "link": "https://stackoverflow.com/users/4927569/david-milanese"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463581477, "post_id": 37295107, "comment_id": 62126872, "body": "@M.M, Yes, however, as a compiler why should that matter. You can initialise an array of length 3 with only e.g. 2 elements, or 15 elements. The compiler will give you a warning but it won&#39;t give you an error."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463603361, "post_id": 37295107, "comment_id": 62140107, "body": "@DavidMilanese too many initializers is an error ."}, {"owner": {"reputation": 356, "user_id": 4927569, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/17463e7b2c0eb564ed2742aa3637993f?s=128&d=identicon&r=PG&f=1", "display_name": "David Milanese", "link": "https://stackoverflow.com/users/4927569/david-milanese"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463616305, "post_id": 37295107, "comment_id": 62144682, "body": "@M.M, on gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-4),      <code>demo1e.c:5:2: warning: excess elements in array initializer [enabled by default]   int b[3] = { 1, 5, 9, 4 };   ^ demo1e.c:5:2: warning: (near initialization for \u2018b\u2019) [enabled by default] </code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463623795, "post_id": 37295107, "comment_id": 62146472, "body": "@DavidMilanese gcc often says &quot;warning&quot; for errors"}], "answers": [{"comments": [{"owner": {"reputation": 356, "user_id": 4927569, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/17463e7b2c0eb564ed2742aa3637993f?s=128&d=identicon&r=PG&f=1", "display_name": "David Milanese", "link": "https://stackoverflow.com/users/4927569/david-milanese"}, "edited": false, "score": 0, "creation_date": 1463563234, "post_id": 37295142, "comment_id": 62113825, "body": "but why? Is there a documented reason for this?"}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 1, "last_activity_date": 1463563530, "last_edit_date": 1463563530, "creation_date": 1463562861, "answer_id": 37295142, "question_id": 37295107, "link": "https://stackoverflow.com/questions/37295107/variable-list-array-initialization-in-c-explained/37295142#37295142", "title": "Variable list array initialization in C explained", "body": "<blockquote>\n  <p>Why does this generate this error?  </p>\n</blockquote>\n\n<p>C standard doesn't allow this. Variable length arrays can't be initialized using brace-enclosed list of initializers.  </p>\n\n<p>Standard says:<br>\nC11-\u00a76.7.9/3: </p>\n\n<blockquote>\n  <p>The type of the entity to be initialized shall be an array of unknown size or a complete object type that is not a variable length array type.  </p>\n</blockquote>\n"}], "owner": {"reputation": 356, "user_id": 4927569, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/17463e7b2c0eb564ed2742aa3637993f?s=128&d=identicon&r=PG&f=1", "display_name": "David Milanese", "link": "https://stackoverflow.com/users/4927569/david-milanese"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "closed_date": 1463562971, "answer_count": 1, "score": 3, "last_activity_date": 1463563530, "creation_date": 1463562764, "question_id": 37295107, "link": "https://stackoverflow.com/questions/37295107/variable-list-array-initialization-in-c-explained", "closed_reason": "Duplicate", "title": "Variable list array initialization in C explained", "body": "<p>Give an a basic set of C code:</p>\n\n<pre><code>int a = 5;\nint b[a] = {1,2,3,4,5};\n</code></pre>\n\n<p>Why does this generate this error?</p>\n\n<pre><code>$gcc -o demo demo.c\nerror: variable-sized object may not be initialized\n</code></pre>\n\n<p>I understand that it is a bad thing to do and the compiler won't let you.\nHowever as a teacher I am having a hard time coming up with an explanation as to why you can not and should not do this.</p>\n\n<p>(Assume C99)</p>\n\n<p>How would you explain what is happening here?</p>\n"}, {"tags": ["c", "debugging", "embedded", "bare-metal", "jtag"], "comments": [{"owner": {"reputation": 28386, "user_id": 5666987, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/guTdN.jpg?s=128&g=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/5666987/ian"}, "edited": false, "score": 0, "creation_date": 1463560016, "post_id": 37294090, "comment_id": 62111734, "body": "This depends on your IDE.. some IDE like uVision is specifically designed to program in an embedded device"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 3, "creation_date": 1463560272, "post_id": 37294090, "comment_id": 62111899, "body": "Usually, by interfacing with built-in debugging hardware.  That&#39;s why you will oten see restrictions, eg. &#39;only 2 breakpoints at any one time&#39;, (the chip has only 2 breakpoint registers),"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1463571087, "post_id": 37294090, "comment_id": 62119185, "body": "The question is a bit too broad. It depends on the debugger, the ICD adapter and the microcontroller."}], "answers": [{"comments": [{"owner": {"reputation": 2153, "user_id": 731872, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/QWA8Z.jpg?s=128&g=1", "display_name": "Emilien", "link": "https://stackoverflow.com/users/731872/emilien"}, "edited": false, "score": 2, "creation_date": 1463561061, "post_id": 37294324, "comment_id": 62112370, "body": "There is also a usefull discussion here on <a href=\"http://stackoverflow.com/questions/8878716/what-is-the-difference-between-hardware-and-software-breakpoints\">software vs hardware breakpoints</a>, they explain both."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 6, "last_activity_date": 1463561044, "last_edit_date": 1495539851, "creation_date": 1463560608, "answer_id": 37294324, "question_id": 37294090, "link": "https://stackoverflow.com/questions/37294090/how-are-breakpoints-working-on-an-embedded-device/37294324#37294324", "title": "How are breakpoints working on an embedded device?", "body": "<p>As mentioned in a comment by <a href=\"https://stackoverflow.com/users/758133/martin-james\">@Martin James</a>, the typical way this works is that the target hardware supports breakpoints natively.</p>\n\n<p>The debugger then uses the JTAG interface to set on-chip registers to configure the breakpoints, and the actual \"breaking\" is then done by the chip itself.</p>\n\n<p>This often means that the number of simultaneous breakpoints you can have is limited to some small number, since there is a limited amount of such hardware present.</p>\n\n<p><a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.ddi0432c/Bcgbfdhc.html\" rel=\"nofollow noreferrer\">This link</a> describes the ARM Cortex-M0's debug hardware for instance, and says that is has (customer-selectable) 1 to at most 4 hardware breakpoints and up to two (2) watchpoints. So, pretty severely limited (but as an actual embedded developer, I see this and think \"mmmm hardware breakpoints, such richness\").</p>\n"}, {"tags": [], "owner": {"reputation": 70426, "user_id": 463115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dabb2e53ae031494cbe17a214cb285ab?s=128&d=identicon&r=PG", "display_name": "jeb", "link": "https://stackoverflow.com/users/463115/jeb"}, "is_accepted": false, "score": 3, "last_activity_date": 1463574611, "creation_date": 1463574611, "answer_id": 37299717, "question_id": 37294090, "link": "https://stackoverflow.com/questions/37294090/how-are-breakpoints-working-on-an-embedded-device/37299717#37299717", "title": "How are breakpoints working on an embedded device?", "body": "<p>@unwind Mentioned the hardware breakpoints already.  </p>\n\n<p>Some mcu's also offer a single step interrupt/mechanism.<br>\nAfter each instruction the code will be stopped, but the debugger doesn't need to set breakpoints each time for this single stepping.</p>\n\n<p>And on some older mcu without hardware breakpoints, the breakpoints are realized by replacing instructions by a software interrupt instruction.<br>\nWhen the code resides in flash this is awful, as the flash has to reprogrammed for each breakpoint and this is typically very slow</p>\n"}], "owner": {"reputation": 469, "user_id": 6012315, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d7f2484ba51df08ea30569f351afe958?s=128&d=identicon&r=PG&f=1", "display_name": "Schafwolle", "link": "https://stackoverflow.com/users/6012315/schafwolle"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 505, "favorite_count": 0, "closed_date": 1463685453, "accepted_answer_id": 37294324, "answer_count": 2, "score": 4, "last_activity_date": 1463575530, "creation_date": 1463559963, "last_edit_date": 1463575530, "question_id": 37294090, "link": "https://stackoverflow.com/questions/37294090/how-are-breakpoints-working-on-an-embedded-device", "closed_reason": "Needs more focus", "title": "How are breakpoints working on an embedded device?", "body": "<p>This is just a question for personal intrest. I know that my JTAG is able to read the register values of the uController. But I have no clue how the JTAG device knows when to stop the uController. I thought that maybe some code is added calling an interrupt but you are able to add breakpoints during operation therefore this seams to be wrong. So how is it done?</p>\n"}, {"tags": ["c", "arrays", "microcontroller", "pic", "microchip"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1463560558, "post_id": 37294009, "comment_id": 62112071, "body": "What??  You read the port: &#39;array[index] = PORTDbits.RD0;&#39;, and them immediately overwrite the value you read: &#39;array[index] = array[index+1];&#39;.  You say that this code actually works, a bit?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1463560726, "post_id": 37294009, "comment_id": 62112181, "body": "Also, &#39;unsigned char array[SIZE];&#39; is an 8 BYTE array, not 8 bits.  Can you be clearer re. your actual intent?"}, {"owner": {"reputation": 45, "user_id": 6349579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-qcUasKhdHNo/AAAAAAAAAAI/AAAAAAAAAdE/iWrb5OUFxBs/photo.jpg?sz=128", "display_name": "Daymov", "link": "https://stackoverflow.com/users/6349579/daymov"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1463560763, "post_id": 37294009, "comment_id": 62112198, "body": "Hi,  Yes I know it&#39;s absolutely stupid and illogical.  But I&#39;ve tried the other way : array[index+1] = array[index] and it wasn&#39;t better... EDIT : I looked up for the help on the bit shifting and that&#39;s what I have found to do it manually"}, {"owner": {"reputation": 45, "user_id": 6349579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-qcUasKhdHNo/AAAAAAAAAAI/AAAAAAAAAdE/iWrb5OUFxBs/photo.jpg?sz=128", "display_name": "Daymov", "link": "https://stackoverflow.com/users/6349579/daymov"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1463560920, "post_id": 37294009, "comment_id": 62112284, "body": "The application of the code would be audio monitoring. I just want to create frames from the audio signal given in input. They will be sent to the slave to compare if the audio in output is the same"}, {"owner": {"reputation": 45, "user_id": 6349579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-qcUasKhdHNo/AAAAAAAAAAI/AAAAAAAAAdE/iWrb5OUFxBs/photo.jpg?sz=128", "display_name": "Daymov", "link": "https://stackoverflow.com/users/6349579/daymov"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1463563680, "post_id": 37294009, "comment_id": 62114132, "body": "Ok, I have tried like this and it seems to work.     &#39;array[index] = PORTDbits.RD0;&#39;   // Read RD0 and save in array     &#39;printf(&quot;%s&quot;, array);&#39;     &#39;++index; &#39;                       // Getting index ready for next bit"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 6349579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-qcUasKhdHNo/AAAAAAAAAAI/AAAAAAAAAdE/iWrb5OUFxBs/photo.jpg?sz=128", "display_name": "Daymov", "link": "https://stackoverflow.com/users/6349579/daymov"}, "edited": false, "score": 0, "creation_date": 1463573442, "post_id": 37296612, "comment_id": 62120885, "body": "Thanks !  Before I could read you answer, I had re-written the code for filling the data into the array to one very close to the one you are suggesting (just the name of the variables were different).   Regarding the global flag, I&#39;m sorry but in don&#39;t really understand its purpose. When configuring my timer, I have set the registers, prescaler to get my 100ms delay. Won&#39;t it do a redundancy if I use the flag ?"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "reply_to_user": {"reputation": 45, "user_id": 6349579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-qcUasKhdHNo/AAAAAAAAAAI/AAAAAAAAAdE/iWrb5OUFxBs/photo.jpg?sz=128", "display_name": "Daymov", "link": "https://stackoverflow.com/users/6349579/daymov"}, "edited": false, "score": 0, "creation_date": 1463633914, "post_id": 37296612, "comment_id": 62148904, "body": "The flag is required to have a delay in between two reads of <code>PORTDbits.RD0</code>. In your original code, after completing one iteration of the data acquisition <code>while(1)</code> loop, it reads the data again immediately. The while loop will take in the order of microseconds to execute. The next data is read after few microseconds rather than 100ms as desired."}, {"owner": {"reputation": 45, "user_id": 6349579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-qcUasKhdHNo/AAAAAAAAAAI/AAAAAAAAAdE/iWrb5OUFxBs/photo.jpg?sz=128", "display_name": "Daymov", "link": "https://stackoverflow.com/users/6349579/daymov"}, "edited": false, "score": 0, "creation_date": 1463642574, "post_id": 37296612, "comment_id": 62152834, "body": "OK. Thanks a lot for your help."}, {"owner": {"reputation": 45, "user_id": 6349579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-qcUasKhdHNo/AAAAAAAAAAI/AAAAAAAAAdE/iWrb5OUFxBs/photo.jpg?sz=128", "display_name": "Daymov", "link": "https://stackoverflow.com/users/6349579/daymov"}, "edited": false, "score": 0, "creation_date": 1463650151, "post_id": 37296612, "comment_id": 62157954, "body": "Quick additional question : would it work if I use a delay function between two acquisition instead of the flag ?"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "reply_to_user": {"reputation": 45, "user_id": 6349579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-qcUasKhdHNo/AAAAAAAAAAI/AAAAAAAAAdE/iWrb5OUFxBs/photo.jpg?sz=128", "display_name": "Daymov", "link": "https://stackoverflow.com/users/6349579/daymov"}, "edited": false, "score": 0, "creation_date": 1463654276, "post_id": 37296612, "comment_id": 62160901, "body": "Yes, But you have gone to all the trouble of setting up the timer. So you can use the better solution of the timer."}, {"owner": {"reputation": 69, "user_id": 2098225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6628200bcecdbf24e5880cc4a0804d6f?s=128&d=identicon&r=PG", "display_name": "crypticfool", "link": "https://stackoverflow.com/users/2098225/crypticfool"}, "edited": false, "score": 0, "creation_date": 1464003751, "post_id": 37296612, "comment_id": 62289429, "body": "I&#39;m not familiar with the PORTDbits.RD0 are you reading an 8 bit port or a single bit? If it is single bit &quot;filling of the array and the bit shifting&quot; is not being carried out in any of the code including answers. @Rishikesh global flag is correct method - timer isr sets flag, the while loop detects the set flag, resets flag and transfers the port to your array."}, {"owner": {"reputation": 45, "user_id": 6349579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-qcUasKhdHNo/AAAAAAAAAAI/AAAAAAAAAdE/iWrb5OUFxBs/photo.jpg?sz=128", "display_name": "Daymov", "link": "https://stackoverflow.com/users/6349579/daymov"}, "reply_to_user": {"reputation": 69, "user_id": 2098225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6628200bcecdbf24e5880cc4a0804d6f?s=128&d=identicon&r=PG", "display_name": "crypticfool", "link": "https://stackoverflow.com/users/2098225/crypticfool"}, "edited": false, "score": 0, "creation_date": 1464009494, "post_id": 37296612, "comment_id": 62293313, "body": "@crypticfool : The signal coming on RD0 is an audio signal that has been treated (modulation, etc.). I want to create frames so I can compare the audio signal leaving the master and arriving on the slave. The idea is just to ensure that the message sent is the one received"}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": true, "score": 2, "last_activity_date": 1463566553, "creation_date": 1463566553, "answer_id": 37296612, "question_id": 37294009, "link": "https://stackoverflow.com/questions/37294009/storing-portd-value-in-array-on-pic18f452-c/37296612#37296612", "title": "Storing PORTD value in array on pic18f452 (C)", "body": "<ol>\n<li>In the main function you have an infinite loop, which runs without any delay between two acquisitions. What you need is to have a delay of 100ms between the two times that you read PORTD.</li>\n</ol>\n\n<p>What you can do is introduce a global flag. This is set in the timer subroutine, and is cleared in main.</p>\n\n<ol start=\"2\">\n<li>The code for filling the data into the array is not correct. The code below fills the array starting from location <code>arrray[0]</code>, <code>array[1]</code> to max in order.</li>\n</ol>\n\n<p>The timer should be modified like this</p>\n\n<pre><code>void timer1_isr(void) {\n    if (PIR1bits.TMR1IF == 1) {\n        blTimeOverFlag = 1;\n        // Other code here\n    }\n}\n</code></pre>\n\n<p>Main function loop is below</p>\n\n<pre><code>while(1){\n  if (blTimeOverFlag == 1)\n  {   \n    blTimeOverFlag = 0;\n    array[filling_cnt] = PORTDbits.RD0;          // Read RD0 and save in array        \n     filling_cnt++;                         // Array counter for filling control\n\n     if(filling_cnt &gt;= SIZE){                  // Reached the end of array ?\n        filling_cnt = 0;\n        printf(\"%s\\n\", array);             // Send data to terminal\n        for (j=0; j&lt;SIZE; j++){\n            array[j] = '\\0';               // Empty array\n        } //rof\n     } //fi\n  }\n}           \n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 6349579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-qcUasKhdHNo/AAAAAAAAAAI/AAAAAAAAAdE/iWrb5OUFxBs/photo.jpg?sz=128", "display_name": "Daymov", "link": "https://stackoverflow.com/users/6349579/daymov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 37296612, "answer_count": 1, "score": 0, "last_activity_date": 1463566553, "creation_date": 1463559721, "question_id": 37294009, "link": "https://stackoverflow.com/questions/37294009/storing-portd-value-in-array-on-pic18f452-c", "title": "Storing PORTD value in array on pic18f452 (C)", "body": "<p>I'm a looking for some advice as I'm working on a PIC18F452 on Proteus.</p>\n\n<p>My objective is to acquire the value of PORTDbits.RD0 (set as input) every 100ms (set through timer1) and store it in an 8-bit array. This frame would be later sent through SPI to slave. </p>\n\n<p>For the moment I have only implemented what I consider to be the filling of the array and the bit shifting. Sadly, when I start the simulation, only on bit of the array contains at some point the value of PORTDbits.RD0.</p>\n\n<p>If anyone has an idea that might help, it would be great :D</p>\n\n<p>Here's my code</p>\n\n<pre><code>/* CONFIG *******************************************************************/\n#pragma config PWRT  = ON    // Power-up Timer\n#pragma config OSC   = HS    // High-Speed Oscillator\n#pragma config LVP   = OFF   // Low-Voltage In-Circuit Serial Programming\n#pragma config DEBUG = ON    //\n\n/* INCLUDES *****************************************************************/\n#include \"project_config.h\"  // All headers inclusion\n\n/* MACROS *******************************************************************/\n#define nop() {_asm nop _endasm}\n\n/* DEFINES ******************************************************************/\n#define SIZE 8\n\n/* FUNCTIONS PROTOTYPES *****************************************************/\nvoid main(void);\n\nvoid isr_config(void);\nvoid io_config(void);\n\nvoid timer1_config(void);\nvoid timer1_isr(void);\n\n/* PROTOTYPES ***************************************************************/\n\n/* VARIABLES DEFINITION *****************************************************/\nunsigned int filling_cnt = 0; \n\n/* MAIN *********************************************************************/\nvoid main(void) {\n    unsigned char array[SIZE]; \n    unsigned int index = 0; \n    int j; \n\n    /// Initialization\n    io_config();\n    timer1_config();\n    isr_config();\n\n    /// Interruption\n    timer1_isr();\n\n    /// Data acquisiton\n    while(1){\n        array[index] = PORTDbits.RD0;          // Read RD0 and save in array        \n        for(index = 0; index &lt; SIZE; index++){ // Fill array\n            array[index] = array[index+1];     // shifting n_value to insert n+1_value\n            //printf(\"%s\\n\", array);\n         } //rof\n\n         filling_cnt++;                         // Array counter for filling control\n\n         if(filling_cnt &gt; SIZE){                  // Reached the end of array ?\n            index = 0;                         // Reset counter\n            printf(\"%s\\n\", array);             // Send data to terminal\n            for (j=0; j&lt;SIZE; j++){\n                array[j] = '\\0';               // Empty array\n            } //rof\n         } //fi\n    }\n}\n\n/* FUNCTIONS ****************************************************************/\n/// Configurations\nvoid timer1_config(void) {\n    T1CONbits.RD16 = 1;    // Timer/Counter 8-bits/16-bits Control bit: 0=8-bits / 1=16-bits\n    T1CONbits.T1CKPS1 = 1; // Prescaler\n    T1CONbits.T1CKPS0 = 1; //   1 = 0b00\n                           //   2 = 0b01\n                           //   4 = 0b10\n                           //   8 = 0b11\n    T1CONbits.T1OSCEN = 1; // Timer1 Oscillator shut off\n    T1CONbits.TMR1CS = 0;  // Timer1 Clock Source Select bit\n                           //   0 = Internal Clock (Fosc/4)\n                           //   1 = Transition on T1CKI pin\n    T1CONbits.TMR1ON = 1;  // Timer1 On/Off Control bit\n                           //   1 = Enables Timer1\n                           //   0 = Stops Timer1\n    TMR1H=0x0B;            // Preset timer1 value for MSB register\n    TMR1L=0xDB;            // Preset timer1 value for LSB register\n                           // to get a 100ms delay\n}\n\nvoid isr_config(void) {\n    PIE1bits.TMR1IE = 1;   // Enable Timer1 interrupts\n    PIR1bits.TMR1IF = 0;   // Clear Timer1 interrupt flag\n    IPR1bits.TMR1IP = 1;   // Non high priority interrupt\n\n    RCONbits.IPEN   = 1;   // Interrupt High level\n\n    INTCONbits.PEIE = 1;   // All peripherals interrutps verified\n    INTCONbits.GIE  = 1;   // All interrupts verified\n}\n\nvoid io_config(void) {\n    TRISB = 0x00;          // PORTB as output\n    TRISDbits.TRISD0 = 1;  // COMP_OUT as input\n    TRISDbits.TRISD1 = 0;  // DATA as output\n}\n\n/// Interruptions\n#pragma code highVector = 0x08 //lowVector = 0x18\nvoid InterruptHigh (void) {\n   _asm\n   goto timer1_isr\n   _endasm\n}\n#pragma code\n\n#pragma interrupt timer1_isr\nvoid timer1_isr(void) {\n     if (PIR1bits.TMR1IF == 1) {  // check that timer1 overflow is reason for ISR.\n                                  // even though there is only one Interrupt source\n                                  // trigger enabled, it is good programming practice to\n                                  // test why we have arrived at the ISR.\n        PIR1bits.TMR1IF = 0; // Timer1 interrupt flag clear\n\n        TMR1H = 0x0B;        // Preset timer1 value for MSB register\n        TMR1L = 0xDC;        // Preset timer1 value for LSB register\n                             // with a 20MHz xtal, Timer1 Prescalar set to /8\n                             // decimal 3036 (0x0B 0xDC) is the counter start point\n                             // which will result in Timer1 overflow 1 per 100ms\n                             // 65536 - 3036 = 62500 cycles\n                             // 10 interrupts per second\n\n        LATBbits.LATB4 = !LATBbits.LATB4; // invert the condition of LED to show program\n                                          // has entered the Interrupt routine\n        PORTDbits.RD1 = !PORTDbits.RD1;   // invert the condition of DATA to show program\n                                          // has entered the Interrupt routine                              \n     } //fi\n}\n\n/* EOF main.c ***************************************************************/\n</code></pre>\n\n<p>If anything is missing or unclear in this message, please do not hesitate do tell me. I'll do my best to add details or to re-think my post in order to facilitate the comprehension. \nThanks in advance ;)</p>\n"}, {"tags": ["c", "linux", "gcc", "io", "flush"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1463559235, "post_id": 37293803, "comment_id": 62111232, "body": "How about asking the program to exit nicely instead of killing it?"}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 5, "creation_date": 1463559245, "post_id": 37293803, "comment_id": 62111236, "body": "Looking for <a href=\"http://en.cppreference.com/w/cpp/io/manip/flush\" rel=\"nofollow noreferrer\">std::flush</a>?"}, {"owner": {"reputation": 1026, "user_id": 4068338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y8uJJ.png?s=128&g=1", "display_name": "Matsmath", "link": "https://stackoverflow.com/users/4068338/matsmath"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1463559694, "post_id": 37293803, "comment_id": 62111522, "body": "@BartekBanachewicz that  actually might work... so I should send the program a different <code>SIG...</code> signal. I will check."}, {"owner": {"reputation": 2203, "user_id": 6137423, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O1Rfu.jpg?s=128&g=1", "display_name": "AhmadWabbi", "link": "https://stackoverflow.com/users/6137423/ahmadwabbi"}, "edited": false, "score": 0, "creation_date": 1463559719, "post_id": 37293803, "comment_id": 62111537, "body": "Do you want to force flush when you kill the program?"}, {"owner": {"reputation": 1026, "user_id": 4068338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y8uJJ.png?s=128&g=1", "display_name": "Matsmath", "link": "https://stackoverflow.com/users/4068338/matsmath"}, "reply_to_user": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1463559771, "post_id": 37293803, "comment_id": 62111576, "body": "@nwp (and the comment-upvoters): I don&#39;t see how <code>std::flush</code> would help since the program is <i>still running</i>."}, {"owner": {"reputation": 3256, "user_id": 6292850, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/86iZy.jpg?s=128&g=1", "display_name": "uh oh somebody needs a pupper", "link": "https://stackoverflow.com/users/6292850/uh-oh-somebody-needs-a-pupper"}, "edited": false, "score": 0, "creation_date": 1463559813, "post_id": 37293803, "comment_id": 62111601, "body": "<a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">Is the fact that the program hangs intended behavior?</a>"}, {"owner": {"reputation": 3256, "user_id": 6292850, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/86iZy.jpg?s=128&g=1", "display_name": "uh oh somebody needs a pupper", "link": "https://stackoverflow.com/users/6292850/uh-oh-somebody-needs-a-pupper"}, "edited": false, "score": 0, "creation_date": 1463559916, "post_id": 37293803, "comment_id": 62111669, "body": "@Matsmath What about &quot;This manipulator may be used to produce an incomplete line of output immediately, e.g. when displaying output from a <b>long-running process</b>&quot; is unclear to you?"}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 0, "creation_date": 1463559980, "post_id": 37293803, "comment_id": 62111711, "body": "@Matsmath It means that you should modify your program so that it flushes after writing interesting stuff, or periodically, or whatever. Since your question mentions opening/closing a file each time, it seems changes to the program are fair game. Or are you asking how to extract the data from one particular currently running instance which you don&#39;t want to kill?"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1463560007, "post_id": 37293803, "comment_id": 62111726, "body": "@Matsmath doesn&#39;t even have to be a signal, you can just wait on stdio."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 4, "creation_date": 1463560770, "post_id": 37293803, "comment_id": 62112204, "body": "Your question is based on a fallacy. &#39;Stuff that is in the OS buffer/disk cache&#39; won&#39;t be lost. What you have to worry about is stuff that is still in the application, e.g. <code>stdio</code> or <code>streams</code> buffers, and <code>fflush()</code> and <code>std::flush()</code> are the answers to those two."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1463560847, "post_id": 37293803, "comment_id": 62112231, "body": "You can use <code>std::flush</code> while the program is running. Flushing when the program is not running doesn&#39;t make sense."}, {"owner": {"reputation": 1026, "user_id": 4068338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y8uJJ.png?s=128&g=1", "display_name": "Matsmath", "link": "https://stackoverflow.com/users/4068338/matsmath"}, "edited": false, "score": 0, "creation_date": 1463566673, "post_id": 37293803, "comment_id": 62116148, "body": "@To the commenters who are repeatedly suggesting <code>std::flush</code>. Where should I put that? I have a process which is <i>currently</i> running <i>at this moment</i>."}, {"owner": {"reputation": 1026, "user_id": 4068338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y8uJJ.png?s=128&g=1", "display_name": "Matsmath", "link": "https://stackoverflow.com/users/4068338/matsmath"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1463566810, "post_id": 37293803, "comment_id": 62116255, "body": "@EJP so I guess you are suggesting basically the same idea as of Bartek B: gracefully shut down the process, if possible. I guess if I just plug the plug out of the wall, those stuff in the OS buffer/disk cache <i>will</i> be lost."}, {"owner": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "edited": false, "score": 0, "creation_date": 1463568723, "post_id": 37293803, "comment_id": 62117605, "body": "The real solution is to troubleshoot why your program runs &quot;forever&quot; or, if the &quot;interesting stuff&quot; is available quickly but the program is doing something else for very long after that, split it into two programs."}, {"owner": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "edited": false, "score": 0, "creation_date": 1463568776, "post_id": 37293803, "comment_id": 62117643, "body": "Since you&#39;re asking for ways to intrude into the program with OS means, please specify the OS."}, {"owner": {"reputation": 1026, "user_id": 4068338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y8uJJ.png?s=128&g=1", "display_name": "Matsmath", "link": "https://stackoverflow.com/users/4068338/matsmath"}, "edited": false, "score": 0, "creation_date": 1463585728, "post_id": 37293803, "comment_id": 62130145, "body": "I made a major edit. It is somewhat unfortunate that I have changed the scope from C++ to C."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1463928951, "post_id": 37293803, "comment_id": 62262944, "body": "&quot;Experience shows, that stuff indeed get lost.&quot; - How are you determining that?"}, {"owner": {"reputation": 1026, "user_id": 4068338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y8uJJ.png?s=128&g=1", "display_name": "Matsmath", "link": "https://stackoverflow.com/users/4068338/matsmath"}, "edited": false, "score": 0, "creation_date": 1463931355, "post_id": 37293803, "comment_id": 62263834, "body": "&quot;but after either of these approaches the file test.txt created in the very beginning of the program remains empty.&quot; I checked that with <code>cat</code>. You are right in the sense that stuff might get lost from the <code>stdio</code>, or <code>streams</code> buffers, and not from the disk/os cache."}, {"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1463943943, "post_id": 37293803, "comment_id": 62268035, "body": "Yup - disk cache is independent of process lifecycle.  Only place you can be losing data is if you&#39;re not writing it in the first place (due to a bug), or you&#39;re not flushing it from your streams (which can be solved with <code>fflush</code> or <code>std::flush</code> at the appropriate time)."}], "answers": [{"comments": [{"owner": {"reputation": 1026, "user_id": 4068338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y8uJJ.png?s=128&g=1", "display_name": "Matsmath", "link": "https://stackoverflow.com/users/4068338/matsmath"}, "edited": false, "score": 0, "creation_date": 1463566495, "post_id": 37295482, "comment_id": 62116031, "body": "This is an interesting approach, and I think I should implement it.  But it does not help now, as I have a <i>currently</i> running program."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1463566790, "post_id": 37295482, "comment_id": 62116242, "body": "Note that your &quot;code for clean shutdown&quot; must be async-signal-safe.  In general, flushing IO buffers is <i>not</i> async-signal-safe.  The only function calls guaranteed to be async-signal-safe are listed <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html\" rel=\"nofollow noreferrer\">about halfway down this page</a>.  C++ IO will be somewhere on the spectrum between implementation-defined and undefined behavior."}, {"owner": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "edited": false, "score": 3, "creation_date": 1463570006, "post_id": 37295482, "comment_id": 62118490, "body": "Another solution is to attach a debugger (which would halt the program), then call <code>std::flush()</code> from it (e.g. <code>gdb</code> can evaluate expressions). Yet likewise, it&#39;s unsafe, as the program may be halted in some transient state. The safest way is to set a breakpoint somewhere outside any I/O and wait for it to be hit - so you know the I/O system is in a usable state."}, {"owner": {"reputation": 2631, "user_id": 5153116, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/vSaaK.jpg?s=128&g=1", "display_name": "mvorisek", "link": "https://stackoverflow.com/users/5153116/mvorisek"}, "reply_to_user": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "edited": false, "score": 0, "creation_date": 1560119865, "post_id": 37295482, "comment_id": 99622771, "body": "@ivan_pozdeev I need to trigger the flush externally for stdout file redirect. The program is started like <code>.&#47;program &gt; out.txt</code>. Is it possible to somehow get the reference of that file and call <code>fflush</code> externally (without modifiing the program of course)?"}], "tags": [], "owner": {"reputation": 9156, "user_id": 6255513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a62b448d7fe8e472368e4cd4e2615a3?s=128&d=identicon&r=PG&f=1", "display_name": "Smeeheey", "link": "https://stackoverflow.com/users/6255513/smeeheey"}, "is_accepted": false, "score": 2, "last_activity_date": 1463568249, "last_edit_date": 1463568249, "creation_date": 1463563744, "answer_id": 37295482, "question_id": 37293803, "link": "https://stackoverflow.com/questions/37293803/how-to-force-a-running-program-to-flush-the-contents-of-its-i-o-buffers-to-disk/37295482#37295482", "title": "How to force a running program to flush the contents of its I/O buffers to disk with external means?", "body": "<p>By default, the response to the signal SIGTERM is to shut down the application immediately. However, you can add your own custom signal handler to override this behaviour, like this:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;atomic&gt;\n...\nstd::atomic_bool shouldStop;\n\n...\nvoid signalHandler(int sig)\n{\n    //code for clean shutdown goes here: MUST be async-signal safe, such as:\n    shouldStop = true;\n}\n...\nint main()\n{\n    ...\n    signal(SIGTERM, signalHandler); //this tells the OS to use your signal handler instead of default\n    signal(SIGINT, signalHandler);  //can do it for other signals too\n    ...\n    //main work logic, which could be of form:\n    while(!shouldStop) {\n        ...\n        if(someTerminatingCondition) break;\n        ...\n    }\n    //cleanup including flushing\n    ...\n}\n</code></pre>\n\n<p>Be aware that if take this approach, you must make sure that your program does actually terminate after your custom handler is run (it is under no obligation to do so immediately, and can run clean-up logic as it sees fit). If it doesn't shut down, linux will not shut it down either so the SIGTERM will be 'ignored' from an outside perspective.</p>\n\n<p>Note that by default the linux <code>kill</code> command sends a SIGTERM, invoking the behaviour above. If your program is running in the foreground and <code>Ctrl-C</code> is pressed, a SIGINT is sent instead, which is why you might want to handle that as well as per above.</p>\n\n<p>Note also, the implementation suggested above takes care to be safe, in that no async logic is performed in the signal handler other than setting an atomic flag. This is important, as pointed out in the comments below. See the Async-signal safe section of <a href=\"http://man7.org/linux/man-pages/man7/signal.7.html\" rel=\"nofollow\">this page</a> for details of what is and isn't allowed.</p>\n"}, {"comments": [{"owner": {"reputation": 1026, "user_id": 4068338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y8uJJ.png?s=128&g=1", "display_name": "Matsmath", "link": "https://stackoverflow.com/users/4068338/matsmath"}, "edited": false, "score": 1, "creation_date": 1473360158, "post_id": 39397951, "comment_id": 66122118, "body": "Thank you for your time writing up this detailed... <i>attempt</i> of an answer. My program is still running, by the way. I have decided it is better not to mess with it."}, {"owner": {"reputation": 1473, "user_id": 5851520, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1050ad350ce5bed47c2db205b54c3f16?s=128&d=identicon&r=PG&f=1", "display_name": "SusanW", "link": "https://stackoverflow.com/users/5851520/susanw"}, "reply_to_user": {"reputation": 1026, "user_id": 4068338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y8uJJ.png?s=128&g=1", "display_name": "Matsmath", "link": "https://stackoverflow.com/users/4068338/matsmath"}, "edited": false, "score": 0, "creation_date": 1473360271, "post_id": 39397951, "comment_id": 66122190, "body": "@Matsmath OMG! really? Wow! Do you know, I don&#39;t think I&#39;d touch it either... :-)"}, {"owner": {"reputation": 2631, "user_id": 5153116, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/vSaaK.jpg?s=128&g=1", "display_name": "mvorisek", "link": "https://stackoverflow.com/users/5153116/mvorisek"}, "edited": false, "score": 0, "creation_date": 1560119855, "post_id": 39397951, "comment_id": 99622767, "body": "I need to trigger the flush externally for stdout file redirect. The program is started like <code>.&#47;program &gt; out.txt</code>. Is it possible to somehow get the reference of that file and call <code>fflush</code> externally (without modifiing the program of course)?"}, {"owner": {"reputation": 1473, "user_id": 5851520, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1050ad350ce5bed47c2db205b54c3f16?s=128&d=identicon&r=PG&f=1", "display_name": "SusanW", "link": "https://stackoverflow.com/users/5851520/susanw"}, "reply_to_user": {"reputation": 2631, "user_id": 5153116, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/vSaaK.jpg?s=128&g=1", "display_name": "mvorisek", "link": "https://stackoverflow.com/users/5153116/mvorisek"}, "edited": false, "score": 0, "creation_date": 1560413417, "post_id": 39397951, "comment_id": 99730118, "body": "@Mvorisek sorry, don&#39;t think so. The buffer is just some memory inside the process (it&#39;s not an OS thing), and if the program hasn&#39;t been written with a &quot;flush on demand&quot; capability (via signal handler etc), then it can&#39;t do it. My normal trick when I find process logging is overly buffered is to do something that stimulates extra logging and it will flush on buffer-full, but that won&#39;t work on everything. Debugger, maybe?"}], "tags": [], "owner": {"reputation": 1473, "user_id": 5851520, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1050ad350ce5bed47c2db205b54c3f16?s=128&d=identicon&r=PG&f=1", "display_name": "SusanW", "link": "https://stackoverflow.com/users/5851520/susanw"}, "is_accepted": true, "score": 4, "last_activity_date": 1473359612, "creation_date": 1473359612, "answer_id": 39397951, "question_id": 37293803, "link": "https://stackoverflow.com/questions/37293803/how-to-force-a-running-program-to-flush-the-contents-of-its-i-o-buffers-to-disk/39397951#39397951", "title": "How to force a running program to flush the contents of its I/O buffers to disk with external means?", "body": "<p>Can I just add some clarity? Obviously months have passed, and I imagine your program isn't running any more ... but there's some confusion here about buffering which still isn't clear.</p>\n\n<p>As soon as you use the <em>stdio</em> library and <code>FILE *</code>, you will by default have a fairly small (implementation dependent, but typically some KB) buffer inside your program which is accumulating what you write, and flushing it to the OS when it's full, (or on file close). When you kill your process, it is this buffer that gets lost.</p>\n\n<p>If the data <em>has</em> been flushed to the OS, then it is kept in a unix file buffer until the OS decides to persist it to disk (usually fairly soon), or someone runs the <code>sync</code> command. If you kill the power on your computer, then this buffer gets lost as well. You probably don't care about this scenario, because you probably aren't planning to yank the power! But this is what @EJP was talking about (re <em>Stuff that is in the OS buffer/disk cache' won't be lost</em>): your problem is the <em>stdio</em> cache, not the OS.</p>\n\n<p>In an ideal world, you'd write your app so it fflushed (or <code>std::flush()</code>) at key points. In your example, you'd say:</p>\n\n<pre><code>    if (i == 0) {//This case is interesting!\n        fprintf(filept, \"Hello world\\n\");\n        fflush(filept);\n    }\n</code></pre>\n\n<p>which would cause the <em>stdio</em> buffer to flush to the OS. I imagine your real writer is more complex, and in that situation I would try to make the fflush happen \"often but not too often\". Too rare, and you lose data when you kill the process, too often and you lose the performance benefits of buffering if you are writing a lot.</p>\n\n<p>In your described situation, where the program is already running and can't be stopped and rewritten, then your only hope, as you say, is to stop it in a debugger. The details of what you need to do depend on the implementation of the std lib, but you can usually look inside the <code>FILE *filept</code> object and start following pointers, messy though. @ivan_pozdeev's comment about executing <code>std::flush()</code> or <code>fflush()</code> within the debugger is helpful.</p>\n"}], "owner": {"reputation": 1026, "user_id": 4068338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Y8uJJ.png?s=128&g=1", "display_name": "Matsmath", "link": "https://stackoverflow.com/users/4068338/matsmath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3729, "favorite_count": 1, "accepted_answer_id": 39397951, "answer_count": 2, "score": 5, "last_activity_date": 1473359612, "creation_date": 1463559065, "last_edit_date": 1495535350, "question_id": 37293803, "link": "https://stackoverflow.com/questions/37293803/how-to-force-a-running-program-to-flush-the-contents-of-its-i-o-buffers-to-disk", "title": "How to force a running program to flush the contents of its I/O buffers to disk with external means?", "body": "<p>I have a long-running C program which opens a file in the beginning, writes out \"interesting\" stuff during execution, and closes the file just before it finishes. The code, compiled with <code>gcc -o test test.c</code> (gcc version 5.3.1.) looks like as follows:</p>\n\n<pre><code>//contents of test.c\n#include&lt;stdio.h&gt;\n\nFILE * filept;\n\nint main() {\n    filept = fopen(\"test.txt\",\"w\");\n    unsigned long i;\n    for (i = 0; i &lt; 1152921504606846976; ++i) {\n        if (i == 0) {//This case is interesting!\n            fprintf(filept, \"Hello world\\n\");\n        }\n    }\n    fclose(filept);\n    return 0;\n}\n</code></pre>\n\n<p>The problem is that <em>since this is a scientific computation</em> (think of searching for primes, or whatever is your favourite hard-to-crack stuff) it could really run for a <em>very</em> long time. Since I determined that I am not patient enough, I would like to abort the current computation, but I would like to do this in an <em>intelligent</em> way by somehow forcing the program <em>by external means</em> to flush out all the data that is currently in the OS buffer/disk cache, wherever.</p>\n\n<p>Here is what I have tried (for this bogus program above, and of course not for the real deal <em>which is currently still running</em>):</p>\n\n<ol>\n<li>pressing ctrl+C; or</li>\n<li>sending <code>kill -6 &lt;PID&gt;</code> (and also <code>kill -3 &lt;PID&gt;</code>) -- as suggested by @BartekBanachewicz,</li>\n</ol>\n\n<p>but after either of these approaches the file <code>test.txt</code> created in the very beginning of the program <em>remains empty</em>. This means, that the contents of <code>fprintf()</code> were left in some intermediate buffer during the computation, waiting for some OS/hardware/software flush signal, but since no such a signal was obtained, the contents <em>disappeared</em>. This also means, that the comment made by @EJP</p>\n\n<blockquote>\n  <p>Your question is based on a fallacy. 'Stuff that is in the OS\n  buffer/disk cache' won't be lost.</p>\n</blockquote>\n\n<p>does not seem to apply here. Experience shows, that stuff indeed get lost.</p>\n\n<p>I am using Ubuntu 16.04 and I am willing to attach a debugger to this process if it is possible, and if it is safe to retrieve the data this way. Since I never done such a thing before, I would appreciate if someone would provide me a <em>detailed</em> answer how to get the contents flushed into the disk <em>safely and surely</em>. Or I am open to other methods as well. There is no room for error here, as I am not going to rerun the program again.</p>\n\n<p>Note: Sure I could have opened and closed a file <em>inside</em> the <code>if</code> branch, but that is extremely inefficient once you have <em>many</em> things to be written. Recompiling the program is not possible, as it is still in the middle of some computation.</p>\n\n<p>Note2: the original question was asked the same question in a slightly more abstract way related to C++, and was tagged as such (that is why people in the comments suggesting <code>std::flush()</code>, which wouldn't help even if this was a C++ question). Well, I guess I made a major edit then.</p>\n\n<hr>\n\n<p>Somewhat related: <a href=\"https://stackoverflow.com/questions/19647997/will-data-written-via-write-be-flushed-to-disk-if-a-process-is-killed\">Will data written via write() be flushed to disk if a process is killed?</a></p>\n"}, {"tags": ["c", "assembly", "language-agnostic", "x86", "pipeline"], "comments": [{"owner": {"reputation": 2572, "user_id": 5784350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be79d2a9a367e3b66c42928c0b095a7?s=128&d=identicon&r=PG&f=1", "display_name": "Tommylee2k", "link": "https://stackoverflow.com/users/5784350/tommylee2k"}, "edited": false, "score": 0, "creation_date": 1463559116, "post_id": 37293788, "comment_id": 62111148, "body": "usually jumping to functions and back isn&#39;t the problem, while jumping on conditions is (&quot;branches&quot;) ... like each time you use if/while/for/etc... here&#39;s a pretty good posting about this: <a href=\"http://stackoverflow.com/questions/11227809/why-is-processing-a-sorted-array-faster-than-an-unsorted-array/11227902#11227902\" title=\"why is processing a sorted array faster than an unsorted array\">stackoverflow.com/questions/11227809/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1463560194, "post_id": 37293788, "comment_id": 62111854, "body": "In modern processors, branch misprediction is often cheaper than cache misses. While a compiler can prevent braches (and thus mispredictions) by inlining functions and unrolling loops, this greatly increases code size. While there used to be ways to help the branch predictor, <a href=\"http://stackoverflow.com/a/1851905\">they no longer work</a>."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1463565459, "post_id": 37293788, "comment_id": 62115349, "body": "The front end should be redirected a while before the back end notices anything, but of course if there is a cache miss due to the non-locality that mechanism is defeated a bit. On the other hand, inlining a lot causes capacity misses, so there&#39;s a trade-off there."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1463836770, "post_id": 37293788, "comment_id": 62240184, "body": "What kind of level of detail are you looking for in an explanation of how instruction caches work?  A link to a good wikipedia page for background?  I don&#39;t want to bloat my answer with a lot of generic how-caches-work stuff; it already covers a lot of ground.  Do you also require an explanation of how queues between pipeline stages hide bubbles?"}, {"owner": {"reputation": 4005, "user_id": 3719089, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf5a351c1e20c4ee67ab5627f09380c7?s=128&d=identicon&r=PG&f=1", "display_name": "ayushgp", "link": "https://stackoverflow.com/users/3719089/ayushgp"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1463893214, "post_id": 37293788, "comment_id": 62253478, "body": "Hey @PeterCordes It&#39;d be great if you could point me to some links that can let me understand your answer better. Right now your answer is overwhelming for me, since I asked this question after studying about Intel 8086 and ARM processors fundamentals and pipelining in it in my class."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1464026145, "post_id": 37293788, "comment_id": 62303566, "body": "@ayushgp: getting back to this answer and making some edits was on my to-do list.  You awarded the bounty, though, so does that mean you managed to research stuff on your own (e.g. from Agner Fog&#39;s excellent guides)?  If you found any other resources really helpful, feel free to suggest an edit to add links or extra text to my answer, or just leave a comment and I&#39;ll think about how to incorporate it.  I have a hard time knowing exactly what&#39;s confusing for a beginner, since I&#39;ve understood caches and pipelines for a while now.  Your perspective could help make this more useful for others."}, {"owner": {"reputation": 4005, "user_id": 3719089, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf5a351c1e20c4ee67ab5627f09380c7?s=128&d=identicon&r=PG&f=1", "display_name": "ayushgp", "link": "https://stackoverflow.com/users/3719089/ayushgp"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1464085029, "post_id": 37293788, "comment_id": 62327931, "body": "@PeterCordes seeing that many other people agreeing with you, I awarded you the bounty. I have started reading from Agner Fog&#39;s guides, but they too are somewhat difficult for a beginner. But I&#39;m slowly starting to get a hang of these topics. But finding good material to read in addition to those mentioned by you, about these areas is gruelling task. If you too could provide some more links, that I could understand, it&#39;d be quite helpful. Especially for caches, maybe a book or something similar to Fog&#39;s guides. Thanks!"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1464087789, "post_id": 37293788, "comment_id": 62329779, "body": "@ayushgp: A bounty is your rep to award as you see fit.  The criteria for awarding don&#39;t have to be the same as for an accepting answer.  If I were you, I&#39;d have held off on awarding it until you got me to add some beginner links to the answer. :P  Luckily, some searching found that Wikipedia&#39;s article on the classic RISC pipeline explains this in detail, with diagrams, so it didn&#39;t take too much extra work to expand my answer to deserve the bounty you awarded.  I also found a couple other things to link."}], "answers": [{"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 7, "last_activity_date": 1464087671, "last_edit_date": 1464087671, "creation_date": 1463567137, "answer_id": 37296833, "question_id": 37293788, "link": "https://stackoverflow.com/questions/37293788/functions-in-our-code-make-it-slower/37296833#37296833", "title": "Functions in our code make it slower?", "body": "<blockquote>\n  <p>So every time a function is called, the processor needs to throw away the instructions in the pipeline.</p>\n</blockquote>\n\n<p>No, everything after the decode stage is still good.  The CPU knows not to keep decoding after an unconditional branch (like a <code>jmp</code>, <code>call</code>, or <code>ret</code>).  Only the instructions that have been fetched but not yet decoded are ones that shouldn't run.  Until the target address is decoded from the instruction, there's nothing useful for beginning of the pipeline to do, so you get bubbles in the pipeline until the target address is known.  Decoding branch instructions as early as possible thus minimizes the penalty for taken branches.</p>\n\n<p>In the <a href=\"https://en.wikipedia.org/wiki/Classic_RISC_pipeline\" rel=\"nofollow\">classic RISC pipeline</a>, the stages are <code>IF ID EX MEM WB</code> (fetch, decode, execute, mem, write-back (results to registers).  So when ID decodes a branch instruction, the pipeline throws away the instruction currently being fetched in IF, and the instruction currently being decoded in ID (because it's the instruction after the branch).</p>\n\n<p>\"Hazard\" is the term for things that prevent a steady stream of instructions from going through the pipeline at one per clock.  Branches are a <a href=\"https://en.wikipedia.org/wiki/Classic_RISC_pipeline#Control_hazards\" rel=\"nofollow\">Control Hazard</a>.  (Control as in flow-control, as opposed to data.)</p>\n\n<p>If the branch target isn't in L1 I-cache, the pipeline will have to wait for instructions to streaming in from memory before the IF pipeline stage can produce a fetched instruction.  <a href=\"https://en.wikipedia.org/wiki/CPU_cache#Cache_miss\" rel=\"nofollow\">I-cache misses</a> always create a pipeline bubble.  Prefetching usually avoids this for non-branching code.</p>\n\n<hr>\n\n<p>More complex CPUs decode far enough ahead to detect branches and re-steer fetch soon enough to hide this bubble.  This may involve a queue of decoded instructions to hide the fetch bubble.</p>\n\n<p>Also, instead of actually decoding to detect branch instructions, the CPU can check every instruction address against a <a href=\"http://cseweb.ucsd.edu/~j2lau/cs141/week8.html\" rel=\"nofollow\">\"Branch Target Buffer\"</a> cache.  If you get a hit, you know the instruction is a branch even though you haven't decoded it yet.  The BTB also holds the target address, so you can start fetching from there right away (if it's an unconditional branch or your CPU supports speculative execution based on branch prediction).</p>\n\n<hr>\n\n<p><code>ret</code> is actually the harder case: the return address is in a register or on the stack, not encoded directly into the instruction.  It's an unconditional <strong>indirect</strong> branch.  Modern x86 CPUs maintain an internal return-address predictor stack, and perform very badly when you mis-match call/ret instructions.  E.g. <code>call label</code> / <code>label: pop ebx</code> is terrible for position-independent 32bit code to get EIP into EBX.  That will cause a mis-predict for the next 15 or so <code>ret</code>s up the call tree.</p>\n\n<p>I think I've read that <a href=\"http://cseweb.ucsd.edu/~j2lau/cs141/week8.html\" rel=\"nofollow\">a return-address predictor stack</a> is used by some other non-x86 microarchitectures.</p>\n\n<p>See <a href=\"http://agner.org/optimize\" rel=\"nofollow\">Agner Fog's microarchitecture pdf</a> to learn more about how x86 CPUs behave (also see the <a href=\"/questions/tagged/x86\" class=\"post-tag\" title=\"show questions tagged &#39;x86&#39;\" rel=\"tag\">x86</a> tag wiki), or read a computer architecture textbook to learn about <a href=\"https://en.wikipedia.org/wiki/Classic_RISC_pipeline\" rel=\"nofollow\">simple RISC pipelines</a>.</p>\n\n<p>For more about caches and memory (mostly focused on data caching / prefetching), see <a href=\"http://www.akkadia.org/drepper/cpumemory.pdf\" rel=\"nofollow\">Ulrich Drepper's What Every Programmer Should Know About Memory</a>.</p>\n\n<hr>\n\n<p>An unconditional branch is quite cheap, like usually a couple cycles at worst (not including I-cache misses).</p>\n\n<p>The big cost of a function call is when the compiler can't see the definition of the target function, and has to assume it clobbers all the call-clobbered registers in the calling convention.  (In x86-64 SystemV, all the float/vector registers, and about 8 integer registers.)  This requires either spilling to memory or keeping live data in call-preserved registers.  But that means the function has to save/restore those register to not break the caller.</p>\n\n<p>Inter-procedural optimization to let functions take advantage of knowing which registers other functions actually clobber, and which they don't, is something compilers can do within the same compilation unit.  Or even across compilation units with link-time whole-program optimization.  But it can't extend across dynamic-linking boundaries, because the compiler isn't allowed to make code that will break with a differently-compiled version of the same shared library.</p>\n\n<hr>\n\n<blockquote>\n  <p>Are there any ways in which compilers deal with this to reduce it?</p>\n</blockquote>\n\n<p>They inline small functions, or even large <code>static</code> functions that are only called once.</p>\n\n<p><a href=\"http://gcc.godbolt.org/#compilers:!((compiler:g530,options:&#39;-std%3Dgnu%2B%2B11+-O3+-Wall+-Wextra+-fverbose-asm+-march%3Dhaswell+-ffast-math+-lm&#39;,source:&#39;int+foo(void)+%7B+return+1%3B+%7D%0A%0Aint+bar(int+x)+%7B+return+foo()+%2B+x%3B%7D+&#39;)),filterAsm:(commentOnly:!t,directives:!t,intel:!t,labels:!t),version:3\" rel=\"nofollow\">e.g.</a></p>\n\n<pre><code>int foo(void) { return 1; }\n    mov     eax, 1    #,\n    ret\n\nint bar(int x) { return foo() + x;} \n    lea     eax, [rdi+1]      # D.2839,\n    ret\n</code></pre>\n\n<p>As @harold points out, overdoing it with inlining can cause cache misses, too, because it inflates your code size so much that not all of your hot code fits in cache.</p>\n\n<p>Intel SnB-family designs have a small but very fast uop cache that caches decoded instructions.  It only holds at most 1536 uops IIRC, in lines of 6 uops each.  Executing from uop cache instead of from the decoders shortens the branch-mispredict penalty from 19 to 15 cycles, IIRC (something like that, but those numbers are probably not actually correct for any specific uarch).  There's also a significant frontend throughput boost compared to the decoders, esp. for long instructions which are common in vector code.</p>\n"}], "owner": {"reputation": 4005, "user_id": 3719089, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf5a351c1e20c4ee67ab5627f09380c7?s=128&d=identicon&r=PG&f=1", "display_name": "ayushgp", "link": "https://stackoverflow.com/users/3719089/ayushgp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 1, "accepted_answer_id": 37296833, "answer_count": 1, "score": 4, "last_activity_date": 1464087671, "creation_date": 1463558993, "last_edit_date": 1463563695, "question_id": 37293788, "link": "https://stackoverflow.com/questions/37293788/functions-in-our-code-make-it-slower", "title": "Functions in our code make it slower?", "body": "<p>When we compile code and execute it, in assembly, in which our code gets converted, functions are stored in a non sequential manner. So every time a function is called, the processor needs to throw away the instructions in the pipeline. Doesn't this affect the performance of the program?</p>\n\n<p>PS: I'm not considering the time invested in developing such programs without functions. Purely on the performance level. Are there any ways in which compilers deal with this to reduce it?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 3, "creation_date": 1463558440, "post_id": 37293582, "comment_id": 62110745, "body": "Pointer to an array of 2 <code>int</code>s."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4087080"}, "edited": false, "score": 0, "creation_date": 1463559222, "post_id": 37293582, "comment_id": 62111221, "body": "I see now. This looks similar to how we declare function pointers."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1463559377, "post_id": 37293582, "comment_id": 62111317, "body": "Do a favor to your self, do not watch that video again."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4087080"}, "edited": false, "score": 0, "creation_date": 1463559478, "post_id": 37293582, "comment_id": 62111382, "body": "haccks, Why is that?"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 2, "creation_date": 1463564093, "post_id": 37293582, "comment_id": 62114406, "body": "Because 1) <code>a</code> is that video is an array not a pointer as he claims. 2) He is casting the value of <code>malloc</code> which is a bad practice. 3) He makes the explanation too complex for beginners and finally 4) He doesn&#39;t seem to be updated."}], "owner": {"user_type": "does_not_exist", "display_name": "user4087080"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "closed_date": 1463558473, "answer_count": 0, "score": 0, "last_activity_date": 1463572017, "creation_date": 1463558387, "last_edit_date": 1463572017, "question_id": 37293582, "link": "https://stackoverflow.com/questions/37293582/what-does-this-mean-int-arr2", "closed_reason": "Duplicate", "title": "What does this mean: int (*arr)[2]?", "body": "<p>I know that the following would be an array of two elements each holding a pointer to an integer:</p>\n\n<pre><code>int* arr[2];\n</code></pre>\n\n<p>But I don't really understand what this does:</p>\n\n<pre><code>int (*arr)[2];\n</code></pre>\n\n<p>This is from the video course on data structures I'm watching right now, but I don't find the lecturer's explanation as to how exactly you should understand this kind of syntax all that clear, to say the least. Here's the YouTube link: <a href=\"http://www.youtube.com/watch?v=69OzAUm_Mp0&amp;list=PLgj_V-ZKxRKrxgFyOutPJpoLFBaQMOpK-&amp;index=16#t=21m40s\" rel=\"nofollow\">Lecture 16: Dynamic Allocation</a> (just click on the link and it will automatically take you to the moment he talks about it)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 151870, "user_id": 1501794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/VyUv5.jpg?s=128&g=1", "display_name": "Rahul Tripathi", "link": "https://stackoverflow.com/users/1501794/rahul-tripathi"}, "edited": false, "score": 0, "creation_date": 1463558546, "post_id": 37293578, "comment_id": 62110807, "body": "Read this: <a href=\"http://web.eecs.utk.edu/~huangj/cs360/360/notes/Malloc1/lecture.html\" rel=\"nofollow noreferrer\">web.eecs.utk.edu/~huangj/cs360/360/notes/Malloc1/lecture.htm&zwnj;&#8203;l</a>"}, {"owner": {"reputation": 448, "user_id": 6271671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1d181593f8c690c09eccc6b002416c7?s=128&d=identicon&r=PG&f=1", "display_name": "george_ptr", "link": "https://stackoverflow.com/users/6271671/george-ptr"}, "edited": false, "score": 0, "creation_date": 1463558549, "post_id": 37293578, "comment_id": 62110812, "body": "there are many implementations, search for <code>doug lea malloc</code> as its the most popular"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1463558595, "post_id": 37293578, "comment_id": 62110840, "body": "Check <code>glibc</code> shource code."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1463558857, "post_id": 37293578, "comment_id": 62110994, "body": "If you want to understand memory allocators you should not attempt to read the source for an existing optimized system allocator. Instead I suggest you try to find out resources on how memory allocators work generally, learn the basics of memory allocators, and then step by step learn more about more advanced allocators until you can understand what your system allocator does. Or don&#39;t bother at all, and just know that &quot;it works&quot; and be happy with that."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6143533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85ed4a8d7fd76e3c70ee85c38847a418?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej D\u0142ugoszek ", "link": "https://stackoverflow.com/users/6143533/maciej-d%c5%82ugoszek"}, "is_accepted": false, "score": 0, "last_activity_date": 1463558773, "creation_date": 1463558773, "answer_id": 37293721, "question_id": 37293578, "link": "https://stackoverflow.com/questions/37293578/where-is-malloc-defined-in-code/37293721#37293721", "title": "Where is malloc defined in code?", "body": "<p><a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/malloc.html\" rel=\"nofollow\">http://pubs.opengroup.org/onlinepubs/009695399/functions/malloc.html</a>\nYou can find many of such definitions. You should try to google it first :)</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5773927"}, "is_accepted": false, "score": 2, "last_activity_date": 1463559253, "creation_date": 1463559253, "answer_id": 37293854, "question_id": 37293578, "link": "https://stackoverflow.com/questions/37293578/where-is-malloc-defined-in-code/37293854#37293854", "title": "Where is malloc defined in code?", "body": "<p>I recommend you to check the GNU C library: glibc.</p>\n\n<p><a href=\"http://www.gnu.org/software/libc/download.html\" rel=\"nofollow\">http://www.gnu.org/software/libc/download.html</a></p>\n\n<p>You can read the code there. In the <code>malloc</code> folder.</p>\n"}, {"tags": [], "owner": {"reputation": 784, "user_id": 4185477, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cvKOt.jpg?s=128&g=1", "display_name": "nikesh joshi", "link": "https://stackoverflow.com/users/4185477/nikesh-joshi"}, "is_accepted": false, "score": 1, "last_activity_date": 1463559394, "last_edit_date": 1495541763, "creation_date": 1463559394, "answer_id": 37293905, "question_id": 37293578, "link": "https://stackoverflow.com/questions/37293578/where-is-malloc-defined-in-code/37293905#37293905", "title": "Where is malloc defined in code?", "body": "<p><a href=\"https://stackoverflow.com/questions/6485586/code-for-malloc-and-free\">Code for malloc and free</a></p>\n\n<p><a href=\"https://code.woboq.org/userspace/glibc/malloc/malloc.c.html\" rel=\"nofollow noreferrer\">https://code.woboq.org/userspace/glibc/malloc/malloc.c.html</a></p>\n\n<p><a href=\"https://fossies.org/dox/glibc-2.23/malloc_8c_source.html\" rel=\"nofollow noreferrer\">https://fossies.org/dox/glibc-2.23/malloc_8c_source.html</a></p>\n\n<p>Above are link for code of malloc.</p>\n"}, {"tags": [], "owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "is_accepted": true, "score": 1, "last_activity_date": 1463567090, "last_edit_date": 1495535316, "creation_date": 1463566564, "answer_id": 37296619, "question_id": 37293578, "link": "https://stackoverflow.com/questions/37293578/where-is-malloc-defined-in-code/37296619#37296619", "title": "Where is malloc defined in code?", "body": "<p><code>malloc()</code> is defined in Standard Library, as far as all unix flavors are concerned, and probably more, since Standard Library belongs to the C library. Whichever system has a C library and C API implemented, one could at least expect it to have a malloc. </p>\n\n<p>Here are few more (beside above mentioned  GNU) links with source code:</p>\n\n<p><a href=\"http://cvsweb.netbsd.org/bsdweb.cgi/src/lib/libc/stdlib/malloc.c\" rel=\"nofollow noreferrer\">NET BSD malloc</a><BR>\n<a href=\"http://opensource.apple.com//source/Libc/Libc-594.1.4/gen/malloc.c\" rel=\"nofollow noreferrer\">OSX malloc</a></p>\n\n<p>Some legacy unix systems (IRIX for example), beside having Standard Library <code>malloc()</code> also used to have a <em>fast</em> <code>libmalloc</code> implementation.<BR><BR>\nPlease, also take a look at this <a href=\"https://stackoverflow.com/questions/6485586/code-for-malloc-and-free\">SO post</a>.</p>\n"}], "owner": {"reputation": 6389, "user_id": 1952109, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nUkea.jpg?s=128&g=1", "display_name": "User314159", "link": "https://stackoverflow.com/users/1952109/user314159"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 883, "favorite_count": 0, "closed_date": 1463685497, "accepted_answer_id": 37296619, "answer_count": 4, "score": 2, "last_activity_date": 1463567090, "creation_date": 1463558380, "last_edit_date": 1463559225, "question_id": 37293578, "link": "https://stackoverflow.com/questions/37293578/where-is-malloc-defined-in-code", "closed_reason": "Not suitable for this site", "title": "Where is malloc defined in code?", "body": "<p>I'm learning about malloc and understand what it's used for. I'm curious if malloc is written in C. If so, I'd like to see the code that defines it. Anyone know where I can find the definition of malloc?</p>\n\n<p>EDIT:</p>\n\n<p>I'm aware of this link (and many like it on google) <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/malloc.html\" rel=\"nofollow\">http://pubs.opengroup.org/onlinepubs/009695399/functions/malloc.html</a> but that's not the code definition of malloc.  I'm looking for the source file (if it exists) where malloc is defined.  Something that looks like this</p>\n\n<pre><code>void *malloc(size_t size) {\n   // code for how malloc is implemented\n}\n</code></pre>\n"}, {"tags": ["c", "char", "heap-memory"], "comments": [{"owner": {"reputation": 22608, "user_id": 618598, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/37b955736b6911e9bbfd417c6aede9ca?s=128&d=identicon&r=PG", "display_name": "Bernd Elkemann", "link": "https://stackoverflow.com/users/618598/bernd-elkemann"}, "edited": false, "score": 0, "creation_date": 1463557159, "post_id": 37292811, "comment_id": 62109969, "body": "The linked page&#39;s answers might be too technical because they mostly focus on segments and what the standards say. I suggest that you think about it this way: The character array is within &quot;load-time&quot; memory. You are just assigning a pointer to it. Load-time memory (however the compiler&amp;OS are implementing it) already exists at the time your program starts (and is filled with the appropriate data). It may be implemented this way: you click on an executable file, the OS copies the exe (including the char-array) into RAM, it does further setup, then starts the program, ..., you assign a pointer."}], "owner": {"reputation": 480, "user_id": 4462413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/KqFVA.png?s=128&g=1", "display_name": "Anish Sharma", "link": "https://stackoverflow.com/users/4462413/anish-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 1, "closed_date": 1463556467, "answer_count": 0, "score": 3, "last_activity_date": 1463567276, "creation_date": 1463556200, "last_edit_date": 1463567276, "question_id": 37292811, "link": "https://stackoverflow.com/questions/37292811/how-does-the-memory-allocation-happen-when-i-declare-a-char-pointer-and-then-lat", "closed_reason": "Duplicate", "title": "How does the memory allocation happen when I declare a char pointer and then later assign a string constant to it?", "body": "<p>Well I have seen declarations like</p>\n\n<pre><code>char strng[20]=\"\";\nstrcpy(strng,\"Some_String\");\n</code></pre>\n\n<p>Here it is well understood that when I declare <code>strng[20]</code>, i am reserving 20 memory locations(bytes) for this character array so I can copy any string to it which is almost 20 characters long.</p>\n\n<p>Also, a declaration like</p>\n\n<pre><code>char *strng;\nstrng=(char*)malloc(sizeof(char)*n);\n</code></pre>\n\n<p>Which will create a character pointer(2 bytes), and then memory is allocated via<code>malloc</code>  and the base address of the allocated memory is assigned to <code>strng</code>. Here,<code>n</code> bytes will be allocated.</p>\n\n<p>But, I have seen declarations like</p>\n\n<pre><code>char *srtng;\nstrng=\"Some_Very_Long_Text\";\n</code></pre>\n\n<p>So, How is memory being allocated in this case? Here I am declaring a char pointer(2 bytes) then assigning a string to it. If the size of this string is<code>n</code>, then how and where is this string stored? my pointer only holds its base address. when is memory allocated and how? I am not even using <code>malloc</code> here.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 3, "creation_date": 1463555840, "post_id": 37292556, "comment_id": 62109196, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a Minimal, Complete, and Verifiable example."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1463556023, "post_id": 37292556, "comment_id": 62109303, "body": "Time to learn how to use your debugger."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1463556085, "post_id": 37292556, "comment_id": 62109342, "body": "<code>DistDosPuntos(&amp;x1,&amp;x2,&amp;y1,&amp;y2,&amp;d);</code> --&gt; <code>DistDosPuntos(x1,x2,y1,y2,d);</code>"}, {"owner": {"reputation": 456, "user_id": 5276705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e8bd54c7b2823d28abc6dbee63f3e0b?s=128&d=identicon&r=PG", "display_name": "SKD", "link": "https://stackoverflow.com/users/5276705/skd"}, "edited": false, "score": 0, "creation_date": 1463556132, "post_id": 37292556, "comment_id": 62109370, "body": "Crashing? Your program should show errors while compiling."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 456, "user_id": 5276705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e8bd54c7b2823d28abc6dbee63f3e0b?s=128&d=identicon&r=PG", "display_name": "SKD", "link": "https://stackoverflow.com/users/5276705/skd"}, "edited": false, "score": 0, "creation_date": 1463556199, "post_id": 37292556, "comment_id": 62109415, "body": "@SKD I think no, because OP is using same names for pointers passed to function and global variables. So compiler does not complains due to the local and global scope."}, {"owner": {"reputation": 22202, "user_id": 696391, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VrUwT.jpg?s=128&g=1", "display_name": "samgak", "link": "https://stackoverflow.com/users/696391/samgak"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1463556347, "post_id": 37292556, "comment_id": 62109497, "body": "@LPs the call to menu1() in main() passes the wrong number of arguments"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 22202, "user_id": 696391, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VrUwT.jpg?s=128&g=1", "display_name": "samgak", "link": "https://stackoverflow.com/users/696391/samgak"}, "edited": false, "score": 0, "creation_date": 1463556557, "post_id": 37292556, "comment_id": 62109611, "body": "@samgak No, because of void menu1() is an <i>old-style</i>  function declaration that means: <b><i>function that takes an unspecified number of arguments of unspecified type</i></b>"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1463556822, "post_id": 37292556, "comment_id": 62109784, "body": "BTW start using different names for different variable: if you have a global float x1, the function declaration shouldn&#39;t be <code>void foo (float *x1)</code> but, e.g., <code>void  foot( float *local_x1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1463557454, "post_id": 37293016, "comment_id": 62110142, "body": "If you write something about local and global scopes of variables I&#39;ll upvote."}, {"owner": {"reputation": 583, "user_id": 6335763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b87a4dc1f3283f07064b3077fc7dcad4?s=128&d=identicon&r=PG&f=1", "display_name": "eyeApps LLC", "link": "https://stackoverflow.com/users/6335763/eyeapps-llc"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1463557718, "post_id": 37293016, "comment_id": 62110284, "body": "What do you think? The variables in the main function aren&#39;t global variables though, so I&#39;m not sure how to work global scope into it."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1463558196, "post_id": 37293016, "comment_id": 62110592, "body": "OP code have same definition of main variables at the top of code, with global scope. BTW your edit is good."}, {"owner": {"reputation": 51, "user_id": 6349251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vonCd.png?s=128&g=1", "display_name": "George Gibbs", "link": "https://stackoverflow.com/users/6349251/george-gibbs"}, "edited": false, "score": 0, "creation_date": 1463635128, "post_id": 37293016, "comment_id": 62149259, "body": "Thanks a lot, Indeed, I was taking the adress and passing it as a pointer. That did it, well, that and fixing other issues the code had. (I also was sending 4 values to a function that requested 5). as I said pretty dumb mistakes."}], "tags": [], "owner": {"reputation": 583, "user_id": 6335763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b87a4dc1f3283f07064b3077fc7dcad4?s=128&d=identicon&r=PG&f=1", "display_name": "eyeApps LLC", "link": "https://stackoverflow.com/users/6335763/eyeapps-llc"}, "is_accepted": false, "score": 3, "last_activity_date": 1463557689, "last_edit_date": 1463557689, "creation_date": 1463556811, "answer_id": 37293016, "question_id": 37292556, "link": "https://stackoverflow.com/questions/37292556/why-is-my-code-crashing/37293016#37293016", "title": "Why is my code crashing?", "body": "<p>I think you are taking the address of a pointer and passing as a pointer in this section:</p>\n\n<pre><code>printf(\"Y2:\\n\");\nscanf(\"%f\",y2);\n// wrong? x1,x2... are *float; Remove the &amp;s\nDistDosPuntos(&amp;x1,&amp;x2,&amp;y1,&amp;y2,&amp;d);\n</code></pre>\n\n<p>The arguments of the function menuLR are are variables with the names x1, etc. These are of type (float *). They happen to have the same name, (though different types), than the variables in your main function. That's why in one case you need no &amp;, whereas in the main function you do.</p>\n"}], "owner": {"reputation": 51, "user_id": 6349251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vonCd.png?s=128&g=1", "display_name": "George Gibbs", "link": "https://stackoverflow.com/users/6349251/george-gibbs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "closed_date": 1463559043, "answer_count": 1, "score": -8, "last_activity_date": 1463557689, "creation_date": 1463555426, "question_id": 37292556, "link": "https://stackoverflow.com/questions/37292556/why-is-my-code-crashing", "closed_reason": "Not suitable for this site", "title": "Why is my code crashing?", "body": "<p>I've got a pretty basic question, why is my code crashing? I'm learning to use pointers and I really don't know why the code crashes after I enter the values of x1,x2,y1 and y2 (this happens in case 3 of the second switch). I've looked everywhere and I can't find a reason. I need to send the values entered in function menuLR, case 3 to the function DistDosPuntos, an then return the values to menuLR,case 3.  </p>\n\n<p>Here's my code.</p>\n\n<p>Some of the code is in spanish, however it's not relevant to know how the code is working. In advance thanks for your help and patience, I know this is quite dumb, but I've tried several methods and haven't been able to either solve or understand the problem</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nvoid menu1();\nvoid menuLR();\nvoid DistDosPuntos();\n\nvoid menu1()\n{\nint a;\nfloat m,x1,x2,y1,y2,k,v,d;  \nprintf(\"MENU PRINCIPAL\\n\");\nprintf(\"1.- La l\u00ednea Recta \\n\");\nprintf(\"2.- La circunferencia \\n\");\nprintf(\"3.- Coordenaas Polares \\n\");\nprintf(\"4.- Salir\\n\");\nscanf(\"%d\",&amp;a); \n\nswitch(a)\n{\n    case 1: \n        menuLR(&amp;m,&amp;x1,&amp;x2,&amp;y1,&amp;y2,&amp;k,&amp;v,&amp;d);\n    break;\n\n    case 2 :\n    // ; \n    break;\n\n    case 3 :\n    //; \n    break;\n\n    case 4 :\n    break ;\n}\n\n}\n\nvoid menuLR (float *m,float*x1,float *x2,float *y1,float*y2,float*k,float         *v,float *d)\n{   \nint b;\n\n\nprintf(\"LA LINEA RECTA\\n\");\nprintf(\"1.- Ecuaci\u00f3n de la recta dada su puendiente y un punto de la misma \\n\");\nprintf(\"2.- Ecuaci\u00f3n de la recta que pasa por dos puntos\\n\");\nprintf(\"3.- Distancia entre dos puntos del plano \\n\");\nprintf(\"4.- Punto medio entre dos puntos del plano\\n\");\nprintf(\"5.- Per\u00edmetro y \u00e1rea de un tri\u00e1ngulo en un plano\\n\");\nprintf(\"6.- Regresar al men\u00fa principal\\n\");\nscanf(\"%d\",&amp;b); \n\nswitch (b)\n{\n    case 1 : \n    printf(\"Introduzca la pendiente de la recta m y el punto P1(x1,y1)\\n\");\n    printf(\"Introduzca m\\n\");\n    scanf(\"%f\",m);\n    printf(\"Introduzca x1\\n\");\n    scanf(\"%f\",x1);\n    printf(\"Introduzca y1\\n\");\n    scanf(\"%f\",y1);\n\n    printf(\"La ecuaci\u00f3n de la recta es:\\n\");\n    printf(\"y-y1 = m(x-x1)\\n\");\n    printf(\"Sustituyendo valores:\\n\");\n    printf(\"y-%f = %f (x-%f) \\n\" ,*y1,*m,*x1);\n    printf(\"Desarrollando y despejando:\\n\");\n    *k = ((*m)*(*x1));\n    printf(\"y-%f = %fx-%f)\\n\",*y1,*m,*k);\n    *v= -*k+*y1;\n    printf(\"y=%fx+(%f)\\n\",*m,*v);\n\n    printf(\"La ecuaci\u00f3n de la recta en la forma general 'y=mx+b' es:\\n\");\n    printf(\"y=%fx+(%f)\\n\",*m,*v);\n    break;\n\n    case 2 :\n\n\n\n    break;\n\n    case 3 :\n    printf(\"Introduzca el punto en el plano P1(X1,Y1)\\n\"); \n    printf(\"x1:\");\n    scanf(\"%f\",x1);\n    printf(\"y1:\");\n    scanf(\"%f\",y1);\n    printf(\"Introduzca el punto en el plano P2(X2,Y2)\\n\");\n    printf(\"X2:\\n\");\n    scanf(\"%f\",x2);\n    printf(\"Y2:\\n\");\n    scanf(\"%f\",y2);\n\n    DistDosPuntos(&amp;x1,&amp;x2,&amp;y1,&amp;y2,&amp;d);\n\n    printf(\"La distancia entre los puntos P1 y P2 es:\\n %f\",*d);\n    break;\n\n    case 4 :\n    // exit ; \n    break ;\n    }\n   }\n\nvoid DistDosPuntos(float *x1,float *x2, float *y1, float *y2,float *d)\n{\n    *d = sqrt(pow((*x2-*x1),2) + pow((*y2-*y1),2));\n}\n\n\nint main()\n{\nint a,b;\nfloat m,x1,y1,k,v,d,y2,x2;\nmenu1(&amp;b,&amp;x1,&amp;y1,&amp;x2,&amp;y2,&amp;m,&amp;k,&amp;v,&amp;d);\nDistDosPuntos(&amp;x1,&amp;x2,&amp;y1,&amp;y2,&amp;d);\n\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "ubuntu-14.04", "stdin", "nonblocking"], "comments": [{"owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "edited": false, "score": 3, "creation_date": 1463555367, "post_id": 37292474, "comment_id": 62108904, "body": "On what OS ? That changes the answer"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1463555783, "post_id": 37292474, "comment_id": 62109153, "body": "Post your code. Why using <code>fcntl</code> is not working?"}, {"owner": {"reputation": 289, "user_id": 4469300, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/129a68a0966af5db970841af561bbad5?s=128&d=identicon&r=PG&f=1", "display_name": "warwcat", "link": "https://stackoverflow.com/users/4469300/warwcat"}, "edited": false, "score": 0, "creation_date": 1463557569, "post_id": 37292474, "comment_id": 62110207, "body": "linux , the fcntl I used but when I pressed &#39;Q&#39; what is my key the scanf maybe don&#39;t nocice that continued make first operation&#39;s"}, {"owner": {"reputation": 812, "user_id": 674737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457ff81d6b0efaa3ac43e9d661a51fd7?s=128&d=identicon&r=PG", "display_name": "Dave Kok", "link": "https://stackoverflow.com/users/674737/dave-kok"}, "edited": false, "score": 0, "creation_date": 1463558101, "post_id": 37292474, "comment_id": 62110537, "body": "If you are on linux perhaps using a signal like SIGINT might be interesting. When you hit ctrl-c you will receive this signal."}, {"owner": {"reputation": 17723, "user_id": 733077, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/db1bf62fae51d5bafb8f1db7fb677176?s=128&d=identicon&r=PG", "display_name": "luser droog", "link": "https://stackoverflow.com/users/733077/luser-droog"}, "edited": false, "score": 0, "creation_date": 1463559179, "post_id": 37292474, "comment_id": 62111187, "body": "what do you expect <code>while(feof(stdin))</code> to do? If you need a <code>getch</code> function, see <a href=\"http://stackoverflow.com/questions/7410447/why-getch-returns-before-press-any-key/7411735?s=2|2.5036#7411735\">my answer here</a>."}, {"owner": {"reputation": 289, "user_id": 4469300, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/129a68a0966af5db970841af561bbad5?s=128&d=identicon&r=PG&f=1", "display_name": "warwcat", "link": "https://stackoverflow.com/users/4469300/warwcat"}, "edited": false, "score": 0, "creation_date": 1463571665, "post_id": 37292474, "comment_id": 62119574, "body": "I know about SIGINT but I need to use specific  key"}], "answers": [{"comments": [{"owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "edited": false, "score": 0, "creation_date": 1463558740, "post_id": 37293561, "comment_id": 62110923, "body": "Yes, that&#39;s the answer. And use fork to create a sub-process that do the job, while in the main process you check for input. If the user press a key, just kill the other process."}], "tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": false, "score": 2, "last_activity_date": 1463559650, "last_edit_date": 1463559650, "creation_date": 1463558345, "answer_id": 37293561, "question_id": 37292474, "link": "https://stackoverflow.com/questions/37292474/how-to-do-nonblocking-input-from-stdin-in-c/37293561#37293561", "title": "How to do nonblocking input from stdin in C", "body": "<p>Check out <a href=\"https://en.wikipedia.org/wiki/Ncurses\" rel=\"nofollow\">NCurses</a>, the go-to library for any kind of advanced terminal software.</p>\n\n<p>Among other things, it provides you with the tools to do \"raw\" terminal I/O -- using <code>int getch( void )</code>, made a non-blocking call via <code>int nodelay( WINDOWS * win, bool bf )</code>.</p>\n\n<p>This blocks:</p>\n\n<pre><code>#include &lt;ncurses.h&gt;\n\nint main()\n{\n    initscr();\n    printw( \"Press a key:\\n\" );\n    int c = getch();\n    endwin();\n}\n</code></pre>\n\n<p>This doesn't (returning <code>ERR</code> if there is no input pending):</p>\n\n<pre><code>#include &lt;ncurses.h&gt;\n\nint main()\n{\n    initscr();\n    printw( \"Press a key:\\n\" );\n    nodelay( stdscr, TRUE );\n    int c = getch();\n    endwin();\n}\n</code></pre>\n\n<p>Note that NCurses comes with its own set of I/O functions, which you will have to use instead of the <code>&lt;stdio.h&gt;</code> ones (check the <code>printw()</code> above).</p>\n"}, {"comments": [{"owner": {"reputation": 289, "user_id": 4469300, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/129a68a0966af5db970841af561bbad5?s=128&d=identicon&r=PG&f=1", "display_name": "warwcat", "link": "https://stackoverflow.com/users/4469300/warwcat"}, "edited": false, "score": 0, "creation_date": 1463593126, "post_id": 37294178, "comment_id": 62134643, "body": "almost solve my problem but if I use Exit(0) on func , after program execution console input is blocked"}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 2, "last_activity_date": 1463560220, "creation_date": 1463560220, "answer_id": 37294178, "question_id": 37292474, "link": "https://stackoverflow.com/questions/37292474/how-to-do-nonblocking-input-from-stdin-in-c/37294178#37294178", "title": "How to do nonblocking input from stdin in C", "body": "<p>An alternative to termios/ncurses using <a href=\"http://web.mit.edu/gnu/doc/html/rlman_2.html\" rel=\"nofollow\">GNU Readline</a>:</p>\n\n<pre><code>#include &lt;readline/readline.h&gt;\n#include &lt;stdio.h&gt;\n\nstatic int func(int count, int key)\n{\n    printf (\"key pressed: %c\\n\", key); /* exec your function */\n    return 0;\n}\n\nint main(void)\n{\n    char *line;\n\n    rl_bind_key('x', func); /* 'x' is the specific key */\n    line = readline (\"&gt; \");\n    printf(\"%s\\n\", line);\n    return 0;\n}\n</code></pre>\n\n<p>Compile using <code>-lreadline</code></p>\n"}], "owner": {"reputation": 289, "user_id": 4469300, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/129a68a0966af5db970841af561bbad5?s=128&d=identicon&r=PG&f=1", "display_name": "warwcat", "link": "https://stackoverflow.com/users/4469300/warwcat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4663, "favorite_count": 0, "closed_date": 1463560469, "answer_count": 2, "score": 2, "last_activity_date": 1463568380, "creation_date": 1463555192, "last_edit_date": 1463568380, "question_id": 37292474, "link": "https://stackoverflow.com/questions/37292474/how-to-do-nonblocking-input-from-stdin-in-c", "closed_reason": "Duplicate", "title": "How to do nonblocking input from stdin in C", "body": "<p>I have follow situation I have an program make an set of operations on a file continuously and I want, when a specific key is pressed, to stop and do another set of operations.</p>\n\n<p>For this I tryed use <code>scanf</code> of an character with </p>\n\n<p><code>fcntl(0, F_SETFL, O_NONBLOCK);</code> </p>\n\n<p>and </p>\n\n<p><code>while(feof(stdin))</code> </p>\n\n<p>but it doesn't work as expected. </p>\n\n<p>I have searched and in some places someone says to use <code>select</code> but I can't find how to use it.</p>\n\n<p>Anyone can advice me somehow? </p>\n\n<p>my main function to provide more information:</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n\n\n if(argc&gt;1){\n  char* password;\n  char* password2;\n\n  printf(\"Password? \");\n  password = get_password();\n  printf(\"Repita a password? \");\n  password2 = get_password();\n\n  if(strcmp(password,password2)!=0){\n   printf(\"Passwords diferentes!\\n\");\n   exit(1);\n  }\n\n  FILE *fptr;\n  fptr = fopen(\"./regist\", \"r\");\n  if(fptr == NULL) //if file does not exist, create it\n  {\n   fptr = fopen(\"./regist\", \"w\");\n  }\n  fclose(fptr);\n\n  if(find_username(argv[1])){\n   printf(\"Utilizador ja existe\\n\");\n   exit(1);\n  }\n  add_user_regist(argv[1],password);\n  printf(\"Utilizador %s adicionado.\\n\",argv[1]);\n  exit(0);\n }\n\n\n char readbuf[250];\n\n /* Create the FIFO if it does not exist */\n umask(0);\n mknod(FIFO_FILE, S_IFIFO|0666, 0);\n printf(\"Servidor iniciado.\\nEm modo de espera de mensagens\\n\");\n\n fcntl(0, F_SETFL, O_NONBLOCK);\n while(1){\n\n\n  char c = getchar();\n  if(c=='q' || c=='Q')\n    exit(0);//by now only goes out\n\n\n  fp = fopen(FIFO_FILE, \"r\");\n  fgets(readbuf, 250, fp);\n  fclose(fp);\n\n  if(readbuf[0]=='U')\n    user_access(readbuf);\n  else if(readbuf[0]=='W')\n    who_online(readbuf);\n  else if(readbuf[0]=='R'){\n    char* tmp;\n    strtok(readbuf,\":\");\n    tmp = strtok(NULL,\";\");\n    remove_online(tmp);\n    printf(\"# %s fez logout\\n\",tmp);\n  }\n  else if(readbuf[0]=='F'){\n    process_msg(readbuf);\n  }\n\n }\n return(0);\n}\n</code></pre>\n"}, {"tags": ["c", "heap-memory"], "comments": [{"owner": {"reputation": 328, "user_id": 4768463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02e9b7b066da2e7d2373ea09fcb63e33?s=128&d=identicon&r=PG&f=1", "display_name": "Aviv", "link": "https://stackoverflow.com/users/4768463/aviv"}, "edited": false, "score": 0, "creation_date": 1463553432, "post_id": 37291853, "comment_id": 62107833, "body": "Can you attach a link for this article?"}, {"owner": {"reputation": 10045, "user_id": 77542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2bb52913c4cebae8835bb50c03996d5?s=128&d=identicon&r=PG", "display_name": "Tordek", "link": "https://stackoverflow.com/users/77542/tordek"}, "edited": false, "score": 0, "creation_date": 1463553461, "post_id": 37291853, "comment_id": 62107853, "body": "<a href=\"http://www.learnme.in/malloc-c/\" rel=\"nofollow noreferrer\">learnme.in/malloc-c</a>"}, {"owner": {"reputation": 328, "user_id": 4768463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02e9b7b066da2e7d2373ea09fcb63e33?s=128&d=identicon&r=PG&f=1", "display_name": "Aviv", "link": "https://stackoverflow.com/users/4768463/aviv"}, "edited": false, "score": 0, "creation_date": 1463554705, "post_id": 37291853, "comment_id": 62108515, "body": "after reading carefully the man pages of <code>linux</code>, when using <code>setrlimit</code> to change the <code>data segment</code> size (which is heap, BSS and initialized data section), it seems that only the <code>soft limit</code> - which is the mentioned break point in the question - has any stated affect - e.g. return <code>ENOMEM</code>. However I can&#39;t find out which role the hardlimit - probably the <code>rlimit</code> mentioned in the question, plays."}], "answers": [{"comments": [{"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 1, "creation_date": 1587298857, "post_id": 37292410, "comment_id": 108450664, "body": "Except Windows doesn&#39;t overcommit memory. I heard it might do this for thread stacks to allow stack overflow exception handling, but it is totally different from what Linux and other OSes do: <code>malloc</code> won&#39;t allocate more that your RAM size + page file."}], "tags": [], "owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "is_accepted": true, "score": 13, "last_activity_date": 1587474753, "last_edit_date": 1587474753, "creation_date": 1463554985, "answer_id": 37292410, "question_id": 37291853, "link": "https://stackoverflow.com/questions/37291853/what-is-the-difference-between-mapped-region-and-unmapped-region-in-memory-space/37292410#37292410", "title": "What is the difference between mapped region and unmapped region in memory space?", "body": "<p>If memory addresses are 64 bits long, as in many modern computers, you have 18446744073709551616 possible memory addresses. (It depends on the processor architecture how many bits can actually be used, but addresses are stored using 64 bits.) That is more than 17 billion gigabytes, which is probably more memory than your computer actually has. So only some of those 17 billion gigabytes correspond to actual memory. For the rest of the addresses, the memory simply doesn't exist. There is no correspondence between the memory address and a memory location. Those addresses are, therefore, <em>unmapped</em>.</p>\n\n<p>That is the simple explanation. In reality, it's a bit more complicated. The memory addresses of your program are not the actual memory addresses of the memory chips, the <em>physical memory</em>, in your computer. Instead, it is <em>virtual memory</em>. Each process has its own memory space, that is, its own 18446744073709551616 addresses, and the memory addresses that a process uses are translated to physical memory addresses by the computer hardware. So one process may have stored some data at memory address 4711, which is actually stored in a real physical memory chip over here, and another process may have <em>also</em> stored some data at memory address 4711, but that is a completely different place, stored in a real physical memory chip over <em>there</em>. The process-internal virtual memory addresses are translated, or <em>mapped</em>, to actual physical memory, but not all of them. The rest, again, are <em>unmapped</em>.</p>\n\n<p>That is, of course, <em>also</em> a simplified explanation. You can use more virtual memory than the amount of physical memory in your computer. This is done by <em>paging</em>, that is, taking some chunks (called <em>pages</em>) of memory not being used right now, and storing them on disk until they are needed again. (This is also called \"swapping\", even if that term originally meant writing <em>all</em> the memory of a process to disk, not just parts of it.)</p>\n\n<p>And to complicate it even further, some modern operating systems such as Linux and MacOS X (but, I am told, not Windows) <em>overcommit</em> when they allocate memory. This means that they allocate more memory addresses than can be stored on the computer, even using the disk. For example, my computer here with 32 gigabytes of physical memory, and just 4 gigabytes available for paging out data to disk, can't possibly allow for more than 36 gigabyes of actual, usable, virtual memory. But malloc happily allocates more than one hundred <em>thousand</em> gigabytes. It is not until I actually try to store things in all that memory that it is connected to physical memory or disk. But it was part of my virtual memory space, so I would call that too <em>mapped</em> memory, even though it wasn't mapped <em>to</em> anything.</p>\n"}, {"comments": [{"owner": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "edited": false, "score": 1, "creation_date": 1499792267, "post_id": 37295265, "comment_id": 77055117, "body": "To clarify, in case it was misunderstood, <code>brk()</code> decreases the size of the heap and <code>sbrk()</code>."}, {"owner": {"reputation": 3543, "user_id": 6329118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a20c0ed8a82fd967952e2539203af9?s=128&d=identicon&r=PG&f=1", "display_name": "CWLiu", "link": "https://stackoverflow.com/users/6329118/cwliu"}, "reply_to_user": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "edited": false, "score": 0, "creation_date": 1499826078, "post_id": 37295265, "comment_id": 77068620, "body": "@RestlessC0bra, Thanks for it."}, {"owner": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "edited": false, "score": 0, "creation_date": 1499854914, "post_id": 37295265, "comment_id": 77083072, "body": "... and <code>sbrk()</code> increases it."}], "tags": [], "owner": {"reputation": 3543, "user_id": 6329118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a20c0ed8a82fd967952e2539203af9?s=128&d=identicon&r=PG&f=1", "display_name": "CWLiu", "link": "https://stackoverflow.com/users/6329118/cwliu"}, "is_accepted": false, "score": 1, "last_activity_date": 1463563164, "creation_date": 1463563164, "answer_id": 37295265, "question_id": 37291853, "link": "https://stackoverflow.com/questions/37291853/what-is-the-difference-between-mapped-region-and-unmapped-region-in-memory-space/37295265#37295265", "title": "What is the difference between mapped region and unmapped region in memory space?", "body": "<p>The mapped region in the heap means the virtual memory area that can be mapped together with physical memory. And the unmapped region indicates the unused virtual memory space which does not point to any physical memory.</p>\n\n<p>The boundary between mapped region for the heap and unmapped region is the system break point. As the <code>malloc()</code> is used to request some memory, the system break point would be moved to enlarge the mapped region. Linux system offeres <code>brk()</code> and <code>sbrk()</code> methods to increase and decrease the virtual memory address of the system break point.</p>\n"}], "owner": {"reputation": 325, "user_id": 5962381, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ea180246665cdc8bef129295de0debc8?s=128&d=identicon&r=PG&f=1", "display_name": "Hells Guardian", "link": "https://stackoverflow.com/users/5962381/hells-guardian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2444, "favorite_count": 2, "accepted_answer_id": 37292410, "answer_count": 2, "score": 9, "last_activity_date": 1587474753, "creation_date": 1463552985, "last_edit_date": 1463553661, "question_id": 37291853, "link": "https://stackoverflow.com/questions/37291853/what-is-the-difference-between-mapped-region-and-unmapped-region-in-memory-space", "title": "What is the difference between mapped region and unmapped region in memory space?", "body": "<p>I came across the following paragraph in <a href=\"http://www.learnme.in/malloc-c/\" rel=\"noreferrer\">an article about malloc</a>.</p>\n\n<blockquote>\n  <p>The heap is a continuous (in term of virtual addresses) space of\n  memory with three bounds:a starting point, a maximum limit (managed\n  through sys/ressource.h\u2019s functions getrlimit(2) and setrlimit(2)) and\n  an end point called the break. The break marks the end of the mapped\n  memory space, that is, the part of the virtual address space that has\n  correspondence into real memory.</p>\n  \n  <p><a href=\"https://i.stack.imgur.com/DrW9C.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/DrW9C.png\" alt=\"enter image description here\"></a></p>\n</blockquote>\n\n<p>I would like to better understand the concept of mapped region and unmapped region.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2127, "user_id": 923194, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d48e182893f9d17460dd2404c4072828?s=128&d=identicon&r=PG", "display_name": "Imran Ali", "link": "https://stackoverflow.com/users/923194/imran-ali"}, "edited": false, "score": 3, "creation_date": 1463552722, "post_id": 37291681, "comment_id": 62107472, "body": "I guess this <a href=\"http://stackoverflow.com/questions/1608318/is-bool-a-native-c-type\">SO Question</a> is relevant"}, {"owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "reply_to_user": {"reputation": 2127, "user_id": 923194, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d48e182893f9d17460dd2404c4072828?s=128&d=identicon&r=PG", "display_name": "Imran Ali", "link": "https://stackoverflow.com/users/923194/imran-ali"}, "edited": false, "score": 3, "creation_date": 1463552828, "post_id": 37291681, "comment_id": 62107510, "body": "I try to run this under <code>gcc</code> with <code>-std=c89</code> and it yields the same result."}, {"owner": {"reputation": 3768, "user_id": 1234693, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5f418c7981a6e42312b38cebd4f246e0?s=128&d=identicon&r=PG", "display_name": "Darrel Hoffman", "link": "https://stackoverflow.com/users/1234693/darrel-hoffman"}, "edited": false, "score": 0, "creation_date": 1463578590, "post_id": 37291681, "comment_id": 62124711, "body": "Doesn&#39;t C usually use the all-caps <code>TRUE</code> and <code>FALSE</code> instead?  I suppose it depends on the compiler, but I&#39;ve always had to use all-caps versions in C.  (Whereas C++, Java, C#, etc. have lower case <code>true</code> and <code>false</code>, but they also have built-in <code>bool</code>/<code>boolean</code> types, so that&#39;s another story.)"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 3768, "user_id": 1234693, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5f418c7981a6e42312b38cebd4f246e0?s=128&d=identicon&r=PG", "display_name": "Darrel Hoffman", "link": "https://stackoverflow.com/users/1234693/darrel-hoffman"}, "edited": false, "score": 0, "creation_date": 1463582318, "post_id": 37291681, "comment_id": 62127503, "body": "@DarrelHoffman: &quot;Usually&quot;, yes. That is to say, Standard C does not define <code>TRUE</code>, C11 has <code>_True</code> and <code>true</code>,  but many people had their own  <code>#define TRUE (1)</code> back in C89."}, {"owner": {"reputation": 2317, "user_id": 1858296, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c17e1958b8bae919289c0a71f96922f7?s=128&d=identicon&r=PG", "display_name": "Arturo Torres S&#225;nchez", "link": "https://stackoverflow.com/users/1858296/arturo-torres-s%c3%a1nchez"}, "reply_to_user": {"reputation": 18784, "user_id": 2057033, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/868c67cd2d96685d2ec0a8bd472a2f69?s=128&d=identicon&r=PG", "display_name": "Blackhole", "link": "https://stackoverflow.com/users/2057033/blackhole"}, "edited": false, "score": 1, "creation_date": 1463583189, "post_id": 37291681, "comment_id": 62128235, "body": "@Blackhole, from 15 to 0."}, {"owner": {"reputation": 23625, "user_id": 2868801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec5567811049b7ce8192be0bc0246d1?s=128&d=identicon&r=PG&f=1", "display_name": "dave_thompson_085", "link": "https://stackoverflow.com/users/2868801/dave-thompson-085"}, "edited": false, "score": 6, "creation_date": 1463591532, "post_id": 37291681, "comment_id": 62133757, "body": "Almost dupe but over a decade before SO/SE: <a href=\"http://c-faq.com/bool/bool2.html\" rel=\"nofollow noreferrer\">c-faq.com/bool/bool2.html</a> ."}, {"owner": {"reputation": 684, "user_id": 470868, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRpk2.png?s=128&g=1", "display_name": "Engineer", "link": "https://stackoverflow.com/users/470868/engineer"}, "edited": false, "score": 1, "creation_date": 1463633061, "post_id": 37291681, "comment_id": 62148650, "body": "That false is zero is canon, however true is generally thought of as &quot;not zero&quot;. Programmers being what they are however, we have all used 1 as &quot;not zero&quot; for our various reasons. You are encouraged not to trust a true to be exactly 1. While (0 == 0) is one in your example, something like (12 == 12) could just as easily have the value 12; also &quot;true&quot;."}, {"owner": {"reputation": 4604, "user_id": 3821804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d837f426da3935510c8c43f2a2c07f8d?s=128&d=identicon&r=PG&f=1", "display_name": "GingerPlusPlus", "link": "https://stackoverflow.com/users/3821804/gingerplusplus"}, "edited": false, "score": 0, "creation_date": 1463636490, "post_id": 37291681, "comment_id": 62149733, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/4276207/is-c-c-bool-type-always-guaranteed-to-be-0-or-1-when-typecasted-to-int\">Is C/C++ bool type always guaranteed to be 0 or 1 when typecast&#39;ed to int?</a>"}, {"owner": {"reputation": 9578, "user_id": 120917, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/cfb74e792db321ba120ffa223197f673?s=128&d=identicon&r=PG", "display_name": "SztupY", "link": "https://stackoverflow.com/users/120917/sztupy"}, "edited": false, "score": 0, "creation_date": 1463655539, "post_id": 37291681, "comment_id": 62161782, "body": "Related <a href=\"http://stackoverflow.com/questions/1252134/strange-c-boolean-casting-behaviour-true-true\" title=\"strange c boolean casting behaviour true true\">stackoverflow.com/questions/1252134/&hellip;</a>"}, {"owner": {"reputation": 15520, "user_id": 428857, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/J477b.png?s=128&g=1", "display_name": "TonyK", "link": "https://stackoverflow.com/users/428857/tonyk"}, "reply_to_user": {"reputation": 684, "user_id": 470868, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRpk2.png?s=128&g=1", "display_name": "Engineer", "link": "https://stackoverflow.com/users/470868/engineer"}, "edited": false, "score": 1, "creation_date": 1463667453, "post_id": 37291681, "comment_id": 62171128, "body": "@SiteNook: That is wrong. An expression of the form <code>x == y</code> is guaranteed to have value <code>0</code> or <code>1</code> if <code>x</code> and <code>y</code> are built-in types."}, {"owner": {"reputation": 569, "user_id": 3204536, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/569ffe1b5cbc11eccaf2771305fac99c?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff.Clark", "link": "https://stackoverflow.com/users/3204536/jeff-clark"}, "edited": false, "score": 0, "creation_date": 1463675060, "post_id": 37291681, "comment_id": 62176931, "body": "Do the good old #DEFINE TRUE 0;   :)"}, {"owner": {"reputation": 56306, "user_id": 592746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2139c4e5d44f7f2219dc936ae4a298?s=128&d=identicon&r=PG", "display_name": "Wayne", "link": "https://stackoverflow.com/users/592746/wayne"}, "edited": false, "score": 0, "creation_date": 1464114916, "post_id": 37291681, "comment_id": 62348194, "body": "The use of the royal &quot;we&quot; here makes it sound like the C language is something that existed in nature and was discovered by scientists, not something invented my man"}, {"owner": {"reputation": 111, "user_id": 654432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a3f8cbb62d19144c3e6fb6e42954b0?s=128&d=identicon&r=PG", "display_name": "Rob Craig", "link": "https://stackoverflow.com/users/654432/rob-craig"}, "reply_to_user": {"reputation": 15520, "user_id": 428857, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/J477b.png?s=128&g=1", "display_name": "TonyK", "link": "https://stackoverflow.com/users/428857/tonyk"}, "edited": false, "score": 0, "creation_date": 1464117145, "post_id": 37291681, "comment_id": 62349297, "body": "@TonyK - SiteNook&#39;s comment is true (false is zero, true is not zero), although the example used at the end may have incorrectly illustrated his point, which I take to be the result of an expression that is anything other than zero will also evaluate to true."}, {"owner": {"reputation": 15520, "user_id": 428857, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/J477b.png?s=128&g=1", "display_name": "TonyK", "link": "https://stackoverflow.com/users/428857/tonyk"}, "reply_to_user": {"reputation": 111, "user_id": 654432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a3f8cbb62d19144c3e6fb6e42954b0?s=128&d=identicon&r=PG", "display_name": "Rob Craig", "link": "https://stackoverflow.com/users/654432/rob-craig"}, "edited": false, "score": 0, "creation_date": 1464121221, "post_id": 37291681, "comment_id": 62351431, "body": "@Rob: &quot;something like (12 == 12) could just as easily have the value 12&quot;: try as I might, I can&#39;t interpret that in a way that makes it true."}, {"owner": {"reputation": 111, "user_id": 654432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a3f8cbb62d19144c3e6fb6e42954b0?s=128&d=identicon&r=PG", "display_name": "Rob Craig", "link": "https://stackoverflow.com/users/654432/rob-craig"}, "reply_to_user": {"reputation": 15520, "user_id": 428857, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/J477b.png?s=128&g=1", "display_name": "TonyK", "link": "https://stackoverflow.com/users/428857/tonyk"}, "edited": false, "score": 0, "creation_date": 1464272679, "post_id": 37291681, "comment_id": 62426124, "body": "@TonyK: Agreed, which is why I said his example incorrectly illustrates the point I think he was trying to make with the rest of his comment."}], "answers": [{"tags": [], "owner": {"reputation": 456, "user_id": 5276705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e8bd54c7b2823d28abc6dbee63f3e0b?s=128&d=identicon&r=PG", "display_name": "SKD", "link": "https://stackoverflow.com/users/5276705/skd"}, "is_accepted": false, "score": 0, "last_activity_date": 1463726363, "last_edit_date": 1463726363, "creation_date": 1463553019, "answer_id": 37291862, "question_id": 37291681, "link": "https://stackoverflow.com/questions/37291681/does-the-c-standard-explicitly-indicate-truth-value-as-0-or-1/37291862#37291862", "title": "Does the C standard explicitly indicate truth value as 0 or 1?", "body": "<p>It happened because of the Relational Operators in your <code>printf</code> statement.</p>\n\n<p>Operator <code>==</code> and operator <code>!=</code></p>\n\n<p>Since <code>(0 == 0)</code> holds true so, it gives a value <code>1</code> </p>\n\n<p>whereas, <code>(0 != 0)</code> doesn't hold true so, gives a value <code>0</code> .</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 20, "creation_date": 1463553804, "post_id": 37291888, "comment_id": 62108062, "body": "It seems to me that the question is about <code>0 == 0</code> and <code>0 != 0</code> etc., not the value of macros."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463553895, "post_id": 37291888, "comment_id": 62108115, "body": "@M.M; I can see two questions there."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 9, "creation_date": 1463553943, "post_id": 37291888, "comment_id": 62108135, "body": "I think that when he wrote <code>true</code> he meant &quot;the value of a true comparison&quot; or something, not the macro <code>true</code>"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "edited": false, "score": 1, "creation_date": 1463557625, "post_id": 37291888, "comment_id": 62110236, "body": "@KevinDong; Yes, C99 draft has similar paragraph."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 1, "creation_date": 1463573914, "post_id": 37291888, "comment_id": 62121256, "body": "@haccks: you can say about it without hesitate &quot;identical&quot; I just pciked your quote up since I was too lazy to look up by paragraph since I refer to c99 when ever needed. And I was able to find it by just searching it via <code>ctrl</code>+<code>f</code> ;)"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 1, "creation_date": 1463574925, "post_id": 37291888, "comment_id": 62121986, "body": "@Zaibis; Thanks. I don&#39;t have copy of C99, but I know it is mentioned in there."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1463676066, "post_id": 37291888, "comment_id": 62177544, "body": "&quot;For any pair of operands, exactly one of the relations is true.&quot; wait, really? Even for <code>double</code>?  I&#39;m pretty sure that they can both return false in C++ when comparing two <code>NaN</code>s"}, {"owner": {"reputation": 466742, "user_id": 224671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c90de868a7e95d75bdfd6a906dfedac7?s=128&d=identicon&r=PG", "display_name": "kennytm", "link": "https://stackoverflow.com/users/224671/kennytm"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 2, "creation_date": 1463758915, "post_id": 37291888, "comment_id": 62216979, "body": "@MooingDuck: <code>NaN == NaN</code> is false and <code>NaN != NaN</code> is true. There is no problem with that statement."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": true, "score": 99, "last_activity_date": 1592328392, "last_edit_date": 1592328392, "creation_date": 1463553087, "answer_id": 37291888, "question_id": 37291681, "link": "https://stackoverflow.com/questions/37291681/does-the-c-standard-explicitly-indicate-truth-value-as-0-or-1/37291888#37291888", "title": "Does the C standard explicitly indicate truth value as 0 or 1?", "body": "<blockquote>\n  <p>Does the C standard explicitly indicate the truth values of <code>true</code> and <code>false</code> as <code>0</code> and <code>1</code> respectively?  </p>\n</blockquote>\n\n<p>The C standard defines <code>true</code> and <code>false</code> as macros in <code>stdbool.h</code> which expand to <code>1</code> and <code>0</code> respectively.  </p>\n\n<p>C11-\u00a77.18:  </p>\n\n<blockquote>\n  <p>The remaining three macros are suitable for use in <code>#if</code> preprocessing directives. They are  </p>\n\n<pre><code>true\n</code></pre>\n  \n  <p>which expands to the integer constant <code>1</code>,  </p>\n\n<pre><code>false\n</code></pre>\n  \n  <p>which expands to the integer constant <code>0</code> [...]    </p>\n</blockquote>\n\n<p>For the operators <code>==</code> and <code>!=</code> , standard says</p>\n\n<p>C11-\u00a76.5.9/3:</p>\n\n<blockquote>\n  <p>The <code>==</code> (equal to) and <code>!=</code> (not equal to) operators are analogous to the relational operators except for their lower precedence.<sup>108)</sup> Each of the operators yields <code>1</code> if the specified relation is true and <code>0</code> if it is false. The result has type <code>int</code>. For any pair of operands, exactly one of the relations is true.  </p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1463553876, "post_id": 37292097, "comment_id": 62108100, "body": "note that <code>||</code>, <code>==</code>, <code>!=</code> etc. yield <code>int</code>, not a boolean type"}, {"owner": {"reputation": 2145, "user_id": 4849573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/096fb4358973b1d406f85d2b0eeec9c2?s=128&d=identicon&r=PG&f=1", "display_name": "ckruczek", "link": "https://stackoverflow.com/users/4849573/ckruczek"}, "edited": false, "score": 2, "creation_date": 1463554123, "post_id": 37292097, "comment_id": 62108228, "body": "I vote this question for the correct one. For me the question is also about the relational operators and not the macros."}, {"owner": {"reputation": 154, "user_id": 3856245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xBB3z.jpg?s=128&g=1", "display_name": "robert bristow-johnson", "link": "https://stackoverflow.com/users/3856245/robert-bristow-johnson"}, "edited": false, "score": 0, "creation_date": 1463582271, "post_id": 37292097, "comment_id": 62127474, "body": "&quot;In the test part of <code>if</code>, <code>while</code>, <code>for</code>, etc, &quot;true&quot; just means &quot;non-zero&quot;.&quot;  This is the salient part of the answer and is, in my opinion, an unfortunate choice of Dennis Ritchie from long ago. Anyone who has written functions that return error codes as the return value generally have <code>#define noErr 0</code> and any non-zero error code is an error. And then the problem is the simplicity and beauty of <code>if ( ready_to_do_something() ){do_something();}</code>  doesn&#39;t work. It has to be <code>if ( !not_ready_to_do_something() ){do_something();}</code> &quot;There are many falsehoods, but only one truth.&quot; TRUE should be 0."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1463590853, "post_id": 37292097, "comment_id": 62133368, "body": "Out of curiosity, how did the first drafts of C rules specify the behavior of &quot;&amp;&amp;&quot; and &quot;||&quot; in the case where the operands had values other than 0 or 1?  The text you quote says &quot;logical expressions&quot; connected by &amp;&amp; and ||, but what if those operators connect things other than logical expressions?"}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1463620465, "post_id": 37292097, "comment_id": 62145688, "body": "@supercat, K&amp;R states much the same as C89. K&amp;R A17.4, for example: <code>The &amp;&amp; operator ... returns 1 if both its operands compare unequal to zero, 0 otherwise)</code>. I&#39;ll add that to the answer."}, {"owner": {"reputation": 3702, "user_id": 1059969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JKhUL.jpg?s=128&g=1", "display_name": "Agent_L", "link": "https://stackoverflow.com/users/1059969/agent-l"}, "reply_to_user": {"reputation": 154, "user_id": 3856245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xBB3z.jpg?s=128&g=1", "display_name": "robert bristow-johnson", "link": "https://stackoverflow.com/users/3856245/robert-bristow-johnson"}, "edited": false, "score": 0, "creation_date": 1463650327, "post_id": 37292097, "comment_id": 62158073, "body": "@robertbristow-johnson The problem is you confusing <b>error</b> code with <b>success</b> code, not Ritchie&#39;s choice. I had seen numerous similar situations with variables such as <code>isHidden</code> vs <code>isVisible</code> and it has nothing to do with the underlying type. And the verbose solution is <code>if(ready_to_do_something() == STATUS_READY)</code> anyway. In higher level languages you can define implicit casts to <code>bool</code> - but it doesn&#39;t mean that you should."}, {"owner": {"reputation": 154, "user_id": 3856245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xBB3z.jpg?s=128&g=1", "display_name": "robert bristow-johnson", "link": "https://stackoverflow.com/users/3856245/robert-bristow-johnson"}, "edited": false, "score": 0, "creation_date": 1463675588, "post_id": 37292097, "comment_id": 62177258, "body": "well, i still think that a language could be constructed so that if integers are used for <code>boolean</code> that the notion of <i>only one truth and many falsehoods</i> would appear congruent to <i>only one zero and many non-zeros</i>.  then when logical statements are implemented, they are implemented with the value of TRUE to be 0 and the value of FALSE to be -1 (all bits set to one).  but in testing, <b>anything</b> non-zero would be FALSE.  i just think that could be done.  and truth == success."}, {"owner": {"reputation": 455, "user_id": 2158499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/807f9d3dd7b288a186f00400adfa0ef7?s=128&d=identicon&r=PG", "display_name": "sdenham", "link": "https://stackoverflow.com/users/2158499/sdenham"}, "edited": false, "score": 0, "creation_date": 1463679960, "post_id": 37292097, "comment_id": 62179600, "body": "Do you know if the stipulation that the logical, relational and comparison operators yield 1 for true was in the first edition of K&amp;R? My recollection is that it could not be relied on, but that may have just been a conservative generalization on my part."}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "reply_to_user": {"reputation": 455, "user_id": 2158499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/807f9d3dd7b288a186f00400adfa0ef7?s=128&d=identicon&r=PG", "display_name": "sdenham", "link": "https://stackoverflow.com/users/2158499/sdenham"}, "edited": false, "score": 1, "creation_date": 1463707157, "post_id": 37292097, "comment_id": 62190543, "body": "@sdenham, yes. In the <i>earliest</i> copy of K&amp;R I have (first edition, print run 14, one so early that it mentions the hardware characteristics of four typical machines, the PDP-11, Honeywell-6000, IBM-370 and Interdata-8/32), <code>A.7.6&#47;7&#47;10&#47;11</code> (relational/equality/logical-and/logical-or) all specify that it gives 0 or 1 as a result. Have updated answer to include that."}], "tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 23, "last_activity_date": 1463707129, "last_edit_date": 1592644375, "creation_date": 1463553829, "answer_id": 37292097, "question_id": 37291681, "link": "https://stackoverflow.com/questions/37291681/does-the-c-standard-explicitly-indicate-truth-value-as-0-or-1/37292097#37292097", "title": "Does the C standard explicitly indicate truth value as 0 or 1?", "body": "<p>There are two areas of the standard you need to be aware with when dealing with Boolean values (by which I mean true/false values rather than the specific C <code>bool/_Bool</code> type) in C.</p>\n<p>The first has to do with the <em>result</em> of expressions and can be found in various portions of <code>C11 6.5 Expressions</code> (relational and equality operators, for example) . The bottom line is that, whenever a Boolean value is generated by an expression, it ...</p>\n<blockquote>\n<p>... yields 1 if the specified relation is true and 0 if it is false. The result has type int.</p>\n</blockquote>\n<p>So, yes, the result of any Boolean-generating expression will be one for true, or zero for false. This matches what you will find in <code>stdbool.h</code> where the standard macros <code>true</code> and <code>false</code> are defined the same way.</p>\n<p>Keep in mind however that, following the robustness principle of &quot;be conservative in what you send, liberal in what you accept&quot;, the interpretation of <em>integers</em> in the Boolean context is somewhat more relaxed.</p>\n<p>Again, from various parts of <code>6.5</code>, you'll see language like:</p>\n<blockquote>\n<p>The <code>||</code> operator shall yield 1 if either of its operands <em>compare unequal to 0; otherwise, it yields 0.</em> The result has type int.</p>\n</blockquote>\n<p>From that (and other parts), it's obvious that zero is considered false and <em>any</em> other value is true.</p>\n<hr />\n<p>As an aside, the language specifying what value are used for Boolean generation and interpretation also appear back in C99 and C89 so they've been around for quite some time. Even K&amp;R (ANSI-C second edition <em>and</em> the first edition) specified that, with text segments such as:</p>\n<blockquote>\n<p>Relational expressions like <code>i &gt; j</code> and logical expressions connected by <code>&amp;&amp;</code> and <code>||</code> are defined to have value <code>1</code> if true, and <code>0</code> if false.</p>\n<p>In the test part of <code>if</code>, <code>while</code>, <code>for</code>, etc, &quot;true&quot; just means &quot;non-zero&quot;.</p>\n<p>The <code>&amp;&amp;</code> operator ... returns 1 if both its operands compare unequal to zero, 0 otherwise.</p>\n<p>The <code>||</code> operator ... returns 1 if either its operands compare unequal to zero, and 0 otherwise.</p>\n</blockquote>\n<p>The macros in <code>stdbool.h</code> appear back in C99 as well, but not in C89 or K&amp;R since that header file did not exist at that point.</p>\n"}, {"tags": [], "owner": {"reputation": 466742, "user_id": 224671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c90de868a7e95d75bdfd6a906dfedac7?s=128&d=identicon&r=PG", "display_name": "kennytm", "link": "https://stackoverflow.com/users/224671/kennytm"}, "is_accepted": false, "score": 51, "last_activity_date": 1463554837, "last_edit_date": 1463554837, "creation_date": 1463554000, "answer_id": 37292153, "question_id": 37291681, "link": "https://stackoverflow.com/questions/37291681/does-the-c-standard-explicitly-indicate-truth-value-as-0-or-1/37292153#37292153", "title": "Does the C standard explicitly indicate truth value as 0 or 1?", "body": "<p>It is not explicitly indicated in C11. All <strong>language-level operations</strong> will return 1 as truthy (and accept any nonzero including NaN as true).</p>\n\n<ul>\n<li>If you concern about <code>_Bool</code>, then true must be 1 because the standard only require it to hold 0 and 1. (\u00a76.2.5/2). </li>\n<li>Also in <code>&lt;stdbool.h&gt;</code> the macro <code>true</code> expands to <code>1</code> (\u00a77.18/3)</li>\n<li><code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code> and <code>&gt;=</code> return 0 or 1 (\u00a76.5.8/6, \u00a76.5.9/3).</li>\n<li><code>!</code>, <code>&amp;&amp;</code> and <code>||</code> return 0 or 1 (\u00a76.5.3.3/5, \u00a76.5.13/3, \u00a76.5.14/3)</li>\n<li><code>defined</code> expands to 0 or 1 (\u00a76.10.1/1)</li>\n</ul>\n\n<p>But all <strong>standard library functions</strong> e.g. <code>islower</code> just say \"nonzero\" for truthy (e.g. \u00a77.4.1/1, \u00a77.17.5.1/3, \u00a77.30.2.1/1, \u00a77.30.2.2.1/4).</p>\n\n<hr>\n\n<blockquote>\n  <p><strong>\u00a76.2.5/2</strong>: An object declared as type <code>_Bool</code> is large enough to store the values 0 and 1.</p>\n  \n  <p><strong>\u00a76.5.5.3/5</strong>: The result of the logical negation operator <code>!</code> is 0 if the value of its operand compares unequal to 0, 1 if the value of its operand compares equal to 0. \u2026</p>\n  \n  <p><strong>\u00a76.5.8/6</strong>: Each of the operators <code>&lt;</code> (less than), <code>&gt;</code> (greater than), <code>&lt;=</code> (less than or equal to), and <code>&gt;=</code> (greater than or equal to) shall yield 1 if the specified relation is true and 0 if it is false.<sup>107) \u2026</p>\n  \n  <p><strong>\u00a76.5.9/3</strong>: The <code>==</code> (equal to) and <code>!=</code> (not equal to) operators are analogous to the relational operators except for their lower precedence.108)</sup> Each of the operators yields 1 if the specified relation is true and 0 if it is false. \u2026</p>\n  \n  <p><strong>\u00a76.5.13/3</strong>: The <code>&amp;&amp;</code> operator shall yield 1 if both of its operands compare unequal to 0; \u2026</p>\n  \n  <p><strong>\u00a76.5.14/3</strong>: The <code>||</code> operator shall yield 1 if either of its operands compare unequal to 0; \u2026</p>\n  \n  <p><strong>\u00a76.10.1/1</strong>: \u2026 it may contain unary operator expressions of the form \u2014 <code>defined identifier</code> \u2014 or \u2014 <code>defined ( identifier )</code> \u2014 which evaluate to 1 if \u2026 </p>\n  \n  <p><strong>\u00a77.4.1 (Character classification functions)/1</strong>: The functions in this subclause return nonzero (true) if and only if \u2026</p>\n  \n  <p><strong>\u00a77.18/3</strong>: The remaining three macros are suitable for use in <code>#if</code> preprocessing directives. They are \u2014 <code>true</code> \u2014 which expands to the integer constant 1, \u2026</p>\n  \n  <p><strong>\u00a77.17.5.1/3</strong>: The <code>atomic_is_lock_free</code> generic function returns nonzero (true) if and only if the object\u2019s operations are lock-free. \u2026</p>\n  \n  <p><strong>\u00a77.30.2.1 (Wide character classification functions)/1</strong>: The functions in this subclause return nonzero (true) if and only if \u2026</p>\n  \n  <p><strong>\u00a77.30.2.2.1/4</strong>: The <code>iswctype</code> function returns nonzero (true) if and only if \u2026</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 30517, "user_id": 774499, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sju2a.jpg?s=128&g=1", "display_name": "David Hammen", "link": "https://stackoverflow.com/users/774499/david-hammen"}, "edited": false, "score": 1, "creation_date": 1463565553, "post_id": 37292332, "comment_id": 62115417, "body": "<code>sizeof(bool)</code> is implementation specific in C++. See <a href=\"http://stackoverflow.com/questions/4897844/is-sizeofbool-defined\">stackoverflow.com/questions/4897844/is-sizeofbool-defined</a> ."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 30517, "user_id": 774499, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sju2a.jpg?s=128&g=1", "display_name": "David Hammen", "link": "https://stackoverflow.com/users/774499/david-hammen"}, "edited": false, "score": 0, "creation_date": 1463568258, "post_id": 37292332, "comment_id": 62117297, "body": "@DavidHammen Just as sizeof(0 == 0) is implementation-defined too. It is just an example."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1463590710, "post_id": 37292332, "comment_id": 62133291, "body": "I thought C did change the rules for Boolean types.  Other kinds of uintN types (including many older compilers&#39; &quot;bit&quot; types) store the lower N bits of a value and ignore any higher bits, while the new Boolean types effectively &quot;or&quot; together all the bits."}, {"owner": {"reputation": 283, "user_id": 4539511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/964d5a8e60fb4569d232d9cfcb7c67a0?s=128&d=identicon&r=PG", "display_name": "Mathieu K.", "link": "https://stackoverflow.com/users/4539511/mathieu-k"}, "edited": false, "score": 1, "creation_date": 1463595630, "post_id": 37292332, "comment_id": 62135982, "body": "Should that be <code>if(ptr != NULL)</code>, or perhaps <code>if(!ptr)</code>?"}, {"owner": {"reputation": 1255, "user_id": 797152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589f919cfbda3d80cd71fa93e65afb10?s=128&d=identicon&r=PG", "display_name": "aja", "link": "https://stackoverflow.com/users/797152/aja"}, "edited": false, "score": 1, "creation_date": 1463695554, "post_id": 37292332, "comment_id": 62187421, "body": "<code>if(c == &#39;\\0&#39;)</code> lends itself to the particularly common beginners mistake of coding <code>if(c = &#39;\\0&#39;)</code>, so I avoid it. Agreed, <code>if(c)</code> is bad...it should be, for example, <code>if(valveIsOpen)</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1255, "user_id": 797152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589f919cfbda3d80cd71fa93e65afb10?s=128&d=identicon&r=PG", "display_name": "aja", "link": "https://stackoverflow.com/users/797152/aja"}, "edited": false, "score": 0, "creation_date": 1463725845, "post_id": 37292332, "comment_id": 62195947, "body": "@aja = vs == is a dead horse argument, how to handle that bug was solved in the 80s. Any decent compiler can nowadays warn for assignment inside conditions, enable that warning, end of story. Don&#39;t let 1980s bugs affect how you write code in 2016. <code>if(something)</code> is regarded as good style if &quot;something&quot; is a boolean variable though. Essentially you should treat all conditions as if they were functions requiring a bool parameter."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 10, "last_activity_date": 1463555082, "last_edit_date": 1463555082, "creation_date": 1463554715, "answer_id": 37292332, "question_id": 37291681, "link": "https://stackoverflow.com/questions/37291681/does-the-c-standard-explicitly-indicate-truth-value-as-0-or-1/37292332#37292332", "title": "Does the C standard explicitly indicate truth value as 0 or 1?", "body": "<p>You are mixing up a lot of different things: control statements, operators and boolean types. Each have their own rules.</p>\n\n<p>Control statements work like for example the <code>if</code> statement, C11 6.4.8.1:</p>\n\n<blockquote>\n  <p>In both forms, the first substatement is executed if the expression\n  compares unequal to 0.</p>\n</blockquote>\n\n<p><code>while</code>, <code>for</code> etc have the same rule. This has nothing to do with \"true\" or \"false\".</p>\n\n<p>As for operators that are supposedly yielding a boolean result, they are actually yielding an <code>int</code> with value 1 or 0. For example the equality operators, C11 6.5.9:</p>\n\n<blockquote>\n  <p>Each of the operators yields 1 if the specified relation is true and 0\n  if it is false</p>\n</blockquote>\n\n<p>All of the above is because C did not have a boolean type until the year 1999, and even when it did get one, the above rules weren't changed. So unlike most other programming languages where statements and operators yield a boolean type (like C++ and Java), they just yield an <code>int</code>, with a value zero or not zero. For example, <code>sizeof(1==1)</code> will give 4 in C but 1 in C++.</p>\n\n<p>The actual boolean type in C is named <code>_Bool</code> and requires a modern compiler. The header <code>stdbool.h</code> defines macros <code>bool</code>, <code>true</code> and <code>false</code>, that expand to <code>_Bool</code>, <code>1</code> and <code>0</code> respectively (for compatibility with C++).</p>\n\n<hr>\n\n<p>It is however considered good programming practice to treat control statements and operators as if they actually required/yielded a boolean type. Certain coding standards like MISRA-C recommend such practice. That is:</p>\n\n<p><code>if(ptr == NULL)</code> instead of <code>if(ptr)</code>. </p>\n\n<p><code>if((data &amp; mask) != 0)</code> instead of <code>if(data &amp; mask)</code>.</p>\n\n<p>The aim of such style is to increase type safety with the aid of static analysis tools, which in turn reduces bugs. Arguably, this style is only meaningful if you do use static analysers. Though in some cases it leads to more readable, self-documenting code, for example </p>\n\n<pre><code>if(c == '\\0') \n</code></pre>\n\n<p>Good, the intent is clear, the code is self-documenting.</p>\n\n<p>versus</p>\n\n<pre><code>if(c) \n</code></pre>\n\n<p>Bad. Could mean anything, and we have to go look for the type of <code>c</code> to understand the code. Is it an integer, a pointer or a character?</p>\n"}, {"comments": [{"owner": {"reputation": 1155, "user_id": 962394, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/97268298c366b07e5556567639105ee1?s=128&d=identicon&r=PG", "display_name": "codeshot", "link": "https://stackoverflow.com/users/962394/codeshot"}, "edited": false, "score": 0, "creation_date": 1567542407, "post_id": 37305231, "comment_id": 101991572, "body": "how can ! change all the 0&#39;s to 1&#39;s and still produce 0 for !5 ?"}, {"owner": {"reputation": 124, "user_id": 2105716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e1119bce4d224b9c70b3e118762457?s=128&d=identicon&r=PG", "display_name": "Pegasus Epsilon", "link": "https://stackoverflow.com/users/2105716/pegasus-epsilon"}, "reply_to_user": {"reputation": 1155, "user_id": 962394, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/97268298c366b07e5556567639105ee1?s=128&d=identicon&r=PG", "display_name": "codeshot", "link": "https://stackoverflow.com/users/962394/codeshot"}, "edited": false, "score": 0, "creation_date": 1598643217, "post_id": 37305231, "comment_id": 112536198, "body": "@codeshot It can&#39;t. But the point he&#39;s making is that not all languages treat the operand of ! as a boolean. Some treat ! as C&#39;s ~ -- that is, a bitwise complement. In which case, determining the resulting value requires knowing the type of the variable in the first place, so !(uint32_t)5 would be 4,294,967,290. But !0 is still 4,294,967,295, and 4,294,967,295 is truthy."}], "tags": [], "owner": {"reputation": 1018, "user_id": 5921289, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uap0h.jpg?s=128&g=1", "display_name": "Russell Hankins", "link": "https://stackoverflow.com/users/5921289/russell-hankins"}, "is_accepted": false, "score": 4, "last_activity_date": 1463588751, "creation_date": 1463588751, "answer_id": 37305231, "question_id": 37291681, "link": "https://stackoverflow.com/questions/37291681/does-the-c-standard-explicitly-indicate-truth-value-as-0-or-1/37305231#37305231", "title": "Does the C standard explicitly indicate truth value as 0 or 1?", "body": "<p>I've programmed in many languages. I've seen true be 1 or -1 depending on the language. The logic behind true being 1 was that a bit was either a 0 or 1. The logic behind true being -1 was that the ! operator was a one's complement. It changed all the 1's to 0's and all the 0's to 1's in an int. So, for an int, !0 = -1 and !(-1) = 0. This has tripped me up enough that I don't compare something to be == true, but instead compare it to be != false. That way, my programming style works in every language. So my answer is to not worry about it, but program so that your code works correctly either way.</p>\n"}, {"comments": [{"owner": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "edited": false, "score": 4, "creation_date": 1463650462, "post_id": 37305698, "comment_id": 62158163, "body": "The question was about C, not C++."}], "tags": [], "owner": {"reputation": 21, "user_id": 6352258, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/211e2846219591cacd45fcb7d5a182ff?s=128&d=identicon&r=PG", "display_name": "Tommy", "link": "https://stackoverflow.com/users/6352258/tommy"}, "is_accepted": false, "score": 1, "last_activity_date": 1463590136, "creation_date": 1463590136, "answer_id": 37305698, "question_id": 37291681, "link": "https://stackoverflow.com/questions/37291681/does-the-c-standard-explicitly-indicate-truth-value-as-0-or-1/37305698#37305698", "title": "Does the C standard explicitly indicate truth value as 0 or 1?", "body": "<p>This answer needs to be looked at a bit more closely.</p>\n\n<p>The actual definition in C++ is that anything not 0 is treated as true.  Why is this relevant?  Because C++ doesn't know what an integer is by how we think about it--we create that meaning, all it holds is the shell and rules for what that means.  It knows what bits are though, that which make up an integer.  </p>\n\n<p>1 as an integer is loosely represented in bits, say an 8-bit signed int as 0000 0001.  Many times what we see visually is a bit of a lie, -1 is a much more common way to represent it because of the signed nature of 'integer'.  1 really can't mean true proper, why?  Because it's NOT operation is 1111 1110.  That's a really major issue for a boolean.  When we talk about a boolean, it's just 1 bit--it's really simple, 0 is false and 1 is true.  All the logic operations hold as trivial.  This is why '-1' should be designated as 'true' for integers (signed).  1111 1111 NOT'ed becomes 0000 0000---the logic holds and we're good.  Unsigned ints is a little bit tricky and were a lot more commonly used in the past--where 1 means true because it's easy to imply the logic that 'anything not 0 is true'.</p>\n\n<p>That's the explanation.  I say the accepted answer here is wrong--there is no clear definition in the C/C++ definition.  A boolean is a boolean, you can treat an integer as a boolean, but the fact the output is an integer says nothing about the operation actually being done is bitwise.</p>\n"}], "owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28993, "favorite_count": 11, "accepted_answer_id": 37291888, "answer_count": 7, "score": 89, "last_activity_date": 1592328392, "creation_date": 1463552366, "last_edit_date": 1463587012, "question_id": 37291681, "link": "https://stackoverflow.com/questions/37291681/does-the-c-standard-explicitly-indicate-truth-value-as-0-or-1", "title": "Does the C standard explicitly indicate truth value as 0 or 1?", "body": "<p>We know that any numbers that are not equal to <code>0</code> are viewed as <code>true</code> in C, so we can write:</p>\n\n<pre><code>int a = 16;\n\nwhile (a--)\n    printf(\"%d\\n\", a);  // prints numbers from 15 to 0\n</code></pre>\n\n<p>However, I was wondering whether true / false are defined as <code>1</code>/<code>0</code> in C, so I tried the code below:</p>\n\n<pre><code>printf(\"True = %d, False = %d\\n\", (0 == 0), (0 != 0));  // prints: True = 1, False = 0\n</code></pre>\n\n<p>Does C standard explicitly indicate the truth values of  true and false as <code>1</code> and <code>0</code> respectively?</p>\n"}, {"tags": ["c", "struct", "compiler-warnings", "c-strings", "strcpy"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1463551378, "post_id": 37291409, "comment_id": 62106896, "body": "<code>scanf(&quot;%s&quot;,review)</code> --&gt; <code>scanf(&quot;%s&quot;,review[index])</code>"}, {"owner": {"reputation": 456, "user_id": 5276705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e8bd54c7b2823d28abc6dbee63f3e0b?s=128&d=identicon&r=PG", "display_name": "SKD", "link": "https://stackoverflow.com/users/5276705/skd"}, "edited": false, "score": 4, "creation_date": 1463551458, "post_id": 37291409, "comment_id": 62106928, "body": "I think the solution is hidden in the warning itself."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1463551755, "post_id": 37291409, "comment_id": 62107054, "body": "<code>strcpy(k-&gt;b-&gt;review,review[MAXSTRING]);</code> --&gt; <code>strcpy(k-&gt;b-&gt;review[index,review[MAXSTRING-1]);</code>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1463552396, "post_id": 37291409, "comment_id": 62107317, "body": "<a href=\"http://stackoverflow.com/q/605845/995714\">Don&#39;t cast the result of <code>malloc</code> in C</a>"}, {"owner": {"reputation": 10045, "user_id": 77542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2bb52913c4cebae8835bb50c03996d5?s=128&d=identicon&r=PG", "display_name": "Tordek", "link": "https://stackoverflow.com/users/77542/tordek"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1463553183, "post_id": 37291409, "comment_id": 62107680, "body": "@LPs you missed a <code>]</code>."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 10045, "user_id": 77542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2bb52913c4cebae8835bb50c03996d5?s=128&d=identicon&r=PG", "display_name": "Tordek", "link": "https://stackoverflow.com/users/77542/tordek"}, "edited": false, "score": 0, "creation_date": 1463553302, "post_id": 37291409, "comment_id": 62107747, "body": "@Tordek I already edited. ;)"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1463554801, "post_id": 37291409, "comment_id": 62108578, "body": "Don&#39;t edit your post with your corrections: it makes hard to understand answers or comments for other users."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 6349062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b80eeb633d3018ccb94abc412c09e02?s=128&d=identicon&r=PG&f=1", "display_name": "Karamanis", "link": "https://stackoverflow.com/users/6349062/karamanis"}, "edited": false, "score": 0, "creation_date": 1463552494, "post_id": 37291490, "comment_id": 62107366, "body": "Thanks so much for the help.  I don&#39;t understand why it gets out of bounds. I changed it to <code>strcpy(k-&gt;b-&gt;review, review[MAXSTRING-1]);</code>but I get the same error"}, {"owner": {"reputation": 73, "user_id": 6349062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b80eeb633d3018ccb94abc412c09e02?s=128&d=identicon&r=PG&f=1", "display_name": "Karamanis", "link": "https://stackoverflow.com/users/6349062/karamanis"}, "edited": false, "score": 0, "creation_date": 1463553993, "post_id": 37291490, "comment_id": 62108170, "body": "Wow, your edited post is so much better. I know about the arrays but I didn&#39;t notice that I had switched the Lines with the columns. About the casting of malloc: in class the&#39;ve said us to cast the result. Do you suggest it is <code>node k=malloc(sizeof(struct nodeR));</code>. Can I use malloc like that?"}, {"owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "reply_to_user": {"reputation": 73, "user_id": 6349062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b80eeb633d3018ccb94abc412c09e02?s=128&d=identicon&r=PG&f=1", "display_name": "Karamanis", "link": "https://stackoverflow.com/users/6349062/karamanis"}, "edited": false, "score": 0, "creation_date": 1463554331, "post_id": 37291490, "comment_id": 62108345, "body": "@Karamanis Yes of course you can! :) This is the correct programming technique but if you are working on a class project, probably you should do what your teacher asks :)"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1463554651, "post_id": 37291490, "comment_id": 62108491, "body": "and if your teacher says you to cast <code>malloc</code> return using <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a>....change school or class ;)"}], "tags": [], "owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "is_accepted": true, "score": 1, "last_activity_date": 1463553269, "last_edit_date": 1495535358, "creation_date": 1463551499, "answer_id": 37291490, "question_id": 37291409, "link": "https://stackoverflow.com/questions/37291409/c-errorformat-s-expects-argument-of-type-char-but-argument-2-has-type-ch/37291490#37291490", "title": "C error:format &#39;%s&#39; expects argument of type &#39;char *&#39;but argument 2 has type &#39;char (*)[100]&#39;", "body": "<ul>\n<li><p><strong>Warning No1</strong></p>\n\n<p>In order to use <code>scanf</code>, you need to pass a <em>pointer</em> to it. You have declared :</p>\n\n<pre><code>char review [MAXSTRING][MAXLINES];\n</code></pre>\n\n<p>but you read :</p>\n\n<pre><code>scanf(\"%s\",review);\n</code></pre>\n\n<p>You need to change this to :</p>\n\n<pre><code>scanf(\"%s\", review[i]);\n</code></pre>\n\n<p>where <code>i</code> is an index from <code>0</code> to <code>MAXSTRING-1</code>.</p></li>\n<li><p><strong>Warning No2</strong></p>\n\n<p>Moreover, the statement :</p>\n\n<pre><code>strcpy(k-&gt;b-&gt;review,review[MAXSTRING]);\n</code></pre>\n\n<p>gets out of bounds, as you the positions of your array reach <code>review[MAXSTRING-1]</code>. Apart from that, you are assigning a <em>line</em> to a whole <em>array</em>. So you should change it to :</p>\n\n<pre><code>strcpy(k-&gt;b-&gt;review[index], review[MAXSTRING-1]);\n</code></pre></li>\n</ul>\n\n<hr>\n\n<p><strong>Two more notes :</strong></p>\n\n<ol>\n<li>See this <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">link on why not to cast the result of malloc</a>.</li>\n<li><p>Keep in mind that in a declaration such as :</p>\n\n<pre><code>array[x][y];\n</code></pre>\n\n<p><code>x</code> indicates the lines and <code>y</code> indicates the columns. You have them in the opposite way, so make sure that you do not get confused and that you really access rows when you want rows and columns when you want columns.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 6349062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b80eeb633d3018ccb94abc412c09e02?s=128&d=identicon&r=PG&f=1", "display_name": "Karamanis", "link": "https://stackoverflow.com/users/6349062/karamanis"}, "edited": false, "score": 0, "creation_date": 1463552938, "post_id": 37291586, "comment_id": 62107557, "body": "The First warning I get it. But the second one stil has a problem i changed it to <code>strcpy(k-&gt;b-&gt;review[index,review[MAXSTRING-1]);</code>. But I get the same error. Is it because of &quot;As you can see there is a second problem into your strcpy call: the second parameter address your array of strings out of bound, that invoke Undefined Behavior&quot; that you said.<code>test.c:666:45: warning: declaration does not declare anything      enum genres{fiction,scientific,politics};</code> Oops I forgot about that, I know how to fix it."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 73, "user_id": 6349062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b80eeb633d3018ccb94abc412c09e02?s=128&d=identicon&r=PG&f=1", "display_name": "Karamanis", "link": "https://stackoverflow.com/users/6349062/karamanis"}, "edited": false, "score": 0, "creation_date": 1463553048, "post_id": 37291586, "comment_id": 62107612, "body": "@Karamanis How did you declare and init <code>index</code>?  See my edit"}, {"owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "edited": false, "score": 0, "creation_date": 1463553340, "post_id": 37291586, "comment_id": 62107765, "body": "@LPs this is because you had the typo in your answer before your edit :)"}, {"owner": {"reputation": 73, "user_id": 6349062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b80eeb633d3018ccb94abc412c09e02?s=128&d=identicon&r=PG&f=1", "display_name": "Karamanis", "link": "https://stackoverflow.com/users/6349062/karamanis"}, "edited": false, "score": 0, "creation_date": 1463553623, "post_id": 37291586, "comment_id": 62107951, "body": "@LPs  You&#39;re about the typo but I still got the same error. The way you reccomend does seem a lot better. I&#39;ll try it and inform you. Thanks for the help and your time."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 73, "user_id": 6349062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b80eeb633d3018ccb94abc412c09e02?s=128&d=identicon&r=PG&f=1", "display_name": "Karamanis", "link": "https://stackoverflow.com/users/6349062/karamanis"}, "edited": false, "score": 0, "creation_date": 1463553719, "post_id": 37291586, "comment_id": 62108003, "body": "@Karamanis I don&#39;t know about your compiler, my <code>gcc (Debian 4.9.2-10) 4.9.2</code> compiles without warnings. :)"}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 2, "last_activity_date": 1463553344, "last_edit_date": 1463553344, "creation_date": 1463551910, "answer_id": 37291586, "question_id": 37291409, "link": "https://stackoverflow.com/questions/37291409/c-errorformat-s-expects-argument-of-type-char-but-argument-2-has-type-ch/37291586#37291586", "title": "C error:format &#39;%s&#39; expects argument of type &#39;char *&#39;but argument 2 has type &#39;char (*)[100]&#39;", "body": "<p><strong>1st warning</strong></p>\n\n<pre><code>char review [MAXSTRING][MAXLINES];\n</code></pre>\n\n<p>it is a matrix, that can be seen as an array of C-strings in your case.</p>\n\n<p>Each C-String is <code>review[index]</code> where index goes from <code>0</code> to <code>MAXSTRING-1</code></p>\n\n<p>So </p>\n\n<pre><code>scanf(\"%s\",review)\n</code></pre>\n\n<p>is wrong because of you must pass a single C-String to function, then you must write:</p>\n\n<pre><code>scanf(\"%s\",review[index]);\n</code></pre>\n\n<p>I'd suggest you to limit the input string to the maximum allowed chars for each string <code>MAXLINES-1</code> using, instead of <code>scanf</code>:</p>\n\n<pre><code>fgets(review[index], MAXLINES, stdin);\n</code></pre>\n\n<p><strong>2nd warning</strong></p>\n\n<p>Same thing for <code>review</code> member of <code>struct bookR</code>.\nSo</p>\n\n<pre><code>strcpy(k-&gt;b-&gt;review,review[MAXSTRING]);\n</code></pre>\n\n<p>must be</p>\n\n<pre><code>strcpy(k-&gt;b-&gt;review[index],review[MAXSTRING-1]);\n</code></pre>\n\n<p>As you can see there is a second problem into your strcpy call: the second parameter address your array of strings out of bound, that invoke <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">Undefined Behavior</a>.</p>\n\n<p><strong>Other warnings</strong></p>\n\n<p>There is an warning more into your code:</p>\n\n<pre><code>test.c:666:45: warning: declaration does not declare anything\n     enum genres{fiction,scientific,politics};\n                                             ^\n</code></pre>\n\n<p><strong>Final Considerations</strong></p>\n\n<p>I guess you want to switch defines into your matrix definitions, as you done into <code>struct bookR</code>, like:</p>\n\n<pre><code>char review [MAXLINES][MAXSTRING];\n</code></pre>\n\n<p>I Think could be a best choice to ask for each single data with a specific <code>prinf</code> ans its <code>scanf</code>/<code>fgets</code>.</p>\n\n<pre><code>printf (\"Give the author: \");\nfgets(author, MAXSTRING, stdin);\nprintf (\"Enter id: \");\nscanf(\"%d\",&amp;id);\nprintf (\"Enter review of the new book respectively: \");\nfgets(review[index], MAXSTRING, stdin);\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 6349062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b80eeb633d3018ccb94abc412c09e02?s=128&d=identicon&r=PG&f=1", "display_name": "Karamanis", "link": "https://stackoverflow.com/users/6349062/karamanis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3813, "favorite_count": 0, "accepted_answer_id": 37291490, "answer_count": 2, "score": 4, "last_activity_date": 1568298314, "creation_date": 1463551165, "last_edit_date": 1463554874, "question_id": 37291409, "link": "https://stackoverflow.com/questions/37291409/c-errorformat-s-expects-argument-of-type-char-but-argument-2-has-type-ch", "title": "C error:format &#39;%s&#39; expects argument of type &#39;char *&#39;but argument 2 has type &#39;char (*)[100]&#39;", "body": "<p>I'm working on an exercise in c the last few days and I'm having this warning (as the title suggests). I've tried a bunch of stuff but I don't really know how to exactly fix this. I'm not good at programming so there are mistakes. Below are the structs I'm using (which cannot be changed because that's how they are given):</p>\n\n<pre><code>    typedef struct bookR* book;\nstruct bookR{\n    char author[MAXSTRING];\n    enum genres{fiction,scientific,politics};\n    int id;\n    char review[MAXLINES][MAXSTRING];\n\n};\n\ntypedef struct nodeR* node;\nstruct nodeR{\n    book b;\n    node next;\n\n};\n\ntypedef struct listR* list;\nstruct listR{\n    node head, tail; \n    int size;\n};\n</code></pre>\n\n<p>And here is part of the code where the problem occurs: </p>\n\n<pre><code> void addBook(book b, list bList){\nchar author [MAXSTRING];\nint id;\nchar review [MAXSTRING][MAXLINES];\nprintf (\"Give the author,`enter code here` id and review of the new book respectively\");\nscanf(\"%s\",author);\nscanf(\"%d\",&amp;id);\nscanf(\"%s\",review);\nnode k=(node)malloc(sizeof(struct nodeR));\nassert(k);\nk-&gt;next=NULL;\nstrcpy(k-&gt;b-&gt;author,author);\nk-&gt;b-&gt;id=id;\nstrcpy(k-&gt;b-&gt;review,review[MAXSTRING]);}\n</code></pre>\n\n<p>And this is the warning I'm getting:</p>\n\n<pre><code>  warning: format '%s' expects argument of type 'char *' but argument 2 has type 'char (*)[100]' [-Wformat=]\nscanf(\"%s\",review);\nwarining:passing argument 1 of 'strcpy' from incompatible pointer tupe [-Wincompatible-pointer-types]\nstrcpy(k-&gt;b-&gt;review,review[MAXSTRING]);\n</code></pre>\n\n<p>Any help is much appreciated. Thanks for your time and sorry for the long post.</p>\n"}, {"tags": ["c++", "c", "socketpair"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 6349004, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-eceetg4bqHw/AAAAAAAAAAI/AAAAAAAAAAA/cPMRlnf-kF8/photo.jpg?sz=128", "display_name": "Manu Thomas Mathew", "link": "https://stackoverflow.com/users/6349004/manu-thomas-mathew"}, "edited": false, "score": 0, "creation_date": 1463561293, "post_id": 37292785, "comment_id": 62112533, "body": "The value of <code>net.unix.max_dgram_qlen</code> in my system is set to 10.   Besides , this parameter will be applicable only for Datagram Sockets, whereas here Stream Sockets are used.  In the discussion <a href=\"http://stackoverflow.com/questions/10899814/af-unix-socket-overhead\">link</a> it is discussed that the kernel reserves space for book keeping, so the sndbuf value received from <code>getsockopt(readFD, SOL_SOCKET, SO_SNDBUF, &amp;rSndBuff, &amp;optlen);</code> will be double the actual value. Considering this i had halved the sndbuf in my calculation.       Still it doesn&#39;t explain the extra buffer space consumed."}], "tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": false, "score": 1, "last_activity_date": 1463556107, "last_edit_date": 1495535315, "creation_date": 1463556107, "answer_id": 37292785, "question_id": 37291100, "link": "https://stackoverflow.com/questions/37291100/behavior-of-so-sndbuf-when-using-socketpair/37292785#37292785", "title": "Behavior of SO_SNDBUF when using socketpair", "body": "<p>Seems similar to: <a href=\"https://stackoverflow.com/questions/10899814/af-unix-socket-overhead\">AF_UNIX socket overhead?</a>.</p>\n\n<p>The limit reached should be <code>net.unix.max_dgram_qlen</code>: maximum number of datagram to enqueue.</p>\n\n<p>To read actual value:</p>\n\n<pre><code>sysctl net.unix.max_dgram_qlen\n</code></pre>\n\n<p>To set a new value:</p>\n\n<pre><code>sysctl net.unix.max_dgram_qlen=...\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 6349004, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-eceetg4bqHw/AAAAAAAAAAI/AAAAAAAAAAA/cPMRlnf-kF8/photo.jpg?sz=128", "display_name": "Manu Thomas Mathew", "link": "https://stackoverflow.com/users/6349004/manu-thomas-mathew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1463556107, "creation_date": 1463549808, "question_id": 37291100, "link": "https://stackoverflow.com/questions/37291100/behavior-of-so-sndbuf-when-using-socketpair", "title": "Behavior of SO_SNDBUF when using socketpair", "body": "<p>I want to send messages between two threads using socketpair.\nI am writing code to find out how many messages can be send using a socketpair, with message of size 16 bytes ( two pointers ). The code I used is below:</p>\n\n<pre><code>int fds[2];\nsocketpair(AF_LOCAL, SOCK_STREAM, PF_UNSPEC, fds);\n\nint readFD=fds[0];\nint writeFD=fds[1];\ngetsockopt(readFD, SOL_SOCKET, SO_SNDBUF, &amp;rSndBuff, &amp;optlen);\ngetsockopt(readFD, SOL_SOCKET, SO_RCVBUF, &amp;rRcvBuff, &amp;optlen);\ncout &lt;&lt;\"Read FD : Send Buff : \"&lt;&lt;rSndBuff&lt;&lt;\" Recv Buff : \"&lt;&lt;rRcvBuff&lt;&lt;endl;\ngetsockopt(writeFD, SOL_SOCKET, SO_SNDBUF , &amp;wSndBuff, &amp;optlen);\ngetsockopt(writeFD, SOL_SOCKET, SO_RCVBUF , &amp;wRcvBuff, &amp;optlen);\ncout  &lt;&lt;\"Write FD : Send Buff : \"&lt;&lt;wSndBuff&lt;&lt;\" Recv Buff : \"&lt;&lt;wRcvBuff&lt;&lt;endl;\n\nint count=0;\nwhile ( 1 )\n{\n  char * im[2];\n  int sentCount=send(writeFD, im, sizeof(im), MSG_DONTWAIT | MSG_NOSIGNAL);\n\n  if(sentCount&lt;0)\n  {\n    ioctl ( readFD , FIONREAD , &amp;rRcvBuff );\n    cout &lt;&lt;\"Size of data sent in one message : \"&lt;&lt;sizeof(im)&lt;&lt;endl;\n    cout  &lt;&lt;\"Recv Buff : \"&lt;&lt;rRcvBuff&lt;&lt;endl;\n    cout &lt;&lt;\"Sent : \" &lt;&lt;sizeof(im)*count&lt;&lt;endl;\n    cout&lt;&lt;\"Unable to send : \"&lt;&lt; errno&lt;&lt; \" \"&lt;&lt;strerror(errno)&lt;&lt;endl;\n    cout&lt;&lt;\"Count : \" &lt;&lt;count&lt;&lt;endl;\n    break;\n  }\n  else if(sentCount!=sizeof(im))\n  {\n    ioctl ( readFD , FIONREAD , &amp;rRcvBuff );\n    cout  &lt;&lt;\"Recv Buff : \"&lt;&lt;rRcvBuff&lt;&lt;endl;\n    cout&lt;&lt;EMSGSIZE&lt;&lt;endl;\n    cout&lt;&lt;\"Count : \" &lt;&lt;count&lt;&lt;endl;\n    break;\n  }\n  count++;\n}\n</code></pre>\n\n<p>No thread/process is listening to the readFD.\nSo the while loop should exit when the send buffer of writeFD is full.</p>\n\n<p>Following output is seen:</p>\n\n<pre><code>Read FD : Send Buff : 129024 Recv Buff : 129024\nWrite FD : Send Buff : 129024 Recv Buff : 129024\nSize of data sent in one message : 16\nRecv Buff : 5504\nSent : 5504\nUnable to send : 11 Resource temporarily unavailable\nCount : 344\n</code></pre>\n\n<p>I was expecting the number of messages sent to be around 4032 ( 129024/(2*16) ).</p>\n\n<p>What am I missing here ?\nIs there a fixed sized header used while sending messages in AF_LOCAL ?</p>\n"}, {"tags": ["c", "parallel-processing", "openmp", "matrix-multiplication"], "comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1463555722, "post_id": 37291093, "comment_id": 62109107, "body": "Have you measured what performance you get? For matrix multiplication you can compare against the theoretical peak performance."}, {"owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "edited": false, "score": 0, "creation_date": 1463557936, "post_id": 37291093, "comment_id": 62110427, "body": "I&#39;m not convinced this code is correct: the <code>collapse(3)</code> directive parallelises over the 3 indexes <code>i</code>, <code>j</code> and <code>k</code>. This means that you are guaranteed that no identical <code>i,j,k</code> triplets will be handled by two different threads. However, you can very well have the same <code>i,j</code> pair with a different <code>k</code> for two threads. And this will lead to a race condition into updating <code>c[i1][j1]</code>..."}, {"owner": {"reputation": 12523, "user_id": 1835769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/kannS.jpg?s=128&g=1", "display_name": "displayName", "link": "https://stackoverflow.com/users/1835769/displayname"}, "edited": false, "score": 0, "creation_date": 1463586217, "post_id": 37291093, "comment_id": 62130488, "body": "<a href=\"http://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-172-performance-engineering-of-software-systems-fall-2010/video-lectures/lecture-1-matrix-multiply-a-case-study/\" rel=\"nofollow noreferrer\">This particular course video</a> is entirely dedicated to improving the speed of Matrix Multiplication."}, {"owner": {"reputation": 12867, "user_id": 1337392, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/KquuZ.jpg?s=128&g=1", "display_name": "Flame_Phoenix", "link": "https://stackoverflow.com/users/1337392/flame-phoenix"}, "edited": false, "score": 0, "creation_date": 1466071840, "post_id": 37291093, "comment_id": 63170233, "body": "I strongly suggest you this stackExchange, specialised in these cases: <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1479, "user_id": 2117960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc912e07e893656d5daf1d3729de7a90?s=128&d=identicon&r=PG&f=1", "display_name": "zyamys", "link": "https://stackoverflow.com/users/2117960/zyamys"}, "is_accepted": false, "score": 2, "last_activity_date": 1463675342, "last_edit_date": 1463675342, "creation_date": 1463551834, "answer_id": 37291569, "question_id": 37291093, "link": "https://stackoverflow.com/questions/37291093/speed-up-matrix-multiplication-with-openmp-and-block-method-can-i-do-better/37291569#37291569", "title": "Speed Up Matrix Multiplication with OpenMP and Block Method: Can I Do Better?", "body": "<p>Linear algebra is one of the most common operations computers perform. In games and graphics libraries it is THE most common operation. It has been studied and optimized heavily, with entire research groups dedicated to it.</p>\n\n<p>If you care about speed, you should be performing matrix multiplication with a <a href=\"https://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms\" rel=\"nofollow\">BLAS</a> library. Some of the things that a BLAS library will optimize for: </p>\n\n<ul>\n<li>minimize cache-misses by performing the matrix multiplication in blocks rather than looping over the entire matrix</li>\n<li>optimize the block size for the cache-size of the computer</li>\n<li>if the computer/CPU has multiple cache levels, use multiple optimized block size levels</li>\n<li>use <a href=\"https://en.wikipedia.org/wiki/SIMD\" rel=\"nofollow\">SIMD</a> instructions if available on the CPU</li>\n</ul>\n\n<p>Note that parallelization is not on the list. This is because in today's computers memory access is slower than the CPU. You will see <em>worse</em> performance with openmp due to the overhead of context switching. </p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 5590381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YA6U4cAGA60/AAAAAAAAAAI/AAAAAAAAADM/_qymwrxswS0/photo.jpg?sz=128", "display_name": "Huanming Song", "link": "https://stackoverflow.com/users/5590381/huanming-song"}, "edited": false, "score": 0, "creation_date": 1463623092, "post_id": 37293739, "comment_id": 62146269, "body": "I studied this for a day and have done lots of experiments. Unfortunately I think it is hard(or out of my ability) to exploit openMP int this method. It performs a little bit worse than the code with openMP."}, {"owner": {"reputation": 9313, "user_id": 1957265, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b616537ad7664d6f0d24c2b6ff098098?s=128&d=identicon&r=PG", "display_name": "kangshiyin", "link": "https://stackoverflow.com/users/1957265/kangshiyin"}, "reply_to_user": {"reputation": 63, "user_id": 5590381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YA6U4cAGA60/AAAAAAAAAAI/AAAAAAAAADM/_qymwrxswS0/photo.jpg?sz=128", "display_name": "Huanming Song", "link": "https://stackoverflow.com/users/5590381/huanming-song"}, "edited": false, "score": 0, "creation_date": 1463652402, "post_id": 37293739, "comment_id": 62159563, "body": "@HuanmingSong The link is optimizing single thread GEMM. With an optimized single thread GEMM, you could then use OpenMP to improve performance on multi-core CPUs."}], "tags": [], "owner": {"reputation": 9313, "user_id": 1957265, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b616537ad7664d6f0d24c2b6ff098098?s=128&d=identicon&r=PG", "display_name": "kangshiyin", "link": "https://stackoverflow.com/users/1957265/kangshiyin"}, "is_accepted": false, "score": 1, "last_activity_date": 1463581015, "last_edit_date": 1463581015, "creation_date": 1463558818, "answer_id": 37293739, "question_id": 37291093, "link": "https://stackoverflow.com/questions/37291093/speed-up-matrix-multiplication-with-openmp-and-block-method-can-i-do-better/37293739#37293739", "title": "Speed Up Matrix Multiplication with OpenMP and Block Method: Can I Do Better?", "body": "<p>It seems that you are far away from fully optimized. Have you tried loop unroll, loop inversion, etc.?</p>\n\n<p>You could refer to the following link for a step by step optimization on matrix multiplication.</p>\n\n<p><a href=\"http://wiki.cs.utexas.edu/rvdg/HowToOptimizeGemm/\" rel=\"nofollow\">http://wiki.cs.utexas.edu/rvdg/HowToOptimizeGemm/</a></p>\n"}], "owner": {"reputation": 63, "user_id": 5590381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YA6U4cAGA60/AAAAAAAAAAI/AAAAAAAAADM/_qymwrxswS0/photo.jpg?sz=128", "display_name": "Huanming Song", "link": "https://stackoverflow.com/users/5590381/huanming-song"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1339, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1463675342, "creation_date": 1463549781, "last_edit_date": 1463581819, "question_id": 37291093, "link": "https://stackoverflow.com/questions/37291093/speed-up-matrix-multiplication-with-openmp-and-block-method-can-i-do-better", "title": "Speed Up Matrix Multiplication with OpenMP and Block Method: Can I Do Better?", "body": "<p>This is the code I wrote:</p>\n\n<pre><code>#include &lt;omp.h&gt;\nvoid matrix_multi(int c[][TSIZE], int a[][TSIZE], int b[][TSIZE])\n{\n   int B=8;\n\n  int i, j, k,i1,j1,k1;\n#pragma omp parallel for private(i,j,k,i1,j1,k1) schedule(auto) collapse(3)\n  for (i=0; i&lt;TSIZE; i+=B)\n    for (j=0; j&lt;TSIZE; j+=B)\n      for (k=0; k&lt;TSIZE; k+=B)\n        for (i1=i;i1&lt;i+B;i1++)\n          for (j1=j;j1&lt;j+B;j1++)\n            {\n              int sum=0;\n              for (k1=k;k1&lt;k+B;k1++)\n                {\n                  sum+=a[i1][k1]*b[k1][j1];\n                }\n              c[i1][j1]+=sum;\n            }\n\n}\n</code></pre>\n\n<p>My question is: Can I get a better performance with some further manipulation on three inner loops?</p>\n"}, {"tags": ["c++", "c", "eclipse", "ide", "eclipse-cdt"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1463555265, "post_id": 37291037, "comment_id": 62108842, "body": "Strange. On my Eclipse it shows me the macro with defines translated."}, {"owner": {"reputation": 23863, "user_id": 135960, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/97d76921347e8b10190717f2529e7547?s=128&d=identicon&r=PG", "display_name": "dimba", "link": "https://stackoverflow.com/users/135960/dimba"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1463637572, "post_id": 37291037, "comment_id": 62150159, "body": "@LP Don&#39;t sure you comment is relevant for my question :)"}, {"owner": {"reputation": 62673, "user_id": 492336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/UjW5c.png?s=128&g=1", "display_name": "sashoalm", "link": "https://stackoverflow.com/users/492336/sashoalm"}, "edited": false, "score": 0, "creation_date": 1464337785, "post_id": 37291037, "comment_id": 62454394, "body": "@dimba Can you add a cropped screenshot of what the tooltip looks like?"}, {"owner": {"reputation": 7471, "user_id": 2796832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nt2uE.jpg?s=128&g=1", "display_name": "Jonah Graham", "link": "https://stackoverflow.com/users/2796832/jonah-graham"}, "edited": false, "score": 1, "creation_date": 1483451706, "post_id": 37291037, "comment_id": 70096374, "body": "@dimba Another CDT committer has taken the time to add the necessary parsing information and now the next release of CDT will have this support <a href=\"https://bugs.eclipse.org/bugs/show_bug.cgi?id=508216\" rel=\"nofollow noreferrer\">bugs.eclipse.org/bugs/show_bug.cgi?id=508216</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7471, "user_id": 2796832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nt2uE.jpg?s=128&g=1", "display_name": "Jonah Graham", "link": "https://stackoverflow.com/users/2796832/jonah-graham"}, "is_accepted": true, "score": 8, "last_activity_date": 1483451623, "last_edit_date": 1483451623, "creation_date": 1464092910, "answer_id": 37413598, "question_id": 37291037, "link": "https://stackoverflow.com/questions/37291037/eclipse-cdt-doesnt-show-name-a-macro-appears-in/37413598#37413598", "title": "Eclipse CDT: doesn&#39;t show name a macro appears in", "body": "<h2>Update - Jan 2017</h2>\n\n<p>The next release of CDT (CDT 9.3, part of Eclipse Oxygen to be released in June 2017) will have support for showing function containing the macro reference. See <a href=\"https://bugs.eclipse.org/bugs/show_bug.cgi?id=508216\" rel=\"nofollow noreferrer\">Bug 508216</a> for more details. </p>\n\n<p>The rest of this answer is the original answer.</p>\n\n<h2>TL;DR</h2>\n\n<p>There is no way in Eclipse CDT to display the function a macro is referenced in because such information is not included in the index when the index is built.</p>\n\n<h2>Pictures</h2>\n\n<p>To ensure that we are talking about the same thing I provide some visuals.</p>\n\n<p>Given a simplified C file containing functions, macros and globals:</p>\n\n<p><strong>Example Code</strong>\n</p>\n\n<pre><code>#define MACRO(X) ((X) + 2)\nint function(int);\nint global;\n\nint function_results_are_in(void) {\n    int i = 0;\n    i = MACRO(i);\n    i = function(i);\n    i += global;\n    return i;\n}\n</code></pre>\n\n<p>Doing a search using one of the following methods that uses the C/C++ Index (as opposed to a file/grep style search):</p>\n\n<p><strong>Setup</strong></p>\n\n<ul>\n<li><em>References in Workspace</em> of selection using one of:\n\n<ul>\n<li><kbd>Shift</kbd>+<kbd>Ctrl</kbd>+<kbd>G</kbd></li>\n<li>Right-click -> <em>References</em> -> <em>Workspace</em></li>\n</ul></li>\n<li><em>Search</em> menu -> <em>C/C++ Search</em> and search for references, like this picture:\n<a href=\"https://i.stack.imgur.com/bgSiG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bgSiG.png\" alt=\"enter image description here\"></a></li>\n</ul>\n\n<p><strong>Results - Function search</strong></p>\n\n<p>As you can see with searches for functions, the result shows the containing function name:</p>\n\n<p><a href=\"https://i.stack.imgur.com/S7dKK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S7dKK.png\" alt=\"function search\"></a></p>\n\n<p><strong>Results - Macro search</strong></p>\n\n<p>But for the macro search, there is no containing function name:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yRtwK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yRtwK.png\" alt=\"macro search\"></a></p>\n\n<h2>Under the hood</h2>\n\n<p>Each search result in the <em>C/C++ Search</em> results is  <a href=\"https://git.eclipse.org/c/cdt/org.eclipse.cdt.git/tree/core/org.eclipse.cdt.ui/src/org/eclipse/cdt/internal/ui/search/LineSearchElement.java#n35\" rel=\"nofollow noreferrer\"><code>LineSearchElement.Match</code></a>. If its <a href=\"https://git.eclipse.org/c/cdt/org.eclipse.cdt.git/tree/core/org.eclipse.cdt.ui/src/org/eclipse/cdt/internal/ui/search/LineSearchElement.java#n39\" rel=\"nofollow noreferrer\"><code>fEnclosingElement</code></a> is <code>null</code> then there is no function to display.</p>\n\n<p>Taking one step back you can see that the <a href=\"https://git.eclipse.org/c/cdt/org.eclipse.cdt.git/tree/core/org.eclipse.cdt.ui/src/org/eclipse/cdt/internal/ui/search/CSearchQuery.java#n259\" rel=\"nofollow noreferrer\">match is created</a> from a matching <a href=\"https://git.eclipse.org/c/cdt/org.eclipse.cdt.git/tree/core/org.eclipse.cdt.core/parser/org/eclipse/cdt/core/index/IIndexName.java\" rel=\"nofollow noreferrer\"><code>IIndexName</code></a>. The <code>Match.fEnclosingElement</code> field is filled from the result of <code>IIndexName.getEnclosingDefinition()</code>.</p>\n\n<p>In the case of a macro reference the concrete type of <code>IIndexName</code> is a <a href=\"https://git.eclipse.org/c/cdt/org.eclipse.cdt.git/tree/core/org.eclipse.cdt.core/parser/org/eclipse/cdt/internal/core/pdom/dom/PDOMMacroReferenceName.java\" rel=\"nofollow noreferrer\"><code>PDOMMacroReferenceName</code></a>, and <a href=\"https://git.eclipse.org/c/cdt/org.eclipse.cdt.git/tree/core/org.eclipse.cdt.core/parser/org/eclipse/cdt/internal/core/pdom/dom/PDOMMacroReferenceName.java#n298\" rel=\"nofollow noreferrer\">the implementation</a> of <code>getEnclosingDefinition</code> is simply <code>return null</code>.</p>\n"}], "owner": {"reputation": 23863, "user_id": 135960, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/97d76921347e8b10190717f2529e7547?s=128&d=identicon&r=PG", "display_name": "dimba", "link": "https://stackoverflow.com/users/135960/dimba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 1, "accepted_answer_id": 37413598, "answer_count": 1, "score": 9, "last_activity_date": 1483451623, "creation_date": 1463549506, "question_id": 37291037, "link": "https://stackoverflow.com/questions/37291037/eclipse-cdt-doesnt-show-name-a-macro-appears-in", "title": "Eclipse CDT: doesn&#39;t show name a macro appears in", "body": "<p>When searching for macro references, Eclipse displays file+line the macro is referenced it. I would like to file+line+<strong>function</strong>.</p>\n\n<p>Searching for a other type of data (e.g. function) will display file+line+<strong>function</strong> as expected, so maybe something should be tweaked in Eclipse configuration for macros?</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c++", "c", "visual-studio"], "comments": [{"owner": {"reputation": 2473, "user_id": 4490706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nmMcD.jpg?s=128&g=1", "display_name": "Ton Plooij", "link": "https://stackoverflow.com/users/4490706/ton-plooij"}, "edited": false, "score": 1, "creation_date": 1463549756, "post_id": 37290828, "comment_id": 62106278, "body": "Can you experiment with building a.lib using the C/C++ /Gy option and linking your executable using the linker /OPT option?"}, {"owner": {"reputation": 161, "user_id": 2006543, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c1b746fcc1c6bfdae8c0cde8b2b6d91d?s=128&d=identicon&r=PG&f=1", "display_name": "Alparslan", "link": "https://stackoverflow.com/users/2006543/alparslan"}, "reply_to_user": {"reputation": 2473, "user_id": 4490706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nmMcD.jpg?s=128&g=1", "display_name": "Ton Plooij", "link": "https://stackoverflow.com/users/4490706/ton-plooij"}, "edited": false, "score": 0, "creation_date": 1463554262, "post_id": 37290828, "comment_id": 62108301, "body": "/Gy is already defined for a.lib, for executable /OPT:ICF and /OPT:REF are already enabled. Do you have another /OPT in mind?"}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 2006543, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c1b746fcc1c6bfdae8c0cde8b2b6d91d?s=128&d=identicon&r=PG&f=1", "display_name": "Alparslan", "link": "https://stackoverflow.com/users/2006543/alparslan"}, "edited": false, "score": 0, "creation_date": 1463553904, "post_id": 37291610, "comment_id": 62108120, "body": "I know everything related to fc is dragged in, but I don&#39;t know why it is necessary, that is my question. btw, b.lib is properly licensed. But I kinda don&#39;t want to ship even its machine code when I don&#39;t need to, because we use b.lib for very special products, while a.lib is shared among all our products."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 161, "user_id": 2006543, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c1b746fcc1c6bfdae8c0cde8b2b6d91d?s=128&d=identicon&r=PG&f=1", "display_name": "Alparslan", "link": "https://stackoverflow.com/users/2006543/alparslan"}, "edited": false, "score": 0, "creation_date": 1463554391, "post_id": 37291610, "comment_id": 62108365, "body": "Without knowing the internals of b.lib, we can&#39;t say why it is all needed."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 161, "user_id": 2006543, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c1b746fcc1c6bfdae8c0cde8b2b6d91d?s=128&d=identicon&r=PG&f=1", "display_name": "Alparslan", "link": "https://stackoverflow.com/users/2006543/alparslan"}, "edited": false, "score": 0, "creation_date": 1463554468, "post_id": 37291610, "comment_id": 62108405, "body": "You say &quot;I kinda don&#39;t want to ship even its machine code when I don&#39;t need to, because we use b.lib for very special products&quot; but that doesn&#39;t make sense to me.  You have a license to use b.lib, use it when you need to - why does it matter to you if some of the machine code is dragged in?"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 161, "user_id": 2006543, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c1b746fcc1c6bfdae8c0cde8b2b6d91d?s=128&d=identicon&r=PG&f=1", "display_name": "Alparslan", "link": "https://stackoverflow.com/users/2006543/alparslan"}, "edited": false, "score": 0, "creation_date": 1463554497, "post_id": 37291610, "comment_id": 62108420, "body": "Are you trying to conceal from your customers you are using b.lib?  I wouldn&#39;t bother."}, {"owner": {"reputation": 161, "user_id": 2006543, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c1b746fcc1c6bfdae8c0cde8b2b6d91d?s=128&d=identicon&r=PG&f=1", "display_name": "Alparslan", "link": "https://stackoverflow.com/users/2006543/alparslan"}, "edited": false, "score": 0, "creation_date": 1463579741, "post_id": 37291610, "comment_id": 62125568, "body": "my reason may not immediately make sense, nonetheless, it is a technical question, and size of the final product really matters in most cases, especially mobile and embedded platforms. also, how internals of b.lib can affect the linkage of uncalled functions? can you give example?"}, {"owner": {"reputation": 161, "user_id": 2006543, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c1b746fcc1c6bfdae8c0cde8b2b6d91d?s=128&d=identicon&r=PG&f=1", "display_name": "Alparslan", "link": "https://stackoverflow.com/users/2006543/alparslan"}, "edited": false, "score": 0, "creation_date": 1463700322, "post_id": 37291610, "comment_id": 62188863, "body": "I&#39;m sorry but your answer is not really addressing the issue, only rephrasing the problem, so I can&#39;t accept it as an answer. I will have to wait someone else."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 161, "user_id": 2006543, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c1b746fcc1c6bfdae8c0cde8b2b6d91d?s=128&d=identicon&r=PG&f=1", "display_name": "Alparslan", "link": "https://stackoverflow.com/users/2006543/alparslan"}, "edited": false, "score": 0, "creation_date": 1463732982, "post_id": 37291610, "comment_id": 62200101, "body": "I <i>think</i> the correct answer is &quot;there is not much you can do about it&quot; - but that doesn&#39;t solve the problem, so certainly feel free not to accept it."}], "tags": [], "owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1463552000, "creation_date": 1463552000, "answer_id": 37291610, "question_id": 37290828, "link": "https://stackoverflow.com/questions/37290828/vc-linker-to-remove-indirect-dependencies-for-static-libraries/37291610#37291610", "title": "VC++ linker to remove indirect dependencies for static libraries", "body": "<p>The linker is dragging in all the statics that <code>fc</code> may be using (like a map of error numbers to strings), and all the functions (potentially) called by <code>fc</code>, and all the functions that the statics use to initialize themselves.</p>\n\n<p>I wouldn't worry about exposing your use of b.lib (providing you have properly licensed it), protecting the IPR in that is the vendor's problem.</p>\n\n<p>Executable size is a genuine concern, but I don't think there is much you can do about it.</p>\n"}], "owner": {"reputation": 161, "user_id": 2006543, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c1b746fcc1c6bfdae8c0cde8b2b6d91d?s=128&d=identicon&r=PG&f=1", "display_name": "Alparslan", "link": "https://stackoverflow.com/users/2006543/alparslan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1463552000, "creation_date": 1463548598, "question_id": 37290828, "link": "https://stackoverflow.com/questions/37290828/vc-linker-to-remove-indirect-dependencies-for-static-libraries", "title": "VC++ linker to remove indirect dependencies for static libraries", "body": "<p>Consider this scenario (everything in release mode):</p>\n\n<pre><code>a.lib includes f1() and f2().\na.lib is built using /LTCG on VS2015.\nf1() is local without any external function calls.\nf2() calls fc() from b.lib\n\nb.lib includes fc() and 100s of other functions.\nb.lib is built by a 3rd party, probably not VS.\n\nmain.exe is built only with main.cpp, using /LTCG on VS2015.\nmain.exe links to a.lib and b.lib\nmain.cpp only calls f1()\n</code></pre>\n\n<p>Now, when I build main.exe, I expect it to include only f1()'s implementation. The executable size is ~10MB.</p>\n\n<p>However, if I comment out f2()'s implementation in a.lib and rebuilt a.lib, then main.exe becomes 200KB. It works exactly the same in both cases.</p>\n\n<p>My concern is both the size of the executable and exposing anything about b.lib (which is not my own library) unnecessarily.</p>\n\n<p>Question: why is the linker not smart enough to not include f2()->fc() definitions? while it is smart enough to not include the rest of b.lib (which is more than 100MB)?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1159, "user_id": 3302647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/784a183178e06cdacc78678f3779cf7d?s=128&d=identicon&r=PG&f=1", "display_name": "shafeeq", "link": "https://stackoverflow.com/users/3302647/shafeeq"}, "edited": false, "score": 0, "creation_date": 1463548822, "post_id": 37290759, "comment_id": 62105939, "body": "data is an integer array.. your array prototype shows return type is an integer. :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5094975"}, "reply_to_user": {"reputation": 1159, "user_id": 3302647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/784a183178e06cdacc78678f3779cf7d?s=128&d=identicon&r=PG&f=1", "display_name": "shafeeq", "link": "https://stackoverflow.com/users/3302647/shafeeq"}, "edited": false, "score": 0, "creation_date": 1463549159, "post_id": 37290759, "comment_id": 62106064, "body": "should  i return it  as data[] ?"}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 1, "creation_date": 1463549255, "post_id": 37290759, "comment_id": 62106104, "body": "FILE fptr1 -&gt; FILE* fptr1"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5094975"}, "reply_to_user": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1463549412, "post_id": 37290759, "comment_id": 62106153, "body": "@sjsam would you elaborate it please"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1463549481, "post_id": 37290759, "comment_id": 62106180, "body": "You only ever use a <code>FILE *</code> in C; you never use a plain <code>FILE</code>.  All else apart, the standard says: <i>The address of the <code>FILE</code> object used to control a stream may be significant; a copy of a <code>FILE</code> object need not serve in place of the original.</i>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1463550068, "post_id": 37290759, "comment_id": 62106406, "body": "Amongst other things: you should not pass an uninitialized <code>FILE *</code> to the function; you may as well make the file stream pointer a local variable; you should pass the file name to the function; you should not blunder on after the file fails to open; you should report the error on standard error; your loop passes the same address to <code>scanf()</code> each time, so it will overwrite the same space each time; you should not pass <code>&amp;data</code> (you probably want <code>&amp;data[i]</code> where <code>i</code> is a counter from 0); you should pass the length of the array to the function so it doesn&#39;t overrun the available space."}], "answers": [{"tags": [], "owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "is_accepted": false, "score": 1, "last_activity_date": 1463553148, "last_edit_date": 1463553148, "creation_date": 1463549994, "answer_id": 37291151, "question_id": 37290759, "link": "https://stackoverflow.com/questions/37290759/send-and-receive-a-file-of-data-as-array-of-integers-to-a-function-in-c/37291151#37291151", "title": "Send and receive a file of data as array of integers to a function in C", "body": "<p>change </p>\n\n<pre><code>int getdata(int data[],FILE fptr1);\n</code></pre>\n\n<p>to </p>\n\n<pre><code>void getdata(int (*data)[80],FILE* f(*data)[80]ptr1)\n/* Case 1\n * You need a pointer to 80 member integer array\n * fptr1 is a pointer, a pointer should be passed as a pointer\n */\n</code></pre>\n\n<p>or</p>\n\n<pre><code> void getdata(int data[80],FILE* f(*data)[80]ptr1)\n/* Case 2\n * fptr1 is a pointer, a pointer should be passed as a pointer\n */\n</code></pre>\n\n<p>Change </p>\n\n<pre><code>(scanf(fptr1,\"%d\",&amp;data)!=EOF)\n</code></pre>\n\n<p>to </p>\n\n<pre><code>(fscanf(fptr1,\"%d\",data[i])==1) //case1\n// data is a pointer,so no ampersand preceeding it\n// fscanf returns the number of values filled\n</code></pre>\n\n<p>or</p>\n\n<pre><code>(fscanf(fptr1,\"%d\",&amp;data[i])==1) //case2\n\n// fscanf returns the number of values filled\n</code></pre>\n\n<p>Then remove </p>\n\n<pre><code>return data;\n</code></pre>\n\n<p><strong>Suggestion</strong></p>\n\n<p>It is good to maintain a count of number of values read, you may put</p>\n\n<pre><code>int count=0;\n</code></pre>\n\n<p>in the beginning of the function and then do</p>\n\n<pre><code>while((fscanf(fptr1,\"%d\",&amp;data)==1))\n        count++;\n</code></pre>\n\n<p>and replace </p>\n\n<pre><code>return data;\n</code></pre>\n\n<p>with </p>\n\n<pre><code>return count; // here function return type should be int.\n</code></pre>\n\n<p>In the main function capture the value of count and print the elements till count.</p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 6349052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8f75312c317cd8b880a45310dd2609e?s=128&d=identicon&r=PG&f=1", "display_name": "Nitish Khatri", "link": "https://stackoverflow.com/users/6349052/nitish-khatri"}, "is_accepted": false, "score": 1, "last_activity_date": 1463567383, "creation_date": 1463567383, "answer_id": 37296919, "question_id": 37290759, "link": "https://stackoverflow.com/questions/37290759/send-and-receive-a-file-of-data-as-array-of-integers-to-a-function-in-c/37296919#37296919", "title": "Send and receive a file of data as array of integers to a function in C", "body": "<p>The code seems fine with slight mistakes as below which need to be corrected ::</p>\n\n<ol>\n<li><p>In the getdata function, while reading from file you need to check and make sure it should not read more than 80*4 = 320 bytes from the file otherwise the array will overflow and will corrupt the stack area.</p></li>\n<li><p>In getdata function arguments, FILE should be replaced by FILE* as you are passing a file pointer.</p></li>\n<li><p>You should change the return type of getdata function to void and dont return any value from it. </p></li>\n</ol>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5094975"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1463567383, "creation_date": 1463548258, "last_edit_date": 1463549864, "question_id": 37290759, "link": "https://stackoverflow.com/questions/37290759/send-and-receive-a-file-of-data-as-array-of-integers-to-a-function-in-c", "title": "Send and receive a file of data as array of integers to a function in C", "body": "<p>I'm trying to pass the array elements to a function which is accessed from a file. But I'm clueless as what's wrong with my declaration, </p>\n\n<p>Here is the code, please help me out.</p>\n\n<pre><code>/*This program takes some random data from a file and \n  prepares a histogram for it.\n*/\n\nint getdata(int data[],FILE fptr1);\n\n#include&lt;stdio.h&gt;\n\nmain()\n{\n    int i,hist[15]={0},elements[15],data[80];\n    FILE * fptr1;\n\n    printf(\"welcome buddy\\n\");\n    getdata(data,fptr1);\n\n    for(i=1;i&lt;80;i++)\n        fprintf(stdout,\"%2d\",data[i]);\n\n}\n\nint getdata(int data[],FILE fptr1)\n{\n    fptr1=fopen(\"sampledata.txt\",\"r\");\n\n    if(fptr1==NULL)\n\n        printf(\"the file is not opened properly\\n\");\n\n    //for(i=0;i&lt;=79;i++)\n\n    //scanf(fptr1,\"%d\",&amp;data[i]);\n\n    while((scanf(fptr1,\"%d\",&amp;data)!=EOF))\n        ;\n\n    fclose(fptr1);\n\n    return data;\n}\n</code></pre>\n"}, {"tags": ["c", "glibc", "unistd.h"], "comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1463546304, "post_id": 37290230, "comment_id": 62105110, "body": "What version of glibc are you using? I don&#39;t have <code>libc_hidden_proto</code> anywhere, but I do remember it from old times ..."}, {"owner": {"reputation": 165, "user_id": 4334072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/301a3ad87e3135db80b523b8528cb3fc?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry Marbas", "link": "https://stackoverflow.com/users/4334072/jerry-marbas"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1463548845, "post_id": 37290230, "comment_id": 62105949, "body": "Thats strange. I&#39;m using glibc 2.19 but Im also looking at the unistd.h header file in glibc 2.18, 2.20, 2.21, and 2.23 and I see libc_hidden_proto in all those versions."}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 4334072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/301a3ad87e3135db80b523b8528cb3fc?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry Marbas", "link": "https://stackoverflow.com/users/4334072/jerry-marbas"}, "edited": false, "score": 0, "creation_date": 1463621532, "post_id": 37293022, "comment_id": 62145957, "body": "Thanks. I&#39;ve actually already read what it says in libc-symbols.h but I didnt understand what a PLT was and so I didnt mention libc-symbols in my question. But +1 for your answer anyways. Now I&#39;m off to read about the PLT, GOT, ELF files, linkers, dynamic loading and the rest of the other million other things I dont know about :P"}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "reply_to_user": {"reputation": 165, "user_id": 4334072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/301a3ad87e3135db80b523b8528cb3fc?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry Marbas", "link": "https://stackoverflow.com/users/4334072/jerry-marbas"}, "edited": false, "score": 0, "creation_date": 1463639060, "post_id": 37293022, "comment_id": 62150782, "body": "@jerry basically, it&#39;s like <code>-fsemantic-interposition</code> for just those symbols. And it only works within glibc due to all the other crazy stuff they do."}], "tags": [], "owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "is_accepted": true, "score": 4, "last_activity_date": 1463556839, "creation_date": 1463556839, "answer_id": 37293022, "question_id": 37290230, "link": "https://stackoverflow.com/questions/37290230/what-does-libc-hidden-proto-in-the-glibc-standard-libraries-do/37293022#37293022", "title": "What does libc_hidden_proto in the glibc standard libraries do?", "body": "<p>You've accidentally looked at the <em>internal</em> copy (<code>include/unistd.h</code>) instead of the public copy (<code>posix/unistd.h</code>). No, I don't understand how glibc's source is organized either.</p>\n\n<p>From <a href=\"https://code.woboq.org/userspace/glibc/include/libc-symbols.h.html#317\" rel=\"nofollow\">include/libc-symbols.h</a>:</p>\n\n<pre><code>   The following macros are used for PLT bypassing within libc.so\n   (and if needed other libraries similarly).\n   First of all, you need to have the function prototyped somewhere,\n   say in foo/foo.h:\n   int foo (int __bar);\n   If calls to foo within libc.so should always go to foo defined in libc.so,\n   then in include/foo.h you add:\n   libc_hidden_proto (foo)\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 4334072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/301a3ad87e3135db80b523b8528cb3fc?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry Marbas", "link": "https://stackoverflow.com/users/4334072/jerry-marbas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1613, "favorite_count": 1, "accepted_answer_id": 37293022, "answer_count": 1, "score": 4, "last_activity_date": 1463556839, "creation_date": 1463545121, "last_edit_date": 1463549031, "question_id": 37290230, "link": "https://stackoverflow.com/questions/37290230/what-does-libc-hidden-proto-in-the-glibc-standard-libraries-do", "title": "What does libc_hidden_proto in the glibc standard libraries do?", "body": "<p>I was trying to look up the prototype for the <code>getpgrp()</code> function in <code>unistd.h</code> but couldnt find it. The only line containing <em>getpgrp</em> in that file was the line <code>libc_hidden_proto (tcgetpgrp)</code> and I'm assuming this is a macro, but I dont know what it does. </p>\n\n<p>I googled but couldn't find any explanations on the web for what <code>libc_hidden_proto</code> actually does. Any explanation about what the purpose of that macro is in glibc would be appreciated.</p>\n"}, {"tags": ["c++", "c", "gcc", "shared-libraries", "rpath"], "comments": [{"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1463814129, "post_id": 37290222, "comment_id": 62234018, "body": "<a href=\"http://stackoverflow.com/help/mcve\">MVCE</a> needed,"}], "answers": [{"comments": [{"owner": {"reputation": 1028, "user_id": 2654470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09fdaef3f1f52aaf47067f1050b27013?s=128&d=identicon&r=PG", "display_name": "Spencer", "link": "https://stackoverflow.com/users/2654470/spencer"}, "edited": false, "score": 1, "creation_date": 1463617326, "post_id": 37311971, "comment_id": 62144908, "body": "Does this actually address the question? OP asked why  an external environment variable (<code>LD_LIBRARY_PATH</code>) was necessary when the required path was already built into the executable."}, {"owner": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "reply_to_user": {"reputation": 1028, "user_id": 2654470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09fdaef3f1f52aaf47067f1050b27013?s=128&d=identicon&r=PG", "display_name": "Spencer", "link": "https://stackoverflow.com/users/2654470/spencer"}, "edited": false, "score": 0, "creation_date": 1463623921, "post_id": 37311971, "comment_id": 62146507, "body": "I admit the answer was not satisfactory. I just edited it requesting more information. Sorry about that."}], "tags": [], "owner": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "is_accepted": false, "score": 2, "last_activity_date": 1463623880, "last_edit_date": 1592644375, "creation_date": 1463616563, "answer_id": 37311971, "question_id": 37290222, "link": "https://stackoverflow.com/questions/37290222/c-dynamically-linked-library-not-found-in-executable/37311971#37311971", "title": "C++ dynamically linked library not found in executable", "body": "<p>From <a href=\"http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html\" rel=\"nofollow noreferrer\">here</a>:</p>\n<blockquote>\n<p>In Linux, the environment variable LD_LIBRARY_PATH is a colon-separated set of directories where libraries should be searched for first, before the standard set of directories</p>\n</blockquote>\n<p>As a tip, you should be careful not to replace entirely your LD_LIBRARY_PATH. It could mess up the path for the system shared libraries.\nAlways use <code>export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/your/path</code>.</p>\n<p><strong>EDIT 1:</strong></p>\n<p>As for the <code>rpath</code>, make sure that <code>libTest.so</code> doesn't depend on any other library. As an alternative you can use <code>-rpath-link</code> option in gcc instead of <code>-rpath</code>, as seen <a href=\"https://ftp.gnu.org/old-gnu/Manuals/ld-2.9.1/html_node/ld_3.html\" rel=\"nofollow noreferrer\">here</a>:</p>\n<blockquote>\n<p>-rpath-link DIR</p>\n<p>When using ELF or SunOS, one shared library may require another. This happens when an ld -shared link includes a shared library as one of the input files. When the linker encounters such a dependency when doing a non-shared, non-relocateable link, it will automatically try to locate the required shared library and include it in the link, if it is not included explicitly. In such a case, the -rpath-link option specifies the first set of directories to search.</p>\n</blockquote>\n<p><strong>EDIT 2:</strong></p>\n<p>If you want more help, please provide:</p>\n<ol>\n<li>Exact parameter for <code>rpath</code> used during compile</li>\n<li>Output for <code>ldd /path/to/binary</code> command</li>\n<li>Output for <code>readelf -d /path/to/binary</code></li>\n</ol>\n"}], "owner": {"reputation": 1745, "user_id": 1583670, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/8N9DU.png?s=128&g=1", "display_name": "bohanl", "link": "https://stackoverflow.com/users/1583670/bohanl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2550, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1463623880, "creation_date": 1463545075, "last_edit_date": 1463556360, "question_id": 37290222, "link": "https://stackoverflow.com/questions/37290222/c-dynamically-linked-library-not-found-in-executable", "title": "C++ dynamically linked library not found in executable", "body": "<p>I have a <code>.so</code> in the path <code>/home/test/lib/libTest.so</code> and an executable called <code>myexec</code> that is built with <code>RPATH</code> pointing to <code>/home/test/lib/</code>. However, when I did <code>ldd</code> on <code>myexec</code>, it says <code>libTest.so</code> not found and I had to do <code>export LD_LIBRARY_PATH</code> in order for it to work.</p>\n\n<p>I have confirmed:</p>\n\n<ol>\n<li><code>libTest.so</code> does exist in <code>/home/test/lib/</code></li>\n<li><code>objdump -x myexec | grep RUNPATH</code> does indicate <code>/home/test/lib/</code> is built into the executable.</li>\n</ol>\n\n<p>Does anyone have idea why it couldn't find the library without setting <code>LD_LIBRARY_PATH</code>?</p>\n"}, {"tags": ["c", "spacing"], "comments": [{"owner": {"reputation": 1159, "user_id": 3302647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/784a183178e06cdacc78678f3779cf7d?s=128&d=identicon&r=PG&f=1", "display_name": "shafeeq", "link": "https://stackoverflow.com/users/3302647/shafeeq"}, "edited": false, "score": 0, "creation_date": 1463543569, "post_id": 37289848, "comment_id": 62104329, "body": "what do you mean by main spaces?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1463544106, "post_id": 37289848, "comment_id": 62104509, "body": "Please note that all the variables in the program should be local to <code>main()</code>; not one of them needs to be a global variable.  You should avoid globals as much as possible.  They&#39;re sometimes necessary and the best way to deal with a situation.  However, in the ordinary course of coding, variables should be local to the function where they&#39;re used."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1463544223, "post_id": 37289848, "comment_id": 62104541, "body": "It seems that you can&#39;t use the <i>string.h</i> headers, is that correct?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463544367, "post_id": 37289848, "comment_id": 62104578, "body": "What happens if the user types several spaces between a word?  How do you calculate how many spaces you need to add?  Do you simply need to print the information, or do you need to make an array that can be printed?  What happens if the user specifies 40 but enters 50 characters?  What happens if they enter 128 characters?  Given that the N words add up to L characters, plus N-1 spaces, you need to add W - (N - 1) - L spaces more or less evenly to the result?  How are you going to do that?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1463544472, "post_id": 37289848, "comment_id": 62104596, "body": "@iharob: the code includes <code>&lt;string.h&gt;</code> and uses <code>strlen()</code> \u2014 those suggest that the functions can be used."}, {"owner": {"reputation": 31, "user_id": 6196139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3dd90c818725eb9f105f47a7f6d34cd?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/6196139/j-doe"}, "edited": false, "score": 0, "creation_date": 1463544646, "post_id": 37289848, "comment_id": 62104645, "body": "By main spaces I mean the spaces that arent a remainder. And we assume that the user types in one space between each word. If it was a column of 10 and the string was 6 characters long (lets just say the string was &quot;hey hi&quot; there would need to be 4 spaces added to the middle of them."}, {"owner": {"reputation": 31, "user_id": 6196139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3dd90c818725eb9f105f47a7f6d34cd?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/6196139/j-doe"}, "edited": false, "score": 0, "creation_date": 1463545549, "post_id": 37289848, "comment_id": 62104890, "body": "How can I use strtok to split the string into seperate words, then add a read in amount of spaces after each word?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463548597, "post_id": 37289848, "comment_id": 62105849, "body": "Do you know how to handle arrays of pointers?"}, {"owner": {"reputation": 31, "user_id": 6196139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3dd90c818725eb9f105f47a7f6d34cd?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/6196139/j-doe"}, "edited": false, "score": 0, "creation_date": 1463549274, "post_id": 37289848, "comment_id": 62106112, "body": "How can you split up the words in my string into separate words?"}], "answers": [{"comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 2, "creation_date": 1463544222, "post_id": 37289992, "comment_id": 62104540, "body": "This sounds more like a comment. PS. I did not downvote."}, {"owner": {"reputation": 13430, "user_id": 622571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41523c6db74e0f187eae731a6871a320?s=128&d=identicon&r=PG", "display_name": "Richard Schwartz", "link": "https://stackoverflow.com/users/622571/richard-schwartz"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1463545654, "post_id": 37289992, "comment_id": 62104927, "body": "It&#39;s not a comment. This question looks like a homework problem. As per the FAQ: &quot;Questions asking for homework help must include a summary of the work you&#39;ve done so far to solve the problem, and a description of the difficulty you are having solving it.&quot; The difficulty was not described here, so I inferred it from what is not present in the code sample. I don&#39;t write code for homework questions. I suggest ways to think about the problem to help the questioner understand how to break it down the way an experienced developer would, and I point to code in existing answers when appropriate."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1463545774, "post_id": 37289992, "comment_id": 62104954, "body": "If a question is not clear, vote to close it, downvote it. Don&#39;t answer it with a poor quality answer."}, {"owner": {"reputation": 13430, "user_id": 622571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41523c6db74e0f187eae731a6871a320?s=128&d=identicon&r=PG", "display_name": "Richard Schwartz", "link": "https://stackoverflow.com/users/622571/richard-schwartz"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1463545976, "post_id": 37289992, "comment_id": 62105008, "body": "I respectfully disagree on both counts."}, {"owner": {"reputation": 13430, "user_id": 622571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41523c6db74e0f187eae731a6871a320?s=128&d=identicon&r=PG", "display_name": "Richard Schwartz", "link": "https://stackoverflow.com/users/622571/richard-schwartz"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1463546099, "post_id": 37289992, "comment_id": 62105046, "body": "That said, I would prefer that homework questions were not welcomed here on StackOverflow at all, but they are."}], "tags": [], "owner": {"reputation": 13430, "user_id": 622571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41523c6db74e0f187eae731a6871a320?s=128&d=identicon&r=PG", "display_name": "Richard Schwartz", "link": "https://stackoverflow.com/users/622571/richard-schwartz"}, "is_accepted": false, "score": 0, "last_activity_date": 1463543607, "last_edit_date": 1495540305, "creation_date": 1463543607, "answer_id": 37289992, "question_id": 37289848, "link": "https://stackoverflow.com/questions/37289848/adding-spaces-between-words-in-a-string-c/37289992#37289992", "title": "Adding spaces between words in a string c", "body": "<p>You need to break your input string into separate words.  Take a look at the answers to <a href=\"https://stackoverflow.com/questions/26330219/split-line-into-array-of-words-c\">this earlier question on StackOverflow</a> for some techniques that you can use for that. </p>\n\n<p>After that, it's just a matter of emitting the separate words with the correct number of spaces in between.</p>\n"}, {"tags": [], "owner": {"reputation": 1639, "user_id": 2073349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0266d3aafa1813f794a5b71058d5cd27?s=128&d=identicon&r=PG", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/2073349/ritesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1463546846, "last_edit_date": 1463546846, "creation_date": 1463546511, "answer_id": 37290458, "question_id": 37289848, "link": "https://stackoverflow.com/questions/37289848/adding-spaces-between-words-in-a-string-c/37290458#37290458", "title": "Adding spaces between words in a string c", "body": "<p>One of the many ways to do it.</p>\n\n<p>Suppose totalSpace is the buffer length in which we have to fit the string.\nand str = the original string we have.</p>\n\n<p>Algo:</p>\n\n<pre><code>int extraSpace = totalSpace - strlen(str);\nint numWords = findWordsInString(str);\nint numSpaces = numWords - 1;\nint incrementEachSpaceby = extraSpace/numSpace;\n\n//Now linear scan of str and increase spaces by value of incrementEachSpaceby \n\n    char *newStr = malloc(totalspace);\n    int i =0, int j = 0;\n    int k;\n    while (i &lt; strlen(str) &amp;&amp; j &lt; totalspace)\n    {\n        while (str[i] != ' ') {\n            newStr[j++] = str[i++];\n        }\n\n        while (str[i] == ' ')\n            newStr[j++] = str[i++];\n\n        k = incrementEachSpaceby;\n\n        while (k) { \n            newStr[j++] = ' ';\n            k--;\n        }\n    }\n</code></pre>\n\n<p>This is just a superficial idea. you can improve it further.</p>\n"}], "owner": {"reputation": 31, "user_id": 6196139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3dd90c818725eb9f105f47a7f6d34cd?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/6196139/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 12009, "favorite_count": 0, "closed_date": 1463568351, "answer_count": 2, "score": 3, "last_activity_date": 1473019251, "creation_date": 1463542721, "last_edit_date": 1473019251, "question_id": 37289848, "link": "https://stackoverflow.com/questions/37289848/adding-spaces-between-words-in-a-string-c", "closed_reason": "Duplicate", "title": "Adding spaces between words in a string c", "body": "<p>I am trying to write a program to insert spaces between words to fit a column, for example:</p>\n\n<ul>\n<li>You read in a line of text, eg: <code>Good morning how are you?</code></li>\n<li>You read in the width of the column, eg: <code>40</code>.</li>\n<li>Then I have counted how many spaces there are in this text (4).</li>\n<li>Now I need to distribute the remaining spaces in between these words so the length of the text is 40.</li>\n</ul>\n\n<p>For example:</p>\n\n<pre><code>Good     morning     how     are    you?\n1234567890123456789012345678901234567890\n</code></pre>\n\n<p>My problem comes when I try to insert the spaces in between words as I don't know how to do this. This is what I have so far.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nchar text[65], spaces[50], ch;\nint i, remainder, spacesr, count, column, length, distribution;\nint main(){\n    i = 0;\n    count = 0;\n    printf(\"Please enter a line of text: \");\n    while(ch != '\\n')\n    {\n        ch = getchar();\n        text[i]=ch;\n        i++;\n    }\n    text[i]='\\0'; \n    printf(\"Text: %s\",text);\n    printf (\"Please enter the width of the column: \");\n    scanf (\"%d\", &amp;column);\n    for (i = 0; text[i] != '\\0'; i++) {\n        if (text[i] == ' ') {\n            count++;\n        }\n    }\n    length = strlen(text);\n    spacesr = column - length;\n    distribution = spacesr / count;\n    remainder = spacesr % count;\n    if (length &gt; column) {\n        printf (\"ERROR: Length of text exceeds column width.\");\n    }\n}\n</code></pre>\n\n<p>I have calculated the amount of spaces in the read in text, then calculated the amount of spaces I would have remaining, then divided that by the amount of spaces to determine how many spaces I need to put between each word. The remainder of these spaces will be distributed evenly after the main spaces have been entered.</p>\n\n<blockquote>\n  <p>What do you mean by main spaces?</p>\n</blockquote>\n\n<p>Basically I want to fit the phrase \"Good morning how are you?\" to a column 40 characters wide by adding spaces between words. Is it possible to do something like this:</p>\n\n<pre><code>for (i = 0; text[i] != '\\0'; i++) {\n    if (text[i] == ' ') {\n    then add a certain amount of spaces to it\n</code></pre>\n"}, {"tags": ["c", "gcc", "segmentation-fault"], "comments": [{"owner": {"reputation": 42229, "user_id": 1290731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd21d706444339285b779efb2e5f34e?s=128&d=identicon&r=PG", "display_name": "jthill", "link": "https://stackoverflow.com/users/1290731/jthill"}, "edited": false, "score": 0, "creation_date": 1463541148, "post_id": 37289389, "comment_id": 62103697, "body": "&quot;as expected&quot; \u2190 there&#39;s your problem.  &quot;Undefined behavior&quot; means just that."}, {"owner": {"reputation": 297, "user_id": 2088861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/184a836537321a34415eb79fe8d7b5c9?s=128&d=identicon&r=PG", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2088861/mahdi"}, "reply_to_user": {"reputation": 42229, "user_id": 1290731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd21d706444339285b779efb2e5f34e?s=128&d=identicon&r=PG", "display_name": "jthill", "link": "https://stackoverflow.com/users/1290731/jthill"}, "edited": false, "score": 0, "creation_date": 1463544624, "post_id": 37289389, "comment_id": 62104638, "body": "Thanks, my expectation was totally wrong"}], "answers": [{"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 3, "last_activity_date": 1463539685, "last_edit_date": 1495542267, "creation_date": 1463539685, "answer_id": 37289404, "question_id": 37289389, "link": "https://stackoverflow.com/questions/37289389/unpredictable-behavior-for-strcpym1-m/37289404#37289404", "title": "Unpredictable behavior for strcpy(m+1,m)", "body": "<p>This causes <a href=\"https://stackoverflow.com/a/4105123/1505939\">undefined behaviour</a>.  <code>strcpy</code> may only be used between areas that do not overlap.</p>\n\n<p>To fix this code you could write:</p>\n\n<pre><code>memmove(m+1, m, strlen(m) + 1);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1463541513, "last_edit_date": 1463541513, "creation_date": 1463541133, "answer_id": 37289608, "question_id": 37289389, "link": "https://stackoverflow.com/questions/37289389/unpredictable-behavior-for-strcpym1-m/37289608#37289608", "title": "Unpredictable behavior for strcpy(m+1,m)", "body": "<p>The memory for <code>m</code> is:</p>\n\n<pre><code>+---+---+---+---+---+---+---+---+---+---+\n|   |   |   |   |   |   |   |   |   |   |\n+---+---+---+---+---+---+---+---+---+---+\n</code></pre>\n\n<p>Whe you initialize it with:</p>\n\n<pre><code>char m[10] = \"dog\";\n</code></pre>\n\n<p>the first four elements <code>m</code> are initialized. The rest are initialized.</p>\n\n<pre><code>+---+---+---+----+---+---+---+---+---+---+\n| d | o | g | \\0 | ? | ? | ? | ? | ? | ? |\n+---+---+---+----+---+---+---+---+---+---+\n</code></pre>\n\n<p>I am using <code>?</code> to indicate uninitialized memory locations. They could\ncontain anything.</p>\n\n<p>Let's walk through the execution of </p>\n\n<pre><code>strcpy(m+1, m);\n</code></pre>\n\n<p>step by step.</p>\n\n<p>Step 1: <code>m[0]</code> is copied to <code>m[1]</code>. So you have:</p>\n\n<pre><code>+---+---+---+----+---+---+---+---+---+---+\n| d | d | g | \\0 | ? | ? | ? | ? | ? | ? |\n+---+---+---+----+---+---+---+---+---+---+\n</code></pre>\n\n<p>Step 2: <code>m[1]</code> is copied to <code>m[2]</code>. So you have:</p>\n\n<pre><code>+---+---+---+----+---+---+---+---+---+---+\n| d | d | d | \\0 | ? | ? | ? | ? | ? | ? |\n+---+---+---+----+---+---+---+---+---+---+\n</code></pre>\n\n<p>Step 3: <code>m[2]</code> is copied to <code>m[3]</code>. So you have:</p>\n\n<pre><code>+---+---+---+---+---+---+---+---+---+---+\n| d | d | d | d | ? | ? | ? | ? | ? | ? |\n+---+---+---+---+---+---+---+---+---+---+\n</code></pre>\n\n<p><code>strcpy</code> terminates when it encounters the null character in the source\nargument.  As you can see, the terminating criteria for <code>strcpy</code> will never\nbe met. Hence, the program keeps on reading data from memory beyond the\nvalid limits and writing data to memory beyond valid limits.</p>\n\n<p>That is cause for undefined behavior.</p>\n\n<p>To get the desired result, <code>\"ddog\"</code>, you can to use:</p>\n\n<pre><code>size_t len = strlen(m);\nfor ( int i = len; i &gt;= 0; --i )\n{\n   m[i+i] = m[i];\n}\n</code></pre>\n"}], "owner": {"reputation": 297, "user_id": 2088861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/184a836537321a34415eb79fe8d7b5c9?s=128&d=identicon&r=PG", "display_name": "Mahdi", "link": "https://stackoverflow.com/users/2088861/mahdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 37289404, "answer_count": 2, "score": -6, "last_activity_date": 1546404652, "creation_date": 1463539581, "last_edit_date": 1463539609, "question_id": 37289389, "link": "https://stackoverflow.com/questions/37289389/unpredictable-behavior-for-strcpym1-m", "title": "Unpredictable behavior for strcpy(m+1,m)", "body": "<p>I was working with an example regarding seg fault:</p>\n\n<pre><code>char m[10]=\"dog\";\nstrcpy(m+1,m);\n</code></pre>\n\n<p>In my centOs machine the result was as expected: segmentation fault. but on Ubuntu nothing happen. then I add a printf(\"%s\",m); to the code on ubuntu and surprisingly I got the \"ddog\" as result. \nI am using GCC and the ubuntu version was the latest.\ncan anyone tell me why the results are different. I also check it on raspbian and I also received segmentation fault.</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["c++", "c", "qt", "opencv"], "answers": [{"tags": [], "owner": {"reputation": 3686, "user_id": 3132173, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6873ee643c6e04fa734682dc57104b5c?s=128&d=identicon&r=PG&f=1", "display_name": "A. Sarid", "link": "https://stackoverflow.com/users/3132173/a-sarid"}, "is_accepted": false, "score": 0, "last_activity_date": 1463548592, "creation_date": 1463548592, "answer_id": 37290824, "question_id": 37289184, "link": "https://stackoverflow.com/questions/37289184/opencv-integration-with-qt/37290824#37290824", "title": "OpenCV integration With Qt", "body": "<p>I suggest you to follow <a href=\"http://rodrigoberriel.com/2014/11/using-opencv-3-qt-creator-3-2-qt-5-3/\" rel=\"nofollow\">this</a> for installing and using OpenCV with Qt.  </p>\n\n<p>Make sure that you compile your OpenCV without the <code>WITH_QT=ON</code> flag. Will be better even to set it to <code>WITH_QT=OFF</code> just to make sure, even though it suppose to be the default.</p>\n"}], "owner": {"reputation": 1, "user_id": 6348514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e9bb2c93398152d2ecfd4a4a6bc2f0?s=128&d=identicon&r=PG&f=1", "display_name": "Curioso", "link": "https://stackoverflow.com/users/6348514/curioso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 647, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463548592, "creation_date": 1463538165, "question_id": 37289184, "link": "https://stackoverflow.com/questions/37289184/opencv-integration-with-qt", "title": "OpenCV integration With Qt", "body": "<p>I am having a problem integrating my openCV with QT. What I have done is installed openCV and Qt for Mac OSX (openCV version 3.1.0) and have went to the myproject.pro file and have added</p>\n\n<pre><code>#-------------------------------------------------\n#\n# Project created by QtCreator 2016-05-15T23:16:25\n#\n#-------------------------------------------------\n\nQT       += core gui\n\ngreaterThan(QT_MAJOR_VERSION, 4): QT += widgets\n\nTARGET = cam\nTEMPLATE = app\n\n\n\n\n// new\nQT       += core\nQT       -= gui\n\nTARGET = RP_openCV_01\nCONFIG   += console\nCONFIG   -= app_bundle\n\nTEMPLATE = app\n\nSOURCES += main.cpp\\\n        mainwindow.cpp\n\nLIBS += -L/opt/local/lib \\\n-lopencv_highgui.3.1.0 \\\n-lopencv_core.3.1.0\n\nINCLUDEPATH += /opt/local/include\n\n\nHEADERS  += mainwindow.h\n\nFORMS    += mainwindow.ui\n</code></pre>\n\n<p>I have tried to add the header files to the main .cpp and have errors stating files not found, can someone please explain to em the appropriate set-up?</p>\n"}, {"tags": ["c", "macos", "gcc"], "comments": [{"owner": {"reputation": 104340, "user_id": 23649, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7e9f543f0ffdb7c9a899e628fe76e7f3?s=128&d=identicon&r=PG", "display_name": "jtbandes", "link": "https://stackoverflow.com/users/23649/jtbandes"}, "edited": false, "score": 0, "creation_date": 1463538395, "post_id": 37289170, "comment_id": 62103020, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1463554179, "post_id": 37289170, "comment_id": 62108256, "body": "You already helped <a href=\"http://stackoverflow.com/questions/37277919/undefined-symbols-for-architecture-x86-64-gcc#comment62087253_37277919\">into this post</a>.... Why post a new identical one?.."}], "owner": {"reputation": 31, "user_id": 6345979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ad480ecf9470541d9e44c0c73692c3?s=128&d=identicon&r=PG&f=1", "display_name": "Liang Guo", "link": "https://stackoverflow.com/users/6345979/liang-guo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 470, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1463538354, "creation_date": 1463538075, "last_edit_date": 1463538354, "question_id": 37289170, "link": "https://stackoverflow.com/questions/37289170/undefined-symbols-for-architecture-x86-64-mac-gcc", "title": "Undefined symbols for architecture x86_64: mac gcc", "body": "<p>I installed gcc 5.3.0 on my mac pro, and i want to compile a c program by using </p>\n\n<pre><code>gcc main.c -o matrix -mcmodel=medium -lm \n</code></pre>\n\n<p>however I received this error: </p>\n\n<pre><code>Undefined symbols for architecture x86_64: \n\n\"_GLOBAL_OFFSET_TABLE_\", referenced from: \n_stressXXSX in ccxZn6ac.o \n_stressYYSX in ccxZn6ac.o \n_stressXYSX in ccxZn6ac.o \n_stressYZSX in ccxZn6ac.o \n_stressZZSX in ccxZn6ac.o\n _stressXZSX in ccxZn6ac.o \n_stressXXN in ccxZn6ac.o ...\nld: symbol(s) not found for architecture x86_64 collect2: erro\uff1ald return 1.\n</code></pre>\n\n<p><code>_stressXXSX</code> is a sub function defined before main(). This program is ok when it was compiled on the old computer with ubuntu system.</p>\n\n<p>Thank your for all your suggestion and help!</p>\n"}, {"tags": ["c", "gcc", "ubuntu-14.04"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463537759, "post_id": 37288961, "comment_id": 62102882, "body": "Segment fault is not awakened in the shown example code &amp; input."}, {"owner": {"reputation": 617, "user_id": 6312276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1e83b215dd0cf1643c588e8ac68fc5?s=128&d=identicon&r=PG&f=1", "display_name": "alessandrocb", "link": "https://stackoverflow.com/users/6312276/alessandrocb"}, "edited": false, "score": 0, "creation_date": 1463538086, "post_id": 37288961, "comment_id": 62102952, "body": "See my explanation on why your strcmp always return 0."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463538823, "post_id": 37288961, "comment_id": 62103151, "body": "Fix the warnings \u2014 the compiler is trying to tell you that you&#39;ve got mistakes in your code. (You removed the <code>&amp;</code> from <code>&amp;s1</code> in the call to <code>scanf()</code>. The code I see doesn&#39;t generate warnings for me with that change.)  What does crash is the <code>strcat()</code> operation when the names I type are long enough (I used <code>abracadabra</code> and <code>&#39;persephone</code>, for 11 + 10, which are too long to fit in <code>s1</code>).  You should make sure there&#39;s enough space before concatenating strings.  You should check that <code>scanf()</code> worked, and limit the input with <code>if (scanf(&quot;%19s&quot;, s1) != 1) { \u2026process error\u2026; }</code>, etc."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463540373, "post_id": 37288961, "comment_id": 62103504, "body": "so... you fixed the code and it works now?"}, {"owner": {"reputation": 617, "user_id": 6312276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1e83b215dd0cf1643c588e8ac68fc5?s=128&d=identicon&r=PG&f=1", "display_name": "alessandrocb", "link": "https://stackoverflow.com/users/6312276/alessandrocb"}, "edited": false, "score": 0, "creation_date": 1463541320, "post_id": 37288961, "comment_id": 62103745, "body": "I tested here and it&#39;s working now, he just didn&#39;t mark anything as the answer, just edited his question, even for the right ones."}, {"owner": {"reputation": 293, "user_id": 3799061, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6be43888ffbde83daf4bc285a84bde9?s=128&d=identicon&r=PG", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/3799061/prasanna"}, "reply_to_user": {"reputation": 617, "user_id": 6312276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1e83b215dd0cf1643c588e8ac68fc5?s=128&d=identicon&r=PG&f=1", "display_name": "alessandrocb", "link": "https://stackoverflow.com/users/6312276/alessandrocb"}, "edited": false, "score": 0, "creation_date": 1463552311, "post_id": 37288961, "comment_id": 62107276, "body": "@AlessandroCaetano, I was away from my PC. Just accepted your answer. Thanks for pointing out the logical mistake"}], "answers": [{"tags": [], "owner": {"reputation": 617, "user_id": 6312276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1e83b215dd0cf1643c588e8ac68fc5?s=128&d=identicon&r=PG&f=1", "display_name": "alessandrocb", "link": "https://stackoverflow.com/users/6312276/alessandrocb"}, "is_accepted": true, "score": 2, "last_activity_date": 1463546750, "last_edit_date": 1463546750, "creation_date": 1463536928, "answer_id": 37288995, "question_id": 37288961, "link": "https://stackoverflow.com/questions/37288961/string-comparison-in-c-gives-segmentation-fault/37288995#37288995", "title": "String comparison in C gives segmentation fault", "body": "<p>Just remove the pointers on lines:</p>\n\n<pre><code>printf(\"S1 is %s\\n\",*s1);\nprintf(\"S2 is %s\\n\",*s2);\n</code></pre>\n\n<p>To be like this:</p>\n\n<pre><code>printf(\"S1 is %s\\n\",s1);\nprintf(\"S2 is %s\\n\",s2);\n</code></pre>\n\n<p>To know more about pointers in c, there are a lot of tutorials on the internet, like this one: <a href=\"http://karwin.blogspot.com.br/2012/11/c-pointers-explained-really.html\" rel=\"nofollow\">http://karwin.blogspot.com.br/2012/11/c-pointers-explained-really.html</a></p>\n\n<p>To know more about c and c++ functions you can relate to their official documentation, here on this link: <a href=\"http://en.cppreference.com/w/\" rel=\"nofollow\">http://en.cppreference.com/w/</a></p>\n\n<p><strong>EDIT:</strong>\nOn this line, you're making a strcat:</p>\n\n<pre><code>strcat(s1,s2)\n</code></pre>\n\n<p>So s1 will have the value of s1+s2, but on the next line you're making a copy of s2 into s1.</p>\n\n<pre><code>strcpy(s1,s2)\n</code></pre>\n\n<p>After that, s1 will have the same value as s2, so s1 is now equals s2. That's why your strcmp is always returning 0. You can see that happening on your output.</p>\n\n<pre><code>S1 is test      #S1 initialy\nS2 is case      #S2 initialy\nS1 is testcase  #S1 after strcat(s1,s2)\nS1 is case      #S1 after strcpy(s1,s2)\n</code></pre>\n\n<p><strong>As you can see S1 have the same value as S2 in the end.</strong></p>\n\n<p>This should work :)</p>\n"}, {"comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1463537496, "post_id": 37289006, "comment_id": 62102812, "body": "<code>#define LENGTH 20;</code> --&gt; <code>#define LENGTH 20</code>, <code>char str[LENGTH];</code> --&gt; <code>char str[LENGTH+1];</code>, <code>scanf(&quot;%&quot; #LENGTH &quot;s&quot;)</code> is bad."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463540340, "post_id": 37289006, "comment_id": 62103494, "body": "@BLUEPIXY Thanks - I fixed the first 2 issues (and zeroed-out the <code>str</code> array), but what is wrong with my usage of <code>scanf</code>?"}], "tags": [], "owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "is_accepted": false, "score": 2, "last_activity_date": 1463540264, "last_edit_date": 1463540264, "creation_date": 1463537008, "answer_id": 37289006, "question_id": 37288961, "link": "https://stackoverflow.com/questions/37288961/string-comparison-in-c-gives-segmentation-fault/37289006#37289006", "title": "String comparison in C gives segmentation fault", "body": "<p>You're using <code>scanf</code> incorrectly. I suspect your program's state is being corrupted by the call to <code>scanf</code> but it isn't being discovered until you call <code>strcmp</code>.</p>\n\n<p>When using <code>scanf</code> to read standard-input into a string, use this format:</p>\n\n<pre><code>#define LENGTH 20\nchar str[LENGTH+1] = {0};\nscanf(\"%20s\", str); // note the \"max-length\" format parameter of 20.\n</code></pre>\n\n<p>By using the address-of operator (<code>&amp;</code>) it means <code>scanf</code> will write to the address defined by the <strong>value</strong> passed-in, as you don't set an initial value for your <code>s1</code> value your program's behaviour is undefined.</p>\n\n<p>To be safer, consider using the <code>LENGTH</code> define'd value in the format-string, so the value of <code>20</code> isn't repeated:</p>\n\n<pre><code>scanf(\"%\" #LENGTH \"s\", str)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 293, "user_id": 3799061, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6be43888ffbde83daf4bc285a84bde9?s=128&d=identicon&r=PG", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/3799061/prasanna"}, "edited": false, "score": 0, "creation_date": 1463537143, "post_id": 37289015, "comment_id": 62102725, "body": "why should we skip the <code>&amp;</code> symbol in this <code>scanf</code>?"}, {"owner": {"reputation": 3633, "user_id": 675154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23da6806cab4830b5d1b15ef2a410541?s=128&d=identicon&r=PG", "display_name": "delta", "link": "https://stackoverflow.com/users/675154/delta"}, "reply_to_user": {"reputation": 293, "user_id": 3799061, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6be43888ffbde83daf4bc285a84bde9?s=128&d=identicon&r=PG", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/3799061/prasanna"}, "edited": false, "score": 1, "creation_date": 1463537298, "post_id": 37289015, "comment_id": 62102763, "body": "@Prasanna For a normal <code>int x;</code>, <code>&amp;x</code> is its address. For an array <code>char s[MAXN];</code>, <code>s</code> itself is the starting address of the string."}], "tags": [], "owner": {"reputation": 3633, "user_id": 675154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23da6806cab4830b5d1b15ef2a410541?s=128&d=identicon&r=PG", "display_name": "delta", "link": "https://stackoverflow.com/users/675154/delta"}, "is_accepted": false, "score": 1, "last_activity_date": 1463537038, "creation_date": 1463537038, "answer_id": 37289015, "question_id": 37288961, "link": "https://stackoverflow.com/questions/37288961/string-comparison-in-c-gives-segmentation-fault/37289015#37289015", "title": "String comparison in C gives segmentation fault", "body": "<p><code>scanf</code>'s second argument is supposed to have an address, which is <code>s1</code> and <code>s2</code>. Change it to:</p>\n\n<pre><code>scanf(\"%s\", s1);\nscanf(\"%s\", s2);\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 3799061, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6be43888ffbde83daf4bc285a84bde9?s=128&d=identicon&r=PG", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/3799061/prasanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 819, "favorite_count": 0, "accepted_answer_id": 37288995, "answer_count": 3, "score": -2, "last_activity_date": 1463546750, "creation_date": 1463536628, "last_edit_date": 1463537285, "question_id": 37288961, "link": "https://stackoverflow.com/questions/37288961/string-comparison-in-c-gives-segmentation-fault", "title": "String comparison in C gives segmentation fault", "body": "<p>I'm teaching someone C programming with simple exercises.<br>\nI'm unable to get the <code>strcmp()</code> function to work.  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#define MAX 20\nint main()\n{\n  char s1[MAX], s2[MAX];\n  printf(\"Enter s1: \");\n  scanf(\"%s\",s1);\n  printf(\"Enter s2: \");\n  scanf(\"%s\",s2);\n  printf(\"S1 is %s\\n\",s1);\n  printf(\"S2 is %s\\n\",s2);\n  // string concatenation\n  strcat(s1,s2);\n  printf(\"S1 is %s\\n\",s1);\n  // string copy\n  strcpy(s1,s2);\n  printf(\"S1 is %s\\n\",s1);\n  // find the length of the string\n  int a = strlen(s1);\n  printf (\"Length of S1 is %d\\n\", a);\n  int b = strlen(s2);\n  printf (\"Length of S2 is %d\\n\", b);\n  // string comparison               &lt;&lt;----- This is where it does not work\n  int c;\n  c = strcmp(s1, s2);\n  printf(\"C is %d\\n\",c);\n  if (c==0)\n    printf(\"S1 = S2\\n\");\n  else if (c&lt;0)\n    printf(\"S1&lt;S2\\n\");\n  else \n    printf(\"S1&gt;S2\\n\");\n  return 0;\n}\n</code></pre>\n\n<p>The above code compiles (with warnings) but does not execute. It throws <code>segmentation fault</code> error and quits.\nI used the pointer style syntax too, but it gets me errors during compile.</p>\n\n<p>As a side note, I saw lot of websites using <code>gets()</code> <code>puts()</code>. But when used in my programs it tells me that the use of the above functions are deprecated. How to determine which functions can be used and where to look for them?</p>\n\n<p><strong>EDIT</strong><br>\nProgram output:  </p>\n\n<pre>\nprasannarajaram@ubuntu:~/Documents/programs/C$ ./string\nEnter s1: test\nEnter s2: case\nS1 is test\nS2 is case\nS1 is testcase\nS1 is case\nLength of S1 is 4\nLength of S2 is 4\nC is 0\nS1 = S2\n</pre>\n\n<p>This is where I started adding <code>*</code> pointer symbols to try to see what would work.</p>\n"}, {"tags": ["c", "openmp", "schedule", "pragma"], "answers": [{"comments": [{"owner": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "edited": false, "score": 2, "creation_date": 1463569945, "post_id": 37291321, "comment_id": 62118444, "body": "Note that using schedule(runtime) and then omp_sched_static can easily produce worse results for the static schedule than you would get if the compiler knew that the schedule was static at compile time. That is because if the compiler knows that the schedule is static, it can generate better code that does not have any calls into the runtime for scheduling  inside the loop. Whereas if the schedule might be dynamic it has to use a more expensive code-generation pattern that makes a scheduling call for each &quot;blocksize&quot; set of iterations."}], "tags": [], "owner": {"reputation": 351, "user_id": 3379534, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/250d20a8387d013d5c73684bb0bc2b25?s=128&d=identicon&r=PG&f=1", "display_name": "Linuxxon", "link": "https://stackoverflow.com/users/3379534/linuxxon"}, "is_accepted": true, "score": 3, "last_activity_date": 1463550773, "creation_date": 1463550773, "answer_id": 37291321, "question_id": 37288493, "link": "https://stackoverflow.com/questions/37288493/how-to-dynamically-choose-scheduling-type/37291321#37291321", "title": "How to dynamically choose scheduling type?", "body": "<p>You can set the scheduling kind when the applied schedule is <code>runtime</code>.</p>\n\n<blockquote>\n  <p>When schedule(runtime) is specified, the decision regarding scheduling is deferred until runtime. The schedule kind and size of the chunks can be chosen at run time by setting the environment variable OMP_SCHEDULE. If this environment variable is not set, the resulting schedule is implementation-defined. When schedule(runtime) is specified, chunk_size must not be specified. - <em><a href=\"http://www.openmp.org/mp-documents/openmp-4.5.pdf\" rel=\"nofollow\">OpenMP-4.5 Specification</a></em></p>\n</blockquote>\n\n<p>This is done with the function <code>void omp_set_schedule(omp_sched_t kind, int chunk_size);</code></p>\n\n<p>The scheduling kinds that are available are defined in <code>omp.h</code> as this enum below</p>\n\n<pre><code>typedef enum omp_sched_t {\n    omp_sched_static = 1,\n    omp_sched_dynamic = 2,\n    omp_sched_guided = 3,\n    omp_sched_auto = 4\n} omp_sched_t;\n</code></pre>\n"}], "owner": {"reputation": 5277, "user_id": 4745527, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mVYxV.png?s=128&g=1", "display_name": "Aracthor", "link": "https://stackoverflow.com/users/4745527/aracthor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 851, "favorite_count": 0, "accepted_answer_id": 37291321, "answer_count": 1, "score": 1, "last_activity_date": 1463550773, "creation_date": 1463533015, "question_id": 37288493, "link": "https://stackoverflow.com/questions/37288493/how-to-dynamically-choose-scheduling-type", "title": "How to dynamically choose scheduling type?", "body": "<p>I need to compare execution time of a loop with different scheduling type and threads number with openMP.</p>\n\n<p>I can set threads number dynamically by passing an <code>int</code> variable directly in the pragma macro:</p>\n\n<pre><code>int threads_number = 4;\n#pragma omp parallel for num_threads(threads_number)\n</code></pre>\n\n<p>But I'm trying to do the same for <code>schedule</code>, I need  to compare <code>static</code>, <code>dynamic</code> and <code>guided</code> types. But it appears I cannot use an int as enum nor a <code>char*</code> as name for this one.</p>\n\n<p>Is there any way to choose it dynamically, or do I have to write the loop 3 times and choose which one to call with an <code>if</code>, which seems kind of dirty ?</p>\n"}, {"tags": ["c", "cmake", "clion", "simgrid"], "comments": [{"owner": {"reputation": 767, "user_id": 578480, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/LKpvI.jpg?s=128&g=1", "display_name": "Steve Heim", "link": "https://stackoverflow.com/users/578480/steve-heim"}, "edited": false, "score": 0, "creation_date": 1463540947, "post_id": 37288478, "comment_id": 62103647, "body": "Hi and welcome to SO! Please read <a href=\"http://stackoverflow.com/help/how-to-ask\">this</a> post for how to ask better questions, which will help people give you better answers. In particular, don&#39;t post images of code/errors, but copy/paste the actual text instead (much more readable). Also, while links are helpful, please also create a <a href=\"http://stackoverflow.com/help/mcve\">MWE</a> of code written directly in the question. Links tend to break, and code in a github repository tends to change!"}, {"owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "reply_to_user": {"reputation": 767, "user_id": 578480, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/LKpvI.jpg?s=128&g=1", "display_name": "Steve Heim", "link": "https://stackoverflow.com/users/578480/steve-heim"}, "edited": false, "score": 0, "creation_date": 1463574584, "post_id": 37288478, "comment_id": 62121729, "body": "Okay I will change it soon."}], "answers": [{"comments": [{"owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "edited": false, "score": 0, "creation_date": 1463610321, "post_id": 37311067, "comment_id": 62143126, "body": "I know it is my misuage."}], "tags": [], "owner": {"reputation": 1296, "user_id": 1756334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c825332eff76785b2c93b2629762c470?s=128&d=identicon&r=PG", "display_name": "Martin Quinson", "link": "https://stackoverflow.com/users/1756334/martin-quinson"}, "is_accepted": true, "score": 1, "last_activity_date": 1469223257, "last_edit_date": 1469223257, "creation_date": 1463610202, "answer_id": 37311067, "question_id": 37288478, "link": "https://stackoverflow.com/questions/37288478/unknown-cmake-command-add-tesh-factories/37311067#37311067", "title": "Unknown CMake command ADD_TESH_FACTORIES", "body": "<p>It seems to me that you messed up your IDE configuration, as this very CMakeLists.txt file is used in the continuous integration of SimGrid. </p>\n\n<p>So I agree with Steeve: please tell us what you did (did you change the config file?) and more importantly, how to reproduce your problem.</p>\n\n<p>A problem that nobody can reproduce is not a problem, that's a misusage ;)</p>\n\n<p>For more information about how to use CMake in a user code built on top of SimGrid, please see <a href=\"http://simgrid.gforge.inria.fr/simgrid/3.13.90/doc/install_yours.html\" rel=\"nofollow\">http://simgrid.gforge.inria.fr/simgrid/3.13.90/doc/install_yours.html</a></p>\n"}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 37311067, "answer_count": 1, "score": 2, "last_activity_date": 1469223257, "creation_date": 1463532917, "last_edit_date": 1463604507, "question_id": 37288478, "link": "https://stackoverflow.com/questions/37288478/unknown-cmake-command-add-tesh-factories", "title": "Unknown CMake command ADD_TESH_FACTORIES", "body": "<p>I use ubuntu version 14.04.\nFor redactoring and viewing C project code I use CLION 2016. \nI opened this <a href=\"https://github.com/simgrid/simgrid/tree/master/examples/msg\" rel=\"nofollow\">simgrid-examples-project</a> by Clion code editor.</p>\n\n<p>This project has <a href=\"https://github.com/simgrid/simgrid/blob/master/examples/msg/CMakeLists.txt\" rel=\"nofollow\">CMakeLists.txt</a>. Its content is shown below:</p>\n\n<pre><code>foreach(x actions-comm actions-storage app-masterworker app-pingpong app-pmm app-token-ring async-wait async-waitall \n          async-waitany cloud-capping cloud-masterworker cloud-migration cloud-multicore cloud-simple cloud-two-tasks\n          dht-chord dht-pastry energy-consumption energy-onoff energy-pstate energy-ptask energy-vm platform-failures \n          io-file io-remote io-storage task-priority process-create process-kill process-migration process-suspend \n          platform-properties maestro-set process-startkilltime synchro-semaphore trace-categories \n          trace-route-user-variables trace-link-user-variables trace-masterworker trace-platform \n          trace-process-migration trace-host-user-variables)\n  add_executable       (${x}     ${x}/${x}.c)\n  target_link_libraries(${x}     simgrid)\n  set_target_properties(${x}  PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/${x})\n  set(examples_src ${examples_src} ${CMAKE_CURRENT_SOURCE_DIR}/${x}/${x}.c)\n  set(tesh_files   ${tesh_files}   ${CMAKE_CURRENT_SOURCE_DIR}/${x}/${x}.tesh)\nendforeach()\n\nif(HAVE_NS3)\n  add_executable       (network-ns3 network-ns3/network-ns3.c)\n  target_link_libraries(network-ns3 simgrid)\n  set_target_properties(network-ns3  PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/network-ns3)\nendif()\n\nadd_executable       (bittorrent app-bittorrent/bittorrent.c app-bittorrent/messages.c app-bittorrent/peer.c app-bittorrent/tracker.c app-bittorrent/connection.c)\ntarget_link_libraries(bittorrent simgrid)\nset_target_properties(bittorrent PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/app-bittorrent)\nforeach (file bittorrent connection messages peer tracker)\n  set(examples_src  ${examples_src}  ${CMAKE_CURRENT_SOURCE_DIR}/app-bittorrent/${file}.c  ${CMAKE_CURRENT_SOURCE_DIR}/app-bittorrent/${file}.h)\nendforeach()\n\nadd_executable       (chainsend app-chainsend/chainsend.c app-chainsend/iterator.c app-chainsend/common.c app-chainsend/messages.c app-chainsend/broadcaster.c app-chainsend/peer.c)\ntarget_link_libraries(chainsend simgrid)\nset_target_properties(chainsend PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/app-chainsend)\nforeach (file common iterator messages broadcaster peer)\n  set(examples_src  ${examples_src}  ${CMAKE_CURRENT_SOURCE_DIR}/app-chainsend/${file}.c  ${CMAKE_CURRENT_SOURCE_DIR}/app-chainsend/${file}.h)\nendforeach()\n\nadd_executable       (dht-kademlia dht-kademlia/dht-kademlia.c dht-kademlia/node.c dht-kademlia/routing_table.c dht-kademlia/task.c dht-kademlia/answer.c)\ntarget_link_libraries(dht-kademlia simgrid)\nset_target_properties(dht-kademlia PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}/dht-kademlia)\nforeach (file answer dht-kademlia node routing_table task)\n  set(examples_src  ${examples_src}  ${CMAKE_CURRENT_SOURCE_DIR}/dht-kademlia/${file}.c  ${CMAKE_CURRENT_SOURCE_DIR}/dht-kademlia/${file}.h)\nendforeach()\n\nforeach (file actions-comm actions-storage app-bittorrent app-chainsend app-masterworker app-pingpong async-wait\n         async-waitall async-waitany dht-chord dht-kademlia dht-pastry io-remote platform-properties maestro-set \n         task-priority)\n  set(xml_files    ${xml_files}     ${CMAKE_CURRENT_SOURCE_DIR}/${file}/${file}_d.xml)\nendforeach()\n\nset(txt_files    ${txt_files}     ${CMAKE_CURRENT_SOURCE_DIR}/README.doc\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/actions-comm/actions-comm.txt\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/actions-comm/actions-comm_split_p0.txt\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/actions-comm/actions-comm_split_p1.txt\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/actions-storage/actions-storage.txt          PARENT_SCOPE)\nset(bin_files    ${bin_files}     ${CMAKE_CURRENT_SOURCE_DIR}/app-bittorrent/generate.py\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/dht-chord/generate.py\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/dht-kademlia/generate.py                     PARENT_SCOPE)\nset(examples_src ${examples_src}  ${CMAKE_CURRENT_SOURCE_DIR}/app-chainsend/chainsend.c\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/dht-kademlia/common.h\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/network-ns3/network-ns3.c                    PARENT_SCOPE)\nset(tesh_files   ${tesh_files}    ${CMAKE_CURRENT_SOURCE_DIR}/app-bittorrent/app-bittorrent.tesh\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/app-chainsend/app-chainsend.tesh\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/dht-kademlia/dht-kademlia.tesh\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/app-masterworker/app-masterworker-multicore.tesh\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/app-masterworker/app-masterworker-vivaldi.tesh\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/network-ns3/network-ns3.tesh                 PARENT_SCOPE)\nset(xml_files    ${xml_files}     ${CMAKE_CURRENT_SOURCE_DIR}/actions-comm/actions-comm_split_d.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/app-masterworker/app-masterworker-multicore_d.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/app-masterworker/app-masterworker-vivaldi_d.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/async-wait/async-wait2_d.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/async-wait/async-wait3_d.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/async-wait/async-wait4_d.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/energy-onoff/platform_onoff.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/network-ns3/3hosts_2links_d.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/network-ns3/3links-timer_d.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/network-ns3/3links_d.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/network-ns3/crosstraffic_d.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/network-ns3/dogbone_d.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/network-ns3/onelink_d.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/network-ns3/one_cluster_d.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/network-ns3/two_clusters_d.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/process-startkilltime/baseline_d.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/process-startkilltime/kill_d.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/process-startkilltime/start_d.xml\n                                  ${CMAKE_CURRENT_SOURCE_DIR}/process-startkilltime/start_kill_d.xml       PARENT_SCOPE)\n\nforeach(x actions-comm actions-storage app-bittorrent app-chainsend app-masterworker app-pingpong app-token-ring\n          async-wait async-waitall async-waitany cloud-capping cloud-masterworker cloud-migration cloud-simple \n          cloud-two-tasks dht-chord dht-kademlia platform-failures io-file io-remote io-storage task-priority \n          process-create process-kill process-migration process-suspend platform-properties synchro-semaphore \n          process-startkilltime)\n  ADD_TESH_FACTORIES(msg-${x} \"thread;ucontext;raw;boost\" --setenv bindir=${CMAKE_BINARY_DIR}/examples/msg/${x} --setenv srcdir=${CMAKE_HOME_DIRECTORY}/examples/platforms --cd ${CMAKE_HOME_DIRECTORY}/examples/msg/${x} ${x}.tesh)\nendforeach()\n\nforeach (example consumption onoff pstate vm)\n  ADD_TESH_FACTORIES(msg-energy-${example} \"thread;ucontext;raw;boost\" --setenv srcdir=${CMAKE_HOME_DIRECTORY}/examples/msg --cd ${CMAKE_BINARY_DIR}/examples/msg ${CMAKE_HOME_DIRECTORY}/examples/msg/energy-${example}/energy-${example}.tesh)\nendforeach()\n\nforeach (x categories route-user-variables link-user-variables masterworker platform process-migration host-user-variables)\n  ADD_TESH(msg-trace-${x} --setenv bindir=${CMAKE_BINARY_DIR}/examples/msg/trace-${x} --setenv srcdir=${CMAKE_HOME_DIRECTORY}/examples/platforms --cd ${CMAKE_HOME_DIRECTORY}/examples/msg/trace-${x} trace-${x}.tesh)\nendforeach()\n\nADD_TESH_FACTORIES(msg-app-bittorrent-parallel         \"thread;ucontext;raw\" --cfg contexts/nthreads:4 ${CONTEXTS_SYNCHRO} --setenv bindir=${CMAKE_BINARY_DIR}/examples/msg/app-bittorrent --setenv srcdir=${CMAKE_HOME_DIRECTORY}/examples/platforms --cd ${CMAKE_HOME_DIRECTORY}/examples/msg/app-bittorrent app-bittorrent.tesh)\nADD_TESH_FACTORIES(msg-dht-chord-parallel              \"thread;ucontext;raw\" --cfg contexts/nthreads:4 ${CONTEXTS_SYNCHRO} --setenv bindir=${CMAKE_BINARY_DIR}/examples/msg/dht-chord --setenv srcdir=${CMAKE_HOME_DIRECTORY}/examples/platforms --cd ${CMAKE_HOME_DIRECTORY}/examples/msg/dht-chord dht-chord.tesh)\nADD_TESH_FACTORIES(msg-dht-kademlia-parallel           \"thread;ucontext;raw\" --cfg contexts/nthreads:4 ${CONTEXTS_SYNCHRO} --setenv bindir=${CMAKE_BINARY_DIR}/examples/msg/dht-kademlia --setenv srcdir=${CMAKE_HOME_DIRECTORY}/examples/platforms --cd ${CMAKE_HOME_DIRECTORY}/examples/msg/dht-kademlia dht-kademlia.tesh)\nADD_TESH_FACTORIES(msg-energy-pstate-ptask             \"thread;ucontext;raw;boost\" --cfg host/model:ptask_L07 --log xbt_cfg.threshold:critical --setenv srcdir=${CMAKE_HOME_DIRECTORY}/examples/msg --cd ${CMAKE_BINARY_DIR}/examples/msg ${CMAKE_HOME_DIRECTORY}/examples/msg/energy-pstate/energy-pstate.tesh)\nADD_TESH_FACTORIES(msg-energy-consumption-ptask        \"thread;ucontext;raw;boost\" --cfg host/model:ptask_L07 --log xbt_cfg.threshold:critical --setenv srcdir=${CMAKE_HOME_DIRECTORY}/examples/msg --cd ${CMAKE_BINARY_DIR}/examples/msg ${CMAKE_HOME_DIRECTORY}/examples/msg/energy-consumption/energy-consumption.tesh)\nADD_TESH_FACTORIES(msg-energy-ptask                    \"thread;ucontext;raw\" --setenv srcdir=${CMAKE_HOME_DIRECTORY}/examples/msg --cd ${CMAKE_BINARY_DIR}/examples/msg ${CMAKE_HOME_DIRECTORY}/examples/msg/energy-ptask/energy-ptask.tesh)\nADD_TESH_FACTORIES(msg-maestro-set                     \"thread\" --setenv srcdir=${CMAKE_HOME_DIRECTORY}/examples/msg --cd ${CMAKE_BINARY_DIR}/examples/msg ${CMAKE_HOME_DIRECTORY}/examples/msg/maestro-set/maestro-set.tesh)\n\nADD_TESH_FACTORIES(app-masterworker-multicore   \"thread;ucontext;raw;boost\" --setenv srcdir=${CMAKE_HOME_DIRECTORY}/examples/msg --cd ${CMAKE_BINARY_DIR}/examples/msg ${CMAKE_HOME_DIRECTORY}/examples/msg/app-masterworker/app-masterworker-multicore.tesh)\nADD_TESH_FACTORIES(app-masterworker-vivaldi     \"thread;ucontext;raw;boost\" --setenv srcdir=${CMAKE_HOME_DIRECTORY}/examples/msg --cd ${CMAKE_BINARY_DIR}/examples/msg ${CMAKE_HOME_DIRECTORY}/examples/msg/app-masterworker/app-masterworker-vivaldi.tesh)\n\nADD_TESH(msg-app-pmm  --setenv srcdir=${CMAKE_HOME_DIRECTORY}/examples/msg --setenv srcdir=${CMAKE_HOME_DIRECTORY}/examples/platforms --cd ${CMAKE_BINARY_DIR}/examples/msg ${CMAKE_HOME_DIRECTORY}/examples/msg/app-pmm/app-pmm.tesh)\n\nif(HAVE_NS3)\n  ADD_TESH_FACTORIES(msg-network-ns3 \"thread;ucontext;raw;boost\" --setenv srcdir=${CMAKE_HOME_DIRECTORY} --cd ${CMAKE_BINARY_DIR}/examples/msg ${CMAKE_HOME_DIRECTORY}/examples/msg/network-ns3/network-ns3.tesh)\nendif()\n\n# This one is not usable:\n# ADD_TESH_FACTORIES(msg-dht-pastry                    \"thread;ucontext;raw;boost\" --setenv srcdir=${CMAKE_HOME_DIRECTORY}/examples/msg/dht-pastry --cd ${CMAKE_BINARY_DIR}/examples/msg/dht-pastry dht-pastry.tesh)\n</code></pre>\n\n<p>But CLion gives following error and warning:</p>\n\n<pre><code>Error:Unknown CMake command \"ADD_TESH_FACTORIES\".\nWarning:Cannot set \"txt_files\": current scope has no parent.\nWarning:Cannot set \"bin_files\": current scope has no parent.\nWarning:Cannot set \"examples_src\": current scope has no parent.\nWarning:Cannot set \"tesh_files\": current scope has no parent.\nWarning:Cannot set \"xml_files\": current scope has no parent.\n</code></pre>\n\n<p>How can I avoid it?</p>\n"}, {"tags": ["c", "linux", "unix", "filesystems", "posix"], "comments": [{"owner": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "edited": false, "score": 0, "creation_date": 1463553175, "post_id": 37288453, "comment_id": 62107673, "body": "Since you just opened the file descriptor, there is no &quot;data for the open file descriptor named by fildes is to be transferred&quot;, so I would say no."}, {"owner": {"reputation": 23, "user_id": 6348183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6e988e7372891a63239ce7fe2c9b4f?s=128&d=identicon&r=PG&f=1", "display_name": "jneighb", "link": "https://stackoverflow.com/users/6348183/jneighb"}, "reply_to_user": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "edited": false, "score": 0, "creation_date": 1463554633, "post_id": 37288453, "comment_id": 62108483, "body": "@marcolz that is my doubt. But I would say that pending requests on the inode referred by <code>filedes</code> are &quot;data for the open file descriptor&quot;"}, {"owner": {"reputation": 21995, "user_id": 263061, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7c724c96f7ec19f73245499b6169e329?s=128&d=identicon&r=PG", "display_name": "nh2", "link": "https://stackoverflow.com/users/263061/nh2"}, "edited": false, "score": 0, "creation_date": 1525349559, "post_id": 37288453, "comment_id": 87327071, "body": "<a href=\"https://lwn.net/Articles/323035/\" rel=\"nofollow noreferrer\">This comment</a> suggests that you can <i>write &quot;a bunch of files you can write them all without fsync, then go back and reopen/fsync them&quot;</i>, suggesting that fsync after close works. It would make sense this way -- otherwise after close() there&#39;d be no way to ever force data to be written to disk. But It would be great to get an authorative answer on this. I&#39;ve started a bounty."}, {"owner": {"reputation": 21995, "user_id": 263061, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7c724c96f7ec19f73245499b6169e329?s=128&d=identicon&r=PG", "display_name": "nh2", "link": "https://stackoverflow.com/users/263061/nh2"}, "edited": false, "score": 0, "creation_date": 1525359845, "post_id": 37288453, "comment_id": 87334293, "body": "I have asked this question on <code>linux-fsdevel</code>. I <a href=\"https://marc.info/?l=linux-fsdevel&amp;m=152535409207496&amp;w=2\" rel=\"nofollow noreferrer\">got confirmed</a> that at least as of writing, <code>close()&#47;re-open()&#47;fsync()</code> does <b>not</b> provide the same guarantees as <code>fsync()&#47;close()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6348183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6e988e7372891a63239ce7fe2c9b4f?s=128&d=identicon&r=PG&f=1", "display_name": "jneighb", "link": "https://stackoverflow.com/users/6348183/jneighb"}, "edited": false, "score": 0, "creation_date": 1525592213, "post_id": 50158433, "comment_id": 87411522, "body": "Thanks for the answer. I&#39;ve updated my question with some info."}], "tags": [], "owner": {"reputation": 21995, "user_id": 263061, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7c724c96f7ec19f73245499b6169e329?s=128&d=identicon&r=PG", "display_name": "nh2", "link": "https://stackoverflow.com/users/263061/nh2"}, "is_accepted": true, "score": 4, "last_activity_date": 1525360313, "creation_date": 1525360313, "answer_id": 50158433, "question_id": 37288453, "link": "https://stackoverflow.com/questions/37288453/calling-fsync2-after-close2/50158433#50158433", "title": "Calling fsync(2) after close(2)", "body": "<p><strong>No</strong>, <code>close()</code>+re-<code>open()</code>+<code>fsync()</code> does not provide the same guarantees as <code>fsync()</code>+<code>close()</code>.</p>\n\n<p>Source: I <a href=\"https://marc.info/?l=linux-fsdevel&amp;m=152535098505449&amp;w=2\" rel=\"nofollow noreferrer\">took this question</a> to the <code>linux-fsdevel</code> mailing list and <a href=\"https://marc.info/?l=linux-fsdevel&amp;m=152535409207496&amp;w=2\" rel=\"nofollow noreferrer\">got the answer</a>:</p>\n\n<blockquote>\n  <blockquote>\n    <p>Does a sequence of close()/re-open()/fsync() provide the same durability\n    guarantees as fsync()/close()?</p>\n  </blockquote>\n  \n  <p>The short answer is no, the latter provides a better guaranty.\n  The longer answer is that durability guarantees depends on kernel version,\n  because situation has been changing in v4.13, v4.14 and now again in\n  v4.17-rc and stable kernels.</p>\n</blockquote>\n\n<p>Further relevant links are:</p>\n\n<ul>\n<li><a href=\"https://wiki.postgresql.org/wiki/Fsync_Errors\" rel=\"nofollow noreferrer\">https://wiki.postgresql.org/wiki/Fsync_Errors</a> (\"fsyncgate\")</li>\n<li>Mailing list entry <a href=\"https://www.postgresql.org/message-id/flat/CAMsr%2BYHh%2B5Oq4xziwwoEfhoTZgr07vdGG%2Bhu%3D1adXx59aTeaoQ%40mail.gmail.com#CAMsr+YHh+5Oq4xziwwoEfhoTZgr07vdGG+hu=1adXx59aTeaoQ@mail.gmail.com\" rel=\"nofollow noreferrer\">PostgreSQL's handling of fsync() errors is unsafe and risks data loss at least on XFS</a></li>\n<li><a href=\"https://stackoverflow.com/questions/42434872/writing-programs-to-cope-with-i-o-errors-causing-lost-writes-on-linux\">Writing programs to cope with I/O errors causing lost writes on Linux</a> from the same author</li>\n</ul>\n\n<p>In particular, the latter links describe how</p>\n\n<ul>\n<li>after closing an FD, you lose all ways to enforce durability</li>\n<li>after an <code>fsync()</code> fails, you cannot call <code>fsync()</code> again in the hope that now your data would be written</li>\n<li>you <a href=\"https://stackoverflow.com/questions/42434872/writing-programs-to-cope-with-i-o-errors-causing-lost-writes-on-linux#comment72017184_42436401\">must re-do/confirm all writing work</a> if that happens</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 2, "last_activity_date": 1525411247, "creation_date": 1525411247, "answer_id": 50167655, "question_id": 37288453, "link": "https://stackoverflow.com/questions/37288453/calling-fsync2-after-close2/50167655#50167655", "title": "Calling fsync(2) after close(2)", "body": "<p>The current (2017) specification of POSIX <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fsync.html\" rel=\"nofollow noreferrer\"><code>fsync()</code></a>\nrecognizes a base functionality and an optional functionality:</p>\n\n<blockquote>\n  <p>The <code>fsync()</code> function shall request that all data for the open file descriptor named by <code>fildes</code> is to be transferred to the storage device associated with the file described by <code>fildes</code>. The nature of the transfer is implementation-defined. The <code>fsync()</code> function shall not return until the system has completed that action or until an error is detected.</p>\n  \n  <p>[SIO] \u2326 If <code>_POSIX_SYNCHRONIZED_IO</code> is defined, the <code>fsync()</code> function shall force all currently queued I/O operations associated with the file indicated by file descriptor <code>fildes</code> to the synchronized I/O completion state. All I/O operations shall be completed as defined for synchronized I/O file integrity completion. \u232b</p>\n</blockquote>\n\n<p>If <code>_POSIX_SYNCHRONIZED_IO</code> is not defined by the implementation, then your reopened file descriptor has no unwritten data to be transferred to the storage device, so the <code>fsync()</code> call is effectively a no-op.</p>\n\n<p>If <code>_POSIX_SYNCHRONIZED_IO</code> is defined by the implementation, then your reopened file descriptor will ensure that all data written on any file descriptor associated with the file to be transferred to the storage device.</p>\n\n<p>The section of the standard on <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap02.html\" rel=\"nofollow noreferrer\">Conformance</a> has information about options and option groups.\nThe <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html\" rel=\"nofollow noreferrer\">Definitions</a> section has definitions <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_382\" rel=\"nofollow noreferrer\">382..387</a> which defines aspects of Synchronized I/O and Synchronous I/O (yes, they're different \u2014 beware open file descriptors and open file descriptions, too).\nThe section on <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_08\" rel=\"nofollow noreferrer\">Realtime</a> defers to the Definitions section for what synchronized I/O means.</p>\n\n<p>It defines:</p>\n\n<blockquote>\n  <h3>3.382 Synchronized Input and Output</h3>\n  \n  <p>A determinism and robustness improvement mechanism to enhance the data input and output mechanisms, so that an application can ensure that the data being manipulated is physically present on secondary mass storage devices.</p>\n  \n  <h3>3.383 Synchronized I/O Completion</h3>\n  \n  <p>The state of an I/O operation that has either been successfully transferred or diagnosed as unsuccessful.</p>\n  \n  <h3>3.384 Synchronized I/O Data Integrity Completion</h3>\n  \n  <p>For read, when the operation has been completed or diagnosed if unsuccessful. The read is complete only when an image of the data has been successfully transferred to the requesting process. If there were any pending write requests affecting the data to be read at the time that the synchronized read operation was requested, these write requests are successfully transferred prior to reading the data.</p>\n  \n  <p>For write, when the operation has been completed or diagnosed if unsuccessful. The write is complete only when the data specified in the write request is successfully transferred and all file system information required to retrieve the data is successfully transferred.</p>\n  \n  <p>File attributes that are not necessary for data retrieval (access time, modification time, status change time) need not be successfully transferred prior to returning to the calling process.</p>\n  \n  <h3>3.385 Synchronized I/O File Integrity Completion</h3>\n  \n  <p>Identical to a synchronized I/O data integrity completion with the addition that all file attributes relative to the I/O operation (including access time, modification time, status change time) are successfully transferred prior to returning to the calling process.</p>\n  \n  <h3>3.386 Synchronized I/O Operation</h3>\n  \n  <p>An I/O operation performed on a file that provides the application assurance of the integrity of its data and files.</p>\n  \n  <h3>3.387 Synchronous I/O Operation</h3>\n  \n  <p>An I/O operation that causes the thread requesting the I/O to be blocked from further use of the processor until that I/O operation completes.</p>\n  \n  <p>Note:\n  A synchronous I/O operation does not imply synchronized I/O data integrity completion or synchronized I/O file integrity completion.</p>\n</blockquote>\n\n<p>It is not 100% clear whether the 'all currently queued I/O operations associated with the file indicated by [the] file descriptor' applies across processes.\nConceptually, I think it should, but the wording isn't there in black and white (or black on pale yellow).  It certainly should apply to any open file descriptors in the current process referring to the same file.  It is not clear that it would apply to the previously opened (and closed) file descriptor in the current process.  If it applies across all processes, then it should include the queued I/O from the current process.  If it does not apply across all processes, it is possible that it does not.</p>\n\n<p>In view of this and the rationale notes for <code>fsync()</code>, it is by far safest to assume that the <code>fsync()</code> operation has no effect on the queued operations associated with the closed file descriptor.  If you want <code>fsync()</code> to be effective, call it before you close the file descriptor.</p>\n"}], "owner": {"reputation": 23, "user_id": 6348183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc6e988e7372891a63239ce7fe2c9b4f?s=128&d=identicon&r=PG&f=1", "display_name": "jneighb", "link": "https://stackoverflow.com/users/6348183/jneighb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1295, "favorite_count": 2, "accepted_answer_id": 50158433, "answer_count": 2, "score": 2, "last_activity_date": 1525593287, "creation_date": 1463532664, "last_edit_date": 1525593287, "question_id": 37288453, "link": "https://stackoverflow.com/questions/37288453/calling-fsync2-after-close2", "title": "Calling fsync(2) after close(2)", "body": "<p>Scenario:</p>\n\n<p>Task code (error checking omitted):</p>\n\n<pre><code>// open, write and close\nfd = open(name);\nwrite(fd, buf, len);\nclose(fd);\n&lt; more code here **not** issuing read/writes to name but maybe open()ing it &gt;\n// open again and fsync\nfd = open(name);\nfsync(fd);\n</code></pre>\n\n<p>No more tasks accessing <code>name</code> concurrently in the system.</p>\n\n<p>Is it defined, and more important, will it sync possible outstanding writes on the inode referred by <code>name</code>? ie, will I read back <code>buf</code> from the file after the fsync?</p>\n\n<p>From POSIX <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/fsync.html\" rel=\"nofollow noreferrer\">http://pubs.opengroup.org/onlinepubs/009695399/functions/fsync.html</a> I would say it seems legit ...</p>\n\n<p>Thanks.</p>\n\n<p>Edit may 18:\nThanks for the answers and research. I took this question (in 2016) to one of the extfs lead developers (Ted) and got this answer: \"It's not guaranteed by Posix, but in practice it should work on most\nfile systems, including ext4.  The key wording in the Posix specification is:</p>\n\n<p>The fsync() function shall request that all data for the open file\n                                                 ^^^^^^^^^^^^^^^^^\ndescriptor named by fildes is to be transferred to the storage device\n^^^^^^^^^^^^^^^^^^^^^^^^^^\nassociated with the file described by fildes.</p>\n\n<p>It does not say \"all data for the file described by fildes....\"  it\nsays \"all data for the open file descriptor\".  So technically data\nwritten by another file descriptor is not guaranteed to be synced to\ndisk.</p>\n\n<p>In practice, file systems don't try dirty data by which fd it came in\non, so you don't need to worry.  And an OS which writes more than what\nis strictly required is standards compliant, and so that's what you\nwill find in general, even if it isn't guaranteed.\"  This is less specific than \"exact same durabily guarrantees\" but is quite authoritative, even though maybe outdated.</p>\n\n<p>What I was trying to do was a 'sync' command that worked on single files.\nLike fsync /some/file without having to sync the whole filesystem, to use it in shell scripts for example.\nNow (since a few years ago) gnu coreutils 'sync' works on single files and does exactly this (open/fsync). commit: <a href=\"https://github.com/coreutils/coreutils/commit/8b2bf5295f353016d4f5e6a2317d55b6a8e7fd00\" rel=\"nofollow noreferrer\">https://github.com/coreutils/coreutils/commit/8b2bf5295f353016d4f5e6a2317d55b6a8e7fd00</a></p>\n"}, {"tags": ["c", "printf", "malloc"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 6, "creation_date": 1463532966, "post_id": 37288426, "comment_id": 62101732, "body": "<code>if (data == NULL)</code> The <code>data</code> variable has not been initialised."}, {"owner": {"reputation": 79, "user_id": 818058, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18c9a0d88bae442e68b11762c4691662?s=128&d=identicon&r=PG", "display_name": "Kaushik Koneru", "link": "https://stackoverflow.com/users/818058/kaushik-koneru"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1463533057, "post_id": 37288426, "comment_id": 62101757, "body": "@kaylum Yes, I agree. So I initialized by allocating memory and later pointed that to data_handler."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1463533117, "post_id": 37288426, "comment_id": 62101766, "body": "But that check will not work as expected because <code>data</code> is uninitalised. So you don&#39;t know which of the conditional blocks of code it will run. <code>data</code> may not be <code>NULL</code> the first time as you seem to expect."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1463533437, "post_id": 37288426, "comment_id": 62101850, "body": "Never cast the return value of <code>malloc()</code> in <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463533469, "post_id": 37288426, "comment_id": 62101854, "body": "Also need <code>#include &lt;stdlib.h&gt;</code>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463535929, "post_id": 37288426, "comment_id": 62102414, "body": "<code>sizeof(data)</code> is wrong."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463536751, "post_id": 37288426, "comment_id": 62102639, "body": "try <a href=\"http://ideone.com/oX18tZ\" rel=\"nofollow noreferrer\">this</a>"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 818058, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18c9a0d88bae442e68b11762c4691662?s=128&d=identicon&r=PG", "display_name": "Kaushik Koneru", "link": "https://stackoverflow.com/users/818058/kaushik-koneru"}, "edited": false, "score": 0, "creation_date": 1463534633, "post_id": 37288576, "comment_id": 62102103, "body": "Thank you very much.. after making changes you suggested ..It is showing better result but not the one I am expecting.. As per my code I am adding new &quot;test&quot; at the end of the prev string..So at the end it should print &quot; test test test test test ..&quot; but it is printing only one &quot;test&quot;"}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 1, "last_activity_date": 1463533625, "last_edit_date": 1495541763, "creation_date": 1463533625, "answer_id": 37288576, "question_id": 37288426, "link": "https://stackoverflow.com/questions/37288426/snprintf-issue-in-c/37288576#37288576", "title": "snprintf issue in C", "body": "<p>Local variables are not automatically initialized, </p>\n\n<pre><code>char *data;\n</code></pre>\n\n<p>leaves <code>data</code> unuinitialized and that means it has no value stored in it, it's a random value that might be considered garbage and is unpredictable, but it's very likely that it's not <code>NULL</code>, so the test is false and you are printing <code>data</code> without first initialiazing it.</p>\n\n<p>Also, the <code>sizeof</code> operator returns the size of the type and not the allocated size. You should keep the allocated size in order to use it later. The <code>sizeof</code> operator gives you the size of an array too but <code>data</code> is not an array it's a pointer.</p>\n\n<p>And finally:</p>\n\n<ol>\n<li>Do not cast the return value of <code>malloc()</code>. <a href=\"https://stackoverflow.com/a/605858/1983495\">Read here for more about it</a>.</li>\n<li>Don't use <code>sizeof(char)</code> because it's <code>=== 1</code> by definition.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1463534288, "post_id": 37288619, "comment_id": 62102030, "body": "I don&#39;t think this is the problem. But casting to <code>(char *)</code> certainly hides the error."}, {"owner": {"reputation": 9975, "user_id": 14738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8b68858adef176d6dc71a727867b38?s=128&d=identicon&r=PG", "display_name": "jussij", "link": "https://stackoverflow.com/users/14738/jussij"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1463534762, "post_id": 37288619, "comment_id": 62102140, "body": "The compiler is pointing out that the <code>data</code> variable is undefined as it has not been initialized, as is the <code>len</code> variable. Because the <code>data</code> variable is undefined it also points out the fact that the if statement &#39;if (data == NULL) {&#39; at line 16 is not going to work as expected and that is definitely the issue. The other warning is no better as this line of code <code>len += snprintf</code> could do anything because <code>len</code> is undefined. These warnings are there for a reason."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1463536221, "post_id": 37288619, "comment_id": 62102488, "body": "Yes 100% with you. And warnings are very helpful for new programmers. I am just teaching it to my sister exactly how important warnings can be."}], "tags": [], "owner": {"reputation": 9975, "user_id": 14738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8b68858adef176d6dc71a727867b38?s=128&d=identicon&r=PG", "display_name": "jussij", "link": "https://stackoverflow.com/users/14738/jussij"}, "is_accepted": false, "score": 0, "last_activity_date": 1463535470, "last_edit_date": 1463535470, "creation_date": 1463533975, "answer_id": 37288619, "question_id": 37288426, "link": "https://stackoverflow.com/questions/37288426/snprintf-issue-in-c/37288619#37288619", "title": "snprintf issue in C", "body": "<p>After adding this include to the code to get it to compile:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n</code></pre>\n\n<p>The compiler gives hints as to why the code is not working as expected:</p>\n\n<pre><code>Microsoft (R) C/C++ Optimizing Compiler Version 19.00.23506 for x86\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\ntest.c\nd:\\temp\\test.c(16) : warning C4700: uninitialized local variable 'data' used\nd:\\temp\\test.c(24) : warning C4700: uninitialized local variable 'len' used\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Below is your code with an include file added so that it compiles and the warnings fixed by initilising the variables as suggested by the compiler: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n\nchar    *data=0;\nchar    *data_handler;\nint      i = 0;\nint      len=0, req;\nchar     test[10] = \"test\";\n\nfor(; i&lt;10; i++){\n\n    req = snprintf(NULL, 0 , \"[%s] \", test);\n\n    printf(\"%d --&gt; req \\n\", req);\n    if (data == NULL) {\n        data = (char *) malloc ((sizeof(char) * req) + 1);\n        data_handler = data;\n    } else {\n        data_handler = data + len;\n        data_handler = (char *) malloc ((sizeof(char) * req) +1);\n    }\n\n    len += snprintf(data_handler, sizeof(data) , \"[%s] \", test);\n\n    printf(\"\\nData --&gt; %s\\n\", data);\n    printf(\"\\nData Handler --&gt; %s\\n\", data_handler);\n}\n\nprintf (\"%s\", data);\n\n}\n</code></pre>\n\n<p>Here is the output produced by that code:</p>\n\n<pre><code>7 --&gt; req \n\nData --&gt; [te\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; [te\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; [te\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; [te\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; [te\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; [te\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; [te\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; [te\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; [te\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; [te\n\nData Handler --&gt; [te\n[te\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1463542091, "creation_date": 1463542091, "answer_id": 37289762, "question_id": 37288426, "link": "https://stackoverflow.com/questions/37288426/snprintf-issue-in-c/37289762#37289762", "title": "snprintf issue in C", "body": "<p>In addition to the other issues discussed, your code leaks memory badly. You cannot simply continue to <code>malloc</code> <code>data_handler</code> each iteration. When you do, you overwrite the address of the previously allocated block losing the ability to <code>free</code> the previously allocated memory. Instead, you must <code>realloc</code> the original block of memory, preserving the pointer <code>data</code> pointing to starting address for the block of memory and then update <code>data_handler</code> accordingly.\nThis is a fundamental memory management issue.</p>\n\n<p>Instead, it looks like you were attempting to do the following. I apologize if I misinterpreted your goal, but otherwise your code does not make sense:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main (void) {\n\n    char *data = NULL;\n    char *data_handler = NULL;\n    int i = 0, len = 0, req = 0;\n    char test[10] = \"test\";\n\n    req = snprintf (NULL, 0, \"[%s] \", test);\n    printf (\"%d --&gt; req\\n\", req);\n\n    for (; i &lt; 10; i++) {\n\n        if (data == NULL) {\n            data = malloc (req + 1);\n            data_handler = data;\n        }\n        else {\n            char *tmp = realloc (data, len + req + 1);  /* realloc data */\n            if (!tmp) { /* validate */\n                fprintf (stderr, \"realloc() error: virtual memory exhausted.\\n\");\n                return 1;\n            }\n            data = tmp;                 /* assign tmp to data  */\n            data_handler = data + len;  /* update data_handler */\n        }\n\n        len += snprintf (data_handler, sizeof test, \"[%s] \", test);\n\n        printf (\"-- (len: %d)\\nData         --&gt; %s\\n\", len, data);\n        printf (\"Data Handler --&gt; %s\\n\", data_handler);\n    }\n    putchar ('\\n');\n    free (data);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/snprintfnoinit\n7 --&gt; req\n-- (len: 7)\nData         --&gt; [test]\nData Handler --&gt; [test]\n-- (len: 14)\nData         --&gt; [test] [test]\nData Handler --&gt; [test]\n-- (len: 21)\nData         --&gt; [test] [test] [test]\nData Handler --&gt; [test]\n-- (len: 28)\nData         --&gt; [test] [test] [test] [test]\nData Handler --&gt; [test]\n-- (len: 35)\nData         --&gt; [test] [test] [test] [test] [test]\nData Handler --&gt; [test]\n-- (len: 42)\nData         --&gt; [test] [test] [test] [test] [test] [test]\nData Handler --&gt; [test]\n-- (len: 49)\nData         --&gt; [test] [test] [test] [test] [test] [test] [test]\nData Handler --&gt; [test]\n-- (len: 56)\nData         --&gt; [test] [test] [test] [test] [test] [test] [test] [test]\nData Handler --&gt; [test]\n-- (len: 63)\nData         --&gt; [test] [test] [test] [test] [test] [test] [test] [test] [test]\nData Handler --&gt; [test]\n-- (len: 70)\nData         --&gt; [test] [test] [test] [test] [test] [test] [test] [test] [test] [test]\nData Handler --&gt; [test]\n</code></pre>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<p>In any code your write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>It is imperative that you use a memory error checking program to insure you haven't written beyond/outside your allocated block of memory, attempted to read or base a jump on an unintitialized value and finally to confirm that you have freed all the memory you have allocated. For Linux <code>valgrind</code> is the normal choice. It is simple to use.</p>\n\n<pre><code>$ valgrind ./bin/snprintfnoinit\n==25279== Memcheck, a memory error detector\n==25279== Copyright (C) 2002-2013, and GNU GPL'd, by Julian Seward et al.\n==25279== Using Valgrind-3.10.1 and LibVEX; rerun with -h for copyright info\n==25279== Command: ./bin/snprintfnoinit\n==25279==\n7 --&gt; req\n-- (len: 7)\nData         --&gt; [test]\nData Handler --&gt; [test]\n-- (len: 14)\n...\n==25279==\n==25279== HEAP SUMMARY:\n==25279==     in use at exit: 0 bytes in 0 blocks\n==25279==   total heap usage: 10 allocs, 10 frees, 395 bytes allocated\n==25279==\n==25279== All heap blocks were freed -- no leaks are possible\n==25279==\n==25279== For counts of detected and suppressed errors, rerun with: -v\n==25279== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 1 from 1)\n</code></pre>\n\n<p>Always confirm <em>All heap blocks were freed -- no leaks are possible</em> and equally important <em>ERROR SUMMARY: 0 errors from 0 contexts</em>.</p>\n\n<p>Look over the changes to the code and let me know if you have any questions.</p>\n"}], "owner": {"reputation": 79, "user_id": 818058, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18c9a0d88bae442e68b11762c4691662?s=128&d=identicon&r=PG", "display_name": "Kaushik Koneru", "link": "https://stackoverflow.com/users/818058/kaushik-koneru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1463542091, "creation_date": 1463532441, "last_edit_date": 1463533403, "question_id": 37288426, "link": "https://stackoverflow.com/questions/37288426/snprintf-issue-in-c", "title": "snprintf issue in C", "body": "<p>In the following case, data is not being set as expected and data_handler as well.</p>\n\n<pre><code>int main() {\n\nchar    *data;\nchar    *data_handler;\nint      i = 0;\nint      len , req;\nchar     test[10] = \"test\";\n\nfor(; i&lt;10; i++){\n\n    req = snprintf(NULL, 0 , \"[%s] \", test);\n\n    printf(\"%d --&gt; req \\n\", req);\n    if (data == NULL) {\n        data = (char *) malloc ((sizeof(char) * req) + 1);\n        data_handler = data;\n    } else {\n        data_handler = data + len;\n        data_handler = (char *) malloc ((sizeof(char) * req) +1);\n    }\n\n    len += snprintf(data_handler, sizeof(data) , \"[%s] \", test);\n\n    printf(\"\\nData --&gt; %s\\n\", data);\n    printf(\"\\nData Handler --&gt; %s\\n\", data_handler);\n} \n\nprintf (\"%s\", data);\n\n}\n</code></pre>\n\n<p>Intention of this program is to append total 10 times test in a string. (Experimenting pointers) but I am getting following output.</p>\n\n<pre><code>7 --&gt; req \n\nData --&gt; (\ufffd\ufffd\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; (\ufffd\ufffd\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; (\ufffd\ufffd\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; (\ufffd\ufffd\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; (\ufffd\ufffd\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; (\ufffd\ufffd\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; (\ufffd\ufffd\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; (\ufffd\ufffd\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; (\ufffd\ufffd\n\nData Handler --&gt; [te\n7 --&gt; req \n\nData --&gt; (\ufffd\ufffd\n\nData Handler --&gt; [te\n(\ufffd\ufffd\nExited: ExitFailure 5\n</code></pre>\n"}, {"tags": ["c", "encryption", "operators"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1463532389, "post_id": 37288406, "comment_id": 62101598, "body": "It&#39;s just very poorly formatted source code. It says <code>*sec++ = CSSt1...</code>"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 3, "creation_date": 1463532786, "post_id": 37288406, "comment_id": 62101699, "body": "The expression parses as <code>*(sec++) = ...</code>; there is no <code>++=</code> operator."}, {"owner": {"reputation": 6510, "user_id": 2196561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac22ef3edb7836c3af11f5511f7942f8?s=128&d=identicon&r=PG", "display_name": "Ebbe M. Pedersen", "link": "https://stackoverflow.com/users/2196561/ebbe-m-pedersen"}, "edited": false, "score": 0, "creation_date": 1463572687, "post_id": 37288406, "comment_id": 62120305, "body": "This is quite similar to the <a href=\"http://stackoverflow.com/questions/1642028/what-is-the-name-of-the-operator\">goes toward:  --&gt;</a>  operator .."}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 12, "last_activity_date": 1463532490, "creation_date": 1463532490, "answer_id": 37288431, "question_id": 37288406, "link": "https://stackoverflow.com/questions/37288406/what-is-in-c/37288431#37288431", "title": "What is &quot;++=&quot; in C?", "body": "<p>There is no <code>++=</code> operator - what you see in on the left side of the <code>*sec++=...</code> assignment is a sequence of three operators glued together by poor formatting:</p>\n\n<ul>\n<li><code>*</code> dereferences the pointer</li>\n<li><code>++</code> increments it</li>\n<li><code>=</code> assigns the result of the right-hand side to the location pointed to by the pointer <em>before</em> it has been incremented.</li>\n</ul>\n"}], "owner": {"reputation": 55, "user_id": 6348286, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ALRmKwbVbtE/AAAAAAAAAAI/AAAAAAAADt0/a0sFiNSWm5M/photo.jpg?sz=128", "display_name": "ELI BRADLEY", "link": "https://stackoverflow.com/users/6348286/eli-bradley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 907, "favorite_count": 0, "accepted_answer_id": 37288431, "answer_count": 1, "score": 3, "last_activity_date": 1463532490, "creation_date": 1463532177, "question_id": 37288406, "link": "https://stackoverflow.com/questions/37288406/what-is-in-c", "title": "What is &quot;++=&quot; in C?", "body": "<p>What does the ++= operator even <strong>do</strong> in C? It wouldn't compile in Derek Fawcus' <a href=\"http://decss.zoy.org/decss.c\" rel=\"nofollow\">\"css_unscramble.c\" program</a>, so I was wondering how to replace it, from a purely academic standpoint. Thanks for reviewing my question, Stack Exchange community!</p>\n\n<pre><code>void CSSdescramble(unsigned char *sec,unsigned char *key) {\n  unsigned int t1,t2,t3,t4,t5,t6;\n  unsigned char *end=sec+0x800;\n  t1=key[0]^sec[0x54]|0x100;\n  t2=key[1]^sec[0x55];\n  t3=(*((unsigned int *)(key+2)))^(*((unsigned int *)(sec+0x56)));\n  t4=t3&amp;7;\n  t3=t3*2+8-t4;\n  sec+=0x80;\n  t5=0;\n  while(sec!=end) {\n    t4=CSSt2[t2]^CSSt3[t1];\n    t2=t1&gt;&gt;1;\n    t1=((t1&amp;1)&lt;&lt;8)^t4;\n    t4=CSSt5[t4];\n    t6=(((((((t3&gt;&gt;3)^t3)&gt;&gt;1)^t3)&gt;&gt;8)^t3)&gt;&gt;5)&amp;0xff;\n    t3=(t3&lt;&lt;8)|t6;\n    t6=CSSt4[t6];\n    t5+=t6+t4;\n    *sec++=CSSt1[*sec]^(t5&amp;0xff);\n    t5&gt;&gt;=8;\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "simgrid"], "comments": [{"owner": {"reputation": 1296, "user_id": 1756334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c825332eff76785b2c93b2629762c470?s=128&d=identicon&r=PG", "display_name": "Martin Quinson", "link": "https://stackoverflow.com/users/1756334/martin-quinson"}, "edited": false, "score": 0, "creation_date": 1463531105, "post_id": 37287974, "comment_id": 62101323, "body": "Could you specify the version of SimGrid that you are using? The platf_generator.h file was removed in 3.13 AFAIK."}, {"owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "reply_to_user": {"reputation": 1296, "user_id": 1756334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c825332eff76785b2c93b2629762c470?s=128&d=identicon&r=PG", "display_name": "Martin Quinson", "link": "https://stackoverflow.com/users/1756334/martin-quinson"}, "edited": false, "score": 0, "creation_date": 1463531275, "post_id": 37287974, "comment_id": 62101362, "body": "@MartinQuinson, I use 3.13 version. I should look for #include &lt;Msg/msg.h&gt;, not &lt;simgrid/msg.h&gt;"}], "answers": [{"tags": [], "owner": {"reputation": 1296, "user_id": 1756334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c825332eff76785b2c93b2629762c470?s=128&d=identicon&r=PG", "display_name": "Martin Quinson", "link": "https://stackoverflow.com/users/1756334/martin-quinson"}, "is_accepted": true, "score": 3, "last_activity_date": 1463610485, "creation_date": 1463610485, "answer_id": 37311114, "question_id": 37287974, "link": "https://stackoverflow.com/questions/37287974/cant-find-simgrid-msg-h-of-simgrid/37311114#37311114", "title": "Can&#39;t find simgrid/msg.h of simgrid", "body": "<p>you are definitely not using a 3.13 version of SimGrid but at most a 3.11. I'm certain because the file you are using (msg/msg.h) does not work anymore since then. Plus, 3.13 introduces many files that should appear on that screenshot. </p>\n\n<p>Could you please fix your question, or close it ?</p>\n"}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 37311114, "answer_count": 1, "score": 0, "last_activity_date": 1463610485, "creation_date": 1463528846, "last_edit_date": 1592644375, "question_id": 37287974, "link": "https://stackoverflow.com/questions/37287974/cant-find-simgrid-msg-h-of-simgrid", "title": "Can&#39;t find simgrid/msg.h of simgrid", "body": "<p>I installed simgrid according to instruction in INSTALL file:</p>\n<pre><code>cmake -DCMAKE_INSTALL_PREFIX=~/SimGrid  -Denable_maintainer_mode=off -Denable_java=on -Denable_scala=off -Denable_lua=off -Denable_smpi=on -Denable_model-checking=off\n\nmake \nsudo make install\n</code></pre>\n<p>But I can't find msg.h file in include directory:</p>\n<p><a href=\"https://i.stack.imgur.com/0eWpt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0eWpt.png\" alt=\"enter image description here\" /></a></p>\n<p>What did I make incorrectly?</p>\n"}, {"tags": ["c", "function", "switch-statement"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1463528208, "post_id": 37287786, "comment_id": 62100674, "body": "What do you type in?"}, {"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "edited": false, "score": 0, "creation_date": 1463528520, "post_id": 37287786, "comment_id": 62100758, "body": "void what_to_do() should be void what_to_do(void), other functions as well"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1463528705, "post_id": 37287786, "comment_id": 62100796, "body": "Exactly what do you enter at the prompt when the program prompts you, and exactly what did you then see?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463529166, "post_id": 37287786, "comment_id": 62100897, "body": "<code>fgets(password, 10, stdin);</code> --&gt; <code>fgets(password, 11, stdin);</code>, <code>int up,num;</code> --&gt; <code>int up = 0, num = 0;</code>, at <code>nickname</code> <code>if (num == 1){</code> --&gt; <code>if (up == 1){</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1463529446, "post_id": 37287786, "comment_id": 62100965, "body": "<code>scanf(&quot;%d&quot;, &amp;number);</code> --&gt; <code>scanf(&quot;%d%*c&quot;, &amp;number);</code> or <code>scanf(&quot;%d&quot;, &amp;number); while(getchar()!=&#39;\\n&#39;);</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463530510, "post_id": 37287786, "comment_id": 62101178, "body": "In <code>nickname()</code> you write <code>up=1</code> but never use <code>up</code>; and you test <code>num == 1</code> but <code>num</code> is an uninitialized variable"}], "answers": [{"comments": [{"owner": {"reputation": 3154, "user_id": 602549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Me0xj.jpg?s=128&g=1", "display_name": "racs", "link": "https://stackoverflow.com/users/602549/racs"}, "edited": false, "score": 0, "creation_date": 1463530288, "post_id": 37288150, "comment_id": 62101124, "body": "Also: whenever you need to debug your code it is always a good idea to dump the input what you are about to process. If you would add this line into your code after reading the password: <code>printf(&quot;input: &#39;%s&#39;&quot;, password);</code> then you would see immediately that the new line character is added into your input feed."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1463562026, "post_id": 37288150, "comment_id": 62112987, "body": "^^ what @racs says.  It&#39;s called debugging.  If you cannot debug, you cannot program computers."}], "tags": [], "owner": {"reputation": 3154, "user_id": 602549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Me0xj.jpg?s=128&g=1", "display_name": "racs", "link": "https://stackoverflow.com/users/602549/racs"}, "is_accepted": false, "score": 0, "last_activity_date": 1463530154, "creation_date": 1463530154, "answer_id": 37288150, "question_id": 37287786, "link": "https://stackoverflow.com/questions/37287786/cant-call-a-function-properly-from-switch-cant-recall-a-function/37288150#37288150", "title": "Can&#39;t call a function properly from switch, can&#39;t recall a function", "body": "<p>All your problems are related to how the input handling works from the standard input: it is handled as a stream of characters, while the data is sent from the terminal only when you press the enter key which adds a new line character to the stream.</p>\n\n<p>Your code is not expecting a new line character and interprets it as part of the input which leads to the explained side effects.</p>\n\n<p>You must consume or remove the new line character every time when you read from the standard input. It is explained here why this happens and what can you do to avoid it in full details:</p>\n\n<p><a href=\"http://www.gidnetwork.com/b-60.html\" rel=\"nofollow\">http://www.gidnetwork.com/b-60.html</a></p>\n"}], "owner": {"reputation": 1, "user_id": 6348105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/890e1e68aa0d26a9b956e77a62bbe1a6?s=128&d=identicon&r=PG&f=1", "display_name": "Volmis", "link": "https://stackoverflow.com/users/6348105/volmis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1463530154, "creation_date": 1463527605, "question_id": 37287786, "link": "https://stackoverflow.com/questions/37287786/cant-call-a-function-properly-from-switch-cant-recall-a-function", "title": "Can&#39;t call a function properly from switch, can&#39;t recall a function", "body": "<p>I have some problems with my code. At first when I want to call a function from a switch statement it won't work. I mean the function is calling but the fgets and stdin doesn't work. If I call the same function alone in main, all works properly. And the other problem is that when I want to recall the same function in else statement. I want to recall the function just once when the password (or nickname) is wrong but it recalls several times, usually quite random times.</p>\n\n<pre><code>void passcheck(){\n\n    char password[11];\n    int up,num;\n\n    puts(\"Password (max 10 signs, must contain upperletter and number):\");\n    fgets(password, 10, stdin);\n\n    for(int i = 0; i &lt; 10; i++){\n        if (isupper(password[i])) {\n            up=1;\n        }\n        if (isdigit(password[i])){\n            num=1;\n        }\n    }\n    if (num == 1 &amp;&amp; up == 1){\n        printf(\"Your password is good and looks like:\\n%s\\n\", password);\n    }\n    else{\n        puts(\"Correct you password\");\n        passcheck();\n    }\n}\n\nvoid nickname(){\n\n    char nick[11];\n    int up,num;\n\n    puts(\"Type your nickname (must contain upperletter):\");\n    fgets(nick, 10, stdin);\n\n    for(int i = 0; i &lt; 10; i++){\n        if (isupper(nick[i])) {\n            up=1;\n        }\n    }\n    if (num == 1){\n        printf(\"Your nickname is good and it is:\\n%s\\n\", nick);\n    }\n    else{\n        puts(\"Correct nickname\");\n        nickname();\n    }\n}\n\n\nvoid what_to_do(){\n    int number;\n    puts(\"What do you want to do?\\n 1. Check password \\n 2. Check nickname\");\n\n    scanf(\"%d\", &amp;number);\n    switch (number) {\n        case 1:\n            passcheck();\n            break;\n        case 2:\n            nickname();\n            break;\n        default:\n            puts(\"Wrong sign!\");\n            break;\n    }\n}\nint main(){\n\n    what_to_do();\n\n    //passcheck();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "video", "ffmpeg", "benchmarking"], "answers": [{"comments": [{"owner": {"reputation": 19142, "user_id": 334402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/476b932160cd12fa0e4515a313427679?s=128&d=identicon&r=PG", "display_name": "Mick", "link": "https://stackoverflow.com/users/334402/mick"}, "edited": false, "score": 0, "creation_date": 1463761406, "post_id": 37289384, "comment_id": 62218481, "body": "It might be worth explaining the difference between the different times - the &#39;real&#39; time is probably not the most useful for comparisons as it depends on system load, available cores etc."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1511326289, "post_id": 37289384, "comment_id": 81808607, "body": "An easier way to ignore streams is <code>-an</code> to ignore audio streams, or <code>-vn</code> ignore video streams."}, {"owner": {"reputation": 85949, "user_id": 1109017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PX561.png?s=128&g=1", "display_name": "llogan", "link": "https://stackoverflow.com/users/1109017/llogan"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1511332959, "post_id": 37289384, "comment_id": 81811007, "body": "@PeterCordes I prefer <code>-map</code> because it&#39;s more flexible and you can choose (or exclude) specific streams."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1511333138, "post_id": 37289384, "comment_id": 81811086, "body": "Sure, it has its uses.  But for me by far the most common thing is &quot;leave out the audio&quot; or &quot;leave out the video&quot;, and <code>-an</code> is faster to type and I don&#39;t need to know which stream number is the audio and which is the video.  (e.g. with <code>-f md5</code>  to compare two files to see if they have the same audio or video bitstream, even if they&#39;re muxed differently)."}], "tags": [], "owner": {"reputation": 85949, "user_id": 1109017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PX561.png?s=128&g=1", "display_name": "llogan", "link": "https://stackoverflow.com/users/1109017/llogan"}, "is_accepted": false, "score": 22, "last_activity_date": 1528859705, "last_edit_date": 1528859705, "creation_date": 1463539554, "answer_id": 37289384, "question_id": 37287533, "link": "https://stackoverflow.com/questions/37287533/how-to-benchmark-the-decoding-of-the-frame-by-ffmpeg/37289384#37289384", "title": "How to benchmark the decoding of the frame by ffmpeg?", "body": "<h1>Null muxer</h1>\n\n<p>If you want a simple way to benchmark decoding use the <a href=\"https://ffmpeg.org/ffmpeg-formats.html#null\" rel=\"noreferrer\">null muxer</a>:</p>\n\n<pre><code>ffmpeg -i input -f null -\n</code></pre>\n\n<h1>Timing decoding</h1>\n\n<p>Linux and macOS users can add the <code>time</code> command:</p>\n\n<pre><code>$ time ffmpeg -i input -f null -\n[...]\nreal    0m5.343s\nuser    0m20.290s\nsys     0m0.230s\n</code></pre>\n\n<p>See <code>man time</code> for more info.</p>\n\n<h1><code>-benchmark</code> option</h1>\n\n<p>The <code>-benchmark</code> option can be added to output CPU time and maximum memory consumption:</p>\n\n<pre><code>$ time ffmpeg -i input -benchmark -f null -\n[...]\nbench: utime=7.314s\nbench: maxrss=72280kB\n</code></pre>\n\n<h1>Choosing streams</h1>\n\n<p>If you want to just decode a particular stream then use the <a href=\"https://ffmpeg.org/ffmpeg.html#Advanced-options\" rel=\"noreferrer\">map option</a>:</p>\n\n<pre><code>ffmpeg -i input -map 0:a:0 -f null -\n</code></pre>\n\n<h1>Threads</h1>\n\n<p>You can decode with one thread if you want to:</p>\n\n<pre><code>ffmpeg -threads 1 -i input -f null -\n</code></pre>\n\n<p>Not all decoders have threading capabilities and some have several. You can check decoder details such as <code>ffmpeg -h decoder=h264</code>.</p>\n\n<h1>Choosing a decoder</h1>\n\n<p>There can be several decoders available for a format. You can name the decoder if you don't want to rely on the default:</p>\n\n<pre><code>ffmpeg -c:v vp8 -i input -f null -\nffmpeg -c:v libvpx -i input -f null -\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 5537562, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/v0z6E.jpg?s=128&g=1", "display_name": "Anny G", "link": "https://stackoverflow.com/users/5537562/anny-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9769, "favorite_count": 3, "answer_count": 1, "score": 6, "last_activity_date": 1528859705, "creation_date": 1463525903, "question_id": 37287533, "link": "https://stackoverflow.com/questions/37287533/how-to-benchmark-the-decoding-of-the-frame-by-ffmpeg", "title": "How to benchmark the decoding of the frame by ffmpeg?", "body": "<p>[ What I have done ] </p>\n\n<p>I am trying to measure a performance of different ffmpeg decoders by</p>\n\n<ul>\n<li>timing how long the call to function <code>avcodec_decode_video2(..)</code> takes in ffmpeg.c and running ffmpeg binary the following way</li>\n</ul>\n\n<p><code>~/bin/ffmpeg -benchmark_all -loglevel debug -threads 0 -i ~/Documents/video-input.h264 -c:v libx265 -x265-params crf=25 video-output.hevc</code></p>\n\n<ul>\n<li>and by timing how long the same function takes in ffplay.c and running the ffplay binary the following way</li>\n</ul>\n\n<p><code>~/bin/ffplay ~/Documents/video-input.h264</code></p>\n\n<p>In my understanding the average time for the call to that function should be the same whether I am converting the video or playing it, because I am only measuring how long it takes to decode the frame for that video. Is this a wrong way of doing it? Please let me know if I am incorrect. The results I am getting are strange to me - the call to the aforementioned function takes twice as much in ffmpeg binary compared to ffplay binary. I have tried to run ffmpeg binary with <code>-threads 0</code> and without it, but the results are still the same(twice as long as ffplay). Could it be because ffplay binary simply utilizes more threads? When I try it with <code>-threads 1</code>, ffmpeg takes about 10 times as long as ffplay (which makes sense to me since before it was using several threads and now it is only using 1)</p>\n\n<p>Before I ask my question, I want you to know that I am a beginner in video processing and video encoding/decoding processes.</p>\n\n<p>[My question]</p>\n\n<p>I am wondering what would be an accurate way to measure how long it takes to decode a frame (using 1 thread)? Should I simply measure only how long it takes to call <code>avcodec_decode_video2(..)</code> function using the ffmpeg binary, and not the ffplay binary? Would the results be more accurate that way? \nI also tried to enable <code>-benchmark_all -loglevel debug</code> options, but it seems like the following message <code>bench:    64537 decode_video 0.0</code> is not very helpful if 0.0 is supposed to mean time. (Not sure what the other number means).</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5795, "user_id": 3253896, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fa6d2f73d0c32ee94e11661d94857fc8?s=128&d=identicon&r=PG", "display_name": "\u0428\u0430\u0445", "link": "https://stackoverflow.com/users/3253896/%d0%a8%d0%b0%d1%85"}, "edited": false, "score": 1, "creation_date": 1463525154, "post_id": 37287412, "comment_id": 62099860, "body": "Use functions, now, code is unreadable. But if u want save code as now but without <code>goto</code> then I&#39;ll post."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1463530217, "post_id": 37287412, "comment_id": 62101113, "body": "I don&#39;t see much point in making the program caller pass in file names that have to be named &quot;F1&quot;, &quot;F2&quot;, &quot;F3&quot;, and &quot;F4&quot;."}, {"owner": {"reputation": 91, "user_id": 6225228, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/34859846693ece27a6783f98e608253e?s=128&d=identicon&r=PG&f=1", "display_name": "Tee", "link": "https://stackoverflow.com/users/6225228/tee"}, "edited": false, "score": 0, "creation_date": 1463583818, "post_id": 37287412, "comment_id": 62128762, "body": "the actually file name like this 20150518F1 20150518F2 20150518F3 20150518F4,the date change everyday"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1468976664, "post_id": 37287412, "comment_id": 64345281, "body": "The code in your question won&#39;t compile. You need <code>#include &lt;stdio.h&gt;</code> and <code>#include &lt;stdlib.h&gt;</code> at the top, and <code>GOTO L1;</code> needs to be <code>goto L1;</code>. Also, the <code>sprintf</code> calls are dangerous; you&#39;re using <code>argv[i]</code> as a format string, and if it contains <code>%</code> characters Bad Things Can Happen."}], "answers": [{"tags": [], "owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "is_accepted": false, "score": 0, "last_activity_date": 1463525389, "creation_date": 1463525389, "answer_id": 37287457, "question_id": 37287412, "link": "https://stackoverflow.com/questions/37287412/how-to-redesign-this-code-to-avoid-goto/37287457#37287457", "title": "How to redesign this code to avoid goto", "body": "<p>the obvious variant is to change if statements like this:</p>\n\n<pre><code>if (access(file1,0) == 0){\n    if((fp1 = fopen(file1,\"r\")) == NULL) exit(-1);\n    do_file_1(fp1);\n    fclose(fp1);\n}\n\nif (access(file2,0) == 0 ){\n    if((fp2 = fopen(file2,\"r\")) == NULL) exit(-1);\n    do_file_2(fp2);\n    fclose(fp2);\n}\n\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": true, "score": 2, "last_activity_date": 1463525394, "creation_date": 1463525394, "answer_id": 37287460, "question_id": 37287412, "link": "https://stackoverflow.com/questions/37287412/how-to-redesign-this-code-to-avoid-goto/37287460#37287460", "title": "How to redesign this code to avoid goto", "body": "<p>You have \"if this condition is true, skip over some code\". That's the only thing you're using <code>goto</code> for.</p>\n\n<p>That's exactly what <code>if</code> does (except <code>if</code> skips the code if the condition is false).</p>\n\n<p>You can replace:</p>\n\n<pre><code>L2: if (access(file3,0) != 0)\n{\n   goto L3;\n}\nif((fp3=fopen(file3,\"r\"))==NULL)\n{\n  exit(-1);\n}\ndo_file_3(fp3);\nfclose(fp3);\n\nL3:\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>if (access(file3,0) == 0)\n{\n  if((fp3=fopen(file3,\"r\"))==NULL)\n  {\n    exit(-1);\n  }\n  do_file_3(fp3);\n  fclose(fp3);\n}\n</code></pre>\n\n<p>and similarly for the other uses of <code>goto</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 5492, "user_id": 6083675, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/D2CgS.png?s=128&g=1", "display_name": "Laurel", "link": "https://stackoverflow.com/users/6083675/laurel"}, "is_accepted": false, "score": 2, "last_activity_date": 1468976276, "last_edit_date": 1495541684, "creation_date": 1463525397, "answer_id": 37287461, "question_id": 37287412, "link": "https://stackoverflow.com/questions/37287412/how-to-redesign-this-code-to-avoid-goto/37287461#37287461", "title": "How to redesign this code to avoid goto", "body": "<p>You refactor in steps.</p>\n\n<p>You can take the end label statement and put it directly where it is called. That's easy.</p>\n\n<p>For the others, you can use else statements:</p>\n\n<pre><code>if (access(file1,0) != 0){\n    //GOTO L1;\n}else{\n  if((fp1 = fopen(file1,\"r\")) == NULL){\n      exit(-1);\n  }\n  do_file_1(fp1);\n  fclose(fp1);\n}\n\nL1: if (access(file2,0) != 0 ){\n        //goto L2;\n    }else{\n      if((fp2 = fopen(file2,\"r\")) == NULL){\n          exit(-1);\n      }\n      do_file_2(fp2);\n      fclose(fp2);\n    }\n\n    L2: if (access(file3,0) != 0)\n    {\n       //goto L3;\n    }else{\n      if((fp3=fopen(file3,\"r\"))==NULL)\n      {\n        exit(-1);\n      }\n      do_file_3(fp3);\n      fclose(fp3);\n    }\n\n\n\n    L3: if (access(file4,0) !=0)\n    {\n        end:\n        return 0;\n    }\n    if((fp4=fopen(file4,\"r\"))==NULL)\n    {\n      exit(-1);\n    }\n    do_file_4(fp4);\n    fclose(fp4);\n</code></pre>\n\n<p>Of course, since there is no other statements in the if statements, the <code>if else</code> can be refactored to just be an <code>if</code>.</p>\n\n<p>I have broken down more complex problems like this <a href=\"https://stackoverflow.com/a/37082004\">in the past</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "is_accepted": false, "score": 0, "last_activity_date": 1463525455, "creation_date": 1463525455, "answer_id": 37287470, "question_id": 37287412, "link": "https://stackoverflow.com/questions/37287412/how-to-redesign-this-code-to-avoid-goto/37287470#37287470", "title": "How to redesign this code to avoid goto", "body": "<p>You're just using goto's as a way to reverse the <code>if</code> clauses. Reverse them directly and indent what lies between:</p>\n\n<pre><code>if (access(file1,0) != 0){\n    GOTO L1;\n}\nif((fp1 = fopen(file1,\"r\")) == NULL){\n    exit(-1);\n}\ndo_file_1(fp1);\nfclose(fp1);\n\nL1: ...\n</code></pre>\n\n<p>Becomes:</p>\n\n<pre><code>if (access(file1,0) == 0) \n{\n    if((fp1 = fopen(file1,\"r\")) == NULL){\n        exit(-1);\n    }\n    do_file_1(fp1);\n    fclose(fp1);\n}\n//L1: \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5795, "user_id": 3253896, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fa6d2f73d0c32ee94e11661d94857fc8?s=128&d=identicon&r=PG", "display_name": "\u0428\u0430\u0445", "link": "https://stackoverflow.com/users/3253896/%d0%a8%d0%b0%d1%85"}, "is_accepted": false, "score": 0, "last_activity_date": 1463525936, "creation_date": 1463525936, "answer_id": 37287540, "question_id": 37287412, "link": "https://stackoverflow.com/questions/37287412/how-to-redesign-this-code-to-avoid-goto/37287540#37287540", "title": "How to redesign this code to avoid goto", "body": "<pre><code>int main(int argc, char **argv){\n    char *tmp;\n    int i, flag1=0, flag2=0, flag3=0, flag4=0;\n    FILE *fp1;\n    FILE *fp2;\n    FILE *fp3;\n    FILE *fp4;\n\n    char file1[64];\n    char file2[64];\n    char file3[64];\n    char file4[64];\n\n    for( i=1; i&lt;argc; i++){\n        tmp = argv[i];\n        if ( strcmp(tmp,\"F1\") == 0 ){\n            sprintf(file1,argv[i]);\n            flag1=1;\n        }\n        else if (strcmp(tmp,\"F2\") == 0 ){\n            sprintf(file2,argv[i]);\n            flag2=1;\n        }\n        else if (strcmp(tmp,\"F3\") == 0 ){\n            sprintf(file3,argv[i]);\n            flag3=1;\n        }\n        else if (strcmp(tmp,\"F4\") == 0 ){\n            sprintf(file4,argv[i]);\n            flag4=1;\n        }\n    }\n\n    if( !(flag1 &amp;&amp; flag2 &amp;&amp; flag3 &amp;&amp; flag4) ){\n        printf(\"Must input four files!!\\n\");\n        return -1;\n    }\n\n    if (access(file1,0) == 0) {\n\n        if((fp1 = fopen(file1,\"r\")) == NULL){\n            return -1;\n        }\n\n        do_file_1(fp1);\n        fclose(fp1);\n    }\n    /*L1:*/\n    if (access(file2,0) == 0 ) {\n\n        if((fp2 = fopen(file2,\"r\")) == NULL){\n            return -1;\n        }\n\n        do_file_2(fp2);\n        fclose(fp2);\n    }\n\n    /*L2:*/\n    if (access(file3,0) == 0) {\n\n       if((fp3=fopen(file3,\"r\"))==NULL) {\n           return -1;\n        }\n\n        do_file_3(fp3);\n        fclose(fp3);\n    }\n\n    /* L3: */\n    if (access(file4,0) == 0) {\n\n       if((fp4=fopen(file4,\"r\"))==NULL) {\n           return -1;\n       }\n\n       do_file_4(fp4);\n       fclose(fp4);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>But really, no one programer will not do so.</p>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 6225228, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/34859846693ece27a6783f98e608253e?s=128&d=identicon&r=PG&f=1", "display_name": "Tee", "link": "https://stackoverflow.com/users/6225228/tee"}, "edited": false, "score": 0, "creation_date": 1463583436, "post_id": 37288050, "comment_id": 62128431, "body": "the actually file name like this 20150518F1 20150518F2 20150518F3 20150518F4,is used for bank reconciliation every day.strcmp(tmp+8,F1) and so on.hope this will make you clear:)"}, {"owner": {"reputation": 91, "user_id": 6225228, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/34859846693ece27a6783f98e608253e?s=128&d=identicon&r=PG&f=1", "display_name": "Tee", "link": "https://stackoverflow.com/users/6225228/tee"}, "edited": false, "score": 0, "creation_date": 1463585574, "post_id": 37288050, "comment_id": 62130037, "body": "I think your code is very cool and beautiful !! but immibis&#39;s answer is more clear here."}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "reply_to_user": {"reputation": 91, "user_id": 6225228, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/34859846693ece27a6783f98e608253e?s=128&d=identicon&r=PG&f=1", "display_name": "Tee", "link": "https://stackoverflow.com/users/6225228/tee"}, "edited": false, "score": 0, "creation_date": 1463585734, "post_id": 37288050, "comment_id": 62130150, "body": "@Tee, happy to hear your opinion of the code and this is a rewrite of your source example that is more condensed using more advanced features of the C programming language. As for the function arguments not being the same, I was going by your example which all have an argument of <code>FILE *</code> with a handle to the open file to be processed."}, {"owner": {"reputation": 91, "user_id": 6225228, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/34859846693ece27a6783f98e608253e?s=128&d=identicon&r=PG&f=1", "display_name": "Tee", "link": "https://stackoverflow.com/users/6225228/tee"}, "edited": false, "score": 0, "creation_date": 1463586302, "post_id": 37288050, "comment_id": 62130546, "body": "if the function arguments not being the same is there a way to use an array of function pointers still?"}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "reply_to_user": {"reputation": 91, "user_id": 6225228, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/34859846693ece27a6783f98e608253e?s=128&d=identicon&r=PG&f=1", "display_name": "Tee", "link": "https://stackoverflow.com/users/6225228/tee"}, "edited": false, "score": 0, "creation_date": 1463593785, "post_id": 37288050, "comment_id": 62135027, "body": "@Tee the question would be what are the differences between the function interfaces or list of arguments and their types. When you say function arguments not being the same do you mean different types in the function arguments (e.g. <code>int func_1 (char *p, int j)</code> versus <code>char * func_2 (int one, int two, float three)</code>). If by different arguments you mean the types in the interface and the number of arguments are the same but the actual values in the arguments are different then you could. If the function interface is different, then maybe depending on the differences."}], "tags": [], "owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "is_accepted": false, "score": 1, "last_activity_date": 1463529743, "last_edit_date": 1495540372, "creation_date": 1463529381, "answer_id": 37288050, "question_id": 37287412, "link": "https://stackoverflow.com/questions/37287412/how-to-redesign-this-code-to-avoid-goto/37288050#37288050", "title": "How to redesign this code to avoid goto", "body": "<p>Perhaps an approach like the following which uses loops with arrays would be shorter and more compact. This is a fairly straightforward transformation that consolidates separate variables into arrays. This does use an array of function pointers (see <a href=\"https://stackoverflow.com/questions/840501/how-do-function-pointers-in-c-work\">How do Function pointers in C work</a>).</p>\n\n<p>The <code>do_file_1()</code>, <code>do_file_2()</code>, etc. functions are just place holders for the actual functions you are using. This keeps the literal file names (\"F1\", \"F2\", etc.) that you specify though I am not sure why you are requiring certain, specific file names.</p>\n\n<p>I also use the <code>strcpy()</code> function to copy the file name argument into the array of file names to open rather than using the <code>sprintf()</code> function.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;io.h&gt;\n#include &lt;string.h&gt;\n\nvoid do_file_1 (FILE *fp)\n{\n    printf (\"function do_file_1 called.\\n\");\n}\nvoid do_file_2 (FILE *fp)\n{\n    printf (\"function do_file_2 called.\\n\");\n}\nvoid do_file_3 (FILE *fp)\n{\n    printf (\"function do_file_3 called.\\n\");\n}\nvoid do_file_4 (FILE *fp)\n{\n    printf (\"function do_file_4 called.\\n\");\n}\n\nint main(int argc, char **argv)\n{\n    int   i;\n    char  *fileArray[4] = { \"F1\", \"F2\", \"F3\", \"F4\"};\n    char  fname[4][64] = {0};\n    void  (*funcs[4]) (FILE *fp) = {do_file_1, do_file_2, do_file_3, do_file_4};\n\n    for( i = 1; i &lt; argc; i++) {\n        int  j;\n        for (j = 0; j &lt; 4; j++) {\n            if ( strcmp(argv[i], fileArray[j]) == 0 ) {\n                strcpy(fname[j],argv[i]);\n                break;\n            }\n        }\n    }\n\n    if( !(fname[0][0] &amp;&amp; fname[1][0] &amp;&amp; fname[2][0] &amp;&amp; fname[3][0]) ) {\n        printf(\"Must input four files!!\\n\");\n        exit(-1);\n    }\n\n    for (i = 0; i &lt; 4; i++) {\n        if (access(fname[i],0) == 0) {\n            FILE *fp = fopen(fname[i],\"r\");\n            if (fp != NULL) {\n                funcs[i](fp);\n                fclose(fp);\n            } else {\n                break;\n            }\n        } else {\n            break;\n        }\n    }\n    if (i &lt; 4) exit(-1);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 6225228, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/34859846693ece27a6783f98e608253e?s=128&d=identicon&r=PG&f=1", "display_name": "Tee", "link": "https://stackoverflow.com/users/6225228/tee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 37287460, "answer_count": 6, "score": 1, "last_activity_date": 1468976276, "creation_date": 1463525070, "last_edit_date": 1463580159, "question_id": 37287412, "link": "https://stackoverflow.com/questions/37287412/how-to-redesign-this-code-to-avoid-goto", "title": "How to redesign this code to avoid goto", "body": "<p>I have a programme that needs the user to input 4 files (no order require). Then I do something to the files differently. Now I used the goto statement, I want to replace the goto statement, but don't know how. And I want to know if these go to have some problem? Here is my code that using goto:</p>\n\n<pre><code>int main(int argc, char **argv){\n    char *tmp;\n    int i, flag1=0, flag2=0, flag3=0, flag4=0;\n    FILE *fp1;\n    FILE *fp2;\n    FILE *fp3;\n    FILE *fp4;\n\n    char file1[64];\n    char file2[64];\n    char file3[64];\n    char file4[64];\n\n    for( i=1; i&lt;argc; i++){\n        tmp = argv[i];\n        if ( strcmp(tmp+8,\"F1\") == 0 ){\n            sprintf(file1,argv[i]);\n            flag1=1;\n        }\n        else if (strcmp(tmp+8,\"F2\") == 0 ){\n            sprintf(file2,argv[i]);\n            flag2=1;\n        }\n        else if (strcmp(tmp+8,\"F3\") == 0 ){\n            sprintf(file3,argv[i]);\n            flag3=1;\n        }\n        else if (strcmp(tmp+8,\"F4\") == 0 ){\n            sprintf(file4,argv[i]);\n            flag4=1;\n        }\n    }\n\n    if( !(flag1 &amp;&amp; flag2 &amp;&amp; flag3 &amp;&amp; flag4) ){\n        printf(\"Must input four files!!\\n\");\n        exit(-1);\n    }\n\n    if (access(file1,0) != 0){\n        GOTO L1;\n    }\n    if((fp1 = fopen(file1,\"r\")) == NULL){\n        exit(-1);\n    }\n    do_file_1(fp1);\n    fclose(fp1);\n\n    L1: if (access(file2,0) != 0 ){\n        goto L2;\n    }\n    if((fp2 = fopen(file2,\"r\")) == NULL){\n        exit(-1);\n    }\n    do_file_2(fp2);\n    fclose(fp2);\n\n\n    L2: if (access(file3,0) != 0)\n    {\n       goto L3;\n    }\n    if((fp3=fopen(file3,\"r\"))==NULL)\n    {\n      exit(-1);\n    }\n    do_file_3(fp3);\n    fclose(fp3);\n\n\n\n    L3: if (access(file4,0) !=0)\n    {\n      goto end;\n    }\n    if((fp4=fopen(file4,\"r\"))==NULL)\n    {\n      exit(-1);\n    }\n    do_file_4(fp4);\n    fclose(fp4);\n\n\n    end:\n        return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "sql-server", "linux", "character-encoding", "freetds"], "comments": [{"owner": {"reputation": 3460, "user_id": 1987788, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5229a103393dc342027d269fb8cf7f1e?s=128&d=identicon&r=PG", "display_name": "natenho", "link": "https://stackoverflow.com/users/1987788/natenho"}, "reply_to_user": {"reputation": 30439, "user_id": 3215527, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/eL3Zs.jpg?s=128&g=1", "display_name": "wero", "link": "https://stackoverflow.com/users/3215527/wero"}, "edited": false, "score": 0, "creation_date": 1463575133, "post_id": 37287329, "comment_id": 62122137, "body": "Hum, it&#39;s just a literal char * passed to SQLBindParameter... I thought FreeTDS would take care of it anyway."}, {"owner": {"reputation": 3460, "user_id": 1987788, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5229a103393dc342027d269fb8cf7f1e?s=128&d=identicon&r=PG", "display_name": "natenho", "link": "https://stackoverflow.com/users/1987788/natenho"}, "reply_to_user": {"reputation": 30439, "user_id": 3215527, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/eL3Zs.jpg?s=128&g=1", "display_name": "wero", "link": "https://stackoverflow.com/users/3215527/wero"}, "edited": false, "score": 0, "creation_date": 1463584979, "post_id": 37287329, "comment_id": 62129598, "body": "I&#39;ve updated the question with more info."}, {"owner": {"reputation": 30439, "user_id": 3215527, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/eL3Zs.jpg?s=128&g=1", "display_name": "wero", "link": "https://stackoverflow.com/users/3215527/wero"}, "edited": false, "score": 1, "creation_date": 1463585991, "post_id": 37287329, "comment_id": 62130357, "body": "try to set tds version to 8.0 see <a href=\"http://stackoverflow.com/a/28741880/3215527\">stackoverflow.com/a/28741880/3215527</a>"}], "answers": [{"comments": [{"owner": {"reputation": 701, "user_id": 2507142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O4DqF.png?s=128&g=1", "display_name": "katalin_2003", "link": "https://stackoverflow.com/users/2507142/katalin-2003"}, "edited": false, "score": 0, "creation_date": 1500468162, "post_id": 37305834, "comment_id": 77348902, "body": "The <code>TDS_Version=</code> in the connection string was what fixed it for me. Thanks!"}], "tags": [], "owner": {"reputation": 3460, "user_id": 1987788, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5229a103393dc342027d269fb8cf7f1e?s=128&d=identicon&r=PG", "display_name": "natenho", "link": "https://stackoverflow.com/users/1987788/natenho"}, "is_accepted": true, "score": 3, "last_activity_date": 1463598113, "last_edit_date": 1463598113, "creation_date": 1463590622, "answer_id": 37305834, "question_id": 37287329, "link": "https://stackoverflow.com/questions/37287329/freetds-how-to-set-charset-of-parameters-running-stored-procedure/37305834#37305834", "title": "FreeTDS: How to set charset of parameters running stored procedure", "body": "<p>After a lot of attempts, I couldn't figure out why freetds.conf settings (client charset and tds version) are not being respected. At least, when I append <strong>TDS_Version=8.0;ClientCharset=UTF-8</strong> into the <a href=\"http://www.freetds.org/userguide/odbcconnattr.htm\" rel=\"nofollow noreferrer\">connection string</a>, it works!</p>\n\n<p><a href=\"https://i.stack.imgur.com/r89fl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r89fl.png\" alt=\"Record is stored correctly when changed the connection string\"></a></p>\n\n<pre><code>\"Driver={FreeTDS};Server=%s;Port=%s;Database=%s;UID=%s;PWD=%s;APP=%s;TDS_Version=8.0;ClientCharset=UTF-8\"\n</code></pre>\n\n<p>Also, the header of freetds log file is changed, mentioning UTF-8 conversion:</p>\n\n<pre><code>log.c:196:Starting log file for FreeTDS 0.91\n        on 2016-05-18 15:58:49 with debug flags 0x4fff.\niconv.c:330:tds_iconv_open(0xaeb19118, UTF-8)\niconv.c:353:Using trivial iconv\niconv.c:187:local name for ISO-8859-1 is ISO-8859-1\niconv.c:187:local name for UTF-8 is UTF-8\niconv.c:187:local name for UCS-2LE is UCS-2LE\niconv.c:187:local name for UCS-2BE is UCS-2BE\niconv.c:349:setting up conversions for client charset \"UTF-8\"\niconv.c:351:preparing iconv for \"UTF-8\" &lt;-&gt; \"UCS-2LE\" conversion\niconv.c:391:preparing iconv for \"ISO-8859-1\" &lt;-&gt; \"UCS-2LE\" conversion\niconv.c:394:tds_iconv_open: done\n</code></pre>\n"}], "owner": {"reputation": 3460, "user_id": 1987788, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5229a103393dc342027d269fb8cf7f1e?s=128&d=identicon&r=PG", "display_name": "natenho", "link": "https://stackoverflow.com/users/1987788/natenho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1408, "favorite_count": 1, "accepted_answer_id": 37305834, "answer_count": 1, "score": 0, "last_activity_date": 1604175677, "creation_date": 1463524660, "last_edit_date": 1604175677, "question_id": 37287329, "link": "https://stackoverflow.com/questions/37287329/freetds-how-to-set-charset-of-parameters-running-stored-procedure", "title": "FreeTDS: How to set charset of parameters running stored procedure", "body": "<p>I have a C program connecting to a MSSQL database through <a href=\"http://www.freetds.org/\" rel=\"nofollow noreferrer\">FreeTDS</a>.</p>\n<p>I'm trying to execute a stored procedure with a varchar parameter set to something like &quot;Sa\u00edda Liberada&quot;, but it's being stored with weird characters in MS SQL, as the screenshot bellow:</p>\n<p><a href=\"https://i.stack.imgur.com/GM1ME.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GM1ME.png\" alt=\"Sa\u00edda Liberada with wrong characters\" /></a></p>\n<p>Here is my freetds.conf:</p>\n<pre><code>#   $Id: freetds.conf,v 1.12 2007/12/25 06:02:36 jklowden Exp $\n#\n# This file is installed by FreeTDS if no file by the same\n# name is found in the installation directory.\n#\n# For information about the layout of this file and its settings,\n# see the freetds.conf manpage &quot;man freetds.conf&quot;.\n\n# Global settings are overridden by those in a database\n# server specific section\n[global]\n        # TDS protocol version\n        tds version = 8.0\n\n        # Whether to write a TDSDUMP file for diagnostic purposes\n        # (setting this to /tmp is insecure on a multi-user system)\n        dump file = /tmp/freetds.log\n;       debug flags = 0xffff\n\n        # Command and connection timeouts\n;       timeout = 10\n;       connect timeout = 10\n\n        # If you get out-of-memory errors, it may mean that your client\n        # is trying to allocate a huge buffer for a TEXT field.\n        # Try setting 'text size' to a more reasonable limit\n        text size = 64512\n\n        client charset = UTF-8\n</code></pre>\n<p>Here is parts of the tds dump file:</p>\n<pre><code>log.c:196:Starting log file for FreeTDS 0.91\n        on 2016-05-17 19:19:41 with debug flags 0x4fff.\niconv.c:330:tds_iconv_open(0xaed19130, ISO-8859-1)\niconv.c:353:Using trivial iconv\niconv.c:187:local name for ISO-8859-1 is ISO-8859-1\niconv.c:187:local name for UTF-8 is UTF-8\niconv.c:187:local name for UCS-2LE is UCS-2LE\niconv.c:187:local name for UCS-2BE is UCS-2BE\niconv.c:349:setting up conversions for client charset &quot;ISO-8859-1&quot;\niconv.c:351:preparing iconv for &quot;ISO-8859-1&quot; &lt;-&gt; &quot;UCS-2LE&quot; conversion\niconv.c:391:preparing iconv for &quot;ISO-8859-1&quot; &lt;-&gt; &quot;ISO-8859-1&quot; conversion\niconv.c:394:tds_iconv_open: done\n\n...\n\nnet.c:741:Sending packet\n0000 01 01 00 84 00 00 00 00-20 45 58 45 43 20 55 50 |........  EXEC UP|\n0010 5f 49 4e 53 45 52 54 4d-4f 56 49 4d 45 4e 54 4f |_INSERTM OVIMENTO|\n0020 20 27 32 30 31 36 2d 30-35 2d 31 37 20 31 39 3a | '2016-0 5-17 19:|\n0030 31 39 3a 33 31 2e 30 30-30 27 2c 27 30 30 30 30 |19:31.00 0','0000|\n0040 30 30 30 30 30 30 36 34-38 33 30 35 37 30 33 30 |00000064 83057030|\n0050 27 2c 27 53 27 2c 30 2c-32 2c 27 50 43 56 43 30 |','S',0, 2,'PCVC0|\n0060 34 20 3d 20 53 61 c3 ad-64 61 20 4c 69 62 65 72 |4 = Sa.. da Liber|\n0070 61 64 61 27 2c 34 2c 27-50 43 56 43 4d 41 4e 41 |ada',4,' PCVCMANA|\n0080 47 45 52 27            -                        |GER'|\n</code></pre>\n<p>According to the freetds log, it's sending the character '\u00ed' (i acute) as c3 ad, which means it's sending it as UTF-8 (LATIN SMALL LETTER I WITH ACUTE).</p>\n<p>How can I setup the client or the server, so the string can be properly stored?</p>\n<p><strong>Update 1:</strong></p>\n<pre><code># tsql -C\nCompile-time settings (established with the &quot;configure&quot; script)\n                            Version: freetds v0.91\n             freetds.conf directory: /etc\n     MS db-lib source compatibility: no\n        Sybase binary compatibility: yes\n                      Thread safety: yes\n                      iconv library: no\n                        TDS version: 4.2\n                              iODBC: no\n                           unixodbc: yes\n              SSPI &quot;trusted&quot; logins: no\n                           Kerberos: no\n#\n</code></pre>\n<p><strong>Update 2</strong></p>\n<p>Code to connect:</p>\n<pre><code>ret = SQLDriverConnect(db_msserver_dbc_handle,\n    NULL,  &quot;Driver={FreeTDS};Server=FooBar;Port=1433;Database=Foo;UID=sa;PWD=pwd@123;APP=XPTO;TDS_Version=8.0;&quot;,\n    SQL_NTS, outstr, sizeof(outstr), &amp;outstrlen,\n    SQL_DRIVER_COMPLETE);\n</code></pre>\n"}, {"tags": ["c", "algorithm", "performance", "hashtable", "cs50"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1463526639, "post_id": 37287248, "comment_id": 62100304, "body": "The problem with the caching idea: you&#39;ll speed up the processing of words that happen to be in the cache, but slow down the processing of words not in the cache. So for example, if the misspelled words are put into a cache, then you&#39;ll speed up the processing of about 5000 words, but slow down the processing of about 1.14 million words.  That&#39;s a bad trade-off. So I&#39;d skip the caching idea, and work on getting all 8 cores computing hash functions."}, {"owner": {"reputation": 6036, "user_id": 1717828, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b52e6a27ec5f0cee4f12713f058923f2?s=128&d=identicon&r=PG", "display_name": "user1717828", "link": "https://stackoverflow.com/users/1717828/user1717828"}, "edited": false, "score": 2, "creation_date": 1463532207, "post_id": 37287248, "comment_id": 62101561, "body": "If you don&#39;t find what you&#39;re looking for here, try on Code Review."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1463536511, "post_id": 37287248, "comment_id": 62102561, "body": "Did you profile your code?"}, {"owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "edited": false, "score": 0, "creation_date": 1463539168, "post_id": 37287248, "comment_id": 62103238, "body": "Given that you have a significant number of repeated misspellings, have you considered adding the misspellings to the hash? If you store the true/false result of the lookup, and insert bad words at the start of the hash chains, you might get some performance back."}, {"owner": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1463546742, "post_id": 37287248, "comment_id": 62105212, "body": "@PaulHankin - sort of, using getrusage and rusage struct between calls to each function, where loading the dictionary into memory, checking incoming words against the hash table, and freeing the heap are individually timed, as well as overall Valgrind to ensure that everything is cleaned up."}, {"owner": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "reply_to_user": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "edited": false, "score": 0, "creation_date": 1463546967, "post_id": 37287248, "comment_id": 62105311, "body": "@AustinHastings Adding the misspellings / marking them &quot;bad&#39; to the hash would require a change to the chain link struct and require an additional check beyond the hash -&gt; value -&gt; key checks I&#39;m doing already. I&#39;ll have to think on that. Good suggestion though. I will try it out."}, {"owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "edited": false, "score": 0, "creation_date": 1463620096, "post_id": 37287248, "comment_id": 62145605, "body": "You could append an extra byte to the word, and store it past the trailing &#39;\\0&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "edited": false, "score": 0, "creation_date": 1463534894, "post_id": 37287418, "comment_id": 62102187, "body": "Thank you for the note, Austin. I had considered a trie instead of a hash table, but I&#39;m not convinced it would provide a speed improvement. I&#39;m at close to O(1), and moving to a trie would be a step in the wrong direction, unless I am missing something fundamental about your suggestion. I will go ahead and implement a trie anyhow, and post the results in a bit. Was hoping to avoid trial and error, but since I&#39;m learning, those are the breaks. :-)"}, {"owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "reply_to_user": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "edited": false, "score": 1, "creation_date": 1463536736, "post_id": 37287418, "comment_id": 62102631, "body": "Hashing a word is O(len) on the word. Trie traversal is O(len) as well. It&#39;s an apples/apples scenario."}, {"owner": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "reply_to_user": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "edited": false, "score": 0, "creation_date": 1463963485, "post_id": 37287418, "comment_id": 62273056, "body": "@Drew: O(1) can be fast or it can be horribly slow. What matters is the constant factor. (Tweak your instructor about that - I&#39;m amazed how many kiddoes come out of school thinking they can snow people with big-O.) I tend to agree with Austin&#39;s trie, because if there are only 50k words in the dictionary, the trie doesn&#39;t get very deep. What&#39;s more, you can use it for <a href=\"http://stackoverflow.com/a/3196466/23771\"><i>spelling correction</i></a>. Also, I bet there&#39;s another trick they&#39;re not telling you - you can precompile the dictionary into code. That will give you massive speedup."}, {"owner": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "reply_to_user": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "edited": false, "score": 0, "creation_date": 1463984925, "post_id": 37287418, "comment_id": 62278248, "body": "@MikeDunlavey thanks for your reply. The challenge to each of the points you make (and they are valid) is that I have absolutely no idea ahead of time what dictionary they will throw at me. So, they may give me a dictionary with 10 words, or 500,000 between runs. Otherwise, for sure I&#39;d take the 30-40 seconds to pre-process and persist a perfect hash table. That would be great! But, they&#39;re onto that trick. ;-)"}], "tags": [], "owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "is_accepted": false, "score": 6, "last_activity_date": 1463525136, "creation_date": 1463525136, "answer_id": 37287418, "question_id": 37287248, "link": "https://stackoverflow.com/questions/37287248/how-can-i-improve-spell-check-time-in-c-program/37287418#37287418", "title": "How can I improve spell check time in C program?", "body": "<p>This is a pretty well-solved problem. ;-) You should look into a data structure called a <a href=\"https://en.wikipedia.org/wiki/Trie\"><strong>trie</strong></a>. A trie is a tree built of individual characters, so that the <em>path</em> represents the information. Each node consists of letters you can legitimately add to the current prefix. When a letter is a valid word, that is also recorded.</p>\n\n<p>For four words:</p>\n\n<pre><code>root-&gt; [a]-&gt; [a]-&gt; [r]-&gt; [d]-&gt; [v]-&gt; [a]-&gt; [r]-&gt; [k*]-&gt;[s*]\n             [b]\n                \\&gt; [a]-&gt; [c]-&gt; [i*]\n                               [u]-&gt; [s*]\n</code></pre>\n\n<p>This would represent \"aardvark\", \"aardvarks\", \"abaci\", and \"abacus.\" The nodes are vertically contiguous, so 2nd letter [ab] is a node, and 5th letter [i*u] is a node.</p>\n\n<p>Traverse the trie character by character, and check for a valid word when you hit space. If you can't traverse with the character you have, then it's a bad word. If you don't find valid when you hit space, it's a bad word.</p>\n\n<p>This is O(n) to process (n = word length) and it's very, very fast. Building the trie is going to consume a bunch of RAM, but you don't care about that I think.</p>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "edited": false, "score": 0, "creation_date": 1463535422, "post_id": 37288644, "comment_id": 62102308, "body": "Thank you for your response, rici. I like the idea of moving the &quot;commonest&quot; link to the front of the list, even if it only saves a few iterations. Occupancy is less of a problem since I&#39;m using a very large table with fewer than 2K internal collisions for the 150K word dictionary, though I have not yet analyzed each bucket to determine how evenly the collisions are distributed. (I have a secondary integer table that stores indexes of the hash table for easy cleanup.) I will definitely be looking at PCMPESTRI and I appreciate the suggestion."}, {"owner": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "edited": false, "score": 0, "creation_date": 1463538099, "post_id": 37288644, "comment_id": 62102958, "body": "PCMPESTRI is actually easier to implement in ASM than it is in C. That is a first for me."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "edited": false, "score": 0, "creation_date": 1463541516, "post_id": 37288644, "comment_id": 62103791, "body": "@drew: there are intrinsics :) If you don&#39;t have many collisions, it&#39;s probably not useful for multiple bucket compares (but getting rid of the linked lists is still a good optimization for dictionaries). PCMPESTRI is also useful for implementing strtok-like things. But it&#39;s <i>not</i> sliced bread. Profile and see if it really helps."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "edited": false, "score": 0, "creation_date": 1463542173, "post_id": 37288644, "comment_id": 62103937, "body": "It is interesting that your second experiment takes significantly longer with fewer word lookups. Are the words longer? Or, contrary to what I suggest in my answer, is there something which is hugely slowing down failed lookups?"}, {"owner": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "edited": false, "score": 0, "creation_date": 1463546057, "post_id": 37288644, "comment_id": 62105037, "body": "re: longer lookup time - this is hosted on a cloud9 Ubuntu IDE, so mid-day runs are dubious. I ran it again just now on the same data set, and the result was:      Unique Misspellings: 8348     WORDS MISSPELLED:     45691     WORDS IN DICTIONARY:  143091     WORDS IN TEXT:        904612     TIME IN load:         0.05     TIME IN check:        0.45     TIME IN size:         0.00     TIME IN unload:       0.03     TIME IN TOTAL:        0.53"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "edited": false, "score": 0, "creation_date": 1463608129, "post_id": 37288644, "comment_id": 62142309, "body": "The variation in those timings makes that benchmarking technique unusable. It is possible that the bulk of the time is reading from the disk; standard benchmarking techniques would help get more consistent values (although not necessarily more meaningful). Do the experiment k times (in a loop); discard outliers and report the mean. That way you will probably have the input file cached in kernel buffers after the first couple of iterations, and the remaining ones won&#39;t need to wait for spindles."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "edited": false, "score": 0, "creation_date": 1463793946, "post_id": 37288644, "comment_id": 62230814, "body": "@drew: So, how did it work out for you in the end? For my little hack I used an Ubuntu dictionary of 99,171 words and an old newsfeed corpus I had kicking around. I&#39;m probably cheating by not doing doing a second lookup on words with uppercase characters, but the result is to detect a lot more failures. Anyway, the input is a bit over 6MB; it has 968234 words, of which 199845 are not in the dictionary; building the dictionary takes about 25 milliseconds and looking up the text takes about 70 milliseconds. (i5 laptop, 2.5GHz, single thread executable.)"}, {"owner": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "edited": false, "score": 0, "creation_date": 1463887327, "post_id": 37288644, "comment_id": 62252617, "body": "Hey @rici, thanks for asking and for taking the time to try it out yourself. I got sidetracked working on the next project (writing an Apache-like web server) that I finished this afternoon. Now I&#39;m going back to put a stamp on the spell checker. I&#39;m also not checking caps. I&#39;m cheating by taking the incoming word and bitwise OR 32 to give me all lowercase. I will have an answer for you tomorrow."}, {"owner": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "edited": false, "score": 0, "creation_date": 1463942744, "post_id": 37288644, "comment_id": 62267608, "body": "I&#39;ll be working on this today If you want to take a look... <a href=\"http://github.com/Ganellon/spell_check\" rel=\"nofollow noreferrer\">github.com/Ganellon/spell_check</a> main is in speller.c  but according to the rules of the assignment, this source file may not be changed. All of my code is in dictionary.c"}, {"owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "edited": false, "score": 0, "creation_date": 1463975620, "post_id": 37288644, "comment_id": 62275524, "body": "I took a look at your code. I&#39;m not sure if it will matter in your environment, but if you&#39;re running 64 bit pointers, you might get a speed up with 1.2 million of them just by cutting them down to 32 bits. Try replacing the pointers to the words in your dictionary with 32 bit values -either near pointers or 32 bit integers offset from the <code>mem_dict</code> base address. (This is primarily to improve cache performance by reducing data size.)"}, {"owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "edited": false, "score": 0, "creation_date": 1463975975, "post_id": 37288644, "comment_id": 62275595, "body": "Also, don&#39;t free <code>mem_dict</code>. Just point into it. Allocating individual strings is worse, since <code>malloc()</code> and friends round up to some even block size."}, {"owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "edited": false, "score": 0, "creation_date": 1463976590, "post_id": 37288644, "comment_id": 62275719, "body": "Finally, consider abandoning <code>mem_dict</code> and throwing memory at the problem. If you treat the first 4 or 8 bytes of the chain entry as an integer type, you can zero-fill the <code>temp</code> buffer and your chain block and compare them as integers. <code>if (*(int32_t*)temp == *(int32_t*)(Trav-&gt;key)) {...</code> I think you&#39;ll do pretty well with 32 bits, and most of the common words are less than 64 bits long, so you can hard-code the logic (since you know <code>lenny</code>) to skip the <code>memcmp</code> entirely."}, {"owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "edited": false, "score": 0, "creation_date": 1463976887, "post_id": 37288644, "comment_id": 62275778, "body": "Finally-finally (really!), consider converting to Pascal strings (put an 8-bit length in the first char). You&#39;re doing this work already, and it triggers the earliest possible failure for words of different lengths."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "edited": false, "score": 0, "creation_date": 1463977640, "post_id": 37288644, "comment_id": 62275901, "body": "@drew: Is the benchmarking code in spelling.c part of what you were given? My immediate reaction was that it was &quot;just plain wrong&quot;, but I&#39;ve settled down to &quot;inaccurate&quot;; it&#39;s trying to measure events whose expected running time is (at worst) hundreds of nanoseconds with a microsecond resolution timer. Obviously, that&#39;s inexact but there is some reason to believe that it&#39;s not <i>too</i> inexact because if you have a lot of events, the timer will roll over to the next value inside an event with a probability roughly equal to the actual time taken by the event."}, {"owner": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "reply_to_user": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "edited": false, "score": 0, "creation_date": 1463984365, "post_id": 37288644, "comment_id": 62278010, "body": "@AustinHastings Thank you so much for taking a look! I&#39;m not actually freeing mem_dict until the hash table is filled and have no further use for mem_dict. I thought I could just use it without creating a hash table, but then really I&#39;d have a glorified linear search. Is that what you mean?"}, {"owner": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "edited": false, "score": 0, "creation_date": 1463984529, "post_id": 37288644, "comment_id": 62278091, "body": "@rici Yes, everything that&#39;s in speller.c is as it arrived as part of the distro. Changes to speller.c are not permitted - and I can guess why in some places where I&#39;d have made changes."}, {"owner": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "reply_to_user": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "edited": false, "score": 0, "creation_date": 1463988355, "post_id": 37288644, "comment_id": 62279990, "body": "@AustinHastings Just had an ah-ha moment with regard to keeping mem_dict around by moving it into global space and using those addresses. That will definitely save some time, rather than malloc for each new node. I&#39;ll still have to malloc for collision nodes, but there are far fewer. Thanks for this tip."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "edited": false, "score": 0, "creation_date": 1464021390, "post_id": 37288644, "comment_id": 62301070, "body": "@drew: it&#39;s clear that they&#39;re trying to not contaminate the timing of your lookup function with, for example, the timing of the word parser or with printing the misspelled words, if the printf is uncommented. But the result is to contaminate the benchmark with the cost of calling getrusage. On my system, getrusage takes about 220 nsec; a reasonable hash lookup shouldn&#39;t take even 100 nsec, so at least 2/3 of the accounted time is made up of calling getrusage."}, {"owner": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "edited": false, "score": 0, "creation_date": 1464026895, "post_id": 37288644, "comment_id": 62303943, "body": "@rici - you can see why I commented that line out of speller.c; having all of those misspellings dumping to the screen is nonsensical. I commented it out because I was only interested in the summary, but that is not the &quot;official&quot; version, which I will have to use in the final product."}, {"owner": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "reply_to_user": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "edited": false, "score": 0, "creation_date": 1464027375, "post_id": 37288644, "comment_id": 62304227, "body": "@AustinHastings changing node from key[45] to *key and updating the CreateNode and AddNode functions reduced the load function time from .06 to .04 seconds. This will always be a consistent rate based on the size of the dictionary, but this is a huge savings! Great suggestion."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "edited": false, "score": 0, "creation_date": 1464038002, "post_id": 37288644, "comment_id": 62309895, "body": "@drew: I suppose they dump the misspellings to stdout in order to verify that the correct misspellings are identified. However, combining a benchmark and a validation is not always a good idea. In this case, I would think that the two should be separated, in which case you could just surround the entire lookup loop with a single pair of getrusage. Of course, that would have the effect of including the cost of parsing, which is also non-trivial compared with the cost of lookup..."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1464038109, "post_id": 37288644, "comment_id": 62309951, "body": "... The way I&#39;d do it would be to first read the entire input into memory, parse it into words, and validate the misspellings. Then I&#39;d reparse the input, keeping track of how much time that took. Then I&#39;d reparse the input again, but this time do the lookups, again keeping track of the time. The difference between the two would be the cost of lookup. Validating first would warm up the cache so that the other two loops would be (more) comparable."}, {"owner": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1464072961, "post_id": 37288644, "comment_id": 62320188, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/112744/discussion-between-drew-and-rici\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 7, "last_activity_date": 1463794961, "last_edit_date": 1463794961, "creation_date": 1463534237, "answer_id": 37288644, "question_id": 37287248, "link": "https://stackoverflow.com/questions/37287248/how-can-i-improve-spell-check-time-in-c-program/37288644#37288644", "title": "How can I improve spell check time in C program?", "body": "<p>In both of your trials, what is noticeable is that the majority of words are correctly spelled. Consequently, you should focus on optimizing lookup of words which are in the dictionary.</p>\n\n<p>In your first trial, for example, only 1.5% of all words are misspelled. Suppose it takes twice as long on average to look up a word which is not in the dictionary (because every word in the bucket needs to be checked). Even if if you reduced that to 0 (the theoretical minimum :) ), you would speed your program up by less than 3%.</p>\n\n<p>A common hashtable optimization is to move the key you find to the beginning of the bucket chain, if it is not already there. That will tend to reduce the number of hash entries checked for commonly-used words. It's not a huge speed-up, but in cases where some keys are looked up much more often than others, it can definitely be noticed.</p>\n\n<p>Reducing chain length by decreasing the hashtable occupancy may help more, at the cost of more memory. </p>\n\n<p>Another possibility, since you are not going to modify the dictionary once it is built, is to store each bucket chain in contiguous memory, without pointers. Not only will that reduce memory consumption, it will improve cache performance because since most words are short, most buckets will fit in a single cache line.</p>\n\n<p>And since words tend to be quite short, you may well be able to find a way to optimize the comparison. <code>strcmp()</code> is well optimized but it is generally optimized for larger strings. If you're allowed to use it, the SSE4.2 PCMPESTRI opcode is amazingly powerful (but figuring out what it does and how to use it to solve your problem can be a huge time-waster). More simply, you should be able to compare four eight-byte prefixes simultaneously with 256-bit comparison operations (and you might even have 512-bit operations available to you), so with clever data arrangement, you may well be able to do an entire bucket comparison in parallel.</p>\n\n<p>That's not to say that hashtables are necessarily the optimal datastructure for this problem. But remember that the more you can do in a single cache-line, the faster you program will run. Linked-list-intensive datastructures can turn out to be suboptimal even if they look good on paper.</p>\n\n<hr>\n\n<p>After thinking about this problem for a couple of days and actually writing some code, I came to the conclusion that optimizing for successful hashtable lookup speed is probably not correct <em>for a realworld spellchecker</em>. It's true that most words in the text being looked up are usually correctly spelled -- although that depends on the spellcheck user -- but the algorithm which attempts to suggest correct spellings is likely to do a lot of unsuccessful lookups as it cycles through possible misspellings. I know that's probably out of scope for this problem, but it does make a difference for optimization, because you end up with two quite different strategies.</p>\n\n<p>If you're trying to reject quickly, you need lots of possibly empty bucket chains, or a Bloom filter or its moral equivalent, so you can reject most errors on the first probe.</p>\n\n<p>For example, if you have a good hash algorithm which yields more bits than you need -- and you almost certainly do, because spellcheck dictionaries aren't that big -- then you can just use some otherwise-unused bits in the hash for a secondary hash. Without even going to the trouble of implementing the entire Bloom filter, you can just add, say, a 32-bit mask to each bucket header representing the possible values of five secondary hash bits in the values stored in that bucket. Combined with a sparse table -- I used 30% occupancy for the experiment, which is not that sparse -- you should be able to reject 80-90% of lookup failures without going beyond the bucket header.</p>\n\n<p>On the other hand, if you're trying to optimize for success, then it might turn out that largish buckets are better because it cuts down on the number of bucket headers, and that improves cache usage. As long as the entire bucket fits into a cache-line, the speed of multiple comparisons is so high that you won't notice the difference. (And since words tend to be short, it's reasonable to expect five or six to fit into a 64-byte cacheline.)</p>\n\n<p>Anyway, without going to too much work, I managed to do a million lookups in 70 milliseconds of CPU. Multiprocessing could speed up elapsed time quite a bit particularly as no locking is required given that the hash table is immutable.</p>\n\n<p>The morals I want to draw from this:</p>\n\n<p>In order to optimize:</p>\n\n<ul>\n<li><p>you need to understand your data</p></li>\n<li><p>you need to understand your expected usage pattern</p></li>\n<li><p>you need to adapt your algorithms based on the above</p></li>\n<li><p>you need to do a lot of experimenting.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 94195, "user_id": 410767, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c1dd4727d07c7dbb6ff8c3a83e400b5?s=128&d=identicon&r=PG", "display_name": "Tony Delroy", "link": "https://stackoverflow.com/users/410767/tony-delroy"}, "is_accepted": false, "score": 1, "last_activity_date": 1463545960, "creation_date": 1463545960, "answer_id": 37290357, "question_id": 37287248, "link": "https://stackoverflow.com/questions/37287248/how-can-i-improve-spell-check-time-in-c-program/37290357#37290357", "title": "How can I improve spell check time in C program?", "body": "<p>A few insights/ideas you might explore:</p>\n\n<ul>\n<li><p>where the values are similar in length - or little bigger than pointers - closed hashing will give you better performance than any open hashing aka separate chaining approach</p></li>\n<li><p>the length of words being checked is a cheap (perhaps free if you're tracking it anyway) way you can direct validations to methods that are most optimal for that word length</p>\n\n<ul>\n<li><p>to get more words onto fewer pages of memory (and thereby be more cache friendly), you could try having multiple hash tables, where the buckets are sized to the longest length of text therein</p></li>\n<li><p>4-byte and 8-byte buckets conveniently allow single-instruction aligned 32-bit and 64-bit value comparisons, if you pad the strings out with NULs (i.e. you can make a union of <code>uint32_t</code> and <code>char[4]</code>, or <code>uint64_t</code> and <code>char[8]</code>, and compare the integer values).</p></li>\n<li><p>your choice of hash function is important: try a good few</p></li>\n<li><p>your choice of collision handling strategy is important too: profile with linear, quadratic, and perhaps a list of primes (1, 3, 7, 11...).</p></li>\n<li><p>the number of buckets is a balancing act: too few and you have too many collisions, too many buckets and you have more memory cache misses, so test with a range of values to find the optimal settings</p></li>\n</ul></li>\n<li><p>you might profile using a more collision-averse prime number of buckets with <code>%</code> folding hash values into the bucket index range vs. a power of two bucket count where you can use faster <code>&amp;</code> bitmasking</p></li>\n<li><p>many of the above interact: e.g. if you use a strong hash function, you have less need of a prime number of buckets; if you have less collisions, you have less need of an elaborate post-collision search order through alternative buckets</p></li>\n<li><p>the spell checking is very easy to scale with threads, as you're doing read-only hash table lookups; the prior insertion of the dictionary into the hash table(s) - less so, though using multiple tables as above offers one way to parallelise it</p></li>\n</ul>\n"}], "owner": {"reputation": 79, "user_id": 6347918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zjULJtukXi8/AAAAAAAAAAI/AAAAAAAAA1Q/jwKSUTjSz8g/photo.jpg?sz=128", "display_name": "Drew", "link": "https://stackoverflow.com/users/6347918/drew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1511, "favorite_count": 1, "answer_count": 3, "score": 7, "last_activity_date": 1472443891, "creation_date": 1463524273, "last_edit_date": 1472443891, "question_id": 37287248, "link": "https://stackoverflow.com/questions/37287248/how-can-i-improve-spell-check-time-in-c-program", "title": "How can I improve spell check time in C program?", "body": "<p>As one of the assignments in Harvard's CS50 course, students are tasked with creating a spell checking program. The main thrust of the assignment is speed - pure speed - and I've gotten to the point where I'm beating the staff's implementation, but I feel that I can do better, and am looking for a push in the right direction.</p>\n\n<p>Here is my pseudocode:</p>\n\n<pre><code>// read the dictionary word list\nRead entire dictionary in one fread into memory\nrawmemchr through and pick out the words\nsend each word through the hash function\ncreate chain links for any index where collisions occur\n\n// accept the incoming test words\nRun the test word through the hash function\ncompare to the existing table / linked list\nreturn the result of the comparison\n</code></pre>\n\n<p>With a dictionary of 150K words, and input text up to 6MB, I'm able to accurately spell check in about a half second.</p>\n\n<p>However, when I look at the words that are coming from the input text, it's pretty clear that a large percentage of those words are common (like \"the\", \"and\", \"for\"), and that most of the misspelled words are also checked multiple times.</p>\n\n<p>My intuition says I should be able to \"cache\" the \"good hits\" and \"bad hits\" so that I'm not hashing the same words over and over for table lookups. Even though the current result is very close to O(1), I feel like I should be able to shave a few microseconds off the time by re-evaluating my approach.</p>\n\n<p>For example, after I have loaded the dictionary, the text input could be 8MB of nothing but this: \"missspeling\". So rather than hash / check the same word over and over (at a computational expense), I would like to understand if there is a way to programmatically discard words which have already been hashed and rejected, but in a way that is more efficient than the hash / check itself. (I'm using MurmurHash3, fwiw).</p>\n\n<p>I realize that the theoretical performance improvement would be limited to situations where the input text is long, and there are a high number of repeat misspellings. Based on some of the input texts I've evaluated, here are some of the results:</p>\n\n<pre><code>Unique Misspellings: 6960\nTotal Misspellings:  17845\nWords in dictionary: 143091\nWords in input text: 1150970\nTotal Time:          0.56 seconds\n\nUnique Misspellings: 8348\nTotal Misspellings:  45691\nWords in dictionary: 143091\nWords in input text: 904612\nTotal Time:          0.83 seconds \n</code></pre>\n\n<p>In the second sample run, you can see that I'm having to go back to the hash table approximately 5.5 times for each misspelled word! That seems nuts to me, and I feel there must be a more efficient way to address this circumstance, since most of my program's time is spent in the hash function.</p>\n\n<p>I could implement Posix threads (this runs on an 8 core system) to improve the program's time, but I am more interested in improving my approach and thought process around the problem.</p>\n\n<p>Sorry this is so long winded, but this is my first Stack Overflow post and I'm trying to be thorough. I searched before posting, but most other \"spell check\" posts are related to \"how\" and not \"improve\". I'm grateful for suggestions that get me pointed in the right direction.</p>\n\n<p><a href=\"http://github.com/Ganellon/spell_check\" rel=\"nofollow\">http://github.com/Ganellon/spell_check</a></p>\n"}, {"tags": ["c", "file", "eof"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 6, "creation_date": 1463523492, "post_id": 37286960, "comment_id": 62099297, "body": "Please post the contents of test.txt. My guess is that you don&#39;t have 50 words in the file."}, {"owner": {"reputation": 1588, "user_id": 6082851, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b14f3cd864bc266a401eca07b4153602?s=128&d=identicon&r=PG", "display_name": "12431234123412341234123", "link": "https://stackoverflow.com/users/6082851/12431234123412341234123"}, "edited": false, "score": 0, "creation_date": 1463523517, "post_id": 37286960, "comment_id": 62099312, "body": "fscanf(p,&quot;%s&quot;,a[i].word); can end in a buffer overflow, use fscanf(p,&quot;%79s&quot;,a[i].word); or fgets(). and check for errors after fopen()"}], "answers": [{"comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 2, "creation_date": 1463524090, "post_id": 37287163, "comment_id": 62099516, "body": "Please describe what modifications you had to make to the OP&#39;s code so it works for you."}, {"owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1463525433, "post_id": 37287163, "comment_id": 62099942, "body": "@RSahu I added improved code and more description. I hope you approve or comment again."}, {"owner": {"reputation": 13595, "user_id": 668501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f15b157200c05100d6baeb0ede510f0?s=128&d=identicon&r=PG", "display_name": "Soren", "link": "https://stackoverflow.com/users/668501/soren"}, "edited": false, "score": 0, "creation_date": 1463531040, "post_id": 37287163, "comment_id": 62101303, "body": "@Programmer400 -- you make no mentions on why your code is better or why his code failed...."}, {"owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "reply_to_user": {"reputation": 13595, "user_id": 668501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f15b157200c05100d6baeb0ede510f0?s=128&d=identicon&r=PG", "display_name": "Soren", "link": "https://stackoverflow.com/users/668501/soren"}, "edited": false, "score": 0, "creation_date": 1463534063, "post_id": 37287163, "comment_id": 62101971, "body": "@Soren I updated with more description. My strategy was to read the entire file as a string and then tokenize it, plus using a <code>char *</code> for the word instead of a <code>char[]</code>. If it&#39;s not perfect we can &quot;pull request&quot; it...."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1463538593, "post_id": 37287163, "comment_id": 62103082, "body": "That&#39;s lot of change to the OP&#39;s code when the only thing he needs to change to fix his problem is change the last loop."}], "tags": [], "owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1463538072, "last_edit_date": 1463538072, "creation_date": 1463523711, "answer_id": 37287163, "question_id": 37286960, "link": "https://stackoverflow.com/questions/37286960/scanning-from-a-file-in-c/37287163#37287163", "title": "Scanning from a file in C", "body": "<p>It's just string manipulation. I debugged and modified your program a little so that there is text output instead of junk. You might need to modify it some more, but it does print the contents of the file now. The reason you got junk character is that the loop doesn't know when to stop when the string is not terminated, so you get memory contents from something else. The recommended way is <code>fgets</code> to read a file and whitespace is preserved.  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct {\n    char *word;\n    int length;\n    int freq;\n} sent;\n\nint words(const char *sentence) {\n    int count, i, len;\n    char lastC;\n    len = strlen(sentence);\n    if (len &gt; 0) {\n        lastC = sentence[0];\n    }\n    for (i = 0; i &lt;= len; i++) {\n        if (sentence[i] == ' ' &amp;&amp; lastC != ' ') {\n            count++;\n        }\n        lastC = sentence[i];\n    }\n    if (count &gt; 0 &amp;&amp; sentence[i] != ' ') {\n        count++;\n    }\n    return count;\n}\n\nint main() {\n    sent a[50];\n    int v, status;\n    int i = 0, cnt = 0;\n    FILE *p;\n    p = fopen(\"data.txt\", \"r\");\n    char buf[100], title[100];\n    fgets(buf, sizeof buf, p);\n    int j = words(buf);\n    char *yy;\n    yy = strtok(buf, \"!@#$&amp;*?%.\");\n\n    while (yy != NULL) {\n        a[i].word = yy;\n        yy = strtok(NULL, \"!@#$&amp;*?%.\");\n        i++;\n    }\n\n    for (int k = 0; k&lt;i; k++) {\n        printf(\"%s\", a[k].word);\n    }\n}\n</code></pre>\n\n<p>The program tokenizes the buffer and keeps the whitespace. I changed the way you read the file to <code>fgets</code>. </p>\n\n<p><strong>data.txt</strong></p>\n\n<blockquote>\n  <p>On a scale from one to ten what$ is your favorite color of the alphabet</p>\n</blockquote>\n\n<p><strong>output</strong></p>\n\n<p>On a scale from one to ten what is your favorite color of the alphabet </p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6347816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0552826bbb8904daa09c8fabe8d83109?s=128&d=identicon&r=PG&f=1", "display_name": "mayar.m", "link": "https://stackoverflow.com/users/6347816/mayar-m"}, "edited": false, "score": 0, "creation_date": 1463573587, "post_id": 37288310, "comment_id": 62120993, "body": "so <code>i</code> here refers to the number of words not the numbers of characters in the file..... i counted the words in the file and changed the loop according to the number ...it worked but there are no spaces between the words how can i keep the spaces between them ??....thank you for the answer it helped"}, {"owner": {"reputation": 1, "user_id": 6347816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0552826bbb8904daa09c8fabe8d83109?s=128&d=identicon&r=PG&f=1", "display_name": "mayar.m", "link": "https://stackoverflow.com/users/6347816/mayar-m"}, "edited": false, "score": 0, "creation_date": 1463609224, "post_id": 37288310, "comment_id": 62142734, "body": "if i used <code>printf(&quot;%s  &quot;,y);</code> it will not work because i have special characters in between the characters of the word itself ,so there will be spaces between the characters in the word."}, {"owner": {"reputation": 13595, "user_id": 668501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f15b157200c05100d6baeb0ede510f0?s=128&d=identicon&r=PG", "display_name": "Soren", "link": "https://stackoverflow.com/users/668501/soren"}, "reply_to_user": {"reputation": 1, "user_id": 6347816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0552826bbb8904daa09c8fabe8d83109?s=128&d=identicon&r=PG&f=1", "display_name": "mayar.m", "link": "https://stackoverflow.com/users/6347816/mayar-m"}, "edited": false, "score": 0, "creation_date": 1463616131, "post_id": 37288310, "comment_id": 62144640, "body": "Im not sure I understand your question -- you comment asked for how to print the spaces, and there is a long explanation on how to do that -- maybe you are printing the spaces inside the while loop, where you clearly should do it outside after printing each word?"}], "tags": [], "owner": {"reputation": 13595, "user_id": 668501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f15b157200c05100d6baeb0ede510f0?s=128&d=identicon&r=PG", "display_name": "Soren", "link": "https://stackoverflow.com/users/668501/soren"}, "is_accepted": false, "score": 2, "last_activity_date": 1463598976, "last_edit_date": 1463598976, "creation_date": 1463531431, "answer_id": 37288310, "question_id": 37286960, "link": "https://stackoverflow.com/questions/37286960/scanning-from-a-file-in-c/37288310#37288310", "title": "Scanning from a file in C", "body": "<p>As people have commented, you are likely not having 50 words in the file you read, but your loop tries to loop over 50 anyway...., so this line</p>\n\n<pre><code>for(i=0;i&lt;50;i++)\n</code></pre>\n\n<p>should be modified to</p>\n\n<pre><code>int w;\nfor(w=0;w&lt;i;w++)\n</code></pre>\n\n<p>and you should replace the use of <code>i</code> with <code>w</code> inside the loop (or maybe you intended to use the variable <code>cnt</code> inside the while loop, since that is currently unused in your code).</p>\n\n<p>And you need protection for buffer overruns that would happen if your file would have more than 50 words etc, but that is beyond the scope of this answer.</p>\n\n<p><strong>Update</strong> to answer your comment:</p>\n\n<p>To have space between the words, you simply just add them to the output, like</p>\n\n<pre><code>printf(\"%s \",y);\n</code></pre>\n\n<p>Your scanf will however terminate the string scan at any space, so space (hex 20), newline (\\n), tab (\\t) or return (\\r) will all be terminating characters for your strings -- If you want to preserve and output the same, you simply just scan for those as well, like</p>\n\n<pre><code>  char theString[50];\n  char theSpace;\n  int matched = scanf(\"%s%c\",theString, theSpace);\n</code></pre>\n\n<p>and if matched == 2 then you have scanned both a string and the space that terminated the scan, and you can print it like</p>\n\n<pre><code>  printf(\"%s%c\",theModifiedString,theSpace);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6347816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0552826bbb8904daa09c8fabe8d83109?s=128&d=identicon&r=PG&f=1", "display_name": "mayar.m", "link": "https://stackoverflow.com/users/6347816/mayar-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1463598976, "creation_date": 1463522607, "last_edit_date": 1463572246, "question_id": 37286960, "link": "https://stackoverflow.com/questions/37286960/scanning-from-a-file-in-c", "title": "Scanning from a file in C", "body": "<p>I am trying to scan a string from a file using the code below. But my program prints weird characters. Any ideas how to stop this and how to keep spaces between words when printing the string?</p>\n\n<p>here are the contents of the file (test.txt)\n<img src=\"https://i.stack.imgur.com/O1Oks.png\" alt=\" (test.txt) \"></p>\n\n<p>Here is the output of my program:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2Hk24.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2Hk24.png\" alt=\"output\"></a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct\n{\n   char word[80];\n   int length;\n   int freq;\n} sent;\n\nint main()\n{\n   sent a[50];\n   int v,status;\n   int i=0,cnt=0;\n   char*y;\n\n   FILE*p;\n   p=fopen(\"C:\\\\Users\\\\User\\\\Desktop\\\\test.txt\",\"r\");\n   status=fscanf(p,\"%s\",a[i].word);\n   while(status !=EOF){\n      i++;\n      status=fscanf(p,\"%s\",a[i].word);\n   }\n   for(i=0;i&lt;50;i++)\n   {\n      char *y=strtok(a[i].word,\"!@#$%&amp;*?.\");\n\n      while(y!=NULL)\n      {\n         printf(\"%s\",y);\n         y=strtok(NULL,\"!@#$%&amp;*?.\");\n\n      }\n   }\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "unix", "udp", "datagram"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 4, "creation_date": 1463518777, "post_id": 37286124, "comment_id": 62097235, "body": "The last parameter is supposed to be a pointer. Did it also return -1 and set errno to EFAULT, by any chance?"}, {"owner": {"reputation": 105, "user_id": 4722429, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1744ccde946714496adce8dba3a716c9?s=128&d=identicon&r=PG&f=1", "display_name": "mateass", "link": "https://stackoverflow.com/users/4722429/mateass"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1463518878, "post_id": 37286124, "comment_id": 62097288, "body": "it returns -1 and the error message is: Bad address"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1463519014, "post_id": 37286124, "comment_id": 62097348, "body": "That code should not even compile. Are you compiling in permissive mode? You should not!"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1463519468, "post_id": 37286124, "comment_id": 62097562, "body": "<i>it returns -1 and the error message is: Bad address</i> And that is why you always check return codes."}], "answers": [{"tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": true, "score": 4, "last_activity_date": 1463519231, "creation_date": 1463519231, "answer_id": 37286247, "question_id": 37286124, "link": "https://stackoverflow.com/questions/37286124/recvfrom-always-return-zero-remote-address/37286247#37286247", "title": "recvfrom() always return zero remote address", "body": "<p>If you read the documentation for <code>recvfrom</code>, you'll see the last parameter is a <em>pointer to</em> a socklen_t holding the size of the address.</p>\n\n<p>So it should be:</p>\n\n<pre><code>socklen_t client_addr_len = sizeof client_addr;\nint len = recvfrom(....., (struct sockaddr*)&amp;client_addr, &amp;client_addr_len);\n</code></pre>\n\n<p>After calling <code>recvfrom</code>, <code>client_addr_len</code> will hold the actual address length (which could be smaller than the buffer, in theory, if it not an AF_INET address).</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1463519366, "creation_date": 1463519366, "answer_id": 37286280, "question_id": 37286124, "link": "https://stackoverflow.com/questions/37286124/recvfrom-always-return-zero-remote-address/37286280#37286280", "title": "recvfrom() always return zero remote address", "body": "<p>The last argument to your <code>recvfrom()</code> call is incorrect.  It is supposed to be a <em>pointer</em> of type <code>socklen_t *</code>, pointing to a location where the address size is initially stored.  The function modifies the value stored there to reflect the actual size of the address structure, as it wrote it or as it <em>would have</em> written it if the initial size were large enough.  You instead pass the actual size, which must be implicitly converted to a pointer.  Your compiler ought to be warning you about that.</p>\n\n<p>Given that the program is not crashing, <code>recvfrom()</code> must be successfully reading a value from the address pointed to by the converted integer, and successfully writing a value there.  Quite possibly, it is reading the value <code>0</code>.</p>\n"}], "owner": {"reputation": 105, "user_id": 4722429, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1744ccde946714496adce8dba3a716c9?s=128&d=identicon&r=PG&f=1", "display_name": "mateass", "link": "https://stackoverflow.com/users/4722429/mateass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 891, "favorite_count": 0, "accepted_answer_id": 37286247, "answer_count": 2, "score": -1, "last_activity_date": 1463519366, "creation_date": 1463518676, "last_edit_date": 1463518801, "question_id": 37286124, "link": "https://stackoverflow.com/questions/37286124/recvfrom-always-return-zero-remote-address", "title": "recvfrom() always return zero remote address", "body": "<p>I'm writing a simple udp server application and i ran into an error when i try to get the address of the remote connecting user.</p>\n\n<pre><code>while(run == 1) {\n    struct sockaddr_in client_addr;\n    char message[1024];\n    int len = recvfrom(sockfd, message, 1024, 0, (struct sockaddr*)&amp;client_addr, sizeof client_addr);\n\n    printf(\"Received request from: %s#%d\\n\", inet_ntoa(client_addr.sin_addr), ntohs(client_addr.sin_port));\n}\n</code></pre>\n\n<p>It always return the remote address: 0.0.0.0#0</p>\n"}, {"tags": ["c", "pointers", "fgets", "password-prompt"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1463518099, "post_id": 37285730, "comment_id": 62096896, "body": "&#39;Reads characters from stream and stores them as a C string into str until (num-1) characters have been read or either a newline or the end-of-file is reached, whichever happens first.&#39;.  Stop bean-counting.  If you are going to need text line buffers, just declare [128], (unless short of RAM).  Trying to exact-size buffers will just get you bugs, input calls returning early, newline chars left in input streams, that kind of stuff.."}, {"owner": {"reputation": 273, "user_id": 3722559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ae714cac6c3fe6897729aca735eaea?s=128&d=identicon&r=PG&f=1", "display_name": "schil227", "link": "https://stackoverflow.com/users/3722559/schil227"}, "edited": false, "score": 0, "creation_date": 1463518261, "post_id": 37285730, "comment_id": 62096983, "body": "What happens if you have a system(&quot;PAUSE&quot;) or a getch() inbetween the fgets()? I would guess that since the password is being skipped, once you hit enter it&#39;s consuming the line and using it for both the u[] and p[] array."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1463525307, "post_id": 37285730, "comment_id": 62099914, "body": "bear in mind: (1) fgets stores <code>\\n</code> in the output buffer,  (2) if the whole input line doesn&#39;t fit in the output buffer, the next <code>fgets</code> call will read more from the same line, therefore it will not wait"}], "answers": [{"tags": [], "owner": {"reputation": 494, "user_id": 6182200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a10cfc81a61d5aac8ebaf106ae04fde9?s=128&d=identicon&r=PG&f=1", "display_name": "quemeraisc", "link": "https://stackoverflow.com/users/6182200/quemeraisc"}, "is_accepted": false, "score": 1, "last_activity_date": 1463518376, "creation_date": 1463518376, "answer_id": 37286057, "question_id": 37285730, "link": "https://stackoverflow.com/questions/37285730/simple-password-prompt-in-c/37286057#37286057", "title": "Simple password-prompt in C", "body": "<p>The problem here is the size of your char[], if you set it to 6, 'admin' will overflow, as reading with gets will read some extra characters.</p>\n\n<p>Try with a bigger string, I'm sure you can afford it, say:</p>\n\n<pre><code>char u[10];\nchar p[10];\n</code></pre>\n\n<p>And that is still a quite stingy ;)</p>\n"}], "owner": {"reputation": 133, "user_id": 4946808, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gp0ba.jpg?s=128&g=1", "display_name": "Telefang", "link": "https://stackoverflow.com/users/4946808/telefang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 736, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1463518376, "creation_date": 1463516994, "last_edit_date": 1592644375, "question_id": 37285730, "link": "https://stackoverflow.com/questions/37285730/simple-password-prompt-in-c", "title": "Simple password-prompt in C", "body": "<p>I'm trying to make a simple user and password autentication in C.\nI was told to never use gets() when getting input and I should use fgets() instead.\nBut I'm not sure of how the fgets() works or why is giving me this input.\nHere is the code.</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint login(char *user, char *passwd){\n\n    int enter = 0;\n    char p[6];\n    char u[6];\n    printf(&quot;User: &quot;);\n    fgets(u, sizeof u, stdin);\n    printf(&quot;Pass: &quot;); \n    fgets(p, sizeof p, stdin);\n    printf(&quot;%s\\n&quot;, p);\n    if (strcmp(user, u) == 0 &amp;&amp; strcmp(passwd, p) == 0){\n        enter = 1;\n    }\n    return entrar;\n}\n\nint main(){\n    char user[] = &quot;admin&quot;;\n    char passwd[] = &quot;12345&quot;;\n    if (login(user, passwd)){\n        puts(&quot;--ACCESS GRANTED--&quot;);\n    }\n    else{\n        puts(&quot;--Wrong pass or user--&quot;);\n    }\n    return 0;\n}\n</code></pre>\n<p>Ouput</p>\n<blockquote>\n<p>User: admin</p>\n<p>Pass:</p>\n<p>--Wrong pass or user--</p>\n</blockquote>\n<p>It doesn't even let me enter the password after I press enter.</p>\n"}, {"tags": ["java", "c", "plugins"], "comments": [{"owner": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "edited": false, "score": 0, "creation_date": 1463517268, "post_id": 37285688, "comment_id": 62096449, "body": "This is possible but you&#39;d have to write a &quot;glue&quot; layer to interface between the Java and C code, and probably isn&#39;t worth it."}, {"owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "reply_to_user": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "edited": false, "score": 0, "creation_date": 1463517862, "post_id": 37285688, "comment_id": 62096751, "body": "What kind of glue would I apply ?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1463518682, "post_id": 37285688, "comment_id": 62097186, "body": "Generally speaking, yes, what you describe is possible, and JNI is mechanism for it.  The details depend in large part on the nature of the C code, and overall the question is far too broad if you are in fact asking about those details.  If you have a sufficiently specific question then we could take it up -- preferably as a separate question."}, {"owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1463518924, "post_id": 37285688, "comment_id": 62097306, "body": "Yes you&#39;re right... Just regarding the case of <code>send_message</code> would it be an answerable question?"}, {"owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1463521336, "post_id": 37285688, "comment_id": 62098430, "body": "Or maybe more important, regarding to this <a href=\"http://hildstrom.com/projects/jni/index.html\" rel=\"nofollow noreferrer\">hildstrom.com/projects/jni/index.html</a> I can run java code in C instancing a JVM, but is it possible to access to an already created JVM (the one that runs the C plugin)?"}], "owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1463518378, "creation_date": 1463516852, "last_edit_date": 1463518378, "question_id": 37285688, "link": "https://stackoverflow.com/questions/37285688/writing-c-plugins-for-c-and-java", "title": "Writing C plugins for C and Java", "body": "<p>for a networking project, with my team we have implemented two version of the program with a shell interface, one in C and the other in Java.</p>\n\n<p>The C version is more advanced because we've added a plugin system for adding commands in the shell. The plugin programmer interface enable access to some functions of the main program for sending protocol messages accross the network.</p>\n\n<p>We've developped some good plugins, and now we wonder if we can find a way to use the plugins written in C. After some research we found that it is possible to load native C code in Java using the JNI interface and we also found some examples, all quite basics using arithmetic operations and basic I/O.</p>\n\n<p>One problem is that our C programmer plugin interface has functions like <code>send_message(char *type, char *format, ...)</code> which can be used by plugins to send message other the network. Basically it sends UDP messages to all the element of a <code>struct sockaddr_in</code> from the main program. This is a problem if we wan't use the same plugin in Java since the main program isn't running.</p>\n\n<p>So my question is how to program a plugin interface and plugin programmer interface in C for plugins that could run in both C and Java, if that's possible?</p>\n\n<p>Thank you</p>\n\n<p>PS: Is it possible to write C functions that access to Java ressources?</p>\n"}, {"tags": ["mysql", "c", "python-3.x"], "comments": [{"owner": {"reputation": 447, "user_id": 2151274, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/iuZDF.jpg?s=128&g=1", "display_name": "arkhy", "link": "https://stackoverflow.com/users/2151274/arkhy"}, "edited": false, "score": 0, "creation_date": 1463517220, "post_id": 37285591, "comment_id": 62096425, "body": "how exactly have you tried to install it? I suspect that you have installed it for python2"}, {"owner": {"reputation": 3, "user_id": 6280940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5845dbf9318d67d23c318e19351b3d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Xherdi Lika", "link": "https://stackoverflow.com/users/6280940/xherdi-lika"}, "reply_to_user": {"reputation": 447, "user_id": 2151274, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/iuZDF.jpg?s=128&g=1", "display_name": "arkhy", "link": "https://stackoverflow.com/users/2151274/arkhy"}, "edited": false, "score": 0, "creation_date": 1463517543, "post_id": 37285591, "comment_id": 62096601, "body": "I think I used sudo pip install mysql-python"}], "answers": [{"tags": [], "owner": {"reputation": 447, "user_id": 2151274, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/iuZDF.jpg?s=128&g=1", "display_name": "arkhy", "link": "https://stackoverflow.com/users/2151274/arkhy"}, "is_accepted": true, "score": 0, "last_activity_date": 1463518065, "creation_date": 1463518065, "answer_id": 37285981, "question_id": 37285591, "link": "https://stackoverflow.com/questions/37285591/error-no-module-named-mysql/37285981#37285981", "title": "Error: No module named &#39;mysql&#39;", "body": "<p>Python versions can be confusing, especially if you install with apt.\nmysql-python is a python 2 package.\nYou probably want to install this one</p>\n\n<pre><code>sudo apt-get install python3-mysql.connector\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6280940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5845dbf9318d67d23c318e19351b3d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Xherdi Lika", "link": "https://stackoverflow.com/users/6280940/xherdi-lika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "accepted_answer_id": 37285981, "answer_count": 1, "score": 0, "last_activity_date": 1463518065, "creation_date": 1463516567, "question_id": 37285591, "link": "https://stackoverflow.com/questions/37285591/error-no-module-named-mysql", "title": "Error: No module named &#39;mysql&#39;", "body": "<p>I'm doing a project that requires to create a python gui and use c functions. I have tried installing mysql-python but It doesn't work. I'm using python3.4, xubuntu 16.04. Please tell me what can be the problem? </p>\n\n<pre><code>from ctypes import *\n# Simple enough, just import everything from tkinter.\nfrom tkinter import *\nfrom tkinter import filedialog\nfrom tkinter.filedialog import askopenfilename\nimport subprocess\n# Here, we are creating our class, Window, and inheriting from the Frame\n# class. Frame is a class from the tkinter module. (see Lib/tkinter/__init__)\nimport mysql.connector\n\ncnx = mysql.connector.connect(user='root', password='root',\n                          host='127.0.0.1',\n                          database='iCalender')\ncnx.close()\n\ncal = CDLL('./caltool.so')\nclass Window(Frame):\n\n# Define settings upon initialization. Here you can specify\ndef __init__(self, master=None):\n\n    # parameters that you want to send through the Frame class.\n    Frame.__init__(self, master)\n    fm = Frame(root, width=400, height=300, bg=\"green\")\n    fm.pack(side=TOP, expand=NO, fill=NONE)\n    #reference to the master widget, which is the tk window\n    self.master = master\n\n    #with that, we want to then run init_window, which doesn't yet exist\n    self.init_window()\n\n#Creation of init_window\ndef init_window(self):\n\n    # changing the title of our master widget\n    self.master.title(\"XCal Application\")\n\n    # allowing the widget to take the full space of the root window\n    self.pack(fill=BOTH, expand=1)\n\n    # creating a menu instance\n    menu = Menu(self.master)\n    self.master.config(menu=menu)\n\n    # create the file object)\n    file = Menu(menu)\n\n    # adds a command to the menu option, calling it exit, and the\n    # command it runs on event is client_exit\n    file.add_command(label=\"Open\", command=self.OpenFile, accelerator=\"Ctrl+O\")\n    file.add_command(label=\"Save\", command=self.file_save, accelerator=\"Ctrl+S\")\n    file.add_command(label=\"Save As...\", command=self.client_exit, accelerator=\"Ctrl+Shift+S\")\n    file.add_command(label=\"Combine\", command=self.client_exit)\n    file.add_command(label=\"Filter\", command=self.client_exit)\n    file.add_command(label=\"Exit\", command=self.client_exit, accelerator=\"Ctrl+X\")\n    self.bind_all(\"&lt;Control-x&gt;\", self.client_exit)\n    self.bind_all(\"&lt;Control-o&gt;\", self.OpenFile)\n    self.bind_all(\"&lt;Control-s&gt;\", self.file_save)\n\n    #added \"file\" to our menu\n    menu.add_cascade(label=\"File\", menu=file)\n\n    # create the file object)\n    edit = Menu(menu)\n\n    # adds a command to the menu option, calling it exit, and the\n    # command it runs on event is client_exit\n    edit.add_command(label=\"To Do List\", accelerator=\"Ctrl+T\")\n    edit.add_command(label=\"Undo\", accelerator=\"Ctrl+Z\")\n\n    #added \"file\" to our menu\n    menu.add_cascade(label=\"Todo\", menu=edit)\n    help1 = Menu(menu)\n    help1.add_command(label=\"Date Mask\")\n    help1.add_command(label=\"About xcal\")\n    menu.add_cascade(label=\"Help\", menu=help1)\n\n\ndef client_exit(self, event):\n    exit()\ndef OpenFile(self):\n    filename = askopenfilename()\n    print(filename)\n    cal.pyGetInfo(filename)\ndef file_save(self, event):\n    name = asksaveasfile(mode='w',defaultextension=\".txt\")\n    text2save=str(text.get(0.0,END))\n    name.write(text2save)\n    name.close\n\n\n# root window created. Here, that would be the only window, but\n# you can later have windows within windows.\nroot = Tk()\n\nroot.geometry(\"400x300\")\n\n#creation of an instance\napp = Window(root)\n\n#mainloop\nroot.mainloop()\n</code></pre>\n"}, {"tags": ["c", "function", "extern"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1463516068, "post_id": 37285435, "comment_id": 62095814, "body": "isn&#39;t it like functions, unless defined <code>static</code> are by default defined with <code>extern</code>?"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1463516095, "post_id": 37285435, "comment_id": 62095834, "body": "google for &quot;forward declaration&quot;"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1463516313, "post_id": 37285435, "comment_id": 62095949, "body": "XAPUBLIC is not a standard term \u2014 is this part of the XA protocol?  Is cm_name a type name?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 4, "creation_date": 1463516364, "post_id": 37285435, "comment_id": 62095977, "body": "I think you are misunderstanding the compile process. You can provide search paths for libraries and header files. However, in your case you simply have your <i>source</i> files in separate directories. In that case, during compile, you simply need to provide the complete path to each of your required source files so they can be compiled to object and linked into the final executable."}, {"owner": {"reputation": 26, "user_id": 3866198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ktuh.jpg?s=128&g=1", "display_name": "Aseem Rambani", "link": "https://stackoverflow.com/users/3866198/aseem-rambani"}, "edited": false, "score": 0, "creation_date": 1463541706, "post_id": 37285435, "comment_id": 62103837, "body": "So how can i provide the complete path to both of the source files. I understand how to add header files using &#39;#include&#39;."}, {"owner": {"reputation": 26, "user_id": 3866198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ktuh.jpg?s=128&g=1", "display_name": "Aseem Rambani", "link": "https://stackoverflow.com/users/3866198/aseem-rambani"}, "edited": false, "score": 1, "creation_date": 1463541788, "post_id": 37285435, "comment_id": 62103852, "body": "I think i got the answer in this discussion[<a href=\"http://stackoverflow.com/questions/1433204/how-do-i-use-extern-to-share-variables-between-source-files-in-c?rq=1]\" title=\"how do i use extern to share variables between source files in c\">stackoverflow.com/questions/1433204/&hellip;</a>"}], "owner": {"reputation": 26, "user_id": 3866198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ktuh.jpg?s=128&g=1", "display_name": "Aseem Rambani", "link": "https://stackoverflow.com/users/3866198/aseem-rambani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1463515991, "creation_date": 1463515991, "question_id": 37285435, "link": "https://stackoverflow.com/questions/37285435/how-to-use-extern-to-access-a-function-from-another-file-in-c", "title": "How to use &#39;extern&#39; to access a function from another file in C", "body": "<p>I've a function declared in a file in a directory, say, abc. main/abc/getcm.c</p>\n\n<pre><code>XAPUBLIC int get_cm_name(cm_name)\n</code></pre>\n\n<p>I've to use this function in another directory, say def. main/def/takecm.c</p>\n\n<pre><code>status = get_cm_name(cm_name)\n</code></pre>\n\n<p>How can i access this function 'get_cm_name' in 'def' directory using extern. I understand that i can use a header file under 'main' directory to declare this function. Is there an alternative of doing it using extern function.</p>\n"}, {"tags": ["c", "arrays", "string", "struct"], "comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 2, "creation_date": 1463515628, "post_id": 37285162, "comment_id": 62095591, "body": "\u039c\u03c0\u03ac\u03bc\u03c0\u03b7, please do me a favor, and indent this code. Welcome to SO!"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1463519130, "post_id": 37285162, "comment_id": 62097400, "body": "Yes Xaralabos, @AnT is right. You should be really careful when it comes to tagging. I re-tagged your question to <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a>. Now that you learnt it, I am sure you won&#39;t make it again. :)"}, {"owner": {"reputation": 49, "user_id": 6347490, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/929108617138555/picture?type=large", "display_name": "Xaralabos Nikolaidhs", "link": "https://stackoverflow.com/users/6347490/xaralabos-nikolaidhs"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 1, "creation_date": 1463519411, "post_id": 37285162, "comment_id": 62097526, "body": "my bad, ima try to double check it from now on"}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1463515916, "post_id": 37285357, "comment_id": 62095742, "body": "You should probably mention that static variables do get default inialization, but automatic variables don&#39;t."}], "tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": false, "score": 5, "last_activity_date": 1463515957, "last_edit_date": 1463515957, "creation_date": 1463515678, "answer_id": 37285357, "question_id": 37285162, "link": "https://stackoverflow.com/questions/37285162/what-is-the-value-of-an-empty-cell-of-a-2d-array/37285357#37285357", "title": "what is the value of an empty cell of a 2d array?", "body": "<p>C has no concept of \"empty\". Variables in C represent actual physical memory locations, and they contain whatever that memory contains, which is either what they were initialized to contain, or some random value if they were never initialized (note that <code>static</code>s are initialized by default).</p>\n\n<p>This doesn't prevent you from choosing to <em>interpret</em> one of the possible values of a variable as \"empty\", but that would be your choice, and entirely up to you. You would then have to initialize your variable/array with that value and check for it. Character variables often use the value <code>'\\0'</code> for this, which should work for you--just make sure you take care of the difference between single characters and arrays: for example, <code>... if...gramma[0] == '\\0'' ...</code></p>\n\n<p>There is what you might consider an exception to this: one of the values pointer variables are allowed to take is a value called NULL, which is guaranteed not to point to anything. This is often used to initialize pointer variables but you still have to do the initialization and checking yourself.</p>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 6347490, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/929108617138555/picture?type=large", "display_name": "Xaralabos Nikolaidhs", "link": "https://stackoverflow.com/users/6347490/xaralabos-nikolaidhs"}, "edited": false, "score": 0, "creation_date": 1463516444, "post_id": 37285433, "comment_id": 62096022, "body": "i tried printing them but each cell have a different value, like, printf(&quot;%s\\n&quot;,pinakas[4][0]); prints ! , while pinakas[4][3] prints @.....i can also print them without getting error as just chars and as integers, thats why i am so confused"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 49, "user_id": 6347490, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/929108617138555/picture?type=large", "display_name": "Xaralabos Nikolaidhs", "link": "https://stackoverflow.com/users/6347490/xaralabos-nikolaidhs"}, "edited": false, "score": 0, "creation_date": 1463518293, "post_id": 37285433, "comment_id": 62096997, "body": "Yes exactly, you see, they print random stuff, because the memory is not initialized. When I do <code>char my_array[5]</code>, the system allocates 5 contiguous memory positions, every one of size of <code>char</code>. I do not know what this memory has, thus when I print, I do not know what I am going to see. However, if I also do <code>strcpy(my_array, &quot;hello babis&quot;);</code> and then print the string, I know what I am going to see, since I filled the array with something, it is not uninitialized now! @XaralabosNikolaidhs now that I now you got, it I would like you to check my last edit, it might help you."}, {"owner": {"reputation": 49, "user_id": 6347490, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/929108617138555/picture?type=large", "display_name": "Xaralabos Nikolaidhs", "link": "https://stackoverflow.com/users/6347490/xaralabos-nikolaidhs"}, "edited": false, "score": 0, "creation_date": 1463518591, "post_id": 37285433, "comment_id": 62097140, "body": "ok, so i tried adding values to the &quot;empty&quot; cells (strcpy(pinakas[4][3].anoxi, &quot;Empty&quot;); and so on, and i tried - if (pinakas[4][r].anoxi!=&quot;Empty&quot;)-  and it still show all 12 names"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 49, "user_id": 6347490, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/929108617138555/picture?type=large", "display_name": "Xaralabos Nikolaidhs", "link": "https://stackoverflow.com/users/6347490/xaralabos-nikolaidhs"}, "edited": false, "score": 0, "creation_date": 1463518740, "post_id": 37285433, "comment_id": 62097220, "body": "@XaralabosNikolaidhs, use <a href=\"http://www.cplusplus.com/reference/cstring/strcmp/\" rel=\"nofollow noreferrer\">strcmp</a> to do that, like <code>if(strcmp(pinakas[4][r].anoxi, &quot;Empty&quot;) != 0)</code> and tell how it goes."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 49, "user_id": 6347490, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/929108617138555/picture?type=large", "display_name": "Xaralabos Nikolaidhs", "link": "https://stackoverflow.com/users/6347490/xaralabos-nikolaidhs"}, "edited": false, "score": 0, "creation_date": 1463518945, "post_id": 37285433, "comment_id": 62097313, "body": "@XaralabosNikolaidhs, because you test for every <code>r</code> maybe? but you have done only <code>(strcpy(pinakas[4][3].anoxi, &quot;Empty&quot;);</code>?"}, {"owner": {"reputation": 49, "user_id": 6347490, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/929108617138555/picture?type=large", "display_name": "Xaralabos Nikolaidhs", "link": "https://stackoverflow.com/users/6347490/xaralabos-nikolaidhs"}, "edited": false, "score": 1, "creation_date": 1463518997, "post_id": 37285433, "comment_id": 62097341, "body": "WOW, IT WORKED, tnx a lot"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 49, "user_id": 6347490, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/929108617138555/picture?type=large", "display_name": "Xaralabos Nikolaidhs", "link": "https://stackoverflow.com/users/6347490/xaralabos-nikolaidhs"}, "edited": false, "score": 0, "creation_date": 1463519078, "post_id": 37285433, "comment_id": 62097381, "body": "Great @XaralabosNikolaidhs, but please make sure you read my edit as well! :)"}, {"owner": {"reputation": 2417, "user_id": 2503164, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/68d57915f8c4a877fe42a67251d1420a?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2503164/mike"}, "edited": false, "score": 0, "creation_date": 1463522635, "post_id": 37285433, "comment_id": 62098965, "body": "Or, for us bad boys, ::memset (my_array, 0, sizeof (my_array);"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463525026, "post_id": 37285433, "comment_id": 62099819, "body": "<code>array[4][r].anoxi!= &#39;\\0&#39;</code> is always true because the left-hand side is an array, which decays to pointer in this expression"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463525905, "post_id": 37285433, "comment_id": 62100081, "body": "Exactly! @M.M is right Xalarabos! M.M do you think that I should improve my answer on that, or is it OK to leave it as is (since this has to do with the comments)?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463526184, "post_id": 37285433, "comment_id": 62100171, "body": "well you should fix mistakes in your answer"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1463526424, "post_id": 37285433, "comment_id": 62100245, "body": "How in the world did I miss that? Thanks a ton @M.M!"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 3, "last_activity_date": 1463526410, "last_edit_date": 1463526410, "creation_date": 1463515982, "answer_id": 37285433, "question_id": 37285162, "link": "https://stackoverflow.com/questions/37285162/what-is-the-value-of-an-empty-cell-of-a-2d-array/37285433#37285433", "title": "what is the value of an empty cell of a 2d array?", "body": "<p>Now that you got, it you may want to read my <a href=\"https://gsamaras.wordpress.com/code/structs-c/\" rel=\"nofollow\">Structs (C)</a>, which offers a compact example, that might come in handy<sup>*</sup>.</p>\n\n<hr>\n\n<p>First of all, allow me to question the validity of this code. Consider this equivalent example I made:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct t { \n    char anoxi[10];\n    char name[10];\n    char gramma [2];\n};\n\nint main(void) {\n        struct t my_array[5][1];\n        if(my_array[0][0].anoxi != '\\0')\n                printf(\"%s\\n\", my_array[0][0].anoxi);\n        return 0;\n}\n</code></pre>\n\n<p>It will print, in <em>my</em> machine:</p>\n\n<pre><code>gsamaras@gsamaras-A15:~$ gcc -Wall px.c\ngsamaras@gsamaras-A15:~$ ./a.out \n\ufffd\ufffd\ufffd\ufffd\n</code></pre>\n\n<p>Why?</p>\n\n<p>Because, the memory the array holds <em>is not initialized</em> to anything, so its value is undefined, which invokes <strong>UNDEFINED BEHAVIOR</strong>!</p>\n\n<p>We could fix this, by initializing every string, like this:</p>\n\n<pre><code>    struct t my_array[5][1];\n    my_array[0][0].anoxi[0] = '\\0';\n    if(my_array[0][0].anoxi[0] != '\\0')\n            printf(\"edw %s\\n\", my_array[0][0].anoxi);\n</code></pre>\n\n<p>Or, as Mike suggested, you could use <a href=\"http://www.cplusplus.com/reference/cstring/memset/\" rel=\"nofollow\">memset()</a>, like this:</p>\n\n<pre><code>memset (my_array, 0, sizeof (my_array);\n</code></pre>\n\n<hr>\n\n<p>Usually we set the value of a variable to a predefined value, which for us, <strong>humans</strong> tells that this cell/string/whatever is empty.</p>\n\n<p><a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> does <strong>not</strong> know that, unless we tell our program to keep an eye out of empty \"things\". We have to inform our program what is an empty \"thing\", especially how to identify it!</p>\n\n<p>Here, you have a string and you check <code>array[4][r].anoxi!= '\\0'</code>, which is <em>always</em> true because the left-hand side is an array, which decays to pointer in this expression, as M.M said.</p>\n\n<hr>\n\n<p>*<sub>I am not writing it here, since the answer is already too long</sub></p>\n"}, {"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1463526726, "last_edit_date": 1463526726, "creation_date": 1463524851, "answer_id": 37287371, "question_id": 37285162, "link": "https://stackoverflow.com/questions/37285162/what-is-the-value-of-an-empty-cell-of-a-2d-array/37287371#37287371", "title": "what is the value of an empty cell of a 2d array?", "body": "<p>First of all, initialize the array to blank:</p>\n\n<pre><code>struct t array[5][12] = { 0 };\n</code></pre>\n\n<p>This means that any members you have not yet assigned contents to will have value <code>0</code>  (converted to the type of that member). This is so that later on you can see if the member has been assigned something else by checking to see if it is still <code>0</code> or not.</p>\n\n<p>Then you can check:</p>\n\n<pre><code>if ( array[4][r].anoxi[0] ) {\n//                   ^^^^\n</code></pre>\n\n<p>Note that you must check <code>anoxi[0]</code> which is a <code>char</code> object.  Checking <code>anoxi</code>, which is an array object, merely checks that the array exists in memory (which it tautologically does), not whether the contents of the array are some particular value.</p>\n\n<hr>\n\n<p>NB. The <code>!= '\\0'</code> is redundant, I think it is clearer to omit it but you could use it if you want.</p>\n"}], "owner": {"reputation": 49, "user_id": 6347490, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/929108617138555/picture?type=large", "display_name": "Xaralabos Nikolaidhs", "link": "https://stackoverflow.com/users/6347490/xaralabos-nikolaidhs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 37285433, "answer_count": 3, "score": 1, "last_activity_date": 1463526726, "creation_date": 1463514962, "last_edit_date": 1463519090, "question_id": 37285162, "link": "https://stackoverflow.com/questions/37285162/what-is-the-value-of-an-empty-cell-of-a-2d-array", "title": "what is the value of an empty cell of a 2d array?", "body": "<p>i am kind of new in c and i am trying to figure things out.</p>\n\n<p>my question is, what i need to have in the place of <code>'/0'</code> , in order for it to skip \nthe \"empty\" cells?</p>\n\n<p>i know i could do it the easy way and just have have all the .anoxi values in the condition, but i was just curious.\ni have tried putting <code>\"\"</code>, which gives me all the names (doesn't skip any of them) , <code>''</code> which gives me \"<em>[Error] empty character constant</em>\" and\n<strong>null</strong>, which gives me \"<em>[Error] 'null' was not declared in this scope</em>\"</p>\n\n<pre><code>struct t { \n    char anoxi[10];\n    char name[10];\n    char gramma [2];\n}\n\nint main() {\n    struct t array[5][12];\n    int r;\n    strcpy(array[4][1].anoxi, \"+-1%\");\n    strcpy(array[4][2].anoxi, \"+-2%\");\n    strcpy(array[4][5].anoxi, \"+-0.5%\");\n    strcpy(array[4][6].anoxi, \"+-0.25%\");\n    strcpy(array[4][7].anoxi, \"+-1%\");\n    strcpy(array[4][8].anoxi, \"+-0.05%\");\n\n    strcpy(array[0][0].gramma, \"M\");\n    strcpy(array[0][1].gramma, \"K\");\n    strcpy(array[0][2].gramma, \"N\");\n    strcpy(array[0][3].gramma, \"O\");\n    strcpy(array[0][4].gramma, \"I\");\n    strcpy(array[0][5].gramma, \"R\");\n    strcpy(array[0][6].gramma, \"L\");\n    strcpy(array[0][7].gramma, \"V\");\n    strcpy(array[0][8].gramma, \"G\");\n    strcpy(array[0][9].gramma, \"A\");\n    strcpy(array[0][10].gramma, \"X\");\n    strcpy(array[0][11].gramma, \"S\");\n\n    strcpy(array[1][0].name, \"Black\");\n    strcpy(array[1][1].name, \"Brown\");\n    strcpy(array[1][2].name, \"Red\");\n    strcpy(array[1][3].name, \"Orange\");\n    strcpy(array[1][4].name, \"Yellow\");\n    strcpy(array[1][5].name, \"Green\");\n    strcpy(array[1][6].name, \"Blue\");\n    strcpy(array[1][7].name, \"Purple\");\n    strcpy(array[1][8].name, \"Grey\");\n    strcpy(array[1][9].name, \"White\");\n    strcpy(array[1][10].name, \"Gold\");\n    strcpy(array[1][11].name, \"Silver\");\n\n    for (r=0; r&lt;12; r++) {\n        if (array[4][r].anoxi!= '\\0') {\n            printf(\"%s = %s\\n\",array[0][r].gramma, array[1][r].name);\n        }\n    }\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["c", "variables", "double", "scanf"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1463514729, "post_id": 37285056, "comment_id": 62095150, "body": "<i>I&#39;m new to programming and I searched it on the Internet and I couldn&#39;t find an answer.</i>, We&#39;ll, you certainly did not search enough. Thought I don;t see how google failed to answer your question."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1463515134, "post_id": 37285056, "comment_id": 62095355, "body": "The basic problem is that when it sees a <code>%f</code>, <code>scanf()</code> expects it was given a <code>float *</code> (and given <code>%lf</code> it expects to get a <code>double *</code>), and passing a <code>double *</code> but telling it to expect a <code>float *</code> leads to unhappiness.  In some ways, the more interesting question is \u2014 Why does this work: <code>float f = 3.1416; double d = 2.78128; printf(&quot;%f %f\\n&quot;, f, d);</code>?  The answer is part of the standard (it is fully defined behaviour), but is probably more subtle than you need to deal with at the moment."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1463515445, "post_id": 37285056, "comment_id": 62095502, "body": "Oh, and another (jocular) way of looking at the whole problem: You lied to <code>scanf()</code>, and it gets its own back by not doing what you want.  This is entirely legitimate behaviour on its part."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1463515736, "post_id": 37285056, "comment_id": 62095647, "body": "A comment on Jonathan Leffler&#39;s edit: C is case-sensitive, so <code>double</code> and <code>DOUBLE</code> are two unrelated names. <code>double</code> is a keyword and a type name; <code>DOUBLE</code> is just an ordinary identifier. Don&#39;t use all-caps for emphasis when discussing C keywords and identifiers. Don&#39;t even capitalize them at the beginning of a sentence."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463519986, "post_id": 37285056, "comment_id": 62097814, "body": "The compilation of your code, per your link provided, reported &quot;0 warnings&quot;.  This is key as the problem (mis-match specifier/type) <i>should</i> have been reported.  So either 1) insure your complier warning options are fully enabled or 2) use a better compiler."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1536467130, "post_id": 37285056, "comment_id": 91431210, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/27657977/scanf-for-double-not-working-in-dev-c\">Scanf for double not working in Dev C++</a>"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1463515098, "last_edit_date": 1463515098, "creation_date": 1463514669, "answer_id": 37285083, "question_id": 37285056, "link": "https://stackoverflow.com/questions/37285056/variable-of-type-double-not-working-when-read-by-scanf/37285083#37285083", "title": "Variable of type double not working when read by scanf()", "body": "<p>In your code,</p>\n\n<pre><code> scanf(\"%f\", &amp;d);\n</code></pre>\n\n<p>is wrong. For <code>scanf()</code>, <code>%f</code> expects a pointer to <code>float</code> as argument.</p>\n\n<p>Quoting <code>C11</code>, chapter \u00a77.21.6.2, <em><code>fscanf()</code></em></p>\n\n<blockquote>\n  <p><code>a</code>,<code>e</code>,<code>f</code>,<code>g</code> </p>\n  \n  <p>Matches an optionally <strong>signed floating-point number</strong>, infinity, or NaN, whose\n  format is the same as expected for the subject sequence of the strtod\n  function. <strong>The corresponding argument shall be a pointer to floating.</strong></p>\n</blockquote>\n\n<p>In case you want to <em>scan</em> a <code>double</code>, you have to use</p>\n\n<pre><code> scanf(\"%lf\", &amp;d);\n</code></pre>\n\n<hr>\n\n<p>FWIW, passing incompatible type of argument for any format specifier invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.</p>\n\n<p>Quoting <code>C11</code>, </p>\n\n<blockquote>\n  <p>[...] Unless assignment suppression was indicated by a *, the\n  result of the conversion is placed in the object pointed to by the first argument following\n  the format argument that has not already received a conversion result. <strong>If this object\n  does not have an appropriate type, or if the result of the conversion cannot be represented\n  in the object, the behavior is undefined.</strong></p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 6347538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a02f8280dc2bb859e4e7c3b7dbb4eaf?s=128&d=identicon&r=PG&f=1", "display_name": "marinuuuuuu", "link": "https://stackoverflow.com/users/6347538/marinuuuuuu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1463515098, "creation_date": 1463514526, "last_edit_date": 1463514930, "question_id": 37285056, "link": "https://stackoverflow.com/questions/37285056/variable-of-type-double-not-working-when-read-by-scanf", "title": "Variable of type double not working when read by scanf()", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    double d;\n\n    scanf(\"%f\", &amp;d);\n    printf(\"%f\\n\\n\",  d);\n\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p>This is what I get:\n<a href=\"https://youtu.be/FlsVwXLg7zk\" rel=\"nofollow\">error</a>.</p>\n\n<p>This code is meant to read the variable double and display it on the screen but it does only display \"0.0...\". </p>\n\n<p>If I just change the variable type to <code>float</code> it does exactly what I want but if I make it a <code>double</code> it just reads '0'. Why?</p>\n"}, {"tags": ["c", "file-io"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 7, "creation_date": 1463514027, "post_id": 37284888, "comment_id": 62094806, "body": "Or have the program work as a filter that reads one file and writes to another. Doing this in-place is hard."}, {"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 2, "creation_date": 1463514158, "post_id": 37284888, "comment_id": 62094863, "body": "Btw, <code>fgetc()</code> returns an <code>int</code> ..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1463514311, "post_id": 37284888, "comment_id": 62094950, "body": "If a file consisted of <code>&quot;1+1\\n1+1&quot;</code>, (only 1 <code>&#39;\\n&#39;</code>) should the output be <code>&quot;1+1=2\\n1+1=2\\n&quot;</code> or <code>&quot;1+1=2\\n1+1&quot;</code>?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 3, "creation_date": 1463514397, "post_id": 37284888, "comment_id": 62094995, "body": "You can&#39;t insert characters into a file.  Using <code>fseek</code> to back up and write something else is never going to do what you want."}, {"owner": {"reputation": 273, "user_id": 3722559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ae714cac6c3fe6897729aca735eaea?s=128&d=identicon&r=PG&f=1", "display_name": "schil227", "link": "https://stackoverflow.com/users/3722559/schil227"}, "edited": false, "score": 0, "creation_date": 1463514593, "post_id": 37284888, "comment_id": 62095085, "body": "The reason it&#39;s going into an infinite loop is because you&#39;re appending &quot;=2\\n&quot; to the end of the file every time. I would suggest using fseek() to offset appending &quot;=2\\n&quot; to the end every time."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1463516241, "post_id": 37284888, "comment_id": 62095909, "body": "<i>You have to read all the lines into memory. Append to each line. Re-write the entire file.</i>  Even better:  Read one line into memory, strip newline if needed, append characters desired, write new line into <i>new</i> file.  Repeat until no lines in file.  Rename <i>new</i> file to original file name."}, {"owner": {"reputation": 1588, "user_id": 6082851, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b14f3cd864bc266a401eca07b4153602?s=128&d=identicon&r=PG", "display_name": "12431234123412341234123", "link": "https://stackoverflow.com/users/6082851/12431234123412341234123"}, "edited": false, "score": 0, "creation_date": 1463523921, "post_id": 37284888, "comment_id": 62099448, "body": "(c = fgetc(fp)) != EOF) dont work in the way you expect. fgets() return a int, convert it to a char and compare against EOF which is a int. if your char is signed, this will also be false for byte 0xFF (if CHAR_BIT is 8), if your char is unsigned, it will never be false."}, {"owner": {"reputation": 1588, "user_id": 6082851, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b14f3cd864bc266a401eca07b4153602?s=128&d=identicon&r=PG", "display_name": "12431234123412341234123", "link": "https://stackoverflow.com/users/6082851/12431234123412341234123"}, "edited": false, "score": 0, "creation_date": 1463524056, "post_id": 37284888, "comment_id": 62099503, "body": "dont use fseek(fp,-2,SEEK_CUR); for jump back on newline. newline is on the most systems only 1 byte and can be anything in textmode and still be valid. better, store the position before read the newline."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5600824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CICa3.jpg?s=128&g=1", "display_name": "Ashuthosh", "link": "https://stackoverflow.com/users/5600824/ashuthosh"}, "edited": false, "score": 0, "creation_date": 1463515458, "post_id": 37285232, "comment_id": 62095512, "body": "So fprintf() doesn&#39;t change the position of the file ?? will seeking further solves the problem ?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 71, "user_id": 5600824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CICa3.jpg?s=128&g=1", "display_name": "Ashuthosh", "link": "https://stackoverflow.com/users/5600824/ashuthosh"}, "edited": false, "score": 0, "creation_date": 1463516484, "post_id": 37285232, "comment_id": 62096039, "body": "@Ashuthosh, it changes position only for the output functions such as <code>fprintf</code>, <code>fwrite</code>, <code>fputc</code>, etc. but not for input functions  such as<code>fscanf</code>, <code>fread</code>, <code>fgetc</code>, etc."}, {"owner": {"reputation": 71, "user_id": 5600824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CICa3.jpg?s=128&g=1", "display_name": "Ashuthosh", "link": "https://stackoverflow.com/users/5600824/ashuthosh"}, "edited": false, "score": 0, "creation_date": 1463516725, "post_id": 37285232, "comment_id": 62096157, "body": "Above you said it doesn&#39;t changes for fprintf, now you are saying it changes for fprintf?? Confused"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 71, "user_id": 5600824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CICa3.jpg?s=128&g=1", "display_name": "Ashuthosh", "link": "https://stackoverflow.com/users/5600824/ashuthosh"}, "edited": false, "score": 1, "creation_date": 1463516786, "post_id": 37285232, "comment_id": 62096190, "body": "@Ashuthosh. I said <i>does not change the position <b>from where you read the data</b>.</i>"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 71, "user_id": 5600824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CICa3.jpg?s=128&g=1", "display_name": "Ashuthosh", "link": "https://stackoverflow.com/users/5600824/ashuthosh"}, "edited": false, "score": 0, "creation_date": 1463517975, "post_id": 37285232, "comment_id": 62096820, "body": "@Ashuthosh, you can use <code>fseek</code> again, after the call to <code>fprintf</code>. <code>fseek(fp,3,SEEK_CUR);</code>"}, {"owner": {"reputation": 71, "user_id": 5600824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CICa3.jpg?s=128&g=1", "display_name": "Ashuthosh", "link": "https://stackoverflow.com/users/5600824/ashuthosh"}, "edited": false, "score": 0, "creation_date": 1463518708, "post_id": 37285232, "comment_id": 62097207, "body": "yup. Its not working. More over the data is getting Over-Written. Best option is to separate the read file and write file. Thanks for your Expertise. Solved my Question. :D"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 0, "last_activity_date": 1463515217, "creation_date": 1463515217, "answer_id": 37285232, "question_id": 37284888, "link": "https://stackoverflow.com/questions/37284888/trying-to-write-at-end-of-each-line-in-a-file-in-c-language/37285232#37285232", "title": "Trying to write at end of each line in a File in C Language?", "body": "<p>Let's say you have one line of text in the file.</p>\n\n<pre><code>1+1\n</code></pre>\n\n<p>If you look at the contents byte wise as characters, you'll see:</p>\n\n<pre><code>+---+---+---+----+\n| 1 | + | 1 | \\n |\n+---+---+---+----+\n</code></pre>\n\n<p>When you encounter the <code>'\\n'</code>, you go back two characters and print <code>\"=2\\n\"</code> to the file. After, the contents of the file will be:</p>\n\n<pre><code>+---+---+---+----+\n| 1 | = | 2 | \\n |\n+---+---+---+----+\n</code></pre>\n\n<p>The call to <code>fprintf</code> does not change the position from where you read the data. Hence, the read position is at the second character, <code>'='</code>, of the file. </p>\n\n<p>The entire process repeats. The contents of the file remain </p>\n\n<pre><code>+---+---+---+----+\n| 1 | = | 2 | \\n |\n+---+---+---+----+\n</code></pre>\n\n<p>The output continues to be</p>\n\n<pre><code>=2\n</code></pre>\n\n<p>after the first line.</p>\n\n<p>Reading from and writing to the same file is fraught with too many pitfalls. It will be better if you separate them.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5990784, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WBot8.jpg?s=128&g=1", "display_name": "Harshit Kumar", "link": "https://stackoverflow.com/users/5990784/harshit-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1463516296, "last_edit_date": 1463516296, "creation_date": 1463515718, "answer_id": 37285371, "question_id": 37284888, "link": "https://stackoverflow.com/questions/37284888/trying-to-write-at-end-of-each-line-in-a-file-in-c-language/37285371#37285371", "title": "Trying to write at end of each line in a File in C Language?", "body": "<p>I had faced the same problem. I got it to work partially.At the desired position, I used ftell to get the current position. I subtracted this from the initial file size and stored in remainingSize variable. Using fread I got the chars after this position into a buffer. Then I wrote the desired output at current position.Then I wrote the data from buffer back into the file. This worked for small data, but there was a bug in my code which I couldn't resolve and it led to ftell returning an out of range value.</p>\n\n<p>It could be explained as</p>\n\n<p>if the data is </p>\n\n<pre class=\"lang-html prettyprint-override\"><code>+---+---+---+----+\n| 1 | + | 1 | \\n |\n+---+---+---+----+\n+---+---+---+----+\n| 3 | * | 5 | \\n |\n+---+---+---+----+\n</code></pre>\n\n\n\n<p>let's say size of file is 'x'\nYou go to the point after 1.\nBy ftell, u can get the current pos 'y'\nYou have to read 'x'-'y' chars and bring them into buffer\nYou can write the desired output at current position and then write the contents of buffer back to the file</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>+---+---+---+----+\n| 1 | + | 1 | = | 2\n+---+---+---+----+\n\nBuf =\n+---+---+---+----+\n| \\n | 3 | * | 5 |\\n\n+---+---+---+----+\n</code></pre>\n\n\n\n<p>I think this solution is inefficient as it involves many reads and writes and may not work on big files.</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 0, "last_activity_date": 1463519367, "last_edit_date": 1463519367, "creation_date": 1463517937, "answer_id": 37285941, "question_id": 37284888, "link": "https://stackoverflow.com/questions/37284888/trying-to-write-at-end-of-each-line-in-a-file-in-c-language/37285941#37285941", "title": "Trying to write at end of each line in a File in C Language?", "body": "<p>You have to rewrite the entire file, other than the first line.  Trying to do that in-place to the existing file is actually pretty difficult given arbitrarily long lines in an arbitrarily-large file.</p>\n\n<p>So it's much, much easier to just write a new file.</p>\n\n<p>Something like this (completely lacks any error checking):</p>\n\n<pre><code>// open files\nFILE *in = fopen( \"infile.txt\", \"r\" );\nFILE *out = fopen( \"infile.txt.tmp\", \"w+\" );\n// getline() variables\nchar *line = NULL;\nsize_t len = 0UL;\nssize_t result;\n\n// buffer for output line\n// (hope it's long enough...)\nchar buffer[ 1024 ];\nfor ( ;; )\n{\n    // getline() makes this so much easier...\n    result = getline( &amp;line, &amp;len, in );\n    if ( result == -1 )\n    {\n        break;\n    }\n    // strip newline\n    char *p = strchr( line, '\\n' );\n    if ( p != NULL )\n    {\n        *p = '\\0';\n    }\n    // append \"=2\" to each line\n    snprintf( buffer, sizeof( buffer), \"%s%s\\n\", line, \"=2\" );\n    fputs( buffer, out );\n}\nfclose( in );\nfclose( out );\n// assume POSIX rename is available\nrename( \"infile.txt.tmp\", \"infile.txt\" );\n</code></pre>\n\n<p>Read the file line-by-line, append the new data to the end of each line, write the new line <em>to a new file</em>, then when done <code>rename()</code> the new file to the old file name.</p>\n\n<p>Normally, I'd add whitespace between lines to aid in readability, but the extra lines cause a scrollbar to appear on the code, making it <em>less</em> readable.</p>\n"}], "owner": {"reputation": 71, "user_id": 5600824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CICa3.jpg?s=128&g=1", "display_name": "Ashuthosh", "link": "https://stackoverflow.com/users/5600824/ashuthosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 463, "favorite_count": 1, "accepted_answer_id": 37285232, "answer_count": 3, "score": 0, "last_activity_date": 1463519367, "creation_date": 1463513874, "last_edit_date": 1463514309, "question_id": 37284888, "link": "https://stackoverflow.com/questions/37284888/trying-to-write-at-end-of-each-line-in-a-file-in-c-language", "title": "Trying to write at end of each line in a File in C Language?", "body": "<p>I have been trying from past 3 hours and stuck at one point.\nI want to add some content after each line in a File using C.</p>\n\n<p>Here's My Code</p>\n\n<pre><code>int main(){\n\nFILE *fp;\nchar c;\nint p;\n\nfp = fopen(\"example1.txt\",\"r+\");\n\nif (fp == 0) {\n    perror(\"No File\");\n    exit(-1);\n}\n\nwhile ( (c = fgetc(fp)) != EOF) {\n    if (c != '\\n')\n        printf(\"%c\",c);\n    else {\n        //Going back two points is for '\\n'\n        fseek(fp,-2,SEEK_CUR);\n        fprintf(fp,\"=2\\n\");\n    }\n}\n\n\nfclose(fp);\nreturn 0;\n}\n</code></pre>\n\n<p>The Input File:</p>\n\n<pre><code>1+1\n1+1\n1+1\n</code></pre>\n\n<p>The Desired Output:</p>\n\n<pre><code>1+1=2\n1+1=2\n1+1=2\n</code></pre>\n\n<p>The Real Output:</p>\n\n<pre><code>1+1=2\n=2\n=2\n=2\n=2\n=2\n</code></pre>\n\n<p>The Execution gets into Infinite Loop..</p>\n"}]