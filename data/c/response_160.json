[{"tags": ["c", "gcc", "cross-compiling", "xv6"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1517438968, "post_id": 48552673, "comment_id": 84101879, "body": "looks like a bad installation. (cross)Compilers are coming with the standard libraries and headers"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1517439050, "post_id": 48552673, "comment_id": 84101913, "body": "&quot;problem is i386-elf-gcc cant link standard libraries&quot; --&gt; not quite.  So far it is not a <i>linking</i> problem, but the compiler is confused where the standard headers reside."}, {"owner": {"reputation": 2046, "user_id": 5379444, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh4.googleusercontent.com/-26CK5H5SP94/AAAAAAAAAAI/AAAAAAAAATc/Dx113UH4CcI/photo.jpg?sz=128", "display_name": "Jay Wong", "link": "https://stackoverflow.com/users/5379444/jay-wong"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1517439141, "post_id": 48552673, "comment_id": 84101951, "body": "@EugeneSh. Do you think it might be caused by this <a href=\"https://github.com/nativeos/homebrew-i386-elf-toolchain/blob/ec10b3a3848b8bc210ce25e5fd6d66057003a8a8/Formula/i386-elf-gcc.rb#L20\" rel=\"nofollow noreferrer\">option</a> in the homebrew tap?"}, {"owner": {"reputation": 2046, "user_id": 5379444, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh4.googleusercontent.com/-26CK5H5SP94/AAAAAAAAAAI/AAAAAAAAATc/Dx113UH4CcI/photo.jpg?sz=128", "display_name": "Jay Wong", "link": "https://stackoverflow.com/users/5379444/jay-wong"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517439182, "post_id": 48552673, "comment_id": 84101968, "body": "@chux I added a <code>--sysroot=usr&#47;includes</code> option to this gcc, but it doesn&#39;t really help."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1517439196, "post_id": 48552673, "comment_id": 84101975, "body": "Have you actually used that option?"}, {"owner": {"reputation": 2046, "user_id": 5379444, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh4.googleusercontent.com/-26CK5H5SP94/AAAAAAAAAAI/AAAAAAAAATc/Dx113UH4CcI/photo.jpg?sz=128", "display_name": "Jay Wong", "link": "https://stackoverflow.com/users/5379444/jay-wong"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1517439276, "post_id": 48552673, "comment_id": 84102026, "body": "@EugeneSh. It is on the Homebrew tap, so I guess homebrew uses this configuration to build i386-elf-gcc."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1517439391, "post_id": 48552673, "comment_id": 84102066, "body": "Well. No. This option is telling not to use any of the target headers when <i>building</i> gcc. Can you locate the headers in the toolchain path?"}, {"owner": {"reputation": 2046, "user_id": 5379444, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh4.googleusercontent.com/-26CK5H5SP94/AAAAAAAAAAI/AAAAAAAAATc/Dx113UH4CcI/photo.jpg?sz=128", "display_name": "Jay Wong", "link": "https://stackoverflow.com/users/5379444/jay-wong"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1517440240, "post_id": 48552673, "comment_id": 84102374, "body": "@EugeneSh. I found <code>&#47;usr&#47;local&#47;Cellar&#47;i386-elf-gcc&#47;7.3.0&#47;lib&#47;gcc&#47;i386-elf&#47;7.3.0&#47;&zwnj;&#8203;include</code>, but I am not sure it is the right path? Interestingly there are <code>stdint.h</code>, <code>float.h</code>, but no <code>stdio.h</code>."}], "answers": [{"tags": [], "owner": {"reputation": 718, "user_id": 6789049, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7343cff3f2c385192d431d8de67eeae2?s=128&d=identicon&r=PG&f=1", "display_name": "b.g.", "link": "https://stackoverflow.com/users/6789049/b-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1594664644, "creation_date": 1594664644, "answer_id": 62881990, "question_id": 48552673, "link": "https://stackoverflow.com/questions/48552673/how-to-link-standard-library-to-a-cross-compiler/62881990#62881990", "title": "How to link standard library to a cross-compiler?", "body": "<p>to resolve, you could try adding the newlib library and cross-compile it to your architecture. The following link says the freeware newlib can be used as source of the stdlib to compile all by yourself.</p>\n<p><a href=\"https://www.oreilly.com/library/view/programming-embedded-systems/0596009836/ch04.html#ID-d1766e1174:%7E:text=a%20freeware%20version%20of%20the%20standard%20C%20library%20for%20use%20in%20embedded%20systems\" rel=\"nofollow noreferrer\"> One problem is that the standard libraries provided with most software development tool suites arrive only in object form...</a></p>\n"}], "owner": {"reputation": 2046, "user_id": 5379444, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh4.googleusercontent.com/-26CK5H5SP94/AAAAAAAAAAI/AAAAAAAAATc/Dx113UH4CcI/photo.jpg?sz=128", "display_name": "Jay Wong", "link": "https://stackoverflow.com/users/5379444/jay-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 648, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1594664644, "creation_date": 1517438622, "question_id": 48552673, "link": "https://stackoverflow.com/questions/48552673/how-to-link-standard-library-to-a-cross-compiler", "title": "How to link standard library to a cross-compiler?", "body": "<p>I want to build xv6 on macOS, so I installed the cross-compiler toolchain i386-elf-gcc and i386-elf-gcc from a<a href=\"https://github.com/nativeos/homebrew-i386-elf-toolchain\" rel=\"nofollow noreferrer\"> Homebrew Tap</a>.</p>\n\n<p>The problem is i386-elf-gcc cant link standard libraries while compiling. I tested on a simple c file, and got the following error.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n    printf(\"d\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>&gt; i386-elf-gcc --sysroot=usr/includes test.c\ntest.c:1:10: fatal error: stdio.h: No such file or directory\n #include &lt;stdio.h&gt;\n          ^~~~~~~~~\ncompilation terminated.\n</code></pre>\n"}, {"tags": ["c", "performance", "performancecounter", "perf", "tlb"], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 477960, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a94906def341a092dfa88dd604c244c8?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Hedayati", "link": "https://stackoverflow.com/users/477960/mohammad-hedayati"}, "edited": false, "score": 1, "creation_date": 1517458147, "post_id": 48553272, "comment_id": 84106540, "body": "I am using 4.5 Linux kernel which doesn&#39;t have KPTI (I am running on Haswell anyway which has PCID and TLB will not be flushed even with KPTI)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 241, "user_id": 477960, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a94906def341a092dfa88dd604c244c8?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Hedayati", "link": "https://stackoverflow.com/users/477960/mohammad-hedayati"}, "edited": false, "score": 0, "creation_date": 1517465790, "post_id": 48553272, "comment_id": 84108838, "body": "@Hedy: Ah, I hadn&#39;t realized the KPTI patches were already using PCIDs to reduce CR3 modifications.  I knew that was possible, but IIRC Linux didn&#39;t previously use PCIDs at all, so I thought that would be too big a change to get it tested so quickly.  Thanks for the feedback that my guess was wrong :P  Updated my answer to reflect that (but I don&#39;t have any other great ideas other than figuring out which instructions TLB-miss, and thus which pages were invalidated.)"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 3, "last_activity_date": 1517470229, "last_edit_date": 1517470229, "creation_date": 1517442222, "answer_id": 48553272, "question_id": 48552362, "link": "https://stackoverflow.com/questions/48552362/two-tlb-miss-per-mmap-access-munmap/48553272#48553272", "title": "Two TLB-miss per mmap/access/munmap", "body": "<p><strong>Update 2</strong>: I think Brendan's answer is right.  I should maybe delete this, but the <code>ocperf.py</code> suggestion is still useful for future readers, I think.  And it might explain extra TLB misses on CPUs without Process-Context-Identifiers with kernels that mitigate Meltdown.</p>\n\n<p><strong>Update</strong>: the below guess was wrong.  New guess: <code>mmap</code> has to modify your process's page table, so perhaps there's some TLB invalidation of something just from that.  My recommendation to use <code>ocperf.py record</code> to try to figure out <em>which</em> asm instructions are causing TLB misses still stands.  Even with optimization enabled, the code will store to the stack when pushing/popping a return address for the glibc wrapper function calls.</p>\n\n<hr>\n\n<p>Perhaps your kernel has <a href=\"https://en.wikipedia.org/wiki/Kernel_page-table_isolation\" rel=\"nofollow noreferrer\">kernel / user page-table isolation enabled to mitigate Meltdown</a>, so on return from kernel to user, all TLB entries have been invalidated (by modifying CR3 to point to page tables that don't include the kernel mappings at all).</p>\n\n<p>Look for <code>Kernel/User page tables isolation: enabled</code> in your dmesg output.  You can try booting with <code>kpti=off</code> as a kernel option to disable it, if you don't mind being vulnerable to Meltdown while testing.</p>\n\n<hr>\n\n<p>Because you're using C, you're using the <code>mmap</code> and <code>munmap</code> system calls through their glibc wrappers, not with inline <code>syscall</code> instructions directly.  The <code>ret</code> instruction in that wrapper needs to load the return address from the stack, which TLB misses.</p>\n\n<p>The extra store misses probably come from <code>call</code> instructions pushing a return address, although I'm not sure that's right because the current stack page should already be in the TLB from the <code>ret</code> from the previous system call.</p>\n\n<hr>\n\n<p>You can profile with <a href=\"https://github.com/andikleen/pmu-tools\" rel=\"nofollow noreferrer\">ocperf.py to get symbolic names for uarch-specific events</a>.  Assuming you're on a recent Intel CPU, <strong><code>ocperf.py record -e mem_inst_retired.stlb_miss_stores,page-faults,dTLB-load-misses</code></strong> to find which instructions cause store misses.  (Then use <code>ocperf.py report -Mintel</code>).  If <code>report</code> doesn't make it easy to choose which event to see counts for, only record with a single event.</p>\n\n<p><code>mem_inst_retired.stlb_miss_stores</code> is a \"precise\" event, unlike most of the other store TLB events, so the counts should be for the real instruction, rather than maybe some later instructions like imprecise perf events.  (See <a href=\"https://stackoverflow.com/questions/8902132/when-an-interrupt-occurs-what-happens-to-instructions-in-the-pipeline\">Andy Glew's trap vs. exception answer</a> for some details about why some performance-counters can't easily be precise; many store events aren't.)</p>\n\n<hr>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1517470126, "post_id": 48557232, "comment_id": 84110558, "body": "Ah yes, I bet this is right.  I forgot about mmap <i>not</i> modifying the page tables without <code>MAP_POPULATE</code>, even though the OP mentioned page faults.  derp."}], "tags": [], "owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "is_accepted": true, "score": 7, "last_activity_date": 1517469646, "last_edit_date": 1517469646, "creation_date": 1517469296, "answer_id": 48557232, "question_id": 48552362, "link": "https://stackoverflow.com/questions/48552362/two-tlb-miss-per-mmap-access-munmap/48557232#48557232", "title": "Two TLB-miss per mmap/access/munmap", "body": "<blockquote>\n  <p>I expect to get ~100000 dTLB-store-misses in userspace, one per each iteration</p>\n</blockquote>\n\n<p>I would expect that:</p>\n\n<ul>\n<li>CPU tries to do <code>page[0] = 0;</code>, tries to load the cache line containing <code>page[0]</code>, can't find the TLB entry for it, increments <code>dTLB-load-misses</code>, fetches the translation, realises the page is \"not present\", then generates a page fault.</li>\n<li>Page fault handler allocates a page and (because the page table was modified) ensures that the TLB entry is invalidated (possibly by relying on the fact that Intel CPU's don't cache \"not present\" pages anyway, not necessarily by explicitly doing an <code>INVLPG</code>). The page fault handler returns to the instruction that caused the fault so it can be retried.</li>\n<li>CPU tries to do <code>page[0] = 0;</code> a second time, tries to load the cache line containing <code>page[0]</code>, can't find the TLB entry for it, increments <code>dTLB-load-misses</code>, fetches the translation, then modifies the cache line.</li>\n</ul>\n\n<p>For fun, you could use the <code>MAP_POPULATE</code> flag with <code>mmap()</code> to try to get the kernel to pre-allocate the pages (and avoid the page fault and the first TLB miss).</p>\n"}], "owner": {"reputation": 241, "user_id": 477960, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a94906def341a092dfa88dd604c244c8?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Hedayati", "link": "https://stackoverflow.com/users/477960/mohammad-hedayati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 2, "accepted_answer_id": 48557232, "answer_count": 2, "score": 9, "last_activity_date": 1517470229, "creation_date": 1517436968, "last_edit_date": 1517442855, "question_id": 48552362, "link": "https://stackoverflow.com/questions/48552362/two-tlb-miss-per-mmap-access-munmap", "title": "Two TLB-miss per mmap/access/munmap", "body": "<pre><code>for (int i = 0; i &lt; 100000; ++i) {\n    int *page = mmap(NULL, PAGE_SIZE, PROT_READ | PROT_WRITE,\n                            MAP_ANONYMOUS | MAP_PRIVATE, -1, 0);\n\n    page[0] = 0;\n\n    munmap(page, PAGE_SIZE);\n}\n</code></pre>\n\n<p>I expect to get ~100000 dTLB-store-misses in userspace, one per each iteration (Also ~100000 page-faults and dTLB-load-misses for kernel). Running following command, the result is roughly 2x what I expect. I would appreciate if someone could clarify why this is the case:</p>\n\n<pre><code>perf stat -e dTLB-store-misses:u ./test\nPerformance counter stats for './test':\n\n           200,114      dTLB-store-misses\n\n       0.213379649 seconds time elapsed\n</code></pre>\n\n<p>P.S. I have verified and am certain that the generated code doesn't introduce anything that would justify this result. Also, I do get ~100000 page-faults and dTLB-load-misses:k.</p>\n"}, {"tags": ["c", "if-statement", "statements"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1517436911, "post_id": 48552293, "comment_id": 84100992, "body": "What do you think the enclosing <code>while</code> loop does?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 5, "creation_date": 1517436982, "post_id": 48552293, "comment_id": 84101026, "body": "Please don&#39;t post an image of the output, copy the output in your question."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1517437065, "post_id": 48552293, "comment_id": 84101064, "body": "And you should use <code>do{}while()</code> instead of <code>while(){}</code>, because you need to check the looping condition after the body runs."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1517437207, "post_id": 48552293, "comment_id": 84101132, "body": "There&#39;s no need for the <code>if</code> statement, since it&#39;s the same condition as <code>while</code>."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1517439121, "post_id": 48552293, "comment_id": 84101942, "body": "@Barmar I think OP actually wants/needs the <code>if</code> statement. The problem is that the <code>scanf</code> should be before the <code>if</code> instead of inside the <code>if</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1517439211, "post_id": 48552293, "comment_id": 84101984, "body": "@4386427 Then he could just use <code>while(true)</code> and then <code>else { break; }</code>"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1517439501, "post_id": 48552293, "comment_id": 84102117, "body": "@Barmar - True - there are many better ways to code this. But OP tried to fix the problem using the <code>if</code> - which is doable. So I think it has a value to explain how the problem is fixed while keeping the <code>if</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517439576, "post_id": 48552293, "comment_id": 84102135, "body": "BTW, little need to use <code>sum</code> as <code>double</code>.  Just insure the average is calculated with <code>double</code> math,  <code>int sum = 0; ...... double average = 1.0* sum &#47; count;</code>"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1517443069, "post_id": 48552293, "comment_id": 84103205, "body": "Also, you don&#39;t initialize grade2, so the first test is random."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1517456523, "post_id": 48552293, "comment_id": 84106181, "body": "It isn&#39;t ignoring it."}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 5, "last_activity_date": 1517439205, "last_edit_date": 1517439205, "creation_date": 1517436968, "answer_id": 48552361, "question_id": 48552293, "link": "https://stackoverflow.com/questions/48552293/if-statement-isnt-being-caught/48552361#48552361", "title": "If statement isn&#39;t being caught", "body": "<p>When you do this the first time</p>\n\n<pre><code>  while(grade2 != -1000) \n</code></pre>\n\n<p>the variable <code>grade2</code> is uninitialized.</p>\n\n<p>Consequently your code has undefined behavior</p>\n\n<p>Make sure to initialize it like:</p>\n\n<pre><code>int grade2 = 0; // To zero or whatever you want\n</code></pre>\n\n<p>Further - always check the value returned by <code>scanf</code>. So instead of</p>\n\n<pre><code>scanf(\"%d\", &amp;grade1);\n</code></pre>\n\n<p>do</p>\n\n<pre><code>if (scanf(\"%d\", &amp;grade1) != 1)\n{\n    // Add error handling here\n}\n</code></pre>\n\n<p>Your next problem is that you don't scan <code>grade2</code> before checking whether it is -1000. Move the scan before the if-statement.</p>\n\n<p>Maybe what you want to do is:</p>\n\n<pre><code>  int grade2 = 0;\n  while(grade2 != -1000) \n  {\n      if (scanf(\"%d\", &amp;grade2) != 1)\n      {\n          // Add error handling here\n      }\n      if(grade2 != -1000)\n      {\n         ... \n</code></pre>\n\n<p>so that you scan for the first <code>grade2</code> before you do the <code>if(grade2 != -1000)</code> and enters the calculation code</p>\n\n<p>Written differently this could be:</p>\n\n<pre><code>  while(1) \n  {\n      if (scanf(\"%d\", &amp;grade2) != 1)\n      {\n          // Add error handling here\n      }\n      if(grade2 == -1000) break;  // Terminate the while\n\n      sum = sum + grade2;\n      ....\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100, "user_id": 9296944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da72733c2ff2dfc58793ad6fe5917387?s=128&d=identicon&r=PG&f=1", "display_name": "King Arthur the Third", "link": "https://stackoverflow.com/users/9296944/king-arthur-the-third"}, "edited": false, "score": 0, "creation_date": 1517463161, "post_id": 48552399, "comment_id": 84107945, "body": "Ah, yes, ofcourse. That makes total sense. Thank you Stephen!"}], "tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": false, "score": 2, "last_activity_date": 1517438281, "last_edit_date": 1517438281, "creation_date": 1517437197, "answer_id": 48552399, "question_id": 48552293, "link": "https://stackoverflow.com/questions/48552293/if-statement-isnt-being-caught/48552399#48552399", "title": "If statement isn&#39;t being caught", "body": "<p>While it's true that grade2 should be initialized and the return for scanf() should be checked, that's not the main problem the poster is running into.  The problem is that he checks</p>\n\n<pre><code>if(grade2 != -1000)\n</code></pre>\n\n<p>AFTER he has already processed grade2.  He should move</p>\n\n<pre><code>scanf(\"%d\", &amp;grade1);\n</code></pre>\n\n<p>before</p>\n\n<pre><code>if(grade2 != -1000)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "is_accepted": false, "score": 0, "last_activity_date": 1517438492, "last_edit_date": 1517438492, "creation_date": 1517437882, "answer_id": 48552526, "question_id": 48552293, "link": "https://stackoverflow.com/questions/48552293/if-statement-isnt-being-caught/48552526#48552526", "title": "If statement isn&#39;t being caught", "body": "<p>The <code>if</code> statement in your <code>while</code> loop is redundant because, the loop will not iterate unless the condition that controls it is true, and the <code>if</code> statement comes directly after that, checking for the same condition, whilst <code>grade2</code> is unchaged.</p>\n\n<p>Instead, you need to move it to after the <code>scanf()</code> call because that will modify the variable <code>grade2</code>, and don't forget to initialize your variables before using them or else you'll have undefined behavior.</p>\n\n<pre><code>int main(void)\n{\n\n    //....\n    int grade2 = 0; // initialized...\n    //....\n\n    while (grade2 != -1000)\n    {\n        scanf(\"%d\", &amp;grade2);\n        if (grade2 != -1000)\n        {\n            sum = sum + grade2;\n            average = sum / count;\n\n            printf(\"Sum is: %lf \\n\", sum);\n            printf(\"Average is: %lf \\n\", average);\n\n            grade1 = sum; //Converting the sum back into an int\n            count++;\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 100, "user_id": 9296944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da72733c2ff2dfc58793ad6fe5917387?s=128&d=identicon&r=PG&f=1", "display_name": "King Arthur the Third", "link": "https://stackoverflow.com/users/9296944/king-arthur-the-third"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 48552361, "answer_count": 3, "score": -1, "last_activity_date": 1517439205, "creation_date": 1517436652, "last_edit_date": 1517436956, "question_id": 48552293, "link": "https://stackoverflow.com/questions/48552293/if-statement-isnt-being-caught", "title": "If statement isn&#39;t being caught", "body": "<p>I can't for the life of me figure out why C is ignoring my if statement. </p>\n\n<p>I'm trying to skip all the procedures in the while statement when the input is -1000 (so that it doesn't print before exiting the program). Here is my code:</p>\n\n<pre><code>int main()\n{\n  int count = 1;\n  int grade1;\n  int grade2;\n  double sum;\n  double average;\n\n  printf(\"Please input a number of grades: \\n\");\n\n  scanf(\"%d\", &amp;grade1);\n  printf(\"Sum is: %d.000000 \\n\", grade1);\n  printf(\"Average is: %d.000000 \\n\", grade1);\n  count++;\n\n  sum = grade1;\n\n  while(grade2 != -1000) \n  {\n    if(grade2 != -1000)\n    {\n      scanf(\"%d\", &amp;grade2);\n\n      sum = sum + grade2;\n      average = sum / count;\n\n      printf(\"Sum is: %lf \\n\", sum);\n      printf(\"Average is: %lf \\n\", average);\n\n      grade1 = sum; //Converting the sum back into an int\n      count++;\n    }\n  }\n  return 0;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/6tPbp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6tPbp.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is a link to an image of my output. As you can see, even when grade2 is given -1000, the if statement is ignored, and another 2 lines are printed to the screen before the program exits. How can I fix this? Is this some sort of oddity of how C works?</p>\n"}, {"tags": ["c", "pipe", "signals", "fork", "posix"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1517437654, "post_id": 48552242, "comment_id": 84101332, "body": "<code>int is_shutdown = 0;</code> --&gt;&gt; <code>volatile sig_atomic_t is_shutdown = 0;</code> ... for a start ..."}], "answers": [{"comments": [{"owner": {"reputation": 525, "user_id": 2042546, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/gLrXB.jpg?s=128&g=1", "display_name": "CorellianAle", "link": "https://stackoverflow.com/users/2042546/corellianale"}, "edited": false, "score": 0, "creation_date": 1517437337, "post_id": 48552348, "comment_id": 84101186, "body": "Thanks for your answers, it would indeed evolve into a remotely controlled IoT device."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 1, "last_activity_date": 1517437221, "last_edit_date": 1517437221, "creation_date": 1517436918, "answer_id": 48552348, "question_id": 48552242, "link": "https://stackoverflow.com/questions/48552242/memory-and-pipe-socket-management-in-a-program-with-pipe-fork-and-signal-ha/48552348#48552348", "title": "memory and pipe/socket management in a program with pipe(), fork() and signal handling", "body": "<ol>\n<li>No, you should not.  The <em>only</em> thing you should do in the signal handler is set <code>is_shutdown</code>.</li>\n<li><code>write</code> makes a copy.  After <code>write</code> returns, it is safe to reuse or deallocate the buffer.  (Make sure to handle short writes, though.)</li>\n<li>You don't.  Again, the <em>only</em> thing you should do in the signal handler is set <code>is_shutdown</code>.  Clean up in the <code>parent</code> and <code>child</code> blocks after the while loops terminate.</li>\n<li>Yes, each process has an independent copy.  You should also know that with this design, if you run the program from the terminal and then type ^C at it, the kernel will fire a SIGINT at both of the processes, because they are both in the same process group.</li>\n<li><code>is_shutdown</code> needs to be declared with type <code>volatile sig_atomic_t</code>, and, for a simple program like this, it should not be written to by anything other than the signal handler.  Also, the signal handler should not read its value, it should only set it.  And depending on details of the code you haven't shown us, it may be appropriate to install the signal handler without using <code>SA_RESTART</code>, so that it interrupts blocking system calls.</li>\n<li>The only thing you need to do about this is make sure that each side of the communications channel gracefully handles the other end disconnecting abruptly.\n\n<ul>\n<li>If this is a mockup of what will eventually become a network server and client, you should change from using <code>pipe</code> to using <code>socketpair</code> before you start testing abrupt disconnects, because <code>socketpair</code> fds behave much more like real network sockets.</li>\n</ul></li>\n<li>I/O overhead is probably much bigger than malloc overhead.  Worrying about malloc overhead at this stage is premature optimization.</li>\n</ol>\n"}], "owner": {"reputation": 525, "user_id": 2042546, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/gLrXB.jpg?s=128&g=1", "display_name": "CorellianAle", "link": "https://stackoverflow.com/users/2042546/corellianale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 48552348, "answer_count": 1, "score": 0, "last_activity_date": 1517437221, "creation_date": 1517436428, "question_id": 48552242, "link": "https://stackoverflow.com/questions/48552242/memory-and-pipe-socket-management-in-a-program-with-pipe-fork-and-signal-ha", "title": "memory and pipe/socket management in a program with pipe(), fork() and signal handling", "body": "<p>Working with <code>fork</code>, <code>pipe</code> and <code>signal.h</code> signal handling. <code>STDIN</code> is used to quickly simulate socket connection with a network server. Pseudocode:</p>\n\n<pre><code>struct message_t {\n    uint32_t length;\n    uint8_t *data;\n};\n\nint is_shutdown = 0;\n\nvoid signal_handler(int) {\n    //set is_shutdown if SIGINT\n}\n\nint main() {\n    //initialize\n    pipe();\n    fork();\n\n    if (parent) {\n        while(!is_shutdown) {\n            //0. initialize variables, buffer, message_t\n            //1. read string of unknown length from STDIN (or socket) to a buffer\n            //2. malloc() message_t and fill it's fields\n            //3. write() message_t to pipe\n            //4. free() message_t\n        }\n    }\n\n    if (child) {\n        while(!is_shutdown) {\n            //0. initialize variables, message_t\n            //1. read() message_t: read length, malloc() buffer, read data\n            //2. execute command\n            //4. free() message_t\n        }   \n    }\n\n    //close pipe\n}\n</code></pre>\n\n<p>Several thing that confuse me:</p>\n\n<ol>\n<li>Should I <code>close()</code> the <code>pipe</code> in the signal handler?</li>\n<li>I don't fully understand what happens to the message (it's memory) after I send it (parent). Should I <code>free()</code> the buffer after the <code>write()</code>?</li>\n<li>How do I handle resources deallocation from signal handler. Should I implement buffers and fd's as global variable to have access to them from signal handler</li>\n<li><code>is_shutdown</code> flag and interprocess communication. Am I understanding it right that parent and child do not share <code>is_shutdown</code> as the same variable (they are copies) and change to the one would not change the other?</li>\n<li>What about concurrent access to <code>is_shutdown</code> for both signal handler and <code>main</code>? Any hidden details like in concurrency via multithreading?</li>\n<li>When one process gets shut down, the other would still be working. I would not be able to notify the other one if something happens with a pipe. Should I hope for a SIGPIPE?</li>\n<li>I suspect that calling <code>malloc()</code> on each iteration of the parent's <code>while</code> loop would not be wise from a performance standpoint. But defining buffer that is \"big enough\" feels like a hack (what if someday it would not be big enough). Am I wrong?</li>\n</ol>\n\n<p>I am quite new to C and it's memory and resource management: switching from C++14 development for powerful Intel based server/desktops to C development for ~180MHz ARM embedded systems so I may be worried to much and forget some obvious things.</p>\n"}, {"tags": ["c", "embedded-linux", "sd-card", "mount", "diskspace"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517436484, "post_id": 48551799, "comment_id": 84100803, "body": "There would be more information in <code>&#47;sys&#47;class</code> about the device. This is really fun, let me try a few things and if I succeed I will answer."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1517436792, "post_id": 48551799, "comment_id": 84100934, "body": "<a href=\"https://stackoverflow.com/questions/646241/c-run-a-system-command-and-get-output\" title=\"c run a system command and get output\">stackoverflow.com/questions/646241/&hellip;</a>"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517436935, "post_id": 48551799, "comment_id": 84101004, "body": "I just found that if you inspect <code>&#47;sys&#47;block</code> you might solve this."}, {"owner": {"reputation": 312, "user_id": 7712908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8ff5e444c5ef577c7c14adf34dd362?s=128&d=identicon&r=PG&f=1", "display_name": "blackbeard", "link": "https://stackoverflow.com/users/7712908/blackbeard"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1517439683, "post_id": 48551799, "comment_id": 84102176, "body": "@IharobAlAsimi: I have inspected <code>&#47;sys&#47;block</code> and found a script called <code>size</code> which doesn&#39;t represent the total or available size of the SD card (has only 1 partition).  There is another script called <code>stat</code> whose information is not human-readable (at least to me)."}, {"owner": {"reputation": 312, "user_id": 7712908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8ff5e444c5ef577c7c14adf34dd362?s=128&d=identicon&r=PG&f=1", "display_name": "blackbeard", "link": "https://stackoverflow.com/users/7712908/blackbeard"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 2, "creation_date": 1517439816, "post_id": 48551799, "comment_id": 84102218, "body": "@pm100 <code>popen</code> and <code>pclose</code> might work! let me try."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517451319, "post_id": 48551799, "comment_id": 84105057, "body": "@blackbeard Read the corresponding kernel documentation for each of the files, and it should become clear what every file and every value is."}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 1, "last_activity_date": 1517440202, "last_edit_date": 1517440202, "creation_date": 1517439795, "answer_id": 48552881, "question_id": 48551799, "link": "https://stackoverflow.com/questions/48551799/how-to-pull-mount-and-df-information-for-sd-card-from-linux/48552881#48552881", "title": "How to pull mount and df information for SD card from linux?", "body": "<p>I know that you didn't ask for code but here you go (<em>I really had fun writing it</em>).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#include &lt;dirent.h&gt;\n#include &lt;limits.h&gt;\n\n#include &lt;string.h&gt;\n\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n\n#include &lt;stdlib.h&gt;\n#include &lt;sys/stat.h&gt;\n\nstatic int\nwalkdir(const char *const path, int (*visit)(const char *const, const char *const), void *data)\n{\n    struct dirent *entry;\n    DIR *dir;\n    dir = opendir(path);\n    if (dir == NULL)\n        return -1;\n    while ((entry = readdir(dir)) != NULL) {\n        int code;\n        code = visit(path, entry-&gt;d_name);\n        if (code != 0) {\n            closedir(dir);\n            return code;\n        }\n    }\n    closedir(dir);\n    return 0;\n}\n\nstatic char *\nfile_get_content(const char *const path)\n{\n    int file;\n    struct stat st;\n    char *text;\n    size_t size;\n\n    text = NULL;\n    file = -1;\n    if (stat(path, &amp;st) == -1)\n        goto error;\n    size = st.st_size;\n    text = malloc(size + 1);\n    if (text == NULL)\n        goto error; // file too large, cannot read like this\n    file = open(path, O_RDONLY);\n    if (file == -1)\n        goto error;\n    if ((size = read(file, text, size)) &lt;= 0)\n        goto error;\n    text[size] = '\\0';\n    if (file != -1)\n        close(file);\n    return text;\nerror:\n    if (file != -1)\n        close(file);\n    free(text);\n    return NULL;\n}\n\nstatic size_t\nget_size(const char *const dirpath, const char *const name)\n{\n    char path[PATH_MAX];\n    char *text;\n    int length;\n    size_t size;\n\n    length = snprintf(path, sizeof(path), \"%s/%s/size\", dirpath, name);\n    if (((size_t) length) &gt; sizeof(path))\n        return 0;\n    size = 0;\n    text = file_get_content(path);\n    if (text != NULL) { \n        size = strtoll(text, NULL, 10);\n        free(text);\n    }\n    return size;\n}\n\nstatic int\ndisplay_block(const char *const dirpath, const char *const name)\n{\n    const char *block;\n    block = strrchr(dirpath, '/');\n    if (block == NULL)\n        return -1;\n    block += 1;\n\n    if (strstr(name, block) == name) {\n        size_t size;\n        // get_ the parition size\n        //\n        // Note, I had to divice the size by 2 because it didn't\n        // match the sizes reported by `df'.\n        //\n        // Also, it appears that it's in megabytes \n        // (i.e. twice the size in MB)\n        size = get_size(dirpath, name) / (1 &lt;&lt; 21);\n        // Display the result\n        fprintf(stdout, \"\\tpartition: %s (%zu GB)\\n\", name, size);\n    }\n\n    return 0;\n}\n\nstatic char *\nget_vendor(const char *const name)\n{\n    char path[PATH_MAX];\n    int length;\n    char *value;\n    // get_ partitions\n    length = snprintf(path, sizeof(path), \"/sys/block/%s/device/vendor\", name);\n    if (((size_t) length) &gt; sizeof(path))\n        return NULL;\n    value = file_get_content(path);\n    if (value == NULL)\n        return NULL;        \n    // Make the trailing `\\n' a '\\0' instead\n    strtok(value, \"\\n\");\n    return value;\n}\n\nstatic char *\nget_model(const char *const name)\n{\n    char path[PATH_MAX];\n    int length;\n    char *value;\n    // get_ partitions\n    length = snprintf(path, sizeof(path), \"/sys/block/%s/device/model\", name);\n    if (((size_t) length) &gt; sizeof(path))\n        return NULL;\n    value = file_get_content(path);\n    if (value == NULL)\n        return NULL;        \n    // Make the trailing `\\n' a '\\0' instead\n    strtok(value, \"\\n\");\n    return value;\n}\n\nstatic int\nparse_block(const char *const name)\n{\n    char path[PATH_MAX];\n    int length;\n    char *vendor;\n    char *model;\n    // get_ partitions\n    length = snprintf(path, sizeof(path), \"/sys/block/%s\", name);\n    if (((size_t) length) &gt; sizeof(path))\n        return -1;      \n    vendor = get_vendor(name);\n    model = get_model(name);    \n    if ((model != NULL) &amp;&amp; (vendor != NULL)) {\n        fprintf(stdout, \"block device: %s (%s %s)\\n\", name, vendor, model);\n        walkdir(path, display_block, NULL);\n    }\n    free(vendor);\n    free(model);\n    return 0;\n}\n\nstatic int\nlist_devices(const char *const dirpath, const char *const name)\n{\n    if (*name == '.')\n        return 0;\n    parse_block(name);\n    return 0;\n}\n\nint\nmain(void)\n{\n    return walkdir(\"/sys/block\", list_devices, NULL);\n}\n</code></pre>\n\n<p>This will show you the devices and some information about them, also the size that you are very interested in.</p>\n\n<p>Note, that there is no need for them to be mounted.</p>\n\n<p>You can of course, find more information in other places. Just check the appropriate directories and you will be able to get everything. For instance, there is a file <em>removable</em> that tells you whether the device is removable, which I think will be <em>very</em> useful in your case.</p>\n"}, {"tags": [], "owner": {"reputation": 312, "user_id": 7712908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8ff5e444c5ef577c7c14adf34dd362?s=128&d=identicon&r=PG&f=1", "display_name": "blackbeard", "link": "https://stackoverflow.com/users/7712908/blackbeard"}, "is_accepted": false, "score": 1, "last_activity_date": 1517859746, "creation_date": 1517859746, "answer_id": 48630275, "question_id": 48551799, "link": "https://stackoverflow.com/questions/48551799/how-to-pull-mount-and-df-information-for-sd-card-from-linux/48630275#48630275", "title": "How to pull mount and df information for SD card from linux?", "body": "<p>I have used the <code>statfs()</code> system call to get the SD card capacity and usage.\nAs for detecting card presence, I have used <code>stat()</code> call to look for the preferable directory at <code>/mnt/sd_card_dir</code> where <code>sd_card_dir</code> is set during auto-mount configuration. If it exists, the SD card is (most likely) present - because the <code>sd_card_dir</code> folder gets created automatically whenever the SD card is inserted. If you create partitions, they should appear as sub-directories of <code>sd_card_dir</code>. </p>\n\n<p>Following libraries should be called:</p>\n\n<pre><code>#include &lt;sys/stat.h&gt;\n#include &lt;sys/vfs.h&gt;\n</code></pre>\n\n<p>Following function handles the detection and it needs to be called periodically - at least once per minute. In my particular case, I have called this function every 10 sec as a low-priority task and attached to the software's main loop. </p>\n\n<pre><code>#define PATH \"/mnt/sd_card_dir\"\nstatic int handler_sd_card_status(void)\n{\n    struct stat st;\n    struct statfs fs;\n\n    if (stat(PATH, &amp;st))\n        printf(\"Missing or unreadable\\n\");\n    else {\n        if (!statfs(PATH, &amp;fs)) {\n            char sd_stat[32];\n            double scale = fs.f_bsize / 1e9;\n            snprintf(sd_stat, sizeof(sd_stat),\n                \"%.2f of %.1f GB used\",\n                (fs.f_blocks - fs.f_bavail) * scale,\n                fs.f_blocks * scale);\n            printf(\"%s\\n\", sd_stat);\n        } else\n            printf(\"Size unreadable\\n\");\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 312, "user_id": 7712908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8ff5e444c5ef577c7c14adf34dd362?s=128&d=identicon&r=PG&f=1", "display_name": "blackbeard", "link": "https://stackoverflow.com/users/7712908/blackbeard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 857, "favorite_count": 2, "accepted_answer_id": 48552881, "answer_count": 2, "score": 1, "last_activity_date": 1554439508, "creation_date": 1517434384, "last_edit_date": 1592644375, "question_id": 48551799, "link": "https://stackoverflow.com/questions/48551799/how-to-pull-mount-and-df-information-for-sd-card-from-linux", "title": "How to pull mount and df information for SD card from linux?", "body": "<p>I am running an embedded software (written in C) on Linux kernel. I need to create an alarm on my software that checks whether an SD card is mounted on, and also find out it's capacity. I can brainstorm three ideas:</p>\n<ol>\n<li><p>I am thinking to read and parse the file <code>/proc/mounts</code></p>\n<p>and then, use <code>regex</code> and a bunch of string comparisons to check if any SD card present, or</p>\n</li>\n<li><p>scan and check for preferable directory name under <code>/mnt/</code> using <code>dirent</code>library.</p>\n<p>Either way, I am not sure how I am going to get the memory usage on SD card,  or</p>\n</li>\n<li><p>I could use my software to run a shell script containing <code>df</code> command, outputting into a file, and then read it. It should tell me whether an SD card is present, where it is mounted on, and it's capacity.</p>\n</li>\n</ol>\n<p>I am sure there are plenty of easy and straightforward ways to acquire this information and feed it into my software. Perhaps a nifty library call? I did some research and saw resources on <code>fstab</code>, <code>&lt;sys/mount.h&gt;</code>, don't think these will take me any further. Does anyone have any better ideas?</p>\n"}, {"tags": ["c", "printf", "control-characters"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1517433591, "post_id": 48551591, "comment_id": 84099398, "body": "It behaves just fine. 3 and 4 don\u2019t correspond to any integers. Your font just shows them that way."}, {"owner": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "edited": false, "score": 0, "creation_date": 1517433659, "post_id": 48551591, "comment_id": 84099436, "body": "Are you trying to print the character &#39;5&#39;? If so, &#39;\\x05&#39; is not what you&#39;re looking for. The ASCII code for &#39;5&#39; is &#39;\\x35&#39;."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1517433961, "post_id": 48551591, "comment_id": 84099574, "body": "<code>0x03</code> is <code>ETX</code> (end of text), <code>0x04</code> is <code>EOT</code> (end of transmission) and <code>0x05</code> is <code>ENQ</code> (enquiry). These are not printable characters, but <a href=\"https://en.wikipedia.org/wiki/Control_character\" rel=\"nofollow noreferrer\">control characters</a>."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1517434880, "post_id": 48551591, "comment_id": 84100039, "body": "&quot;Are&quot; and &quot;are not&quot; printable depends on what the OP&#39;s terminal is designed to handle. Obviously, on OP&#39;s characters they <i>are</i> \u2013 whether they <i>should</i> is something else. I assume it&#39;s for convenience that something is shown, rather than &quot;nothing&quot; \u2013 or a total system crash."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1517435498, "post_id": 48551591, "comment_id": 84100339, "body": "Assuming the screenshot is exactly what that code produces, it&#39;s more weird that the text changed. Try explaining <i>that</i>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1517438516, "post_id": 48551591, "comment_id": 84101712, "body": "Tip: To add clarity to what is printed, surround by sentinel characters --&gt; <code>printf(&quot;question[%d] = [%c]\\n&quot;, i, question[i]);</code>  Add <code>[]</code>.  Perhaps <code>&#39;\\0x05&#39;</code> is printing a space?  Better yet, try <code>for(int i = 0; i &lt;= 48; i++) {     printf(&quot;%2d = [%c]\\n&quot;, i, i); }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1517434650, "post_id": 48551643, "comment_id": 84099932, "body": "<code>%c</code> expects an <code>int</code> (promoted in the variadic function) but it is the OS which dictates whether it is printable."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1517434803, "post_id": 48551643, "comment_id": 84100002, "body": "@WeatherVane To be even more pedantic - it&#39;s the terminal who is dictating."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1517434959, "post_id": 48551643, "comment_id": 84100086, "body": "@EugeneSh. the terminal is implemented by the OS."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1517435047, "post_id": 48551643, "comment_id": 84100128, "body": "@WeatherVane Not necessarily. You can have a bare-metal C project sending these over serial port to some serial terminal emulating whatever standard (VT100, VT50, some custom, you name it)"}], "tags": [], "owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1517434444, "last_edit_date": 1517434444, "creation_date": 1517433678, "answer_id": 48551643, "question_id": 48551591, "link": "https://stackoverflow.com/questions/48551591/printing-a-particular-hexadecimal-value-in-character-representation/48551643#48551643", "title": "Printing a particular hexadecimal value in character representation", "body": "<p>It is completelly ok. <code>\\x05</code> is not printable character in ASCII table that's why you see strange character.</p>\n\n<p><code>%c</code> expects printable character and your is not.</p>\n\n<p><a href=\"http://facweb.cs.depaul.edu/sjost/it212/documents/ascii-pr.htm\" rel=\"nofollow noreferrer\">List of printable ASCII characters</a></p>\n"}, {"comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1517434043, "post_id": 48551649, "comment_id": 84099617, "body": "But OP&#39;s output proves that 3 and 4 <i>are</i> printable."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1517434101, "post_id": 48551649, "comment_id": 84099644, "body": "@usr2564301 Nope, I wont claim that. :)"}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1517434104, "post_id": 48551649, "comment_id": 84099646, "body": "@usr2564301 that&#39;s obviously not true."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1517434478, "post_id": 48551649, "comment_id": 84099833, "body": "@usr2564301 they <i>might</i> be printable."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1517434550, "post_id": 48551649, "comment_id": 84099873, "body": "OK, let&#39;s say that ASCII is not defining <i>how</i> these are printable."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1517435032, "post_id": 48551649, "comment_id": 84100123, "body": "@EugeneSh.: exactly. Therefore it&#39;s left to the terminal implementation what to do with &quot;unprintables&quot;. But the <code>5</code> code <i>does</i> get processed by OP&#39;s terminal, else there would be a <code>5</code> glyphlet as well."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 4, "last_activity_date": 1517434710, "last_edit_date": 1517434710, "creation_date": 1517433698, "answer_id": 48551649, "question_id": 48551591, "link": "https://stackoverflow.com/questions/48551591/printing-a-particular-hexadecimal-value-in-character-representation/48551649#48551649", "title": "Printing a particular hexadecimal value in character representation", "body": "<p><code>%c</code> format specifier is for the printable character representation for the corresponding integer value supplied as argument. As per the ASCII encoding, neither <code>0x03</code>, <code>0x04</code> or <code>0x05</code> is a printable value!!</p>\n\n<p>For sake of confirmation, you can pass the same value to <strong><a href=\"https://linux.die.net/man/3/isprint\" rel=\"nofollow noreferrer\"><code>isprint()</code></a></strong> before attempting to print that. In case you chose to print it anyway, the \"display\" finally depends on how your terminal chooses to <em>interpret</em> the display.</p>\n\n<p>Here's some references (<a href=\"https://www.juniper.net/documentation/en_US/idp5.1/topics/reference/general/intrusion-detection-prevention-custom-attack-object-extended-ascii.html\" rel=\"nofollow noreferrer\">1</a>, <a href=\"https://web.itu.edu.tr/sgunduz/courses/mikroisl/ascii.html\" rel=\"nofollow noreferrer\">2</a>) which lists printable and non-printable ASCII values</p>\n"}, {"tags": [], "owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "is_accepted": false, "score": 3, "last_activity_date": 1517434560, "creation_date": 1517434560, "answer_id": 48551834, "question_id": 48551591, "link": "https://stackoverflow.com/questions/48551591/printing-a-particular-hexadecimal-value-in-character-representation/48551834#48551834", "title": "Printing a particular hexadecimal value in character representation", "body": "<p>Your assumption is wrong. ASCII codes 3, 4, and 5 do <em>not</em> correspond to (visible) integers <code>3</code>, <code>4</code>, and <code>5</code>.</p>\n\n<p>What you are seeing is your local terminal's <em>translation</em> of what it thinks you mean to print:</p>\n\n<ol>\n<li><p>It does not try to interpret the codes <code>3</code> and <code>4</code>. These correspond to ASCII control characters <code>End of Text</code> and <code>End of Transmission</code>, but your terminal chooses to not handle them. Therefore, it writes these two codes literally into the output stream, which looks up a suitable font to display them. In modern (Unicode) fonts, there are no characters for these characters because they are not <em>supposed</em> to be \"printed\". However, some terminals are aware of that and provide a fall-back so you can at least see something.</p></li>\n<li><p>The code <code>5</code>, on the other hand, <em>is</em> interpreted by your terminal: \"Signal intended to trigger a response at the receiving end, to see if it is still present.\" The terminal sends that signal, receives (most likely) a \"yes\" answer \u2013 yes, the output stream is active \u2013 and continues outputting the rest of the text. As it is a signal and not a character, nothing is displayed.</p></li>\n</ol>\n\n<p>This behavior is not unique for the <code>0x05</code> code. You don't mention it in your question, but you seem not suprised to get a new line when you \"print\" <code>\\n</code>' <em>even though</em> it sends a code <code>0x0A</code> to the output stream. And you do <em>not</em> get a <code>10</code> on screen but the cursor moves down a line. Again, this is because that code gets interpreted by the terminal to take some specific action.</p>\n"}], "owner": {"reputation": 335, "user_id": 3524889, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a9cb1fb1fe0b45219dee2fc305ce5795?s=128&d=identicon&r=PG&f=1", "display_name": "reyyez", "link": "https://stackoverflow.com/users/3524889/reyyez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 893, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1517470985, "creation_date": 1517433448, "last_edit_date": 1517470985, "question_id": 48551591, "link": "https://stackoverflow.com/questions/48551591/printing-a-particular-hexadecimal-value-in-character-representation", "title": "Printing a particular hexadecimal value in character representation", "body": "<p>When trying to use <code>'\\x05'</code> in a string, the compiled C code seems to behave oddly when handling the value.</p>\n\n<p>For instance when using the following string:</p>\n\n<pre><code>char *weird = \"\\x04\\x68\\x65\\x79\\x79\\x03\\x6e\\x65\\x74\\x05\\x6c\\x6f\\x63\\x61\\x6c\\x00\";\n</code></pre>\n\n<p>When printing each character of the string, the <code>'\\x05'</code> is not corresponding to the integer 5, whereas the <code>'\\x04'</code> and <code>'\\x03'</code> are corresponding to the integers 4 and 3 respectively.</p>\n\n<p>The following for loop demonstrates the problem:</p>\n\n<pre><code>for(int i = 0; i &lt; strlen(question); i++){\n    printf(\"question[%d] = %c\\n\", i, question[i]);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/aFie9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aFie9.png\" alt=\"0x05\"></a></p>\n\n<p>Any ideas why this specific case of <code>'\\x05'</code> is so troublesome?</p>\n"}, {"tags": ["c", "arrays", "string", "string-literals"], "comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 2, "creation_date": 1517433250, "post_id": 48551525, "comment_id": 84099226, "body": "So sure this has to be a duplicate."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1517433299, "post_id": 48551525, "comment_id": 84099262, "body": "<code>int bar = (int)foo;</code> casting is redundant."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517433312, "post_id": 48551525, "comment_id": 84099270, "body": "&quot;try to cast a string literal &quot; --&gt; Code does not do that here.  <code>(int)foo</code> casts  a <code>char *</code>, a pointer, to <code>int</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1517433314, "post_id": 48551525, "comment_id": 84099271, "body": "When an array-valued expression appears in a context such as you describe, it is automatically converted to a pointer to the array&#39;s first element.  Thus it&#39;s a pointer you&#39;re converting either way."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1517433392, "post_id": 48551525, "comment_id": 84099304, "body": "@SouravGhosh <code>(int)foo;</code> quiets warnings that would otherwise arise when assigning a pointer to an <code>int</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1517433417, "post_id": 48551525, "comment_id": 84099323, "body": "C permits converting pointers to integer types.  This has nothing to do with the data, if any, to which the pointer points -- it&#39;s about the value of the pointer itself."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517433456, "post_id": 48551525, "comment_id": 84099342, "body": "@chux I was talking about the first case..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517433759, "post_id": 48551525, "comment_id": 84099480, "body": "&quot;you try to cast a string literal or a char array to an int, the compiler just gives you a warning&quot;  --&gt; What is the exact text of the warring?  A warning is not expected when a cast is present."}, {"owner": {"reputation": 461, "user_id": 4796762, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4a766de954f2ddcd6444362a44045d18?s=128&d=identicon&r=PG", "display_name": "Andr&#233; Yuhai", "link": "https://stackoverflow.com/users/4796762/andr%c3%a9-yuhai"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1517433983, "post_id": 48551525, "comment_id": 84099591, "body": "@chux Here it is  main.c:62:15: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]      int bar = (int)foo;                ^ main.c:66:16: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]      int bar2 = (int)qux;"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517434948, "post_id": 48551525, "comment_id": 84100075, "body": "@PorFavorDama Exaclty, because the compiler knows that there is a size mismatch. Try <code>intptr_t</code> instead of <code>int</code> and the warning will go away. You will then be able to print the address of the pointer. Note that you can directly do this by using the <code>&quot;%p&quot;</code>. You can of course use this <code>intptr_t</code> variable to get back your pointer."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1517435494, "post_id": 48551525, "comment_id": 84100338, "body": "&quot;the compiler just gives you a warning&quot;.... Take warnings seriously... most likely you are doing something bad - and in this case you are."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1517435746, "post_id": 48551525, "comment_id": 84100460, "body": "looks like we have a serial downvoter"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517436010, "post_id": 48551525, "comment_id": 84100584, "body": "<a href=\"https://stackoverflow.com/questions/48551525/how-does-casting-work-on-char-arrays-and-string-literals?noredirect=1#comment84100460_48551525\">@M.M</a> <a href=\"http://na.frea.com/sites/default/files/styles/large/public/tough-crowd-no-respect-dbff09_zpsdc78f8f6.jpg?itok=MQSNcPmn\" rel=\"nofollow noreferrer\">Tough Crowd</a> today."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517436515, "post_id": 48551525, "comment_id": 84100817, "body": "@IharobAlAsimi <a href=\"https://stackoverflow.com/questions/48551525/how-does-casting-work-on-char-arrays-and-string-literals/48551995#comment84100075_48551525\">re</a> <code>&quot;%p&quot;</code> is for <code>void *</code>,  <code>&quot;%&quot; PRIdPTR</code> is for <code>intptr_t</code>."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517437013, "post_id": 48551525, "comment_id": 84101041, "body": "@chux I see how you can think that I said <i>use <code>&quot;%p&quot;</code> with <code>intptr_t</code></i> but I didn&#39;t mean to. I meant that one could directly print the address using the pointer and the <code>&quot;%p&quot;</code> <code>printf()</code> specifier."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517437970, "post_id": 48551525, "comment_id": 84101481, "body": "@PorFavorDama I&#39;m editing the post to reflect that you are really asking about an <code>(int)</code> cast of a <i>pointer</i> and not a <i>string literal</i>.  <code>(int)&quot;xyz&quot;</code> would be an <code>(int)</code>cast of a <i>string literal</i>.  Re-edit/roll-back if needed."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1517440941, "post_id": 48551525, "comment_id": 84102589, "body": "@gsamaras so look it up and flag it as such."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1517433494, "post_id": 48551579, "comment_id": 84099362, "body": "Note that a memory address may exceed the width of an <code>int</code>."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517433747, "post_id": 48551579, "comment_id": 84099474, "body": "@tilz0R Simply because you should not use <code>int</code> for that, there are types more suited for it. I will lookup the part of the standard that explains why this is UB."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517433844, "post_id": 48551579, "comment_id": 84099522, "body": "@IharobAlAsimi It is not UB.  &quot;Any pointer type may be converted to an integer type.&quot; 6.3.2.3 6  True, other types may be better, but it is not UB."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517433849, "post_id": 48551579, "comment_id": 84099525, "body": "@IharobAlAsimi I simply casted to <code>int</code>. If I have loss of data, who cares. In the next step, I&#39;m using printf completelly ok. What UB can I trigger with this cast? What can happen in system? Memory leak? I don&#39;t believe."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1517434074, "post_id": 48551579, "comment_id": 84099625, "body": "@tilz0R <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.3.2.3p6\" rel=\"nofollow noreferrer\">Here it is</a>, the behavior is <i>strictly speaking</i> undefined. Specifically &quot;<i>if the result cannot be represented ... the behavior is undefined</i>&quot;, whether you convert back or not, the standard says so."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517434100, "post_id": 48551579, "comment_id": 84099640, "body": "@tilz0R Nothing that has to do with <i>loss of data</i>, the BEHAVIOR IS UNDEFINED. But there are integer types that are guaranteed to allow this conversion, and back from it. <a href=\"https://stackoverflow.com/a/48551585/1983495\">Read my answer</a>."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517434160, "post_id": 48551579, "comment_id": 84099674, "body": "@IharobAlAsimi what behavior? Where is this noted. Sorry, but I don&#39;t believe you this time. You have no facts :)"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517434253, "post_id": 48551579, "comment_id": 84099714, "body": "@tilz0R Click the links in my comment please. It&#39;s not a matter of <i>believing</i>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517434314, "post_id": 48551579, "comment_id": 84099748, "body": "@IharobAlAsimi  Fair enough, it (pointer to integer) may be UB if the result is not representable.  Else it is IDB."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517434363, "post_id": 48551579, "comment_id": 84099773, "body": "@IharobAlAsimi I said it clear. int may not be enough for entire pointer. But there is no problem in casting pointer to int. UB would be if you would use this int to cast back to pointer and then dereference it. <code>char* a = &quot;abc&quot;; int b; int* c; b = (int)a; c = (int *)b; printf(&quot;%d&quot;, *c);</code> Printf statement is UB here"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517434483, "post_id": 48551579, "comment_id": 84099838, "body": "tilz0R, @IharobAlAsimi  is correct in the case of the pointer not representable as the target integer.  Code is UB <i>at that point</i>.  Rest of code does not matter.  Using <i>optional</i> integer types <code>(u)intptr_t</code> avoids this problem for <i>object pointers</i>."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517434486, "post_id": 48551579, "comment_id": 84099839, "body": "@tilz0R You are contradicting the standard. <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.3.2.3p6\" rel=\"nofollow noreferrer\">Please read the following link, exactly where it opens, i.e. Paragraph 6</a>."}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517434616, "post_id": 48551579, "comment_id": 84099912, "body": "@IharobAlAsimi you did not post any standard. You example code shows clearly what I said earlier. If you do not cast back to pointer and dereference this pointer, everything is ok. I will change my mind if you show me STANDARD, not some &quot;good coding practice&quot;. Period. End of discussion. Edit: I read your exact part. It says it is undefined due to the fact that you cannot write entire address to int. Clearly, but until you dereference it again, everything is ok!"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517434732, "post_id": 48551579, "comment_id": 84099971, "body": "@tilz0R Click the link, that&#39;s all you need to read. I will not post it here. And NOOOO you don&#39;t have to dereference anything for it to be UB. Read the *** link please, and then say whatever you want: this is the link ---&gt; <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.3.2.3p6\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.3.2.3p6</a>"}], "tags": [], "owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1517433532, "last_edit_date": 1517433532, "creation_date": 1517433409, "answer_id": 48551579, "question_id": 48551525, "link": "https://stackoverflow.com/questions/48551525/how-does-int-casting-work-on-char-arrays-and-char/48551579#48551579", "title": "How does (int) casting work on char arrays and char *?", "body": "<p>When you cast <code>char *</code> to <code>int</code>, you get memory address of first element in char array.</p>\n\n<pre><code>char* foo = \"baz\";\nint bar = (int)foo;\nprintf(\"0x%X\", (unsigned)bar); //It will print memory of first char element. \n</code></pre>\n\n<p>But, this code has major issues and may not print exact result. Memory address can have MSB bit set to 1 and you will get negative value in int or in some cases <code>int</code> is not enough wide to store entire memory address.</p>\n"}, {"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 1, "last_activity_date": 1517434859, "last_edit_date": 1517434859, "creation_date": 1517433420, "answer_id": 48551585, "question_id": 48551525, "link": "https://stackoverflow.com/questions/48551525/how-does-int-casting-work-on-char-arrays-and-char/48551585#48551585", "title": "How does (int) casting work on char arrays and char *?", "body": "<p>Conversions between pointers and integers are accepted by the c standard, but they might easily lead your program to <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.3.2.3p6\" rel=\"nofollow noreferrer\"><em>undefined behavior</em></a>.</p>\n\n<p>If you were presented with a situation where converting between pointer and integer is useful, and there are situations<sup>1</sup>. Then you should use the <a href=\"https://en.wikibooks.org/wiki/C_Programming/stdint.h\" rel=\"nofollow noreferrer\">appropriate types</a>,</p>\n\n<ul>\n<li><code>intptr_t</code></li>\n<li><code>uintptr_t</code></li>\n</ul>\n\n<p>You should probably read these</p>\n\n<ul>\n<li><a href=\"https://softwareengineering.stackexchange.com/questions/290574/what-is-the-motivation-for-casting-a-pointer-into-a-integer\">What is the motivation for casting a pointer to a integer</a></li>\n<li><a href=\"https://wiki.sei.cmu.edu/confluence/display/c/INT36-C.+Converting+a+pointer+to+integer+or+integer+to+pointer\" rel=\"nofollow noreferrer\">INT36-C Converting a poitner integer or integer to pointer</a>.</li>\n</ul>\n\n<p>Also, the actual type of a character constant <em>is</em> <code>int</code>.</p>\n\n<hr>\n\n<p><sup>1</sup><sub>For example in a <em>jni</em> plugin to pass a <em>handle</em> to java and from java to your program.</sub></p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517437486, "post_id": 48551995, "comment_id": 84101256, "body": "PorFavorDama, <code>int bar = (int)foo;</code> did not generate a warning as the <code>int</code> and the <code>char *</code> are the same size on my compilation.  When I used <code>int bar = (int16_t)foo;</code>, I received the same warning as you.  <a href=\"https://stackoverflow.com/a/48551585/2410359\">@Iharob Al Asimi</a> answer about the <i>potential UB</i>, not <i>certain UB</i> was very useful."}, {"owner": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 0, "creation_date": 1588065783, "post_id": 48551995, "comment_id": 108749679, "body": "The answer isn&#39;t sastified. What&#39;s about <code>char qux[]</code> ? Since isn&#39;t the pointer. if i try to print it with <code>%d</code> im going to get integer value like <code>-299211190</code>, what is that?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 1, "creation_date": 1588081613, "post_id": 48551995, "comment_id": 108758388, "body": "@TomSawyer <code>qux</code> as in <code>char qux[]=&quot;something&quot;;</code> is an <a href=\"https://cdecl.org/?q=char+qux%5B10%5D\" rel=\"nofollow noreferrer\">array 10 of char</a>.  With <code>printf(&quot;%d&quot;, qux);</code> converts the <code>qux</code> to the the address of <code>qux[0]</code> ( a <code>char</code> pointer) so it is like <code>printf(&quot;%d&quot;, &amp;qux[0]);</code>.  Printing a pointer with <code>&quot;%d&quot;</code> is undefined behavior.  Use  <code>printf(&quot;%p&quot;, qux);</code> to print a <code>char *</code> and see its address value."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1517435693, "last_edit_date": 1517435693, "creation_date": 1517435272, "answer_id": 48551995, "question_id": 48551525, "link": "https://stackoverflow.com/questions/48551525/how-does-int-casting-work-on-char-arrays-and-char/48551995#48551995", "title": "How does (int) casting work on char arrays and char *?", "body": "<p>Attempting to convert a pointer to some <em>integer</em> type can potentially cause <em>undefined behavior</em>  (UB).</p>\n\n<blockquote>\n  <p>Any pointer type may be converted to an integer type. Except as previously specified, the result is implementation-defined. <strong>If the result cannot be represented in the integer type, the behavior is undefined.*</strong>  ...  C11dr \u00a76.3.2.3 6</p>\n</blockquote>\n\n<p>The <code>(int)foo</code> can generate a warning like \"warning: cast from pointer to integer of different size\" because of that UB potential.  <a href=\"https://stackoverflow.com/questions/48551525/how-does-casting-work-on-char-arrays-and-string-literals/48551995#comment84100338_48551525\">@4386427</a></p>\n\n<pre><code>char* foo = \"baz\";\nint bar = (int)foo;  // potential UB.\n</code></pre>\n\n<hr>\n\n<p>To avoid that UB, when converting <em>object pointers</em> to integers,  (not <em>function pointers</em>), use the optional types  <code>uintptr_t</code> or <code>intptr_t</code>.</p>\n\n<blockquote>\n  <p>The following type designates an unsigned integer type with the property that any valid pointer to <code>void</code> can be converted to this type, then converted back to pointer to void, and the result will compare equal to the original pointer:</p>\n  \n  <p><code>uintptr_t</code><br>\n  7.20.1.4 1</p>\n</blockquote>\n\n<p>Example</p>\n\n<pre><code>#include &lt;inttypes.h&gt;\n\nsome_object* foo = ...;\nuintptr_t bar = (uintptr_t)(void*)foo;  // no UB\n\nprintf(\"0x%\" PRIXPTR \"\\n\", bar);\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>for a char array you always get some variable int value.</p>\n</blockquote>\n\n<p>That is because the conversion of the array, first converts to a pointer to the first element and then to the integer.  <code>int bar2 = (int)qux;</code> is trying to get the value of where the array exists, not its element values.</p>\n"}, {"comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1517440594, "post_id": 48552746, "comment_id": 84102487, "body": "Although POSIX does implicitly require function pointers to be convertible to <code>void*</code>. Other safe things to do with a <i>function</i> pointer include: <code>memcpy()</code> to an array of <code>unsigned char[sizeof((*void)(void))]</code> or <code>typedef void (*funcptr)(void)</code>."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517440653, "post_id": 48552746, "comment_id": 84102506, "body": "However, this question was specifically about <code>char*</code>. I&#39;ll add a qualifier."}], "tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 2, "last_activity_date": 1517440686, "last_edit_date": 1517440686, "creation_date": 1517438997, "answer_id": 48552746, "question_id": 48551525, "link": "https://stackoverflow.com/questions/48551525/how-does-int-casting-work-on-char-arrays-and-char/48552746#48552746", "title": "How does (int) casting work on char arrays and char *?", "body": "<p>The correct way to convert an object pointer <code>p</code> to an integral type is <code>(uintptr_t)(void*)p</code>, or <code>(intptr_t)(void*)p</code> if for some reason you want a signed type.  An <code>int</code> or <code>long</code> are frequently 32 bits wide on 64-bit targets, but <code>uintptr_t</code>, defined in <code>&lt;stdint.h&gt;</code>, is always the right size to hold a pointer. Technically, the standard only says that the conversion to and from <code>void*</code> is safe, hence the intermediate cast.</p>\n\n<p>This gets you a representation of the address of your string.  If what you really want is to read a number in ASCII format, you want something such as <code>atoi()</code> or <code>sscanf()</code>.</p>\n"}], "owner": {"reputation": 461, "user_id": 4796762, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4a766de954f2ddcd6444362a44045d18?s=128&d=identicon&r=PG", "display_name": "Andr&#233; Yuhai", "link": "https://stackoverflow.com/users/4796762/andr%c3%a9-yuhai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 1, "accepted_answer_id": 48551995, "answer_count": 4, "score": 2, "last_activity_date": 1517440686, "creation_date": 1517433142, "last_edit_date": 1517438071, "question_id": 48551525, "link": "https://stackoverflow.com/questions/48551525/how-does-int-casting-work-on-char-arrays-and-char", "title": "How does (int) casting work on char arrays and char *?", "body": "<p>Well, I believe I've searched enough and I couldn't find any explanation on this.</p>\n\n<p>When you cast a <code>char</code> to an <code>int</code>, that is okay and obvious.</p>\n\n<pre><code>char foo = 'a';\nint bar = (int)foo;\nprintf(\"%i\",bar); //Outputs 97 as expected.\n</code></pre>\n\n<p>But when you try to <code>cast</code> a <code>char *</code> or a <code>char</code> array to an <code>int</code>, the compiler just gives you a warning:  </p>\n\n<blockquote>\n  <p>warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]  </p>\n</blockquote>\n\n<p>For a <code>char *</code> you get a constant <code>int</code> value - I believe that has something to do with pointers or memory - then for a <code>char</code> array you always get some variable <code>int</code> value.</p>\n\n<pre><code>char* foo = \"baz\";\nint bar = (int)foo;\nprintf(\"%i\",bar);\n\nchar qux[]=\"something\";\nint bar2 = (int)qux;\nprintf(\"%i\",bar2);\n</code></pre>\n\n<p>This might sound like an unnecessary question but I would like to know the reason. </p>\n"}, {"tags": ["c", "stdin", "fgets"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1517432851, "post_id": 48551395, "comment_id": 84099018, "body": "In the first sample, the second input will overwrite the first input. That&#39;s the difference."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1517432865, "post_id": 48551395, "comment_id": 84099024, "body": "If code needs the result of the first to be preserved after reading the second, then use different buffers."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1517432925, "post_id": 48551395, "comment_id": 84099048, "body": "BTW, check the return value of <code>fgets()</code> before using the buffer."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 5, "last_activity_date": 1517433090, "creation_date": 1517433090, "answer_id": 48551513, "question_id": 48551395, "link": "https://stackoverflow.com/questions/48551395/how-fgets-really-works-to-read-from-stdin/48551513#48551513", "title": "How fgets() really works to read from stdin?", "body": "<p>The answer depends on your use-case. Both the usage maybe equally valid or invalid based on the retention requirement of your logic.</p>\n\n<ul>\n<li><p>In case, the control flow of your program is something like</p>\n\n<pre><code>read first input\n process first input, never need it after this\nread second input\n carry on\n</code></pre>\n\n<p>then you're okay with the first approach, reusing the same buffer.</p></li>\n<li><p>In case, you have to make use of the first input even after reading the second one, you need to preserve the first input, like</p>\n\n<pre><code>read first input\n process first input, but need it later also\nread second input\n carry on \n do something with first and second inputs\n</code></pre>\n\n<p>then, you need separate buffers.</p></li>\n</ul>\n"}], "owner": {"reputation": 91, "user_id": 9281565, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f085ac5e4599a737ee49754b33985c61?s=128&d=identicon&r=PG&f=1", "display_name": "OptatootatpO", "link": "https://stackoverflow.com/users/9281565/optatootatpo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 48551513, "answer_count": 1, "score": 3, "last_activity_date": 1517434263, "creation_date": 1517432670, "last_edit_date": 1517434263, "question_id": 48551395, "link": "https://stackoverflow.com/questions/48551395/how-fgets-really-works-to-read-from-stdin", "title": "How fgets() really works to read from stdin?", "body": "<p>So if I have to use <code>fgets()</code> twice to read two different input from the keyboard, should I specify two different buffers or just reuse the same one? What's the difference?  </p>\n\n<p>Use the same buffer:      </p>\n\n<pre><code>   char buffer[100];\n   fgets(buffer, sizeof(buffer), stdin);\n   fgets(buffer, sizeof(buffer), stdin);\n</code></pre>\n\n<p>Use the different buffers for different inputs: </p>\n\n<pre><code>   char buffer_x[100];\n   char buffer_y[100];\n   fgets(buffer_x , sizeof(buffer_x), stdin);\n   fgets(buffer_y , sizeof(buffer_y), stdin);\n</code></pre>\n"}, {"tags": ["c", "string", "pascal"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1517431799, "post_id": 48551148, "comment_id": 84098473, "body": "<code>I understand that an unsigned int ranges from 0~256</code>..most likely, much wider."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 4, "creation_date": 1517431851, "post_id": 48551148, "comment_id": 84098501, "body": "whos says 127 or less? Wikipedia says 255 <a href=\"https://en.wikipedia.org/wiki/String_(computer_science)#Length-prefixed\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/String_(computer_science)#Length-prefi&zwnj;&#8203;xed</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1517431908, "post_id": 48551148, "comment_id": 84098526, "body": "The question seems lacking in basis.  On what grounds do you assert that the original string length should not exceed 127 characters?  Does Pascal really place such a limitation, or is that tied to a particular implementation?  Or is it even a real requirement at all?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 3, "creation_date": 1517432446, "post_id": 48551148, "comment_id": 84098791, "body": "Common early implementations of Pascal on PCs stored strings preceded by a single-byte length (which was unsigned, so strings could have lengths from 0 to 255). This is not a limitation of the language itself."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1517473907, "post_id": 48551148, "comment_id": 84112414, "body": "&quot;Pascal string&quot; is not standardised and everyone talking about Pascal strings talks about something slightly different. <i>My</i> Pascal strings have 4 byte sizes."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1517480195, "post_id": 48551148, "comment_id": 84115948, "body": "@n.m. Using Delphi and FreePascal regularly, I can say the same, but &quot;Pascal string&quot; is what these languages call a <code>ShortString</code>: 256 bytes, of which the byte at index 0 is the length, and the other bytes contain the text. They are typically indexed 1..255. Some varieties do have ability to restrict those to less than 255 characters, e.g. to save space in a record with <code>string[18]</code>, which then is 19 bytes in size (1 byte length + max. 18 byte text)."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 2, "creation_date": 1517481775, "post_id": 48551148, "comment_id": 84117104, "body": "Where did you get that number 127? I don&#39;t know of any implementations that have that restriction, unless you means so called counted strings, but these have a fixed, explicitly declared size, e.g. <code>var x: string[31]</code>, and that size can be anything from 1 to 255."}, {"owner": {"reputation": 24405, "user_id": 99354, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b6ee96d3a17fcbd2bd24210eb7caf441?s=128&d=identicon&r=PG&f=1", "display_name": "Marco van de Voort", "link": "https://stackoverflow.com/users/99354/marco-van-de-voort"}, "edited": false, "score": 0, "creation_date": 1517763034, "post_id": 48551148, "comment_id": 84217518, "body": "In many context &quot;pascal strings&quot; are all stringtypes that can get the length and/or find the place to append in a O(1) matter. By that definition all FPC/Delphi &quot;string&quot; types are pascal strings. The TP string is usually refered to as TP string or shortstring."}], "answers": [{"comments": [{"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1517481634, "post_id": 48551447, "comment_id": 84116996, "body": "which Pascal do you know that has variable length size &quot;prefixes&quot; (most modern Pascals don&#39;t use prefixes anymore)?"}], "tags": [], "owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "is_accepted": false, "score": 1, "last_activity_date": 1517432878, "creation_date": 1517432878, "answer_id": 48551447, "question_id": 48551148, "link": "https://stackoverflow.com/questions/48551148/converting-c-strings-to-pascal-strings/48551447#48551447", "title": "Converting C strings to Pascal strings", "body": "<p>FreePascal's wiki has a great page showing all the types of strings that Pascal (at least that implementation) supports: <a href=\"http://wiki.freepascal.org/Character_and_string_types\" rel=\"nofollow noreferrer\">http://wiki.freepascal.org/Character_and_string_types</a> - it includes length-prefixed and null-terminated string types. None of the types on that page have a length restriction of 127.</p>\n\n<p>The string type you're referring to would match <code>ShortString</code> which has a single byte prefix, however their documentation states it accepts 0-255.</p>\n\n<p>I am aware of a string-type that has a <em><a href=\"https://en.wikipedia.org/wiki/Variable-length_quantity\" rel=\"nofollow noreferrer\">variable-length-integer</a></em> prefix, which would restrict the length of the string to 127 characters if you want the in-memory representation to be binary-compatible with <code>ShortString</code>, as being 128 characters or longer would set the MSB bit to <code>1</code> which in variable-length-integers means the integer is at least 2 bytes long instead of 1 byte.</p>\n"}, {"tags": [], "owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "is_accepted": false, "score": 2, "last_activity_date": 1517480896, "last_edit_date": 1517480896, "creation_date": 1517472878, "answer_id": 48558092, "question_id": 48551148, "link": "https://stackoverflow.com/questions/48551148/converting-c-strings-to-pascal-strings/48558092#48558092", "title": "Converting C strings to Pascal strings", "body": "<p>The Pascal string you are referring to is probably the one used in older Pascals (called <code>ShortString</code> in e.g. Delphi and FreePascal, the most popular Pascal implementations these days). That can contain 255 single-byte characters (<code>char</code> in C). <strong>There is no need to restrict this to 127 characters</strong>.</p>\n\n<p><em>Perhaps you were thinking of the fact that 255 bytes can only contain 127 UTF-16 code points. But these strings were popular in the old CP/M and DOS days, when no one knew anything about Unicode yet, and were made to contain ASCII or \"Extended ASCII\" (8 bit, using code pages).</em></p>\n\n<p>But most modern Pascal implementations allow you to use strings up to 2 GB in size. There, the length indicator is not stored as the first element anymore, just close to the text data. And these days, most of these strings can contain Unicode too, either as UTF-16 or as UTF-8, depending on the string type you choose (modern Pascal implementations have several <em>different</em> string types for different purposes, so there is not one single \"Pascal string type\" anymore).</p>\n\n<p>Some languages do have the ability to restrict the size of a <code>ShortString</code>, as so called \"counted\" strings:</p>\n\n<pre><code>var\n  s: string[18];\n</code></pre>\n\n<p>That string has a maximum of 18 bytes text data and 1 byte length data (at index 0). Such shorter strings can be used in, say, records, so they don't grow too big.</p>\n"}], "owner": {"reputation": 11, "user_id": 7800299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86f2ce876c01fd4f9bf6976aec59800?s=128&d=identicon&r=PG&f=1", "display_name": "S. Morgan", "link": "https://stackoverflow.com/users/7800299/s-morgan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1517480896, "creation_date": 1517431630, "question_id": 48551148, "link": "https://stackoverflow.com/questions/48551148/converting-c-strings-to-pascal-strings", "title": "Converting C strings to Pascal strings", "body": "<p>When converting a C string into a Pascal string, why should the length of the original string be less or equal to 127 instead of 256? I understand that an unsigned int ranges from 0~256 and a signed one ranges from -128~127, but isn't the first character of a Pascal string unsigned?</p>\n"}, {"tags": ["c", "linux", "memory", "enums"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1517431062, "post_id": 48550984, "comment_id": 84098115, "body": "If you click on <code>NR_LRU_LISTS</code> you get a page with references to all files using that. It is defined in <a href=\"http://elixir.free-electrons.com/linux/v4.15/source/include/linux/mmzone.h#L205\" rel=\"nofollow noreferrer\">mmzone.h</a>. And <code>totalram_pages</code> seems to be declared in <a href=\"http://elixir.free-electrons.com/linux/v4.15/source/mm/page_alloc.c#L220\" rel=\"nofollow noreferrer\">page_alloc.c</a>"}, {"owner": {"reputation": 133, "user_id": 3755746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c6ef3fd45b1c7e3c389b81da7e1d7cb2?s=128&d=identicon&r=PG&f=1", "display_name": "X.LINK", "link": "https://stackoverflow.com/users/3755746/x-link"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1517431148, "post_id": 48550984, "comment_id": 84098160, "body": "Oh, sorry if I wasn&#39;t clear. By set I meant that their values are set like <code>NR_LRU_LISTS = 574934</code> for instance. What I understood there is that &#39;LRU_ACTIVE_FILE` equals <code>3</code>, but there&#39;s no <code>=</code> operator in front of <code>NR_LRU_LISTS</code>."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 3755746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c6ef3fd45b1c7e3c389b81da7e1d7cb2?s=128&d=identicon&r=PG&f=1", "display_name": "X.LINK", "link": "https://stackoverflow.com/users/3755746/x-link"}, "edited": false, "score": 0, "creation_date": 1517432572, "post_id": 48551217, "comment_id": 84098866, "body": "My goal wasn&#39;t about learning C first, but I had no choice to learn it enough to understand how /proc/meminfo values are calculated. So I was missing that... which means <code>NR_LRU_LISTS</code> equals <code>5</code> then. Besides, does <code>totalram_pages</code> in <code>si_meminfo()</code> is a global variable since I couldn&#39;t find any initialization for it ? I know I&#39;m going the -very hard- way for everyone including people who may help me (since I&#39;m learning C), but I do really want to know how /proc/meminfo got its values."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 133, "user_id": 3755746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c6ef3fd45b1c7e3c389b81da7e1d7cb2?s=128&d=identicon&r=PG&f=1", "display_name": "X.LINK", "link": "https://stackoverflow.com/users/3755746/x-link"}, "edited": false, "score": 2, "creation_date": 1517432981, "post_id": 48551217, "comment_id": 84099081, "body": "Yes, <code>NR_LRU_LISTS</code> equals 5.   I&#39;ll add some discussion of <code>totalram_pages</code> to the answer."}, {"owner": {"reputation": 133, "user_id": 3755746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c6ef3fd45b1c7e3c389b81da7e1d7cb2?s=128&d=identicon&r=PG&f=1", "display_name": "X.LINK", "link": "https://stackoverflow.com/users/3755746/x-link"}, "edited": false, "score": 0, "creation_date": 1517433838, "post_id": 48551217, "comment_id": 84099519, "body": "Thanks for the edit and reply. Besides, I heard that some IDE could do the tracking by doing <code>ctrl + Mouse 1</code>, but the most popular one seems to be IntelliJ, which is meant for Java. Do you have any IDE that can do the same for C codes ?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 133, "user_id": 3755746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c6ef3fd45b1c7e3c389b81da7e1d7cb2?s=128&d=identicon&r=PG&f=1", "display_name": "X.LINK", "link": "https://stackoverflow.com/users/3755746/x-link"}, "edited": false, "score": 1, "creation_date": 1517434303, "post_id": 48551217, "comment_id": 84099739, "body": "Sorry, I don&#39;t use any IDE myself; I&#39;ve never found one that could keep up with my typing.  I investigate these things with command line tools like <code>find</code> and <code>grep</code>, and online cross-references like the one you linked to."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 2, "creation_date": 1517434560, "post_id": 48551217, "comment_id": 84099880, "body": "With <a href=\"http://ctags.sourceforge.net/\" rel=\"nofollow noreferrer\">exuberant ctags</a> you can create a database file (called ctags) that has information about where functions, variables, macros are declared, etc. Programs like <code>vim</code> (and I also thing emacs) read these files so you can jump between the functions and definitions. In case of vim by putting the cursor on the function you want to inspect and pressing <code>ctrl+]</code>."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 3, "last_activity_date": 1517435101, "last_edit_date": 1517435101, "creation_date": 1517431933, "answer_id": 48551217, "question_id": 48550984, "link": "https://stackoverflow.com/questions/48550984/where-are-enum-for-meminfo-proc-show-and-variables-for-si-meminfo-set/48551217#48551217", "title": "Where are enum for meminfo_proc_show() and variables for si_meminfo() set?", "body": "<p>The constants you are asking about are defined using C's \"<a href=\"http://en.cppreference.com/w/c/language/enum\" rel=\"nofollow noreferrer\">enum</a>\" feature.</p>\n\n<pre><code>enum Foo { A = 4, B, C };\n</code></pre>\n\n<p>declares constants named <code>A</code>, <code>B</code>, and <code>C</code> with values 4, 5, 6 respectively.</p>\n\n<p>Each constant with no initializer is set to one more than the previous constant.  If the first constant in an <code>enum</code> declaration has no initializer it is set to zero.</p>\n\n<p>The <em>variables</em> you are asking about are defined with no initializer, at file scope (that is, outside of any function).  For instance, <code>totalram_pages</code> is defined <a href=\"http://elixir.free-electrons.com/linux/v4.15/source/mm/page_alloc.c#L128\" rel=\"nofollow noreferrer\">on line 128 of <code>page_alloc.c</code></a>, with a public declaration for use throughout the kernel <a href=\"http://elixir.free-electrons.com/linux/v4.15/source/include/linux/mm.h#L50\" rel=\"nofollow noreferrer\">on line 50 of <code>linux/mm.h</code></a>.  Because they are defined at file scope and they don't have initializers, they are initialized to zero at program start.  (This is a crucial difference from variables defined <em>inside</em> a function with no initializers.  Those start off with \"indeterminate\" values, reading which provokes undefined behavior.)</p>\n\n<p>I do not know how <code>totalram_pages</code> receives a <em>meaningful</em> value.  This code is too complicated for me to want to track that down right now.</p>\n\n<p>It sounds like you are just beginning to learn C.  Studying other people's code is a good way to learn, but you should start with <em>simple</em> programs.  The Linux kernel is not simple, and because it's an operating system kernel, it also does a lot of things that would be considered bad style or just plain wrong in any other program.  Don't start with it.</p>\n\n<p>... That said, declaring a bunch of related constants using an <code>enum</code> and letting them take sequential values implicitly is totally normal and good style, and so is defining variables at file scope with no initializer and relying on them to be zero at program start.  (It is often wrong to have a global variable in the first place, but if you genuinely need one, relying on implicit initialization to zero is not wrong.)  These are things you need to understand and things you are likely to want to do yourself in due course.</p>\n"}], "owner": {"reputation": 133, "user_id": 3755746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c6ef3fd45b1c7e3c389b81da7e1d7cb2?s=128&d=identicon&r=PG&f=1", "display_name": "X.LINK", "link": "https://stackoverflow.com/users/3755746/x-link"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1517484949, "creation_date": 1517430821, "last_edit_date": 1517484949, "question_id": 48550984, "link": "https://stackoverflow.com/questions/48550984/where-are-enum-for-meminfo-proc-show-and-variables-for-si-meminfo-set", "title": "Where are enum for meminfo_proc_show() and variables for si_meminfo() set?", "body": "<p>I am not a developer but I understand some C concepts. However, I'm having a hard time finding where the enums (e.g <code>NR_LRU_LISTS</code>, etc) in <a href=\"http://elixir.free-electrons.com/linux/v4.15/source/fs/proc/meminfo.c#L46\" rel=\"nofollow noreferrer\">meminfo.c/meminfo_proc_show()</a> and the variables (e.g. totalram_pages, etc) in <a href=\"http://elixir.free-electrons.com/linux/v4.15/source/mm/page_alloc.c#L4673\" rel=\"nofollow noreferrer\">page_alloc.c/si_meminfo()</a> are set.</p>\n\n<p>What I meant by set is for example <code>NR_LRU_LISTS = 324077</code> for instance. What I understood there is that <code>LRU_ACTIVE_FILE</code> equals <code>3</code>, but there's no <code>=</code> operator in front of <code>NR_LRU_LISTS</code>, so it must be set somewhere else.</p>\n\n<p>I've clicked on the enums/variables to see where they may be called, but there's either too much unrelevant or either non-defining references.</p>\n\n<p>The last thing would be me not being aware of something, but what ?</p>\n\n<p>To be honest, my goal here is to determine how /proc/meminfo 's values are calculated.</p>\n\n<p>But, here my question is: Where do these enums and variables are set ?</p>\n\n<hr>\n\n<p><strong>Update 1</strong>:</p>\n\n<p>The enums part is now solved, and <code>NR_LRU_LISTS</code> equals <code>5</code>.</p>\n\n<p>But the <code>totalram_pages</code> part seems to be harder to find out...</p>\n"}, {"tags": ["c", "bash"], "comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1517432283, "post_id": 48550974, "comment_id": 84098710, "body": "The <code>printf</code> is inside the loop, so it&#39;s going to print the count so far every time it reads a character. Incidentally, the fact that you used Pico to edit the source file has nothing to do with the problem."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1517441314, "post_id": 48550974, "comment_id": 84102711, "body": "CORRECTION: You print the line number every time you read a <code>&#39;\\n&#39;</code> character, not every time you read a character. So if the input is 3 lines, it will print three lines of output: <code>1</code>, <code>2</code>, and <code>3</code>. Each line number is followed by the <code>&#39;\\n&#39;</code> character you just read, but you never print any other characters from the input."}], "owner": {"reputation": 23, "user_id": 8961589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0d25ee3ddf1902eda877d88c9ac5042?s=128&d=identicon&r=PG&f=1", "display_name": "maritaslag", "link": "https://stackoverflow.com/users/8961589/maritaslag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 549, "favorite_count": 0, "closed_date": 1517432792, "answer_count": 0, "score": 1, "last_activity_date": 1517432664, "creation_date": 1517430768, "last_edit_date": 1517432664, "question_id": 48550974, "link": "https://stackoverflow.com/questions/48550974/command-not-found-trying-to-run-my-c-program-by-typing-its-name-at-the-termina", "closed_reason": "Duplicate", "title": "&quot;Command not found&quot; trying to run my C program by typing its name at the terminal", "body": "<p>So I wrote this code using PICO through my terminal...</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint main()\n{\n    int lineCount =0;\n    int c;\n\n    while((c=getchar()) != EOF)\n    {\n            if (c=='\\n'){\n            ++lineCount;\n\n            printf(\"%d\\t%c\",lineCount,c);\n            }\n    }\n    exit(0);\n}\n\n/*print out the \"c\" which is the words you want to print and then print out \nthe line number before every new line, think of %d as placeholder */\n</code></pre>\n\n<p>So now I want to use this code and apply it to a \"hello world\" script in C. In my terminal, I have both <code>line_number</code> and hello world files compiled and in 1 folder. I go to the folder and type out <code>line_number &lt; hello.c</code> and it gives me an error...</p>\n\n<pre><code>-bash: line_number: command not found\n</code></pre>\n\n<p>my goal is to apply my line number code to my hello world script so that each line of my hello world code has a number in the beginning. My line_number code might also be faulty but if I can get help on getting the command to execute I can resolve the bugs and formatting through trial and error.</p>\n"}, {"tags": ["java", "c++", "c", "operating-system"], "comments": [{"owner": {"reputation": 496316, "user_id": 57695, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=128&d=identicon&r=PG", "display_name": "Peter Lawrey", "link": "https://stackoverflow.com/users/57695/peter-lawrey"}, "edited": false, "score": 0, "creation_date": 1517430615, "post_id": 48550861, "comment_id": 84097896, "body": "File Descriptor 1 is created for the process before it starts, and anything written to that is written to the standard output."}, {"owner": {"reputation": 18530, "user_id": 3344003, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/988af95d5692ee66b1fc2fe725ba738e?s=128&d=identicon&r=PG&f=1", "display_name": "user3344003", "link": "https://stackoverflow.com/users/3344003/user3344003"}, "edited": false, "score": 0, "creation_date": 1517448351, "post_id": 48550861, "comment_id": 84104377, "body": "The answer is highly system specific. These days most people are used to Windoze and Eunuch-style brain damaged I/O that is highly limited."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 3677837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3908209c0e0da4c6bb3d0ed2dcbce9?s=128&d=identicon&r=PG&f=1", "display_name": "Prakhar", "link": "https://stackoverflow.com/users/3677837/prakhar"}, "edited": false, "score": 0, "creation_date": 1517605570, "post_id": 48551258, "comment_id": 84178911, "body": "Thanks for your explanation. First I could not understand all this. But after looking at various blogs, now I understood what you meant. It was high level explanation for me but to the point."}], "tags": [], "owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "is_accepted": false, "score": 5, "last_activity_date": 1517432139, "creation_date": 1517432139, "answer_id": 48551258, "question_id": 48550861, "link": "https://stackoverflow.com/questions/48550861/standard-stream-and-operating-systems/48551258#48551258", "title": "Standard Stream and Operating Systems", "body": "<h3>Definitions</h3>\n\n<p>A \u201cstream\u201d is a catch-all word, like \u201cwindow\u201d. All a stream means is that there is some thing (a \u201cdevice\u201d) that produces sequential data or accepts sequential data.</p>\n\n<p>For example, I can make a string into an input stream (produces data), by simply keeping track of what the next character to produce is. When we run out of characters, we've reached the end of the stream. C++:</p>\n\n<pre><code>struct my_hello_stream\n{\n  static const char* s = \"Hello world!\";\n  int n;\n  my_stream(): n(0) {}\n\n  int get()\n  {\n    if (s[n]) return s[n++];\n    return EOF;\n  }\n};\n</code></pre>\n\n<h3>Abstractions</h3>\n\n<p>Every system has its own way of abstracting a stream. The OS does it through <em>files</em>, <em>pipes</em> and <em>character devices</em>, which you can open for reading or writing. How exactly this is done depends entirely on the design of the OS. Consult your OS API documentation.</p>\n\n<p>On top of that sits a programming language, like C or C++ or Java or FORTRAN \u2014 you name it. The programming language itself <em>also</em> defines a stream in a way convenient for the users of that language. In C you have a <code>FILE*</code>. In C++ you have <code>std::iostream</code>s. In Java you have <a href=\"https://docs.oracle.com/javase/tutorial/essential/io/\" rel=\"noreferrer\">I/O streams</a>. Whatever the case, this works above the OS stream to read and write data from and to files, etc.</p>\n\n<p>Moreover, these language features often allow you to do more powerful things with these stream interfaces, such as convert the character sequence <code>1234567</code> into a native integer value, and to perform these operations over strings.</p>\n\n<p>Beyond that, there are also external libraries that allow us to treat things like internet connections and port connections with the printer like a stream. Some of this stuff the OS handles for us. Some of it it doesn't.</p>\n\n<h3>tl;dr</h3>\n\n<p>It all depends. What matters is the <em>abstraction</em> you have access to \u2014 which is typically your programming language. Hence, read about how your programming language expects you to open a file and read and write data, then act as if that is right. Whatever else actually happens underneath is magic.</p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 3677837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3908209c0e0da4c6bb3d0ed2dcbce9?s=128&d=identicon&r=PG&f=1", "display_name": "Prakhar", "link": "https://stackoverflow.com/users/3677837/prakhar"}, "edited": false, "score": 0, "creation_date": 1517518665, "post_id": 48564624, "comment_id": 84139854, "body": "I have one more question, Is it like System.in read from a device( and that part is abstracted and use System calls like read(OS dependent)) and then when we use read(), we read from the System.in stream? Or System.in.read() invokes the system call? Please take a look at this link: <a href=\"http://journals.ecs.soton.ac.uk/java/tutorial/java/nutsandbolts/inputOutput.html\" rel=\"nofollow noreferrer\">journals.ecs.soton.ac.uk/java/tutorial/java/nutsandbolts/&hellip;</a>"}, {"owner": {"reputation": 2952, "user_id": 4413098, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a944fcc2691378e0c49b5c564bd55d2?s=128&d=identicon&r=PG&f=1", "display_name": "mightyWOZ", "link": "https://stackoverflow.com/users/4413098/mightywoz"}, "reply_to_user": {"reputation": 73, "user_id": 3677837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3908209c0e0da4c6bb3d0ed2dcbce9?s=128&d=identicon&r=PG&f=1", "display_name": "Prakhar", "link": "https://stackoverflow.com/users/3677837/prakhar"}, "edited": false, "score": 0, "creation_date": 1517545655, "post_id": 48564624, "comment_id": 84147928, "body": "I don&#39;t think i understand first part of your question but answer to the second part is yes."}, {"owner": {"reputation": 73, "user_id": 3677837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3908209c0e0da4c6bb3d0ed2dcbce9?s=128&d=identicon&r=PG&f=1", "display_name": "Prakhar", "link": "https://stackoverflow.com/users/3677837/prakhar"}, "edited": false, "score": 0, "creation_date": 1517586401, "post_id": 48564624, "comment_id": 84169288, "body": "First part is regarding the link and your answer, in that link it is mentioned that Input stream reads the data coming from the device and then our program reads the bytes/ characters from that Input Stream when we use Syste.in.read method. So that suggests that it is a two step process."}, {"owner": {"reputation": 73, "user_id": 3677837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3908209c0e0da4c6bb3d0ed2dcbce9?s=128&d=identicon&r=PG&f=1", "display_name": "Prakhar", "link": "https://stackoverflow.com/users/3677837/prakhar"}, "edited": false, "score": 0, "creation_date": 1517588428, "post_id": 48564624, "comment_id": 84170585, "body": "Suppose I am entering Input &quot;Hi&quot;, then according to that link, first Input Stream would read the input from device and this step itself would make system call(read function of OS) and then in the second step when we call System.in.read() of Java I/O API then we would read from InputStream. So is it a 2 step process? Or it is a single step process i.e. when we call System.in.read() then itself system call would be invoked to read the input from device?"}], "tags": [], "owner": {"reputation": 2952, "user_id": 4413098, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a944fcc2691378e0c49b5c564bd55d2?s=128&d=identicon&r=PG&f=1", "display_name": "mightyWOZ", "link": "https://stackoverflow.com/users/4413098/mightywoz"}, "is_accepted": false, "score": 0, "last_activity_date": 1517493917, "creation_date": 1517493917, "answer_id": 48564624, "question_id": 48550861, "link": "https://stackoverflow.com/questions/48550861/standard-stream-and-operating-systems/48564624#48564624", "title": "Standard Stream and Operating Systems", "body": "<p><strong>What is a stream?</strong></p>\n\n<p>Stream is an abstraction which is either an input source or an output destination. In UNIX for example everything is a file so your keyboard will be represented by a read only file (why?). Whenever you want to read something from keyboard you just use the read system call using the keyboard file as parameter.</p>\n\n<blockquote>\n  <p>Does OS(i.e Windows) provide a Common Standard Input Stream and all\n  the languages use it(i.e. Java refers to it as System.in and same\n  Standard Input Stream is referred with stdin in c)?</p>\n</blockquote>\n\n<p>OS only provides the very basic functionality such as read and write system calls (OS dependent) which can be used to read and write raw bytes. All the programming languages use this basic functionality to create abstractions (such as translating raw bytes to certain character set or buffering the data before writing).</p>\n"}], "owner": {"reputation": 73, "user_id": 3677837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3908209c0e0da4c6bb3d0ed2dcbce9?s=128&d=identicon&r=PG&f=1", "display_name": "Prakhar", "link": "https://stackoverflow.com/users/3677837/prakhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1517493917, "creation_date": 1517430291, "question_id": 48550861, "link": "https://stackoverflow.com/questions/48550861/standard-stream-and-operating-systems", "title": "Standard Stream and Operating Systems", "body": "<p>I am very much confused about Streams.</p>\n\n<p>1) Does OS(i.e Windows) provide a Common Standard Input Stream and all the languages use it(i.e. Java refers to it as System.in and same Standard Input Stream is referred with stdin in c)?</p>\n\n<p>Is it like keyboard has some port or physical address and OS has stored that\nin some variable and when a program needs that it will give that same address to stdin or System.in depending on the language?</p>\n\n<p>OR,</p>\n\n<p>2) Is it like each language has its own API written for standard streams and when we run the program, a stream will get connected to the input device?</p>\n\n<p>And what information that stream would have apart from data? i.e. Physical Port or address of device or what?</p>\n\n<p>Also, Please tell about what is the meaning of System.in get \"connected\" to program when we run it. what does \"connected\" mean here?</p>\n\n<p>Please share some link.</p>\n"}, {"tags": ["c", "pointers", "avl-tree"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1517429953, "post_id": 48550741, "comment_id": 84097547, "body": "One way to isolate problems here is to use a unit testing system to define simple test cases and ensure that the functions you&#39;re using actually do what&#39;s advertised under the different scenarios they&#39;re expected to handle. This is just a chunk of code, no explanation, so it&#39;s a debugging problem. If you had a specific test failure you&#39;d have a specific problem to investigate."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517430117, "post_id": 48550741, "comment_id": 84097647, "body": "<code>Node *rebalance(Node **node)</code> does not <code>return</code>a value on some paths (see <code>&#47;&#47;right right</code>).  Save time: Enable all compiler warnings."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517430509, "post_id": 48550741, "comment_id": 84097828, "body": "Why did you  not post the definition of <code>Node</code> and <code>retrace()</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1517430569, "post_id": 48550741, "comment_id": 84097866, "body": "&quot;However, that didn\u2019t seem to work&quot; --&gt; There is no <code>main()</code> to call <code>rebalance()</code>.  Post lacks a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>,"}], "owner": {"reputation": 37, "user_id": 6606390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/575793fa80146d3b95dfbec4e43e13d5?s=128&d=identicon&r=PG&f=1", "display_name": "Xenu&#39;s Prophet", "link": "https://stackoverflow.com/users/6606390/xenus-prophet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517429810, "creation_date": 1517429810, "question_id": 48550741, "link": "https://stackoverflow.com/questions/48550741/c-pointer-refuses-to-reassign", "title": "C pointer refuses to reassign", "body": "<p>I am writing an AVL tree in C, with each node keeping record of both its height and balance factor. I\u2019ve encountered on odd bug when performing rotations. My rebalance function climbs the tree until it finds the root node or an unbalanced node, then checks the balance factors to figure out which rotations it needs to perform. The rotation functions take in double pointers and reassign the dereferenced node they were given. However, that didn\u2019t seem to work, so for good measure I also made the functions return the node that took the original node\u2019s place. This doesn\u2019t seem to work either, which I don\u2019t understand. On lines 164 and 171, I\u2019m explicitly assigning the node\u2019s child to the rotation function\u2019s return value (which is what its new node will be.)</p>\n\n<p>My rotation functions:</p>\n\n<pre><code>Node *rotateRight(Node **root) {\n    Node *node = *root;\n    Node *pivot = node-&gt;left; //pivot will become the new root\n    if(node-&gt;parent) {\n        Node *g = node-&gt;parent;\n        pivot-&gt;parent = node-&gt;parent;\n        if(pivot-&gt;datum &lt; g-&gt;datum) g-&gt;left = pivot;\n        else g-&gt;right = pivot;\n    } else\n        pivot-&gt;parent = NULL;\n    node-&gt;parent = node-&gt;left;\n    node-&gt;left = pivot-&gt;right? pivot-&gt;right : NULL;\n    pivot-&gt;right = node;\n    *root = node-&gt;parent;\n    return pivot;\n}\n\nNode *rotateLeft(Node **root) {\n    Node *node = *root;\n    Node *pivot = node-&gt;right;\n    if(node-&gt;parent) {\n        Node *g = node-&gt;parent;\n        pivot-&gt;parent = node-&gt;parent;\n        if(pivot-&gt;datum &lt; g-&gt;datum) g-&gt;left = pivot;\n        else g-&gt;right = pivot;\n    } else\n        pivot-&gt;parent = NULL;\n    node-&gt;parent = pivot;\n    node-&gt;right = pivot-&gt;left? pivot-&gt;left : NULL;\n    pivot-&gt;left = node;\n    *root = node-&gt;parent;\n    return pivot;\n}\n</code></pre>\n\n<p>My rebalance function (retrace just finds the root of the tree):</p>\n\n<pre><code>Node *rebalance(Node **node) {\n    if(-1 &lt;= (*node)-&gt;bal &amp;&amp; (*node)-&gt;bal &lt;= 1) { //current node is balanced, we can ascend and check the next node\n        if((*node)-&gt;parent) rebalance(&amp;((*node)-&gt;parent));\n        return retrace(*node);\n    }\n    if((*node)-&gt;bal == 2) {\n        if((*node)-&gt;left-&gt;bal == 1) { //left left\n            puts(\"ll\");\n            rotateRight(node);\n            return retrace(*node);\n        } else { //left right\n            puts(\"lr\");\n            (*node)-&gt;left = rotateLeft(&amp;((*node)-&gt;left));\n            rotateRight(node);\n            return retrace(*node);\n        }\n    } else {\n        if((*node)-&gt;right-&gt;bal == 1) { //right left\n            puts(\"rl\");\n            (*node)-&gt;right = rotateRight(&amp;((*node)-&gt;right));\n            rotateLeft(node);\n            return retrace(*node);\n        } else { //right right\n            puts(\"rr\");\n            rotateLeft(node);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 1, "creation_date": 1517429290, "post_id": 48550588, "comment_id": 84097200, "body": "And where is the code for <code>to_lower_case</code>?"}, {"owner": {"reputation": 1119, "user_id": 6797534, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Tu8Gt9iJGt8/AAAAAAAAAAI/AAAAAAAAAI0/Diz261BzMYk/photo.jpg?sz=128", "display_name": "Ray Hamel", "link": "https://stackoverflow.com/users/6797534/ray-hamel"}, "edited": false, "score": 6, "creation_date": 1517429331, "post_id": 48550588, "comment_id": 84097225, "body": "Modifying a string literal is undefined behavior (so, you should never assign a string literal to a <code>char*</code>). Instead declare the variable as a char array, which <i>copies</i> the string literal: <code>char s[] = &quot;the string literal&quot;;</code>"}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1517429385, "post_id": 48550588, "comment_id": 84097251, "body": "Also, <code>void</code> main? Are you planning to learn <code>premature C</code> then unlearn it to learn latest standards?"}, {"owner": {"reputation": 33, "user_id": 9043599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/424663a0a5b8e1e0ba353304fffb6440?s=128&d=identicon&r=PG&f=1", "display_name": "Nerd", "link": "https://stackoverflow.com/users/9043599/nerd"}, "edited": false, "score": 0, "creation_date": 1517429522, "post_id": 48550588, "comment_id": 84097314, "body": "There&#39;s nothing wrong about a void main."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1517429607, "post_id": 48550588, "comment_id": 84097357, "body": "@Nerd: See <a href=\"https://stackoverflow.com/questions/204476/\">What should <code>main()</code> return in C and C++?</a> for a complete disquisition on why <code>void main()</code> is only faintly acceptable on MS Windows and essentially nowhere else."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1517429829, "post_id": 48550588, "comment_id": 84097472, "body": "Note: finding the dupe was easy - I copypasted your exact title into a popular search engine and got: &#39;About 1,140,000 results&#39;, with the dupe as top entry:("}, {"owner": {"reputation": 33, "user_id": 9043599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/424663a0a5b8e1e0ba353304fffb6440?s=128&d=identicon&r=PG&f=1", "display_name": "Nerd", "link": "https://stackoverflow.com/users/9043599/nerd"}, "edited": false, "score": 0, "creation_date": 1517429911, "post_id": 48550588, "comment_id": 84097522, "body": "I&#39;ll accept it as dupe. Sorry."}], "answers": [{"comments": [{"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1517429527, "post_id": 48550634, "comment_id": 84097316, "body": "Well, are you sure this is the issue? This could be, but everything <code>to_lower_case()</code> does is still under the hoods.."}, {"owner": {"reputation": 33, "user_id": 9043599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/424663a0a5b8e1e0ba353304fffb6440?s=128&d=identicon&r=PG&f=1", "display_name": "Nerd", "link": "https://stackoverflow.com/users/9043599/nerd"}, "edited": false, "score": 0, "creation_date": 1517429686, "post_id": 48550634, "comment_id": 84097401, "body": "This was the issue, although I should&#39;ve included the code for the lower case function aswell."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1517429755, "post_id": 48550634, "comment_id": 84097431, "body": "@sjsam yes I&#39;m sure, even without knowing what <code>to_lower_case()</code> does. This is a common pitfall for beginners. Non-beginner do not make this mistake."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 2, "last_activity_date": 1517429344, "creation_date": 1517429344, "answer_id": 48550634, "question_id": 48550588, "link": "https://stackoverflow.com/questions/48550588/modifying-a-string-in-a-function-in-c/48550634#48550634", "title": "Modifying a string in a function in C", "body": "<p>This is the problem</p>\n\n<pre><code>char* s = \"aBCde F. hjiodhfvev, . efof Gh\";\n</code></pre>\n\n<p>String literals (the ones in quotes) are read-only. You cannot modify them.</p>\n\n<p>You should declare it as</p>\n\n<pre><code>char s[] = \"aBCde F. hjiodhfvev, . efof Gh\";\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1517429976, "post_id": 48550701, "comment_id": 84097560, "body": "<code>malloc(s_length + 1)</code> for the trailing 0 character!"}], "tags": [], "owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "is_accepted": false, "score": 1, "last_activity_date": 1517430622, "last_edit_date": 1517430622, "creation_date": 1517429631, "answer_id": 48550701, "question_id": 48550588, "link": "https://stackoverflow.com/questions/48550588/modifying-a-string-in-a-function-in-c/48550701#48550701", "title": "Modifying a string in a function in C", "body": "<p>Correct. Strings provided as string-literals are read-only. You will need to copy the string to mutable memory first:</p>\n\n<pre><code>char* s_readonly = \"foobar\";\nsize_t s_length = strlen( s_readonly );\nchar* s_mutable = malloc( s_length + 1 );\nassert( s_mutable );\nerrno_t err = strcopy_s( s_mutable, s_length, s_readonly );\nassert( err == 0 );\nto_lower_case( s_mutable ); \nputs( s_mutable );\nfree( s_mutable );\n</code></pre>\n\n<ul>\n<li>My code performs an explicit copy to the heap. This code could be made simpler by assigning the string literal to a <code>char[n]</code>-type. This has the advantage of allowing static <code>sizeof()</code> to work which is faster <code>O(1)</code> than <code>strlen</code> which is <code>O(n)</code>.</li>\n<li><code>printf(\"%s\\n\", s)</code> can be replaced with <code>puts</code> which is faster as there's no format-string to parse.</li>\n<li>I use <code>strcopy_s</code> over the insecure <code>strcopy</code>. Always check the returned error code!</li>\n<li>And always call <code>free</code> after <code>malloc</code>. If you're dealing with short strings you could use <code>alloca</code> instead which is faster and doesn't require the use of <code>free</code>.</li>\n</ul>\n\n<p>Alternatively, just this:</p>\n\n<pre><code>char s_mutable[] = \"foobar\";\nto_lower_case( s_mutable ); \nputs( s_mutable );\n</code></pre>\n\n<p>The advantage here (besides terseness) is that <code>s_mutable</code> is mutable right away, and it means that <code>sizeof( s_mutable ) == 12</code>.</p>\n"}], "owner": {"reputation": 33, "user_id": 9043599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/424663a0a5b8e1e0ba353304fffb6440?s=128&d=identicon&r=PG&f=1", "display_name": "Nerd", "link": "https://stackoverflow.com/users/9043599/nerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1517429917, "answer_count": 2, "score": 0, "last_activity_date": 1517430622, "creation_date": 1517429149, "last_edit_date": 1517429332, "question_id": 48550588, "link": "https://stackoverflow.com/questions/48550588/modifying-a-string-in-a-function-in-c", "closed_reason": "Duplicate", "title": "Modifying a string in a function in C", "body": "<p>I'm trying to figure out why this doesn't work, but I'm not really sure. </p>\n\n<pre><code>void main(void){\u00a0\n    char* s = \"aBCde F. hjiodhfvev, . efof Gh\";\n    to_lower_case(s); \n    printf(\"%s\",s); \n}\n</code></pre>\n\n<p>The function <code>to_lower_case()</code> is just a random function that does what its name suggests. I guess it has something to do with the string being declared as a <code>constant</code>.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1517427944, "post_id": 48550232, "comment_id": 84096504, "body": "Likely related: <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong?rq=1\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1517428263, "post_id": 48550232, "comment_id": 84096673, "body": "You should check the return status of <code>fscanf</code> instead. If the end of file is reached, <code>fscanf</code> will return  <code>EOF</code>. See the <b>RETURN VALUE</b> of <a href=\"https://linux.die.net/man/3/scanf\" rel=\"nofollow noreferrer\">man fscanf</a>"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1517428272, "post_id": 48550232, "comment_id": 84096676, "body": "<code>EOF</code> and <code>feof()</code> are entirely different things. <code>feof()</code> is a <i>function</i> which checks to see if the end-of-file indicator has been set, and <code>EOF</code> is a <i>macro</i> for the value returned by some functions when end-of-file has been reached."}, {"owner": {"reputation": 41, "user_id": 7866183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed15859059a9f2941d2d0891dbdaedd0?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis", "link": "https://stackoverflow.com/users/7866183/alexis"}, "edited": false, "score": 0, "creation_date": 1517428298, "post_id": 48550232, "comment_id": 84096698, "body": "can you please tell me how do I replace with EOF? I am still not getting my answer"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1517428310, "post_id": 48550232, "comment_id": 84096703, "body": "See <a href=\"https://stackoverflow.com/questions/5431941/\"><code>while (!feof(file))</code> is always wrong</a> because it is, and your code runs into the problems that arise from abusing <code>feof()</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1517428361, "post_id": 48550232, "comment_id": 84096723, "body": "Replace <code>while (!feof(fp1)) {                 fscanf(fp1, &quot;%d&quot;, &amp;num); \u2026 }</code> with <code>while (fscanf(fp1, &quot;%d&quot;, &amp;num) == 1) { \u2026\u00a0}</code>.  Note that this behaves sanely even when you type a word instead of a number; it stops processing the (erroneous) data.  It doesn&#39;t use EOF; comparing with EOF would not spot the problems with words instead of numbers."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1517428567, "post_id": 48550232, "comment_id": 84096839, "body": "EOF is an integer value returned by functions like <code>fgetc()</code> and <code>getchar()</code>. You&#39;re not using any of those functions, so you won&#39;t see one."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517428842, "post_id": 48550232, "comment_id": 84096974, "body": "Your code doesn&#39;t seem to be treating prime numbers differently from odd numbers (yet \u2014 but the comments say you should/will be doing so, eventually).  If you do end up treating primes differently, don&#39;t forget that 2 is both even and prime."}], "answers": [{"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 3, "last_activity_date": 1517430500, "last_edit_date": 1517430500, "creation_date": 1517428670, "answer_id": 48550461, "question_id": 48550232, "link": "https://stackoverflow.com/questions/48550232/using-eof-instead-of-feof/48550461#48550461", "title": "using EOF instead of feof", "body": "<p><code>fscanf</code> returns <code>EOF</code> when the end-of-file is reached:</p>\n\n<blockquote>\n  <p><em>man fscanf</em></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint scanf(const char *format, ...);\nint fscanf(FILE *stream, const char *format, ...);\nint sscanf(const char *str, const char *format, ...);\n</code></pre>\n  \n  <p>[...]</p>\n  \n  <p>The <code>scanf()</code> function reads input from the standard input stream <code>stdin</code>, <code>fscanf()</code> reads input from the stream pointer <code>stream</code>, and\n  <code>sscanf()</code> reads its input from the character string pointed to by <code>str</code>.</p>\n  \n  <p>[...]</p>\n  \n  <p><strong>RETURN VALUE</strong></p>\n  \n  <p>On success, these functions return the number of input items successfully matched and assigned; this can be fewer than provided for, or\n  even zero, in the event of an early matching failure.</p>\n  \n  <p><strong>The value <code>EOF</code> is returned if the end of input is reached before either the first successful conversion or a matching failure occurs.\n  <code>EOF</code> is also returned if a read error occurs, in which case the error indicator for the stream (see ferror(3)) is set, and <code>errno</code> is set\n  to indicate the error.</strong></p>\n</blockquote>\n\n<p>A solution would be to read save the return value of <code>fscanf</code> in a <code>int</code>\nvariable and check it agains 0 and <code>EOF</code>, like this:</p>\n\n<p>If you want to keep using <code>fscanf</code>:</p>\n\n<pre><code>int ret;\nwhile((ret = fscanf(fp1, \"%d, &amp;num)) != EOF)\n{\n    if(ret == 0)\n    {\n        // fscanf failed to convert the input\n        // let it consume a charatcer and try again.\n        getc(fp1);\n        continue;\n    }\n\n    if(num % 2 == 0)\n        ...\n}\n</code></pre>\n\n<p><strong>edit</strong></p>\n\n<p>Avoid using <code>feof</code> to control looping on a file like this <code>while(!feof(fp)</code>, see <a href=\"https://stackoverflow.com/questions/5431941/\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a> for more\ninformation about that.</p>\n\n<hr>\n\n<p><strong>edit 2</strong></p>\n\n<p>This was my original idea, but as Jonathan Leffler pointed out in the comments:</p>\n\n<blockquote>\n  <p><em>Jonathan Leffler wrote:</em></p>\n  \n  <p>Your first solution demands a single number per line, which the code in the question does not</p>\n</blockquote>\n\n<p>He's right, I didn't see that.</p>\n\n<blockquote>\n  <p><em>me from the past</em></p>\n  \n  <p>One option would be to read the input line by line using <code>fgets</code> and then use\n  <code>sscanf</code> to parse the line:</p>\n\n<pre><code>char buffer[1024];\n\nwhile(fgets(buffer, sizeof buffer, fp1))\n{\n    if(sscanf(buffer, \"%d\", &amp;num) != 1)\n    {\n        fprintf(stderr, \"Could not read an integer, ignoring line\\n\");\n        continue;\n    }\n\n    if (num % 2 == 0)\n        ...\n}\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2737, "user_id": 913182, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/H12RK.jpg?s=128&g=1", "display_name": "Tanner Babcock", "link": "https://stackoverflow.com/users/913182/tanner-babcock"}, "is_accepted": false, "score": 0, "last_activity_date": 1517454275, "creation_date": 1517454275, "answer_id": 48554701, "question_id": 48550232, "link": "https://stackoverflow.com/questions/48550232/using-eof-instead-of-feof/48554701#48554701", "title": "using EOF instead of feof", "body": "<p>Your condition for the while loop should be the <code>fscanf()</code> statement itself. <code>EOF</code> is always an integer. See the <a href=\"https://www.ibm.com/support/knowledgecenter/en/ssw_ibm_i_71/rtref/fscanf.htm\" rel=\"nofollow noreferrer\">manual page for <code>fscanf()</code></a>:</p>\n\n<blockquote>\n  <p><strong>Return Value</strong></p>\n  \n  <p>The fscanf() function returns the number of fields that it successfully converted and assigned. The return value does not include fields that the fscanf() function read but did not assign.</p>\n  \n  <p>The return value is EOF if an input failure occurs before any conversion, or the number of input items assigned if successful.</p>\n</blockquote>\n\n<p>And, like everyone else I will refer you to <strong><a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong?rq=1\">Why is <code>while ( !feof (file) )</code> always wrong?</a></strong>. This is essential reading on Stack Overflow for new C programmers.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    FILE *fp1, *fp2, *fp3;\n    int n, i, num, flag = 0, ret;\n\n    /* fopen files */\n\n    while ((ret = fscanf(fp1, \"%d\", &amp;num)) != EOF) {\n        if (ret == 0) {\n            getc(fp1);\n            continue;\n        }\n        if (num % 2 == 0) {\n            fprintf(fp2, \"%d \", num);\n        }\n        /* rest of the loop here */\n    }\n\n    /* fclose files */\n}\n</code></pre>\n\n<p>If <code>fscanf()</code> fails to read a character, but does not return EOF, it can often solve things to <code>getc()</code>, to advance the buffer by one character. This method also works when using <code>getchar()</code> to advance stdin, after getting user input from <code>scanf()</code>.</p>\n"}], "owner": {"reputation": 41, "user_id": 7866183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed15859059a9f2941d2d0891dbdaedd0?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis", "link": "https://stackoverflow.com/users/7866183/alexis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 958, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1517454275, "creation_date": 1517427811, "question_id": 48550232, "link": "https://stackoverflow.com/questions/48550232/using-eof-instead-of-feof", "title": "using EOF instead of feof", "body": "<pre><code>#include &lt;stdio.h&gt;\n  int main() {\n        FILE *fp1, *fp2, *fp3;\n        int n, i, num, flag = 0;\n        /* open files to write even, odd seperately */\n        fp1 = fopen(\"data.txt\", \"r\");\n        fp2 = fopen(\"even.txt\", \"w\");\n        fp3 = fopen(\"odd.txt\", \"w\");\n\n        fprintf(fp2, \"Even Numbers:\\n\");\n        fprintf(fp3, \"Odd Numbers:\\n\");\n\n        /* print even, odd and prime numbers in separate files */\n        while (!feof(fp1)) {\n                fscanf(fp1, \"%d\", &amp;num);\n                if (num % 2 == 0) {\n                        fprintf(fp2, \"%d \", num);\n                } else {\n                        if (num &gt; 1) {\n                                for (i = 2; i &lt; num; i++) {\n                                        if (num % i == 0) {\n                                                flag = 1;\n                                                break;\n                                        }\n                                }\n                        }\n                        fprintf(fp3, \"%d \", num);\n                        flag = 0;\n                }\n        }\n        fprintf(fp2, \"\\n\");\n        fprintf(fp3, \"\\n\");\n\n        fclose(fp1);\n        fclose(fp2);\n        fclose(fp3);\n        return 0;\n  }\n</code></pre>\n\n<p>I want to use EOF instead of feof. I have tried !EOF = fp1 but it doesn't work and gives an error. I just want to replace feof with EOF. can anyone indicate what is the problem in my code?</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 4, "creation_date": 1517426409, "post_id": 48549850, "comment_id": 84095698, "body": "You need to flush the buffer with a new line.  <code>printf(&quot;hello\\n&quot;)</code>"}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1517426410, "post_id": 48549850, "comment_id": 84095699, "body": "&quot; it just run and do nothing.&quot; what do you expect empty loop to do rather than nothing?"}, {"owner": {"reputation": 5673, "user_id": 2376156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2s2R4.jpg?s=128&g=1", "display_name": "edtheprogrammerguy", "link": "https://stackoverflow.com/users/2376156/edtheprogrammerguy"}, "edited": false, "score": 0, "creation_date": 1517426783, "post_id": 48549850, "comment_id": 84095885, "body": "Why do you want an empty <code>while(1)</code> loop?"}, {"owner": {"reputation": 71, "user_id": 4218207, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/10a77d79eb494459937c2ee38a1f8e7d?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad M", "link": "https://stackoverflow.com/users/4218207/mohammad-m"}, "edited": false, "score": 0, "creation_date": 1517427239, "post_id": 48549850, "comment_id": 84096149, "body": "i want something in it. but it is just for example."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1517427501, "post_id": 48549850, "comment_id": 84096300, "body": "@Fran&#231;oisAndrieux your comment got some ticks but to me the link was a TL;DR in this context. The question is about buffer discharge to ouput. Why are you saying an empty loop is <i>undefined behaviour</i>? Is it because an optimising compiler does not know whether to reject the loop?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1517427641, "post_id": 48549850, "comment_id": 84096368, "body": "@Fran&#231;oisAndrieux That&#39;s true in C++ but not in C.  In C an infinite loop whose controlling condition is constant is well-defined.  (Some C compilers, incorrectly, apply the C++ rule to C, see e.g.  <a href=\"https://bugs.llvm.org//show_bug.cgi?id=965\" rel=\"nofollow noreferrer\">bugs.llvm.org//show_bug.cgi?id=965</a> .)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1517427662, "post_id": 48549850, "comment_id": 84096380, "body": "PS I hate optimising compilers. My tutor advised me: don&#39;t let the compiler do the work for you. Since C is just above assembler, I would use another language if I didn&#39;t want control of my code. I <i>like</i> crafting my code."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1517427681, "post_id": 48549850, "comment_id": 84096391, "body": "@zwol The question was tagged c++ at the time."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1517427904, "post_id": 48549850, "comment_id": 84096485, "body": "@WeatherVane Note that the question was tagged c++ at the time of my comment. In that context, since all path can be shown to have undefined behavior, a compiler could optimize out the output in the name of speed. Coming from a c++ background, <i>&quot;don&#39;t let the compiler do the work for you.&quot;</i> is inexcusable blasphemy of the highest order, but I guess things are different in the c community. Different languages, different goals."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1517427976, "post_id": 48549850, "comment_id": 84096519, "body": "@Fran&#231;oisAndrieux I guess things are somewhat similar with C compilers now."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1517427992, "post_id": 48549850, "comment_id": 84096532, "body": "@Fran&#231;oisAndrieux Even in C, there is a substantial population of programmers who want the compiler to do the work for them. Many are refugees from FORTRAN :-)"}, {"owner": {"reputation": 71, "user_id": 4218207, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/10a77d79eb494459937c2ee38a1f8e7d?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad M", "link": "https://stackoverflow.com/users/4218207/mohammad-m"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1517428536, "post_id": 48549850, "comment_id": 84096814, "body": "every programmer was newcommer someday @Fran&#231;oisAndrieux :)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1517429341, "post_id": 48549850, "comment_id": 84097231, "body": "@Fran&#231;oisAndrieux I made a brave attempt at C++ some time ago, but didn&#39;t like it. I was advised to change the way I think to be able use C++. That told me it fails in the primary requirement for a computer language: to bridge the gap between the way people think, and the way computers work. Things have come on a long way since."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1517431042, "post_id": 48549850, "comment_id": 84098106, "body": "@WeatherVane Trying to develop with c++ but with a c mindset leads to &quot;programming in c with classes&quot;, the worst of both worlds. In my experience, the mindsets required to work with c and c++ are very different and it&#39;s challenging for professionals that are familiar with one to adopt the idiosyncrasies of the other. I feel c++ bridges the gap between how people think and computer very well, though it&#39;s features are geared towards helping developers express intent rather than detail. If you want to continue the discussion, we should migrate it to a chat as it&#39;s no longer about the question."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1517433070, "post_id": 48549850, "comment_id": 84099125, "body": "@Fran&#231;oisAndrieux thank you for the input, my last comment was not so much about idiosyncrasies but hierarchy of data structures and inheritance, which seemed to be upside down to the way I wanted to work. Too late here to go to chat sorry."}], "answers": [{"comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1517426823, "post_id": 48549876, "comment_id": 84095905, "body": "It should be noted that the output buffer can also be flushed by terminating the print line with a line feed: <code>printf(&quot;hello\\n&quot;)</code>, in which case the <code>fflush(stdout)</code> is unnecessary."}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1517426920, "post_id": 48549876, "comment_id": 84095952, "body": "@lurker That may depend. For example, if <code>STDOUT_FILENO</code> is redirected to a file, it won&#39;t."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1517427031, "post_id": 48549876, "comment_id": 84096017, "body": "Yes, that&#39;s worth noting, too. :)"}], "tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": true, "score": 4, "last_activity_date": 1517426396, "creation_date": 1517426396, "answer_id": 48549876, "question_id": 48549850, "link": "https://stackoverflow.com/questions/48549850/endless-loop-doesnt-work-compiled-with-gcc/48549876#48549876", "title": "Endless loop doesn&#39;t work, compiled with gcc", "body": "<blockquote>\n  <p>for example in this code, doesn't print \"hello\".</p>\n</blockquote>\n\n<p>It is because of the <em>buffering</em>.</p>\n\n<p>You can call <code>fflush(stdout)</code> just after the <code>printf()</code> in order to flush the buffer:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    printf(\"hello\");\n    fflush(stdout);\n    while(1){\n\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>In your second case the buffer is flushed at program's termination.</p>\n"}, {"tags": [], "owner": {"reputation": 6233, "user_id": 5741073, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1uZeL.jpg?s=128&g=1", "display_name": "TomServo", "link": "https://stackoverflow.com/users/5741073/tomservo"}, "is_accepted": false, "score": 2, "last_activity_date": 1517428004, "last_edit_date": 1517428004, "creation_date": 1517427273, "answer_id": 48550092, "question_id": 48549850, "link": "https://stackoverflow.com/questions/48549850/endless-loop-doesnt-work-compiled-with-gcc/48550092#48550092", "title": "Endless loop doesn&#39;t work, compiled with gcc", "body": "<p>If what you want, to start with, is to print \"hello\" infinitely, then you need something like this. It puts a print and flush <em>inside</em> the infinite loop.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    while(1)\n    {\n        printf(\"hello\");\n        fflush(stdout);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 4218207, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/10a77d79eb494459937c2ee38a1f8e7d?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad M", "link": "https://stackoverflow.com/users/4218207/mohammad-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 48549876, "answer_count": 2, "score": 1, "last_activity_date": 1553277767, "creation_date": 1517426311, "last_edit_date": 1553277767, "question_id": 48549850, "link": "https://stackoverflow.com/questions/48549850/endless-loop-doesnt-work-compiled-with-gcc", "title": "Endless loop doesn&#39;t work, compiled with gcc", "body": "<p>When I add an endless loop to my, code it doesn't work. It just runs and does nothing.</p>\n\n<p>For example, this code doesn't print <code>\"hello\"</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    printf(\"hello\");\n    while(1){\n\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>but this code prints \"hello\".</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    printf(\"hello\");\n    //while(1){ \n    //}\n\n    return 0;\n}\n</code></pre>\n\n<p>How can I add a <code>while(1)</code> loop to my code?</p>\n"}, {"tags": ["c", "linked-list", "codeblocks", "dynamic-programming", "simpsons-rule"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1517426337, "post_id": 48549804, "comment_id": 84095658, "body": "step through it in a debugger and see what&#39;s happening."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1517427030, "post_id": 48549804, "comment_id": 84096016, "body": "When you print the result (&quot;Integral Is&quot;), you use the <code>%ld</code> format on a <code>double</code> arguent. Use <code>%g</code>, <code>%f</code> or <code>%e</code>. Switching on compiler warnings will detect such errors."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1517427159, "post_id": 48549804, "comment_id": 84096105, "body": "And instead of assertions such as &quot;applying the correct logic&quot;, please include the input data, the expected result and the actual result. That would make life much easier for those whose help you are requesting."}, {"owner": {"reputation": 3854, "user_id": 2235885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d0d6a08639ef79ef960a52bd013e02?s=128&d=identicon&r=PG", "display_name": "joop", "link": "https://stackoverflow.com/users/2235885/joop"}, "edited": false, "score": 1, "creation_date": 1517483118, "post_id": 48549804, "comment_id": 84118074, "body": "<code>if(i==0){</code> could be replaced by <code>if(start == NULL){</code>, eliminating the <code>i</code> variable. Also: most people prefer <code>array[j]</code> indexing to <code>*(array +j)</code>"}, {"owner": {"reputation": 27, "user_id": 8352140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f09daa88f342a1e385275c700be7bcca?s=128&d=identicon&r=PG&f=1", "display_name": "tushar ", "link": "https://stackoverflow.com/users/8352140/tushar"}, "edited": false, "score": 0, "creation_date": 1517683593, "post_id": 48549804, "comment_id": 84198157, "body": "Got that!! thanks, Mr. M Oehm!!"}], "answers": [{"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1576172187, "post_id": 59309999, "comment_id": 104822187, "body": "Code only answers with no explanation, especially large blobs like this, don&#39;t really answer the question as to what is wrong with the asker&#39;s code and how to fix it."}, {"owner": {"reputation": 1418, "user_id": 4559414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bde91c5b14f4bac3b149d658ba2df9ab?s=128&d=identicon&r=PG", "display_name": "Gander", "link": "https://stackoverflow.com/users/4559414/gander"}, "edited": false, "score": 0, "creation_date": 1576173275, "post_id": 59309999, "comment_id": 104822717, "body": "Repair this code. Use code tags instead of indentation."}], "tags": [], "owner": {"reputation": 1, "user_id": 12526538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3494b742548c217250f53a7e3e972178?s=128&d=identicon&r=PG&f=1", "display_name": "HAZARD", "link": "https://stackoverflow.com/users/12526538/hazard"}, "is_accepted": false, "score": -4, "last_activity_date": 1576178456, "last_edit_date": 1576178456, "creation_date": 1576172011, "answer_id": 59309999, "question_id": 48549804, "link": "https://stackoverflow.com/questions/48549804/integration-by-simpsons-1-3rd-integration-method-for-any-non-linear-equation-in/59309999#59309999", "title": "Integration by simpson&#39;s 1/3rd integration method for any non-linear equation in C language?", "body": "<pre><code>/* DEFINING TRAPEZIUM RULE FUNCTION */\n\ndouble trapeziumrule (Variables *p){\n\n    printf(\"You have chosen the Trapezium Rule!\\n\");\n    printf(\"Please enter the highest order polynomial.\\n\");\n    scanf(\"%d\",&amp;p-&gt;poly);\n\n    for(int i=p-&gt;poly ; i&gt;=0 ; --i){\n        printf(\"Please enter the coefficient for x^%d:  \", i);\n        scanf(\"%lg\",&amp;p-&gt;coeff[i]);\n    }\n\n    //Establishing conditions\n    printf(\"\\nPlease enter the lower bound \\n\");\n    scanf(\"%lg\",&amp;p-&gt;lbound);\n    printf(\"Please enter the higher bound \\n\");\n    scanf(\"%lg\",&amp;p-&gt;hbound);\n\n    //Sanity Check\n    if (p-&gt;hbound&lt;=p-&gt;lbound){\n        printf(\"The higher bound must be higher than the lower bound!\\n\");\n        return -1;\n    }\n\n    printf(\"Please enter how many intervals you wish to use \\n\");\n    scanf(\"%lg\",&amp;p-&gt;interval);\n    printf(\"\\n You chose a lower bound of %lg, an upper bound of %lg and  %lg intervals \\n\",p-&gt;lbound, p-&gt;hbound,p-&gt;interval);\n\n    p-&gt;width = (p-&gt;hbound-p-&gt;lbound)/p-&gt;interval;\n\n    //Finding the x values to evaluate y at\n    for (int i=0 ; i&lt;=p-&gt;interval ; ++i){\n        p-&gt;x[i]=p-&gt;lbound + i*p-&gt;width;\n    }\n\n    for (int k=0; k&lt;=p-&gt;interval; ++k){\n        for (int i=0; i&lt;=p-&gt;poly; ++i){\n            //Case for y(0) and y(interval)\n            if (k==0 || k==p-&gt;interval){\n                p-&gt;value=p-&gt;coeff[i]*pow(p-&gt;x[k],i)*(1.0/2.0);\n            }\n            //Case for middle y values\n            else if (k!=0 || k!=p-&gt;interval){\n                p-&gt;value=p-&gt;coeff[i]*pow(p-&gt;x[k],i);\n            }\n            //Adding each segment onto the previous\n            p-&gt;area=p-&gt;area+p-&gt;value;\n        }\n    }\n    //Finding the area under the curve\n    p-&gt;area=p-&gt;area*p-&gt;width;\n    printf(\"\\n The result of the integration via Trapezium rule is %lg \\n\", p-&gt;area);\n     return 0;\n}\n\n/* DEFINING SIMPSONS RULE FUNCTION */\n\ndouble simpsonsrule (Variables *s){\n\n    printf(\"You have chosen Simpsons rule!\\n\");\n    printf(\"Please enter the highest order polynomial.\\n\");\n    scanf(\"%d\",&amp;s-&gt;poly);\n\n    for(int i=s-&gt;poly ; i&gt;=0 ; --i){\n        printf(\"Please enter the coefficient for x^%d:  \", i);\n        scanf(\"%lg\",&amp;s-&gt;coeff[i]);\n    }\n    //Conditions\n    printf(\"Please enter the lower bound \\n\");\n    scanf(\"%lg\",&amp;s-&gt;lbound);\n    printf(\"Please enter the higher bound \\n\");\n    scanf(\"%lg\",&amp;s-&gt;hbound);\n\n    //Sanity Check\n    if (s-&gt;hbound&lt;=s-&gt;lbound){\n        printf(\"The higher bound must be higher than the lower bound!\\n\");\n        return -1;\n    }\n\n    printf(\"Please enter how many intervals you wish to use \\n\");\n    scanf(\"%lg\",&amp;s-&gt;interval);\n    printf(\"\\nYou chose a lower bound of %lg, an upper bound of %lg and  %lg intervals \\n\",s-&gt;lbound, s-&gt;hbound,s-&gt;interval);\n\n    s-&gt;width = (s-&gt;hbound-s-&gt;lbound)/s-&gt;interval;\n\n    //Finding the x values to evaluate y at\n    for (int i=0 ; i&lt;=s-&gt;interval ; ++i){\n        s-&gt;x[i]=s-&gt;lbound + i*s-&gt;width;\n    }\n\n    for (int k=0; k&lt;=s-&gt;interval; ++k){\n        for (int i=0; i&lt;=s-&gt;poly; ++i){\n            //Case for y(0) and y(interval)\n            if (k==0 || k==s-&gt;interval){\n                s-&gt;value=s-&gt;coeff[i]*pow(s-&gt;x[k],i)*(1.0/3.0);\n            }\n            //Case for odd values of y(interval)\n            else if (k%2!=0 &amp;&amp; k!=s-&gt;interval){\n                s-&gt;value=s-&gt;coeff[i]*pow(s-&gt;x[k],i)*(4.0/3.0);\n            }\n            //Case for even values of y(interval)\n            else if (k%2==0 &amp;&amp; k!=s-&gt;interval){\n                s-&gt;value=s-&gt;coeff[i]*pow(s-&gt;x[k],i)*(2.0/3.0);\n            }\n            s-&gt;area=s-&gt;area+s-&gt;value;\n        }\n    }\n    s-&gt;area=s-&gt;area*s-&gt;width;\n    printf(\"\\n The result of the integration via Simpsons rule is %lg \\n\", s-&gt;area);\n    return 0;\n}\n\ndouble midptrule (Variables *m){\n\n    printf(\"You have chosen the Midpoint Rule!\\n\");\n    printf(\"Please enter the highest order polynomial.\\n\");\n    scanf(\"%d\",&amp;m-&gt;poly);\n\n    for(int i=m-&gt;poly ; i&gt;=0 ; --i){\n        printf(\"Please enter the coefficient for x^%d:  \", i);\n        scanf(\"%lg\",&amp;m-&gt;coeff[i]);\n    }\n    //Conditions\n    printf(\"Please enter the lower bound \\n\");\n    scanf(\"%lg\",&amp;m-&gt;lbound);\n    printf(\"Please enter the higher bound \\n\");\n    scanf(\"%lg\",&amp;m-&gt;hbound);\n\n\n\n    printf(\"Please enter how many intervals you wish to use \\n\");\n    scanf(\"%lg\",&amp;m-&gt;interval);\n    printf(\"\\nYou chose a lower bound of %lg, an upper bound of %lg and  %lg intervals \\n\",m-&gt;lbound, m-&gt;hbound, m-&gt;interval);\n\n    m-&gt;width = ((m-&gt;hbound-m-&gt;lbound)/m-&gt;interval)/2;\n\n    //Finding and storing x values\n    for (int i=0 ; i&lt;m-&gt;interval ; ++i){\n        m-&gt;x[i]=m-&gt;lbound + (m-&gt;width+i*2*m-&gt;width);\n    }\n\n    //Calculating the y values\n    for (int k=0; k&lt;m-&gt;interval; ++k){\n        for (int i=0; i&lt;=m-&gt;poly; ++i){\n            m-&gt;value=m-&gt;coeff[i]*pow(m-&gt;x[k],i);\n            m-&gt;area=m-&gt;area+m-&gt;value;\n        }\n    }\n    m-&gt;area=m-&gt;area*2*m-&gt;width;\n    printf(\"\\n The result is %lg \\n\", m-&gt;area);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8352140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f09daa88f342a1e385275c700be7bcca?s=128&d=identicon&r=PG&f=1", "display_name": "tushar ", "link": "https://stackoverflow.com/users/8352140/tushar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576178456, "creation_date": 1517426130, "last_edit_date": 1517511008, "question_id": 48549804, "link": "https://stackoverflow.com/questions/48549804/integration-by-simpsons-1-3rd-integration-method-for-any-non-linear-equation-in", "title": "Integration by simpson&#39;s 1/3rd integration method for any non-linear equation in C language?", "body": "<p>Simpson 1/3rd integration method by Linklist.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n#include&lt;math.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct term{\n    int power;\n    int coefficient;\n    struct term *nxt;\n};\n\nstruct term *start=NULL;\nint deg=0;\ndouble valOfFuncAt(double);\nvoid createEquationTermsInLL(int);\n\nint main(){\n    double xo,xoTemp,xn,*fx,value;\n    double h;\n    double y=0.0,y_=0.0,z=0.0;\n    int n,i;\n    printf(\"Enter The Degree Of The Equation:: \");\n    scanf(\"%d\",&amp;deg);\n    createEquationTermsInLL(deg);\n    printf(\"\\n\\nEnter The Lower Limit,Upper Limit And No. Of Intervals(Must Be Even)::\");\n    scanf(\"%lf %lf %d\",&amp;xo,&amp;xn,&amp;n);\n    h = (xn - xo)/n;\n    fx = (double*)malloc((n+1)*sizeof(double));\n    i=0;\n    xoTemp=xo;\n    while(i&lt;=n){\n\n        *(fx + i)=valOfFuncAt(xoTemp);\n        xoTemp = xoTemp + h;\n        i++;\n    }\n\n\n    y = (*(fx+0)) + (*(fx + n));\n\n    i=1;\n    while(i&lt;n){\n        z = z + *(fx + i);\n        i+=2;\n    }\n    z = 4*z;\n    i=2;\n    while(i&lt;n){\n\n        y_ = y_ + *(fx + i);\n        i+=2;\n    }\n    y_ = 2*y_;\n\n    value = (h/3)*(y + z + y_);\n    printf(\"Integral Is:: %ld\",value);\n\n    getch();\n}\n\n\n\ndouble valOfFuncAt(double x){\n    double fx1=0; int i;\n    struct term *temp=start;\n\n    for(i=deg;i&gt;=0;i--){\n        fx1 = fx1 + (temp-&gt;coefficient) * pow(x,temp-&gt;power);\n        temp=temp-&gt;nxt;\n    }\n    return fx1;\n}\n\n\n\nvoid createEquationTermsInLL(int deg1){ /*Creating link list nodes */\n    static int i=0;\n    int j,coefficient;\n    int degClone=deg1;\n    struct term *temp=NULL;\n    for(j=1;j&lt;=deg1+1;j++){\n        if(i==0){\n            start=(struct term*)malloc(sizeof(struct term));\n            printf(\"Enter Coefficient of %dst term\",j);\n            scanf(\"%d\",&amp;coefficient);\n            start-&gt;coefficient=coefficient;\n            start-&gt;power=degClone; i++; \n            degClone-=1;\n            temp=start;\n        }\n        else{\n            temp-&gt;nxt=(struct term*)malloc(sizeof(struct term));\n            temp=temp-&gt;nxt;\n            if(j==2)\n            printf(\"Enter Coefficient of %dnd term\",j);\n            else if(j==3)\n            printf(\"Enter Coefficient of %drd term\",j);\n            else\n            printf(\"Enter Coefficient of %dth term\",j);\n            fflush(stdin);\n            scanf(\"%d\",&amp;coefficient);\n            temp-&gt;power=degClone;\n            temp-&gt;coefficient=coefficient;\n            degClone-=1;\n        }\n    }\n    temp-&gt;nxt=NULL;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/jxrWt.png\" rel=\"nofollow noreferrer\">expecting output to be 60.00 but getting 0, don't know why?</a>\nTrying to do integration by Simpson's 1/3rd integration method for any non-linear Equation. Tried this in code blocks IDE. Applying the correct logic of Simpson's 1/3rd rule for integration, still getting the Integrand value always to zero, don't know where I did wrong in this code.</p>\n"}, {"tags": ["c", "arrays", "struct", "malloc", "memcpy"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 1, "creation_date": 1517425113, "post_id": 48549514, "comment_id": 84095019, "body": "<code>0x20</code> - <code>32</code> in decimal."}, {"owner": {"reputation": 829, "user_id": 624470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e8415a67ef02e1e2ddd403a61b68ca?s=128&d=identicon&r=PG", "display_name": "apmeyers1987", "link": "https://stackoverflow.com/users/624470/apmeyers1987"}, "reply_to_user": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1517425200, "post_id": 48549514, "comment_id": 84095074, "body": "Sorry misformatted offset is 32 (0x20)...forgot the 0x"}], "answers": [{"comments": [{"owner": {"reputation": 829, "user_id": 624470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e8415a67ef02e1e2ddd403a61b68ca?s=128&d=identicon&r=PG", "display_name": "apmeyers1987", "link": "https://stackoverflow.com/users/624470/apmeyers1987"}, "edited": false, "score": 0, "creation_date": 1517425283, "post_id": 48549549, "comment_id": 84095116, "body": "Oh wow, thank you!  Definitely an oversight.  I&#39;ve used memcpy plenty of other times with buffer + offset."}, {"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "reply_to_user": {"reputation": 829, "user_id": 624470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e8415a67ef02e1e2ddd403a61b68ca?s=128&d=identicon&r=PG", "display_name": "apmeyers1987", "link": "https://stackoverflow.com/users/624470/apmeyers1987"}, "edited": false, "score": 0, "creation_date": 1517425850, "post_id": 48549549, "comment_id": 84095409, "body": "@apmeyers1987 How come the compiler didn&#39;t warn about this?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1517426083, "post_id": 48549549, "comment_id": 84095525, "body": "@BjornA. Compiling without warnings :)"}, {"owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "edited": false, "score": 0, "creation_date": 1517426185, "post_id": 48549549, "comment_id": 84095577, "body": "that is a bad bad idea"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "edited": false, "score": 0, "creation_date": 1517426385, "post_id": 48549549, "comment_id": 84095682, "body": "@VladP Who wants to live forever?"}, {"owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "edited": false, "score": 2, "creation_date": 1517426458, "post_id": 48549549, "comment_id": 84095717, "body": ":)  yeah live dangerously and don&#39;t sell your code to anyone :)"}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 5, "last_activity_date": 1517425322, "last_edit_date": 1517425322, "creation_date": 1517425150, "answer_id": 48549549, "question_id": 48549514, "link": "https://stackoverflow.com/questions/48549514/segfault-when-using-memcpy-to-copy-from-buffer-to-array-of-structs/48549549#48549549", "title": "SEGFAULT when using memcpy to copy from buffer to array of structs", "body": "<p>The correct way to use <code>memcpy</code> would be (from the description given)(<em>a buffer I have at offset 32 into this new nodes array</em>)</p>\n\n<pre><code>memcpy(nodes,buffer+32,sizeof(node)*nodecount);\n</code></pre>\n\n<p>or </p>\n\n<pre><code>memcpy(nodes,&amp;buffer[0x20],sizeof(node)*nodecount);\n</code></pre>\n\n<p>Earlier you didn't pass the address, rather you passed the value itself. You made an attempt to access some memory location you are not supposed to leading to segmentation fault.</p>\n"}], "owner": {"reputation": 829, "user_id": 624470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e8415a67ef02e1e2ddd403a61b68ca?s=128&d=identicon&r=PG", "display_name": "apmeyers1987", "link": "https://stackoverflow.com/users/624470/apmeyers1987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517425322, "creation_date": 1517424992, "question_id": 48549514, "link": "https://stackoverflow.com/questions/48549514/segfault-when-using-memcpy-to-copy-from-buffer-to-array-of-structs", "title": "SEGFAULT when using memcpy to copy from buffer to array of structs", "body": "<p>I have the following struct defined</p>\n\n<pre><code>typedef struct {\n    uint16_t type;\n    uint16_t name_offset;\n    uint32_t data_offset;\n    uint32_t size;\n}node;\n</code></pre>\n\n<p><code>sizeof(node)</code> returns 12 bytes as expected.  </p>\n\n<pre><code>node *nodes = (node*)malloc(sizeof(node)*nodecount);\n</code></pre>\n\n<p>In my current test nodecount is 96 and the memory allocated for nodes is 1152 as expected.  (tested via _msize) </p>\n\n<p>I want to memcpy from a buffer I have at offset 20 into this new nodes array (this is where I crash).  I have confirmed that 0x20(inclusive)-0x4A0(exclusive) is the correct structure for this array. </p>\n\n<pre><code>memcpy(nodes,buffer[0x20],sizeof(node)*nodecount)\n</code></pre>\n\n<p>Buffer looks like this</p>\n\n<pre><code>00000020: 01 00 00 00 00 00 00 00 00 00 00 60\n...\n00000490: 00 00 00 88 00 00 06 89 02 15 DE 40\n</code></pre>\n"}, {"tags": ["c++", "c", "function", "assembly", "x86"], "comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 2, "creation_date": 1517423156, "post_id": 48549014, "comment_id": 84093955, "body": "On x86-64 some args are passed in registers others on the stack. Start with <a href=\"https://en.wikipedia.org/wiki/X86_calling_conventions\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/X86_calling_conventions</a>"}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 1, "creation_date": 1517423594, "post_id": 48549014, "comment_id": 84094194, "body": "First parameter is in <code>rcx</code>, second in <code>rdx</code> (then <code>r8</code> and <code>r9</code>). You also need to create an <a href=\"https://docs.microsoft.com/en-us/cpp/build/stack-allocation\" rel=\"nofollow noreferrer\">home area</a>, possibly via a <code>sub rsp, 20h</code>."}, {"owner": {"reputation": 48820, "user_id": 182676, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/446fa39e5f227c92db408e1b68356b5e?s=128&d=identicon&r=PG", "display_name": "Macmade", "link": "https://stackoverflow.com/users/182676/macmade"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 1, "creation_date": 1517423902, "post_id": 48549014, "comment_id": 84094352, "body": "@MargaretBloom Depends on the calling convention..."}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "reply_to_user": {"reputation": 48820, "user_id": 182676, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/446fa39e5f227c92db408e1b68356b5e?s=128&d=identicon&r=PG", "display_name": "Macmade", "link": "https://stackoverflow.com/users/182676/macmade"}, "edited": false, "score": 0, "creation_date": 1517424150, "post_id": 48549014, "comment_id": 84094505, "body": "@Macmade Yes. Windows 64 bit C++ code, compiled with VC++, used this calling convention last time I checked."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1517424192, "post_id": 48549014, "comment_id": 84094533, "body": "@MargaretBloom : Yep x86-64 has pretty much standardized to that one convention on Windows."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1517425130, "post_id": 48549014, "comment_id": 84095033, "body": "If program A isn&#39;t a debugger it has no business using <code>CreateRemoteThread</code>. That that API even <i>exists</i> is a strong contender for the biggest single design mistake in Windows."}, {"owner": {"reputation": 67, "user_id": 5261139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd4c2f7c8c672d728884f986a098aed7?s=128&d=identicon&r=PG&f=1", "display_name": "ChronicUser", "link": "https://stackoverflow.com/users/5261139/chronicuser"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1517425973, "post_id": 48549014, "comment_id": 84095477, "body": "@Maxim Egorushkin How do I determine if my function requires args to be passes in registers or on the stack?"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1517435951, "post_id": 48549014, "comment_id": 84100551, "body": "@ChronicUser its simply the amount of arguments. The first four always go in <code>rcx</code>, <code>rdx</code>, <code>r8</code> and <code>r9</code> (in 64-bit Windows anyway..). The rest are placed on the stack AFTER the shadow/home/scratch space. Basically, if you&#39;ve got 6 args you&#39;re passing, arg 5 would go to <code>[rsp+0x28]</code> and arg 6 would go to <code>[rsp+0x30]</code> ... etc (this takes into account the return address already present on the stack ... you would need to adjust it if you are setting up another local frame)."}], "answers": [{"comments": [{"owner": {"reputation": 48820, "user_id": 182676, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/446fa39e5f227c92db408e1b68356b5e?s=128&d=identicon&r=PG", "display_name": "Macmade", "link": "https://stackoverflow.com/users/182676/macmade"}, "edited": false, "score": 0, "creation_date": 1517427906, "post_id": 48549475, "comment_id": 84096487, "body": "ABI is also related to the OS, not only the machine."}, {"owner": {"reputation": 455, "user_id": 9253686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28afb8ac49796a9fae1a9bec60bba686?s=128&d=identicon&r=PG&f=1", "display_name": "0x51ba", "link": "https://stackoverflow.com/users/9253686/0x51ba"}, "reply_to_user": {"reputation": 48820, "user_id": 182676, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/446fa39e5f227c92db408e1b68356b5e?s=128&d=identicon&r=PG", "display_name": "Macmade", "link": "https://stackoverflow.com/users/182676/macmade"}, "edited": false, "score": 0, "creation_date": 1517428726, "post_id": 48549475, "comment_id": 84096919, "body": "@Macmade Thanks for your comment. I edited my answer."}, {"owner": {"reputation": 67, "user_id": 5261139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd4c2f7c8c672d728884f986a098aed7?s=128&d=identicon&r=PG&f=1", "display_name": "ChronicUser", "link": "https://stackoverflow.com/users/5261139/chronicuser"}, "edited": false, "score": 0, "creation_date": 1517434799, "post_id": 48549475, "comment_id": 84099999, "body": "Thank you so much for the instructions. I went over the assembly code of the function a few more times. The simple problem was the fact that you must determine the order of the arguments and then pass them in a reverse order. Furthermore you must see what arguments go to the stack and which ones will go into to the registries."}], "tags": [], "owner": {"reputation": 455, "user_id": 9253686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28afb8ac49796a9fae1a9bec60bba686?s=128&d=identicon&r=PG&f=1", "display_name": "0x51ba", "link": "https://stackoverflow.com/users/9253686/0x51ba"}, "is_accepted": false, "score": 1, "last_activity_date": 1517428696, "last_edit_date": 1517428696, "creation_date": 1517424829, "answer_id": 48549475, "question_id": 48549014, "link": "https://stackoverflow.com/questions/48549014/how-to-call-a-function-and-pass-arguments-to-it-in-x86-assembly/48549475#48549475", "title": "How to call a function and pass arguments to it in x86 assembly", "body": "<p>Since you are looking for a way to understand and clarify what is happening internally, I recommend to start with generating an assembler file for the specific machine you are working with. If you are using gcc or g++ you can use the <code>-S</code> flag to generate the associated assembler files. For the beginning you can implement a function with two arguments and call that function inside your main function. Using the assembler files, you should get a really good picture of how the stack is filled before your function is called and where your return value is put. In the next step you should compare what you see in the assembler file with the <a href=\"https://en.wikipedia.org/wiki/X86_calling_conventions\" rel=\"nofollow noreferrer\">x86 calling convetion</a>.</p>\n"}], "owner": {"reputation": 67, "user_id": 5261139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd4c2f7c8c672d728884f986a098aed7?s=128&d=identicon&r=PG&f=1", "display_name": "ChronicUser", "link": "https://stackoverflow.com/users/5261139/chronicuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1761, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1517434599, "creation_date": 1517423002, "last_edit_date": 1517434599, "question_id": 48549014, "link": "https://stackoverflow.com/questions/48549014/how-to-call-a-function-and-pass-arguments-to-it-in-x86-assembly", "title": "How to call a function and pass arguments to it in x86 assembly", "body": "<p>Intel CPU\nWindows 10 64bit\nC++\nx86 assembly</p>\n\n<p>I have two programs, both written by me in C++. For the sake of simplicity I will refer to them as program A and program B. They do not do anything special really, I am just using them to test things out and have some fun in the process. </p>\n\n<p>The idea is that program A injects code into program B and that injected code will set the parameters of a function in program B and will call a function in program B.</p>\n\n<p>I must say I have learned a lot from this experiment. As I needed to open up a handle to a process with proper permissions and then construct assembly code to inject, call it with CreateRemoteThread and clean up afterwards.</p>\n\n<p>I ve managed to do this and call a function from program B and that function takes one parameter of type UINT64. </p>\n\n<p>I do this by injecting the following assembly code:</p>\n\n<pre><code>b9 paramAddr\ne8 funcAddr\nc3\n</code></pre>\n\n<p>By calling this code snippet from program A with CreateRemoteThread in program B I manage to call a function at an address and with a parameter passed. And this works fine. Nothing too complex just call a function that takes one param. One thing to note here is that I have injected the parameter prior to this code and just provided a parameter address to b9.</p>\n\n<p>Now what I am failing to do is call a function in program B from program A that takes two parameters.</p>\n\n<p>Function Example: \nmyFunction(uint num1, int num2)</p>\n\n<p>The procedure for injection is the same, and all that works just fine windows API provides plenty of well documented functionalities. </p>\n\n<p>What I do not seam to be able to do is pass the two parameters to the function. This is where my troubles begin. I have been looking at x86 assembly function call conventions. And what they do is either just</p>\n\n<pre><code>push param2\npush param1\ncall functAddr\nretn\n</code></pre>\n\n<p>or</p>\n\n<p>perform a mov to esi</p>\n\n<p>Could anyone please clarify,explain and provide a clear example of how to call a function in x86 assembly that takes two parameters or type uint and int.</p>\n\n<p>Thank you all for your time and effort. </p>\n"}, {"tags": ["c", "parsing", "gdb"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1517421386, "post_id": 48548553, "comment_id": 84092941, "body": "Please post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem. Show the input, the expected output, and the actual output as text <i>in the question</i>."}, {"owner": {"reputation": 157, "user_id": 8524363, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NVtOB.png?s=128&g=1", "display_name": "arkdevelopment", "link": "https://stackoverflow.com/users/8524363/arkdevelopment"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1517421448, "post_id": 48548553, "comment_id": 84092984, "body": "@WeatherVane Due to this being for an assignment, I&#39;m trying to avoid academic misconduct by posting code, unfortunately."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1517421551, "post_id": 48548553, "comment_id": 84093036, "body": "The MCVE doesn&#39;t have to be the assigment code: it can be stripped down to the minimal code that shows the problem. And one benefit of preparing the MCVE is that you discover the problem on the way. The code posted gives us nothing to go on."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1517421901, "post_id": 48548553, "comment_id": 84093260, "body": "Will it segfault after the next <code>n</code>?"}, {"owner": {"reputation": 157, "user_id": 8524363, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NVtOB.png?s=128&g=1", "display_name": "arkdevelopment", "link": "https://stackoverflow.com/users/8524363/arkdevelopment"}, "edited": false, "score": 0, "creation_date": 1517421952, "post_id": 48548553, "comment_id": 84093289, "body": "The segfault occurs at the end of the file which is denoted by the TRLR. I&#39;ve added where the toParse comes from (simplified), and a bit more info."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1517421993, "post_id": 48548553, "comment_id": 84093321, "body": "<i>The segfault occurs at the end of the file which is denoted by the TRLR</i> - what does it mean? You said <code>strlen</code> is causing the segfault."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1517422033, "post_id": 48548553, "comment_id": 84093351, "body": "Enable all compiler warnings and make your program compile clean (without adding any casts). Then use valgrind or gcc/clang sanitizers to catch errors."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1517422143, "post_id": 48548553, "comment_id": 84093425, "body": "<i>&quot;The segfault occurs at the end of the file&quot;</i>. What happens when <code>fgets</code> returns <code>NULL</code>, after the last line of the file (check the idiomatic way to write a loop)? It is essential to check return values from functions such as <code>fgets</code> and <code>strtok</code> which can return <code>NULL</code> before passing the pointer on."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1517422159, "post_id": 48548553, "comment_id": 84093437, "body": "Please remove the image of your gdb output and replace it with the output as copy-and-pasted text (formatted as code)."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1517422258, "post_id": 48548553, "comment_id": 84093494, "body": "<code>strlen(&quot;TRLR&quot;)</code> will not cause a segfault. <code>strlen(toParse)</code> may cause a segfault if <code>toParse</code> doesn&#39;t point to a string, i.e., if <code>toParse</code> is a null pointer, or an invalid pointer, or a pointer to something that doesn&#39;t contain a terminating null character."}, {"owner": {"reputation": 157, "user_id": 8524363, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NVtOB.png?s=128&g=1", "display_name": "arkdevelopment", "link": "https://stackoverflow.com/users/8524363/arkdevelopment"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1517422612, "post_id": 48548553, "comment_id": 84093674, "body": "@KeithThompson Does it have to have a terminator at the end for strlen to work? Ex. (&#39;\\0&#39;). I&#39;m asking because as shown by gdb, toParse = &quot;TRLR&quot;"}, {"owner": {"reputation": 157, "user_id": 8524363, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NVtOB.png?s=128&g=1", "display_name": "arkdevelopment", "link": "https://stackoverflow.com/users/8524363/arkdevelopment"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1517422873, "post_id": 48548553, "comment_id": 84093807, "body": "@WeatherVane In terms of fgets, I get the total number of lines in the file before executing by reading through the file character by character and adding a line any time a \\n\\r is found. So I don&#39;t think it could be that, but I could be mistaken?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1517422927, "post_id": 48548553, "comment_id": 84093832, "body": "Without MCVE this is a guessing game."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1517423220, "post_id": 48548553, "comment_id": 84093993, "body": "@arkdevelopment: Yes, there absolutely has to be a terminating <code>&#39;\\0&#39;</code>. Without it, it&#39;s not a string, and <code>strlen</code> returns the length of a string. If you give it something that isn&#39;t a pointer to a string, the behavior is undefined. (If there happens to be a zero byte past the end of the object, <code>strlen</code> might return some incorrect value rather than blowing up; that&#39;s the nature of undefined behavior.)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1517423543, "post_id": 48548553, "comment_id": 84094170, "body": "The last line in the file may not have a newline so the count can be off by one (less). The idiomatic way to use <code>fgets</code> is <code>while(fgets(buffer, 255, file) != NULL) { ... }</code> but I would advise a bigger buffer during development to prevent a line being split."}, {"owner": {"reputation": 157, "user_id": 8524363, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NVtOB.png?s=128&g=1", "display_name": "arkdevelopment", "link": "https://stackoverflow.com/users/8524363/arkdevelopment"}, "edited": false, "score": 0, "creation_date": 1517423877, "post_id": 48548553, "comment_id": 84094339, "body": "fgets was sending in a NULL line. Problem has been fixed. Thanks guys! I don&#39;t think I can set a comment to an accepted answer, but I&#39;d probably set Weather Vane&#39;s previous response to being the accepted answer."}], "answers": [{"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 1, "last_activity_date": 1517424833, "creation_date": 1517424833, "answer_id": 48549479, "question_id": 48548553, "link": "https://stackoverflow.com/questions/48548553/why-does-strlentrlr-cause-a-segfault/48549479#48549479", "title": "Why Does strlen(&quot;TRLR&quot;) cause a segfault?", "body": "<p>The last line in the file may not have a newline so counting them with a first pass can be off by one (less). The idiomatic way to use <code>fgets</code> is </p>\n\n<pre><code>while(fgets(buffer, 255, file) != NULL) { ... }\n</code></pre>\n\n<p>but I would advise a bigger buffer during development to prevent a line being split. </p>\n"}], "owner": {"reputation": 157, "user_id": 8524363, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NVtOB.png?s=128&g=1", "display_name": "arkdevelopment", "link": "https://stackoverflow.com/users/8524363/arkdevelopment"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "closed_date": 1517424019, "accepted_answer_id": 48549479, "answer_count": 1, "score": -3, "last_activity_date": 1517424833, "creation_date": 1517421343, "last_edit_date": 1517422572, "question_id": 48548553, "link": "https://stackoverflow.com/questions/48548553/why-does-strlentrlr-cause-a-segfault", "closed_reason": "Not suitable for this site", "title": "Why Does strlen(&quot;TRLR&quot;) cause a segfault?", "body": "<p>I have a program in C that's parsing a file. It works for a small file, however, when I run it with a larger file and I reach a \"TRLR\" string that I try to get the length of, it causes a segfault.</p>\n\n<pre><code>int length = 0;\nlength = strlen(toParse);\n</code></pre>\n\n<p>Running this in gdb, toParse is equal to \"TRLR\", length is equal to 0 even after running strlen on the variable.</p>\n\n<p>GDB Output: </p>\n\n<pre><code>Breakpoint 1, initializeField (toParse=0x7fffffffe0e2 \"TRLR\")\n    at ./src/GEDCOMutilities.c:79\n79          printf(\"Before length = strlen(toParse\\n\");\n(gdb) p toParse\n$12 = 0x7ffffffffffe0e2 \"TRLR\"\n</code></pre>\n\n<p>Edit (Code to show where the information is coming from): </p>\n\n<pre><code>    fgets(buffer, 255, file);\n    //Check if it's a number between 0-99\n    if ((isdigit(buffer[0])) || (isdigit(buffer[0] &amp;&amp; isdigit(buffer[1])))) {\n        //Get the number and store into toParse\n        toParse = strtok(buffer, \" \");\n        int num = atoi(toParse);\n\n        //Create and initialize a new structure with the line's other information\n        StructureToStoreInto* tempStructure = initialize(toParse);\n</code></pre>\n\n<p>Essentially what I'm doing is getting a line from a file that should have a structure as such: \nNumber Tag/Reference Value\nSo I check to make sure that the number falls between 0-99 (valid numbers), then I send the rest of the line into my initialize function to be parsed and stored into the structure. (I know regex would be a much simpler way of doing the validation)</p>\n"}, {"tags": ["c", "linux", "aix"], "comments": [{"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 1, "creation_date": 1517421668, "post_id": 48548526, "comment_id": 84093102, "body": "If you just want to prevent concurrent access by multiple instances of the program, <code>flock</code> would probably be the closest thing.  Otherwise, I don&#39;t know if there are any &quot;mandatory locks&quot; available in Linux."}, {"owner": {"reputation": 113, "user_id": 6781193, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/HGWd5.png?s=128&g=1", "display_name": "henninb", "link": "https://stackoverflow.com/users/6781193/henninb"}, "reply_to_user": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 0, "creation_date": 1517425147, "post_id": 48548526, "comment_id": 84095040, "body": "Daniel, thanks for the reply, I&#39;m aware of flock and lockf, however there are limitations even with those with respect to race conditions. I would like to &quot;lock&quot; the file before the file is opened/created."}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 0, "creation_date": 1517426488, "post_id": 48548526, "comment_id": 84095734, "body": "Your concept of locking sounds strange. Even &quot;before file is created&quot;? That&#39;s roughly equivalent to &quot;prevent a path name to be created&quot;"}], "owner": {"reputation": 113, "user_id": 6781193, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/HGWd5.png?s=128&g=1", "display_name": "henninb", "link": "https://stackoverflow.com/users/6781193/henninb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517421278, "creation_date": 1517421278, "question_id": 48548526, "link": "https://stackoverflow.com/questions/48548526/aix-option-o-nshare-during-open-system-call-not-available-on-centos-7", "title": "AIX option O_NSHARE during open system call, not available on Centos 7", "body": "<p>I am attempting to port code from AIX to Linux (Centos7 32bit). In doing so I have a snip of code that I cannot find like for like and would appreciate any advise. In the open system call I am trying to assure that no process has this file open and precludes subsequent opens. Please let me know if/how this functionality can be ported to Linux.</p>\n\n<p>Below is a snip of code that work on AIX.</p>\n\n<pre><code>if( -1 != (fd = open(pidfname, O_RDWR|O_NSHARE|O_NDELAY, S_IRUSR|S_IWUSR|S_IRGRP|S_IROTH)) ) {\n</code></pre>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1517421221, "post_id": 48548469, "comment_id": 84092855, "body": "It would make sense if they expect the function to set the passed pointer to NULL after freeing."}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1517421307, "post_id": 48548469, "comment_id": 84092889, "body": "It&#39;s not necessary to catch with double pointer but its depends how  <code>puzzle_free()</code> gets called and what argument  is passed in <code>puzzle_free()</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1517421308, "post_id": 48548469, "comment_id": 84092890, "body": "That&#39;s an odd thing to see, but like Eugene the only explanation I can think of is you squish the pointer once you free it. That is a very quirky design, and probably some attempt to avoid using a freed pointer, but since C is rife with problems like this it&#39;s a tiny fix for an endemic problem. Using a NULL pointer by accident is just as dangerous as using one that&#39;s been released."}, {"owner": {"reputation": 2531, "user_id": 1555662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7046fb9264a333e4c8ac89180f7fed20?s=128&d=identicon&r=PG", "display_name": "olivecoder", "link": "https://stackoverflow.com/users/1555662/olivecoder"}, "edited": false, "score": 0, "creation_date": 1517421396, "post_id": 48548469, "comment_id": 84092948, "body": "the double pointer when passing the structure pointer to the puzzle_free function is not related to the type of data in the struct. please read your textbook again."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1517421549, "post_id": 48548469, "comment_id": 84093034, "body": "@tadman Setting freed pointer to null is useful for checking. I guess it&#39;s legit to have a design where some dynamic data structure is filled with such a pointers and <code>NULL</code> will indicate the invalid ones."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1517421713, "post_id": 48548469, "comment_id": 84093132, "body": "@EugeneSh. Some systems set pointers to <code>0xdeadbeef</code> or something distinctive so you can know if it was freed, or if it was always NULL. You can use your own nonsense values for this purpose, an invalid pointer is an invalid pointer."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1517421771, "post_id": 48548469, "comment_id": 84093165, "body": "@tadman Sure. The above <code>puzzle_free</code> can do this too :)"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1517422026, "last_edit_date": 1517422026, "creation_date": 1517421298, "answer_id": 48548530, "question_id": 48548469, "link": "https://stackoverflow.com/questions/48548469/freeing-struct-that-cointains-double-pointer/48548530#48548530", "title": "Freeing struct that cointains double pointer", "body": "<p>Well that depends. If you did this,</p>\n\n<pre><code>puzzle **a = malloc(sizeof *a * NUMITEMS);\nfor(size_t i = 0; i &lt; NUMITEMS; i++)\n   a[i]= malloc(sizeof *a[i] * NUMITEMS);\n</code></pre>\n\n<p>Then ofcourse free can be like this. <code>myfree(&amp;puzzle);</code> - signature being <code>myfree(puzzle *** a)</code>.</p>\n\n<p>Then if you had simply this,</p>\n\n<pre><code>puzzle* a = malloc(sizeof *a *NUMITEMS);\n</code></pre>\n\n<p>Then <code>myfree(&amp;a)</code> (signature containing double pointer) would suffice. It depends on the what you are trying to free.</p>\n\n<pre><code>void myfree(puzzle **a){\n    free(*a);\n}\n</code></pre>\n\n<p>The way the book mentioned - it is safe to say that book used the kind of allocation shown in the second above. You have to pass the address of it because otherwise you will be making changes to a local variable. (This is why the double pointer is needed as mentioned by book).</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 9043599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/424663a0a5b8e1e0ba353304fffb6440?s=128&d=identicon&r=PG&f=1", "display_name": "Nerd", "link": "https://stackoverflow.com/users/9043599/nerd"}, "edited": false, "score": 0, "creation_date": 1517429037, "post_id": 48550203, "comment_id": 84097067, "body": "How does this prevent access after free? Could there be a dangling pointer?"}, {"owner": {"reputation": 15037, "user_id": 1111371, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/85fbe34f335b26ff6f6c8ef921a682ae?s=128&d=identicon&r=PG", "display_name": "ugoren", "link": "https://stackoverflow.com/users/1111371/ugoren"}, "reply_to_user": {"reputation": 33, "user_id": 9043599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/424663a0a5b8e1e0ba353304fffb6440?s=128&d=identicon&r=PG&f=1", "display_name": "Nerd", "link": "https://stackoverflow.com/users/9043599/nerd"}, "edited": false, "score": 0, "creation_date": 1517429517, "post_id": 48550203, "comment_id": 84097312, "body": "@Nerd, it does not completely prevent it. It helps prevent it, by setting this one pointer to <code>NULL</code>."}], "tags": [], "owner": {"reputation": 15037, "user_id": 1111371, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/85fbe34f335b26ff6f6c8ef921a682ae?s=128&d=identicon&r=PG", "display_name": "ugoren", "link": "https://stackoverflow.com/users/1111371/ugoren"}, "is_accepted": true, "score": 1, "last_activity_date": 1517427669, "creation_date": 1517427669, "answer_id": 48550203, "question_id": 48548469, "link": "https://stackoverflow.com/questions/48548469/freeing-struct-that-cointains-double-pointer/48550203#48550203", "title": "Freeing struct that cointains double pointer", "body": "<p>It probably has nothing to do with the double pointer contained in the struct, but is just a way to write free functions that helps prevent access after free.<br>\nEugene Sh. refers to it in his comment.</p>\n\n<p>The implementation of <code>puzzle_free</code> would be:</p>\n\n<pre><code>void puzzle_free(puzzle** puzzle_p) {\n    puzzle *puzzle = *puzzle_p\n    // Somehow free puzzle-&gt;data\n    free(puzzle);\n    *puzzle_p = NULL;\n}\n</code></pre>\n\n<p>And usage would be:</p>\n\n<pre><code>puzzle *puzzle = malloc(...)\n// Fill it, use it.\npuzzle_free(&amp;puzzle);\n// puzzle pointer is now NULL\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9043599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/424663a0a5b8e1e0ba353304fffb6440?s=128&d=identicon&r=PG&f=1", "display_name": "Nerd", "link": "https://stackoverflow.com/users/9043599/nerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 48550203, "answer_count": 2, "score": 1, "last_activity_date": 1517427669, "creation_date": 1517421064, "question_id": 48548469, "link": "https://stackoverflow.com/questions/48548469/freeing-struct-that-cointains-double-pointer", "title": "Freeing struct that cointains double pointer", "body": "<p>Say I have a struct defined as follows:</p>\n\n<pre><code>typedef struct {\nint width;\nint height;\nchar **data;\n} puzzle;\n</code></pre>\n\n<p>Then, according to my textbook, the free function should look like this:</p>\n\n<pre><code>void puzzle_free(puzzle** puzzle) \n</code></pre>\n\n<p>But I don't see why puzzle should be a double pointer in the free function. </p>\n"}, {"tags": ["c", "video-streaming", "libvlc", "mpv"], "owner": {"reputation": 441, "user_id": 3464102, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/7X7wk.jpg?s=128&g=1", "display_name": "serg.v.gusev", "link": "https://stackoverflow.com/users/3464102/serg-v-gusev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 550, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1517420756, "creation_date": 1517420756, "question_id": 48548393, "link": "https://stackoverflow.com/questions/48548393/get-raw-video-frames-from-mpv-callback-or-render-to-specific-memory-address", "title": "Get raw video frames from MPV (callback or render to specific memory address)", "body": "<p>There is <a href=\"https://mpv.io/\" rel=\"nofollow noreferrer\">mpv player</a> which is a fork of old MPlayer. It can be built as library and has API to render video frames to many video outputs such as OpenGL surface, Direct3D, SDL and others. I am trying to use this library in my current project to decode flv stream from cloud.</p>\n\n<p>But i can't find a way to render decoded video frames direct to user-space allocated memory buffer. I need this option for specific reasons, and interfaces listed above aren't suitable for my task. I also need a callback which will be called after every frame is decoded and written in memory.</p>\n\n<p>Is there any way to reach this functionality using standard mpv API from <a href=\"https://github.com/mpv-player/mpv/blob/master/libmpv/client.h\" rel=\"nofollow noreferrer\">libmpv/client.h</a>? If no, how to write simple <a href=\"https://github.com/mpv-player/mpv/tree/master/video/out\" rel=\"nofollow noreferrer\">video out driver</a> and pass a pointer to custom memory to it?</p>\n\n<p>I had used libVLC for my task already and it has <a href=\"https://www.videolan.org/developers/vlc/doc/doxygen/html/group__libvlc__media__player.html#ga612605f2e5c638d9f4ed59021d714bf0\" rel=\"nofollow noreferrer\">clear interface</a> to set up few callbacks for my needs, but unfortunately libVLC 2.x contains <a href=\"https://forum.videolan.org/viewtopic.php?t=117809\" rel=\"nofollow noreferrer\">bug with gray frames artifacts</a> appearing during play video stream from cloud.</p>\n"}, {"tags": ["c", "unix"], "answers": [{"tags": [], "owner": {"reputation": 627, "user_id": 6694404, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bd260580a43b5bb091b40509eee0bfe9?s=128&d=identicon&r=PG&f=1", "display_name": "P.Carlino", "link": "https://stackoverflow.com/users/6694404/p-carlino"}, "is_accepted": true, "score": 0, "last_activity_date": 1517427560, "creation_date": 1517427560, "answer_id": 48550162, "question_id": 48548261, "link": "https://stackoverflow.com/questions/48548261/malformed-packet-in-dns-client-implementation/48550162#48550162", "title": "Malformed packet in dns client implementation", "body": "<p>I solved finally. Studing better the protocoll ( the domain name system) where the reference is at this <a href=\"https://www.ietf.org/rfc/rfc1035.txt\" rel=\"nofollow noreferrer\">link</a> a the wrong part was in the section called qname ( the name of the host that in my case the protocoll wasn't able  to determinate the size) \nSo as the document said qname is: </p>\n\n<pre><code> a domain name represented as a sequence of labels, where\n            each label consists of a length octet followed by that\n            number of octets.  The domain name terminates with the\n            zero length octet for the null label of the root.  Note\n            that this field may be an odd number of octets; no\n            padding is used.\n</code></pre>\n\n<p>So i changed my code to transform www.example.com in 3www7example3com\nand everything works</p>\n"}], "owner": {"reputation": 627, "user_id": 6694404, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bd260580a43b5bb091b40509eee0bfe9?s=128&d=identicon&r=PG&f=1", "display_name": "P.Carlino", "link": "https://stackoverflow.com/users/6694404/p-carlino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 965, "favorite_count": 0, "accepted_answer_id": 48550162, "answer_count": 1, "score": 1, "last_activity_date": 1517427560, "creation_date": 1517420291, "question_id": 48548261, "link": "https://stackoverflow.com/questions/48548261/malformed-packet-in-dns-client-implementation", "title": "Malformed packet in dns client implementation", "body": "<p>Hi there for fun i'm developing a tiny dns client on a unix system.\nI've read the documentation about dns protocol i wrote a tiny function </p>\n\n<pre><code>int makeQuestion(char* dns_addr,char *name){\nint s = socket(AF_INET,SOCK_DGRAM,IPPROTO_UDP);\nregister int len_name = strlen(name);\n\nif(s&lt;0)\n    return errno;\n\n\nstruct sockaddr_in address;\nbzero(&amp;address,sizeof(address));\naddress.sin_port = htons(53);\naddress.sin_addr.s_addr = inet_addr(dns_addr);\n\ndns_header header;\nmemset(&amp;header,0,sizeof(dns_header));\nheader.id = htons(getpid());\nheader.q_count = htons(1);\ndns_question quest = {\n        .qclass = htons(IN),\n        .qtype = htons(A)\n};\n\nregister int pack_size = sizeof(dns_header)+len_name+2+sizeof(dns_question);\nchar *packet = malloc(pack_size);\n\nmemcpy(packet,&amp;header,sizeof(dns_header));\nfor(int i = 0;i&lt;len_name;i++)\n    *(packet +i +sizeof(dns_header)) = name[i];\n\npacket[len_name+sizeof(dns_header)] = '.';\npacket[len_name+sizeof(dns_header)+1] = '\\0';\nmemcpy(packet+sizeof(dns_header)+len_name+2,&amp;quest,sizeof(dns_question));\n\n\nsendto(s,packet,pack_size,NULL,&amp;address,sizeof(address));\nreturn OK;\n}\n</code></pre>\n\n<p>The structure for the dns header and dns query are declared like: </p>\n\n<pre><code>//DNS header structures\ntypedef struct dns_header\n{\n    uint16_t id; // identification number\n\n    uint8_t rd :1; // recursion desired\n    uint8_t tc :1; // truncated message\n    uint8_t aa :1; // authoritive answer\n    uint8_t opcode :4; // purpose of message\n    uint8_t qr :1; // query/response flag\n\n    uint8_t rcode :4; // response code\n    uint8_t cd :1; // checking disabled\n    uint8_t ad :1; // authenticated data\n    uint8_t z :1; // its z! reserved\n    uint8_t ra :1; // recursion available\n\n    uint16_t q_count; // number of question entries\n    uint16_t ans_count; // number of answer entries\n    uint16_t auth_count; // number of authority entries\n    uint16_t add_count; // number of resource entries\n}dns_header;\n\n\ntypedef struct dns_question\n{\n    uint16_t qtype;\n    uint16_t qclass;\n}dns_question;\n</code></pre>\n\n<p>Now i executed the code while wireshark was running and i saw the packet that seemed to be correct but in the query section wireshark said</p>\n\n<pre><code>Name: &lt;Unknown extended label&gt;\n</code></pre>\n\n<p>So the question is there is a way i have to use to store the dns name of the queried host in the packet or there is something wrong in the implementation. Sorry for the loosing of time and sorry for my English. Thanks indeed</p>\n"}, {"tags": ["c", "linux", "sockets", "bind", "can-bus"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1517420416, "post_id": 48548239, "comment_id": 84092434, "body": "<code>addr.can_ifindex = ifr.ifr_ifindex;</code> is undefined behavior. You&#39;ve never initialized <code>ifr_ifindex</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1517420435, "post_id": 48548239, "comment_id": 84092440, "body": "This sort of thing <b>can</b> be a symptom of <i>undefined behaviour</i> although I don&#39;t know what."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1517420605, "post_id": 48548239, "comment_id": 84092512, "body": "should make sure all of <code>addr</code> is populated properly."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 2, "creation_date": 1517425353, "post_id": 48548239, "comment_id": 84095154, "body": "You should start with <code>memset(&amp;addr, 0, sizeof addr); memset(&amp;ifr, 0, sizeof ifr);</code> and then set <code>ifr_ifr_ifindex</code> to a meaningful value before copying it into <code>addr.can_ifindex</code>.  (This cut-down program doesn&#39;t appear to need <code>ifr</code> at all, but I imagine it serves some function in the real program.)"}, {"owner": {"reputation": 41, "user_id": 9293781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vq5yN.jpg?s=128&g=1", "display_name": "Doom", "link": "https://stackoverflow.com/users/9293781/doom"}, "edited": false, "score": 0, "creation_date": 1517471846, "post_id": 48548239, "comment_id": 84111383, "body": "Initialising <code>addr</code> and <code>ifr</code> with memset fixed our problem. We set <code>ifr.ifr_name</code> to our device name and <code>addr.can_family</code> to <code>AF_CAN</code> but this has been cut out as it didn&#39;t affect the behaviour. <code>ifr</code> is needed for our <code>ioctl</code> which was cut as well."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1517608784, "post_id": 48548239, "comment_id": 84180160, "body": "regarding: <code>addr.can_ifindex = ifr.ifr_ifindex;</code>  the struct <code>ifr</code> has not been set to anything, so this statement is undefined behavior."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1517608975, "post_id": 48548239, "comment_id": 84180220, "body": "regarding: <code>gcc main.c</code>  when compiling, always enable the warnings, then fix those warnings.  ( for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnu11</code> )"}], "answers": [{"comments": [{"owner": {"reputation": 128, "user_id": 9270351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35c46013d34eef296562e448cf68276?s=128&d=identicon&r=PG", "display_name": "MarcusS", "link": "https://stackoverflow.com/users/9270351/marcuss"}, "edited": false, "score": 0, "creation_date": 1517422956, "post_id": 48548446, "comment_id": 84093842, "body": "As it&#39;s only a CAN socket, you just need the address family AF_CAN and the ifindex of the corresponding interface (or &#39;0&#39; for all interfaces)."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 128, "user_id": 9270351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35c46013d34eef296562e448cf68276?s=128&d=identicon&r=PG", "display_name": "MarcusS", "link": "https://stackoverflow.com/users/9270351/marcuss"}, "edited": false, "score": 0, "creation_date": 1517542924, "post_id": 48548446, "comment_id": 84147331, "body": "@MarcusS Yeah but which interface?"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 4, "last_activity_date": 1517420957, "creation_date": 1517420957, "answer_id": 48548446, "question_id": 48548239, "link": "https://stackoverflow.com/questions/48548239/why-do-we-need-an-unused-char-array-for-a-successfull-bind/48548446#48548446", "title": "Why do we need an unused char array for a successfull bind?", "body": "<p>You're causing all sorts of undefined behavior due to use of uninitialized variables.</p>\n\n<p>You never initialize <code>ifr</code>, then you use <code>ifr.ifr_ifindex</code>.</p>\n\n<p>You never initialize <code>addr.tp</code>, then you pass <code>addr</code> as the <code>sockaddr</code> parameter to <code>bind()</code>.</p>\n\n<p>That it ever succeeds <em>at all</em> is more surprising than the fact that the failure depends on the size of the <code>empty</code> array. What address are you expecting the socket to be bound to?</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 9293781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vq5yN.jpg?s=128&g=1", "display_name": "Doom", "link": "https://stackoverflow.com/users/9293781/doom"}, "is_accepted": false, "score": 3, "last_activity_date": 1517476807, "creation_date": 1517476807, "answer_id": 48559159, "question_id": 48548239, "link": "https://stackoverflow.com/questions/48548239/why-do-we-need-an-unused-char-array-for-a-successfull-bind/48559159#48559159", "title": "Why do we need an unused char array for a successfull bind?", "body": "<p>We followed the documentation found at <a href=\"https://www.kernel.org/doc/Documentation/networking/can.txt\" rel=\"nofollow noreferrer\">kernel.org</a>.</p>\n\n<p>In \"4. How to use SocketCAN\" (approx. line 60) this example is given:</p>\n\n<pre><code>int s;\nstruct sockaddr_can addr;\nstruct ifreq ifr;\n\ns = socket(PF_CAN, SOCK_RAW, CAN_RAW);\n\nstrcpy(ifr.ifr_name, \"can0\" );\nioctl(s, SIOCGIFINDEX, &amp;ifr);\n\naddr.can_family = AF_CAN;\naddr.can_ifindex = ifr.ifr_ifindex;\n\nbind(s, (struct sockaddr *)&amp;addr, sizeof(addr));\n\n(..)\n</code></pre>\n\n<p>While it states that no error checking has been implemented neither <code>addr</code> nor <code>ifr</code> have been fully initialised (like all of you mentioned here). Therefore the given example encounters the same problem as our program.\nInitialising them with <code>memset</code> like @zwol mentioned to ensure all values are set to 0 before working with them fixes this unexpected behaviour completely.</p>\n\n<p>Thanks everyone.</p>\n"}], "owner": {"reputation": 41, "user_id": 9293781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vq5yN.jpg?s=128&g=1", "display_name": "Doom", "link": "https://stackoverflow.com/users/9293781/doom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1517476807, "creation_date": 1517420217, "question_id": 48548239, "link": "https://stackoverflow.com/questions/48548239/why-do-we-need-an-unused-char-array-for-a-successfull-bind", "title": "Why do we need an unused char array for a successfull bind?", "body": "<p>We're currently developing a small tool that reads CAN-messages and evaluates the data contained. The <code>bind()</code> command doesn't return 0 (for a successfull bind) when the char array <code>empty</code> is too short, too long or not present. This bug is present in the shortened program below.</p>\n\n<pre><code>#include &lt;sys/socket.h&gt;     // socket, bind, PF_CAN, SOCK_RAW\n#include &lt;linux/if.h&gt;       // ifreq\n#include &lt;linux/can.h&gt;      // sockaddr_can, CAN_RAW\n#include &lt;stdio.h&gt;          // printf\n\nint main()\n{\n    struct sockaddr_can addr;\n    struct ifreq ifr;\n    int socketFd = socket(PF_CAN, SOCK_RAW, CAN_RAW);\n    addr.can_ifindex = ifr.ifr_ifindex;\n\n    char empty[5];     // change length or comment out to provoke the error\n\n    if(bind(socketFd, (struct sockaddr *) &amp;addr, sizeof(addr)) != 0)\n    {\n        printf(\"Unable to bind the CAN-socket.\\n\");\n    }\n}\n</code></pre>\n\n<p>The behaviour changes with the length of our char array <code>empty</code>. \nFor example <code>[5]</code> works, while <code>[24]</code> doesn't.\nWe tested this with GCC 5.4.0 and 7.2.0 which both showed this behaviour.\nUnder GCC 5.3.0 the presence and lentgh of <code>empty</code> do not influence our <code>bind()</code>.</p>\n\n<p>For reference we used</p>\n\n<pre><code>gcc main.c\n./a.out\n</code></pre>\n\n<p>Why do we need an unused char array with GCC 5.4.0 and 7.2.0 for a successfull bind?</p>\n"}, {"tags": ["c", "visual-studio"], "comments": [{"owner": {"reputation": 908, "user_id": 1019079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0W76c.png?s=128&g=1", "display_name": "Michael O&#39;Neill", "link": "https://stackoverflow.com/users/1019079/michael-oneill"}, "edited": false, "score": 2, "creation_date": 1517420247, "post_id": 48548204, "comment_id": 84092344, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/20821416/c-programming-in-visual-studio\">C programming in Visual Studio</a>"}], "answers": [{"tags": [], "owner": {"reputation": 189, "user_id": 7153508, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZYUym.gif?s=128&g=1", "display_name": "akasoggybunz", "link": "https://stackoverflow.com/users/7153508/akasoggybunz"}, "is_accepted": true, "score": 3, "last_activity_date": 1555953541, "last_edit_date": 1555953541, "creation_date": 1517420722, "answer_id": 48548383, "question_id": 48548204, "link": "https://stackoverflow.com/questions/48548204/c-support-in-visual-studio-2017/48548383#48548383", "title": "C support in visual studio 2017", "body": "<p>Using the <em>Visual Studio Installer</em> if you click on your already installed version of Visual Studio (<em>in the image I clicked on my VS 2017 Community</em>).  </p>\n\n<blockquote>\n  <p>Under <strong>Individual components</strong> --> <em>Compilers, build tools and run-times</em> you can check <code>Clang/C2</code>. Clang is a <code>C</code> compiler.</p>\n</blockquote>\n\n<p><strong>Answer:</strong> by default it appears not, but you can install the Clang component and it appears you will be able to. </p>\n\n<p><a href=\"https://i.stack.imgur.com/XDiKR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XDiKR.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 31, "user_id": 8738695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/225c4c3e5ae8d5c16cc7b3943b949a57?s=128&d=identicon&r=PG&f=1", "display_name": "bobiscool", "link": "https://stackoverflow.com/users/8738695/bobiscool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 48548383, "answer_count": 1, "score": 1, "last_activity_date": 1560189458, "creation_date": 1517420063, "last_edit_date": 1560189458, "question_id": 48548204, "link": "https://stackoverflow.com/questions/48548204/c-support-in-visual-studio-2017", "title": "C support in visual studio 2017", "body": "<p>Not C# or C++, but C. Is there any C support in Visual Studio?</p>\n"}, {"tags": ["c++", "c", "linux", "gcc", "libgcrypt"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517419881, "post_id": 48548050, "comment_id": 84092125, "body": "Can code not use <code>static</code> in the data definitions?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1517419934, "post_id": 48548050, "comment_id": 84092154, "body": "If it is <code>static</code>, the author&#39;s idea was that it should not be directly accessed by other modules."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517420037, "post_id": 48548050, "comment_id": 84092222, "body": "@chux, inside the libgcrypt library , static function inside other source file are using these (i.e. encT) static data."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1517420186, "post_id": 48548050, "comment_id": 84092309, "body": "I want to access those static data from other independent C program (not part of library). As the static data section are located/loaded at fixed OFFSET, we may access those data with respect to address of some function."}, {"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 1, "creation_date": 1517423188, "post_id": 48548050, "comment_id": 84093975, "body": "Can&#39;t you just copy the definitions? They&#39;re const anyway and won&#39;t change."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "reply_to_user": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1517487490, "post_id": 48548050, "comment_id": 84120697, "body": "@BjornA., no I want to access static data of shared library. so by simply copying is not  a solution."}], "owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517488165, "creation_date": 1517419601, "last_edit_date": 1517488165, "question_id": 48548050, "link": "https://stackoverflow.com/questions/48548050/how-to-access-read-only-static-const-data-of-shared-library-from-c-c-program", "title": "How to access read-only (static const) data of shared library from C/C++ program with known OFFSET", "body": "<p>I have installed libgcrypt shared library. libgcrypt.so file is generated .\nIt has some read-only data.</p>\n\n<pre><code>./configure   ( without -g option for debug symbol)\nmake install \n\n\nstatic const u32 encT[256] =\n  {\n    0xa56363c6, 0x847c7cf8, 0x997777ee, 0x8d7b7bf6,\n    0x0df2f2ff, 0xbd6b6bd6, 0xb16f6fde, 0x54c5c591,\n    0x50303060, 0x03010102, 0xa96767ce, 0x7d2b2b56,\n...\n\n}\n\nstatic const struct\n{\n  u32 T[256];\n  byte inv_sbox[256];\n} dec_tables =\n  {\n    {\n      0x50a7f451, 0x5365417e, 0xc3a4171a, 0x965e273a,\n      0xcb6bab3b, 0xf1459d1f, 0xab58faac, 0x9303e34b,\n      0x55fa3020, 0xf66d76ad, 0x9176cc88, 0x254c02f5,\n      .....},\n\n    {\n      0x52,0x09,0x6a,0xd5,0x30,0x36,0xa5,0x38,\n      0xbf,0x40,0xa3,0x9e,0x81,0xf3,0xd7,0xfb,\n      0x7c,0xe3,0x39,0x82,0x9b,0x2f,0xff,0x87,\n      .....\n    }  \n }\n</code></pre>\n\n<p>Using nm command I am able to find the offset of read-only data.</p>\n\n<pre><code>nm /usr/lib/libgcrypt.so | grep encT\n0008ffc0 r encT\n\nnm /usr/lib/libgcrypt.so | grep dec_tables\n0008fac0 r dec_tables\n</code></pre>\n\n<p>I want to access those read-only data from C/C++ program.</p>\n\n<pre><code>    //sample.c\n    // gcc sample.c -lgcrypt \n\n    #include &lt;gcrypt.h&gt;\n\n    int main()\n    {\n\n    // ADDRESS of encT[0] = ? + OFFSET  (0008ffc0)\n    //print value of encT[0] as 0xa56363c6\n    // ADDRESS of dec_tables.T[0] = ? + OFFSET (0008fac0)\n    //print value of dec_tables.T[0] as 0x50a7f451\n    //print value of dec_tables.inv_sbox[0] as 0x52\n\n    }\n</code></pre>\n\n<p>I have following questions </p>\n\n<ol>\n<li><p>How to use those offset to access those read-only data (encT,\ndec_tables.T,dec_tables.inv_sbox)  from C program ?</p>\n\n<p><strong>2. Is there any other way to find the ADDRESS of encT, dec_tables.T,dec_tables.inv_sbox ?</strong></p></li>\n</ol>\n\n<p>EDIT-1 :\nglobal(extern) function, gcry_cipher_decrypt()  is used to perform decryption and it calls static do_decrypt --> static do_decrypt_fn() which uses dec_tables.T,dec_tables.inv_sbox. So it is possible to find ADDRESS of dec_tables.T,dec_tables.inv_sbox with respect to address of \ngcry_cipher_decrypt ?    </p>\n\n<p>I am using gcc-4.9, Ubuntu 16.04.</p>\n\n<p>It will be a great help if someone help me to complete the above sample program or any link to understand how I can do that ? Thanks in advance.   </p>\n"}, {"tags": ["c", "string", "permutation"], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1517423063, "last_edit_date": 1517423063, "creation_date": 1517419565, "answer_id": 48548040, "question_id": 48547997, "link": "https://stackoverflow.com/questions/48547997/n-permutations-of-string-with-repetitions/48548040#48548040", "title": "N permutations of string (with repetitions)", "body": "<p>(Showing a different idea)If you look carefully you will see that all the permutations are the numbers in base-7. Consider <code>a</code> as <code>0</code>, <code>b</code> as <code>1</code> and so on. So for every number <code>1..n</code> you will convert it into base <code>7</code> and write it (By write it I mean, in place of <code>0</code> you put <code>a</code>,<code>1</code> - <code>b</code> etc). That will give you the required result. (Ofcourse in conversion you will have to append <code>0</code> to the left of the number as per number of digits you want to show). There are problems in your code:</p>\n\n<pre><code>char s[6]=\"abcdef\";\n</code></pre>\n\n<p>is legal in C. </p>\n\n<pre><code>s[6]=0;\n</code></pre>\n\n<p>This is not as you are accessing array index out of bound which is Undefined behavior. <code>strlen(t)</code> is undefined behavior as <code>t</code> is not NUL terminated.</p>\n\n<p>Also you have <code>fprintf(c,\"%s \",t);</code> in your code - this also leads to undefined behavior, it also expects a <code>char*</code> which points to a nul terminated <code>char</code> array. This will make your realize that how irrelevant it is to have something like this</p>\n\n<pre><code>char s[6]=\"abcdef\";\n</code></pre>\n\n<p>Long story short, use <code>char s[7]=\"abcdef\";</code> (same applies to <code>t</code> also).</p>\n"}], "owner": {"reputation": 9, "user_id": 8850944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6573c928f01c76cd4c6f37372e1ea80d?s=128&d=identicon&r=PG&f=1", "display_name": "Milo\u0161", "link": "https://stackoverflow.com/users/8850944/milo%c5%a1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1517439779, "creation_date": 1517419424, "last_edit_date": 1517439779, "question_id": 48547997, "link": "https://stackoverflow.com/questions/48547997/n-permutations-of-string-with-repetitions", "title": "N permutations of string (with repetitions)", "body": "<p>I have to print first n permutations with repetitions of a string. </p>\n\n<p>String is formed with characters 'a','b','c','d','e','f'.</p>\n\n<p>For example, first 10 permutations would be: aaaaaa,aaaaab,aaaaac,aaaaad,aaaaae,aaaaaf,aaaaba,aaaabb,aaaabc,aaaabd.</p>\n\n<p>This is my failed attempt:</p>\n\n<pre><code>int main()\n{    \n  FILE *c;\n  c = fopen(\"C:\\\\Users\\\\Korisnik\\\\Desktop\\\\tekst\\\\permutacija.txt\", \"w\");\n  char s[6] = \"abcdef\";\n  char t[6] = \"aaaaaa\";\n  s[6] = '\\0';\n  t[6] = '\\0';\n  int k = strlen(t);\n  int m = k;\n  int n;\n  scanf(\"%d\", &amp;n);\n  int br = 0;\n  int i = 0;\n\n  while (br &lt; n) {\n    i = 0;\n\n    while (i &lt; 6) {\n      t[k-1] = s[i];\n      fprintf(c, \"%s \", t);\n      fprintf(c, \"\\n\");\n      i++;\n      br++;\n\n      if (br == n) {\n        exit(1);\n      }\n    }\n\n    t[k-1] = 'a';\n    k--;\n\n    if (k &lt; 0) {\n      k = m;\n    }\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>And my output for first 10 permutations is:\naaaaa \naaaaab \naaaaac \naaaaad \naaaaae \naaaaaf \naaaa \naaaaba \naaaaca \naaaada </p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["c", "fork"], "comments": [{"owner": {"reputation": 1, "user_id": 9293767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a63cf8bcc20d8f6bbd0c224f64f3561?s=128&d=identicon&r=PG&f=1", "display_name": "Kyla", "link": "https://stackoverflow.com/users/9293767/kyla"}, "edited": false, "score": 2, "creation_date": 1517419477, "post_id": 48547996, "comment_id": 84091869, "body": "I posted a similar question earlier but I wasn&#39;t sure how to edit a post so I just posted a new question."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1517420026, "post_id": 48547996, "comment_id": 84092215, "body": "Your code won&#39;t compile - it&#39;s missing a declaration for <code>file</code> that is used by the child processes. It&#39;s a moot point though as your code can&#39;t work as processes created by <code>fork</code> don&#39;t share memory with their parent."}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1517420772, "post_id": 48547996, "comment_id": 84092593, "body": "Click the edit link on the left of the question footer. You can delete this one."}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1517423283, "post_id": 48547996, "comment_id": 84094037, "body": "<code>fork()</code> creates a <i>copy</i> of the current process, it is not multi-threading."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517451923, "post_id": 48554373, "comment_id": 84105242, "body": "Nice, thorough explanation."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 1, "last_activity_date": 1517452631, "last_edit_date": 1517452631, "creation_date": 1517451276, "answer_id": 48554373, "question_id": 48547996, "link": "https://stackoverflow.com/questions/48547996/creating-seperate-child-function-for-counting-each-letter-in-a-file/48554373#48554373", "title": "Creating seperate child function for counting each letter in a file", "body": "<p>The problem with forking when the parent has open a file for reading, is that\nalthough all children inherit copies of open <strong>file descriptors</strong>, they all\nshare the same <strong>file description</strong>.</p>\n\n<blockquote>\n  <p><em><a href=\"https://linux.die.net/man/2/fork\" rel=\"nofollow noreferrer\">man fork</a></em></p>\n  \n  <p>The child process is an exact duplicate of the parent process except for the following points:</p>\n  \n  <p>[...]</p>\n  \n  <ul>\n  <li>The child inherits copies of the parent's set of open file descriptors. Each file descriptor in the child refers to the <strong>same open\n  file description (see <a href=\"https://linux.die.net/man/2/open\" rel=\"nofollow noreferrer\"><code>open(2)</code></a>) as the corresponding file descriptor in the parent</strong>. This means that the two file descriptors share\n  open file status flags, file offset, and signal-driven I/O attributes (see the description of <code>F_SETOWN</code> and <code>F_SETSIG</code> in <a href=\"https://linux.die.net/man/2/fcntl\" rel=\"nofollow noreferrer\"><code>fcntl(2)</code></a>).</li>\n  </ul>\n</blockquote>\n\n<p>You can do such a program, but you would have to synchronize the children with\neach other, because every time a child does <code>fgetc(file)</code>, the file description\nadvances for all children. The synchronization would have to be written such as\nall children wait for the others to stop reading, do a <code>rewind</code> and then finally\nread. In that case having all these children is no gain at all.</p>\n\n<p>For more information about that, see this <a href=\"https://stackoverflow.com/a/11734354/1480131\">excellent answer</a> from this\nquestion: <a href=\"https://stackoverflow.com/questions/11733481/can-anyone-explain-a-simple-description-regarding-file-descriptor-after-fork\">Can anyone explain a simple description regarding &#39;file descriptor&#39; after fork()?</a></p>\n\n<p>Another problem with your code is this:</p>\n\n<pre><code>printf(\"%c: %i\\n\", characters[i], counter[i]);\n</code></pre>\n\n<p><code>fork</code> duplicates the process and they both run in separate memory spaces.\nThe children's <code>counter</code> is a copy of the parent's <code>counter</code>, but a modification\nof <code>counter</code> in a child process will only affect the <code>counter</code> for that process,\nthe parent's <code>counter</code> is not affected by that. So in this case you are always\nprinting 0, because the parent never changed <code>counter</code>.</p>\n\n<p>Also, even if the modification of a child's <code>counter</code> would somehow propagate to\nthe parent, the parent should <strong>wait</strong> for the child process to make the\nmodification before accessing the variable. Again synchronization would be\nneeded for that.</p>\n\n<p>For the parent to benefit of the work of the children, it must communicate with\nthe children. One way to do it is by creating a pipe for each of the children. The\nparent closes the writing end of the pipes, the children close the reading end\nof the pipe. When the child does its work, it writes the results on the writing end of it's\npipe back to the parent and exits. The parent must then wait for every children,\nread from the reading end of the pipe.</p>\n\n<p>This program does exactly that:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n\nint main(int argc, char **argv)\n{\n    char characters[26] = \"abcdefghijklmnopqrstuvwxyz\";\n\n    if(argc != 2)\n    {\n        fprintf(stderr, \"usage: %s file\\n\", argv[0]);\n        return 1;\n    }\n\n    size_t i;\n    int pipes[26][2];\n\n    // creating the pipes for all children\n    for(i = 0; i &lt; 26; ++i)\n    {\n        if(pipe(pipes[i]) &lt; 0)\n        {\n            perror(\"unable to create a pipe\");\n            return 1;\n        }\n    }\n\n    pid_t pids[26];\n\n    memset(pids, -1, sizeof pids);\n\n\n    for(i = 0; i &lt; 26; ++i)\n    {\n        pids[i] = fork();\n        if(pids[i] &lt; 0)\n        {\n            fprintf(stderr, \"Unable to fork for child %lu: %s\\n\", i, strerror(errno));\n            continue;\n        }\n\n        if(pids[i] == 0)\n        {\n            // CHILD process\n\n            // closing reading end of pipe\n            close(pipes[i][0]);\n\n            FILE *fp = fopen(argv[1], \"r\");\n            if(fp == NULL)\n            {\n                close(pipes[i][1]);\n                exit(1);\n            }\n\n            int n = 0, c;\n\n            while((c = getc(fp)) != EOF)\n            {\n                if(c == characters[i])\n                    n++;\n            }\n\n            // sending answer back to parent through the pipe\n            write(pipes[i][1], &amp;n, sizeof n);\n\n            fclose(fp);\n            close(pipes[i][1]);\n            exit(0);\n        }\n\n        // PARENT process\n\n        // closing writing end of pipe\n        close(pipes[i][1]);\n    }\n\n    printf(\"Frequency of characters for %s\\n\", argv[1]);\n    for(i = 0; i &lt; 26; ++i)\n    {\n        if(pids[i] &lt; 0)\n        {\n            fprintf(stderr, \"%c: could not create child worker\\n\", (char) i + 'a');\n            close(pipes[i][0]);\n            continue;\n        }\n\n        int status;\n        waitpid(pids[i], &amp;status, 0);\n\n        if(WIFEXITED(status) &amp;&amp; WEXITSTATUS(status) == 0)\n        {\n            // child ended normally and wrote result\n            int cnt;\n            read(pipes[i][0], &amp;cnt, sizeof cnt);\n            printf(\"%c: %d\\n\", (char) i + 'a', cnt);\n        } else {\n            printf(\"%c: no answer from child\\n\", (char) i + 'a');\n        }\n\n        close(pipes[i][0]);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The parent creates 26 pipes, each one for a child. The it creates an array for\nthe pids and initializes them to -1 (later for error checking). Then enters in\nthe loop and creates a new child and closes the writing end of the parent's pipe\nfor the <code>i</code>-th child. Then it goes again into a loop and checks if a child\nprocess was created for every character. If that's the case, it waits for that\nchild to exit and checks it's exit status. If and only if the child exits\nnormally (with an exit status of 0), it reads from the reading end of the pipe\nand prints the result, otherwise it prints an error message. Then it closes the\nreading end of the pipe and exits.</p>\n\n<p>Meanwhile every child closes its reading end of the pipe and open a file for\nreading. By doing this, the children don't share the file description and can\nindependently from each other read the contents of the file and calculate the\nfrequency of the letter assigned to the child. If something goes wrong when\nopening the file, the child closes the writing end of the pipe and exits with a\nreturn status of 1, signalling to the parent, that something went wrong and that\nit won't send any result through the pipe. If everything goes well, the child\nwrites the result in the writing end of the pipe and exits with an exit status\nof 0.</p>\n\n<p>The output of this program with the its source is:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ ./counter counter.c\nFrequency of characters for counter.c\na: 44\nb: 5\nc: 56\nd: 39\ne: 90\nf: 40\ng: 17\nh: 26\ni: 113\nj: 1\nk: 5\nl: 35\nm: 6\nn: 68\no: 45\np: 59\nq: 2\nr: 78\ns: 71\nt: 65\nu: 25\nv: 5\nw: 10\nx: 3\ny: 6\nz: 5\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9293767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a63cf8bcc20d8f6bbd0c224f64f3561?s=128&d=identicon&r=PG&f=1", "display_name": "Kyla", "link": "https://stackoverflow.com/users/9293767/kyla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1517452631, "creation_date": 1517419417, "last_edit_date": 1517419945, "question_id": 48547996, "link": "https://stackoverflow.com/questions/48547996/creating-seperate-child-function-for-counting-each-letter-in-a-file", "title": "Creating seperate child function for counting each letter in a file", "body": "<p>I am trying to create separate <code>child process</code> for each <code>letter</code> that needs to be counted in a file. I have the file being read in a <code>parent process</code>, but the output is all zeros. I don't understand what I am doing wrong. I need to use child processes for each of the letters, but I am not exactly sure how to create separate processes for each letter. Please help! Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;sys/wait.h&gt;\nint main(int argc, char **argv){\n\n        char characters[26] = { \"abcdefghijklmnopqrstuvwxyz\" };\n        int counter[26] = { 0 };\n        int n = 26;\n        int c;\n        char ch;\n        if (argc &lt; 2)\n                return 1;\n\n        pid_t pids[26];\n        for (int i = 0; i &lt; n; i++){\n                pids[i] = fork();\n                if (pids[i] &lt; 0) {\n                        printf(\"Error\");\n                        exit(1);\n                } else if (pids[i] == 0) {\n                        while (c = fgetc(file) != EOF){\n                                if (c == characters[i])\n                                        counter[i]++;\n                        }\n                        exit(0);\n\n                } else {\n\n                        FILE *file = fopen(argv[1], \"r\");\n                        if(file == NULL)\n                                printf(\"File not found\\n\");\n                        while (c = fgetc(file) != EOF);\n                        fclose(file);\n                        wait(NULL);\n\n                }\n        }\n        for (int i = 0; i &lt; n; ++i){\n                printf(\"%c: %i\\n\", characters[i], counter[i]);\n        }\n        return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "file", "file-handling"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1517419924, "post_id": 48547918, "comment_id": 84092148, "body": "Is it C or C++ ? Pedantically, you cannot do that in portable C or portable C++ (because you cannot be guaranteed that the computer running your program has some compiler)."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1517420009, "post_id": 48547918, "comment_id": 84092206, "body": "Does &quot;the output in output.txt&quot; refer to the diagnostic messages generated by the compiler during the compilation, or the output messages generated by the compiled program itself when you run it?  (either way, it sounds like running from the command line and redirecting stdout to a file with the &gt; operator would get you what you want, with no programming required)"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1517420188, "post_id": 48547918, "comment_id": 84092310, "body": "Please stop tag spamming C != C++ != C#. Use <b>only</b> the tags that actually apply to your question, and stop randomly adding others that just seem similar."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1517420833, "post_id": 48547918, "comment_id": 84092645, "body": "I compile (MSVC) from a console, using a batch file to ensure that environment variables are set. If the <code>errorlevel</code> is non-0 it recompiles with the compiler output redirected by <code>@NMAKE &gt; TEMP.ERR</code> for the reasons you state: so I can examine the output more easily."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1517421267, "post_id": 48547918, "comment_id": 84092874, "body": "@KenWhite: What do you mean, \u201cstop\u201d? The OP has only two posted questions, and the other one was over a year ago and was not tagged with C or C++. They have not established any pattern of behavior to stop. Or do you imagine there is a massive organization of newbies colluding to enter questions with tags that irritate you, and that complaining to one of them will make the rest stop?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1517421304, "post_id": 48547918, "comment_id": 84092887, "body": "If I recall, TCC can be also be run from a console."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1517421390, "post_id": 48547918, "comment_id": 84092943, "body": "You do not need a C program to compile and run another program and save its output. If you could do it in a C program, you could do it from the command line shell (except in some bizarre cripped GUI-only system). So really all you need to know is the commands to compile using your C compiler and to run a program and redirect its output to a file."}], "answers": [{"tags": [], "owner": {"reputation": 2072, "user_id": 853065, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/aa14452cb8fbbc5b22c10c567ce710d8?s=128&d=identicon&r=PG", "display_name": "yoones", "link": "https://stackoverflow.com/users/853065/yoones"}, "is_accepted": true, "score": 1, "last_activity_date": 1517419716, "creation_date": 1517419716, "answer_id": 48548079, "question_id": 48547918, "link": "https://stackoverflow.com/questions/48547918/how-to-create-a-program-in-c-that-compiles-and-runs-another-c-program-and-saves/48548079#48548079", "title": "How to create a program in C that compiles and runs another c program and saves the output in a txt file?", "body": "<p>It's possible. You either run a shell command that compiles and runs your subprogram (<code>man 3 system</code>, easy), or you go with more advanced techniques such as on-the-fly compilation (<a href=\"http://blog.coldflake.com/posts/On-the-fly-C++/\" rel=\"nofollow noreferrer\">http://blog.coldflake.com/posts/On-the-fly-C++/</a> or <a href=\"https://bellard.org/tcc/\" rel=\"nofollow noreferrer\">https://bellard.org/tcc/</a> if you're a C programmer)</p>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1517427884, "last_edit_date": 1517427884, "creation_date": 1517420393, "answer_id": 48548289, "question_id": 48547918, "link": "https://stackoverflow.com/questions/48547918/how-to-create-a-program-in-c-that-compiles-and-runs-another-c-program-and-saves/48548289#48548289", "title": "How to create a program in C that compiles and runs another c program and saves the output in a txt file?", "body": "<p>The C11 standard (read <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">n1570</a>) <em>does not define</em> how to run a compiler. In many cases (think about cross-compiling for some <a href=\"http://www.arduino.cc/\" rel=\"nofollow noreferrer\">Arduino</a> target) you won't be able to run a compiler on the target machine (it could be \"too small\").</p>\n\n<p>BTW, you could compile your code into some executable, remove every compiler from your system, and run that executable (in a situation where your system don't have any compiler)....</p>\n\n<p>The C11 standard vaguely speaks in \u00a77.22.4.8 of a <code>system</code> function.</p>\n\n<p>On some implementations, that <code>system</code> function is able to start <em>other</em> programs (in processes) thru some <em>unspecified</em> command processor. But there is no guarantee that you'll be able to start a <em>compiler</em> (for example, you could run your executable on a Windows computer without any compiler).</p>\n\n<p><sup>(In practice, your computer is likely to practically have some command line C compiler, but you need to know which one and how to invoke it)</sup></p>\n\n<p><a href=\"https://stackoverflow.com/a/48548412/841108\">On POSIX</a>, you could use <a href=\"http://man7.org/linux/man-pages/man3/system.3.html\" rel=\"nofollow noreferrer\">system(3)</a> (which uses <code>/bin/sh -c</code>), but also <a href=\"http://man7.org/linux/man-pages/man2/fork.2.html\" rel=\"nofollow noreferrer\">fork(2)</a> &amp; <a href=\"http://man7.org/linux/man-pages/man2/execve.2.html\" rel=\"nofollow noreferrer\">execve(2)</a> -and other functions, e.g. <a href=\"http://man7.org/linux/man-pages/man3/popen.3.html\" rel=\"nofollow noreferrer\">popen(3)</a>- to start other programs.</p>\n\n<p>On Linux, you usually have some <em>command line</em> compiler, often <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a> as <code>gcc</code> (or even <code>cc</code>). You could run it (e.g. using <code>system</code>).</p>\n\n<p>I like to do the following trick on my Linux system: generate some <em>temporary</em> file containing C code, e.g. <code>/tmp/temporaryc.c</code>, then compile that temporary file into some temporary <a href=\"https://en.wikipedia.org/wiki/Plug-in_(computing)\" rel=\"nofollow noreferrer\">plugin</a> <code>/tmp/temporaryplugin.so</code> by using <code>system</code> with a command (in a string built at runtime) like <code>gcc -Wall -O -fPIC -shared /tmp/temporaryc.c -o /tmp/temporaryplugin.so</code>, and at last <a href=\"https://en.wikipedia.org/wiki/Dynamic_loading\" rel=\"nofollow noreferrer\">dynamically load</a> that plugin using <a href=\"http://man7.org/linux/man-pages/man3/dlopen.3.html\" rel=\"nofollow noreferrer\">dlopen(3)</a>.  </p>\n\n<p>Look also into <a href=\"https://en.wikipedia.org/wiki/Just-in-time_compilation\" rel=\"nofollow noreferrer\">JIT-compilation</a> libraries like <a href=\"https://gcc.gnu.org/onlinedocs/jit/\" rel=\"nofollow noreferrer\">libgccjit</a>.</p>\n\n<p>BTW, you should consider giving up Turbo C (it is an obsolete compiler for obsolete variants of C or C++) and switch to Linux on your PC.</p>\n"}, {"comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1517421601, "post_id": 48548412, "comment_id": 84093059, "body": "AFAIK, <code>popen</code> is not in the C11 standard (but only in POSIX)"}], "tags": [], "owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "is_accepted": false, "score": 1, "last_activity_date": 1517421638, "last_edit_date": 1517421638, "creation_date": 1517420859, "answer_id": 48548412, "question_id": 48547918, "link": "https://stackoverflow.com/questions/48547918/how-to-create-a-program-in-c-that-compiles-and-runs-another-c-program-and-saves/48548412#48548412", "title": "How to create a program in C that compiles and runs another c program and saves the output in a txt file?", "body": "<p>You want to look at the Standard C functions named <code>system()</code> and POSIX <code>popen()</code>.</p>\n\n<p>On a POSIXly system with a C compiler, to compile a simple C program would be</p>\n\n<pre><code>system(\"cc -o input input.c\");\n</code></pre>\n\n<p>And to run it and capture the output,</p>\n\n<pre><code>FILE *fp_in = popen(\"./input\", \"r\"); /* to read */\nFILE *fp_out = fopen(\"output.txt\", \"w\"); /* to write */\n</code></pre>\n\n<p>Then read from <code>fp_in</code> and write to <code>fp_out</code>. That's the basic idea. I've left the details for you to figure out, so you gain deep insight into deep C secrets :-)\nDon't forget the error handling for all library functions.</p>\n\n<p>PS: If the system's shell supports redirection, you might even simplify the popen/fopen combo to a single <code>system(\"./input &gt; output.txt\");</code> </p>\n\n<p>PPS: If the <code>PS</code> works, you might as well combine everything into <code>system(\"cc -o input input.c &amp;&amp; ./input &gt; output.txt\");</code> I trust you know how to wrap this in <code>main()</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 7343036, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F37X1k12oRY/AAAAAAAAAAI/AAAAAAAAB90/TJ9XJreZESU/photo.jpg?sz=128", "display_name": "Omkar Deshpande", "link": "https://stackoverflow.com/users/7343036/omkar-deshpande"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "closed_date": 1517430418, "accepted_answer_id": 48548079, "answer_count": 3, "score": -2, "last_activity_date": 1517427884, "creation_date": 1517419183, "last_edit_date": 1517420135, "question_id": 48547918, "link": "https://stackoverflow.com/questions/48547918/how-to-create-a-program-in-c-that-compiles-and-runs-another-c-program-and-saves", "closed_reason": "Needs details or clarity", "title": "How to create a program in C that compiles and runs another c program and saves the output in a txt file?", "body": "<p>I want to create a program in C such that it compiles another program of c and saves the output in a text file. For example, I want the output of my \"input.c\" file to be stored in a text file named \"output.txt\", using a C program. Please help. <br/><br />\n  I have chosen this project because it often becomes difficult to copy the entire output screen in Turbo C++, and sometimes turbo c doesn't show the entire output and only the current output screen is copied, leaving behind the previous output. </p>\n"}, {"tags": ["c", "opengl", "glut"], "comments": [{"owner": {"reputation": 2796, "user_id": 6121044, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d36000b5ea58961acf50354041457af9?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/6121044/andreas"}, "edited": false, "score": 0, "creation_date": 1517421515, "post_id": 48547699, "comment_id": 84093016, "body": "is the result the same if you remove the hit logic (last 4 lines)?"}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1517424421, "post_id": 48547699, "comment_id": 84094648, "body": "Edit in a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 41, "user_id": 6282795, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-Mw_RkNPA8HQ/AAAAAAAAAAI/AAAAAAAAACo/EzYuyhzokwg/photo.jpg?sz=128", "display_name": "Federico Zucchi", "link": "https://stackoverflow.com/users/6282795/federico-zucchi"}, "reply_to_user": {"reputation": 2796, "user_id": 6121044, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d36000b5ea58961acf50354041457af9?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/6121044/andreas"}, "edited": false, "score": 0, "creation_date": 1517425667, "post_id": 48547699, "comment_id": 84095317, "body": "@Andreas Yes, the result is identical"}, {"owner": {"reputation": 1930, "user_id": 1890396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20812a06bb3f81c24479cc1b65112723?s=128&d=identicon&r=PG", "display_name": "Hugh Fisher", "link": "https://stackoverflow.com/users/1890396/hugh-fisher"}, "edited": false, "score": 1, "creation_date": 1517612658, "post_id": 48547699, "comment_id": 84181508, "body": "A problem I&#39;ve had in the past is that the current OpenGL context stays around once set in Linux, but on Win32 seems to be made current only before a redraw and cleared afterwards. Try setting the current window within ProcessSelection. Or ProcessSelection stores &quot;most recent click here&quot; and calls glutPostRedisplay, the display function checks for a recent click and if so does the selection"}, {"owner": {"reputation": 41, "user_id": 6282795, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-Mw_RkNPA8HQ/AAAAAAAAAAI/AAAAAAAAACo/EzYuyhzokwg/photo.jpg?sz=128", "display_name": "Federico Zucchi", "link": "https://stackoverflow.com/users/6282795/federico-zucchi"}, "edited": false, "score": 0, "creation_date": 1517823079, "post_id": 48547699, "comment_id": 84235261, "body": "Thanks. If you would post it as an answer I would be happy to accept it."}], "owner": {"reputation": 41, "user_id": 6282795, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-Mw_RkNPA8HQ/AAAAAAAAAAI/AAAAAAAAACo/EzYuyhzokwg/photo.jpg?sz=128", "display_name": "Federico Zucchi", "link": "https://stackoverflow.com/users/6282795/federico-zucchi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517424397, "creation_date": 1517418505, "last_edit_date": 1517424397, "question_id": 48547699, "link": "https://stackoverflow.com/questions/48547699/opengl-image-disappears-on-selection-if-the-os-is-not-linux", "title": "OpenGL image disappears on selection if the OS is not Linux", "body": "<p>I need to check if an object or an empty space has been clicked in OpenGL. I capture the click event in the <code>MouseCallback</code> function which passes the x and y click coordinates to <code>ProcessSelection</code>. The function is:</p>\n\n<pre><code>void MouseCallback(int button, int state, int x, int y)\n{\n    if (button == GLUT_LEFT_BUTTON &amp;&amp; state == GLUT_DOWN)\n        ProcessSelection(x, y);\n}\n</code></pre>\n\n<p>Then I coordinates process the selection coordinates in <code>ProcessSelection</code>:</p>\n\n<pre><code>#define BUFFER_LENGTH 64\nvoid ProcessSelection(int xPos, int yPos)\n{\n    printf(\"xpos: %d\\n\", xPos);\n    printf(\"ypos: %d\\n\", yPos);\n    GLfloat fAspect;        // Screen aspect ratio\n    GLuint selectBuff[BUFFER_LENGTH];\n    GLint viewport[4];\n    glSelectBuffer(BUFFER_LENGTH, selectBuff);\n    glGetIntegerv(GL_VIEWPORT, viewport);\n    glMatrixMode(GL_PROJECTION);\n    glPushMatrix();\n    glRenderMode(GL_SELECT);\n\n    glLoadIdentity();\n    gluPickMatrix(xPos, viewport[3] - yPos, 4, 4, viewport);\n\n    fAspect = (float)(viewport[2]) / (float)viewport[3];\n\n    gluPerspective(120, fAspect, 1, 300);\n    display();\n\n    // Restore the projection matrix\n    glMatrixMode(GL_PROJECTION);\n    glPopMatrix();\n    glMatrixMode(GL_MODELVIEW);\n    glLoadIdentity();\n\n    hits = glRenderMode(GL_RENDER);\n\n    if (hits &gt;= 1)\n        enable_animation = !enable_animation;\n    else\n        glutSetWindowTitle(\"You clicked empty space!\");\n}\n</code></pre>\n\n<p>The <code>gluPerspective()</code> is the exact same function that is called in the reshape function. I noticed that it works well in Linux but not in Windows and Mac OS X where the image disappears at every click. I can't understand why. Can someone help me?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1517417245, "post_id": 48547244, "comment_id": 84090329, "body": "<code>strcmp(x,&quot;si&quot;)==0</code> is a paradox."}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1517417693, "post_id": 48547244, "comment_id": 84090652, "body": "Please learn to debug and turn all warnings to max while compiling. Then note that strings are null terminated."}], "answers": [{"tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 0, "last_activity_date": 1517418632, "last_edit_date": 1517418632, "creation_date": 1517418174, "answer_id": 48547608, "question_id": 48547244, "link": "https://stackoverflow.com/questions/48547244/sort-a-linked-list-in-cinsertion-between-two-node/48547608#48547608", "title": "sort a linked list in c(insertion between two node)?", "body": "<p>You don't have enough space to store <code>\"si\"</code> in <code>char x[2];</code></p>\n\n<p>Switch to</p>\n\n<pre><code>char x[3];\n</code></pre>\n\n<p>One more for the trailing NUL character (<code>'\\0'</code>)</p>\n\n<p>And notice that <code>scanf</code> without a length specifier doesn't protect you from buffer overflows, consider using:</p>\n\n<pre><code>scanf(\"%2s\",x);\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9287909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e5ed8175634daebf967575dd592d2df?s=128&d=identicon&r=PG", "display_name": "user9287909", "link": "https://stackoverflow.com/users/9287909/user9287909"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1517418632, "creation_date": 1517417163, "last_edit_date": 1517417530, "question_id": 48547244, "link": "https://stackoverflow.com/questions/48547244/sort-a-linked-list-in-cinsertion-between-two-node", "title": "sort a linked list in c(insertion between two node)?", "body": "<p>this function works only if the first element is not the biggest</p>\n\n<p>output:</p>\n\n<pre><code>a 55 n m\n\nb 100 j k\n\nc 88 i o\n</code></pre>\n\n<p>is there a way to solve this to obtain as output something like this\noutput:</p>\n\n<pre><code>a 55 n m\n\nc 88 i o\n\nb 100 j k\n</code></pre>\n\n<p>i think that the problem is at the end of the while cycle after the head insert.</p>\n\n<pre><code>LINK f1(){\n\n    LINK p,head,tail;\n    head=NULL;\n    tail=NULL;\n    char x[2];\n    printf(\"Vuoi inserire un nuovo elemento?: \");\n    scanf(\"%s\",x);\n    if(strcmp(x,\"si\")==0){\n        p=newnode();\n        printf(\"inserire: \");\n        scanf(\"%s\",p-&gt;d.t);\n        printf(\"inserire: \");\n        scanf(\"%d\",&amp;p-&gt;d.c);\n        printf(\"inserire: \");\n        scanf(\"%s\",p-&gt;d.pr);\n        printf(\"inserire: \");\n        scanf(\"%s\",p-&gt;d.m);\n        p-&gt;next=NULL;\n        if(head==NULL){head=p; tail=p;}\n        else{tail-&gt;next=p; tail=p;}\n        printf(\"Vuoi inserire un nuovo elemento?: \");\n        scanf(\"%s\",x);\n    }\n    while(strcmp(x,\"si\")==0){\n        p=newnode();\n        printf(\"inserire: \");\n        scanf(\"%s\",p-&gt;d.t);\n        printf(\"inserire: \");\n        scanf(\"%d\",&amp;p-&gt;d.c);\n        printf(\"inserire: \");\n        scanf(\"%s\",p-&gt;d.pr);\n        printf(\"inserire: \");\n        scanf(\"%s\",p-&gt;d.m);\n        if(p-&gt;d.c&lt;head-&gt;d.c){\n            p-&gt;next=head; head=p;\n        }\n        else{\n            tail-&gt;next=p; tail=p;\n        }\n    printf(\"Vuoi inserire un nuovo elemento?: \");\n    scanf(\"%s\",x);\n    }\n    return(head);\n}\n</code></pre>\n"}, {"tags": ["c", "free"], "comments": [{"owner": {"reputation": 1, "user_id": 7173251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16eb1a776f8d1ab86e9a861673e73105?s=128&d=identicon&r=PG&f=1", "display_name": "Hinok Wong", "link": "https://stackoverflow.com/users/7173251/hinok-wong"}, "reply_to_user": {"reputation": 663, "user_id": 8282168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba492cef39f592a7e738a4d3a70b8bab?s=128&d=identicon&r=PG&f=1", "display_name": "L_Church", "link": "https://stackoverflow.com/users/8282168/l-church"}, "edited": false, "score": 0, "creation_date": 1517416876, "post_id": 48547084, "comment_id": 84090078, "body": "@L_Church what u talking about?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1517416908, "post_id": 48547084, "comment_id": 84090100, "body": "Have you tried stepping through in a debugger to see what is happening?"}, {"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1517416933, "post_id": 48547084, "comment_id": 84090115, "body": "s/free(&amp;p-&gt;data);/free(p-&gt;data);/"}, {"owner": {"reputation": 1, "user_id": 7173251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16eb1a776f8d1ab86e9a861673e73105?s=128&d=identicon&r=PG&f=1", "display_name": "Hinok Wong", "link": "https://stackoverflow.com/users/7173251/hinok-wong"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1517417096, "post_id": 48547084, "comment_id": 84090217, "body": "any debugger suggest? @ChristianGibbons"}, {"owner": {"reputation": 1, "user_id": 7173251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16eb1a776f8d1ab86e9a861673e73105?s=128&d=identicon&r=PG&f=1", "display_name": "Hinok Wong", "link": "https://stackoverflow.com/users/7173251/hinok-wong"}, "reply_to_user": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1517417197, "post_id": 48547084, "comment_id": 84090290, "body": "@BjornA. what does it mean?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1517417540, "post_id": 48547084, "comment_id": 84090537, "body": "@HinokWong GDB is the go-to debugger.  A typical IDE will have a debugger built in.  It really is essential to programming to learn how to use one.  As for what Bjorn said, his comment was in the form of a regular expression.  He was telling you to replace <code>free(&amp;p-&gt;data);</code> with <code>free(p-&gt;data);</code>"}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1517417663, "post_id": 48547084, "comment_id": 84090625, "body": "If the nodes can link to each other in a loop (as your use of the <code>duplicate</code> function suggests), then the solution is to use a graph traversal algorithm such as DFS (which would require additional storage). If you had allocated all nodes in blocks of memory then this would be far simpler."}, {"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1517417691, "post_id": 48547084, "comment_id": 84090651, "body": "@HinokWong Remove the ampersand so free() gets the right argument. It wants the address stored in the &#39;data&#39; struct member , not the address of the member."}, {"owner": {"reputation": 1, "user_id": 7173251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16eb1a776f8d1ab86e9a861673e73105?s=128&d=identicon&r=PG&f=1", "display_name": "Hinok Wong", "link": "https://stackoverflow.com/users/7173251/hinok-wong"}, "reply_to_user": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1517417923, "post_id": 48547084, "comment_id": 84090848, "body": "@BjornA. Inside free() must be &quot;void * &quot; and if p-&gt;data it is type long integer, so free(p-&gt;data) wont work"}, {"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 1, "creation_date": 1517418106, "post_id": 48547084, "comment_id": 84090978, "body": "My bad. Why free p-&gt;data at all?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1517418186, "post_id": 48547084, "comment_id": 84091041, "body": "You should only free things that have an associated <code>malloc</code> family call to allocate them."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 2, "creation_date": 1517418189, "post_id": 48547084, "comment_id": 84091044, "body": "<b>Since you tagged as C++</b>, I&#39;ll assume you&#39;re working in C++. 1) The <code>typedef</code> is not required in C++.  2) The <code>struct</code> keyword is not required when creating instances of structures.  3) Prefer to use smart pointers 4) Initialize the link fields in the constructor of your <code>struct</code>. 5) Use <code>new</code> to dynamically allocate memory (the <code>malloc</code> function doesn&#39;t call the constructor).  6) Use <code>delete</code> to free up the allocated memory."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1517418292, "post_id": 48547084, "comment_id": 84091121, "body": "@ThomasMatthews Since he specifically mentioned C in the title, I think it&#39;s a safe assumption that it was a typical case of over-tagging.  I removed the C++ tag in an edit, but it hasn&#39;t been approved yet :/"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517418440, "post_id": 48547084, "comment_id": 84091231, "body": "Remove <code>free(&amp;p-&gt;data);</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517418807, "post_id": 48547084, "comment_id": 84091433, "body": "Tip: delete <code>p1-&gt;x = p5;     p2-&gt;y = p4;     p2-&gt;z = p2;     p6-&gt;y = p5;     p6-&gt;z = p6;</code> and get code to work.  Then add back with the additional code to handle cycles.  Suggest adding a <code>usage_count</code> member to <code>struct N</code>."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1517418898, "post_id": 48547084, "comment_id": 84091479, "body": "@ChristianGibbons: I would prefer you not to remove the tag.  Let the OP.  This will help the OP realize that C and C++ are two different languages.  I&#39;m not sure which edition of C contains the <code>bool</code> type; in the C++ language, the <code>bool</code> type is standard."}, {"owner": {"reputation": 1, "user_id": 7173251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16eb1a776f8d1ab86e9a861673e73105?s=128&d=identicon&r=PG&f=1", "display_name": "Hinok Wong", "link": "https://stackoverflow.com/users/7173251/hinok-wong"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1517419158, "post_id": 48547084, "comment_id": 84091651, "body": "@ThomasMatthews my bad, i removed C++ after realizing they are different, thanks"}, {"owner": {"reputation": 1, "user_id": 7173251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16eb1a776f8d1ab86e9a861673e73105?s=128&d=identicon&r=PG&f=1", "display_name": "Hinok Wong", "link": "https://stackoverflow.com/users/7173251/hinok-wong"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1517419202, "post_id": 48547084, "comment_id": 84091680, "body": "@ChristianGibbons thanks i approved it"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1517420342, "post_id": 48547084, "comment_id": 84092394, "body": "@ThomasMatthews C added <code>bool</code> in C99, as a typedef for the newly added <code>_Bool</code> type.  However it looks like he did his own typdef here, anyways."}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1517423602, "post_id": 48547084, "comment_id": 84094199, "body": "@HinokWong does the question state that the implementation of <code>mknode</code> is modifiable or fixed?"}, {"owner": {"reputation": 1, "user_id": 7173251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16eb1a776f8d1ab86e9a861673e73105?s=128&d=identicon&r=PG&f=1", "display_name": "Hinok Wong", "link": "https://stackoverflow.com/users/7173251/hinok-wong"}, "reply_to_user": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1517424275, "post_id": 48547084, "comment_id": 84094575, "body": "@meowgoesthedog fixed"}, {"owner": {"reputation": 1, "user_id": 7173251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16eb1a776f8d1ab86e9a861673e73105?s=128&d=identicon&r=PG&f=1", "display_name": "Hinok Wong", "link": "https://stackoverflow.com/users/7173251/hinok-wong"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517424305, "post_id": 48547084, "comment_id": 84094590, "body": "@chux thanks for ur tip, it helped me a lot"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517424497, "post_id": 48547084, "comment_id": 84094683, "body": "@HinokWong You can even post an answer below to your own question if you later figure out a good solution."}], "answers": [{"tags": [], "owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "is_accepted": false, "score": 0, "last_activity_date": 1517427164, "creation_date": 1517427164, "answer_id": 48550064, "question_id": 48547084, "link": "https://stackoverflow.com/questions/48547084/free-memories-in-c-and-got-unknown-error-that-freep-data-not-working/48550064#48550064", "title": "free memories in c and got unknown error that free(&amp;p-&gt;data) not working", "body": "<p>Given that no other modifications can be made to the provided functions and data type, the (abstract) data structure required to solve this problem efficiently is a <strong>set</strong>. These always contain only one copy of every unique element.</p>\n\n<p>Procedure:</p>\n\n<ul>\n<li>Create an empty set</li>\n<li>Perform a recursive Depth-First Search on the given starting node</li>\n<li>For each node visited, stop recursing if the set contains it, otherwise add it to the set and continue</li>\n<li>After recursion finishes completely, call <code>free</code> on every node in the set (without doing anything to their child pointers)</li>\n</ul>\n\n<p>C-style pseudocode:</p>\n\n<pre><code>static void dealloc_recursive(struct N *p, Set* s)\n{\n   if (p == NULL) return;\n\n   if (set_contains(s, p)) return;\n\n   dealloc_recursive(p-&gt;x, s);\n   dealloc_recursive(p-&gt;y, s);\n   dealloc_recursive(p-&gt;z, s);\n}\n\nvoid deallocate(struct N *p)\n{\n   Set* set = set_create_empty();\n\n   dealloc_recursive(p, set);\n\n   for (struct N *p in set)\n      free(p);\n\n   set_destroy(set);\n}\n</code></pre>\n\n<p>Two common types of sets spring to mind (present in Java's library; see <a href=\"https://stackoverflow.com/questions/2630738/c-how-to-implement-set-data-structure\">this post</a> for more on solutions for C):</p>\n\n<ul>\n<li>Hash sets: a hash table. Containment queries are (amortized) constant time. Might use more memory to account for collisions and chaining.</li>\n<li>Tree sets: a (balanced) binary search tree (typically). Containment queries are logarithmic time. Uses a fixed percentage more memory for node metadata.</li>\n</ul>\n\n<p>A quick Google search yields <a href=\"https://github.com/avsej/hashset.c\" rel=\"nofollow noreferrer\">this</a> example implementation. If you have a very large number of nodes, consider using <em>Judy arrays</em>. There are countless many others, possibly more efficient.</p>\n"}], "owner": {"reputation": 1, "user_id": 7173251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16eb1a776f8d1ab86e9a861673e73105?s=128&d=identicon&r=PG&f=1", "display_name": "Hinok Wong", "link": "https://stackoverflow.com/users/7173251/hinok-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1517427164, "creation_date": 1517416660, "last_edit_date": 1517418371, "question_id": 48547084, "link": "https://stackoverflow.com/questions/48547084/free-memories-in-c-and-got-unknown-error-that-freep-data-not-working", "title": "free memories in c and got unknown error that free(&amp;p-&gt;data) not working", "body": "<p>I have a structure of nodes down here:</p>\n\n<pre><code>struct N *mknode(struct N *xp, struct N *yp, struct N *zp, long n)\n{\n    struct N *p = malloc(sizeof(struct N));\n    p-&gt;x = xp;\n    p-&gt;y = yp;\n    p-&gt;z = zp;\n    p-&gt;data = n;\n    return p;\n}\n</code></pre>\n\n<p>my task is to free each node exactly once, so that there are neither double frees nor memory leaks</p>\n\n<p>and my codes can only include stdlib.h and \"freegraph.h\", i put stdio.h because i need to use the printf function to show which line of codes not working</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include \"freegraph.h\"\n\n#include &lt;stdio.h&gt;\n\n// construct a linked list\ntypedef struct node {\n    struct N * val;\n    struct node * next;\n} node_t;\n\ntypedef enum { false, true } bool;\n\nnode_t head = { NULL, NULL };\n\n\n// check if any duplicated in the linked list\nbool check_duplicate (node_t * head, struct N * val) {\n    bool duplicate = false;\n    node_t * current = head;\n\n    while (current != NULL) {\n        if ( current-&gt;val == val) {\n            duplicate = true;\n            return duplicate;\n        }\n        else {\n            current = current-&gt;next;\n        }\n    }\n    return duplicate;\n}\n\n// adding an item to the end of the linked list\nvoid push (node_t * head, struct N * val) {\n    node_t * current = head;\n    while (current-&gt;next != NULL) {\n        current = current-&gt;next;\n    }\n    current-&gt;next = malloc(sizeof(node_t));\n    current-&gt;next-&gt;val = val;\n    current-&gt;next-&gt;next = NULL;\n}\n//deallocate recursive function, printf to see which line is working\nvoid deallocate(struct N *p)\n{\n    if (p != NULL) {\n        if (!check_duplicate(&amp;head, p)) {\n            deallocate (p-&gt;x);\n            printf(\"1\\n\");\n            deallocate (p-&gt;y);\n            printf(\"2\\n\");\n            deallocate (p-&gt;z);\n            printf(\"3\\n\");\n            free(&amp;p-&gt;data);\n            printf(\"4\\n\");\n            push (&amp;head, p);\n            printf(\"5\\n\");\n        }\n    }\n</code></pre>\n\n<p>}</p>\n\n<p>however my programs only print out 1,2,3 and then it will stop and exit itself.\nso i am assuming free(&amp;p->data) isn't working, but i dont really know what im doing wrong.</p>\n\n<p>Here is my test codes:</p>\n\n<pre><code>    p1 = mknode(NULL, NULL, NULL, 1);\n    p2 = mknode(NULL, NULL, NULL, 10);\n    p3 = mknode(NULL, NULL, NULL, 100);\n    p4 = mknode(p1, p2, p3, 3000);\n    p1 = mknode(NULL, NULL, NULL, 1);\n    p2 = mknode(NULL, NULL, NULL, 10);\n    p3 = mknode(NULL, NULL, NULL, 100);\n    p5 = mknode(p1, p2, p3, 4000);\n    p5 = mknode(p4, p5, NULL, 50000);\n    p6 = mknode(p5, NULL, NULL, 100000);\n\n    // now make it harder by sharing and cycles\n    p1-&gt;x = p5;\n    p2-&gt;y = p4;\n    p2-&gt;z = p2;\n    p6-&gt;y = p5;\n    p6-&gt;z = p6; \n\n    deallocate(p6);\n</code></pre>\n"}, {"tags": ["c", "visual-c++", "dll", "printf", "mingw"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1517417485, "post_id": 48547028, "comment_id": 84090489, "body": "&quot;MSVC doesn&#39;t have a definition for it (<code>fprintf</code>)&quot; sounds incorrect."}, {"owner": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517435979, "post_id": 48547028, "comment_id": 84100565, "body": "@chux what I mean is that MSVC cannot find a binary definition (i.e. a <code>.data</code> section with the name <code>fprintf</code> in any of the libraries it has available). I think it&#39;s quite obvious from the context what I mean though."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1517417977, "creation_date": 1517417977, "answer_id": 48547535, "question_id": 48547028, "link": "https://stackoverflow.com/questions/48547028/is-there-a-way-to-define-fprintf-in-terms-of-printf-simpler-functions-easily/48547535#48547535", "title": "Is there a way to define fprintf in terms of printf / simpler functions (easily)?", "body": "<blockquote>\n  <p>Is there a way to define fprintf in terms of printf / simpler functions (easily)?\"</p>\n</blockquote>\n\n<p>Yes, if the library has <code>vfprintf()</code></p>\n\n<pre><code>#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n\nint my_own_fprintf(FILE * stream, const char * format, ...) {\n  int y;\n  va_list args;\n  va_start(args, format);\n  y = vfprintf(stream, format, args);\n  va_end(args);\n  return y;\n}\n</code></pre>\n"}], "owner": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 48547535, "answer_count": 1, "score": 1, "last_activity_date": 1517417977, "creation_date": 1517416444, "question_id": 48547028, "link": "https://stackoverflow.com/questions/48547028/is-there-a-way-to-define-fprintf-in-terms-of-printf-simpler-functions-easily", "title": "Is there a way to define fprintf in terms of printf / simpler functions (easily)?", "body": "<p>I'm trying to link a program built with MSVC against a DLL compiled with MinGW. The problem is the DLL assumes the function <code>fprintf</code> exists, but MSVC doesn't have a definition for it in any of the libraries it links against.  I cannot change versions of neither MSVC nor of MinGW, so the only way I can think around the problem is to write my own <code>fprintf</code>, but I would hope there's a simple implementation that doesn't require from me to maintain a whole library of code...</p>\n"}, {"tags": ["c", "io", "buffer", "system-calls", "tee"], "comments": [{"owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "edited": false, "score": 2, "creation_date": 1517416099, "post_id": 48546730, "comment_id": 84089523, "body": "Add <code>{}</code> in your while loop and put both <code>write</code> in it. Without <code>{}</code> the <code>while</code> loop is only executing the first <code>write</code>."}, {"owner": {"reputation": 75, "user_id": 5012418, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8e254ea55274dbc62c956f72452c70e1?s=128&d=identicon&r=PG&f=1", "display_name": "M Dey", "link": "https://stackoverflow.com/users/5012418/m-dey"}, "reply_to_user": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "edited": false, "score": 0, "creation_date": 1517416447, "post_id": 48546730, "comment_id": 84089795, "body": "Thank you my friend, that worked!"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5012418, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8e254ea55274dbc62c956f72452c70e1?s=128&d=identicon&r=PG&f=1", "display_name": "M Dey", "link": "https://stackoverflow.com/users/5012418/m-dey"}, "edited": false, "score": 0, "creation_date": 1517417832, "post_id": 48547089, "comment_id": 84090757, "body": "Is there a reason to not use code blocks? I see it a lot in my textbook, which is why I copied that schema. When I code in Java I always use them. Just curious from a syntax perspective."}, {"owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "reply_to_user": {"reputation": 75, "user_id": 5012418, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8e254ea55274dbc62c956f72452c70e1?s=128&d=identicon&r=PG&f=1", "display_name": "M Dey", "link": "https://stackoverflow.com/users/5012418/m-dey"}, "edited": false, "score": 0, "creation_date": 1517419162, "post_id": 48547089, "comment_id": 84091653, "body": "I don&#39;t know which textbook you are referring to. Without curly braces, only the first statement following the loop definition is considered to belong to the loop body, that means the loop only has a single statement. With curly braces, statement(s) between <code>{</code> and <code>}</code> are considered as loop body and it can be a single statement or more than one statement."}, {"owner": {"reputation": 75, "user_id": 5012418, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8e254ea55274dbc62c956f72452c70e1?s=128&d=identicon&r=PG&f=1", "display_name": "M Dey", "link": "https://stackoverflow.com/users/5012418/m-dey"}, "edited": false, "score": 0, "creation_date": 1517425530, "post_id": 48547089, "comment_id": 84095247, "body": "Understood, is it best practice to always put curly braces? I guess that&#39;s what I&#39;m asking."}, {"owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "reply_to_user": {"reputation": 75, "user_id": 5012418, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8e254ea55274dbc62c956f72452c70e1?s=128&d=identicon&r=PG&f=1", "display_name": "M Dey", "link": "https://stackoverflow.com/users/5012418/m-dey"}, "edited": false, "score": 0, "creation_date": 1517452418, "post_id": 48547089, "comment_id": 84105354, "body": "Yes, it is good programming practice to have curly braces. It makes code easier to read."}], "tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1517468084, "last_edit_date": 1517468084, "creation_date": 1517416672, "answer_id": 48547089, "question_id": 48546730, "link": "https://stackoverflow.com/questions/48546730/how-to-write-to-two-different-places-with-the-same-buffer-c-system-call/48547089#48547089", "title": "How to write to two different places with the same buffer? (C-System call)", "body": "<p>Your <code>while</code> loop does not have <code>{}</code>. So, it is considering only first statement, after it, in loop body:</p>\n\n<pre><code>   while((n_char=read(STDIN_FILENO, &amp;buf,1)) != 0)\n      n_char=write(fd, &amp;buf, 1);\n      write(STDOUT_FILENO,&amp;buf,1);  &lt;===== this statement is out of loop body\n</code></pre>\n\n<p>Add <code>{}</code> for the block of statements in loop body:</p>\n\n<pre><code>   while((n_char=read(STDIN_FILENO, &amp;buf,1)) != 0) {\n      n_char=write(fd, &amp;buf, 1);\n      write(STDOUT_FILENO,&amp;buf,1);\n   }\n</code></pre>\n\n<hr>\n\n<p><strong>Additional</strong>:</p>\n\n<p>As a part of good programming practice, you should also check the return value of system call('s), like <code>write()</code>, using in your program and make sure to do proper error handling.</p>\n\n<p><a href=\"http://man7.org/linux/man-pages/man2/write.2.html\" rel=\"nofollow noreferrer\">write</a>:</p>\n\n<blockquote>\n  <p>On error, -1 is returned, and <code>errno</code> is set appropriately.</p>\n</blockquote>\n"}], "owner": {"reputation": 75, "user_id": 5012418, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8e254ea55274dbc62c956f72452c70e1?s=128&d=identicon&r=PG&f=1", "display_name": "M Dey", "link": "https://stackoverflow.com/users/5012418/m-dey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1517468084, "creation_date": 1517415488, "question_id": 48546730, "link": "https://stackoverflow.com/questions/48546730/how-to-write-to-two-different-places-with-the-same-buffer-c-system-call", "title": "How to write to two different places with the same buffer? (C-System call)", "body": "<p>I'm supposed to be implementing the Unix 'tee' command with the option of the '-a' flag which will append the input to the EOF instead of overwriting it. The catch is I can only use C System calls for I/O. I've so far been able to implement everything except multiple outputs. </p>\n\n<p>In my while loop I have two different lines, one which writes to a file, and the other which writes to stdout. If I comment one out, or put one before the other, that works, but keeping both in doesn't. Only the write function I call first will work. I'm assuming because it empties the buffer if I understand correctly. </p>\n\n<p>How can I write out whatever I input to stdin, to both stdout and a file?</p>\n\n<pre><code>#include \"csapp.h\"\n#include &lt;ctype.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc, char **argv) {\n\n   int aflag = 0;\n   int n_char = 0;\n   int c,fd;\n   char *path;\n   char buf;\n\n   opterr = 0;\n\n   // getopt is looking for flags with dashes\n   while((c = getopt(argc, argv, \"a\")) != -1)\n      switch (c)\n      {\n         // assign the aflag value to 1, so we know that arg was applied\n         case 'a':\n            aflag = 1;\n            break;\n         case '?':\n            if (isprint (optopt))\n               fprintf(stderr, \"Unknown option \\\\x%x'.\\n\",optopt);\n            return 1;\n         default:\n            abort();\n      }\n\n   // if the -a flag was provided, we must append, if not overwrite the file\n   // by default if the file exists.\n   if(aflag == 1) {\n      path = argv[2];\n      fd = open(path,O_WRONLY|O_APPEND,0);\n   } else {\n      path = argv[1];\n      fd = open(path,O_WRONLY,0);\n   }\n\n   // While not EOF, right to stdout and file\n   while((n_char=read(STDIN_FILENO, &amp;buf,1)) != 0)\n      n_char=write(fd, &amp;buf, 1);\n      write(STDOUT_FILENO,&amp;buf,1);\n   close(fd);\n\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "clang"], "comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1517416712, "post_id": 48546298, "comment_id": 84089979, "body": "By the way, do not take the down vote personally. I did not vote, but I imagine the voter voted because this question is not hugely useful for other people\u2014it is not something that is likely to be what they are searching for when looking up their own problem. You did a good job reducing the problem to a reproducible example."}], "answers": [{"comments": [{"owner": {"reputation": 186, "user_id": 2012805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w0jiE.png?s=128&g=1", "display_name": "Ikem Krueger", "link": "https://stackoverflow.com/users/2012805/ikem-krueger"}, "edited": false, "score": 0, "creation_date": 1517415215, "post_id": 48546468, "comment_id": 84088892, "body": "Okay. That makes sense. But why does making \u201en\u201c a const fix this?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 186, "user_id": 2012805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w0jiE.png?s=128&g=1", "display_name": "Ikem Krueger", "link": "https://stackoverflow.com/users/2012805/ikem-krueger"}, "edited": false, "score": 1, "creation_date": 1517415620, "post_id": 48546468, "comment_id": 84089179, "body": "@IkemKrueger: Making <code>n</code> const does not fix the problem. It just happened to cause the compiler to change how it organized things in memory, with the result that the buffer overrun destroyed different data than before, in a way that might not have been noticeable in your program\u2019s observable behavior."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1517416174, "post_id": 48546468, "comment_id": 84089572, "body": "Undefined Behavior can be tricky in that way.  If you move the declaration of <code>n</code> to be after all of your buffers, it also happens to not segfault (at least on my system).  Use of safer functions like <code>strncat</code> can help you avoid buffer-overflows by specifying the length of the buffer."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1517416407, "post_id": 48546468, "comment_id": 84089757, "body": "And one last note as relates to <code>strcat</code>, using it in a loop like this can be rather inefficient because it has to recalculate the length of the string each time it is called, and as the string grows, so does the amount of time to calculate its length.  This is referred to as a Sclemiel The Painter algorithm. <a href=\"https://en.wikichip.org/wiki/schlemiel_the_painter%27s_algorithm\" rel=\"nofollow noreferrer\">en.wikichip.org/wiki/schlemiel_the_painter%27s_algorithm</a> .  It is better to keep track of the length of the string as you go and then you can use that as an offset into the buffer to copy directly to the end of the string instead of costly recalculation of its length."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1517414660, "creation_date": 1517414660, "answer_id": 48546468, "question_id": 48546298, "link": "https://stackoverflow.com/questions/48546298/clang-loop-optimizations-causes-a-segmentation-fault/48546468#48546468", "title": "Clang loop optimizations causes a segmentation fault?", "body": "<p>You declared <code>buf</code> as an array of 20 <code>char</code>, but you write \u201c[1] [3] [6] [9] [10] [14] [16] [17] [21]\u201d to it, which is 41 <code>char</code>, including the terminating null. During the loop, <code>strcat</code> overruns <code>buf</code> and writes data to memory it should not, which corrupts other things in your process.</p>\n"}], "owner": {"reputation": 186, "user_id": 2012805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w0jiE.png?s=128&g=1", "display_name": "Ikem Krueger", "link": "https://stackoverflow.com/users/2012805/ikem-krueger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1521503650, "creation_date": 1517414208, "last_edit_date": 1521503650, "question_id": 48546298, "link": "https://stackoverflow.com/questions/48546298/clang-loop-optimizations-causes-a-segmentation-fault", "title": "Clang loop optimizations causes a segmentation fault?", "body": "<p>I was writing code for \"binary search\". And meanwhile I did, I wrote some code to see where my start, middle, and end point is. For that I printed out a string where the numbers for start, middle and end were surrounded by square brackets. Because that lead me to a segmentation fault, I made a copy of the code and condensed it to the smallest amount of code which causes the issue.</p>\n\n<p>This is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    int values[9] = {1, 3, 6, 9, 10, 14, 16, 17, 21};\n    int n = sizeof(values) / sizeof(int); // &lt;-- make this is a \"const\", and the \"segmentation fault\" goes away\n\n    char buf[20] = \"\";\n    char num[6] = \"\";\n\n    for(int i = 0; i &lt; n; i++)\n    {\n        printf(\"i: %i, n: %i\\n\", i, n);\n\n        sprintf(num, \"[%i] \", values[i]);\n\n        strcat(buf, num);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Compiled with this line:</p>\n\n<pre><code>clang -std=c99 -Wall -Werror loop.c -o loop\n</code></pre>\n\n<p>Somehow \"n\" get changed, despite it shouldn't get changed. At least it is not changed by me.</p>\n\n<p>So why does this happen?</p>\n"}, {"tags": ["python", "c", "signedness"], "answers": [{"tags": [], "owner": {"reputation": 327, "user_id": 2685189, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/74d91b5a5b3ce513dbc54f86cf2baee1?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Bergemann", "link": "https://stackoverflow.com/users/2685189/frank-bergemann"}, "is_accepted": false, "score": 0, "last_activity_date": 1517582486, "creation_date": 1517582486, "answer_id": 48585026, "question_id": 48546215, "link": "https://stackoverflow.com/questions/48546215/gdb-python-pretty-printer-uint64-t-is-interpreted-signed/48585026#48585026", "title": "gdb python pretty printer uint64_t is interpreted signed", "body": "<p>At least as a workaround this works for me:</p>\n\n<pre><code>class MyPrinter:\n        def __init__(self, val):\n                self.val = val\n\n        def to_hex(self, val):\n                s = ''\n                x = 7\n                while (x &gt;= 0):\n                        s = s + \"%02x\" % ((val&gt;&gt;(x*8))&amp;255)\n                        x -= 1\n\n                return s\n\n        def to_string(self):\n                return self.to_hex(self.val['fData'][0]) + self.to_hex(self.val['fData'][1])\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 2685189, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/74d91b5a5b3ce513dbc54f86cf2baee1?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Bergemann", "link": "https://stackoverflow.com/users/2685189/frank-bergemann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517582486, "creation_date": 1517413941, "last_edit_date": 1517417221, "question_id": 48546215, "link": "https://stackoverflow.com/questions/48546215/gdb-python-pretty-printer-uint64-t-is-interpreted-signed", "title": "gdb python pretty printer uint64_t is interpreted signed", "body": "<p>When I try to use:</p>\n\n<pre><code>class MyPrinter:\n        def __init__(self, val):\n                self.val = val\n\n        def to_string(self):\n                return str(self.val['fData'][0]) + \":\" + \"%016x\" % (self.val['fData'][0]).cast(gdb.lookup_type(\"uint64_t\"))\n</code></pre>\n\n<p>It prints<br>\n<code>2929725441843584891:28a879c45a82df7b</code><br>\nBut also<br>\n<code>9918728419520062851:-7659990ddaef5a7d</code><br>\n<br>\nWhen the most significant bit is set for <code>val</code>, it is interpreted as signed.</p>\n\n<p><code>fData[]</code> is <code>uint64_t</code>.</p>\n\n<p>How can I avoid that? All my values should be unsigned.</p>\n"}, {"tags": ["c", "pipe"], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517414648, "post_id": 48546062, "comment_id": 84088528, "body": "Or tell <code>printf()</code> how many bytes to print: <code>printf(&quot;%.*s\\n&quot;, bytes_read, readbuf);</code> \u2014 using <code>printf(\u2026)</code> instead of <code>fprintf(stdout, \u2026);</code>.  It also isn&#39;t clear that inserting newlines at random points in the output is beneficial; it would probably better to just use <code>printf(&quot;%.*s&quot;, bytes_read, readbuf);</code>."}, {"owner": {"reputation": 3, "user_id": 7945819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ncOV7.jpg?s=128&g=1", "display_name": "naval_ned", "link": "https://stackoverflow.com/users/7945819/naval-ned"}, "edited": false, "score": 0, "creation_date": 1517414851, "post_id": 48546062, "comment_id": 84088671, "body": "I appreciate your response. This is the output.laptop$ ./test              t r"}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 2, "last_activity_date": 1517413504, "creation_date": 1517413504, "answer_id": 48546062, "question_id": 48545889, "link": "https://stackoverflow.com/questions/48545889/reading-from-a-pipe-in-c-and-printing-to-stdout/48546062#48546062", "title": "reading from a pipe in c and printing to stdout", "body": "<p>What is one of the most important things to remember about strings in C? They're meant to be <code>NUL</code> terminated!</p>\n\n<p><code>read</code> doesn't add a <code>NUL</code> your string - it deals with chunks of raw data, so you have to do that yourself. This also means that you can't pass in the full size of the buffer as you'll need to leave space for the <code>NUL</code> to be added</p>\n\n<pre><code>       while ((bytes_read = read(pfd[0], readbuf, sizeof(readbuf)-1) &gt; 0)) {\n                readbuf[bytes_read]='\\0';\n                fprintf(stdout, \"%s\\n\", readbuf);\n       }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 7945819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ncOV7.jpg?s=128&g=1", "display_name": "naval_ned", "link": "https://stackoverflow.com/users/7945819/naval-ned"}, "is_accepted": false, "score": 0, "last_activity_date": 1517418074, "creation_date": 1517418074, "answer_id": 48547579, "question_id": 48545889, "link": "https://stackoverflow.com/questions/48545889/reading-from-a-pipe-in-c-and-printing-to-stdout/48547579#48547579", "title": "reading from a pipe in c and printing to stdout", "body": "<p>This seems to have corrected the problem:</p>\n\n<pre><code>do {\n        bytes_read = read(pfd[0], readbuf, sizeof(readbuf));\n        readbuf[bytes_read] = '\\0';\n        printf(\"%s\", readbuf);\n    } while (bytes_read &gt; 0);\n</code></pre>\n\n<p>Thanks for the assisstance.</p>\n"}], "owner": {"reputation": 3, "user_id": 7945819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ncOV7.jpg?s=128&g=1", "display_name": "naval_ned", "link": "https://stackoverflow.com/users/7945819/naval-ned"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 994, "favorite_count": 0, "accepted_answer_id": 48546062, "answer_count": 2, "score": 0, "last_activity_date": 1517418074, "creation_date": 1517412978, "question_id": 48545889, "link": "https://stackoverflow.com/questions/48545889/reading-from-a-pipe-in-c-and-printing-to-stdout", "title": "reading from a pipe in c and printing to stdout", "body": "<p>I'm having some trouble reading from a pipe. Well not exactly. I'm reading fine its just the output is globbed up. </p>\n\n<pre><code>#include &lt;sys/wait.h&gt;\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nint pfd[2];\n\nint main(void)\n{\n    pid_t   pid;\n    int     status;\n    char    readbuf[1024];\n    int     bytes_read = 0;\n\n    pipe(pfd);\n\n    switch((pid = fork())) {\n    case -1:\n            perror(\"fork\");\n            break;\n    case 0:\n            /* child */\n            close(pfd[0]);\n            dup2(pfd[1], 1);        /* stdout */\n\n            /* mkdir -p /home/edgar/testdir */\n            chdir(\"/home/edgar/testdir\");\n\n            /* for file in a b c d e f g h i j k l m n o p q r s t u v w x y z;\n             * do\n             * touch $file\n             * done\n             */\n\n            execl(\"/bin/ls\", \"ls\", \"-l\", (char *)NULL);\n            exit(1);\n    default:\n            /* parent */\n            close(pfd[1]);\n            dup2(pfd[0], 0);\n\n            pid = wait(&amp;status);\n            /* get input back from ls */\n            while ((bytes_read = read(pfd[0], readbuf, sizeof readbuf) &gt; 0)) {\n                    fprintf(stdout, \"%s\\n\", readbuf);\n            }\n\n            printf(\"child exit status: %d\\n\", WEXITSTATUS(status));\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Here is an example of globbed up output:</p>\n\n<p>laptop$ ./test1</p>\n\n<p>-rw-r--r--  1 edgar  edgar  0 Jan 31 09:15 u</p>\n\n<p>-rw-r--r--  1 edgar  edgar  0 Jan 31 09:15 v</p>\n\n<p>-rw-r--r--  1 edgar  edgarp\ufffd\ufffd</p>\n\n<p>0 Jan 31 09:15 w\n-rw-r--r--  1 edgar  edgar  0 Jan 31 09:15 x</p>\n\n<p>-rw-r--r--  1 edgar  edgar  0 Jan 31 09:15 y</p>\n\n<p>-rw-r--r--  1 edgar  edgar  0 Jan 31 09:15 z</p>\n\n<p>1 edgar  edgar  0 Jan 31 09:15 d</p>\n\n<p>-rw-r--r--  1 edgar  edgar  0 Jan 31 09:15 e</p>\n\n<p>It read from a-v fine and then w-z is weird and then it started over at d. \nI added the extra newlines above for readability.</p>\n"}, {"tags": ["c", "linux", "unix", "operating-system"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1517414639, "post_id": 48545762, "comment_id": 84088519, "body": "Are you familiar with <code>strerror</code>?"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1517415508, "post_id": 48545762, "comment_id": 84089090, "body": "Trying to change the process group of an already died process (which a zombie is) is of no interest so <code>ESRCH</code> seems a very reasonable error."}], "answers": [{"comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 1, "creation_date": 1517416244, "post_id": 48546709, "comment_id": 84089617, "body": "Looks like in Linux zombies are removed from their thread group and <code>setpgid</code> returns <code>ESRCH</code> if caller and process to move aren&#39;t in the same thread group. That is reasonable to consider a zombie as absent from almost all kernel list."}, {"owner": {"reputation": 581, "user_id": 8093676, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e4a097e527c8390afa006bedd7cc19e4?s=128&d=identicon&r=PG&f=1", "display_name": "K.Miao", "link": "https://stackoverflow.com/users/8093676/k-miao"}, "edited": false, "score": 1, "creation_date": 1517418369, "post_id": 48546709, "comment_id": 84091179, "body": "Actually I tried the same piece of code on different computers. Some return <code>EACCES</code> while others return <code>ESRCH</code>."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 2, "last_activity_date": 1517415419, "creation_date": 1517415419, "answer_id": 48546709, "question_id": 48545762, "link": "https://stackoverflow.com/questions/48545762/setpgid-for-child-zombie-process-gives-esrch-instead-of-eacces/48546709#48546709", "title": "setpgid for Child Zombie Process Gives ESRCH instead of EACCES?", "body": "<p>The <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/setpgid.html\" rel=\"nofollow noreferrer\">specification of <code>setpgid</code></a> does not say what error is to be returned by <code>setpgid</code> when the pid argument refers to a <em>zombie</em> child of the calling process, whether or not it called <code>execve</code>.  Thus, this is not technically a bug.</p>\n\n<p><code>ESRCH</code> makes sense if you consider that zombies aren't really processes anymore; they're just the data that needs to stick around until someone gets around to calling <code>wait</code>.  For instance, it would make a lot of sense for <code>kill</code> to fail with <code>ESRCH</code> when applied to a zombie.</p>\n\n<p>I'd like to close with some observations on how this is actually implemented, but, alas,  I looked at the source code for <code>setpgid</code> in Linux and could not figure out what it would return for this case, because Linux's namespace support has turned many process-related syscalls into horrible mazes of spaghetti.  So then I tried to look at FreeBSD instead and I couldn't even find the relevant part of the source code, because the file-level organization of the FreeBSD kernel is incomprehensible.  So you're going to have to do without, sorry.</p>\n"}], "owner": {"reputation": 581, "user_id": 8093676, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e4a097e527c8390afa006bedd7cc19e4?s=128&d=identicon&r=PG&f=1", "display_name": "K.Miao", "link": "https://stackoverflow.com/users/8093676/k-miao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 48546709, "answer_count": 1, "score": 0, "last_activity_date": 1517415419, "creation_date": 1517412597, "last_edit_date": 1592644375, "question_id": 48545762, "link": "https://stackoverflow.com/questions/48545762/setpgid-for-child-zombie-process-gives-esrch-instead-of-eacces", "title": "setpgid for Child Zombie Process Gives ESRCH instead of EACCES?", "body": "<p>According to the man <code>setpgid(2)</code> page,</p>\n<blockquote>\n<p>EACCES An attempt was made to change the process group ID of one of the children of the calling process and the child had already performed an execve(2) (setpgid(), setpgrp()).</p>\n<p>ESRCH  For getpgid(): pid does not match any process.  For setpgid(): pid is not the calling process and not a child of the calling process.</p>\n</blockquote>\n<p>The errno should be <code>EACCES</code> according to the description. But why do I get <code>ESRCH</code> instead?</p>\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n\nvoid print_errno() {\n  if (errno == EACCES) printf(&quot;errno: EACCES\\n&quot;);\n  else if (errno == EPERM) printf(&quot;errno: EPERM\\n&quot;);\n  else if (errno == ESRCH) printf(&quot;errno: ESRCH\\n&quot;);\n}\n\n#define CHECK(syscall, msg) do {                    \\\n    if ((syscall) == -1) {                          \\\n      print_errno();                                \\\n      perror(msg);                                  \\\n      _exit(1);                                     \\\n    }                                               \\\n  } while(0)\n\nint main () {\n  int ls_pid;\n  char *ls_argv[] = { &quot;ls&quot;, NULL };\n\n  CHECK(ls_pid = fork(), &quot;fork error&quot;);\n  if (!ls_pid) {\n    CHECK(execvp(ls_argv[0], ls_argv), &quot;execvp error&quot;);\n  } else {\n    sleep(2);\n    CHECK(setpgid(ls_pid, ls_pid), &quot;setpgid error&quot;);\n    CHECK(wait(NULL), &quot;wait error&quot;);\n\n    printf(&quot;Finish\\n&quot;);\n  }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 4, "creation_date": 1517412330, "post_id": 48545612, "comment_id": 84086888, "body": "My question is why you thought to use <code>rand()</code>. You clearly don&#39;t want random <i>numbers</i>; you want a random <b>order</b> of a specific set of numbers, which is a very different thing, so generating random numbers isn&#39;t the answer."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517412693, "post_id": 48545612, "comment_id": 84087149, "body": "See <a href=\"https://stackoverflow.com/q/3343797/2410359\">stackoverflow.com/q/3343797/2410359</a>"}, {"owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "edited": false, "score": 0, "creation_date": 1517423770, "post_id": 48545612, "comment_id": 84094277, "body": "You have to keep a track of numbers that are already generated. Run a while loop around the rand function, and bail out of it when the new unique number is taken. That is a simplest way. This could be helped with an additional array containing 25 Boolean values corresponding to the status of the random number (already generated = true, new number = false). I have to post it here so @Quicky can see it. Otherwise it is down-voted."}, {"owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "edited": false, "score": 0, "creation_date": 1517424402, "post_id": 48545612, "comment_id": 84094640, "body": "rand is a standard C function and it may be used for generating random numbers.  More about the quality of this function is here: <a href=\"https://cboard.cprogramming.com/c-programming/141644-finding-distribution-rand-function.html\" rel=\"nofollow noreferrer\">cboard.cprogramming.com/c-programming/&hellip;</a>"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "edited": false, "score": 0, "creation_date": 1517474031, "post_id": 48545612, "comment_id": 84112466, "body": "@VladP: You ought to put answers in the answers section, where they can be peer-reviewed which perhaps includes a downvote. Don&#39;t take downvotes personally, I don&#39;t, and at the time of my writing, my answer below has a downvote."}], "answers": [{"comments": [{"owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "edited": false, "score": 0, "creation_date": 1517424616, "post_id": 48545656, "comment_id": 84094755, "body": "Good solution, perhaps a bit of overkill."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 8, "last_activity_date": 1517412364, "last_edit_date": 1517412364, "creation_date": 1517412273, "answer_id": 48545656, "question_id": 48545612, "link": "https://stackoverflow.com/questions/48545612/how-to-stop-duplicates-values-in-an-array-in-c/48545656#48545656", "title": "How to stop duplicates values in an array in C", "body": "<p><code>rand()</code> would not be a particularly good generator if the probability of drawing the same number twice was zero.</p>\n\n<p>A standard approach here would be to generate the <code>board</code> with consecutive numbers, then <em>shuffle</em> it by swapping elements at random a certain number of times.</p>\n\n<p>A good shuffling algorithm is <a href=\"https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\" rel=\"noreferrer\">https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle</a></p>\n"}, {"comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1517412509, "post_id": 48545734, "comment_id": 84087019, "body": "but this is just a clumsy way to work around the inherent limitations of using the wrong design."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1517413674, "post_id": 48545734, "comment_id": 84087805, "body": "One problem with this approach is that you are assuming that a <code>rand</code> implementation draws numbers in its periodic cycle such that when the results are transformed under the function <code>% 25</code>, they completely fill the range [0, 24]. The C standard makes no such guarantees (a trivial counterexample would be a <code>rand</code> implementation that draws only even numbers), so this approach <i>could</i> cause an infinite loop. Granted, this is unlikely but it does illustrate an important flaw in this technique."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1517415821, "post_id": 48545734, "comment_id": 84089323, "body": "@Bathsheba: While it is not formally stated in the C standard, I am confident the intent of the standard is that <code>rand</code> is intended to select from the integers in [0, RAND_MAX] with uniform distribution. A <code>rand</code> that returned only even values (always, not just in some limited subsequence) would be defective."}], "tags": [], "owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "is_accepted": false, "score": 0, "last_activity_date": 1517423858, "last_edit_date": 1517423858, "creation_date": 1517412465, "answer_id": 48545734, "question_id": 48545612, "link": "https://stackoverflow.com/questions/48545612/how-to-stop-duplicates-values-in-an-array-in-c/48545734#48545734", "title": "How to stop duplicates values in an array in C", "body": "<p>Deleted since downvoted. That is a reason why it is removed.</p>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 8496688, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FFHzeDQL1Bs/AAAAAAAAAAI/AAAAAAAAABM/Qy9wkZT4BBE/photo.jpg?sz=128", "display_name": "Ananda Raju", "link": "https://stackoverflow.com/users/8496688/ananda-raju"}, "is_accepted": false, "score": 1, "last_activity_date": 1517539891, "creation_date": 1517539891, "answer_id": 48575014, "question_id": 48545612, "link": "https://stackoverflow.com/questions/48545612/how-to-stop-duplicates-values-in-an-array-in-c/48575014#48575014", "title": "How to stop duplicates values in an array in C", "body": "<p>Use srand() function instead of rand function.\nrand() will give same numbers  after each program.\nRefer this for help. This is for improvement of your program this is not answer\n<a href=\"https://www.geeksforgeeks.org/rand-and-srand-in-ccpp/\" rel=\"nofollow noreferrer\">Rand() vs srand() function</a></p>\n"}], "owner": {"reputation": 113, "user_id": 6942677, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-xWJTRWdOYAo/AAAAAAAAAAI/AAAAAAAAABE/nc76HJWPs5Q/photo.jpg?sz=128", "display_name": "Quicky App", "link": "https://stackoverflow.com/users/6942677/quicky-app"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 48545656, "answer_count": 3, "score": 2, "last_activity_date": 1517539891, "creation_date": 1517412146, "last_edit_date": 1517425367, "question_id": 48545612, "link": "https://stackoverflow.com/questions/48545612/how-to-stop-duplicates-values-in-an-array-in-c", "title": "How to stop duplicates values in an array in C", "body": "<p>I am creating a 5x5 board game in C. The problem I am having is that when I use the rand() it duplicates some of the numbers. How do I stop the duplicates and 0's?</p>\n\n<p>Sorry if too basic a question. I'm new to C.</p>\n\n<pre><code>int createboard() {\n\n  int rows;\n  int columns;\n  int board[5][5];\n  int board2[5][5];\n\n  srand(time(NULL));\n\n  for (rows = 0; rows &lt; 5; rows++) {\n    for (columns = 0; columns &lt; 5; columns++) {\n      randomNumber = rand() % 25;\n      board[rows][columns] = randomNumber;\n    }\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "embedded", "riot-os"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1517414254, "post_id": 48545405, "comment_id": 84088236, "body": "It is not too specific for SO but in order to get a better answer, you need to state exactly which tool chain that is used."}, {"owner": {"reputation": 4252, "user_id": 1113139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d875f6bb3d484f227b68a7b2923de948?s=128&d=identicon&r=PG", "display_name": "yegorich", "link": "https://stackoverflow.com/users/1113139/yegorich"}, "edited": false, "score": 0, "creation_date": 1556099469, "post_id": 48545405, "comment_id": 98319180, "body": "Could you solve your problem? If not, first of all try using <a href=\"https://github.com/RIOT-OS/RIOT/wiki/Use-Docker-to-build-RIOT\" rel=\"nofollow noreferrer\">Docker</a> to build the hello world example. Afterwards invoking <code>make BOARD=nucleo-f411re flash-only term</code> should burn the image, open the termnial and show the hello world messages."}, {"owner": {"reputation": 611, "user_id": 2988172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/327d6e83273fdd0687043861b898c2f6?s=128&d=identicon&r=PG&f=1", "display_name": "bjornruffians", "link": "https://stackoverflow.com/users/2988172/bjornruffians"}, "edited": false, "score": 0, "creation_date": 1556117710, "post_id": 48545405, "comment_id": 98330673, "body": "I did not end up solving this.  A project I was working on went a different direction (different platform and OS).  This was at the evaluation stage of the project.  Had RIOT been super easy to use, I would have recommended it but the MCU vendor had examples with freeRTOS that worked &quot;out-of-the-box&quot;.  (My opinion)"}], "answers": [{"comments": [{"owner": {"reputation": 611, "user_id": 2988172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/327d6e83273fdd0687043861b898c2f6?s=128&d=identicon&r=PG&f=1", "display_name": "bjornruffians", "link": "https://stackoverflow.com/users/2988172/bjornruffians"}, "edited": false, "score": 0, "creation_date": 1517418845, "post_id": 48546288, "comment_id": 84091450, "body": "I guess I&#39;m not sure how to do a simple GPIO either in the &quot;RIOT OS&quot; environment. I assume there is some standard way, versus platform specific function calls?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 611, "user_id": 2988172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/327d6e83273fdd0687043861b898c2f6?s=128&d=identicon&r=PG&f=1", "display_name": "bjornruffians", "link": "https://stackoverflow.com/users/2988172/bjornruffians"}, "edited": false, "score": 0, "creation_date": 1517472377, "post_id": 48546288, "comment_id": 84111622, "body": "@bornruffians Perfect time to learn then. No there&#39;s no standard way, it is MCU dependant. You&#39;ll have to read the friendly manual."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1517414175, "creation_date": 1517414175, "answer_id": 48546288, "question_id": 48545405, "link": "https://stackoverflow.com/questions/48545405/riot-os-stdout-for-embedded-platforms/48546288#48546288", "title": "RIOT OS - &quot;stdout&quot; for embedded platforms", "body": "<p>Embedded microcontroller system compilers fall into a category called <em>freestanding implementations</em>. This means that they don't have to provide libraries like <code>stdio.h</code> and you can't expect <code>printf</code> to be available.</p>\n\n<p>There is however a probability that there's a compiler library implementing stdio.h through UART transmission. You will have to check if your compiler implements this or not.</p>\n\n<p>Just for simple tests and \"hello world\"-like applications, it is far easier just to use GPIO pins. The embedded systems equivalent of \"hello world\" is to flash a LED.</p>\n"}, {"comments": [{"owner": {"reputation": 611, "user_id": 2988172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/327d6e83273fdd0687043861b898c2f6?s=128&d=identicon&r=PG&f=1", "display_name": "bjornruffians", "link": "https://stackoverflow.com/users/2988172/bjornruffians"}, "edited": false, "score": 0, "creation_date": 1517434856, "post_id": 48547411, "comment_id": 84100023, "body": "I implemented a fputc() function, but it doesn&#39;t seem to change behavior (no observable activity on the UART pins).  I also added a call to uart_init() from the file uart.c"}], "tags": [], "owner": {"reputation": 1357, "user_id": 773102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/St5U2.gif?s=128&g=1", "display_name": "Jonny Schubert", "link": "https://stackoverflow.com/users/773102/jonny-schubert"}, "is_accepted": false, "score": 1, "last_activity_date": 1517417618, "creation_date": 1517417618, "answer_id": 48547411, "question_id": 48545405, "link": "https://stackoverflow.com/questions/48545405/riot-os-stdout-for-embedded-platforms/48547411#48547411", "title": "RIOT OS - &quot;stdout&quot; for embedded platforms", "body": "<p>On embedded systems the user has to implement the function putchar(char chr) to output a single char. This function can use UART for example. </p>\n\n<p>The function should look something like:    </p>\n\n<pre><code>int fputc(int ch, FILE *f)\n{\n    /* Place your implementation of fputc here */\n    /* e.g. write a character to the USART */\n    HAL_UART_Transmit(&amp;huart1, (uint8_t *)&amp;ch, 1, 100);\n\n    return ch;\n}\n</code></pre>\n\n<p>Here you find a more complex example for an STM32F0</p>\n\n<p><a href=\"https://github.com/bjornfor/stm32-test/blob/master/STM32F0xx_StdPeriph_Lib_V1.0.0/Project/STM32F0xx_StdPeriph_Examples/USART/Printf/main.c\" rel=\"nofollow noreferrer\">https://github.com/bjornfor/stm32-test/blob/master/STM32F0xx_StdPeriph_Lib_V1.0.0/Project/STM32F0xx_StdPeriph_Examples/USART/Printf/main.c</a></p>\n"}, {"comments": [{"owner": {"reputation": 648, "user_id": 9968825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6d0332ac7d53381e1a5b84b320fd135?s=128&d=identicon&r=PG", "display_name": "chrysn", "link": "https://stackoverflow.com/users/9968825/chrysn"}, "edited": false, "score": 0, "creation_date": 1564679501, "post_id": 48553144, "comment_id": 101119943, "body": "This is not particularly useful for the described case, as RIOT-OS already implements those, and it stands to reason that bornruffians will keep using it on the embedded device. Then, redefining them would only cause build issues."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 648, "user_id": 9968825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6d0332ac7d53381e1a5b84b320fd135?s=128&d=identicon&r=PG", "display_name": "chrysn", "link": "https://stackoverflow.com/users/9968825/chrysn"}, "edited": false, "score": 0, "creation_date": 1564684415, "post_id": 48553144, "comment_id": 101122039, "body": "@chrysn : Point noted.  It seems that Toons answer makes that clear - a clear case of RTFM it seems."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 2, "last_activity_date": 1517441401, "creation_date": 1517441401, "answer_id": 48553144, "question_id": 48545405, "link": "https://stackoverflow.com/questions/48545405/riot-os-stdout-for-embedded-platforms/48553144#48553144", "title": "RIOT OS - &quot;stdout&quot; for embedded platforms", "body": "<p>The toolchain you are using uses the Newlib C library (rather than GNU's libc which has POSIX dependencies).  To port newlib to your target, some standard functions require re-implementation of at least some of the syscalls stub.  </p>\n\n<p>Specifically for <code>stdout</code> to work, you need to implement at least <code>_write_r()</code>.  If the UART is the only device you will ever support, you can ignore the file descriptor - for stdout it will always be 1 (0 = stdin, 2 = stderr).</p>\n\n<p>As an aside if you want <code>malloc()</code> <em>et al</em> to work, you need ot implement <code>_sbrk_r()</code>.</p>\n\n<p><a href=\"https://www.embedded.com/electronics-blogs/industry-comment/4023922/Embedding-GNU-Newlib-Part-2\" rel=\"nofollow noreferrer\">Bill Gatliff's article on embedded.com</a> provides examples for Newlib porting for uC/OS - the principles are probably similar for RIOT OS, but equally you could make it simpler if your library I/O needs do not need to be that sophisticated.</p>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 10437744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4a6c87c6236e2e3a4071be6ac1c5bd1?s=128&d=identicon&r=PG&f=1", "display_name": "Toon", "link": "https://stackoverflow.com/users/10437744/toon"}, "is_accepted": true, "score": 5, "last_activity_date": 1547297615, "last_edit_date": 1547297615, "creation_date": 1538328742, "answer_id": 52580416, "question_id": 48545405, "link": "https://stackoverflow.com/questions/48545405/riot-os-stdout-for-embedded-platforms/52580416#52580416", "title": "RIOT OS - &quot;stdout&quot; for embedded platforms", "body": "<p>In RIOT OS, by default the stdio is mapped to UART0. This can be seen here:\n<a href=\"https://github.com/RIOT-OS/RIOT/blob/master/sys/include/stdio_uart.h#L38\" rel=\"nofollow noreferrer\">https://github.com/RIOT-OS/RIOT/blob/master/sys/include/stdio_uart.h#L38</a></p>\n\n<p>By redefining <code>STDIO_UART_DEV</code> you can map the stdio to a different UART. If you want to know which UART is mapped to which pins, have a look in the <code>periph_conf.h</code> of your board, which in case of the Nucleo F411 is here:\n<a href=\"https://github.com/RIOT-OS/RIOT/blob/master/boards/nucleo-f411re/include/periph_conf.h#L56\" rel=\"nofollow noreferrer\">https://github.com/RIOT-OS/RIOT/blob/master/boards/nucleo-f411re/include/periph_conf.h#L56</a></p>\n"}], "owner": {"reputation": 611, "user_id": 2988172, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/327d6e83273fdd0687043861b898c2f6?s=128&d=identicon&r=PG&f=1", "display_name": "bjornruffians", "link": "https://stackoverflow.com/users/2988172/bjornruffians"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1025, "favorite_count": 0, "accepted_answer_id": 52580416, "answer_count": 4, "score": -1, "last_activity_date": 1599118819, "creation_date": 1517411513, "last_edit_date": 1599118819, "question_id": 48545405, "link": "https://stackoverflow.com/questions/48545405/riot-os-stdout-for-embedded-platforms", "title": "RIOT OS - &quot;stdout&quot; for embedded platforms", "body": "<p>I'm trying out RIOT OS for the first time.  After downloading source, I can build applications pretty easily, including targets that need the ARM toolchain.  </p>\n\n<p>The hello-world application runs fine on my Linux build machine (built using BOARD=native) and prints in the terminal.  </p>\n\n<p>When I switch to an embedded platform (Nucleo F411 e.g. ARM Cortex M4) where can I expect any puts() or printf() calls to appear?  Further, how can I setup printf() to go to UART1 if that's not where it's going already?</p>\n\n<p>Apologies if this is too specific for SO.  I'm not familiar with the RIOT OS mailing lists but I'll try there as well.</p>\n\n<p>EDIT: The hello-world example is really bare bones, as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    puts(\"Hello World!\");\n\n    printf(\"You are running RIOT on a(n) %s board.\\n\", RIOT_BOARD);\n    printf(\"This board features a(n) %s MCU.\\n\", RIOT_MCU);\n\n    return 0;\n}\n</code></pre>\n\n<p>I am compiling with the ARM GNU toolchain, gcc-arm-none-eabi-7-2017-q4, after following install instructions here: <a href=\"https://github.com/RIOT-OS/RIOT/wiki/Family:-ARM\" rel=\"nofollow noreferrer\" title=\"link\">link</a>.  I figure I am going to need some extra compiler flags, or editing the board init functions outside the application code above.  But, at this stage, I don't know where to start.  My end goal is to observe \"Hello World!\" and \"You are running...\" on pin TX/D1 of my dev kit after configuring it to go there.</p>\n"}, {"tags": ["c", "linux", "process", "signals"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1517410330, "post_id": 48544933, "comment_id": 84085406, "body": "Please don\u2019t tag c++ <i>and</i> c. You\u2019re using one or the other, so tag accordingly."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1517410601, "post_id": 48544933, "comment_id": 84085619, "body": "<i>unrelated to your question</i>, but <code>while (scanf(&quot;%d%d&quot;, &amp;a, &amp;b) &gt; 0)</code> -&gt; <code>while (scanf(&quot;%d%d&quot;, &amp;a, &amp;b) == 2)</code> or you should initialize <code>a</code> and <code>b</code> before entering the loop."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 2, "creation_date": 1517410821, "post_id": 48544933, "comment_id": 84085806, "body": "Two things. 1. SIGPIPE isn&#39;t sent until the second write to a closed pipe (the first one returns 0, second one generates SIGPIPE). 2. Your parent process still has the pipes open."}, {"owner": {"reputation": 845, "user_id": 7632699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9ad6e931e258bb710bb5f26f8f577466?s=128&d=identicon&r=PG", "display_name": "TsReaper", "link": "https://stackoverflow.com/users/7632699/tsreaper"}, "edited": false, "score": 0, "creation_date": 1517411053, "post_id": 48544933, "comment_id": 84085982, "body": "You are right... After closing the pipes in the parent process, the asking process is now terminated due to SIGPIPE. Sorry for the mistake, it&#39;s so awkward...-_-&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 845, "user_id": 7632699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9ad6e931e258bb710bb5f26f8f577466?s=128&d=identicon&r=PG", "display_name": "TsReaper", "link": "https://stackoverflow.com/users/7632699/tsreaper"}, "is_accepted": true, "score": 0, "last_activity_date": 1517411171, "creation_date": 1517411171, "answer_id": 48545322, "question_id": 48544933, "link": "https://stackoverflow.com/questions/48544933/why-sigpipe-doesnt-occur-when-the-read-end-of-a-pipe-is-closed/48545322#48545322", "title": "Why SIGPIPE doesn&#39;t occur when the read end of a pipe is closed?", "body": "<p>Thanks @Art for the comment. I forgot to close the pipes in the parent process-_-\"</p>\n\n<p>After closing the pipes in the parent process, the asking process is now terminated due to SIGPIPE.</p>\n"}], "owner": {"reputation": 845, "user_id": 7632699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9ad6e931e258bb710bb5f26f8f577466?s=128&d=identicon&r=PG", "display_name": "TsReaper", "link": "https://stackoverflow.com/users/7632699/tsreaper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 48545322, "answer_count": 1, "score": 1, "last_activity_date": 1517411171, "creation_date": 1517410077, "last_edit_date": 1517410768, "question_id": 48544933, "link": "https://stackoverflow.com/questions/48544933/why-sigpipe-doesnt-occur-when-the-read-end-of-a-pipe-is-closed", "title": "Why SIGPIPE doesn&#39;t occur when the read end of a pipe is closed?", "body": "<p>I'm trying to write a program with two processes:</p>\n\n<p>One process generates some a + b problems and print it to its stdout (like <code>printf(\"%d %d\\n\", a, b)</code>), and gets the answer from another process through stdin, and log the answer to log.txt. When all the problems are asked, the process will print out \"-1 -1\" to indicate the end of the problems.</p>\n\n<p>Another process receives the a + b problems through stdin (like <code>scanf(\"%d%d\", &amp;a, &amp;b)</code>), and prints the answer to its stdout. When <code>a = b = -1</code> the process exits.</p>\n\n<p>I'm using two pairs of pipe to connect the two processes. I use <code>dup2</code> to bind the pipes with stdin and stdout. My source code is shown below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/types.h&gt;\n\n// Get a + b question through stdin, and print answer to stdout\nvoid calc_a_plus_b() {\n    int a, b;\n    while (scanf(\"%d%d\", &amp;a, &amp;b) &gt; 0)\n    {\n        if (a == -1 &amp;&amp; b == -1)\n            break;\n        printf(\"%d\\n\", a + b);\n        fflush(stdout);\n    }\n}\n\n// Ask a + b through stdout, and get answer through stdin\n// Log answer to log.txt\nvoid ask_a_plus_b() {\n    FILE* log = fopen(\"log.txt\", \"w\");\n    int i, a, b, c;\n    for (i = 0; i &lt; 3; i++) {\n        a = i; b = i + 1;\n        printf(\"%d %d\\n\", a, b);\n        fflush(stdout);\n        scanf(\"%d\", &amp;c);\n        fprintf(log, \"%d\\n\", c);\n    }\n    printf(\"-1 -1\\n\");\n    fclose(log);\n}\n\nint main()\n{\n    pid_t ask_pid, calc_pid, term_pid;\n    int ask_to_calc[2], calc_to_ask[2];    // Two pairs of pipe\n    int status;\n\n    // Create pipe\n    pipe(ask_to_calc); pipe(calc_to_ask);\n\n    // Create calculate process\n    calc_pid = fork();\n    if (calc_pid == 0) {\n        // Close useless pipe\n        close(ask_to_calc[1]);\n        close(calc_to_ask[0]);\n\n        // Bind pipe to stdin and stdout\n        dup2(ask_to_calc[0], 0);\n        dup2(calc_to_ask[1], 1);\n        close(ask_to_calc[0]);\n        close(calc_to_ask[1]);\n\n        calc_a_plus_b();\n        return 0;\n    }\n\n    // Create ask process\n    ask_pid = fork();\n    if (ask_pid == 0) {\n        // Close useless pipe\n        close(ask_to_calc[0]);\n        close(calc_to_ask[1]);\n\n        // Bind pipe to stdin and stdout\n        dup2(calc_to_ask[0], 0);\n        dup2(ask_to_calc[1], 1);\n\n        ask_a_plus_b();\n        return 0;\n    }\n\n    // Wait for children to exit\n    while ((term_pid = wait(&amp;status)) &gt; 0) {\n        if (WIFSTOPPED(status))\n        {\n            // If child stopped but hasn't exited, ignore\n            continue;\n        } else if (WIFSIGNALED(status)) {\n            // Child exited due to signal\n            printf(\"%s terminated due to signal %d\\n\", ask_pid == term_pid ? \"ask\" : \"calc\", WTERMSIG(status));\n        } else {\n            // Child exited normally\n            printf(\"%s terminated normally\\n\", ask_pid == term_pid ? \"ask\" : \"calc\");\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>This code runs normally, and prints out</p>\n\n<pre><code>calc terminated normally\nask terminated normally\n</code></pre>\n\n<p>From <code>man 7 pipe</code> (<a href=\"http://man7.org/linux/man-pages/man7/pipe.7.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man7/pipe.7.html</a>) I know that, when all the file descriptors to the read end of a pipe is closed, and another process still tries to write to this pipe, a SIGPIPE will occur. So I decided to remove all the code in <code>calc_a_plus_b</code> and see what will happen.</p>\n\n<p>Surprisingly, SIGPIPE doesn't occur. The program only prints out</p>\n\n<pre><code>calc terminated normally\n</code></pre>\n\n<p>after that the program is stuck. I guess this is because the <code>printf</code> in <code>ask_a_plus_b</code> is blocked.</p>\n\n<p>I think I've closed all the file descriptors to the read end of the pipe <code>ask_to_calc</code> (I've bound the pipe to the stdin of the calculating process, but the process has exited so its stdin is also closed right?), so why SIGPIPE doesn't occur when the asking process tries to write to the pipe?</p>\n"}, {"tags": ["c", "callback", "function-pointers", "unions"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517409652, "post_id": 48544651, "comment_id": 84084870, "body": "define union as <code>typedef union {   void* callback;   void (*callback_s_char)(signed char);   void (*callback_void)(void); } callback_func_ptr_t;</code> - so add <code>void* callback;</code> member. and <code>void register_callback(event_t event, void* ptr) {     callback_func_ptrs[event].callback = ptr; }</code> and <code>register_callback(EVENT1, event_func1);</code> - not need any typecast more"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 3, "creation_date": 1517409707, "post_id": 48544651, "comment_id": 84084917, "body": "@RbMm That would be undefined behavior, because <code>void *</code> data pointer representation is not guaranteed to be compatible with function pointers. Specifically, this would break on CPUs with Harvard Architecture."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1517409804, "post_id": 48544651, "comment_id": 84084999, "body": "@dasblinkenlight - this is absolute false. pointer to void and pointer to function - is absolute the same. 4 or 8 bytes depend from system bitness"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517410085, "post_id": 48544651, "comment_id": 84085206, "body": "@RbMm This is a common compiler extension, not a standard. <a href=\"https://stackoverflow.com/a/13697654/335858\">Relevant Q&amp;A</a>."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1517410379, "post_id": 48544651, "comment_id": 84085442, "body": "@dasblinkenlight - pointer is only the pointer - register size data (i not say about pointer to member in c++ which is different). what i say based not on any standard but my internal knowledge. no matter to what point pointer - to code (function pointer) to data, which is data type. in all case this is simply register size data"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 3, "creation_date": 1517410422, "post_id": 48544651, "comment_id": 84085469, "body": "@RbMm <i>pointer to void and pointer to function - is absolute the same.</i> Utterly, completely incorrect.  The world isn&#39;t limited to recent x86 architectures.  For example.  <a href=\"https://en.wikipedia.org/wiki/Far_pointer\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Far_pointer</a>  Per <b>6.2.5 Types</b>, paragraph 27 of <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf\" rel=\"nofollow noreferrer\">the C standard</a>:  &quot;... Pointers  to  other  types  need  not  have  the  same representation or alignment requirements.&quot;"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1517410526, "post_id": 48544651, "comment_id": 84085553, "body": "@AndrewHenle - i nothing say about x86. but pointer is register size data. no matter to where it point"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1517410758, "post_id": 48544651, "comment_id": 84085756, "body": "@RbMm: You are true for most common architectures and compilers, and wrong is we speak of C language specifications. Just read the references you were given in comments..."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1517410973, "post_id": 48544651, "comment_id": 84085907, "body": "@SergeBallesta - i say nothing about formal standard. i know that formal by standard this may be incorrect. and also different member of union used - write to one, read from another. but i sure that really is always correct do this on practic. are you can build example when this not true ?"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517411126, "post_id": 48544651, "comment_id": 84086039, "body": "@RbMm In C it is perfectly legal to write to one union member and to read from the other (type punning). In C++ this is prohibited, though."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517411138, "post_id": 48544651, "comment_id": 84086050, "body": "@RbMm Do you know what a <code>far</code>, <code>near</code>, or <code>huge</code> pointer are?  Those are examples where pointer sizes vary.  And given just the x86 architecture, please define &quot;the register size&quot; - then you get to deal with x86&#39;s real-mode <a href=\"https://en.wikipedia.org/wiki/X86_memory_segmentation\" rel=\"nofollow noreferrer\">segmented addressing</a>.  How about architectures with different address sizes for code and data?"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1517411269, "post_id": 48544651, "comment_id": 84086145, "body": "@RbMm: dasblinkenlight has already given an example. <a href=\"https://en.wikipedia.org/wiki/Harvard_architecture\" rel=\"nofollow noreferrer\">Harvard architecture</a> computers use different buses for data and code, so you could have pointers to obj of size 4 and pointers to data of size 8 (or the opposite)"}, {"owner": {"reputation": 61, "user_id": 1160713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de27c56716d8cff784f4c77648310ae9?s=128&d=identicon&r=PG", "display_name": "user1160713", "link": "https://stackoverflow.com/users/1160713/user1160713"}, "edited": false, "score": 0, "creation_date": 1517411442, "post_id": 48544651, "comment_id": 84086247, "body": "The code is intended for a harvard architecture (PIC microcontroller with XC8 compiler)"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1517412316, "post_id": 48544651, "comment_id": 84086875, "body": "@user1160713, could you explain what you want to achieve from an array of dissimilar function pointers?  You can&#39;t <i>use</i> them without additional information, and in the use case you present, it appears that you can simply use a <code>struct</code> of correctly-typed function pointers instead of an array."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1517413846, "post_id": 48544651, "comment_id": 84087925, "body": "@dasblinkenlight - in c legal, in c++ prohibited - not true by fact. in c++ same as c - also legal."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1517414122, "post_id": 48544651, "comment_id": 84088133, "body": "@AndrewHenle - <i>what a far, near, or huge pointer are</i> - are ms-dos like system stile alive ?  &quot;the register size&quot; - 4 for x86 code, 8 for x64 for example"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1517414497, "post_id": 48544651, "comment_id": 84088423, "body": "@RbMm <i>in c legal, in c++ prohibited - not true by fact. in c++ same as c - also legal.</i> That is one of the scariest statements I&#39;ve ever noted on Stackoverflow.  You&#39;re attempting to defend the use code that&#39;s undefined behavior because it appears to you that it &quot;works&quot;, and worse, you don&#39;t even seem to be <i>trying</i> to understand why undefined behavior is bad.  You&#39;ve confused &quot;it didn&#39;t crash&quot; with &quot;it&#39;s legal&quot;.  That is fundamentally and completely wrong."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1517414631, "post_id": 48544651, "comment_id": 84088517, "body": "@AndrewHenle - the same compiler used for compile both c and c++ code. and by fact will be always and in c and in the c++ - this true. union only shared memory or register"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517417816, "post_id": 48544651, "comment_id": 84090750, "body": "@RbMm <i>the same compiler used for compile both c and c++ code.</i>  <a href=\"https://www.google.com/search?q=differences+between+C+and+C%2B%2B+site%3Astackoverflow.com\" rel=\"nofollow noreferrer\">C and C++ aren&#39;t even the same language.</a>  <i>and by fact will be always and in c and in the c++ - this true. union only shared memory or register</i> Repeating statements like that just makes it clear that you are not even trying to understand why it&#39;s wrong. The majority of computer code out there is not written for x86/Windows and it&#39;s not compiled with MSVC."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1517418109, "post_id": 48544651, "comment_id": 84090981, "body": "@AndrewHenle - why you all time repeat x86 ? why not x64 ?"}, {"owner": {"reputation": 61, "user_id": 1160713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de27c56716d8cff784f4c77648310ae9?s=128&d=identicon&r=PG", "display_name": "user1160713", "link": "https://stackoverflow.com/users/1160713/user1160713"}, "edited": false, "score": 0, "creation_date": 1517476329, "post_id": 48544651, "comment_id": 84113635, "body": "@user1160713: I&#39;m searching for a solution to handle different events through function pointers. A struct would also be possible but I don&#39;t see a way of accessing the struct through a register_callback function. Of course it would be possible to directly access the struct from the main function but this is not very beautiful either."}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1517411007, "creation_date": 1517411007, "answer_id": 48545266, "question_id": 48544651, "link": "https://stackoverflow.com/questions/48544651/c-store-different-callback-function-adresses-in-an-array/48545266#48545266", "title": "C - store different callback function adresses in an array", "body": "<p>Since you must provide the pointer type implicitly at the point of invocation by specifying the correct field of the union, you might as well do it with a cast. Adding a few typedefs and hiding the cast in a macro could make your code more readable:</p>\n\n<pre><code>typedef void (*callback_s_char_t)(signed char);\ntypedef void (*callback_void_t)(void);\n\ntypedef enum {\n    EVENT1,    \n    EVENT2,\n    MAX_EVENTS  \n} event_t;\n\ncallback_void_t callback_func_ptrs[MAX_EVENTS];\n\nvoid event_func1(signed char direction) {\n    printf(\"success rotated: %d\\n\", direction);\n}\nvoid event_func2(void) {\n    printf(\"success button pressed\\n\");\n}\n\nvoid register_callback(event_t event, callback_void_t ptr) {\n    callback_func_ptrs[event] = ptr;\n}\n\nint main(void) {\n\n    //register callback functions   \n    REGISTER_CALLBACK(EVENT1, event_func1);\n    REGISTER_CALLBACK(EVENT2, event_func2);\n\n    //call callbacks\n    if(callback_func_ptrs[EVENT1])\n        GET_CALLBACK(EVENT1,callback_s_char_t)(1);\n\n    if(callback_func_ptrs[EVENT2])\n        GET_CALLBACK(EVENT2,callback_void_t)();\n\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/ZI0lfp\" rel=\"nofollow noreferrer\">Demo.</a></p>\n"}], "owner": {"reputation": 61, "user_id": 1160713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de27c56716d8cff784f4c77648310ae9?s=128&d=identicon&r=PG", "display_name": "user1160713", "link": "https://stackoverflow.com/users/1160713/user1160713"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 927, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1547025947, "creation_date": 1517409245, "last_edit_date": 1547025947, "question_id": 48544651, "link": "https://stackoverflow.com/questions/48544651/c-store-different-callback-function-adresses-in-an-array", "title": "C - store different callback function adresses in an array", "body": "<p>I'm trying to store different callback function addresses in an array. To be able to store function addresses with different signatures, I have defined a union and I use typecasting. This approach seems to work, but it is not very beautiful. Is there a better solution?</p>\n\n<pre><code>typedef union {\n  void (*callback_s_char)(signed char);\n  void (*callback_void)(void);\n} callback_func_ptr_t;\n\ntypedef enum {\n    EVENT1,    \n    EVENT2,\n    MAX_EVENTS  \n} event_t;\n\ncallback_func_ptr_t callback_func_ptrs[MAX_EVENTS];\n\nvoid event_func1(signed char direction) {\n    printf(\"success rotated: %d\\n\", direction);\n}\nvoid event_func2(void) {\n    printf(\"success button pressed\\n\");\n}\n\nvoid register_callback(event_t event, void (*ptr)(void)) {\n    callback_func_ptrs[event].callback_void = ptr;\n}\n\nint main(void) {\n\n    //register callback functions   \n    register_callback(EVENT1, (void (*)(void))event_func1);\n    register_callback(EVENT2, (void (*)(void))event_func2);\n\n    //call callbacks\n    if(callback_func_ptrs[EVENT1].callback_s_char != NULL)\n        (*callback_func_ptrs[EVENT1].callback_s_char)(1);\n\n    if(callback_func_ptrs[EVENT2].callback_void != NULL)\n        (*callback_func_ptrs[EVENT2].callback_void)();\n}\n</code></pre>\n"}, {"tags": ["c", "if-statement", "multidimensional-array"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1517409956, "post_id": 48544574, "comment_id": 84085114, "body": "This does not make sense: <code>if (temp == &#39;1&#39; &amp;&amp; temp != &#39;;&#39;)</code> If the left hand side is true, the right hand side can never be false. You could remove the second part"}, {"owner": {"reputation": 29, "user_id": 9263090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff047d0b7fba6b3e0276ac0edc4fef01?s=128&d=identicon&r=PG&f=1", "display_name": "N. Holmes", "link": "https://stackoverflow.com/users/9263090/n-holmes"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1517410486, "post_id": 48544574, "comment_id": 84085523, "body": "Counter determines the size of the board, since its not a set board. And i think i had a problem originally how i had the if statement set and switched it around."}, {"owner": {"reputation": 29, "user_id": 9263090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff047d0b7fba6b3e0276ac0edc4fef01?s=128&d=identicon&r=PG&f=1", "display_name": "N. Holmes", "link": "https://stackoverflow.com/users/9263090/n-holmes"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1517411130, "post_id": 48544574, "comment_id": 84086042, "body": "I didn&#39;t realize i did, i blanked out there, my bad! (because I&#39;m not the brightest lightbulb in the shed)"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1517411917, "post_id": 48544574, "comment_id": 84086570, "body": "Could you please add the output you get when you feed the sample into your program? 1 or 2 Iterations should be OK. And please add some hint which values are wrong."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 9263090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff047d0b7fba6b3e0276ac0edc4fef01?s=128&d=identicon&r=PG&f=1", "display_name": "N. Holmes", "link": "https://stackoverflow.com/users/9263090/n-holmes"}, "edited": false, "score": 0, "creation_date": 1517410986, "post_id": 48545147, "comment_id": 84085917, "body": "Line 27      int matrix[counter][counter]; Doesn&#39;t that initialize the array?  How do you recommend fixing the first error?"}, {"owner": {"reputation": 29, "user_id": 9263090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff047d0b7fba6b3e0276ac0edc4fef01?s=128&d=identicon&r=PG&f=1", "display_name": "N. Holmes", "link": "https://stackoverflow.com/users/9263090/n-holmes"}, "edited": false, "score": 0, "creation_date": 1517411232, "post_id": 48545147, "comment_id": 84086115, "body": "When i fix the matrix to the line you gave it causes an error, would it be better to loop through and set to 0&#39;s?"}, {"owner": {"reputation": 29, "user_id": 9263090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff047d0b7fba6b3e0276ac0edc4fef01?s=128&d=identicon&r=PG&f=1", "display_name": "N. Holmes", "link": "https://stackoverflow.com/users/9263090/n-holmes"}, "edited": false, "score": 0, "creation_date": 1517411506, "post_id": 48545147, "comment_id": 84086298, "body": "and i know the board is set right actually as far as what&#39;s in it, as it prints correctly when ran, the neighbor count screws up somewhere though"}, {"owner": {"reputation": 29, "user_id": 9263090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff047d0b7fba6b3e0276ac0edc4fef01?s=128&d=identicon&r=PG&f=1", "display_name": "N. Holmes", "link": "https://stackoverflow.com/users/9263090/n-holmes"}, "edited": false, "score": 0, "creation_date": 1517414140, "post_id": 48545147, "comment_id": 84088157, "body": "No it&#39;s supposed to, it&#39;s supposed to count neighbors for each cell individually"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 29, "user_id": 9263090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff047d0b7fba6b3e0276ac0edc4fef01?s=128&d=identicon&r=PG&f=1", "display_name": "N. Holmes", "link": "https://stackoverflow.com/users/9263090/n-holmes"}, "edited": false, "score": 0, "creation_date": 1517414340, "post_id": 48545147, "comment_id": 84088299, "body": "Please read carefully. There is an <b>assignment</b> in the if-condition. Not a comparison. You should always enable warnings. If you have correct value <code>neighbors==2</code> before you reach that if-else construction, it will be changed to 3 afterwards."}, {"owner": {"reputation": 29, "user_id": 9263090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff047d0b7fba6b3e0276ac0edc4fef01?s=128&d=identicon&r=PG&f=1", "display_name": "N. Holmes", "link": "https://stackoverflow.com/users/9263090/n-holmes"}, "edited": false, "score": 0, "creation_date": 1517414444, "post_id": 48545147, "comment_id": 84088378, "body": "Oh my goodness! I&#39;ll check and see if that fixes it when I get home!"}], "tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": true, "score": 0, "last_activity_date": 1517413270, "last_edit_date": 1517413270, "creation_date": 1517410694, "answer_id": 48545147, "question_id": 48544574, "link": "https://stackoverflow.com/questions/48544574/somewhere-my-if-statements-mess-up-and-my-gsas-cant-gelp-me/48545147#48545147", "title": "Somewhere my if statements mess up, and my GSA&#39;s cant gelp me", "body": "<p>There are a few errors:</p>\n\n<p>1.\nFirst of all you only handle a fixed number of columns:</p>\n\n<pre><code>    if (rows==6){\n        cols++;\n        rows=0;\n    }       \n</code></pre>\n\n<p>This must be</p>\n\n<pre><code>    if (rows==counter){\n        cols++;\n        rows=0;\n    }       \n</code></pre>\n\n<p>You start a new line after reading 6 values. For this purpose you have an extra parameter <code>counter</code>. Remember: You don't have a fixed size.</p>\n\n<p>If your input is not a 6*6 field, you will put the read values in wrong positions.</p>\n\n<p>2.\nApart from that your initial array <code>matrix</code> is not initialized and contains garbage values. This clearly can mess up your result.</p>\n\n<p>Solution is easy:\nUse <code>memset</code> or create a tiny loop to set everything to 0.</p>\n\n<p>3.\nFor each character you increment <code>rows</code> which is wrong. You switched rows and columns. But as you only accept square input fields, this does ont matter.</p>\n\n<p>4.\nFinally your problem: \nYour counting is correct, but during taking actions you destroy the value of <code>neighbors</code>. </p>\n\n<pre><code>            else if (neighbors = 3){\n                updated[i][j]=1;\n            }\n</code></pre>\n\n<p>There should be a <code>==</code>\nYour compiler should give a warning about this.</p>\n"}], "owner": {"reputation": 29, "user_id": 9263090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff047d0b7fba6b3e0276ac0edc4fef01?s=128&d=identicon&r=PG&f=1", "display_name": "N. Holmes", "link": "https://stackoverflow.com/users/9263090/n-holmes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 48545147, "answer_count": 1, "score": -1, "last_activity_date": 1517413270, "creation_date": 1517408945, "last_edit_date": 1517412028, "question_id": 48544574, "link": "https://stackoverflow.com/questions/48544574/somewhere-my-if-statements-mess-up-and-my-gsas-cant-gelp-me", "title": "Somewhere my if statements mess up, and my GSA&#39;s cant gelp me", "body": "<p>So, this is supposed to go through a file of 0's, ';'s and 1;s (all in character form originally but i set to integers), however when i run it the code counts the neighboring living cells wrong, pulling 3's in 5 spots where there should be a 2 for my neighbor count.</p>\n\n<p>Current output;\nNeighbor square for how many neighbors each cell has (counting all 8 surrounding tiles), then the updated matrix after basic game of life operations happen, lastly the original Matrix\nThis is the original matrix below</p>\n\n<p>0;0;0;0;0;0</p>\n\n<p>0;0;0;1;0;0</p>\n\n<p>0;1;0;1;0;0</p>\n\n<p>0;0;1;1;0;0</p>\n\n<p>0;0;0;0;0;0</p>\n\n<p>0;0;0;0;0;0</p>\n\n<p>The rest of the process happens flawlessly, but the counting of neighbors doesn't work. What do i do wrong?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;  \nvoid manage_board(FILE *input, int counter, int iterate);\nint main (int argc, const char * argv[]){\n    FILE *input = fopen(argv[1],\"r\");\n    int counter = 0,temp1=0,temp2=0;\n    char temp = fgetc(input);\n    while (temp != EOF){\n        if (temp == '1' || temp == '0'){\n        counter+=1;\n        }\n        temp = fgetc(input) ;\n    }\n    counter = sqrt(counter);\n    rewind(input);\n    manage_board(input,counter, atoi(argv[2]));\n    fclose(input);\n    return 0;\n}\nvoid manage_board(FILE *input, int counter, int iterate){\n    int matrix[counter][counter];\n    FILE *output = fopen(\"output.csv\",\"w\");\n    int original[counter][counter];\n    int updated[counter][counter];\n    int rows = 0,cols = 0, neighbors =0;\n    char temp = fgetc(input);\n    /*for (int i=0; i&lt;counter; i++){\n        for (int j=0; j&lt;counter; j++){\n            updated[i][j] = 0; \n        }   \n        printf (\"\\n\");\n    }*/\n    while (temp != EOF){\n        //printf(\"%c\",temp);\n        if (temp == '1' &amp;&amp; temp != ';'){\n            matrix[cols][rows] = 1;\n            rows++;\n        }\n        else if (temp == '0' &amp;&amp; temp != ';'){\n            matrix[cols][rows] = 0;\n            rows++;\n        }\n        if (rows==6){\n            cols++;\n            rows=0;\n        }       \n        temp = fgetc(input);\n    }   \n    for (int i=0; i&lt;counter; i++){\n        for (int j=0; j&lt;counter; j++){\n            updated[i][j] = 0;          \n        }   \n        //printf (\"\\n\");\n    }\n    for (int i=0; i&lt;counter; i++){\n        for (int j=0; j&lt;counter; j++){\n            original[i][j] =matrix[i][j]; \n        }   \n        //printf (\"\\n\");\n    }   \n    for (int loops = 0; loops &lt; iterate;loops++){\n        for (int i=0; i&lt;counter; i++){\n            for (int j=0; j&lt;counter; j++){              \n                if ( i !=counter-1){ //down one\n                    if(matrix[i+1][j] == 1){\n                        neighbors ++;\n                    }\n                }\n                if ( i !=0){//up one\n                    if(matrix[i-1][j] == 1){\n                        neighbors++;\n                    }\n                }\n                if ( j != counter-1){//right one\n                    if (matrix[i][j+1] == 1){\n                    neighbors++;\n                    }\n                }\n                if (j !=0 ){//left one\n                    if (matrix[i][j-1] == 1 ){\n                        neighbors++;\n                    }\n                }\n                if (i !=counter-1 &amp;&amp; j != counter-1){//bot right\n                    if(matrix[i+1][j+1] == 1)\n                        neighbors++;\n                }\n                if (j != counter-1 &amp;&amp; i !=0 ){//top right\n                    if(matrix[i-1][j+1] == 1){\n                        neighbors++;\n                    }\n                }\n                if (j !=0 &amp;&amp; i !=0){//top left\n                    if (matrix[i-1][j-1] == 1){\n                        neighbors++;\n                    }\n                }\n                if (i !=counter-1 &amp;&amp; j !=0 ){//bottom left\n                    if (matrix[i+1][j-1] == 1){\n                        neighbors++;\n                    }\n                }\n                ///printf(\"%d\", matrix[i][j]);\n                //printf (\"%d \",neighbors);\n                if (neighbors &lt; 2 ){\n                    updated[i][j]=0;\n                }\n                else if (neighbors == 2 &amp;&amp; matrix[i][j] == 1)\n                    updated[i][j]=1;\n                else if (neighbors &gt; 3){\n                    updated[i][j]=0;\n                }\n                else if (neighbors = 3){\n                    updated[i][j]=1;\n                }\n                printf(\"%d \",neighbors);\n                neighbors = 0;\n            }\n            printf(\"\\n\");\n        }   \n        for (int i=0; i&lt;counter; i++){\n            for (int j=0; j&lt;counter; j++){\n                matrix[i][j]= updated[i][j];\n                printf(\"%d\",updated[i][j]);\n                updated[i][j] = 0;\n            }\n            printf(\"\\n\");\n        }\n    }\n        printf(\"original board\\n\");\n        for (int i=0; i&lt;counter; i++){\n            for (int j=0; j&lt;counter; j++){\n                printf(\"%d\", original[i][j]);\n            }\n            printf (\"\\n\");\n        }       \n        //printf(\" \\nnew matrix\\n\\n\");\n/*      for (int i=0; i&lt;counter; i++){\n            for (int j=0; j&lt;counter; j++){\n                    if (updated[i][j] == 1){\n                        fprintf( output, \"%d %d \\n\", i, j);\n                        //printf(updated)\n                    }\n            }\n        }\n    */  \n/* A live cell with fewer than two live neighbors dies. \nA live cell with more than three live neighbors also dies. \nA live cell with exactly two or three live neighbors lives. \nA dead cell with exactly three live neighbors becomes alive.*/\n}\n</code></pre>\n\n<p>Here is my output</p>\n\n<pre><code>0 0 1 1 1 0\n1 1 3 1 3 0\n1 1 5 3 3 0\n1 3 3 2 3 0\n0 1 3 3 1 0\n0 0 0 0 0 0\n\n\n000000\n001010\n000110\n011110\n001100\n000000\noriginal board\n000000\n000100\n010100\n001100\n000000\n000000\n</code></pre>\n\n<p>The neighbor matrix should appear </p>\n\n<pre><code>0 0 1 1 1 0\n1 1 3 1 2 0\n1 1 5 3 3 0\n1 2 3 2 2 0\n0 1 2 2 1 0\n0 0 0 0 0 0\n</code></pre>\n"}, {"tags": ["c", "assembly", "x86", "x86-64", "setjmp"], "comments": [{"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 1, "creation_date": 1517408859, "post_id": 48544505, "comment_id": 84084241, "body": "If that glibc implementation says so, what makes you think it&#39;s not correct?"}, {"owner": {"reputation": 113, "user_id": 5210304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c36a5ce14b6e1412bafeaa702548c7?s=128&d=identicon&r=PG", "display_name": "gammaALpha", "link": "https://stackoverflow.com/users/5210304/gammaalpha"}, "reply_to_user": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1517408955, "post_id": 48544505, "comment_id": 84084296, "body": "I&#39;m just not sure about my understanding of the code since I&#39;m rather new to assembly and C."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1517410025, "post_id": 48544505, "comment_id": 84085164, "body": "Are you asking whether that&#39;s what glibc does, or whether what glibc does is correct, or something else?"}, {"owner": {"reputation": 113, "user_id": 5210304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c36a5ce14b6e1412bafeaa702548c7?s=128&d=identicon&r=PG", "display_name": "gammaALpha", "link": "https://stackoverflow.com/users/5210304/gammaalpha"}, "edited": false, "score": 0, "creation_date": 1517410617, "post_id": 48544505, "comment_id": 84085630, "body": "I&#39;m asking in general what processor state needs to go in a jmp_buf on an x86-64 architecture. Not what glibc does or if it is correct. For example, which x86-64 registers need to be saved? What about condition flags? For example, I think the floating point registers do not need to be saved because they don&#39;t contribute to the state of the program."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1517425500, "post_id": 48544505, "comment_id": 84095236, "body": "It might be easier to ask what won&#39;t get saved. All the caller saved registers will not be saved. calling <code>setjmp</code> is like any other function. The caller has to preserve the caller registers (volatile) before calling <code>setjmp</code>. On x86-64 (and x86) This data usually gets saved to the stack by pushing or storing them to non-volatile registers. Because this data is already saved, the <code>jmp_buf</code> needs to concern itself with saving all the non-volatile (callee saved) registers."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1517425856, "post_id": 48544505, "comment_id": 84095412, "body": "Generally all the flags get restored as they were as it is easier to restore them all than individual ones. But at a minimum the direction flag must be 0 (forward) on exit from a function. The x87 control word is nonvolatile (callee saved) so it to must be restored. All the x87 registers are volatile (thus caller saved) so they don&#39;t need to be saved by setjmp. Since MMX registers are mapped onto x87 registers they too don&#39;t need to be savedas they too are caller saved (volatile registers)."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1517426057, "post_id": 48544505, "comment_id": 84095513, "body": "The best place to understand what is non-volatile and must e saved by setjmp is the <a href=\"https://www.uclibc.org/docs/psABI-x86_64.pdf\" rel=\"nofollow noreferrer\">64-bit Linux System V ABI</a>."}, {"owner": {"reputation": 113, "user_id": 5210304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c36a5ce14b6e1412bafeaa702548c7?s=128&d=identicon&r=PG", "display_name": "gammaALpha", "link": "https://stackoverflow.com/users/5210304/gammaalpha"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1517430537, "post_id": 48544505, "comment_id": 84097842, "body": "@MichaelPetch thank you a lot this actually helped a lot!"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 5210304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c36a5ce14b6e1412bafeaa702548c7?s=128&d=identicon&r=PG", "display_name": "gammaALpha", "link": "https://stackoverflow.com/users/5210304/gammaalpha"}, "edited": false, "score": 0, "creation_date": 1517418190, "post_id": 48547082, "comment_id": 84091046, "body": "Thank you! This makes it clearer. But on a practical machine, like the x86-64 architecture, would we really need to save the full set of registers? Also the floating point registers, flag status, etc.?"}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "reply_to_user": {"reputation": 113, "user_id": 5210304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c36a5ce14b6e1412bafeaa702548c7?s=128&d=identicon&r=PG", "display_name": "gammaALpha", "link": "https://stackoverflow.com/users/5210304/gammaalpha"}, "edited": false, "score": 0, "creation_date": 1517418315, "post_id": 48547082, "comment_id": 84091137, "body": "you didn&#39;t read the second paragraph, especially the part in parentheses."}, {"owner": {"reputation": 113, "user_id": 5210304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c36a5ce14b6e1412bafeaa702548c7?s=128&d=identicon&r=PG", "display_name": "gammaALpha", "link": "https://stackoverflow.com/users/5210304/gammaalpha"}, "edited": false, "score": 0, "creation_date": 1517418911, "post_id": 48547082, "comment_id": 84091490, "body": "I did but I was hoping there was a more concrete answer for a concrete x86-64 GNU C compiler for example or similar. Just to get an idea what might be important to have in the jmp_buf and of what the program state/environment might consist of."}], "tags": [], "owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "is_accepted": false, "score": 0, "last_activity_date": 1517416656, "creation_date": 1517416656, "answer_id": 48547082, "question_id": 48544505, "link": "https://stackoverflow.com/questions/48544505/what-software-visible-processor-state-needs-to-go-in-a-jmp-buf-on-an-x86-64-proc/48547082#48547082", "title": "What software-visible processor state needs to go in a jmp_buf on an x86-64 processor?", "body": "<p>As the <code>jmp_buf</code> is the only place that can be used to restore processor state on a <code>longjmp</code>, it's generally everything that is needed to restore the full state of the machine as it was when <code>setjmp</code>is called.</p>\n\n<p>This obviously depends very much on the processor and the compiler (what exactly does it use of the CPU's features to store program state):</p>\n\n<ul>\n<li>On an ideal pure-stack machine that holds information of CPU state nowhere but the stack, that would be the stack pointer only. Other than in very old or purely academical implementations, such machines do rarely exist. You could, however, write a compiler on a modern machine like an x86 that solely uses the stack to store such information. For such a hypothetical compiler, saving the stack pointer only would suffice to restore program state.</li>\n<li>On a more common, practical machine, this might be the stack pointer and the full set of registers used to store program status.</li>\n<li>On some CPUs that store program status information in other places, for example in a zero page, and compilers that make use of such CPU features, the <code>jmp_buff</code> would also need to store a copy of this zero page (certain 65xx CPUs or ATmel AVR MCUs and their compilers might use this feature)</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 2, "last_activity_date": 1517423732, "creation_date": 1517423732, "answer_id": 48549215, "question_id": 48544505, "link": "https://stackoverflow.com/questions/48544505/what-software-visible-processor-state-needs-to-go-in-a-jmp-buf-on-an-x86-64-proc/48549215#48549215", "title": "What software-visible processor state needs to go in a jmp_buf on an x86-64 processor?", "body": "<blockquote>\n  <p>For example, which x86-64 registers need to be saved? What about condition flags? For example, I think the floating point registers do not need to be saved because they don't contribute to the state of the program. </p>\n</blockquote>\n\n<p>That's because of the calling convention.  <code>setjmp</code> is a function-call that can return multiple times (the first time when you actually call it, later times when a child function calls <code>longjmp</code>), but it's still a function call.  Like any function call, the compiler assumes that all call-clobbered registers have been clobbered, so <code>longjmp</code> doesn't need to restore them.</p>\n\n<p>So yes, they're not part of the \"program state\" on a function call boundary because the compiler-generated asm is definitely not keeping any values in them.</p>\n\n<p>You're looking at glibc's implementation for the x86-64 System V ABI, where <em>all</em> vector / x87 registers are call-clobbered and thus don't have to be saved.</p>\n\n<p>In the Windows x86-64 calling convention, xmm6-15 are call-preserved (just the low 128 bits, not the upper portions of y/zmm6-15), and would have to be part of the <code>jmp_buf</code>.</p>\n\n<p>i.e. it's not the CPU architecture that's relevant here, it's the software calling convention.</p>\n\n<hr>\n\n<p>Besides the call-preserved registers, one key thing is that it's only legal to <code>longjmp</code> to a <code>jmp_buf</code> saved by a parent function, not from any arbitrary function after the function that called <code>setjmp</code> has returned.</p>\n\n<p>If <code>setjmp</code> had to support that, it would have to save the entire stack frame, or actually (for the function to be able to return, and that parent to be able to return, etc.) the whole stack all the way up to the top.  This is obviously insane, and thus it's clear why <code>longjmp</code> has that restriction of only being able to jump to parent / (great) grandparent functions, so it just has to restore the stack pointer to point at the still-existing stack frame and restore whatever local variables in that function might have been modified since <code>setjmp</code>.</p>\n\n<p>(On C / C++ implementations on architectures / calling conventions that use something other than a normal call-stack, a similar argument about the jump-target function being able to return still applies.)</p>\n"}], "owner": {"reputation": 113, "user_id": 5210304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c36a5ce14b6e1412bafeaa702548c7?s=128&d=identicon&r=PG", "display_name": "gammaALpha", "link": "https://stackoverflow.com/users/5210304/gammaalpha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 48549215, "answer_count": 2, "score": 1, "last_activity_date": 1517426069, "creation_date": 1517408730, "last_edit_date": 1517426069, "question_id": 48544505, "link": "https://stackoverflow.com/questions/48544505/what-software-visible-processor-state-needs-to-go-in-a-jmp-buf-on-an-x86-64-proc", "title": "What software-visible processor state needs to go in a jmp_buf on an x86-64 processor?", "body": "<p>As stated, what software-visible processor state needs to go in a <code>jmp_buf</code> on an x86-64 processor when <code>setjmp(jmp_buf env)</code> is called? What processor state does not?</p>\n\n<p>I have been reading a lot about <code>setjmp</code> and <code>longjmp</code> but couldn't find a clear answer to my question. I know it is implementation dependent but I would like to know for the x86_64 architecture. </p>\n\n<p>From the <a href=\"https://github.com/lattera/glibc/blob/master/sysdeps/x86_64/setjmp.S\" rel=\"nofollow noreferrer\">following implementation</a> \nit seems that on an x86-64 machine all the callee saved registers (<code>%r12-%r15</code>, <code>%rbp</code>, <code>%rbx</code>) need to be saved as well as the stack pointer, program counter and all the saved arguments of the current environment. However I'm not sure about that, hope someone could clarify that for me.</p>\n"}, {"tags": ["c", "testing", "libc", "test-suite"], "comments": [{"owner": {"reputation": 1754, "user_id": 6087092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jjhgT.jpg?s=128&g=1", "display_name": "Isac", "link": "https://stackoverflow.com/users/6087092/isac"}, "edited": false, "score": 0, "creation_date": 1517408717, "post_id": 48544352, "comment_id": 84084140, "body": "So you are asking if anyone knows a test suite for your not yet implemented library? Seems rather off topic"}, {"owner": {"reputation": 1143, "user_id": 3948912, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qDN5f.jpg?s=128&g=1", "display_name": "Ben Hirschberg", "link": "https://stackoverflow.com/users/3948912/ben-hirschberg"}, "reply_to_user": {"reputation": 1754, "user_id": 6087092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jjhgT.jpg?s=128&g=1", "display_name": "Isac", "link": "https://stackoverflow.com/users/6087092/isac"}, "edited": false, "score": 0, "creation_date": 1517411642, "post_id": 48544352, "comment_id": 84086396, "body": "I assume that people wrote other implementations of standard C library before me ;-) I&#39;m asking about reuse of test code since the API is there for more than 25 years..."}, {"owner": {"reputation": 1143, "user_id": 3948912, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qDN5f.jpg?s=128&g=1", "display_name": "Ben Hirschberg", "link": "https://stackoverflow.com/users/3948912/ben-hirschberg"}, "reply_to_user": {"reputation": 1754, "user_id": 6087092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jjhgT.jpg?s=128&g=1", "display_name": "Isac", "link": "https://stackoverflow.com/users/6087092/isac"}, "edited": false, "score": 0, "creation_date": 1517412621, "post_id": 48544352, "comment_id": 84087091, "body": "Here is an example: <a href=\"https://github.com/lattera/glibc/blob/master/posix/tst-preadwrite.c\" rel=\"nofollow noreferrer\">github.com/lattera/glibc/blob/master/posix/tst-preadwrite.c</a>  The problem that this is not comprehensive"}], "owner": {"reputation": 1143, "user_id": 3948912, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qDN5f.jpg?s=128&g=1", "display_name": "Ben Hirschberg", "link": "https://stackoverflow.com/users/3948912/ben-hirschberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517408332, "creation_date": 1517408332, "question_id": 48544352, "link": "https://stackoverflow.com/questions/48544352/file-system-operation-validation-at-c-standard-library-level", "title": "File system operation validation at C standard library level", "body": "<p>I'm implementing an alternative C standard library with file operation support.</p>\n\n<p>I'm planning to support both:</p>\n\n<ul>\n<li><a href=\"https://www.gnu.org/software/libc/manual/html_node/I_002fO-on-Streams.html#I_002fO-on-Streams\" rel=\"nofollow noreferrer\">file stream API</a> like fopen, fwrite and etc.</li>\n<li><a href=\"https://www.gnu.org/software/libc/manual/html_node/Low_002dLevel-I_002fO.html#Low_002dLevel-I_002fO\" rel=\"nofollow noreferrer\">low level file API</a> like open, write and etc.</li>\n</ul>\n\n<p>I'm looking for a test suite which validates my implementation against standard C requirements (example: validates that pread returns zero when the caller requests read beyond the file contents).</p>\n\n<p>I'll be happy for your suggestions. </p>\n"}, {"tags": ["html", "c"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1517408422, "post_id": 48544319, "comment_id": 84083906, "body": "Are you sure the file name is <code>.html</code> and not <code>.htm</code>?"}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1517408631, "post_id": 48544319, "comment_id": 84084076, "body": "Absolutely. Would that make a difference? I updated my answer. Could that be because of the file content?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1517409401, "post_id": 48544319, "comment_id": 84084647, "body": "Please show the verbatim output of your program and show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Especially show what <code>buf</code> is and how it is allocated, the problem is most likely <i>there</i>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1517409821, "post_id": 48544319, "comment_id": 84085011, "body": "^^^ what @MichaelWalz says.  Where&#39;s &#39;buf&#39; declared, and how big is it?   I don&#39;t suppose, by any chance that your &#39;test.html&#39; file is much bigger than the text files you were testing with?"}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 0, "creation_date": 1517410077, "post_id": 48544319, "comment_id": 84085195, "body": "Yeah, you&#39;re right, that&#39;s embarrassing... buf was way too small, after giving it a larger size, it worked fine. Thanks! Should this question be deleted?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1517410651, "post_id": 48544319, "comment_id": 84085655, "body": "@T.Meyer no, it should not be deleted, but you need to show how <code>request_get_file</code> is called, because the problem is <i>there</i>. But the design of the program is wrong anyway, it should be up to <code>request_get_file</code> to allocate a buffer of sufficient size, because it is only <i>there</i> where the file size is known. Your new program will fail again if you have a really big file."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1517411188, "post_id": 48544319, "comment_id": 84086082, "body": "Don&#39;t mark your questions &quot;[SOLVED]&quot; in the title. <a href=\"https://meta.stackoverflow.com/questions/311829/why-cant-i-mark-my-title-as-solved\">Mark them solved by accepting an answer</a>. Since there <i>is</i> no answer posted here (yet you have added a solution to your question post) you can self-answer and accept your own answer, if you wish."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1517411863, "post_id": 48544319, "comment_id": 84086530, "body": "And would you be treating the file contents as a <code>nul</code>-terminated <code>char</code> string?  If so, be aware that <code>fread()</code> will not <code>nul</code>-terminate your &quot;string&quot;."}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1517411865, "post_id": 48544319, "comment_id": 84086532, "body": "@MichaelWalz So do you mean that I should declare and allocate the buffer <i>within</i> the function or declare it outside of it and allocate the memory inside (and return the address, f.ex.)?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1517412901, "post_id": 48544319, "comment_id": 84087278, "body": "@T.Meyer it&#39;s up to you, <code>request_get_file</code> should allocate the memory and for example return the buffer to the allocated memory: <code>char *request_get_file( ....</code>. And use like this: <code>char *myfile = request_get_file(...</code>, then once you&#39;re done with the content pointed my <code>myfile</code> free the memory  with <code>free(myfile);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1517412827, "post_id": 48545666, "comment_id": 84087239, "body": "@MichaelWalz Why is that? Could you improve my answer, please? Doesn&#39;t buf have a value due to calloc()?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1517415213, "post_id": 48545666, "comment_id": 84088889, "body": "Sorry, I missed something in your code, it looks correct to me. Forget by wrong comments. I&#39;ve deleted them."}], "tags": [], "owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "is_accepted": true, "score": 0, "last_activity_date": 1517415686, "last_edit_date": 1517415686, "creation_date": 1517412303, "answer_id": 48545666, "question_id": 48544319, "link": "https://stackoverflow.com/questions/48544319/why-does-fread-not-work-for-files-with-html-content/48545666#48545666", "title": "Why does fread() not work for files with html content?", "body": "<p>The problem was that the buffer I was writing to was way too small to hold all the data read by <code>fread()</code>.</p>\n\n<p>My updated code: </p>\n\n<h3>Main:</h3>\n\n<pre><code>char* buf = NULL;\nrequest_get_file(\"/User/...\", &amp;buf);\n</code></pre>\n\n<h3>Function Declaration:</h3>\n\n<pre><code>int request_get_file(char* requested_file_path, char** buf) {\n    int file_size = 0;\n    FILE* fp = NULL;\n\n    if ((fp = fopen(requested_file_path, \"r+\")) == NULL) {\n        return errno;\n    }\n\n    fseek(fp, 0L, SEEK_END);\n    file_size = (int)ftell(fp);\n    rewind(fp);\n    errno = 0;\n\n    if ((*buf = calloc(file_size + 1, sizeof(char))) == NULL) {\n        perror(\"calloc()\");\n        return errno;\n    }\n\n    if (fread(*buf, 1, file_size, fp) == 0) {\n        if (!feof(fp)) {\n            if (ferror(fp)) {\n                printf(\"An error occured while reading the requested file. File size: %d\\n\", file_size);\n                perror(\"fread()\");\n                return errno;\n            }\n        }\n    }\n    fclose(fp);\n}\n</code></pre>\n"}], "owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 48545666, "answer_count": 1, "score": 0, "last_activity_date": 1517415686, "creation_date": 1517408237, "last_edit_date": 1517411664, "question_id": 48544319, "link": "https://stackoverflow.com/questions/48544319/why-does-fread-not-work-for-files-with-html-content", "title": "Why does fread() not work for files with html content?", "body": "<p>I tried to read some files with the following code:</p>\n\n<h3>Main:</h3>\n\n<pre><code>#define RESPONSE_MAX_LENGTH (1024 * 1024)       // Should be 1MB\nchar file_content[RESPONSE_MAX_LEGNTH];\nmemset(&amp;file_content, 0, RESPONSE_MAX_LEGNTH);\n\nrequest_get_file(\"/User/...\", file_content);\n</code></pre>\n\n<h3>Function Declaration:</h3>\n\n<pre><code>int request_get_file(char* requested_file_path, char* buf) {\n    int file_size = 0;\n    FILE* fp = NULL;\n\n    if ((fp = fopen(requested_file_path, \"r+\")) == NULL) {\n        return errno;\n    }\n\n    fseek(fp, 0L, SEEK_END);\n    file_size = (int)ftell(fp);\n    rewind(fp);\n    errno = 0;\n    if (fread(buf, 1, file_size, fp) == 0) {\n        if (!feof(fp)) {\n            if (ferror(fp)) {\n                printf(\"An error occured while reading the requested file. File size: %d\\n\", file_size);\n                perror(\"fread()\");\n                return errno;\n            }\n        }\n    }\n    fclose(fp);\n}\n</code></pre>\n\n<p>I am able to read .txt files, but when I open a html file, I get an error saying: </p>\n\n<p><code>fread(): Bad address</code> (Created with perror(\"fread\")) \n<code>errno = 14</code></p>\n\n<p>For some reason, this error only occurs for some specific documents.</p>\n\n<p><strong>Solution:</strong></p>\n\n<p>I just realized that the problem seems to be related to a specific file. After renaming my test.html to test.txt and trying to open this one, the error is still there. Could that have to do with the file content? \n=> <strong>Yes</strong>, as the buffer I was writing the data was way too small. </p>\n\n<p>How can I fix this issue?</p>\n"}, {"tags": ["c", "linux", "linux-device-driver", "device-tree"], "owner": {"reputation": 7630, "user_id": 709852, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/bf402f309d40d607a369395e32a984fc?s=128&d=identicon&r=PG", "display_name": "Henry Gomersall", "link": "https://stackoverflow.com/users/709852/henry-gomersall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1517407399, "creation_date": 1517407399, "question_id": 48544027, "link": "https://stackoverflow.com/questions/48544027/is-it-possible-to-inherit-from-a-linux-driver-with-minimal-modifications", "title": "Is it possible to inherit from a linux driver with minimal modifications?", "body": "<p>I'm using the <a href=\"https://www.kernel.org/doc/Documentation/spi/spidev\" rel=\"nofollow noreferrer\"><code>spidev</code></a> driver to expose a few SPI devices connected to an ARM SoC to userspace through a character device.</p>\n\n<p>Placing suitable nodes in the device tree will generate the devices as expected. However, the compatibility in the device tree in this case is set using the name \"spidev\". This causes the driver to issue a warning about the driver compatibility not being explicitly set. The warning is issued <a href=\"https://elixir.free-electrons.com/linux/latest/source/drivers/spi/spidev.c#L727\" rel=\"nofollow noreferrer\">here</a> during the device probe, and as I understand it is based on the device tree node being present but not being listed as a suitable <code>.compatible</code> in the <code>of_device_id</code> struct.</p>\n\n<p>I'd now like to fix this problem (the problem behind the warning). The obvious thing to do would be to patch <code>spidev.c</code> to have an extra <code>.compatible</code> line with my device(s) added appropriately.</p>\n\n<p>Better, IMO, would be to write a minimal driver that uses all the functionality of <code>spidev</code> but presents the correct <code>of_device_id</code> structure. This way small tweaks to <code>spidev.c</code> aren't going to break the solution, unlike a patch which would be rather fragile.</p>\n\n<p>My question then is this: How minimal a driver can I write to expose an <code>spidev</code> equivalent given that it's already been written? Can I effectively inherit from the driver and just change minimal parts of it (the <code>of_device_id</code> struct)?</p>\n\n<p>I can't find anything on the web talking about this, and <code>spidev</code> has no associated header file to draw on, so I'm not optimistic, but more than likely I've missed something.</p>\n"}, {"tags": ["c", "ppm", "ascii-art"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1517405502, "post_id": 48543329, "comment_id": 84081785, "body": "Please read on how to provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. For example, if file loading is not an issue, then we don&#39;t need to see it. You can remove it and replace it with simpler hardcoded input. Do not make us debug your code."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1517408394, "post_id": 48543329, "comment_id": 84083878, "body": "Using the magic &quot;number&quot; P3 you define a plain PPM where pixels are stored as <i>&quot;A raster of Height rows, in order from top to bottom. Each row consists of Width pixels, in order from left to right. Each pixel is a triplet of red, green, and blue samples, in that order. &quot;</i> and <i>&quot;Each sample in the raster has white space before and after it&quot;</i> (from <a href=\"http://netpbm.sourceforge.net/doc/ppm.html\" rel=\"nofollow noreferrer\">netpbm.sourceforge.net/doc/ppm.html</a> ). You are reading the file wrongly."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1517408673, "post_id": 48543329, "comment_id": 84084108, "body": "Also, to &quot;allocate place for array[width][length][3]&quot; you could just declare <code>int array[height][width][3];</code> (or even a <code>short int</code>)."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1517412244, "post_id": 48543329, "comment_id": 84086806, "body": "tip: if you have to say <i>&quot;it&#39;s showing something clearly different from the original image&quot;</i> or such, then you also need to show (A) the original image (B) what you want (C) what it&#39;s showing instead."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1517412861, "post_id": 48543329, "comment_id": 84087259, "body": "Welcome to Stack Overflow! Please <a href=\"https://stackoverflow.com/posts/48543329/edit\">edit</a> your question to show us what kind of debugging you&#39;ve done.  I expect you to have reduced your code to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and investigated with a debugger such as GDB, for example.  Ensure you&#39;ve enabled a full set of compiler warnings, too.  What did the tools tell you, and what information are they missing?  And read Eric Lippert&#39;s <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9294590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fa9c8ca885ae056366353d57781f92f?s=128&d=identicon&r=PG&f=1", "display_name": "Saber Dinpashoh", "link": "https://stackoverflow.com/users/9294590/saber-dinpashoh"}, "edited": false, "score": 0, "creation_date": 1517411047, "post_id": 48544288, "comment_id": 84085973, "body": "You got the point.problem solved.code working now.Thanks very much."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 3, "user_id": 9294590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fa9c8ca885ae056366353d57781f92f?s=128&d=identicon&r=PG&f=1", "display_name": "Saber Dinpashoh", "link": "https://stackoverflow.com/users/9294590/saber-dinpashoh"}, "edited": false, "score": 0, "creation_date": 1517425936, "post_id": 48544288, "comment_id": 84095454, "body": "@SaberDinpashoh If the answer helped you, please upvote it. If it solved your question, please mark it as the answer."}], "tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": true, "score": 1, "last_activity_date": 1517408150, "creation_date": 1517408150, "answer_id": 48544288, "question_id": 48543329, "link": "https://stackoverflow.com/questions/48543329/converting-a-ppm-file-into-ascii-art/48544288#48544288", "title": "Converting a ppm file into ASCII art", "body": "<p>Here:</p>\n\n<pre><code>array[x][y][0] = fgetc(input); //red\narray[x][y][1] = fgetc(input); //green\narray[x][y][2] = fgetc(input); //blue\n</code></pre>\n\n<p>you read the character code of a single characters from the file. That's not what you want. The PPM format stores the pixel info as numbers between 0 and 255. You could use <code>fscanf</code> to read them:</p>\n\n<pre><code>int res = fscanf(input, \"%d%d%d\",\n                        &amp;array[x][y][0],\n                        &amp;array[x][y][1],\n                        &amp;array[x][y][2]);\n\nif (res &lt; 3) handle_error();\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9294590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fa9c8ca885ae056366353d57781f92f?s=128&d=identicon&r=PG&f=1", "display_name": "Saber Dinpashoh", "link": "https://stackoverflow.com/users/9294590/saber-dinpashoh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "closed_date": 1517418942, "accepted_answer_id": 48544288, "answer_count": 1, "score": -1, "last_activity_date": 1517412176, "creation_date": 1517405229, "last_edit_date": 1517412176, "question_id": 48543329, "link": "https://stackoverflow.com/questions/48543329/converting-a-ppm-file-into-ascii-art", "closed_reason": "Not suitable for this site", "title": "Converting a ppm file into ASCII art", "body": "<p>I'm trying to write a code for converting a ppm image into ASCII art. I've written my code but this is not working properly. In fact, it's showing something clearly different from the original image. I have read the ppm file and wrote the ASCII art characters in a text file. Is there anyone who could help me?</p>\n\n<p>Here's my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n// convert the calculated greyscale to a character based on brightness\nchar method_of_conversion(int greyscale){\n    if(greyscale &gt;= 230){\n        return ' ';\n    }else if(greyscale &gt;= 200 ){\n        return ',';\n    }else if(greyscale &gt;= 180 ){\n        return ':';\n    }else if(greyscale &gt;= 160 ){\n        return '^';\n    }else if(greyscale &gt;= 130 ){\n        return '-';\n    }else if(greyscale &gt;= 100 ){\n        return '*';\n    }else if(greyscale &gt;= 70 ){\n        return '8';\n    }else if(greyscale &gt;= 50 ){\n        return '=';\n    }else {\n        return '#';\n}\n}\nint main(){\n    char ppmFile[100];\n    char outputFile[100];\n\n    int n;\n\n    scanf(\"%s\", ppmFile); //read the name of input file\n    scanf(\"%s\", outputFile); //read the name of output file \n    // the size of a window of pixels you have to convert to ascii art character\n    scanf(\"%d\", &amp;n); \n\n    FILE *input = fopen(ppmFile, \"r\");\n    FILE *output = fopen(outputFile, \"w\"); \n\n    int width, height; // max pixel is always 255\n    // read the header from the ppm file\n    printf(\"two files succesfully opened\");\n    fscanf(input, \"P3\\n%d %d\\n255\\n\", &amp;width, &amp;height);\n    printf(\"file read correctly that width=%d and height=%d\",width ,height);\n    // allocate place for array[width][length][3]\n    int a, b;\n    int ***array;\n    array = malloc(width*sizeof(int **));\n    for(a = 0; a &lt; width; a++){\n        array[a] = malloc(height*sizeof(int *));\n        for(b = 0; b &lt; height; b++){\n            array[a][b] = malloc(3*sizeof(int));\n        }\n    }\n\n    int x, y;\n    for (y = 0; y &lt; height;y++){ \n        for(x=0; x &lt; width; x++){\n            array[x][y][0] = fgetc(input); //red\n            array[x][y][1] = fgetc(input); //green\n            array[x][y][2] = fgetc(input); //blue\n}}\n            int greyscale;\n            int i, j;\n            int blockx,blocky,sum=0;\n            // convert blocks of pixels to a character and write it into output file\n            for(j = 0; j &lt; height; j+=n){\n                for(i=0; i &lt;width ; i+=n){sum=0;\n                    for(blocky=0; blocky &lt; n&amp;&amp;(j+blocky)&lt;height; blocky++){\n                    for(blockx = 0; blockx  &lt; n&amp;&amp;(i+blockx)&lt;width; blockx++){\n                    // greyscale = (red + green +blue)/3;\n                    sum+=(array[blockx+i][blocky+j][0] + array[blockx+i][blocky+j][1] +array[blockx+i][blocky+j][2]);\n                    }\n                    }\n                    greyscale = sum/(3*n*n);\n                    char c = method_of_conversion(greyscale);\n                    fprintf(output,\"%c \",c);\n                     // write the ASCII art directly in the output file\n                }\n            fprintf(output,\"\\n\"); // dont forget to go into a new line\n            }   \n    free(array);\n    fclose(input);\n    fclose(output);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 5, "creation_date": 1517404584, "post_id": 48543072, "comment_id": 84081148, "body": "This may or may not be directly relevant, but you have undefined behaviour. You should declare <code>sigset_t ss;</code> and pass <code>&amp;ss</code> to the sig functions. Currently you have an uninitialized pointer and are using a random area of memory for your signal set."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4180854"}, "reply_to_user": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1517404759, "post_id": 48543072, "comment_id": 84081276, "body": "Ofcourse! How silly. That was the problem, it works now"}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 1, "creation_date": 1517404900, "post_id": 48543072, "comment_id": 84081371, "body": "Have an upvote for a clearly-answered and well-thought-out question, even if the solution isn&#39;t likely to help anyone else"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1517405850, "post_id": 48543072, "comment_id": 84082049, "body": "And almost a MCVE (just needs a couple of <code>#include</code> and it will be complete)..."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1517406309, "post_id": 48543072, "comment_id": 84082379, "body": "Note that <code>printf()</code> is not an async-signal-safe function and can&#39;t be safely called from within a signal handler."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4180854"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1517406788, "post_id": 48543072, "comment_id": 84082744, "body": "@AndrewHenle seeing how this was written 7 minutes ago, you were probably typing that comment when I was reading the same statement from <a href=\"https://rads.stackoverflow.com/amzn/click/com/013409266X\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">this</a> book :D."}], "answers": [{"tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 1, "last_activity_date": 1517405282, "creation_date": 1517405282, "answer_id": 48543344, "question_id": 48543072, "link": "https://stackoverflow.com/questions/48543072/why-does-the-process-handle-the-blocked-signal/48543344#48543344", "title": "Why does the process handle the blocked signal?", "body": "<p>@Useless has rightly answered the question stating that you are invoking UB by passing an uninitialized pointer to <code>sig*</code> functions. </p>\n\n<p>As to why it works and doesn't crash or doesn't block SIGINT can be made clear if you add the line - </p>\n\n<pre><code>printf(\"%p\", ss);\n</code></pre>\n\n<p>This will most probably print <code>(nil)</code> or <code>0</code>. </p>\n\n<p>Luckily the uninitialized variable is set to <code>NULL</code> and from the documentation of <a href=\"http://man7.org/linux/man-pages/man2/sigprocmask.2.html\" rel=\"nofollow noreferrer\"><code>sigprocmask</code></a></p>\n\n<blockquote>\n  <p>If <code>set</code> is <code>NULL</code>, then the signal mask is unchanged (i.e., how is\n         ignored), but the current value of the signal mask is nevertheless\n         returned in <code>oldest</code> (if it is not <code>NULL</code>).</p>\n</blockquote>\n\n<p>So your blocking of <code>SIGINT</code> is in fact being ignored. But yes, you might also see crashes or some other (even correct behavior) if you are not lucky. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4180854"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1517405282, "creation_date": 1517404385, "question_id": 48543072, "link": "https://stackoverflow.com/questions/48543072/why-does-the-process-handle-the-blocked-signal", "title": "Why does the process handle the blocked signal?", "body": "<p>Consider the following program:</p>\n\n<pre><code>void handler(int signum){\n    printf(\"handling %d\\n\", signum);\n}\n\nint main() {\n    signal(SIGINT, handler);\n    sigset_t *ss;\n    sigemptyset(ss);\n    sigaddset(ss, SIGINT);\n    sigprocmask(SIG_BLOCK, ss, NULL);\n    for(;;);\n    return 0;\n}\n</code></pre>\n\n<p>After running this program in the terminal, when I press ctrl-c, i always get \"handling 2\" as output, but I would expect to get no output, as SIGINT was previously blocked. Am I blocking SIGINT wrongly? Am I misunderstanding what it means for a signal to be blocked, by assuming that a blocked signal will not be handled on entering the process from kernel mode to user mode?</p>\n"}, {"tags": ["c", "bit-manipulation", "bit-shift"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1517404449, "post_id": 48542911, "comment_id": 84081062, "body": "<code>%lu</code> does not specify a 64-bit integer (unless you have 64-bit <code>unsigned long</code>s) so the program is undefined."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1517404601, "post_id": 48542911, "comment_id": 84081160, "body": "You have multiple cases of <i>undefined behavior</i>. For starters, remember that <code>a</code> will be <a href=\"http://en.cppreference.com/w/c/language/conversion#Integer_promotions\" rel=\"nofollow noreferrer\">promoted to an <code>int</code></a> which is a <i>signed</i> 32-bit type. Then remember how computers typically handles negative numbers ([two&#39;s complement](<a href=\"http://en.cppreference.com/w/c/language/conversion#Integer_promotions\" rel=\"nofollow noreferrer\">promoted to an <code>int</code></a>)) and lastly remember that shifting a value more than the available bits is leading to UB."}, {"owner": {"reputation": 9606, "user_id": 5012099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7a24d87840141459cef20b2877bcd9bc?s=128&d=identicon&r=PG&f=1", "display_name": "FlyingTeller", "link": "https://stackoverflow.com/users/5012099/flyingteller"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517404930, "post_id": 48542911, "comment_id": 84081390, "body": "@Someprogrammerdude thanks, I actually didn&#39;t know that shifting was actually undefined when I exceed the number of bits. Guess that just never happened in my code before. Good to know though"}, {"owner": {"reputation": 9606, "user_id": 5012099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7a24d87840141459cef20b2877bcd9bc?s=128&d=identicon&r=PG&f=1", "display_name": "FlyingTeller", "link": "https://stackoverflow.com/users/5012099/flyingteller"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1517405213, "post_id": 48542911, "comment_id": 84081587, "body": "@molbdnilo <code>sizeof(unsigned long)</code> gives 8 bytes on my system, but you are right to point that out"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1517406375, "post_id": 48542911, "comment_id": 84082422, "body": "You seem to be changing your code - with the current code, modified as shown, I cannot reproduce your output."}, {"owner": {"reputation": 9606, "user_id": 5012099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7a24d87840141459cef20b2877bcd9bc?s=128&d=identicon&r=PG&f=1", "display_name": "FlyingTeller", "link": "https://stackoverflow.com/users/5012099/flyingteller"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1517406477, "post_id": 48542911, "comment_id": 84082512, "body": "@TobySpeight the only &quot;significant&quot; change I made was change the format specifier to <code>PRIu64</code>. But since the behaviour is <code>undefined</code>, it is very likely that you cannot reproduce my output"}], "answers": [{"comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 2, "creation_date": 1517404780, "post_id": 48543158, "comment_id": 84081287, "body": "Assuming 32 (or inferior) bits <code>int</code>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1517405472, "post_id": 48543158, "comment_id": 84081764, "body": "On a platform with a 128 bit <code>int</code>, the code as presented would be absolutely fine."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1517413572, "post_id": 48543158, "comment_id": 84087737, "body": "@Bathsheba Curious, do you know of any 128 bit <code>long long</code> or <code>intmax_t</code> implementations yet?  I know of various platforms that have some squishy <code>__int128</code> <i>extended integer</i> type, but not as  regular integer types.   Maybe someday?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1517414282, "post_id": 48543158, "comment_id": 84088256, "body": "@chux: Me neither sadly. But what I really want is a &quot;native&quot; decimal floating point type."}], "tags": [], "owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "is_accepted": false, "score": 1, "last_activity_date": 1517405680, "last_edit_date": 1592644375, "creation_date": 1517404651, "answer_id": 48543158, "question_id": 48542911, "link": "https://stackoverflow.com/questions/48542911/understanding-shift-operations-on-too-small-types/48543158#48543158", "title": "Understanding shift operations on too small types", "body": "<p>Because this is an undefined behavior.</p>\n<p><a href=\"http://port70.net/%7Ensz/c/c99/n1256.html#6.5.7p3\" rel=\"nofollow noreferrer\">C99</a></p>\n<blockquote>\n<p>shift-expression:</p>\n<p>The integer promotions are performed on each of the operands. The type of the result is that of the promoted left operand. If the value of the right operand is negative or is greater than or equal to <strong>the width of the promoted left operand</strong>, the behavior is undefined.</p>\n</blockquote>\n<p>Here your <code>char a</code> is promoted to <code>int</code>[See <a href=\"http://port70.net/%7Ensz/c/c99/n1256.html#6.3.1.1p2\" rel=\"nofollow noreferrer\">here</a> why]. And in your machine, the width of <code>int</code> is not bigger than 63, thus according to the standard, the behavior is undefined.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517414929, "post_id": 48543170, "comment_id": 84088721, "body": "Hmmm, as the spec is based on <i>values</i>, it appears <code>char a = 0; a &lt;&lt; 31;</code> or even <code>a &lt;&lt; 1000</code> would be well defined.  True that in OP&#39;s case <code>a == 1</code>, but your post with the citations made me re-think the &quot;shifting left by more than 30 bits invoked undefined behavior.&quot; applicability as it appears to be value dependent."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517415706, "post_id": 48543170, "comment_id": 84089247, "body": "@chux For shifts of less than the bit size for signed types then yes, whether or not the behavior is undefined depends on the value being shifted.  However, <i>any</i> shift greater than or equal to the bit size is undefined, per 6.5.7p3."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517416043, "post_id": 48543170, "comment_id": 84089486, "body": "It certainly looks that per 6.5.7p3, <code>0&lt;&lt;1000</code> is defined."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1517513073, "last_edit_date": 1517513073, "creation_date": 1517404692, "answer_id": 48543170, "question_id": 48542911, "link": "https://stackoverflow.com/questions/48542911/understanding-shift-operations-on-too-small-types/48543170#48543170", "title": "Understanding shift operations on too small types", "body": "<p>You're performing a shift that's greater than the size of the type in question.</p>\n\n<p>First, <code>a</code> (which is of type <code>char</code>) is promoted to type <code>int</code>.  This is detailed in section 6.3.1.1 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a>:</p>\n\n<blockquote>\n  <p>The following may be used in an expression wherever an <code>int</code> or <code>unsigned\n  int</code> may be used:</p>\n  \n  <ul>\n  <li>An object or expression with an integer type (other than <code>int</code> or <code>unsigned int</code>) whose integer conversion rank is less than or equal to\n  the rank of <code>int</code> and <code>unsigned int</code>.</li>\n  <li>A bit-field of type <code>_Bool</code>, <code>int</code>, <code>signed int</code>, or <code>unsigned int</code>.</li>\n  </ul>\n  \n  <p>If an <code>int</code> can represent all values of the original type (as restricted\n  by the width, for a bit-field), the value is converted to an <code>int</code>;\n  otherwise, it is converted to an <code>unsigned int</code>. These are called the\n  <em>integer promotions</em>. All other types are unchanged by the integer\n  promotions.</p>\n</blockquote>\n\n<p>Assuming an <code>int</code> is 32 bits on your system, shifting left by more than 30 bits invoked undefined behavior.  This is detailed in section 6.5.7 of the standard:</p>\n\n<blockquote>\n  <p><em>3</em> The integer promotions are performed on each of the operands. The type of the result is that of the promoted left operand. <strong>If the value\n  of the right operand is negative or is greater than or equal to the\n  width of the promoted left operand, the behavior is undefined</strong></p>\n  \n  <p><em>4</em> The result of <strong>E1 &lt;&lt; E2</strong> is E1 left-shifted <strong>E2</strong> bit positions; vacated\n  bits are filled with zeros. If <strong>E1</strong> has an unsigned type, the value of\n  the result is <strong>E1 \u00d7 2<sup>E2</sup></strong>, reduced modulo one more than the maximum value\n  representable in the result type. <strong>If E1 has a signed type and\n  nonnegative value, and E1 \u00d7 2<sup>E2</sup> is representable in the result type,\n  then that is the resulting value; otherwise, the behavior is\n  undefined.</strong></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 3, "last_activity_date": 1517405013, "last_edit_date": 1517405013, "creation_date": 1517404693, "answer_id": 48543171, "question_id": 48542911, "link": "https://stackoverflow.com/questions/48542911/understanding-shift-operations-on-too-small-types/48543171#48543171", "title": "Understanding shift operations on too small types", "body": "<p>The (somewhat unexpected) rule that kicks in here is that, when it comes to <code>&lt;&lt;</code>, </p>\n\n<blockquote>\n  <p>the type of the result is that of the promoted left operand</p>\n</blockquote>\n\n<p>This means that the type of  <code>a &lt;&lt; (uint64_t) i</code> is an <code>int</code>, as the <code>char</code> type for <code>a</code> is automatically widened to an <code>int</code>.</p>\n\n<p>It appears that your <code>int</code> is a 32 bit 2's complement signed type. Therefore for <code>i</code> greater or equal to 31, the behaviour of the expression is <em>undefined</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 1, "last_activity_date": 1517442368, "last_edit_date": 1517442368, "creation_date": 1517408944, "answer_id": 48544572, "question_id": 48542911, "link": "https://stackoverflow.com/questions/48542911/understanding-shift-operations-on-too-small-types/48544572#48544572", "title": "Understanding shift operations on too small types", "body": "<p>A lot of answers already address that your code have undefined behavior. Therefore it doesn't in general make sense to reason about what happened (as anything could have happened...).</p>\n\n<p>But.... sometimes it's actually quite interesting to do anyway - keeping in mind that it is <strong>pure guessing</strong> and <strong>not guaranteed to be correct</strong> and <strong>highly system dependent</strong> and .... </p>\n\n<p>So with all the disclaimers in place...</p>\n\n<blockquote>\n  <p>Where could the odd number 18446744071562067968  come from?</p>\n</blockquote>\n\n<p>Let's assume 32 bit <code>int</code>and also notice that your <code>char a = 1;</code> could just as well be <code>int a = 1;</code> because of integer promotion. So we can write:</p>\n\n<pre><code>int a = 1;\nint as = a &lt;&lt; 31;  // Undefined behavior here as 1*2^31 can't be stored in 32 bit int\nuint64_t b = as;\nprintf(\"%\" PRIu64 \"\\n\", b);\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>18446744071562067968\n</code></pre>\n\n<p>Hmmm.... there we have that mysterious 18446744071562067968  but why?</p>\n\n<p>Let's do one more printing:</p>\n\n<pre><code>int a = 1;\nint as = a &lt;&lt; 31;  // Undefined behavior here\nuint64_t b = as;\nprintf(\"%d\\n\", as);\nprintf(\"%\" PRIu64 \"\\n\", b);\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>-2147483648\n18446744071562067968\n</code></pre>\n\n<p>So <code>as</code> is negative so we really did:</p>\n\n<pre><code>uint64_t b = -2147483648;\n</code></pre>\n\n<p>Since b is unsigned the above is calculated as:</p>\n\n<pre><code>uint64_t b = UINT64_MAX + 1 - 2147483648;  // which is 18446744071562067968\n</code></pre>\n\n<p>So now we know where 18446744071562067968 came from. Not that mysterious after all.</p>\n\n<p>But this leaves another question - why is <code>as</code> negative?</p>\n\n<p>Hmmm.... let's do one more printing:</p>\n\n<pre><code>int a = 1;\nint as = a &lt;&lt; 31;  // Undefined behavior here\nuint64_t b = as;\nprintf(\"%d\\n\", as);\nprintf(\"%x\\n\", as);  // Print as in hex\nprintf(\"%\" PRIu64 \"\\n\", b);\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>-2147483648\n80000000\n18446744071562067968\n</code></pre>\n\n<p>So in hex <code>as</code> is <code>80000000</code> which is in fact a <code>1</code> left shifted 31 times. So the processor simply did what we asked for, i.e. <code>1 &lt;&lt; 31</code> It is undefined by the C standard but your/my processor was simply implemented to do like that - other machines may do something else.</p>\n\n<p><code>80000000</code> as a 32 bit 2's complement is <code>-2147483648</code> and thereby we know why <code>as</code> is negative.</p>\n"}], "owner": {"reputation": 9606, "user_id": 5012099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7a24d87840141459cef20b2877bcd9bc?s=128&d=identicon&r=PG&f=1", "display_name": "FlyingTeller", "link": "https://stackoverflow.com/users/5012099/flyingteller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 48544572, "answer_count": 4, "score": 1, "last_activity_date": 1517513073, "creation_date": 1517403913, "last_edit_date": 1517405257, "question_id": 48542911, "link": "https://stackoverflow.com/questions/48542911/understanding-shift-operations-on-too-small-types", "title": "Understanding shift operations on too small types", "body": "<p>I had an issue in my code with bitwise shifting in C that I boiled down to the following example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;inttypes.h&gt;\n\nint main(int argc, char **argv)\n{\n  char a = 1;\n  int i=0;\n  uint64_t b;\n  for(i=0; i&lt;64; i++)\n  {\n    b=0;\n    printf(\"i=%d\\n\", i);\n    b = (a&lt;&lt; ((uint64_t) i));\n    printf(\"%\" PRIu64 \"\\n\", b);\n  }\n  return 0;\n\n}\n</code></pre>\n\n<p>For reasons not apparent in this MWE <code>a</code> is a <code>char</code> from which I wanted to generate the powers of 2 up to 2^63. It failed because something weird was going on because <code>a</code> as not <code>uint64_t</code>. The obvious fix was </p>\n\n<pre><code>b = ((uint64_t)a&lt;&lt; ((uint64_t) i))\n</code></pre>\n\n<p>To understand what exactly was going on I wrote above MWE example from which I get the output (shown partially): </p>\n\n<pre><code>i=30  \n1073741824  \ni=31  \n18446744071562067968  \ni=32  \n1  \ni=33  \n2  \n</code></pre>\n\n<p>Now I am wondering how can I explain the jump from <code>i=30</code> to <code>i=31</code>? And how does it end up being 1 again at <code>i=32</code>?</p>\n\n<p>If it is of interest, I compiled above code using gcc (<code>gcc (SUSE Linux) 4.8.5</code>)</p>\n"}, {"tags": ["c++", "c", "winapi", "windows-10", "domaincontroller"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1517402383, "post_id": 48542321, "comment_id": 84079763, "body": "Close only counts in horseshoes and hand grenades."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1517402440, "post_id": 48542321, "comment_id": 84079791, "body": "For a standalone computer the domain name is the computer name.  There is no domain controller as you do not have a real domain."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1517402528, "post_id": 48542321, "comment_id": 84079834, "body": "Why is this question tagged <code>c++</code>?"}, {"owner": {"reputation": 213, "user_id": 5623335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e00e0647a5095f7b474c5b524828918d?s=128&d=identicon&r=PG&f=1", "display_name": "securityauditor", "link": "https://stackoverflow.com/users/5623335/securityauditor"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1517402606, "post_id": 48542321, "comment_id": 84079883, "body": "@Eljay While I prefer C, I am happy for a solution in C++."}, {"owner": {"reputation": 213, "user_id": 5623335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e00e0647a5095f7b474c5b524828918d?s=128&d=identicon&r=PG&f=1", "display_name": "securityauditor", "link": "https://stackoverflow.com/users/5623335/securityauditor"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1517402644, "post_id": 48542321, "comment_id": 84079905, "body": "@RichardCritten Okay but why does that command line return something called &quot;Domain Name:&quot; ?? Is it something different? Also if the domain name is the computer name why does the code I posted fail?"}, {"owner": {"reputation": 213, "user_id": 5623335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e00e0647a5095f7b474c5b524828918d?s=128&d=identicon&r=PG&f=1", "display_name": "securityauditor", "link": "https://stackoverflow.com/users/5623335/securityauditor"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1517403183, "post_id": 48542321, "comment_id": 84080245, "body": "@stark I know what that means but I need the WinAPI code to work, I am not allowed to use the command prompt (with system() or something) sorry."}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 1, "creation_date": 1517403895, "post_id": 48542321, "comment_id": 84080690, "body": "Your code asks for a domain controller. You don&#39;t have one. So it fails. Your command line gives you a domain name, not the name of a domain controller (which you don&#39;t have)."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517404038, "post_id": 48542321, "comment_id": 84080780, "body": "are you need name of the account domain ? (<code>DESKTOP-I53IU6C</code> this is exactly this in your case). <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms721755(v=vs.85).aspx#computers_that_are_not_domain_controllers\" rel=\"nofollow noreferrer\">Account domain</a> - this need ?"}, {"owner": {"reputation": 213, "user_id": 5623335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e00e0647a5095f7b474c5b524828918d?s=128&d=identicon&r=PG&f=1", "display_name": "securityauditor", "link": "https://stackoverflow.com/users/5623335/securityauditor"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517409685, "post_id": 48542321, "comment_id": 84084899, "body": "@RbMm I think I need account domain, how can I get it using WinAPI as using the command line is not allowed?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517409711, "post_id": 48542321, "comment_id": 84084923, "body": "@user5623335 -i paste answer already"}, {"owner": {"reputation": 213, "user_id": 5623335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e00e0647a5095f7b474c5b524828918d?s=128&d=identicon&r=PG&f=1", "display_name": "securityauditor", "link": "https://stackoverflow.com/users/5623335/securityauditor"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517410303, "post_id": 48542321, "comment_id": 84085386, "body": "@RbMm You are going to kill me - but would you mind doing one in C not C++ sorry? Your original code was very very helpful though."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517410449, "post_id": 48542321, "comment_id": 84085493, "body": "@user5623335 - sorry - i not understand your last comment"}, {"owner": {"reputation": 213, "user_id": 5623335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e00e0647a5095f7b474c5b524828918d?s=128&d=identicon&r=PG&f=1", "display_name": "securityauditor", "link": "https://stackoverflow.com/users/5623335/securityauditor"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517410602, "post_id": 48542321, "comment_id": 84085623, "body": "@RbMm The code you posted is C++ not C?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517410686, "post_id": 48542321, "comment_id": 84085679, "body": "what is different ? i always compile code as c++. for me this is c++ code."}, {"owner": {"reputation": 213, "user_id": 5623335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e00e0647a5095f7b474c5b524828918d?s=128&d=identicon&r=PG&f=1", "display_name": "securityauditor", "link": "https://stackoverflow.com/users/5623335/securityauditor"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517410730, "post_id": 48542321, "comment_id": 84085728, "body": "@RbMm Would it be possible to get this in C code please, I do not know enough C++ to understand it. I compile as C not C++."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517410811, "post_id": 48542321, "comment_id": 84085796, "body": "but this is almost compatible with <i>c</i> code - i not use any c++ features (except may be how variable declared). in what problem compile it as c ?"}, {"owner": {"reputation": 213, "user_id": 5623335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e00e0647a5095f7b474c5b524828918d?s=128&d=identicon&r=PG&f=1", "display_name": "securityauditor", "link": "https://stackoverflow.com/users/5623335/securityauditor"}, "edited": false, "score": 0, "creation_date": 1517411029, "post_id": 48542321, "comment_id": 84085956, "body": "error C2223: left of &#39;-&gt;DnsDomainName&#39; must point to struct/union. I get this error for DomainName, Name, Sid..."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517413971, "post_id": 48542321, "comment_id": 84088021, "body": "but this already your task  write final code and compile it. you anyway need be some change it. i describe which api and how need call for get info"}], "answers": [{"tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": true, "score": 1, "last_activity_date": 1517406130, "last_edit_date": 1517406130, "creation_date": 1517405800, "answer_id": 48543489, "question_id": 48542321, "link": "https://stackoverflow.com/questions/48542321/get-domain-controller-name/48543489#48543489", "title": "Get Domain Controller Name", "body": "<p>you can use call <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa378313(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>LsaQueryInformationPolicy</code></a> first with <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms721905(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><em><code>PolicyDnsDomainInformation</code></em></a>  or <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms721905(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><em><code>PolicyPrimaryDomainInformation</code></em></a> for get the computer <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms722415(v=vs.85).aspx#primary_domain\" rel=\"nofollow noreferrer\"><em>primary domain</em></a>. </p>\n\n<p>if the <em>Sid</em> member of <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms721904(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>POLICY_DNS_DOMAIN_INFO</code></a> or <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms722413(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>POLICY_PRIMARY_DOMAIN_INFO</code></a> (<em>the SID of the primary domain</em>) is 0 - this meant that system has no primary domain. in this case we need query <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms721755(v=vs.85).aspx#computers_that_are_not_domain_controllers\" rel=\"nofollow noreferrer\"><em>account domain</em></a>:</p>\n\n<blockquote>\n  <p>On a system that is not part of a network and therefore has no primary\n  domain, the account domain is used to house all accounts that provide\n  access to the computer.</p>\n</blockquote>\n\n<p>for this we need call <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa378313(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>LsaQueryInformationPolicy</code></a> with <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms721905(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><em><code>PolicyAccountDomainInformation</code></em></a> and got <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms721895(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>POLICY_ACCOUNT_DOMAIN_INFO</code></a> structure</p>\n\n<pre><code>#include &lt;Ntsecapi.h&gt;\n\nNTSTATUS PrintDomainName()\n{\n    LSA_HANDLE PolicyHandle;\n\n    static LSA_OBJECT_ATTRIBUTES oa = { sizeof(oa) };\n\n    NTSTATUS status = LsaOpenPolicy(0, &amp;oa, POLICY_VIEW_LOCAL_INFORMATION, &amp;PolicyHandle);\n\n    if (LSA_SUCCESS(status))\n    {\n        union {\n            PPOLICY_DNS_DOMAIN_INFO ppddi;\n            PPOLICY_ACCOUNT_DOMAIN_INFO ppadi;\n        };\n\n        if (LSA_SUCCESS(status = LsaQueryInformationPolicy(PolicyHandle, PolicyDnsDomainInformation, (void**)&amp;ppddi)))\n        {\n            if (ppddi-&gt;Sid)\n            {\n                DbgPrint(\"DnsDomainName: %wZ\\n\", &amp;ppddi-&gt;DnsDomainName);\n            }\n            else\n            {\n                DbgPrint(\"%wZ: not domain controller !!\\n\", &amp;ppddi-&gt;Name);\n                status = -1;\n            }\n\n            LsaFreeMemory(ppddi);\n\n            if (0 &gt; status)\n            {\n                if (LSA_SUCCESS(status = LsaQueryInformationPolicy(PolicyHandle, PolicyAccountDomainInformation, (void**)&amp;ppadi)))\n                {\n                    DbgPrint(\"DomainName: %wZ\\n\", &amp;ppadi-&gt;DomainName);\n                    LsaFreeMemory(ppadi);\n                }\n            }\n        }\n\n        LsaClose(PolicyHandle);\n    }\n\n    return status;\n}\n</code></pre>\n\n<p>i got next output:</p>\n\n<pre><code>WORKGROUP: not domain controller !!\nDomainName: DESKTOP-2N5ODLB\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 5623335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e00e0647a5095f7b474c5b524828918d?s=128&d=identicon&r=PG&f=1", "display_name": "securityauditor", "link": "https://stackoverflow.com/users/5623335/securityauditor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1836, "favorite_count": 0, "accepted_answer_id": 48543489, "answer_count": 1, "score": 0, "last_activity_date": 1517406130, "creation_date": 1517401983, "last_edit_date": 1517403131, "question_id": 48542321, "link": "https://stackoverflow.com/questions/48542321/get-domain-controller-name", "title": "Get Domain Controller Name", "body": "<p><strong>Summary:</strong> I want to get the name of the Domain Controller using just WinAPI, the computer is not on a network which might make my code fail with \"NERR_DCNotFound\"?</p>\n\n<p>I am trying to get the name of the Domain Controller that a networked computer would be part of.</p>\n\n<p>The computer I am experimenting with is just a personal computer, I never setup a Domain Controller or anything which <em>might</em> make testing difficult? At the moment it is inside of a VirtualBox, airgapped from the internet.</p>\n\n<p>When I run this from command line I get the following output, which appears to contain a Domain Name:</p>\n\n<pre><code>C:\\Users\\lone&gt;gpresult /Z\n\nMicrosoft (R) Windows (R) Operating System Group Policy Result tool v2.0\n\u00a9 2016 Microsoft Corporation. All rights reserved.\n\nCreated on 31/01/2018 at 12:24:12\n\n\nRSOP data for DESKTOP-I53IU6C\\lone on DESKTOP-I53IU6C : Logging Mode\n---------------------------------------------------------------------\n\nOS Configuration:            Standalone Workstation\nOS Version:                  10.0.10586\nSite Name:                   N/A\nRoaming Profile:             N/A\nLocal Profile:               C:\\Users\\lone\nConnected over a slow link?: No\n\n\nUSER SETTINGS\n--------------\n\n    Last time Group Policy was applied: 31/01/2018 at 10:30:38\n    Group Policy was applied from:      N/A\n    Group Policy slow link threshold:   500 kbps\n    Domain Name:                        DESKTOP-I53IU6C\n    Domain Type:                        &lt;Local Computer&gt;\n\n    Applied Group Policy Objects\n    -----------------------------\n        N/A\n\n    The following GPOs were not applied because they were filtered out\n    -------------------------------------------------------------------\n        Local Group Policy\n            Filtering:  Not Applied (Empty)\n\n    The user is a part of the following security groups\n    ---------------------------------------------------\n        None\n        Everyone\n        Local account and member of Administrators group\n        HelpLibraryUpdaters\n        BUILTIN\\Administrators\n        BUILTIN\\Users\n        NT AUTHORITY\\INTERACTIVE\n        CONSOLE LOGON\n        NT AUTHORITY\\Authenticated Users\n        This Organization\n        Local account\n        LOCAL\n        NTLM Authentication\n        High Mandatory Level\n\n    The user has the following security privileges\n    ----------------------------------------------\n\n\n    Resultant Set Of Policies for User\n    -----------------------------------\n\n        Software Installations\n        ----------------------\n            N/A\n\n        Logon Scripts\n        -------------\n            N/A\n\n        Logoff Scripts\n        --------------\n            N/A\n\n        Public Key Policies\n        -------------------\n            N/A\n\n        Administrative Templates\n        ------------------------\n            N/A\n\n        Folder Redirection\n        ------------------\n            N/A\n\n        Internet Explorer Browser User Interface\n        ----------------------------------------\n            N/A\n\n        Internet Explorer Connection\n        ----------------------------\n            N/A\n\n        Internet Explorer URLs\n        ----------------------\n            N/A\n\n        Internet Explorer Security\n        --------------------------\n            N/A\n\n        Internet Explorer Programs\n        --------------------------\n            N/A\n</code></pre>\n\n<p><strong>I get this from the above output:</strong>  </p>\n\n<blockquote>\n  <p>Domain Name: DESKTOP-I53IU6C</p>\n</blockquote>\n\n<p>Maybe I am getting Domain Name confused with the Domain Controller Name?</p>\n\n<p>I copy and pasted the code from the MSDN <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa370420(v=vs.85).aspx\" rel=\"nofollow noreferrer\">tutorial</a>:</p>\n\n<pre><code>#ifndef UNICODE\n#define UNICODE\n#endif\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;  // for _wtoi function\n#include &lt;assert.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;lm.h&gt;\n\n// Need to link with netapi32.lib\n#pragma comment(lib, \"netapi32.lib\")\n\nint wmain(int argc, wchar_t * argv[])\n{\n\n    NET_API_STATUS nStatus;\n\n    LPCWSTR lpServer = NULL;\n    LPCWSTR lpDomain = NULL;\n\n    LPCWSTR lpDcName = NULL;\n\n    if (argc != 3 ) {\n        wprintf(L\"Usage: %ws &lt;ServerName&gt; &lt;DomainName&gt;\\n\",\n                argv[0]);\n        wprintf(L\"     %ws Myserver Domain\\n\", argv[0]);\n        exit(1);\n    }\n\n    // lpServer = argv[1];\n    // lpDomain = argv[2];\n\n    wprintf(L\"Calling NetGetDCName with parameters\\n\");\n    wprintf(L\"    lpServer = %ws\\n\", lpServer);\n    wprintf(L\"    lpDomain = %ws\\n\", lpDomain);\n\n    //\n    // Call the NetGetDCName function\n    //\n    nStatus = NetGetDCName(lpServer, lpDomain, (LPBYTE *) &amp;lpDcName);\n    //\n    // If the call succeeds,\n    //\n    if (nStatus == NERR_Success) {\n        wprintf(L\"NetGetDCName was successful\\n\", nStatus);\n        wprintf(L\"DC Name = %ws\\n\", lpDcName);\n        // Need to free the returned buffer\n        nStatus = NetApiBufferFree( (LPVOID) lpDcName);\n        if (nStatus != NERR_Success)\n            wprintf(L\"NetApiBufferFree failed with error: %lu (0x%lx)\\n\",\n                nStatus, nStatus);\n    } else {\n        wprintf(L\"NetGetDCName failed with error: %lu (0x%lx)\\n\", nStatus,\n                nStatus);\n        wprintf(L\"   Error = \");\n        switch (nStatus) {\n        case ERROR_INVALID_PARAMETER:\n            wprintf(L\"ERROR_INVALID_PARAMETER\\n\");\n            break;\n        case ERROR_NO_SUCH_DOMAIN:\n            wprintf(L\"ERROR_NO_SUCH_DOMAIN\\n\");\n            break;\n        case ERROR_NOT_SUPPORTED:\n            wprintf(L\"ERROR_NOT_SUPPORTED\\n\");\n            break;\n        case ERROR_BAD_NETPATH:\n            wprintf(L\"ERROR_BAD_NETPATH\\n\");\n            break;\n        case ERROR_INVALID_COMPUTERNAME:\n            wprintf(L\"ERROR_INVALID_COMPUTERNAME\\n\");\n            break;\n        case DNS_ERROR_INVALID_NAME_CHAR:\n            wprintf(L\"DNS_ERROR_INVALID_NAME_CHAR\\n\");\n            break;\n        case DNS_ERROR_NON_RFC_NAME:\n            wprintf(L\"DNS_ERROR_NON_RFC_NAME\\n\");\n            break;\n        case ERROR_INVALID_NAME:\n            wprintf(L\"ERROR_INVALID_NAME\\n\");\n            break;\n        case NERR_DCNotFound:\n            wprintf(L\"NERR_DCNotFound\\n\");\n            break;\n        case NERR_WkstaNotStarted:\n            wprintf(L\"NERR_WkstaNotStarted\\n\");\n            break;\n        case RPC_S_SERVER_UNAVAILABLE:\n            wprintf(L\"RPC_S_SERVER_UNAVAILABLE\\n\");\n            break;\n        case RPC_E_REMOTE_DISABLED:\n            wprintf(L\"RPC_E_REMOTE_DISABLED\\n\");\n            break;\n        default:\n            wprintf(L\"Other error, see Winerror.h or lmerr.h)\\n\");\n            break;\n        }\n    }\n\n    return nStatus;\n}\n</code></pre>\n\n<p>I only commented out the command line arguments to keep them as NULL:</p>\n\n<blockquote>\n<pre><code>    // lpServer = argv[1];\n    // lpDomain = argv[2];\n</code></pre>\n  \n  <p>A pointer to a constant string that specifies the DNS or NetBIOS name\n  of the remote server on which the function is to execute. <strong>If this\n  parameter is NULL, the local computer is used.</strong></p>\n  \n  <p>A pointer to a constant string that specifies the name of the domain.\n  The domain name must be a NetBIOS domain name (for example,\n  microsoft). NetGetDCName does not support DNS-style names (for\n  example, microsoft.com). <strong>If this parameter is NULL, the function\n  returns the name of the domain controller for the primary domain.</strong></p>\n</blockquote>\n\n<p><strong>Error I get:</strong> </p>\n\n<blockquote>\n  <p>NERR_DCNotFound</p>\n</blockquote>\n\n<p>Why did the command line argument give me a Domain Name, but the WinAPI fails, or are they two different things with a similar name?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1517401576, "post_id": 48542145, "comment_id": 84079249, "body": "Does your controller have an MMU ? If not then it&#39;s hard to see how you would implement stack guards or any other kind of memory protection ?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1517402558, "post_id": 48542145, "comment_id": 84079854, "body": "<i>&quot;potentially hostile environment&quot;</i> Hostile how? You haven&#39;t defined what threats you are trying to protect from."}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 0, "creation_date": 1517402569, "post_id": 48542145, "comment_id": 84079859, "body": "What microcontroller are you using?"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1517402569, "post_id": 48542145, "comment_id": 84079861, "body": "I&#39;m not sure whether memory protection is the key in this case. Security issues come from outside .i.e. via input. No input - no security issue. (You cannot break into a house if it has neither doors nor windows.) To ban all comm. is probably not possible. Stackguards are good to detect buffer overruns. But careful design of communication (esp. input) to prevent e.g. buffer overruns should achieve this also. MMUs are helpful to prevent that one process accesses (in illegal manner) memory of another. For me, it&#39;s not clear how the &quot;hostile environment&quot; will be able to start such other process."}], "answers": [{"comments": [{"owner": {"reputation": 2533, "user_id": 2534648, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b0db0568c4b5ddba17953d7b8ba1cb5?s=128&d=identicon&r=PG", "display_name": "ooxi", "link": "https://stackoverflow.com/users/2534648/ooxi"}, "edited": false, "score": 0, "creation_date": 1517404037, "post_id": 48542793, "comment_id": 84080778, "body": "While your answer is valuable, I missed to express that I&#39;m not concerned about protecting IP. It&#39;s more about resilience against attacks on the bus."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 2533, "user_id": 2534648, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b0db0568c4b5ddba17953d7b8ba1cb5?s=128&d=identicon&r=PG", "display_name": "ooxi", "link": "https://stackoverflow.com/users/2534648/ooxi"}, "edited": false, "score": 0, "creation_date": 1517404116, "post_id": 48542793, "comment_id": 84080831, "body": "@ooxi Then your question is too broad, that&#39;s a big subject."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1517404290, "post_id": 48542793, "comment_id": 84080950, "body": "@Lundin I respectfully want to point out that if you have realized after answering that the question is in fact off topic, you should retract your answer. Close voting and also answering is not fair to other users."}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 1, "creation_date": 1517405510, "post_id": 48542793, "comment_id": 84081794, "body": "This answer was written before OP made some clarifications and the question was closed. What&#39;s wrong with that?"}, {"owner": {"reputation": 2533, "user_id": 2534648, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b0db0568c4b5ddba17953d7b8ba1cb5?s=128&d=identicon&r=PG", "display_name": "ooxi", "link": "https://stackoverflow.com/users/2534648/ooxi"}, "edited": false, "score": 0, "creation_date": 1517405734, "post_id": 48542793, "comment_id": 84081952, "body": "You are right, my question is too broad. I just don&#39;t even know, what too look out for :-( Nevertheless I am very thankful for your answer, since it helps me protect against an attack vector which might be relevant for other projects!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1517412468, "post_id": 48542793, "comment_id": 84086998, "body": "@AjayBrahmakshatriya I cast the close vote after the question was changed and no longer on-topic. Read the edit history of the question before making such comments. The question is now also down-voted and will therefore get roomba-deleted together with this answer."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1517403555, "creation_date": 1517403555, "answer_id": 48542793, "question_id": 48542145, "link": "https://stackoverflow.com/questions/48542145/best-practices-for-securing-an-embedded-device/48542793#48542793", "title": "Best practices for securing an embedded device", "body": "<p>Automotive MCU:s typically have a \"copy cat\" protection which blocks any form of debugger access - you can't read anything out of the MCU or debug it while this is active, you have to erase everything.</p>\n\n<p>Check out MCU:s by silicon vendors with a lot to automative customers, such as NXP/Freescale or Renesas.</p>\n"}], "owner": {"reputation": 2533, "user_id": 2534648, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b0db0568c4b5ddba17953d7b8ba1cb5?s=128&d=identicon&r=PG", "display_name": "ooxi", "link": "https://stackoverflow.com/users/2534648/ooxi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "closed_date": 1517404121, "answer_count": 1, "score": -2, "last_activity_date": 1517403826, "creation_date": 1517401489, "last_edit_date": 1517403826, "question_id": 48542145, "link": "https://stackoverflow.com/questions/48542145/best-practices-for-securing-an-embedded-device", "closed_reason": "Needs more focus", "title": "Best practices for securing an embedded device", "body": "<p>I'm currently developing an embedded controller, which will be connected to a potentially hostile environment. Since the Controller is quite limited (~50 MHz, ~16 KiB RAM), I do not have the luxury of an operating system which can help me with memory protection.</p>\n\n<p>What is considered best practices for securing an embedded device? I know of techniques like stack guards, but since I'm not familiar with embedded development, I'm looking for some kind of guidance.</p>\n\n<p><strong>Edit:</strong> I'm using an ATSAMD21G18, which does not have an MMU. It's the same as used on many Arduinos. The controller will be conntected to a public bus (as in wiring, not the transportation method) thus I cannot assume anything about the behaviour of other bus members.</p>\n\n<p>I am however not trying to protect IP, e.g. I'm not worried about somebody figuring out the contents of my controller. It's more about application security, e.g. how do I limit the harm done by somebody trying to take over my controller by exploiting e.g. buffer overruns.</p>\n"}, {"tags": ["c", "linux", "sockets"], "comments": [{"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1517401166, "post_id": 48541880, "comment_id": 84079006, "body": "recvfrom()&#39;s man page states that &quot;When a stream socket peer has performed an orderly shutdown, the return value will be 0 (the traditional &quot;end-of-file&quot; return).&quot; Your code does not handle this case, only -1."}], "answers": [{"tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": true, "score": 1, "last_activity_date": 1517401064, "creation_date": 1517401064, "answer_id": 48542015, "question_id": 48541880, "link": "https://stackoverflow.com/questions/48541880/how-do-i-make-the-program-exit-when-server-is-disconnected-instead-of-going-into/48542015#48542015", "title": "How do I make the program exit when server is disconnected instead of going into an infinte loop?", "body": "<p><code>recvfrom</code> returns zero when the other end of the connection is closed, not <code>&lt; 0</code>.</p>\n\n<p>Change your test of the return result as follows:</p>\n\n<pre><code>if (ret == 0)\n{\n  printf(\"Connection closed!\\n\");  \n  exit(0);  \n}\nelse if (ret &lt; 0) {  \n  printf(\"Error connecting to the server!\\n\");  \n  exit(1);  \n}\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 6876820, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-Su4LgQcW-o8/AAAAAAAAAAI/AAAAAAAAAAA/ZkY14Iuctmo/photo.jpg?sz=128", "display_name": "Jodh Singh", "link": "https://stackoverflow.com/users/6876820/jodh-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 48542015, "answer_count": 1, "score": 0, "last_activity_date": 1517401064, "creation_date": 1517400684, "question_id": 48541880, "link": "https://stackoverflow.com/questions/48541880/how-do-i-make-the-program-exit-when-server-is-disconnected-instead-of-going-into", "title": "How do I make the program exit when server is disconnected instead of going into an infinte loop?", "body": "<p>I have created a server and client communication system in C and when the server is shutdown or quit, the client goes into an infinite loop repeating the last received message instead of quitting. I think the problem lies in recieveMessage function declaration but can't seem to pinpoint it.</p>\n\n<p>How do I resolve this and how can I avoid this in the future?</p>\n\n<p><a href=\"https://i.stack.imgur.com/mTs1s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mTs1s.png\" alt=\"Output in console\"></a></p>\n\n<pre><code>#include\"stdio.h\"  \n#include\"stdlib.h\"  \n#include\"sys/types.h\"  \n#include\"sys/socket.h\"  \n#include\"string.h\"  \n#include\"netinet/in.h\"  \n#include\"netdb.h\"\n#include\"pthread.h\"\n\n#define PORT 4444 \n#define BUF_SIZE 2000 \n\nvoid * receiveMessage(void * socket) {\n int sockfd, ret;\n char buffer[BUF_SIZE]; \n sockfd = (int) socket;\n memset(buffer, 0, BUF_SIZE);  \n for (;;) {\n  ret = recvfrom(sockfd, buffer, BUF_SIZE, 0, NULL, NULL);  \n  if (ret &lt; 0) {  \n   printf(\"Error receiving data!\\n\");\n   break;  \n  } else {\n   printf(\"server: \");\n   fputs(buffer, stdout);\n   //printf(\"\\n\");\n  }  \n }\n}\n\nint main(int argc, char**argv) {  \n struct sockaddr_in addr, cl_addr;  \n int sockfd, ret;  \n char buffer[BUF_SIZE]; \n char * serverAddr;\n pthread_t rThread;\n\n if (argc &gt; 2) {\n  printf(\"usage: client &lt; ip address &gt;\\n\");\n  exit(1);  \n }\n\n serverAddr = argv[1]; \n\n sockfd = socket(AF_INET, SOCK_STREAM, 0);  \n if (sockfd &lt; 0) {  \n  printf(\"Error creating socket!\\n\");  \n  exit(1);  \n }  \n printf(\"Socket created...\\n\");   \n\n memset(&amp;addr, 0, sizeof(addr));  \n addr.sin_family = AF_INET;  \n addr.sin_addr.s_addr = inet_addr(\"192.168.31.90\");\n addr.sin_port = PORT;     \n\n ret = connect(sockfd, (struct sockaddr *) &amp;addr, sizeof(addr));  \n if (ret &lt; 0) {  \n  printf(\"Error connecting to the server!\\n\");  \n  exit(1);  \n }  \n printf(\"Connected to the server...\\n\");  \n\n memset(buffer, 0, BUF_SIZE);\n printf(\"Enter your messages one by one and press return key!\\n\");\n\n //creating a new thread for receiving messages from the server\n ret = pthread_create(&amp;rThread, NULL, receiveMessage, (void *) sockfd);\n if (ret) {\n  printf(\"ERROR: Return Code from pthread_create() is %d\\n\", ret);\n  exit(1);\n }\n\n while (fgets(buffer, BUF_SIZE, stdin) != NULL) {\n  ret = sendto(sockfd, buffer, BUF_SIZE, 0, (struct sockaddr *) &amp;addr, sizeof(addr));  \n  if (ret &lt; 0) {  \n   printf(\"Error sending data!\\n\\t-%s\", buffer);  \n   break;\n  }\n  puts(buffer);\n }\n\n close(sockfd);\n pthread_exit(NULL);\n\n return 0;    \n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "arm", "stm32", "spi"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1517400844, "post_id": 48541818, "comment_id": 84078811, "body": "What is your current inefficient way?"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 1, "creation_date": 1517400898, "post_id": 48541818, "comment_id": 84078842, "body": "<code>w = (w&lt;&lt;8)|(w&gt;&gt;8)</code>, and trust your compiler."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1517401630, "post_id": 48541818, "comment_id": 84079274, "body": "Can you preprocess your data with REV / REV16 instructions? Are you sure your DMA doesn&#39;t support endianness swapping?"}, {"owner": {"reputation": 95, "user_id": 6527528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff405acb88a3f9f88b8eaa83943e66d4?s=128&d=identicon&r=PG&f=1", "display_name": "Tobi", "link": "https://stackoverflow.com/users/6527528/tobi"}, "edited": false, "score": 1, "creation_date": 1517401678, "post_id": 48541818, "comment_id": 84079316, "body": "You probably meant to say : w = (w&lt;&lt;16)|(w&gt;&gt;16) ?"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1517402067, "post_id": 48541818, "comment_id": 84079557, "body": "IMO, &quot;word&quot; = 16 bits, so &quot;halfword&quot; = byte (32 bits is &quot;dword&quot;). Am I wrong?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 1, "creation_date": 1517402191, "post_id": 48541818, "comment_id": 84079648, "body": "@iBug You are right when using Intel terms.  However, OP is using RISC terms where a word is 32 bits and a halfword is 16 bits."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1517403838, "post_id": 48541818, "comment_id": 84080655, "body": "word = 32 bits for arm, mips, etc.  this was tagged as arm not x86."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1517406625, "post_id": 48541818, "comment_id": 84082619, "body": "isn&#39;t <code>word</code> on ARM signed? Then C <code>&gt;&gt;</code> is UB, so depending on your compiler you may want to mask the result of right shift first, before merging with left shift result: <code>w = (w&lt;&lt;16)|((w&gt;&gt;16)0xFFFF);</code> just to keep the source portable across platforms and compilers (although to keep it easily portable I would rather use <code>uint32_t</code> type instead of <code>word</code>, which makes the right shift well defined, then you don&#39;t need to mask it. (now I checked fuz answer, all is there, perfect)"}], "answers": [{"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 8, "last_activity_date": 1517402496, "last_edit_date": 1517402496, "creation_date": 1517402121, "answer_id": 48542368, "question_id": 48541818, "link": "https://stackoverflow.com/questions/48541818/swap-halfwords-efficently/48542368#48542368", "title": "Swap halfwords efficently", "body": "<p>Write the common idiom</p>\n\n<pre><code>unsigned w;\nw = w &lt;&lt; 16 | w &gt;&gt; 16;\n</code></pre>\n\n<p>an optimizing compiler generally translates this to a single <code>ror</code> or <code>rev16</code> instruction.  It is reasonable to expect the compiler to do this optimization.  Make sure that <code>w</code> is unsigned so the right shift is an unsigned one.</p>\n\n<p>If the compiler does not optimize this, it's still just two instructions (a shift and an or with a shifted operand), so not much performance is lost.</p>\n"}], "owner": {"reputation": 95, "user_id": 6527528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff405acb88a3f9f88b8eaa83943e66d4?s=128&d=identicon&r=PG&f=1", "display_name": "Tobi", "link": "https://stackoverflow.com/users/6527528/tobi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 832, "favorite_count": 1, "accepted_answer_id": 48542368, "answer_count": 1, "score": 2, "last_activity_date": 1517402496, "creation_date": 1517400505, "last_edit_date": 1517400810, "question_id": 48541818, "link": "https://stackoverflow.com/questions/48541818/swap-halfwords-efficently", "title": "Swap halfwords efficently", "body": "<p>I would like to send data from an STM32 (Cortex M4) device via its I2S peripheral using DMA in 24bit mode, MSB first.\nThe I2S data register is however only 16bit, according to the datasheet you have to send the upper halfword first, then the lower one. \nThis is problematic when using the DMA, it will always send the lower halfword first. </p>\n\n<p>What is an efficient way in c or ARM-assembler to switch the two halfwords?</p>\n"}, {"tags": ["c", "select", "posix"], "answers": [{"comments": [{"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1520954941, "post_id": 49259604, "comment_id": 85523278, "body": "I have come to a similar conclusion, but I don&#39;t follow your logic about the difficulty of having an &quot;only one&quot; restriction, since if a handled signal executes a <code>siglongjmp</code> then that definitely precludes other signals being received while pselect is executing (i.e. this manually enforces the &quot;only one restriction&quot;). And in fact, this is the solution I ended up using to ensure that I detected only one signal while in <code>pselect</code>. Code here, if you&#39;re interested: <a href=\"https://github.com/davmac314/dasynq/blob/master/dasynq-pselect.h\" rel=\"nofollow noreferrer\">github.com/davmac314/dasynq/blob/master/dasynq-pselect.h</a>"}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1520969154, "post_id": 49259604, "comment_id": 85532064, "body": "Inside pselect, it would have to choose which signal to permit, and which to wait until sometime later to permit, and because there is no guarantee that the signal handler will return (siglongjmp), it needs to store that decision somewhere, so it can eventually run the handler for it.  This amounts to an \u201cup\u201d call, even though you wouldn\u2019t implement it as such, every other call would then have to check whether it was time to run that handler or not."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1520969221, "post_id": 49259604, "comment_id": 85532100, "body": "Now, suppose that in that original handler, I invoked pselect again, directly, with an adjusted mask, and the same thing happened (two awakening signals), and again the kernel makes a decision about which one to permit, it now has to store the next one."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1520969276, "post_id": 49259604, "comment_id": 85532125, "body": "As I dig myself in deeper, I recycle the mask of two of the previously occurred but not delivered signals, again the kernel has to choose one, and store the other."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1520971070, "post_id": 49259604, "comment_id": 85533061, "body": "See also my own answer, where I&#39;ve included a test program showing that on Linux, only one signal is handled during <code>pselect</code> even though two are pending. This contradicts what you are saying."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1520988781, "post_id": 49259604, "comment_id": 85539733, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/166777/discussion-between-mevets-and-davmac\">continue this discussion in chat</a>."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1521028959, "post_id": 49259604, "comment_id": 85556854, "body": "As noted in chat, your example uses <code>signal</code> instead of <code>sigaction</code> to establish handlers and therefore doesn&#39;t mask other signals during handler execution. This was a key part of the question - <i>For purposes of the question, suppose that SA_RESTART is not set for the signal action, and that all signals were specified to be masked during execution of the signal handler when it was established via sigaction</i> - if you don&#39;t do that then one signal can interrupt another&#39;s handler."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1521040444, "post_id": 49259604, "comment_id": 85565271, "body": "Yes, sorry, hadn\u2019t read your question properly.   The \u2018main\u2019 signal mask will be the one in force when the signal handler has returned.   I thought you were suggesting something quite different."}], "tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": false, "score": 1, "last_activity_date": 1520988742, "last_edit_date": 1520988742, "creation_date": 1520953787, "answer_id": 49259604, "question_id": 48541338, "link": "https://stackoverflow.com/questions/48541338/does-posix-specify-that-only-one-signal-can-interrupt-pselect/49259604#49259604", "title": "Does POSIX specify that only one signal can interrupt pselect?", "body": "<p>No, but it also doesn\u2019t specify that multiple signals can or must.  Since it is unspecified, it is best to follow the general rule, which allows all pending unmasked signals to be processed.  If you attempt to strictly depend upon this, you are likely on a bad path because the timing of asynchronous events is difficult to predict.</p>\n\n<p>In general, it would be very difficult to make an implementation that imposed an \u2018only one' restriction because the os runtime would have to leave one or more signals pending but unmasked until some unspecified point.  Remember that the signal handler which runs when pselect is interrupted could do a siglongjmp rather than returning, so the kernel would have to keep a complicated, possibly unbounded data structure to track which signal mask to enforce.</p>\n\n<p>Below is a modified version of your test program.   In this one, each event emits a string via write() so there are no buffering problems.  The program sets its \u201cmain\u201d environment to mask SIGUSR1, SIGUSR2; but while pselect is running, it permits SIGUSR1, SIGUSR2, SIGTERM.\nThe program forks, with the parent (default:) sitting in a loop invoking pselect(), then outputting \u2018.\u2019 after it completes.\nThe child sits in a loop, delivering SIGUSR1, SIGUSR2 to the parent, then sleeping for a bit.  It outputs \u2018^\u2019 after delivering the signals.\nThe handler emits a prefix \u201c(1\u201d or \u201c(2\u201d for SIGUSR1, SIGUSR2 resp; then sleeps for a bit, and outputs \u201c)\u201d to indicate the sleep has completed.</p>\n\n<p>The output I see on macos (10.12.6, but I doubt it matters much) is:\n^(2)(1).^(2)(1).^(2)(1).^(2)(1).Terminated: 15\nwhich indicates that the signal handler for each of SIGUSR1 and SIGUSR2 are being run for every invocation of pselect().   This is what I would expect; as it is designed to not admit a window of uncertainty as would be the case with bracketting select() with sigprocmasks().</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/select.h&gt;\n#include &lt;unistd.h&gt;\n\nvoid handle(int signo)\n{\n    char s[2];\n    s[0] = '(';\n    s[1] = signo == SIGUSR1? '1' : '2';\n    write(1, s, 2);\n    sleep(1);\n    write(1, \")\", 1);\n}\n\nint main(int argc, char **argv)\n{\n  sigset_t mask;\n  sigemptyset(&amp;mask);\n  sigaddset(&amp;mask, SIGUSR1);\n  sigaddset(&amp;mask, SIGUSR2);\n  sigprocmask(SIG_SETMASK, &amp;mask, NULL);\n\n  sigfillset(&amp;mask);\n  sigdelset(&amp;mask, SIGUSR1);\n  sigdelset(&amp;mask, SIGUSR2);\n  sigdelset(&amp;mask, SIGTERM);\n  signal(SIGUSR1, handle);\n  signal(SIGUSR2, handle);\n  pid_t t = fork();\n  switch (t) {\n  default:\n    while (1) {\n            /* no USR1, USR2 */\n            pselect(0, NULL, NULL, NULL, NULL, &amp;mask);\n            /* no USR1, USR2 */\n            write(1, \".\", 1);\n    }\n    break;\n  case 0:\n    t = getppid();\n    for (int i = 0; i &lt; 4; i++) {\n        kill(t, SIGUSR1);\n        kill(t, SIGUSR2);\n        write(1, \"^\", 1);\n        sleep(5);\n    }\n    kill(t, SIGTERM);\n    break;\n  case -1:\n    perror(\"fork\\n\");\n  }\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "is_accepted": true, "score": 0, "last_activity_date": 1520973136, "last_edit_date": 1520973136, "creation_date": 1520958847, "answer_id": 49261339, "question_id": 48541338, "link": "https://stackoverflow.com/questions/48541338/does-posix-specify-that-only-one-signal-can-interrupt-pselect/49261339#49261339", "title": "Does POSIX specify that only one signal can interrupt pselect?", "body": "<p>I've continued searching and found no additional information, so I can only conclude that there are no guarantees in POSIX generally.</p>\n\n<p>Under Linux, if I understand the code below correctly, only one signal can be handled (assuming that the signal handler itself doesn't unmask signals): the relevant code and a revealing comment is in fs/select.c, in the <code>do_pselect</code> function:</p>\n\n<pre><code>ret = core_sys_select(n, inp, outp, exp, to);\nret = poll_select_copy_remaining(&amp;end_time, tsp, 0, ret);\n\nif (ret == -ERESTARTNOHAND) {\n    /*\n     * Don't restore the signal mask yet. Let do_signal() deliver\n     * the signal on the way back to userspace, before the signal\n     * mask is restored.\n     */\n    if (sigmask) {\n        memcpy(&amp;current-&gt;saved_sigmask, &amp;sigsaved,\n                sizeof(sigsaved));\n        set_restore_sigmask();\n    }\n} else ...\n</code></pre>\n\n<p>It essentially returns from the system call, allowing the signal handler to execute, after which the original signal mask will immediately be restored (from <code>current-&gt;saved_sigmask</code>, because <code>set_restore_sigmask()</code> sets a flag indicating that this should occur).</p>\n\n<p>The following test program verifies this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/select.h&gt;\n\nvolatile sig_atomic_t got_usr1 = 0;\nvolatile sig_atomic_t got_usr2 = 0;\n\nvoid handle_usr1(int signo, siginfo_t *info, void *v)\n{\n  got_usr1 = 1;\n}\n\nvoid handle_usr2(int signo, siginfo_t *info, void *v)\n{\n  got_usr2 = 1;\n}\n\nint main(int argc, char **argv)\n{\n  // mask SIGUSR1 and SIGUSR2:\n  sigset_t curmask;\n  sigemptyset(&amp;curmask);\n  sigaddset(&amp;curmask, SIGUSR1);\n  sigaddset(&amp;curmask, SIGUSR2);\n  sigprocmask(SIG_SETMASK, &amp;curmask, NULL);\n\n  // Create a mask for all but SIGUSR1 and SIGUSR2:\n  sigset_t mask;\n  sigfillset(&amp;mask);\n  sigdelset(&amp;mask, SIGUSR1);\n  sigdelset(&amp;mask, SIGUSR2);\n\n  // Set up signal handlers:\n  struct sigaction action;\n  action.sa_sigaction = handle_usr1;\n  sigfillset(&amp;action.sa_mask);\n  action.sa_flags = SA_SIGINFO;\n  sigaction(SIGUSR1, &amp;action, NULL);\n\n  action.sa_sigaction = handle_usr2;\n  sigaction(SIGUSR2, &amp;action, NULL);\n\n  // Make signals pending:\n  raise(SIGUSR1);\n  raise(SIGUSR2);\n\n  // pselect with no file descriptors and no timeout:\n  pselect(0, NULL, NULL, NULL, NULL, &amp;mask);\n\n  int count = got_usr1 + got_usr2;\n\n  printf(\"Handled %d signals while in pselect.\\n\", count);\n  return 0;\n}\n</code></pre>\n\n<p>On Linux, the output of the above is consistently:</p>\n\n<blockquote>\n  <p>Handled 1 signals while in pselect.</p>\n</blockquote>\n\n<p>This also seems to be the case on FreeBSD; however, I'm not willing to count on this being the case on all other platforms. The solution I have found to ensuring that only one signal can be handled is to use <code>siglongjmp</code> to jump out of the signal handler as well as out of the <code>pselect</code> call while also restoring the signal mask so that no further signals can be processed.</p>\n\n<p>Essentially, that code looks like this:</p>\n\n<pre><code>    jmp_buf jbuf; // signal handlers have access to this\n\n    if (sigsetjmp(jbuf, 1) != 0) {\n        // We received a signal while in pselect ...\n    }\n\n    int r = pselect(nfds, &amp;read_set_c, &amp;write_set_c, &amp;err_set, wait_ts, &amp;sigmask);\n</code></pre>\n\n<p>The signal handlers must execute a <code>siglongjmp</code>:</p>\n\n<pre><code>void signal_handler(int signo, siginfo_t *siginfo, void *v)\n{\n    siglongjmp(jbuf, 1);\n}\n</code></pre>\n\n<p>This feels crufty, but seems to work on all platforms that I've tested it on (Linux, MacOS and FreeBSD) - furthermore it seems to be supported by POSIX generally.</p>\n"}], "owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 2, "accepted_answer_id": 49261339, "answer_count": 2, "score": 9, "last_activity_date": 1520988742, "creation_date": 1517399001, "last_edit_date": 1517406210, "question_id": 48541338, "link": "https://stackoverflow.com/questions/48541338/does-posix-specify-that-only-one-signal-can-interrupt-pselect", "title": "Does POSIX specify that only one signal can interrupt pselect?", "body": "<p>The <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pselect.html\" rel=\"noreferrer\">POSIX <code>pselect</code> function</a> take a signal mask argument. The signal mask is \"atomically\" set as the current mask before execution of the function begins, and is restored as the function returns.</p>\n\n<p>This allows an otherwise masked signal to be unmasked while the function executes, and masked again when the function returns. It's guaranteed<sup>*</sup> that if a signal unmasked in this way is caught, the <code>pselect</code> function will be interrupted by the signal and (unless the signal action is specified with the <code>SA_RESTART</code> flag) will return an <code>EINTR</code> error.</p>\n\n<p>(*: or is it? the language in the document linked above would seem to allow that a signal being received <em>between</em> when <code>pselect</code> unblocked due to seeing a file readiness or timeout and when it replaced the signal mask with the original would not necessarily cause <code>EINTR</code>, since <code>EINTR</code> is required if \"The function was interrupted while blocked ...\" - however, that ultimately doesn't affect this question).</p>\n\n<p>My question is: supposing that two separate signals are temporarily unmasked during <code>pselect</code> execution, is it possible that both signals will be caught before the <code>pselect</code> function returns and the previous signal mask is restored - or is there some kind of guarantee that only one signal will be caught in this case (leaving the other one pending)? (For purposes of the question, suppose that <code>SA_RESTART</code> is not set for the signal action, and that all signals were specified to be masked during execution of the signal handler when it was established via <code>sigaction</code>).</p>\n\n<p>I can find nothing which suggests that only one signal may be processed, but I may have missed something, and I am writing some code for which this would be a very useful guarantee. I'd be interested to know if POSIX itself makes any guarantee, and also if different OSes provide such a guarantee independently.</p>\n"}, {"tags": ["c", "linux", "multiprocess"], "comments": [{"owner": {"reputation": 13259, "user_id": 1207049, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/445e3d8cb8ef7471a15bdeda0b573de6?s=128&d=identicon&r=PG", "display_name": "marekful", "link": "https://stackoverflow.com/users/1207049/marekful"}, "edited": false, "score": 0, "creation_date": 1517398741, "post_id": 48541190, "comment_id": 84077616, "body": "How could it leave its child process open? You must be overlooking something. Maybe they are in background?"}, {"owner": {"reputation": 425, "user_id": 8543542, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0735a717fbbd536b75d4a2ccfa0d5d15?s=128&d=identicon&r=PG&f=1", "display_name": "J.R.", "link": "https://stackoverflow.com/users/8543542/j-r"}, "reply_to_user": {"reputation": 13259, "user_id": 1207049, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/445e3d8cb8ef7471a15bdeda0b573de6?s=128&d=identicon&r=PG", "display_name": "marekful", "link": "https://stackoverflow.com/users/1207049/marekful"}, "edited": false, "score": 0, "creation_date": 1517399044, "post_id": 48541190, "comment_id": 84077788, "body": "@marekful Hi. If you kill the parent process with this function in c/c++, the child process still runs forward."}, {"owner": {"reputation": 13259, "user_id": 1207049, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/445e3d8cb8ef7471a15bdeda0b573de6?s=128&d=identicon&r=PG", "display_name": "marekful", "link": "https://stackoverflow.com/users/1207049/marekful"}, "edited": false, "score": 0, "creation_date": 1517399204, "post_id": 48541190, "comment_id": 84077876, "body": "That is weird. So when I kill a process from shell in Linux and children are killed automatically, who kills the children? The Kernel?"}, {"owner": {"reputation": 425, "user_id": 8543542, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0735a717fbbd536b75d4a2ccfa0d5d15?s=128&d=identicon&r=PG&f=1", "display_name": "J.R.", "link": "https://stackoverflow.com/users/8543542/j-r"}, "reply_to_user": {"reputation": 13259, "user_id": 1207049, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/445e3d8cb8ef7471a15bdeda0b573de6?s=128&d=identicon&r=PG", "display_name": "marekful", "link": "https://stackoverflow.com/users/1207049/marekful"}, "edited": false, "score": 0, "creation_date": 1517399397, "post_id": 48541190, "comment_id": 84077990, "body": "I do not know why that happened to you...you can try to run two process, all of them just print in ifinite loop. Try to kill the parent, the child is still there"}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 5, "creation_date": 1517399503, "post_id": 48541331, "comment_id": 84078048, "body": "Be aware though, that this will likely also kill more than the target process and its child processes.  All of the parent process, its other children, and the entire process tree up to something like the originating login session are likely in the same process group. The <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/setsid.html\" rel=\"nofollow noreferrer\"><code>setsid()</code></a>, <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/setpgid.html\" rel=\"nofollow noreferrer\"><code>setpgid()</code></a> or <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/setpgrp.html\" rel=\"nofollow noreferrer\"><code>setpgrp()</code></a> functions can be used to create a new process group."}], "tags": [], "owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "is_accepted": true, "score": 3, "last_activity_date": 1517399508, "last_edit_date": 1517399508, "creation_date": 1517398937, "answer_id": 48541331, "question_id": 48541190, "link": "https://stackoverflow.com/questions/48541190/how-to-kill-the-parent-process-and-all-its-child-processes-in-c/48541331#48541331", "title": "how to kill the parent process and all its child processes in c?", "body": "<p>You can send a signal to a <em>process group</em> by <code>kill(a_negative_number, a_signal)</code>, or <code>killpg()</code>.</p>\n\n<p>See <a href=\"http://man7.org/linux/man-pages/man2/kill.2.html\" rel=\"nofollow noreferrer\"><code>kill(2)</code></a> for detail. Basically, when you <code>fork()</code> or <code>execve()</code>, the child process will have the same <code>PGID</code>(process group id). </p>\n\n<p>Another way is to install a signal handle for the parent process. When a signal is received at the parent, parent send signal to it's children and kill them. See <a href=\"https://linux.die.net/man/2/signal\" rel=\"nofollow noreferrer\"><code>signal(2)</code></a></p>\n"}], "owner": {"reputation": 425, "user_id": 8543542, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0735a717fbbd536b75d4a2ccfa0d5d15?s=128&d=identicon&r=PG&f=1", "display_name": "J.R.", "link": "https://stackoverflow.com/users/8543542/j-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1948, "favorite_count": 0, "accepted_answer_id": 48541331, "answer_count": 1, "score": 2, "last_activity_date": 1517399508, "creation_date": 1517398462, "last_edit_date": 1517398727, "question_id": 48541190, "link": "https://stackoverflow.com/questions/48541190/how-to-kill-the-parent-process-and-all-its-child-processes-in-c", "title": "how to kill the parent process and all its child processes in c?", "body": "<p>So the following function should be called to kill the parent process. But it leaves the child processes alive. I know you can pass a argument to the sigkill in shell command to kill all the child process under this process group. But how to do this in C? </p>\n\n<pre><code>kill(parent, SIGKILL);\n</code></pre>\n"}, {"tags": ["c", "operators"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 2, "creation_date": 1517397446, "post_id": 48540843, "comment_id": 84076823, "body": "Google for &quot;c sequence point&quot;."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 2, "creation_date": 1517397795, "post_id": 48540843, "comment_id": 84077033, "body": "@JonathonReinhart: the comma operator is a sequence point, so this is NOT UB."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1517397948, "post_id": 48540843, "comment_id": 84077119, "body": "Note that <code>%11d</code> should be <code>%lld</code> and the declaration of <code>b</code> is redundant."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1517405313, "post_id": 48540843, "comment_id": 84081659, "body": "This artificial code is not useful to future SO users/visitors."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1517419309, "post_id": 48540843, "comment_id": 84091761, "body": "@PaulR I thought of that after I posted and forgot to come back and remove my comment. Thanks for clearing that up."}], "answers": [{"tags": [], "owner": {"reputation": 2613, "user_id": 9156061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69150721b719cef2eb990fc78bc9cc0?s=128&d=identicon&r=PG&f=1", "display_name": "mdatsev", "link": "https://stackoverflow.com/users/9156061/mdatsev"}, "is_accepted": false, "score": 3, "last_activity_date": 1517398623, "last_edit_date": 1517398623, "creation_date": 1517397757, "answer_id": 48540963, "question_id": 48540843, "link": "https://stackoverflow.com/questions/48540843/problems-with-c-operators/48540963#48540963", "title": "Problems with C operators", "body": "<p>This code uses the comma operator, which evaluates the operations in order and then evaluates to the last one.</p>\n\n<pre><code>int a = 3;\na += 1;             // a = 4\na &gt;&gt;= 2;            // a = 1\na--;                // a = 0\nint c = !(..., !a); // c = !(!a) = !(!0) = 0\n</code></pre>\n\n<p>By the way for those in doubt - </p>\n\n<blockquote>\n  <p>The comma operator introduces a sequence point, and therefore in the\n  code f(),g() the order of evaluation is defined: first f() is called,\n  and then g() is called.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": false, "score": 4, "last_activity_date": 1517398074, "last_edit_date": 1517398074, "creation_date": 1517397765, "answer_id": 48540966, "question_id": 48540843, "link": "https://stackoverflow.com/questions/48540843/problems-with-c-operators/48540966#48540966", "title": "Problems with C operators", "body": "<p>Expand the code and remove anything redundant:</p>\n\n<pre><code>long long int a = 3;         // a = 3\na+=1;                        // a = 4\na&gt;&gt;=2;                       // a = 1\na--;                         // a = 0\nint c = !!a;                 // c = 0\nprintf (\"%lld %d\\n\", a, c);  // prints 0 0\n          ^^\n      // note that this should be `ll`, not `11`\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9294037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a786461386edb899d1a919be8253d8?s=128&d=identicon&r=PG&f=1", "display_name": "Giacomo Surace", "link": "https://stackoverflow.com/users/9294037/giacomo-surace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 1, "closed_date": 1517411657, "answer_count": 2, "score": -2, "last_activity_date": 1517398623, "creation_date": 1517397336, "last_edit_date": 1517397425, "question_id": 48540843, "link": "https://stackoverflow.com/questions/48540843/problems-with-c-operators", "closed_reason": "Not suitable for this site", "title": "Problems with C operators", "body": "<p>I have this code:</p>\n\n<pre><code>long long int a = 3, *b = &amp;a;\nint c = !(a+=1, a&gt;&gt;=2, a--, !a);\nprintf (\"%11d %d\\n\", a, c);\n</code></pre>\n\n<p>when I run it, it gave me 0 0, but I don't understand why. Shouldn't be 0 1?</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "linux-device-driver", "sysfs"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1517395969, "post_id": 48540242, "comment_id": 84075746, "body": "There&#39;s no question here. Can you edit your post to clearly state what you want an answer to? e.g. &quot;How can I generate many similar structures and functions&quot; or something."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1517397275, "post_id": 48540242, "comment_id": 84076714, "body": "BTW, my reading of the kernel source suggests that its <code>sprintf()</code> supports the <code>#</code> modifier just like user-space <code>sprintf()</code>, so you could simply write <code>%#x</code> instead of <code>0x%x</code>."}, {"owner": {"reputation": 888, "user_id": 5415668, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-bKZjlhl-kXM/AAAAAAAAAAI/AAAAAAAADEk/RPTN02x91CA/photo.jpg?sz=128", "display_name": "Franz Forstmayr", "link": "https://stackoverflow.com/users/5415668/franz-forstmayr"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1517400792, "post_id": 48540242, "comment_id": 84078783, "body": "@TobySpeight Thank you, i didn&#39;t knew that."}], "answers": [{"tags": [], "owner": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "is_accepted": false, "score": 2, "last_activity_date": 1517396926, "creation_date": 1517396926, "answer_id": 48540699, "question_id": 48540242, "link": "https://stackoverflow.com/questions/48540242/how-can-i-create-lots-of-similar-functions-for-sysfs-attributes/48540699#48540699", "title": "How can I create lots of similar functions for sysfs attributes?", "body": "<p>I might be missing something but wouldn't you just want to make 32 wrappers around:</p>\n\n<pre><code>static ssize_t readreg_show(struct device *dev, struct device_attribute *attr, char *buf,unsigned long offset) {\n    struct axi_register_driver *drv = dev_get_drvdata(dev);\n\n    u32 reg;\n    reg = ioread32(drv-&gt;reg_base + offset);\n\n    return sprintf(buf, \"0x%x\\n\", reg);\n}\n</code></pre>\n\n<p>and maybe define 32:</p>\n\n<pre><code>static ssize_t readreg1_show(struct device *dev, struct device_attribute *attr, char *buf) {readreg_show(dev,attr,buf,OFF_REG1)}\n</code></pre>\n\n<p>(one for each reg) if you need different function names? This might be MACROd, if it really bothers you to copy this 32 times, if the offsets are all OFF_REGi.</p>\n"}, {"tags": [], "owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "is_accepted": true, "score": 4, "last_activity_date": 1517402852, "creation_date": 1517402852, "answer_id": 48542589, "question_id": 48540242, "link": "https://stackoverflow.com/questions/48540242/how-can-i-create-lots-of-similar-functions-for-sysfs-attributes/48542589#48542589", "title": "How can I create lots of similar functions for sysfs attributes?", "body": "<p>Your <code>_show</code> and <code>_store</code> functions don't use <code>struct device_attribute *attr</code> parameter, but exactly this parameter is intended for contain information about specific thing represented by a given file:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// Derive 'device_attribute' structure for a read register's attribute\nstruct dev_axi_read_reg_attribute {\n    struct device_attribute attr;\n    int reg_offset; // Offset of the register here\n};\n\n// Generic 'show' method, suitable for every read register\nstatic ssize_t read_axi_reg_show(struct device *dev, struct device_attribute *attr, char *buf) {\n    struct axi_register_driver *drv = dev_get_drvdata(dev);\n    // 'attr' is actually of type `struct dev_axi_read_reg_attribute`.\n    // See definition of the macro 'AXI_READ_REG_ATTR' below.\n    struct dev_axi_read_reg_attribute* axi_read_attr = container_of(attr,\n        struct dev_axi_read_reg_attribute, attr);\n\n    u32 reg;\n    // Take offset to the register from the attribute\n    reg = ioread32(drv-&gt;reg_base + axi_read_attr-&gt;reg_offset);\n\n    return sprintf(buf, \"0x%x\\n\", reg);\n}\n\n// Macro for declare attribute for read register\n#define AXI_READ_REG_ATTR(_name, _reg_offset) \\\nstruct dev_axi_read_reg_attribute dev_attr_##_name = \\\n    { __ATTR(_name,  S_IRUGO, read_axi_reg_show, NULL), _reg_offset }\n\n// Declare as many attributes as you want\nstatic AXI_READ_REG_ATTR(readreg0, OFF_REG0);\nstatic AXI_READ_REG_ATTR(readreg1, OFF_REG1);\n// ...\n\nstatic struct attribute *axi_register_attrs[] = {\n    &amp;dev_attr_readreg0.attr.attr,\n    &amp;dev_attr_readreg1.attr.attr,\n    // ...\n    NULL,\n};\nATTRIBUTE_GROUPS(axi_register);\n</code></pre>\n\n<p>Similar approach is used in <code>DEVICE_ULONG_ATTR</code> macro, defined in <a href=\"http://elixir.free-electrons.com/linux/latest/source/include/linux/device.h#L550\" rel=\"nofollow noreferrer\">include/linux/device.h</a>. That macro creates an attribute for a variable of type 'long'.</p>\n"}], "owner": {"reputation": 888, "user_id": 5415668, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-bKZjlhl-kXM/AAAAAAAAAAI/AAAAAAAADEk/RPTN02x91CA/photo.jpg?sz=128", "display_name": "Franz Forstmayr", "link": "https://stackoverflow.com/users/5415668/franz-forstmayr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 0, "accepted_answer_id": 48542589, "answer_count": 2, "score": 1, "last_activity_date": 1517402852, "creation_date": 1517395602, "last_edit_date": 1517397005, "question_id": 48540242, "link": "https://stackoverflow.com/questions/48540242/how-can-i-create-lots-of-similar-functions-for-sysfs-attributes", "title": "How can I create lots of similar functions for sysfs attributes?", "body": "<p>I have a generic AXI-slave device with several I/O registers in my FPGA. I want to access my registers with a sysfs interface. For each register I want to access, I create a <code>_show</code> and a <code>_store</code> function, but that would be a lot of code.</p>\n\n<pre><code>static ssize_t writereg0_store(struct device *dev, struct device_attribute                *attr, const char *buf, size_t count) {\n    struct axi_register_driver *drv = dev_get_drvdata(dev);\n    u32 val;\n\n    if (kstrtou32(buf, 10, &amp;val) != 0)\n        return -EINVAL;\n\n    iowrite32(val, drv-&gt;reg_base + WRITE_OFFSET + 0);\n\n    return count;\n\n}\n\nstatic ssize_t writereg0_show(struct device *dev, struct device_attribute *attr, char *buf) {\n    struct axi_register_driver *drv = dev_get_drvdata(dev);\n\n    u32 reg;\n    reg = ioread32(drv-&gt;reg_base + WRITE_OFFSET + 0);\n\n    return sprintf(buf, \"0x%x\\n\", reg);\n}\nstatic DEVICE_ATTR_RW(writereg0);\n\nstatic ssize_t readreg0_show(struct device *dev, struct device_attribute *attr, char *buf) {\n    struct axi_register_driver *drv = dev_get_drvdata(dev);\n\n    u32 reg;\n    reg = ioread32(drv-&gt;reg_base + 0);\n\n    return sprintf(buf, \"0x%x\\n\", reg);\n}\nstatic DEVICE_ATTR_RO(readreg0);\n</code></pre>\n\n<p>The second read-only register is basically the same, except the function name and address offset:</p>\n\n<pre><code>static ssize_t readreg1_show(struct device *dev, struct device_attribute *attr, char *buf) {\n    struct axi_register_driver *drv = dev_get_drvdata(dev);\n\n    u32 reg;\n    reg = ioread32(drv-&gt;reg_base + OFF_REG1);\n\n    return sprintf(buf, \"0x%x\\n\", reg);\n}\nstatic DEVICE_ATTR_RO(readreg1);\n</code></pre>\n\n<p>When creating e.g. 32 registers, I have to do this 32 times; the code wouldn't be very pretty.</p>\n\n<p>So what's the best way to create a bunch of similar functions, especially for the given sysfs-attribute usecase?</p>\n"}, {"tags": ["c", "c-preprocessor", "preprocessor"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1517395665, "post_id": 48540220, "comment_id": 84075549, "body": "Show a minimal code sample that exhibits the quoted issue and readers can use to replicate it. And if that&#39;s not your real case, give a real one that isn&#39;t completely silly. The macro you cite is far worse than just writing <code>thing &gt; 0</code> and will infuriate readers of your code. Also, why the <code>? 1 : 0</code>? You know that already returns a boolean, right?"}, {"owner": {"reputation": 3, "user_id": 4535273, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205714015228125/picture?type=large", "display_name": "Mario Sonlord", "link": "https://stackoverflow.com/users/4535273/mario-sonlord"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1517395984, "post_id": 48540220, "comment_id": 84075754, "body": "the real case is something like this example I want to use a macro that return 1 or 0 inside a function that I give the parameters in the run time"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1517396005, "post_id": 48540220, "comment_id": 84075772, "body": "Show a minimal code sample that exhibits the quoted issue and readers can use to replicate it. Right now, we have only an incomplete fragment and your statement that it causes a problem, with no evidence of how the problematic behaviour is produced. We could go and write our own tests to prove or disprove what you said, but that&#39;s not our job."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1517396109, "post_id": 48540220, "comment_id": 84075851, "body": "@underscore_d Boolean-&gt;Integer-&gt;Boolean again with <code>==1</code>!"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1517396194, "post_id": 48540220, "comment_id": 84075933, "body": "Comparison operators in C are guaranteed by the standard to return either 0 or 1 anyway, so the ternary operator is for nothing..."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1517396319, "post_id": 48540220, "comment_id": 84076015, "body": "Safe macros should always put the arguments into parentheses, as well as the whole macro should be, so: <code>GTZ(a) ((a)&gt;0?1:0)</code> or simply (consider my previous comment!): <code>GTZ(a) ((a)&gt;0)</code>"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1517396606, "post_id": 48540220, "comment_id": 84076223, "body": "@AjayBrahmakshatriya I have no idea what you&#39;re talking about. No <code>== 1</code> is required; the <code>&gt;</code> operator already returns a result of <code>0</code> or <code>1</code> that is guaranteed to behave correctly in any boolean context, and comparing explicitly to some value for booleans is discouraged by all good coding styles I&#39;ve seen."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1517396627, "post_id": 48540220, "comment_id": 84076240, "body": "Albeit my first comment, always prefer comparing <code>!= 0</code> with boolean semantics - or even better: just leave the comparison out entirely (<code>if(GTZ(x))</code>);"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1517396757, "post_id": 48540220, "comment_id": 84076339, "body": "@underscore_d I am not trying to justify OPs code. I am saying just as you said the <code>?1:0</code> is unnecessary, there is also an unnecessary <code>==1</code> because without that too, the meaning would be the same."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1517396913, "post_id": 48540220, "comment_id": 84076445, "body": "@MarioSonlord Please don&#39;t paste this code in a comment, edit your question instead."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1517397421, "post_id": 48540220, "comment_id": 84076802, "body": "@AjayBrahmakshatriya Ah yeah, my bad!"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1517397451, "post_id": 48540220, "comment_id": 84076826, "body": "@MarioSonlord And where exactly do you now use the macro?"}], "answers": [{"tags": [], "owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "is_accepted": true, "score": 6, "last_activity_date": 1517398047, "last_edit_date": 1517398047, "creation_date": 1517397028, "answer_id": 48540730, "question_id": 48540220, "link": "https://stackoverflow.com/questions/48540220/how-to-pass-arguments-to-function-and-use-these-arguments-in-macro-function-insi/48540730#48540730", "title": "how to pass arguments to function and use these arguments in macro function inside it", "body": "<p>I can't reproduce the problem with the code you posted, but you mentioned it's not the real case, and I do have an idea of the problem.</p>\n\n<p>The expression is not being associated as you intended.  When expanded, the expression is:</p>\n\n<pre><code>x&gt;0? 1:0 == 1\n</code></pre>\n\n<p>which groups as:</p>\n\n<pre><code>x&gt;0? 1:(0 == 1)\n</code></pre>\n\n<p>which is equivalent to:</p>\n\n<pre><code>x&gt;0? 1:0\n</code></pre>\n\n<p>This still works as intended.  But if you instead had:</p>\n\n<pre><code>if (GREATER_THAN_ZERO(x) == 0)\n</code></pre>\n\n<p>then you would end up with:</p>\n\n<pre><code>x&gt;0? 1:0 == 0\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>x&gt;0? 1:(0 == 0)\n</code></pre>\n\n<p>which is always 1.</p>\n\n<p>There are two fundamental problems with the macro definition:  (1) it isn't protecting its argument from mis-association, and (2) it isn't protecting the result from mis-association.</p>\n\n<p>The proper way to write it would be:</p>\n\n<pre><code>#define GREATER_THAN_ZERO(a) ((a) &gt; 0 ? 1 : 0)\n</code></pre>\n\n<p>The parentheses around <code>(a)</code> allow you to pass an expression as the argument without worrying about it being re-associated. The parentheses around the entire macro body allow you to use the macro in an expression without it being re-associated.</p>\n\n<p>In this particular case, the <code>?:</code> operator is redundant, since <code>n &gt; 0</code> always returns either 0 or 1, so you could just use:</p>\n\n<pre><code>#define GREATER_THAN_ZERO(a) ((a) &gt; 0)\n</code></pre>\n\n<p>with identical results.</p>\n\n<p>Similarly, the comparison of the result with <code>1</code> serves no purpose and suggests that something unusual is going on.  It is much more natural to simply write:</p>\n\n<pre><code>if (GREATER_THAN_ZERO(x))\n</code></pre>\n\n<p>This implicitly tests to see if it's non-zero.  Remember, <code>if (n)</code> is equivalent to <code>if (n != 0)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 0, "last_activity_date": 1517398633, "creation_date": 1517398633, "answer_id": 48541237, "question_id": 48540220, "link": "https://stackoverflow.com/questions/48540220/how-to-pass-arguments-to-function-and-use-these-arguments-in-macro-function-insi/48541237#48541237", "title": "how to pass arguments to function and use these arguments in macro function inside it", "body": "<p>Too large for a comment, so as answer: I recommend a different formatting (with parentheses adjusted, though):</p>\n\n<pre><code>#define LED_u8_GET_MODE(LED_u8_INDX)  \\\n    (                                 \\\n        (LED_u8_INDX) == 0            \\\n        ? (LED_u8_MODE_0)             \\\n        : (LED_u8_INDX) == 1          \\\n            ? (LED_u8_MODE_1)         \\\n            : (LED_u8_INDX) == 2      \\\n                ? (LED_u8_MODE_2)     \\\n                : (LED_u8_INDX) == 3  \\\n                    ? (LED_u8_MODE_3) \\\n                    : 800             \\\n    )\n</code></pre>\n\n<p>Or do you disagree that this is easier to read?</p>\n\n<p>Still, those many ternary operators are difficult to read and handle, I'd rather consider replacing the entire macro with an inline function:</p>\n\n<pre><code>inline int ledGetMode(int index)\n    // (if need be, adjust parameter and return value types appropriately)\n{\n    switch(index)\n    {\n        case 0:\n            return LED_u8_MODE_0;\n        // ...\n        default:\n            return 800;\n    }\n}\n</code></pre>\n\n<p>Looks much cleaner and should, as inline, not have any overhead over the macro...</p>\n\n<p>The main advantage, though, is that you simply skip any trouble with bad association of parameters or result and with multiple evaluation of the parameters!</p>\n"}], "owner": {"reputation": 3, "user_id": 4535273, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205714015228125/picture?type=large", "display_name": "Mario Sonlord", "link": "https://stackoverflow.com/users/4535273/mario-sonlord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 48540730, "answer_count": 2, "score": -2, "last_activity_date": 1517399160, "creation_date": 1517395521, "last_edit_date": 1517399160, "question_id": 48540220, "link": "https://stackoverflow.com/questions/48540220/how-to-pass-arguments-to-function-and-use-these-arguments-in-macro-function-insi", "title": "how to pass arguments to function and use these arguments in macro function inside it", "body": "<p>I want to do something like that </p>\n\n<pre><code>#define GREATER_THAN_ZERO(a) a&gt;0? 1:0\n</code></pre>\n\n<p>and use this macro inside another function like that</p>\n\n<pre><code>void test(int x)\n{  if (GREATER_THAN_ZERO(x) == 1) printf(\"more than zero\");\n   else printf(\"less than zero\");\n}\n</code></pre>\n\n<p>But when I use test function it always prints \"less than zero\"\nNOTE: this is an example not the real case but I want to do something like that (use macro inside a function)\nCan anyone help me please?\nEDIT\nI have configuration file like that</p>\n\n<pre><code> #define LED_u8_MODE_0          LED_u8_REVERSE\n #define LED_u8_MODE_1          LED_u8_NORMAL\n</code></pre>\n\n<p>and in program I have a macro function</p>\n\n<pre><code>#define LED_u8_GET_MODE(LED_u8_INDX)        (LED_u8_INDX == 0)? LED_u8_MODE_0: \\\n(LED_u8_INDX == 1)? LED_u8_MODE_1: \\\n(LED_u8_INDX == 2)? LED_u8_MODE_2: \\\n(LED_u8_INDX == 3)? LED_u8_MODE_3: 800\n</code></pre>\n\n<p>then I use it inside this function</p>\n\n<pre><code>    void LED_voidSetLedOnWithIndx(u8 Copy_u8LedIndx)\n{\n    if(LED_u8_GET_MODE(Copy_u8LedIndx) == LED_u8_NORMAL)\n    {\n        DIO_voidSetPinValue(Copy_u8LedIndx, DIO_u8_HIGH);\n    }\n    else //if(LED_u8_GET_MODE(Copy_u8LedIndx) == LED_u8_REVERSE)\n    {\n        DIO_voidSetPinValue(Copy_u8LedIndx, DIO_u8_LOW);\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "performance", "sorting", "c++11"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 7, "creation_date": 1517395343, "post_id": 48540113, "comment_id": 84075326, "body": "Your timing is flawed, you only sort the vector in the <i>first</i> iteration of the loops, then you sort an already sorted container, which is usually not a good case for many sorting algorithms."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 9, "creation_date": 1517395349, "post_id": 48540113, "comment_id": 84075332, "body": "Do you think sorting an array of size 6 is a good benchmark?"}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 3, "creation_date": 1517395352, "post_id": 48540113, "comment_id": 84075334, "body": "Your test is ill-designed because after the first iteration, you keep sorting an already sorted array. (And as Ajay already said, size 6 is, sorry, grotesque.)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1517395459, "post_id": 48540113, "comment_id": 84075410, "body": "You should also take a look at your optimization levels, and check the generated code to make sure the compiler perhaps doesn&#39;t do some optimization for the <code>qsort</code> case that it misses in the <code>std::sort</code> case."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1517395530, "post_id": 48540113, "comment_id": 84075454, "body": "Since nobody has answered yet, I suggest you withdraw this question, fix the issues that have been pointed out, and resubmit if there is still a material time difference."}, {"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 0, "creation_date": 1517395542, "post_id": 48540113, "comment_id": 84075465, "body": "Moreover, you <code>std::sort</code> a <code>std::vector</code> of <code>std::string</code>s and compare it to <code>qsort</code>ing an array of <code>char*</code>s"}, {"owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "edited": false, "score": 0, "creation_date": 1517396165, "post_id": 48540113, "comment_id": 84075904, "body": "An implementation of sort will probably revert to something like insertion-sort for an array of size 6. Try 6000 or 60,000. Also, shuffle the array before every call to sort.  Your test would not pass a code-review."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672107"}, "edited": false, "score": 1, "creation_date": 1517396224, "post_id": 48540113, "comment_id": 84075952, "body": "Enable the optimzer, aka build in Release mode,"}, {"owner": {"reputation": 15096, "user_id": 445296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/E6JMR.jpg?s=128&g=1", "display_name": "Jive Dadson", "link": "https://stackoverflow.com/users/445296/jive-dadson"}, "edited": false, "score": 1, "creation_date": 1517396500, "post_id": 48540113, "comment_id": 84076145, "body": "I&#39;m voting to close this question as off-topic because the code posted does not demonstrate the problem as described."}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 2, "creation_date": 1517397231, "post_id": 48540113, "comment_id": 84076687, "body": "This is <b>not</b> how you bench code :-/ I&#39;d recommend reading a nice tutorial about microbenching code, and if you don&#39;t want to set this up locally, you can use <a href=\"http://quick-bench.com\" rel=\"nofollow noreferrer\">quick-bench.com</a>. But only after you&#39;ve read more about microbenching in general."}, {"owner": {"reputation": 47, "user_id": 9293911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b601dcf75c1dd7a4932d1f832b8384db?s=128&d=identicon&r=PG&f=1", "display_name": "K.Sam", "link": "https://stackoverflow.com/users/9293911/k-sam"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517398326, "post_id": 48540113, "comment_id": 84077361, "body": "@Someprogrammerdude ... Thank you all very much for your quick reply, I am totally a novice in C++, so Sorry for my ugly code. I will fix it. Thx"}, {"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 1, "creation_date": 1517399003, "post_id": 48540113, "comment_id": 84077764, "body": "To downvoters: sure, this benchmark is terrible. But the question as a whole is fine - it shows effort, has MVCE, and is pretty clear."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1517399585, "post_id": 48540113, "comment_id": 84078092, "body": "Using Visual Studio 2017 I get the times 0.045 and 0.043 seconds, respectively."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 3, "creation_date": 1517400720, "post_id": 48540113, "comment_id": 84078734, "body": "I voted to reopen the question because it seems fine to me. Implicit in the question as asked is a false assumption about why the questioner is getting the result he gets, but I don&#39;t think that is a good reason to reject the question."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "reply_to_user": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 1, "creation_date": 1517417996, "post_id": 48540113, "comment_id": 84090896, "body": "@el.pescado As policy, I downvote any C++ performance question that does not include the command line used to compile, or at least strong evidence that it isn&#39;t an accidental debug build.  Nearly every C++ performance question on this website has someone asking about that, so anyone who doesn&#39;t mention it has done zero prior research on SO, and is wasting everyone&#39;s time."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1517563327, "post_id": 48540113, "comment_id": 84154990, "body": "Amen to that. - &quot;Why is this code slow?&quot; - &quot;Well, what optimizations did you enable?&quot; - &quot;Huh, what do you mean optimizations enabled?&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9293911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b601dcf75c1dd7a4932d1f832b8384db?s=128&d=identicon&r=PG&f=1", "display_name": "K.Sam", "link": "https://stackoverflow.com/users/9293911/k-sam"}, "edited": false, "score": 0, "creation_date": 1517398977, "post_id": 48540289, "comment_id": 84077740, "body": "@el.pescado Thank you very much, I just started learning C + +, what you said is very useful to me"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1517563624, "post_id": 48540289, "comment_id": 84155172, "body": "Well, according to all the arrogant Stroupstrupian statements about C++ performance, all C++ containers should be just as fast as C arrays. Even though no human being has ever managed to produced machine code where this is true. Therefore it makes perfect sense to compare <code>std::sort</code> of a <code>std::vector&lt;std::string&gt;</code> with <code>qsort</code> of a raw 2D <code>char</code> array. You&#39;ll get a great measurement of how much BS various C++ fundamentalist dogmas contain."}], "tags": [], "owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "is_accepted": false, "score": 14, "last_activity_date": 1517396530, "last_edit_date": 1517396530, "creation_date": 1517395746, "answer_id": 48540289, "question_id": 48540113, "link": "https://stackoverflow.com/questions/48540113/why-in-this-code-the-sort-in-c-is-much-slower-than-qsort-in-c-for-string-arra/48540289#48540289", "title": "why in this code the sort in C++ is much slower than qsort in C (for string array)?", "body": "<p>There are many problems in your benchmark that prevent you from making any conclusions form it:</p>\n\n<ol>\n<li><p>You compare <code>std::sort</code>ing a <code>std::vector</code> of <code>std::strings</code> with <code>qsort</code>ing an array of <code>char*</code>s. Proper benchmark should use the same data structures.</p></li>\n<li><p>An set size of 6 is not representative for benchmark by a few orders of magnitude.</p></li>\n<li><p>Both algorithms sort in place, so despite performing one million iterations each, only first actually performs sort. The following 999999 iteration \"sort\" already sorted data.</p></li>\n<li><p>You don't do anything meaningful with sorted data, so compiler might even remove your code.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 9293911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b601dcf75c1dd7a4932d1f832b8384db?s=128&d=identicon&r=PG&f=1", "display_name": "K.Sam", "link": "https://stackoverflow.com/users/9293911/k-sam"}, "is_accepted": true, "score": 0, "last_activity_date": 1517574533, "creation_date": 1517574533, "answer_id": 48582717, "question_id": 48540113, "link": "https://stackoverflow.com/questions/48540113/why-in-this-code-the-sort-in-c-is-much-slower-than-qsort-in-c-for-string-arra/48582717#48582717", "title": "why in this code the sort in C++ is much slower than qsort in C (for string array)?", "body": "<p>The problem was found\uff0cas @manni66 pointed out, I made a big mistake..  I used Debug mode , when I changed to Release mode, the result was reasonable:</p>\n\n<pre><code>[1] vector&lt;char*&gt;(qsort) Elapsed time: 0.559000\n[2] vector&lt;char*&gt;(sort) Elapsed time: 0.530000\nOther test:\n[3] char array(qsort)   Elapsed time: 0.512000\n[3] vector&lt;string&gt;(sort) Elapsed time: 0.620000\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 9293911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b601dcf75c1dd7a4932d1f832b8384db?s=128&d=identicon&r=PG&f=1", "display_name": "K.Sam", "link": "https://stackoverflow.com/users/9293911/k-sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 48582717, "answer_count": 2, "score": -1, "last_activity_date": 1517574533, "creation_date": 1517395221, "last_edit_date": 1517562972, "question_id": 48540113, "link": "https://stackoverflow.com/questions/48540113/why-in-this-code-the-sort-in-c-is-much-slower-than-qsort-in-c-for-string-arra", "title": "why in this code the sort in C++ is much slower than qsort in C (for string array)?", "body": "<p>In the book <strong>The C++ Programming Language (4th Edition)</strong>, <em>Stroustrup</em> say that <strong><em>sort</em></strong> is much faster than <strong><em>qsort</em></strong> , but in my experiment, I got a different result, could any one help me to explain Why?</p>\n\n<p>Here is my code :</p>\n\n<pre><code>double begin_time=0, end_time=0, elapsed_time=0;\n\nvector&lt;string&gt; vs1 = { \"fsfaa\", \"errer\", \"weesa\", \"yuyre\", \"wedsa\", \"xcxcx\" };\nbegin_time = clock();\n\nfor (int i = 0; i &lt; 1000000; i++)\n{\n    std::sort(vs1.begin(), vs1.end());\n}\n\nend_time = clock();\nelapsed_time = double(end_time - begin_time) / CLOCKS_PER_SEC;\n\nprintf(\"\\n\\nElapsed time: %f\\n\", elapsed_time);\n\nconst char* vs[] = { \"fsfaa\", \"errer\", \"weesa\", \"yuyre\", \"wedsa\", \"xcxcx\" };\nbegin_time = clock();\n\nfor (int i = 0; i &lt; 1000000; i++)\n{\n    std::qsort(vs, sizeof(vs) / sizeof(*vs), sizeof(*vs), (int(*)(const void*, const void*))compare_function);\n}\n\nend_time = clock();\nelapsed_time = double(end_time - begin_time) / CLOCKS_PER_SEC;\nprintf(\"\\n\\nElapsed time: %f\\n\", elapsed_time);\n</code></pre>\n\n<p>and, </p>\n\n<pre><code>int compare_function(const void * a, const void * b) {\nconst char *pa = *(const char**)a;\nconst char *pb = *(const char**)b;\n\nreturn strcmp(pa, pb);\n</code></pre>\n\n<p>}</p>\n\n<p>Here is the result(Windows/Visual Studio):</p>\n\n<pre><code>Elapsed time: 0.245000\nElapsed time: 0.090000\n</code></pre>\n\n<p><strong>Update:</strong>\nThanks for advice, I had changed the code as follow:</p>\n\n<pre><code>int compFunc_2(const void * a, const void * b) {\n    const char *pa = *(char**)a;\n    const char *pb = *(char**)b;\n\n    return strcmp(pa, pb);\n}\n\nbool compFunc(const char *c1, const char *c2)\n{\n    return strcmp(c1, c2) &lt; 0;\n}\n\nstring gen_random_str(int len)\n{\n    string str;\n    string w = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\";\n\n    for (int i = 0; i &lt; len; i++)\n    {\n        str += w[rand() % sizeof(w)];\n    }\n    return str;\n}\n\nchar *convert(const std::string &amp; s)\n{\n    char *pc = new char[s.size() + 1];\n    strcpy(pc, s.c_str());\n    return pc;\n}\n\n\nint main()\n{\n\n    srand((unsigned)time(0));\n    const int str_num = 1000000;\n    vector&lt;string&gt; vs;\n    vector&lt;char*&gt;  vc;\n    vector&lt;char*&gt;  vc2; //\n    char**  as = new char*[str_num];\n\n    for (int i = 0; i &lt; str_num; i++)\n    {\n        string tmp = gen_random_str(10);  // length is 10\n        vs.push_back(tmp);\n        as[i] = new char(tmp.size() + 1);\n        strcpy(as[i], tmp.c_str());\n    }\n    transform(vs.begin(), vs.end(), std::back_inserter(vc), convert);\n    transform(vs.begin(), vs.end(), std::back_inserter(vc2), convert);\n\n\n\n    double begin_time = 0, end_time, elapsed_time;\n\n    begin_time = clock();\n    std::qsort(&amp;vc[0], str_num, sizeof(vc[0]), (int(*)(const void*, const void*))compFunc_2);\n    end_time = clock();\n    elapsed_time = double(end_time - begin_time) / CLOCKS_PER_SEC;\n    printf(\"\\n[1] vector&lt;char*&gt;(qsort) Elapsed time: %f\", elapsed_time);\n\n    begin_time = clock();\n    std::sort(vc2.begin(), vc2.end(), compFunc);\n    end_time = clock();\n    elapsed_time = double(end_time - begin_time) / CLOCKS_PER_SEC;\n    printf(\"\\n[2] vector&lt;char*&gt;(sort) Elapsed time: %f\", elapsed_time);\n\n\n\n    printf(\"\\nOther test:\");\n    begin_time = clock();\n    std::qsort(as, str_num, sizeof(as[0]), (int(*)(const void*, const void*))compFunc_2);\n    end_time = clock();\n    elapsed_time = double(end_time - begin_time) / CLOCKS_PER_SEC;\n    printf(\"\\n[3] char array(qsort)   Elapsed time: %f\", elapsed_time); \n\n    begin_time = clock();\n    std::sort(vs.begin(), vs.end());\n    end_time = clock();\n    elapsed_time = double(end_time - begin_time) / CLOCKS_PER_SEC;\n    printf(\"\\n[4] vector&lt;string&gt;(sort) Elapsed time: %f\", elapsed_time);\n\n    // clean\n    cin.get();\n    return 0;\n}\n</code></pre>\n\n<p>And, I got the result on my computer:</p>\n\n<pre><code>[1] vector&lt;char*&gt;(qsort) Elapsed time: 1.752000\n[2] vector&lt;char*&gt;(sort) Elapsed time: 6.004000\nOther test:\n[3] char array(qsort)   Elapsed time: 1.691000\n[4] vector&lt;string&gt;(sort) Elapsed time: 46.663000\n</code></pre>\n\n<p>as some say, yes, there is <strong>no comparison</strong> between [1] and [3]/[4](because of the different data), but I'm still confused about [1] and [2], why the <strong>sort</strong> seems still slower? (I had closed the Optimize in VS), any help would be great appreciate . </p>\n"}, {"tags": ["c", "memory"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1517396301, "post_id": 48540081, "comment_id": 84076007, "body": "<i><code>a</code> and <code>b</code> are capable to store a number up to <code>255</code></i> -- No! a and b are only supposed to store values <code>0</code> or <code>-1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1517395446, "post_id": 48540151, "comment_id": 84075396, "body": "Just a side question. Does assignment count as overflow?"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1517395478, "post_id": 48540151, "comment_id": 84075427, "body": "@AjayBrahmakshatriya.: I would say so."}, {"owner": {"reputation": 41, "user_id": 9278974, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kk2zuJ9SmwY/AAAAAAAAAAI/AAAAAAAAADo/FJWSV84_QT8/photo.jpg?sz=128", "display_name": "Horia Pantelimon", "link": "https://stackoverflow.com/users/9278974/horia-pantelimon"}, "edited": false, "score": 0, "creation_date": 1517396856, "post_id": 48540151, "comment_id": 84076411, "body": "@coderredoc (I missread &#39;byte&#39; with &#39;bit&#39; on a source, and this led to confusion) Thank you for clarification!"}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 1, "last_activity_date": 1517395993, "last_edit_date": 1517395993, "creation_date": 1517395315, "answer_id": 48540151, "question_id": 48540081, "link": "https://stackoverflow.com/questions/48540081/about-struct-memory-managemet-in-c/48540151#48540151", "title": "about Struct Memory Managemet in C", "body": "<p>Most variables in C have a size that is an integral number of bytes. Bit-fields are a part of a structure that <em>don't\nnecessarily</em> occupy a integral number of bytes; <em>they can any number of bits</em>. Multiple bit-fields can be packed into a\nsingle storage unit. Here these are 1 bit bitfiels capable of holding <code>0</code> and <code>-1</code>.</p>\n\n<p>And in case there is a larger number being stored in a 1 bit bitfield then this would be <em>undefined behavior</em> (signed overflow).</p>\n\n<p>More prominently use <code>unsigned</code> type in bit field in this case</p>\n\n<pre><code>typedef struct{\n unsigned int a:1, b:1;\n}test;\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9278974, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kk2zuJ9SmwY/AAAAAAAAAAI/AAAAAAAAADo/FJWSV84_QT8/photo.jpg?sz=128", "display_name": "Horia Pantelimon", "link": "https://stackoverflow.com/users/9278974/horia-pantelimon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 48540151, "answer_count": 1, "score": 1, "last_activity_date": 1517395993, "creation_date": 1517395122, "question_id": 48540081, "link": "https://stackoverflow.com/questions/48540081/about-struct-memory-managemet-in-c", "title": "about Struct Memory Managemet in C", "body": "<pre><code>typedef struct{\n int a:1, b:1;\n}test;\n</code></pre>\n\n<p><code>a</code> and <code>b</code> are capable to store a number up to 255. If somehow variable <code>a</code> stores a bigger value than that, this will affect the value of <code>b</code>,right? I am terrible at memory management. Also, is it recommended to alter the size of a field in a struct this way?</p>\n"}, {"tags": ["c", "arrays", "global-variables", "extern"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1517394981, "post_id": 48539945, "comment_id": 84075109, "body": "&quot;So,By default global variables are extern,&quot; NO; they are not by default extern. They are only <code>extern</code> if you declare them to be <code>extern</code>. Otherwise they are not."}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 8, "last_activity_date": 1517394983, "last_edit_date": 1517394983, "creation_date": 1517394782, "answer_id": 48539977, "question_id": 48539945, "link": "https://stackoverflow.com/questions/48539945/behaviour-of-global-variable-in-c/48539977#48539977", "title": "Behaviour of global variable in C", "body": "<p>The first case needs to allocate memory at run-time for an array of unspecified length. This is \"hard\", which is why the compiler complains and cheats out by assuming a length of 1.</p>\n\n<p>The second case only needs for someone else to provide a base address for an array, and it's that someone's problem to make sure there's memory allocated at the provided location.</p>\n\n<p>Not entirely sure how the details land, but that's the basic difference between the two.</p>\n\n<p>The C11 draft even has this as an explicit example:</p>\n\n<blockquote>\n  <p><code>extern int *x;</code><br>\n  <code>extern int y[];</code></p>\n  \n  <p>The first declares <code>x</code> to be a pointer to <code>int</code>; the second declares <code>y</code> to be an array of <code>int</code> of unspecified size (an incomplete type), the storage for which is defined elsewhere.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "is_accepted": false, "score": 5, "last_activity_date": 1517394887, "creation_date": 1517394887, "answer_id": 48540012, "question_id": 48539945, "link": "https://stackoverflow.com/questions/48539945/behaviour-of-global-variable-in-c/48540012#48540012", "title": "Behaviour of global variable in C", "body": "<p>When you write a</p>\n\n<pre><code>char arr[];\n</code></pre>\n\n<p>in global scope, your intention is to <strong>define</strong> an array with static lifetime. Thus you must specify how many elements it contains.</p>\n\n<p>When you write</p>\n\n<pre><code>extern char arr[];\n</code></pre>\n\n<p>it's only a <strong>declaration</strong>, to tell compiler that an array named <code>arr</code> exists somewhere else, not defined here. Thus no size is required.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517414205, "post_id": 48541155, "comment_id": 84088206, "body": "Very nice and clear - especially about the linkage issue."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 4, "last_activity_date": 1517398342, "creation_date": 1517398342, "answer_id": 48541155, "question_id": 48539945, "link": "https://stackoverflow.com/questions/48539945/behaviour-of-global-variable-in-c/48541155#48541155", "title": "Behaviour of global variable in C", "body": "<p>Beware there is a little confusion in your terms:</p>\n\n<blockquote>\n  <p>By default global variables are extern</p>\n</blockquote>\n\n<p>Not exactly: global variable have <em>external linkage</em> unless they are declared static. In that latter case they have <em>internal linkage</em>.</p>\n\n<p>External linkage means that the variable may be refered from a different translation unit (another source file) if it is declared extern there. The <code>extern</code> specifier declares that the variable should be defined elsewhere with external linkage.</p>\n\n<p>That explains your problem:</p>\n\n<pre><code>char arr[];\n</code></pre>\n\n<p>is a tentative (incorrect here) definition of a character array with external linkage. As the size is not specified and cannot be deduced from an initializer, it cannot fully define the array. As it is not declared extern and as no complete definition exists in that translation unit, it is an incorrect definition.</p>\n\n<pre><code>extern char arr[];\n</code></pre>\n\n<p>on the other hand only <em>declares</em> arr to be a char array, which is assumed to be defined elsewhere, possibly in a different translation unit. The program will be ill formed with no diagnostic required if there is no definition.</p>\n\n<p>But this is a perfectly correct program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar arr[];  // tentative definition\n\nint main()\n{\n    // can use arr here, except for sizeof(arr) which would be an error\n    // because only a declaration (not a definition) has been seen to this point\n    return 0;\n}\n\nchar arr[] = \"abcd\";  // full definition: the size is deduced to be 5\n</code></pre>\n\n<p>The tentative definition is only seen as a forward declaration. As the definition exists in the translation unit the compiler is glad with it...</p>\n"}], "owner": {"reputation": 4293, "user_id": 7035151, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ce9aa200c854d26a2cd263f6fc8c24eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jayesh", "link": "https://stackoverflow.com/users/7035151/jayesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 1, "accepted_answer_id": 48541155, "answer_count": 3, "score": 2, "last_activity_date": 1517398342, "creation_date": 1517394640, "last_edit_date": 1517397508, "question_id": 48539945, "link": "https://stackoverflow.com/questions/48539945/behaviour-of-global-variable-in-c", "title": "Behaviour of global variable in C", "body": "<p>If I declared array as a global like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar arr[];\n\nint main()\n{\n    return 0;\n}\n</code></pre>\n\n<p>The compiler generates a warning:</p>\n\n<pre><code>test.c:3:6: warning: array \u2018arr\u2019 assumed to have one element [enabled by default]\n char arr[];\n</code></pre>\n\n<p>But, If I declared array as a global and explicit provide extern keyword like this: </p>\n\n<pre><code>extern char arr[];\n\nint main()\n{\n    return 0;\n}\n</code></pre>\n\n<p>Then, it's compile fine without warning.</p>\n\n<p>But, By default global variables are <code>extern</code>, then why does first case generated warning?</p>\n"}, {"tags": ["c++", "c", "scope", "static", "shadowing"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1517393926, "post_id": 48539659, "comment_id": 84074420, "body": "Possible duplicate <a href=\"https://stackoverflow.com/questions/22120362/shadowing-of-static-global-and-local-identifiers\" title=\"shadowing of static global and local identifiers\">stackoverflow.com/questions/22120362/&hellip;</a>"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 3, "creation_date": 1517394691, "post_id": 48539659, "comment_id": 84074939, "body": "If you turn your compiler Flags ON you\u2019ll see that the compiler warns you about the declaration which shadows another one. At least GCC does that."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1517394696, "post_id": 48539659, "comment_id": 84074942, "body": "&quot;It looks like two operations are achieved in a single instruction and more than once.&quot; Could you please specify what you mean and which output you expected?"}, {"owner": {"reputation": 856, "user_id": 4250150, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-KLzePzmbqTs/AAAAAAAAAAI/AAAAAAAAAD8/henWhVuLqE4/photo.jpg?sz=128", "display_name": "sudo rm -rf slash", "link": "https://stackoverflow.com/users/4250150/sudo-rm-rf-slash"}, "edited": false, "score": 0, "creation_date": 1517420672, "post_id": 48539659, "comment_id": 84092544, "body": "Maybe off topic, but why did they design compilers to allow shadowing?  Only use case I can think of is maybe you include a c library that uses a common name?"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1517463843, "post_id": 48539659, "comment_id": 84108187, "body": "&quot;two operations are achieved in a single instruction&quot; - where exactly do you see something like that?"}], "answers": [{"comments": [{"owner": {"reputation": 2197, "user_id": 5774004, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GWLhs.jpg?s=128&g=1", "display_name": "Sreeragh A R", "link": "https://stackoverflow.com/users/5774004/sreeragh-a-r"}, "edited": false, "score": 8, "creation_date": 1517394821, "post_id": 48539800, "comment_id": 84075013, "body": "Just an information.. static int i = 100;  is executed only once.. If it was not static result would have been 99,  99 , 99"}, {"owner": {"reputation": 8947, "user_id": 744616, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/2Pfhc.jpg?s=128&g=1", "display_name": "Pranit Kothari", "link": "https://stackoverflow.com/users/744616/pranit-kothari"}, "reply_to_user": {"reputation": 2197, "user_id": 5774004, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GWLhs.jpg?s=128&g=1", "display_name": "Sreeragh A R", "link": "https://stackoverflow.com/users/5774004/sreeragh-a-r"}, "edited": false, "score": 0, "creation_date": 1517394871, "post_id": 48539800, "comment_id": 84075041, "body": "@SreeraghAR True."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 2197, "user_id": 5774004, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GWLhs.jpg?s=128&g=1", "display_name": "Sreeragh A R", "link": "https://stackoverflow.com/users/5774004/sreeragh-a-r"}, "edited": false, "score": 2, "creation_date": 1517463930, "post_id": 48539800, "comment_id": 84108212, "body": "@Sreeragh A R: That is misleading. In both C and  C++ <code>i</code> is initialized <i>statically</i> (aka &quot;at compile time&quot;). It is never really executed even once. And C language does not even have a concept of &quot;executing&quot; initialization of static objects. Even though the initializer appears to be written inside the function, the actual initialization takes place outside its bounds."}, {"owner": {"reputation": 2197, "user_id": 5774004, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GWLhs.jpg?s=128&g=1", "display_name": "Sreeragh A R", "link": "https://stackoverflow.com/users/5774004/sreeragh-a-r"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1517464790, "post_id": 48539800, "comment_id": 84108521, "body": "@AnT You may be right..I just wanted to convey that the  result would have been different if it was not static.."}], "tags": [], "owner": {"reputation": 8947, "user_id": 744616, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/2Pfhc.jpg?s=128&g=1", "display_name": "Pranit Kothari", "link": "https://stackoverflow.com/users/744616/pranit-kothari"}, "is_accepted": true, "score": 24, "last_activity_date": 1517394535, "last_edit_date": 1517394535, "creation_date": 1517394219, "answer_id": 48539800, "question_id": 48539659, "link": "https://stackoverflow.com/questions/48539659/defining-a-variable-and-its-static-equivalent-in-the-same-function/48539800#48539800", "title": "Defining a variable and its static equivalent in the same function", "body": "<p>This is not undefined behavior.</p>\n\n<pre><code>#include \"stdio.h\"\n\nint main(void) {\n  int i = 3; //first i\n  while(i--) {\n    static int i = 100; //second i\n    i--,\n    printf(\"%d\\n\", i);\n  }\n  return 0;\n}\n</code></pre>\n\n<p>In while loop body most local <code>i</code> (second <code>i</code>) is preferred.  While checking condition in while loop it doesn't know what is there in body. So it has no problem choosing first <code>i</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1517394665, "post_id": 48539866, "comment_id": 84074919, "body": "If you turn your compiler Flags ON you\u2019ll see that the compiler warns you about the declaration which shadows another one. At least GCC does that."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1517394811, "post_id": 48539866, "comment_id": 84075009, "body": "Sure. It warns you that it refers to the inner most variable, while the programmer might not. The warning explains the behavior"}], "tags": [], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "is_accepted": false, "score": 2, "last_activity_date": 1517394421, "creation_date": 1517394421, "answer_id": 48539866, "question_id": 48539659, "link": "https://stackoverflow.com/questions/48539659/defining-a-variable-and-its-static-equivalent-in-the-same-function/48539866#48539866", "title": "Defining a variable and its static equivalent in the same function", "body": "<p>Its possible to declare a same named variable inside a nested scope. The compiler sees them as different variables. It is very confusing but the variable you are accessing each time is the one declared in the inner most scope. Outside the <code>while</code> it is the  <code>int i = 3;</code> and inside it is the <code>static int i = 100;</code></p>\n\n<pre><code>#include \"stdio.h\"\n\nint main(void) {\n  int i = 3; // outer i\n  while(i--) { // outer i\n    static int i = 100; // inner i\n    i--, // inner i\n    printf(\"%d\\n\", i); // inner i\n  }\n  return 0;\n}\n</code></pre>\n\n<p>If this was a function other than main, then the 2nd call to it would produce </p>\n\n<pre><code>96\n95\n94\n</code></pre>\n\n<p>and so on...</p>\n"}, {"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 11, "last_activity_date": 1517463095, "last_edit_date": 1517463095, "creation_date": 1517394430, "answer_id": 48539869, "question_id": 48539659, "link": "https://stackoverflow.com/questions/48539659/defining-a-variable-and-its-static-equivalent-in-the-same-function/48539869#48539869", "title": "Defining a variable and its static equivalent in the same function", "body": "<p>Wikipedia says very prominent thing on this:</p>\n\n<blockquote>\n  <p>In computer programming, variable <strong>shadowing</strong> occurs when a variable declared within a certain scope (decision block, method, or inner class) has the same name as a variable declared in an outer scope. At the level of identifiers (names, rather than variables), this is known as name masking. This outer variable is said to be shadowed by the inner variable, while the inner identifier is said to mask the outer identifier. </p>\n</blockquote>\n\n<p>Now here inside the block it finds the static variable and works on it but the while condition decrements the <code>i</code> which is the one declared outside the block. The scope being different - it is no problem to use the correct value of <code>i</code>. This is legal C code but not necessarily a good way of writing things. </p>\n\n<p>In fact doing this <code>gcc -Wshadow progname.c</code> gives</p>\n\n<pre><code>progname.c: In function 'main':\nprogname.c:7:20: warning: declaration of 'i' shadows a previous local [-Wshadow]\n         static int i=2;\n                    ^\nprogname.c:5:9: warning: shadowed declaration is here [-Wshadow]\n     int i=2;\n         ^\n</code></pre>\n\n<p>From standard \u00a7<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.1p4\" rel=\"nofollow noreferrer\">6.2.1p4</a></p>\n\n<blockquote>\n  <p>... If an identifier designates two different entities in the same name space, the scopes might overlap. If so, the scope of one entity (the inner scope) will end strictly before the scope of the other entity (the outer scope). <em>Within the inner scope, the identifier designates the entity declared in the inner scope; the entity declared in the outer scope is hidden (and not visible) within the inner scope</em>.</p>\n</blockquote>\n"}], "owner": {"reputation": 1324, "user_id": 8147455, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c0f9204eec46dea673aa01464b496362?s=128&d=identicon&r=PG&f=1", "display_name": "Xatyrian", "link": "https://stackoverflow.com/users/8147455/xatyrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1557, "favorite_count": 2, "accepted_answer_id": 48539800, "answer_count": 3, "score": 17, "last_activity_date": 1517463095, "creation_date": 1517393819, "last_edit_date": 1517439435, "question_id": 48539659, "link": "https://stackoverflow.com/questions/48539659/defining-a-variable-and-its-static-equivalent-in-the-same-function", "title": "Defining a variable and its static equivalent in the same function", "body": "<p>I don't understand how the following code works:</p>\n\n<pre><code>#include \"stdio.h\"\n\nint main(void) {\n  int i = 3;\n  while(i--) {\n    static int i = 100;\n    i--,\n    printf(\"%d\\n\", i);\n  }\n  return 0;\n}\n</code></pre>\n\n<p>The code compiled with either Clang or GCC prints the following output:</p>\n\n<pre><code>99\n98\n97\n</code></pre>\n\n<p>Can someone explain to me what happens here? It looks like two operations are achieved in a single instruction and more than once. Is it undefined behavior?\nI observe the same behavior in C++.</p>\n"}, {"tags": ["c", "fork"], "comments": [{"owner": {"reputation": 1, "user_id": 9293767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a63cf8bcc20d8f6bbd0c224f64f3561?s=128&d=identicon&r=PG&f=1", "display_name": "Kyla", "link": "https://stackoverflow.com/users/9293767/kyla"}, "edited": false, "score": 0, "creation_date": 1517393697, "post_id": 48539521, "comment_id": 84074269, "body": "Would it be outside of the loop?"}, {"owner": {"reputation": 1, "user_id": 9293767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a63cf8bcc20d8f6bbd0c224f64f3561?s=128&d=identicon&r=PG&f=1", "display_name": "Kyla", "link": "https://stackoverflow.com/users/9293767/kyla"}, "edited": false, "score": 0, "creation_date": 1517393992, "post_id": 48539521, "comment_id": 84074470, "body": "I change my code slightly so that i call pids[i] = fork() before the if statements."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517394073, "post_id": 48539521, "comment_id": 84074532, "body": "Two problems: The first is that there&#39;s no synchronization for the reading of the file inside the child process, two or more processes might (and it&#39;s very likely actually) read the same character. You can&#39;t read the file inside the child processes. Secondly, memory is not shared between processes. Each child-process will have its own separate and distinct copy of the memory."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517394230, "post_id": 48539521, "comment_id": 84074639, "body": "On a more unrelated note: Don&#39;t use <a href=\"https://en.wikipedia.org/wiki/Magic_number_(programming)\" rel=\"nofollow noreferrer\"><i>magic numbers</i></a>. If by e.g. <code>65</code> mean the <a href=\"http://en.cppreference.com/w/c/language/ascii\" rel=\"nofollow noreferrer\">ASCII</a> encoded character <code>&#39;A&#39;</code> then <i>say</i> so. Although in this case you really should not to that anyway and instead use <a href=\"http://en.cppreference.com/w/c/string/byte#Character_manipulation\" rel=\"nofollow noreferrer\">the standard character manipulation functions</a> to convert casing."}, {"owner": {"reputation": 1, "user_id": 9293767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a63cf8bcc20d8f6bbd0c224f64f3561?s=128&d=identicon&r=PG&f=1", "display_name": "Kyla", "link": "https://stackoverflow.com/users/9293767/kyla"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517394312, "post_id": 48539521, "comment_id": 84074700, "body": "So should I have the file input information in the parent process?"}, {"owner": {"reputation": 1, "user_id": 9293767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a63cf8bcc20d8f6bbd0c224f64f3561?s=128&d=identicon&r=PG&f=1", "display_name": "Kyla", "link": "https://stackoverflow.com/users/9293767/kyla"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517394357, "post_id": 48539521, "comment_id": 84074728, "body": "Write a program which reads its input from a plain text file  (containing letters, punctuation marks, new lines and digits)  given as input (read  the filename  from the standard input),  and calculates a statistic based  on the frequency of each letter. For each letter  i , there should be a  separate  process  P i who is responsible  to return the fr equency for that particular letter."}, {"owner": {"reputation": 1, "user_id": 9293767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a63cf8bcc20d8f6bbd0c224f64f3561?s=128&d=identicon&r=PG&f=1", "display_name": "Kyla", "link": "https://stackoverflow.com/users/9293767/kyla"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517394375, "post_id": 48539521, "comment_id": 84074740, "body": "That is the assignment description."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517394394, "post_id": 48539521, "comment_id": 84074752, "body": "Instead of posting such information in comments, edit your question."}, {"owner": {"reputation": 1, "user_id": 9293767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a63cf8bcc20d8f6bbd0c224f64f3561?s=128&d=identicon&r=PG&f=1", "display_name": "Kyla", "link": "https://stackoverflow.com/users/9293767/kyla"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517394547, "post_id": 48539521, "comment_id": 84074846, "body": "Sorry, because each letter needs a seperate process, how should I set up my fork?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517394549, "post_id": 48539521, "comment_id": 84074848, "body": "As for how to solve your problem, read the whole file into memory once, in the parent process, before you fork. Then you fork one child for each letter in the alphabet. Each child process iterates over the in-memory copy of the file and increase an internal counter for each respective character. Then lastly, to propagate that to the parent process, consider how to <i>return</i> a value from a process. Haven&#39;t you ever wondered what the number in that <code>exit</code> call means and what happens to it? Read some <i>manual pages</i> (for example for<a href=\"http://man7.org/linux/man-pages/man2/waitpid.2.html\" rel=\"nofollow noreferrer\"><code>wait</code></a>)"}, {"owner": {"reputation": 1, "user_id": 9293767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a63cf8bcc20d8f6bbd0c224f64f3561?s=128&d=identicon&r=PG&f=1", "display_name": "Kyla", "link": "https://stackoverflow.com/users/9293767/kyla"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517394578, "post_id": 48539521, "comment_id": 84074865, "body": "And for the characters, would using the tolower(c) function work?"}, {"owner": {"reputation": 1, "user_id": 9293767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a63cf8bcc20d8f6bbd0c224f64f3561?s=128&d=identicon&r=PG&f=1", "display_name": "Kyla", "link": "https://stackoverflow.com/users/9293767/kyla"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517394720, "post_id": 48539521, "comment_id": 84074963, "body": "How would I fork one child per letter?"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1517395564, "post_id": 48539521, "comment_id": 84075482, "body": "Please remember that <code>EOF</code> does not fit in a <code>char</code>, hence <code>fgetc()</code> returns <code>int</code>."}, {"owner": {"reputation": 1, "user_id": 9293767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a63cf8bcc20d8f6bbd0c224f64f3561?s=128&d=identicon&r=PG&f=1", "display_name": "Kyla", "link": "https://stackoverflow.com/users/9293767/kyla"}, "edited": false, "score": 0, "creation_date": 1517415806, "post_id": 48539521, "comment_id": 84089310, "body": "Thank you! I didn&#39;t realize I had done that."}], "owner": {"reputation": 1, "user_id": 9293767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a63cf8bcc20d8f6bbd0c224f64f3561?s=128&d=identicon&r=PG&f=1", "display_name": "Kyla", "link": "https://stackoverflow.com/users/9293767/kyla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517393455, "creation_date": 1517393455, "question_id": 48539521, "link": "https://stackoverflow.com/questions/48539521/i-have-to-count-the-occurence-of-letters-in-a-file-with-each-letter-having-its-o", "title": "I have to count the occurence of letters in a file with each letter having its own fork process", "body": "<p>Here is my code so far. It is printing out zeros for each letter. I have a loop that creates different fork child processes for each letter. Then I take the character from a file which loops until the end of a file, then it checks to see if it is a lower or upper case that matches the letters in ascii. I am really stuck and don't know where to go from here. </p>\n\n<pre><code>    int main(int argc, char **argv){\n\nchar characters[26] = { 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n',\n            'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z' };\nint counter[26] = { 0 };\nint n = 26;\nchar c;\nif (argc &lt; 2) \nreturn 1;\nFILE *file = fopen(argv[1], \"r\");\npid_t pids[26];\n\nfor (int i = 0; i &lt; n; i++){\n    if ((pids[i] = fork()) &lt; 0) {\n        printf(\"Error\");\n        exit(1);\n    } else if (pids[i] == 0) {\n        c = fgetc(file);\n        if (c == EOF) break;\n        if (c == (i + 65) || c == (i + 97))\n            counter[i]++;\n        exit(0);\n    } else {\n        wait(NULL);\n\n\n    }\n}\nfor (int i = 0; i &lt; n; ++i){\n            printf(\"%c: %i\\n\", characters[i], cou nter[i]);\n}\nfclose(file);\nreturn 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1517392219, "post_id": 48539015, "comment_id": 84073187, "body": "I don&#39;t think that description is meant to be read as: &quot;... and so you can treat it as such&quot;. It&#39;s just a value of <i>some</i> type, only meant to be passed on to <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms633571(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>CallWindowProc</code></a> (which also does not care what type it is)."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 3, "creation_date": 1517392593, "post_id": 48539015, "comment_id": 84073485, "body": "Why do you need to know? I&#39;m smelling an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY problem</a>."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517392946, "post_id": 48539015, "comment_id": 84073724, "body": "exist <code>GetWindowLongPtrW</code> and <code>GetWindowLongPtrA</code> - based as window procedure Unicode or ansi - one version returned handle, another procedure address"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 1, "creation_date": 1517393364, "post_id": 48539015, "comment_id": 84074038, "body": "@zett42 - I don&#39;t know for what this is need for OP, but this is need if we write tool like Spy++ - by given windows handle - display for user information about window, window procedure address as well. for debugging and research this info is very useful"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517433540, "post_id": 48539015, "comment_id": 84099378, "body": "@RbMm: Yes, correct. I&#39;m writing a debugging, RE, malware analysis tool. The goal here is to know the exact <code>WndProc</code> address in the target process, (as well as <code>DlgProc</code> for dialog windows.)"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1517433618, "post_id": 48539015, "comment_id": 84099416, "body": "so <code>(IsWindowUnicode(hwnd) ?      GetWindowLongPtrW : GetWindowLongPtrA)(hwnd, GWLP_WNDPROC);</code> give to you exactly function address."}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517433805, "post_id": 48539015, "comment_id": 84099505, "body": "@RbMm: Yeah, thanks. I just read your full explanation below. Totally makes sense. I hate that I didn&#39;t see it myself :) So in other words, if I call <code>GetWindowLongPtrW(hWnd, DWLP_DLGPROC);</code> on a Unicode window it will <b>always</b> return a pointer and <b>not</b> a handle, correct?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517434563, "post_id": 48539015, "comment_id": 84099882, "body": "yes. the same - <code>IsWindowUnicode(hwnd) ? GetWindowLongPtrW : GetWindowLongPtrA</code> - <code>GWLP_WNDPROC</code> or <code>DWLP_DLGPROC</code> - no different"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517436279, "post_id": 48539015, "comment_id": 84100713, "body": "yes, this is right. however need check, what be in this case. need create poc"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517439868, "post_id": 48539015, "comment_id": 84102239, "body": "@RbMm: I&#39;ll remove my bug comment. Need to look into it first... thanks."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517440539, "post_id": 48539015, "comment_id": 84102471, "body": "i check - really if window proc in <code>0xffff0000</code> mask (this is can be legal address for x64 - simply set <code>&#47;BASE:0xffff0000</code> and <code>&#47;FIXED</code> linker option) - the <code>HMValidateHandleNoRip</code> called. but it return false and after this direct call by this address. so this is only <b>first fast check</b>"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517449143, "post_id": 48539015, "comment_id": 84104557, "body": "@RbMm: Yeah, you&#39;re right. It can recover from it. So I don&#39;t think they&#39;ll be fixing it any time soon. At the worst it wastes CPU cycles for looking up a nonexistent handle. I&#39;ll try to report it just for completeness. We&#39;ll see if they care."}], "answers": [{"comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1517393218, "post_id": 48539407, "comment_id": 84073915, "body": "question have sense if we write some tool like Spy++ and want show window procedure address for concrete window - we not need call window proc, but show it address"}, {"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1517433654, "post_id": 48539407, "comment_id": 84099433, "body": "@RbMm: Thanks for your understanding. This site is full of hot shots that are eager to issue their pointless &amp; pithy comments without understanding the question. You answer below is spot on. Plus I just learned something today. Very cool stuff!"}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1517393063, "creation_date": 1517393063, "answer_id": 48539407, "question_id": 48539015, "link": "https://stackoverflow.com/questions/48539015/how-to-convert-a-returned-wndproc-dlgproc-handle-into-a-function-address/48539407#48539407", "title": "How to convert a returned WndProc/DlgProc handle into a function address?", "body": "<p>Your question does not really make sense. If you have the window procedure in your own code - more exactly in one of the application modules - <code>GetWindowLongPtr(hWnd, DWLP_DLGPROC);</code> will return that address. It only returns a handle when no explicit window procedure exists and it is then </p>\n\n<blockquote>\n  <p>... a special internal value meaningful only to CallWindowProc.</p>\n</blockquote>\n\n<p>That means that the messages are directly processed by Windows internal code, and you should not even try to guess how(*): it is private to Windows system.</p>\n\n<hr>\n\n<p>(*) The only exception is if you are building a low level library like those from sysinternals that do use undocumented functions and structures.</p>\n"}, {"comments": [{"owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "edited": false, "score": 0, "creation_date": 1517436597, "post_id": 48539414, "comment_id": 84100853, "body": "Anyway, I just learned something today. This is crazy. I had no idea that someone can change ANSI to Unicode window class type after its creation (and vice versa) by calling <code>SetWindowLongPtr</code>"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "edited": false, "score": 0, "creation_date": 1517436710, "post_id": 48539414, "comment_id": 84100901, "body": "@c00000fd - yes. can. documentation is incomplete at this point. however you can simply run and test my code snippet"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "edited": false, "score": 0, "creation_date": 1517436965, "post_id": 48539414, "comment_id": 84101017, "body": "@c00000fd - somebody send <code>WM_SETTEXT</code> to window. window proc must got pointer to <code>WCHAR</code> or <code>CHAR</code> text string ? this is depend form are windows ansi or unicode. but if we subclass window with <code>SetWindowLongPtrX(hwnd, GWLP_WNDPROC, (LONG_PTR)NewWindowProc)</code> - new procedure must got ansi or unicode string ? this must based on initial window creation or on <code>SetWindowLongPtrA</code> vs <code>SetWindowLongPtrW</code> ? documentation nothing say about this. always need think yourself"}], "tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": true, "score": 3, "last_activity_date": 1517397717, "last_edit_date": 1517397717, "creation_date": 1517393110, "answer_id": 48539414, "question_id": 48539015, "link": "https://stackoverflow.com/questions/48539015/how-to-convert-a-returned-wndproc-dlgproc-handle-into-a-function-address/48539414#48539414", "title": "How to convert a returned WndProc/DlgProc handle into a function address?", "body": "<p>you need next code:</p>\n\n<pre><code>PVOID pfn = (IsWindowUnicode(hwnd) ? \n    GetWindowLongPtrW : GetWindowLongPtrA)(hwnd, GWLP_WNDPROC);\n</code></pre>\n\n<p>so you need call <code>GetWindowLongPtrW</code> or <code>GetWindowLongPtrA</code> based on result of <code>IsWindowUnicode</code></p>\n\n<hr>\n\n<p>note: <code>GetWindowLongPtrA(hwnd, GWLP_WNDPROC)</code> and <code>GetWindowLongPtrW(hwnd, GWLP_WNDPROC)</code> - always return different result - one address of the window procedure and another - handle representing the address of the window procedure : special internal value meaningful only to <code>CallWindowProc</code> - for determine which version <strong>A</strong> or <strong>W</strong> retrieves the address of the window procedure - need call <code>IsWindowUnicode</code>. this is undocumented, but reasonable. if subclassed procedure have the same ANSI or UNICODE native that original procedure it can direct call original. if native is different - need translation (Unicode &lt;-> ANSI) for window messages (as example <code>WM_GETTEXT</code>, <code>WM_SETTEXT</code>..). </p>\n\n<p>fact that <code>GetWindowLongPtr(hwnd, GWLP_WNDPROC)</code> must return the same value as <code>SetWindowLongPtr(hwnd, GWLP_WNDPROC, (LONG_PTR)NewWindowProc)</code></p>\n\n<p>but <code>SetWindowLongPtrA</code> set the ansi window procedure (which say got pointer to <code>CHAR</code> string in <code>WM_SETTEXT</code>) and <code>SetWindowLongPtrW</code> set the unicode window procedure (which say got pointer to <code>WCHAR</code> string in <code>WM_SETTEXT</code>). so if current window procedure and new set by <code>SetWindowLongPtr</code> have the same <strong>A</strong> or <strong>W</strong> - new procedure can direct call old, without translation, and absolute reasonable that <code>SetWindowLongPtr</code> return direct address of old windows procedure. if native is different - (we set A for W or W for A) - new window procedure can not direct call old. before this some windows messages need to be translated (<code>WM_GETTEXT</code>, <code>WM_SETTEXT</code>, etc). because this and handle returned and <code>CallWindowProc</code> translate message before call original procedure.</p>\n\n<hr>\n\n<p>example which show that <code>IsWindowUnicode</code> can return different values for the same window - based on current window procedure - are it ansi or Unicode:</p>\n\n<pre><code>if (HWND hwnd = CreateWindowExA(0, WC_STATICA, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)) {\n\n    DbgPrint(\"IsWindowUnicode=%x\\n\", IsWindowUnicode(hwnd));\n\n    LONG_PTR l = GetWindowLongPtrW(hwnd, GWLP_WNDPROC);\n\n    SetWindowLongPtrA(hwnd, GWLP_WNDPROC, l);\n\n    DbgPrint(\"IsWindowUnicode=%x\\n\", IsWindowUnicode(hwnd));\n\n    SetWindowLongPtrW(hwnd, GWLP_WNDPROC, l);\n\n    DbgPrint(\"IsWindowUnicode=%x\\n\", IsWindowUnicode(hwnd));\n\n    DestroyWindow(hwnd);\n}\n</code></pre>\n\n<p>and output:</p>\n\n<pre><code>IsWindowUnicode=1\nIsWindowUnicode=0\nIsWindowUnicode=1\n</code></pre>\n\n<p>so what say documentation:</p>\n\n<blockquote>\n  <p>The character set of a window is determined by the use of the\n  <strong>RegisterClass</strong> function. If the window class was registered with the\n  ANSI version of <strong>RegisterClass</strong> (<strong>RegisterClassA</strong>), the character set of\n  the window is ANSI. If the window class was registered with the\n  Unicode version of <strong>RegisterClass</strong> (<strong>RegisterClassW</strong>), the character set\n  of the window is Unicode.</p>\n</blockquote>\n\n<p>not exactly correct. it based on current window procedure Ansi or Unicode. initially this is based on <code>RegisterClass</code> but can be changed by <code>SetWindowLongPtr(hwnd, GWLP_WNDPROC, (LONG_PTR)NewWindowProc)</code></p>\n"}], "owner": {"reputation": 17964, "user_id": 843732, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8e7b3eb1f6bb311c47610a9d230485f0?s=128&d=identicon&r=PG", "display_name": "c00000fd", "link": "https://stackoverflow.com/users/843732/c00000fd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 48539414, "answer_count": 2, "score": 2, "last_activity_date": 1575564795, "creation_date": 1517391967, "last_edit_date": 1575564795, "question_id": 48539015, "link": "https://stackoverflow.com/questions/48539015/how-to-convert-a-returned-wndproc-dlgproc-handle-into-a-function-address", "title": "How to convert a returned WndProc/DlgProc handle into a function address?", "body": "<p>In the following call, the <code>WndProc</code> can be <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms633585(v=vs.85).aspx\" rel=\"nofollow noreferrer\">returned as a handle</a>:</p>\n\n<pre><code>FARPROC pfn = (FARPROC)GetWindowLongPtr(hWnd, \n    DWLP_DLGPROC);  //same with GWLP_WNDPROC\n</code></pre>\n\n<p>Is there a way to convert it to address from a user-mode code?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1517390113, "post_id": 48538425, "comment_id": 84071811, "body": "infinite loop.."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1517390128, "post_id": 48538425, "comment_id": 84071822, "body": "and <code>dest</code> is not initialized."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 6, "creation_date": 1517390145, "post_id": 48538425, "comment_id": 84071832, "body": "you need a C book."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1517390243, "post_id": 48538425, "comment_id": 84071901, "body": "<code>char dest[];</code> does not have any size. It is a tentative definition."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 2, "creation_date": 1517390268, "post_id": 48538425, "comment_id": 84071911, "body": "So many issues..."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1517390756, "post_id": 48538425, "comment_id": 84072233, "body": "Is it a tentative definition or incomplete type?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1517390986, "post_id": 48538425, "comment_id": 84072388, "body": "@DavidC.Rankin my compiler gave no warning (about the definition), and when I follow it with <code>char dest[20];</code> that too is acccepted."}, {"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1517391102, "post_id": 48538425, "comment_id": 84072458, "body": "<code>GCC</code> will complain all the errors and warnings if you go through one by one its easier for you to understand what is the problem. Why while loop is not executing as you wanted? You need to use <code>#include &lt;string.h&gt;</code> to use <code>strcpy</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1517391434, "post_id": 48538425, "comment_id": 84072666, "body": "@rori ... two infinite loops. Can you figure out why?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1517391857, "post_id": 48538425, "comment_id": 84072941, "body": "When I compile this with -Wall and -Wextra I get 7 warnings. Read them."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1517393574, "post_id": 48538425, "comment_id": 84074189, "body": "@WeatherVane, thanks. When I see one of those wonky global things that are incomplete, I haven&#39;t a good handle on whether they are just forward declarations or one that would be flagged as an error as an incomplete type. (I&#39;ll just have to set some time aside and work with them a bit to have it sink in)"}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 3, "last_activity_date": 1517396289, "last_edit_date": 1517396289, "creation_date": 1517391928, "answer_id": 48539004, "question_id": 48538425, "link": "https://stackoverflow.com/questions/48538425/c-modify-global-char-array/48539004#48539004", "title": "C modify global char array", "body": "<p>Let us see what <code>gcc</code> has to say about your code:</p>\n\n<pre><code>gcc -Wall test.c -o test\n\ntest.c: In function \u2018function1\u2019:\ntest.c:8:25: warning: comparison between pointer and integer\n     while (newstring[i] != NULL) {\n                         ^~\ntest.c:9:7: warning: implicit declaration of function \u2018strcpy\u2019 [-Wimplicit-function-declaration]\n       strcpy(dest, newstring[i]);\n       ^~~~~~\ntest.c:9:7: warning: incompatible implicit declaration of built-in function \u2018strcpy\u2019\ntest.c:9:7: note: include \u2018&lt;string.h&gt;\u2019 or provide a declaration of \u2018strcpy\u2019\ntest.c:9:20: warning: passing argument 2 of \u2018strcpy\u2019 makes pointer from integer without a cast [-Wint-conversion]\n       strcpy(dest, newstring[i]);\n                    ^~~~~~~~~\ntest.c:9:20: note: expected \u2018const char *\u2019 but argument is of type \u2018char\u2019\ntest.c: In function \u2018main\u2019:\ntest.c:19:20: warning: comparison between pointer and integer\n     while (dest[i] != NULL) {\n                    ^~\ntest.c:20:22: warning: format \u2018%s\u2019 expects argument of type \u2018char *\u2019, but argument 3 has type \u2018int\u2019 [-Wformat=]\n       printf (\"[%d] %s\\n\", i, dest[i]);\n                      ^\ntest.c: At top level:\ntest.c:3:6: warning: array \u2018dest\u2019 assumed to have one element\n char dest[];\n      ^~~~\n</code></pre>\n\n<p>As you can see there are so many warnings to take care of.</p>\n\n<blockquote>\n  <p><strong>Take warnings seriously and fix them</strong>. </p>\n</blockquote>\n\n<p>Doing that the code could be:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar dest[32];\n\nint function1(char* newstring) {\n    // Or simply use strcpy instead of a loop... \n    int i = 0;\n    while(newstring[i] != '\\0')\n    {\n      dest[i] = newstring[i];\n      ++i;\n    }\n    dest[i] = '\\0';\n    return 0;\n}\n\nint main() {\n    char* test=\"newstring\";\n    function1(test);\n    int i = 0;\n    while (dest[i] != '\\0') {\n      printf (\"[%d] %c\\n\", i, dest[i]);\n      ++i;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[0] n\n[1] e\n[2] w\n[3] s\n[4] t\n[5] r\n[6] i\n[7] n\n[8] g\n</code></pre>\n\n<p><strong>note</strong> You should also check for buffer overflow, i.e. that <code>i</code> is always less than 32. For clarity I omitted that but make sure to add that before the code is considered done..</p>\n"}, {"comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1517392909, "post_id": 48539304, "comment_id": 84073698, "body": "Not to be rude but this code is wrong. It has undefined behavior for multiple reasons, e.g. the <code>strcpy</code>"}, {"owner": {"reputation": 1, "user_id": 3935908, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J7okf.png?s=128&g=1", "display_name": "chirag.patel", "link": "https://stackoverflow.com/users/3935908/chirag-patel"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1517393086, "post_id": 48539304, "comment_id": 84073830, "body": "Yes but I only tried to make your code working."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1517393268, "post_id": 48539304, "comment_id": 84073951, "body": "I guess mean: &quot;make OPs code work&quot;, i.e. the code in the question... Anyway - you didn&#39;t succeed as your code isn&#39;t correct either. 1) <code>char dest[];</code> -&gt; <code>char dest[50];</code> 2) Make sure to zero-terminate <code>temp</code>"}, {"owner": {"reputation": 1, "user_id": 3935908, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J7okf.png?s=128&g=1", "display_name": "chirag.patel", "link": "https://stackoverflow.com/users/3935908/chirag-patel"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1517393870, "post_id": 48539304, "comment_id": 84074375, "body": "Yes you are correct. I only tried to make @rori code working. Maybe my code isn&#39;t correct but it provide output with little warning."}], "tags": [], "owner": {"reputation": 1, "user_id": 3935908, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J7okf.png?s=128&g=1", "display_name": "chirag.patel", "link": "https://stackoverflow.com/users/3935908/chirag-patel"}, "is_accepted": false, "score": -1, "last_activity_date": 1517392747, "creation_date": 1517392747, "answer_id": 48539304, "question_id": 48538425, "link": "https://stackoverflow.com/questions/48538425/c-modify-global-char-array/48539304#48539304", "title": "C modify global char array", "body": "<p>I have made solution for your code to work.</p>\n\n<pre><code>char dest[];\n</code></pre>\n\n<p>This statement gives warning: array 'dest' assumed to have one element.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nchar dest[];\n\nint function1(char* newstring)\n{\n    int i = 0;\n    char temp[50];\n    while (newstring[i]) {\n        temp[i]=newstring[i];\n        i++;\n    }\n    strcpy(dest, temp);\n    return 0;\n}\n\nint main() {\n    char* test=\"newstring\";\n    function1(test);\n    int i = 0;\n    while (dest[i]) {\n      printf (\"[%d] %c\\n\", i, dest[i]);\n      i++;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[0] n\n[1] e\n[2] w\n[3] s\n[4] t\n[5] r\n[6] i\n[7] n\n[8] g\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 816, "user_id": 9256699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fl416.png?s=128&g=1", "display_name": "Mahesh Nepal", "link": "https://stackoverflow.com/users/9256699/mahesh-nepal"}, "is_accepted": false, "score": 0, "last_activity_date": 1517393330, "creation_date": 1517393330, "answer_id": 48539489, "question_id": 48538425, "link": "https://stackoverflow.com/questions/48538425/c-modify-global-char-array/48539489#48539489", "title": "C modify global char array", "body": "<p>I don't think you need to use loop to copy strings using strcpy.</p>\n\n<pre><code>#include&lt;string.h&gt;\n#include&lt;stdio.h&gt;\n\nchar dest[50];\n\nint main()\n{\n    char* test = \"newstring\";\n    strcpy(dest, test);\n    int i = 0;\n    while(dest[i] != '\\0')\n    {\n       printf(\"%d: %c\\n\",i, dest[i]);\n       i++;\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9060607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbecb9077970f451c7a57ceb4082c67?s=128&d=identicon&r=PG&f=1", "display_name": "rori", "link": "https://stackoverflow.com/users/9060607/rori"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 723, "favorite_count": 0, "closed_date": 1517403715, "answer_count": 3, "score": -6, "last_activity_date": 1517410842, "creation_date": 1517390063, "last_edit_date": 1517410842, "question_id": 48538425, "link": "https://stackoverflow.com/questions/48538425/c-modify-global-char-array", "closed_reason": "Not suitable for this site", "title": "C modify global char array", "body": "<p>i have problem in C.\nI want in function1 update/modify a global string (char array)</p>\n\n<p>how can i update my variable dest and share with main function ?</p>\n\n<p>edit:\ni found solution</p>\n\n<pre><code>char *alphabet;\n\nint function1(char* newstring) {\n\n\n    alphabet = (char*)malloc(63);\n\n    printf (\"%s\\n\", alphabet);\n\n\n    strcpy(alphabet, newstring);\n\n    return 0;\n}\n\nint main() {\n   char* test=\"newstring\";\n   function1(test);\n\n   printf (\"%s\\n\", alphabet);\n\n    return 0;\n</code></pre>\n"}, {"tags": ["c", "x86", "bit-manipulation", "intel", "intrinsics"], "answers": [{"comments": [{"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1517413267, "post_id": 48538885, "comment_id": 84087528, "body": "Did you know you can use <code>PCLMULQDQ</code> 3 times to spread the bits like this? That&#39;s not very fast, but on Ryzen it&#39;s at least not as bad as <code>pdep</code>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1517420438, "post_id": 48538885, "comment_id": 84092441, "body": "@harold: Interesting.  But when the pattern is regular like this, the usual methods for the inverse of <code>pmovmskb</code> are better.  I mostly mentioned <code>pdep</code> because the question was &quot;is there an intrinsic (singular) for this?&quot;"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 4, "last_activity_date": 1517422302, "last_edit_date": 1517422302, "creation_date": 1517391546, "answer_id": 48538885, "question_id": 48538254, "link": "https://stackoverflow.com/questions/48538254/intrinsic-to-set-value-in-array-based-on-a-bitmask/48538885#48538885", "title": "Intrinsic to set value in array based on a BitMask", "body": "<p>With AVX512, yes.  Masked stores are a first-class operation in AVX512.</p>\n\n<p>Use the bitmask as an AVX512 mask for a vector store to an array, using <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#expand=1825,5214&amp;text=movdqu8\" rel=\"nofollow noreferrer\"><code>_mm512_mask_storeu_epi8 (void* mem_addr, __mmask64 k, __m512i a)</code></a>  <code>vmovdqu8</code>.  (AVX512BW.  With AVX512F, you can only use 32 or 64-bit element size.)</p>\n\n<pre><code>#include &lt;immintrin.h&gt;\n#include &lt;stdint.h&gt;\n\nvoid set_value_in_selected_elements(char *array, uint64_t bitmask, uint8_t value) {\n    __m512i broadcastv = _mm512_set1_epi8(value);\n    // integer types are implicitly convertible to/from __mmask types\n    // the compiler emits the KMOV instruction for you.\n    _mm512_mask_storeu_epi8 (array, bitmask, broadcastv);\n}\n</code></pre>\n\n<p>This compiles <a href=\"https://gcc.godbolt.org/#g:!((g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:&#39;%23include+%3Cimmintrin.h%3E%0A%23include+%3Cstdint.h%3E%0A%0Avoid+set_value_in_selected_elements(char+*array,+uint64_t+bitmask,+uint8_t+value)+%7B%0A++++__m512i+broadcastv+%3D+_mm512_set1_epi8(value)%3B%0A++++//+integer+types+are+implicitly+convertible+to/from+__mmask+types%0A++++//+the+compiler+emits+the+KMOV+instruction+for+you.%0A++++_mm512_mask_storeu_epi8+(array,+bitmask,+broadcastv)%3B%0A%7D&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:40.67076742823668,l:&#39;4&#39;,m:56.16883116883117,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:output,i:(compiler:1,editor:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;%231+with+x86-64+gcc+7.3&#39;,t:&#39;0&#39;)),header:(),l:&#39;4&#39;,m:43.83116883116883,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),k:52.07481005260082,l:&#39;3&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g73,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-xc+-O3+-march%3Dskylake-avx512&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+7.3+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),header:(),k:47.92518994739918,l:&#39;4&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">(with gcc7.3 <code>-O3 -march=skylake-avx512</code>)</a> to:</p>\n\n<pre><code>    vpbroadcastb    zmm0, edx\n    kmovq   k1, rsi\n    vmovdqu8        ZMMWORD PTR [rdi]{k1}, zmm0\n    vzeroupper\n    ret\n</code></pre>\n\n<p>If you want to write zeros in the elements where the bitmap was zero, either use a zero-masking move to create a constant from the mask and store that, or create a 0 / -1 vector using AVX512BW or DQ <a href=\"https://github.com/HJLebbink/asm-dude/wiki/VPMOVM2B_VPMOVM2W_VPMOVM2D_VPMOVM2Q\" rel=\"nofollow noreferrer\"><code>__m512i _mm512_movm_epi8(__mmask64 )</code></a>.  Other element sizes are available.  But using a masked store makes it possible to safely use it when the array size isn't a multiple of the vector width, because the unmodified elements aren't read / rewritten or anything; they're truly untouched.  (The CPU can take a slow microcode assist if any of the untouched elements would have faulted on a real store, though.)</p>\n\n<hr>\n\n<p>Without AVX512, you still asked for \"an intrinsic\" (singular).</p>\n\n<p>There's <code>pdep</code>, which you can use to expand a bitmap to a byte-map.  See <a href=\"https://stackoverflow.com/a/36951611/224132\">my AVX2 left-packing answer</a> for an example of using <code>_pdep_u64(mask, 0x0101010101010101);</code> to unpack each bit in <code>mask</code> to a byte.  This gives you 8 bytes in a <code>uint64_t</code>.  In C, if you use a <code>union</code> between that and an array, then it gives you an array of 0 / 1 elements.  (But of course indexing the array will require the compiler to emit shift instructions, if it hasn't spilled it somewhere first.  You probably just want to <code>memcpy</code> the <code>uint64_t</code> into a permanent array.)</p>\n\n<p>But in the more general case (larger bitmaps), or even with 8 elements when you want to blend in new values based on the bitmask, you should use multiple intrinsics to implement the inverse of <code>pmovmskb</code>, and use that to blend. (<strong>See the without <code>pdep</code> section below</strong>)</p>\n\n<hr>\n\n<p>In general, if your array fits in 64 bits (e.g. an 8-element char array), you can use <code>pdep</code>.  Or if it's an array of 4-bit nibbles, then you can do a 16-bit mask instead of 8.</p>\n\n<p>Otherwise there's no single instruction, and thus no intrinsic.  For larger bitmaps, you can process it in 8-bit chunks and store 8-byte chunks into the array.</p>\n\n<hr>\n\n<p><strong>If your array elements are wider than 8 bits</strong> (and you don't have AVX512), you should probably still expand bits to bytes with <code>pdep</code>, but then use <code>[v]pmovzx</code> to expand from bytes to dwords or whatever in a vector.  e.g. </p>\n\n<pre><code>// only the low 8 bits of the input matter\n__m256i bits_to_dwords(unsigned bitmap) {\n    uint64_t mask_bytes = _pdep_u64(bitmap, 0x0101010101010101);  // expand bits to bytes\n    __m128i byte_vec = _mm_cvtsi64x_si128(mask_bytes);\n    return _mm256_cvtepu8_epi32(byte_vec);\n}\n</code></pre>\n\n<hr>\n\n<p><strong>If you want to leave elements unmodified instead of setting them to zero where the bitmask had zeros</strong>, OR with the previous contents instead of assigning / storing.</p>\n\n<p>This is rather inconvenient to express in C / C++ (compared to asm).  To copy 8 bytes from a <code>uint64_t</code> into a char array, you can (and should) just use <code>memcpy</code> (to avoid any undefined behaviour because of pointer aliasing or misaligned <code>uint64_t*</code>).  This will compile to a single 8-byte store with modern compilers.</p>\n\n<p>But to OR them in, you'd either have to write a loop over the bytes of the <code>uint64_t</code>, or cast your char array to <code>uint64_t*</code>.  This <em>usually</em> works fine, because <code>char*</code> can alias anything so reading the char array later doesn't have any strict-aliasing UB.  But a misaligned <code>uint64_t*</code> <em>can</em> cause problems even on x86, if the compiler assumes that it <em>is</em> aligned when auto-vectorizing.  <a href=\"https://stackoverflow.com/questions/47510783/why-does-unaligned-access-to-mmaped-memory-sometimes-segfault-on-amd64\">Why does unaligned access to mmap&#39;ed memory sometimes segfault on AMD64?</a></p>\n\n<hr>\n\n<p><strong>Assigning a value other than 0 / 1</strong></p>\n\n<p>Use a multiply by <code>0xFF</code> to turn the mask of 0/1 bytes into a 0 / -1 mask, and then AND that with a <code>uint64_t</code> that has your value broadcasted to all byte positions.</p>\n\n<p>If you want to leave element unmodified instead of setting them to zero or <code>value=121</code>, you should probably use SSE2 / SSE4 or AVX2 even if your array has byte elements.  Load the old contents, <code>vpblendvb</code> with <code>set1(121)</code>, using the byte-mask as a control vector.</p>\n\n<p><code>vpblendvb</code> only uses the high bit of each byte, so your <code>pdep</code> constant can be <code>0x8080808080808080</code> to scatter the input bits to the <em>high</em> bit of each byte, instead of the low bit.  (So you don't need to multiply by <code>0xFF</code> to get an AND mask).</p>\n\n<p>If your elements are dword or larger, you could use <code>_mm256_maskstore_epi32</code>.  (Use <code>pmovsx</code> instead of zx to copy the sign bit when expanding the mask from bytes to dwords).  This can be a perf win over a variable-blend + always read / re-write.  <a href=\"https://stackoverflow.com/questions/48254965/is-it-possible-to-use-simd-instruction-for-replace/48285594#48285594\">Is it possible to use SIMD instruction for replace?</a>.</p>\n\n<hr>\n\n<h2>Without <code>pdep</code></h2>\n\n<p><code>pdep</code> is very slow on Ryzen, and even on Intel it's maybe not the best choice.</p>\n\n<p>The alternative is to turn your bitmask into a vector mask: \n<a href=\"https://stackoverflow.com/questions/36488675/is-there-an-inverse-instruction-to-the-movemask-instruction-in-intel-avx2/36491672#36491672\">is there an inverse instruction to the movemask instruction in intel avx2?</a> and<br>\n<a href=\"https://stackoverflow.com/questions/21622212/how-to-perform-the-inverse-of-mm256-movemask-epi8-vpmovmskb\">How to perform the inverse of _mm256_movemask_epi8 (VPMOVMSKB)?</a>.</p>\n\n<p>i.e. broadcast your bitmap to every position of a vector (or shuffle it so the right bit of the bitmap in in the corresponding byte), and use a SIMD AND to mask off the appropriate bit for that byte.  Then use <code>pcmpeqb/w/d</code> against the AND-mask to find the elements that had their bit set.</p>\n\n<p>You're probably going to want to load / blend / store if you don't want to store zeros where the bitmap was zero.</p>\n\n<p>Use the compare-mask to blend on your <code>value</code>, e.g. with <a href=\"https://software.intel.com/sites/landingpage/IntrinsicsGuide/#expand=1825,5214,433&amp;text=vpblendv\" rel=\"nofollow noreferrer\"><code>_mm_blendv_epi8</code></a> or the 256bit AVX2 version.  You can handle bitmaps in 16-bit chunks, producing 16-byte vectors with just a <code>pshufb</code> to send bytes of it to the right elements.</p>\n\n<p>It's not safe for multiple threads to do this at the same time on the same array even if their bitmaps don't intersect, unless you use masked stores, though.</p>\n"}], "owner": {"reputation": 16716, "user_id": 211528, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1d7004915c52d224157468b95e1cf4cd?s=128&d=identicon&r=PG", "display_name": "user855", "link": "https://stackoverflow.com/users/211528/user855"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1109, "favorite_count": 2, "accepted_answer_id": 48538885, "answer_count": 1, "score": 0, "last_activity_date": 1517422302, "creation_date": 1517389464, "last_edit_date": 1517391658, "question_id": 48538254, "link": "https://stackoverflow.com/questions/48538254/intrinsic-to-set-value-in-array-based-on-a-bitmask", "title": "Intrinsic to set value in array based on a BitMask", "body": "<p>Is there an intrinsic that will set a single value at all the places in an input array where the corresponding position had a 1 bit in the provided BitMask?</p>\n\n<p>10101010 is bitmask</p>\n\n<p>value is 121</p>\n\n<p>it will set positions 0,2,4,6 with value 121</p>\n"}, {"tags": ["c", "macros", "c-preprocessor"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1517389641, "post_id": 48538243, "comment_id": 84071548, "body": "Try <code>#endif</code> instead of <code>#end</code>."}, {"owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1517389867, "post_id": 48538243, "comment_id": 84071686, "body": "Hi, sorry for that, i edited the code in the SO question, but the problem is still relevant"}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1517389870, "post_id": 48538243, "comment_id": 84071687, "body": "What do you mean you &quot;dont want this&quot;? It is necessary to have a corresponding #endif for every #if"}, {"owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1517389949, "post_id": 48538243, "comment_id": 84071732, "body": "@machine_1 I want only one if statement. why do I need 2 if statements instead of using &amp;&amp; operator ?"}, {"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 0, "creation_date": 1517390070, "post_id": 48538243, "comment_id": 84071787, "body": "If it works when in 2 separate lines, then I would try to put braces on each term in the original (one-line) expression."}, {"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 0, "creation_date": 1517390119, "post_id": 48538243, "comment_id": 84071818, "body": "Something like <code>#if (LINUX_VERSION_CODE == KERNEL_VERSION(3,12,49)) &amp;&amp; (KERNEL_PATCH_LEVEL == 11)</code>."}, {"owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "reply_to_user": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 0, "creation_date": 1517390178, "post_id": 48538243, "comment_id": 84071858, "body": "@goodvibration I tried, does not work, Thats why i asked question, Also, I have included the gcc version, on my other gcc it works fine !! it is specific to this one !! thanks for trying :)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1517390482, "post_id": 48538243, "comment_id": 84072059, "body": "and what&#39;s the computed value of <code>KERNEL_PATCH_LEVEL</code> ?  could you define it to 11 in your code ?"}, {"owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1517390647, "post_id": 48538243, "comment_id": 84072164, "body": "@Jean-Fran&#231;oisFabre error: &quot;KERNEL_PATCH_LEVEL&quot; redefined [-Werror]  #define KERNEL_PATCH_LEVEL 11"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1517390649, "post_id": 48538243, "comment_id": 84072166, "body": "When you say that &quot;it works&quot; with two separate lines, is the nested <code>#if</code> being considered?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1517390710, "post_id": 48538243, "comment_id": 84072202, "body": "of course. Undefine it first with <code>#undef</code> for the test"}, {"owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1517390751, "post_id": 48538243, "comment_id": 84072232, "body": "@WeatherVane yes the nested if is considered"}, {"owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1517390876, "post_id": 48538243, "comment_id": 84072306, "body": "@Jean-Fran&#231;oisFabre Ok, we are getting somewhere, If i #undef and #define KERNEL_PATCH_LEVEL in my code (and not makefile) then it OK"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1517391452, "post_id": 48538243, "comment_id": 84072677, "body": "can you just assign this value to a variable (int a = KERNEL_PATCH_LEVEL) and see the outcome of -E output"}, {"owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1517391873, "post_id": 48538243, "comment_id": 84072950, "body": "@Jean-Fran&#231;oisFabre We seem to find the problem, the command i execute to define KERNEL_PATCH_LEVEL return null or empty on the specific kernel im running on, so if its null or empty, the #if defined macro on KERNEL_PATCH_LEVEL returns true, During compilation output I see: DKERNEL_MICRO=21 -DKERNEL_PATCH_LEVEL=&quot;"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1517391959, "post_id": 48538243, "comment_id": 84073006, "body": "defining it empty triggers the error in both cases. With &amp;&amp; and without (already tried that :)). That doesn&#39;t explain why it works with 2 <code>#if</code>"}, {"owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1517392038, "post_id": 48538243, "comment_id": 84073062, "body": "@Jean-Fran&#231;oisFabre You are write, and I was wrong in my answer to WeatherVane , on this specific kernel I compile, Im not entering the nested if. Why it works with 2 if is because i currently compile on kernel 4.1.21.x86_64.1 and the first #if checks if kernel 3.12.49.. so the second #if macro is not executed"}], "answers": [{"comments": [{"owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "edited": false, "score": 0, "creation_date": 1517392505, "post_id": 48539162, "comment_id": 84073398, "body": "What is the best practice for this problem ? to dummy define KERNEL_PATCH_LEVEL in my makefile if empty ? since #if defined(KERNEL_PATCH_LEVEL) does not do the job"}, {"owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "edited": false, "score": 0, "creation_date": 1517393341, "post_id": 48539162, "comment_id": 84074022, "body": "KERNEL_PATCH_LEVEL is defined but &quot;ill&quot;, I think i&#39;d rather get compilation issues rather then defining it to dummy 0, that would hurt me later on some cases and would be hard to detect. Since it only fails in the 2nd if. on the problematic kernels that I will enter the first if, i rather fail then passing 0 (since kernel versions ends with 0)."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 3, "last_activity_date": 1517395109, "last_edit_date": 1517395109, "creation_date": 1517392390, "answer_id": 48539162, "question_id": 48538243, "link": "https://stackoverflow.com/questions/48538243/macro-if-statement-returns-error-operator-has-no-right-operand/48539162#48539162", "title": "macro if statement returns error: operator &#39;&amp;&amp;&#39; has no right operand", "body": "<p>it turns out that the error source is that <code>KERNEL_PATCH_LEVEL</code> is defined in the makefile but empty.</p>\n\n<p>In that case, the 2 lines aren't equivalent, since </p>\n\n<pre><code>#if LINUX_VERSION_CODE == KERNEL_VERSION(3,12,49) &amp;&amp; KERNEL_PATCH_LEVEL == 11\n</code></pre>\n\n<p>evaluates both parts no matter what the the outcome of the first test is, so the preprocessor stumbles on the syntax error when meeting <code>&amp;&amp; == 11</code>.</p>\n\n<p>But if <code>LINUX_VERSION_CODE == KERNEL_VERSION(3,12,49)</code> is false, with this construct:</p>\n\n<pre><code>#if LINUX_VERSION_CODE == KERNEL_VERSION(3,12,49) \n#if KERNEL_PATCH_LEVEL == 11\n  ...\n#endif //KERNEL_PATCH_LEVEL == 11\n#endif \n</code></pre>\n\n<p>you're not entering the first <code>#if</code> so the inner <code>#if</code> (which is wrong since worth <code>#if == 11</code>) belongs to a block which skipped by the preprocessor, which explains that there's no error.</p>\n\n<p>Note that if <code>KERNEL_PATCH_LEVEL</code> is not defined, <code>#if</code> sees that as <code>0</code>, that wouldn't have triggered any error.</p>\n\n<p>you can protect against ill-defined <code>KERNEL_PATCH_LEVEL</code> with this (seen in <a href=\"https://stackoverflow.com/questions/4102351/test-for-empty-macro-definition\">Test for empty macro definition</a>, I have added a better answer now)</p>\n\n<pre><code>#if (KERNEL_PATCH_LEVEL + 0) == 0\n#undef KERNEL_PATCH_LEVEL\n#define KERNEL_PATCH_LEVEL 0\n#endif\n</code></pre>\n\n<p>so if the macro is defined empty (or is 0), undefine it and define it to a <code>0</code> value. You could even detect (see my answer in the link above to understand how it works) if it's empty instead of <code>0</code> like this: </p>\n\n<pre><code>#if (0-KERNEL_PATCH_LEVEL-1)==1 &amp;&amp; (KERNEL_PATCH_LEVEL+0)!=-2\n#error \"KERNEL_PATCH_LEVEL defined empty\"\n#endif\n</code></pre>\n"}], "owner": {"reputation": 4454, "user_id": 1426106, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/67b5bab68445cf71df9b77cef2fc3ec8?s=128&d=identicon&r=PG", "display_name": "ilansch", "link": "https://stackoverflow.com/users/1426106/ilansch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1383, "favorite_count": 0, "accepted_answer_id": 48539162, "answer_count": 1, "score": 4, "last_activity_date": 1517395109, "creation_date": 1517389424, "last_edit_date": 1517390479, "question_id": 48538243, "link": "https://stackoverflow.com/questions/48538243/macro-if-statement-returns-error-operator-has-no-right-operand", "title": "macro if statement returns error: operator &#39;&amp;&amp;&#39; has no right operand", "body": "<p>I am compiling my code on many linux machines, on a specific machine, I receive the following error:  </p>\n\n<pre><code>error: operator '&amp;&amp;' has no right operand\n</code></pre>\n\n<p>The macro code is:  </p>\n\n<pre><code>#if LINUX_VERSION_CODE == KERNEL_VERSION(3,12,49) &amp;&amp; KERNEL_PATCH_LEVEL == 11\n</code></pre>\n\n<p>where LINUX_VERSION_CODE and KERNEL_VERSION are defined in linux sources and KERNEL_PATCH_LEVEL is defined in my Makefile  </p>\n\n<pre><code>KERNEL_PATCH_LEVEL :=$(word 1, $(subst ., ,$(word 2, $(subst -, ,$(KERNEL_HEADERS)))))\n</code></pre>\n\n<p>If i change the code to 2 different lines, like this, <strong>it works</strong>:  </p>\n\n<pre><code>#if LINUX_VERSION_CODE == KERNEL_VERSION(3,12,49) \n#if KERNEL_PATCH_LEVEL == 11\n  ...\n#endif //KERNEL_PATCH_LEVEL == 11\n#endif \n</code></pre>\n\n<p>Is it possible to still keep it with one #if ?\nI use gcc version 4.9.0 (Debian 4.9.0-7)</p>\n\n<p>The following macro does not work:  </p>\n\n<pre><code>#if (LINUX_VERSION_CODE == KERNEL_VERSION(3,12,49)) &amp;&amp; (KERNEL_PATCH_LEVEL == 11)  \n\n#if ((LINUX_VERSION_CODE == KERNEL_VERSION(3,12,49)) &amp;&amp; (KERNEL_PATCH_LEVEL == 11))  \n\n#if defined(KERNEL_MAJOR) &amp;&amp; defined(KERNEL_MINOR) &amp;&amp; defined(KERNEL_MICRO) &amp;&amp; defined(KERNEL_PATCH_LEVEL) &amp;&amp; defined(KERNEL_VERSION) &amp;&amp; \ndefined(LINUX_VERSION_CODE) &amp;&amp; \\\n     (LINUX_VERSION_CODE == KERNEL_VERSION(3,12,49)) &amp;&amp; (KERNEL_PATCH_LEVEL == 11)\n</code></pre>\n"}, {"tags": ["c", "templates", "gtk3", "glade"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1517391492, "post_id": 48538189, "comment_id": 84072702, "body": "This seems like a highly opinion-based question, where the real answer is probably &#39;use whatever you prefer&#39; until a specific problem arises where any of the available methods falls short."}, {"owner": {"reputation": 5010, "user_id": 966823, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1ce9d71c067c0994a72ff0d1ea407697?s=128&d=identicon&r=PG&f=1", "display_name": "sprocket12", "link": "https://stackoverflow.com/users/966823/sprocket12"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1517393730, "post_id": 48538189, "comment_id": 84074286, "body": "@underscore_d I&#39;m assuming the gtk developers had some reasons for doing things in different ways and that there may be disadvantages or advantages to certain approaches"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1517393811, "post_id": 48538189, "comment_id": 84074333, "body": "I think that in the vast majority of cases, it comes down to what you need to do and whether XML definitions can suffice, and which of XML or widget code you personally prefer to write and maintain for your given use cases."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1517405956, "post_id": 48538189, "comment_id": 84082125, "body": "Assuming that the code works correctly, you might want to write up your samples in a more-complete fashion and ask for critique over at <a href=\"https://codereview.stackexchange.com\">Code Review</a>. Be sure to read <a href=\"//codereview.meta.stackexchange.com/a/5778\">A guide to Code Review for Stack Overflow users</a> first, as some things are done differently over there!"}], "answers": [{"tags": [], "owner": {"reputation": 858, "user_id": 637754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L4KrL.png?s=128&g=1", "display_name": "Governa", "link": "https://stackoverflow.com/users/637754/governa"}, "is_accepted": false, "score": 1, "last_activity_date": 1586897713, "creation_date": 1586897713, "answer_id": 61217091, "question_id": 48538189, "link": "https://stackoverflow.com/questions/48538189/what-are-advantages-of-template-based-ui-in-gtk/61217091#61217091", "title": "what are advantages of template based UI in GTK+", "body": "<p>The difference, from what I understand, is that templates+subclass can be easily reused. Doing it <em>your way\u2122</em> you would have to use multiple GtkBuilder objects and would still have problems with defining signals in the XML.</p>\n\n<p>So if you have, for example, a Dialog that you use from N different places in your code, then you should use a template.</p>\n\n<p>Also if, for example, you wish to have N copies of your main window, where N is defined by user interaction, doing it <em>your way\u2122</em> would be almost impossible.</p>\n"}], "owner": {"reputation": 5010, "user_id": 966823, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1ce9d71c067c0994a72ff0d1ea407697?s=128&d=identicon&r=PG&f=1", "display_name": "sprocket12", "link": "https://stackoverflow.com/users/966823/sprocket12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1167, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1586897713, "creation_date": 1517389235, "last_edit_date": 1592644375, "question_id": 48538189, "link": "https://stackoverflow.com/questions/48538189/what-are-advantages-of-template-based-ui-in-gtk", "title": "what are advantages of template based UI in GTK+", "body": "<p>Is there an advantage of using a &quot;Template&quot; based method in GTK+ apps? I am making my first GTK+ app, and I am finding on the internet that there are many variations of creating a GTK+ apps, some older looking methods, some newer, I looked at the GTK+ dev guide and it uses a complex looking &quot;Template&quot; with sub-classing etc. See: <a href=\"https://developer.gnome.org/gtk3/stable/ch01s04.html\" rel=\"nofollow noreferrer\">https://developer.gnome.org/gtk3/stable/ch01s04.html</a></p>\n<p>My question is am I fine doing it with my method or should I be using templates / sub-classing?</p>\n<h1>My way:</h1>\n<pre><code>&lt;interface&gt;\n  &lt;requires lib=&quot;gtk+&quot; version=&quot;3.20&quot;/&gt;\n  &lt;object class=&quot;GtkApplicationWindow&quot; id=&quot;window&quot;&gt;\n...\n\n#include &lt;gtk/gtk.h&gt;\n\nstatic void activate (GtkApplication* app, gpointer user_data) {\n  GtkBuilder *builder = gtk_builder_new_from_file (&quot;gui.glade&quot;);\n  GtkWidget *window = GTK_WIDGET (gtk_builder_get_object (builder, &quot;window&quot;));\n  gtk_builder_connect_signals (builder, NULL);\n  gtk_widget_show_all (window);\n  gtk_main ();\n}\n\nint main (int argc, char *argv[]) {\n  GtkApplication *app = gtk_application_new (&quot;a.b.c&quot;, G_APPLICATION_FLAGS_NONE);\n  g_signal_connect (app, &quot;activate&quot;, G_CALLBACK (activate), NULL);\n  int status = g_application_run (G_APPLICATION (app), argc, argv);\n  g_object_unref (app);\n  return status;\n}\n</code></pre>\n<h1>vs &quot;Template&quot; way:</h1>\n<pre><code>&lt;interface&gt;\n  &lt;requires lib=&quot;gtk+&quot; version=&quot;3.20&quot;/&gt;\n  &lt;template class=&quot;ExampleAppWindow&quot; parent=&quot;GtkApplicationWindow&quot;&gt;\n...\n\n#include &lt;gtk/gtk.h&gt;\n\n#include &quot;exampleapp.h&quot;\n#include &quot;exampleappwin.h&quot;\n\nstruct _ExampleApp\n{\n  GtkApplication parent;\n};\n\nG_DEFINE_TYPE(ExampleApp, example_app, GTK_TYPE_APPLICATION);\n\nstatic void\nexample_app_init (ExampleApp *app)\n{\n}\n\nstatic void\nexample_app_activate (GApplication *app)\n{\n  ExampleAppWindow *win;\n\n  win = example_app_window_new (EXAMPLE_APP (app));\n  gtk_window_present (GTK_WINDOW (win));\n}\n\nstatic void\nexample_app_open (GApplication  *app,\n                  GFile        **files,\n                  gint           n_files,\n                  const gchar   *hint)\n{\n  GList *windows;\n  ExampleAppWindow *win;\n  int i;\n...\n</code></pre>\n"}, {"tags": ["c", "sockets", "libevent"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 4, "creation_date": 1517388570, "post_id": 48537984, "comment_id": 84070891, "body": "<code>sizeof(s)</code> -&gt; <code>strlen(s)+1</code>"}, {"owner": {"reputation": 127, "user_id": 6264190, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9b4c8b840fb54b053523b252ed43d76f?s=128&d=identicon&r=PG&f=1", "display_name": "jojeyh", "link": "https://stackoverflow.com/users/6264190/jojeyh"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1517388924, "post_id": 48537984, "comment_id": 84071115, "body": "Brilliant. Leave a quick answer if you want me to upvote, otherwise you are most gracious and expedient sir."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1517389012, "post_id": 48537984, "comment_id": 84071179, "body": "You&#39;re welcome - sizeof/strlen confusion is a common mistake."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1517392472, "post_id": 48537984, "comment_id": 84073379, "body": "Answer now added, for any future readers..."}], "answers": [{"tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": true, "score": 2, "last_activity_date": 1517392438, "creation_date": 1517392438, "answer_id": 48539185, "question_id": 48537984, "link": "https://stackoverflow.com/questions/48537984/eventbuffer-can-only-read-8-bytes-on-input/48539185#48539185", "title": "eventbuffer can only read 8 bytes on input?", "body": "<p>You are passing the size of a pointer (which happens to be 8 on your 64-bit platform) here:</p>\n\n<pre><code>int n = send(SOCKET, s, sizeof(s), 0);\n                        ^^^^^^^^^\n</code></pre>\n\n<p>You need to instead pass the number of characters in the string (+ 1 to include the NUL terminator):</p>\n\n<pre><code>int n = send(SOCKET, s, strlen(s) + 1, 0);\n                        ^^^^^^^^^^^^^\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 6264190, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9b4c8b840fb54b053523b252ed43d76f?s=128&d=identicon&r=PG&f=1", "display_name": "jojeyh", "link": "https://stackoverflow.com/users/6264190/jojeyh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 48539185, "answer_count": 1, "score": 0, "last_activity_date": 1517392564, "creation_date": 1517388485, "last_edit_date": 1517392564, "question_id": 48537984, "link": "https://stackoverflow.com/questions/48537984/eventbuffer-can-only-read-8-bytes-on-input", "title": "eventbuffer can only read 8 bytes on input?", "body": "<p>I am working through some examples on libevent and am running into a problem with reading any string over 8 bytes from the input buffer.  I'm going between two computers on my local network.  Here is my code for the simple libevent server:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n\n#include &lt;event2/listener.h&gt;\n#include &lt;event2/bufferevent.h&gt;\n#include &lt;event2/buffer.h&gt;\n\n#define PORTNUM 8080\n\nstatic void echo_read_cb(struct bufferevent *bev, void *ctx)\n{\n    struct evbuffer *input = bufferevent_get_input(bev);\n    struct evbuffer *output = bufferevent_get_output(bev);\n\n    size_t len = evbuffer_get_length(input);\n    char *data = malloc(len);\n    evbuffer_copyout(input, data, len);\n    printf(\"We got some data: %s\\n\", data);\n    free(data);\n}\n\nstatic void echo_event_cb(struct bufferevent *bev, short events, void *ctx)\n{\n    if (events &amp; BEV_EVENT_ERROR) \n        perror(\"Error from bufferevent.\");\n    if (events &amp; (BEV_EVENT_EOF | BEV_EVENT_ERROR)) {\n        bufferevent_free(bev);\n    }\n}\n\nstatic void accept_conn_cb(struct evconnlistener *listener, \n                           evutil_socket_t fd, struct sockaddr *addr,\n                           int socklen, void *ctx)\n{\n    struct event_base *base = evconnlistener_get_base(listener);\n    struct bufferevent *bev = bufferevent_socket_new(base, fd, BEV_OPT_CLOSE_ON_FREE);\n    bufferevent_setcb(bev, echo_read_cb, NULL, echo_event_cb, NULL);\n    bufferevent_enable(bev, EV_READ|EV_WRITE);\n}\n\nstatic void accept_error_cb(struct evconnlistener *listener, void *ctx) {\n    struct event_base *base = evconnlistener_get_base(listener);\n    int err = EVUTIL_SOCKET_ERROR();\n    fprintf(stderr, \"Got an error %d (%s) on the listener. \"\n            \"Shutting down.\\n\", err, evutil_socket_error_to_string(err));\n    event_base_loopexit(base, NULL);\n}\n\nint main(int argc, char **argv)\n{\n    struct event_base *base;\n    struct evconnlistener *listener;\n    struct sockaddr_in sin;\n\n    base = event_base_new();\n    if (!base) {\n        puts(\"Couldn't open event base\\n\");\n        return 1;\n    }\n\n    memset(&amp;sin, 0, sizeof(sin));\n    sin.sin_family = AF_INET;\n    sin.sin_port = htons(PORTNUM);\n    sin.sin_addr.s_addr = htonl(INADDR_ANY);\n\n    listener = evconnlistener_new_bind(base, accept_conn_cb, NULL,\n                                       LEV_OPT_CLOSE_ON_FREE|LEV_OPT_REUSEABLE,\n                                       -1, (struct sockaddr *)&amp;sin, \n                                       sizeof(sin));\n    if (!listener) {\n        perror(\"Couldn't create listener.\\n\");\n        return 1;\n    }\n\n    evconnlistener_set_error_cb(listener, accept_error_cb);\n\n    event_base_dispatch(base);\n    return 0;\n}\n</code></pre>\n\n<p>This program continues to run while on another computer on the local network I run a simple client program using regular networking:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n\nint main()\n{\n    struct sockaddr_in serv;\n    memset(&amp;serv, 0, sizeof(serv));\n    serv.sin_family = AF_INET;\n    serv.sin_port = htons(8080);\n    inet_aton(\"192.168.1.155\", &amp;(serv.sin_addr));\n\n    int SOCKET = socket(AF_INET, SOCK_STREAM, 0);\n    connect(SOCKET, (struct sockaddr *)&amp;serv, sizeof(struct sockaddr_in));\n\n    const char *s = \"Messagefromtheclient.\";\n    int n = send(SOCKET, s, sizeof(s), 0);\n    close(SOCKET);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>I run this simple client program, which should write to the simple server made using evbuffer and output the data to <code>stdout</code>. The server writes to <code>stdout</code>: </p>\n\n<pre><code>&gt; We got some data: Messagef\n</code></pre>\n\n<p>So <code>data</code> is only 8 bytes, the rest of the string gets truncated.  Can anyone tell me why?</p>\n"}, {"tags": ["c", "openssl"], "answers": [{"tags": [], "owner": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "is_accepted": true, "score": 2, "last_activity_date": 1517399167, "creation_date": 1517399167, "answer_id": 48541395, "question_id": 48537964, "link": "https://stackoverflow.com/questions/48537964/openssl-bio-f-base64-does-not-read-the-whole-buffer/48541395#48541395", "title": "OpenSSL BIO_f_base64 does not read the whole buffer", "body": "<p>The problem is in this line:</p>\n\n<pre><code>bio = BIO_new_mem_buf(b64, -1);\n</code></pre>\n\n<p>From the man page for BIO_new_mem_buf:</p>\n\n<p><a href=\"https://www.openssl.org/docs/man1.1.0/crypto/BIO_s_mem.html\" rel=\"nofollow noreferrer\">https://www.openssl.org/docs/man1.1.0/crypto/BIO_s_mem.html</a></p>\n\n<blockquote>\n  <p>BIO_new_mem_buf() creates a memory BIO using len bytes of data at buf,\n  if len is -1 then the buf is assumed to be nul terminated and its\n  length is determined by strlen.</p>\n</blockquote>\n\n<p>But you have passed -1 and your buffer is not nul terminated! Therefore the strlen will overrun the buffer and keep going until it does find a nul terminator. This will likely include lots of values which are not valid base64, and hence the base64 decode fails.</p>\n\n<p>It appears that the behaviour of the <code>BIO_f_base64()</code> BIO is to read and return what it has successfully read, but give up trying to read any more as soon as it encounters an error - as opposed to failing the entire read. It's not clear to me whether that is intended behaviour or a bug.</p>\n\n<blockquote>\n  <p>And a more general question, how one should debug such issues with OpenSSL?</p>\n</blockquote>\n\n<p>In general you should inspect the OpenSSL error stack which usually gives good information about the source of a problem. For example by using <code>ERR_print_errors_fp()</code>:</p>\n\n<p><a href=\"https://www.openssl.org/docs/man1.1.0/crypto/ERR_print_errors_fp.html\" rel=\"nofollow noreferrer\">https://www.openssl.org/docs/man1.1.0/crypto/ERR_print_errors_fp.html</a></p>\n\n<p>Not that it would have helped in this particular issue because it seems no error is placed on the error stack for this problem.</p>\n"}], "owner": {"reputation": 113, "user_id": 9293313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c9fc919cc1c97bb80eecf0dda4201d?s=128&d=identicon&r=PG&f=1", "display_name": "0x00", "link": "https://stackoverflow.com/users/9293313/0x00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 48541395, "answer_count": 1, "score": 1, "last_activity_date": 1517399167, "creation_date": 1517388433, "question_id": 48537964, "link": "https://stackoverflow.com/questions/48537964/openssl-bio-f-base64-does-not-read-the-whole-buffer", "title": "OpenSSL BIO_f_base64 does not read the whole buffer", "body": "<p>I'm trying to read and base64-decode a file. For some reason OpenSSL reads only a part of it, then on all subsequent calls it simply returns 0. Here is the code I'm using:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include &lt;openssl/bio.h&gt;\n#include &lt;openssl/buffer.h&gt;\n#include &lt;openssl/evp.h&gt;\n\nsize_t b64_get_datalen(const char* b64, size_t b64len) {\n    size_t actual_len = 0;\n    int padding = 0;\n\n    for (int i = 0; i &lt; b64len; i++) {\n        if (b64[i] != '\\n') actual_len++;\n    }\n\n    int last = b64len-1;\n    if (b64[last] == '\\n') {\n        last--;\n    }\n    if (b64[last] == '=') {\n        padding = b64[last-1] == '=' ? 2 : 1;\n    }\n\n    return (actual_len*3)/4 - padding;\n}\n\n\nint main(int argc, char** argv) {\n    FILE* fp = fopen(\"7.txt\", \"r\");\n    if (fp == NULL) {\n        perror(\"fopen\");\n        exit(EXIT_FAILURE);\n    }\n\n    fseek(fp, 0, SEEK_END);\n    size_t b64_len = ftell(fp);\n    rewind(fp);\n\n    char b64[b64_len];\n    fread(b64, b64_len, 1, fp);\n    fclose(fp);\n\n    size_t data_len = b64_get_datalen(b64, b64_len);\n    char data[data_len];\n\n    BIO *bio, *base64;\n    base64 = BIO_new(BIO_f_base64());\n    bio = BIO_new_mem_buf(b64, -1);\n    bio = BIO_push(base64, bio);\n\n    int read = BIO_read(bio, data, b64_len);\n    printf(\"expected %d bytes, got %d bytes\\n\", (int)data_len, (int)read);\n    BIO_free_all(bio);\n}\n</code></pre>\n\n<p>The program outputs: <code>expected 2880 bytes, got 2244 bytes</code></p>\n\n<p>The file I'm trying to read is from cryptopals challenges (<a href=\"http://cryptopals.com/static/challenge-data/7.txt\" rel=\"nofollow noreferrer\">http://cryptopals.com/static/challenge-data/7.txt</a>). I solved that challenge in Python, there were no issues with reading and base64-decoding the file.</p>\n\n<p>What can be a reason of such behavior? And a more general question, how one should debug such issues with OpenSSL?</p>\n"}, {"tags": ["c", "string", "unicode", "char"], "comments": [{"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 2, "creation_date": 1517388241, "post_id": 48537793, "comment_id": 84070691, "body": "You seem to be confused. UTF-8 <i>is</i> Unicode. Which other Unicode representation do you hope to convert it to? Maybe see also <a href=\"https://www.joelonsoftware.com/2003/10/08/the-absolute-minimum-every-software-developer-absolutely-positively-must-know-about-unicode-and-character-sets-no-excuses/\" rel=\"nofollow noreferrer\">joelonsoftware.com/2003/10/08/&hellip;</a> and <a href=\"http://utf8everywhere.com\" rel=\"nofollow noreferrer\">utf8everywhere.com</a>"}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1517388354, "post_id": 48537793, "comment_id": 84070760, "body": "... But most probably the answer is <i>You don&#39;t need to write any code at all.</i> You just need to understand what it is you&#39;re looking at."}, {"owner": {"reputation": 19, "user_id": 4850376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7c6c8539211be7903ebf68d1b9df53?s=128&d=identicon&r=PG&f=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/4850376/pavan"}, "reply_to_user": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1517388427, "post_id": 48537793, "comment_id": 84070800, "body": "@tripleee I would like to convert the displayed string from &quot;\\xE6\\xAC\\xA2\\xE8\\xBF\\x8E&quot; to &quot;\u6b22\u8fce&quot;"}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1517388538, "post_id": 48537793, "comment_id": 84070882, "body": "So <code>perl -pe &#39;s&#47;\\\\x(\\X{2})&#47;chr(hex(&quot;0x$1&quot;))&#47;ge&#39; &lt;&lt;&lt;&#39;\\xE6\\xAC\\xA2\\xE8\\xBF\\x8E&#39;</code> basically? Is there a particular reason you want to reinvent this in C?"}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1517388630, "post_id": 48537793, "comment_id": 84070932, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10770257/c-programming-convert-hex-int-to-char\">C Programming: Convert Hex Int to Char*</a>"}, {"owner": {"reputation": 19, "user_id": 4850376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7c6c8539211be7903ebf68d1b9df53?s=128&d=identicon&r=PG&f=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/4850376/pavan"}, "reply_to_user": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1517389862, "post_id": 48537793, "comment_id": 84071679, "body": "@tripleee Thanks for the pointer in perl. My application is in C. So I need to find out a way to get this done in C only"}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 1, "creation_date": 1517391156, "post_id": 48537793, "comment_id": 84072488, "body": "The proposed duplicate shows how to parse \\xXX in C. There is nothing really about Unicode here."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517415700, "post_id": 48537793, "comment_id": 84089239, "body": "Aside: Why code <code>fgets(str, MAX, fptr1);             if (!feof(fptr1))</code> instead of <code>if(fgets(str, MAX, fptr1))</code>?  The 2nd is more idiomatic and catches rare read error too."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1517425583, "post_id": 48537793, "comment_id": 84095279, "body": "@tripleee It seems to me that the proposed duplicate does just the opposite, conversion from integer to ascii, no?"}], "answers": [{"tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": false, "score": 0, "last_activity_date": 1517425931, "creation_date": 1517425931, "answer_id": 48549754, "question_id": 48537793, "link": "https://stackoverflow.com/questions/48537793/convert-unicoded-string-to-corresponding-string-in-c/48549754#48549754", "title": "Convert unicoded string to corresponding string in C", "body": "<p>You'd have to identify the <code>\\x</code> positions in your line, say pointer <code>p</code> then points to the next character. Now</p>\n\n<pre><code>char hex[3] = { p[0], p[1], 0 }; \nchar val = strtoul(hex, 0, 16);\np += 2;\n</code></pre>\n\n<p>will return the value of the following two bytes interpreted in hex in <code>val</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1517806603, "post_id": 48615953, "comment_id": 84229022, "body": "this is overkill. if you want to unescape a literal string containing hex values then just remove the escape string <code>\\x</code> then convert those hex to bytes and print directly. Don&#39;t you know how to convert from hex to binary?"}], "tags": [], "owner": {"reputation": 19, "user_id": 4850376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7c6c8539211be7903ebf68d1b9df53?s=128&d=identicon&r=PG&f=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/4850376/pavan"}, "is_accepted": false, "score": 0, "last_activity_date": 1517805533, "creation_date": 1517805533, "answer_id": 48615953, "question_id": 48537793, "link": "https://stackoverflow.com/questions/48537793/convert-unicoded-string-to-corresponding-string-in-c/48615953#48615953", "title": "Convert unicoded string to corresponding string in C", "body": "<p>I was able to get the conversion done. Below is my final code</p>\n\n<pre><code>                if(strstr(str,\"\\\\\")!=NULL)\n                {\n                    memset(str2,'\\0',sizeof(str2));\n                    printf(\"Input String Contains Unicode Character\\n\");                    \n                    str[strlen(str)-1]='\\0';\n\n\n                    sprintf(str2,\"echo %s | sed \\'s/[\\\\\\\\x]//g\\' | xxd -r -p &gt;&gt; data.txt\",str);\n                    printf(\"Final String: %s\\nUnicode String Size: %ld\\n\",str2,strlen(str));\n                    system(str2);\n                }\n</code></pre>\n\n<p>Thanks for all your response and thanks @chux for your pointer</p>\n"}], "owner": {"reputation": 19, "user_id": 4850376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7c6c8539211be7903ebf68d1b9df53?s=128&d=identicon&r=PG&f=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/4850376/pavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1517805533, "creation_date": 1517387864, "question_id": 48537793, "link": "https://stackoverflow.com/questions/48537793/convert-unicoded-string-to-corresponding-string-in-c", "title": "Convert unicoded string to corresponding string in C", "body": "<p>I need to convert a unicoded string to its appropriate language. I need to read from a text file line by line. There is a possibility that a line may contain a unicode some thing like this </p>\n\n<blockquote>\n  <p>\\xE6\\xAC\\xA2\\xE8\\xBF\\x8E</p>\n</blockquote>\n\n<p>This is basically a chinese text which is equal to </p>\n\n<blockquote>\n  <p>\u6b22\u8fce</p>\n</blockquote>\n\n<p>Now I need to remove this line (\\xE6\\xAC\\xA2\\xE8\\xBF\\x8E) from text file, convert this unicode to chinese text, append this chinese text to the text file.</p>\n\n<p>Below is the content of my data.txt file:</p>\n\n<pre><code>testing\nprogramming\n\\xE6\\xAC\\xA2\\xE8\\xBF\\x8E\ndevelopment\n</code></pre>\n\n<p>I would like to get the file content as:</p>\n\n<pre><code>testing\nprogramming\ndevelopment\n\u6b22\u8fce\n</code></pre>\n\n<p>Below is what I have done so far</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n\n#define MAX 256\n\n  int main() \n  {\n        int ctr = 0;\n        char ch;\n        FILE *fptr1, *fptr2;\n        char fname[MAX] = \"data.txt\";\n        char str[MAX], temp[] = \"temp.txt\";\n        char str2[256];\n\n        fptr1 = fopen(fname, \"r\");\n        if (!fptr1) \n        {\n                printf(\" File not found or unable to open the input file!!\\n\");\n                return 0;\n        }\n        fptr2 = fopen(temp, \"w\"); // open the temporary file in write mode \n        if (!fptr2) \n        {\n                printf(\"Unable to open a temporary file to write!!\\n\");\n                fclose(fptr1);\n                return 0;\n        }\n\n        // copy all contents to the temporary file except the specific line with unicode characters\n        while (!feof(fptr1)) \n        {\n            strcpy(str, \"\\0\");\n            fgets(str, MAX, fptr1);\n            if (!feof(fptr1)) \n            {\n                ctr++;\n                if(strstr(str,\"\\\\\")!=NULL)\n                {\n                    memset(str2,'\\0',sizeof(str2));\n                    printf(\"Input String Contains Unicode Character\\n\");                    \n                    str[strlen(str)-1]='\\0';\n\n                    sprintf(str2,\"echo %s &gt;&gt; data.txt\",str);\n                    printf(\"Final String: %s\\nUnicode String Size: %ld\\n\",str2,strlen(str));\n                    system(str2);\n                }\n                else\n                {\n\n                    fprintf(fptr2, \"%s\", str);                  \n                }\n            }\n        }\n        fclose(fptr1);\n        fclose(fptr2);\n        remove(fname);          // remove the original file \n        rename(temp, fname);    // rename the temporary file to original name\n/*------ Read the file ----------------*/\n   fptr1=fopen(fname,\"r\"); \n            ch=fgetc(fptr1); \n          printf(\" Now the content of the file %s is : \\n\",fname); \n          while(ch!=EOF) \n            { \n                printf(\"%c\",ch); \n                 ch=fgetc(fptr1); \n            }\n        fclose(fptr1);\n/*------- End of reading ---------------*/\n        return 0;\n\n  } \n</code></pre>\n\n<p>When tried to compile and run this code, below is the output I am seeing</p>\n\n<pre><code>Input String Contains Unicode Character\nFinal String: echo \\xE6\\xAC\\xA2\\xE8\\xBF\\x8E &gt;&gt; data.txt\nUnicode String Size: 24\n Now the content of the file data.txt is : \ntesting\nprogramming\ndevelopment\nxE6xACxA2xE8xBFx8E\n</code></pre>\n\n<p>The same code when changed the below lines, it was working as expected</p>\n\n<pre><code> sprintf(str2,\"echo %s &gt;&gt; data.txt\",str); \n sprintf(str2,\"echo %s &gt;&gt; data.txt\",\"\\xE6\\xAC\\xA2\\xE8\\xBF\\x8E\");\n</code></pre>\n\n<p>But when the value is read from file it was not working.</p>\n\n<p>Also this line, the string is identified as unicode string with correct size</p>\n\n<pre><code>printf(\"Final String: %s\\nUnicode String Size: %ld\\n\",str2,strlen(str));\nThe String Size: 6\n</code></pre>\n\n<p>Can some one please let me know, how to convert the value to chinese when read from text file.</p>\n"}, {"tags": ["c", "structure", "fwrite"], "comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 1, "creation_date": 1517385387, "post_id": 48537123, "comment_id": 84069175, "body": "main() is deprecated. Use int main(void)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517386158, "post_id": 48537123, "comment_id": 84069594, "body": "<code>main()</code> alone is invalid C according to the standard since C99 was finalized.  Some compilers let it through without comment; others pass comments on it (issue warnings).  You should set your compiler to reject it."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517386223, "post_id": 48537123, "comment_id": 84069626, "body": "Since you write binary data to disk for the two numbers, it is not surprising that you read binary data from disk when you view what you wrote.  You need to convert to strings before writing \u2014 probably using <code>fprintf()</code>."}, {"owner": {"reputation": 136, "user_id": 4066927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wkrQa.jpg?s=128&g=1", "display_name": "Anudeepsyamprasad", "link": "https://stackoverflow.com/users/4066927/anudeepsyamprasad"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1517386255, "post_id": 48537123, "comment_id": 84069646, "body": "@machine_1 That&#39;s not my exact question. Please read and answer bro. Try to solve my problem."}, {"owner": {"reputation": 136, "user_id": 4066927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wkrQa.jpg?s=128&g=1", "display_name": "Anudeepsyamprasad", "link": "https://stackoverflow.com/users/4066927/anudeepsyamprasad"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517387836, "post_id": 48537123, "comment_id": 84070473, "body": "@JonathanLeffler Yah it&#39;s working with fprintf() function. Is there any possibility to solve this by using different file functions?"}], "answers": [{"comments": [{"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1517385970, "post_id": 48537184, "comment_id": 84069499, "body": "@machine_1 I dont want to do the work for the OP. I am sure they can learn how to add one extra item. It should hopefully teach them about format specifiers as well."}, {"owner": {"reputation": 136, "user_id": 4066927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wkrQa.jpg?s=128&g=1", "display_name": "Anudeepsyamprasad", "link": "https://stackoverflow.com/users/4066927/anudeepsyamprasad"}, "edited": false, "score": 0, "creation_date": 1517386052, "post_id": 48537184, "comment_id": 84069544, "body": "Can you elaborate this? I&#39;m trying to open .dat file from folder to check inserted data. After opening, it &#39;s showing numbers like binary form but I&#39;m storing the whole record combined with chars and integers but I&#39;m unable to read it while opening the filer."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 136, "user_id": 4066927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wkrQa.jpg?s=128&g=1", "display_name": "Anudeepsyamprasad", "link": "https://stackoverflow.com/users/4066927/anudeepsyamprasad"}, "edited": false, "score": 0, "creation_date": 1517386383, "post_id": 48537184, "comment_id": 84069708, "body": "@AnudeepSyamPrasad Did you read the answer? You are writing binary data to a file. Why do you expect to read something other than binary data when you open that file?"}, {"owner": {"reputation": 136, "user_id": 4066927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wkrQa.jpg?s=128&g=1", "display_name": "Anudeepsyamprasad", "link": "https://stackoverflow.com/users/4066927/anudeepsyamprasad"}, "edited": false, "score": 0, "creation_date": 1517387321, "post_id": 48537184, "comment_id": 84070213, "body": "@FantasticMrFox Can&#39;t we do this without using fprintf() statement. I mean using fwrite() function.  Your answer solved my problem but I want to know with fwrite()."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 136, "user_id": 4066927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wkrQa.jpg?s=128&g=1", "display_name": "Anudeepsyamprasad", "link": "https://stackoverflow.com/users/4066927/anudeepsyamprasad"}, "edited": false, "score": 1, "creation_date": 1517387595, "post_id": 48537184, "comment_id": 84070348, "body": "@Anudeep No you can&#39;t. fwrite() cannot format data."}], "tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": true, "score": 3, "last_activity_date": 1517385389, "creation_date": 1517385389, "answer_id": 48537184, "question_id": 48537123, "link": "https://stackoverflow.com/questions/48537123/why-cant-i-see-structure-inserted-record-from-files-while-opening-it-in-editor/48537184#48537184", "title": "Why can&#39;t I see structure inserted record from files while opening it in editor?", "body": "<p>This is because you are using <code>fwrite</code> which writes a binary stream of the data you give it. <a href=\"https://linux.die.net/man/3/fwrite\" rel=\"nofollow noreferrer\">See here.</a> You should use something like <code>fprintf</code> instead:</p>\n\n<pre><code>fprintf(file, \"CustomerName: %s\\nCIF Number: %s\", bank.customer_name, bank.cif_no);\n</code></pre>\n\n<p><a href=\"https://linux.die.net/man/3/fprintf\" rel=\"nofollow noreferrer\">man <code>fprintf</code></a></p>\n"}], "owner": {"reputation": 136, "user_id": 4066927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wkrQa.jpg?s=128&g=1", "display_name": "Anudeepsyamprasad", "link": "https://stackoverflow.com/users/4066927/anudeepsyamprasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 48537184, "answer_count": 1, "score": 1, "last_activity_date": 1517385442, "creation_date": 1517385159, "last_edit_date": 1517385442, "question_id": 48537123, "link": "https://stackoverflow.com/questions/48537123/why-cant-i-see-structure-inserted-record-from-files-while-opening-it-in-editor", "title": "Why can&#39;t I see structure inserted record from files while opening it in editor?", "body": "<p>I have a problem with structure handling in C files. Here I wrote this programme to save bank customer record into the file. It's working fine but when I'm trying to open the data file[.txt (or).dat].It's showing some binary digits. Below is my programme.</p>\n\n<pre><code>/* Reading bank details and saving it on a file and printing it on \nscreen*/\n#include &lt;stdio.h&gt;\n\n//Declaring a structure\nstruct bank_details\n {\n  char customer_name[20];\n  char cif_no[10];\n  int ac_no,pincode;\n };\n\nmain()\n{\nstruct bank_details bank;\nFILE *file;\nfile= fopen(\"bank_file.dat\", \"w\");\nprintf(\"Enter A/no:\\n\");\nscanf(\"%d\",&amp;bank.ac_no);\nprintf(\"Enter customer name:\\n\");\nscanf(\"%s\",bank.customer_name);\nprintf(\"Enter CIF no:\\n\");\nscanf(\"%s\",bank.cif_no);\nprintf(\"Enter your PINCODE:\\n\");\nscanf(\"%d\",&amp;bank.pincode);\n\nfwrite(&amp;bank, sizeof(bank), 1, file);\nif (file!=0)\n{\n    printf(\"Data successfully updated into file\\n\");\n}\n\nfclose(file);\n}\n</code></pre>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1517385155, "post_id": 48537078, "comment_id": 84069058, "body": "What do you mean by <i>&quot;declare it as a variable but not as a constant&quot;</i>?"}, {"owner": {"reputation": 269, "user_id": 4248226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/672e6d1e5eb828268b34179c64108b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Diabolus", "link": "https://stackoverflow.com/users/4248226/diabolus"}, "edited": false, "score": 4, "creation_date": 1517385165, "post_id": 48537078, "comment_id": 84069063, "body": "Why do you need this ?"}, {"owner": {"reputation": 134, "user_id": 6915174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BUmUa.jpg?s=128&g=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/6915174/peter-k"}, "edited": false, "score": 0, "creation_date": 1517385403, "post_id": 48537078, "comment_id": 84069181, "body": "&#39;as a variable&#39; means something like <code>{int a=1}</code>, not like just <code>{1}</code>. Sorry if I ask stupid questions."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 2, "creation_date": 1517385437, "post_id": 48537078, "comment_id": 84069209, "body": "What is the purpose of doing this? I fail to see what advantage this has over <code>int a = 1; foo(&amp;a);</code>"}, {"owner": {"reputation": 134, "user_id": 6915174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BUmUa.jpg?s=128&g=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/6915174/peter-k"}, "edited": false, "score": 0, "creation_date": 1517385670, "post_id": 48537078, "comment_id": 84069329, "body": "I need this by 2 reasons. First - in my project I need to call API function from macros and pass pointer to variable that I really do not use. And to simplify macros I prefer to write all in one line without complex solutions like <code>#define CALL_FOO() do {int a=1; foo(&amp;a);}while(0)</code> Second reason - I would like to understand better how compiler works. I have seen such solution preciously in internet, just cannot remind the syntax and cannot find it again. And knowing the solution will bring me better understanding how compiler understands <code>{}</code> and variables visability"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1517385879, "post_id": 48537078, "comment_id": 84069438, "body": "Again, what purpose to you envision that <code>a</code> having, assuming you could declare it?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1517385969, "post_id": 48537078, "comment_id": 84069497, "body": "@PeterK.: It&#39;s possible you&#39;re after something called <i>statement expressions</i> which is a gcc extension. See <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html</a>. It&#39;s not standard C though."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1517386139, "post_id": 48537078, "comment_id": 84069583, "body": "@Bathsheba - Keeping my fingers crossed for C20 :)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1517386609, "post_id": 48537078, "comment_id": 84069828, "body": "Since you know about the compound literal notation, and your <code>&amp;(int){int a = 1}</code> notation seems to be trying to use it too, it isn&#39;t clear what you&#39;re hoping for.  You can&#39;t define a variable name inside the compound literal.  It really isn&#39;t clear what you&#39;re asking for."}], "answers": [{"comments": [{"owner": {"reputation": 134, "user_id": 6915174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BUmUa.jpg?s=128&g=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/6915174/peter-k"}, "edited": false, "score": 0, "creation_date": 1517405835, "post_id": 48542699, "comment_id": 84082034, "body": "Yes, this variant works (as in description). And sorry - I&#39;ve used wrong terms. You are correct - <code>{1}</code> here is not a &quot;constant&quot; - as I understoot it is just a variable on stack that has no name. My question was how to give a name to this variable. If I try to set <code>{int a=1}</code> instead of just <code>{1}</code> the gcc prints error. I just do not understand how compiler treat this construction and why does it suppose it as an error."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 134, "user_id": 6915174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BUmUa.jpg?s=128&g=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/6915174/peter-k"}, "edited": false, "score": 0, "creation_date": 1517412249, "post_id": 48542699, "comment_id": 84086809, "body": "@PeterK. Why on earth do you need to <i>name</i> a variable, when in this case <b>the name is only useful from the point where the variable is created until the function is called</b>? Once inside a function, the variable name is that of the pointer parameter. Your explanation about writing all of this in comments doesn&#39;t make sense. This is an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a> if I ever saw one."}, {"owner": {"reputation": 134, "user_id": 6915174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BUmUa.jpg?s=128&g=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/6915174/peter-k"}, "edited": false, "score": 0, "creation_date": 1517471031, "post_id": 48542699, "comment_id": 84110994, "body": "ok, accept this answer (even having it in my initial comment) because it actually resolve my request &#39;to have declaration inside argument&#39;. Again, I would like to understand why compiler suppose that <code>{int a=1}</code> and just <code>{1}</code> are different."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 3, "last_activity_date": 1517403195, "creation_date": 1517403195, "answer_id": 48542699, "question_id": 48537078, "link": "https://stackoverflow.com/questions/48537078/how-to-declare-variable-in-function-arguments/48542699#48542699", "title": "How to declare variable in function arguments", "body": "<p>You can use compound literal - I suspect that's what you tried, you almost got it right:</p>\n\n<pre><code>foo (&amp;(int){1});\n</code></pre>\n\n<p>This is by no means a \"constant\", I don't know how you got that idea.</p>\n\n<p>Note that a compound literal only have local (\"automatic\") storage duration - if the calling block goes out of scope, so does the compound literal.</p>\n"}], "owner": {"reputation": 134, "user_id": 6915174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BUmUa.jpg?s=128&g=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/6915174/peter-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 48542699, "answer_count": 1, "score": 0, "last_activity_date": 1517471199, "creation_date": 1517384987, "last_edit_date": 1517471199, "question_id": 48537078, "link": "https://stackoverflow.com/questions/48537078/how-to-declare-variable-in-function-arguments", "title": "How to declare variable in function arguments", "body": "<p>I need to declare a variable inside function arguments. Please advice the syntax to use?</p>\n\n<p>I've got something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint foo (int *a)\n{\n   printf (\"%d\\n\", *a);\n}\n\nint main (void)\n{\n   foo (&amp;(int){int a=1});\n   return 0;\n}\n</code></pre>\n\n<p>And GCC fails with the message:</p>\n\n<pre><code>$ gcc a.c\na.c: In function 'main':\na.c:10: error: expected expression before '{' token\n</code></pre>\n\n<p>As an option I can put use not named variable like this (<a href=\"https://ru.stackoverflow.com/a/777826/221676\">same question at russian version of Stack Overflow</a>):</p>\n\n<pre><code>foo(&amp;(int) { 1 });\n</code></pre>\n\n<p>and it works, but it is interesting why compiler accept <code>{1}</code> but does not accept <code>{int a=1}</code></p>\n"}, {"tags": ["c", "pointers", "memory-management", "struct"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517382678, "post_id": 48536257, "comment_id": 84067919, "body": "The only problem is the memory leak.  Since you&#39;re about to exit, that isn&#39;t a major problem in this context, but in general, memory leakage is a problem, especially in long-running programs."}, {"owner": {"reputation": 2145, "user_id": 4849573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/096fb4358973b1d406f85d2b0eeec9c2?s=128&d=identicon&r=PG&f=1", "display_name": "ckruczek", "link": "https://stackoverflow.com/users/4849573/ckruczek"}, "edited": false, "score": 0, "creation_date": 1517384612, "post_id": 48536257, "comment_id": 84068802, "body": "Everything is fine, just dont forget to <code>free</code> the pointer at the appropriate location, e.g. before exiting the main function."}], "answers": [{"comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1517383336, "post_id": 48536286, "comment_id": 84068217, "body": "It would be great to leave a comment pointing what I did wrong?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1517384471, "post_id": 48536286, "comment_id": 84068734, "body": "I didn&#39;t downvote but <i>&quot;memory on heap and it has static storage duration&quot;</i> seems like an abuse of formal terminology."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1517384518, "post_id": 48536286, "comment_id": 84068755, "body": "@StoryTeller; I didn&#39;t get it. Could you please elaborate?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1517384606, "post_id": 48536286, "comment_id": 84068798, "body": "I&#39;m talking about messing up this bit in <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.4p1\" rel=\"nofollow noreferrer\">n1570</a>. I think you misspoke meant allocated storage duration, perhaps?"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1517384840, "post_id": 48536286, "comment_id": 84068897, "body": "@StoryTeller; I mean that memory allocated dynamically (on heap) has static storage duration.  I might have wrong wordings for it. I fixed it now."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1517385040, "post_id": 48536286, "comment_id": 84069010, "body": "I get what you mean now. Though to be frank, I think it would be better to explain it in another sentence or two instead of overloading a formal term. Just my two cents. +1 anyway"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1517386919, "post_id": 48536286, "comment_id": 84069986, "body": "@StoryTeller; Than you. I improved the answer."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 2, "last_activity_date": 1517386877, "last_edit_date": 1517386877, "creation_date": 1517381981, "answer_id": 48536286, "question_id": 48536257, "link": "https://stackoverflow.com/questions/48536257/function-returning-an-instance-of-struct/48536286#48536286", "title": "function returning an instance of struct", "body": "<p><code>malloc</code> allocates memory on heap. Objects allocated on heap has static storage duration. It is valid to return a pointer from a function to an object allocated by <code>malloc</code>.  </p>\n\n<p>Note that the empty struct you are using is not standard C. GCC provide this feature as an extension.</p>\n"}, {"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 3, "last_activity_date": 1517382618, "last_edit_date": 1517382618, "creation_date": 1517381989, "answer_id": 48536291, "question_id": 48536257, "link": "https://stackoverflow.com/questions/48536257/function-returning-an-instance-of-struct/48536291#48536291", "title": "function returning an instance of struct", "body": "<p>C structure must contain at least one member as per standard, but gcc allows it as an extension.</p>\n\n<p>And what you did is legal - you can return pointer to dynamically allocated memory and use it in other function.</p>\n\n<p>Memory allocated by <code>malloc</code> has storage duration (allocated storage duration) beyond the scope on which it is declared. You can use it without any problem. </p>\n\n<p>It's expected that you would free the allocated memory and check the return value of <code>malloc</code> (saves you from dereferencing null in case of failure).</p>\n\n<p>Standard N1570 C11 standard also mentions it under <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.22.3\" rel=\"nofollow noreferrer\">\u00a77.22.3</a> memory management functions:</p>\n\n<blockquote>\n  <p>....<em>The lifetime of an allocated object extends from the allocation until the deallocation</em>. </p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 2, "last_activity_date": 1517383154, "creation_date": 1517383154, "answer_id": 48536598, "question_id": 48536257, "link": "https://stackoverflow.com/questions/48536257/function-returning-an-instance-of-struct/48536598#48536598", "title": "function returning an instance of struct", "body": "<p>You have two ways to return a struct from a function:</p>\n\n<ol>\n<li><p>return a pointer to a dynamically allocated struct (your example code)</p>\n\n<p>The lifetime of a dynamically allocated object extends until it is de-allocated, so the caller will be able to use it. Simply you must not forget to free it when you no longer need it. Not doing so is called a memory leak. So a fixed version should be:</p>\n\n<pre><code>struct Temp {\n    int i;          // a struct should not be empty...\n};\n\nstruct Temp *newTemp() {\n    struct Temp *temp = malloc(sizeof(struct Temp));\n    return temp;\n}\n\nint main() {\n    struct Temp *temp = newTemp(); // any problem?\n    // use temp...\n    free(temp);\n    return 0;\n}\n</code></pre></li>\n<li><p>return a temporary object</p>\n\n<p>A struct is a first class object in C, so you can directly assign to it. You can then build a struct in a function and return it (beware: returning a pointer to it would actually return a dangling pointer because lifetime would end when function returns). So an alternate way is:</p>\n\n<pre><code>struct Temp {\n    int i;          // a struct should not be empty...\n};\n\nstruct Temp newTemp() {\n    struct Temp temp;\n    // set values of temp members...\n    return temp;\n}\n\nint main() {\n    struct Temp temp = newTemp(); // no problem?\n    // use temp...\n    return 0;\n}\n</code></pre>\n\n<p>The good news here is that the struct is an automatic object in the caller, so it has not to (and shall not) be free-d. And <em>decent</em> compilers can even <em>elide</em> the copy by having the callee to directly use the caller automatic storage.</p></li>\n</ol>\n"}], "owner": {"reputation": 943, "user_id": 9286380, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f01ad17d463071ab90d001330159fb19?s=128&d=identicon&r=PG&f=1", "display_name": "App2015", "link": "https://stackoverflow.com/users/9286380/app2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 48536291, "answer_count": 3, "score": 1, "last_activity_date": 1517386877, "creation_date": 1517381874, "question_id": 48536257, "link": "https://stackoverflow.com/questions/48536257/function-returning-an-instance-of-struct", "title": "function returning an instance of struct", "body": "<pre><code>struct Temp {};\n\nstruct Temp *newTemp() {\n    struct Temp *temp = malloc(sizeof(struct Temp));\n    return temp;\n}\n\n\nint main() {\n    struct Temp *temp = newTemp(); // any problem?\n    return 0;\n}\n</code></pre>\n\n<p>Is there any problem with returning an instance of a struct from inside the function (factory method).</p>\n\n<p>Will the pointer will be invalid. I was suggested that if you return a pointer it should point to something on the caller's stack, a global, or something on the heap </p>\n"}, {"tags": ["c", "authentication", "login", "passwords", "user-input"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1517381766, "post_id": 48536203, "comment_id": 84067487, "body": "Welcome to stackoverflow.com. Please take some time to read <a href=\"http://stackoverflow.com/help\">the help pages</a>, especially the sections named <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. Also please <a href=\"http://stackoverflow.com/tour\">take the tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>. Lastly please learn how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>."}, {"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1517381839, "post_id": 48536203, "comment_id": 84067525, "body": "Your requirement is quite vague. You are saying you don&#39;t even want to store the password temporarily (in a variable) while the program is running! And even though you don&#39;t want the user to input the password for subsequent access of journal, My question is if user inputs the password and you don&#39;t want to store it in variable then what is the use of prompting for password in the first place."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 2, "creation_date": 1517381924, "post_id": 48536203, "comment_id": 84067580, "body": "You can store a salted hash of the password (like in Unix <a href=\"https://en.wikipedia.org/wiki/Passwd#Shadow_file\" rel=\"nofollow noreferrer\">shadow file</a>) in which case it can only be cracked by trial and error, or you can use the password to <a href=\"https://en.wikipedia.org/wiki/Encryption\" rel=\"nofollow noreferrer\">encrypt</a> the entire journal."}, {"owner": {"reputation": 1, "user_id": 8968323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01816e1c62f8745453761e4087fd0a6?s=128&d=identicon&r=PG&f=1", "display_name": "Isha", "link": "https://stackoverflow.com/users/8968323/isha"}, "reply_to_user": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1517381979, "post_id": 48536203, "comment_id": 84067609, "body": "Ah my bad @Gaurav. I want to store the password in the program on a long term basis and the only ways I can think of right now, are: Storing in an external file or simply setting a pre-made password which the user cannot change. Just started programming recently so please bear with me haha"}, {"owner": {"reputation": 1, "user_id": 8968323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01816e1c62f8745453761e4087fd0a6?s=128&d=identicon&r=PG&f=1", "display_name": "Isha", "link": "https://stackoverflow.com/users/8968323/isha"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1517382083, "post_id": 48536203, "comment_id": 84067656, "body": "@NominalAnimal I&#39;ll check it out thanks."}, {"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1517382109, "post_id": 48536203, "comment_id": 84067672, "body": "So as per @NominalAnimal suggested you can encrypt the password and when you want to access the information where password is required you can decrypt it and supply it to the desired entity."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 3, "creation_date": 1517382251, "post_id": 48536203, "comment_id": 84067743, "body": "Actually, @Gaurav, hashing is logically very different. Although encryption works as you described, with hashing, the idea is that only the user has the plaintext password. Whatever the user supplies, is salted with the same salt as the stored hash was; and if the resulting hash matches the stored hash exactly, <i>then</i> we know the user supplied the same password as was used to calculate the original hash. In particular, with hashes, we never compare plain text passwords; only their correctly salted hashes."}], "answers": [{"comments": [{"owner": {"reputation": 1051, "user_id": 263879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f720786ef4b2ff5b4b260ccd64b1bf96?s=128&d=identicon&r=PG", "display_name": "Royce Williams", "link": "https://stackoverflow.com/users/263879/royce-williams"}, "edited": false, "score": 0, "creation_date": 1517462220, "post_id": 48542451, "comment_id": 84107676, "body": "100% concur. For selecting the hash, choose a slow hash, salted with a large salt. A hash like bcrypt (<a href=\"http://www.openwall.com/crypt/\" rel=\"nofollow noreferrer\">openwall.com/crypt</a>, using work factor of 12 or so), would be OK and familiar to other developers.  argon2i (<a href=\"https://github.com/P-H-C/phc-winner-argon2/blob/master/src/argon2.c\" rel=\"nofollow noreferrer\">github.com/P-H-C/phc-winner-argon2/blob/master/src/argon2.c</a>&zwnj;&#8203;) is a very solid modern choice, but may be less prevalent (and interestingly, not yet supported by hashcat, so might be harder to attack by lower-skill attackers, though John the Ripper does support attacking it)."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1517402375, "creation_date": 1517402375, "answer_id": 48542451, "question_id": 48536203, "link": "https://stackoverflow.com/questions/48536203/how-to-store-passwords-in-a-c-program-for-future-use-without-writing-to-external/48542451#48542451", "title": "How to store passwords in a C program for future use without writing to external file?", "body": "<p>The solution that standard C provides for storing data for future use is files. That is why they exist, and there is no reasonable alternative. C does not keep any of your program\u2019s internal data from run to run. You need to use files for that.</p>\n\n<p>It is not necessary to store the password itself in a file. You can store a <a href=\"https://en.m.wikipedia.org/wiki/Hash_function\" rel=\"nofollow noreferrer\">hash</a> of the password. A hash is a function that converts some input, such as a string, to another value in a way such that it is hard to figure out an input that produces a specific value. Thus, if somebody learns the stored hash value, it is hard for them to figure out the password.</p>\n\n<p>So, when the user sets a new password, your program would compute the hash of the password and store the hash in a file. When checking a password, your program would read a password entered by the user, compute the hash of it, and compare that hash to the one stored in the file.</p>\n\n<p>Selecting, implementing, and using hash functions is a broad and complicated topic.</p>\n"}], "owner": {"reputation": 1, "user_id": 8968323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01816e1c62f8745453761e4087fd0a6?s=128&d=identicon&r=PG&f=1", "display_name": "Isha", "link": "https://stackoverflow.com/users/8968323/isha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1376, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1517402375, "creation_date": 1517381619, "last_edit_date": 1517381912, "question_id": 48536203, "link": "https://stackoverflow.com/questions/48536203/how-to-store-passwords-in-a-c-program-for-future-use-without-writing-to-external", "title": "How to store passwords in a C program for future use without writing to external file?", "body": "<p>I have currently started coding an electronic journal that is password protected. The user inputs one in (when they first use the program) and then the same password can be used to access records. </p>\n\n<p><strong>How to do this without writing the password into a file? I want the program to work every time using the same password.*?</strong></p>\n"}, {"tags": ["c", "sdl-2"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1517381507, "post_id": 48536115, "comment_id": 84067372, "body": "So what do you see instead? White screen, black screen, blue screen, dancing piglets?"}, {"owner": {"reputation": 49, "user_id": 8751232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9761f85599589f9942c1e70656067f?s=128&d=identicon&r=PG", "display_name": "user8751232", "link": "https://stackoverflow.com/users/8751232/user8751232"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1517381554, "post_id": 48536115, "comment_id": 84067393, "body": "I see all White Screen"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1517381606, "post_id": 48536115, "comment_id": 84067413, "body": "You draw a white pixel on white background and see a white screen. How do you know that the pixel was not drawn?"}, {"owner": {"reputation": 49, "user_id": 8751232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9761f85599589f9942c1e70656067f?s=128&d=identicon&r=PG", "display_name": "user8751232", "link": "https://stackoverflow.com/users/8751232/user8751232"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1517381727, "post_id": 48536115, "comment_id": 84067465, "body": "i draw a black pixel on white screen."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1517381760, "post_id": 48536115, "comment_id": 84067485, "body": "&quot;try to color the pixel white&quot; Would you like to rephrase your question?"}, {"owner": {"reputation": 49, "user_id": 8751232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9761f85599589f9942c1e70656067f?s=128&d=identicon&r=PG", "display_name": "user8751232", "link": "https://stackoverflow.com/users/8751232/user8751232"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1517381834, "post_id": 48536115, "comment_id": 84067523, "body": "that was my mistake, I am sorry"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1517381901, "post_id": 48536115, "comment_id": 84067567, "body": "How did you come up with the code? Can you start from a working tutorial (somethign like a SDL2 hello world) and make something work? Then start to increment towards your goal?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1517381957, "post_id": 48536115, "comment_id": 84067590, "body": "Did you notice the question listed on the side under &quot;Related&quot;? Is any of them helpful?"}, {"owner": {"reputation": 49, "user_id": 8751232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9761f85599589f9942c1e70656067f?s=128&d=identicon&r=PG", "display_name": "user8751232", "link": "https://stackoverflow.com/users/8751232/user8751232"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1517381967, "post_id": 48536115, "comment_id": 84067596, "body": "I started from scratch only , and stucked here."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1517382032, "post_id": 48536115, "comment_id": 84067628, "body": "Tutorial or other questions seem a wise path then."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1517391491, "post_id": 48536115, "comment_id": 84072700, "body": "First you update the window, then you draw pixels. Try the other way around."}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1517419569, "post_id": 48536115, "comment_id": 84091925, "body": "Your <code>drawPixel</code> assumes pixel occupies single byte. That may be (check surface format), but very unlikely. For most formats pixels stored in <code>Uint32</code>."}], "owner": {"reputation": 49, "user_id": 8751232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9761f85599589f9942c1e70656067f?s=128&d=identicon&r=PG", "display_name": "user8751232", "link": "https://stackoverflow.com/users/8751232/user8751232"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 348, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1517381811, "creation_date": 1517381334, "last_edit_date": 1517381811, "question_id": 48536115, "link": "https://stackoverflow.com/questions/48536115/pixel-manipulation-in-sdl2-0", "title": "Pixel Manipulation in SDL2.0", "body": "<p>I can not display pixels in SDL 2.0.</p>\n\n<pre><code>#include&lt;SDL2/SDL.h&gt;\n#include&lt;stdbool.h&gt;\n\nvoid end( SDL_Window *Window, SDL_Surface *Surface);\nvoid drawPixel( SDL_Surface *Surface, int x, int y);\nvoid main(){\n    Uint32 start;\n    const int FPS = 60;\n    bool running = true;\n    SDL_Event event;\n    SDL_Window *main_window = NULL;\n    SDL_Surface *main_screen = NULL;\n    SDL_Init( SDL_INIT_EVERYTHING );\n    main_window =  SDL_CreateWindow(\"Pixel\", SDL_WINDOWPOS_UNDEFINED,\n                        SDL_WINDOWPOS_UNDEFINED,800,600,\n                        SDL_WINDOW_RESIZABLE);\n\n    main_screen = SDL_GetWindowSurface ( main_window );\n    SDL_UpdateWindowSurface( main_window );\n\n    //printf(\"%d\\n\",main_screen-&gt;pixels);\n    SDL_FillRect( main_screen, NULL, SDL_MapRGB(main_screen-&gt;format, 255, 255, 255));\n    SDL_UpdateWindowSurface( main_window );\n    for(int i = 0; i &lt;= 3000; i++ ){\n        drawPixel( main_screen, i, 0);\n        //break;\n    }\n   // SDL_UpdateWindowSurface( main_window );\n\n    while( running ) {\n      //  start = SDL_GetTicks();\n        while ( SDL_PollEvent( &amp;event ) ){\n            switch( event.type ){\n                case SDL_QUIT:\n                    running = false;\n                    break;\n            }\n        }\n    }\n    end( main_window, main_screen);\n\n}\n\nvoid end(SDL_Window *Window, SDL_Surface *Surface){\n    SDL_FreeSurface( Surface );\n    SDL_DestroyWindow( Window );\n}\n\nvoid drawPixel(SDL_Surface *Surface, int x, int y){\n    Uint8 *pixel_array = (Uint8 *) Surface-&gt;pixels;\n    Uint8 *pixel = pixel_array + Surface-&gt;pitch * y + x;\n    *pixel = SDL_MapRGB(Surface-&gt;format, 0, 0, 0 );\n}`\n</code></pre>\n\n<p>I tried to locate pixel position and try to color the pixel black while background color white, but it does not print anything.\nAlthough I tried to create a line in case i am not unable to see the pixel, but it turned out to be not working. I see only white screen.</p>\n"}, {"tags": ["c", "arrays", "file", "fopen"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 1, "creation_date": 1517381376, "post_id": 48536064, "comment_id": 84067323, "body": "One problem I can see is <code>for (int x = 0; x &gt; L&#196;NGE; x++)</code> should be this <code>for (int x = 0; x &lt; L&#196;NGE; x++)</code>. Could you show us the code for <code>print</code> function."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1517381495, "post_id": 48536064, "comment_id": 84067367, "body": "I think the <i>Fehler</i> here is that you are printing an uninitialized array!"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517382503, "post_id": 48536064, "comment_id": 84067844, "body": "You should be checking the return value from <code>fscanf()</code> to ensure it works.  You could also print each value as it is read, so you know what the matrix is initialized to.  But this would reveal that your matrix is not initialized because of the bug in the inner loop \u2014 there&#39;d be no printing.  Printing the data as it is read is a basic mechanism for checking whether the I/O is working as you expect \u2014 something you should check automatically if (when) things aren&#39;t working as you think they should."}, {"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517382610, "post_id": 48536064, "comment_id": 84067882, "body": "In general, I would wonder about portability when using umlauts, and maybe also about maintainability with only non-English comments. Not a problem with personal projects, but maybe a good habit to get into? Here in Germany, we professionals always write our comments only in English, and a German comment won&#39;t get through code review"}, {"owner": {"reputation": 21, "user_id": 8628529, "user_type": "registered", "profile_image": "https://graph.facebook.com/130816364323366/picture?type=large", "display_name": "Lara", "link": "https://stackoverflow.com/users/8628529/lara"}, "edited": false, "score": 0, "creation_date": 1517383180, "post_id": 48536064, "comment_id": 84068151, "body": "yes as said, i&#39;m really new and when i started this project i just worte all comments in german, I&#39;m gonna do better next time. I changed all the umlauts.  I have an initialising functing  edit: i pressed enter by accident  int init_matrix(char matrix[][LAENGE]) {  \tint x, y;  \tfor (x = 0; x &lt; BREITE; x++){  \t\tfor (y = 0; y &lt; LAENGE; y++){  \t\t\tmatrix[x][y] = 0;  \t\t} \t} \treturn matrix; }"}], "answers": [{"tags": [], "owner": {"reputation": 13998, "user_id": 2352344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JHVDS.png?s=128&g=1", "display_name": "clemens", "link": "https://stackoverflow.com/users/2352344/clemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1517382385, "last_edit_date": 1517382385, "creation_date": 1517381421, "answer_id": 48536141, "question_id": 48536064, "link": "https://stackoverflow.com/questions/48536064/trying-to-print-an-array-out-of-a-file/48536141#48536141", "title": "Trying to print an array out of a file", "body": "<p>There is probably a typo in the inner for loop:</p>\n\n<pre><code>for (int x = 0; x &gt; L\u00c4NGE; x++){\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>for (int x = 0; x &lt; L\u00c4NGE; x++){\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8628529, "user_type": "registered", "profile_image": "https://graph.facebook.com/130816364323366/picture?type=large", "display_name": "Lara", "link": "https://stackoverflow.com/users/8628529/lara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1517382781, "creation_date": 1517381158, "last_edit_date": 1517382781, "question_id": 48536064, "link": "https://stackoverflow.com/questions/48536064/trying-to-print-an-array-out-of-a-file", "title": "Trying to print an array out of a file", "body": "<p>I'm new here and new to C.</p>\n\n<p>I want to print an array out of a file with fopen but it does not seem to work.</p>\n\n<p>My empty array is <code>char matrix[25][25]</code>, and now I am trying to open a text file and print it into the array. The txt file is named <code>Matrix1.txt</code> and consists out of 625 characters that are either <code>'*'</code> or <code>' '</code>.</p>\n\n<p>What I am trying to do now is:</p>\n\n<pre><code>//openfile(), L\u00c4NGE=Lenght=25, BREITE=Height=25, datei=file, matrix=array\nint datei\u00f6ffnen(char matrix[][L\u00c4NGE], char* datei){\n\n    FILE *fp;\n    char cell;\n\n    fp = fopen(datei, \"r\");\n    if (fp == NULL){\n        printf(\"Fehler!\\n\");  //Fehler=Error\n    }\n    else{\n        for (int y = 0; y &lt; BREITE; y++){\n            for (int x = 0; x &gt; L\u00c4NGE; x++){\n                fscanf(fp, \"%c\", &amp;cell);\n                matrix[x][y] = cell;\n            }\n        }\n\n        fclose(fp);\n    } \n}\n</code></pre>\n\n<p>So later I try to print the array and play the Game of life with that printed array (it's in a switch):</p>\n\n<pre><code>case 1: \n    datei\u00f6ffnen(matrix, \"Matrix1.txt\");\n    play(matrix); \n    print(matrix);\n</code></pre>\n\n<p>but for some reason it prints a blank array and if I try to run the openfile() in the main function like this</p>\n\n<pre><code>int main(int argc, char *argv[]) {\n    char matrix[BREITE][L\u00c4NGE];\n    int x, y;\n    //srand(time(NULL));\n    datei\u00f6ffnen(matrix, \"Matrix1.txt\");\n}\n</code></pre>\n\n<p>it prints an array like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/EKtI9.png\" alt=\"this\"></p>\n\n<p>So I am very confused and would be glad and thankful if someone could give me a hint what's going on.</p>\n"}, {"tags": ["c", "arrays", "linux"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1517381013, "post_id": 48535983, "comment_id": 84067154, "body": "You should probably learn that <code>argv[argc]</code> is always a null pointer. I also can&#39;t help but feel that <code>data[i+1]</code> will go out of bounds."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1517381545, "post_id": 48535983, "comment_id": 84067388, "body": "C is not Java; source files are not related to classes per se.  Using <code>class</code> in questions about C raises hackles and warns that you&#39;re not a C programmer.  You create a program from <code>child.c</code>, not a class."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517381713, "post_id": 48535983, "comment_id": 84067458, "body": "It&#39;s pretty pointless copying the arguments from <code>argv</code> into <code>data</code>."}], "answers": [{"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 0, "last_activity_date": 1517381541, "creation_date": 1517381541, "answer_id": 48536180, "question_id": 48535983, "link": "https://stackoverflow.com/questions/48535983/adding-a-0-to-an-array-of-char-based-on-the-argc-being-even-or-odd/48536180#48536180", "title": "adding a 0 to an array of char* based on the argc being even or odd", "body": "<p>To get around the \"<code>odd</code>-issue\" one simple approach would be to define <code>char * data[argc + 1];</code>  and initialise all it's elements to point to a literal <code>\"0\"</code> before setting the relevant elements to point to <code>argv</code>'s elements.</p>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 0, "last_activity_date": 1517388766, "creation_date": 1517388766, "answer_id": 48538047, "question_id": 48535983, "link": "https://stackoverflow.com/questions/48535983/adding-a-0-to-an-array-of-char-based-on-the-argc-being-even-or-odd/48538047#48538047", "title": "adding a 0 to an array of char* based on the argc being even or odd", "body": "<p>It seems to me you are making the code much more complicated than need. Some specific items:</p>\n\n<p>1) Why do you have two nested loops (i.e. a <code>while</code> with a <code>for</code> inside)? As far as I can see that will just lead to too many calls of <code>child</code></p>\n\n<p>2) <code>workerid</code> seems unused!?</p>\n\n<p>3) <code>arrayNum</code> seems unused!?</p>\n\n<p>4) Why convert the return values into strings? You want to calculate a sum so just keep it as integer</p>\n\n<p>Simplifying your code could give something like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main(int argc, char *argv[])\n{\n  int status, id;\n  int i = 1;\n  int sum = 0;\n  int numberloops = argc / 2;\n  int index = 0;\n\n  while(numberloops &gt; index)\n  {\n    id = fork();\n    if(id &lt; 0)\n    {\n      perror(\"fork() ERROR.\\n\");\n    }\n    else if(id &gt; 0)\n    {\n      waitpid(id, &amp;status, 0);\n      status = WEXITSTATUS(status);\n      sum += status;\n    }\n    else\n    {\n      if (i == argc-1)\n      {\n        execlp(\"./child\", \"child\", argv[i], \"\", NULL);\n      }\n      else\n      {\n        execlp(\"./child\", \"child\", argv[i], argv[i+1], NULL);\n      }\n    }\n\n    i = i + 2;\n    index++;\n  }\n\n  printf(\"Final Sum: %d.\\n\\n\", sum);\n}\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>./parent 1 2 3 4 5\n1 + 2 = 3 Worker PID: 12961\n3 + 4 = 7 Worker PID: 12962\n5 + 0 = 5 Worker PID: 12963\nFinal Sum: 15.\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8621368, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/332330253896100/picture?type=large", "display_name": "noel880", "link": "https://stackoverflow.com/users/8621368/noel880"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1517388766, "creation_date": 1517380841, "question_id": 48535983, "link": "https://stackoverflow.com/questions/48535983/adding-a-0-to-an-array-of-char-based-on-the-argc-being-even-or-odd", "title": "adding a 0 to an array of char* based on the argc being even or odd", "body": "<p>so I'm working on an assignment where the user simply calls the parent.c class like \"./parent 1 2 3 4 5 6 7 8\" and the child.c class will compute the sum of the result. </p>\n\n<p>It works by reading 2 numbers each on the line like this...\n\"1 + 2\" \"3 + 4\" \"5 + 6\" \"7 + 8\"</p>\n\n<p>I've gotten it to do this successfully, but I hit a complete brick wall when the input ends up being odd. As I keep looping the child processes, each 2 numbers will keep adding up, but it becomes a problem when the loop comes to the end of the input and there are no longer 2 numbers to add, but simply one (odd number scenario).</p>\n\n<p>So if the input became something such as...\n\"./parent 1 2 3 4 5 6 7\" or \"./parent 1 2 3\"</p>\n\n<p>it will just flat out return as 0.</p>\n\n<p>My file will compute the even numbers, but it will not add up an odd amount of numbers.  The overall goal I would like to accomplish is to just be able to add a zero if the input ever hits an odd number.  One attempted solution I had was to just check at the beginning of the while loop if the amount of values in data array was odd, and then increment index by one and then add a 0 to that very index.  But it still didn't provide the correct solution.  </p>\n\n<p>parent.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;math.h&gt;\n\n\nint main(int argc, char *argv[])\n{\nint status, workerid, id;\nint i = 0;\nint loopcount = 0;\n\n\nchar* data[argc];\nfor(i = 1; i &lt;= argc; i++)\n{\n  data[i] = argv[i];\n}\n\nint numberloops = argc / 2; \nint index = 0;\n\nwhile(numberloops &gt; index)\n{\n\nloopcount = 0;\n\nfor(i = 1; i &lt;= argc; i += 2)\n{\n  loopcount++;\n\n  id = fork();\n\n  if(id &lt; 0)\n  {\n    perror(\"fork() ERROR.\\n\");\n\n  }\n  else if(id &gt; 0)\n  {        \n    workerid = waitpid(id, &amp;status, 0); \n\n    status = WEXITSTATUS(status);\n\n    //update data array\n    char* statStr;\n    statStr = (char*) malloc(16);\n    snprintf(statStr, sizeof(statStr), \"%d\", status);\n    data[loopcount] = statStr;\n  }\n  else\n  { \n     execlp(\"./child\", \"child\", data[i], data[i+1], NULL); \n  }\n}\n\nint arrayNum = atoi(data[loopcount]);\n\n// Adds a 0 to the array.\n\nwhile(loopcount &lt; argc)\n{\n  loopcount++;\n  data[loopcount] = 0;\n} \n\n//change argc (number of values in data array)\nif(argc % 2 == 1)\n{\n  argc = (argc + 1) / 2;   \n}\nelse\n{\n  argc /= 2;\n}\n\nindex++;\n}\n\nprintf(\"Final Sum: %s.\\n\\n\", data[1]);\n}\n</code></pre>\n\n<p>child.c</p>\n\n<pre><code> #include&lt;stdio.h&gt;\n #include&lt;stdlib.h&gt;\n\n int main(int argc, char *argv[])\n {\n int x = atoi(argv[1]);\n int y = atoi(argv[2]);\n\n int sum = x + y;\n\n printf(\"%d + %d = %d Worker PID: %d\\n\", x, y, sum, getpid());\n\n exit(sum);\n }\n</code></pre>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1517381013, "post_id": 48535954, "comment_id": 84067155, "body": "What&#39;s wrong with your code? What does not work?"}, {"owner": {"reputation": 143, "user_id": 8658311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4e64b0f7eb9a0f6e03470da50b7873f?s=128&d=identicon&r=PG&f=1", "display_name": "sktsasus", "link": "https://stackoverflow.com/users/8658311/sktsasus"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1517381120, "post_id": 48535954, "comment_id": 84067199, "body": "My code as of now works fine. I just want to add additional code that will help me check a file&#39;s content and then print an error message when certain characters are not present. But I&#39;m not sure how to do this. This is why I asked this question."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1517381247, "post_id": 48535954, "comment_id": 84067259, "body": "BTW: you should put an effort indenting your code consistently."}, {"owner": {"reputation": 2104, "user_id": 4635537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad50ed18dff8aaff0ff427ea7b1067d?s=128&d=identicon&r=PG", "display_name": "sameerkn", "link": "https://stackoverflow.com/users/4635537/sameerkn"}, "edited": false, "score": 0, "creation_date": 1517381290, "post_id": 48535954, "comment_id": 84067279, "body": "Use <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\">getline</a> to read lines of files and <code>strstr</code> to check <code>#A#</code> and <code>#B#</code>"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1517381313, "post_id": 48535954, "comment_id": 84067294, "body": "Maybe you want to learn about <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.24.5.7\" rel=\"nofollow noreferrer\"><code>strstr()</code></a>"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 2104, "user_id": 4635537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad50ed18dff8aaff0ff427ea7b1067d?s=128&d=identicon&r=PG", "display_name": "sameerkn", "link": "https://stackoverflow.com/users/4635537/sameerkn"}, "edited": false, "score": 1, "creation_date": 1517381358, "post_id": 48535954, "comment_id": 84067312, "body": "@sameerkn -- <code>getline()</code> is POSIX, but not Standard C. What is wrong with <code>fgets()</code>?"}, {"owner": {"reputation": 2104, "user_id": 4635537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad50ed18dff8aaff0ff427ea7b1067d?s=128&d=identicon&r=PG", "display_name": "sameerkn", "link": "https://stackoverflow.com/users/4635537/sameerkn"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1517381895, "post_id": 48535954, "comment_id": 84067562, "body": "@DavidBowling : Size of line cannot be predicted and it would be easy for OP, if complete line is available for search."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517382111, "post_id": 48535954, "comment_id": 84067674, "body": "There is no evidence in the code of you looking for <code>#A#</code> or <code>#B#</code>, so it isn&#39;t clear where you&#39;re having problems."}], "answers": [{"tags": [], "owner": {"reputation": 246, "user_id": 2737130, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54e4ef7abc5ac54ce7e0190f0ef8cd0a?s=128&d=identicon&r=PG&f=1", "display_name": "pHbits", "link": "https://stackoverflow.com/users/2737130/phbits"}, "is_accepted": true, "score": 2, "last_activity_date": 1517383278, "last_edit_date": 1517383278, "creation_date": 1517382758, "answer_id": 48536506, "question_id": 48535954, "link": "https://stackoverflow.com/questions/48535954/reading-and-checking-a-files-content-in-c/48536506#48536506", "title": "Reading and checking a file&#39;s content in C", "body": "<p>After taking each line (into 'filedata') simply use the <strong>strstr</strong> function to check if it contains that substring \"#A#\" etc. </p>\n\n<p>if <strong>strstr</strong> finds the substring it will return a pointer to it, otherwise it will return a NULL pointer.</p>\n\n<p>So you should write something like this:</p>\n\n<pre><code>if ( strstr(filedata, \"#A#\") == NULL )\n    printf(\"Error\\n\");\n</code></pre>\n\n<p>but since you are looking at the entire file for this substring, you need to check all the lines before you conclude that there is an error.</p>\n"}], "owner": {"reputation": 143, "user_id": 8658311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4e64b0f7eb9a0f6e03470da50b7873f?s=128&d=identicon&r=PG&f=1", "display_name": "sktsasus", "link": "https://stackoverflow.com/users/8658311/sktsasus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 48536506, "answer_count": 1, "score": 1, "last_activity_date": 1517383278, "creation_date": 1517380725, "question_id": 48535954, "link": "https://stackoverflow.com/questions/48535954/reading-and-checking-a-files-content-in-c", "title": "Reading and checking a file&#39;s content in C", "body": "<p>So I am writing a program in C that takes in a few command-line arguments and also reads a file and prints it to standard out. This is my code thus far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main( int argc, char* argv[] ) {\nchar* file_path;\nfloat a;\nfloat b;\nchar filedata[200];\nif (argc != 4) {\n    printf(\"Error: 4 arguments are required.\\n\");\n    return -1;\n}\nfile_path = argv[1];\na = atof(argv[2]);\nb = atof(argv[3]);\nif( a == 0.0 ) {\nprintf(\"Error: bad float arg\\n\");\nreturn -1;\n}\nif( b == 0.0 ) {\nprintf(\"Error: bad float arg\\n\");\nreturn -1;\n}\nFILE* fp = fopen( file_path, \"r\");\nif( fp == NULL ){\n    printf( \"Error: bad file; %s\\n\", file_path);\n    return -1;\n}\nwhile( fgets( filedata, 200, fp ) ){\n\n printf(\"%s\", filedata);        \n}\n    fclose(fp);\n}\n</code></pre>\n\n<p>At the very bottom I have began to read a file. What I am trying to do is find files that contain the characters \"#A#\" and \"#B#\" and then print an error message when files containing these characters are not present.</p>\n\n<p>Unfortunately, a simple if statement will not work in this scenario as I am not checking for equality but rather whether or not something is present.</p>\n\n<p>If anybody could tell me about any C functions that are able to read and check the contents of a file, along with a few more specifics, then I would highly appreciate it!</p>\n"}, {"tags": ["c", "linux", "unix", "permissions", "system-calls"], "comments": [{"owner": {"reputation": 19, "user_id": 9292765, "user_type": "registered", "profile_image": "https://graph.facebook.com/1496919237043134/picture?type=large", "display_name": "Rong Chen", "link": "https://stackoverflow.com/users/9292765/rong-chen"}, "edited": false, "score": 0, "creation_date": 1517379217, "post_id": 48535583, "comment_id": 84066468, "body": "forgot to ask the question. My program wont allow me to copy a file because of permission denied and i gave it permissions"}, {"owner": {"reputation": 11092, "user_id": 8794221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e2de0a8497383ad1889e87d91adc91?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/8794221/allan"}, "edited": false, "score": 0, "creation_date": 1517379221, "post_id": 48535583, "comment_id": 84066471, "body": "Could you add a bit more explanations? error message etc?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517379400, "post_id": 48535583, "comment_id": 84066537, "body": "Edit your question into your question \u2014 don&#39;t make it into a comment."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517379587, "post_id": 48535583, "comment_id": 84066606, "body": "Are you copying an executable program?  If not, the <code>S_IXUSR</code> and <code>S_IXOTH</code> bits are inappropriate in the permissions (and the omission of <code>S_IXGRP</code> is puzzling given that you include the other two).  Note that your second <code>open()</code> call tramples the error status (in <code>errno</code>) from the first \u2014 if both failed.  Your <code>open()</code> for writing doesn&#39;t attempt to create the file if it doesn&#39;t already exist, which is probably as well since you omitted the permissions argument that would be needed if you included <code>O_CREAT</code>.  If you create, consider <code>O_TRUNC</code> or <code>O_EXCL</code> too."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1517380343, "post_id": 48535583, "comment_id": 84066900, "body": "What is the purpose of defining and initialising <code>mode</code>?, without ever using it?"}, {"owner": {"reputation": 19, "user_id": 9292765, "user_type": "registered", "profile_image": "https://graph.facebook.com/1496919237043134/picture?type=large", "display_name": "Rong Chen", "link": "https://stackoverflow.com/users/9292765/rong-chen"}, "edited": false, "score": 0, "creation_date": 1517380498, "post_id": 48535583, "comment_id": 84066965, "body": "i changed the fdoutput to else after the first if statement, but now its telling me bad address"}, {"owner": {"reputation": 19, "user_id": 9292765, "user_type": "registered", "profile_image": "https://graph.facebook.com/1496919237043134/picture?type=large", "display_name": "Rong Chen", "link": "https://stackoverflow.com/users/9292765/rong-chen"}, "edited": false, "score": 0, "creation_date": 1517380561, "post_id": 48535583, "comment_id": 84066987, "body": "i used the mode because at first i couldnt get permission, but now i have bad address as the error"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517380583, "post_id": 48535583, "comment_id": 84066996, "body": "What is the name of the source file you&#39;re copying, and the target file you&#39;re copying to?  If the target file does not exist yet, your program won&#39;t create it.  You can only copy over an existing file with that code.  The <code>mode</code> variable is unused \u2014 you seem to be confused about this as you keep saying it is used but the code shows that it is not used.  Or perhaps you aren&#39;t showing us the real code \u2014 which is an appalling mistake to make.  We can&#39;t analyze bugs in an approximation to the code you&#39;re running. You should error report immediately after each <code>open()</code> call."}, {"owner": {"reputation": 19, "user_id": 9292765, "user_type": "registered", "profile_image": "https://graph.facebook.com/1496919237043134/picture?type=large", "display_name": "Rong Chen", "link": "https://stackoverflow.com/users/9292765/rong-chen"}, "edited": false, "score": 0, "creation_date": 1517380734, "post_id": 48535583, "comment_id": 84067060, "body": "so i created two txt files and tried to copy one to another, but i tried that just now and it gave me permission denied after the adjustments. the source files exist, but permission is not granted"}, {"owner": {"reputation": 19, "user_id": 9292765, "user_type": "registered", "profile_image": "https://graph.facebook.com/1496919237043134/picture?type=large", "display_name": "Rong Chen", "link": "https://stackoverflow.com/users/9292765/rong-chen"}, "edited": false, "score": 0, "creation_date": 1517380886, "post_id": 48535583, "comment_id": 84067109, "body": "gcc filehw1.c [user]$ ./a.out the source file cant be opened: Bad address [user]$ ./filehw1.c simpledata.txt samplecontext.txt -bash: ./filehw1.c: Permission denied [user]$ vi filehw1.c"}, {"owner": {"reputation": 2737, "user_id": 913182, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/H12RK.jpg?s=128&g=1", "display_name": "Tanner Babcock", "link": "https://stackoverflow.com/users/913182/tanner-babcock"}, "edited": false, "score": 0, "creation_date": 1517381069, "post_id": 48535583, "comment_id": 84067178, "body": "I don&#39;t think you&#39;re executing your program the right way. You know you run the binary with <code>$ .&#47;a.out simpledata.txt samplecontent.txt</code> right? You can&#39;t directly execute the <code>filehw1.c</code> source file. That&#39;s probably why it&#39;s telling you &quot;Permission denied&quot;. <code>a.out</code> is the binary, <code>filehw1.c</code> is just the source file."}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 0, "creation_date": 1517381504, "post_id": 48535583, "comment_id": 84067370, "body": "You are not checking argc to determine if you are passing the filenames, so executing &quot;a.out&quot; with no arguments will give you &quot;Bad address&quot;.... which was one of your error messages."}], "answers": [{"tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": false, "score": 1, "last_activity_date": 1517423373, "last_edit_date": 1517423373, "creation_date": 1517422707, "answer_id": 48548924, "question_id": 48535583, "link": "https://stackoverflow.com/questions/48535583/copy-program-file-permission-denied/48548924#48548924", "title": "Copy program: File Permission Denied", "body": "<p>The problem is in the call to the <em>system call</em> <code>open()</code> for the <em>destination</em> file (i.e.: the file to be created as a result of the copy):</p>\n\n<pre><code>fdoutput = open(argv[2], O_WRONLY);\n</code></pre>\n\n<h3>Making possible the creation of the destination file</h3>\n\n<p>First, the call above to <code>open()</code> opens the file with the given name by <code>argv[2]</code>, <strong>only if it already exits</strong>. Otherwise, the system call fails (<code>errno</code> is set to <code>ENOENT</code>) and <code>perror()</code> produces:</p>\n\n<blockquote>\n  <p>the written file cant be opened: No such file or directory</p>\n</blockquote>\n\n<p>In order to create the file if it does not exist yet, the <code>O_CREAT</code> flag has to <em>ORed</em> together with <code>O_WRONLY</code>.</p>\n\n<h3>Truncating  an already existing destination file</h3>\n\n<p>If the destination file already exist you surely want to <strong>truncate the length of that already existing file to zero</strong> at the moment of <code>open()</code>ing. That can by achieved by <em>ORing</em> the <code>O_TRUNC</code> flag together with the other flags.</p>\n\n<h3>Providing the permissions for the file to be created</h3>\n\n<p>Let's look at the <code>open()</code> system call's prototype:</p>\n\n<pre><code>int open(const char *path, int oflag, ...);\n</code></pre>\n\n<p>The <code>...</code> at the end is to specify a kind of optional argument. That argument is used by <code>open()</code> only when a new file is being created. It provides the <em>mode bits</em> to be applied for the file to be created. This is not exactly the permissions for the file to be created, but it is strongly related to them (for more info see: <em><a href=\"https://en.wikipedia.org/wiki/Umask\" rel=\"nofollow noreferrer\">file mode creation mask</a></em>).</p>\n\n<p>You created <code>mode</code> of type <code>mode_t</code> but just forgot to pass it to <code>open()</code>.</p>\n\n<hr>\n\n<p>With all exposed above in mind, your call should look like:</p>\n\n<pre><code>fdoutput = open(argv[2], O_WRONLY | O_CREAT | O_TRUNC, mode);\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9292765, "user_type": "registered", "profile_image": "https://graph.facebook.com/1496919237043134/picture?type=large", "display_name": "Rong Chen", "link": "https://stackoverflow.com/users/9292765/rong-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1517423719, "creation_date": 1517379102, "last_edit_date": 1517423719, "question_id": 48535583, "link": "https://stackoverflow.com/questions/48535583/copy-program-file-permission-denied", "title": "Copy program: File Permission Denied", "body": "<p>My following program, which copies a file, won't allow me to copy files because of \"permission denied\". However, I gave it permissions.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc, char* argv[])\n{\n    int fdinput, fdoutput; //file pointers\n    char arrbuf[5000]; //size of what can be read in file\n    ssize_t bytesR, bytesW;//number of what input returns\n\n    mode_t mode = S_IRUSR | S_IWUSR | S_IXUSR | S_IRGRP | S_IROTH |S_IXOTH ;\n\n    fdinput = open(argv[1], O_RDONLY); //pointing to read file\n\n    fdoutput = open(argv[2], O_WRONLY);//pointing to write file\n\n    if(fdinput == -1){\n    perror(\"the source file cant be opened\");\n    return 1;\n    }\n\n    if(fdoutput == -1){\n    perror(\"the written file cant be opened\");\n    return 2;\n    }\n\n    while((bytesR = read(fdinput, arrbuf, sizeof arrbuf)) &gt; 0){\n        bytesW = write(fdoutput, arrbuf, (ssize_t) bytesR);\n    }\n\n    close(fdinput);\n    close(fdoutput);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["javascript", "c", "hash"], "answers": [{"comments": [{"owner": {"reputation": 6103, "user_id": 565244, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WnmbD.png?s=128&g=1", "display_name": "Codebeat", "link": "https://stackoverflow.com/users/565244/codebeat"}, "edited": false, "score": 0, "creation_date": 1517378914, "post_id": 48535301, "comment_id": 84066327, "body": "Thanks for the answer, take a look at it later, however the question is about to achieve the same behaviour in C instead of Javapascript. I have the same in PHP, both produce the same so there must be some trick to get it working."}, {"owner": {"reputation": 130214, "user_id": 772035, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/jAEqI.jpg?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/772035/paul"}, "reply_to_user": {"reputation": 6103, "user_id": 565244, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WnmbD.png?s=128&g=1", "display_name": "Codebeat", "link": "https://stackoverflow.com/users/565244/codebeat"}, "edited": false, "score": 1, "creation_date": 1517380826, "post_id": 48535301, "comment_id": 84067088, "body": "@Codebeat I updated my answer with C code that behaves the way the JS and PHP do."}, {"owner": {"reputation": 6103, "user_id": 565244, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WnmbD.png?s=128&g=1", "display_name": "Codebeat", "link": "https://stackoverflow.com/users/565244/codebeat"}, "edited": false, "score": 0, "creation_date": 1517441122, "post_id": 48535301, "comment_id": 84102647, "body": "Hi, tried this all, the Javascript version works however the C version don&#39;t, still the same results. It&#39;s a real problem when I need to change the javascript and php versions because it is used everwhere in projects."}, {"owner": {"reputation": 6103, "user_id": 565244, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WnmbD.png?s=128&g=1", "display_name": "Codebeat", "link": "https://stackoverflow.com/users/565244/codebeat"}, "edited": false, "score": 0, "creation_date": 1517441263, "post_id": 48535301, "comment_id": 84102694, "body": "There is also a typo in the javascript version, &gt;&gt;&gt; must be &gt;&gt;"}, {"owner": {"reputation": 130214, "user_id": 772035, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/jAEqI.jpg?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/772035/paul"}, "reply_to_user": {"reputation": 6103, "user_id": 565244, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WnmbD.png?s=128&g=1", "display_name": "Codebeat", "link": "https://stackoverflow.com/users/565244/codebeat"}, "edited": false, "score": 0, "creation_date": 1517442064, "post_id": 48535301, "comment_id": 84102927, "body": "@Codebeat <code>&gt;&gt;&gt;</code> does the same thing as <code>&gt;&gt;</code> when its second operand is 0."}, {"owner": {"reputation": 130214, "user_id": 772035, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/jAEqI.jpg?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/772035/paul"}, "reply_to_user": {"reputation": 6103, "user_id": 565244, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WnmbD.png?s=128&g=1", "display_name": "Codebeat", "link": "https://stackoverflow.com/users/565244/codebeat"}, "edited": false, "score": 0, "creation_date": 1517442185, "post_id": 48535301, "comment_id": 84102962, "body": "@Codebeat The C version works for me ( final value of <code>hash</code> is <code>14538328381</code> ). Did you make both changes to the code? If you are printing it with printf you need to use <code>%lli</code>."}, {"owner": {"reputation": 6103, "user_id": 565244, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WnmbD.png?s=128&g=1", "display_name": "Codebeat", "link": "https://stackoverflow.com/users/565244/codebeat"}, "edited": false, "score": 0, "creation_date": 1517443349, "post_id": 48535301, "comment_id": 84103268, "body": "Okay, your right! Thanks man, really great! Didn&#39;t copy paste before but now after copy paste it is working fine. Thanks!"}], "tags": [], "owner": {"reputation": 130214, "user_id": 772035, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/jAEqI.jpg?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/772035/paul"}, "is_accepted": true, "score": 1, "last_activity_date": 1517380783, "last_edit_date": 1517380783, "creation_date": 1517377808, "answer_id": 48535301, "question_id": 48535147, "link": "https://stackoverflow.com/questions/48535147/does-js-trick-me-want-to-achieve-the-same-hash-in-c-as-in-javascript/48535301#48535301", "title": "Does JS trick me? Want to achieve the same hash in C as in Javascript", "body": "<p>You're getting a strange result in JS and PHP because you are working with IEEE floating point numbers, not integers. The <code>&gt;&gt;</code> operator treats its operand as if it is a signed 32-bit integer, but the subtraction and addition do not. That means that when the value is between <code>2^31</code> and <code>2^32 - 1</code> on any iteration you get different output, since JavaScript interprets it as an unsigned number instead of a signed number.</p>\n\n<p>You can fix your JavaScript and make it output the same result as C/C++, by <a href=\"https://stackoverflow.com/questions/1822350/what-is-the-javascript-operator-and-how-do-you-use-it\">using a rightshift of 0</a> to treat the result as a signed 32 bit integer again:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>const str = \"M:/Mijn Muziek/Various Artists/Revs &amp; ElBee - Tell It To My Heart.mp3\"\r\nconst hashCode = getHashCode( str );\r\nconsole.log( hashCode );\r\n\r\nfunction getHashCode(s)\r\n{\r\n     var hash=0,c=(typeof s === 'string')?s.length:0,i=0;\r\n    \r\n     while(i&lt;c) \r\n      { hash = (((hash&lt;&lt;5)-hash)+s.charCodeAt(i++)&gt;&gt;&gt;0); } // Added &gt;&gt;&gt; 0\r\n    \r\n     return ( hash &lt; 0 )?((hash*-1)+0xFFFFFFFF):hash; /* convert to unsigned int */\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>To instead get C to act the way Javascript and PHP do you will need to use a larger datatype for hash (int64_t) , but make sure to treat it as an <code>int32_t</code> for just the leftshift operation:</p>\n\n<pre><code>uint64_t getHashCode( const char* s )\n{\n int16_t  iLen  = strlen( s );\n int16_t  i     = 0;\n int64_t  hash  = 0;\n\n while( i &lt; iLen ) \n  { \n     // hash&lt;&lt;5 = multiply by 32\n    hash = (((int32_t)hash&lt;&lt;5)-hash)+(uint8_t)s[i++]; \n  }\n\n return (( hash &lt; 0 )?((hash*-1)+0xFFFFFFFF):hash); //convert to unsigned \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6103, "user_id": 565244, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WnmbD.png?s=128&g=1", "display_name": "Codebeat", "link": "https://stackoverflow.com/users/565244/codebeat"}, "edited": false, "score": 0, "creation_date": 1517378920, "post_id": 48535339, "comment_id": 84066329, "body": "Thanks for the answer, take a look at it later, however the question is about to achieve the same behaviour in C instead of Javapascript. I have the same in PHP, both produce the same so there must be some trick to get it working."}], "tags": [], "owner": {"reputation": 71380, "user_id": 3558960, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a98b52149d419c2aad558befe51c8cc5?s=128&d=identicon&r=PG", "display_name": "Robby Cornelissen", "link": "https://stackoverflow.com/users/3558960/robby-cornelissen"}, "is_accepted": false, "score": 0, "last_activity_date": 1517378428, "last_edit_date": 1517378428, "creation_date": 1517377931, "answer_id": 48535339, "question_id": 48535147, "link": "https://stackoverflow.com/questions/48535147/does-js-trick-me-want-to-achieve-the-same-hash-in-c-as-in-javascript/48535339#48535339", "title": "Does JS trick me? Want to achieve the same hash in C as in Javascript", "body": "<p>You have to convert the result of <code>((hash &lt;&lt; 5) - hash) + s.charCodeAt(i++)</code> back to a 32 bit integer. Easiest way to do that is with a bitwise operation, by virtue of the fact that all bitwise operators in JavaScript return a 32 bit integer result:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>function getHashCode(s) {\r\n  var hash = 0,\r\n    c = (typeof s === 'string') ? s.length : 0,\r\n    i = 0;\r\n\r\n  while (i &lt; c) {\r\n    hash = ((hash &lt;&lt; 5) - hash) + s.charCodeAt(i++);\r\n    hash = hash &gt;&gt; 0; // convert to 32 bit integer\r\n\r\n    console.log(hash);\r\n  }\r\n\r\n  return (hash &lt; 0) ? ((hash * -1) + 0xFFFFFFFF) : hash;\r\n}\r\n\r\ngetHashCode(\"M:/Mijn Muziek/Various Artists/Revs &amp; ElBee - Tell It To My Heart.mp3\");</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 6103, "user_id": 565244, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WnmbD.png?s=128&g=1", "display_name": "Codebeat", "link": "https://stackoverflow.com/users/565244/codebeat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 48535301, "answer_count": 2, "score": 0, "last_activity_date": 1517380783, "creation_date": 1517377024, "last_edit_date": 1517377488, "question_id": 48535147, "link": "https://stackoverflow.com/questions/48535147/does-js-trick-me-want-to-achieve-the-same-hash-in-c-as-in-javascript", "title": "Does JS trick me? Want to achieve the same hash in C as in Javascript", "body": "<p>I have a function in Javascript that produces hashes from strings, I have the same in PHP and produces the same value, however in C it doesn't. It has something to do with type I guess but cannot figure out how to solve this. I spend hours on this.</p>\n\n<hr>\n\n<p>The javascript function is simple, (I think copied from Java):</p>\n\n<pre><code>function getHashCode(s)\n{\n var hash=0,c=(typeof s === 'string')?s.length:0,i=0;\n\n while(i&lt;c) \n  { hash = ((hash&lt;&lt;5)-hash)+s.charCodeAt(i++); }\n\n return ( hash &lt; 0 )?((hash*-1)+0xFFFFFFFF):hash; /* convert to unsigned int */\n}\n</code></pre>\n\n<p>The C version (mess with some types already however can't get it right):</p>\n\n<pre><code>uint64_t getHashCode( const char* s )\n{\n int16_t  iLen  = strlen( s );\n int16_t  i     = 0;\n int32_t  hash  = 0;\n\n while( i &lt; iLen ) \n  { \n     // hash&lt;&lt;5 = multiply by 32\n    hash = ((hash&lt;&lt;5)-hash)+(uint8_t)s[i++]; \n  }\n\n return (( hash &lt; 0 )?((hash*-1)+0xFFFFFFFF):hash); //convert to unsigned \n}\n</code></pre>\n\n<p>Example string I have used:</p>\n\n<pre><code>\"M:/Mijn Muziek/Various Artists/Revs &amp; ElBee - Tell It To My Heart.mp3\"\n</code></pre>\n\n<p>After adding some debug output after a new hash value is applied (in the while loop), I get this table: </p>\n\n<pre><code>C/C++               JS\n---------------         -----------------\n77                  77\n2445                2445\n75842               75842\n2351179             2351179\n72886654            72886654\n-2035480916         -2035480916\n1324601154          1324601154\n-1887037154         -1887037154\n1631390447          1631390447\n-966503578          -966503578\n103160276           103160276\n-1096998635         -1096998635\n352780784           352780784\n-1948697477         -1948697477\n-280079596          4014887700      &lt;- DIFFERENT!\n-92532798           -4387500094     | (and all after this)\n1426450655          5721417951      |\n1270297459          -7319637133     |\n724515670            9314450262     \\/\n985149401           -7604785191\n474860476            9064795068\n1835772983          -11049128905\n1074387657           9664322249\n-1053720936         -9643655528\n1694389466           10284324058\n986466010           -11898435878\n515675343            13400577231\n-1193933436          -14078835324\n1642769264           14527671152\n-613760253          -13498662141\n-1846698612          15333170572\n-1413082042          -14297983930\n-855870241           16323998943\n-762173577           -17942042761\n2142423004           19322292188\n1990603716          -19484232764\n1579173090           18759042274\n1709725566          -19765110914\n1461885063           18641754247\n-1926203195         -19106072379\n417243165            17597112349\n49636328        -17130232856\n1538726269      18718595453\n455874115       -16723995069\n1247195722      18427064906\n8361750             -17171507434\n259214334       17439083518\n-554290137      -17734159321\n-3124955        17176744229\n-96873497       -17276742681\n1291888921      18471758105\n1393850960      -20080985520\n259706916       21734543396\n-539020164      -22013856644\n470244184       21945080664\n1692667927      -24077135849\n933098217       22407934697\n-1138726268     -22613562748\n-940775819      20534060661\n900720715       -20574115765\n-2142428835     19332407645\n-1990784344     -19170653528\n-1584772423     19890064057\n-1883304743     -19063173927\n1747095227      18926964411\n-1674622765     -18854491949\n-373698054      16806171130\n1300262326      -15879606858\n1653426493      14538328381\n</code></pre>\n\n<hr>\n\n<p>What can I do to get it right in C? Tried to 'increase' the type however gave very different results. Does JS a trick to change it's type depending on the value or something? Can anybody explain what's going on and why it is so different at a certain point (see <code>DIFFERENT!</code> marking in result table above)? </p>\n\n<p>Somebody any idea how to solve this?    </p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 1, "creation_date": 1517375241, "post_id": 48534790, "comment_id": 84064983, "body": "Have you checked the signature of <code>strncpy</code>? And also can you please try to rephrase the question to something more clear?"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1517375443, "post_id": 48534790, "comment_id": 84065060, "body": "What do you mean by &quot;read&quot; it?  If <code>argv[1]</code> is a string, then <code>argv[1] + 1</code> is the string you seem to want.  You don&#39;t need to read it--you already have it."}, {"owner": {"reputation": 23, "user_id": 6484389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2122098274339e6583bc3c75b47cda37?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6484389/coder"}, "edited": false, "score": 0, "creation_date": 1517375713, "post_id": 48534790, "comment_id": 84065149, "body": "Sorry for not being clear enough. This is what I am trying to do: given an input to my executable in the form of &quot;+name&quot; (which is argv[1]), I want to read the input starting from character &quot;n&quot; to the end of the string, skipping &quot;+&quot;"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1517376340, "post_id": 48534790, "comment_id": 84065368, "body": "@coder.: What do you mean by read? You want to copy it to some char array so that you process it? And each of your argument to <code>main</code> would be liek this? <code>.&#47;a.out +name1 +name2 +name3</code>??"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1517376954, "post_id": 48534790, "comment_id": 84065590, "body": "<code>char *p = argv[1];</code> would give you a pointer to the beginning of the string <code>&quot;+name&quot;</code>.  So then if you do <code>p += 1;</code>; you would advance the pointer past the <code>+</code> character, and get the argument."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1517376996, "post_id": 48534790, "comment_id": 84065603, "body": "Well thank you for taking the <a href=\"https://stackoverflow.com/tour\">tour</a>.  Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  &quot;but it didn&#39;t work&quot; is not a good problem statement.  Where is your code?  What were the results?  What exactly did you expect?  BTW: <code>char *p = &amp;(argv[1][1]);</code> would work if you&#39;re just trying to skip the leading &#39;-&#39; or &#39;/&#39; characters in your program arguments.  It&#39;s equivalent to <code>char *p = argv[1] + 1;</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1517377005, "post_id": 48534790, "comment_id": 84065608, "body": "<code>#include &lt;string.h&gt; .. size_t len = strlen (argv[1]); char variable[len]; strcpy (variable, argv[1] + 1); printf (&quot;variable : %s\\n&quot;, variable);</code> (note: this requires C99 (or newer) or VLA extensions to C89). Otherwise instead of <code>char varable[len];</code> use <code>char *variable = malloc (len); if (!varable) return 1;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6484389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2122098274339e6583bc3c75b47cda37?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6484389/coder"}, "edited": false, "score": 0, "creation_date": 1517544775, "post_id": 48535420, "comment_id": 84147744, "body": "Thank you for the explanation. I understand it now."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1517379881, "last_edit_date": 1517379881, "creation_date": 1517378326, "answer_id": 48535420, "question_id": 48534790, "link": "https://stackoverflow.com/questions/48534790/how-to-read-argv11-untill-the-end-of-the-string-in-c/48535420#48535420", "title": "How to read argv[1][1 - untill the end of the string] in C", "body": "<p>You are running up against two fundamental misconceptions regarding variables and pointers in C.</p>\n\n<p>Let's start with:</p>\n\n<pre><code> char *variable = strncpy(argv[1][1], strlen(argv[1]))\n</code></pre>\n\n<p>The biggest problem (aside from the improper use of <code>strncpy</code>) is you attempt to assign the return of <code>strncpy</code> to <code>char *variable</code> where <code>char *variable</code> is a <em>pointer-to-char</em> that is uninitialized and points to no valid storage. Your attempt to assign the return fails because the proper prototype for <code>strncpy</code> is:</p>\n\n<pre><code>char *strncpy(char *dest, const char *src, size_t n);\n</code></pre>\n\n<p>(<strong>note:</strong> the <code>dest</code> parameter. The destination must have adequate storage to accept <code>n</code> characters<code>. **further note:** if there is no</code>null byte` among the first n bytes of src, the array of bytes placed in dest will not be a <em>null-terminated</em> string.)</p>\n\n<p>Now either by cleverness or happy-circumstance using the <code>strlen</code> of the complete <code>argv[1]</code> to allocate storage for <code>dest</code> and copying from <code>argv[1] + 1</code> does provide space for the <code>null byte</code>.</p>\n\n<p>Your next misconception is using <code>argv[1][1]</code> in <code>strncpy</code>. <code>argv[1][1]</code> has type <code>char</code>, not <code>char*</code>. (though your could use <code>&amp;argv[1][1]</code> to use the <em>address of</em> <code>argv[1][1]</code> -- but not as you have it above.</p>\n\n<p><code>argv[1]</code> is a pointer of type <code>char *</code>. Being a pointer-to-char, if you want to skip one char, you want to read from the address <code>pointer + 1</code> (or <code>argv[1] + 1</code> in this case). Now it may make things easier to understand if you declare a separate pointer, e.g. <code>char *p = argv[1];</code> and then use <code>p + 1</code>, but it is the same thing.</p>\n\n<p>Putting that together, it looks like you intended:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main (int argc, char **argv) {\n\n    if (argc &lt; 2) \n        return 1;\n\n    size_t len = strlen (argv[1]);\n    char variable[len];\n\n    strcpy (variable, argv[1] + 1); \n    printf (\"variable : %s\\n\", variable);\n\n    return 0;\n}\n</code></pre>\n\n<p>Where with your example argument of <code>+name</code>, you would get:</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/argv1plus1 +name\nvariable : name\n</code></pre>\n\n<p>For sake of completeness, if your compiler does not support use of a <em>Variable Length Array</em> (VLA) as used in <code>char variable[len];</code> above, then your options are to declare <code>variable</code> as a fixed size array and validate that <code>strlen(argv[1])</code> has no more characters than your fixed size, or, you simply allocate storage for <code>variable</code> dynamically by calling <code>malloc</code> (or <code>calloc</code> or <code>realloc</code>). A short example using <code>malloc</code> would be:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main (int argc, char **argv) {\n\n    if (argc &lt; 2) \n        return 1;\n\n    size_t len = strlen (argv[1]);\n    char *variable = malloc (len);  /* allocate a block of memory len chars long */\n\n    if (variable == NULL) {         /* always validate malloc succeeded */\n        perror (\"malloc failure\");\n        exit (EXIT_FAILURE);\n    }\n\n    strcpy (variable, argv[1] + 1); \n    printf (\"variable : %s\\n\", variable);\n\n    free (variable);   /* don't forget to free the memory you allocate */\n\n    return 0;\n}\n</code></pre>\n\n<p>(same example &amp; output)</p>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 23, "user_id": 6484389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2122098274339e6583bc3c75b47cda37?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6484389/coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517379881, "creation_date": 1517374998, "last_edit_date": 1517378387, "question_id": 48534790, "link": "https://stackoverflow.com/questions/48534790/how-to-read-argv11-untill-the-end-of-the-string-in-c", "title": "How to read argv[1][1 - untill the end of the string] in C", "body": "<p>I am trying to read <code>argv[1]</code> starting from the <em>second character</em> until the end of the string in <code>argv[1]</code> (ignoring the first character, which is a flag). How can I do this? </p>\n\n<p>I tried some library functions and other ways such as storing it in a variable such as </p>\n\n<pre><code>char *variable = strncpy(argv[1][1], strlen(argv[1])) \n</code></pre>\n\n<p>but it didn't work. </p>\n"}, {"tags": ["c", "pointers", "recursion", "multidimensional-array"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517371165, "post_id": 48534172, "comment_id": 84063909, "body": "<code>void goesThrough(void *p, ...)</code> will accept any object pointer for <code>p</code>."}, {"owner": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517404631, "post_id": 48534172, "comment_id": 84081183, "body": "@chux - Yes, but it&#39;d be like building a house by making up the bricks. I don&#39;t want to write my own implementation of multidimensional arrays, I&#39;d rather use the one that already exists. As I said above, accessing a single member of these arrays would require a new function."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1517407414, "post_id": 48534788, "comment_id": 84083214, "body": "In my function, <code>* dimSize</code> is always a factor of quantity. This would mean that in the last call to <code>goesThrough</code>,  <code>quantity &#47; (*dimSize) == 1</code>, which actually identifies both, the amount of dimensions the array has at this stage, and the factor <code>index</code> should be multiplied by with each iteration. Basically, whenever <code>quantity &#47; (*dimSize) &gt; 1</code> is <code>false</code>, <code>quantity &#47; (*dimSize) ==</code> 1 is <code>true</code>. I&#39;m still taking a look at your code, thanks for your answers!"}, {"owner": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1517412628, "post_id": 48534788, "comment_id": 84087095, "body": "I&#39;m sorry but I&#39;m a bit confused about your code. Is <code>void *(*a)[*dimSize]</code> a pointer-to a pointer-to an array? what do you need it for? (and should it be declared after &#39;a&#39;?). In the &#39;true&#39; part of your if, when calling <code>goesThrough</code>, <code>a[index]</code> is the value of the array in the index position. Did you mean this?. Again, thanks!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1517413027, "post_id": 48534788, "comment_id": 84087358, "body": "@Gabriel  <code>void *(*a)[*dimSize]</code> is a <a href=\"https://cdecl.org/?q=void+%2A%28%2Aa%29%5B42%5D\" rel=\"nofollow noreferrer\">pointer to array (*dimSize) of pointer to void</a>.  I use <code>a</code>, assigned with <code>anArray</code>, to simplify the offset calculation of <code>goesThrough(a[index]...</code>, but I this is the part I am not confident about.  Will have to ponder it more when  I have time."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1517374997, "creation_date": 1517374997, "answer_id": 48534788, "question_id": 48534172, "link": "https://stackoverflow.com/questions/48534172/how-to-pass-down-multidimensional-pointers-arrays-to-recursive-function/48534788#48534788", "title": "how to pass down multidimensional pointers/arrays to recursive function", "body": "<p>@Gabriel, this looks like an interesting question, yet I only came up with a partial answer and made this wiki.  The *** may still need work.  Good luck.</p>\n\n<p>Recall that a dimension could be 1, so <code>quantity / (* dimSize) &gt; 1</code> is not sufficient a test.</p>\n\n<p>This uses a <code>level</code>: index into <code>dimSize</code> rather than <code>quantity</code>.</p>\n\n<pre><code>void goesThrough(void * anArray, size_t * dimSize, size_t level, void (*aFunction)(int)) {\n  if (level &gt; 1) {\n    for (size_t index = 0; index &lt; *dimSize; index++) {\n      void *(*a)[*dimSize];  // ***\n      a = anArray;\n      goesThrough(a[index], dimSize + 1, level - 1, aFunction);\n    }\n  } else if (level &gt; 0) {\n    int *a = anArray;\n    for (size_t index = 0; index &lt; *dimSize;index++) {\n      aFunction(a[index]);\n    }\n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1517414039, "post_id": 48535666, "comment_id": 84088067, "body": "I&#39;m afraid this&#39;s not why I asked. If I understand, (and I might not, no joke), you make a 2D loop to go through a 2D array. What I need is the function to be recursive, because if I had a 25D array I wouldn&#39;t like to write 25 times the same <code>for</code>, and should it also be general enough to take an array of any dimensions, not a fixed number of them. The size of each dimension is not a concern, as I&#39;d very well use a loop for that. Thanks!"}], "tags": [], "owner": {"reputation": 368, "user_id": 2904562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77e6e82a71d9209170823146567abca2?s=128&d=identicon&r=PG&f=1", "display_name": "Michal Butterweck", "link": "https://stackoverflow.com/users/2904562/michal-butterweck"}, "is_accepted": false, "score": 0, "last_activity_date": 1517379510, "creation_date": 1517379510, "answer_id": 48535666, "question_id": 48534172, "link": "https://stackoverflow.com/questions/48534172/how-to-pass-down-multidimensional-pointers-arrays-to-recursive-function/48535666#48535666", "title": "how to pass down multidimensional pointers/arrays to recursive function", "body": "<p>In C99 and higher you may use variable length arrays to pass multidimensional arrays:</p>\n\n<pre><code>void foo(int n, int m, int a[n][m]);\n</code></pre>\n\n<p>or using pointer to array:</p>\n\n<pre><code>void bar(int n, int m, int (*a)[n][m]);\n</code></pre>\n\n<p>as pointer may be dereferenced to first row/column you may even pass it like this:</p>\n\n<pre><code>void bar2(int n, int m, int (*a)[m]);\n</code></pre>\n\n<p>and still accsess it like <code>a[i][j]</code>.</p>\n\n<p>Please, note that <code>n</code> and <code>m</code> are declared in function declaration before the array itself.</p>\n\n<p>Also, you would need to create a new array on each recursion call and copy the data to it:</p>\n\n<pre><code>void bar(int n, int m, int a[n][m]) {\n    if ((n &gt; 1) &amp;&amp; (m &gt; 1)) {\n        int b[n-1][m-1];\n        for (int i = 0; i &lt; n-1; i++) {\n            for (int j = 0; j &lt; m-1; j++) {\n                b[i][j] = a[i][j];\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>This is because changing the <code>m</code> requires change of size of each row in memory.\nAlso naive approach of automatic allocation of array pushes it on stack. So you may want to do dynamic allocation:</p>\n\n<pre><code>int (*b)[m] = malloc(sizeof(int) * (n) * (m));\n</code></pre>\n\n<p>To use or not to use recursion is tough question. When using recursion make sure that height of the recursion is limited. If it is tail recursion compiler may serialize it (but this is not guaranteed). If you have multiple recursion calls (as pass a quarter of array to a new recursion call like in quadtree) this may require some custom stack/queue to be implemented.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1517437200, "post_id": 48550074, "comment_id": 84101129, "body": "The reason why I didn&#39;t use ++/-- on vars or indexes (as in your <b>Q2</b>) is that it won&#39;t work when going through the same dimension more than once. e.g. in <code>ar[2][3]</code> you&#39;ll call <code>f</code> once using the <code>++</code> op, then reading <code>ar[0]</code> and returning to the caller, then iterate to read <code>ar[1]</code> and call again, but by that moment your index/var is already incremented/decremented due to the former call, (unless decremented/incremented the opposite when the function exits). That&#39;s why I didn&#39;t use them."}, {"owner": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1517438023, "post_id": 48550074, "comment_id": 84101504, "body": "As for ANSI: I don&#39;t understand much about standards but I can assure you that I&#39;m not getting any complain about the literals <code>(int []) {2, 3}</code> using <code>gcc -std=c11 -pedantic -Wall -o &quot;%e&quot; &quot;%f&quot;</code>. I only use them to test the function, by the way."}, {"owner": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1517438706, "post_id": 48550074, "comment_id": 84101781, "body": "Now <b>Q1</b>: Lets say I don&#39;t want to write my own implementation of <i>recursion-compatible multidimensional arrays</i> (as I already did), <b>Is there a way to define a recursive function that passes arrays of any number of dimensions, by using multidimensional arrays as defined in the standard?</b>"}, {"owner": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "edited": false, "score": 0, "creation_date": 1517439014, "post_id": 48550074, "comment_id": 84101895, "body": "Now <b>Q2</b>: I know recursion is usually not even considered compared to loops, but that is my point. What is asked for in <b>Q2</b>, among others that you&#39;ve already answered, is <b>a way to do this using loops</b>, whether it exists. I still have to take a look into your <code>* get_p</code>. Thanks for your answer!"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1517456359, "post_id": 48550074, "comment_id": 84106156, "body": "Some quibbles-- 1) recursive algorithms should be <i>easy</i> to understand, that is the whole point; but, C does <i>not</i> guarantee tail call optimization (though some compilers may do this). 2) &quot;when using multidimensional syntax in c you need to know the sizes at compile time&quot;: C has had VLAs since C99 (optional in C11), for which array sizes are determined at runtime...."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1517456817, "post_id": 48550074, "comment_id": 84106261, "body": "3) &quot;The <code>array_1</code> and <code>array_2</code> are layed out the same in memory, it is just a matter of interpretation.&quot; This can get you in trouble. True that they share the same memory layout, but note that it is undefined behavior to index into a 2d array as a 1d array. For example, <code>int arr[10][10] = { { 0 } };  int *ptr = &amp;arr[0][0]; for (size_t i = 0; i &lt; 100; i++) { ptr[i] = 1; }</code> leads to undefined behavior, even though there is no attempted access outside of the 2d array. Even <code>ptr[10] = 1</code> is undefined behavior, because the access is oob the first row of <code>arr</code>."}], "tags": [], "owner": {"reputation": 941, "user_id": 7617604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7f920ede1516b4f8460a1b0e554bc8b?s=128&d=identicon&r=PG&f=1", "display_name": "Burdui", "link": "https://stackoverflow.com/users/7617604/burdui"}, "is_accepted": false, "score": 0, "last_activity_date": 1517427206, "creation_date": 1517427206, "answer_id": 48550074, "question_id": 48534172, "link": "https://stackoverflow.com/questions/48534172/how-to-pass-down-multidimensional-pointers-arrays-to-recursive-function/48550074#48550074", "title": "how to pass down multidimensional pointers/arrays to recursive function", "body": "<blockquote>\n  <p>a single-dimension pointer and threat it as multidimensional</p>\n</blockquote>\n\n<p>That is totally fine, because this is basically what c does.\nThe array_1 and array_2 are layed out the same in memory, it is just a matter of interpretation:</p>\n\n<pre><code>int array_1[60] = {\n    111, 112, 113, 114, 115,\n    121, 122, 123, 124, 125,\n    131, 132, 133, 134, 135,\n    141, 142, 143, 144, 145,\n\n    211, 212, 213, 214, 215,\n    221, 222, 223, 224, 225,\n    231, 232, 233, 234, 235,\n    241, 242, 243, 244, 245,\n\n    311, 312, 313, 314, 315,\n    321, 322, 323, 324, 325,\n    331, 332, 333, 334, 335,\n    341, 342, 343, 344, 345\n};\n\nint array_2[3][4][5] = {\n    {{111, 112, 113, 114, 115},\n     {121, 122, 123, 124, 125},\n     {131, 132, 133, 134, 135},\n     {141, 142, 143, 144, 145}},\n\n    {{211, 212, 213, 214, 215},\n     {221, 222, 223, 224, 225},\n     {231, 232, 233, 234, 235},\n     {241, 242, 243, 244, 245}},\n\n    {{311, 312, 313, 314, 315},\n     {321, 322, 323, 324, 325},\n     {331, 332, 333, 334, 335},\n     {341, 342, 343, 344, 345}}\n};\n</code></pre>\n\n<p>But in the latter case you always need to know the sizes and dimensions at compiletime.</p>\n\n<h2>Q1:</h2>\n\n<p>Thus said, your code works fine, although i recommend to declare something like <code>int subQuantity = quantity / *dimSize;</code> and use <code>subQuantity</code> for readability.</p>\n\n<h2>Q2:</h2>\n\n<p>Right know you just apply the funcion to every element, this could be done much easier:</p>\n\n<pre><code>void for_each_how_you_would_probably_do_it(int *arr, size_t elementCnt, void (*fn)(int)){\n    int i;\n    for(i = 0; i &lt; elementCnt; ++i){\n        fn(arr[i]);\n    }\n}\n\nvoid for_each_beacause_its_c(int *arr, size_t elementCnt, void (*fn)(int)){\n    while(elementCnt--){\n        fn(*arr++);\n    }\n}\n</code></pre>\n\n<p>In my opinion you should try writing iterative algorithms, recursive ones are hard to understand. In addition, i do not know if the compiler can perform tail recursion elimination.</p>\n\n<hr>\n\n<blockquote>\n  <p>every time the function calls itself it gets rid of one dimension, which is incompatible with the function prototype and definition</p>\n</blockquote>\n\n<p>That is what recursion is about, reducing the problem untill it gets trivial.</p>\n\n<blockquote>\n  <p>Reducing</p>\n</blockquote>\n\n<p>in this case means applying itself to the lesser dimension. </p>\n\n<blockquote>\n  <p>Trivial</p>\n</blockquote>\n\n<p>means, just one dimension is left.</p>\n\n<hr>\n\n<blockquote>\n  <p>and to read/write to a single member in these arrays I'd need to write my own functions too</p>\n</blockquote>\n\n<p>You can get the corresponding pointer with following code:</p>\n\n<pre><code>/* \n * arr is the array\n * idx is an array of indice for each dimension (0-based like everything in c)\n * dimSisez are the sizes of each dimension\n * dim is the dimension\n */\nint *get_p(int *arr, int *idx, int *dimSizes, int dim){\n    int pos = idx[0];\n    int i;\n    for(i = 1; i &lt; dim; ++i){\n        pos *= dimSizes[i];\n        pos += idx[i];\n    }\n    return arr + pos;   /* &amp;arr[pos] */\n}\n</code></pre>\n\n<p>It is the same as using <code>&amp;arr[idx[0]][idx[1]]...[idx[dim - 1]]</code> but again, when using multidimensional syntax in c you need to know the sizes at compile time.\nBy the way dimSizes[0] is never used, that is the reason you can omit the first size when givin multidimensional-arrays as parameter to functions.</p>\n\n<hr>\n\n<p>One last thing:\nYou declared all your variables at the beginning of a block, like in the ansi-standard, but <code>(int []) {2, 3}</code> as parameter-value is not allowed in ansi.</p>\n"}], "owner": {"reputation": 13, "user_id": 3197717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cacad0a6bddf71e94d39501c72ef3aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/3197717/gabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1517427206, "creation_date": 1517370677, "last_edit_date": 1517407798, "question_id": 48534172, "link": "https://stackoverflow.com/questions/48534172/how-to-pass-down-multidimensional-pointers-arrays-to-recursive-function", "title": "how to pass down multidimensional pointers/arrays to recursive function", "body": "<p>I want to write a function that accepts an array of 'm' dimensions of 'n' elements each, and a pointer to other-trivial-function. The function will call itself at each dimension, iterates through its elements and call each time the function pointed to by the mentioned pointer (the trivial one).\nThe problem is that I couldn't find a way to define a function <em>general enough</em> as to accept an array of any dimensions, or a pointer to an array of any dimensions. Basically because every time the function calls itself it gets rid of one dimension, which is incompatible with the function prototype and definition.\nI wrote a function that accepts a single-dimension pointer and threat it as multidimensional according to other two arguments, i.e. the total amount of elements, and the sizes of each dimension.</p>\n\n<pre><code>int main(int argc, char **argv)\n{\n    void goesThrough (int *, int *, size_t, void (*) (int));\n    void print (int);\n\n    int array[] = {1, 2, 3, 4, 5, 6};\n    int (* ptrToArray) = array;\n\n/*\n * Arguments are a pointer to an array, an array of sizes for each \n * dimension, the amount of elements, and a pointer to whatever \n * function.\n */\n    goesThrough (ptrToArray, (int []) {2, 3}, 6, print);\n    return 0;\n}\n\nvoid goesThrough (int * anArray, int * dimSize, size_t quantity,\n                  void (* aFunction) (int))\n{\n    size_t index;\n\n    for (index = 0; index &lt; (* dimSize); ++index)\n    {\n        if (quantity / (* dimSize) &gt; 1)\n        {\n            goesThrough (anArray + (index * (quantity /(*dimSize))),\n                         dimSize + 1, quantity / (* dimSize), aFunction);\n        }\n        else\n        {\n            aFunction (anArray[index]);\n        }\n    }\n}\n\nvoid print (int aValue)\n{\n    printf (\"%d \", aValue);\n}\n</code></pre>\n\n<p>However, I find two drawback with this approach. It feels like the \ncompiler won't help if something goes wrong; and to read/write to a single member in these <strong><em>arrays</em></strong> I'd need to write my own functions too.</p>\n\n<p><strong>Question1</strong>: How to write this using multidimensional <strong>arrays</strong>?</p>\n\n<p><strong>Question2</strong>: Is recursion a better approach than loops in this case? if not, I'd appreciate an example using loops, (I would it anyway) ;). For better I mean any reason a serious programmer would choose it.</p>\n\n<p><strong>EDIT</strong>: I initially asked for <strong><em>arrays/pointers</em></strong> (<strong>Q1</strong>), but I meant <strong><em>arrays/pointers-to-arrays</em></strong></p>\n\n<p><strong>NOTE:</strong> Please notice that the matter here is to pass arrays of a number of dimensions that is different to the number of dimensions the function is expecting. To this regard edits or suggestions to the title are very much welcome.</p>\n"}, {"tags": ["c", "arrays", "methods", "2d", "reverse"], "comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1517372263, "post_id": 48534145, "comment_id": 84064166, "body": "&quot;I have the following code, which only works for a 3x3 array&quot; -- Are you sure about that? Why does it only work for a 3X3 array, and note that the posted code does not give the claimed output."}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 1, "last_activity_date": 1517377143, "last_edit_date": 1517377143, "creation_date": 1517375652, "answer_id": 48534893, "question_id": 48534145, "link": "https://stackoverflow.com/questions/48534145/reversing-a-2d-array-in-c/48534893#48534893", "title": "Reversing a 2D array in C", "body": "<p>You are reversing each row of the array. So write a function that will reverse an array passed as an parameter to it. </p>\n\n<p>The second one would be something like,</p>\n\n<pre><code>void swap(int *a, int *b){\n     int temp = *a;\n     *a = *b;\n     *b = temp;\n}\nvoid rev(int a[],const int col){\n    for(size_t i = 0; i &lt; col/2; i++){\n        swap(&amp;a[i],&amp;a[col-i-1]);\n    }\n}\n\nint main(void){\n...\n\nfor(size_t i = 0;  i &lt; rows; i++)\n   rev(a[i],columns);\n...\nreturn 0;\n}\n</code></pre>\n\n<p>The problem with your code is that you yourself are contradicting what you want to achieve.</p>\n\n<p>First swap you made is between <code>r2,c2</code> and <code>0,0</code> This way at first iteration inside the while you are swapping last row and first row. That is what you didn't want to do (atleast the question says so).</p>\n"}], "owner": {"reputation": 25, "user_id": 9214510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c6df047110d05632493e76680ec01ec?s=128&d=identicon&r=PG&f=1", "display_name": "Oracle", "link": "https://stackoverflow.com/users/9214510/oracle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4810, "favorite_count": 0, "accepted_answer_id": 48534893, "answer_count": 1, "score": 2, "last_activity_date": 1517377143, "creation_date": 1517370486, "question_id": 48534145, "link": "https://stackoverflow.com/questions/48534145/reversing-a-2d-array-in-c", "title": "Reversing a 2D array in C", "body": "<p>I can't seem to create a general method that will reverse a 2D array of any size. I have the following code, which only works for a 3x3 array. Is there a way to modify this code to reverse any size 2D array? </p>\n\n<pre><code>I need my array to go from:\n[ 1 2 3 ]\n[ 4 5 6 ]\n[ 7 8 9 ]\n\nto:  \n[ 3 2 1 ]\n[ 6 5 4 ]\n[ 9 8 7 ]\n</code></pre>\n\n<p>But this should work for any array size, not just 3x3 and not just an nxn array (square array). </p>\n\n<pre><code>    #include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nint main()\n{\n    int r,r2,c,c2,temp;\n\n    int rows = 3;\n    int columns = 3;\n\n    int a[rows][columns]; \n\n    a[0][0] = 1;\n    a[0][1] = 2;\n    a[0][2] = 3;\n\n    a[1][0] = 4;\n    a[1][1] = 5;\n    a[1][2] = 6;\n\n    a[2][0] = 7;\n    a[2][1] = 8;\n    a[2][2] = 9;\n\n    r = 0;\n    r2 = rows-1;\n\n    c = 0;\n    c2 = columns-1; \n\n    while(r&lt;=r2){\n        while(c&lt;=c2){\n            temp = a[r][c];\n            a[r][c] = a[r2][c2];\n            a[r2][c2] = temp;\n\n            c++;\n            c2--;\n        }\n\n        temp = a[r][c];\n        a[r][c] = a[r2][c2];\n        a[r2][c2] = temp;\n\n        r++;\n        r2--;\n\n    }\n\n\n    for(r=0;r&lt;3;r++){\n        for(c=0;c&lt;3;c++){\n            printf(\"%d\\n\",a[r][c]);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "csv", "printf"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9292261, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Cz_DSnndSg4/AAAAAAAAAAI/AAAAAAAAAzA/trepCxeAPWk/photo.jpg?sz=128", "display_name": "Vamshi Krishna", "link": "https://stackoverflow.com/users/9292261/vamshi-krishna"}, "edited": false, "score": 0, "creation_date": 1517370067, "post_id": 48534052, "comment_id": 84063664, "body": "Thank you so much. I will go through that link"}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1517384624, "post_id": 48534052, "comment_id": 84068808, "body": "Actually, adding the quotes to the second argument is better, as that allows to quote a variable char array, unlike the string literal: fprintf(fp, &quot;\\&quot;%s\\&quot;&quot;, &quot;hello, world&quot;);"}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1517415373, "post_id": 48534052, "comment_id": 84089001, "body": "Unless you have something in the string you also need to escape, like a quotation mark, or if the writer is in a common path for strings and numeric values and all you&#39;re doing is writing. Basically, the case you cite (a variable string) is actually the case where you usually won&#39;t want to put the quotes in the format string."}], "tags": [], "owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "is_accepted": true, "score": 2, "last_activity_date": 1517369790, "creation_date": 1517369790, "answer_id": 48534052, "question_id": 48534021, "link": "https://stackoverflow.com/questions/48534021/printing-a-in-csv-file-using-c-programming/48534052#48534052", "title": "Printing a , in CSV file using c programming", "body": "<p>Put quotes around the cell:</p>\n\n<pre><code>fprintf(fp, \"%s\", \"\\\"hello,world\\\"\");\n</code></pre>\n\n<p>IIRC Wikipedia has <a href=\"https://en.wikipedia.org/wiki/Comma-separated_values#Basic_rules\" rel=\"nofollow noreferrer\">a pretty good article on CSV</a>.</p>\n"}], "owner": {"reputation": 35, "user_id": 9292261, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Cz_DSnndSg4/AAAAAAAAAAI/AAAAAAAAAzA/trepCxeAPWk/photo.jpg?sz=128", "display_name": "Vamshi Krishna", "link": "https://stackoverflow.com/users/9292261/vamshi-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1467, "favorite_count": 0, "accepted_answer_id": 48534052, "answer_count": 1, "score": 0, "last_activity_date": 1517380105, "creation_date": 1517369560, "last_edit_date": 1517380105, "question_id": 48534021, "link": "https://stackoverflow.com/questions/48534021/printing-a-in-csv-file-using-c-programming", "title": "Printing a , in CSV file using c programming", "body": "<pre><code>FILE * fp = fopen (\"excel.csv\" , \" w+ \");\nfprintf (fp, \"%s\", \"hello,world\");\n</code></pre>\n\n<p>I want to print <code>hello,world</code> with comma in a single cell.\nHow can I print the same without printing in two different cells?</p>\n"}, {"tags": ["c", "unix", "linux-kernel", "operating-system"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1517366231, "post_id": 48533559, "comment_id": 84062809, "body": "I believe it&#39;s an option but I don&#39;t know how to change it. Some time ago the default has changed, from sending SIGTTOU, to not sending it and just letting the output appear."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1517366325, "post_id": 48533559, "comment_id": 84062828, "body": "Try running <code>stty tostop</code> to enable getting SIGTTOU in that terminal."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517367248, "post_id": 48533559, "comment_id": 84063023, "body": "Curious, why use a macro instead of a function, maybe <code>inline</code>?"}, {"owner": {"reputation": 581, "user_id": 8093676, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e4a097e527c8390afa006bedd7cc19e4?s=128&d=identicon&r=PG&f=1", "display_name": "K.Miao", "link": "https://stackoverflow.com/users/8093676/k-miao"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517369077, "post_id": 48533559, "comment_id": 84063424, "body": "@chux I don&#39;t really know. It looks cool."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1517374883, "post_id": 48533559, "comment_id": 84064862, "body": "regarding: <code>CHECK(setpgid(0, 0), &quot;child setpgid error&quot;);</code>  the pid of the child is seen in the parent as 0 HOWEVER, that is not its&#39; actual pid.  before calling this statement, syntax: <code>pid_t = getpid( void )</code> to obtain the actual pid value.  NOTE: the group id of 0 is for <code>root</code>, probably NOT what you want to use.  Note: group IDs have nothing to do with &#39;is the process running in foreground or background?`"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1517375115, "post_id": 48533559, "comment_id": 84064940, "body": "it is poor programming practice to declare a function via a <code>#define</code> statement.  Much better to just give it the modifier: <code>inline</code>"}, {"owner": {"reputation": 432, "user_id": 7245173, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-gktj-toDgUk/AAAAAAAAAAI/AAAAAAAAAj0/4ZKPOh6tRbc/photo.jpg?sz=128", "display_name": "Emil Terman", "link": "https://stackoverflow.com/users/7245173/emil-terman"}, "edited": false, "score": 0, "creation_date": 1517386085, "post_id": 48533559, "comment_id": 84069558, "body": "you&#39;re calling <code>setpgid()</code> in parent process"}, {"owner": {"reputation": 581, "user_id": 8093676, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e4a097e527c8390afa006bedd7cc19e4?s=128&d=identicon&r=PG&f=1", "display_name": "K.Miao", "link": "https://stackoverflow.com/users/8093676/k-miao"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1517406267, "post_id": 48533559, "comment_id": 84082345, "body": "@user3629249 According to the man page, <code>setpgid() sets the PGID of the process specified by pid to pgid.  If pid is zero, then the process ID of the calling process is used.  If pgid is zero, then the PGID of the process specified by pid is made  the  same  as  its process  ID.</code> So <code>setpgid(0, 0)</code> should be fine. I use <code>#define</code> because I don&#39;t want type checking."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1517464015, "post_id": 48533559, "comment_id": 84108238, "body": "@K.Miao,  regarding type checking.. Lets remember that the contents of a macro (as defined via a <code>#define</code> statement) is simply replacing the text of the macro name, in the source code, during preprocessing.  When the compiler gets the modified source code, then the type checking is performed.  So the type checking is still performed."}], "answers": [{"tags": [], "owner": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "is_accepted": true, "score": 1, "last_activity_date": 1517379288, "last_edit_date": 1517379288, "creation_date": 1517378914, "answer_id": 48535548, "question_id": 48533559, "link": "https://stackoverflow.com/questions/48533559/no-sigttou-when-background-process-writing-to-stdout/48535548#48535548", "title": "No SIGTTOU when Background Process Writing to STDOUT", "body": "<p>Shells usually support <em>job control</em> and allow processes to run in background (like <code>some-command &amp;</code>) so it makes more sense to by default allow background processes to output to the terminal without receiving <code>SIGTTOU</code>.</p>\n\n<p>To enable it you can run <code>stty tostop</code> (<code>stty -tostop</code> for disabling) which turns on the <code>TOSTOP</code> flag of the terminal.</p>\n\n<p>See following example:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>[STEP 101] # stty -a | grep tostop\nisig icanon iexten echo echoe echok -echonl -noflsh -xcase -tostop -echoprt\n                                                           ^^^^^^^\n[STEP 102] # sh -c 'echo hello world' &amp;\n[1] 39554\n[STEP 103] # hello world\n\n[1]+  Done                    sh -c 'echo hello world'\n[STEP 104] #\n[STEP 105] # stty tostop\n[STEP 106] # stty -a | grep tostop\nisig icanon iexten echo echoe echok -echonl -noflsh -xcase tostop -echoprt\n                                                           ^^^^^^\n[STEP 107] #\n[STEP 108] # sh -c 'echo hello world' &amp;\n[1] 39558\n[STEP 109] #\n\n[1]+  Stopped                 sh -c 'echo hello world'\n[STEP 110] #\n</code></pre>\n"}], "owner": {"reputation": 581, "user_id": 8093676, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e4a097e527c8390afa006bedd7cc19e4?s=128&d=identicon&r=PG&f=1", "display_name": "K.Miao", "link": "https://stackoverflow.com/users/8093676/k-miao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1036, "favorite_count": 1, "accepted_answer_id": 48535548, "answer_count": 1, "score": 0, "last_activity_date": 1517406392, "creation_date": 1517365851, "last_edit_date": 1517406392, "question_id": 48533559, "link": "https://stackoverflow.com/questions/48533559/no-sigttou-when-background-process-writing-to-stdout", "title": "No SIGTTOU when Background Process Writing to STDOUT", "body": "<p>In the following code, after I call <code>setpgid</code> for the child process, the child process should be in its own process group (becomes background group) while the parent process remains in the foreground group. I use <code>strace</code> to track the signal. The <code>ls</code> process successfully writes to STDOUT while no <code>SIGTTOU</code> arises. When a background process writes to the terminal, wouldn't it get <code>SIGTTOU</code>?</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n#define CHECK(syscall, msg) do {                    \\\n    if ((syscall) == -1) {                          \\\n      perror(msg);                                  \\\n      _exit(1);                                     \\\n    }                                               \\\n  } while(0)\n\nint main () {\n  int ls_pid;\n  char *ls_argv[] = { \"ls\", NULL };\n\n  CHECK(ls_pid = fork(), \"fork error\");\n  if (!ls_pid) {\n    CHECK(setpgid(0, 0), \"child setpgid error\");\n    CHECK(execvp(ls_argv[0], ls_argv), \"execvp error\");\n  } else {\n    sleep(2);\n  }\n  CHECK(wait(NULL), \"wait error\");\n\n  printf(\"Finish\\n\");\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 45919, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1517365340, "post_id": 48533406, "comment_id": 84062585, "body": "What is <code>a-&gt;seating[rowNum][columnNum]</code> supposed to be in <code>malloc(sizeof(a-&gt;seating[rowNum][columnNum])</code>? You seem to be trying to refer to something that you haven&#39;t yet allocated."}, {"owner": {"reputation": 49, "user_id": 8969676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a9fc05cd85260750957dfa04f8afe7f?s=128&d=identicon&r=PG", "display_name": "Timothy Mach", "link": "https://stackoverflow.com/users/8969676/timothy-mach"}, "reply_to_user": {"reputation": 45919, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1517366468, "post_id": 48533406, "comment_id": 84062855, "body": "how I am supposed to write it?,I have no idea,how malloc function works John Coleman"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1517369519, "post_id": 48533406, "comment_id": 84063524, "body": "for ease of readability and understanding: 1) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>  2) separate code blocks ( <code>for</code> <code>if</code> <code>else</code> <code>while</code> <code>do...while</code> <code>switch</code> <code>case</code> <code>default</code> ) via a single blank line.  3) separate functions by 2 or 3 blank lines (be consistent),."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1517369871, "post_id": 48533406, "comment_id": 84063620, "body": "the &#39;scope&#39; of variables should be as limited as reasonable possible.  in function: <code>classroom_seating_to_string()</code> the variables <code>i</code> and <code>j</code> have a &#39;scope&#39; of the whole function.  However, they only need a &#39;scope&#39; of the associated <code>for()</code> statements.  And variable types should be compared with the same types. I.E.  remove the function scope variable declarations and replace <code>for (i = 0; i &lt; sizeof(a-&gt;seating); i++)</code>  with: <code>for ( size_t i = 0; i &lt; sizeof(a-&gt;seating); i++)</code> and <code>for (j = 0; j &lt; sizeof(a-&gt;seating[0]); j++)</code> with: <code>for ( size_t j = 0; j &lt; sizeof(a-&gt;seating[0]); j++)</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1517370201, "post_id": 48533406, "comment_id": 84063697, "body": "in general, variable and parameter names should indicate <code>content</code> or <code>usage</code> (or better, both).  names like <code>a</code>, <code>s</code> are meaningless, even in the current context."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1517370250, "post_id": 48533406, "comment_id": 84063719, "body": "when calling: <code>strtok()</code>, always check (!=NULL) the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1517370761, "post_id": 48533406, "comment_id": 84063830, "body": "when calling any of the <code>scanf()</code> family of functions, 1) always check the returned value (not the parameter values) to assure the operation was successful.  2) When using the input format specifiers &#39;%s&#39; and/or &#39;%[...]&#39;, always include a MAX CHARACTERS modifier that is one less than the length of the input buffer.  Otherwise the input can overflow the input buffer, which is undefined behavior and can lead to a seg fault event."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1517371145, "post_id": 48533406, "comment_id": 84063904, "body": "regarding: <code>printf(&quot;Please enter a student information or enter \\&quot;Q\\&quot; to quit.&quot;);     scanf(&quot;%s&quot;,&amp;info);</code>  The posted code expects a &#39;firstname/lastname&#39; format, However, the prompt fails to mention that critical detail and the code is not checking for a &#39;Q&#39;"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1517371596, "post_id": 48533406, "comment_id": 84064004, "body": "regarding: <code>printf(&quot;\\n&quot;);</code>  the function: <code>printf()</code> is very expensive in CPU cycles.  a much less expensive alternative would be: <code>puts(&quot;&quot;);</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1517372157, "post_id": 48533406, "comment_id": 84064144, "body": "regarding the function: <code>classroom_seating_init()</code>.  Statements like: <code>student_init_default(&amp;a-&gt;seating[i][j]);</code>  are accessing memory that the function does not own.  This is undefined behavior and can lead to a seg fault event.  This is because the instance &#39;seating&#39; is only a double offset pointer and it is not set to point to anything in particular."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1517372334, "post_id": 48533406, "comment_id": 84064187, "body": "regarding: <code>else if (row &gt; sizeof(a-&gt;seating) || col &gt; sizeof(a-&gt;seating[0]))</code>  the <code>sizeof()</code> is (in almost all instances) evaluated at compile time.  So will return the size of a **pointer and not the actual size the code is expecting.  This is a serious problem with the posted code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1517372602, "post_id": 48533406, "comment_id": 84064258, "body": "regarding: <code>for ( size_t i = 0; i &lt; sizeof(a-&gt;seating); i++)     {         for ( size_t j = 0; j &lt; sizeof(a-&gt;seating[0]); j++)</code>  the <code>sizeof()</code> is a compile time operators so will return the size of a pointer (depending on the underlying architecture, 2, 4, or 8.  I.E. it will not return the number of bytes where the <code>seating</code> pointer points.  This is a serious problem with the posted code."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 8969676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a9fc05cd85260750957dfa04f8afe7f?s=128&d=identicon&r=PG", "display_name": "Timothy Mach", "link": "https://stackoverflow.com/users/8969676/timothy-mach"}, "edited": false, "score": 0, "creation_date": 1517368862, "post_id": 48533658, "comment_id": 84063382, "body": "pliz, implement for this metho Then classroom_seating_init can be void classroom_seating_init( void classroom_seating_init( int rowNum, int columnNum, struct classroom_seating *a){ // You should check the boundaries before reaching this point // Do something with a-&gt;seating[rowNum][columnNum] // Say add First name scanf(&quot;%s&quot;,(a-&gt;seating[rowNum][columnNum]).first_name) } d"}, {"owner": {"reputation": 45919, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 49, "user_id": 8969676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a9fc05cd85260750957dfa04f8afe7f?s=128&d=identicon&r=PG", "display_name": "Timothy Mach", "link": "https://stackoverflow.com/users/8969676/timothy-mach"}, "edited": false, "score": 0, "creation_date": 1517400583, "post_id": 48533658, "comment_id": 84078657, "body": "@TimothyMach You have gotten a fairly detailed answer to your question (one that warrants being accepted) -- try to understand it and use what you learn in the rest of your code. This seems to be homework. Don&#39;t deprive yourself of the learning experience of working it out by yourself."}, {"owner": {"reputation": 49, "user_id": 8969676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a9fc05cd85260750957dfa04f8afe7f?s=128&d=identicon&r=PG", "display_name": "Timothy Mach", "link": "https://stackoverflow.com/users/8969676/timothy-mach"}, "reply_to_user": {"reputation": 45919, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1517462826, "post_id": 48533658, "comment_id": 84107848, "body": "@John Coleman Yes sir. Thank you Stackoverflow. I manged to  solve it by going through it line by line using the suggestions above."}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "reply_to_user": {"reputation": 49, "user_id": 8969676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a9fc05cd85260750957dfa04f8afe7f?s=128&d=identicon&r=PG", "display_name": "Timothy Mach", "link": "https://stackoverflow.com/users/8969676/timothy-mach"}, "edited": false, "score": 0, "creation_date": 1517466667, "post_id": 48533658, "comment_id": 84109106, "body": "@TimothyMach Glad that you&#39;ve sorted that out. Thank you for accepting the answer"}], "tags": [], "owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "is_accepted": true, "score": 2, "last_activity_date": 1517366609, "creation_date": 1517366609, "answer_id": 48533658, "question_id": 48533406, "link": "https://stackoverflow.com/questions/48533406/c-program-only-allows-array-of-size-2x2-size-3-and-above-makes-it-crash/48533658#48533658", "title": "C program only allows array of size 2x2. Size 3 and above makes it crash", "body": "<p>Given</p>\n\n<pre><code>struct student {\n    //members of the structure\n    char last_name[30];\n    char first_name[30];\n};\n//declaring structure called  classroom_seating\nstruct classroom_seating {\n    struct student **seating ;\n\n};\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>a-&gt;seating=malloc((sizeof(a-&gt;seating[rowNum][columnNum])));\n</code></pre>\n\n<p>is not what you want. The immediate problem is that your structure definitions cannot model the real-world problem of seating. First you need to fill the total seating capacity.</p>\n\n<p>You may change the definition to </p>\n\n<pre><code>#define ROW_MAX 45\n// Say you have 45 rows\n#define COL_MAX 50\n// Say you have 30 cols\n\n//declaring structure called  classroom_seating\nstruct classroom_seating {\n    struct student seating[ROW_MAX][COLUMN_MAX] ; //maximum seating\n\n};\n</code></pre>\n\n<p>Then <code>classroom_seating_init</code> can be</p>\n\n<pre><code>void classroom_seating_init(void classroom_seating_init(int rowNum, int columnNum, struct classroom_seating *a){\n// You should check the boundaries before reaching this point\n// Do something with a-&gt;seating[rowNum][columnNum]\n// Say add First name scanf(\"%s\",(a-&gt;seating[rowNum][columnNum]).first_name)\n\n}\n</code></pre>\n\n<p>You can optionally add a filled field in <code>struct student</code></p>\n\n<pre><code>struct student {\n        //members of the structure\n        unsigned char isfilled;\n        // set it to say 'f' when filling a particular spot is filled\n\n        char last_name[30];\n        char first_name[30];\n    };\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 8969676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a9fc05cd85260750957dfa04f8afe7f?s=128&d=identicon&r=PG", "display_name": "Timothy Mach", "link": "https://stackoverflow.com/users/8969676/timothy-mach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "closed_date": 1517462513, "accepted_answer_id": 48533658, "answer_count": 1, "score": -2, "last_activity_date": 1517366609, "creation_date": 1517364690, "last_edit_date": 1517366333, "question_id": 48533406, "link": "https://stackoverflow.com/questions/48533406/c-program-only-allows-array-of-size-2x2-size-3-and-above-makes-it-crash", "closed_reason": "Duplicate", "title": "C program only allows array of size 2x2. Size 3 and above makes it crash", "body": "<p>The program runs without any errors, it prompts the user to enter row and column numbers so that it can construct a 2D array. If you enter 2 for rows and 2 for columns, it proceeds to the next step but if you enter 3 and above, it terminates with an error </p>\n\n<blockquote>\n  <p>\"there is a problem causing this program to stop working...\"</p>\n</blockquote>\n\n<p>Here is my code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;malloc.h&gt;\n//declaring structure called student\nstruct student {\n    //members of the structure\n    char last_name[30];\n    char first_name[30];\n};\n//declaring structure called  classroom_seating\nstruct classroom_seating {\n    struct student **seating ;\n\n};\n//Functions implementation for struct student.\n\nvoid student_init_default(struct student *s) {\n    //initializing the data members to string \"???\"\n    strcpy(s-&gt;first_name, \"???\");\n    strcpy(s-&gt;last_name, \"???\");\n}\n\nvoid student_init(struct student *s, char *info) {\n\n  /* Use the strtok function to extract first name and\n    last name from the variable student, then assign\n    them to each instance variable of the student\n    structure*/\n  strcpy(s-&gt;first_name, strtok(info, \"/\"));\n  strcpy(s-&gt;last_name, strtok(NULL, \"/\"));\n\n}\n\nvoid student_to_string(struct student *s) {\n    //printing the initial character of the first name, a period, the initial character of the last name, and a\n    //period\n    printf(\"%c.%c.\", s-&gt;first_name[0], s-&gt;last_name[0]);\n}\n//end of step1\n\n//step2\n\n//Functions implementation for struct classro classroom_seating_init(int rowNum, int columnNum, struct classroom_seating *a){\n//It instantiates a two-dimensional array of the size \"rowNum\" by \"columnNum\" specified by the\n//parameters inside the struct a. Then it initializes each student element of this array using the student_init_default function\nvoid classroom_seating_init(int rowNum, int columnNum, struct classroom_seating *a){\n  a-&gt;seating=malloc((sizeof(a-&gt;seating[rowNum][columnNum])));\n   //initializing the counters\n    int i = 0;\n    int j = 0;\n    for (i = 0; i &lt; rowNum; i++) {\n        for (j = 0; j &lt; columnNum; j++) {\n        student_init_default(&amp;a-&gt;seating[i][j]);\n\n        }\n       printf(\"\\n\");\n    }\n}\n\n\nint assign_student_at(int row, int col,struct classroom_seating *a,struct student *s) {\n    char str1[30];\n    strcpy(str1, a-&gt;seating[row][col].first_name);\n    if (strcmp(str1, \"???\"))\n    {\n        strcpy(a-&gt;seating[row][col].first_name,s-&gt;first_name);\n        strcpy(a-&gt;seating[row][col].last_name,s-&gt;last_name);\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\nint check_boundaries(int row, int col, struct classroom_seating *a) {\n    if (row &lt; 0 || col &lt; 0) {\n        return 0;\n    }\n    else if (row &gt; sizeof(a-&gt;seating) || col &gt; sizeof(a-&gt;seating[0])) {\n        return 0;\n    }\n    else {\n        return 1;\n    }\n}\n\nvoid classroom_seating_to_string(struct classroom_seating *a) {\n    printf(\"The Current Seating\\n\");\n    printf(\"-------------------\\n\");\n    int i = 0;\n    int j = 0;\n    for (i = 0; i &lt; sizeof(a-&gt;seating); i++) {\n        for (j = 0; j &lt; sizeof(a-&gt;seating[0]); j++) {\n            student_to_string(&amp;a-&gt;seating[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n}\n//end of functions implementation.\n\n//main function\nint main(){\n    //variable declaration\n  struct student s;\n  struct classroom_seating a;\n  char info[30];\n  int rowNum,colNum,row,col;\n\n\n//taking the inputs from the user,,,enter number of rows and columns that the array will have\n  printf(\"Please enter a number of rows for an classroom seating.\");\n  scanf(\"%d\",&amp;rowNum);\n  printf(\"Please enter a number of columns for an classroom seating.\");\n  scanf(\"%d\",&amp;colNum);\n  //\n  classroom_seating_init(rowNum,colNum,&amp;a);//calling method to create a 2D array for class arrangement.\n\n  printf(\"Please enter a student information or enter \\\"Q\\\" to quit.\");\n  scanf(\"%s\",&amp;info);\n  student_init(&amp;s, info);\n  while (1) {\n        printf(\"\\nA student information is read.\\n\");\n\n        // printing student information.\n        student_to_string(&amp;s);\n         printf(\"\\n\");\n        // Ask a user to decide where to seat a student by asking for row and column of a seat\n        printf(\"Please enter a row number where the student wants to sit.\");\n        scanf(\"%d\",&amp;row);\n        printf(\"Please enter a column number where the student wants to sit.\");\n        scanf(\"%d\", &amp;col);\n        // Checking if the row number and column number are valid\n\n        if (check_boundaries(row, col, &amp;a) == 0) {\n            printf(\"\\nrow or column number is not valid.\");\n            printf(\"A student %s %s is not assigned a seat.\\n\",s.first_name, s.last_name);\n        }\n        else {\n            // Assigning a seat for a student\n            if (assign_student_at(row, col, &amp;a, &amp;s)== 1) {\n                printf(\"\\nThe seat at row %d and column %d is assigned to the student\\n\", row, col);\n                student_to_string(&amp;s);\n                classroom_seating_to_string(&amp;a);\n            }\n            else {\n                printf(\"\\nThe seat at row %d and column %d is taken.\\n\", row, col);\n            }\n        }\n        // Read the next studentInfo\n        printf(\"Please enter a student information or enter \\\"Q\\\" to quit.\");\n        // reading a student's information\n        scanf(\"%s\", info);\n\n    }\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "string", "struct"], "comments": [{"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 4, "creation_date": 1517363516, "post_id": 48533256, "comment_id": 84062133, "body": "<code>create_customer</code> doesn&#39;t return, which results in undefined behavior from there on. Turn on compiler warnings."}, {"owner": {"reputation": 1004, "user_id": 1692517, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/893889b69fb20b6f02e3cb7a182e1c47?s=128&d=identicon&r=PG", "display_name": "user1692517", "link": "https://stackoverflow.com/users/1692517/user1692517"}, "reply_to_user": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1517363583, "post_id": 48533256, "comment_id": 84062155, "body": "@deidei Thanks! that was it."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1517375528, "post_id": 48533256, "comment_id": 84065084, "body": "when posting about a run time problem, as this question is doing, post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can easily reproduce the problem."}], "answers": [{"comments": [{"owner": {"reputation": 716, "user_id": 2031180, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jkKlR.jpg?s=128&g=1", "display_name": "campescassiano", "link": "https://stackoverflow.com/users/2031180/campescassiano"}, "edited": false, "score": 0, "creation_date": 1517373685, "post_id": 48533349, "comment_id": 84064518, "body": "You must allocate a new customer, this is returning the customer which is in stack and will not be valid anymore."}], "tags": [], "owner": {"reputation": 109, "user_id": 7339040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/718ddf85bede62c9cadb0ea47e441838?s=128&d=identicon&r=PG&f=1", "display_name": "rrkjonnapalli", "link": "https://stackoverflow.com/users/7339040/rrkjonnapalli"}, "is_accepted": false, "score": 0, "last_activity_date": 1517364141, "creation_date": 1517364141, "answer_id": 48533349, "question_id": 48533256, "link": "https://stackoverflow.com/questions/48533256/c-print-function-not-printing/48533349#48533349", "title": "C - print function not printing?", "body": "<p>You're not returning customer.</p>\n\n<pre><code>CustomerType create_customer(char* fname, char* lname) {\n    CustomerType customer;\n    strcpy(customer.firstName, fname);\n    strcpy(customer.lastName, lname);\n    return customer; \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 716, "user_id": 2031180, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jkKlR.jpg?s=128&g=1", "display_name": "campescassiano", "link": "https://stackoverflow.com/users/2031180/campescassiano"}, "is_accepted": false, "score": 0, "last_activity_date": 1517374455, "last_edit_date": 1517374455, "creation_date": 1517373862, "answer_id": 48534641, "question_id": 48533256, "link": "https://stackoverflow.com/questions/48533256/c-print-function-not-printing/48534641#48534641", "title": "C - print function not printing?", "body": "<p>You are not returning the customer from the function <code>create_customer</code>. Nonetheless, you must allocate the customer dynamically. Besides that, I also encourage you to check the string sizes before you copy them, otherwise a overflow may happen. Here is the code:</p>\n\n<pre><code>CustomerType create_customer(char* fname, char* lname) {\n    /* allocate a new customer */\n    CustomerType *c = malloc(sizeof(CustomerType)); /\n\n    /* ensure the string size before copying it */\n    int size_str_to_copy = (strlen(fname) &gt;= MAX_STR) ? MAX_STR : strlen(fname);\n    /* copy the string with the safe size */\n    strncpy(c-&gt;firstName, fname, size_str_to_copy);\n\n    /* ensure the string size before copying it */\n    size_str_to_copy = (strlen(lname) &gt;= MAX_STR) ? MAX_STR : strlen(lname);\n    /* copy the string with the safe size */\n    strncpy(c-&gt;lastName, lname, size_str_to_copy);\n\n    /* return the allocated customer pointer */\n    return customer; \n}\n</code></pre>\n\n<p>Also, don't forget to free the created customers.</p>\n"}], "owner": {"reputation": 1004, "user_id": 1692517, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/893889b69fb20b6f02e3cb7a182e1c47?s=128&d=identicon&r=PG", "display_name": "user1692517", "link": "https://stackoverflow.com/users/1692517/user1692517"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 345, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1517374455, "creation_date": 1517363361, "question_id": 48533256, "link": "https://stackoverflow.com/questions/48533256/c-print-function-not-printing", "title": "C - print function not printing?", "body": "<p>I'm trying to print a string value for one of my structs but it is printing out nothing, even though it compiles. Was wondering if someone can help me point out where I went wrong with my function.</p>\n\n<pre><code>typedef struct {\n    char        firstName[MAX_STR];\n    char        lastName[MAX_STR];\n    int         numVehicles;\n    VehicleType cars[MAX_VEHICLES];\n} CustomerType;\n\nvoid print_customer(CustomerType *c) {\n    printf(\"%s %s, \\n\", c-&gt;firstName, c-&gt;lastName);\n}\n\nCustomerType create_customer(char* fname, char* lname) {\n    CustomerType customer;\n    strcpy(customer.firstName, fname);\n    strcpy(customer.lastName, lname);\n}\n\nint main() {\n    CustomerType customers[MAX_CUSTOMERS];\n    customers[0] = create_customer(\"John\", \"Bob\");\n    print_customer(&amp;customers[0]);\n    return 0;\n}\n</code></pre>\n\n<p>I think my problem is that I'm not calling the string value correctly in my print function. </p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 2, "creation_date": 1517363650, "post_id": 48533248, "comment_id": 84062171, "body": "Not to put too fine a point on it, it is undefined behavior to modify a string literal in C."}, {"owner": {"reputation": 1505, "user_id": 4344586, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zmULe.png?s=128&g=1", "display_name": "Frank AK", "link": "https://stackoverflow.com/users/4344586/frank-ak"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1517363865, "post_id": 48533248, "comment_id": 84062225, "body": "But why the other <code>test_3</code> and <code>test_4</code> can be modify?"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1517364038, "post_id": 48533248, "comment_id": 84062272, "body": "<code>p3[]</code> is an array of <code>char</code>, which you <i>can</i> modify (here, <code>char p3[] = &quot;dddddd&quot;;</code> <i>initializes</i> <code>p3</code> with the contents of the string literal, but <code>p3</code> itself is not a string literal). <code>p4</code> points to a dynamic allocation of <code>char</code>, which you can also modify. Note that on some old systems string literals <i>could</i> be modified, but the C Standard specifies that this is undefined behavior."}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 1, "creation_date": 1517364203, "post_id": 48533248, "comment_id": 84062310, "body": "<code>sizeof(&quot;dddddd&quot;)</code> is basically the same as <code>sizeof(char*)</code>, not <code>strlen(&quot;dddddd&quot;)</code>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1517364570, "post_id": 48533248, "comment_id": 84062397, "body": "<code>p1</code> is pointing to read-only memory, even if you didn&#39;t use <code>const</code>. All string literals are read-only."}, {"owner": {"reputation": 1505, "user_id": 4344586, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zmULe.png?s=128&g=1", "display_name": "Frank AK", "link": "https://stackoverflow.com/users/4344586/frank-ak"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1517364621, "post_id": 48533248, "comment_id": 84062410, "body": "But this answer no clearly why and which section the memory layout . @Pablo"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1517364676, "post_id": 48533248, "comment_id": 84062425, "body": "@FrankAK what? I don&#39;t understand you"}, {"owner": {"reputation": 1505, "user_id": 4344586, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zmULe.png?s=128&g=1", "display_name": "Frank AK", "link": "https://stackoverflow.com/users/4344586/frank-ak"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1517365637, "post_id": 48533248, "comment_id": 84062649, "body": "@Pablo I have update my question with some asm code, which output from <code>gcc -S</code>, i want to know the layout of each pointer at the memory ! like my asm code show."}], "answers": [{"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 2, "creation_date": 1517365761, "post_id": 48533430, "comment_id": 84062684, "body": "Arrays are not &quot;constant pointers.&quot;"}], "tags": [], "owner": {"reputation": 100, "user_id": 8943195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ORuS.png?s=128&g=1", "display_name": "Hamza Jadid", "link": "https://stackoverflow.com/users/8943195/hamza-jadid"}, "is_accepted": false, "score": 0, "last_activity_date": 1517364909, "creation_date": 1517364909, "answer_id": 48533430, "question_id": 48533248, "link": "https://stackoverflow.com/questions/48533248/whats-different-between-pointer-with-array-in-c/48533430#48533430", "title": "What&#39;s different between pointer with array in c?", "body": "<p>Arrays are constant pointer, which means that an array points to a memory address and you cant change were it points. But you can change the elements in it.</p>\n\n<p>While you can change where the pointer points, but it's elements are constant.</p>\n\n<p>for example consider this code</p>\n\n<pre><code>int main(){\nint a[] = {1,2,3};\nint * ptr = {1,2,3};\n\n//a[0] == *(a+0)\n//a[1] == *(a+1)\n\na += 1; // this is wrong, because we cant change were array points\nptr += 1; // this is correct, now the pointer ptr will points to the next element which is 2\n\na[0] += 2 // this is correct, now a[0] will become 3\n*ptr += 2 // this is wrong, because we cant change the elements of the pointer.\nreturn 0;\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1505, "user_id": 4344586, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zmULe.png?s=128&g=1", "display_name": "Frank AK", "link": "https://stackoverflow.com/users/4344586/frank-ak"}, "edited": false, "score": 0, "creation_date": 1517365862, "post_id": 48533518, "comment_id": 84062713, "body": "Thank you , awesome answer"}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1517366132, "last_edit_date": 1517366132, "creation_date": 1517365542, "answer_id": 48533518, "question_id": 48533248, "link": "https://stackoverflow.com/questions/48533248/whats-different-between-pointer-with-array-in-c/48533518#48533518", "title": "What&#39;s different between pointer with array in c?", "body": "<p>So</p>\n\n<pre><code>char * p1 = \"dddddd\";\n</code></pre>\n\n<p>this should be</p>\n\n<pre><code>const char * p1 = \"dddddd\";\n</code></pre>\n\n<p>String literals (the ones in quotes) reside in read-only memory. Even if you\ndon't use the <code>const</code> keyword in the declaration of the variable, <code>p1</code> still\npoints to read-only memory. So</p>\n\n<pre><code>*(p1+2) = 'b'; // test_1\n</code></pre>\n\n<p>is going to fail.</p>\n\n<p>Here</p>\n\n<pre><code>*(p2+2) = 'b'; // test_2\n// Output &gt;&gt; char_point.c:11:13: error: read-only variable is not assignable\n</code></pre>\n\n<p>the compiler tells you, you cannot do that because you declared <code>p2</code> as <code>const</code>.\nThe difference between the first test and this one, is that the code <em>tries</em> to\nmodify a character and fails.</p>\n\n<p>Now this:</p>\n\n<pre><code>char * p4 =(char*)malloc(sizeof(\"dddddd\")+1);\n</code></pre>\n\n<p>First, do not cast <code>malloc</code> &amp; friends. Second: the <code>sizeof</code>-operator returns the\nnumber of bytes needed to store the expression in memory. <code>\"ddddd\"</code> is a string\nliteral, it returns a pointer to <code>char</code>, so <code>sizeof(\"dddddd\")</code> returns the number\nof bytes that a pointer to <code>char</code> needs to be stored in memory.</p>\n\n<p>The correct function would be <code>strlen</code>:</p>\n\n<pre><code>char * p4 = malloc(strlen(\"dddddd\")+1);\n</code></pre>\n\n<p>Note that in this case</p>\n\n<pre><code>char txt[] = \"Hello world\";\nprintf(\"%lu\\n\", sizeof(txt));\n</code></pre>\n\n<p>will print 12 and not 11. C strings are <code>'\\0'</code>-terminated, that means that <code>txt</code>\nholds all these characters <strong>plus</strong> the <code>'\\0'</code>-terminating byte. In this case\n<code>sizeof</code> doesn't return the number of bytes for a pointer, because <code>txt</code> is an\narray.</p>\n\n<pre><code>void foo(char *txt)\n{\n    printf(\"%lu\\n\", sizeof(txt));\n}\n\nvoid bar(void)\n{\n    char txt[] = \"Hello world\";\n    foo(txt);\n}\n</code></pre>\n\n<p>Here you won't get 12 like before, most probably 8 (today's common size for a\npointer). Even though <code>txt</code> in <code>bar</code> is an array, the <code>txt</code> in <code>foo</code> is a\npointer.</p>\n"}, {"comments": [{"owner": {"reputation": 1505, "user_id": 4344586, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zmULe.png?s=128&g=1", "display_name": "Frank AK", "link": "https://stackoverflow.com/users/4344586/frank-ak"}, "edited": false, "score": 0, "creation_date": 1517365926, "post_id": 48533535, "comment_id": 84062731, "body": "Thank you sir! i have read your link! it&#39;s good but no easy to understand!"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 1505, "user_id": 4344586, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zmULe.png?s=128&g=1", "display_name": "Frank AK", "link": "https://stackoverflow.com/users/4344586/frank-ak"}, "edited": false, "score": 0, "creation_date": 1517365987, "post_id": 48533535, "comment_id": 84062746, "body": "It may take a while to get used to reading Standardese, but it is worth it if you plan to do much programming in C ;)"}, {"owner": {"reputation": 1505, "user_id": 4344586, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zmULe.png?s=128&g=1", "display_name": "Frank AK", "link": "https://stackoverflow.com/users/4344586/frank-ak"}, "edited": false, "score": 1, "creation_date": 1517366037, "post_id": 48533535, "comment_id": 84062764, "body": "<code>C</code> look simple , but no easy to deep in ~"}], "tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 2, "last_activity_date": 1517365650, "last_edit_date": 1592644375, "creation_date": 1517365650, "answer_id": 48533535, "question_id": 48533248, "link": "https://stackoverflow.com/questions/48533248/whats-different-between-pointer-with-array-in-c/48533535#48533535", "title": "What&#39;s different between pointer with array in c?", "body": "<h2>&quot;Why <code>p1</code> can't be modified?&quot;</h2>\n<p>Roughly speaking, <code>p1</code> points to a string literal, and attempts to modify string literals cause undefined behavior in C.</p>\n<p>More specifically, according to the <a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#6.4.5p6\" rel=\"nofollow noreferrer\">\u00a76.4.5 6 of the C11 Standard</a>, string literals are:</p>\n<blockquote>\n<p>used to initialize an array of static storage duration and length just sufficient to contain the sequence. For character string literals, the array elements have type <code>char</code>....</p>\n</blockquote>\n<p>Concerning objects with <code>static</code> storage duration, <a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#5.1.2p1\" rel=\"nofollow noreferrer\">\u00a75.1.2 1 states that</a></p>\n<blockquote>\n<p>All objects with static storage duration shall be initialized (set to their initial values) before program startup. The manner and timing of such initialization are otherwise unspecified.</p>\n</blockquote>\n<h2>&quot;Which section of memory it's layout?&quot;</h2>\n<p>But, the Standard does not specify any specific memory layouts that an implementation must follow.</p>\n<p>What the Standard <em>does</em> say about the arrays of <code>char</code> which are created from string literals is that (<a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#6.4.5p7\" rel=\"nofollow noreferrer\">\u00a76.4.5 7</a>):</p>\n<blockquote>\n<p>It is unspecified whether these arrays are distinct provided their elements have the appropriate values. <strong>If the program attempts to modify such an array, the behavior is undefined.</strong></p>\n</blockquote>\n"}], "owner": {"reputation": 1505, "user_id": 4344586, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zmULe.png?s=128&g=1", "display_name": "Frank AK", "link": "https://stackoverflow.com/users/4344586/frank-ak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "closed_date": 1517497957, "accepted_answer_id": 48533518, "answer_count": 3, "score": 0, "last_activity_date": 1517366132, "creation_date": 1517363293, "last_edit_date": 1517364957, "question_id": 48533248, "link": "https://stackoverflow.com/questions/48533248/whats-different-between-pointer-with-array-in-c", "closed_reason": "Duplicate", "title": "What&#39;s different between pointer with array in c?", "body": "<p>I try to google this topic, but no one can explain clear. I try the below code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char * argv[]){\n\n    char * p1 = \"dddddd\";\n    const char * p2 = \"dddddd\";\n    char p3[] = \"dddddd\";\n    char * p4 =(char*)malloc(sizeof(\"dddddd\")+1);\n    strcpy(p4, \"dddddd\");\n    //*(p1+2) = 'b'; // test_1\n    //Output &gt;&gt;  Bus error: 10\n\n    // *(p2+2) = 'b'; // test_2\n    // Output &gt;&gt; char_point.c:11:13: error: read-only variable is not assignable\n    *(p3+2) = 'b'; // test_3\n    // Output &gt;&gt;\n    //d\n    //dddddd\n    //dddddd\n    //ddbddd\n\n    *(p4+2) = 'k'; // test_4\n    // Output &gt;&gt;\n    //d\n    //dddddd\n    //dddddd\n    //ddbddd\n    //ddkddd\n\n    printf(\"%c\\n\", *(p1+2));\n    printf(\"%s\\n\", p1);\n    printf(\"%s\\n\", p2);\n    printf(\"%s\\n\", p3);\n    printf(\"%s\\n\", p4);\n\n    return 0;\n}\n</code></pre>\n\n<p>I have try 3 tests, but only the <code>test_3</code> and <code>test_4</code> can pass. I know <code>const char *p2</code> is read only, because it's a constant value! but i don't know why <code>p1</code> can't be modified! which section of memory it's layout? BTW, I compile it on my Mac with <code>GCC</code>.</p>\n\n<p>I try to compile it to dis-asm it by <code>gcc -S</code>, I got this.</p>\n\n<pre><code>.section    __TEXT,__text,regular,pure_instructions\n.macosx_version_min 10, 13\n.globl  _main\n.p2align    4, 0x90\n_main:                                  ## @main\n    .cfi_startproc\n## BB#0:\n    pushq   %rbp\nLcfi0:\n    .cfi_def_cfa_offset 16\nLcfi1:\n    .cfi_offset %rbp, -16\n    movq    %rsp, %rbp\nLcfi2:\n    .cfi_def_cfa_register %rbp\n    subq    $48, %rsp\n    movl    $8, %eax\n    movl    %eax, %ecx\n    leaq    L_.str(%rip), %rdx\n    movl    $0, -4(%rbp)\n    movl    %edi, -8(%rbp)\n    movq    %rsi, -16(%rbp)\n    movq    %rdx, -24(%rbp)\n    movq    %rdx, -32(%rbp)\n    movl    L_main.p3(%rip), %eax\n    movl    %eax, -39(%rbp)\n    movw    L_main.p3+4(%rip), %r8w\n    movw    %r8w, -35(%rbp)\n    movb    L_main.p3+6(%rip), %r9b\n    movb    %r9b, -33(%rbp)\n    movq    %rcx, %rdi\n    callq   _malloc\n    xorl    %r10d, %r10d\n    movq    %rax, -48(%rbp)\n    movl    %r10d, %eax\n    addq    $48, %rsp\n    popq    %rbp\n    retq\n    .cfi_endproc\n\n    .section    __TEXT,__cstring,cstring_literals\nL_.str:                                 ## @.str\n    .asciz  \"dddddd\"\n\nL_main.p3:                              ## @main.p3\n    .asciz  \"dddddd\"\n\n\n.subsections_via_symbols\n</code></pre>\n\n<p>I want to know every pointer what i declaration, which section is it?</p>\n"}, {"tags": ["c", "exploit"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1517370985, "post_id": 48533235, "comment_id": 84063879, "body": "What happens if the calculation <code>sizeof(struct data)*numElems</code> overflows?"}, {"owner": {"reputation": 778, "user_id": 1008134, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/osZGs.png?s=128&g=1", "display_name": "penu", "link": "https://stackoverflow.com/users/1008134/penu"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1517378572, "post_id": 48533235, "comment_id": 84066193, "body": "Oh, are you suggesting to specify a numElem which will cause interger overflow in such a way that we can access a free chunk?"}, {"owner": {"reputation": 432, "user_id": 7245173, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-gktj-toDgUk/AAAAAAAAAAI/AAAAAAAAAj0/4ZKPOh6tRbc/photo.jpg?sz=128", "display_name": "Emil Terman", "link": "https://stackoverflow.com/users/7245173/emil-terman"}, "edited": false, "score": 0, "creation_date": 1517386321, "post_id": 48533235, "comment_id": 84069672, "body": "<code>arr[numElements]</code> is not allocated. Use valgrind to detect Invalid Read."}], "owner": {"reputation": 778, "user_id": 1008134, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/osZGs.png?s=128&g=1", "display_name": "penu", "link": "https://stackoverflow.com/users/1008134/penu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1517363238, "creation_date": 1517363238, "question_id": 48533235, "link": "https://stackoverflow.com/questions/48533235/exploiting-malloc-by-specifying-number-of-elems", "title": "Exploiting malloc by specifying number of elems", "body": "<p>I'm trying to understand this heap overflow exploit. Say I have the following code:</p>\n\n<pre><code>struct data *arr = malloc(sizeof(struct data)*numElems);\n/*... use arr[0], arr[1], etc if arr is not NULL*/\n</code></pre>\n\n<p>The attacker has control over numElems.\nI understand this can be exploited by causing a heap overflow to write into arbitrary pointer addresses in the metadata of free chunks. But how is this? The memory given to us by malloc is safe so I'm assuming <code>arr[numElems-n]</code> <code>(n&gt;0;n&lt;=numElems)</code> is also safe. Does the exploit come from accessing <code>arr[numElems]</code> and write into the next block's space?</p>\n"}, {"tags": ["c", "string", "hex"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 2, "creation_date": 1517361175, "post_id": 48532957, "comment_id": 84061584, "body": "A hex representation makes only sense in string form. What do you really want? You want to get a <code>uint8_t</code> array of 4 from the string <code>&quot;6162636465&quot;</code>?"}, {"owner": {"reputation": 41, "user_id": 6919830, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9c683f7caa7954b9772cea00210e62bd?s=128&d=identicon&r=PG&f=1", "display_name": "anush95", "link": "https://stackoverflow.com/users/6919830/anush95"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1517361260, "post_id": 48532957, "comment_id": 84061607, "body": "Yes, as I am using it to do bitwise operations."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1517361839, "post_id": 48532957, "comment_id": 84061726, "body": "After the <code>strcpy(str, argv[1])</code>, the contents of <code>str</code> are as you requested."}, {"owner": {"reputation": 1211, "user_id": 1509809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2be13fa9f78f64b8f3ca00f7d1c988d?s=128&d=identicon&r=PG", "display_name": "thuyein", "link": "https://stackoverflow.com/users/1509809/thuyein"}, "edited": false, "score": 0, "creation_date": 1517361924, "post_id": 48532957, "comment_id": 84061745, "body": "FYI, you can use raw char to do bitwise operation."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517365779, "post_id": 48533067, "comment_id": 84062687, "body": "<code>memcpy(in, &amp;val, in_size * sizeof *in);</code> is a problem if <code>unsigned long val</code> is 4 bytes.  Suggest <code>uint64_t</code> to show your endian point."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517366012, "post_id": 48533067, "comment_id": 84062755, "body": "But val is <code>unsigned long int</code> which is longer than 4 bytes. I guess you only would get in trouble if <code>in_size</code> is longer than <code>unsigned long int</code>. Or am I wrong?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517366169, "post_id": 48533067, "comment_id": 84062798, "body": "C does not specify that <code>unsigned long int</code> is longer than 4 bytes.  Many systems have 4-byte <code>unsigned long int</code>, some use 8.  It is implementation dependent as long at it at least encodes values 0 to 4294967295."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517366271, "post_id": 48533067, "comment_id": 84062816, "body": "@chux thanks for explanation. So it would be better to check that <code>unsigned long int</code> is at least as large as <code>in_size</code> and abort if that&#39;s not the case?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517366334, "post_id": 48533067, "comment_id": 84062830, "body": "Perhaps, various ways to cope with that."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517366674, "post_id": 48533067, "comment_id": 84062899, "body": "@chux thanks for the feedback, I&#39;ve updated my answer."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 1, "last_activity_date": 1517366652, "last_edit_date": 1517366652, "creation_date": 1517361818, "answer_id": 48533067, "question_id": 48532957, "link": "https://stackoverflow.com/questions/48532957/writing-a-string-to-hex-convertor/48533067#48533067", "title": "Writing a string to hex convertor", "body": "<p>Assuming that your string with the hex representation is always of the same\nlength and that you have padding zeros:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;string.h&gt;\n\nuint8_t hexchar_to_dec(char x)\n{\n    if(x &gt;= '0' &amp;&amp; x &lt;= '9')\n        return x - '0';\n\n    x = tolower(x);\n\n    if(x &gt;= 'a' &amp;&amp; x &lt;= 'f')\n        return 10 + x - 'a';\n\n    return 0;\n}\n\nint main(void)\n{\n\n    char hex[] = \"6162636465\";\n    char *tmp_hex = NULL;\n\n    uint8_t *in;\n\n    size_t hexlen = strlen(hex);\n\n    size_t in_size = hexlen / 2;\n\n    // the padding zero is missing, adding at the\n    // beginning\n    if(hexlen % 2)\n    {\n        tmp_hex = calloc(hexlen + 2, 1);\n        if(tmp_hex == NULL)\n            return 1;\n        *tmp_hex = '0';\n        strcat(tmp_hex, hex);\n        in_size++;\n    } else\n        tmp_hex = hex;\n\n\n\n    in = calloc(in_size, sizeof *in);\n    if(in == NULL)\n    {\n        if(tmp_hex != hex)\n            free(tmp_hex);\n        return 1;\n    }\n\n    for(size_t i = 0; i &lt; hexlen; i = i+2)\n        in[i/2] = 16*hexchar_to_dec(tmp_hex[i]) + hexchar_to_dec(tmp_hex[i+1]);\n\n    for(size_t i = 0; i &lt; in_size; ++i)\n        printf(\"in[%lu] = 0x%02x\\n\", i, in[i]);\n\n    free(in);\n    if(tmp_hex != hex)\n        free(tmp_hex);\n\n    return 0;\n}\n</code></pre>\n\n<p>Here I'm using the fact that for <code>'1' == '0' + 1</code> because of the ASCII code. My\ncode also takes into account when the hex string is missing a padding 0.</p>\n\n<p>Output:</p>\n\n<pre><code>in[0] = 0x61\nin[1] = 0x62\nin[2] = 0x63\nin[3] = 0x64\nin[4] = 0x65\n</code></pre>\n\n<p><strong>edit</strong></p>\n\n<p>Another way would be using <code>strtoul</code> and <code>memcpy</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;string.h&gt;\n\nuint8_t hexchar_to_dec(char x)\n{\n    if(x &gt;= '0' &amp;&amp; x &lt;= '9')\n        return x - '0';\n\n    x = tolower(x);\n\n    if(x &gt;= 'a' &amp;&amp; x &lt;= 'f')\n        return 10 + x - 'a';\n\n    return 0;\n}\n\nint main(void)\n{\n\n    char hex[] = \"6162636465\";\n\n    uint8_t *in;\n\n    size_t hexlen = strlen(hex);\n\n    size_t in_size = hexlen / 2;\n\n    // the padding zero is missing, adding at the\n    // beginning\n    if(hexlen % 2)\n        in_size++;\n\n    if(sizeof(unsigned long int) &lt; (in_size * sizeof *in))\n    {\n        fprintf(stderr, \"Hex value too large for unsigned long int. Aborting\\n\");\n        return 1;\n    }\n\n    in = calloc(in_size, sizeof *in);\n    if(in == NULL)\n        return 1;\n\n\n    unsigned long int val = strtoul(hex, NULL, 16);\n    memcpy(in, &amp;val, in_size * sizeof *in);\n\n    for(size_t i = 0; i &lt; in_size; ++i)\n        printf(\"in[%lu] = 0x%02x\\n\", i, in[i]);\n\n    free(in);\n\n    return 0;\n}\n</code></pre>\n\n<p>The downside of this is that the order of the bytes in <code>in</code> would depend on the\nendianness. In my computer I get</p>\n\n<pre><code>in[0] = 0x65\nin[1] = 0x64\nin[2] = 0x63\nin[3] = 0x62\nin[4] = 0x61\n</code></pre>\n\n<p><strong>edit</strong></p>\n\n<p>I've added this check</p>\n\n<pre><code>    if(sizeof(unsigned long int) &lt; (in_size * sizeof *in))\n    {\n        fprintf(stderr, \"Hex value too large for unsigned long int. Aborting\\n\");\n        return 1;\n    }\n</code></pre>\n\n<p>as user chux pointed out in the comments, the <code>memcpy</code> call would overflow if\nthe size of the <code>unsigned long int</code> is smaller than the number of bytes\nallocated for <code>in</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517366391, "post_id": 48533489, "comment_id": 84062839, "body": "Agreed, who speaks <code>&#39;W&#39;</code> anyway."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 2, "last_activity_date": 1517366442, "last_edit_date": 1517366442, "creation_date": 1517365357, "answer_id": 48533489, "question_id": 48532957, "link": "https://stackoverflow.com/questions/48532957/writing-a-string-to-hex-convertor/48533489#48533489", "title": "Writing a string to hex convertor", "body": "<p>If you are looking to store the bytes:</p>\n\n<blockquote>\n<pre><code>0x61, 0x62, 0x63, 0x64, 0x65\n</code></pre>\n</blockquote>\n\n<p>In your array of <code>uint8_t</code> from <code>abcde</code>, you are not preforming any type of hex conversion, you are simply storing the ASCII values for <code>a, b, c, d, e</code> in your array. If that is you goal, you can do it simply by assigning the value of each character to your array, e.g.:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;inttypes.h&gt;\n\nint main (int argc, char **argv) {\n\n    if (argc &lt; 2) {\n        fprintf (stderr, \"error: insufficient input, %s &lt;hexval&gt;\\n\", argv[0]);\n        return 1;\n    }\n    char *s = argv[1];\n    size_t i = 0, \n        len = strlen (s);\n    uint8_t bytes[len];\n\n    for (i = 0; i &lt; len; i++)\n        bytes[i] = s[i];       /* simply store the ASCII value of each char */\n\n    for (i = 0; i &lt; len; i++)\n        printf (\" 0x%02\" PRIx8, bytes[i]);\n    putchar ('\\n');\n\n    return 0;\n}\n</code></pre>\n\n<p>(above the <code>uint8_t bytes[]</code> array contains the ASCII values for your input)</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/strtoasciibytes abcde\n 0x61 0x62 0x63 0x64 0x65\n</code></pre>\n\n<p>If you need to validate and convert the characters to their <em>\"hex\"</em> values, then you can simply convert the digits to lowercase and for <code>0-9</code>, just assign <code>s[i] - '0'</code> and for <code>a-f</code> store <code>s[i] - 'a' + 10</code>. If the character doesn't fit either of those ranges after a conversion to lowercase, then it is not a hex character. (and note a byte can be comprised of 2-characters)</p>\n\n<p>Let me know if that is what you were attempting or whether you actually need to convert each single character to its hex as opposed to ASCII value.</p>\n"}], "owner": {"reputation": 41, "user_id": 6919830, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9c683f7caa7954b9772cea00210e62bd?s=128&d=identicon&r=PG&f=1", "display_name": "anush95", "link": "https://stackoverflow.com/users/6919830/anush95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1517366652, "creation_date": 1517361019, "question_id": 48532957, "link": "https://stackoverflow.com/questions/48532957/writing-a-string-to-hex-convertor", "title": "Writing a string to hex convertor", "body": "<p>I tried writing a string to hex converter and was successful in the conversion</p>\n\n<pre><code>input : abcde\n</code></pre>\n\n<p>But the output is a string type </p>\n\n<pre><code>Output : \"6162636465\"\n</code></pre>\n\n<p>I need the converted value to be in the following form :</p>\n\n<pre><code>uint8_t in[] = { 0x61, 0x62, 0x63, 0x64, 0x65}\n</code></pre>\n\n<p>How do I switch it from a string to a uint8</p>\n\n<p>The code is as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char *argv[] )\n{\n    unsigned char str[100],strH[200];\n    int i,j;\n    strcpy(str, argv[1]);\n    //printf(\"Enter string: \");\n    //scanf(\"%[^\\n]s\",str);\n\n    printf(\"\\nString is: %s\\n\",str);\n\n    /*set strH with nulls*/\n    memset(strH,0,sizeof(strH));\n\n    /*converting str character into Hex and adding into strH*/\n    for(i=0,j=0;i&lt;strlen(str);i++,j+=2)\n    {\n        sprintf((char*)strH+j,\"%02X\",str[i]);\n    }\n    strH[j]='\\0'; /*adding NULL in the end*/\n\n    printf(\"Hexadecimal converted string is: \\n\");\n    printf(\"%s\\n\",strH);\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "unix", "operating-system"], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1517361213, "creation_date": 1517361213, "answer_id": 48532987, "question_id": 48532708, "link": "https://stackoverflow.com/questions/48532708/setpgid-for-child-process-no-such-process/48532987#48532987", "title": "setpgid for Child Process: No Such Process", "body": "<p>You get an error when you sleep because the child process has exited and no longer exists.  You can\u2019t do anything to a zombie process except call <code>wait</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 581, "user_id": 8093676, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e4a097e527c8390afa006bedd7cc19e4?s=128&d=identicon&r=PG&f=1", "display_name": "K.Miao", "link": "https://stackoverflow.com/users/8093676/k-miao"}, "edited": false, "score": 0, "creation_date": 1517363327, "post_id": 48533161, "comment_id": 84062089, "body": "Suppose I change the PGID of child process before it exits. Now the child process and parent process have different PGID. Which one is the foreground group?"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "reply_to_user": {"reputation": 581, "user_id": 8093676, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e4a097e527c8390afa006bedd7cc19e4?s=128&d=identicon&r=PG&f=1", "display_name": "K.Miao", "link": "https://stackoverflow.com/users/8093676/k-miao"}, "edited": false, "score": 0, "creation_date": 1517365092, "post_id": 48533161, "comment_id": 84062531, "body": "At any  time,  only one of the process groups in the session can be the foreground process  group  for  the  terminal;  the  remaining process  groups  are in the background."}], "tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": true, "score": 0, "last_activity_date": 1517362597, "creation_date": 1517362597, "answer_id": 48533161, "question_id": 48532708, "link": "https://stackoverflow.com/questions/48532708/setpgid-for-child-process-no-such-process/48533161#48533161", "title": "setpgid for Child Process: No Such Process", "body": "<p>when <code>sleep</code> occurs while <code>parents</code> executing it switches to <code>child</code> process and in child process <code>execvp</code> replace current process with new one and it's get exited. When it comes back to parent after <code>2 seconds</code> child process is not in existence  that why <code>setpgid</code> fails. </p>\n\n<pre><code>CHECK(setpgid(ls_pid, ls_pid), \"setpgid error\");\n</code></pre>\n\n<p>As you can see from the man page of <code>setpgid</code>, Its an <code>EACCES</code> error</p>\n\n<p><em>An attempt was made to change the process group  ID  of\n              one  of  the  children  of  the calling process and the\n              <strong>child had already performed  an  execve(2)  (setpgid()</strong>,\n              setpgrp()).</em></p>\n"}], "owner": {"reputation": 581, "user_id": 8093676, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e4a097e527c8390afa006bedd7cc19e4?s=128&d=identicon&r=PG&f=1", "display_name": "K.Miao", "link": "https://stackoverflow.com/users/8093676/k-miao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 598, "favorite_count": 0, "accepted_answer_id": 48533161, "answer_count": 2, "score": 0, "last_activity_date": 1517362597, "creation_date": 1517358974, "last_edit_date": 1517359338, "question_id": 48532708, "link": "https://stackoverflow.com/questions/48532708/setpgid-for-child-process-no-such-process", "title": "setpgid for Child Process: No Such Process", "body": "<p>I'm not sure why I get such error on my computer. I've tested the code on some other computers. It works well.</p>\n\n<p>If I remove <code>sleep(2)</code>, it works. I think I should be able to set the PGID for the zombie process. Does it depend on OS implementation?</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n#define CHECK(syscall, msg) do {                    \\\n    if ((syscall) == -1) {                          \\\n      perror(msg);                                  \\\n      _exit(1);                                     \\\n    }                                               \\\n  } while(0)\n\n#define SAFE_CLOSE_NOT_STD(fd) do {                                 \\\n    if (fd != STDIN_FILENO &amp;&amp; fd != STDOUT_FILENO &amp;&amp; fd != -1) {    \\\n      CHECK(close(fd), \"close error\");                              \\\n      fd = -1;                                                      \\\n    }                                                               \\\n  } while(0)\n\nint main () {\n  int ls_pid;\n  char *ls_argv[] = { \"ls\", NULL };\n\n  CHECK(ls_pid = fork(), \"fork error\");\n  if (!ls_pid) {\n    CHECK(setpgid(0, 0), \"child setpgid error\");\n    CHECK(execvp(ls_argv[0], ls_argv), \"execve error\");\n  } else {\n    printf(\"child pid:%d\\n\", ls_pid);\n    sleep(2); // no error arises if I remove this line\n    CHECK(setpgid(ls_pid, ls_pid), \"setpgid error\"); // error here\n  }\n  CHECK(wait(NULL), \"wait error\");\n\n  printf(\"Finish\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "multidimensional-array"], "comments": [{"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 0, "creation_date": 1517357433, "post_id": 48532407, "comment_id": 84060604, "body": "When you&#39;re copying the name into <code>names[x]</code> just use <code>strncpy</code> (assuming the names are null-terminated). You don&#39;t have to copy if char by char."}, {"owner": {"reputation": 353, "user_id": 4847214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/03941dd267a2f227b0ccaa5a6ba791be?s=128&d=identicon&r=PG&f=1", "display_name": "Suhaib Ahmad", "link": "https://stackoverflow.com/users/4847214/suhaib-ahmad"}, "edited": false, "score": 0, "creation_date": 1517539119, "post_id": 48532407, "comment_id": 84146474, "body": "<code>void read_files(char** names, int size)</code>, using char** means pointer to char pointers, and pass <code>size</code> as 25"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9291734, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2q0Zzpg3y3w/AAAAAAAAAAI/AAAAAAAAARg/TUr3druRPKo/photo.jpg?sz=128", "display_name": "TannerDanger", "link": "https://stackoverflow.com/users/9291734/tannerdanger"}, "edited": false, "score": 0, "creation_date": 1517359739, "post_id": 48532501, "comment_id": 84061217, "body": "&gt; &quot;In memory a 2d array is still a 1d block with fancy addressing.&quot;  Good info, I completely forgot about that. This is helpful for another part of this assignment, thanks."}], "tags": [], "owner": {"reputation": 2928, "user_id": 5927758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QmcMj.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/5927758/mitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1517357409, "creation_date": 1517357409, "answer_id": 48532501, "question_id": 48532407, "link": "https://stackoverflow.com/questions/48532407/how-to-pass-a-2d-char-array-to-another-function/48532501#48532501", "title": "How to pass a 2D Char array to another function?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nvoid read_files(char* names){\n    char newName1[4] = \"mary\";\n    char newName2[4] = \"anna\";\n    for(int i = 0; i &lt; 5; i++){\n        names[i] = newName1[i];\n    }\n    int offset = 25;\n    for(int i = 0; i &lt; 5; i++){\n        names[i + offset] = newName2[i];\n    }\n}\n\n\n\nvoid main(){\n/*\nThis is the value being passed. The first dimension has a size of 1000, \nto account for 1000 different sorted people. Second dimension is an \narray that holds the actual name, with a max name length of 25.\n*/\n    char names[1000][25] = {'\\0'};\n    read_files(names[0]);\n    printf(\"%s %s\", names[0], names[1]);\n}\n</code></pre>\n\n<p>In memory a 2d array is still a 1d block with fancy addressing. So you could have an offset variable and just add it on to every name like I have done here</p>\n"}, {"comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1517357563, "post_id": 48532502, "comment_id": 84060639, "body": "@chux I missed that, I fixed my answer"}, {"owner": {"reputation": 2928, "user_id": 5927758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QmcMj.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/5927758/mitch"}, "edited": false, "score": 0, "creation_date": 1517357758, "post_id": 48532502, "comment_id": 84060675, "body": "I think you mean element. I hope to god strings dont have to be declared in five dimensions"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 2928, "user_id": 5927758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QmcMj.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/5927758/mitch"}, "edited": false, "score": 0, "creation_date": 1517358101, "post_id": 48532502, "comment_id": 84060786, "body": "@Mitchel0022 I meant elements, but declaring an array in 5 dimensions... that would be awesome."}, {"owner": {"reputation": 31, "user_id": 9291734, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2q0Zzpg3y3w/AAAAAAAAAAI/AAAAAAAAARg/TUr3druRPKo/photo.jpg?sz=128", "display_name": "TannerDanger", "link": "https://stackoverflow.com/users/9291734/tannerdanger"}, "edited": false, "score": 0, "creation_date": 1517358508, "post_id": 48532502, "comment_id": 84060893, "body": "good info on the strcpy vs strncpy. Is one better than the other as far as comparison? Because another step is before I copy the name into the name array, I need to make sure it doesn&#39;t exist in one of the other elements."}, {"owner": {"reputation": 2928, "user_id": 5927758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QmcMj.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/5927758/mitch"}, "reply_to_user": {"reputation": 31, "user_id": 9291734, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2q0Zzpg3y3w/AAAAAAAAAAI/AAAAAAAAARg/TUr3druRPKo/photo.jpg?sz=128", "display_name": "TannerDanger", "link": "https://stackoverflow.com/users/9291734/tannerdanger"}, "edited": false, "score": 0, "creation_date": 1517358644, "post_id": 48532502, "comment_id": 84060929, "body": "@TannerDanger strcpy will copy the whole string and strncpy will copy only n bytes. Ones not better than the other, they are just used for different things"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1517358683, "post_id": 48532502, "comment_id": 84060946, "body": "If you know that the destination buffer is large enough to hold the source string, <code>strcpy</code> is fine. However, if you have no guarantee that the destination buffer is large enough, <code>strncpy</code> is safer. However with <code>strncpy</code> you have to make sure that you set the <code>\\0</code> terminating yourself."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1517358783, "last_edit_date": 1517358783, "creation_date": 1517357427, "answer_id": 48532502, "question_id": 48532407, "link": "https://stackoverflow.com/questions/48532407/how-to-pass-a-2d-char-array-to-another-function/48532502#48532502", "title": "How to pass a 2D Char array to another function?", "body": "<p>You would have to define <code>read_files</code> as this:</p>\n\n<pre><code>void read_files(char (*names)[25]) {\n    char newName1[5] = \"mary\";\n    char newName2[5] = \"anna\";\n    for(int i = 0; i &lt; 5; i++){\n        names[0][i] = newName1[i];\n    }\n    for(int i = 0; i &lt; 5; i++){\n        names[1][i] = newName2[i];\n    }   \n}\n</code></pre>\n\n<p>Because you need to pass a pointer to an array of <code>char[25]</code>. A two\ndimensional array cannot be converted into a double-pointer or a single pointer.</p>\n\n<p>Note also that <code>newName1</code> and <code>newName2</code> must be arrays that can hold 5 elements. In C a\nstring is a sequence of characters that ends with the <code>'\\0'</code>-terminating byte.\nThat means that for a string of length <code>n</code>, you need a <code>char</code> array of length\n<code>n+1</code>, because you need the extra byte for the <code>'\\0'</code>-terminating byte.</p>\n\n<p>Also the better way of copying strings is <code>strcpy</code> or <code>strncpy</code>. <code>strncpy</code> is\nmore safe than <code>strcpy</code> because you limit the amount of bytes to be copied, thus\navoiding a buffer overflow. But <code>strncpy</code> might not write the <code>'\\0'</code>-terminating byte\nif there is not enough room.</p>\n\n<p>Instead of:</p>\n\n<pre><code>for(int i = 0; i &lt; 5; i++){\n    names[0][i] = newName1[i];\n}\n</code></pre>\n\n<p>use this:</p>\n\n<pre><code>strcpy(names[0], newName1);\n</code></pre>\n\n<p>Or the <code>strncpy</code> way:</p>\n\n<pre><code>strncpy(names[0], newName1, sizeof names[0]);\nnames[0][sizeof(names[0]) - 1] = 0; // making sure to add the \\0 byte\n</code></pre>\n\n<p>Also bear in mind, that the correct definition of the <code>main</code> function can be\nonly one of these:</p>\n\n<ul>\n<li><code>int main(void);</code></li>\n<li><code>int main(int argc, char **argv);</code></li>\n<li><code>int main(int argc, char *argv[]);</code></li>\n</ul>\n"}], "owner": {"reputation": 31, "user_id": 9291734, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2q0Zzpg3y3w/AAAAAAAAAAI/AAAAAAAAARg/TUr3druRPKo/photo.jpg?sz=128", "display_name": "TannerDanger", "link": "https://stackoverflow.com/users/9291734/tannerdanger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 48532502, "answer_count": 2, "score": 1, "last_activity_date": 1517359855, "creation_date": 1517356858, "last_edit_date": 1592644375, "question_id": 48532407, "link": "https://stackoverflow.com/questions/48532407/how-to-pass-a-2d-char-array-to-another-function", "title": "How to pass a 2D Char array to another function?", "body": "<p>I'm sure this question has been asked before, but I've been searching pretty constantly for the last 2 days and can't solve this, so I'm hoping someone will help me out.</p>\n<p>For my C assignment, we are supposed to receive each function parameter as a pointer. One of the values passed is a 2D char array, and for the last 48+ hours, I haven't been able to find out how to properly do this in my book, notes, instructor slides, etc. and actually make it work.</p>\n<h3>Simplified code of what I'm trying to accomplish</h3>\n<pre><code>void main(){\n/*\nThis is the value being passed. The first dimension has a size of 1000, \nto account for 1000 different sorted people. Second dimension is an \narray that holds the actual name, with a max name length of 25.\n*/\n    char names[1000][25] = {'\\0'};\n    read_files(names);\n}\nvoid read_files(char* names){\n    char newName1[4] = &quot;mary&quot;;\n    char newName2[4] = &quot;anna&quot;;\n    for(int i = 0; i &lt; 5; i++){\n        names[0][i] = newName1[i];\n    }\n    for(int i = 0; i &lt; 5; i++){\n        names[1][i] = newName2[i];\n    }\n}\n</code></pre>\n<p>Basically, I'm trying to get <code>names[0][x]</code> to have <code>x = &quot;mary&quot;</code>, and <code>names[1][x]</code> to have <code>x = &quot;anna&quot;</code>.</p>\n<p>(Or, more literally, <code>names[0][0]= 'm'</code>, <code>names[0][1]= 'a'</code>, etc.)</p>\n<p>Unfortunately I can't get the passing right. The closest I've gotten is to have it assign one name to names, but not anymore.</p>\n<p>Any help with this would be fantastic. There's actually quite a few classmates I'm working with who are all stumped on this. I'm sure its easy for experienced guys, but we just haven't gotten good instruction on how to do it and I can't find many specific examples that address this exact issue.</p>\n<p>As I said, our instructor specifically wants function arguments to be pointers.</p>\n<p><strong>EDIT</strong><br />\nGood info so far, I was very close to a few of these examples. I'll give them a shot and see what works.</p>\n"}, {"tags": ["c", "micropython"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1517355889, "post_id": 48532019, "comment_id": 84060217, "body": "Detail: With <code>printAllBytes(&quot;Kifd&quot;, kifd, sizeof(kifd))</code>, the function does not receive a &quot;a pointer to a byte array&quot; but a &quot;pointer to the first element of the byte array&quot; a <code>byte*</code>.    <code>&amp;Kifd</code> is a &quot;pointer to a byte array&quot;.  Same effective address - different types"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1535610746, "post_id": 48532019, "comment_id": 91130836, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17590226/finding-length-of-array-inside-a-function\">Finding length of array inside a function</a>"}], "answers": [{"tags": [], "owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "is_accepted": false, "score": 3, "last_activity_date": 1517354356, "last_edit_date": 1517354356, "creation_date": 1517354241, "answer_id": 48532038, "question_id": 48532019, "link": "https://stackoverflow.com/questions/48532019/c-only-first-8-bytes-passed-to-function/48532038#48532038", "title": "c only first 8 bytes passed to function", "body": "<p>You've done a poor job of explaining the issue. Are you saying that <code>sizeof(bytes)</code> returns 8?</p>\n\n<p><code>bytes</code> is a pointer, and <code>sizeof(bytes)</code> is returning the size of that pointer. And pointers may be 8 bytes on your system. That has nothing to do with the number of bytes at the address it points to.</p>\n\n<p>In C, when you get a pointer, there is no way to know how many bytes it points to unless you provide that information as another argument or have a special terminating value in the data.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517354647, "post_id": 48532067, "comment_id": 84059813, "body": "Might as well use <code>for (size_t i = 0;...</code>  and <code>printf(&quot;%02hhX&quot;,</code>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1517354891, "post_id": 48532067, "comment_id": 84059885, "body": "@chux Oh yeah, my bad, I just made copy&amp;paste and changed the condition without looking further. I fixed my answer, thanks for the feedback."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 3, "last_activity_date": 1517355157, "last_edit_date": 1517355157, "creation_date": 1517354378, "answer_id": 48532067, "question_id": 48532019, "link": "https://stackoverflow.com/questions/48532019/c-only-first-8-bytes-passed-to-function/48532067#48532067", "title": "c only first 8 bytes passed to function", "body": "<p><code>sizeof(bytes)</code> returns you the number of bytes that a pointer to <code>byte</code> will need to be stored in memory. It doesn't return you the number of bytes that the array pointed to by <code>bytes</code> contains.</p>\n\n<p>For that you need to pass that size to the function:</p>\n\n<pre><code>static void printSomeBytes(char *description, byte *bytes, size_t size)\n{\n    printf(\"\\r\\n%s: \", description);\n    for (size_t i = 0; i &lt; size; ++i )\n    {\n        printf(\"%02X\", bytes[i]); \n    }\n\n    puts(\"\");\n\n}\n</code></pre>\n\n<p><sup><strong>edit</strong></sup><br>\nI also added <code>puts(\"\")</code> there so that the bytes are printed right away. Note\nthat <code>printf</code> is buffered and it won't show the output on the screen unless you flush it\n(<code>fflush(stdout);</code>) by hand or add a <code>'\\n'</code> newline at the end of <code>printf</code>.\n<code>puts(string)</code> is equivalent to <code>printf(\"%s\\n\", string);</code> but without the\noverhead of having to parse the format argument.<br>\n<sup><strong>end edit</strong></sup></p>\n\n<p>And then call it:</p>\n\n<pre><code>byte Kifd[] = { 0x0B, 0x79, 0x52, 0x40, 0xCB, 0x70, 0x49, 0xB0, 0x1C, 0x19, 0xB3, 0x3E, 0x32, 0x80, 0x4F, 0x0B};\n\nprintSomeBytes(\"Kifd\", Kifd, sizeof Kifd / sizeof *Kifd);\n</code></pre>\n\n<p>Also the correct way of getting the number of elements of an array is:</p>\n\n<pre><code>sizeof array / sizeof *array\n</code></pre>\n\n<p>I encourage you to use that formula even when you know that the type is 8bit\nlong. It makes the code more portable.</p>\n"}], "owner": {"reputation": 2654, "user_id": 4279006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0232d2f0c1a1c37cc5f8717871fb88a1?s=128&d=identicon&r=PG", "display_name": "IAmCoder", "link": "https://stackoverflow.com/users/4279006/iamcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "accepted_answer_id": 48532067, "answer_count": 2, "score": -1, "last_activity_date": 1517355157, "creation_date": 1517354095, "question_id": 48532019, "link": "https://stackoverflow.com/questions/48532019/c-only-first-8-bytes-passed-to-function", "title": "c only first 8 bytes passed to function", "body": "<p>I am working on a C module in micropython... if I pass a byte array to a function, only the first 8 bytes make it (according to sizeof). I have to also send in the length, then copy it to access everything in a function.</p>\n\n<pre><code>static void printSomeBytes(char *description, byte *bytes)\n{    \n    printf(\"\\r\\n%s: \", description);\n    for (int i = 0; i &lt; sizeof(bytes); ++i )\n    {\n        printf(\"%02X\", bytes[i]); \n    }\n}\n\nstatic void printAllBytes(char *description, byte *bytes, int length)\n{    \n    byte copy[length];\n    memcpy(copy, bytes, length);\n\n    printf(\"\\r\\n%s: \", description);\n    for (int i = 0; i &lt; sizeof(copy); ++i )\n    {\n        printf(\"%02X\", copy[i]); \n    }\n\n    // this also works without making a copy \n    //for (int i = 0; i &lt; length; ++i )\n    //{\n    //    printf(\"%02X\", bytes[i]); \n    //}\n}\n\nbyte Kifd[] = { 0x0B, 0x79, 0x52, 0x40, 0xCB, 0x70, 0x49, 0xB0, 0x1C, 0x19, 0xB3, 0x3E, 0x32, 0x80, 0x4F, 0x0B};\n\nprintSomeBytes(\"Kifd\", kifd); // prints \"Kifd: 0B795240CB7049B0\"\nprintAllBytes(\"Kifd\", kifd, sizeof(kifd)); // prints \"Kifd: 0B795240CB7049B01C19B33E32804F0B\"\n</code></pre>\n\n<p>What am I doing wrong / is there a better way to send a pointer to a byte array to a function?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1517351092, "post_id": 48531444, "comment_id": 84058562, "body": "Why not?  Lines only mean something to you, not the computer.  It just sees bytes."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1517351095, "post_id": 48531444, "comment_id": 84058564, "body": "I don&#39;t understand your question. What exactly is what you expect <code>scanf</code> to do?"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1517351209, "post_id": 48531444, "comment_id": 84058609, "body": "SCANF never ask for inputs, that\u2019s the programmers Job."}, {"owner": {"reputation": 21, "user_id": 9288064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9jbIy.jpg?s=128&g=1", "display_name": "StuKers", "link": "https://stackoverflow.com/users/9288064/stukers"}, "edited": false, "score": 0, "creation_date": 1517351439, "post_id": 48531444, "comment_id": 84058706, "body": "I expect scanf to ask for an int in every iteration of the loop, but apparently if you give it an input with 3 ints, when size=3, separated by a space it only asks for input the first time."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1517351762, "post_id": 48531444, "comment_id": 84058834, "body": "scanf reads stdin, period. So either what you are typing at the console or the file contents that are piped to stdin. It never &#39;asks&#39; , if there is nothing to read it will just wait (interactive) or fail (from file)"}, {"owner": {"reputation": 21, "user_id": 9288064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9jbIy.jpg?s=128&g=1", "display_name": "StuKers", "link": "https://stackoverflow.com/users/9288064/stukers"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1517352593, "post_id": 48531444, "comment_id": 84059153, "body": "@pm100 thank you. I though scanf really asked for an input, but it just reads what&#39;s given to the console, from what I understood. So in this case it is waiting to read &quot;size&quot; values, but if we write those values all at once, scanf can &quot;get&quot; them all at once too. Thank you."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1517353485, "post_id": 48531444, "comment_id": 84059439, "body": "Any input reading function (like <code>scanf</code>or <code>fgets</code>) tries first to consume input from the input buffer. If there is nothing to consume, it will read from the stream. The case of <code>stdin</code> because it closes only when the program exits (unless you close it yourself) or when the pipe is closed. That&#39;s why the call blocks (on <code>stdin</code>) if there is nothing in the input buffer until the user enters something in the console, thus adding characters to the stream."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1517356169, "post_id": 48531444, "comment_id": 84060292, "body": "<code>scanf()</code> does not read per a <i>line</i> of input, but the <i>stream</i>."}], "answers": [{"comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 2, "creation_date": 1517353198, "post_id": 48531725, "comment_id": 84059340, "body": "The newline character will also be part of the input stream. This is important specially for conversion specifiers like like <code>%s</code>, because the newline will remain in the input buffer."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1517356210, "post_id": 48531725, "comment_id": 84060301, "body": "the input stream contains:<code>&quot;2 4 6 8\\n&quot;</code>"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1517357955, "post_id": 48531725, "comment_id": 84060729, "body": "@chux -- if everyone remembered that the input stream contains newlines, there might only be <a href=\"https://stackoverflow.com/questions/tagged/c\">135,000 questions under the C tag</a>"}], "tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": true, "score": 5, "last_activity_date": 1517352329, "creation_date": 1517352329, "answer_id": 48531725, "question_id": 48531444, "link": "https://stackoverflow.com/questions/48531444/why-can-scanf-read-multiple-inputs-in-a-line-with-a-for-loop/48531725#48531725", "title": "Why can scanf read multiple inputs in a line with a for loop?", "body": "<p>When you type in some numbers on your console and hit ENTER, you are providing an input stream to your code via stdin.  The entire contents of what you type in are kept in that input stream.  So if you type </p>\n\n<p>2 4 6 8</p>\n\n<p>and hit enter, the input stream contains:2 4 6 8</p>\n\n<p>Now, each of your scanfs is only reading (and removing) a single integer from that input stream, so after a single scanf, the stdin input stream now contains: 4 6 8</p>\n\n<p>The extra input is not discarded, it is still available in the input stream, so your next scanf can come along and grab the next integer from the stream, and the next, and the next.....until the data in the input stream is exhausted.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 4, "last_activity_date": 1517368349, "last_edit_date": 1517368349, "creation_date": 1517352357, "answer_id": 48531728, "question_id": 48531444, "link": "https://stackoverflow.com/questions/48531444/why-can-scanf-read-multiple-inputs-in-a-line-with-a-for-loop/48531728#48531728", "title": "Why can scanf read multiple inputs in a line with a for loop?", "body": "<p>This is one of the surprising things about <code>scanf</code>.</p>\n\n<p>If I write</p>\n\n<pre><code>scanf(\"%d %d %d\", &amp;a, &amp;b, &amp;c);\n</code></pre>\n\n<p>it looks like I'm expecting to read a line with three numbers on it.  But if what the user actually types is</p>\n\n<pre><code>1\n2\n3\n</code></pre>\n\n<p>(that is, on three separate lines), it'll \"work\" just fine.  <code>scanf</code> wanted three integers, and it found them, but it had to read three lines in order to do so.</p>\n\n<p>Contrariwise, if I wrote</p>\n\n<pre><code>scanf(\"%d\", &amp;a);\nscanf(\"%d\", &amp;b);\nscanf(\"%d\", &amp;c);\n</code></pre>\n\n<p>and the user typed</p>\n\n<pre><code>4 5 6\n</code></pre>\n\n<p>on one line, again, this'll \"work\" just fine, there were three <code>scanf</code> calls asking for a total of three ints, and there were three ints there -- although they happened to be on one line.</p>\n\n<p>And in your case, your <code>scanf</code> call in a loop has about the same effect as the several separate <code>scanf</code> calls.</p>\n\n<p>The bottom line is that <code>scanf</code> is <em>not</em> line-based.  There is no one-to-one correspondence between calls to <code>scanf</code> and expected lines of input.  <code>scanf</code> does not treat newline characters specially -- they're just treated as whitespace, separating other input fields.</p>\n\n<p>(By way of comparison, <code>printf</code> isn't line-based, either, although it does at least treat <code>\\n</code> characters specially.  But there's no different in output between</p>\n\n<pre><code>printf(\"one \");\nprintf(\"two \");\nprintf(\"three\\n\");\n</code></pre>\n\n<p>and</p>\n\n<pre><code>printf(\"one two three\\n\");\n</code></pre>\n\n<p>.)</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 9288064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9jbIy.jpg?s=128&g=1", "display_name": "StuKers", "link": "https://stackoverflow.com/users/9288064/stukers"}, "edited": false, "score": 0, "creation_date": 1517353674, "post_id": 48531834, "comment_id": 84059487, "body": "This was a thank you comment but I just looked up and I&#39;m not supposed to write those, sorry. Thank you to everyone, though."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1517356400, "post_id": 48531834, "comment_id": 84060345, "body": "Idea: post what <code>stdin</code> looks like after reading <code>5</code> - with the <code>&#39;\\n&#39;</code> still there.  Something often surprising for learners."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 1, "last_activity_date": 1517352952, "creation_date": 1517352952, "answer_id": 48531834, "question_id": 48531444, "link": "https://stackoverflow.com/questions/48531444/why-can-scanf-read-multiple-inputs-in-a-line-with-a-for-loop/48531834#48531834", "title": "Why can scanf read multiple inputs in a line with a for loop?", "body": "<p>After reading the original question, I think I understand what you are asking.</p>\n\n<p>So in the other question the input was:</p>\n\n<pre><code>5&lt;ENTER&gt;\n1 2 3 4 99&lt;ENTER&gt;\n</code></pre>\n\n<p><code>scanf</code> is a function design to read formatted input (the name comes from scan\nformatted), it is not design to read random user input.</p>\n\n<p>To quote the man page of scanf:</p>\n\n<blockquote>\n  <p><em><a href=\"https://linux.die.net/man/3/scanf\" rel=\"nofollow noreferrer\">man scanf</a></em></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint scanf(const char *format, ...);\n</code></pre>\n  \n  <p><strong>DESCRIPTION</strong></p>\n  \n  <p>The <code>scanf()</code> family of functions scans input according to <code>format</code> as described below. This format may contain <code>conversion specifications</code>;\n  the results from such conversions, if any, are stored in the locations pointed to by the pointer arguments that  follow  format.   Each\n  pointer argument must be of a type that is appropriate for the value returned by the corresponding conversion specification.</p>\n</blockquote>\n\n<p>That means that scanf scans the input according to the provided format. The\n<strong>conversion specifier</strong> <code>%d</code> matches an optionally signed decimal integer. If\nyour format contains only <code>\"%d\"</code> it will consume any white-space characters and\ntry to convert the next sequence of non-white-space characters into an <code>signed int</code>. If this is possible, <code>scanf</code> will\nstore the converted integer in the memory pointed to by the passed argument. If\nit fails at converting, it stops scanning and any other character in the input\nbuffer <strong>will remain</strong> in the input buffer.</p>\n\n<p>So let's to this: You enter 3 numbers like this:<br>\n<kbd>3</kbd><kbd>SPACE</kbd><kbd>SPACE</kbd><kbd>4</kbd><kbd>SPACE</kbd><kbd>TAB</kbd><kbd>5</kbd><kbd>ENTER</kbd></p>\n\n<p>Your input buffer will look like this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>+---+---+---+---+---+----+---+----+\n| 3 | \u2423 | \u2423 | 4 | \u2423 | \\t | 5 | \\n |\n+---+---+---+---+---+----+---+----+\n</code></pre>\n\n<p>In the first iteration <code>scanf</code> consume any white-space characters, right now\nthere is none, so it will read 3 and continue with the next character\nwhich is a space. At that point it stops and converts the 3 and stores it in\n<code>&amp;v[i]</code>. The input buffer will look like this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>+---+---+---+---+----+---+----+\n| \u2423 | \u2423 | 4 | \u2423 | \\t | 5 | \\n |\n+---+---+---+---+----+---+----+\n</code></pre>\n\n<p>In the second iteration it will consume any white-space characters. There are\ntwo spaces there and those are just consumed. Then it will read 4, and then a\nwhite-space character. <code>scanf</code> stops and and converts the 4 and stores it in\n<code>&amp;v[i]</code>. The input buffer will look like this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>+---+----+---+----+\n| \u2423 | \\t | 5 | \\n |\n+---+----+---+----+\n</code></pre>\n\n<p>As you can see, in every iteration <code>scanf</code> didn't wait block and wait for the\nuser to enter something, because characters were left in the input buffer from\nthe previous iterations.</p>\n\n<p>And that's why you can have <code>scanf(\"%d\", &amp;v[i])</code> in a loop for an input like\nthis <code>\"1 2 3 4 5\"</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 9288064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9jbIy.jpg?s=128&g=1", "display_name": "StuKers", "link": "https://stackoverflow.com/users/9288064/stukers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1386, "favorite_count": 1, "accepted_answer_id": 48531725, "answer_count": 3, "score": -1, "last_activity_date": 1517368349, "creation_date": 1517350680, "last_edit_date": 1517354318, "question_id": 48531444, "link": "https://stackoverflow.com/questions/48531444/why-can-scanf-read-multiple-inputs-in-a-line-with-a-for-loop", "title": "Why can scanf read multiple inputs in a line with a for loop?", "body": "<p>I wanted to store n values given (n was known) in an array but I didn't know how to do it, so I looked and found this post: <a href=\"https://stackoverflow.com/questions/2539796/c-reading-multiple-numbers-from-single-input-line-scanf\">C, reading multiple numbers from single input line (scanf?)</a> , and this answer:</p>\n\n<pre><code>int main()\n{\n    int i, size, *v;\n    scanf(\"%d\", &amp;size);\n    v = malloc(size * sizeof(int));\n    for (i=0; i&lt;size; i++)\n        scanf(\"%d\", &amp;v[i]);\n    printf(\"%d %d %d\", v[0], v[1], v[2]);\n}\n</code></pre>\n\n<p>I don't understand why scanf can do that, shouldn't the function, in every iteration of the loop, ask for another input? How can it read one int, then another and so on, as long as they are separated by spaces? How can scanf behave that way? Because it seems like it shouldn't.</p>\n\n<p>PS: I only wrote the final print statement with 3 values for simplicity, in \"my case\" size was 3.</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["c", "ruby", "dll", "ffi", "fiddle"], "comments": [{"owner": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517350532, "post_id": 48531371, "comment_id": 84058343, "body": "I suggest taking a look at this <a href=\"http://swig.org\" rel=\"nofollow noreferrer\">swig.org</a>"}, {"owner": {"reputation": 23, "user_id": 8974331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df4b8c154fab8525b73bb0491f92fa2d?s=128&d=identicon&r=PG&f=1", "display_name": "Yof", "link": "https://stackoverflow.com/users/8974331/yof"}, "reply_to_user": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517351892, "post_id": 48531371, "comment_id": 84058895, "body": "@shadowsheep SWIG is used for creating extensions though and I&#39;m looking to just load a dll file into my Ruby app and use the functions in it. Am I missing something here?"}, {"owner": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517352027, "post_id": 48531371, "comment_id": 84058956, "body": "Nope! You can use swig to auto generate ruby wrapoer for your dll like that <a href=\"http://web.mit.edu/svn/src/swig-1.3.25/Examples/ruby/class/index.html\" rel=\"nofollow noreferrer\">web.mit.edu/svn/src/swig-1.3.25/Examples/ruby/class/index.ht&zwnj;&#8203;ml</a>"}, {"owner": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517352322, "post_id": 48531371, "comment_id": 84059052, "body": "See at the tutorial <a href=\"http://www.swig.org/tutorial.html\" rel=\"nofollow noreferrer\">swig.org/tutorial.html</a> sorry I don\u2019t answer with a live example \u2018cause are on my mobile right now."}, {"owner": {"reputation": 23, "user_id": 8974331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df4b8c154fab8525b73bb0491f92fa2d?s=128&d=identicon&r=PG&f=1", "display_name": "Yof", "link": "https://stackoverflow.com/users/8974331/yof"}, "reply_to_user": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517352628, "post_id": 48531371, "comment_id": 84059167, "body": "Oh cool! O.k thank you! :)"}, {"owner": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517352890, "post_id": 48531371, "comment_id": 84059242, "body": "U\u2019r welcome! Happy learning!"}, {"owner": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517397260, "post_id": 48531371, "comment_id": 84076705, "body": "I&#39;ve posted an answer for OSX, I hope could help"}, {"owner": {"reputation": 23, "user_id": 8974331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df4b8c154fab8525b73bb0491f92fa2d?s=128&d=identicon&r=PG&f=1", "display_name": "Yof", "link": "https://stackoverflow.com/users/8974331/yof"}, "reply_to_user": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517419513, "post_id": 48531371, "comment_id": 84091892, "body": "It does, Thank you!!"}, {"owner": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "edited": false, "score": 0, "creation_date": 1517420806, "post_id": 48531371, "comment_id": 84092623, "body": "So if it answers your question, could you flag it as the accepted one?"}], "answers": [{"tags": [], "owner": {"reputation": 10161, "user_id": 4677951, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/fnR1Z.png?s=128&g=1", "display_name": "shadowsheep", "link": "https://stackoverflow.com/users/4677951/shadowsheep"}, "is_accepted": true, "score": 2, "last_activity_date": 1517420132, "last_edit_date": 1517420132, "creation_date": 1517392717, "answer_id": 48539292, "question_id": 48531371, "link": "https://stackoverflow.com/questions/48531371/access-dll-function-on-c-project-from-ruby/48539292#48539292", "title": "access dll function on C project from Ruby", "body": "<p>I suggest using SWIG (<a href=\"http://swig.org\" rel=\"nofollow noreferrer\">http://swig.org</a>)</p>\n\n<p>I'll give you an example on OSX but you could find the equivalent on Windows as well. </p>\n\n<p>Let's say you have a library (in my case hello.bundle or in your case hello.DLL) with this header file <code>hello.h</code></p>\n\n<pre><code>#ifndef __HELLO__\n#define __HELLO__\n\nextern void say_hello(void); \n\n#endif\n</code></pre>\n\n<p>and you wanna call <code>say_hello</code> from a ruby program like that run.rb:</p>\n\n<pre><code># file: run.rb\nrequire 'hello'\n\n# Call a c function\nHello.say_hello\n</code></pre>\n\n<p>(Pay attention here that the module name is Capitalised)</p>\n\n<p>what you have to do is to create a file <code>hello.i</code> like that:</p>\n\n<pre><code>%module hello\n %{\n #include \"hello.h\"\n %}\n\n // Parse the original header file\n %include \"hello.h\"\n</code></pre>\n\n<p>And then run the command:</p>\n\n<pre><code>swig -ruby hello.i\n</code></pre>\n\n<p>This will generate a file <code>.c</code> that is a wrapper that will be installed as a wrapper module for your ruby environment: <code>hello_wrap.c</code>.</p>\n\n<p>Then you need to create a file <code>extconf.rb</code> with this content:</p>\n\n<pre><code>require 'mkmf'\ncreate_makefile('hello')\n</code></pre>\n\n<p>Pay attention that here \"hello\" is the name of our module in the file <code>.i</code>.</p>\n\n<p>Then you must run <code>ruby extconf.rb</code> that will generate a Makefile.</p>\n\n<pre><code>ruby extconf.rb    \ncreating Makefile\n</code></pre>\n\n<p>Then you must type <code>make</code> that will compile the <code>_wrap.c</code> file against the library (in my case .bundle in your case .DLL).</p>\n\n<pre><code>make\ncompiling hello_wrap.c\nlinking shared-object hello.bundle\n</code></pre>\n\n<p>Now you must type <code>make install</code> (or sudo make install on Unix/Osx)</p>\n\n<pre><code>sudo make install\nPassword:\n/usr/bin/install -c -m 0755 hello.bundle /Library/Ruby/Site/2.3.0/universal-darwin17\n</code></pre>\n\n<p>Then you can run your program run.rb</p>\n\n<pre><code>ruby run.rb \nHello, world!\n</code></pre>\n\n<p>I'll paste here below the <code>.c</code> file used to generate the library hello.bundle</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"hello.h\"\n\nvoid say_hello(void) {\n    printf(\"Hello, world!\\n\");\n    return;\n}\n</code></pre>\n\n<p>If you leave this file along with it's <code>.h</code> file the Makefile will build the library for you</p>\n\n<pre><code>make\ncompiling hello.c\ncompiling hello_wrap.c\nlinking shared-object hello.bundle\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8974331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df4b8c154fab8525b73bb0491f92fa2d?s=128&d=identicon&r=PG&f=1", "display_name": "Yof", "link": "https://stackoverflow.com/users/8974331/yof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 48539292, "answer_count": 1, "score": 2, "last_activity_date": 1517420132, "creation_date": 1517350296, "question_id": 48531371, "link": "https://stackoverflow.com/questions/48531371/access-dll-function-on-c-project-from-ruby", "title": "access dll function on C project from Ruby", "body": "<p>I have a project written in C controlling hardware devices. I'm trying to access DLL functions in my projects from a Ruby app in order to control the hardware from the Ruby web app. I'm failing in loading the dll project files using FFI and Fiddle. Does anyone have an example I can use to share of a similar case?</p>\n\n<p>Thanks.  </p>\n"}, {"tags": ["c", "sockets", "ipv6", "multicast"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 4, "creation_date": 1517348965, "post_id": 48530167, "comment_id": 84057617, "body": "What purpose does it serve to (try to) unbind the socket immediately before you close it?  Whatever binding it may have should go away on closure anyway."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1517349535, "post_id": 48530167, "comment_id": 84057892, "body": "&quot;<i>How do i send a broadcast using multicast in IPv6?</i>&quot; - simply <code>sendto()</code> a packet to a multicast group IP (<code>ff00::0.0.0.1</code> is a malformed IPv6 address, though. You might be thinking of <code>ff00::1</code> instead). The network will forward the packet to all receivers who are joined to the same group."}, {"owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1517350339, "post_id": 48530167, "comment_id": 84058252, "body": "@RemyLebeau, <code>ff00::1</code> is a bad IPv6 multicast address. It uses a Reserved IPv6 multicast scope. <code>ff02::1</code> would be for all hosts on a link, <code>ff05::1</code> would be for all hosts at a site, and <code>ff08::1</code> would be for all hosts in an organization."}, {"owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 3, "creation_date": 1517372081, "post_id": 48530167, "comment_id": 84064121, "body": "Understand that broadcast is overused in IPv4, which is why it was eliminated in IPv6. You should have a really, really good reason to send to the All Hosts multicast address, regardless of scope. The point of multicast is to only interrupt interested hosts, which are subscribed to a particular multicast group, not all the hosts in a scope. With heightened security concerns, misuse of broadcast or the All Hosts multicast group can get your application rejected. You should also learn the IPv6 multicast flags and scopes."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1517379876, "post_id": 48530167, "comment_id": 84066727, "body": "is there some reason you used <code>setsockopt()</code> to try to perform binding the socket to a specific port, rather than simply using <code>bind()</code>?   And dosen&#39;t the &#39;bind&#39; condition go away when the associated socket is closed?"}, {"owner": {"reputation": 2084, "user_id": 1009046, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cc11b1ca214d5b024174bf356c6fc242?s=128&d=identicon&r=PG&f=1", "display_name": "codenamezero", "link": "https://stackoverflow.com/users/1009046/codenamezero"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1517424584, "post_id": 48530167, "comment_id": 84094736, "body": "The reason for a broadcast/multicast on a specific port is to notify other hosts in the network for &quot;some thing&quot;. @JohnBollinger No particular reason, I am just trying to do proper clean up, if <code>close</code> is enough then I will do that. @RonMaupin I am guessing <code>ff08::1</code> would covers <code>ff05::1</code> as well? I need to cover as much network as possible."}], "owner": {"reputation": 2084, "user_id": 1009046, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cc11b1ca214d5b024174bf356c6fc242?s=128&d=identicon&r=PG&f=1", "display_name": "codenamezero", "link": "https://stackoverflow.com/users/1009046/codenamezero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1535611083, "creation_date": 1517344880, "last_edit_date": 1535611083, "question_id": 48530167, "link": "https://stackoverflow.com/questions/48530167/how-to-unbind-socket-after-so-bindtodevice-in-c", "title": "How to unbind socket after SO_BINDTODEVICE in C?", "body": "<p>I am trying to do multicast in C, but after sending out a UDP packet, my system loses all the connections and needs a reboot. </p>\n\n<p>Questions:</p>\n\n<ol>\n<li><p>Am I unbinding correctly? </p></li>\n<li><p>How do i send a broadcast using multicast in IPv6?</p></li>\n</ol>\n\n<p></p>\n\n<pre><code>int family = ifa-&gt;ifa_addr-&gt;sa_family;\n\nint socket_fd = socket(family, SOCK_DGRAM, 0);\nif (setsockopt(socket_fd, SOL_SOCKET, SO_BINDTODEVICE, ifa-&gt;ifa_name, strlen(ifa-&gt;ifa_name)))\n    perror(\"setsockopt\");\nelse\n{\n    // do something\n    struct sockaddr_in6 a;\n    a.sin6_family = AF_INET;\n    a.sin6_port = htons(9000);\n    inet_pton(family, \"ff00::0.0.0.1\", &amp;a.sin6_addr);\n    status = sendto(socket_fd, data, sz, 0, (struct sockaddr *)&amp;a, sizeof(a));\n}\n\n// clean up?\nif (setsockopt(socket_fd, SOL_SOCKET, SO_BINDTODEVICE, \"\", 0)) {\n      perror(\"setsockopt (unbind)\");\n}\n\nclose(socket_fd);\n</code></pre>\n"}, {"tags": ["c", "notepad++", "mingw-w64"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1517344370, "post_id": 48529950, "comment_id": 84055354, "body": "If you are learning C, don&#39;t compile your C code with C++!"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1517344933, "post_id": 48529950, "comment_id": 84055624, "body": "You need to put a call to <code>getchar()</code> at the end of <code>main</code>. That will keep the window open until you press a key. Also, change <code>g++</code> to <code>gcc -Wall -Werror</code>."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1517345125, "post_id": 48529950, "comment_id": 84055731, "body": "@user3386109 Printing a message such as<code>&quot;Press Enter to continue...&quot;</code> before calling <code>getchar()</code> is even better."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 1, "creation_date": 1517345320, "post_id": 48529950, "comment_id": 84055833, "body": "@machine_1 Yeah, ok. If you want to be nice to the user, I guess that&#39;s fine :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8249477"}, "edited": false, "score": 0, "creation_date": 1517351729, "post_id": 48529950, "comment_id": 84058821, "body": "Hello good folks. Thanks for everything. So i did this: npp_save cd &quot;$(CURRENT_DIRECTORY)&quot;  gcc -Wall -Werror &quot;$(FILE_NAME)&quot; -o $(NAME_PART) -march=native -O3  NPP_RUN $(NAME_PART)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8249477"}, "edited": false, "score": 0, "creation_date": 1517351812, "post_id": 48529950, "comment_id": 84058857, "body": "and added getchar(); at the end just like mr. Pablo mentioned. Yet it still closes. Sorry."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1517356070, "post_id": 48529950, "comment_id": 84060266, "body": "my best advice to you is to forget notepad++ and go with a proper IDE designed for programming development."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8249477"}, "edited": false, "score": 0, "creation_date": 1517356500, "post_id": 48529950, "comment_id": 84060360, "body": "<i>sigh</i> i really wanted to use this. I was getting hang of it."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1517356727, "post_id": 48529950, "comment_id": 84060423, "body": "I made an update of my answer addressing your problem. In the feature, please don&#39;t ask the same question twice. If you have some problem with an answer, leave a comment. The person who answered will notice that. If you however have a <b>new</b> question, then you can of course create a new answer."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8249477"}, "edited": false, "score": 0, "creation_date": 1517352105, "post_id": 48530218, "comment_id": 84058985, "body": "Yes sir, you are right, it closes immediately. I added getchar(); but it closes again/ I have made changes to the npp exec too. npp_save cd &quot;$(CURRENT_DIRECTORY)&quot; gcc -Wall -Werror &quot;$(FILE_NAME)&quot; -o $(NAME_PART) -march=native -O3 NPP_RUN $(NAME_PART)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8249477"}, "edited": false, "score": 0, "creation_date": 1517356542, "post_id": 48530218, "comment_id": 84060370, "body": "Please help. I don&#39;t know how to reply to you. First timer in stackoverflow."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8249477"}, "edited": false, "score": 0, "creation_date": 1517356966, "post_id": 48530218, "comment_id": 84060488, "body": "Thank you. This is overly complicated. I might just use some other software. Hurdle after hurdle. But its ok."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1517357159, "post_id": 48530218, "comment_id": 84060541, "body": "@Ulta this is exactly how to reply to an user, by leaving a comment in the comment section. The creator of the answer will see a notification when someone leaves a comment. See <a href=\"https://stackoverflow.com/help/privileges/comment\">stackoverflow.com/help/privileges/comment</a> I know you still don&#39;t have enough rep. points to comment everywhere, but you can always comment on answers of your own questions."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8249477"}, "edited": false, "score": 0, "creation_date": 1517357447, "post_id": 48530218, "comment_id": 84060607, "body": "Thank you! :) I am gonna use Putty and notepad++. or WinSCp? What do you recommend @Pablo?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1517358298, "post_id": 48530218, "comment_id": 84060841, "body": "@Ulta they are 3 unrelated programs. But sure, open a putty session on a remote server (or virtual machine), compile and execute it there. And use winscp to move the files. I think it&#39;s much more easier if you open a terminal in windows, enter <code>cd path\\to\\your\\build\\directory</code> and execute the binary from there, don&#39;t you think? But if it works well for you with these 3 programs, go ahead."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 2, "last_activity_date": 1517356581, "last_edit_date": 1517356581, "creation_date": 1517345082, "answer_id": 48530218, "question_id": 48529950, "link": "https://stackoverflow.com/questions/48529950/notepad-and-nppexe-not-showing-me-an-output/48530218#48530218", "title": "Notepad++ and NppExe not showing me an output", "body": "<p>First of all, <code>g++</code> is the C++ compiler. If you have C code, then you have to\nuse <code>gcc</code> to compile C code.</p>\n\n<p>I don't really understand what you mean by <em>a command prompt appears and takes\nall the input</em>, but judging from the behaviour that the console closes\nimmediately, then this is because the console closes right after the program\nexits.</p>\n\n<p>When making a double-click on an (console) executable, a terminal is spawned and\nit executes your program (not the command line). Normal behaviour of terminals is that when the\nexecuted program exists, the terminal closes. This also would happen when\nlaunching the program through your IDE.</p>\n\n<p>As you can see, if you open a terminal and execute it from there, the terminal\nstays open, because the command line is still active<sup>1</sup>.</p>\n\n<p>If you want to launch a program via double-click or IDE, then you have to make\nsure that your program doesn't exit right away. An easy way to do this is by\nmaking the user wait for an input.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    printf(\"hello world\\n\");\n\n    puts(\"Press Enter to continue...\");\n    getchar();\n    return 0;\n}\n</code></pre>\n\n<p>Here the <code>getchar</code> would wait for user input and it would exit after the user hits <kbd>ENTER</kbd>. This is a workaround for launching console programs via\ndouble-click and IDEs. However I think this is bad practice, the correct way\nwould be to start a terminal yourself and execute your program yourself.</p>\n\n<p>Many terminals have the option that they don't close immediately when the\nrunning program ends. For that you should be able to check the settings of the\nterminal. Sometimes IDEs have also a checkbox in the settings that you have to\ncheck so that the terminal doesn't close right away.</p>\n\n<p><strong>edit</strong></p>\n\n<p>The reason why <code>getchar</code> at the end does not wait is because of the previous\n<code>scanf</code>.</p>\n\n<p>When you enter something in the command line, a newline (<code>'\\n'</code>) is also added\nto the input stream.</p>\n\n<pre><code>scanf(\"%d/%d/%d\", &amp;month2, &amp;day2, &amp;year2);\n</code></pre>\n\n<p>If the format is correct, <code>scanf</code> will consume all input but leave behind the\nnewline in the input buffer. The last <code>getchar()</code> will consume the newline that\nis already in the buffer, and because of that it doesn't wait for further user\ninput.</p>\n\n<p>You have to clear your input buffer. Add this function before the <code>main</code>:</p>\n\n<pre><code>void clear_stdin(void)\n{\n    int c;\n    while((c = getchar()) != '\\n' &amp;&amp; c != EOF);\n}\n</code></pre>\n\n<p>The call it after the <code>scanf</code> calls:</p>\n\n<pre><code>printf(\"Enter first date (mm/dd/yy): \");\nscanf(\"%d/%d/%d\", &amp;month1, &amp;day1, &amp;year1);\nclear_stdin();\n\nprintf(\"Enter second date (mm/dd/yy): \");\nscanf(\"%d/%d/%d\", &amp;month2, &amp;day2, &amp;year2);\nclear_stdin();\n</code></pre>\n\n<p>Now that the input buffer is cleared, the last <code>getchar</code> will wait for more user\ninput and you program will block until you press ENTER.</p>\n\n<hr>\n\n<p><strong>Fotenotes</strong></p>\n\n<p><sup>1</sup>Note that a terminal (console) is <strong>not</strong> the same as the command\nline. The terminal is the program that displays the text and allow users to\ntype with the keyboard. A command line is just a program that allows you to\nenter commands and start programs. In Windows the command line is <code>cmd.exe</code>\ncalled command line, it is mostly found in <code>C:\\Windows\\System32</code>.</p>\n\n<p>The default settings are that when you open a terminal without telling which\ncommand to execute, it will automatically open a command line, in Windows would\nbe <code>cmd.exe</code> by default.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8249477"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 998, "favorite_count": 0, "accepted_answer_id": 48530218, "answer_count": 1, "score": 1, "last_activity_date": 1517356581, "creation_date": 1517343979, "last_edit_date": 1517352592, "question_id": 48529950, "link": "https://stackoverflow.com/questions/48529950/notepad-and-nppexe-not-showing-me-an-output", "title": "Notepad++ and NppExe not showing me an output", "body": "<p>I want to learn C. I would like to get my notepad++ to compile and run my .c files. I have done what is needed to be done. I am using MinGW and have added the plugin. I added this prompt:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>npp_save\ncd \"$(CURRENT_DIRECTORY)\"\n\ngcc -Wall -Werror \"$(FILE_NAME)\" -o $(NAME_PART) -march=native -O3\n\nNPP_RUN $(NAME_PART)\n</code></pre>\n\n<p>but whenever I go to compile and run, a command prompt appears and takes all the input. But when the time comes to show me an output command prompt closes out. Also there is no output on the console embedded in the notepad++ either. I then have to use Windows cmd to execute. Can someone please help me. I am a beginner.</p>\n\n<p>for instance, take a look at this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n/* Note: Program assumes years are in the same century. */\n\nint main(void)\n\n {\n\n int month1, day1, year1, month2, day2, year2;\n int first_earlier = 0;\n\n printf(\"Enter first date (mm/dd/yy): \");\n scanf(\"%d/%d/%d\", &amp;month1, &amp;day1, &amp;year1);\n\n printf(\"Enter second date (mm/dd/yy): \");\n scanf(\"%d/%d/%d\", &amp;month2, &amp;day2, &amp;year2);\n\n  if (year1 != year2)\n      first_earlier = year1 &lt; year2;\n\n  else if (month1 != month2)\n      first_earlier = month1 &lt; month2;\n  else\n     first_earlier = day1 &lt; day2;\n\n   if (first_earlier)\n  printf(\"%d/%d/%d is earlier than %d/%d/%d\\n\", month1, day1, year1, month2, day2, year2);\n\n   else\n   printf(\"%d/%d/%d is earlier than %d/%d/%d\\n\",month2, day2, year2, month1, day1, year1);\n\n   getchar();\n  return 0;\n\n  }\n</code></pre>\n\n<p>when pressing F6, the command prompt appears, it asks dates and when pressing enter after entering the second date prompt closes without showing me an output anywhere. </p>\n"}]