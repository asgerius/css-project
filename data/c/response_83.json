[{"tags": ["c", "caesar-cipher", "mod"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 5, "creation_date": 1470872245, "post_id": 38885168, "comment_id": 65130944, "body": "0-25 are not visible characters in ascii."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1470872248, "post_id": 38885168, "comment_id": 65130946, "body": "The letter c doesn&#39;t have a value of less than 26.  You might take a look at an ascii chart and see if that helps."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 3, "creation_date": 1470872462, "post_id": 38885168, "comment_id": 65131007, "body": "You might want to add an <code>&#39;a&#39;</code> (or <code>&#39;A&#39;</code>) to that."}, {"owner": {"reputation": 724, "user_id": 2744342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e46375ea8161701c62f0a0e0cde23f0?s=128&d=identicon&r=PG&f=1", "display_name": "Alok--", "link": "https://stackoverflow.com/users/2744342/alok"}, "edited": false, "score": 2, "creation_date": 1470873308, "post_id": 38885168, "comment_id": 65131205, "body": "You want <code>&#39;a&#39; + (c - &#39;a&#39; + shift) % 26</code> if I understand correctly."}], "answers": [{"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 0, "last_activity_date": 1470872696, "creation_date": 1470872696, "answer_id": 38885230, "question_id": 38885168, "link": "https://stackoverflow.com/questions/38885168/using-modulus-operator-on-a-char-in-c/38885230#38885230", "title": "Using modulus operator on a char in C", "body": "<p>Shift it by <code>'a'</code> or <code>'A'</code>. Then you'll always get a character that's part of the alphabet:</p>\n\n<pre><code>int main(){\n    unsigned i;\n    for(i=0;;i++)\n        printf(\"i=%c\\n\", 'a'+i%26);\n\n }\n</code></pre>\n\n<p>prints:</p>\n\n<pre><code>i=a\ni=b\ni=c\ni=d\ni=e\ni=f\ni=g\ni=h\ni=i\ni=j\n...\n</code></pre>\n"}], "owner": {"reputation": 1251, "user_id": 4324721, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/w57jr.jpg?s=128&g=1", "display_name": "Turtle", "link": "https://stackoverflow.com/users/4324721/turtle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2207, "favorite_count": 0, "closed_date": 1470873453, "answer_count": 1, "score": 0, "last_activity_date": 1470873681, "creation_date": 1470872140, "last_edit_date": 1470873681, "question_id": 38885168, "link": "https://stackoverflow.com/questions/38885168/using-modulus-operator-on-a-char-in-c", "closed_reason": "Duplicate", "title": "Using modulus operator on a char in C", "body": "<p>I am trying to mod a char in c by using the following:</p>\n\n<pre><code>int shift = 1;    \nc = (c + shift ) % 26;\nprintf(\"c= %c \\n\",c);\n</code></pre>\n\n<p>The variable c is a lowercase english character between a-z. When I try to print out the char c using the above code, I get the following:</p>\n\n<pre><code>c=  \n</code></pre>\n\n<p>Could someone please tell me what I am doing wrong?</p>\n"}, {"tags": ["c", "linker", "embedded", "startup"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1470868257, "post_id": 38884561, "comment_id": 65129915, "body": "When the chip is powered on or reset, it jumps to (starts executing code at) a specific address in memory. The linker arranges for the startup code to be mapped to that address."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1470868792, "post_id": 38884561, "comment_id": 65130042, "body": "<code>_start</code> (or <code>start</code>) will most likely be a label in an assembly file, where you&#39;ll also find the call to the C function you found."}, {"owner": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470868869, "post_id": 38884561, "comment_id": 65130063, "body": "@EOF Thanks for the feedback; yes but i want know what code is executed before the main, and in case of &quot;code executed before the main&quot; where it is called in the linker script or where exactly ?"}, {"owner": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1470869392, "post_id": 38884561, "comment_id": 65130233, "body": "@DanielJour yes it seems something like that, but wich make me crazy is that i didn&#39;t find this .s, <a href=\"http://www.avrfreaks.net/forum/initstartup\" rel=\"nofollow noreferrer\">here</a>, its said that crt0.s calls this function however in my toolchain i only have crt.o, object files, means that i can&#39;t have an idea about what happened. this is not fair in my opinion."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1470869901, "post_id": 38884561, "comment_id": 65130371, "body": "just disassemble the binary, if it uses elf or other formats like that you can see the label names, etc.  and if that is not good enough (even though it would show you your answer) you can then start grepping for the labels and see if you find the source to the bootstrap."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1470869902, "post_id": 38884561, "comment_id": 65130372, "body": "It can be <code>crt.o</code> [on older/simpler systems], <code>crt0.o</code>, <code>crt1.o</code>, <code>gcrt1.o</code>, etc. You just have to look around a bit. Also, <code>crt.o</code> is often quite simple. So, you could disassemble it with <code>objdump</code>. Also, the <code>crt.s</code> source is part of the compiler source, so if you know your compiler (e.g. <code>gcc</code>), you can pull that independently and find the <code>crt*.s</code> that matches your arch. So, by comparing the disassembly and the <code>crt.s</code> files, you should be able to find a pretty good match and/or substitute."}, {"owner": {"reputation": 5701, "user_id": 4392605, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IgDqF.png?s=128&g=1", "display_name": "Meninx - \u30e1\u30cd\u30f3\u30c3\u30af\u30b9", "link": "https://stackoverflow.com/users/4392605/meninx-%e3%83%a1%e3%83%8d%e3%83%b3%e3%83%83%e3%82%af%e3%82%b9"}, "edited": false, "score": 0, "creation_date": 1470871069, "post_id": 38884561, "comment_id": 65130643, "body": "<code>_start</code>  prepare the arguments for <code>__libc_start_main</code>  which set the initialization and the cleanup function of the program and then call the <code>main</code> function and that&#39;s the reason why you find the entry point of <code>__start</code> and not  <code>main</code>. You can check this <a href=\"http://bottomupcs.sourceforge.net/csbu/x3564.htm\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1470871140, "post_id": 38884561, "comment_id": 65130667, "body": "When I ask google about it I get <a href=\"https://github.com/avrxml/asf/blob/master/thirdparty/lodepng/example/crt0.S\" rel=\"nofollow noreferrer\">github.com/avrxml/asf/blob/master/thirdparty/lodepng/example&zwnj;&#8203;/&hellip;</a> Is that it? Seems to be from  NewLib: <a href=\"https://sourceware.org/git/gitweb.cgi?p=newlib-cygwin.git;a=blob_plain;f=libgloss/arm/crt0.S\" rel=\"nofollow noreferrer\">sourceware.org/git/&hellip;</a>"}, {"owner": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 0, "creation_date": 1470878456, "post_id": 38884561, "comment_id": 65132319, "body": "Questions like these suggest it is past time to learn about tools such as  <code>grep</code> and <code>objdump</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1470897981, "post_id": 38884561, "comment_id": 65138341, "body": "Every system has some manner of start-up routine, usually called directly through the reset interrupt vector, which sets up the very fundamentals and the ABI: stack pointer, watchdog &amp; LVD, memory mapping, initialize .bss and .data sections etc. When done, it calls <code>main</code>. On modern embedded compilers you usually get this code for free with the compiler."}], "answers": [{"comments": [{"owner": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "edited": false, "score": 0, "creation_date": 1471037531, "post_id": 38917166, "comment_id": 65210450, "body": "Thanks for the feedback, however all that i need, _start and init_startup is in the <a href=\"https://github.com/avrxml/asf/blob/master/thirdparty/lodepng/example/crt0.S\" rel=\"nofollow noreferrer\">crt0.s</a>. as @ deamentiaemundi pointed"}], "tags": [], "owner": {"reputation": 66, "user_id": 5395113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d310716f6bbf99100008a15b69aaafe?s=128&d=identicon&r=PG&f=1", "display_name": "Oren Fivlovich", "link": "https://stackoverflow.com/users/5395113/oren-fivlovich"}, "is_accepted": false, "score": 0, "last_activity_date": 1471002260, "creation_date": 1471002260, "answer_id": 38917166, "question_id": 38884561, "link": "https://stackoverflow.com/questions/38884561/how-to-know-the-startup-point-of-an-application/38917166#38917166", "title": "How to know the startup point of an application", "body": "<p>Didnt worked with Atmel mcu but i assume it same as the other .</p>\n\n<p>1- where can i find the calls to _init_startup?</p>\n\n<ul>\n<li>You can't,its absolute address jump. you can find it at MCU flash memory reset vector.</li>\n</ul>\n\n<p>2- why in the linker script i have ENTRY(_start) instead of ENTRY(main)?</p>\n\n<ul>\n<li>Because the first instruction of the code located at address _start.\nafter the first piece of code run,it should have jump command pointing to main.</li>\n</ul>\n\n<p>3- Where can i find the definition of _start?</p>\n\n<ul>\n<li>its probably reserved word.try look for it at compiler options.</li>\n</ul>\n"}], "owner": {"reputation": 808, "user_id": 6644375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6c70e82e4e69a7ffc24b7e269cbff6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Mouin", "link": "https://stackoverflow.com/users/6644375/mouin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1471002260, "creation_date": 1470868149, "question_id": 38884561, "link": "https://stackoverflow.com/questions/38884561/how-to-know-the-startup-point-of-an-application", "title": "How to know the startup point of an application", "body": "<p>I am using Atmel studio 7.0.</p>\n\n<p>I come to this function when trying to undrestand the code of freeRTOS.</p>\n\n<pre><code>/*\n* Low-level initialization routine called during startup, before the main\n* function.\n* This version comes in replacement to the default one provided by the Newlib\n * add-ons library.\n * Newlib add-ons' _init_startup only calls init_exceptions, but Newlib add-ons'\n * exception vectors are not compatible with the SCALL management in the current\n * FreeRTOS port. More low-level initializations are besides added here.\n */\n int _init_startup(void);\n int _init_startup(void)\n {\n   /* Import the Exception Vector Base Address. */\n   extern void _evba;\n\n    #if configHEAP_INIT\n     extern void __heap_start__;\n     extern void __heap_end__;\n     portBASE_TYPE *pxMem;\n   #endif\n   ...\n</code></pre>\n\n<p>As you may see in the comment this function is called before the main, however i didn't undrestand who calls this function.</p>\n\n<p>After some research i said that this function can be called in the linker script, however it wasn't the case, the linker script looks like :</p>\n\n<pre><code>/* Default linker script, for normal executables */\nOUTPUT_FORMAT(\"elf32-avr32\", \"elf32-avr32\",\n      \"elf32-avr32\")\nOUTPUT_ARCH(avr32:uc)\nENTRY(_start)\n/* Do we need any of these for elf?\n__DYNAMIC = 0;    */ \n</code></pre>\n\n<p>I expect to find calls to _init_startup in this file howver it was not the case.</p>\n\n<p>To summarize here is my questions:</p>\n\n<p>1- where can i find the calls to <code>_init_startup</code></p>\n\n<p>2- why in the linker script i have <code>ENTRY(_start)</code> instead of <code>ENTRY(main)</code></p>\n\n<p>3- Where can i find the definition of <code>_start</code>  </p>\n\n<p>Thanks a Lot.</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "device-tree"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1470867958, "post_id": 38884498, "comment_id": 65129833, "body": "Before you do anything else: please look if there is an NTP-driver for your device. If not: try to build your softwate as an NTP driver."}, {"owner": {"reputation": 387, "user_id": 4917005, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-MT_gtbhhzTo/AAAAAAAAAAI/AAAAAAAAAGk/JKNBOWsGQpo/photo.jpg?sz=128", "display_name": "David Cater", "link": "https://stackoverflow.com/users/4917005/david-cater"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1470870188, "post_id": 38884498, "comment_id": 65130434, "body": "I&#39;m not sure what you mean by an NTP driver.  Is that Network Time Protocol?  If so, I don&#39;t think that would apply here; this clock is used to generate a stable frequency (e.g., 75MHz)."}, {"owner": {"reputation": 1879, "user_id": 1586929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75b3597330a3d6854efc6f1578fc595?s=128&d=identicon&r=PG", "display_name": "Krzysztof Adamski", "link": "https://stackoverflow.com/users/1586929/krzysztof-adamski"}, "edited": false, "score": 0, "creation_date": 1470871531, "post_id": 38884498, "comment_id": 65130775, "body": "Note that you left <code>status = &quot;disabled&quot;</code> on i2c0 in Attempt #2. Did you enable it using some other method (like <code>dtparam</code>)?"}, {"owner": {"reputation": 387, "user_id": 4917005, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-MT_gtbhhzTo/AAAAAAAAAAI/AAAAAAAAAGk/JKNBOWsGQpo/photo.jpg?sz=128", "display_name": "David Cater", "link": "https://stackoverflow.com/users/4917005/david-cater"}, "edited": false, "score": 0, "creation_date": 1470872703, "post_id": 38884498, "comment_id": 65131055, "body": "The <b>overrides</b> in bcm2710-rpi-3-b.dts enable it (I believe).  I also have a dtparam for i2c_arm, fwiw.  I do know that I can query the i2c device.  I am going to post another reply with the actual device tree after boot, in case that is helpful.  I&#39;m not entirely clear still on the difference between i2c_arm, i2c0 and i2c1."}, {"owner": {"reputation": 387, "user_id": 4917005, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-MT_gtbhhzTo/AAAAAAAAAAI/AAAAAAAAAGk/JKNBOWsGQpo/photo.jpg?sz=128", "display_name": "David Cater", "link": "https://stackoverflow.com/users/4917005/david-cater"}, "edited": false, "score": 0, "creation_date": 1470873555, "post_id": 38884498, "comment_id": 65131262, "body": "Added an update with the live device tree.  Looks like i2c0 remains disabled, but i2c_arm is i2c1, and i2c1 is enabled.  Also, i2c-1 is the name of the i2c bus that is enabled when I query with <code>idtdetect -l</code>, so that seems consistent."}], "answers": [{"tags": [], "owner": {"reputation": 387, "user_id": 4917005, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-MT_gtbhhzTo/AAAAAAAAAAI/AAAAAAAAAGk/JKNBOWsGQpo/photo.jpg?sz=128", "display_name": "David Cater", "link": "https://stackoverflow.com/users/4917005/david-cater"}, "is_accepted": false, "score": 2, "last_activity_date": 1470878690, "creation_date": 1470878690, "answer_id": 38885896, "question_id": 38884498, "link": "https://stackoverflow.com/questions/38884498/hello-world-for-common-clock-framework-driver-on-raspberry-pi-3/38885896#38885896", "title": "Hello World for common clock framework driver on Raspberry Pi 3", "body": "<p>The C code in the original post works for a Hello World driver, and the sole change I actually had to make to the device tree to get my driver to load was to add a child of the i2c1 node (in arch/arm/boot/dts/bcm2708_common.dts):</p>\n\n<pre><code>i2c1: i2c@7e804000 {\n        compatible = \"brcm,bcm2708-i2c\";\n        reg = &lt;0x7e804000 0x1000&gt;;\n        interrupts = &lt;2 21&gt;;\n        clocks = &lt;&amp;clk_core&gt;;\n        #address-cells = &lt;1&gt;;\n        #size-cells = &lt;0&gt;;\n        status = \"disabled\";\n        myclock: clock-generator@6a {\n                #clock-cells = &lt;0&gt;;\n                compatible = \"dbc,myclock\";\n                reg = &lt;0x6a&gt;;\n                clock-frequency = &lt;75000000&gt;;\n        };\n};\n</code></pre>\n\n<p>With that in place, I now see the printk messages I expected to see in dmesg.</p>\n"}], "owner": {"reputation": 387, "user_id": 4917005, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-MT_gtbhhzTo/AAAAAAAAAAI/AAAAAAAAAGk/JKNBOWsGQpo/photo.jpg?sz=128", "display_name": "David Cater", "link": "https://stackoverflow.com/users/4917005/david-cater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 949, "favorite_count": 1, "answer_count": 1, "score": 12, "last_activity_date": 1470878690, "creation_date": 1470867668, "last_edit_date": 1470878655, "question_id": 38884498, "link": "https://stackoverflow.com/questions/38884498/hello-world-for-common-clock-framework-driver-on-raspberry-pi-3", "title": "Hello World for common clock framework driver on Raspberry Pi 3", "body": "<p>I am trying to write a common clock framework driver for a clock that I have attached to my Raspberry PI 3 via I2C.  NOTE: I am very new to both Linux and kernel programming. </p>\n\n<h1>Update: SUCCESS!</h1>\n\n<p>The code below works for a Hello World driver, and the sole change I had to make to the device tree to get my driver to load was to add a child of the i2c1 node (in arch/arm/boot/dts/bcm2708_common.dts):</p>\n\n<pre><code>i2c1: i2c@7e804000 {\n        compatible = \"brcm,bcm2708-i2c\";\n        reg = &lt;0x7e804000 0x1000&gt;;\n        interrupts = &lt;2 21&gt;;\n        clocks = &lt;&amp;clk_core&gt;;\n        #address-cells = &lt;1&gt;;\n        #size-cells = &lt;0&gt;;\n        status = \"disabled\";\n        myclock: clock-generator@6a {\n                #clock-cells = &lt;0&gt;;\n                compatible = \"dbc,myclock\";\n                reg = &lt;0x6a&gt;;\n                clock-frequency = &lt;75000000&gt;;\n        };\n};\n</code></pre>\n\n<p>With that in place, I now see the printk messages I expected to see in dmesg.</p>\n\n<h1>What is working</h1>\n\n<ul>\n<li>The evaluation board with the clock is hooked up to the PI via the serial bus.  Verified with i2cdetect/i2cdump.  The I2C device is @ slave address 0x6a.</li>\n<li>I have cross-compiled my own version of the Raspberry PI 3 kernel (4.4.16-v7) from Ubuntu (running on VirtualBox) and successfully deployed it to the PI. Verified with uname -a (checking EXTRAVERSION info I added to the Makefile).</li>\n<li>I have created a Hello World device driver that I can load with insmod.</li>\n<li>I have created a Hello World device driver that I can add to the device tree (in bcm2708_common.dtsi and bcm2710-rpi-3-b.dts). I can deploy the new device tree to the PI.  Verified that the device driver is loading using printk statements (viewed using dmesg after PI boot) as well as checking lsmod after boot.</li>\n<li>I have created an initial attempt at a Hello World common clock framework driver in drivers/clk (clk-myclock.c).  This driver will ultimately be used to change the rate on the clock, so I am implementing recalc_rate, round_rate and set_rate in the clk_ops struct.  I added this driver to drivers/clk/Makefile and added a config option to drivers/clk/Kconfig.  I used menuconfig to enable the option, and I have verified that the module is being built (clk-myconfig.o is created by the build).</li>\n</ul>\n\n<h1>What is not working</h1>\n\n<p>I am now trying to add my Hello World ccf driver to the device tree on the Raspberry Pi.  I don't understand the device tree well enough to know where to add it (or even whether the ccf is actually supported on the PI).</p>\n\n<p>The two main things I have tried are:</p>\n\n<ul>\n<li><p>Adding the device as a child under i2c0 and i2c1 in bcm2708_common.dtsi.</p></li>\n<li><p>Adding the device in the clocks {} section in bcm2708_common.dtsi and then referring to my new clock from the clocks property of i2c0 and i2c1.</p></li>\n</ul>\n\n<p>As far as I can tell, my driver is never being loaded or used.  This is based on the fact that I don't see my debug message (from a printk call at the top of my *_probe function), and I don't see my module loaded in lsmod after booting.</p>\n\n<p>Looking at the arch/arm/boot/dts/zynq-zc702.dts file, it appears that board has an i2cswitch (compatible=\"nxp,pca9548\") as a child of the i2c0 device, and an i2c0 child under that, and then a common clock framework driver (\"silabs,si570\") under there.  I have no idea what the corresponding hw architecture might be on the Raspberry PI (or where to look to figure that out) to support arbitrary new I2C devices in the I2C chain.</p>\n\n<h2>Questions</h2>\n\n<ol>\n<li><p>Is the common clock framework supported on the PI?</p></li>\n<li><p>How do you add an arbitrary new I2C device to the Raspberry PI device tree?</p></li>\n<li><p>Is using printk in the probe function and lsmod to check to see if my driver is loaded sufficient for determining whether or not my device has been found in the device tree and my driver has been associated with it?</p></li>\n</ol>\n\n<h1>Code</h1>\n\n<h2>clk-myclock.c</h2>\n\n<pre><code>#include &lt;linux/clk.h&gt;\n#include &lt;linux/clk-provider.h&gt;\n#include &lt;linux/delay.h&gt;\n#include &lt;linux/module.h&gt;\n#include &lt;linux/i2c.h&gt;\n#include &lt;linux/regmap.h&gt;\n#include &lt;linux/slab.h&gt;\n\n#define DRV_NAME        \"myclock\"\n\nstruct clk_myclock {\n    struct clk_hw hw;\n    struct regmap *regmap;\n    unsigned int div_offset;\n    u64 max_freq;\n    u64 fxtal;\n    unsigned int n1;\n    unsigned int hs_div;\n    u64 rfreq;\n    u64 frequency;\n    struct i2c_client *i2c_client;\n};\n#define to_clk_myclock(_hw) container_of(_hw, struct clk_myclock, hw)\n\nenum clk_myclock_variant {\n    myclock\n};\n\nstatic int myclock_set_rate(struct clk_hw *hw, unsigned long rate,\n        unsigned long parent_rate)\n{\n    struct clk_myclock *data = to_clk_myclock(hw);\n    data-&gt;frequency = rate;\n    return 0;\n}\n\nstatic unsigned long myclock_recalc_rate(struct clk_hw *hw,\n        unsigned long parent_rate)\n{\n    u64 rate;\n    struct clk_myclock *data = to_clk_myclock(hw);\n    rate = data-&gt;fxtal;\n    return rate;\n}\n\nstatic long myclock_round_rate(struct clk_hw *hw, unsigned long rate,\n        unsigned long *parent_rate)\n{\n    if (!rate)\n        return 0;\n    return rate;\n}\n\nstatic const struct clk_ops myclock_clk_ops = {\n    .recalc_rate = myclock_recalc_rate,\n    .round_rate = myclock_round_rate,\n    .set_rate = myclock_set_rate,\n};\n\nstatic bool myclock_regmap_is_volatile(struct device *dev, unsigned int reg)\n{\n    return false;\n}\n\nstatic bool myclock_regmap_is_writeable(struct device *dev, unsigned int reg)\n{\n    return true;\n}\n\nstatic const struct regmap_config myclock_regmap_config = {\n    .reg_bits = 8,\n    .val_bits = 8,\n    .cache_type = REGCACHE_RBTREE,\n    .max_register = 0xff,\n    .writeable_reg = myclock_regmap_is_writeable,\n    .volatile_reg = myclock_regmap_is_volatile,\n};\n\n\nstatic int myclock_probe(struct i2c_client *client,\n        const struct i2c_device_id *id)\n{\n    struct clk_myclock *data;\n    struct clk_init_data init;\n    struct clk *clk;\n    u32 initial_fout;\n    int err;\n\n    printk(KERN_ALERT \"myclock_probe\\n\");\n    data = devm_kzalloc(&amp;client-&gt;dev, sizeof(*data), GFP_KERNEL);\n    if (!data)\n        return -ENOMEM;\n\n    init.ops = &amp;myclock_clk_ops;\n    init.flags = CLK_IS_ROOT;\n    init.num_parents = 0;\n    data-&gt;hw.init = &amp;init;\n    data-&gt;i2c_client = client;\n\n    init.name = \"myclock\";\n\n    data-&gt;regmap = devm_regmap_init_i2c(client, &amp;myclock_regmap_config);\n    if (IS_ERR(data-&gt;regmap)) {\n        dev_err(&amp;client-&gt;dev, \"failed to allocate register map\\n\");\n        return PTR_ERR(data-&gt;regmap);\n    }\n\n    i2c_set_clientdata(client, data);\n\n    clk = devm_clk_register(&amp;client-&gt;dev, &amp;data-&gt;hw);\n    if (IS_ERR(clk)) {\n        dev_err(&amp;client-&gt;dev, \"clock registration failed\\n\");\n        return PTR_ERR(clk);\n    }\n    err = of_clk_add_provider(client-&gt;dev.of_node, of_clk_src_simple_get,\n            clk);\n    if (err) {\n        dev_err(&amp;client-&gt;dev, \"unable to add clk provider\\n\");\n        return err;\n    }\n\n    /* Read the requested initial output frequency from device tree */\n    if (!of_property_read_u32(client-&gt;dev.of_node, \"clock-frequency\",\n                &amp;initial_fout)) {\n        dev_info(&amp;client-&gt;dev, \"initial output frequency: %u\\n\", initial_fout);\n    }\n\n    /* Display a message indicating that we've successfully registered */\n    dev_info(&amp;client-&gt;dev, \"registered, current frequency %llu Hz\\n\",\n            data-&gt;frequency);\n\n    return 0;\n}\n\nstatic int myclock_remove(struct i2c_client *client)\n{\n   printk(KERN_ALERT \"myclock_remove\\n\");\n   of_clk_del_provider(client-&gt;dev.of_node);\n   return 0;\n}\n\nstatic const struct i2c_device_id myclock_id[] = {\n    { \"myclock\", myclock },\n    { }\n};\n\nMODULE_DEVICE_TABLE(i2c, myclock_id);\n\nstatic const struct of_device_id myclock_of_match[] = {\n        { .compatible = \"dbc,myclock\" },\n        {},\n};\n\nMODULE_DEVICE_TABLE(of, myclock_of_match);\n\nstatic struct i2c_driver myclock_driver = {\n    .driver = {\n        .name = DRV_NAME,\n        .of_match_table = myclock_of_match,\n    },\n    .probe      = myclock_probe,\n    .remove     = myclock_remove,\n    .id_table   = myclock_id,\n};\n\nmodule_i2c_driver(myclock_driver);\n\nMODULE_DESCRIPTION(\"Hello World Common clock framework driver\");\nMODULE_AUTHOR(\"David Cater\");\nMODULE_LICENSE(\"GPL\");\nMODULE_ALIAS(\"platform:\" DRV_NAME);\n</code></pre>\n\n<h2>bcm2708_common.dtsi Attempt #1: adding to clocks</h2>\n\n<pre><code>i2c0: i2c@7e205000 {\n    compatible = \"brcm,bcm2708-i2c\";\n    reg = &lt;0x7e205000 0x1000&gt;;\n    interrupts = &lt;2 21&gt;;\n    clocks = &lt;&amp;clk_core &amp;clk_myclock&gt;;\n    #address-cells = &lt;1&gt;;\n    #size-cells = &lt;0&gt;;\n    status = \"disabled\";\n};\ni2c1: i2c@7e804000 {\n    compatible = \"brcm,bcm2708-i2c\";\n    reg = &lt;0x7e804000 0x1000&gt;;\n    interrupts = &lt;2 21&gt;;\n    clocks = &lt;&amp;clk_core &amp;clk_myclock&gt;;\n    #address-cells = &lt;1&gt;;\n    #size-cells = &lt;0&gt;;\n    status = \"disabled\";\n};\nclocks: clocks {\n    clk_core: clock@0 {\n        compatible = \"fixed-clock\";\n        reg = &lt;0&gt;;\n        #clock-cells = &lt;0&gt;;\n        clock-output-names = \"core\";\n        clock-frequency = &lt;250000000&gt;;\n    };\n\n    ...   \n    clk_myclock: clock@7 {\n        #clock-cells = &lt;0&gt;;\n        reg = &lt;0x6a&gt;;\n        compatible = \"dbc,myclock\";\n        clock-frequency = &lt;75000000&gt;;\n    };\n};\n</code></pre>\n\n<h2>bcm2708_common.dtsi Attempt #2: adding as child of i2c</h2>\n\n<pre><code>i2c0: i2c@7e205000 {\n    compatible = \"brcm,bcm2708-i2c\";\n    reg = &lt;0x7e205000 0x1000&gt;;\n    interrupts = &lt;2 21&gt;;\n    clocks = &lt;&amp;clk_core &amp;clk_myclock&gt;;\n    #address-cells = &lt;1&gt;;\n    #size-cells = &lt;0&gt;;\n    status = \"disabled\";\n    i2c@0 {\n        #address-cells = &lt;1&gt;;\n        #size-cells = &lt;0&gt;;\n        reg = &lt;0&gt;;\n        myclock: clock-generator@6a {\n            #clock-cells = &lt;0&gt;;\n            compatible = \"dbc,myclock\";\n            reg = &lt;0x6a&gt;;\n            clock-frequency = &lt;75000000&gt;;\n        };\n    };\n};\n</code></pre>\n\n<h2>UPDATE: device tree after boot (from #1)</h2>\n\n<p>This is a portion of the device tree from the live system after boot.  This is from adding the clocks to the clock section in the dts and then referencing the clock in the i2c0 and i2c1 clocks properties.  This is from running <code>dtc -I fs /proc/device-tree</code>.  (The whole tree exceeds the limits of the post).</p>\n\n<p>It looks like i2c0 is disabled, but i2c1 is enabled.</p>\n\n<pre><code>/dts-v1/;\n\n/ {\n    model = \"Raspberry Pi 3 Model B Rev 1.2\";\n    compatible = \"brcm,bcm2710\", \"brcm,bcm2709\";\n    memreserve = &lt;0x3b000000 0x4000000&gt;;\n    #address-cells = &lt;0x1&gt;;\n    #size-cells = &lt;0x1&gt;;\n    interrupt-parent = &lt;0x1&gt;;\n\n    soc {\n        compatible = \"simple-bus\";\n        ranges = &lt;0x7e000000 0x3f000000 0x1000000 0x40000000 0x40000000 0x40000&gt;;\n        #address-cells = &lt;0x1&gt;;\n        phandle = &lt;0x30&gt;;\n        #size-cells = &lt;0x1&gt;;\n        ...\n\n        i2c@7e205000 {\n            reg = &lt;0x7e205000 0x1000&gt;;\n            interrupts = &lt;0x2 0x15&gt;;\n            pinctrl-0 = &lt;0x10&gt;;\n            compatible = \"brcm,bcm2708-i2c\";\n            clock-frequency = &lt;0x186a0&gt;;\n            clocks = &lt;0x8 0xf&gt;;\n            status = \"disabled\";\n            #address-cells = &lt;0x1&gt;;\n            phandle = &lt;0x28&gt;;\n            #size-cells = &lt;0x0&gt;;\n            pinctrl-names = \"default\";\n        };\n        i2c@7e804000 {\n            reg = &lt;0x7e804000 0x1000&gt;;\n            interrupts = &lt;0x2 0x15&gt;;\n            pinctrl-0 = &lt;0x18&gt;;\n            compatible = \"brcm,bcm2708-i2c\";\n            clock-frequency = &lt;0x186a0&gt;;\n            clocks = &lt;0x8 0xf&gt;;\n            status = \"okay\";\n            #address-cells = &lt;0x1&gt;;\n            phandle = &lt;0x29&gt;;\n            #size-cells = &lt;0x0&gt;;\n            pinctrl-names = \"default\";\n        };\n        i2c@7e805000 {\n            reg = &lt;0x7e805000 0x1000&gt;;\n            interrupts = &lt;0x2 0x15&gt;;\n            compatible = \"brcm,bcm2708-i2c\";\n            clock-frequency = &lt;0x186a0&gt;;\n            clocks = &lt;0x8&gt;;\n            status = \"disabled\";\n            #address-cells = &lt;0x1&gt;;\n            phandle = &lt;0x19&gt;;\n            #size-cells = &lt;0x0&gt;;\n        };\n\n\n        gpio@7e200000 {\n            ...\n            i2c0 {\n                phandle = &lt;0x10&gt;;\n                brcm,function = &lt;0x4&gt;;\n                brcm,pins = &lt;0x0 0x1&gt;;\n            };\n\n            i2c1 {\n                phandle = &lt;0x18&gt;;\n                brcm,function = &lt;0x4&gt;;\n                brcm,pins = &lt;0x2 0x3&gt;;\n            };\n            ...\n        };\n    };\n    ...\n    clocks {\n        compatible = \"simple-bus\";\n        #address-cells = &lt;0x1&gt;;\n        phandle = &lt;0x45&gt;;\n        #size-cells = &lt;0x0&gt;;\n\n        clock@0 {\n            reg = &lt;0x0&gt;;\n            #clock-cells = &lt;0x0&gt;;\n            compatible = \"fixed-clock\";\n            clock-frequency = &lt;0x17d78400&gt;;\n            clock-output-names = \"core\";\n            phandle = &lt;0x8&gt;;\n        };\n        ...\n        clock@7 {\n            reg = &lt;0x6a&gt;;\n            #clock-cells = &lt;0x0&gt;;\n            compatible = \"dbc,myclock\";\n            clock-frequency = &lt;0x47868c0&gt;;\n            phandle = &lt;0xf&gt;;\n        };\n    };\n\n    ...\n    __symbols__ {\n        ...\n        i2c0 = \"/soc/i2c@7e205000\";\n        i2c1 = \"/soc/i2c@7e804000\";\n        i2c2 = \"/soc/i2c@7e805000\";\n        ...\n    };\n\n    aliases {\n        ...\n        i2c0 = \"/soc/i2c@7e205000\";\n        i2c1 = \"/soc/i2c@7e804000\";\n        i2c2 = \"/soc/i2c@7e805000\";\n        ...\n        i2c_arm = \"/soc/i2c@7e804000\";\n    };\n\n    __overrides__ {\n        ...\n        i2c0 = \"\", \"\", \"\", \"(status\";\n        i2c1 = \"\", \"\", \"\", \")status\";\n        i2c_arm = \"\", \"\", \"\", \")status\";\n        ...\n    };\n};\n</code></pre>\n\n<h2>UPDATE: Got error on boot</h2>\n\n<p>Now that I know I'm dealing with i2c1, I removed all extraneous test code from the dts.  At this point I am just trying this:</p>\n\n<pre><code>i2c1: i2c@7e804000 {\n        compatible = \"brcm,bcm2708-i2c\";\n        reg = &lt;0x7e804000 0x1000&gt;;\n        interrupts = &lt;2 21&gt;;\n        clocks = &lt;&amp;clk_core&gt;;\n        #address-cells = &lt;1&gt;;\n        #size-cells = &lt;0&gt;;\n        status = \"disabled\";\n    i2c@0 {\n            #address-cells = &lt;1&gt;;\n            #size-cells = &lt;0&gt;;\n            reg = &lt;0&gt;;\n            myclock: clock-generator@6a {\n                    #clock-cells = &lt;0&gt;;\n                    compatible = \"dbc,myclock\";\n                    reg = &lt;0x6a&gt;;\n                    clock-frequency = &lt;75000000&gt;;\n            };\n    };\n};\n</code></pre>\n\n<p>Now I am getting the following error in dmesg:</p>\n\n<pre><code>[    5.071515] bcm2708_i2c_probe\n[    5.086179] i2c i2c-1: of_i2c: modalias failure on /soc/i2c@7e804000/i2c@0\n[    5.086224] bcm2708_i2c 3f804000.i2c: BSC1 Controller at 0x3f804000 (irq 83) (baudrate 100000)\n</code></pre>\n\n<p>I'm not sure how to interpret a \"modalias failure\". </p>\n"}, {"tags": ["c", "unix"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 4, "creation_date": 1470866016, "post_id": 38884126, "comment_id": 65129195, "body": "You can arrange for a signal to be sent to your process after a certain time has elapsed via <code>timer_create()</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1470866177, "post_id": 38884126, "comment_id": 65129250, "body": "I would expect <code>elapsed = ...</code> rather than <code>elapsed += ..</code>"}, {"owner": {"reputation": 11, "user_id": 6227908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a30759932db1b409295baf3817761cfb?s=128&d=identicon&r=PG&f=1", "display_name": "Austin Bodzas", "link": "https://stackoverflow.com/users/6227908/austin-bodzas"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1470866408, "post_id": 38884126, "comment_id": 65129337, "body": "@chux ok yes I didn&#39;t mean to include that. My issue with the part about incorrect detection of changing in time through that lil example."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1470867947, "post_id": 38884126, "comment_id": 65129828, "body": "&quot;keep everything in the loop as efficient as possible.&quot; --&gt; Efficiency can be measure in program speed, program size, data usage, code maintainability.  Which &quot;efficiency&quot; is of concern?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1470868179, "post_id": 38884126, "comment_id": 65129888, "body": "&quot;epoch requires 42 bits&quot; implies you think or know <code>time_t</code> is a 32-bit` integer.  Many systems use a wider <code>time_t</code> to avoid the <a href=\"https://en.wikipedia.org/wiki/Year_2038_problem\" rel=\"nofollow noreferrer\">Year 2038 problem</a>.  I hope, as it is 2016, your system is not using a 32-bit <code>time_t</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6227908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a30759932db1b409295baf3817761cfb?s=128&d=identicon&r=PG&f=1", "display_name": "Austin Bodzas", "link": "https://stackoverflow.com/users/6227908/austin-bodzas"}, "edited": false, "score": 0, "creation_date": 1470866455, "post_id": 38884270, "comment_id": 65129353, "body": "But how would this fix the issue mentioned by &quot;But then I thought that if upon the first call of ftime, the struct is time = 1, millitm = 999 and on the second call time = 2, millitm = 01 it would be calculating the elapsed time as being 1002 milliseconds.&quot;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 11, "user_id": 6227908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a30759932db1b409295baf3817761cfb?s=128&d=identicon&r=PG&f=1", "display_name": "Austin Bodzas", "link": "https://stackoverflow.com/users/6227908/austin-bodzas"}, "edited": false, "score": 0, "creation_date": 1470866596, "post_id": 38884270, "comment_id": 65129400, "body": "@Austin Bodzas <code>millitm</code> is an <code>unsgined short</code> which is promoted to <code>int</code> on your platform.  1-999` is -998.  <code>(2-1)*1000 + -998</code> is 2.  If concerned that <code>unsigned short</code> may be the same range as <code>unsigned</code>, use <code>((check.time - start.time) * (int64_t)1000)  + ((int)check.millitm - (int)start.millitm);</code>"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1470868321, "last_edit_date": 1470868321, "creation_date": 1470866399, "answer_id": 38884270, "question_id": 38884126, "link": "https://stackoverflow.com/questions/38884126/run-code-for-x-amount-of-time/38884270#38884270", "title": "Run code for x amount of time", "body": "<p>Code is incorrect calculating elapsed time.</p>\n\n<pre><code>// elapsed += ((check.time - start.time) * 1000)  + (check.millitm - start.millitm);\nelapsed = ((check.time - start.time) * (int64_t)1000)  + (check.millitm - start.millitm);\n</code></pre>\n\n<hr>\n\n<p>There is some concern about <code>check.millitm - start.millitm</code>.  On systems with <code>struct timeb *tp</code>, it can be expected that the <code>millitm</code> will be promoted to <code>int</code> before subtraction occurs.  So the difference will be in the range <code>[-1000 ... 1000]</code>.</p>\n\n<pre><code>       struct timeb {\n           time_t         time;\n           unsigned short millitm;\n           short          timezone;\n           short          dstflag;\n       };\n</code></pre>\n\n<hr>\n\n<p>IMO, more robust code would handle ms conversion in a separate helper function.  This matches OP's \"I believe I could convert the start time into milliseconds, and the check time into millseconds, then subtract start from check.\"</p>\n\n<pre><code>int64_t timeb_to_ms(struct timeb *t) {\n  return (int64_t)t-&gt;time * 1000 + t-&gt;millitm;\n}\n\nstruct timeb start, check;\nftime(&amp;start);\nint64_t start_ms = timeb_to_ms(&amp;start);\n\nint64_t duration = 10000 /* ms */;\nint64_t elapsed = 0;\n\nwhile (elapsed &lt; duration) {\n  // do a set of tasks\n  struct timeb check;\n  ftime(&amp;check);\n  elapsed = timeb_to_ms(&amp;check) - start_ms;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470916324, "post_id": 38884977, "comment_id": 65150138, "body": "<code>man getcontext</code> <i>Do not leave the handler using longjmp(3): it is undefined what would  happen  with  contexts.   Use siglongjmp(3) or setcontext() instead.</i>"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470916825, "post_id": 38884977, "comment_id": 65150492, "body": "@EOF the manpage says that siglongjmp works like longjmp but also restores the signal mask. I&#39;m not setting a signal mask in this example, though, so I think it shouldn&#39;t matter here. Generally, I guess I would use sigaction and siglongjmp, but I think longjmp is OK here."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470917121, "post_id": 38884977, "comment_id": 65150672, "body": "The problem is that <code>setjmp&#47;longjmp</code> were woefully underspecified in C (like <code>signal</code> and other functions as well). The result is that different implementations do starkly different things for these functions, and C doesn&#39;t guarantee much. Given that <code>longjmp()</code> is not on the list of async-safe functions (much like <code>puts()</code>), your program exhibits <i>undefined behavior</i>."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470918379, "post_id": 38884977, "comment_id": 65151576, "body": "@EOF siglongjmp is async unsafe too. But that shouldn&#39;t matter. The piece above will never trigger another longjmp while one is running. The system will never send you two consequitive SIGALRM. And if you do receive two consequitive SIGALRM than if they&#39;re very close to each other, the second one will kill you (with sysv_signal anyway). If it doesn&#39;t, then you&#39;ve reestablished the handler which implies the longjmp call finished. If you use sigaction handlers with sigmask changes, you need siglongjmp, though, to restore the original sigmask."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470918784, "post_id": 38884977, "comment_id": 65151889, "body": "According to <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/xsh_chap02_04.html\" rel=\"nofollow noreferrer\">POSIX</a> <i>[...]when a signal interrupts an unsafe function and the signal-catching function calls an unsafe function, the behavior is undefined.</i>, the unsafe function that gets interrupted and the unsafe function in the signal handler don&#39;t have to be the same for the behavior to be undefined."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470919200, "post_id": 38884977, "comment_id": 65152219, "body": "Also, the <a href=\"http://man7.org/linux/man-pages/man7/signal.7.html\" rel=\"nofollow noreferrer\">manpage</a> on Linux has this juicy bit: <i>If a signal interrupts the execution of an unsafe function, and handler either calls an unsafe function or handler terminates via a call to longjmp() or siglongjmp() and the program subsequently calls an unsafe function, then the behavior of the program is undefined.</i> Given that you don&#39;t check the return value of <code>setjmp()</code>, the behavior is undefined."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470920709, "post_id": 38884977, "comment_id": 65153330, "body": "@EOF I agree it is undefined. The <code>loop</code> function prints. If it didn&#39;t, though, I believe that all should be well as <code>loop()</code> is otherwise async-safe and <code>loop()</code> is the only place where the above function should receive SIGALRM. I don&#39;t see what me not checking <code>setjmp()</code> has to do with anything."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470923018, "post_id": 38884977, "comment_id": 65155064, "body": "If the <code>longjmp()</code> is reached, you return to the <code>setjmp()</code>, and since you don&#39;t do anything special there, you continue executing into the <code>loop()</code> again, where you call an async-unsafe function again, which is undefined according to the manpage I cited. Few things are safe to do in a signal-handler, chief among them is <code>_Exit()</code> or setting a <code>volatile sig_atomic_t</code> or lock-free atomic."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 0, "last_activity_date": 1470871030, "last_edit_date": 1495541687, "creation_date": 1470870725, "answer_id": 38884977, "question_id": 38884126, "link": "https://stackoverflow.com/questions/38884126/run-code-for-x-amount-of-time/38884977#38884977", "title": "Run code for x amount of time", "body": "<p>If you want efficiency, let the system send you a signal when a timer expires.</p>\n\n<p>Traditionally, you can set a timer with a resolution in seconds with the <a href=\"http://linux.die.net/man/2/alarm\" rel=\"nofollow noreferrer\">alarm(2)</a> syscall.</p>\n\n<p>The system then sends you a SIGALRM when the timer expires. The default disposition of that signal is to terminate.</p>\n\n<p>If you handle the signal, you can <a href=\"http://linux.die.net/man/2/longjmp\" rel=\"nofollow noreferrer\">longjmp(2)</a> from the handler to another place.</p>\n\n<p>I don't think it gets much more efficient than SIGALRM + longjmp (with an asynchronous timer, your code basically runs undisturbed without having to do any extra checks or calls).</p>\n\n<p>Below is an example for you:</p>\n\n<pre><code>#define _XOPEN_SOURCE\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;setjmp.h&gt;\n\nstatic jmp_buf jmpbuf;\n\nvoid hndlr();\nvoid loop();\nint main(){\n\n    /*sisv_signal handlers get reset after a signal is caught and handled*/\n    if(SIG_ERR==sysv_signal(SIGALRM,hndlr)){\n        perror(\"couldn't set SIGALRM handler\");\n        return 1;\n    }\n\n    /*the handler will jump you back here*/\n    setjmp(jmpbuf);\n\n    if(0&gt;alarm(3/*seconds*/)){\n        perror(\"couldn't set alarm\");\n        return 1;\n    }\n\n    loop();\n\n    return 0;\n}\n\nvoid hndlr(){\n    puts(\"Caught SIGALRM\");\n    puts(\"RESET\");\n    longjmp(jmpbuf,1);\n}\n\nvoid loop(){\n    int i;\n    for(i=0;  ; i++){\n        //print each 100-milionth iteration\n        if(0==i%100000000){\n            printf(\"%d\\n\", i);\n        }\n    }\n}\n</code></pre>\n\n<p>If <a href=\"http://linux.die.net/man/2/alarm\" rel=\"nofollow noreferrer\">alarm(2)</a> isn't enough, you can use <a href=\"http://linux.die.net/man/2/timer_create\" rel=\"nofollow noreferrer\">timer_create(2)</a> as <a href=\"https://stackoverflow.com/users/3185968/eof\">EOF</a> suggests. </p>\n"}], "owner": {"reputation": 11, "user_id": 6227908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a30759932db1b409295baf3817761cfb?s=128&d=identicon&r=PG&f=1", "display_name": "Austin Bodzas", "link": "https://stackoverflow.com/users/6227908/austin-bodzas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1470871030, "creation_date": 1470865712, "last_edit_date": 1495540858, "question_id": 38884126, "link": "https://stackoverflow.com/questions/38884126/run-code-for-x-amount-of-time", "title": "Run code for x amount of time", "body": "<p>To preface, I am on a Unix (linux) system using gcc.</p>\n\n<p>What I am stuck on is how to accurately implement a way to run a section of code for a certain amount of time.</p>\n\n<p>Here is an example of something I have been working with:</p>\n\n<pre><code>struct timeb start, check;\nint64_t duration = 10000;\nint64_t elapsed = 0;\n\nftime(&amp;start);\n\nwhile ( elapsed &lt; duration ) {\n    // do a set of tasks\n    ftime(&amp;check);\n    elapsed += ((check.time - start.time) * 1000)  + (check.millitm - start.millitm);\n}\n</code></pre>\n\n<p>I was thinking this would have carried on for 10000ms or 10 seconds, but it didn't, almost instantly.  I was basing this off other questions such as <a href=\"https://stackoverflow.com/questions/17250932/how-to-get-the-time-elapsed-in-c-in-milliseconds-windows\">How to get the time elapsed in C in milliseconds? (Windows)</a> . But then I thought that if upon the first call of ftime, the struct is <code>time = 1, millitm = 999</code> and on the second call <code>time = 2, millitm = 01</code> it would be calculating the elapsed time as being 1002 milliseconds.  Is there something I am missing?</p>\n\n<p>Also the suggestions in the various stackoverflow questions, ftime() and gettimeofday(), are listed as deprecated or legacy. </p>\n\n<p>I believe I could convert the start time into milliseconds, and the check time into millseconds, then subtract start from check. But milliseconds since the epoch requires 42 bits and I'm trying to keep everything in the loop as efficient as possible.</p>\n\n<p>What approach could I take towards this?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470865007, "post_id": 38883968, "comment_id": 65128760, "body": "Let apart the string literals, I don&#39;t see an array. What do you mean? (Note: the first version does not &quot;run without problems&quot;. You just don&#39;t notice there is a problem, as you likely don&#39;t want to print the trailing <code>\\0</code> of the string literal. And the second invokes undefined behaviour. Your compiler should be yelling at you. If not, enable warnings and never ignore them!"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 3, "creation_date": 1470865336, "post_id": 38883968, "comment_id": 65128888, "body": "You should listen to the compiler&#39;s warnings, and never ignore one unless you fully understand the implications of doing so. The warnings &quot;initialization makes pointer from integer without a cast&quot; and &quot;excess elements in scalar initializer&quot; indicate that your second piece of code does not mean what you think it means."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 1, "creation_date": 1470865822, "post_id": 38883968, "comment_id": 65129109, "body": "Related? <a href=\"http://stackoverflow.com/questions/1704407/what-is-the-difference-between-char-s-and-char-s-in-c\" title=\"what is the difference between char s and char s in c\">stackoverflow.com/questions/1704407/&hellip;</a>"}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1470865872, "post_id": 38883968, "comment_id": 65129133, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1470865925, "post_id": 38883968, "comment_id": 65129162, "body": "&quot;... and I receive warnings.&quot; --&gt; post the warnings and why code has not been changed to remove the warnings."}, {"owner": {"reputation": 33, "user_id": 5955489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/579dc68fca94f101fec6eef9c434adf8?s=128&d=identicon&r=PG&f=1", "display_name": "BasilG", "link": "https://stackoverflow.com/users/5955489/basilg"}, "edited": false, "score": 0, "creation_date": 1470866506, "post_id": 38883968, "comment_id": 65129365, "body": "The warnings are:initialization makes pointer from integer without a cast"}, {"owner": {"reputation": 33, "user_id": 5955489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/579dc68fca94f101fec6eef9c434adf8?s=128&d=identicon&r=PG&f=1", "display_name": "BasilG", "link": "https://stackoverflow.com/users/5955489/basilg"}, "edited": false, "score": 0, "creation_date": 1470866519, "post_id": 38883968, "comment_id": 65129370, "body": "and: excess elements in scalar initializer"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1470869013, "post_id": 38883968, "comment_id": 65130108, "body": "&quot;I don&#39;t understand the downvotes&quot; --&gt; NMDV, but by not originally posting the warnings, it appears your compiler gave you the answer to your problem then - which was ignored.  It is common to include compiler warnings, even if you do not understand them (that is common) as 1) it helps other to help you 2) it helps others to find this post via a search.  Including those warning messages in a post improves its quality.  Leaving them out reduces it."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1470873615, "post_id": 38883968, "comment_id": 65131279, "body": "<code>char *der=(char[]){&#39;a&#39;,&#39;a&#39;,&#39;a&#39;,&#39;a&#39;,&#39;a&#39;};</code> or <code>char der[]={&#39;a&#39;,&#39;a&#39;,&#39;a&#39;,&#39;a&#39;,&#39;a&#39;};</code> also <code>i&lt;=7</code> --&gt; <code>i&lt;7</code>"}], "answers": [{"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": true, "score": 2, "last_activity_date": 1470866904, "last_edit_date": 1470866904, "creation_date": 1470866516, "answer_id": 38884291, "question_id": 38883968, "link": "https://stackoverflow.com/questions/38883968/initializing-an-array-with-a-pointer-in-c/38884291#38884291", "title": "Initializing an array with a pointer in c", "body": "<p><code>{'a','a','a','a','a'}</code> is not an array but an initializer list, and it can be used to initialize either an aggregate or a scalar.<br>\n(Yes, <code>int x = {'a'};</code> is valid.)</p>\n\n<p>If it's used to initialize a scalar, such as a pointer, only the first value is used, so your declaration of <code>der</code> is equivalent to</p>\n\n<pre><code>char *der = 'a';\n</code></pre>\n\n<p>You can probably see what the problem is.</p>\n\n<p>So today's programming lessons:</p>\n\n<ul>\n<li>When your compiler warns you that something might be wrong, it probably is.<br>\n(Most experienced programmers treat warnings as errors, <code>-Werr</code>. It's an even more important habit for the inexperienced.)</li>\n<li>If you don't understand what a warning means, don't do anything until you've found out.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1470872328, "post_id": 38884808, "comment_id": 65130964, "body": "ISO/IEC 9899:2011 &#167;6.4.5 <b>String literals</b> &#182;6: <i>In translation phase 7, a byte or code of value zero is appended to each multibyte character sequence that results from a string literal or literals. The multibyte character sequence is then used to initialize an array of static storage duration and length just sufficient to contain the sequence. For character string literals, the array elements have type char, and are initialized with the individual bytes of the multibyte character sequence. \u2026</i>  This might be regarded as contradicting &#39;is not an array&#39;."}, {"owner": {"reputation": 2630, "user_id": 4065269, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/90c9cd69a6663c31758d6cd6043dfcc3?s=128&d=identicon&r=PG&f=1", "display_name": "sps", "link": "https://stackoverflow.com/users/4065269/sps"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470874054, "post_id": 38884808, "comment_id": 65131392, "body": "@JonathanLeffler Thanks for the comment. I have removed the contraditcting part. Now wondering, what happens when we use string literal to initialize the array? Will it also have a static storage duration? Or like I guess, it is only used to initialize the array to LHS of <code>=</code>; after which its (string literal&#39;s) lifetime ends? Is it even considered as a string literal in this case (while initializing an array)?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1470874326, "post_id": 38884808, "comment_id": 65131464, "body": "In a loop like <code>for (int i = 0; i &lt; 9; i++) { char data[12] = &quot;abcdefghijk&quot;; data[i] = &#39;X&#39;; printf(&quot;[%s]\\n&quot;, data); }</code>, I believe that there must be a copy of the string stored somewhere, and the loop code contains an analogue to <code>memmove()</code> (or <code>memcpy()</code>) that copies from the stored value into the local variable on the stack.  I&#39;ve not disassembled code to prove that hypothesis, but I think it must be roughly equivalent to that."}], "tags": [], "owner": {"reputation": 2630, "user_id": 4065269, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/90c9cd69a6663c31758d6cd6043dfcc3?s=128&d=identicon&r=PG&f=1", "display_name": "sps", "link": "https://stackoverflow.com/users/4065269/sps"}, "is_accepted": false, "score": 1, "last_activity_date": 1470873678, "last_edit_date": 1470873678, "creation_date": 1470869480, "answer_id": 38884808, "question_id": 38883968, "link": "https://stackoverflow.com/questions/38883968/initializing-an-array-with-a-pointer-in-c/38884808#38884808", "title": "Initializing an array with a pointer in c", "body": "<p>One way to initialize the array - which is related to your second example - is by doing:</p>\n\n<pre><code>char foo[] = {'a', 'b', 'c'};\n</code></pre>\n\n<p>In this syntax, to the right side of <code>=</code> you provide the array elements as comma separeted values inside a <code>{ }</code>. So in the above example, array <code>foo</code> has three elements. First is <code>a</code>, second is <code>b</code>, and third is <code>c</code>. If you wanted a <code>\\0</code> at the end, you need to do it explicitly as <code>char foo[] = {'a', 'b', 'c', '\\0'};</code>.</p>\n\n<p>Regarding your second example, answer by @molbdnilo already explains what is semantically wrong with your statment <code>char *der={'a','a','a','a','a'};</code>. If you want to define <code>der</code> as array and initialize it using <code>{ }</code>, you can do:</p>\n\n<pre><code>char der[] = {'a','a','a','a','a'};\n</code></pre>\n\n<p>This way you are actually defining a char array and initializing it with the content you want.</p>\n\n<p>Note that, you NEED to mention the array size if you are not initializing it while defining it. Which means:</p>\n\n<pre><code>char foo[];   // Will give error because no size is mentioned\nchar foo[10]; // Fine because size is given as 10\n</code></pre>\n\n<p>However, mentioning size is optional if you initialize the array while defining it, as we saw in the examples above. But, if you mention the size and if your initializer is smaller than the array size, remaining elements will be initialized to <code>0</code>. Like:</p>\n\n<pre><code>char bar[10] = {'a', 'b', 'c', '\\0'};\n/* Your arrays' content will be 'a', 'b', 'c', '\\0',\n * and all remaning 6 elements will be 0 \n */\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5955489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/579dc68fca94f101fec6eef9c434adf8?s=128&d=identicon&r=PG&f=1", "display_name": "BasilG", "link": "https://stackoverflow.com/users/5955489/basilg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 38884291, "answer_count": 2, "score": -3, "last_activity_date": 1470873678, "creation_date": 1470864923, "last_edit_date": 1470865693, "question_id": 38883968, "link": "https://stackoverflow.com/questions/38883968/initializing-an-array-with-a-pointer-in-c", "title": "Initializing an array with a pointer in c", "body": "<p>When I run the code:</p>\n\n<pre><code>char *abc=\"Goodbye\";\nfor(i=0; i&lt;=7; i++){\n    printf(\"%c\\n\",*(abc+i)); }\n</code></pre>\n\n<p>it runs without problem, but when I run the following:</p>\n\n<pre><code>char *der={'a','a','a','a','a'};\nfor(i=0; i&lt;=4; i++){\n    printf(\"%c\\n\",*(der+i)); }\n</code></pre>\n\n<p>it doesn't show the correct results and I receive warnings.</p>\n\n<p>So why is this happening since <code>\"Goodbye\"</code> and <code>{'a','a','a','a','a'}</code> are arrays of chars?</p>\n"}, {"tags": ["java", "c", "encryption", "openssl", "aes"], "comments": [{"owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 1, "creation_date": 1470864361, "post_id": 38883454, "comment_id": 65128519, "body": "You really should be using the <code>EVP_*</code> functions, because they include padding by default. Whereas the functions from aes.h are rather basic and are probably not supposed to be used at all."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1470865226, "post_id": 38883454, "comment_id": 65128840, "body": "You should <i>not</i> use <code>AES_encrypt</code> and friends. That&#39;s a software-only implementation, so you will not enjoy hardware support, like AES-NI. You should be using <code>EVP_*</code> functions. See <a href=\"http://wiki.openssl.org/index.php/EVP_Symmetric_Encryption_and_Decryption\" rel=\"nofollow noreferrer\">EVP Symmetric Encryption and Decryption</a> on the OpenSSL wiki. In fact, you should probably be using authenticated encryption because it provides <i>both</i> confidentiality and authenticity. See <a href=\"http://wiki.openssl.org/index.php/EVP_Authenticated_Encryption_and_Decryption\" rel=\"nofollow noreferrer\">EVP Authenticated Encryption and Decryption</a> on the OpenSSL wiki."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6137364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bbbe52927aa176992fb6fc9d2a45d66?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/6137364/andrew"}, "edited": false, "score": 0, "creation_date": 1470866574, "post_id": 38884143, "comment_id": 65129390, "body": "Thanks for the info. I will try to do AES/ECB/NoPadding and the do the padding myself in Scala. When using ECB, does it require an IV vector? and if so what would be the default openssl IV vector be?"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "reply_to_user": {"reputation": 23, "user_id": 6137364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bbbe52927aa176992fb6fc9d2a45d66?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/6137364/andrew"}, "edited": false, "score": 0, "creation_date": 1470868502, "post_id": 38884143, "comment_id": 65129971, "body": "@Andrew - be sure to verify the provider&#39;s default AES implementation is <code>AES&#47;ECB&#47;PKCS5Padding</code>. Also see <a href=\"http://stackoverflow.com/q/6258047\">Java default Crypto/AES behavior</a>."}, {"owner": {"reputation": 23, "user_id": 6137364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bbbe52927aa176992fb6fc9d2a45d66?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/6137364/andrew"}, "edited": false, "score": 0, "creation_date": 1470869196, "post_id": 38884143, "comment_id": 65130172, "body": "Thanks jww! I changed to <code>Cipher.getInstance(&quot;AES&#47;ECB&#47;NoPadding&quot;) </code> and padded the message byte array with 0s until it&#39;s a multiple of 16. <code>Arrays.copyOf(value.getBytes(&quot;UTF-8&quot;), paddedLength)</code>  That gave me the same outputs. I will do some more testing if filling it with 0s is just as good as filling it with <code>0x0b </code>"}], "tags": [], "owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "is_accepted": true, "score": 1, "last_activity_date": 1470869415, "last_edit_date": 1470869415, "creation_date": 1470865820, "answer_id": 38884143, "question_id": 38883454, "link": "https://stackoverflow.com/questions/38883454/aes-encryption-cross-component-java-scala-and-c/38884143#38884143", "title": "AES encryption cross-component Java/Scala and C", "body": "<blockquote>\n  <p>I am trying to match the outputs, but I have not been able to do it...</p>\n</blockquote>\n\n<p>For OpenSSL, you are operating the cipher in ECB mode, and you are responsible for the padding. I believe OpenSSL is encrypting 16 bytes composed of 6 characters (<em><code>hello\\0</code></em>) and 10 garbage characters.</p>\n\n<p>For Java, I believe you are using the cipher with <code>AES/ECB/PKCS5Padding</code>. <code>value: String</code> is unconditionally padded using PKCS padding. The padding also means 16 bytes of plaintext will expand to 32 bytes of ciphertext while OpenSSL remains at 16.</p>\n\n<p>In cases like this, its often good to go back to test vectors to see which implementation is diverging. For AES, you often use Brian Gladman's vectors.</p>\n\n<hr>\n\n<blockquote>\n  <p>I have tried to look into the documentation of AES_set_encrypt_key and AES_encrypt calls, but I couldn't dig too much out of it. I know that there are better user friendly calls from the openssl library like evp_encryption calls, but I can't get away from AES_set_encrypt_key and AES_encrypt</p>\n</blockquote>\n\n<p>OpenSSL does not document them because they don't want you using them. If you stay with <code>AES_encrypt</code> and friends, then you are married to a software-only implementation. You will also suffer endian-ness issues on occasion because EVP interfaces handle that for you. Finally, you will <em>not</em> enjoy hardware acceleration, like AES-NI on i686 or AES on ARMv8.</p>\n\n<hr>\n\n<blockquote>\n  <p>The C code gives <code>XaiMOCo7KteRUkejpd8JLA==</code>, in Scala/Java <code>7GHRfFgKVdaAiwti36tqDQ==</code></p>\n</blockquote>\n\n<p>Related, the Scala/Java is correct <strong><em>if</em></strong> you are aiming for ECB mode with PKCS padding. I can duplicate the Scala/Java results with <a href=\"https://www.cryptopp.com/\" rel=\"nofollow\">Crypto++</a> (its <code>StreamTransformationFilter</code> uses PKCS padding by default):</p>\n\n<pre class=\"lang-cxx prettyprint-override\"><code>int main(int argc, char* argv[])\n{\n  byte key[] = \"aaaaaaaaaaaaaaaa\";\n  ECB_Mode&lt;AES&gt;::Encryption enc(key, 16);\n  string result;\n\n  StringSource ss(string(\"hello\"), true,\n                  new StreamTransformationFilter(enc,\n                       new Base64Encoder(\n                           new StringSink(result))));\n\n  cout &lt;&lt; result &lt;&lt; endl;\n\n  return 0;\n}\n</code></pre>\n\n<hr>\n\n<p><strong><em>From Comments</em></strong></p>\n\n<blockquote>\n  <p>I will try to do AES/ECB/NoPadding and the do the padding myself in Scala.</p>\n</blockquote>\n\n<p>You will still need to avoid the garbage characters in the C program. Maybe something like the following will help you match Java's <a href=\"http://en.wikipedia.org/wiki/Padding_(cryptography)#PKCS7\" rel=\"nofollow\">PKCS #7 padding</a> (<code>0x0b</code> applied 11 times):</p>\n\n<pre><code>unsigned char text[] = \"hello\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\";\n</code></pre>\n\n<p>Here's a larger string padded with <a href=\"http://en.wikipedia.org/wiki/Padding_(cryptography)#PKCS7\" rel=\"nofollow\">PKCS #7 padding</a> (<code>0x06</code> applied 6 times):</p>\n\n<pre><code>unsigned char text[] = \"hellohello\\x06\\x06\\x06\\x06\\x06\\x06\";\n</code></pre>\n\n<p>If the string is 16 in length, then apply 0x10 16 times.</p>\n\n<hr>\n\n<blockquote>\n  <p>When using ECB, does it require an IV vector? </p>\n</blockquote>\n\n<p>No. ECB mode does not require an IV. It encrypts a 16-byte block under a key (and nothing more).</p>\n"}], "owner": {"reputation": 23, "user_id": 6137364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bbbe52927aa176992fb6fc9d2a45d66?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/6137364/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 724, "favorite_count": 0, "accepted_answer_id": 38884143, "answer_count": 1, "score": 1, "last_activity_date": 1470869415, "creation_date": 1470862877, "question_id": 38883454, "link": "https://stackoverflow.com/questions/38883454/aes-encryption-cross-component-java-scala-and-c", "title": "AES encryption cross-component Java/Scala and C", "body": "<p>I am trying to do a cross-component encryption working between different system. Currently, I can't really match the outputs.\nI am using openssl/aes/h library for C and javax.crypto for Java/Scala.\nI don't have much flexibility in changing the code in the C system, so that leaves me in the need of modifying the Java/Scala code.</p>\n\n<pre><code>#include &lt;string.h&gt; \n#include &lt;openssl/aes.h&gt;\n\nchar key[] = \"aaaaaaaaaaaaaaaa\";\n\nint main(){\n unsigned char text[]=\"hello\";\n unsigned char enc_out[80];\n unsigned char dec_out[80];\n\n AES_KEY enc_key, dec_key;\n\n AES_set_encrypt_key(key, 128, &amp;enc_key);\n AES_encrypt(text, enc_out, &amp;enc_key);\n return 0\n}\n</code></pre>\n\n<p>The C code roughly looks like that.Using the AES_set_encrypt_key and AES_encrypt calls except there is padding with 0s when needed (when key is not 128 bits). The padding shouldnt matter for this simple example.</p>\n\n<p>In the scala code I have:</p>\n\n<pre><code>  def aes_encrypt(value: String, k: String): Array[Byte] = {\n    val cipher = Cipher.getInstance(\"AES\")\n    val key = Arrays.copyOf(k.getBytes(\"UTF-8\"), 16)\n    val secretKey: SecretKeySpec = new SecretKeySpec(key, 0, key.length, \"AES\")\n    cipher.init(Cipher.ENCRYPT_MODE, secretKey)\n    cipher.doFinal(value.getBytes(\"UTF-8\"), 0, value.getBytes(\"UTF-8\").length)\n  }\n</code></pre>\n\n<p>Using the key \"aaaaaaaaaaaaaaaa\" and message \"hello\" , in base64 </p>\n\n<p>The C code gives \"XaiMOCo7KteRUkejpd8JLA==\"</p>\n\n<p>in Scala/Java    \"7GHRfFgKVdaAiwti36tqDQ==\"</p>\n\n<p>I am trying to match the outputs, but I have not been able to do it.\nI have tried different algorithm for the Scala code, but I am not sure how to match the C output.</p>\n\n<p>I have tried to look into the documentation of AES_set_encrypt_key and AES_encrypt calls, but I couldn't dig too much out of it. I know that there are better user friendly calls from the openssl library like evp_encryption calls, but I can't get away from  AES_set_encrypt_key and AES_encrypt</p>\n"}, {"tags": ["java", "c", "java-native-interface", "ffi"], "comments": [{"owner": {"reputation": 6004, "user_id": 6471538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Robert Columbia", "link": "https://stackoverflow.com/users/6471538/robert-columbia"}, "edited": false, "score": 1, "creation_date": 1470859915, "post_id": 38882650, "comment_id": 65126351, "body": "Could you show us your code? What have you tried? What was the result? Are you getting compile errors? Does the data not transfer correctly?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1470860048, "post_id": 38882650, "comment_id": 65126434, "body": "Please show your research/debugging effort so far. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> page first."}], "answers": [{"tags": [], "owner": {"reputation": 1474, "user_id": 6483824, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3fc10ff38e7bf1b5a7b5e62399016ccb?s=128&d=identicon&r=PG&f=1", "display_name": "mike", "link": "https://stackoverflow.com/users/6483824/mike"}, "is_accepted": true, "score": 6, "last_activity_date": 1470861067, "creation_date": 1470861067, "answer_id": 38882993, "question_id": 38882650, "link": "https://stackoverflow.com/questions/38882650/how-to-convert-a-jchararray-to-a-char-in-c/38882993#38882993", "title": "How to convert a jcharArray to a char[] in c", "body": "<p>You must use jni functions, there are at least two methods:</p>\n\n<p>Copy a region:</p>\n\n<pre><code>jchar buf[10]; \n(*env)-&gt;GetCharArrayRegion(env, bits, 0, 10, buf); \n</code></pre>\n\n<p>lock a memory region in JVM, then access it and finally release:</p>\n\n<pre><code>jchar *carr; \ncarr = (*env)-&gt;GetCharArrayElements(env, bits, NULL); \nif (carr == NULL) {\n    return 0; /* exception occurred */ \n} \n//for (int i=0; i&lt;10; i++) {\n//    do something with carr[i]; \n//} \n(*env)-&gt;ReleaseCharArrayElements(env, bits, carr, 0); \n</code></pre>\n\n<p>Here I assume your array is 10 elements in length. To find out number of elements in the array use <code>GetArrayLength</code> jni function.</p>\n"}], "owner": {"reputation": 241, "user_id": 2350459, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9eaf3d41493d3ecf72af1d9aba52fb18?s=128&d=identicon&r=PG", "display_name": "user2350459", "link": "https://stackoverflow.com/users/2350459/user2350459"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2410, "favorite_count": 0, "accepted_answer_id": 38882993, "answer_count": 1, "score": -3, "last_activity_date": 1481034521, "creation_date": 1470859817, "last_edit_date": 1481034521, "question_id": 38882650, "link": "https://stackoverflow.com/questions/38882650/how-to-convert-a-jchararray-to-a-char-in-c", "title": "How to convert a jcharArray to a char[] in c", "body": "<p>I have a <code>jcharArray</code> that is passed into a C program through Java, and I need to know how to use the array in the C program. How do I convert my <code>jcharArray</code> bits into something I can use (<code>char bits[]</code>)?</p>\n\n<p>I tried writing this code using JNI</p>\n\n<pre><code>JNIEXPORT jint JNICALL Java_ex_NistStatisticalTestSuite_frequency\n  (JNIEnv *env, jclass cls, jcharArray bits, jint jn)\n{\n\n    printf(\"running frequency test\");\n\n    int     i;\n    double  f, s_obs, p_value, sum, sqrt2 = 1.41421356237309504880;\n    int n=jn;\n    char deletethis=(char)bits[0];\n    sum = 0.0;\n    for ( i=0; i&lt;n; i++ )\n        sum += 2*1-1;\n    s_obs = fabs(sum)/sqrt(n);\n    f = s_obs/sqrt2;\n    p_value = erfc(f);\n\n    return (jint)p_value;\n\n}\n</code></pre>\n\n<p>but it fails to compile, saying:</p>\n\n<blockquote>\n<pre><code>frequency.c:19:2: error: invalid use of undefined type \u2018struct _jobject\u2019\n  char deletethis=(char)bits[0];\n  ^~~~\nfrequency.c:19:28: error: dereferencing pointer to incomplete type \u2018struct _jobject\u2019\n  char deletethis=(char)bits[0];\n</code></pre>\n</blockquote>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1470859105, "post_id": 38882435, "comment_id": 65125915, "body": "Start with formatting this mess properly."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 4, "creation_date": 1470859483, "post_id": 38882435, "comment_id": 65126107, "body": "Next, enable all warnings and treat every single one of them as error!"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1470859542, "post_id": 38882435, "comment_id": 65126150, "body": "<code>reverse(&amp;p);</code> --&gt; <code>reverse(p);</code>, <code>while (i &lt; 3) {         ReverseDigits(array, 3);         i++;     }</code> --&gt; <code>ReverseDigits(array, 3);     for(i=0; i &lt; 3; ++i)     \tprintf(&quot;%d\\n&quot;, array[i]);</code>"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1470861078, "post_id": 38882435, "comment_id": 65126945, "body": "Why are you trying to reverse it 3 times?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1470861434, "post_id": 38882435, "comment_id": 65127123, "body": "Look at the <code>reverse()</code> function.  <code>number2</code> is computed as the sum of the digits of <code>*n</code> (aka <code>n[0]</code>) supplied to it.     Then <code>*n</code> is set to that value.    The logic has nothing to do with reversing anything."}, {"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1470862022, "post_id": 38882435, "comment_id": 65127419, "body": "@Peter: Actually the <code>reverse()</code> function correctly reverses the digits of the number pointed to by <code>n</code>, e.g. <code>123</code> becomes <code>321</code>."}], "answers": [{"comments": [{"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 2, "creation_date": 1470861890, "post_id": 38883081, "comment_id": 65127352, "body": "If I understand it correctly, the program is supposed to <i>reverse the digits</i> of each element in the array, i.e. <code>{123, 456, 789}</code> should become <code>{321, 654, 987}</code>."}, {"owner": {"reputation": 7429, "user_id": 4811873, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/2ef5bab087ac0b70e03e34b0b0009fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Robinson", "link": "https://stackoverflow.com/users/4811873/mike-robinson"}, "reply_to_user": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1470861973, "post_id": 38883081, "comment_id": 65127393, "body": "An interesting possibility ... <i>(rolleyes)</i> ... leaving on-the-table the subsequent pondering: &quot;so, exactly what does this have to do with &#39;an array?&#39;&quot;  Oh, well... I tried ... <b>:*)</b>"}], "tags": [], "owner": {"reputation": 7429, "user_id": 4811873, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/2ef5bab087ac0b70e03e34b0b0009fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Robinson", "link": "https://stackoverflow.com/users/4811873/mike-robinson"}, "is_accepted": false, "score": 0, "last_activity_date": 1470861375, "creation_date": 1470861375, "answer_id": 38883081, "question_id": 38882435, "link": "https://stackoverflow.com/questions/38882435/how-to-reverse-digits-of-each-number-in-an-array-using-pointer-arithmetic/38883081#38883081", "title": "How to reverse digits of each number in an array using pointer arithmetic", "body": "<p>It seems to me that your <code>reverse()</code> function is \"both baffling, and necessarily wrong.\" <em>(Hey, don't take that personally...)</em> </p>\n\n<p>How could such a function <em>possibly</em> work, without being told, not only <em>where</em> the (array) is, but how <em>long</em> it is? You seem to be missing a parameter here.</p>\n\n<p>Once you've settled <em>that</em> problem in your design, the task of \"reversing\" an array is simply a process of \"swapping\" the first-and-last elements in an algorithm that goes something like this: <em>(pseudocode!)</em></p>\n\n<pre><code> function reverse( array[], array_size) {\n   int i = 0;\n   int j = array_size - 1;   // since zero-based\n   while (i &lt; j) {           // no need to use \"&lt;=\" here\"\n      temp     = array[i];\n      array[i] = array[j];\n      array[j] = temp;\n      i++;\n      j--;\n   }\n }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 1, "last_activity_date": 1470862680, "creation_date": 1470862680, "answer_id": 38883408, "question_id": 38882435, "link": "https://stackoverflow.com/questions/38882435/how-to-reverse-digits-of-each-number-in-an-array-using-pointer-arithmetic/38883408#38883408", "title": "How to reverse digits of each number in an array using pointer arithmetic", "body": "<p>In <code>ReverseDigits</code> the variable <code>p</code> is an int pointer. When you do <code>&amp;p</code> you'll get a pointer to int pointer. But your <code>reverse</code> function just expects an int pointer so your call of <code>reverse</code>is wrong. Simply do</p>\n\n<pre><code>reverse(p);  // insteand of reverse(&amp;p)\n</code></pre>\n\n<p>In <code>main</code> you shall not call <code>ReverseDigits</code> in a loop as the function already loops the array (i.e. the number of elements passed). So skip the <code>while</code> and simply do:</p>\n\n<pre><code>int main() {\n    int array[3] = {123, 456, 789};\n\n    ReverseDigits(array, 3);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6063312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b652b1e76d54bcdc7695825c594d252?s=128&d=identicon&r=PG&f=1", "display_name": "Leon Benko", "link": "https://stackoverflow.com/users/6063312/leon-benko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 38883408, "answer_count": 2, "score": -2, "last_activity_date": 1470924383, "creation_date": 1470859045, "last_edit_date": 1470924383, "question_id": 38882435, "link": "https://stackoverflow.com/questions/38882435/how-to-reverse-digits-of-each-number-in-an-array-using-pointer-arithmetic", "title": "How to reverse digits of each number in an array using pointer arithmetic", "body": "<p>I tried to write a program in C that reverses all the numbers in an array, but it actually doesn't reverse anything, so I get unchanged numbers back. I guess I got something wrong with the pointers.</p>\n\n<p>Here is my code: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid reverse(int *n) { \n    int number = *n, number2 = 0;\n\n    while (number!=0) {\n        number2 *= 10;\n        number2 += number % 10;\n        number /= 10;\n    }\n\n    *n = number2;\n}\n\nvoid ReverseDigits(int *p, int n) {\n    int i = 0;\n\n    while (i &lt; n) {\n        reverse(&amp;p);\n        p++;\n        i++;\n    }\n}\n\nint main() {\n    int array[3] = {123, 456, 789}, i = 0;\n\n    while (i &lt; 3) {\n        ReverseDigits(array, 3);\n        i++;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm", "pointers", "char", "memcpy"], "comments": [{"owner": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 1, "creation_date": 1470858205, "post_id": 38882141, "comment_id": 65125466, "body": "Please <a href=\"https://stackoverflow.com/posts/38882141/edit\">edit</a> your question to include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1470859023, "post_id": 38882141, "comment_id": 65125873, "body": "&quot;users to enter a string into a char pointer&quot; - Bad idea! A pointer is not an array. You definitively don&#39;t want users to input anything <b>into</b> a pointer!"}, {"owner": {"reputation": 2630, "user_id": 4065269, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/90c9cd69a6663c31758d6cd6043dfcc3?s=128&d=identicon&r=PG&f=1", "display_name": "sps", "link": "https://stackoverflow.com/users/4065269/sps"}, "edited": false, "score": 1, "creation_date": 1470861172, "post_id": 38882141, "comment_id": 65126994, "body": "I tested your <code>Permute</code> function by writing my own <code>main</code> function and it seems to be working fine for the inputs that I tested. I tested for <code>AABB</code>, <code>AABBB</code>, etc. I dont think there is issue in <code>Permute</code> function that you have shown here. Can you edit your question and add the function from where you are calling Permute? There will be issue if <code>printPerm[permIndex]</code> is does not point to valid memory, and if <code>permIndex</code> is not initialized correctly."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1470864178, "post_id": 38882141, "comment_id": 65128429, "body": "Show the declaration of printPerm. It is the likely failure  point."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1470866815, "post_id": 38882141, "comment_id": 65129461, "body": "I suspect the problem is that your code that figures out how large to make the <code>printPerm</code> array is counting unique characters. So &quot;ABCD&quot; has 4 unique characters and the number of permutations is computed correctly. But &quot;AADD&quot; has only 2 unique characters. Your <code>Permute</code> function doesn&#39;t take into account repeated characters, so it will still try to compute 24 permutations. You need to show us how you&#39;re determining the size of the <code>printPerm</code> array."}], "answers": [{"tags": [], "owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "is_accepted": false, "score": 0, "last_activity_date": 1470865618, "creation_date": 1470865618, "answer_id": 38884103, "question_id": 38882141, "link": "https://stackoverflow.com/questions/38882141/why-does-my-program-crash-when-transferring-strings-between-char-pointers-in-c/38884103#38884103", "title": "Why does my program crash when transferring strings between char pointers in C?", "body": "<p>You are lucky: my crystal ball just came back from repair! Let's see if it works now:</p>\n\n<pre><code>// ALL CHECKS OMMITTED!\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstatic int permIndex;\n\n// place the two functions you published here\n\n// Uhmmm...well...but we need one\nint factorial(int n)\n{\n  int f = 1;\n  do {\n    f *= n;\n  } while (--n);\n\n  return f;\n}\n\nint main(int argc, char **argv)\n{\n  int f,i;\n  char **pperm;\n  char *word;\n  size_t length;\n\n  if (argc &lt; 2) {\n    fprintf(stderr, \"Usage: %s string\\n\", argv[0]);\n    exit(EXIT_FAILURE);\n  }\n\n  // work on copy\n  length = strlen(argv[1]);\n  word = malloc(length + 1);\n  strcpy(word, argv[1]);\n\n  // You either allocate memory as you need it but as you compute\n  // all combinations first, you need the whole memory for them\n  // at once. That means the amount of memory needed is known in\n  // advance and can be allocated at once\n\n  f = factorial((int) length);\n  // allocate memory for an array of (length)! pointers to char\n  pperm = malloc(f * sizeof(char *));\n  for (i = 0; i &lt; f; i++) {\n    // allocate memory for the n characters plus '\\0'\n    pperm[i] = malloc(length + 1);\n  }\n\n  Permute(word, pperm, 0, length - 1);\n\n  // do something with the list\n\n  // print it\n  for (i = 0; i &lt; f; i++) {\n    printf(\"%s\\n\", pperm[i]);\n    // we don't need the memory anymore: free it\n    free(pperm[i]);\n  }\n  // free that array of pointers mjentioned above\n  free(pperm);\n  // free the memory for the input \n  free(word);\n\n  exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>This is one of several ways to do it.</p>\n"}], "owner": {"reputation": 11, "user_id": 6701967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/231a2f5fe37482a36dd9ef64b05de32a?s=128&d=identicon&r=PG&f=1", "display_name": "TheFlyingCanadian", "link": "https://stackoverflow.com/users/6701967/theflyingcanadian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 254, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470865618, "creation_date": 1470857952, "question_id": 38882141, "link": "https://stackoverflow.com/questions/38882141/why-does-my-program-crash-when-transferring-strings-between-char-pointers-in-c", "title": "Why does my program crash when transferring strings between char pointers in C?", "body": "<p>I'm having a problem with memcpy() in c right now, and hope someone can help.</p>\n\n<p>My program allows users to enter a string into a char pointer, and then calculates all possible permutations. As the permutations are generated (the user input pointer is changed into a permutation), the permutation is copied into a second char pointer via memcpy. It works perfectly, unless the string has two or more different repeating characters (eg. \"CCBB\" or \"AADD\"). If the user enters anything like this, memcpy (or even strcpy) causes the program to crash.</p>\n\n<pre><code>void Permute(char * word, char ** printPerm, int start, int end)\n{   \n    if (start == end)\n    {\n        memcpy(printPerm[permIndex], word, strlen(word) + 1);\n        ++permIndex;\n    }\n    else\n    {\n        for (int i = start; i &lt;= end; ++i)\n        {\n            Swap((word + start), (word + i));\n            Permute(word, printPerm, start + 1, end);\n            Swap((word + start), (word + i));\n        }\n    }\n}\n\nvoid Swap(char *a, char *b)\n{\n    char temp;\n    temp = *a;\n    *a = *b;\n    *b = temp;\n}\n</code></pre>\n\n<p>I've tried allocating more memory to both pointers but it's proved futile. Everything else works except for this.</p>\n\n<p>Because I'm using gcc on Windows (MinGW), the details of my crash aren't shown. It simply says \"perm.exe has stopped working\". I used a series of printf() statements and found that the program is crashing on the memcpy() line.</p>\n\n<p>A few details about the code:</p>\n\n<p>The \"word\" char pointer holds the user's input. It will be morphed into permutations by the program, and it's contents will be dumped into \"printPerm\". \"printPerm\" the the char pointer array that holds the permutations, and will later be used to print the permutations when they've been sorted alphabetically and any duplicate entries have been removed. \"permIndex\" is the index of \"printPerm\" and is iterated every time a permutation is added to \"printPerm\".</p>\n\n<p>Sorry I don't have more details, but using a text editor and gcc means I don't get much of a debugger. It seems any method of tranferring data between the pointers will crash the program ONLY if the string contains two or more different repeating characters.</p>\n"}, {"tags": ["c", "for-loop", "multidimensional-array", "c11", "fgetc"], "comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 1, "creation_date": 1470858034, "post_id": 38882034, "comment_id": 65125370, "body": "I bet this is on a Windows machine, right? Or at least your input file has crlf line endings."}, {"owner": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "edited": false, "score": 0, "creation_date": 1470858073, "post_id": 38882034, "comment_id": 65125393, "body": "Yep, cause the &#39;missing&#39; character is moving backwards one position in each line - which means the extra <code>fgetc</code> is discarding it."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1470858228, "post_id": 38882034, "comment_id": 65125477, "body": "Indeed, looks like your file is in fact a text file with Windows line endings, even though you open it in binary mode. Hints, use debugger, print read characters&#39; ASCII values instead of characters themselves, and don&#39;t cram so many things in one line, so things are easier to debug."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470859267, "post_id": 38882034, "comment_id": 65125998, "body": "There is no 2D array in your code and nothing which can represent one or point to one."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1470860006, "post_id": 38882034, "comment_id": 65126409, "body": "<a href=\"https://en.wikipedia.org/wiki/Netpbm_format\" rel=\"nofollow noreferrer\">ppm</a> appears to be a text file.  Perhaps open file in text mode?"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1470860179, "post_id": 38882034, "comment_id": 65126501, "body": "@chux It depends on the &quot;magic number&quot;, P4 P5 and P6 (ppm RGB) are actually binary."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1470860421, "post_id": 38882034, "comment_id": 65126614, "body": "@Bob__ Good to know.  LSNED."}, {"owner": {"reputation": 23, "user_id": 5648419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/794754a56341eb5a9dc00a6494f362d5?s=128&d=identicon&r=PG&f=1", "display_name": "Egon Gilstrom", "link": "https://stackoverflow.com/users/5648419/egon-gilstrom"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471329425, "post_id": 38882034, "comment_id": 65290213, "body": "@Olaf does the array have to be stored for it to count as a 2D array? the problem was inputting a binary 2d array of bytes. &quot;2D Array&quot; is the format of the data within the file I was reading, if this is indeed not what a 2d array is, then I will remove the tag, but this does still fit the definition of what a multidimensional array is, so as I see it your comment is unjustified. If you can convince me otherwise I will remove the tag immediately. (took me a while to respond because I was considering if it was worth it or not)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471347808, "post_id": 38882034, "comment_id": 65301148, "body": "@EgonGilstrom: I commented more on your text &quot;I am working on inputting a 2d pixel array ...&quot; and suspected a very common missconception- But yes, if you don&#39;t mean a C array, nor want one, you of course can process the file on-the-fly (hi, Marty Mc!)."}], "answers": [{"tags": [], "owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "is_accepted": true, "score": 0, "last_activity_date": 1470860403, "last_edit_date": 1470860403, "creation_date": 1470859491, "answer_id": 38882562, "question_id": 38882034, "link": "https://stackoverflow.com/questions/38882034/fgetc-dropping-characters-when-reading-2d-pixel-map-with-for-loop/38882562#38882562", "title": "fgetc dropping characters when reading 2d pixel map with for loop", "body": "<p>The problem is that '\\n' on a Windows machine actually ends up producing two characters, a carriage return (ASCII code 13) and a line feed (ASCII code 10). When you open a file in binary mode, those line endings are not translated back to a single character. You're only accounting for one of these characters, so you're getting off by a character on each line you read.</p>\n\n<p>To illustrate this, replace your <code>printf(\"%c\", c);\"</code> with <code>printf(\"%d \", c);</code>. I get the following output:</p>\n\n<pre><code>49 50 51 52 53 \n10 97 98 99 100 \n13 10 49 50 51 \n53 13 10 97 98 \n100 101 13 10 49\n</code></pre>\n\n<p>You can see those 10s and 13s shifting through.</p>\n\n<p>Now try adding a second <code>fgetc(f);</code> to eat the line feed and it will work much better. Keep in mind, however, that this only works on files with CRLF line endings. Port it to Linux or Mac and you will have more troubles.</p>\n"}], "owner": {"reputation": 23, "user_id": 5648419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/794754a56341eb5a9dc00a6494f362d5?s=128&d=identicon&r=PG&f=1", "display_name": "Egon Gilstrom", "link": "https://stackoverflow.com/users/5648419/egon-gilstrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 38882562, "answer_count": 1, "score": -1, "last_activity_date": 1471329592, "creation_date": 1470857584, "last_edit_date": 1471329592, "question_id": 38882034, "link": "https://stackoverflow.com/questions/38882034/fgetc-dropping-characters-when-reading-2d-pixel-map-with-for-loop", "title": "fgetc dropping characters when reading 2d pixel map with for loop", "body": "<p>I am working on inputting a 2d pixel array from a PPM file with the one I am testing being of width and length 5. Also I am aware that in a ppm file that is rgb it has 3 color values not just one. I had forgotten that before I wrote this code, but the problem still persists even with the update to it and the problem still exists in the same way. I have simplified the problem to just the array as to isolate the problem. From what I can tell this seems to be both dropping characters and replacing some with new line characters as well. Any insight into why this is happening would be greatly appreciated and if I forgot to add something I will update this as soon as I am aware.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int args, char *argv[]) {\n    int w = 5, h = 5;\n\n    FILE *f = fopen(argv[1], \"rb\");\n    int c = 'a';//I am setting this so as to avoid the off chance of c being defined as EOF\n    for(int i = 0; i &lt; h &amp;&amp; c != EOF; i++) {\n        for(int j = 0; j &lt; w &amp;&amp; (c = fgetc(f)) != EOF; j++) printf(\"%c\", c);\n        fgetc(f);//To remove the '\\n' character I am not using fgets because it stops at '\\n' character and it is possible for a rgb value to be == to '\\n'\n        printf(\"\\n\");\n    }\n    fclose(f);\n    return 0;\n}\n</code></pre>\n\n<p>Test File I am using:</p>\n\n<pre><code>12345\nabcde\n12345\nabcde\n12345\n</code></pre>\n\n<p>Output I am getting: </p>\n\n<pre><code>12345\n\nabcd\n\n123\n5\nab\nde\n1\n</code></pre>\n\n<p>Thanks in advance!</p>\n\n<p>Edit: This is running on the windows 10 command prompt</p>\n"}, {"tags": ["c", "bit-manipulation"], "comments": [{"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1470857226, "post_id": 38881877, "comment_id": 65124942, "body": "Do you allow the use of <code>pdep</code>?"}, {"owner": {"reputation": 1455, "user_id": 5339966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0897e935d50e040875b9ea61d8c0851c?s=128&d=identicon&r=PG&f=1", "display_name": "mszymborski", "link": "https://stackoverflow.com/users/5339966/mszymborski"}, "edited": false, "score": 4, "creation_date": 1470857302, "post_id": 38881877, "comment_id": 65124986, "body": "Sean Eron Anderson has this in his bit twiddling hacks: <a href=\"https://graphics.stanford.edu/~seander/bithacks.html#InterleaveTableObvious\" rel=\"nofollow noreferrer\">graphics.stanford.edu/~seander/&hellip;</a> - also the three ones below."}, {"owner": {"reputation": 1484, "user_id": 3780573, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/81f2ae844e72da9de5163cd2593f000a?s=128&d=identicon&r=PG&f=1", "display_name": "thndrwrks", "link": "https://stackoverflow.com/users/3780573/thndrwrks"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1470857304, "post_id": 38881877, "comment_id": 65124988, "body": "@harold No, sorry. Straight-up C."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 2, "creation_date": 1470857422, "post_id": 38881877, "comment_id": 65125048, "body": "So no <code>_pdep_u32</code> intrinsic either?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470857456, "post_id": 38881877, "comment_id": 65125073, "body": "What non-&quot;bithack-y way&quot; did you try? Why does that not work/is too complex/too slow/etc.?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1470857488, "post_id": 38881877, "comment_id": 65125091, "body": "@harold: That&#39;s not standard. What is <code>pdep</code>??"}, {"owner": {"reputation": 1484, "user_id": 3780573, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/81f2ae844e72da9de5163cd2593f000a?s=128&d=identicon&r=PG&f=1", "display_name": "thndrwrks", "link": "https://stackoverflow.com/users/3780573/thndrwrks"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1470857540, "post_id": 38881877, "comment_id": 65125123, "body": "@harold No intrinsics. Trying to keep this portable."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1470857598, "post_id": 38881877, "comment_id": 65125152, "body": "@Olaf it scatters bits according to a mask, putting the lsb at the position of the lowest set bit in the mask and so on. This problem could be solved with a pdep and a multiplication by 3."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1470857822, "post_id": 38881877, "comment_id": 65125262, "body": "@harold: Well, it does not exist on my targets. You seem to assume x86 is ISO-given. How do you know OP uses x86?"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 5, "creation_date": 1470857865, "post_id": 38881877, "comment_id": 65125283, "body": "@Olaf I don&#39;t, that&#39;s why I asked whether he allows it."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1470859664, "post_id": 38881877, "comment_id": 65126214, "body": "My gut-feeling is that there is a multiplication-trick possible here. BTW: Stanford bit hacks does have bit-interleaving, IIRC."}, {"owner": {"reputation": 1455, "user_id": 5339966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0897e935d50e040875b9ea61d8c0851c?s=128&d=identicon&r=PG&f=1", "display_name": "mszymborski", "link": "https://stackoverflow.com/users/5339966/mszymborski"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1470860250, "post_id": 38881877, "comment_id": 65126536, "body": "@wildplasser: sure they have: <a href=\"https://graphics.stanford.edu/~seander/bithacks.html#Interleave64bitOps\" rel=\"nofollow noreferrer\">graphics.stanford.edu/~seander/bithacks.html#Interleave64bit&zwnj;&#8203;Ops</a> - but God is this hacky"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470859470, "post_id": 38882523, "comment_id": 65126100, "body": "That code does invoke undefined behaviour in at least one expression (more on certain platforms)!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470859577, "post_id": 38882523, "comment_id": 65126177, "body": "Read the standard - section bitshifts."}, {"owner": {"reputation": 174, "user_id": 4490919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YukaU.jpg?s=128&g=1", "display_name": "javey", "link": "https://stackoverflow.com/users/4490919/javey"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1470859710, "post_id": 38882523, "comment_id": 65126247, "body": "That&#39;s not an explanation. Can you point out a specific expression of undefined behavior?"}, {"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470860388, "post_id": 38882523, "comment_id": 65126602, "body": "I suspect that this has to do with bit shifts on a signed integer. @Olaf, could you confirm this?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1470860468, "post_id": 38882523, "comment_id": 65126635, "body": "Using <code>uint8_t</code> for <code>bit_at_i</code> is risky \u2014 it gets converted to (signed) <code>int</code> in the computation for <code>result</code>.  Use <code>uint32_t</code> instead; it avoids problems.  You could use <code>1U</code> instead of <code>1</code> in the masking operation too, for similar reasons, though there are few systems left with 16-bit plain <code>int</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470861845, "post_id": 38882523, "comment_id": 65127327, "body": "@JonathanLeffler: <code>1U</code> will not be sufficient for 16 bit architectures."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1470861887, "post_id": 38882523, "comment_id": 65127349, "body": "@Olaf: Oh, why not?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470861961, "post_id": 38882523, "comment_id": 65127387, "body": "&quot;That&#39;s not an explanation.&quot; - It is not. But it is a clear hint where to look for the explanation. Apparently you did not even try to follow my advice. The standard is the only authoritative resource when it comes to C issues like UB. Using it is a good idea and this is a very easy entry to get familar with it."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1470862184, "post_id": 38882523, "comment_id": 65127493, "body": "@JonathanLeffler: Sorry, I was after the variable. Anyway, still far by most targets have in fact 16 bit <code>int</code>. Still something like 8051 is sold more than most ARM. Add PIC16, AVR, the various HC08/05/12 derivats and the many other 8 or 16 bit MCUs I just don&#39;t remember. Then DSPs, etc."}], "tags": [], "owner": {"reputation": 174, "user_id": 4490919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YukaU.jpg?s=128&g=1", "display_name": "javey", "link": "https://stackoverflow.com/users/4490919/javey"}, "is_accepted": false, "score": 1, "last_activity_date": 1470863237, "last_edit_date": 1470863237, "creation_date": 1470859344, "answer_id": 38882523, "question_id": 38881877, "link": "https://stackoverflow.com/questions/38881877/bit-hack-expanding-bits/38882523#38882523", "title": "Bit hack: Expanding bits", "body": "<p>Try this, where <code>input16</code> is the uint16_t input mask:</p>\n\n<pre><code>uint32_t input32 = (uint32_t) input16;\nuint32_t result = 0;\nuint32_t i;\nfor(i=0; i&lt;16; i++)\n{\n    uint32_t bit_at_i = (input32 &amp; (((uint32_t)1) &lt;&lt; i)) &gt;&gt; i;\n    result |= ((bit_at_i &lt;&lt; (i*2)) | (bit_at_i &lt;&lt; ((i*2)+1)));\n}\n// result is now the 32 bit expanded mask\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1470860285, "creation_date": 1470860285, "answer_id": 38882770, "question_id": 38881877, "link": "https://stackoverflow.com/questions/38881877/bit-hack-expanding-bits/38882770#38882770", "title": "Bit hack: Expanding bits", "body": "<p>Here's a working implementation:</p>\n\n<pre><code>uint32_t remask(uint16_t x)\n{\n    uint32_t i;\n    uint32_t result = 0;\n    for (i=0;i&lt;16;i++) {\n        uint32_t mask = (uint32_t)x &amp; (1U &lt;&lt; i);\n        result |= mask &lt;&lt; (i);\n        result |= mask &lt;&lt; (i+1);\n    }\n    return result;\n}\n</code></pre>\n\n<p>On each iteration of the loop, the bit in question from the <code>uint16_t</code> is masked out and stored.  </p>\n\n<p>That bit is then shifted by its bit position and ORed into the result, then shifted again by its bit position plus 1 and ORed into the result.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1470886032, "last_edit_date": 1470886032, "creation_date": 1470861011, "answer_id": 38882976, "question_id": 38881877, "link": "https://stackoverflow.com/questions/38881877/bit-hack-expanding-bits/38882976#38882976", "title": "Bit hack: Expanding bits", "body": "<p>A simple loop.  Maybe not bit-hacky enough?</p>\n\n<pre><code>uint32_t thndrwrks_expand(uint16_t x) {\n  uint32_t mask = 3;\n  uint32_t y = 0;\n  while (x) {\n    if (x&amp;1) y |= mask;\n    x &gt;&gt;= 1;\n    mask &lt;&lt;= 2;\n  }\n  return y;\n}\n</code></pre>\n\n<p>Tried another that is twice as fast. Still 655/272 as slow as <code>expand_bits()</code>.  Appears to be fastest 16 loop iteration solution.</p>\n\n<pre><code>uint32_t thndrwrks_expand(uint16_t x) {\n  uint32_t y = 0;\n  for (uint16_t mask = 0x8000; mask; mask &gt;&gt;= 1) {\n    y &lt;&lt;= 1;\n    y |= x&amp;mask;\n  }\n  y *= 3;\n  return y;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1470871853, "post_id": 38883125, "comment_id": 65130853, "body": "Can you explain how this works? It&#39;s quite short, but it&#39;s not immediately clear what&#39;s going on."}], "tags": [], "owner": {"reputation": 1484, "user_id": 3780573, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/81f2ae844e72da9de5163cd2593f000a?s=128&d=identicon&r=PG&f=1", "display_name": "thndrwrks", "link": "https://stackoverflow.com/users/3780573/thndrwrks"}, "is_accepted": true, "score": 9, "last_activity_date": 1471578911, "last_edit_date": 1471578911, "creation_date": 1470861574, "answer_id": 38883125, "question_id": 38881877, "link": "https://stackoverflow.com/questions/38881877/bit-hack-expanding-bits/38883125#38883125", "title": "Bit hack: Expanding bits", "body": "<p><a href=\"http://graphics.stanford.edu/~seander/bithacks.html#InterleaveBMN\" rel=\"nofollow\">Interleaving bits by Binary Magic Numbers</a> contained the clue:</p>\n\n<pre><code>uint32_t expand_bits(uint16_t bits)\n{\n    uint32_t x = bits;\n\n    x = (x | (x &lt;&lt; 8)) &amp; 0x00FF00FF;\n    x = (x | (x &lt;&lt; 4)) &amp; 0x0F0F0F0F;\n    x = (x | (x &lt;&lt; 2)) &amp; 0x33333333;\n    x = (x | (x &lt;&lt; 1)) &amp; 0x55555555;\n\n    return x | (x &lt;&lt; 1);\n}\n</code></pre>\n\n<p>The first four steps consecutively interleave the source bits in groups of 8, 4, 2, 1 bits with zero bits, resulting in <code>00AB00CD</code> after the first step, <code>0A0B0C0D</code> after the second step, and so on. The last step then duplicates each even bit (containing an original source bit) into the neighboring odd bit, thereby achieving the desired bit arrangement.</p>\n\n<p>A number of variants are possible. The last step can also be coded as <code>x + (x &lt;&lt; 1)</code> or <code>3 * x</code>. The <code>|</code> operators in the first four steps can be replaced by <code>^</code> operators. The masks can also be modified as some bits are naturally zero and don't need to be cleared. On some processors short masks may be incorporated into machine instructions as immediates, reducing the effort for constructing and / or loading the mask constants. It may also be advantageous to increase instruction-level parallelism for out-of-order processors and optimize for those with shift-add or integer-multiply-add instructions. One code variant incorporating various of these ideas is:</p>\n\n<pre><code>uint32_t expand_bits (uint16_t bits)\n{\n    uint32_t x = bits;\n\n    x = (x ^ (x &lt;&lt; 8)) &amp; ~0x0000FF00;\n    x = (x ^ (x &lt;&lt; 4)) &amp; ~0x00F000F0;\n    x = x ^ (x &lt;&lt; 2);\n    x = ((x &amp; 0x22222222) &lt;&lt; 1) + (x &amp; 0x11111111);\n    x = (x &lt;&lt; 1) + x;\n\n    return x;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1470862541, "post_id": 38883310, "comment_id": 65127685, "body": "With the possibility of cache misses etc, a table is likely to be slower than the bit-twiddling hack <a href=\"http://stackoverflow.com/a/38883125/\">solution</a>.  I&#39;m not sure how you deduce that the middle-endian orders will produce the wrong result \u2014 numerically, the result will be correct (as a 32-bit value), but if you analyze bytes in sequence, then you would get different results, but that would also be true of big-endian vs little-endian systems too."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1470862549, "post_id": 38883310, "comment_id": 65127690, "body": "1) Sneaky endian agnostic UV.  2) Would seem more consistent to use <code>uint8_t</code>--&gt; <code>uint8_t outputBytes[4];</code>  3) suggest <code>uint32</code> --&gt; <code>uint32_t</code>"}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1470871726, "post_id": 38883310, "comment_id": 65130824, "body": "@chux Yes, I thought about using <code>uint8_t</code>. I decided against it to make it clear that I&#39;m actually using a <code>char</code> type, which has that exception in the strict aliasing rules. AFAIK, while the standard requires <code>sizeof(char)</code> to be <code>1</code>, it does not require <code>char</code> to be exactly eight bit, nor does it require <code>sizeof(uint8_t)</code> to be <code>1</code>. Consequently, I doubt that I have the license of the standard to assume that <code>uint8_t</code> is the same as <code>unsigned char</code>, and by consequence that the strict aliasing exception applies to <code>uint8_t</code>."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1470871879, "post_id": 38883310, "comment_id": 65130860, "body": "@chux Of course, I meant <code>uint32_t</code>, not <code>uint32</code>. Fixed it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1470872204, "post_id": 38883310, "comment_id": 65130933, "body": "<b>If <code>uint8_t</code> exist</b>, then <code>sizeof(uint8_t)</code> <i>must</i> be 1 and <code>unsigned char</code> is the same size/range as <code>uint8_t</code>.  Yet I think that assertion would engender a language lawyer session.  (BTW: answer still has <code>uint32 output;</code>)"}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470872297, "post_id": 38883310, "comment_id": 65130956, "body": "@JonathanLeffler The difference between the large lookup table and any bit-fiddling solution is, that the lookup table only requires a single operation, while the bit-fiddling takes quite a number of operations. Even thndrwrks&#39; beautiful solution (they&#39;ve got my upvote) requires 14 operations, which is slower than a cache hitting memory load. Considering the size of the lookup table, we see that it&#39;s 256 kiB, which does fit into caches without any problem. However, it does increase the load on the caches, so thndrwrks&#39; solution may indeed be faster."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1470872422, "post_id": 38883310, "comment_id": 65130995, "body": "@chux Ah, good to know, thanks. Also thanks for spotting that missed <code>uint32</code> :-)"}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470872934, "post_id": 38883310, "comment_id": 65131115, "body": "@JonathanLeffler On the PDP11, you would get the high order byte of the input in <code>inputBytes[0]</code>, but the result of the lookup would be stored in <code>outputBytes[0]</code> which corresponds to the two low order bytes of the output. The other way round for the low order input byte. In effect, the code would produce a correct big endian value in the <code>outputBytes</code> array, which would then be interpreted in PDP11 middle endian byte order."}, {"owner": {"reputation": 99643, "user_id": 445517, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/57e2ba76e6290c4e9e19821a068bc8c1?s=128&d=identicon&r=PG", "display_name": "CodesInChaos", "link": "https://stackoverflow.com/users/445517/codesinchaos"}, "edited": false, "score": 0, "creation_date": 1470898717, "post_id": 38883310, "comment_id": 65138750, "body": "I&#39;d prefer using bitshifts to combine <code>((uint32_t)a)&lt;&lt;16|b</code> and split (<code>(uint8_t)x</code> and <code>x &gt;&gt; 8</code>) the two halves instead of using memcopies."}, {"owner": {"reputation": 99643, "user_id": 445517, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/57e2ba76e6290c4e9e19821a068bc8c1?s=128&d=identicon&r=PG", "display_name": "CodesInChaos", "link": "https://stackoverflow.com/users/445517/codesinchaos"}, "edited": false, "score": 1, "creation_date": 1470899153, "post_id": 38883310, "comment_id": 65138975, "body": "The char vs <code>uint8_t</code> thing is tricky. Since <code>char</code> has at least 8 bits, and <code>uint8_t</code> exactly 8 (if it exists), its size must be 1. But that still doesn&#39;t make it a character type and thus still not exempt from the aliasing rules. I&#39;ve seen a <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=66110\" rel=\"nofollow noreferrer\">GCC bugtracker thread</a> where somebody proposed taking advantage of the rule that <code>uint8_t</code> must not alias other types."}], "tags": [], "owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1470872323, "last_edit_date": 1470872323, "creation_date": 1470862289, "answer_id": 38883310, "question_id": 38881877, "link": "https://stackoverflow.com/questions/38881877/bit-hack-expanding-bits/38883310#38883310", "title": "Bit hack: Expanding bits", "body": "<p>If your concern is performance and simplicity, you are likely best of with a big lookup table (64k entries of 4 bytes each). With that, you can pretty much use any algorithm you like to generate the table, lookup will just be a single memory access.</p>\n\n<p>If that table is too big for your liking, you can split it. For instance, you can use a 8 bit lookup table with 256 entries of 2 bytes each. With that you can perform the entire operation with just two lookups. Bonus is, that this approach allows for type-punning tricks to avoid the hassle of splitting the address with bit operations:</p>\n\n<pre><code>//Implementation defined behavior ahead:\n//Works correctly for both little and big endian machines,\n//however, results will be wrong on a PDP11...\nuint32_t getMask(uint16_t input) {\n    assert(sizeof(uint16_t) == 2);\n    assert(sizeof(uint32_t) == 4);\n    static const uint16_t lookupTable[256] = { 0x0000, 0x0003, 0x000c, 0x000f, ... };\n\n    unsigned char* inputBytes = (unsigned char*)&amp;input;    //legal because we type-pun to char, but the order of the bytes is implementation defined\n    char outputBytes[4];\n    uint16_t* outputShorts = (uint16_t*)outputBytes;    //legal because we type-pun from char, but the order of the shorts is implementation defined\n    outputShorts[0] = lookupTable[inputBytes[0]];\n    outputShorts[1] = lookupTable[inputBytes[1]];\n    uint32_t output;\n    memcpy(&amp;output, outputBytes, 4);    //can't type-pun directly from uint16 to uint32_t due to strict aliasing rules\n    return output;\n}\n</code></pre>\n\n<p>The code above works around strict aliasing rules by casting only to/from <code>char</code>, which is an explicit exception to the strict aliasing rules. It also works around the effects of little/big-endian byte order by building the result in the same order as the input was split. However, it still exposes implementation defined behavior: A machine with a byte order of <code>1, 0, 3, 2</code>, or other <a href=\"https://en.wikipedia.org/wiki/Endianness#Middle-endian\" rel=\"nofollow\">middle endian orders</a>, will silently produce wrong results (there have actually been such CPUs like the <a href=\"https://en.wikipedia.org/wiki/Endianness#Middle-endian\" rel=\"nofollow\">PDP11</a>...).</p>\n\n<p>Of course, you can split the lookup table even further, but I doubt that would do you any good.</p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1471581115, "post_id": 38883485, "comment_id": 65412385, "body": "making the <code>table</code> <code>static const</code> should improve performance."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1471583570, "post_id": 38883485, "comment_id": 65413005, "body": "@chqrlie Interesting suggestion. I tried it with clang, and it makes no difference. The compiler already puts the table in the <i>text</i> segment, even without the <code>static const</code>. It&#39;s able to do that because, (1) <code>table</code> has local scope (2) <code>table</code> is never used as an lvalue (3) there are no pointers in the function, so nothing can point to <code>table</code>."}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": false, "score": 6, "last_activity_date": 1470862977, "creation_date": 1470862977, "answer_id": 38883485, "question_id": 38881877, "link": "https://stackoverflow.com/questions/38881877/bit-hack-expanding-bits/38883485#38883485", "title": "Bit hack: Expanding bits", "body": "<p>The easiest way to map a 4-bit input to an 8-bit output is with a 16 entry table. So then it's just a matter of extracting 4 bits at a time from the <code>uint16_t</code>, doing a table lookup, and inserting the 8-bit value into the output.</p>\n\n<pre><code>uint32_t expandBits( uint16_t input )\n{\n    uint32_t table[16] = {\n        0x00, 0x03, 0x0c, 0x0f,\n        0x30, 0x33, 0x3c, 0x3f,\n        0xc0, 0xc3, 0xcc, 0xcf,\n        0xf0, 0xf3, 0xfc, 0xff\n    };\n\n    uint32_t output;\n    output  = table[(input &gt;&gt; 12) &amp; 0xf] &lt;&lt; 24;\n    output |= table[(input &gt;&gt;  8) &amp; 0xf] &lt;&lt; 16;\n    output |= table[(input &gt;&gt;  4) &amp; 0xf] &lt;&lt;  8;\n    output |= table[ input        &amp; 0xf];\n    return output;\n}\n</code></pre>\n\n<p>This provides a decent compromise between performance and readability. It doesn't have quite the performance of cmaster's over-the-top lookup solution, but it's certainly more understandable than thndrwrks' magical mystery solution. As such, it provides a technique that can be applied to a much larger variety of problems, i.e. use a small lookup table to solve a larger problem.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1471580909, "last_edit_date": 1471580909, "creation_date": 1470881708, "answer_id": 38886259, "question_id": 38881877, "link": "https://stackoverflow.com/questions/38881877/bit-hack-expanding-bits/38886259#38886259", "title": "Bit hack: Expanding bits", "body": "<p>In case you want to get some estimate of relative speeds, some community wiki test code.  Adjust as needed.</p>\n\n<pre><code>void f_cmp(uint32_t (*f1)(uint16_t x), uint32_t (*f2)(uint16_t x)) {\n  uint16_t x = 0;\n  do {\n    uint32_t y1 = (*f1)(x);\n    uint32_t y2 = (*f2)(x);\n    if (y1 != y2) {\n      printf(\"%4x %8lX %8lX\\n\", x, (unsigned long) y1, (unsigned long) y2);\n    }\n  } while (x++ != 0xFFFF);\n}\n\nvoid f_time(uint32_t (*f1)(uint16_t x)) {\n  f_cmp(expand_bits, f1);\n  clock_t t1 = clock();\n  volatile uint32_t y1 = 0;\n  unsigned n = 1000;\n  for (unsigned i = 0; i &lt; n; i++) {\n    uint16_t x = 0;\n    do {\n      y1 += (*f1)(x);\n    } while (x++ != 0xFFFF);\n  }\n  clock_t t2 = clock();\n  printf(\"%6llu %6llu: %.6f %lX\\n\", (unsigned long long) t1,\n          (unsigned long long) t2, 1.0 * (t2 - t1) / CLOCKS_PER_SEC / n,\n          (unsigned long) y1);\n  fflush(stdout);\n}\n\nint main(void) {\n  f_time(expand_bits);\n  f_time(expandBits);\n  f_time(remask);\n  f_time(javey);\n  f_time(thndrwrks_expand);\n  // now in the other order\n  f_time(thndrwrks_expand);\n  f_time(javey);\n  f_time(remask);\n  f_time(expandBits);\n  f_time(expand_bits);\n  return 0;\n}\n</code></pre>\n\n<p>Results</p>\n\n<pre><code>     0    280: 0.000280 FE0C0000 // fast\n   280    702: 0.000422 FE0C0000\n   702   1872: 0.001170 FE0C0000\n  1872   3026: 0.001154 FE0C0000\n  3026   4399: 0.001373 FE0C0000 // slow\n\n  4399   5740: 0.001341 FE0C0000\n  5740   6879: 0.001139 FE0C0000\n  6879   8034: 0.001155 FE0C0000\n  8034   8470: 0.000436 FE0C0000\n  8486   8751: 0.000265 FE0C0000\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6712630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b476c7c3a5de9409cbb33fdcebadd5e8?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Bitwise", "link": "https://stackoverflow.com/users/6712630/mr-bitwise"}, "is_accepted": false, "score": 0, "last_activity_date": 1471613867, "creation_date": 1471613867, "answer_id": 39040492, "question_id": 38881877, "link": "https://stackoverflow.com/questions/38881877/bit-hack-expanding-bits/39040492#39040492", "title": "Bit hack: Expanding bits", "body": "<p>My solution is meant to run on mainstream x86 PCs and be simple and generic. I did not write this to compete for the fastest and/or shortest implementation. It is just another way to solve the problem submitted by OP.</p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define BITS_TO_EXPAND (4U)\n#define SIZE_MAX (256U)\n\nstatic bool expand_uint(unsigned int *toexpand,unsigned int *expanded);\n\nint main(void)\n{\n    unsigned int in = 12;\n    unsigned int out = 0;\n    bool success;\n    char buff[SIZE_MAX];\n\n    success = expand_uint(&amp;in,&amp;out);\n    if(false == success)\n    {\n        (void) puts(\"Error: expand_uint failed\");\n        return EXIT_FAILURE;\n    }\n    (void) snprintf(buff, (size_t) SIZE_MAX,\"%u expanded is %u\\n\",in,out);\n    (void) fputs(buff,stdout);\n    return EXIT_SUCCESS;\n}\n/*\n** It expands an unsigned int so that every bit in a nibble is copied twice\n** in the resultant number. It returns true on success, false otherwise.\n*/\nstatic bool expand_uint(unsigned int *toexpand,unsigned int *expanded)\n{\n    unsigned int i;\n    unsigned int shifts = 0;\n    unsigned int mask;\n\n    if(NULL == toexpand || NULL == expanded)\n    {\n        return false;\n    }\n    *expanded = 0;\n    for(i = 0; i &lt; BIT_TO_EXPAND; i++)\n    {\n        mask = (*toexpand &gt;&gt; i) &amp; 1;\n        *expanded |= (mask &lt;&lt; shifts);\n        ++shifts;\n        *expanded |= (mask &lt;&lt; shifts);\n        ++shifts;\n    }\n    return true;\n}\n</code></pre>\n"}], "owner": {"reputation": 1484, "user_id": 3780573, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/81f2ae844e72da9de5163cd2593f000a?s=128&d=identicon&r=PG&f=1", "display_name": "thndrwrks", "link": "https://stackoverflow.com/users/3780573/thndrwrks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2359, "favorite_count": 3, "accepted_answer_id": 38883125, "answer_count": 8, "score": 12, "last_activity_date": 1471613867, "creation_date": 1470856939, "question_id": 38881877, "link": "https://stackoverflow.com/questions/38881877/bit-hack-expanding-bits", "title": "Bit hack: Expanding bits", "body": "<p>I am trying to convert a <code>uint16_t</code> input to a <code>uint32_t</code> bit mask. One bit in the input toggles two bits in the output bit mask. Here is an example converting a 4-bit input to an 8-bit bit mask:</p>\n\n<pre><code>Input    Output\nABCDb -&gt; AABB CCDDb\n\nA,B,C,D are individual bits\n\nExample outputs:\n\n0000b -&gt; 0000 0000b\n0001b -&gt; 0000 0011b\n0010b -&gt; 0000 1100b\n0011b -&gt; 0000 1111b\n....\n1100b -&gt; 1111 0000b\n1101b -&gt; 1111 0011b\n1110b -&gt; 1111 1100b\n1111b -&gt; 1111 1111b\n</code></pre>\n\n<p>Is there a bithack-y way to achieve this behavior?</p>\n"}, {"tags": ["c", "pointers", "compiler-errors", "undefined-behavior", "strange-attractor"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 1, "creation_date": 1470855993, "post_id": 38881622, "comment_id": 65124268, "body": "<code>&amp;a</code> - what do you believe this is, if not a pointer?"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 1, "creation_date": 1470856178, "post_id": 38881622, "comment_id": 65124393, "body": "<code>gcc 73.c -o 73.c</code> tells the compiler to output the executable with the same name as your source file.  You should use a different name for the executable, e.g. <code>gcc 73.c -o 73; .&#47;73</code>"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1470856423, "post_id": 38881622, "comment_id": 65124514, "body": "@aschepler good catch, I updated my answer with that info, if you don&#39;t mind."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470856656, "post_id": 38881622, "comment_id": 65124646, "body": "Spaces exist for a reason. Use them! Format this mess properly - and consistently. You might notice you understand your code much better and can see errors easier yourself."}, {"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 0, "creation_date": 1470857073, "post_id": 38881622, "comment_id": 65124867, "body": "You would also be getting some warnings that a,b, and c are uninitialized. You should explicitly set them to zero at the start of the program."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 1, "creation_date": 1470857216, "post_id": 38881622, "comment_id": 65124937, "body": "@hugomg well, treat warnings as errors comes in handy here, the fact about the uninitialized variables, will invoke <b>Undefined Behavior</b> in this code, I updated my answer!"}, {"owner": {"reputation": 271, "user_id": 6082977, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b868ddc05aacb6cc94e1a24b2be278f?s=128&d=identicon&r=PG&f=1", "display_name": "FlerrElectronics", "link": "https://stackoverflow.com/users/6082977/flerrelectronics"}, "edited": false, "score": 0, "creation_date": 1470857432, "post_id": 38881622, "comment_id": 65125052, "body": "It doesn&#39;t even compile on a Mac, are you sure this code is fine?"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 271, "user_id": 6082977, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b868ddc05aacb6cc94e1a24b2be278f?s=128&d=identicon&r=PG&f=1", "display_name": "FlerrElectronics", "link": "https://stackoverflow.com/users/6082977/flerrelectronics"}, "edited": false, "score": 0, "creation_date": 1470857527, "post_id": 38881622, "comment_id": 65125116, "body": "@FlerrElectronics that doesn&#39;t make sense. The code should compile and generate warnings. Except if you have enabled treating warnings as errors. In fact, my answer uses a Mac. :P"}, {"owner": {"reputation": 271, "user_id": 6082977, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b868ddc05aacb6cc94e1a24b2be278f?s=128&d=identicon&r=PG&f=1", "display_name": "FlerrElectronics", "link": "https://stackoverflow.com/users/6082977/flerrelectronics"}, "edited": false, "score": 0, "creation_date": 1470857554, "post_id": 38881622, "comment_id": 65125127, "body": "I used the same command as you did."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 271, "user_id": 6082977, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b868ddc05aacb6cc94e1a24b2be278f?s=128&d=identicon&r=PG&f=1", "display_name": "FlerrElectronics", "link": "https://stackoverflow.com/users/6082977/flerrelectronics"}, "edited": false, "score": 0, "creation_date": 1470858727, "post_id": 38881622, "comment_id": 65125730, "body": "Hey @FlerrElectronics, you didn&#39;t tag me, so I didn&#39;t see your comment. If you want, you can tell me what errors you get. :) BTW, Natalia Beneitez, I have answered your question, if you haven&#39;t see.. :)"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5404115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0284366f30475d6769358aeeda343535?s=128&d=identicon&r=PG&f=1", "display_name": "Natalia Beneitez", "link": "https://stackoverflow.com/users/5404115/natalia-beneitez"}, "edited": false, "score": 1, "creation_date": 1470892272, "post_id": 38881648, "comment_id": 65135860, "body": "I understand now, thank you! I thought the &amp; operator acted just like a reference for the variable or something like that. Went back and did what you told me and now it runs perfectly :) Also thanks for the -Wall flag tip, it was very useful"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 21, "user_id": 5404115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0284366f30475d6769358aeeda343535?s=128&d=identicon&r=PG&f=1", "display_name": "Natalia Beneitez", "link": "https://stackoverflow.com/users/5404115/natalia-beneitez"}, "edited": false, "score": 0, "creation_date": 1470931405, "post_id": 38881648, "comment_id": 65161249, "body": "@NataliaBeneitez you are welcome, glad it helped! You posted a nice first question, that&#39;s why I upvoted you (the score of your question is +1). Note that in StackOverflow, we <i>accept</i> the answer we found more useful. You received two answers, choose one and accept it, please. :)"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 4, "last_activity_date": 1470857473, "last_edit_date": 1495541687, "creation_date": 1470856006, "answer_id": 38881648, "question_id": 38881622, "link": "https://stackoverflow.com/questions/38881622/compilation-on-terminal-gives-off-pointer-warning-and-strange-symbols/38881648#38881648", "title": "Compilation on Terminal gives off pointer warning and strange symbols", "body": "<p>There are two major things that are wrong here:</p>\n\n<ol>\n<li>You try to print the address of variables <code>a</code>, <code>b</code> and <code>c</code>.</li>\n<li>You invoke <strong>Undefined Behavior</strong>, but not initializing your\ncounters to 0.</li>\n</ol>\n\n<hr>\n\n<p>You want to print the integers, so change this:</p>\n\n<pre><code>printf(\"%d %d %d\", &amp;a,&amp;b,&amp;c);\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>printf(\"%d %d %d\", a, b, c);\n</code></pre>\n\n<p>I also added some spaces, but that's just to beautify the code, to make it more readable, it won't affect the execution.</p>\n\n<p>You don't want to print the addresses! That's why you get the warning. Read more here: <a href=\"https://stackoverflow.com/questions/2702156/what-is-the-difference-between-the-and-the-operators-in-c-programming\">What is the difference between the * and the &amp; operators in c programming?</a></p>\n\n<hr>\n\n<p>As achelper, mentioned, you don't compile your program as you should (but that's not the problem of the code), but it's something you should get used to. I will demonstrate what I did to compile me program (I also like to use  <code>-Wall</code> flag, which enables all warnings):</p>\n\n<pre><code>C02QT2UBFVH6-lm:~ gsamaras$ nano main.c\nC02QT2UBFVH6-lm:~ gsamaras$ gcc main.c -Wall -o main\nmain.c:13:22: warning: format specifies type 'int' but the argument has type\n      'int *' [-Wformat]\n  printf(\"%d %d %d\", &amp;a,&amp;b,&amp;c);\n          ~~         ^~\nmain.c:13:25: warning: format specifies type 'int' but the argument has type\n      'int *' [-Wformat]\n  printf(\"%d %d %d\", &amp;a,&amp;b,&amp;c);\n             ~~         ^~\nmain.c:13:28: warning: format specifies type 'int' but the argument has type\n      'int *' [-Wformat]\n  printf(\"%d %d %d\", &amp;a,&amp;b,&amp;c);\n                ~~         ^~\nmain.c:11:16: warning: variable 'c' is uninitialized when used here\n      [-Wuninitialized]\n    if(n%3==2){c+=1;}\n               ^\nmain.c:5:16: note: initialize the variable 'c' to silence this warning\n  int n,i,a,b,c;\n               ^\n                = 0\nmain.c:10:16: warning: variable 'b' is uninitialized when used here\n      [-Wuninitialized]\n    if(n%3==1){b+=1;}\n               ^\nmain.c:5:14: note: initialize the variable 'b' to silence this warning\n  int n,i,a,b,c;\n             ^\n              = 0\nmain.c:9:16: warning: variable 'a' is uninitialized when used here\n      [-Wuninitialized]\n    if(n%3==0){a+=1;}\n               ^\nmain.c:5:12: note: initialize the variable 'a' to silence this warning\n  int n,i,a,b,c;\n           ^\n            = 0\n6 warnings generated.\nC02QT2UBFVH6-lm:~ gsamaras$ ./main\n2\n1\n2\n1461300256 1461300252 1461300248C02QT2UBFVH6-lm:~ gsamaras$ \n</code></pre>\n\n<hr>\n\n<p>In general, when in doubt, <em>treat warnings as errors</em>, so let's debug that code together, it will be fun. Pro-tip: Start from the first warning and resolve it. After that, the next warnings may be related, thus gone without having you really reading them!</p>\n\n<p>After applying my suggestion, all the warnings related with what you described in your question are gone. Only the uninitialized variable ones are left.</p>\n\n<p>That's easy, just initialize your variables to some initial value, like -1, if that makes sense of course.</p>\n\n<p><em>In your case</em> though, you use <code>a</code>, <code>b</code> and <code>c</code> as counters! So you <strong>must</strong> initialize them to 0, otherwise you are starting adding your values to garbage values, and that invokes <strong>Undefined Behavior</strong>!</p>\n\n<p>So do change this:</p>\n\n<pre><code>int n,i,a,b,c;\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>int n, i, a = 0, b = 0, c = 0;\n</code></pre>\n\n<p>Without the initialization of the counters, I am getting, <em>on my machine, now</em></p>\n\n<pre><code>C02QT2UBFVH6-lm:~ gsamaras$ ./main\n2\n1\n2\n1505029184 1 1C02QT2UBFVH6-lm:~ gsamaras$\n</code></pre>\n\n<p>You see that <code>printf()</code> gives me some garbage, while after initializing my counters to 0, I got:</p>\n\n<pre><code>C02QT2UBFVH6-lm:~ gsamaras$ ./main\n2\n1\n2\n0 1 1C02QT2UBFVH6-lm:~ gsamaras$ \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1470874435, "post_id": 38882379, "comment_id": 65131490, "body": "Thank you for reading my answer and providing more information! ;) +1, since you are a new user too!"}], "tags": [], "owner": {"reputation": 21, "user_id": 3588620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f5dc5832c9ef60f63170dff3d3798ea?s=128&d=identicon&r=PG&f=1", "display_name": "joshi.mohit86", "link": "https://stackoverflow.com/users/3588620/joshi-mohit86"}, "is_accepted": false, "score": 2, "last_activity_date": 1470858839, "creation_date": 1470858839, "answer_id": 38882379, "question_id": 38881622, "link": "https://stackoverflow.com/questions/38881622/compilation-on-terminal-gives-off-pointer-warning-and-strange-symbols/38882379#38882379", "title": "Compilation on Terminal gives off pointer warning and strange symbols", "body": "<p>The points mentioned by gsamaras are correct, you should use :</p>\n\n<pre><code> printf(\"%d %d %d\", a, b, c);\n</code></pre>\n\n<p>The syntax you were using is used in </p>\n\n<ul>\n<li><p>scanf (pass address of the variable where the data is need to be filled.)</p></li>\n<li><p>Also initialize variables while defining.</p></li>\n</ul>\n\n<p><strong>Regarding compilation:</strong>\nThe name -o specifies the output file generated after compilation thus it is overwriting your source code (i.e., 73.c).\nIf you omit -o, the default output file is generated as a.out. So for compiling you can use following and run the program as ./a.out:</p>\n\n<pre><code>gcc 73.c\n</code></pre>\n\n<p><strong>man gcc quotes</strong>:</p>\n\n<blockquote>\n  <p>-o file\n             Place output in file file.  This applies to whatever sort of output is being produced, whether it be an executable file, an object file, an assembler\n             file or preprocessed C code.</p>\n  \n  <p>If -o is not specified, the default is to put an executable file in a.out, the object file for source.suffix in source.o, its assembler file in source.s,\n             a precompiled header file in source.suffix.gch, and all preprocessed C source on standard output.</p>\n</blockquote>\n"}], "owner": {"reputation": 21, "user_id": 5404115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0284366f30475d6769358aeeda343535?s=128&d=identicon&r=PG&f=1", "display_name": "Natalia Beneitez", "link": "https://stackoverflow.com/users/5404115/natalia-beneitez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 38881648, "answer_count": 2, "score": 1, "last_activity_date": 1470931851, "creation_date": 1470855930, "last_edit_date": 1470931851, "question_id": 38881622, "link": "https://stackoverflow.com/questions/38881622/compilation-on-terminal-gives-off-pointer-warning-and-strange-symbols", "title": "Compilation on Terminal gives off pointer warning and strange symbols", "body": "<p>I am trying to compile and run a simple C program from my Terminal. This is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n//integers that are 3n, 3n + 1, and 3n + 2\n\nint main(){\n  int n,i,a,b,c;\n  scanf(\"%d\", &amp;n);\n  for (;n&gt;0;n--) {\n    scanf(\"%d\", &amp;i);\n    if(n%3==0){a+=1;}\n    if(n%3==1){b+=1;}\n    if(n%3==2){c+=1;}\n  }\n  printf(\"%d %d %d\", &amp;a,&amp;b,&amp;c);\n  return 0;\n}\n</code></pre>\n\n<p>After compiling it one time it generates this warning:</p>\n\n<pre><code>warning: format specifies type 'int' but the argument has type 'int *' [-Wformat]\n</code></pre>\n\n<p>I don't understand why it is generating that warning because I am not assigning any pointer variables. Why is it generating it? </p>\n\n<p>Also, after compiling it a couple of times more my c file is turning into symbols. I don't understand why this is happening. \nThe name of my file is 73.c and this is how I'm compiling it on Terminal: </p>\n\n<pre><code>gcc 73.c -o 73.c\n</code></pre>\n\n<p>After that my file in converted to something like this (lines and lines of this):</p>\n\n<pre><code>\u0153\u02d9\u00cc\u02db\ufffd\ufffd\ufffd\ufffd\u00c4\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u00d6\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdH\ufffd\ufffd\ufffd__PAGEZERO\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd(\ufffd\ufffd__TEXT\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd__text\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd__TEXT\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd0\ufffd\ufffd\ufffd\ufffd\ufffd\u02dd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd0\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u00c4\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd__stubs\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd__TEXT\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd.\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd.\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u00c4\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd__stub_helper\ufffd\ufffd\ufffd__TEXT\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd&lt;\ufffd\ufffd\ufffd\ufffd\ufffd$\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd&lt;\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u00c4\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd__cstring\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd__TEXT\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd`\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd`\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd__unwind_info\ufffd\ufffd\ufffd__TEXT\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdl\ufffd\ufffd\ufffd\ufffd\ufffdH\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdl\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd__eh_frame\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd__TEXT\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u220f\ufffd\ufffd\ufffd\ufffd\ufffd@\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u220f\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u00cb\ufffd\ufffd\ufffd__DATA\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd__nl_symbol_ptr\ufffd__DATA\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd__la_symbol_ptr\ufffd__DATA\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdH\ufffd\ufffd\ufffd__LINKEDIT\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd`\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\"\ufffd\ufffd\u00c40\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd  \ufffd\ufffd \ufffd\ufffd\ufffd@ \ufffd\ufffd0\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u220f \ufffd\ufffd\ufffd\ufffd\ufffd !\ufffd\ufffd@\ufffd\ufffd\ufffd\n</code></pre>\n\n<p>I really don't have any idea of what's going on. I've been at it for a long time now, I know it shouldn't be that hard but I really don't know what's wrong. Somebody have any idea of what might be happening?</p>\n"}, {"tags": ["c", "pointers", "memory-leaks"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 3, "creation_date": 1470855494, "post_id": 38881435, "comment_id": 65123994, "body": "<code>*(root)-&gt;data = 5;</code> --&gt;&gt; <code>(*root)-&gt;data = 5;</code> BTW: your code leaks the <code>*temp</code> memory on some code path. And: remove the casts, they can only do harm."}, {"owner": {"reputation": 734, "user_id": 5755464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-Vf68fbcrMOw/AAAAAAAAAAI/AAAAAAAABI0/nQuZ9pogv1s/photo.jpg?sz=128", "display_name": "Rudrani Angira", "link": "https://stackoverflow.com/users/5755464/rudrani-angira"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1470855716, "post_id": 38881435, "comment_id": 65124111, "body": "it worked!.Thanks @wildplasser. Can you please give a brief explanation about how the precedence differs in the two cases."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1470855852, "post_id": 38881435, "comment_id": 65124193, "body": "The others have already done that. <code>-&gt;</code> and <code>.</code> have the highest precedence (&quot;bind tighter&quot;); <code>*</code> is <i>weaker</i>. and <code>#include &lt;malloc.h&gt;</code> malloc.h is a non-standard header. You want <code>stdlib.h</code>"}, {"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "edited": false, "score": 1, "creation_date": 1470855897, "post_id": 38881435, "comment_id": 65124216, "body": "Use the proper header for <code>malloc</code>, which is <code>&lt;stdlib.h&gt;</code>."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1470856144, "post_id": 38881435, "comment_id": 65124367, "body": "I&#39;ve edited your question to refer to &quot;pointers to pointers&quot; rather than &quot;double pointers&quot;. A &quot;double pointer&quot; could be of type <code>double*</code>."}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 3, "last_activity_date": 1470855949, "last_edit_date": 1470855949, "creation_date": 1470855649, "answer_id": 38881533, "question_id": 38881435, "link": "https://stackoverflow.com/questions/38881435/pointers-to-pointers-error-in-referencing-members/38881533#38881533", "title": "Pointers to pointers : error in referencing members", "body": "<p><code>-&gt;</code> binds tighter than the dereferencing operator (<code>*</code>). See <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow\">operator precedence</a>. So, </p>\n\n<pre><code>*(root)-&gt;data = 5;\n</code></pre>\n\n<p>is equivalent to:</p>\n\n<pre><code>*(root-&gt;data) = 5;\n</code></pre>\n\n<p>What you intended to do was:</p>\n\n<pre><code>(*root)-&gt;data = 5;\n</code></pre>\n\n<p>Same for the next line, which should be:</p>\n\n<pre><code>(*root)-&gt;next = temp;\n</code></pre>\n\n<p>Also, note that <code>malloc.h</code> is not portable. You should include C standard header <code>stdlib.h&gt;</code> instead to get the prototype for <code>malloc()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 1, "last_activity_date": 1470855657, "creation_date": 1470855657, "answer_id": 38881539, "question_id": 38881435, "link": "https://stackoverflow.com/questions/38881435/pointers-to-pointers-error-in-referencing-members/38881539#38881539", "title": "Pointers to pointers : error in referencing members", "body": "<p>The <code>-&gt;</code> operator has a higher precedence than the dereferencing operator <code>*</code>. Refer <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow\">here</a> for the full list. \nSo the lines like </p>\n\n<pre><code>*(root)-&gt;data = 5;\n</code></pre>\n\n<p>will be illegal, as <em>first</em> it is trying to find a field <code>data</code> in something pointed by <code>root</code>, and obviously doesn't find it, as it is a pointer type as well.</p>\n\n<p>Instead you should use the explicit precedence:</p>\n\n<pre><code>(*root)-&gt;data = 5;\n</code></pre>\n"}], "owner": {"reputation": 734, "user_id": 5755464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-Vf68fbcrMOw/AAAAAAAAAAI/AAAAAAAABI0/nQuZ9pogv1s/photo.jpg?sz=128", "display_name": "Rudrani Angira", "link": "https://stackoverflow.com/users/5755464/rudrani-angira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 38881533, "answer_count": 2, "score": 1, "last_activity_date": 1470856114, "creation_date": 1470855350, "last_edit_date": 1470856114, "question_id": 38881435, "link": "https://stackoverflow.com/questions/38881435/pointers-to-pointers-error-in-referencing-members", "title": "Pointers to pointers : error in referencing members", "body": "<p>Below is a simple code where I am trying to use pointers to pointers to add a node to a linked list.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;malloc.h&gt;\n\nstruct node \n{\n        int data;\n        struct node *next;\n};\n\nvoid insert(struct node **root)\n{\n    struct node * temp = (struct node *)malloc(sizeof(struct node));\n    if(*root == NULL)\n    {\n       *(root) = (struct node *) malloc (sizeof(struct node ));\n       *(root)-&gt;data = 5;\n       *(root)-&gt;next = temp;\n    }\n    else\n        printf(\"here\");\n}\n\nint main()\n{\n  struct node *root = NULL;\n  insert(&amp;root);\n  return 0;\n}\n</code></pre>\n\n<p>My understanding is that in main() a block is getting allocated to <code>root</code>. And in <code>insert</code> the address of that memory block is passed in the argument. Then it checks if their is any memory block allocated to a structure at that address and if it is NULL memory is allocated to a structure block. And this should be referenced by <code>*root</code>.But when I execute the above code I get the following error:</p>\n\n<pre><code>error: request for member 'data' in something not a structure or union\n</code></pre>\n\n<p>I am not able to understand where i am going wrong exactly.</p>\n"}, {"tags": ["c++", "c", "pthreads", "posix", "ada"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 5, "creation_date": 1470854149, "post_id": 38881052, "comment_id": 65123246, "body": "Possibly because C and C++ are different languages? Identical syntax does not imply identical semantics."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 5, "creation_date": 1470854436, "post_id": 38881052, "comment_id": 65123403, "body": "You should not be treating pointers to functions as pointers to objects \u2014 they aren&#39;t guaranteed to be the same size, even in C (though they commonly are the same size).  C++ is fussier about such issues; you have to explicitly convert <code>void *</code> to the desired type, whereas C does that casually for you \u2014 one of the reasons C++ programmers are leery of C at times.  Succinctly, there&#39;s lots of C code that is not valid C++ code; your function is one example of such code."}, {"owner": {"reputation": 22472, "user_id": 40851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RwWVj.jpg?s=128&g=1", "display_name": "Simon Wright", "link": "https://stackoverflow.com/users/40851/simon-wright"}, "edited": false, "score": 0, "creation_date": 1470855903, "post_id": 38881052, "comment_id": 65124221, "body": "Your C function doesn\u2019t seem to add any value over just using <code>pthread_create()</code> directly. In fact, you lose the thread id <code>pthread_t</code>."}, {"owner": {"reputation": 105, "user_id": 5921147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de28daa68dc73d0cd8e8e0a2869403b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/5921147/nautilus"}, "reply_to_user": {"reputation": 22472, "user_id": 40851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RwWVj.jpg?s=128&g=1", "display_name": "Simon Wright", "link": "https://stackoverflow.com/users/40851/simon-wright"}, "edited": false, "score": 0, "creation_date": 1470858920, "post_id": 38881052, "comment_id": 65125822, "body": "@SimonWright Yes I know that.This rest of the function is not EXACTLY the same. This was more of for clarity purposes."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470865804, "post_id": 38881052, "comment_id": 65129100, "body": "Your compiler is actually obligated to issue a diagnostic message about this in C, provided you have the correct prototype for <code>pthread_create()</code> visible when you call it. There is no implicit conversion from <code>void*</code> to function-pointer type, this is a constraint violation."}, {"owner": {"reputation": 507, "user_id": 987209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe9053cd9e9543a6876166643da34679?s=128&d=identicon&r=PG", "display_name": "darkestkhan", "link": "https://stackoverflow.com/users/987209/darkestkhan"}, "edited": false, "score": 1, "creation_date": 1470996874, "post_id": 38881052, "comment_id": 65188032, "body": "Out of curiosity, what is the point of passing address to Ada function into pthread instead of using native Ada threading (tasking)?"}], "answers": [{"tags": [], "owner": {"reputation": 3239, "user_id": 5271927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aTJYf.jpg?s=128&g=1", "display_name": "KIIV", "link": "https://stackoverflow.com/users/5271927/kiiv"}, "is_accepted": true, "score": 10, "last_activity_date": 1470854777, "last_edit_date": 1470854777, "creation_date": 1470854288, "answer_id": 38881128, "question_id": 38881052, "link": "https://stackoverflow.com/questions/38881052/differences-between-pthread-in-c-vs-c/38881128#38881128", "title": "Differences between Pthread in C vs C++", "body": "<p>Implicit type conversions in C++ are much more strict than in C. The <code>void * function</code> parameter can't be used as function pointer in C++ or C...</p>\n\n<p>You need <code>void* (*function)(void*)</code> in your function prototype.</p>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 5921147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de28daa68dc73d0cd8e8e0a2869403b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/5921147/nautilus"}, "edited": false, "score": 0, "creation_date": 1470858743, "post_id": 38881497, "comment_id": 65125737, "body": "How would I create a thread that runs a function using the c++ standard thread library when all i have is the address ( pointer ) to the function that is passed in from Ada?"}], "tags": [], "owner": {"reputation": 6779, "user_id": 1691223, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/c2AsP.jpg?s=128&g=1", "display_name": "Shravan40", "link": "https://stackoverflow.com/users/1691223/shravan40"}, "is_accepted": false, "score": 1, "last_activity_date": 1470855513, "last_edit_date": 1495540856, "creation_date": 1470855513, "answer_id": 38881497, "question_id": 38881052, "link": "https://stackoverflow.com/questions/38881052/differences-between-pthread-in-c-vs-c/38881497#38881497", "title": "Differences between Pthread in C vs C++", "body": "<p>As mentioned by <a href=\"https://stackoverflow.com/users/5271927/kiiv\">KIIV</a> implicit type conversions in C++ are much more strict than in C.</p>\n\n<p><code>void* (*function) (void*)</code></p>\n\n<p>This is a pointer to a function which takes one <code>void*</code> argument and returns <code>void*</code>.</p>\n\n<p>To get rid of your errors in C++, change your function to return <code>void *</code>, and pass it without type-casting it. The return from the thread function can be a simple return <code>NULL</code> if you don't care about the value.</p>\n\n<p>There are various other issues with using this C library directly from C++; in particular, for portability, the thread entry function should be <code>extern \"C\"</code>. Good practice should be using the standard C++ thread library (or Boost's implementation, if you're stuck with a pre-2011 version of the language).</p>\n"}], "owner": {"reputation": 105, "user_id": 5921147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de28daa68dc73d0cd8e8e0a2869403b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/5921147/nautilus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1183, "favorite_count": 0, "accepted_answer_id": 38881128, "answer_count": 2, "score": 1, "last_activity_date": 1470855513, "creation_date": 1470853982, "question_id": 38881052, "link": "https://stackoverflow.com/questions/38881052/differences-between-pthread-in-c-vs-c", "title": "Differences between Pthread in C vs C++", "body": "<p>So I was able to pass an Ada function using Ada_function'Address to a C_function. Here is the C function: </p>\n\n<pre><code>void Create_Process(int * status, void * function) {\n    pthread_t new_thread;\n\n    //creating function with the given function and no arguments.\n    *status = pthread_create(&amp;new_thread, NULL, function, NULL);\n}\n</code></pre>\n\n<p>This worked perfectly fine. My problem is when I try to use this same function in C++. It fails at compiling with the error:</p>\n\n<pre><code>error: invalid conversion from \u2018void*\u2019 to \u2018void* (*)(void*)\u2019 [-fpermissive]\n*status = pthread_create(&amp;new_thread, NULL, function, NULL);\n</code></pre>\n\n<p>Is there any reason that this works / compiles in C but not C++?</p>\n"}, {"tags": ["c", "list", "parameters", "macros", "comma"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 2, "creation_date": 1470853683, "post_id": 38880909, "comment_id": 65122980, "body": "Note that if this is anything more than learning exercise, (ab)using preprosessor macros like this is probably a bad idea... That way madness lies."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1470853956, "post_id": 38880909, "comment_id": 65123139, "body": "C does not support <i>methods</i>. Don&#39;t get too fancy with macros. This sounds like a pretty bad idea. If you don&#39;t like the C syntax, use a different language or define your own language."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 2, "creation_date": 1470853961, "post_id": 38880909, "comment_id": 65123141, "body": "If you are planning on including the body as well as a variadic argument, how do you proposed separating parameters from the body? If that is not what you meant, I don&#39;t see why you cannot use a variadic macro. But assuming that to be the case, why can&#39;t you use parentheses? <code>MAKE_FUNCTION(int, foo, (int x, char const* s))</code>"}], "owner": {"reputation": 13, "user_id": 6701714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4505731b81a09b46ac3e794d616e728e?s=128&d=identicon&r=PG&f=1", "display_name": "mad_a_i", "link": "https://stackoverflow.com/users/6701714/mad-a-i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513436162, "creation_date": 1470853485, "last_edit_date": 1513436162, "question_id": 38880909, "link": "https://stackoverflow.com/questions/38880909/c-macro-generate-comma-separated-list", "title": "C Macro - Generate comma separated list", "body": "<p>My goal is to generate functions for c functions/methods via macros.\nEverything works so far except the parameters.</p>\n\n<p>My first attempt was to just use:</p>\n\n<pre><code>#define COMMA ,\n</code></pre>\n\n<p>and then use this in my macros, but it gets kinda tedious and messy in bigger cases.</p>\n\n<p>Is it possible to do something like this</p>\n\n<pre><code>#define MAKE_FUNCTION(RETURN_TYPE, NAME, PARAMETERS) \\\n RETURN_TYPE somePrefix ## NAME(PARAMETERS)\n</code></pre>\n\n<p>Very important is that I can't use variadic macros because the function body will also be defined via those later.</p>\n"}, {"tags": ["c", "sudoku"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 4, "creation_date": 1470853410, "post_id": 38880820, "comment_id": 65122830, "body": "<code>int a; &#47;*a not initilaized*&#47; while(a != 81) {</code> Undefined behavior."}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 2, "creation_date": 1470853670, "post_id": 38880820, "comment_id": 65122969, "body": "<i>But it is still hard to follow exactly what the program is doing</i> - I do understand the frustration of a beginner but a word of advice, try to write within your learning curve. Start small."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1470853689, "post_id": 38880820, "comment_id": 65122985, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a Minimal, Complete, and Verifiable example."}, {"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "edited": false, "score": 0, "creation_date": 1470853723, "post_id": 38880820, "comment_id": 65123001, "body": "Interesting fact, <a href=\"https://en.wikipedia.org/wiki/Mathematics_of_Sudoku\" rel=\"nofollow noreferrer\">the general solution to solve a sudoku puzzle is NP-Complete</a>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470853725, "post_id": 38880820, "comment_id": 65123005, "body": "This is no debugging service. &quot;But it is still hard to follow exactly what the program is doing&quot; - So you thought about off-loading this boring task to us?"}], "owner": {"reputation": 1, "user_id": 6701697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9abc99970a14ed434afd38e79ce4e7d4?s=128&d=identicon&r=PG&f=1", "display_name": "Headless Hank", "link": "https://stackoverflow.com/users/6701697/headless-hank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1472652457, "creation_date": 1470853211, "last_edit_date": 1472652457, "question_id": 38880820, "link": "https://stackoverflow.com/questions/38880820/problems-creating-my-own-sudoku-backtracking-alghoritm-c", "title": "Problems creating my own sudoku backtracking alghoritm (C)", "body": "<p>I'm trying to make my own sudoku backtracker with C. The program is looping in the Solving Function. It goes into the IsNotInVert and IsNotInHor and then goes back to the beginning of the while loop. (while a != 81) I'm a beginner in C and I guess I started with something way to hard. But anyway I hope on some help.</p>\n\n<p>I try to debug the program following the place in the array where we are now. But it is still hard to follow exactly what the program is doing, I really hope you guys can give me some hints and tips to point me to the right direction!</p>\n\n<p>Here the code;</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid print_sudoku(int a[9][9]) {\n   int i, j, h;\n   /* print the sudoku :D */\n   for (i = 0; i &lt; 9; i++) {\n      for (j = 0; j &lt; 9; j++) {\n         printf(\"%6i \", a[i][j]);\n   }\n     printf(\"|---|---|---|\");\n   printf(\"\\n\");\n}\nprintf(\"\\n\");\n}\n\n/* The solver, \nA counts till 81, 81 is the last number in the puzzle.\nIf there are no possibilities anymore failed will turn on.\nThis means we can hop over a static field back.\n\n*/\n\nvoid Solver (int puzzle[9][9], int staticField[9][9]) { \nint a;\nint row;\nint col;\nint numb;\nint failed;\n    while(a != 81) {\n    if (!IsStatic(row,col,staticField)) {\n        do {\n        numb++;\n        puzzle[row][col] = numb;\n        if (numb == 10) {\n            a--;\n            puzzle[row][col] = 0;\n            failed = 1;\n            if(col != 0){\n            col--;\n            }\n            else {\n                col = 8;\n                row--;\n            }\n        }\n        }while(!IsSafe(row,col,puzzle));\n            if (col == 9) {\n                col = 0;\n                if (row != 9) {\n                row++;\n                } \n            }\n        } else if (failed == 0) { a++; }\n        else { a--; Solver(puzzle, staticField);}\n    } \n    print_sudoku(puzzle);\n}\n\n/* If a Number is \"static\" we are not allowed to change it.\nWe compare our coordinates with the staticfield \"mask\" to determine if \nwe have a static number.\n\n*/\nint IsStatic (int a, int b, int staticField[9][9]) {    \n    if (staticField[a][b] == 1 ) {\n        return 1;\n        }\n    else return 0;\n}\n\n/* Function who looks if it is allowed to place a number\n*/\n\nint IsSafe (int a, int b, int field[9][9]) {\n    if (IsNotInVert(a, b, field)) {\n        if(IsNotInHor(a, b, field)) {\n            if(IsNotInBox(WhichBox(a,b),a,b,field)) {\n            return 1;\n            } else return 0;\n        } else return 0;\n    } else return 0;\n}\n\n\n/* \nFunction to check if the number we are testing is already in the 3 x 3 box\nthe if statements (a!=c &amp;&amp; b!=d) are to filter yourself out\nc= rownumber we want to check\nd= columnnumber we want to check\nbox = array with the numbers in the 3 x 3 box\n*/\n\nint IsNotInBox (int coord[1], int c, int d, int field[9][9]) {\n    int a = coord[0];\n    int b = coord[1];\n    int *box[8];\n\n    /* Fill box[] with the numbers in the 3 x 3 box */\n    if (a != c &amp;&amp; b != d) { box[0] = field[a][b]; }\na++;\n    if (a != c &amp;&amp; b != d) { box[1] = field[a][b]; }\na++;\n    if (a != c &amp;&amp; b != d) { box[2] = field[a][b]; }\na - 2;\nb++;\n    if (a != c &amp;&amp; b != d) { box[3] = field[a][b]; }\na++;\n    if (a != c &amp;&amp; b != d) { box[4] = field[a][b]; }\na++;\n    if (a != c &amp;&amp; b != d) { box[5] = field[a][b]; }\na - 2;\nb++;\n    if (a != c &amp;&amp; b != d) { box[6] = field[a][b]; } \na++;\n    if (a != c &amp;&amp; b != d) { box[7] = field[a][b]; }\na++;\n    if (a != c &amp;&amp; b != d) { box[8] = field[a][b]; }\n    int f;\n    for (f = 0; f &lt; 9; f++) {\n    if (box[f] == field[c][d]) { return 0; }\n    }\n    return 1;\n}\n\n\n/* \nTo calculate in which 3x3 box you are,\n\ngives back a array with the coordinates of the LEFTCORNER of \nthe 3x3 block (4,4 becomes 3,3 8,2 becomes 6,0)\n\n*/\n\nint WhichBox (int a, int b) {\n    while (a != 0 || a != 3 || a != 6) { // Make 0,3 or 6\n        a--;\n    }\n    while (b != 0 || b != 3 || b != 6) { // Make 0,3 or 6\n        b--;\n    }\n\n    int pos[1]; // creating and filling the array\n    pos[0] = a;\n    pos[1] = b;\n    return pos;\n}\n\n/*\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! NOT WORKING NOT IMPLEMENTED\nvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv\n\nint IsSolved (int a) {\n    if (IsNotInVert(8,  8)) {\n        if(IsNotInHor(8, 8)) {\n            if(IsNotInBox(WhichBox(8,8),8,8)) {\n            return 1;\n            } else return 0;\n        } else return 0;\n    } else return 0;\n} \n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! NOT WORKING NOT IMPLEMENTED\n*/\n/*\nA is row\nB is counter\nD is column\n~ Same as IsNotInHor\n*/\n\nint IsNotInVert (int a, int d, int field[9][9]) {\n\n    int b = 0; // set counter to zero\n    for ( b = 0; b &lt; 9; b++) { // For loop till 9\n        if (field[d][b] == field[d][a]) { // Check if number is same\n            if (a != b ) { // Check if not checking yourself\n            return 0;\n            }\n        }\n    } \n    return 1;\n}\n\n/*\nA = Column\nB = Counter\nD = Row\n*/\nint IsNotInHor (int a, int d, int field[8][8]) {\n\n    int b = 0; // set counter to zero\n    for ( b = 0; b &lt; 9; b++ ) { // For loop counting till 9 \n        if (field[b][a] == field[d][a]) { // Check if number already exist\n            if(b != d) { // Check if not checking yourself \n                return 0;\n            }\n        }\n    }\n        return 1;\n}\n\n/*\nMain\n\n*/\n\nint main (void) {\n    /* Field with the unsolved puzzle */\n    int field[9][9] = {\n/*       0  1  2  3  4  5  6  7  8              */\n/* 0 */ {0, 0, 7, 0, 0, 5, 0, 1, 0} ,\n/* 1 */ {0, 1, 2, 0, 0, 0, 3, 0, 9} ,\n/* 2 */ {6, 9, 0, 0, 0, 0, 0, 8, 0} ,\n/* 3 */ {0, 0, 0, 9, 0, 3, 0, 0, 7} ,\n/* 4 */ {0, 0, 0, 0, 1, 0, 0, 0, 0} ,\n/* 5 */ {4, 0, 0, 2, 0, 8, 0, 0, 0} ,\n/* 6 */ {0, 7, 0, 0, 0, 0, 0, 4, 1} ,\n/* 7 */ {5, 0, 1, 0, 0, 0, 8, 3, 0} ,\n/* 8 */ {0, 8, 0, 1, 0, 0, 6, 0, 0} \n    };\n\n    /* For IsStatic to see where static numbers are */\n        int staticField[9][9] = {\n/*       0  1  2  3  4  5  6  7  8              */\n/* 0 */ {0, 0, 1, 0, 0, 1, 0, 1, 0} ,\n/* 1 */ {0, 1, 1, 0, 0, 0, 1, 0, 1} ,\n/* 2 */ {1, 1, 0, 0, 0, 0, 0, 1, 0} ,\n/* 3 */ {0, 0, 0, 1, 0, 1, 0, 0, 1} ,\n/* 4 */ {0, 0, 0, 0, 1, 0, 0, 0, 0} ,\n/* 5 */ {1, 0, 0, 1, 0, 1, 0, 0, 0} ,\n/* 6 */ {0, 1, 0, 0, 0, 0, 0, 1, 1} ,\n/* 7 */ {1, 0, 1, 0, 0, 0, 1, 1, 0} ,\n/* 8 */ {0, 1, 0, 1, 0, 0, 1, 0, 0} \n    };\nprint_sudoku(field);\nSolver(field, staticField); \n\n} \n</code></pre>\n"}, {"tags": ["c", "struct", "c99", "arm9", "struct-member-alignment"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470850341, "post_id": 38879913, "comment_id": 65121042, "body": "It is unsafe. You can&#39;t assume <code>len2</code> is not padded."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1470850359, "post_id": 38879913, "comment_id": 65121054, "body": "Get a new job! 1) Homebrew fixed width types instead of using standard types. 2) not in a header, but the implementation 3) not <code>_static_assert</code>ed 4) Relying on implementation details/UB. 5) Wildly casting 6) Undefined behaviour."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1470850413, "post_id": 38879913, "comment_id": 65121079, "body": "@Olaf Expand on 6, please.."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1470850453, "post_id": 38879913, "comment_id": 65121104, "body": "<code>typedef char int8;</code> should be <code>typedef signed char int8;</code>"}, {"owner": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470850501, "post_id": 38879913, "comment_id": 65121139, "body": "@Olaf 1 and 2 are not really true. I just wanted to add a completely compilable code. But the definitions are in the header of the device SDK."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470850669, "post_id": 38879913, "comment_id": 65121236, "body": "The 2 might be obsolete. Still 1) seems to be true, otherwise you just had to use the standard names and include the standard header. Then get a different vendor. It is a bad sign they don&#39;t use standard types."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1470850798, "post_id": 38879913, "comment_id": 65121307, "body": "Frankly, I side with Olaf, you should get a new job.  Code like this is a good indication you will learn nothing useful there."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1470850846, "post_id": 38879913, "comment_id": 65121329, "body": "@chqrlie But you can contribute much and get some respect and recognition."}, {"owner": {"reputation": 3946, "user_id": 1703536, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d781a145ffbdecc059bfe29a3ce9fb1e?s=128&d=identicon&r=PG", "display_name": "Jeff Loughlin", "link": "https://stackoverflow.com/users/1703536/jeff-loughlin"}, "edited": false, "score": 4, "creation_date": 1470851213, "post_id": 38879913, "comment_id": 65121544, "body": "The C standard guarantees that the members of a struct will be stored in the order they are declared, but says nothing about the alignment.  The compiler is free to add any sort of padding it deems necessary between struct members to align them as needed.  If this code works at all, it is very fragile and will break if ever ported to a different architecture or even a different compiler."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470851333, "post_id": 38879913, "comment_id": 65121628, "body": "@EugeneSh.: if you are in a position to take charge, there is a lot you can do and indeed a lot to be done.  If you are just an low ranking developper in the company, you will suffer and waste your time debugging ugly code."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1470851448, "post_id": 38879913, "comment_id": 65121686, "body": "<code>memcpy ((void*)ptr, &amp;size, 2);</code> is invalid because <code>sizeof(size)</code> is 1."}, {"owner": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1470851557, "post_id": 38879913, "comment_id": 65121747, "body": "@Ian Abbott: It should be int16. I mistyped it when translating the code"}, {"owner": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "reply_to_user": {"reputation": 3946, "user_id": 1703536, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d781a145ffbdecc059bfe29a3ce9fb1e?s=128&d=identicon&r=PG", "display_name": "Jeff Loughlin", "link": "https://stackoverflow.com/users/1703536/jeff-loughlin"}, "edited": false, "score": 0, "creation_date": 1470852191, "post_id": 38879913, "comment_id": 65122124, "body": "@Jeff Loughlin: The code works in the device I&#39;m working (it is in production for a long time) and in my x86_64 computer. You can try it yourself."}, {"owner": {"reputation": 532, "user_id": 4520911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uzPkX.png?s=128&g=1", "display_name": "iRove", "link": "https://stackoverflow.com/users/4520911/irove"}, "edited": false, "score": 1, "creation_date": 1470852904, "post_id": 38879913, "comment_id": 65122541, "body": "@Gustavo It doesn&#39;t really matter if the code works on your computer, or Bob&#39;s computer.  In fact, it doesn&#39;t matter if it works on the majority of the computers, or every single computer in the universe.  If the standard says the compiler is allowed to add any sort of padding or alignment, then you shouldn&#39;t take the chance.  The fact that there <i>might</i> be the chance that a computer is created where this code does not work as expected  means it is unsafe code."}, {"owner": {"reputation": 3946, "user_id": 1703536, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d781a145ffbdecc059bfe29a3ce9fb1e?s=128&d=identicon&r=PG", "display_name": "Jeff Loughlin", "link": "https://stackoverflow.com/users/1703536/jeff-loughlin"}, "edited": false, "score": 0, "creation_date": 1470852985, "post_id": 38879913, "comment_id": 65122582, "body": "@Gustavo: Oh, I don&#39;t doubt that it works, it&#39;s just not guaranteed to <i>always</i> work.  You can pee on an electric fence and get away with it sometimes, but I don&#39;t recommend doing it too often.  When it goes wrong, it goes <i>badly</i> wrong."}, {"owner": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "reply_to_user": {"reputation": 532, "user_id": 4520911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uzPkX.png?s=128&g=1", "display_name": "iRove", "link": "https://stackoverflow.com/users/4520911/irove"}, "edited": false, "score": 0, "creation_date": 1470853053, "post_id": 38879913, "comment_id": 65122615, "body": "@iRove: I agree with you. I wouldn&#39;t do this kind of coding myself. But I can&#39;t change it either."}, {"owner": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "reply_to_user": {"reputation": 3946, "user_id": 1703536, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d781a145ffbdecc059bfe29a3ce9fb1e?s=128&d=identicon&r=PG", "display_name": "Jeff Loughlin", "link": "https://stackoverflow.com/users/1703536/jeff-loughlin"}, "edited": false, "score": 0, "creation_date": 1470853309, "post_id": 38879913, "comment_id": 65122773, "body": "@Jeff Loughlin: I completely understand. As I said, I wouldn&#39;t do it myself. But since everyone says it is not safe, is there anything I can do to make it safer? Maybe adding <code>__attribute__ ((__packed__))</code> to the struct?"}, {"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1470854309, "post_id": 38879913, "comment_id": 65123352, "body": "Is this by any chance some sort of network packet for some protocol? If it is, then the &quot;proper&quot; way is to pack the struct and manually insert padding so that it matches the layout of the packet."}, {"owner": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "reply_to_user": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1470854442, "post_id": 38879913, "comment_id": 65123407, "body": "@Mysticial: I could do that, but will it make it any safer? I mean, is there a way of knowing exactly where I should insert the paddings?"}, {"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1470854598, "post_id": 38879913, "comment_id": 65123494, "body": "Packing a struct is not specified by the standard, but every major compiler supports it with their own extension (otherwise, it&#39;d be difficult to implement network protocols). When you pack a struct, there is no padding at all. So if you need to do your own padding, just insert dummy fields."}, {"owner": {"reputation": 3946, "user_id": 1703536, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d781a145ffbdecc059bfe29a3ce9fb1e?s=128&d=identicon&r=PG", "display_name": "Jeff Loughlin", "link": "https://stackoverflow.com/users/1703536/jeff-loughlin"}, "edited": false, "score": 0, "creation_date": 1470855230, "post_id": 38879913, "comment_id": 65123835, "body": "Read this: <a href=\"http://www.catb.org/esr/structure-packing/\" rel=\"nofollow noreferrer\">catb.org/esr/structure-packing</a>  everything you ever wanted to know about structure packing"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 532, "user_id": 4520911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uzPkX.png?s=128&g=1", "display_name": "iRove", "link": "https://stackoverflow.com/users/4520911/irove"}, "edited": false, "score": 0, "creation_date": 1471032272, "post_id": 38879913, "comment_id": 65208287, "body": "@iRove: Any useful program for a free-standing implementation must rely upon behaviors not defined by the Standard, since the Standard doesn&#39;t define any means by which a free-standing program could have any behavior.  Nothing in the Standard specifies that pointers have to be two bytes long, but if an implementation&#39;s documentation says pointers are two bytes long a programmer should be entitled to rely upon that when targeting that implementation."}], "answers": [{"comments": [{"owner": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "edited": false, "score": 0, "creation_date": 1470854318, "post_id": 38880871, "comment_id": 65123358, "body": "The real code is not that simple. I simplified the example to get to the point, but I just don&#39;t have no means to do what you suggested. I could show a code similar to the real one, but there is no reason for it, really. The point is already addressed by the question. Anyways, thank you for the answer."}, {"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "reply_to_user": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "edited": false, "score": 1, "creation_date": 1470854467, "post_id": 38880871, "comment_id": 65123422, "body": "I can only judge by the code you posted and that&#39;s just messy."}, {"owner": {"reputation": 532, "user_id": 4520911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uzPkX.png?s=128&g=1", "display_name": "iRove", "link": "https://stackoverflow.com/users/4520911/irove"}, "reply_to_user": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "edited": false, "score": 0, "creation_date": 1470859364, "post_id": 38880871, "comment_id": 65126053, "body": "@Gustavo You don&#39;t want to show the code because <i>&quot;there is no reason for it,&quot;</i> but this code does not work for you.  Clearly it would be useful for us to know your <i>real constraints</i>.  Otherwise how do you suggest we provide an answer which fits your needs?  :-)"}, {"owner": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "reply_to_user": {"reputation": 532, "user_id": 4520911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uzPkX.png?s=128&g=1", "display_name": "iRove", "link": "https://stackoverflow.com/users/4520911/irove"}, "edited": false, "score": 0, "creation_date": 1470860028, "post_id": 38880871, "comment_id": 65126418, "body": "@iRove: There is no reason for it because the question is the same. I cannot post the company code here, as you are surely aware. It would take a lot of time for me to translate the code and it would not add meaning to the question. Anyways, I appreciate the effort to help me."}, {"owner": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "reply_to_user": {"reputation": 532, "user_id": 4520911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uzPkX.png?s=128&g=1", "display_name": "iRove", "link": "https://stackoverflow.com/users/4520911/irove"}, "edited": false, "score": 0, "creation_date": 1470860596, "post_id": 38880871, "comment_id": 65126698, "body": "@iRove: The code doesn&#39;t work for me simply because it references the name of the member variable. Maybe I should have pointed in the question that this is exactly what they didn&#39;t want when they implemented the code."}, {"owner": {"reputation": 532, "user_id": 4520911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uzPkX.png?s=128&g=1", "display_name": "iRove", "link": "https://stackoverflow.com/users/4520911/irove"}, "reply_to_user": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "edited": false, "score": 0, "creation_date": 1470860985, "post_id": 38880871, "comment_id": 65126895, "body": "@Gustavo Yes, knowing that would help.  I see where you are coming from.  Good luck!"}], "tags": [], "owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "is_accepted": false, "score": 3, "last_activity_date": 1470854085, "last_edit_date": 1495535319, "creation_date": 1470853356, "answer_id": 38880871, "question_id": 38879913, "link": "https://stackoverflow.com/questions/38879913/struct-alignment-safe-use/38880871#38880871", "title": "Struct alignment safe use", "body": "<p>You don't need to write code that works on every system. What you should do is write code that has predictable behavior. Either it works as designed or if your assumptions don't hold, a static assertion aborts the compilation.</p>\n\n<p>The second <code>memcpy</code> line fails to do that. It assumes that <code>offsetof(struct padded_t, len2) + 2 == offsetof(struct padded_t, array2)</code>. An assumption which will often hold, but is utterly stupid.</p>\n\n<p>Why not just write</p>\n\n<pre><code>foo.len2 = strlen(str);\nmemcpy (foo.array2, str, foo.len2);\n//possibly, foo.array2[foo.len2] = '\\0';\n</code></pre>\n\n<p>Code is readable. No unneeded variables. No unnecessary casts. No unpredictable behavior.\nThe original doesn't look like code you will learn a lot from, the clutter doesn't look like something I expect someone proficient in C to write.</p>\n\n<p>To answer a comment of yours, making them packed is the wrong fix. Because it will misalign members and will just open <a href=\"https://stackoverflow.com/questions/8568432/is-gccs-attribute-packed-pragma-pack-unsafe\">another can of worms</a>.</p>\n\n<p>Also keep wary of custom fixed-size typedefs. I once had the fun of debugging a <code>typedef char int8;</code> on a system that had <code>char</code>s <code>unsigned</code>\u2026</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1470854290, "last_edit_date": 1470854290, "creation_date": 1470853852, "answer_id": 38881013, "question_id": 38879913, "link": "https://stackoverflow.com/questions/38879913/struct-alignment-safe-use/38881013#38881013", "title": "Struct alignment safe use", "body": "<blockquote>\n  <p>But is this code safe?</p>\n  \n  <p>As I understand it, it will be safe as long as the <code>uint16 len</code> variables are immediately followed by <code>int8 array[]</code> variables regardless of the other struct members.</p>\n</blockquote>\n\n<p>It is not safe in the sense that compilers are allowed free rein to insert any amount of padding between or after structure members, so you cannot be confident that <code>&amp;ptr[2]</code> points to the first byte of <code>foo.array2</code>.  Provided that <code>uint16</code> is indeed two bytes wide, however, (which is in no way guaranteed by the language) you can be confident that if <code>size</code> is less than 25 then the</p>\n\n<pre><code>memcpy ((void*)&amp;ptr[2], (void*)str, size);\n</code></pre>\n\n<p>will modify neither any bytes of <code>foo.len2</code> nor the last byte of <code>foo.array2</code>.  Since <code>foo</code> was earlier filled with zeroes, this will leave <code>foo.array2</code> as a properly terminated C string.  It is thus safe to print it with <code>printf()</code>.  On the other hand, C does not guarantee that the result of doing so will be the same as the result of printing <code>str</code>.</p>\n\n<blockquote>\n  <p>Will it only add paddings before a uint16 when the size before it is odd?</p>\n</blockquote>\n\n<p>This is at the discretion of the compiler.  It might be influenced by pragmas, command-line options, configuration options, language extensions (though none of these are in use in the example), target architecture, or anything else that the compiler wants to use to make such decisions.</p>\n\n<blockquote>\n  <p>Is this use correct?</p>\n</blockquote>\n\n<p>As far as I can tell, the program is conforming, if that's what you mean.</p>\n\n<blockquote>\n  <p>And more importantly, is it safe?</p>\n</blockquote>\n\n<p>The program's output is not predictable from its code alone, so in that sense, no, it is not safe.</p>\n"}], "owner": {"reputation": 265, "user_id": 1840409, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xsHQF.jpg?s=128&g=1", "display_name": "learning_frog", "link": "https://stackoverflow.com/users/1840409/learning-frog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 1, "accepted_answer_id": 38881013, "answer_count": 2, "score": 5, "last_activity_date": 1470854290, "creation_date": 1470850083, "last_edit_date": 1470851591, "question_id": 38879913, "link": "https://stackoverflow.com/questions/38879913/struct-alignment-safe-use", "title": "Struct alignment safe use", "body": "<p>I'm new in a company where the following use of a struct is done:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\ntypedef unsigned char uint8;\ntypedef signed char int8;\ntypedef unsigned short int uint16;\ntypedef signed short int int16;\n\ntypedef struct padded_t {\n    int8 array0[11];\n    int8 array1[4];\n    uint16 len2;\n    int8 array2[25];\n    uint16 len3;\n    int8 array3[6];\n    // many more len/arrays follow\n} padded_t;\n\nint main(int argc, char** argv)\n{\n    padded_t foo;\n    memset((void*)&amp;foo, 0, sizeof(padded_t));\n\n    int8* str = \"foobar\";\n    int16 size = (int16)strlen(str);\n\n    int8* ptr = (int8*)&amp;foo.len2;\n\n    // please note that the memcpy references only the pointer to len\n    // are the following couple of lines safe?\n    memcpy ((void*)ptr, &amp;size, 2);\n    memcpy ((void*)&amp;ptr[2], (void*)str, size);\n\n    printf(\"%d\\n\", foo.len2);\n    printf(\"%s\\n\", foo.array2);\n\n    return 0;\n}\n</code></pre>\n\n<p>I know some things about alignment and padding, and I assume the compiler (gnu C99 for an ARM9 device) will add some paddings to make the struct aligned.</p>\n\n<p>But is this code safe?<br>\nAs I understand it, it will be safe as long as the <code>uint16 len</code> variables are immediately followed by <code>int8 array[]</code> variables regardless of the other struct members.</p>\n\n<p>Will it only add paddings before a uint16 when the size before it is odd?<br>\nIs this use correct? And more importantly, is it safe?</p>\n"}, {"tags": ["c", "windows", "assembly", "mingw", "shellcode"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1470846302, "post_id": 38878823, "comment_id": 65118846, "body": "So what do you think the processor will do once it has executed those <code>nop</code>s?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1470846383, "post_id": 38878823, "comment_id": 65118896, "body": "some RET opcode would be needed after those nops"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1470846575, "post_id": 38878823, "comment_id": 65118996, "body": "downvoted as trivial / uninteresting.  Lack of a <code>ret</code> at the end of a function is a common newbie error that is easy to solve when you single-step with a debugger.  You have to know asm to design shellcode, so you should work on it and debug it like any other asm function."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 3, "creation_date": 1470846726, "post_id": 38878823, "comment_id": 65119084, "body": "<i>It basically takes an array of characters</i>, no, <code>char *code[]</code> is an array of pointers to <code>char</code>, change to <code>char code[] = &quot;...&quot;;</code>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1470847778, "post_id": 38878823, "comment_id": 65119668, "body": "Also add the <code>const</code> to hopefully make the byte array part of an executable segment. This is not guaranteed to work."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1470848573, "post_id": 38878823, "comment_id": 65120079, "body": "&quot;It basically takes an array of characters and casts it as a function pointer.&quot; - Undefined behaviour. Read how modern OS execute code, how programs are structured and what measures are taken to exactly inhibit such things. <b>Before</b> you start messing with such things."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6362555, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d409c502ab54f00a0b0655b30fa8653c?s=128&d=identicon&r=PG&f=1", "display_name": "August ", "link": "https://stackoverflow.com/users/6362555/august"}, "edited": false, "score": 0, "creation_date": 1470848051, "post_id": 38879226, "comment_id": 65119815, "body": "I did in fact add the ret opcode, still no joy. I think your first idea is accurate though. In gdb it segfaults at the entry point to the function... which says something is up with that memory address... Should I use malloc to store the character array? Does malloc reserve memory on the stack?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 35, "user_id": 6362555, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d409c502ab54f00a0b0655b30fa8653c?s=128&d=identicon&r=PG&f=1", "display_name": "August ", "link": "https://stackoverflow.com/users/6362555/august"}, "edited": false, "score": 0, "creation_date": 1470848324, "post_id": 38879226, "comment_id": 65119961, "body": "@August, <i>Does malloc reserve memory on the stack?</i> No, you mean <a href=\"http://man7.org/linux/man-pages/man3/alloca.3.html\" rel=\"nofollow noreferrer\">alloca</a>, but I doubt that it solves it."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 35, "user_id": 6362555, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d409c502ab54f00a0b0655b30fa8653c?s=128&d=identicon&r=PG&f=1", "display_name": "August ", "link": "https://stackoverflow.com/users/6362555/august"}, "edited": false, "score": 0, "creation_date": 1470848633, "post_id": 38879226, "comment_id": 65120110, "body": "@August: <code>malloc</code> allocates memory from the heap, not from the stack.  I updated the answer with <code>code</code> allocated on the stack."}, {"owner": {"reputation": 5746, "user_id": 583570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17472ad659a41e48c4574e01d2312807?s=128&d=identicon&r=PG", "display_name": "markgz", "link": "https://stackoverflow.com/users/583570/markgz"}, "edited": false, "score": 1, "creation_date": 1470849244, "post_id": 38879226, "comment_id": 65120481, "body": "Memory used for the stack is unlikely to have execute permission."}, {"owner": {"reputation": 35, "user_id": 6362555, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d409c502ab54f00a0b0655b30fa8653c?s=128&d=identicon&r=PG&f=1", "display_name": "August ", "link": "https://stackoverflow.com/users/6362555/august"}, "edited": false, "score": 0, "creation_date": 1470850131, "post_id": 38879226, "comment_id": 65120928, "body": "unsigned char const code[] = &quot;&quot;; Works by adding the const. Solved."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 35, "user_id": 6362555, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d409c502ab54f00a0b0655b30fa8653c?s=128&d=identicon&r=PG&f=1", "display_name": "August ", "link": "https://stackoverflow.com/users/6362555/august"}, "edited": false, "score": 0, "creation_date": 1470855692, "post_id": 38879226, "comment_id": 65124089, "body": "@August: that works because the stack is mapped as non-executable, but data and read-only data are mapped with execute permission.  A <code>const char[]</code> will use a constant in read-only memory, but a non-const <code>char[]</code> local variable will copy the string to the stack.  If you used a global non-const <code>char[]</code>, it would still be executable.  Doing stuff like this requires knowing your target platform, or a lot of confusing trial and error."}, {"owner": {"reputation": 35, "user_id": 6362555, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d409c502ab54f00a0b0655b30fa8653c?s=128&d=identicon&r=PG&f=1", "display_name": "August ", "link": "https://stackoverflow.com/users/6362555/august"}, "edited": false, "score": 0, "creation_date": 1470933416, "post_id": 38879226, "comment_id": 65162383, "body": "Actually, update, I put the unsigned char code[]= statement within the main function and it works now."}, {"owner": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 0, "creation_date": 1471122179, "post_id": 38879226, "comment_id": 65229910, "body": "Also, you can have strings stored in the read-only section by initializing as <code>char *str = &quot;some string&quot;; </code> instead of <code>char str[] = &quot;some string&quot;;</code>. I don&#39;t know if that would accomplish the same thing for your purposes as adding <code>const</code>, but it&#39;s just something to note."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1470848566, "last_edit_date": 1470848566, "creation_date": 1470847571, "answer_id": 38879226, "question_id": 38878823, "link": "https://stackoverflow.com/questions/38878823/shellcode-testing-gone-wrong/38879226#38879226", "title": "Shellcode testing gone wrong", "body": "<p>Your <em>shell code</em> contains nops, a <code>0x00</code> opcode and no further known contents. I can see 2 reasons for this to fail:</p>\n\n<ul>\n<li>The operating system might not let you run code from the segment into which string literals are stored.</li>\n<li>The sequence of operations does not end with a <code>RET</code> opcode, so you end up running some random unknown opcodes...</li>\n</ul>\n\n<p>Try changing <code>code</code> to <code>unsigned char const code[] = \"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\xC3\";</code></p>\n\n<p>Alternately, you can try and define <code>code</code> locally in the <code>main()</code> function:</p>\n\n<pre><code>int main(void) {\n    unsigned char code[] = \"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\xC3\";\n\n    printf(\"Code at %p, length = %i\\n\", (void*)code, (int)sizeof(code)-1);\n    int (*ret)() = (int(*)())code;\n    ret();\n}\n</code></pre>\n\n<p>Neither approach is guaranteed to work, because the location where the compiler stores the <code>code</code> array may not be executable.</p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 6362555, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d409c502ab54f00a0b0655b30fa8653c?s=128&d=identicon&r=PG&f=1", "display_name": "August ", "link": "https://stackoverflow.com/users/6362555/august"}, "is_accepted": true, "score": 0, "last_activity_date": 1470989036, "creation_date": 1470989036, "answer_id": 38912935, "question_id": 38878823, "link": "https://stackoverflow.com/questions/38878823/shellcode-testing-gone-wrong/38912935#38912935", "title": "Shellcode testing gone wrong", "body": "<p>I figured it out. DEP (Data Execution Prevention) for my Windows XP SP3 VM was actually on after all.</p>\n\n<p>To shut it off on Windows XP follow <a href=\"https://www.zensoftware.co.uk/kb/Knowledgebase/Disabling-Windows-DEP-Data-Execution-Prevention\" rel=\"nofollow\">these</a> steps.</p>\n\n<p>For Windows Vista - Windows 10 download and install the <a href=\"https://support.microsoft.com/en-us/kb/2458544\" rel=\"nofollow\">Enhanced Mitigation Experience Toolkit</a>, run it, and specify which security settings you want.</p>\n"}], "owner": {"reputation": 35, "user_id": 6362555, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d409c502ab54f00a0b0655b30fa8653c?s=128&d=identicon&r=PG&f=1", "display_name": "August ", "link": "https://stackoverflow.com/users/6362555/august"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 38912935, "answer_count": 2, "score": 0, "last_activity_date": 1470989036, "creation_date": 1470846152, "last_edit_date": 1470847734, "question_id": 38878823, "link": "https://stackoverflow.com/questions/38878823/shellcode-testing-gone-wrong", "title": "Shellcode testing gone wrong", "body": "<p>Hey I'm using a bit of code most of you are familiar with. It basically takes an array of characters and casts it as a function pointer. With this code you can theoretically test any shellcode's functionality with it, and it would be a very valuable program for my work, if it would behave... I'm doing this on Windows XP SP3, and am using MinGW's gcc to compile and gdb to debug the damn thing.</p>\n\n<p>Here's what I've got...</p>\n\n<pre><code>unsigned char code[] =\n\"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\";\nmain()\n{\n  printf(\"Code length = %i...\\n\",sizeof(code)-1);\n  int (*ret)()=(int(*)())code;\n  ret();\n}\n</code></pre>\n\n<p>So I decided to use nops as the \"shellcode\" because it's easy on the eye and brain and would probably work no matter what. Unfortunately it doesn't.</p>\n\n<p>When I compile and run the program I get...</p>\n\n<pre><code>An unhandled win32 exception occurred in horsefile.exe[3612].\n</code></pre>\n\n<p>...and when I run it in gdb I get...</p>\n\n<pre><code>Program received signal SIGSEV, Segmentation fault.\n0x00409000 in code()\n</code></pre>\n\n<p>...where 0x00409000 is the entry point address of the shellcode function ret().</p>\n\n<p>I've turned off DEP, as I thought casting the character array, which I thought was on the stack (probably in .data section in reality), and that there was no executing code on the stack (the casting treating the character array data as code on the stack). So I turned DEP off and it's still misbehaving.</p>\n\n<p>Any thoughts? Remember, I'm using the MinGW compiler/debugger suite for Windows on Windows XP SP3.</p>\n\n<p>EDIT - <code>unsigned char code[]</code> instead of <code>char *code[]</code> ... still doesn't work...\nEDIT - Added the <code>ret (\\xc3)</code> at the end of the \"shellcode\", still no joy...</p>\n"}, {"tags": ["c", "fortify", "strncmp"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1470844483, "post_id": 38878195, "comment_id": 65117686, "body": "Fortify is wrong. At least for a proper, that is Standard conforming implementation of <code>strncmp()</code>."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1470844565, "post_id": 38878195, "comment_id": 65117743, "body": "Unless I am <i>very</i> much mistaken, <code>strncmp()</code> will only need to compare a single <code>char</code> from each of the strings in your example. I second the false positive."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470845772, "post_id": 38878195, "comment_id": 65118502, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. That would include the parametrisation of Fortify. Or ask HP why it generates a false positive with the required information."}, {"owner": {"reputation": 2989, "user_id": 2591612, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/wgKU1.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2591612/brian"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 5, "creation_date": 1470845815, "post_id": 38878195, "comment_id": 65118527, "body": "@Olaf: I met those requirements. Thanks"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1470846173, "post_id": 38878195, "comment_id": 65118775, "body": "Note that <code>&quot;test string&quot;</code> is not a <i>string</i> but a <i>string literal</i>.  A <i>string literal</i> may have multiple null characters.  A <i>string</i> has only one.  IAC, this <i>string literal</i> certainly has at least one null character and does not pose any problem here."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1470847349, "post_id": 38878195, "comment_id": 65119438, "body": "Are you sure Fortify is not complaining about the code you did not post?"}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1470847483, "post_id": 38878195, "comment_id": 65119521, "body": "Valgrind also often complains about out-of-bounds reads in strncmp, strlen, and other strxxx methods."}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 3, "creation_date": 1470854115, "post_id": 38878195, "comment_id": 65123223, "body": "String function implementations may be performance optimized to process data in naturally aligned chunks of 4 or 8 bytes. The alignment guarantees that no extraneous memory exceptions will be triggered (every access is completely within one page) and is thus &quot;safe&quot;, but this implementation technique can draw complaints from tools that check for access out of bounds, i.e. beyond the limits of a particular data object. My take is that such optimizations are allowed under the as-if rule, and thus compliant with the C standard."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "reply_to_user": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 0, "creation_date": 1470855552, "post_id": 38878195, "comment_id": 65124026, "body": "@njuffa You might want to turn your comment into an answer. I had similar problems with <code>strcmp</code>, which were caused exactly by the problem you mentioned."}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "reply_to_user": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1470859061, "post_id": 38878195, "comment_id": 65125887, "body": "@anatolyg Thanks for the endorsement, I have provided a full answer as you suggested"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 10, "last_activity_date": 1470854591, "last_edit_date": 1470854591, "creation_date": 1470844456, "answer_id": 38878259, "question_id": 38878195, "link": "https://stackoverflow.com/questions/38878195/does-this-usage-of-strncmp-contain-an-out-of-bounds-read/38878259#38878259", "title": "Does this usage of strncmp contain an out of bounds read?", "body": "<p><strong>TL;DR</strong> - <code>strncmp()</code> will keep comparing the <em>string</em> elements, until either the end of either string or 32 elements (<em>characters</em>), whichever is <em>fewer</em>.</p>\n\n<p>A(<em>ny</em>) <em>string</em> is always null-terminated and upon encountering null-terminator, no further comparison is performed. Your code is safe.</p>\n\n<p>Quoting <code>C11</code>, chapter \u00a77.24.4.4 (<em>emphasis mine</em>)</p>\n\n<blockquote>\n<pre><code>int strncmp(const char *s1, const char *s2, size_t n);\n</code></pre>\n  \n  <p>The <code>strncmp</code> function compares <strong>not more than <code>n</code> characters (characters that follow a\n  null character are not compared)</strong> from the array pointed to by <code>s1</code> to the array pointed to\n  by <code>s2</code>.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1470874802, "post_id": 38878264, "comment_id": 65131575, "body": "Generating what bad object code? For what? A function call? to a standard library function? This is a source code analysis. Nothing to do with the compiler or object code whatsoever."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 6, "last_activity_date": 1470846222, "last_edit_date": 1470846222, "creation_date": 1470844470, "answer_id": 38878264, "question_id": 38878195, "link": "https://stackoverflow.com/questions/38878195/does-this-usage-of-strncmp-contain-an-out-of-bounds-read/38878264#38878264", "title": "Does this usage of strncmp contain an out of bounds read?", "body": "<p>You have perfectly valid code.</p>\n\n<p>Either your compiler is generating bad object code or fortify is reporting a false positive.</p>\n\n<p>I doubt it is the compiler generating bad code. That will create too many problems and will be detected and fixed in no time.</p>\n\n<p>It is most likely that fortify is reporting a false positive.</p>\n"}, {"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1470864842, "post_id": 38882429, "comment_id": 65128702, "body": "It&#39;s too bad that &quot;modern&quot; compiler writers show little interest in allowing programmers to use such techniques to perform tasks not built into the Standard Library.  Sometimes a compiler may be able to find equivalent or better optimizations when given code that simply processes items sequentially, but in many cases compilers don&#39;t find such optimizations.  Unfortunately, they may find UB-based &quot;optimizations&quot; that may randomly break user code that uses such techniques."}], "tags": [], "owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "is_accepted": false, "score": 13, "last_activity_date": 1470859465, "last_edit_date": 1470859465, "creation_date": 1470859014, "answer_id": 38882429, "question_id": 38878195, "link": "https://stackoverflow.com/questions/38878195/does-this-usage-of-strncmp-contain-an-out-of-bounds-read/38882429#38882429", "title": "Does this usage of strncmp contain an out of bounds read?", "body": "<p>For performance reasons, implementations of the standard string functions will often process the data in naturally aligned register-width chunks. This can cause read access past the end of the source data objects, but the alignment guarantees that the code behaves exactly like a naive implementation with respect to memory exceptions. Each wide access is contained within a single page, and no pages are touched that would not also be touched by a byte-wise implementation. </p>\n\n<p>I would claim that such implementations are covered by C's as-if rule, that is, they behave the same \"as if\" they were following the abstract functional specifications.</p>\n\n<p>An example of such an optimized implementation would be <a href=\"https://github.com/illumos/illumos-gate/blob/master/usr/src/lib/libc/sparc/gen/strcmp.s\">OpenSolaris's <code>strcmp()</code> for SPARC v8</a>. This is code I wrote some fifteen years ago, along with other performance-optimized string functions.</p>\n\n<p>Various memory checker tools will complain about such code, however, because its use can lead to access beyond the limits of the allocated data object, even though the out-of-bounds read access is harmless by design.</p>\n"}], "owner": {"reputation": 2989, "user_id": 2591612, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/wgKU1.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2591612/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1100, "favorite_count": 0, "accepted_answer_id": 38878259, "answer_count": 3, "score": 13, "last_activity_date": 1470874399, "creation_date": 1470844290, "last_edit_date": 1470874399, "question_id": 38878195, "link": "https://stackoverflow.com/questions/38878195/does-this-usage-of-strncmp-contain-an-out-of-bounds-read", "title": "Does this usage of strncmp contain an out of bounds read?", "body": "<p>Fortify indicates that this is an out of bounds read:</p>\n\n<pre><code>if (strncmp(\"test string\", \"less than 32 char\", 32) == 0)\n{\n...\n}\n</code></pre>\n\n<p>It says that the function reads data from outside the bounds of <code>less than 32 char</code>. </p>\n\n<p>Is there really a finding if <code>strncmp</code> goes beyond 32 chars and the second string is less than 32 chars?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1470844120, "post_id": 38877960, "comment_id": 65117464, "body": "In C a &quot;string&quot; is an array of <code>char</code>s, with at least one element being equal to <code>0</code>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1470847892, "post_id": 38877960, "comment_id": 65119727, "body": "It prints the size 8 because that is the size of a <code>char *</code> pointer value on your system. Also, the format specifier <code>%d</code> expects an argument of type <code>int</code>, but your argument <code>sizeof(s)</code> has type <code>size_t</code>. You can fix that by casting the argument to the expected type: <code>(int)sizeof(s)</code>."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1470852032, "post_id": 38877960, "comment_id": 65122036, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1975128/sizeof-an-array-in-the-c-programming-language\">Sizeof an array in the C programming language</a>"}], "answers": [{"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1470844907, "post_id": 38878268, "comment_id": 65117953, "body": "<code>strlen()</code> gives you the length of the string, which  (hopefully ;-)) is different from the size of the array it might be held by."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1470845001, "post_id": 38878268, "comment_id": 65118017, "body": "<code>char* p; *p = ...</code> this invokes undefined behaviour, as <code>p</code> is pointing &quot;no where&quot; and is being de-referenced."}], "tags": [], "owner": {"reputation": 698, "user_id": 6697083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zwg0f.png?s=128&g=1", "display_name": "Riley", "link": "https://stackoverflow.com/users/6697083/riley"}, "is_accepted": false, "score": 2, "last_activity_date": 1470847159, "last_edit_date": 1470847159, "creation_date": 1470844491, "answer_id": 38878268, "question_id": 38877960, "link": "https://stackoverflow.com/questions/38877960/character-array-in-function-argument-as-a-pointer-or-array/38878268#38878268", "title": "Character array in function argument as a pointer or array?", "body": "<blockquote>\n  <p>assigning char pointer p as s will not reference its address rather\n  its value  </p>\n</blockquote>\n\n<p>When you assign s to p you are actually assigning the address.<br>\nIf you wanted to assign just the value, then you would need to do something like this:</p>\n\n<pre><code>char p; //create a char called p\np = *s; //value at p = value at s\n</code></pre>\n\n<p>But then you can't scan through the array in your while loop using p.</p>\n\n<hr>\n\n<blockquote>\n  <p>why it prints the whole array</p>\n</blockquote>\n\n<p>%s means keep printing until you see a null character. So because p points to the first address of your string it prints the whole thing.</p>\n\n<hr>\n\n<blockquote>\n  <p>its size is only 8  </p>\n</blockquote>\n\n<p>sizeof(s) means what is the size of the variable s. You defined s as a char pointer, so it returns the size or a char pointer (8). The function you want is:</p>\n\n<pre><code>strlen(s);  \n</code></pre>\n\n<hr>\n\n<p><strong>EDIT:</strong>\nFixed the first example to remove undefined behavior. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4675742, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1NgS7YEQlVs/AAAAAAAAAAI/AAAAAAAAADg/ZWhzJB1IK6U/photo.jpg?sz=128", "display_name": "Kumari puja", "link": "https://stackoverflow.com/users/4675742/kumari-puja"}, "is_accepted": false, "score": 0, "last_activity_date": 1470850894, "creation_date": 1470850894, "answer_id": 38880149, "question_id": 38877960, "link": "https://stackoverflow.com/questions/38877960/character-array-in-function-argument-as-a-pointer-or-array/38880149#38880149", "title": "Character array in function argument as a pointer or array?", "body": "<p>%s takes a memory address and prints the characters till it finds a null character.</p>\n\n<p>When u initiallize a pointer at the time of declaration as in this case \"char *p = s;\" , the address of s is assigned to p and not the value.</p>\n\n<ol>\n<li><p>char *p;\n p=s; </p></li>\n<li><p>char *p=s;</p></li>\n</ol>\n\n<p>Both are same things.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6701010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba1acedaf4a7b298c9f7e038b91ce02?s=128&d=identicon&r=PG&f=1", "display_name": "anshika24", "link": "https://stackoverflow.com/users/6701010/anshika24"}, "edited": false, "score": 0, "creation_date": 1471028386, "post_id": 38880541, "comment_id": 65206421, "body": "Thank you.This description is really helpful."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1470852220, "creation_date": 1470852220, "answer_id": 38880541, "question_id": 38877960, "link": "https://stackoverflow.com/questions/38877960/character-array-in-function-argument-as-a-pointer-or-array/38880541#38880541", "title": "Character array in function argument as a pointer or array?", "body": "<p>Under most circumstances, an <em>expression</em> of type \"N-element array of <code>T</code>\" will be converted (\"decay\") to an expression of type \"pointer to <code>T</code>\", and the value of the expression will be the address of the first element of the array.</p>\n\n<p>The exceptions to this rule are:</p>\n\n<ul>\n<li>when the array expression is the operand of the <code>sizeof</code> or unary <code>&amp;</code> operators;</li>\n<li>when the array expression is a string literal used to initialize another array in a declaration (thus, the <code>\"welcome back \"</code> string literal used to initialize <code>c</code> is <em>not</em> converted to a pointer expression; instead, the contents of the string literal are copied to <code>c</code>).  </li>\n</ul>\n\n<p>When you call</p>\n\n<pre><code>len=strlen1(c);\n</code></pre>\n\n<p>the <em>expression</em> <code>c</code> is converted from type \"14-element array of <code>char</code>\" to \"pointer to <code>char</code>\", and this pointer expression is what actually gets passed to <code>strlen1</code>.  </p>\n\n<p>In the context of a function parameter declaration, <code>T a[N]</code> and <code>T a[]</code> are treated the same as <code>T *a</code>; <code>a</code> is declared as a pointer to <code>T</code>, not an array of <code>T</code>.  This makes sense, since a function <em>cannot</em> receive an array expression as a parameter; it will have been converted to a pointer before being passed to the function.  </p>\n\n<blockquote>\n  <p>then why it prints the whole array</p>\n</blockquote>\n\n<p>That's how the <code>%s</code> conversion specifier works; it tells <code>printf</code> to start printing the sequence of characters beginning at the address specified by <code>s</code> until it sees a 0-valued byte.  </p>\n\n<blockquote>\n  <p>its size is only 8</p>\n</blockquote>\n\n<p>The type of the <em>expression</em> <code>s</code> is <code>char *</code>, so <code>sizeof s</code> is equivalent to <code>sizeof (char *)</code> (that is, the size of a pointer to <code>char</code>), so what you're displaying is the number of bytes required to store a <em>pointer</em> value, not the size of the string that <code>s</code> is pointing to.  </p>\n\n<p>Here's a memory map of how things play out on my platform, which may help understand some of these concepts:</p>\n\n<pre><code>           Item        Address   00   01   02   03\n           ----        -------   --   --   --   --\n\"welcome back \"       0x400c89   77   65   6c   63    welc\n                      0x400c8d   6f   6d   65   20    ome.\n                      0x400c91   62   61   63   6b    back\n                      0x400c95   20   00   25   64    ..%d\n\n              c 0x7fffa9c401a0   77   65   6c   63    welc\n                0x7fffa9c401a4   6f   6d   65   20    ome.\n                0x7fffa9c401a8   62   61   63   6b    back\n                0x7fffa9c401ac   20   00   00   00    ....\n\n            len 0x7fffa9c401bc   00   00   00   00    ....\n\n              s 0x7fffa9c400e8   a0   01   c4   a9    ....\n                0x7fffa9c400ec   ff   7f   00   00    ....\n\n              p 0x7fffa9c40128   a0   01   c4   a9    ....\n                0x7fffa9c4012c   ff   7f   00   00    ....\n</code></pre>\n\n<p>This is the state of things at the entry to <code>strlen1</code>.  </p>\n\n<p>The string literal <code>\"welcome back \"</code> is stored starting at address <code>0x400c89</code>.  The character array <code>c</code> is stored starting at address <code>0x7fffa9c401a0</code>.  The pointer object <code>s</code> is stored starting at address <code>0x7fffa9c400e8</code> and contains the <em>address</em> of the array object <code>c</code> (x86 is little-endian, so it reads from least-signficant byte to most-significant byte).  The <em>object</em> <code>s</code> is only 8 bytes wide, which is why you got <code>8</code> as output for <code>sizeof(s)</code>.  </p>\n\n<p>You should not use the <code>%d</code> format specifier to print a value of type <code>size_t</code> (which is what <code>sizeof</code> returns).  If you're using C99 or later, use <code>%zu</code>;  if you're using C89, use <code>%lu</code> and cast the value to <code>unsigned long</code>:</p>\n\n<pre><code>printf( \"size of s=%zu\\n\", sizeof s ); // C99 or later\nprintf( \"size of s=%lu\\n\", (unsigned long) sizeof s ); /* C89 */\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6701010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba1acedaf4a7b298c9f7e038b91ce02?s=128&d=identicon&r=PG&f=1", "display_name": "anshika24", "link": "https://stackoverflow.com/users/6701010/anshika24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "closed_date": 1470914110, "answer_count": 3, "score": -7, "last_activity_date": 1470852220, "creation_date": 1470843553, "last_edit_date": 1470843593, "question_id": 38877960, "link": "https://stackoverflow.com/questions/38877960/character-array-in-function-argument-as-a-pointer-or-array", "closed_reason": "Needs more focus", "title": "Character array in function argument as a pointer or array?", "body": "<pre><code>#include&lt;stdio.h&gt;\n\nint strlen1(char *s){\n\n    char *p=s;\n    printf(\"%s\\n\",s);\n\n    printf(\"size of s=%d\\n\",sizeof(s));\n\n    while(*p!='\\0')\n\n    p++;\n\n    return p-s;\n\n}\n\nint main(){\n\n    int len;\n    char c[]=\"welcome back \";\n    len=strlen1(c);\n    printf(\"%d\",len);\n    return 0;\n\n}\n</code></pre>\n\n<p>In this code the char array passed as parameter of function strlen() in which s is a pointer(address of first element of array c) then why it prints the whole array and its size is only 8.And also assigning char pointer p as s will not reference its address rather its value.Please clear my concepts and basics of this whole code.\nThanks in advance.</p>\n"}, {"tags": ["c", "gcc", "optimization", "amazon-ec2", "fgets"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 8, "creation_date": 1470843396, "post_id": 38877883, "comment_id": 65116948, "body": "<code>40 &lt; 80</code>. Doesn&#39;t seem too cryptic."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470844223, "post_id": 38877883, "comment_id": 65117540, "body": "The problem is that line is an array of 40 bytes but you tell frets that it has 80 bytes. Use sizeof(line) instead of 80."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1470844315, "post_id": 38877883, "comment_id": 65117600, "body": "Let&#39;s extend the warning: <code>fgets called with bigger size (which is 80) than length of destination buffer (which is 40)</code>"}, {"owner": {"reputation": 139, "user_id": 6605625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd50ef1059f4ce3b7b18e2c40540a50?s=128&d=identicon&r=PG&f=1", "display_name": "mscnvrsy", "link": "https://stackoverflow.com/users/6605625/mscnvrsy"}, "edited": false, "score": 0, "creation_date": 1470844636, "post_id": 38877883, "comment_id": 65117792, "body": "ugh, can&#39;t believe I didn&#39;t see that. Thank you!"}, {"owner": {"reputation": 532, "user_id": 4520911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uzPkX.png?s=128&g=1", "display_name": "iRove", "link": "https://stackoverflow.com/users/4520911/irove"}, "edited": false, "score": 1, "creation_date": 1470844676, "post_id": 38877883, "comment_id": 65117815, "body": "@mscnvrsy So replace the call to <code>fgets</code> as: <code>fgets(line, sizeof(line), fp)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 3, "last_activity_date": 1471294663, "last_edit_date": 1471294663, "creation_date": 1470846223, "answer_id": 38878840, "question_id": 38877883, "link": "https://stackoverflow.com/questions/38877883/gcc-optimization-error-caused-by-fgets/38878840#38878840", "title": "GCC Optimization: Error caused by fgets", "body": "<p>You are indeed calling <code>fgets(line, 80, fp)</code>, but the destination array <code>line</code> is defined as an array of <code>40</code> char.  The compiler on the Amazon EC2 is better configured or smarter than yours.  This is a real bug if the file contains lines longer than 39 bytes.</p>\n\n<p>Incidentally, the compiler invoked as <code>gcc</code> on the Mac is usually an instance of <code>clang</code>. Try <code>gcc --version</code>.</p>\n\n<p>Note that your program does not check if too much data is read, nor if the <code>sscanf()</code> conversion succeeds.  Both lead to undefined behavior.</p>\n\n<p>Here is a safer version:</p>\n\n<pre><code>int loadPriceData(const char *filename, double *target, int nb_items) {\n    char line[80];\n    FILE *fp = fopen(filename, \"r\");\n    if (fp == NULL) {\n        return -1;\n    }\n    int i = 0;\n    while (fgets(line, sizeof line, fp) != NULL) {\n        if (i &lt; nb_items) {\n            if (sscanf(line, \"%lf\", target + i) != 1)\n                target[i] = 0;\n        }\n        i += 1;\n    }\n    fclose(fp);\n    return i; // Return number of elements\n}\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 6605625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd50ef1059f4ce3b7b18e2c40540a50?s=128&d=identicon&r=PG&f=1", "display_name": "mscnvrsy", "link": "https://stackoverflow.com/users/6605625/mscnvrsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 689, "favorite_count": 2, "accepted_answer_id": 38878840, "answer_count": 1, "score": -1, "last_activity_date": 1471294663, "creation_date": 1470843342, "last_edit_date": 1470846420, "question_id": 38877883, "link": "https://stackoverflow.com/questions/38877883/gcc-optimization-error-caused-by-fgets", "title": "GCC Optimization: Error caused by fgets", "body": "<p>I compiled code on my Mac with the GCC Optimization Flag <code>-O3</code> on to accelerate the execution time. This perfectly worked on my local machine and lead to a speed increase by 2/3.</p>\n\n<p>However, I tried to compile the code on the Amazon EC2, since I am dealing with a large dataset. Using the <code>-O3</code> optimization flag causes the following warning</p>\n\n<blockquote>\n  <p>warning: call to \u2018__fgets_chk_warn\u2019 declared with attribute warning: \n  fgets called with bigger size than length of destination buffer</p>\n</blockquote>\n\n<p>In the respective function, a text file is parsed line by line. However, I do not really understand why I end up with the warning. The code of the function reads as follows:</p>\n\n<pre><code>int loadPriceData(const char *filename, double *target) {\n    char line[40];\n    FILE *fp;\n    fp = fopen(filename, \"r\");\n    if (fp == NULL) {\n        return -1;\n    }\n    int i = 0;\n    while (fgets(line, 80, fp) != NULL) {\n        sscanf(line, \"%lf\\n\", target + i);\n        i += 1;\n    }\n    fclose(fp);\n    return i; // Return number of elements\n}\n</code></pre>\n\n<p><code>target</code> is a pointer to an array with <code>10000</code> elements by default. The number of entries is not known in advance, but returned by the function.</p>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1470842899, "post_id": 38877695, "comment_id": 65116576, "body": "Which textbook? (just out of curiosity)"}, {"owner": {"reputation": 179, "user_id": 6228372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc19b885bb848eed9d1aee5af0305882?s=128&d=identicon&r=PG&f=1", "display_name": "Hardey Pandya", "link": "https://stackoverflow.com/users/6228372/hardey-pandya"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1470843009, "post_id": 38877695, "comment_id": 65116680, "body": "Why a downvote ? What&#39;s wrong with it."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 3, "creation_date": 1470843047, "post_id": 38877695, "comment_id": 65116714, "body": "There are &quot;predefined identifiers&quot; and &quot;predefined macro names&quot;. These are the only uses of &quot;predefined&quot; in the standard. Every thing else is just &quot;gossip&quot;. Probably get a better book (since it does not clearly define the terms it is using, a sign of bad quality)."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 3256, "user_id": 6292850, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/86iZy.jpg?s=128&g=1", "display_name": "uh oh somebody needs a pupper", "link": "https://stackoverflow.com/users/6292850/uh-oh-somebody-needs-a-pupper"}, "edited": false, "score": 0, "creation_date": 1470843133, "post_id": 38877695, "comment_id": 65116783, "body": "@uhohsomebodyneedsapupper Actually it&#39;s used (see my previous comment), but not in any relation with functions."}, {"owner": {"reputation": 179, "user_id": 6228372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc19b885bb848eed9d1aee5af0305882?s=128&d=identicon&r=PG&f=1", "display_name": "Hardey Pandya", "link": "https://stackoverflow.com/users/6228372/hardey-pandya"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1470843283, "post_id": 38877695, "comment_id": 65116883, "body": "As @SouravGhosh told in the answer, these are library functions. But is the definition of library function can be given as mentioned in the book ? If yes, then how ?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470844158, "post_id": 38877695, "comment_id": 65117496, "body": "@HardeyPandya: By now you should already know the book is more than bad, it is not to be trusted in any its statements. So forget it and get a correct one."}, {"owner": {"reputation": 22909, "user_id": 2291, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52c5b2df0b28f6efc9d50e4d0d47e42a?s=128&d=identicon&r=PG", "display_name": "Jon Adams", "link": "https://stackoverflow.com/users/2291/jon-adams"}, "edited": false, "score": 0, "creation_date": 1470846160, "post_id": 38877695, "comment_id": 65118770, "body": "This would probably be better suited to ask on <a href=\"http://programmers.stackexchange.com/\">programmers.stackexchange.com</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470843167, "post_id": 38877758, "comment_id": 65116803, "body": "Better? You men &quot;correct&quot;. &quot;predefined&quot; functions is nonsense, even for <i>intrinsics</i>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1470843257, "post_id": 38877758, "comment_id": 65116862, "body": "@Olaf ok, that&#39;s <i>better</i>. :)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1470843345, "last_edit_date": 1470843345, "creation_date": 1470843007, "answer_id": 38877758, "question_id": 38877695, "link": "https://stackoverflow.com/questions/38877695/what-exactly-is-a-predefined-function/38877758#38877758", "title": "What exactly is a &quot;Predefined Function&quot;?", "body": "<p>A <del><em>better</em></del> correct (and appropriate) term to use there would be <em>library functions</em>.</p>\n\n<p>To elaborate, a library contains pre-written and compiled code. To use the code (example: functions), you need to link the library to your application and <em>make use of</em> the library code (example: call the functions). You'll get the functionality <em>as if the code present in library in integrated in your application</em>.</p>\n\n<p>Read about the <a href=\"https://en.wikipedia.org/wiki/C_standard_library\" rel=\"nofollow\">C standard library</a> and <a href=\"https://www.gnu.org/software/libc/manual/html_node/Function-Index.html\" rel=\"nofollow\">check the list of library functions</a></p>\n\n<p><strong>Note:</strong> not <strong><em>all</em></strong> the libraries are standard library.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470843610, "post_id": 38877931, "comment_id": 65117099, "body": "And <code>main</code> is strongly discouraged since C99 and listed as obsolescence feature. The part about the functions is just nonsense. <b>All</b> functions have to be declared. The standard requires a warning for implicit declarations. Is that book about K&amp;R-C or C90? Ok, the book should be banned from any list of C books."}, {"owner": {"reputation": 179, "user_id": 6228372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc19b885bb848eed9d1aee5af0305882?s=128&d=identicon&r=PG&f=1", "display_name": "Hardey Pandya", "link": "https://stackoverflow.com/users/6228372/hardey-pandya"}, "edited": false, "score": 0, "creation_date": 1470843632, "post_id": 38877931, "comment_id": 65117119, "body": "@uh oh somebody needs a pupper, I am beginner, so obviously I don&#39;t know right things."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 179, "user_id": 6228372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc19b885bb848eed9d1aee5af0305882?s=128&d=identicon&r=PG&f=1", "display_name": "Hardey Pandya", "link": "https://stackoverflow.com/users/6228372/hardey-pandya"}, "edited": false, "score": 3, "creation_date": 1470843693, "post_id": 38877931, "comment_id": 65117156, "body": "@HardeyPandya no one&#39;s blaming you -- You did well to come and ask :)"}, {"owner": {"reputation": 3256, "user_id": 6292850, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/86iZy.jpg?s=128&g=1", "display_name": "uh oh somebody needs a pupper", "link": "https://stackoverflow.com/users/6292850/uh-oh-somebody-needs-a-pupper"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470843769, "post_id": 38877931, "comment_id": 65117214, "body": "@Olaf The book is titled &quot;ANSI C&quot;. Either way, <code>void main()</code> is commonly taught in the country of origin the book is published in because they still use Turbo C on DOS there."}, {"owner": {"reputation": 179, "user_id": 6228372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc19b885bb848eed9d1aee5af0305882?s=128&d=identicon&r=PG&f=1", "display_name": "Hardey Pandya", "link": "https://stackoverflow.com/users/6228372/hardey-pandya"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1470843793, "post_id": 38877931, "comment_id": 65117230, "body": "@Quentin &quot;I wouldn&#39;t trust the book, if I were you.&quot;"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 179, "user_id": 6228372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc19b885bb848eed9d1aee5af0305882?s=128&d=identicon&r=PG&f=1", "display_name": "Hardey Pandya", "link": "https://stackoverflow.com/users/6228372/hardey-pandya"}, "edited": false, "score": 0, "creation_date": 1470843829, "post_id": 38877931, "comment_id": 65117248, "body": "@HardeyPandya: 1) open the window 2) grab the book 3) test the aerodynamics of the book 4) find the list of recommended C books on stack overflow <b>yourself</b> 5) Pick a book 6) turn on your brain (i.e. think for yourself when ...) 7) Read that book (or the book<b>s</b>)"}, {"owner": {"reputation": 3256, "user_id": 6292850, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/86iZy.jpg?s=128&g=1", "display_name": "uh oh somebody needs a pupper", "link": "https://stackoverflow.com/users/6292850/uh-oh-somebody-needs-a-pupper"}, "reply_to_user": {"reputation": 179, "user_id": 6228372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc19b885bb848eed9d1aee5af0305882?s=128&d=identicon&r=PG&f=1", "display_name": "Hardey Pandya", "link": "https://stackoverflow.com/users/6228372/hardey-pandya"}, "edited": false, "score": 0, "creation_date": 1470843928, "post_id": 38877931, "comment_id": 65117325, "body": "@HardeyPandya It&#39;s perfectly normal to not trust the textbook as they&#39;re not perfect. I know of a $300 textbook required for a college course that&#39;s full of errors, despite being the 16th edition."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1470844000, "post_id": 38877931, "comment_id": 65117375, "body": "@uhohsomebodyneedsapupper: Any book still teaching ANSI-C (aka C89/90) should be banned instantly. Beginners should start with modern C99 at least. If they encounter a project with C90 in the job, they should be able to 1) try the companiy to move on to modern times, if that is not possible, then 2) easily learn the pitfalls of mideval C."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470844069, "post_id": 38877931, "comment_id": 65117427, "body": "Of course, <code>printf()</code> and <code>scanf()</code> are <b><i>not</i></b> &quot;part of the language&quot; in any sense that distinguishes them from other functions in the standard library.  Compilers generally do not know their signatures automatically, contrary to the text&#39;s assertion."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1470844149, "post_id": 38877931, "comment_id": 65117487, "body": "I wouldn&#39;t be bothered much about teaching C90 if it were just taught <i>accurately</i>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470844308, "post_id": 38877931, "comment_id": 65117597, "body": "@JohnBollinger: Well... when compiling for a hosted environment, gcc by default knows a lot of the standard functions (though not the larger ones like <code>printf</code> etc.) already and may replace them with optimised inline code."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470844446, "post_id": 38877931, "comment_id": 65117664, "body": "@JohnBollinger: Problem is, C99 introduced some incompatibilities and added very useful features. There are good reasons to use C99/C11 and not C90 anymore, so why not move things on? Interestingly, the C community much more refuses to adopt new features than e.g. the C++ community."}, {"owner": {"reputation": 3256, "user_id": 6292850, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/86iZy.jpg?s=128&g=1", "display_name": "uh oh somebody needs a pupper", "link": "https://stackoverflow.com/users/6292850/uh-oh-somebody-needs-a-pupper"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1470844501, "post_id": 38877931, "comment_id": 65117702, "body": "@Olaf The same is true for freestanding environments too actually. Your performance may be degraded if GCC decides to use its built-in memcpy over your super duper hand-written SSE3 assembly memcpy. It&#39;s tricky to get it to <i>not</i> do that regardless of the presence of a C library."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470845031, "post_id": 38877931, "comment_id": 65118034, "body": "@uhohsomebodyneedsapupper: Just checked, yes, I confused something here. It depends on strict ISO mode and <code>-fno-builtin</code> if it might use them. Regarding the memcpy: I strongly doubt your claim is true for my projects."}], "tags": [], "owner": {"reputation": 3256, "user_id": 6292850, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/86iZy.jpg?s=128&g=1", "display_name": "uh oh somebody needs a pupper", "link": "https://stackoverflow.com/users/6292850/uh-oh-somebody-needs-a-pupper"}, "is_accepted": true, "score": 5, "last_activity_date": 1470843469, "creation_date": 1470843469, "answer_id": 38877931, "question_id": 38877695, "link": "https://stackoverflow.com/questions/38877695/what-exactly-is-a-predefined-function/38877931#38877931", "title": "What exactly is a &quot;Predefined Function&quot;?", "body": "<p>I wouldn't trust that textbook if I were you. On page 5 it says:</p>\n\n<blockquote>\n  <p>C permits different forms of main statement. Following forms are\n  allowed.</p>\n  \n  <ul>\n  <li><p>main()</p></li>\n  <li><p>int main()</p></li>\n  <li><p>void main()</p></li>\n  </ul>\n</blockquote>\n\n<p>I'm going to stop right there. <code>void main()</code> has never been allowed in standardized C. Similarly it says:</p>\n\n<blockquote>\n  <p><em>NOTE:</em> Some authors recommend the inclusion of the statement</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n</code></pre>\n  \n  <p>at the beginning of all programs that use any input/output library\n  functions. However, this is not necessary for the functions <em>printf</em>\n  and <em>scanf</em> which have been defined as a part of the C language.</p>\n</blockquote>\n\n<p>It is very bad practice to rely on the implicit definitions of <code>printf</code> (or any library function for that matter.)</p>\n\n<p>Which leads me to believe the authors use of \"defined\" is shaky at best, since \"definition\" and \"predefined\" are words that have exact meanings in the C specification.</p>\n\n<p>A generous interpretation would be that the library functions are linked in via the C library either provided by the compiler or found on your system, which is usually glibc. You can always run <code>ldd</code> on a linux system to see which dynamic library is used for your program.</p>\n"}], "owner": {"reputation": 179, "user_id": 6228372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc19b885bb848eed9d1aee5af0305882?s=128&d=identicon&r=PG&f=1", "display_name": "Hardey Pandya", "link": "https://stackoverflow.com/users/6228372/hardey-pandya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "closed_date": 1470847269, "accepted_answer_id": 38877931, "answer_count": 2, "score": 2, "last_activity_date": 1470843469, "creation_date": 1470842849, "last_edit_date": 1470843439, "question_id": 38877695, "link": "https://stackoverflow.com/questions/38877695/what-exactly-is-a-predefined-function", "closed_reason": "Needs more focus", "title": "What exactly is a &quot;Predefined Function&quot;?", "body": "<p>My textbook writes the definition of predefined function as follows : </p>\n\n<blockquote>\n  <p>Predefined means that it is a function that has already been written and compiled, and linked together with our program at the time of linking. </p>\n</blockquote>\n\n<p>I just can't understand what does it mean. Can you explain ? I actually a beginner in C. I've searched the terminology of compiling and linking. But this definition does not makes sense to me. \nMy textbook also writes that <code>printf</code>is also a predefined function.</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "kernel-module", "fpu"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 7, "creation_date": 1470842958, "post_id": 38877694, "comment_id": 65116631, "body": "Sounds like an XY-problem. <i>Why</i> do you need the FP computations to be done in kernelmode?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1470842975, "post_id": 38877694, "comment_id": 65116644, "body": "XY problem. Why do you <b>think</b> you have to do the processing in kernel space??"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470842997, "post_id": 38877694, "comment_id": 65116669, "body": "@EOF: Hrmm, too slow ;-)"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1470848852, "post_id": 38877694, "comment_id": 65120247, "body": "If it is not clear from what EOF and Olaf commented, userspace applications in Linux on x86 can use floating point hardware as they wish. The kernel doesn&#39;t use floating-point, because it does not need to, and not using floating-point registers means it can optimize their loading/unloading on each context switch. <a href=\"https://www.rtai.org/\" rel=\"nofollow noreferrer\"><b>RTAI</b></a> is RealTime Application Interface -- for userspace applications (which, as I mentioned, can use FP HW freely)."}, {"owner": {"reputation": 1, "user_id": 6291146, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209304952570223/picture?type=large", "display_name": "Eshwar Khatri", "link": "https://stackoverflow.com/users/6291146/eshwar-khatri"}, "edited": false, "score": 0, "creation_date": 1470863460, "post_id": 38877694, "comment_id": 65128083, "body": "well, the point of using FPU in kernel space is that I want to <b><i>_access the hardware directly_</i></b>, which I believe is not possible in userspace. I am aware that I can use fpu in userspace but I don&#39;t want to have any kind of bridge between hardware and my actual module because it would eventually slower the performance. Moreover, my task involves the communication between two Linux-RTAI systems via EtherCAT and by doing so in userspace, the application has to read kernel module buffer every time when the buffer is full and process it. so I have to have FPU enabled in kernel space somehow!"}], "owner": {"reputation": 1, "user_id": 6291146, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209304952570223/picture?type=large", "display_name": "Eshwar Khatri", "link": "https://stackoverflow.com/users/6291146/eshwar-khatri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 550, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1470842843, "creation_date": 1470842843, "question_id": 38877694, "link": "https://stackoverflow.com/questions/38877694/how-to-enable-hardware-floating-point-unit-fpu-in-linux-kernel", "title": "how to enable hardware Floating Point Unit (FPU) in linux kernel?", "body": "<p>I am have a linux system (x86) with RTAI installed on it, and I am using it for a control design application.</p>\n\n<p>The exported c code of a continuous-time simulink model involves some calculations with floating point data, which off course not supported in kernel space, normally. But I have to force my hardware to perform floating point calculations since I don't seem to have any other alternative.</p>\n\n<p>I have tried to google it a lot, but I didn't found anything to the point and straight forward.</p>\n\n<p>any suggestions?</p>\n\n<p>__</p>\n\n<p>regards.</p>\n"}, {"tags": ["c", "arrays", "string", "pointers"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470842686, "post_id": 38877542, "comment_id": 65116405, "body": "You realize that the parentheses in <code>char *(names)[8];</code> are pointless, right? It&#39;s still equivalent to <code>char *(names[8]);</code>, an array of pointers, same as <code>char *names[8];</code>."}, {"owner": {"reputation": 145, "user_id": 6636589, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1VGrBVOmjF4/AAAAAAAAAAI/AAAAAAAAABY/dXlado0wH5w/photo.jpg?sz=128", "display_name": "Matthew", "link": "https://stackoverflow.com/users/6636589/matthew"}, "edited": false, "score": 0, "creation_date": 1470842719, "post_id": 38877542, "comment_id": 65116426, "body": "Why do you use brackets around names? <code>char *(names)[8]</code> what did you expect from this?"}, {"owner": {"reputation": 2201, "user_id": 1488801, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6uYLp.jpg?s=128&g=1", "display_name": "James Elderfield", "link": "https://stackoverflow.com/users/1488801/james-elderfield"}, "edited": false, "score": 1, "creation_date": 1470842765, "post_id": 38877542, "comment_id": 65116468, "body": "For one thing you have an array of size 8, but then loop 10 times through it."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 2201, "user_id": 1488801, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6uYLp.jpg?s=128&g=1", "display_name": "James Elderfield", "link": "https://stackoverflow.com/users/1488801/james-elderfield"}, "edited": false, "score": 1, "creation_date": 1470842807, "post_id": 38877542, "comment_id": 65116495, "body": "@JamesElderfield hah!! beat you sir by 17 seconds. :)"}, {"owner": {"reputation": 2201, "user_id": 1488801, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6uYLp.jpg?s=128&g=1", "display_name": "James Elderfield", "link": "https://stackoverflow.com/users/1488801/james-elderfield"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1470843058, "post_id": 38877542, "comment_id": 65116722, "body": "@SouravGhosh next time... :)"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1470843347, "post_id": 38877542, "comment_id": 65116923, "body": "Not related to your issue, but to have a string hold 8 <code>char</code>s it needs to be 9 <code>char</code> long. Mind the <code>0</code>-terminator."}], "answers": [{"tags": [], "owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "is_accepted": true, "score": 4, "last_activity_date": 1470842908, "creation_date": 1470842908, "answer_id": 38877721, "question_id": 38877542, "link": "https://stackoverflow.com/questions/38877542/code-fails-to-initialize-array-of-strings/38877721#38877721", "title": "Code Fails to Initialize Array of Strings", "body": "<pre><code>char *(names)[8];\n</code></pre>\n\n<p>declares an array of 8 pointers, the same as</p>\n\n<pre><code>char* names[8];\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>*names = malloc(sizeof(char)*8*10);\n</code></pre>\n\n<p>sets the first of those pointers to point at an array of 80 characters.  The other 7 pointers are still uninitialized.</p>\n\n<p>You seem to want a pointer to array, which would be</p>\n\n<pre><code>char (*names)[8];\n\nnames = malloc(10*sizeof(*names));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 145, "user_id": 6636589, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1VGrBVOmjF4/AAAAAAAAAAI/AAAAAAAAABY/dXlado0wH5w/photo.jpg?sz=128", "display_name": "Matthew", "link": "https://stackoverflow.com/users/6636589/matthew"}, "is_accepted": false, "score": 0, "last_activity_date": 1470843177, "creation_date": 1470843177, "answer_id": 38877814, "question_id": 38877542, "link": "https://stackoverflow.com/questions/38877542/code-fails-to-initialize-array-of-strings/38877814#38877814", "title": "Code Fails to Initialize Array of Strings", "body": "<p>You are getting the seg fault because you are overwritting allocated memory.</p>\n\n<pre><code>*names = malloc(sizeof(char)*8*10);\n</code></pre>\n\n<p>This line allocates 8 bytes of space for your first of 8 strings.</p>\n\n<p>When i == 0, at:</p>\n\n<pre><code>strcpy(names[i], defstr);\n</code></pre>\n\n<p>You overwrite names[0] with defstr. But names[0] == *names (which you already allocated. Thus you just lost your allocation.</p>\n\n<p>You must allocate all sections of your <code>**</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1470921011, "last_edit_date": 1470921011, "creation_date": 1470843959, "answer_id": 38878095, "question_id": 38877542, "link": "https://stackoverflow.com/questions/38877542/code-fails-to-initialize-array-of-strings/38878095#38878095", "title": "Code Fails to Initialize Array of Strings", "body": "<p>For starters this declaration</p>\n\n<pre><code>char *(names)[8];\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>char * names[8];\n</code></pre>\n\n<p>and declares an array of 8 pointers to char.</p>\n\n<p>In this statement</p>\n\n<pre><code>*names = malloc(sizeof(char)*8*10);\n</code></pre>\n\n<p>the first element of the array (that is the element names[0]) is initialized by the address of the allocated memory. All other elements have undetermined  values.</p>\n\n<p>Thus the following loop</p>\n\n<p>for (i=0; i&lt;10; i++) {\n      strcpy(names[i], defstr);\n      printf(\"done with %d, string is %s\\n\", i, names[i]);\n   }</p>\n\n<p>is incorrect and results in undefined behaviour of the program because as it was said elements of the array with indices greater than 0 were not initialized.</p>\n\n<p>What you mean is the following</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define M   10\n#define N   8\n\nint main( void ) \n{\n    char ( *names )[N];\n    int i;\n    char defstr[] = \"none\";\n\n    names = malloc( sizeof( char[M][N] ) );\n\n    printf( \"%s\\n\", defstr );\n\n    printf( \"defining\\n\" );\n\n    for ( i = 0; i &lt; M; i++ ) \n    {\n        strcpy(  names[i], defstr );\n        printf( \"done with %d, string is %s\\n\", i, names[i] );\n    }\n\n    printf(\"now printing\\n\");\n\n    for ( i = 0;  i &lt; M; i++ ) printf( \"%s\\n\", names[i] );\n\n    free( names );\n\n    return 0;\n}\n</code></pre>\n\n<p>In this program there is allocated dynamically a two-dimensional array of type <code>char [M][N]</code>. And this declaration</p>\n\n<pre><code>char ( *names )[N];\n</code></pre>\n\n<p>declares a pointer to an array of type <code>char[N]</code>.</p>\n\n<p>Or the following</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define M   10\n#define N   8\n\nint main( void ) \n{\n    char * names[M];\n    int i;\n    char defstr[] = \"none\";\n\n    printf( \"%s\\n\", defstr );\n\n    printf( \"defining\\n\" );\n\n    for ( i = 0; i &lt; M; i++ ) \n    {\n        names[i] = malloc( sizeof( char[N] ) );\n        strcpy(  names[i], defstr );\n        printf( \"done with %d, string is %s\\n\", i, names[i] );\n    }\n\n    printf(\"now printing\\n\");\n\n    for ( i = 0;  i &lt; M; i++ ) printf( \"%s\\n\", names[i] );\n\n    for ( i = 0; i &lt; M; i++ ) free( names[i] );\n\n    return 0;\n}\n</code></pre>\n\n<p>In this program there is declared a one-dimensional array of type <code>char * [M]</code> and each element of the array is initialized by the address of the allocated memory of type <code>char[N]</code></p>\n"}], "owner": {"reputation": 5213, "user_id": 1380285, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f9a9583aed6db34815797c68823225b9?s=128&d=identicon&r=PG", "display_name": "bob.sacamento", "link": "https://stackoverflow.com/users/1380285/bob-sacamento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 1, "accepted_answer_id": 38877721, "answer_count": 3, "score": -2, "last_activity_date": 1470921011, "creation_date": 1470842484, "last_edit_date": 1470842842, "question_id": 38877542, "link": "https://stackoverflow.com/questions/38877542/code-fails-to-initialize-array-of-strings", "title": "Code Fails to Initialize Array of Strings", "body": "<p>I'm trying to do something pretty simple: Establish a collection of 10 eight-character strings and assign a simple default value to each one. My code assigns the first string value, but then bombs with a segmentation fault. Code is below. Can anyone see what I am doing wrong?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n\nint main() {\n\n   char *(names)[8];\n   int i;\n   char defstr[] = \"none\";\n\n   *names = malloc(sizeof(char)*8*10);\n\n   printf(\"%s\\n\",defstr);\n\n   printf(\"defining\\n\");\n\n   for (i=0; i&lt;10; i++) {\n      strcpy(names[i], defstr);\n      printf(\"done with %d, string is %s\\n\", i, names[i]);\n   }\n\n   printf(\"now printing\\n\");\n\n   for (i=0; i&lt;10; i++) {\n      printf(\"%s\\n\", names[i]);\n   }\n}\n</code></pre>\n\n<p>Output is</p>\n\n<pre><code>$&gt; ./a.out\nnone\ndefining\nSegmentation fault: 11\n</code></pre>\n"}, {"tags": ["c", "sockets", "tcp"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1470842381, "post_id": 38877414, "comment_id": 65116183, "body": "What do the several calls to <code>recv()</code> return?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1470842443, "post_id": 38877414, "comment_id": 65116233, "body": "Does <code>encrypt()</code> <code>0</code>-terminate its result?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470842450, "post_id": 38877414, "comment_id": 65116239, "body": "How do you prevent the <code>recv()</code> call that reads the key from also reading parts of the file that are sent afterwards?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1470842522, "post_id": 38877414, "comment_id": 65116283, "body": "<code>sizeof(newString)</code> returns the size of the pointer <code>newString</code> which is either 4 or 8 depending on the bit width of your platform."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1470842685, "post_id": 38877414, "comment_id": 65116404, "body": "Come on, run this code inside a debugger, tracing it line by line, and while doing so inspect each and every value whether its contains what it should."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1470842738, "post_id": 38877414, "comment_id": 65116442, "body": "Same size-of issue in the client for this <code>sizeof(newBuff)</code>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1470842884, "post_id": 38877414, "comment_id": 65116561, "body": "Also not at least for the sake of efficient debugging: <b><i>Do test</i></b> the outcome of <b><i>all relevant</i></b> function calls as detailed as possible. Read the documentation to learn what detailed info the functions provide on success or failure. Log this."}, {"owner": {"reputation": 10901, "user_id": 1076479, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/eLQUX.jpg?s=128&g=1", "display_name": "Gil Hamilton", "link": "https://stackoverflow.com/users/1076479/gil-hamilton"}, "edited": false, "score": 0, "creation_date": 1470845247, "post_id": 38877414, "comment_id": 65118166, "body": "Comment 1: You&#39;re doing <code>while (n != 0) { n = recv(...)</code>: so if <code>recv</code> <i>does</i> return 0, you still execute the rest of the loop. Should restructure the code. One way (common in C) is:   <code>while ((n = recv(....)) &gt; 0) {</code>  (<code>&gt; 0</code> because <code>-1</code> is the error return from <code>recv</code>)"}, {"owner": {"reputation": 10901, "user_id": 1076479, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/eLQUX.jpg?s=128&g=1", "display_name": "Gil Hamilton", "link": "https://stackoverflow.com/users/1076479/gil-hamilton"}, "edited": false, "score": 0, "creation_date": 1470845391, "post_id": 38877414, "comment_id": 65118256, "body": "Comment 2: You should explicitly null-terminate your buffer -- following the <code>recv</code> -- before calling <code>strtok</code>. Otherwise, <code>strtok</code> may clobber whatever follows <code>buffer</code> on the stack."}, {"owner": {"reputation": 10901, "user_id": 1076479, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/eLQUX.jpg?s=128&g=1", "display_name": "Gil Hamilton", "link": "https://stackoverflow.com/users/1076479/gil-hamilton"}, "edited": false, "score": 0, "creation_date": 1470845481, "post_id": 38877414, "comment_id": 65118317, "body": "Comment 3: TCP does not preserve message boundaries. So, even though you&#39;re sending the file-to-be-encrypted a line at a time, the <code>recv</code> calls on the daemon side will almost certainly <i>not</i> obtain only a single line with each call."}, {"owner": {"reputation": 11, "user_id": 6700976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ee3aead3e5e703a580e37e61caea4e?s=128&d=identicon&r=PG&f=1", "display_name": "Sixo", "link": "https://stackoverflow.com/users/6700976/sixo"}, "edited": false, "score": 0, "creation_date": 1470886621, "post_id": 38877414, "comment_id": 65134156, "body": "Agh, it was the sizeof(newString) part. My bad. Thanks so much, alk/everybody! I&#39;d upvote it if I had the ability to do so..."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1470904213, "post_id": 38877414, "comment_id": 65142114, "body": "Please, post full working examples.  As such, your code snippet can have the problem erased once posted (as you <b>don&#39;t know</b> what the problem with the code is, you can accidentally erase it while extracting a not-working snippet ---that we have to rearrange again to make it executable---)"}], "owner": {"reputation": 11, "user_id": 6700976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ee3aead3e5e703a580e37e61caea4e?s=128&d=identicon&r=PG&f=1", "display_name": "Sixo", "link": "https://stackoverflow.com/users/6700976/sixo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1470843040, "creation_date": 1470842183, "last_edit_date": 1495539859, "question_id": 38877414, "link": "https://stackoverflow.com/questions/38877414/client-only-receiving-partial-data-back-from-the-server-via-a-socket-in-c", "title": "Client only receiving partial data back from the server via a socket in C", "body": "<p>Brand new to StackOverflow and definitely brand new to figuring out how to get sockets to work in C. Here's what I'm trying to do: I need to create two programs where one acts as a \"daemon\" (not actually, you just launch it first and it runs in the background) that listens on a specified port, and then another program that attempts to send information -- via that port -- from a plaintext file, along with the name of a \"key\" file that should be used to encrypt it. The daemon program connects to the (let's call it client) program, forks off a new process, accepts the information, encrypts the text accordingly, and then sends it back to the client program to be stored in a file.</p>\n\n<p>This last part is where I'm having trouble. I've been able to successfully transfer all of the data from the client to the daemon program, and even successfully encrypt it; I tried storing the info into a temp file to see how it was coming out and everything looked as it should. But when I try to send the information back -- it's worth noting that I'm trying to send it back in chunks as the daemon program is encrypting it and therefore potentially still receiving info -- the client only receives a fraction of the data before the connection is seemingly closed and the process is finished.</p>\n\n<p>Sorry for the lengthy post, just trying to be as detailed as possible. I tried searching for some posts regarding this topic and I did find <a href=\"https://stackoverflow.com/questions/4259722/socket-data-corrupted-during-tcp-ip-transfer\">this one</a>, but it wasn't quite the same issue (plus the suggested fixes were things I already tried). Below is what I think is the pertinent code. This is only my current set up, so certain aspects might just be random bits from different approaches I've tried, e.g. the shutdown on write on the client side is a recent addition that doesn't appear to have made a difference. I've tried a number of different things to make this work over the past week, so if any of the suggestions that come in are things that I've tried, I'll let you folks know. Thanks in advance!</p>\n\n<p>Client:</p>\n\n<pre><code>//Create socket, check for success\n//\n    int sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    if(sockfd == -1){\n        fprintf(stderr, \"socket creation failed\");\n        exit(1);\n    }\n//Create address structure for socket to connect to\n\n    struct sockaddr_in server;\n    server.sin_family = AF_INET;\n    server.sin_port = htons(port);  \n    server.sin_addr.s_addr = INADDR_ANY;\n\n    int success;\n    success = connect(sockfd, (struct sockaddr*) &amp;server, sizeof(server));\n    if(success == -1){\n        fprintf(stderr, \"Could not find port, failed to connect socket\\n\");\n        exit(2);\n    }\n\n//IF all is well, open up the plaintext file for extracting data\n\n    FILE* ptextSend = fopen(argv[1], \"r\");\n    int totalNeeded;\n    rewind(ptextSend);\n    fseek(ptextSend, 0L, SEEK_END);\n    totalNeeded = ftell(ptextSend);\n    totalNeeded = totalNeeded - 1;\n    rewind(ptextSend);\n//First, send key path\n\n    send(sockfd, keypath, sizeof(keypath), 0);\n\n//Then, send contents of file\n    int n = 0;\n    char buffer[1000];\n    while(n &lt; totalNeeded){\n    fgets(buffer, 1000, ptextSend);\n    printf(\"right now buffer is %s\\n\", buffer);\n    n = n + (send(sockfd, buffer, sizeof(buffer), 0));\n    }\n    shutdown(sockfd, 1);\n//Attempt to receive encrypted info back    \n    n=1;\n    while(n != 0){\n    char* newBuff[1000];\n    n = recv(sockfd, newBuff, sizeof(newBuff) - 1, 0);\n    if(n!=0)\n    fprintf(stdout, \"this is the client: %s\\n\", newBuff);\n    }\n</code></pre>\n\n<p>Daemon/Server code:</p>\n\n<pre><code>//Create socket\n    int sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    if(sockfd == -1){\n        fprintf(stderr, \"Server error: failure to create socket.\\n\");\n        exit(1);\n    }\n\n//Create address for socket\n    struct sockaddr_in server;\n    server.sin_family = AF_INET;\n    server.sin_port = htons(port);\n    server.sin_addr.s_addr = INADDR_ANY;\n\n//Bind socket to port using address struct\n    int bindSuccess = bind(sockfd, (struct sockaddr*) &amp;server, sizeof(server));\n    if(bindSuccess == -1){\n        fprintf(stderr, \"Server error: bind call failed.\\n\");\n        exit(1);\n    }\n\n//Set socket to listen\n    int listenSuccess = listen(sockfd, 5);\n    if(listenSuccess == -1){\n        fprintf(stderr, \"Server error: listen call failed.\\n\");\n        exit(1);\n    }\n\n//Accept next client connection\n    struct sockaddr_in client_addr;\n    socklen_t client_length = sizeof(client_addr);\n    int client_sockfd = accept(sockfd, (struct sockaddr*) &amp;client_addr, &amp;client_length);\n    if(client_sockfd == -1){\n        fprintf(stderr, \"Server error: accept call failed.\\n\");\n        exit(1);\n    }\npid_t pid = fork();\n\nif(pid &lt; 0){\n    fprintf(stderr, \"Error forking process on connection.\\n\");\n    exit(1);\n}\nif(pid == 0){\n//First receive key path\n    char keybuff[100];\n    recv(client_sockfd, keybuff, sizeof(keybuff),0);\n    FILE* theKey = fopen(keybuff, \"r\");\n\n    char buffer[1000];\n    int n = 1;\n\n    while(n != 0){\n    n = recv(client_sockfd, buffer, sizeof(buffer) - 1, 0);\n\n    strtok(buffer, \"\\n\");\n    char* newString = encrypt(buffer, theKey);\n    send(client_sockfd, newString, sizeof(newString) - 1, 0);\n\n    }\n\n    if(n == -1){\n        fprintf(stderr, \"Server error: failed to read from socket.\\n\");\n        exit(1);\n    }\n\n    fclose(theKey);\n    close(client_sockfd);\n    close(sockfd); \n\n    return 0;\n}else\n    return 0;\n\n}\n</code></pre>\n\n<p>What I should be getting back is \"right now buffer is: THE RED GOOSE FLIES AT MIDNIGHT STOP\" followed by its encrypted version, so 36 characters of gibberish (occasionally broken up with \"this is the client\" and a newline). Instead, the total output is:</p>\n\n<p>right now buffer is THE RED GOOSE FLIES AT MIDNIGHT STOP</p>\n\n<p>this is the client: BPZDOSZ</p>\n\n<p>...so just seven characters worth of data and then it exits (successfully).</p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 13521, "user_id": 654953, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f6453f58b70e93dbfa8998b71a95bb09?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/654953/ryan"}, "edited": false, "score": 0, "creation_date": 1470841816, "post_id": 38877209, "comment_id": 65115794, "body": "Can you compress your problem into a sentence or two? Reading novels isn&#39;t too fun."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1470842029, "post_id": 38877209, "comment_id": 65115948, "body": "I think you may have undefined behaviour when first calling fclose(img) when img has never been defined. Plus you have a block of code strictly identical in if and else foundJPEG test."}, {"owner": {"reputation": 1448, "user_id": 6301161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/379dcefc00cb60f7106a54bcfe8ec738?s=128&d=identicon&r=PG&f=1", "display_name": "Sraffa", "link": "https://stackoverflow.com/users/6301161/sraffa"}, "reply_to_user": {"reputation": 13521, "user_id": 654953, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f6453f58b70e93dbfa8998b71a95bb09?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/654953/ryan"}, "edited": false, "score": 0, "creation_date": 1470842066, "post_id": 38877209, "comment_id": 65115978, "body": "@self Sorry, it&#39;s my first time writing a question here. Basically, I want to know why in that block of code the fopen function changes the value of the foundJPEG boolean."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470842427, "post_id": 38877209, "comment_id": 65116220, "body": "Any reason you obfuscate <code>uint8_t</code> as <code>BYTE</code>? 1) all-uppercase should be used for macros/enum-constants only. 2) A byte does not necessarily have 8 bits. 3) Using the standard type makes your code clear to anyone without knowing the declaration of <code>BYTE</code>. 4) <code>typedef</code> only to include semantics into names."}, {"owner": {"reputation": 1448, "user_id": 6301161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/379dcefc00cb60f7106a54bcfe8ec738?s=128&d=identicon&r=PG&f=1", "display_name": "Sraffa", "link": "https://stackoverflow.com/users/6301161/sraffa"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470843476, "post_id": 38877209, "comment_id": 65117012, "body": "@Olaf Not really, another part of the assignment used it like that and I was trying to use it in my own code to make sure I understood how it worked (the BYTE had to do with the bitmap infoheader structure suggested in the  Microsoft website). Thanks anyway, jcoder already pointed out what was causing undefined behavior so I will just read on that to make sure I don&#39;t make this type of newbie mistake again :)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470844708, "post_id": 38877209, "comment_id": 65117832, "body": "Microsoft does not have a standard compliant C compiler. So it is a bad reference. <code>BYTE</code> or <code>WORD</code> are MS-specific relics, but today just bad style. Anyway, they should be already defined in some header, don&#39;t hand-craft them!"}], "answers": [{"comments": [{"owner": {"reputation": 1448, "user_id": 6301161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/379dcefc00cb60f7106a54bcfe8ec738?s=128&d=identicon&r=PG&f=1", "display_name": "Sraffa", "link": "https://stackoverflow.com/users/6301161/sraffa"}, "edited": false, "score": 0, "creation_date": 1470843232, "post_id": 38877592, "comment_id": 65116847, "body": "Thanks a lot! You are right, I forgot about the null terminator in the title array :(. About the img thing I&#39;m guessing I should initialize those to NULL from now on."}], "tags": [], "owner": {"reputation": 28011, "user_id": 417292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/d3520ad50fa42c9319830bd9f0900c5d?s=128&d=identicon&r=PG", "display_name": "jcoder", "link": "https://stackoverflow.com/users/417292/jcoder"}, "is_accepted": true, "score": 1, "last_activity_date": 1470842585, "creation_date": 1470842585, "answer_id": 38877592, "question_id": 38877209, "link": "https://stackoverflow.com/questions/38877209/fopen-changes-variable-value-in-c/38877592#38877592", "title": "fopen changes variable value in C", "body": "<p>There are at least two instances of indefined behavour in your code. </p>\n\n<pre><code>fclose(img);\n</code></pre>\n\n<p>You are calling this with img uninitialized</p>\n\n<pre><code>char title[7];          \nsprintf(title, \"%03d.jpg\", k);\n</code></pre>\n\n<p>The sprintf will write 8 characters 3+4 + null terminator to a 7 byte buffer which will overwrite something else on your stack.</p>\n\n<p>It's likely one of these causes your issue.</p>\n"}], "owner": {"reputation": 1448, "user_id": 6301161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/379dcefc00cb60f7106a54bcfe8ec738?s=128&d=identicon&r=PG&f=1", "display_name": "Sraffa", "link": "https://stackoverflow.com/users/6301161/sraffa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 38877592, "answer_count": 1, "score": -4, "last_activity_date": 1470851560, "creation_date": 1470841649, "last_edit_date": 1470851560, "question_id": 38877209, "link": "https://stackoverflow.com/questions/38877209/fopen-changes-variable-value-in-c", "title": "fopen changes variable value in C", "body": "<p>I'm taking the EDx CS50 class from Harvard to learn C and I noticed a strange behavior of my code in one of the problem sets (I already came up with a solution that worked, but I want to understand why the original one doesn't). The idea of the assignment is to check a file where references to jpeg files have been deleted, and thus recover photos from memory.</p>\n\n<p>The issue I have is with the <code>foundJPEG</code> boolean below. My original idea was to set it to false until the first photo was found and after that start writing the individual files (they were supposed to be in continuous blocks of memory). The first time a jpeg header was found, a new write file would be generated and the information copied there until a new jpeg was found. Additionally, the <code>foundJPEG</code> variable would become <code>true</code>. Originally I only had this declaration under the else clause of the  <code>if(foundJPEG)</code> block of code, but after running it I noticed that every time the <code>fopen</code> function was called, the variable went back to <code>false</code>. Hence, I just added a new <code>foundJPEG = true;</code> statement after opening a new file, even in the case when the variable was already changed to true. </p>\n\n<p>What I want to know is why the boolean is becoming false every time <code>fopen</code> is called. In particular, since C gives so much control about memory allocation, I was wondering if it was because it was somehow being overwritten whenever I open a file or because of some scope issue. I guess this is probably a rookie mistake but I thought maybe someone could help me understand this better so that I don't compound mistakes when writing larger applications. Thank you very much!</p>\n\n<pre><code>/*\n* recover.c\n*\n* Computer Science 50\n* Problem Set 4\n*\n* Recovers JPEGs from a forensic image.\n*/\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdbool.h&gt;\n\ntypedef uint8_t  BYTE;\n\n\nint main(int argc, char* argv[]) {\n    int k = 0;\n    bool foundJPEG = false;\n    char title[7];\n    FILE* file = fopen(\"card.raw\", \"rb\");\n    FILE* img;\n\n    BYTE buf[512];\n    int size = sizeof(buf);\n    while(fread(&amp;buf, size, 1, file) == 1) {\n        if(buf[0] == 0xff &amp;&amp; buf[1] == 0xd8 &amp;&amp; buf[2] == 0xff &amp;&amp; buf[3]  &gt;= 0xe0 &amp;&amp; buf[3] &lt;= 0xef) {\n            if(foundJPEG) {\n                fclose(img);\n                k++;\n                sprintf(title, \"%03d.jpg\", k);\n                img = fopen(title, \"wb\");\n                foundJPEG = true;\n            }\n            else {\n                sprintf(title, \"%03d.jpg\", k);\n                img = fopen(title, \"wb\");\n                foundJPEG = true;\n            }\n\n\n        }\n        if(foundJPEG) {\n            fwrite(&amp;buf, size, 1, img);\n        }\n\n    }\n\n    fclose(img);\n    return 0; \n}\n</code></pre>\n"}, {"tags": ["c", "text"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1470839444, "post_id": 38876245, "comment_id": 65114004, "body": "can you tell us what is your problem with this code? (I see one: your delay loop is a CPU intensive loop, not very good!)"}, {"owner": {"reputation": 135, "user_id": 6700773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8750c4673d6f252eb01d318194aeb5?s=128&d=identicon&r=PG&f=1", "display_name": "f.koglu", "link": "https://stackoverflow.com/users/6700773/f-koglu"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1470839678, "post_id": 38876245, "comment_id": 65114188, "body": "it needs some addition. this code takes the lines number once it doesn&#39;s asks till text ends."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 6700773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8750c4673d6f252eb01d318194aeb5?s=128&d=identicon&r=PG&f=1", "display_name": "f.koglu", "link": "https://stackoverflow.com/users/6700773/f-koglu"}, "edited": false, "score": 0, "creation_date": 1470846622, "post_id": 38876746, "comment_id": 65119027, "body": "Yeah you are right but i&#39;m not good at c and its libraries. And i cant do that how i index last written line and keep going from there"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 135, "user_id": 6700773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8750c4673d6f252eb01d318194aeb5?s=128&d=identicon&r=PG&f=1", "display_name": "f.koglu", "link": "https://stackoverflow.com/users/6700773/f-koglu"}, "edited": false, "score": 0, "creation_date": 1470847157, "post_id": 38876746, "comment_id": 65119324, "body": "@f.koglu: sorry, I do not understand your comment."}, {"owner": {"reputation": 135, "user_id": 6700773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8750c4673d6f252eb01d318194aeb5?s=128&d=identicon&r=PG&f=1", "display_name": "f.koglu", "link": "https://stackoverflow.com/users/6700773/f-koglu"}, "edited": false, "score": 0, "creation_date": 1470847608, "post_id": 38876746, "comment_id": 65119588, "body": "For example program i run the program and program write 5 lines. And then ask me how many lines to read i write 8. How can i start with sixth line?? I have to put a loop? Can you write this loop?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 135, "user_id": 6700773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8750c4673d6f252eb01d318194aeb5?s=128&d=identicon&r=PG&f=1", "display_name": "f.koglu", "link": "https://stackoverflow.com/users/6700773/f-koglu"}, "edited": false, "score": 0, "creation_date": 1470848801, "post_id": 38876746, "comment_id": 65120223, "body": "@f.koglu: after you have read the 5 lines, ask the user for input with <code>printf()</code> and <code>scanf()</code>, then keep reading the number of lines entered... and put this in a loop to repeat until you reach the end of the file.  I cannot write the full assignment myself, it is for you to figure."}, {"owner": {"reputation": 135, "user_id": 6700773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8750c4673d6f252eb01d318194aeb5?s=128&d=identicon&r=PG&f=1", "display_name": "f.koglu", "link": "https://stackoverflow.com/users/6700773/f-koglu"}, "edited": false, "score": 0, "creation_date": 1470850022, "post_id": 38876746, "comment_id": 65120862, "body": "Yes i know this algorithmic type but i cant put this in in code"}, {"owner": {"reputation": 135, "user_id": 6700773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8750c4673d6f252eb01d318194aeb5?s=128&d=identicon&r=PG&f=1", "display_name": "f.koglu", "link": "https://stackoverflow.com/users/6700773/f-koglu"}, "edited": false, "score": 0, "creation_date": 1470850486, "post_id": 38876746, "comment_id": 65121128, "body": "And i cant understand this point, first i take number of line from command line. When i want to take this again should i assign the value another veriable?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 135, "user_id": 6700773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8750c4673d6f252eb01d318194aeb5?s=128&d=identicon&r=PG&f=1", "display_name": "f.koglu", "link": "https://stackoverflow.com/users/6700773/f-koglu"}, "edited": false, "score": 0, "creation_date": 1470851074, "post_id": 38876746, "comment_id": 65121460, "body": "It does not matter which variable you use for the rest of the program.  You are not going to execute the beginning of <code>main()</code> again.  You can use <code>lineCount</code> first as <code>lineCount = atoi(arg[3]);</code> to read the number of lines specified on the command line, and then with <code>scanf(&quot;%d&quot;, &amp;lineCount);</code> to get the next count from the user.  <code>lineCount</code> is a local variable, you can use for multiple purposes, but combining these into a single loop is tricky, use 2 separate loops."}, {"owner": {"reputation": 135, "user_id": 6700773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8750c4673d6f252eb01d318194aeb5?s=128&d=identicon&r=PG&f=1", "display_name": "f.koglu", "link": "https://stackoverflow.com/users/6700773/f-koglu"}, "edited": false, "score": 0, "creation_date": 1470852677, "post_id": 38876746, "comment_id": 65122420, "body": "OK thanks i will try it  if i have some troubles can i ask you?"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1470840837, "last_edit_date": 1470840837, "creation_date": 1470840509, "answer_id": 38876746, "question_id": 38876245, "link": "https://stackoverflow.com/questions/38876245/c-programming-read-from-text-file/38876746#38876746", "title": "C programming- read from text file", "body": "<p>Your <code>delay</code> function uses a busy loop.  This is unnecessarily expensive in terms of computing power.  It would be very unwelcome to do this on a battery operated device.  Furthermore, <code>clock()</code> does not necessarily return a number of milliseconds.  The unit used by the <code>clock()</code> function can be determined using the <code>CLOCKS_PER_SEC</code> macro.  Unfortunately, there is no portable way to specify a delay expressed in milliseconds, POSIX conformant systems have <code>usleep()</code> and <code>nanosleep()</code>.</p>\n\n<p>Your line counting function is incorrect: you count 1 line too many, unless the file ends without a trailing linefeed.</p>\n\n<p>Here is an improved version:</p>\n\n<pre><code>int countlines(const char *filename) {\n    FILE *fp = fopen(filename, \"r\");\n    int ch, last = '\\n';\n    int lines = 0;\n\n    if (fp != NULL) {\n        while ((ch = fgetc(fp)) != EOF) {\n            if (ch == '\\n')\n                lines++;\n            last = ch;\n        }\n        fclose(fp);\n        if (last != '\\n')\n            lines++;\n    }\n    return lines;\n}\n</code></pre>\n\n<p>There are issues in the <code>main()</code> function too:</p>\n\n<ul>\n<li>You so not verify that enough arguments are passed on the command line.</li>\n<li>You do not check for <code>EOF</code> in the main reading loop.</li>\n<li>You do not repeat the process in a loop until end of file, nor do you even ask the question <code>how many line(s) do you want to read?</code> after reading the specified number of lines...</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 135, "user_id": 6700773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8750c4673d6f252eb01d318194aeb5?s=128&d=identicon&r=PG&f=1", "display_name": "f.koglu", "link": "https://stackoverflow.com/users/6700773/f-koglu"}, "edited": false, "score": 0, "creation_date": 1470848399, "post_id": 38877146, "comment_id": 65119997, "body": "Do you understand my problem? Can you write missing part of my code?"}], "tags": [], "owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "is_accepted": false, "score": 0, "last_activity_date": 1470841483, "creation_date": 1470841483, "answer_id": 38877146, "question_id": 38876245, "link": "https://stackoverflow.com/questions/38876245/c-programming-read-from-text-file/38877146#38877146", "title": "C programming- read from text file", "body": "<p>First, if the file cannot be found, the countlines method returns zero. You should use that value to write the error message, and skip the rest of the code.</p>\n\n<p>Second, in the next loop, you use</p>\n\n<pre><code>    if (ch != '\\n') {\n        printf(\"%c\", ch);\n    } else {\n        printf(\"\\n\");\n        delay(s2);\n        x++;\n    }\n</code></pre>\n\n<p>Why the two printf statements? They will print the same thing.\nPerhaps something like this:</p>\n\n<pre><code> ch = getc(ptDosya);\n /* exit the loop here if you hit EOF */\n\n printf(\"%c\", ch);  /* Why not putc() or putchar()  ? */\n if (ch == '\\n') {\n    x++;\n    if ( x == lineCount ) {\n       x = 0;\n       lineCount = requestNumberOfLinesToRead();\n    } else {\n      sleep(s2); /* instead of delay(). Remember to #include unistd.h */\n    }\n }\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 6700773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8750c4673d6f252eb01d318194aeb5?s=128&d=identicon&r=PG&f=1", "display_name": "f.koglu", "link": "https://stackoverflow.com/users/6700773/f-koglu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1470923456, "creation_date": 1470839285, "last_edit_date": 1470923456, "question_id": 38876245, "link": "https://stackoverflow.com/questions/38876245/c-programming-read-from-text-file", "title": "C programming- read from text file", "body": "<p>it's about reading from a text file.</p>\n\n<p>I have 3 command line arguments: </p>\n\n<ol>\n<li>name of text file</li>\n<li>delay time</li>\n<li>how many line(s) want to read.</li>\n</ol>\n\n<p>I want to read that text file by user specified line numbers till text file ends.</p>\n\n<p>For example, the first time I read 5 lines and then the program asks <code>how many line(s) do you want to read?</code>. I would enter <code>7</code> it reads lines 5 to 12.</p>\n\n<p>This would repeat until the end of the file.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include&lt;time.h&gt;\n#include &lt;string.h&gt;\nvoid delay(unsigned int mseconds)\n{\nclock_t goal = mseconds + clock();\nwhile (goal &gt; clock());\n}\nint countlines(const char *filename) {\nFILE *fp = fopen(filename, \"r\");\nint ch, last = '\\n';\nint lines = 0;\n\nif (fp != NULL) {\n    while ((ch = fgetc(fp)) != EOF) {\n        if (ch == '\\n')\n            lines++;\n        last = ch;\n    }\n    fclose(fp);\n    if (last != '\\n')\n        lines++;\n}\nreturn lines;\n}\nint main(int argc, char *arg[])\n{\nFILE *ptDosya;\nchar ch;\nch = arg[1][0];\nint s2;\nint satir = 0;\nint spaceCounter=0;\nint lineCount, x = 0;\nlineCount = atoi(arg[3]);\ns2 = atoi(arg[2]);\nprintf(\"dosya %d satir icerir.\\n\", countlines(arg[1]));\nptDosya = fopen(arg[1], \"r\");\nif (ptDosya != NULL)\n{\n    while (ch != EOF&amp;&amp; x &lt; lineCount)\n    {\n        ch = getc(ptDosya);\n        printf(\"%c\", ch);\n        if (ch == '\\n')\n        {\n            delay(s2);\n            x++;\n        }\n    }\n    while (x &lt; countlines(arg[1]))\n    {\n        printf(\"satir sayisi giriniz:\");\n        scanf(\"%d\", &amp;lineCount);\n         // i don't know what should i do in this loop..\n    x=x+lineCount;\n    }\n} \n\nelse {\n    printf(\"dosya bulunamadi\");\n}\nprintf(\"\\n\\nend of file!\\n\");\nfclose(ptDosya);\nreturn 0;\nsystem(\"PAUSE\");\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "malloc"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1470838795, "post_id": 38876014, "comment_id": 65113460, "body": "C11 draft standard n1570: <i>6.5.2.2 Function calls 4 An argument may be an expression of any complete object type. In preparing for the call to a function, the arguments are evaluated, and each parameter is assigned the value of the corresponding argument. 93) A function may change the values of its parameters, but these changes cannot affect the values of the arguments.</i>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1470839110, "post_id": 38876014, "comment_id": 65113736, "body": "@EOF absolutely right, just my two cents, for someone who says <code>I am new to C development</code>, <i>only</i> those are pretty heavy words. :)"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1470839226, "post_id": 38876014, "comment_id": 65113835, "body": "@SouravGhosh: I find that there really is no alternative to reading the standard if you want to <i>actually understand what is going on</i> in C. Much of the standard is quite readable as well."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470839297, "post_id": 38876014, "comment_id": 65113893, "body": "@EOF I certainly don&#39;t completely disagree, but IMHO, to <i>start with</i> reading the standard, is too much to ask for. :)"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1470839379, "post_id": 38876014, "comment_id": 65113948, "body": "@SouravGhosh: Which is why I like to cite relevant parts of the standard. That way, interested people can quickly find the section and find an entry into the subject. It&#39;s how I got into it as well."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470839448, "post_id": 38876014, "comment_id": 65114011, "body": "@EOF well, most of us here will have the same story, I believe :)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470839651, "post_id": 38876014, "comment_id": 65114166, "body": "C has neither <i>methods</i> nor <i>references</i>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1470839871, "post_id": 38876014, "comment_id": 65114359, "body": "@SouravGhosh: I&#39;m not so sure. Of course it is hard stuff to start with, but then it is well structured. One just has to invest more to start with it, but later it is easier than searching is some C book which splits the information across multiple chapters. And even if one does not understand some phrases, there is google and stack overflow to be <b>searched</b> first. Last option is to ask here."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470840020, "post_id": 38876014, "comment_id": 65114475, "body": "@Olaf that is why I used <i>only</i> in <i>italics</i>. For starting, it&#39;s good to read a book (or tutorial), get the basic idea of syntax and semantics, then, spec is always there for enhancement and / or correction of understanding."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1470840715, "post_id": 38876014, "comment_id": 65115023, "body": "@SouravGhosh: That&#39;s where I&#39;m not sure. E.g. I did not learn C (or programming in general) from a book, but by self-teaching and soon used the standard, resp. snippets from it I found. (Hard to recap after all this time ...)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470842264, "post_id": 38876014, "comment_id": 65116100, "body": "<code>void main</code> is an invalid signature. Your compiler should complain! If not, enable warnings and pay heed to them!"}, {"owner": {"reputation": 123, "user_id": 4177164, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0415ef37cfd57ca9c7169e98bdfbc8b6?s=128&d=identicon&r=PG&f=1", "display_name": "trebor74", "link": "https://stackoverflow.com/users/4177164/trebor74"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470842787, "post_id": 38876014, "comment_id": 65116485, "body": "Thanks @Olaf: I&#39;m not getting any warnings though. I&#39;m using gcc via Cygwin."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470842923, "post_id": 38876014, "comment_id": 65116601, "body": "@trebor74: Read my comment carefully <b>again</b>!"}, {"owner": {"reputation": 123, "user_id": 4177164, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0415ef37cfd57ca9c7169e98bdfbc8b6?s=128&d=identicon&r=PG&f=1", "display_name": "trebor74", "link": "https://stackoverflow.com/users/4177164/trebor74"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470843127, "post_id": 38876014, "comment_id": 65116778, "body": "@Olaf: Warnings are enabled and I&#39;m dealing with legacy Unix C code, so am getting loads of warnings and gradually resolving, It&#39;s possibly because I&#39;m using Cygwin which is a Unix emulator and probably has an older compiler?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470844579, "post_id": 38876014, "comment_id": 65117753, "body": "<code>malloc</code> cannot return <code>0</code>. It can return a _null pointer, though. That is <b>not</b> the same! (And how do you know, you don&#39;t even test the result of <code>malloc</code>, which you <b>always</b> should?)"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470841235, "post_id": 38876053, "comment_id": 65115380, "body": "You can&#39;t pass arrays by value to functions (and there is no pass-by reference in C)."}, {"owner": {"reputation": 123, "user_id": 4177164, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0415ef37cfd57ca9c7169e98bdfbc8b6?s=128&d=identicon&r=PG&f=1", "display_name": "trebor74", "link": "https://stackoverflow.com/users/4177164/trebor74"}, "edited": false, "score": 1, "creation_date": 1470841386, "post_id": 38876053, "comment_id": 65115501, "body": "Many thanks for your help. I&#39;ve just tried this exactly as you suggested and am still getting 0 as the output in <code>main()</code>. Do I need to change <code>testArray[1].id</code> to different syntax?"}, {"owner": {"reputation": 123, "user_id": 4177164, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0415ef37cfd57ca9c7169e98bdfbc8b6?s=128&d=identicon&r=PG&f=1", "display_name": "trebor74", "link": "https://stackoverflow.com/users/4177164/trebor74"}, "edited": false, "score": 0, "creation_date": 1470902525, "post_id": 38876053, "comment_id": 65141111, "body": "Actually the suggested code does return the first element of the array correctly, <code>testArray[0].id</code>. It&#39;s the second value only which is 0, <code>testArray[1].id</code>."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1470838804, "creation_date": 1470838804, "answer_id": 38876053, "question_id": 38876014, "link": "https://stackoverflow.com/questions/38876014/amending-an-array-by-reference-using-pointers-in-c/38876053#38876053", "title": "Amending an array by reference using pointers in C", "body": "<p>In your code, <code>testArray</code> itself is being passed-by-value. Any changes made to that inside the function, will not <em>reflect back</em> to the caller. You need to pass the address of the <code>testArray</code>, i.e., use a pointer to pointer.</p>\n\n<p>In this condition, </p>\n\n<pre><code>  printf(\"main element 2 id = %d\\n\", testArray[1].id); \n</code></pre>\n\n<p>in <code>main()</code> is basically accessing invalid memory which  invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.</p>\n\n<p>You can, however, do something like</p>\n\n<pre><code>int getArray(TestType **testArray)\n{\n\n    *testArray = malloc(2 * sizeof(TestType));\n    (*testArray[0]).id = 1;  \n    //....\n    //....\n</code></pre>\n\n<p>and</p>\n\n<pre><code> int i = getArray(&amp;testArray);\n</code></pre>\n\n<p>to get the desired behaviour.</p>\n\n<p>That said, just to mention <code>getArray(*&amp;testArray);</code> is the same as <code>getArray(testArray);</code></p>\n"}], "owner": {"reputation": 123, "user_id": 4177164, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0415ef37cfd57ca9c7169e98bdfbc8b6?s=128&d=identicon&r=PG&f=1", "display_name": "trebor74", "link": "https://stackoverflow.com/users/4177164/trebor74"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 2, "closed_date": 1470838808, "answer_count": 1, "score": 0, "last_activity_date": 1470922606, "creation_date": 1470838701, "last_edit_date": 1495541959, "question_id": 38876014, "link": "https://stackoverflow.com/questions/38876014/amending-an-array-by-reference-using-pointers-in-c", "closed_reason": "Duplicate", "title": "Amending an array by reference using pointers in C", "body": "<p>I am new to C development and I am having an issue setting an arrays values in a function and returning to the calling method. The function itself has to return an int and the array size needs to be dynamic, so I am trying to update the original array utilising a pointer to the array. My code is as below:</p>\n\n<pre><code>int getArray(TestType *testArray)\n{\n\n    testArray = malloc(2 * sizeof(TestType));\n    testArray[0].id = 1;\n    testArray[0].testFloat = 1.5;\n    testArray[1].id = 2;\n    testArray[1].testFloat = 2.5;\n\n    printf(\"getArray element 2 id = %d\\n\", testArray[1].id);\n\n    return 1;\n}\n\nvoid main()\n{\n   TestType *testArray; \n   int i = getArray(*&amp;testArray);   \n   printf(\"main element 2 id = %d\\n\", testArray[1].id); \n}\n</code></pre>\n\n<p>When I run this I get the following results:</p>\n\n<pre><code>getArray element 2 id = 2\nmain element 2 id = 0\n</code></pre>\n\n<p>I have looked elsewhere and although <a href=\"https://stackoverflow.com/questions/22814866/c-returning-an-array-from-a-function/\">c returning an array from a function</a> describes a similar issue this is dealing with a char array, whilst I have a user defined struct, so don't believe I can apply the same solution.</p>\n"}, {"tags": ["c", "compiler-errors", "free"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 2, "creation_date": 1470837928, "post_id": 38875667, "comment_id": 65112698, "body": "Please construct a <a href=\"http://stackoverflow.com/help/mcve\">minimal test-case</a>."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1470837986, "post_id": 38875667, "comment_id": 65112739, "body": "<code>File* fileStruct = (File*)malloc(sizeof(File)); [...] char* pointer = fileStruct-&gt;name; [...] free(pointer); </code> Undefined behavior for using an object with automatic storage duration while its value is indeterminate."}, {"owner": {"reputation": 20231, "user_id": 1342730, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/36543a7316596ec6e930bc8c996bf14b?s=128&d=identicon&r=PG", "display_name": "mathematician1975", "link": "https://stackoverflow.com/users/1342730/mathematician1975"}, "edited": false, "score": 1, "creation_date": 1470838035, "post_id": 38875667, "comment_id": 65112779, "body": "You are allocating memory to <code>fileStruct-&gt;name</code> then overwriting that pointers value after. This is a memory leak if nothing else. Similarly, <code>pointer</code> reflects the value of <code>fileStruct-&gt;name</code> prior to its value being overwritten by the malloc call. You have many issues here."}, {"owner": {"reputation": 45, "user_id": 5539398, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37076ca7b1a8a8a280b0e20268ecb02a?s=128&d=identicon&r=PG&f=1", "display_name": "Rafa_G", "link": "https://stackoverflow.com/users/5539398/rafa-g"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470838806, "post_id": 38875667, "comment_id": 65113470, "body": "@EOF can you give me a link to a website, because i cant really understand what you meant by &quot;undefined behavior&quot;, i saved the pointer in the first place so i could free it, i cant really get what should i do else. and the problem with pointer was me trying to fix the error...clearly i didnt get the idea of it"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470838874, "post_id": 38875667, "comment_id": 65113540, "body": "@RafaelShakedGreenfeld: You saved an indeterminate value from uninitialized memory that <code>malloc()</code> returned."}, {"owner": {"reputation": 45, "user_id": 5539398, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37076ca7b1a8a8a280b0e20268ecb02a?s=128&d=identicon&r=PG&f=1", "display_name": "Rafa_G", "link": "https://stackoverflow.com/users/5539398/rafa-g"}, "edited": false, "score": 0, "creation_date": 1470838887, "post_id": 38875667, "comment_id": 65113550, "body": "and why i keep getting rank down for qs? did i asked something wrong?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470838986, "post_id": 38875667, "comment_id": 65113622, "body": "@RafaelShakedGreenfeld You are getting downvoted because your code makes absolutely no sense and is wrong on too many levels to adequately explain within the format of Q&amp;A&#39;s on this site. You should start with the basics of C, read a book or do an online tutorial."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5539398, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37076ca7b1a8a8a280b0e20268ecb02a?s=128&d=identicon&r=PG&f=1", "display_name": "Rafa_G", "link": "https://stackoverflow.com/users/5539398/rafa-g"}, "edited": false, "score": 0, "creation_date": 1470854415, "post_id": 38878858, "comment_id": 65123392, "body": "thnx man, i know java and python, but c is a new world for me and i tried to learn in it in few days, i never saw a program in c a week ago....didnt see it coming...its nothong like java and lets not even mantion python...i try to use pointer to learn in the hard way,cause this how i always learned how to do things, i can see the power in c , but i need to let go of my java\\python habbits. anyway i return to the books\\youtube..."}, {"owner": {"reputation": 698, "user_id": 6697083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zwg0f.png?s=128&g=1", "display_name": "Riley", "link": "https://stackoverflow.com/users/6697083/riley"}, "reply_to_user": {"reputation": 45, "user_id": 5539398, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37076ca7b1a8a8a280b0e20268ecb02a?s=128&d=identicon&r=PG&f=1", "display_name": "Rafa_G", "link": "https://stackoverflow.com/users/5539398/rafa-g"}, "edited": false, "score": 0, "creation_date": 1470855127, "post_id": 38878858, "comment_id": 65123774, "body": "A lot of people have trouble with pointers. Keep at it, and good luck!"}], "tags": [], "owner": {"reputation": 698, "user_id": 6697083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zwg0f.png?s=128&g=1", "display_name": "Riley", "link": "https://stackoverflow.com/users/6697083/riley"}, "is_accepted": true, "score": 2, "last_activity_date": 1470846271, "creation_date": 1470846271, "answer_id": 38878858, "question_id": 38875667, "link": "https://stackoverflow.com/questions/38875667/getting-a-free-invalid-pointer-in-c/38878858#38878858", "title": "getting a &quot;free(): invalid pointer&quot; in c", "body": "<p>I'm just going to focus on what is causing your error (I didn't read most of your code).</p>\n\n<p>Pointers are one of the concepts in C that take a long time to learn, and you have a long way to go.<br>\nA pointer is just an address in memory, nothing else. You can think of <code>*pointer</code> as being a function call that says, \"take the number stored in pointer, go out to memory, and return the value that you find at the address corresponding to that number\".   </p>\n\n<hr>\n\n<p>When you say:</p>\n\n<pre><code>char* pointer = fileStruct-&gt;name;  \n</code></pre>\n\n<p>You aren't connecting those two variables in any way. It would be like saying:</p>\n\n<pre><code>int foo = 3;\nint bar = foo;\n</code></pre>\n\n<p>For now they have the same value, but if you change foo, bar doesn't change.  </p>\n\n<p>In your code, you aren't actually using pointer anywhere, so you can just gt rid of it and call <code>free(fileStruct-&gt;name)</code> when you are done using it.</p>\n\n<hr>\n\n<p>That being said, you need more practice/reading/learning about how pointers work. If you are just starting to program in general, you might want to avoid pointers all together until you are are comfortable with the basics.</p>\n"}], "owner": {"reputation": 45, "user_id": 5539398, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37076ca7b1a8a8a280b0e20268ecb02a?s=128&d=identicon&r=PG&f=1", "display_name": "Rafa_G", "link": "https://stackoverflow.com/users/5539398/rafa-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6396, "favorite_count": 0, "accepted_answer_id": 38878858, "answer_count": 1, "score": -5, "last_activity_date": 1470846271, "creation_date": 1470837823, "last_edit_date": 1470838264, "question_id": 38875667, "link": "https://stackoverflow.com/questions/38875667/getting-a-free-invalid-pointer-in-c", "title": "getting a &quot;free(): invalid pointer&quot; in c", "body": "<p>i am new at writing in c, \nmy program is for parsing a txt file and save the first word in a struct named File.</p>\n\n<p>for exmple:\nfor a txt file containing:\nfile1: file2,file3\nfile66: file7</p>\n\n<p>i would like to save file1 and file2 in a struct\nwhen\nfile1->name=file1\nfiel1->relation=[file2,file3]</p>\n\n<p>but this just for a bit explantion of the program.</p>\n\n<p>the problem is:\nbecause i dont know the size of the array of chars that would represent the name i were trying to use dynamic memory using malloc and free\nin the process i am using strtok for the parsing part\nthe problem start in the 4 last lines (marked in a comment) \nand i keep getting the error \"free(): invalid pointer: 0x00007ffe6accfdd0 ***\"\n(i looked in the website for answers but i because the lack of understanding in pointer it was hard for me to get the idea of the problem).</p>\n\n<p>someone can explain me why? \nthank you from advance</p>\n\n<pre><code>typedef struct File\n{\nchar *name;\nint *relation; \n}File;\n\nchar *error = BAD_FILE_MSG;\nchar buffer[MAX_LEN_SIZE];//the file buffer\nif (argc != RIGHT_NUM_OF_PARAM) {\n    fprintf(stderr, UNVALID_PARAMETER_MSG);\n    return BAD_RET_VAL;\n}\nchar *fileName = argv[1];\nFILE *fp = fopen(argv[1], \"r\"); /* \"r\" = open for reading */\nif (fp == NULL)\n{\n\n    fprintf(stderr, \"%s %s\", error, fileName);\n    return BAD_RET_VAL;\n}\nif (ferror(fp) != 0)\n{\n    fprintf(stderr, \"%s %s\", error, fileName);\n    return BAD_RET_VAL;\n}\n//int line = 0;//todo magic\n\nwhile (fgets (buffer, sizeof(buffer), fp))\n{\n    /**\n     * saving all the line in a char[]\n     */\n    //give memory to an array in file\n    char *token;\n    token = strtok (buffer, SIGN_FOR_SEPARATE);\n    int marker = 0;//todo fix\n    //creating a struct of a file\n    File* fileStruct = (File*)malloc(sizeof(File));\n    //creating a dynamic array of ints for relation\n    fileStruct-&gt;relation = (int *)malloc(100 * sizeof(int));//todo free your mind\n    char file[100];\n    while (token != NULL)\n    {\n        if (marker == 0)\n        {\n\n            char* pointer = fileStruct-&gt;name;\n            size_t size = strlen(token);\n            //creating a dynamic array of chars for name\n            fileStruct-&gt;name = (char *)malloc(size + 1);\n            fileStruct-&gt;name = token;//**getting the error**\n            free(pointer);\n            marker++;\n        }\n</code></pre>\n"}, {"tags": ["c++", "c", "memory"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 11, "creation_date": 1470837166, "post_id": 38875369, "comment_id": 65112116, "body": "Remember that C and C++, while syntactically similar in some parts, are really two different languages with different semantics and rules. So please don&#39;t spam tags unrelated to the language you are actually asking about."}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 3, "creation_date": 1470837244, "post_id": 38875369, "comment_id": 65112176, "body": "Well, the standard should be pretty informative."}, {"owner": {"reputation": 698, "user_id": 5845611, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/BheTl.jpg?s=128&g=1", "display_name": "Carousel", "link": "https://stackoverflow.com/users/5845611/carousel"}, "edited": false, "score": 0, "creation_date": 1470837244, "post_id": 38875369, "comment_id": 65112177, "body": "for C++, <a href=\"http://eel.is/c++draft/basic.align\" rel=\"nofollow noreferrer\">here</a> is what the standard says about it"}, {"owner": {"reputation": 523, "user_id": 6250057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1010949318993077/picture?type=large", "display_name": "Dogus Ural", "link": "https://stackoverflow.com/users/6250057/dogus-ural"}, "edited": false, "score": 0, "creation_date": 1470837507, "post_id": 38875369, "comment_id": 65112358, "body": "I added C tag because it is the language that brought this question to my mind ,and added the C++ tag because i am trying to do all typecastings explicitly."}, {"owner": {"reputation": 7737, "user_id": 3410396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc26b280cedaa721d90828a80e39706?s=128&d=identicon&r=PG&f=1", "display_name": "Revolver_Ocelot", "link": "https://stackoverflow.com/users/3410396/revolver-ocelot"}, "edited": false, "score": 3, "creation_date": 1470838334, "post_id": 38875369, "comment_id": 65113031, "body": "As your question mentions <i>typecasting pointers</i>, it is a good idea to read about <a href=\"http://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">strict aliacing</a>."}, {"owner": {"reputation": 8326, "user_id": 53089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525dac0c4812e8e8753935590b40ddb6?s=128&d=identicon&r=PG", "display_name": "Rob K", "link": "https://stackoverflow.com/users/53089/rob-k"}, "edited": false, "score": 0, "creation_date": 1470839097, "post_id": 38875369, "comment_id": 65113727, "body": "ESR wrote <a href=\"http://www.catb.org/esr/structure-packing/\" rel=\"nofollow noreferrer\">a good guide about alignment and structure packing</a> that will be of interest."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1470839439, "post_id": 38875369, "comment_id": 65114000, "body": "It is just amazing how such a question (no code, no demonstrated research effort, kinda broad) can have this score..."}, {"owner": {"reputation": 4326, "user_id": 4801801, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4Jzhl.jpg?s=128&g=1", "display_name": "shrike", "link": "https://stackoverflow.com/users/4801801/shrike"}, "edited": false, "score": 1, "creation_date": 1470841929, "post_id": 38875369, "comment_id": 65115878, "body": "You may have a look at <a href=\"http://www.catb.org/esr/structure-packing/\" rel=\"nofollow noreferrer\">this article</a> which explains in details how alignment works."}, {"owner": {"reputation": 6316, "user_id": 3323096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1227f90127f0f7b8678a8c13261f48b4?s=128&d=identicon&r=PG", "display_name": "Vality", "link": "https://stackoverflow.com/users/3323096/vality"}, "edited": false, "score": 0, "creation_date": 1470850349, "post_id": 38875369, "comment_id": 65121048, "body": "I am afraid I have to vote to close this. It is already very broad and asking about two different languages with extremely different rules and good practices in one question sends this way over the edge of not being answerable well in the format of this site."}, {"owner": {"reputation": 28015, "user_id": 63550, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/RIZKi.png?s=128&g=1", "display_name": "Peter Mortensen", "link": "https://stackoverflow.com/users/63550/peter-mortensen"}, "edited": false, "score": 0, "creation_date": 1470856164, "post_id": 38875369, "comment_id": 65124384, "body": "How is this not a duplicate 8 years after Stack Overflow was launched (and more than 12,000,000 questions)?"}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 4, "creation_date": 1470838148, "post_id": 38875464, "comment_id": 65112861, "body": "As per C11, there is <code>_Alignof</code> in C."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1470861277, "post_id": 38875464, "comment_id": 65127061, "body": "This is a superior answer for mentioning that alignment rules depending on architecture exist for either speed or necessity - mentioning both - whereas each of the other answers focuses only on one of the two, to such an extent that they downplay the other factor&#39;s importance almost to nil."}], "tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": false, "score": 15, "last_activity_date": 1470839109, "last_edit_date": 1470839109, "creation_date": 1470837312, "answer_id": 38875464, "question_id": 38875369, "link": "https://stackoverflow.com/questions/38875369/what-is-data-alignment-why-and-when-should-i-be-worried-when-typecasting-pointe/38875464#38875464", "title": "What is data alignment? Why and when should I be worried when typecasting pointers in C?", "body": "<p>This is \"implementation defined\", i.e. the alignment requirements are not part of the language specification.</p>\n\n<p>Different CPUs have different requirements on alignment. Some could not address a 16bit value on an uneven address, some could. Some could not address a floating point value unless aligned to an address divisible by its size, some could. And so on. Some would access misaligned data objects more slowly than properly aligned ones, others would trip over an unaligned access.</p>\n\n<p>That is why the language standard does not go into the details of which type needs to be aligned which way (because it couldn't), but left it to the \"implementation\" -- the compiler backend, in this case.</p>\n\n<p>If you typecast pointers, you might be forcing the code to address a given object at an address where it cannot be addressed. You need to ensure that the alignment requirements of the \"old\" type are <em>at least</em> as strict as those of the \"new\" type.</p>\n\n<p><strong>In C++</strong> (C++11 upwards), you get the <a href=\"http://en.cppreference.com/w/cpp/language/alignof\">alignof</a> operator to tell you the alignment requirements of a given type. You also get the <a href=\"http://en.cppreference.com/w/cpp/language/alignas\">alignas</a> operator to enforce a more strict alignment on a given type or object.</p>\n\n<p><strong>In C</strong> (C11 upwards), you get the <a href=\"http://en.cppreference.com/w/c/language/_Alignof\">_Alignof</a> and <a href=\"http://en.cppreference.com/w/c/language/_Alignas\">_Alignas</a> operators, which <code>&lt;stdalign.h&gt;</code> wraps into the <code>alignof</code> / <code>alignas</code> <a href=\"http://en.cppreference.com/w/c/types\">convenience macros</a>. (Thanks, Lundin -- C11 is not my forte.)</p>\n"}, {"comments": [{"owner": {"reputation": 23243, "user_id": 23118, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fab0965d392f9190012e9f8368c203d0?s=128&d=identicon&r=PG", "display_name": "hlovdal", "link": "https://stackoverflow.com/users/23118/hlovdal"}, "edited": false, "score": 1, "creation_date": 1470844436, "post_id": 38875518, "comment_id": 65117662, "body": "The gcc compiler has a <code>-Wcast-align</code> option to specificly warn against such errors."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1470861444, "post_id": 38875518, "comment_id": 65127130, "body": "<code>either the compiler will try to generate some fancy code to compose the word out of two memory accesses, but usually it is not the case.</code> Please define &quot;usually&quot;. x86 can handle unaligned accesses just fine for basic load/store instructions by aggregating reads/writes, <a href=\"http://stackoverflow.com/questions/12491578/whats-the-actual-effect-of-successful-unaligned-accesses-on-x86\">e.g. link</a>. And isn&#39;t x86 our usual reference point for terms like &quot;usual&quot;? What architectures were you talking about instead?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 2, "creation_date": 1470861959, "post_id": 38875518, "comment_id": 65127385, "body": "@underscore_d I will replace &quot;usually&quot; by &quot;it is not always the case&quot;. I am used to ARMs and lower-end MCUs, so they are usual to me."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 9, "last_activity_date": 1470861983, "last_edit_date": 1470861983, "creation_date": 1470837416, "answer_id": 38875518, "question_id": 38875369, "link": "https://stackoverflow.com/questions/38875369/what-is-data-alignment-why-and-when-should-i-be-worried-when-typecasting-pointe/38875518#38875518", "title": "What is data alignment? Why and when should I be worried when typecasting pointers in C?", "body": "<p>Some systems can access memory in portions of, say, 32-bit words (4 bytes). It's a hardware limitation. It means that the actual address going into the memory controller should be divisible by four (as it is still addressing the bytes). So once you try to have a word located at address which is not divisible by four, there ate two options - either the compiler will try to generate some fancy code to compose the word out of two memory accesses, but it is not always the case. Sometimes it will just generate a code to access 4 bytes out of the given address. And then the <em>processor</em> will fail with the data alignment error.</p>\n\n<p>Which leads to limitation the language is imposing.</p>\n\n<p>Consider the code (a bad one):</p>\n\n<pre><code>uint8_t a[] = {1,2,3,4,5,6};\nuint32_t b = *(uint32_t*)&amp;a[1];\n</code></pre>\n\n<p>and assume <code>a</code> is aligned to the divisible by four boundary.\nThen the second line is trying to read a word out of an address of it's <em>second</em> element, i.e. an address <em>not</em> divisible by four. It will lead to the alignment error. But in <code>C</code> it is simply forbidden by the <em>strict aliasing rule</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 5, "creation_date": 1470861057, "post_id": 38875855, "comment_id": 65126933, "body": "<code>This is done for performance reasons (99% of times).</code> IMO should immediately be followed by the disclaimer that 99% of statistics are fabricated on the spot, then a precise explanation of the possible reasons that account for the other &#39;1%&#39;. Like unaligned accesses causing trap representations, hardware exceptions, etc. Saying this is mostly about speed without explaining other, often more important reasons is barely any better than saying it&#39;s entirely about speed, which would be false."}], "tags": [], "owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "is_accepted": true, "score": 35, "last_activity_date": 1470859610, "last_edit_date": 1592644375, "creation_date": 1470838295, "answer_id": 38875855, "question_id": 38875369, "link": "https://stackoverflow.com/questions/38875369/what-is-data-alignment-why-and-when-should-i-be-worried-when-typecasting-pointe/38875855#38875855", "title": "What is data alignment? Why and when should I be worried when typecasting pointers in C?", "body": "<p>I'll try to explain in short.</p>\n<h1>What is data alignment?</h1>\n<p>The architecture in you computer is composed of processor and memory.\nMemory is organized in cells, so:</p>\n<pre><code> 0x00 |   data  |  \n 0x01 |   ...   |\n 0x02 |   ...   |\n</code></pre>\n<p>Each memory cell has a specified size, amount of bits it can store. This is architecture dependent.</p>\n<p>When you define a variable in your C/C++ program, one <em>or more</em> different cells are occupied by your program.</p>\n<p>For example</p>\n<pre><code>int variable = 12;\n</code></pre>\n<p>Suppose each cell contains 32 bits and the <code>int</code> type size is 32 bits, then in somewhere in your memory:</p>\n<pre><code>variable: | 0 0 0 c |  // c is hexadecimal of 12.\n</code></pre>\n<p>When your CPU has to operate on that variable it needs to bring it inside its register. A CPU can take in &quot;<em>1 clock</em>&quot; a small amount of bit from the memory, that size is usually called <em>WORD</em>. This dimension is architecture dependent as well.</p>\n<p>Now suppose you have a variable which is stored, because of some offset, in two cells.</p>\n<p>For example I have two different pieces data to store (I'm going to use a &quot;<em>string representation to make more clear</em>&quot;):</p>\n<pre><code>data1: &quot;ab&quot;\ndata2: &quot;cdef&quot;\n</code></pre>\n<p>So the memory will be composed in that way (2 different cells):</p>\n<pre><code>|a b c d|     |e f 0 0|\n</code></pre>\n<p>That is, <code>data1</code> occupies just half of the cell, so <code>data2</code> occupies the remaining part and a part of a second cell.</p>\n<p>Now suppose you CPU wants to read <code>data2</code>. The CPU needs <em>2 clocks</em> in order to access the data, because within one clock it reads the first cell and within the other clock it reads the remaining part in the second cell.</p>\n<p>If we <em>align</em> <code>data2</code> in accordance with this memory-example, we can\nintroduce a sort of <em>padding</em> and shift <code>data2</code> all in the second cell.</p>\n<pre><code>|a b 0 0|     |c d e f|\n     ---\n   padding\n</code></pre>\n<p>In that way the CPU will lose only &quot;<em>1 clock</em>&quot; in order to access to <code>data2</code>.</p>\n<h1>What an align system does</h1>\n<p>An align system just introduces that <em>padding</em> in order to align the data with the memory of the system, remember in accordance with the architecture. When the data is aligned in the memory you don't waste CPU cycles in order to access the data.</p>\n<p>This is done for performance reasons (99% of times).</p>\n"}], "owner": {"reputation": 523, "user_id": 6250057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1010949318993077/picture?type=large", "display_name": "Dogus Ural", "link": "https://stackoverflow.com/users/6250057/dogus-ural"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8927, "favorite_count": 11, "closed_date": 1470859960, "accepted_answer_id": 38875855, "answer_count": 3, "score": 28, "last_activity_date": 1512329667, "creation_date": 1470837047, "last_edit_date": 1470856000, "question_id": 38875369, "link": "https://stackoverflow.com/questions/38875369/what-is-data-alignment-why-and-when-should-i-be-worried-when-typecasting-pointe", "closed_reason": "Duplicate", "title": "What is data alignment? Why and when should I be worried when typecasting pointers in C?", "body": "<p>I couldn't find a decent document that explains how the alignment system works and why some types are more strictly aligned than the others.</p>\n"}, {"tags": ["c", "gcc", "declaration"], "answers": [{"comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1470833593, "post_id": 38873868, "comment_id": 65109400, "body": "<code>Reading values of uninitialized variables is undefined behavior.</code> No; only if they can contain trap-representations, such as floats. You might get undefined <i>results</i>, though."}, {"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1470833704, "post_id": 38873868, "comment_id": 65109484, "body": "@wildplasser hm I think on SO reading values of uninitialized variables is commonly referred as UB: <a href=\"http://stackoverflow.com/documentation/c/364/undefined-behavior/2576/reading-an-uninitialized-object-that-is-not-backed-by-memory#t=201608101257444574981\">stackoverflow.com/documentation/c/364/undefined-behavior/257&zwnj;&#8203;6/&hellip;</a>"}, {"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1470833845, "post_id": 38873868, "comment_id": 65109586, "body": "@wildplasser where is dereference mentioned?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1470833950, "post_id": 38873868, "comment_id": 65109665, "body": "In the &quot;article&quot; you linked to. (it is even the title)"}, {"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1470833962, "post_id": 38873868, "comment_id": 65109677, "body": "@wildplasser check it once again"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1470834379, "post_id": 38873868, "comment_id": 65109988, "body": "I see. It <i>could</i> be a wrong interpretation of The Standard, though. (the docs are only a few days old)"}, {"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1470834451, "post_id": 38873868, "comment_id": 65110036, "body": "@wildplasser <a href=\"http://stackoverflow.com/questions/11233602/what-will-be-the-value-of-uninitialized-variable\" title=\"what will be the value of uninitialized variable\">stackoverflow.com/questions/11233602/&hellip;</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1470834768, "post_id": 38873868, "comment_id": 65110286, "body": "@wildplasser, if an object with automatic storage duration has no initializer then its initial value is indeterminate.  The standard specifies that one of the ways a program has undefined behavior is if &quot;The value of an object with automatic storage duration is used while it is indeterminate.&quot;  (C2011, J.2)  The analysis doesn&#39;t reach the question of whether the value is a trap representation."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1470835012, "post_id": 38873868, "comment_id": 65110472, "body": "It must have been changed since C99. I stand corrected. The trap-reprentation was the rationale in the older standard, IIRC."}], "tags": [], "owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "is_accepted": false, "score": 3, "last_activity_date": 1505363757, "last_edit_date": 1505363757, "creation_date": 1470833201, "answer_id": 38873868, "question_id": 38873800, "link": "https://stackoverflow.com/questions/38873800/why-gcc-didnt-print-0-consistenly-after-a-declaration-int/38873868#38873868", "title": "Why gcc didn&#39;t print 0 consistenly after a declaration int", "body": "<pre><code>int num;\nprintf(\"%d\\n\", num);\n\nint* num2;\nprintf(\"%p\\n\", num2);\n</code></pre>\n\n<p>In both cases above you are reading values of uninitialized variables (in one case this variable is simple integer, in other case pointer - but like I said in both cases their values are not initialized).</p>\n\n<p>Local variables are not initialized by default.</p>\n\n<p>Reading values of uninitialized variables is <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>This was fine</p>\n\n<pre><code>int* num2;\nprintf(\"%p\\n\", &amp;num2);\n</code></pre>\n\n<p>because <code>&amp;num</code> is address of <code>num</code> pointer - it has defined value.\nThough more correct is to use:  </p>\n\n<pre><code>   printf(\"%p\\n\", (void*) &amp;num2);\n</code></pre>\n\n<p>In other cases too where you use <code>%p</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2630, "user_id": 4065269, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/90c9cd69a6663c31758d6cd6043dfcc3?s=128&d=identicon&r=PG&f=1", "display_name": "sps", "link": "https://stackoverflow.com/users/4065269/sps"}, "is_accepted": false, "score": 1, "last_activity_date": 1471192348, "last_edit_date": 1471192348, "creation_date": 1470833235, "answer_id": 38873883, "question_id": 38873800, "link": "https://stackoverflow.com/questions/38873800/why-gcc-didnt-print-0-consistenly-after-a-declaration-int/38873883#38873883", "title": "Why gcc didn&#39;t print 0 consistenly after a declaration int", "body": "<p><code>local</code> variables without <code>static</code> keyword have <code>automatic</code> storage duration.<code>num</code> is one such variable.</p>\n\n<p>And reading a value of a varibale with <code>automatic</code> storage <strong>before</strong> assigning any value to it can result in anything. So you cannot expect some determinate output.</p>\n\n<p>And yes, as your code is, what you are doing with the variable <code>num2</code> and its value HAS NOTHING TO DO WITH the variable <code>num</code>. But <code>num2</code> and <code>num</code> can be relaed if you do <code>num2 = &amp;num;</code>, after which what you you assign to <code>*num2</code> will impact the value of <code>num</code>.</p>\n"}], "owner": {"reputation": 1212, "user_id": 565739, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c0ade41cedf94f802407d52c7956ad18?s=128&d=identicon&r=PG", "display_name": "user565739", "link": "https://stackoverflow.com/users/565739/user565739"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1505363757, "creation_date": 1470833025, "last_edit_date": 1495542399, "question_id": 38873800, "link": "https://stackoverflow.com/questions/38873800/why-gcc-didnt-print-0-consistenly-after-a-declaration-int", "title": "Why gcc didn&#39;t print 0 consistenly after a declaration int", "body": "<p>With the following code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n\n    int num;\n    printf(\"%d\\n\", num);\n\n    int* num2;\n    printf(\"%p\\n\", &amp;num2);\n\n    return 0;\n}\n</code></pre>\n\n<p>I got result like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7E3EL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7E3EL.png\" alt=\"enter image description here\"></a></p>\n\n<p>From <a href=\"https://stackoverflow.com/questions/1597405/what-happens-to-a-declared-uninitialized-variable-in-c-does-it-have-a-value\">Memory allocation for global and local variables</a>,\nI know the global variable <code>num</code> is initialized to <code>0</code> implicitly,\neven it is not initialized by me.</p>\n\n<p>Now I am just trying something randomly, so I change the code to</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n\n    int num;\n    printf(\"%d\\n\", num);\n\n    int* num2;\n    printf(\"%p\\n\", num2);\n\n    return 0;\n}\n</code></pre>\n\n<p>and now I get</p>\n\n<p><a href=\"https://i.stack.imgur.com/zdYTe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zdYTe.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Question:</strong> I don't know WHY the value of <code>num</code> is no longer <code>0</code>.</p>\n\n<p>In my opinion, what I am doing with the variable <code>num2</code> and its value HAS\nNOTHING TO DO WITH the variable <code>num</code>.</p>\n\n<p>I am not only interested why, but also want to hear your opinions\nabout this behavior.</p>\n"}, {"tags": ["c", "overflow"], "comments": [{"owner": {"reputation": 1248, "user_id": 1791872, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6nnz7.png?s=128&g=1", "display_name": "flau", "link": "https://stackoverflow.com/users/1791872/flau"}, "edited": false, "score": 1, "creation_date": 1470833177, "post_id": 38873672, "comment_id": 65109050, "body": "This question is almost identical to the one you asked an hour ago <a href=\"http://stackoverflow.com/questions/38871531/\">stackoverflow.com/questions/38871531</a>"}, {"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "reply_to_user": {"reputation": 1248, "user_id": 1791872, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6nnz7.png?s=128&g=1", "display_name": "flau", "link": "https://stackoverflow.com/users/1791872/flau"}, "edited": false, "score": 0, "creation_date": 1470833298, "post_id": 38873672, "comment_id": 65109163, "body": "Yes sorry , I was just trying to write it in a more specific and easier to solve form, as people miss understood what&#39;s going on"}, {"owner": {"reputation": 1248, "user_id": 1791872, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6nnz7.png?s=128&g=1", "display_name": "flau", "link": "https://stackoverflow.com/users/1791872/flau"}, "edited": false, "score": 3, "creation_date": 1470833327, "post_id": 38873672, "comment_id": 65109180, "body": "You can edit your old answer instead of posting several identical ones."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470834952, "post_id": 38873672, "comment_id": 65110426, "body": "And you can delete this duplicate question, to save us the trouble of closing it as a dupe."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1470835169, "post_id": 38873672, "comment_id": 65110606, "body": "It&#39;s no trouble at all, closed. @MohammedAl-Huneidi Whenever you need to clarify a question or add additional info, always edit the original question."}], "owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "closed_date": 1470834990, "answer_count": 0, "score": 0, "last_activity_date": 1470832699, "creation_date": 1470832699, "question_id": 38873672, "link": "https://stackoverflow.com/questions/38873672/c-overflow-when-getting-data-from-stdin", "closed_reason": "Duplicate", "title": "C Overflow when getting data from STDIN", "body": "<p>I'm new to C programming and I've been writing a virtual computer program that takes input from STDIN , the inputs basically represents commands that task the Virtual computer to perform a multiple of a certain number check - just simple stuff. Essentially when I first wrote this program I was reading my input from a file using file pointers, but then when I switched my stream to STDIN it started getting weird.</p>\n\n<p>The interesting thing about this STDIN is that it's a file stream redirection, so I am still providing a file in command line argument , but since I use a coding platform that has a command that allows file redirection without having to implement an actual file pointer it's getting me confused. </p>\n\n<p>I started getting overflow errors that did not occur when I used to have file pointers to the programs that are being provided in the command line argument, I have no idea why as I have just switched my <code>fscanf</code> to a <code>gets</code>, and obviously deleted the file pointer stuff. I would greatly appreciate it if someone could point out to me what the problem could likely be, here is the function that I'm getting the overflow errors from:</p>\n\n<pre><code>int compile ( int memory [], int* instructionCounter , int* instructionRegister ,int*operationCode ,int* operand){\n    char s[800]; /* The buffer */\n    char temp[800];\n    *instructionRegister=0;\n    *operationCode=0;\n    while(gets(temp)){ /*Reads data line by line then stores the integer      returned by fscanf to instructionRegister pointer so that I can check for formating */\n\n    *instructionRegister=sscanf(temp,\"%2d %s %d\",operationCode,s,operand); \n       printf(\"%d %s %d\\n\",*operationCode,s,*operand);\n        if((*instructionRegister) ==3 ){ /*Checks for improper format by\n\n\n             comparing the current instructionRegister count to 3, returns improper format otherwise */\n            if(*operand &gt;9999|| *operand &lt;0){  /* Checks for word overflow in compiler, makes sure that digits do not exceed 9999 */\n                printf(\"attempts to place a word in memory that is larger than 4 digits, or attempted to pass in a negative value\\n \");\n                exit(0);\n            }\n            /*Compares the string section of the code and checks if it matches the following words and then it converts it to it's 4 digit value by adding into it the operand */\n            if(strcmp(s,\"READ\") == 0) {\n                memory[*operationCode] = 10 * 100 + *operand;\n            }\n            else if(strcmp(s,\"WRIT\") == 0) {\n                memory [*operationCode] = 11 * 100 + *operand;\n            }\n            else if(strcmp(s,\"LOAD\") ==0){\n                memory [*operationCode] = 20 * 100 + *operand;\n            }\n            else if(strcmp(s,\"PRNT\") ==0){\n                memory [*operationCode] = 12 * 100 + *operand;\n            }\n            else if(strcmp(s,\"STOR\") ==0){\n                memory [*operationCode] = 21 * 100 + *operand;\n            }\n            else if(strcmp(s,\"SET\") ==0){\n                memory [*operationCode] = *operand;\n            }\n            else if(strcmp(s,\"ADD\") ==0){\n                memory [*operationCode] = 30 * 100 + *operand;\n            }\n            else if(strcmp(s,\"SUB\") ==0){\n                memory [*operationCode] = 31 * 100 + *operand;\n            }\n            else if(strcmp(s,\"DIV\") ==0){\n                memory [*operationCode] = 32 * 100 + *operand;\n            }\n            else if(strcmp(s,\"MULT\") ==0){\n                memory [*operationCode] = 33 * 100 + *operand;\n            }\n            else if(strcmp(s,\"MOD\") ==0){\n               memory [*operationCode] = 34 * 100 + *operand;\n            }\n            else if(strcmp(s,\"BRAN\") ==0){\n            memory [*operationCode] = 40 * 100 + *operand;\n            }\n            else if(strcmp(s,\"BRNG\") ==0){\n            memory [*operationCode] = 41 * 100 + *operand;\n            }\n            else if(strcmp(s,\"BRZR\") ==0){\n            memory [*operationCode] = 42 * 100 + *operand;;\n            }\n            else if(strcmp(s,\"HALT\")==0){\n            memory [*operationCode] =9999;\n            }\n\n        else {   /* Prints back to the user that the compiler did not recognize one of them commands as it was going through it */\n            printf (\"This is an unknown command, commands are case sensitive, program will now exit \\n\");\n            exit(0);\n\n        }\n    }\n    else{    /* Returns improper format if instructionRegister does not match 3*/\n        printf(\"%d\",*instructionRegister);\n        printf(\"Improper Format, program will now exit \\n\");\n        exit(0);\n    }\n\n\n}\n/* Checks if the instruction data contains a HALT, if not it would terminate */\nwhile(*instructionCounter&lt;100){\n    if (memory[*instructionCounter] == 9999){\n        return 1;\n    }\n    else\n        (*instructionCounter)++;\n}\nprintf(\"Halt was not found, program will now exit\");\nexit (0); }\n</code></pre>\n\n<p>The stream of input looks something like this: (Like I mentioned above this stream is being redirected with a VIM command, it cheats the program into reading from files without having to actually implement file pointers)</p>\n\n<pre><code>01 READ 20\n02 LOAD 20\n03 BRNG 12\n04 STOR 30\n05 LOAD 60\n06 ADD 30\n07 STOR 60\n08 LOAD 50\n09 ADD 70\n10 STOR 70\n11 BRAN 01\n12 LOAD 60\n13 DIV 70\n14 STOR 80\n15 WRIT 80\n16 HALT 99\n50 SET 1\n60 SET 0\n70 SET 0\n</code></pre>\n\n<p>I have added a printf that prints out the contents being scanned to sscanf t the compiling process and here is what I get in the output , the first argument is operationCode an integer pointer ,2nd argument one is a string buffer s , third argument is operand which is an integer pointer) :</p>\n\n<pre><code>1 READ 20\n2 LOAD 20\n3 BRNG 12\n4 STOR 30\n5 LOAD 60\n6 ADD 30\n7 STOR 60\n8 LOAD 50\n9 ADD 70\n10 STOR 70\n11 BRAN 1\n12 LOAD 60\n13 DIV 70\n14 STOR 80\n15 WRIT 80\n16 HALT 99\n50 SET 1\n60 SET 0\n70 SET 0\nWord Overflow at memory element 70\n program will exit\n</code></pre>\n\n<p>I've been scratching my head for hours and I cannot figure out why it's doing that, as I said I'm new to C programming and I still don't know how to debug and do the C stuff, I came from a Java background.         </p>\n\n<p>Edit 1: The user does not write the program to the virtual computer, the programs are already written and the user just redirects with a STDIN  via a command in VIM like this     <code>(./computer &lt; prog1)</code> or     <code>(./computer &lt; prog2)</code>. The program should compile successfully, and then when the computer figures out what kind of a program it is , it will prompt the user for input depending on it's task. So it could ask the user to input values , then it would calculate their average if that was the program that was redirected to it.</p>\n"}, {"tags": ["c", "compiler-errors"], "comments": [{"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 0, "creation_date": 1470832102, "post_id": 38873404, "comment_id": 65108297, "body": "Isn&#39;t <code>enum</code> a reserved keyword?"}, {"owner": {"reputation": 1248, "user_id": 1791872, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6nnz7.png?s=128&g=1", "display_name": "flau", "link": "https://stackoverflow.com/users/1791872/flau"}, "edited": false, "score": 0, "creation_date": 1470832138, "post_id": 38873404, "comment_id": 65108316, "body": "Yes, it creates an enumeration."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 1, "creation_date": 1470832241, "post_id": 38873404, "comment_id": 65108385, "body": "@sunqingyao It is.  And it should be used to create an enumeration, like the OP does."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1470832282, "post_id": 38873404, "comment_id": 65108406, "body": "I have to ask, why to need values that are outside the range of (signed) int?"}, {"owner": {"reputation": 1180, "user_id": 4233968, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/34a8a28a578ed988cb3b7800cc79a867?s=128&d=identicon&r=PG&f=1", "display_name": "achoora", "link": "https://stackoverflow.com/users/4233968/achoora"}, "edited": false, "score": 0, "creation_date": 1470832438, "post_id": 38873404, "comment_id": 65108505, "body": "Its like returning an address at which we have the error handling/reporting routine for further processing."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1470832490, "post_id": 38873404, "comment_id": 65108554, "body": "Simply use and array of <code>uintptr_t</code> then... simple <code>enum</code> (0,1,2,3...) can be used for indexing the array."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1470832598, "post_id": 38873404, "comment_id": 65108625, "body": "@LPs, I think <code>uintptr_t</code> may be a better choice."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1470832640, "post_id": 38873404, "comment_id": 65108653, "body": "@StoryTeller Yes, really better ;)"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1470832846, "post_id": 38873404, "comment_id": 65108798, "body": "I&#39;ll just add that you could simply write your definition of both the enum and the table LPs suggested using <a href=\"https://en.wikibooks.org/wiki/C_Programming/Preprocessor#X-Macros\" rel=\"nofollow noreferrer\">X-macros</a>. That way you&#39;ll just have to update the <code>.def</code> file when you add a new one."}], "answers": [{"comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1470835394, "post_id": 38874223, "comment_id": 65110783, "body": "<code>Enumeration constants are guaranteed to be of the same size as (signed) int</code> The standard says: <code>Each enumerated type shall be compatible with char, a signed integer type, or an unsigned integer type. The choice of type is implementation-defined, but shall be capable of representing the values of all the members of the enumeration.</code> That sounds as a conflict to me."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 5, "creation_date": 1470835981, "post_id": 38874223, "comment_id": 65111203, "body": "@4386427 Indeed, that&#39;s part of the C language flaw I&#39;m talking about. An <i>enumeration constant</i> is guaranteed to be the same type as <code>int</code> (6.7.2.2/3), but an <i>enumeration type</i> (variable) could be any of the mentioned types (6.7.2.2/4). It is plain stupid, but it is a well-known flaw."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 4, "last_activity_date": 1470834532, "last_edit_date": 1470834532, "creation_date": 1470834124, "answer_id": 38874223, "question_id": 38873404, "link": "https://stackoverflow.com/questions/38873404/how-to-avoid-pedantic-warnings-while-using-hexadecimal-in-enum/38874223#38874223", "title": "How to avoid pedantic warnings while using Hexadecimal in Enum?", "body": "<p>Enumeration constants are guaranteed to be of the same size as (signed) <code>int</code>. Apparently your system uses 32 bit int, so an unsigned hex literal larger than 0x7FFFFFFF will not fit. </p>\n\n<p>So the warning is not just \"pedantic\", it hints of a possibly severe bug. Note that <code>-pedantic</code> in GCC does <em>not</em> mean \"be picky and give me unimportant warnings\" but rather \"ensure that my code actually follows the C standard\".</p>\n\n<p>It appears that you want to do a list of bit masks or hardware addresses, or some other hardware-related programming. <code>enum</code> is unsuitable for such tasks, because in hardware-related programming, you rarely ever want to use signed types, but always unsigned ones.</p>\n\n<p>If you must have a safe and portable program, then there is no elegant way to do this. C is a language with a lot of flaws, the way <code>enum</code> is defined by the standard is one of them.</p>\n\n<p>One work-around is to use some sort of \"poor man's enum\", such as:</p>\n\n<pre><code>typedef uint32_t STATUS;\n\n#define THIRD 0X80000001\n</code></pre>\n\n<p>If you must also have the increased type safety of an enum, then you could possibly use a struct:</p>\n\n<pre><code>typedef struct\n{\n  uint32_t value;\n} STATUS;\n</code></pre>\n\n<p>Or alternatively, just declare an array of constants and use an enum to define the array index. Probably the cleanest solution but takes a little bit of extra overhead:</p>\n\n<pre><code>typedef enum {   \n    FIRST,  \n    SECOND,  \n    THIRD,  \n    FOURTH,  \n    FIFTH,  \n    STATUS_N\n} STATUS; \n\nconst uint32_t STATUS_DATA [STATUS_N] =\n{\n  0,\n  1,\n  0X80000001,\n  0X80000002,\n  0X80000003\n};\n</code></pre>\n"}], "owner": {"reputation": 1180, "user_id": 4233968, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/34a8a28a578ed988cb3b7800cc79a867?s=128&d=identicon&r=PG&f=1", "display_name": "achoora", "link": "https://stackoverflow.com/users/4233968/achoora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 0, "accepted_answer_id": 38874223, "answer_count": 1, "score": 2, "last_activity_date": 1470834532, "creation_date": 1470831978, "last_edit_date": 1470832210, "question_id": 38873404, "link": "https://stackoverflow.com/questions/38873404/how-to-avoid-pedantic-warnings-while-using-hexadecimal-in-enum", "title": "How to avoid pedantic warnings while using Hexadecimal in Enum?", "body": "<p>I have an enum like this   </p>\n\n<pre><code>typedef enum {   \n    FIRST,  \n    SECOND,  \n    THIRD = 0X80000001,  \n    FOURTH,  \n    FIFTH,  \n} STATUS;  \n</code></pre>\n\n<p>I am getting a pedantic warning since I am compiling my files with the option <code>-Wpedantic</code>:</p>\n\n<blockquote>\n  <p>warning: ISO C restricts enumerator values to range of 'int' [-Wpedantic]</p>\n</blockquote>\n\n<p>I found that it occurs since when I convert the hex value <code>0X80000001</code> to integer it exceeds the unsigned integer limits. My purpose is to have continuous hex values as the status in the enum without this warning. \nI cannot use the macros since this will defy the purpose of having the enums in the first place. What code change will avoid this warning? </p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 9, "creation_date": 1470828998, "post_id": 38872327, "comment_id": 65106189, "body": "<code>std::sscanf</code> does not very much look like <code>C</code> to me."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1470829339, "post_id": 38872327, "comment_id": 65106433, "body": "How do you expect <code>-567</code> to be represented as an <i>unsigned</i> value?"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "reply_to_user": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "edited": false, "score": 4, "creation_date": 1470831450, "post_id": 38872327, "comment_id": 65107856, "body": "@stackptr <code>snscanf</code> has <i>nothing</i> to do with avoiding overflows."}, {"owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "reply_to_user": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1470831786, "post_id": 38872327, "comment_id": 65108083, "body": "@rustyx Sorry, got confused with <code>snprintf</code>"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "edited": false, "score": 1, "creation_date": 1470832081, "post_id": 38872327, "comment_id": 65108283, "body": "@stackptr <code>snprintf</code> has nothing to do with avoiding overflows :)"}, {"owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1470834231, "post_id": 38872327, "comment_id": 65109875, "body": "@AlterMann What do you mean? <a href=\"http://www.cplusplus.com/reference/cstdio/snprintf/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/cstdio/snprintf</a> &quot;If the resulting string would be longer than n-1 characters, the remaining characters are discarded and not stored, but counted for the value returned by the function.&quot;"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "edited": false, "score": 0, "creation_date": 1470834503, "post_id": 38872327, "comment_id": 65110079, "body": "@stackptr, restricts the <b>number of bytes to store</b>, not the maximum value assigned to a parameter"}], "answers": [{"comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 5, "creation_date": 1470829298, "post_id": 38872415, "comment_id": 65106411, "body": "<code>if(value&lt;0)</code> when <code>value</code> is declared as <code>unsigned int</code> is always false, isn&#39;t it?"}, {"owner": {"reputation": 1362, "user_id": 6386250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/brwvr.jpg?s=128&g=1", "display_name": "Dr.Haimovitz", "link": "https://stackoverflow.com/users/6386250/dr-haimovitz"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1470830155, "post_id": 38872415, "comment_id": 65106975, "body": "@AlterMann when i wrote value i meant is the input int type and not the unsigned int"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1470831490, "post_id": 38872415, "comment_id": 65107888, "body": "Ok, then you should declare <code>value</code> as <code>long int</code> to be in the range <code>0 - UINT_MAX</code> (overflow of <code>signed int</code> is undefined behaviour)"}], "tags": [], "owner": {"reputation": 1362, "user_id": 6386250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/brwvr.jpg?s=128&g=1", "display_name": "Dr.Haimovitz", "link": "https://stackoverflow.com/users/6386250/dr-haimovitz"}, "is_accepted": false, "score": 1, "last_activity_date": 1470842207, "last_edit_date": 1470842207, "creation_date": 1470829153, "answer_id": 38872415, "question_id": 38872327, "link": "https://stackoverflow.com/questions/38872327/how-to-use-scanf-unsigned-int/38872415#38872415", "title": "how to use scanf unsigned int", "body": "<p>This is because every negative value integere has its corrusponding unsigned integer value , if you want to check that a positive value was entered you will have to declare it as int type and check its value:</p>\n\n<pre><code>long int value:\nunsigned int value_ui;\nscanf(\"%ld\",&amp;value);\nif(value&lt;0) \n    printf(\"error\");\nelse\n    value_ui=(unsigned int) value;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1470829848, "creation_date": 1470829848, "answer_id": 38872645, "question_id": 38872327, "link": "https://stackoverflow.com/questions/38872327/how-to-use-scanf-unsigned-int/38872645#38872645", "title": "how to use scanf unsigned int", "body": "<p>Given your usage of <code>std::sscanf()</code>, you're actually using C++, not C.   But C++'s <code>sscanf()</code> behaves in largely the same way as in C.</p>\n\n<p>The specification of the <code>%u</code> format specifier allows a sign to be included.   Which would essentially mean modulo arithmetic will be employed.   Assuming a 32 <code>unsigned int</code> type, the result will be modulo <code>4294967296</code> to produce a value between <code>0</code> and <code>4294967295</code>.   <code>-567</code> modulo <code>4294967296</code> (aka the smallest positive remainder obtained on dividing <code>-567</code> by <code>4294967296</code>) is <code>4294966729</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 3, "creation_date": 1470830467, "post_id": 38872682, "comment_id": 65107162, "body": "Interesting. Who would have thought that <code>strtoul</code> is <i>specified</i> to happily eat negative integers?"}], "tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 5, "last_activity_date": 1470831142, "last_edit_date": 1470831142, "creation_date": 1470829944, "answer_id": 38872682, "question_id": 38872327, "link": "https://stackoverflow.com/questions/38872327/how-to-use-scanf-unsigned-int/38872682#38872682", "title": "how to use scanf unsigned int", "body": "<p>The <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.2p12\" rel=\"noreferrer\">C11 Standard states</a></p>\n\n<p><em>\"... whose format is the same as expected for the subject sequence of the <code>strtoul</code> function with the value 10 for the base argument ...\"</em></p>\n\n<p>and, <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.22.1.4p5\" rel=\"noreferrer\">for <code>strtoul</code></a></p>\n\n<p><em>\"... If the subject sequence begins with a minus sign, the value resulting from the conversion is negated ...\"</em></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    unsigned int value;\n    int res;\n\n    res = sscanf(\"-567\", \"%u\", &amp;value);\n    if (res == 1) {\n        printf(\"Value: %u\\n\", value);\n    } else {\n        fprintf(stderr, \"Error\\n\");\n    }\n\n    res = sscanf(\"567\", \"%u\", &amp;value);\n    if (res == 1) {\n        value = ~value + 1; // add 1 in two's complement machines\n        printf(\"Value: %u\\n\", value);\n    } else {\n        fprintf(stderr, \"Error\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 157, "user_id": 6281459, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RsTjpIbBuUw/AAAAAAAAAAI/AAAAAAAAABc/vxXoAJU08X4/photo.jpg?sz=128", "display_name": "Natesh Raina", "link": "https://stackoverflow.com/users/6281459/natesh-raina"}, "is_accepted": false, "score": 0, "last_activity_date": 1470834828, "last_edit_date": 1470834828, "creation_date": 1470834013, "answer_id": 38874181, "question_id": 38872327, "link": "https://stackoverflow.com/questions/38872327/how-to-use-scanf-unsigned-int/38874181#38874181", "title": "how to use scanf unsigned int", "body": "<p>If you go through the docs of <code>sscanf</code> function you will find that return type of <code>sscanf</code> is the number of variables filled which is essentially one in this case i.e. the variable <code>value</code>. Also <code>value</code> is showing a very large number because you are storing a negative integer in it and displaying it in unsigned integer format. This will lead to modulo arithmetic and final result will be (-567)%(<strong>max unsigned integer value</strong>). To put it in simple words, it would be two's complement of 567. If instead you had used %d format specifier for <code>value</code> it would have shown -567 only. For more details on <code>sscanf</code> usage refer following link:</p>\n\n<p>For C:<a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_sscanf.htm\" rel=\"nofollow\">http://www.tutorialspoint.com/c_standard_library/c_function_sscanf.htm</a></p>\n\n<p>For C++:<a href=\"http://www.cplusplus.com/reference/cstdio/sscanf/\" rel=\"nofollow\">http://www.cplusplus.com/reference/cstdio/sscanf/</a></p>\n"}], "owner": {"reputation": 47, "user_id": 6700100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db551a3c489e5ca16fc615d941d47f6?s=128&d=identicon&r=PG&f=1", "display_name": "DourSquid", "link": "https://stackoverflow.com/users/6700100/doursquid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22553, "favorite_count": 0, "answer_count": 4, "score": 3, "last_activity_date": 1470842207, "creation_date": 1470828892, "last_edit_date": 1470828980, "question_id": 38872327, "link": "https://stackoverflow.com/questions/38872327/how-to-use-scanf-unsigned-int", "title": "how to use scanf unsigned int", "body": "<p>I have the following</p>\n\n<pre><code> unsigned int value = 12;\n int res = std::sscanf(\"-567\", \"%u\", &amp;value);\n</code></pre>\n\n<p>When this is run res is 1 indicating 1 match and value is set to 4294966729\nWhereas I was expecting no matches to be made</p>\n\n<p>I would be grateful if someone could explain this behaviour.</p>\n"}, {"tags": ["c", "pointers", "structure"], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1470828829, "last_edit_date": 1470828829, "creation_date": 1470828122, "answer_id": 38872063, "question_id": 38872006, "link": "https://stackoverflow.com/questions/38872006/how-two-structures-can-work-in-this-way/38872063#38872063", "title": "How two structures can work in this way", "body": "<p>First of all, the first version, <strong><em>does</em></strong> warn you. with proper compiler options enabled, you'll see</p>\n\n<blockquote>\n  <p>source_file.c: In function \u2018main\u2019:<br>\n  source_file.c:30:5: warning: passing argument 1 of \u2018fun\u2019 from incompatible pointer type<br></p>\n\n<pre><code>fun(&amp;var1);//passing 'anna' type pointer\n ^\n</code></pre>\n  \n  <p>source_file.c:16:6: note: expected \u2018struct bob *\u2019 but argument is of type \u2018struct anna *\u2019</p>\n\n<pre><code>void fun(bob *var2)\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>That said, in the first version of the code</p>\n\n<blockquote>\n  <p><em>//expecting 'bob' type variable</em></p>\n</blockquote>\n\n<p>is wrong!! Its ought to be (<em>follow emphasis</em>)</p>\n\n<blockquote>\n  <p><em>//expecting a <strong>pointer to</strong> 'bob' type variable</em></p>\n</blockquote>\n\n<p>As per C rules, a pointer to a type <em>can be</em> converted to another type, but the result is not always defined. So, the first version of the code compiler (with warnings) and runs.</p>\n\n<p>OTOH, in the second case, <code>anna</code> and <code>bob</code> are different types, so the inter-change is not possible while passing the argument and receiving the parameter. To the compiler, they are different types and compiler behaves accordingly.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1470829848, "last_edit_date": 1495542787, "creation_date": 1470829848, "answer_id": 38872646, "question_id": 38872006, "link": "https://stackoverflow.com/questions/38872006/how-two-structures-can-work-in-this-way/38872646#38872646", "title": "How two structures can work in this way", "body": "<p><em>Answer for beginner/intermediately experienced:</em></p>\n\n<p>Any two structure types in C with different type names are not compatible types. No matter if they happen to have the same member variables. Similarly, pointers to different structure types are not compatible. So your types \"bob\" and \"anna\" are not compatible, and using them like you attempt is formally not safe nor well-defined.</p>\n\n<p>Simply refrain from doing things like this, you will end up writing subtle bugs.</p>\n\n<hr>\n\n<p><em>Answer for veterans:</em></p>\n\n<p>Despite the type compatibility rules mentioned above, C (but not C++) allows some tricks to let you use one memory region in several different ways, no matter the type of the variables stored there. This is known as \"type punning\". Most often type punning is done through <code>union</code>, for example:</p>\n\n<pre><code>typedef struct\n{\n  bob b;\n  anna a;\n} bobanna;\n</code></pre>\n\n<p>If you would use a pointer to a type like the one above, you are actually allowed to assume that either of the two types can be used, but only because in this case, all the involved struct/union members contain (recursively) the very same types. For example, code like this is fine:</p>\n\n<pre><code>void fun (bobanna *var)\n{\n  bob* b = var.b;\n  b.c = something;\n}\n\nbobanna ba = {.anna.c = 1 };\nfun(&amp;ba);\n</code></pre>\n\n<p>Please note that type punning is an advanced topic. It is very easy to do things like this in the wrong way - I would not recommend to even consider the above trick if you don't already know about <em>pointer aliasing</em> and <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\"><em>the strict aliasing rule</em></a>.</p>\n"}], "owner": {"reputation": 95, "user_id": 6599345, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/761d2bd810bfeddaa684a76459112e89?s=128&d=identicon&r=PG&f=1", "display_name": "pointer accurate", "link": "https://stackoverflow.com/users/6599345/pointer-accurate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1470833687, "creation_date": 1470827959, "last_edit_date": 1470833687, "question_id": 38872006, "link": "https://stackoverflow.com/questions/38872006/how-two-structures-can-work-in-this-way", "title": "How two structures can work in this way", "body": "<p>The below program is having two structures. I don't understand how I can pass value from one structure variable to another structure variable while using pointers</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct {\n int c;\n char d;\n}bob;\n\ntypedef struct {\nint c;\nchar d;\n}anna;\n\n//expecting 'bob' type variable\nvoid fun(bob *var2)\n{\n\nprintf(\"var2-&gt;c=%d\\n\",var2-&gt;c);\nprintf(\"var2-&gt;d=%c\\n\",var2-&gt;d);\n\n}\n\nint main()\n\n{\nanna var1;\nvar1.c=2;\nvar1.d='c';\nfun(&amp;var1);//passing 'anna' type pointer\nreturn 0;\n}\n</code></pre>\n\n<p>...but if I change the program to pass values using normal variables, it gives compilation error.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct {\n int c;\n char d;\n}bob;\n\ntypedef struct {\nint c;\nchar d;\n}anna;\n\n//expecting a variable of type 'bob'\nvoid fun(bob var2)\n{\n\nprintf(\"var2.c=%d\\n\",var2.c);\nprintf(\"var2.d=%c\\n\",var2.d);\n\n}\n\nint main()\n\n{\nanna var1;\nvar1.c=2;\nvar1.d='c';\nfun(var1);//passing a variable of type 'anna'\nreturn 0;\n}\n</code></pre>\n\n<p>What is the logic behind this?</p>\n"}, {"tags": ["c", "string", "input", "scanf"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1470827784, "post_id": 38871930, "comment_id": 65105365, "body": "Also see: <a href=\"http://stackoverflow.com/questions/8004237/how-do-i-properly-compare-strings-in-c\">How do I properly compare strings in C?</a>"}, {"owner": {"reputation": 1, "user_id": 6626044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80de4302c9c26414ed0eb33ca6a257b3?s=128&d=identicon&r=PG&f=1", "display_name": "C. Johnson", "link": "https://stackoverflow.com/users/6626044/c-johnson"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1470828455, "post_id": 38871930, "comment_id": 65105821, "body": "This question is not duplicate, the link you put mentions completely different thing."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6626044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80de4302c9c26414ed0eb33ca6a257b3?s=128&d=identicon&r=PG&f=1", "display_name": "C. Johnson", "link": "https://stackoverflow.com/users/6626044/c-johnson"}, "edited": false, "score": 0, "creation_date": 1470828526, "post_id": 38871955, "comment_id": 65105864, "body": "thank you for your reply, is it possible to get input of a single line and put it to each cell, with an easier way ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 1, "user_id": 6626044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80de4302c9c26414ed0eb33ca6a257b3?s=128&d=identicon&r=PG&f=1", "display_name": "C. Johnson", "link": "https://stackoverflow.com/users/6626044/c-johnson"}, "edited": false, "score": 0, "creation_date": 1470828915, "post_id": 38871955, "comment_id": 65106118, "body": "@C.Johnson The only way to get multiple lines of input, each line written into its own string, is with a loop. So no there&#39;s really no other way to do it."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1470828163, "last_edit_date": 1470828163, "creation_date": 1470827808, "answer_id": 38871955, "question_id": 38871930, "link": "https://stackoverflow.com/questions/38871930/c-how-to-get-strings-when-user-press-space/38871955#38871955", "title": "C how to get strings when user press space", "body": "<p>That's because <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow\"><code>scanf</code> (and family)</a> with the <code>\"%s\"</code> format only reads space <em>delimited</em> words. To get a whole line you should use <a href=\"http://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow\"><code>fgets</code></a> instead.</p>\n\n<p>Do note that <code>fgets</code> puts the ending newline in the buffer you provide (if it can fit)</p>\n\n<hr>\n\n<p>Also, you definitely need to allocate memory for the strings first. The code you show seems to tell us that you don't initialize the array <code>test</code> which means you either have an array of null pointers (if <code>test</code> is a global variable) or have pointers being <em>indeterminate</em> (if <code>test</code> is a local variable. Both of these will lead to <em>undefined behavior</em>.</p>\n\n<p>Depending on platform, you might have a function available called <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html\" rel=\"nofollow\"><code>getline</code></a> which allows you to read lines, and also allocates memory for you. As with <code>fgets</code> the ending newline will be added to the buffer.</p>\n\n<hr>\n\n<p>Lastly, you can't compare string using the <code>==</code> operator, it will only compare the <em>pointers</em> and not what they point to. Therefore comparing using <code>==</code> will almost always be false, unless both pointers point to the same memory.</p>\n\n<p>To compare string you should use the <a href=\"http://en.cppreference.com/w/c/string/byte/strcmp\" rel=\"nofollow\"><code>strcmp</code></a> function.</p>\n"}], "owner": {"reputation": 1, "user_id": 6626044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80de4302c9c26414ed0eb33ca6a257b3?s=128&d=identicon&r=PG&f=1", "display_name": "C. Johnson", "link": "https://stackoverflow.com/users/6626044/c-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "closed_date": 1470827873, "answer_count": 1, "score": -1, "last_activity_date": 1470828163, "creation_date": 1470827718, "last_edit_date": 1470827795, "question_id": 38871930, "link": "https://stackoverflow.com/questions/38871930/c-how-to-get-strings-when-user-press-space", "closed_reason": "Duplicate", "title": "C how to get strings when user press space", "body": "<p>I want to get string elements with space. Let's say I have a string called test and user will enter something in every cell, for instance he will enter colors he will enter the colors in a single line like; Green Yellow Blue Black - then he will press enter then program take everything until the space entered and put it on the first element of string then continues. In this case the string should be according to;</p>\n\n<pre><code>test[0] \"Green\"\ntest[1] \"Yellow\"\ntest[2] \"Blue\"\ntest[3] \"Black\"\n</code></pre>\n\n<p>I have tried to write it with 2 nested loops but I couldn't manage to get strings with space</p>\n\n<pre><code>long i\nchar* test[4]\n\n\nprintf(\"Enter your guess:\\n\");\nfor(i=0;i&lt;5;i++)\n{\n    while(test[i]!=\" \")\n    {\n        scanf(\"%s\", test[i]);\n    }\n\n\n\n}\n</code></pre>\n"}, {"tags": ["c", "integer", "long-integer", "c99", "unsigned-long-long-int"], "comments": [{"owner": {"reputation": 239, "user_id": 5981113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402d54df630177d975611af7cc741f9b?s=128&d=identicon&r=PG&f=1", "display_name": "ABuckau", "link": "https://stackoverflow.com/users/5981113/abuckau"}, "edited": false, "score": 0, "creation_date": 1470828714, "post_id": 38871847, "comment_id": 65105973, "body": "To make a small value be in a large type? Ex. 0 as long long. Maybe doesn&#39;t answer your question, but is example."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "reply_to_user": {"reputation": 239, "user_id": 5981113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402d54df630177d975611af7cc741f9b?s=128&d=identicon&r=PG&f=1", "display_name": "ABuckau", "link": "https://stackoverflow.com/users/5981113/abuckau"}, "edited": false, "score": 0, "creation_date": 1470830754, "post_id": 38871847, "comment_id": 65107358, "body": "@ABuckau That&#39;s indeed an example of what it does. But when you use it in an expression with different integer types of equal signedness, such values will be converted to a common type (section 6.3.1.8, clause 1 for more precise wording). Something similar happens when you use it as an initialiser, or on the right hand side of a simple assignment. I still don&#39;t see why you&#39;d <i>need</i> it."}, {"owner": {"reputation": 8116, "user_id": 909655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70d8d9d24942b0fe339ecedeb2c4c5e7?s=128&d=identicon&r=PG", "display_name": "Mats", "link": "https://stackoverflow.com/users/909655/mats"}, "edited": false, "score": 0, "creation_date": 1470832560, "post_id": 38871847, "comment_id": 65108596, "body": "Compare <code>~0ull</code> and <code>~0</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "reply_to_user": {"reputation": 8116, "user_id": 909655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70d8d9d24942b0fe339ecedeb2c4c5e7?s=128&d=identicon&r=PG", "display_name": "Mats", "link": "https://stackoverflow.com/users/909655/mats"}, "edited": false, "score": 0, "creation_date": 1470838363, "post_id": 38871847, "comment_id": 65113055, "body": "@Mats That&#39;s a decent example of where the difference matters, but it&#39;s not clear to me why you&#39;d want to write <code>~0ull</code> instead of the much more descriptive <code>ULLONG_MAX</code> (which is the exact same thing)."}, {"owner": {"reputation": 8116, "user_id": 909655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70d8d9d24942b0fe339ecedeb2c4c5e7?s=128&d=identicon&r=PG", "display_name": "Mats", "link": "https://stackoverflow.com/users/909655/mats"}, "edited": false, "score": 6, "creation_date": 1470839893, "post_id": 38871847, "comment_id": 65114374, "body": "This seems to have been asked before: <a href=\"http://stackoverflow.com/questions/13134956/\">stackoverflow.com/questions/13134956</a>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1471079989, "post_id": 38871847, "comment_id": 65218439, "body": "There are a number of instances where they are required or provide clarity in bitwise operations, etc."}], "owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "closed_date": 1471080211, "answer_count": 0, "score": 1, "last_activity_date": 1471078683, "creation_date": 1470827533, "last_edit_date": 1471078683, "question_id": 38871847, "link": "https://stackoverflow.com/questions/38871847/are-the-l-and-ll-integer-suffixes-ever-needed", "closed_reason": "Duplicate", "title": "Are the L and LL integer suffixes ever needed?", "body": "<p>From <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf\" rel=\"nofollow\">the standard draft N1256</a>, section 6.4.4.1, clause 5:</p>\n\n<blockquote>\n  <p>The type of an integer constant is the first of the corresponding list in which its value can be represented.</p>\n</blockquote>\n\n<p>From the table, it seems that octal and hexadecimal constants without suffixes will be assigned any standard integer type (the smallest suitable combination of <code>signed</code>/<code>unsigned</code> and <code>int</code>/<code>long int</code>/<code>long long int</code>). For decimal constants, only the <code>signed</code> types will be considered by default.</p>\n\n<p>It makes sense to me why <code>u</code>/<code>U</code> exist; signed overflow behaviour is different from unsigned overflow behaviour at best, and UB at worst, so I guess it may be necessary to specify the unsignedness of a literal in complicated expressions.</p>\n\n<p>This leaves us with the <code>L</code>/<code>l</code> and <code>LL</code>/<code>ll</code> suffixes. They can only be used to select the lower bound of the type of integer literals. What practical purpose does that serve in C99?</p>\n"}, {"tags": ["c", "cpu-usage", "static-linking", "memory-footprint", "static-allocation"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1470828191, "post_id": 38871700, "comment_id": 65105656, "body": "Compile and run it on a RaspberryPi and maybe use gprof on it?"}, {"owner": {"reputation": 22367, "user_id": 1057909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93a3df0a806e7301ce9b92d0705646ac?s=128&d=identicon&r=PG", "display_name": "ams", "link": "https://stackoverflow.com/users/1057909/ams"}, "edited": false, "score": 1, "creation_date": 1470828716, "post_id": 38871700, "comment_id": 65105977, "body": "Raspberry Pi uses ARM11 and undoubtedly a different system architecture, memory, etc. If you find it&#39;s no good on ARM11 then I suppose that&#39;s useful, but otherwise you&#39;ve learned nothing about ARM9."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1470901677, "post_id": 38871700, "comment_id": 65140567, "body": "Please clarify your question. You say <i>&quot;For memory footprint, I build a tiny application on my i386 machine...&quot;</i>, but do you build <b>for</b> i386 or ARM9?"}], "answers": [{"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1470896815, "post_id": 38872199, "comment_id": 65137710, "body": "Are you saying that compiling library on not-ARM system would give reasonable estimation of how big the library is on ARM system? That doesn&#39;t sound right at all: Compiling with 2 different compilers for the same architecture can yield 2 completely different memory sizes. It&#39;s even worse when comparing to 2 different architectures."}, {"owner": {"reputation": 22367, "user_id": 1057909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93a3df0a806e7301ce9b92d0705646ac?s=128&d=identicon&r=PG", "display_name": "ams", "link": "https://stackoverflow.com/users/1057909/ams"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1470899702, "post_id": 38872199, "comment_id": 65139324, "body": "No, of course I&#39;m not saying that. That would be absurd. Why would you even think of that?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1470901277, "post_id": 38872199, "comment_id": 65140338, "body": "<i>&quot;For memory footprint, I build a tiny application on my i386 machine&quot;</i> and <i>&quot;Your memory estimate sounds pretty good to me.&quot;</i>"}, {"owner": {"reputation": 22367, "user_id": 1057909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93a3df0a806e7301ce9b92d0705646ac?s=128&d=identicon&r=PG", "display_name": "ams", "link": "https://stackoverflow.com/users/1057909/ams"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1470905955, "post_id": 38872199, "comment_id": 65143116, "body": "You&#39;re right, I only <i>assumed</i> he meant he cross-compiled it. I&#39;ll edit the answer."}, {"owner": {"reputation": 5400, "user_id": 364365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ebd7951248c6d4d2f2f0bd92f18fec7?s=128&d=identicon&r=PG", "display_name": "Frode", "link": "https://stackoverflow.com/users/364365/frode"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1470937088, "post_id": 38872199, "comment_id": 65164222, "body": "ams &amp; @user694733 , many thanks for your input, it&#39;s greatly appreciated. Yes, I actually built the &quot;estimation application&quot; on my i386 machine, compiled for i386. I have no ARM board yet, I was asked for these estimates before we&#39;d acquire anything. My theory was that the i386 binary would at least give me a ballpark figure about the footprint. I do have a lot of zero-initialized storage (basically a statically allocated database of sorts), so I&#39;ll go hunt for an ARM board."}, {"owner": {"reputation": 5400, "user_id": 364365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ebd7951248c6d4d2f2f0bd92f18fec7?s=128&d=identicon&r=PG", "display_name": "Frode", "link": "https://stackoverflow.com/users/364365/frode"}, "edited": false, "score": 0, "creation_date": 1470937266, "post_id": 38872199, "comment_id": 65164319, "body": "Hmm, on a second thought, I can just emulate an ARM9 box with QEMU, no? Hurrah for learning new things!"}, {"owner": {"reputation": 22367, "user_id": 1057909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93a3df0a806e7301ce9b92d0705646ac?s=128&d=identicon&r=PG", "display_name": "ams", "link": "https://stackoverflow.com/users/1057909/ams"}, "edited": false, "score": 1, "creation_date": 1470937548, "post_id": 38872199, "comment_id": 65164460, "body": "Yep, install QEMU on Ubuntu, for example, and ARM binaries run on x86 seamlessly. Other distros might need you to run QEMU explicitly, without additional config."}], "tags": [], "owner": {"reputation": 22367, "user_id": 1057909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93a3df0a806e7301ce9b92d0705646ac?s=128&d=identicon&r=PG", "display_name": "ams", "link": "https://stackoverflow.com/users/1057909/ams"}, "is_accepted": true, "score": 2, "last_activity_date": 1470906182, "last_edit_date": 1470906182, "creation_date": 1470828523, "answer_id": 38872199, "question_id": 38871700, "link": "https://stackoverflow.com/questions/38871700/estimating-memory-footprint-and-cpu-usage-for-a-c-library/38872199#38872199", "title": "Estimating memory footprint and CPU usage for a C library", "body": "<p>Your memory estimate sounds pretty good to me, <strong>as long as you compiled it for ARM9</strong>. Actually, if you cross-compile the library without debug info, and you expect all the functions of the library to be used in the final application, then the file-size of the library is a pretty good ball-park estimate. The only way that wouldn't work is if you had a lot of zero-initialized global (or static) variables. Run-time memory allocation is a different matter, of course, but you've accounted for that already.</p>\n\n<p>Size estimates based on x86 code may be within the same ball-park, but really shouldn't be trusted. Sizes do vary from compiler to compiler also, so try to match it if you can, but any recent ARM compiler is OK for a <em>rough</em> estimate.</p>\n\n<p>As for CPU estimates, that's impossible to put a figure on without measuring it. It's a function of the architectural efficiency of the CPU, effectiveness of compiler optimizations, clock rate, memory speed, bus speed, cache size, cache pressure caused by other running tasks, etc., etc., etc.  There's just too many variables.</p>\n\n<p>One thing you might be able to do is use big-O notation to say something about the performance of the algorithms on different input.</p>\n\n<p>I'd probably just say \"light\", or \"heavy\". You probably have an idea which of those fits.</p>\n"}], "owner": {"reputation": 5400, "user_id": 364365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ebd7951248c6d4d2f2f0bd92f18fec7?s=128&d=identicon&r=PG", "display_name": "Frode", "link": "https://stackoverflow.com/users/364365/frode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 38872199, "answer_count": 1, "score": 1, "last_activity_date": 1470906182, "creation_date": 1470827188, "question_id": 38871700, "link": "https://stackoverflow.com/questions/38871700/estimating-memory-footprint-and-cpu-usage-for-a-c-library", "title": "Estimating memory footprint and CPU usage for a C library", "body": "<p>I have a static library written in C, with no dynamic memory allocation. </p>\n\n<p>Until now, the library has only been used in an application for regular i386 Linux, where CPU and memory was plentiful. </p>\n\n<p>I now need to try building a version of the library for an embedded, real-time ARM9 system (provided by a 3rd party). Before that I have to give some rough estimates of memory footprint and CPU usage.</p>\n\n<p>For memory footprint, I build a tiny application on my i386 machine, statically linking with my library, that exercises all the functions of my library. Is it roughly correct that checking the resident memory of this application will give me a ballpark estimate of my library's memory footprint? Is there a better way to measure it?</p>\n\n<p>For estimating CPU usage, I'm at a loss. I can of course run the test application mentioned above, on my i386 system, but I don't know what metrics that'll give me (if any) that can translate into something relateable to the ARM system. Is there a way to do it?</p>\n"}, {"tags": ["c", "function", "overflow"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470835439, "post_id": 38871531, "comment_id": 65110823, "body": "Consider separating concerns.  You had code that worked for you using <code>FILE *</code> streams.  You can access the standard input via just such a stream, declared in stdio.h as <code>stdin</code>.  I suggest taking your old, working code, and replacing the <code>fopen()</code> call with <code>stdin</code> (i.e. <code>myFilePointer = stdin;</code>.  This will help you rule out the unlikely proposition that the problem has anything to do with the details of the manner of input."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470835804, "post_id": 38871531, "comment_id": 65111074, "body": "You claim to use <code>gets()</code>, but I see no <code>gets()</code> calls in the code you posted.  That&#39;s good, because if there were any then I would urge you to remove them, because <code>gets()</code> is inherently flawed and should never be used.  The problem is so serious that <code>gets()</code> has actually been removed from C2011 -- it is extremely rare for features to be altogether removed."}, {"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470836167, "post_id": 38871531, "comment_id": 65111334, "body": "Thank you I will try to do that now!"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470836475, "post_id": 38871531, "comment_id": 65111565, "body": "You say you get &quot;overflow errors&quot; but I&#39;m not sure what that means.  If you&#39;re saying that some other part of your code behaves differently than you expect, then you should consider that the problem may be <i>there</i>.  We generally expect troubleshooting questions to be accompanied by a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  That means not just any code, but <i>minimal</i>, <i>complete</i> code with which we can reproduce the problem, plus input data and expected results."}, {"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470836497, "post_id": 38871531, "comment_id": 65111580, "body": "@JohnBollinger I switched my fopen call in the original to stdin but it&#39;s still throwing overflows at me now in the original"}, {"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470836614, "post_id": 38871531, "comment_id": 65111662, "body": "@JohnBollinger I will edit my code now to provide the full program"}, {"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470837088, "post_id": 38871531, "comment_id": 65112043, "body": "I have edited my code now , as you can see in the main function I have my file pointers from the original code and I just simply switched the poiner to stdin for the stream but it still would not work."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470837734, "post_id": 38871531, "comment_id": 65112543, "body": "We can maybe work with this, but you have clearly not fully understood the <b>minimal</b> part of &quot;minimal, complete, and verifiable&quot;.  We don&#39;t ordinarily want your whole code; we want something with as much unnecessary cruft cut out as possible.  Preparing such a thing is a useful exercise in its own right, as it often helps you discover the error yourself."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470838153, "post_id": 38871531, "comment_id": 65112869, "body": "I&#39;m still not sure what an &quot;overflow error&quot; is, but if you&#39;re talking about the test performed by function <code>checkWordFlow()</code> then your program runs the sample input for me without triggering the diagnostic therein."}, {"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470838334, "post_id": 38871531, "comment_id": 65113030, "body": "@JohnBollinger I figured out the problem :)! So basically if I am inputting the values with STDIN manually instead of redirecting them with that VIM command, the program works! The thing is when I am doing then manually I do CTRL+D and that signals the end of the program , and then the user is prompted to input the values for the program! SO Basically in the stream it does not have a ctrl+D to tell it to stop , so how can I make it stop"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470838877, "post_id": 38871531, "comment_id": 65113542, "body": "Your program works for me <i>with</i> I/O redirection, both via the shell and indirectly from <code>vim</code> (which anyway just launches a shell to run the program).  And it should.  When you use I/O redirection, end-of-file is indicated by the physical end of the file; you do not need a special character in the stream for that purpose."}, {"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470838999, "post_id": 38871531, "comment_id": 65113634, "body": "For me it only works when I am doing manual STDIN for the program , indicating it&#39;s end with CTRL D, but the shell command is not working :(. That&#39;s what&#39;s driving me nuts! I have EOF comparision so why does it overflow when it&#39;s doing it with the shell command? very strange."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470839177, "post_id": 38871531, "comment_id": 65113790, "body": "If you get different results when the program&#39;s stdin is connected to a terminal than when it is connected to a file, despite feeding it the same data, then I&#39;m inclined to think that you&#39;re not running the same program in those two cases.  Alternatively, maybe you&#39;re not actually feeding it the same input."}, {"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470839432, "post_id": 38871531, "comment_id": 65113989, "body": "Maybe the shell command that VIM is using requires a certain setup? I just double checked and the program is exactly the same! , is it okay if I show you what&#39;s going on with a screen-share program?"}, {"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470839555, "post_id": 38871531, "comment_id": 65114096, "body": "I think the VIM shell command is preventing it from receiving the same input, does the file it&#39;s reading require a \\n at very end or something ?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470839565, "post_id": 38871531, "comment_id": 65114109, "body": "No, I will not participate in any kind of screen sharing.  Any information needed to answer the question should be presented <i>in</i> the question."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470839725, "post_id": 38871531, "comment_id": 65114228, "body": "I doubt that <code>vim</code> is contributing to the problem, but I do suggest simplifying the problem space by taking <code>vim</code> out of it.  Run the program directly from the (same) shell, both with and without I/O redirection.  If the latter still fails, then present the input that causes it to fail, and the program output indicative of the failure."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470839930, "post_id": 38871531, "comment_id": 65114403, "body": "Yes, I took the exact code you presented and compiled it.  I took the example input you presented, put it in a file, and ran the program, redirecting its input from the file.  The program printed a <code>0</code>, a summary of registers, and a memory map.  It did not emit any diagnostic messages."}, {"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470840317, "post_id": 38871531, "comment_id": 65114723, "body": "Alright, it should not behave like that, thanks for clarifying .The program should works in two steps: First - it will take input of the program that the user wants , reads line by line , as commands, just like a virtual computer in the compiler. Second - If compilation process was a success it will go to execution now and it will execute the program that the user provided, Now when the program executes it will prompt the user to enter two values , and it should take inputs from user, the program above has the following task: sums the total of integers that the user inputs"}, {"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470840410, "post_id": 38871531, "comment_id": 65114796, "body": "This  programreads in two numbers and if the second number is a multiple of the first outputs the string \u201cMULT\u201d otherwise outputs the string \u201cNOT\u201d, here are the commands for it 01 READ 51 02 READ 52 03 LOAD 52 04 MOD 51 05 BRZR 08 06 PRNT 90 07 HALT 99 08 PRNT 80 09 HALT 99 80 SET 7785 81 SET 7684 82 SET 1000 90 SET 7879 91 SET 8410 92 SET 0000 , That one is giving me an overflow in the shell"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470840895, "post_id": 38871531, "comment_id": 65115144, "body": "Wait, what?  The program tries to read the VM program AND additional inputs from the same stream?  Now I understand what you said earlier about ctrl+D (and this is one reason why we want a <i>minimal</i> example).  Yes, you do need a way to mark the boundary between VM instructions and VM data if you are reading them from the same stream.  That Ctrl+D works for you when you input the data by hand is a shell quirk.  I&#39;d suggest adding a VM pseudo-instruction that serves to mark the end of the program source.  &quot;END&quot; or &quot;STOP&quot; might be a reasonable name."}, {"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470841287, "post_id": 38871531, "comment_id": 65115425, "body": "Yes that is  exactly the technical term for it :D ! It was reading both from the same stream and I could not figure out if EOF was supposed to stop that but it was not, so if I add a STOP at the very last line and like make an if block that has a break in it , it would work right? Also do you think there is another way to do this without having to write a termination command at the very end?"}, {"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470842045, "post_id": 38871531, "comment_id": 65115961, "body": "I tried adding the following if block within the while loop       <code>if(strcmp(s,&quot;STOP&quot;)==0){                 break;}</code>  I also added a <code>00 STOP 00</code>, at the very last line of the program that I&#39;m giving into the shell but it did not work , it still gave overflow for the other programs and did not prompt the user to enter for the one in the example above"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470842155, "post_id": 38871531, "comment_id": 65116042, "body": "There is a variety of ways you could mark the boundary between sections of the input.  It does not have to be a (pseudo)instruction, but that would have the advantage of fitting very cleanly into your existing code.  It is unreasonable, however, to rely on a stream-level end-of-input signal between sections, because once you see EOF on a stream, it is unsafe to assume that any further data can be read from it (unless you first successfully reposition with <code>fseek()</code> or such)."}, {"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470842580, "post_id": 38871531, "comment_id": 65116326, "body": "I thought break would terminate a while loop, however it seems like it&#39;s constantly looping even after providing a break for the  loop, maybe I should redirect the stdin to the user terminal with something like this : stdin = fopen(&quot;/dev/tty&quot;, &quot;r&quot;);"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470842665, "post_id": 38871531, "comment_id": 65116393, "body": "I added the same line for handling a STOP command, and recompiled.  I added the same <code>00 STOP 00</code> to the vm program file, and I added an additional integer after it to be read by the <code>READ</code> vm instruction.  The vm runs successfully and accepts both parts of the input.  If I remove the STOP instruction from the vm program file, it instead fails with an &quot;Improper Format&quot; message.  This all seems right, and exactly what I would expect."}, {"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1470843200, "post_id": 38871531, "comment_id": 65116829, "body": "It works perfectly now! Thank you sooooo much John! I learn something new everyday in this world of C haha! Sorry for sending so many comments I was just really frustrated! Thank you again alot , have a great day"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "edited": false, "score": 0, "creation_date": 1470828853, "post_id": 38872081, "comment_id": 65106055, "body": "Thank you for your prompt response, I use VIM for programming and it has a tool within it that auto redirects files as input when being provided in the command line argument so to execute the program I use something like this ./computer &lt; prog1 , where prog1 is actually a file being read in via STDIN instead of having to implement file pointers. The user inputs values after the prog compiles succesfully depending on the program. Afterall it&#39;s a virtual computer :) ."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "edited": false, "score": 0, "creation_date": 1470835151, "post_id": 38872081, "comment_id": 65110593, "body": "@MohammedAl-Huneidi, note that <code>vim</code> is just giving you standard I/O redirection using the same syntax as the shell&#39;s."}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 0, "last_activity_date": 1470828168, "creation_date": 1470828168, "answer_id": 38872081, "question_id": 38871531, "link": "https://stackoverflow.com/questions/38871531/overflow-error-in-function/38872081#38872081", "title": "Overflow error in function", "body": "<p>If you are taking the input from the user, then the code will be different.</p>\n\n<p>There are a few options,</p>\n\n<ol>\n<li><p>Keep the same code, but put a condition on the user to press <code>Ctrl-Z</code> after entering all the data. This will only work if you are the only person entering the data, and is generally not workable.</p></li>\n<li><p>After every loop, you can ask the user if he wants to enter more data. Then you can get the input as a <code>y/n</code> and loop back if the user enters <code>y</code>. </p></li>\n</ol>\n\n<p>An example is below.</p>\n\n<pre><code>do\n{\n  scanf(\"%d %79s %d\",operationCode,s,operand));\n  // Other code here\n\n   printf(\"\\n Do you want to enter another value (y/n) \");\n   scanf(\" %c\",&amp;check);\n} while(check != 'n\");\n</code></pre>\n\n<ol start=\"3\">\n<li>Loop for a fixed no of times, but your original code does not work that way and this will not be a good option for you.</li>\n</ol>\n"}], "owner": {"reputation": 49, "user_id": 5658556, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153768174668221/picture?type=large", "display_name": "Mohammed Al-Huneidi", "link": "https://stackoverflow.com/users/5658556/mohammed-al-huneidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 853, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470836876, "creation_date": 1470826828, "last_edit_date": 1470836876, "question_id": 38871531, "link": "https://stackoverflow.com/questions/38871531/overflow-error-in-function", "title": "Overflow error in function", "body": "<p>I'm new to C programming and I've been writing a virtual computer program that takes input from STDIN , the inputs basically represents commands that task the Virtual computer to perform a multiple of a certain number check - just simple stuff. Essentially when I first wrote this program I was reading my input from a file using file pointers that direct to file streams , but then when I switched my stream to STDIN it started getting weird.</p>\n\n<p>The interesting thing about this STDIN is that it's a file stream redirection, so I am still providing a file in command line argument , but since I use a coding platform that has a command that allows file redirection without having to implement an actual file pointer it's getting me confused. </p>\n\n<p>I started getting overflow errors that did not occur when I used to have file pointers to the programs that are being provided in the command line argument, I have no idea why as I have just switched my file pointer stream to stdin`, . I would greatly appreciate it if someone could point out to me what the problem could likely be, here is the code that I'm getting the overflow errors from:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n/*Calling in the prototypes NOTE: I don't call execute/compile because they preceed the main method */\n\nint printMemory(int* accumulator, int* instructionCounter, int* instructionRegister,int*operationCode,int* operand, int memory []);\nint checkSegmentationFault(int *operand);\nint checkWordFlow(int instructionCounter, int memory []);\n\n/* \nFunction Name: compile\nParameters: A pointer to the file that we are processing, the memory array, a pointer to  instructionCounter, instructionRegister, operationCode, and operand, so that we can carry operations on them\nReturn value(s): returns 1 if it compiles succesfully otherwise it would return a zero or terminate.\nPartners: None\nDescription: This function reads in the file through it's pointer line by line and then converts it's data into 4 digit values, then they get stored into memory array. The function the proceeds to check for some compiling errors then it returns the result.\n*/\n\nint compile (FILE* fPointer , int memory [], int* instructionCounter , int* instructionRegister ,int*operationCode ,int* operand){\n    char s[80]; /* The buffer */\n    *instructionRegister=0;\n    *operationCode=0;\n    while(((*instructionRegister)=fscanf(fPointer,\"%d %s %d\", operationCode,s,operand)) != EOF){ /*Reads data line by line then stores the integer returned by fscanf to instructionRegister pointer so that I can check for formating */\n        if((*instructionRegister) ==3 ){ /*Checks for improper format by comparing the current instructionRegister count to 3, returns improper format otherwise */\n            if(*operand &gt;9999|| *operand &lt;0){  /* Checks for word overflow in compiler, makes sure that digits do not exceed 9999 */\n                printf(\"attempts to place a word in memory that is larger than 4 digits, or attempted to pass in a negative value\\n \");\n                exit(0);\n            }\n            /*Compares the string section of the code and checks if it matches the following words and then it converts it to it's 4 digit value by adding into it the operand */\n            if(strcmp(s,\"READ\") == 0) {\n                memory[*operationCode] = 10 * 100 + *operand;\n            }\n            else if(strcmp(s,\"WRIT\") == 0) {\n                memory [*operationCode] = 11 * 100 + *operand;\n            }\n            else if(strcmp(s,\"LOAD\") ==0){\n                memory [*operationCode] = 20 * 100 + *operand;\n            }\n            else if(strcmp(s,\"PRNT\") ==0){\n                memory [*operationCode] = 12 * 100 + *operand;\n            }\n            else if(strcmp(s,\"STOR\") ==0){\n                memory [*operationCode] = 21 * 100 + *operand;\n            }\n            else if(strcmp(s,\"SET\") ==0){\n                memory [*operationCode] = *operand;\n            }\n            else if(strcmp(s,\"ADD\") ==0){\n                memory [*operationCode] = 30 * 100 + *operand;\n            }\n            else if(strcmp(s,\"SUB\") ==0){\n                memory [*operationCode] = 31 * 100 + *operand;\n            }\n            else if(strcmp(s,\"DIV\") ==0){\n                memory [*operationCode] = 32 * 100 + *operand;\n            }\n            else if(strcmp(s,\"MULT\") ==0){\n                memory [*operationCode] = 33 * 100 + *operand;\n            }\n            else if(strcmp(s,\"MOD\") ==0){\n                memory [*operationCode] = 34 * 100 + *operand;\n            }\n            else if(strcmp(s,\"BRAN\") ==0){\n                memory [*operationCode] = 40 * 100 + *operand;\n            }\n            else if(strcmp(s,\"BRNG\") ==0){\n                memory [*operationCode] = 41 * 100 + *operand;\n            }\n            else if(strcmp(s,\"BRZR\") ==0){\n                memory [*operationCode] = 42 * 100 + *operand;;\n            }\n            else if(strcmp(s,\"HALT\")==0){\n                memory [*operationCode] =9999;\n            }\n\n            else {   /* Prints back to the user that the compiler did not recognize one of them commands as it was going through it */\n                printf (\"This is an unknown command, commands are case sensitive, program will now exit \\n\");\n                exit(0);\n\n            }\n        }\n        else{    /* Returns improper format if instructionRegister does not match 3*/\n            printf(\"Improper Format, program will now exit \\n\");\n            exit(0);\n        }\n\n\n    }\n    /* Checks if the instruction data contains a HALT, if not it would terminate */\n    while(*instructionCounter&lt;100){\n        if (memory[*instructionCounter] == 9999){\n            return 1;\n        }\n        else\n            (*instructionCounter)++;\n    }\n    printf(\"Halt was not found, program will now exit\");    \n    exit (0);\n\n}\n/*\nFunction Name       : execute\nParameters      : accumulator for storing in the arithematic operations , instructionCounter for counting the instructions, instructionRegisterfor storing the current instruction, \noperationCode stores the first 2 digits so that it would recognize what command is currently being executed, operand stores the next 2 digits , and the memory to be able to loop through the computer 100 memory\nReturn value(s)     : returns 1 if it executes fine, otherwise it would terminate if it finds an error. It also prints out HALT once found which shows the current state of the memory.\nPartners            : None\nDescription     : This function processes the compiled instructions and start carrying out operations on them depending on their operation code, it also checks for error then it prints out the current memory state once it reaches HALT,\n*/\n\nint execute(int* accumulator ,  int* instructionCounter , int* instructionRegister ,int*operationCode ,int* operand, int memory [])\n{\n    /* Resets the values to zero because they were used in the compiler */\n    *operand=0;\n    *operationCode=0;\n    *instructionRegister=0;\n    *instructionCounter=0;\n    *accumulator=0;\n\n    /* this loop starts looking at the 4 digit memory cells and executes them 1 by 1  */\n    while(*instructionCounter&lt;100){\n\n        checkWordFlow(*instructionCounter, memory);\n\n        *instructionRegister=memory[*operand];  /*stores current instruction */\n\n        *operand=memory[*instructionCounter]%100;   /* Stores the 2 right  digits  */\n\n        checkSegmentationFault(operand);         /* checks that operand does not contain a negative value so that the problem does not throw a seg fault */\n\n        *operationCode=memory[*instructionCounter]/100; /* Stores the 2 left diigts */\n\n        if(*operationCode==10){ /*READ: inquires the user to provide input and stores it in specified address in the instructions*/\n\n            scanf(\"%d\",&amp;memory[*operand]);\n\n        }\n        else if(*operationCode==11 ){ /*WRIT*: prints out the data in a memory element when executed*/\n            printf(\"%d\\n\",memory[*operand]);\n        }\n\n        else if(*operationCode==12 ){ /*PRNT */\n\n            while(1){   /*Loops and prints the followiing values that prnt passes in as operand */  \n\n                /*Checks if the ASCI values are within the correct range */                \n                if((memory[*operand]/100 &gt; 65 &amp;&amp;memory[*operand]/100 &lt;90)  || memory[*operand]/100 == 10 )\n                    printf(\"%c\",memory[*operand]/100);\n                else if (memory[*operand]/100 == 0){\n                    break;\n                }\n                else {\n                    printf(\"Unknown Character\\n\");\n                    exit(0);\n                }\n                if((memory[*operand]%100&gt;65 &amp;&amp;memory[*operand]%100 &lt;90)  || memory[*operand]%100 == 10)\n                    printf(\"%c\", memory[*operand]%100);\n                else if (memory[*operand]%100 == 0){\n                    break;\n                }\n\n                else{\n                    printf(\"Unknown Character\\n\");\n                    exit(0);\n                }\n\n                (*operand)++;  \n            }\n            *operand =0;  /*Resets the value of operand since it was incremented, so that it wont mess up the HALT print*/\n            printf(\"\\n\");\n        }\n        else if(*operationCode==20 ){  /*LOAD : loads into the accumulator */\n            *accumulator = memory[*operand];\n\n        }\n        else if(*operationCode== 21){  /*STORE: stores the accumlator value into the specific memory cell*/\n            memory[*operand] = *accumulator;\n        }\n\n        else if(*operationCode==30 ){ /*ADD: adds into the accumulator the specificed memory address data*/\n            *accumulator+=memory[*operand];\n        }\n\n        else if(*operationCode==31 ){ /*SUB: substracts from the accumulator the specified memoery addres data*/\n            *accumulator= *accumulator - memory[*operand];\n        }\n        else if(*operationCode== 32){ /*DIV: divides from the accumulator the specificed memory address data */\n\n            if(memory[*operand] &gt;0){ /* Handles division by zero error */\n                *accumulator= *accumulator/memory[*operand];\n            }\n            else {\n                printf(\"Division by zero was attempted\\n program will now exit \\n\");\n                exit(0);\n            }\n        }\n        else if(*operationCode== 33){    /*MULT: multiplies to the accumulator the specified address data*/\n            *accumulator= *accumulator*memory[*operand];\n        }   \n        else if(*operationCode== 34){  /*MOD: calculates the remainder to the accumulator the specified address data*/\n            *accumulator= *accumulator%memory[*operand];\n        }\n        else if(*operationCode ==40){  /*BRAN: jump memory execution to address given */\n            *instructionCounter= *operand;\n            (*instructionCounter)--;  /* deduct counter by 1 so that the loop does not skip over instructions */\n        }\n        else if(*operationCode ==41){ /*BRNG: jumps memory execution to addres given only if accumulator is negative*/\n\n            if (*accumulator &lt;0){        \n                *instructionCounter=*operand;\n                (*instructionCounter)--;  /* deduct counter by 1 so that the loop does not skip over instructions */\n\n            }\n        }\n        else if(*operationCode ==42){  /*BRZR jumps memory execution to memory location only if accumulator is zero*/\n\n            if(*accumulator ==0){        \n                *instructionCounter=*operand;\n                (*instructionCounter)--; /* deduct counter by 1 so that the loop does not skip over instructions */            \n            }\n        }\n        else if(*operationCode == 99){  /*HALT: terminates the program but prints out the memory state before it does that*/\n            printMemory(accumulator,instructionCounter,instructionRegister,operationCode,operand,memory); /*prints the memory out */\n            exit(0);\n        }\n        else if(*operationCode == 0){ /* Checks for empty elements and moves passt them */\n            (*instructionCounter)++;\n            continue;\n        }\n\n        else{  /* Handles unrecognized operation codes */    \n            printf(\"Unknown Command, program will now exit\\n\");\n            exit(0);\n        }\n\n        (*instructionCounter)++;  /* Increment loop by 1 and start the next round of looping */\n\n    }\n    return 1;\n}\nint main (int argc, char* argv[]){\n    FILE * fPointer=NULL;\n    char fileName[150];\n    int accumulator=0;\n    signed int instructionCounter=0;\n    signed int instructionRegister=0;\n    int operationCode=0;\n    int operand=0;\n    signed int memory [100];\n    /*Checks if the user passed in an argument at the command  line*/\n    if(argc &lt; 1){\n        puts(\"You didn't specify the arguments or parameters\\n\");\n        exit(0);\n\n    }\n    /*fill the buffer */\n    if(argc&gt;1)\n        strcpy(fileName,argv[1]);\n\n\n    fPointer=stdin;\n    /* If file failed to open then this would throw an error */\n    if(fPointer == NULL){\n        puts(\"File failed to open\\n\");\n        exit(0);\n    }\n\n    /* This loop fills the memory array with zeros*/\n    for(instructionCounter =0;instructionCounter&lt;100;instructionCounter++){\n        memory [instructionCounter] = 0; \n    }\n    instructionCounter=0;\n\n\n    /* Run the commands */\n\n    compile(fPointer, memory,&amp;instructionCounter,&amp;instructionRegister,&amp;operationCode,&amp;operand);\n    execute(&amp;accumulator,&amp;instructionCounter,&amp;instructionRegister,&amp;operationCode,&amp;operand,memory);\n    return 1;\n}\n\n/*\n   Function Name       : printMemory\nParameters      : accumulator, instructionCounter, instructionRegister, operationCode, operand, memory array, to insure that we print out the correct state of the memory we have to pass them in \nReturn value(s)     : returns 1, but prints out memory state before it does that\nPartners            : None\nDescription     : Prints out the current state of the memory in a nicely formatted manner\n*/\n\nint printMemory(int* accumulator , int* instructionCounter , int* instructionRegister ,int*operationCode ,int* operand, int memory []){\n    printf(\"REGISTERS:\\naccumulator              %+05d\\ninstructionCounter          %02d\\ninstructionRegister      %+05d\\noperationCode               %02d\\noperand                     %02d\\n\",\n            *accumulator, *instructionCounter, *instructionRegister, *operationCode, *operand); \n    *instructionCounter =0;\n\n    printf(\"MEMORY:\\n       0     1     2     3     4     5     6     7     8     9\\n\");\n    for((*instructionCounter)=0;(*instructionCounter)&lt;100;(*instructionCounter)+=10) /* loops through the memory array and outputs 10 elements in every row */\n    {\n        printf(\"%2d\",*instructionCounter);\n        printf(\" %+05d %+05d %+05d %+05d %+05d %+05d %+05d %+05d %+05d %+05d\\n\", memory[*instructionCounter], memory[*instructionCounter+1] , memory [*instructionCounter+2] , memory [*instructionCounter+3], memory[*instructionCounter+4],\n                memory[*instructionCounter+5],memory[*instructionCounter+6],memory[*instructionCounter+7],memory[*instructionCounter+8],memory[*instructionCounter+9] );\n\n    }\n    return 1;\n}\n/*\n   Function Name       : checksegmentationFault\nParameters      : operand.\nReturn value(s)     : returns 0, terminates the program if it tried to access an unknown operand , likely a negative value.\nPartners            : None\nDescription     : terminates the program if it tried to access an unknown operand , likely a negative value.,\n*/\n\nint checkSegmentationFault(int *operand)\n{\n    if(*operand &lt; 0 || *operand &gt;100){\n        printf(\"SEGMENTATION FAULT: Attempted to access an unknown address \\n\");\n        exit(0);\n    }\n    return 0;\n}\n/*\n   Function Name       : checkWordFlow\nParameters      : instructionCounter for looping, and memory array\nReturn value(s)     : 1 , terminates if it reaches a word overflow\nPartners            : None\nDescription     : this function checks for the word overflow possible error at execution by checking that digit values do no surpass 9999,\n*/\n\nint checkWordFlow( int instructionCounter, int memory []) /*fix this shit */\n{\n    instructionCounter=0;\n    while(instructionCounter&lt;100){\n        if(memory[instructionCounter]&gt;9999)\n        { printf(\"Word Overflow at memory element %d\\n program will exit\\n\", instructionCounter);\n            exit(0);\n        }\n        instructionCounter++;\n    }\n    return 1;\n}\n</code></pre>\n\n<p>The stream of input looks something like this: (Like I mentioned above this stream is being redirected with a VIM command, it cheats the program into reading from files without having to actually implement file pointers)</p>\n\n<pre><code>01 READ 60\n02 LOAD 60\n03 SUB 61\n04 STOR 60\n05 BRNG 15\n06 READ 70\n07 LOAD 70\n08 ADD 80\n09 STOR 80\n10 LOAD 60\n11 SUB 61\n12 STOR 60\n13 BRNG 15\n14 BRAN 6\n15 WRIT 80\n16 HALT 99\n61 SET 1\n80 SET 0\n</code></pre>\n\n<p>I've been scratching my head for hours and I cannot figure out why it's doing that, as I said I'm new to C programming and I still don't know how to debug and do the C stuff, I came from a Java background.         </p>\n\n<p>Edit 1: The user does not write the program to the virtual computer, the programs are already written and the user just redirects with a STDIN  via a command in VIM like this     <code>(./computer &lt; prog1)</code> or     <code>(./computer &lt; prog2)</code>. The program should compile successfully, and then when the computer figures out what kind of a program it is , it will prompt the user for input depending on it's task. So it could ask the user to input values , then it would calculate their average if that was the program that was redirected to it.</p>\n"}, {"tags": ["c++", "mysql", "sql", "c", "linux"], "comments": [{"owner": {"reputation": 26033, "user_id": 1047662, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8aXzf.jpg?s=128&g=1", "display_name": "Cyclonecode", "link": "https://stackoverflow.com/users/1047662/cyclonecode"}, "edited": false, "score": 2, "creation_date": 1470826605, "post_id": 38871422, "comment_id": 65104595, "body": "<code>i want to add a table from mysql into c or c++ program</code> - c/c++ is <b>not</b> mysql. Do you want to create a table using c/c++?"}, {"owner": {"reputation": 73, "user_id": 4691190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/75fe1ccec5aefd304bd0d9402b6d7c9c?s=128&d=identicon&r=PG&f=1", "display_name": "sass", "link": "https://stackoverflow.com/users/4691190/sass"}, "reply_to_user": {"reputation": 26033, "user_id": 1047662, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8aXzf.jpg?s=128&g=1", "display_name": "Cyclonecode", "link": "https://stackoverflow.com/users/1047662/cyclonecode"}, "edited": false, "score": 0, "creation_date": 1470826664, "post_id": 38871422, "comment_id": 65104644, "body": "no . i mean i want use the info of a table in my database and for example show it to a program i wrote in c/c++ ."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 2, "creation_date": 1470827125, "post_id": 38871422, "comment_id": 65104926, "body": "I&#39;m sure there are plenty of good books in your nearest book store that you can read in order to learn how to write a mysql client in C++. stackoverflow.com is not, unfortunately, a tutorial web site."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 4691190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/75fe1ccec5aefd304bd0d9402b6d7c9c?s=128&d=identicon&r=PG&f=1", "display_name": "sass", "link": "https://stackoverflow.com/users/4691190/sass"}, "edited": false, "score": 0, "creation_date": 1470828219, "post_id": 38871821, "comment_id": 65105679, "body": "could  you please explain about input i have to put in that funtion . what is the connection and ... . tnx ."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 73, "user_id": 4691190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/75fe1ccec5aefd304bd0d9402b6d7c9c?s=128&d=identicon&r=PG&f=1", "display_name": "sass", "link": "https://stackoverflow.com/users/4691190/sass"}, "edited": false, "score": 1, "creation_date": 1470828428, "post_id": 38871821, "comment_id": 65105802, "body": "There are a lot of examples showing how to fetch a result in C/C++ , take a look to <a href=\"http://zetcode.com/db/mysqlc/\" rel=\"nofollow noreferrer\">Retrieving data from the database</a> in this link"}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": false, "score": 1, "last_activity_date": 1470827815, "last_edit_date": 1470827815, "creation_date": 1470827477, "answer_id": 38871821, "question_id": 38871422, "link": "https://stackoverflow.com/questions/38871422/mysql-and-c-connection/38871821#38871821", "title": "mysql and c++ connection", "body": "<p>You can use <a href=\"https://mariadb.com/kb/en/mariadb/show-create-table/\" rel=\"nofollow\">SHOW CREATE TABLE</a></p>\n\n<blockquote>\n  <p>Shows the CREATE TABLE statement that created the given table. The\n  statement requires the SELECT privilege for the table. This statement\n  also works with views.</p>\n</blockquote>\n\n<pre><code>mysql_query(connection, \"show create table tb_foo\")\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 4691190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/75fe1ccec5aefd304bd0d9402b6d7c9c?s=128&d=identicon&r=PG&f=1", "display_name": "sass", "link": "https://stackoverflow.com/users/4691190/sass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "closed_date": 1470854704, "answer_count": 1, "score": -3, "last_activity_date": 1470829775, "creation_date": 1470826511, "last_edit_date": 1470826964, "question_id": 38871422, "link": "https://stackoverflow.com/questions/38871422/mysql-and-c-connection", "closed_reason": "Not suitable for this site", "title": "mysql and c++ connection", "body": "<p>i'm new in MySQL and i want to use a table from mysql and show it on c or c++ program . \ni'm on linux Ubuntu and i use the simple terminal for compile my cpp or c file . </p>\n\n<p>if you can give me an example in this subject , i'll apreaciate .</p>\n\n<p>i download mysql.h and ... and link it to the program but i just don't know what should i write for the program :) . </p>\n"}, {"tags": ["c", "string", "strcmp"], "comments": [{"owner": {"reputation": 1560, "user_id": 4303216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-crjc3oGU_5c/AAAAAAAAAAI/AAAAAAAAADc/BTLu8OHFfRM/photo.jpg?sz=128", "display_name": "sameera sy", "link": "https://stackoverflow.com/users/4303216/sameera-sy"}, "edited": false, "score": 3, "creation_date": 1470824995, "post_id": 38870813, "comment_id": 65103540, "body": "please provide an example of where you went wrong or a sample test case proving your point"}, {"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 0, "creation_date": 1470825050, "post_id": 38870813, "comment_id": 65103580, "body": "It would be nice to see related info from core dump."}, {"owner": {"reputation": 6519, "user_id": 2069380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fac5cb90925b4059b6b2c0885c9ffaf?s=128&d=identicon&r=PG", "display_name": "Ohad Eytan", "link": "https://stackoverflow.com/users/2069380/ohad-eytan"}, "edited": false, "score": 3, "creation_date": 1470825072, "post_id": 38870813, "comment_id": 65103592, "body": "Welcome to StackOverflow. Please provide <a href=\"http://stackoverflow.com/help/mcve\">a Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 8543, "user_id": 2067492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54af3ad01b032767b05a7e98fede6d6e?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/2067492/matt"}, "edited": false, "score": 0, "creation_date": 1470825080, "post_id": 38870813, "comment_id": 65103605, "body": "What is garbage? If it is random bytes then that could cause the issue."}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1470825097, "post_id": 38870813, "comment_id": 65103618, "body": "&quot;Sane&quot; possibly means the pointer is pointing at memory it shouldn&#39;t be and you have undefined behaviour and are lucky it crashed. To answer your questions 1. Yes. 2. Deferencing uninitialised pointers, pointers pointing somewhere they shouldn&#39;t be, ..."}, {"owner": {"reputation": 1223, "user_id": 1816731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c187a9d0d27eae3ad1b5c6600ab4f578?s=128&d=identicon&r=PG&f=1", "display_name": "H_squared", "link": "https://stackoverflow.com/users/1816731/h-squared"}, "edited": false, "score": 0, "creation_date": 1470825213, "post_id": 38870813, "comment_id": 65103692, "body": "my guess is the &quot;garbage&quot; is not null terminated, so you are getting seg fault. But this is just a guess, we can&#39;t really help unless you show us more info like what both strings contain and how you are calling strcmp..."}, {"owner": {"reputation": 13, "user_id": 5307875, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kNe4bN-fER0/AAAAAAAAAAI/AAAAAAAAAQo/NUryqF6u55g/photo.jpg?sz=128", "display_name": "Proteen", "link": "https://stackoverflow.com/users/5307875/proteen"}, "edited": false, "score": 0, "creation_date": 1470825368, "post_id": 38870813, "comment_id": 65103801, "body": "The &quot;garbage&quot; string is null terminated as shown in my example. Otherwise gdb wouldn&#39;t have printed only that segment."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1470825477, "post_id": 38870813, "comment_id": 65103873, "body": "The pointer points to memory that your program is not allowed to access. Dereferencing the pointer means: accessing that memory."}, {"owner": {"reputation": 13, "user_id": 5307875, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kNe4bN-fER0/AAAAAAAAAAI/AAAAAAAAAQo/NUryqF6u55g/photo.jpg?sz=128", "display_name": "Proteen", "link": "https://stackoverflow.com/users/5307875/proteen"}, "edited": false, "score": 0, "creation_date": 1470825519, "post_id": 38870813, "comment_id": 65103908, "body": "Which part of the memory is my program not allowed to access but gdb is allowed to print ?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 2, "creation_date": 1470826070, "post_id": 38870813, "comment_id": 65104255, "body": "Post the code.  Debugging output can be misleading: <code>b</code> and <code>c</code> might not be available with their actual values to the debugger."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5307875, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kNe4bN-fER0/AAAAAAAAAAI/AAAAAAAAAQo/NUryqF6u55g/photo.jpg?sz=128", "display_name": "Proteen", "link": "https://stackoverflow.com/users/5307875/proteen"}, "edited": false, "score": 0, "creation_date": 1470847459, "post_id": 38871319, "comment_id": 65119513, "body": "Sorry, for obvious reasons, I cannot reveal the code as-is since it&#39;s closed source. I tried to make do with an example that looks similar. I am looking more for ideas and situations where strcmp can crash even though both the strings being compared are OK. Someone suggests that the pointer is outside of referenceable memory. If that is the case, why can gdb print it ? Shouldn&#39;t gdb also complain that address is out of bounds ?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 13, "user_id": 5307875, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kNe4bN-fER0/AAAAAAAAAAI/AAAAAAAAAQo/NUryqF6u55g/photo.jpg?sz=128", "display_name": "Proteen", "link": "https://stackoverflow.com/users/5307875/proteen"}, "edited": false, "score": 0, "creation_date": 1470848128, "post_id": 38871319, "comment_id": 65119863, "body": "@Proteen: <code>gdb</code> would complain too.  My guess is the debugging information is not precise enough for <code>gdb</code> to use you the correct values for <code>b</code> and <code>c</code>.  You could disassemble the code and see for yourself which register is being used as the address causing the crash.  Without further information, there is not much we can say.  The value printed for <code>b</code> is surprisingly large."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 1, "last_activity_date": 1470848399, "last_edit_date": 1470848399, "creation_date": 1470826230, "answer_id": 38871319, "question_id": 38870813, "link": "https://stackoverflow.com/questions/38870813/strcmp-crashes-even-though-both-strings-are-sane/38871319#38871319", "title": "strcmp crashes even though both strings are sane", "body": "<p>The values for <code>b</code> and <code>c</code> <em>seem</em> OK, but due to optimizations, especially around such functions as <code>strcmp()</code> that may undergo intense macro expansion, the actual values might not be available to the debugger.</p>\n\n<p>The problem might be easy to spot in the source code, you should post the source to the offending function.</p>\n\n<p>The value <code>0x7f58d3a36b89</code> printed by <code>gdb</code> for variable <code>b</code> is surprisingly large!  You could try and modify your code this way:</p>\n\n<pre><code>static char bb = *b;\nstatic char cc = *c;\na = strcmp(b, c);\n</code></pre>\n\n<p>Forcing an access to <code>b</code> and <code>c</code> before the <code>strcmp()</code> may move the crash up and let you verify if <code>b</code> is indeed what <code>gdb</code> prints it to be.</p>\n"}], "owner": {"reputation": 13, "user_id": 5307875, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kNe4bN-fER0/AAAAAAAAAAI/AAAAAAAAAQo/NUryqF6u55g/photo.jpg?sz=128", "display_name": "Proteen", "link": "https://stackoverflow.com/users/5307875/proteen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "closed_date": 1470914064, "accepted_answer_id": 38871319, "answer_count": 1, "score": -1, "last_activity_date": 1470848399, "creation_date": 1470824903, "last_edit_date": 1470825277, "question_id": 38870813, "link": "https://stackoverflow.com/questions/38870813/strcmp-crashes-even-though-both-strings-are-sane", "closed_reason": "Not suitable for this site", "title": "strcmp crashes even though both strings are sane", "body": "<p>I have a peculiar problem where my program crashes at strcmp.</p>\n\n<p>Upon gdb core analysis I see that both the strings being checked are sane meaning their pointers are not NULL and they contain finite null terminated values.</p>\n\n<p>However one of the strings is garbage (not the one the variable is intended to contain)</p>\n\n<p>Leaving aside the fact that it is garbage, I really want to know why strcmp would crash for 2 sane strings ? What could be the possible causes of this ?</p>\n\n<p>Thanks in advance!</p>\n\n<p>EDIT:</p>\n\n<p>An example,</p>\n\n<pre><code>a = strcmp(b,c);\n(gdb) p b\n$92 = 0x7f58d3a36b89 \"H\\205\\300uRH\\215}\\320\\350\\a\\300\\361\\377A\\276\"\n(gdb) p c\n$93 = 0x2041e48 \"MAIN\"\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 2, "creation_date": 1470824677, "post_id": 38870692, "comment_id": 65103321, "body": "Because <code>-1</code> is greater than <code>-10</code>?"}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1470824678, "post_id": 38870692, "comment_id": 65103324, "body": "Can you explain what you mean by &quot;still works&quot;?"}, {"owner": {"reputation": 109, "user_id": 6564887, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/733f338dd1cc6e10ef1ddb592c5918f9?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nguyen", "link": "https://stackoverflow.com/users/6564887/dave-nguyen"}, "edited": false, "score": 0, "creation_date": 1470824713, "post_id": 38870692, "comment_id": 65103353, "body": "I mean that there are more than one semi-colon."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1470824720, "post_id": 38870692, "comment_id": 65103360, "body": "What is the actual output? What is your expected output. Which is line 8?"}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1470825381, "post_id": 38870692, "comment_id": 65103809, "body": "It&#39;s somewhat dangerous to omit curly brackets in control statements. Especially for someone who uses Python from time to time."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1470915668, "post_id": 38870692, "comment_id": 65149715, "body": "Its worse to abuse on semicolons :)"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 6564887, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/733f338dd1cc6e10ef1ddb592c5918f9?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nguyen", "link": "https://stackoverflow.com/users/6564887/dave-nguyen"}, "edited": false, "score": 0, "creation_date": 1470824770, "post_id": 38870730, "comment_id": 65103397, "body": "Are there any case like that?"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "reply_to_user": {"reputation": 109, "user_id": 6564887, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/733f338dd1cc6e10ef1ddb592c5918f9?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nguyen", "link": "https://stackoverflow.com/users/6564887/dave-nguyen"}, "edited": false, "score": 0, "creation_date": 1470824887, "post_id": 38870730, "comment_id": 65103478, "body": "I don&#39;t get your question."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1470824958, "post_id": 38870730, "comment_id": 65103517, "body": "empty statement are accepted anywhere a statement is accepted"}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 2, "last_activity_date": 1470824711, "creation_date": 1470824711, "answer_id": 38870730, "question_id": 38870692, "link": "https://stackoverflow.com/questions/38870692/c-why-are-extra-semicolons-ok/38870730#38870730", "title": "C: why are extra semicolons OK?", "body": "<p><code>;;;;;</code> are empty statements. They are allowed in C.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1470825034, "post_id": 38870756, "comment_id": 65103567, "body": "A Sun Solaris compiler I once used emitted an <b>error</b> on this (which was <i>extremely</i> annoying). But that was a C++ compiler in the late 1990s. The 128bit <code>long double</code> more than made up for it though ;-)"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 8, "last_activity_date": 1470824783, "creation_date": 1470824783, "answer_id": 38870756, "question_id": 38870692, "link": "https://stackoverflow.com/questions/38870692/c-why-are-extra-semicolons-ok/38870756#38870756", "title": "C: why are extra semicolons OK?", "body": "<p>An <em>empty statement</em> is legal in C. Since <code>;</code> is the <em>statement terminator</em>, multiple <code>;</code> are syntactically valid. Sometimes this is even useful: such as the <code>for (;;) {/*code here*/}</code> idiom.</p>\n\n<p>(Although some compilers will warn you in appropriate instances).</p>\n\n<p>Do note that, conceptually at least, the excess <code>;</code> in that line are <strong>not</strong> part of the <code>if</code> block.</p>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1470824889, "creation_date": 1470824889, "answer_id": 38870802, "question_id": 38870692, "link": "https://stackoverflow.com/questions/38870692/c-why-are-extra-semicolons-ok/38870802#38870802", "title": "C: why are extra semicolons OK?", "body": "<p>It's a <em>null statement</em> which you have after the printf() statment. Having more than one semi-colons is allowed.</p>\n\n<p><em>C11, \u00a76.8.3, 4</em></p>\n\n<blockquote>\n  <p>A null statement (consisting of just a semicolon) performs no\n  operations</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1470827209, "post_id": 38870865, "comment_id": 65104990, "body": "<code>int main(void)</code> is a mistake... please correct your answer. The current way would be to either omit the <code>main</code> function&#39;s arguments (<code>int main()</code>) or put them in <code>int main(int argc, const char ** argv)}</code>), but <b>not</b> to put in the <b>wrong</b> argument (<code>int main(void)</code>..."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 1, "creation_date": 1470827905, "post_id": 38870865, "comment_id": 65105457, "body": "@Myst: I&#39;m afraid you are mistaken: your remark is correct for C++, but  not for C as the question is tagged.  <b>5.1.2.2.1 Program startup</b> The function called at program startup is named <code>main</code>. The implementation declares no prototype for this function. It shall be defined with a return type of <code>int</code> and with no parameters: <code>int main(void) { &#47;* ... *&#47; }</code> or with two parameters (referred to here as <code>argc</code> and <code>argv</code>, though any names may be used, ...): <code>int main(int argc, char *argv[]) { &#47;* ... *&#47; }</code> or equivalent; or in some other implementation-defined manner."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 1, "creation_date": 1470840815, "post_id": 38870865, "comment_id": 65115097, "body": "OMG, @chqrlie , I never saw that. Thanks. I apologize for my misinformed remark."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1470904651, "post_id": 38870865, "comment_id": 65142386, "body": "Not, <code>int main()</code> can be perfectly written as such, meaning an <i>undeterminate list of parameters</i> for the compiler, against <code>int main(void)</code> that means a <i>perfectly determinate <b>and empty</b> list of parameters</i> which is completely wrong.  What is that <b>5.1.2.2.1 ...</b> thing that you quote without reference?  Did you live in the times where main was declared as: <code>int main(argc, argv) char **argv; {...</code> ???  and that&#39;s perfectly valid C code."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1470905605, "post_id": 38870865, "comment_id": 65142906, "body": "@LuisColorado: I am just quoting the C11 Standard.  Similar language can be found in earlier versions of the standard. <code>int main() { ... }</code> will certainly compile and run smoothly, but the standard recommends otherwise.  I did indeed live through the 80s programming in C, and I do regret the slowness of the C standard committee to clean up some of the dark corners of the language.  It takes time and hard work to gain more than <i>some experience with C</i>... A humbling experience for sure."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1470906427, "post_id": 38870865, "comment_id": 65143426, "body": "@chqrlie, you are appealing the <code>C11 standard</code> as if it were the <b>unique</b> reference of the C programming language.  <code>K&amp;R C</code> is also C, <code>pre-ansi</code> is also valid C code, and none of them complaint about that (and it is not even related to the question subject).  Don&#39;t be so pedantic, and allow for flexibility in what you accept and be strict only in what you emit.  The question was marked <code>C</code> and not <code>C11</code>, so your point is completely off-topic.  A perfectly valid definition for main is <code>main () { ... }</code> (without even putting the return type)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1470906697, "post_id": 38870865, "comment_id": 65143634, "body": "@LuisColorado: much of K&amp;R C code does not compile anymore, or invokes undefined behavior. Compilers have become too smart. I just hinted with a <i>should</i>."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1470907014, "post_id": 38870865, "comment_id": 65143867, "body": "Tell me some C code not compiling for example, in GCC or Clang, and probably you have configured wrong options as default.  I&#39;m afraid you are wrong.  I&#39;m continously making tests about that precise statement and have not found <code>K&amp;R</code> code that does not compile or behaves incorrectly (not being incorrect code)  But if you want to continue this thread, please take it off this question (continue by chat or email)"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1470920435, "post_id": 38870865, "comment_id": 65153105, "body": "@chqrlie , I apologize for starting the discussion. It seems to me it&#39;s growing out of proportion... I&#39;m not so sure debating the point is productive, no matter where the truth lies (and I meant &quot;lies&quot;, not just &quot;lays&quot;)."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471005430, "post_id": 38870865, "comment_id": 65193139, "body": "@Myst: never mind!  I shall continue this discussion with Luis when I return to civilisation.  Language lawyering seem harsh, but provides for interesting encounters (or the forth kind ;-)"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 6, "last_activity_date": 1470825046, "creation_date": 1470825046, "answer_id": 38870865, "question_id": 38870692, "link": "https://stackoverflow.com/questions/38870692/c-why-are-extra-semicolons-ok/38870865#38870865", "title": "C: why are extra semicolons OK?", "body": "<p>Your program just has a sequence of empty statements at the end of the <code>main</code> function.  It is parsed as this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int a = -1, b = -10, c = 5;\n\n    if (a &gt; b)\n        printf(\"Hello World\");\n    else\n        printf(\"Get out World\");\n    ;\n    ;\n    ;\n    ;\n    ;\n}\n</code></pre>\n\n<p>Note that <code>int main()</code> should be written <code>int main(void)</code> and it should return an <code>int</code> value, for example <code>0</code>.  C99 makes this <code>return 0;</code> implicit, but it is considered bad style and it is indeed less portable to omit it.</p>\n"}, {"tags": [], "owner": {"reputation": 714, "user_id": 6231383, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MLtEJ.jpg?s=128&g=1", "display_name": "prithvi parre", "link": "https://stackoverflow.com/users/6231383/prithvi-parre"}, "is_accepted": false, "score": 0, "last_activity_date": 1470825275, "last_edit_date": 1470825275, "creation_date": 1470825096, "answer_id": 38870893, "question_id": 38870692, "link": "https://stackoverflow.com/questions/38870692/c-why-are-extra-semicolons-ok/38870893#38870893", "title": "C: why are extra semicolons OK?", "body": "<p>As we know, semicolon (<code>;</code>) works as a statement terminator. In the Line no.8 the first semicolon terminates the statement under <code>else</code> and the next semicolon terminates the empty statement, and so on.</p>\n"}, {"comments": [{"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1470905022, "post_id": 38872716, "comment_id": 65142588, "body": "Please, illustrate people about why those examples don&#39;t compile, as the one who knows why doesn&#39;t even need the example, and the one who needs the example needs also to know the reasons."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 3, "last_activity_date": 1470830016, "creation_date": 1470830016, "answer_id": 38872716, "question_id": 38870692, "link": "https://stackoverflow.com/questions/38870692/c-why-are-extra-semicolons-ok/38872716#38872716", "title": "C: why are extra semicolons OK?", "body": "<p>Extra semicolons in general are not \"OK\".</p>\n\n<p>For example, changing your code slightly:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int a = -1, b = -10, c = 5;\n    if (a &gt; b)\n        printf(\"Hello World\");;;;;;\n    else\n        printf(\"Get out World\");\n}\n</code></pre>\n\n<p>That won't even compile.</p>\n\n<p>Another example, and this one does compile:</p>\n\n<pre><code>   ...\n\n   int done = 0;\n\n   ...\n\n   while ( !done );\n   {\n       ...\n\n       done = 1;\n   }\n\n   ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 2, "last_activity_date": 1470906120, "creation_date": 1470906120, "answer_id": 38891830, "question_id": 38870692, "link": "https://stackoverflow.com/questions/38870692/c-why-are-extra-semicolons-ok/38891830#38891830", "title": "C: why are extra semicolons OK?", "body": "<p>Well, the <code>;</code> semicolon in C is a statement terminator, which means that you cannot put it where you like, <strong>only at the end of a statement</strong>.</p>\n\n<p>The null statement (one that does nothing) is valid in C, which allow you to write things as the one you post, and things like:</p>\n\n<pre><code>while((data = do_read(...)) != NULL); /* skip input until EOF */\n</code></pre>\n\n<p>that should be more visible written as (a single semicolon is too small to be skipped in a quick read):</p>\n\n<pre><code>while((data = do_read(...)) != NULL) continue;\n</code></pre>\n\n<p>which looks better as you'll never think that the next line is inside the loop.</p>\n\n<p>By the way, if you write something like:</p>\n\n<pre><code>if (a &gt; b); /* &lt;====== LOOK at this semicolon */\n    printf(\"Hello World\");;;;;;\nelse\n    printf(\"Get out World\");\n</code></pre>\n\n<p>it will not compile, as that means <em>if a greater than b just do nothing</em> and that's a good valid sentence in C.  By contrast you'll get an error several lines later, when the compiler gets to the <code>else</code> token and cannot match it to an <code>if</code> statement (remember, when you used the <code>;</code>, you finished the <code>if</code>statement)</p>\n\n<p>That also happens to occur with the group of semicolons you put after the <code>printf(\"Hello World\");</code> statement (the first semicolon terminates it, and also as the next token is not an <code>else</code> but a <code>;</code>, also terminates the <code>if</code> statement).</p>\n\n<p>The statements in the example above are:</p>\n\n<pre><code>if (a &gt; b); /* if a greater than b do nothing */\n; /* do nothing */\n; /* ... */\n; /* ... */\n; /* ... */\n; /* do nothing */\nelse /* ERROR, else cannot begin a statement */\n....\n</code></pre>\n\n<p>Here, as you got a syntax error from the compiler, you cannot have a good C program so you'll not get further analysing (the compiler tries to recover and continue parsing past that point, but you can have new errors originating of the new condition, or <em>fake errors</em>)</p>\n"}], "owner": {"reputation": 109, "user_id": 6564887, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/733f338dd1cc6e10ef1ddb592c5918f9?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Nguyen", "link": "https://stackoverflow.com/users/6564887/dave-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1775, "favorite_count": 0, "accepted_answer_id": 38870756, "answer_count": 7, "score": 1, "last_activity_date": 1470906120, "creation_date": 1470824624, "last_edit_date": 1470825450, "question_id": 38870692, "link": "https://stackoverflow.com/questions/38870692/c-why-are-extra-semicolons-ok", "title": "C: why are extra semicolons OK?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int a = -1, b = -10, c = 5;\n    if (a &gt; b)\n        printf(\"Hello World\");\n    else\n        printf(\"Get out World\");;;;;;\n}\n</code></pre>\n\n<p>Can anybody tell me why line number 8 still works, with multiple semicolons?</p>\n"}, {"tags": ["c", "multithreading", "performance"], "comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 5, "creation_date": 1470824296, "post_id": 38870492, "comment_id": 65103085, "body": "not enough work between locks results in more time spent dealing with locks than time saved working in parallel."}, {"owner": {"reputation": 615, "user_id": 1212028, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d6efc147bb6946dce9e50a1fdc367caf?s=128&d=identicon&r=PG", "display_name": "anshu", "link": "https://stackoverflow.com/users/1212028/anshu"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1470824552, "post_id": 38870492, "comment_id": 65103237, "body": "I can move the calculation of theta in the doProcTheta function to inside the lock, would that help ??"}, {"owner": {"reputation": 12895, "user_id": 1881610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d33c1dcf29d614b9366ccc3e08ac793f?s=128&d=identicon&r=PG", "display_name": "Phillip", "link": "https://stackoverflow.com/users/1881610/phillip"}, "edited": false, "score": 0, "creation_date": 1470824692, "post_id": 38870492, "comment_id": 65103331, "body": "Only loosely related to your question: If you don&#39;t know it yet, have a look at OpenMP."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1470824787, "post_id": 38870492, "comment_id": 65103412, "body": "@anshu: it might, it might not... Only benchmarking will tell you.  Note however that the more you do inside the locks, the less chances you give for parallelism."}, {"owner": {"reputation": 615, "user_id": 1212028, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d6efc147bb6946dce9e50a1fdc367caf?s=128&d=identicon&r=PG", "display_name": "anshu", "link": "https://stackoverflow.com/users/1212028/anshu"}, "edited": false, "score": 0, "creation_date": 1470824796, "post_id": 38870492, "comment_id": 65103422, "body": "I have had openMP in mind but I wanted to avoid using external libraries and use the in-built linux libraries as much as possible, but I will try to give openMP a shot as well .."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1470825072, "post_id": 38870492, "comment_id": 65103593, "body": "You are assigning specific jobs to specific threads. That&#39;s not smart. You want whichever thread happens to run to do whatever work happens to need to be done. Use a queue of work."}, {"owner": {"reputation": 8749, "user_id": 990750, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/nIvmG.jpg?s=128&g=1", "display_name": "Tarik", "link": "https://stackoverflow.com/users/990750/tarik"}, "edited": false, "score": 1, "creation_date": 1470825187, "post_id": 38870492, "comment_id": 65103673, "body": "From a quick look at the sequential code, since you are summing up in theta[i], you do not seem to need any lock. Just fire up as many threads as you have cores to process each theta[i]. When m is reached, the threads exit."}, {"owner": {"reputation": 615, "user_id": 1212028, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d6efc147bb6946dce9e50a1fdc367caf?s=128&d=identicon&r=PG", "display_name": "anshu", "link": "https://stackoverflow.com/users/1212028/anshu"}, "reply_to_user": {"reputation": 8749, "user_id": 990750, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/nIvmG.jpg?s=128&g=1", "display_name": "Tarik", "link": "https://stackoverflow.com/users/990750/tarik"}, "edited": false, "score": 0, "creation_date": 1470826172, "post_id": 38870492, "comment_id": 65104318, "body": "@Tarik : I tried to avoid spawning a lot of threads to keep the overhead minimum, the locks are used to synchronise the child threads with the main thread"}, {"owner": {"reputation": 1836, "user_id": 351861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/540239cb3a1089fcb53aae8abea1cfdd?s=128&d=identicon&r=PG&f=1", "display_name": "specializt", "link": "https://stackoverflow.com/users/351861/specializt"}, "edited": false, "score": 1, "creation_date": 1470827368, "post_id": 38870492, "comment_id": 65105094, "body": "this has absolutely nothing to do with <i>&quot;realtime&quot;</i>. Please dont just use random words because they may <i>&quot;look cool&quot;</i>."}], "answers": [{"comments": [{"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1470827262, "post_id": 38871328, "comment_id": 65105019, "body": "+1 Apart from what you wrote, I also don&#39;t understand the need for <code>while (1)</code> inside the processing function. And the usage of mutexes is completely unnecessary."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 5, "last_activity_date": 1470827075, "last_edit_date": 1470827075, "creation_date": 1470826259, "answer_id": 38871328, "question_id": 38870492, "link": "https://stackoverflow.com/questions/38870492/multithreaded-results-in-slower-performance-in-c/38871328#38871328", "title": "Multithreaded results in slower performance in C", "body": "<p>Your multi threaded implementation seems way to complex for the problem at hand. The single threaded code shows that each <code>theta</code> element is calculated independently from all other <code>theta</code> elements.</p>\n\n<p>So you don't need the mutexes and conditionals as there are no need for data exchange/synchronization between the threads. Just let the threads deal with different ranges of the <code>theta</code> calculation.</p>\n\n<p>With <code>m=661</code> and 2 threads, then the first thread should calculate <code>theta</code> in range 0..330 and the second thread should calculate <code>theta</code> in range 331..660. Launch the two threads and wait for them to finish (aka join).</p>\n\n<p>You can nearly use the single threaded code for a multi threaded implementation. All you need is to add a start-index to the function.</p>\n"}], "owner": {"reputation": 615, "user_id": 1212028, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d6efc147bb6946dce9e50a1fdc367caf?s=128&d=identicon&r=PG", "display_name": "anshu", "link": "https://stackoverflow.com/users/1212028/anshu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 38871328, "answer_count": 1, "score": 2, "last_activity_date": 1470827075, "creation_date": 1470824124, "last_edit_date": 1470824659, "question_id": 38870492, "link": "https://stackoverflow.com/questions/38870492/multithreaded-results-in-slower-performance-in-c", "title": "Multithreaded results in slower performance in C", "body": "<p>I am implementing a realtime signal processing algorithm in C and I am trying to parallelise a section of the code using multithreading.</p>\n\n<p>The code for the single threaded implementation is</p>\n\n<pre><code>void calcTheta(float *theta, float **s, float ***q, float ***g,\n               int *Ki, int m, int numObv, int numTask) {\n    int i, j, k;\n\n    for (i = 0; i &lt; m; i++) {\n        theta[i] = 0;\n        for (j = 0; j &lt; numObv; j++) {\n            for (k = 0; k &lt; numTask; k++) {\n                theta[i] += (Ki[k] * (pow(fabs(q[i][j][k]), 2) / g[i][j][k]) - s[i][k]) /\n                             (s[i][k] * (s[i][k] - (pow(fabs(q[i][j][k]), 2) / g[i][j][k])));\n            }//k\n        }//j\n        theta[i] = (numTask * numObv) / theta[i];\n    }//i\n}\n</code></pre>\n\n<p>The multithreaded implementation uses a thread spooling idea where I create a few threads and keep signalling them to process with specific data arrays. The code is below:</p>\n\n<pre><code>#define NUM_THREADS_THETA 2\n#define TRUE 1\n#define FALSE 0\n#define READY 1\n#define DONE 0\n\nstruct threadThetaData {\n    float *theta;\n    float **s;\n    float ***q;\n    float ***g;\n    int *Ki;\n    int numObv;\n    int numTask;\n    int threadId;\n};\n\nstruct threadThetaData dataArrayTheta[NUM_THREADS_THETA];\nint termThread[NUM_THREADS_THETA];\nint statusThread[NUM_THREADS_THETA];\nint iVal[NUM_THREADS_THETA];\npthread_mutex_t mutexThreadProc[NUM_THREADS_THETA];\npthread_mutex_t mutexMainProc[NUM_THREADS_THETA];\npthread_cond_t condThreadProc[NUM_THREADS_THETA];\npthread_cond_t condMainProc[NUM_THREADS_THETA];\n\nvoid *doProcTheta(void *threadArg) {\n    struct threadThetaData *myData = (struct threadThetaData *)threadArg;\n\n    float *theta = myData-&gt;theta;\n    float **s = myData-&gt;s;\n    float ***q = myData-&gt;q;\n    float ***g = myData-&gt;g;\n    int *Ki = myData-&gt;Ki;\n    int numObv = myData-&gt;numObv;\n    int numTask = myData-&gt;numTask;\n    int threadId = myData-&gt;threadId;\n\n    int j, k;\n\n    while(1) {\n        //printf(\"thread %d waiting for signal from master..\\n\", threadId);\n        pthread_mutex_lock(&amp;mutexThreadProc[threadId]);\n        while (statusThread[threadId] != READY)\n            pthread_cond_wait(&amp;condThreadProc[threadId], &amp;mutexThreadProc[threadId]);\n        pthread_mutex_unlock(&amp;mutexThreadProc[threadId]);\n\n        //printf(\"thread %d got signal from master..\\n\", threadId);\n\n        if (termThread[threadId] == TRUE)\n            pthread_exit(NULL);\n\n        theta[iVal[threadId]] = 0;\n        for (j = 0; j &lt; numObv; j++) {\n            for (k = 0; k &lt; numTask; k++) {\n                theta[iVal[threadId]] += (Ki[k]*(pow(fabs(q[iVal[threadId]][j][k]),2)/g[iVal[threadId]][j][k]) - s[iVal[threadId]][k])/(s[iVal[threadId]][k]*(s[iVal[threadId]][k] - (pow(fabs(q[iVal[threadId]][j][k]),2)/g[iVal[threadId]][j][k])));\n            }//k\n        }//j\n        theta[iVal[threadId]] = (numTask*numObv)/theta[iVal[threadId]];\n\n        pthread_mutex_lock(&amp;mutexMainProc[threadId]);\n        statusThread[threadId] = DONE;\n        pthread_cond_signal(&amp;condMainProc[threadId]);\n        pthread_mutex_unlock(&amp;mutexMainProc[threadId]);\n\n        //printf(\"thread %d signaled to master..\\n\", threadId);\n    }\n}\n\nvoid calcTheta(float *theta,float **s,float ***q,float ***g,int *Ki,int m, int numObv, int numTask)\n{\n    int i,j;\n\n    pthread_t thetaThreads[NUM_THREADS_THETA];\n    int numThreadBlks = m/NUM_THREADS_THETA;\n    int numThreadRem = m%NUM_THREADS_THETA;\n    int mCount = 0;\n\n    for(i=0;i&lt;NUM_THREADS_THETA;i++)\n    {\n        pthread_mutex_init(&amp;mutexThreadProc[i], NULL);\n        pthread_mutex_init(&amp;mutexMainProc[i], NULL);\n        pthread_cond_init (&amp;condThreadProc[i], NULL);\n        pthread_cond_init (&amp;condMainProc[i], NULL);\n        dataArrayTheta[i].theta = theta;\n        dataArrayTheta[i].s = s;\n        dataArrayTheta[i].q = q;\n        dataArrayTheta[i].g = g;\n        dataArrayTheta[i].Ki = Ki;\n        dataArrayTheta[i].numObv = numObv;\n        dataArrayTheta[i].numTask = numTask;\n        dataArrayTheta[i].threadId = i;\n        termThread[i] = FALSE;\n        statusThread[i] = DONE;\n        pthread_create(&amp;thetaThreads[i],NULL,doProcTheta,(void *)&amp;dataArrayTheta[i]);\n\n    }\n\n    for(i=0;i&lt;numThreadBlks;i++)\n    {\n        for(j=0;j&lt;NUM_THREADS_THETA;j++)\n        {\n            pthread_mutex_lock(&amp;mutexThreadProc[j]);\n            statusThread[j] = READY;\n            iVal[j] = mCount;\n            mCount++;\n            pthread_cond_signal(&amp;condThreadProc[j]);\n            pthread_mutex_unlock(&amp;mutexThreadProc[j]);\n            //printf(\"Signaled thread %d from master ... Waiting  on signal ..\\n\",j);\n        }\n\n        for(j=0;j&lt;NUM_THREADS_THETA;j++)\n        {\n            pthread_mutex_lock(&amp;mutexMainProc[j]);\n            while (statusThread[j] != DONE)\n                pthread_cond_wait(&amp;condMainProc[j], &amp;mutexMainProc[j]);\n            pthread_mutex_unlock(&amp;mutexMainProc[j]);\n            //printf(\"Got signal from thread %d to  master \\n\",j);\n        }\n\n    }\n\n    for(j=0;j&lt;numThreadRem;j++)\n    {\n        pthread_mutex_lock(&amp;mutexThreadProc[j]);\n        statusThread[j] = READY;\n        iVal[j] = mCount;\n        mCount++;\n        pthread_cond_signal(&amp;condThreadProc[j]);\n        pthread_mutex_unlock(&amp;mutexThreadProc[j]);\n    }\n\n    for(j=0;j&lt;numThreadRem;j++)\n    {\n        pthread_mutex_lock(&amp;mutexMainProc[j]);\n        while (statusThread[j] != DONE)\n            pthread_cond_wait(&amp;condMainProc[j], &amp;mutexMainProc[j]);\n        pthread_mutex_unlock(&amp;mutexMainProc[j]);\n    }\n\n    for(j=0;j&lt;NUM_THREADS_THETA;j++)\n    {\n        pthread_mutex_lock(&amp;mutexThreadProc[j]);\n        statusThread[j] = READY;\n        termThread[j] = TRUE;\n        pthread_cond_signal(&amp;condThreadProc[j]);\n        pthread_mutex_unlock(&amp;mutexThreadProc[j]);\n\n        pthread_join(thetaThreads[j],NULL);\n\n        pthread_mutex_destroy(&amp;mutexThreadProc[j]);\n        pthread_cond_destroy(&amp;condThreadProc[j]);\n        pthread_mutex_destroy(&amp;mutexMainProc[j]);\n        pthread_cond_destroy(&amp;condMainProc[j]);\n    }\n\n}\n</code></pre>\n\n<p>Array dimensions :</p>\n\n<pre><code>float theta[m];\nfloat s[m][numTask];\nfloat q[m][numObv][numTask];\nfloat g[m][numObv][numTask];\nint Ki[numTask];\n</code></pre>\n\n<p>For a specific dataset where </p>\n\n<pre><code>m=661\nnumObv=96\nnumTask=1024\n</code></pre>\n\n<p>the runtimes are :</p>\n\n<pre><code>Single threaded : 4.5 seconds\nMultithreaded with 2 threads : 6.9 seconds \n</code></pre>\n\n<p>I expected the runtimes for the multithreaded code to give me some performance improvement over the single threaded code when its the other way around . Any pointers to what I am missing here would be much appreciated.</p>\n"}, {"tags": ["c", "linux-device-driver", "freebsd", "device-driver", "hid"], "comments": [{"owner": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "edited": false, "score": 0, "creation_date": 1470914161, "post_id": 38870306, "comment_id": 65148727, "body": "Is this a USB-HID device, as in, it serves up HID report descriptors and reports according to the USB standard? Or is this a generic USB device, and you&#39;d like to write a driver which makes it behave like a HID device to FreeBSD? In the former case, you probably can start your driver at a higher level - the descriptor/report parsing should be reusable. (I&#39;m not a FreeBSD expert unfortunately, but have done HID stuff on OS X and Linux.)"}, {"owner": {"reputation": 31, "user_id": 6699644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fy7ud.jpg?s=128&g=1", "display_name": "Kernel_Pilgrim", "link": "https://stackoverflow.com/users/6699644/kernel-pilgrim"}, "reply_to_user": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "edited": false, "score": 0, "creation_date": 1472114500, "post_id": 38870306, "comment_id": 65625464, "body": "It is a standard HID device. I am currently using the generic uhid driver which comes with FreeBSD, both for research and to aid me in the development of the specific driver I&#39;m writing. Right now I&#39;m in the process of writing an application to be able to communicate with the device."}], "owner": {"reputation": 31, "user_id": 6699644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fy7ud.jpg?s=128&g=1", "display_name": "Kernel_Pilgrim", "link": "https://stackoverflow.com/users/6699644/kernel-pilgrim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 316, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1470823916, "creation_date": 1470823638, "last_edit_date": 1470823916, "question_id": 38870306, "link": "https://stackoverflow.com/questions/38870306/usb-hid-device-driver-development-in-freebsd", "title": "USB HID Device Driver Development in FreeBSD", "body": "<p>I am currently developing a driver for an HID device on a <strong>FreeBSD system</strong>. The idea is that the driver writes to the device's registers through the Control Endpoint. From then on the device acts according to the data fed.</p>\n\n<p>Since I have just started out on drivers, I am following a guide book (I would name it here but I don't know if I can? ). This book tackles a <strong>USB ULPT (Printer) driver</strong>, explaining the basic driver for a <strong>USB device</strong>. However when I am trying to implement these concepts to the <strong>HID device</strong>, I am having trouble, more specifically when it comes to identifying and probing the device.</p>\n\n<p>Since I haven't found much material online, I was wondering are there any guides/books or tutorials I can follow which tackle the development of an HID device driver on <strong>FreeBSD</strong> or at least <strong>Linux systems</strong>. A pointer (pun intended) to the right direction would be enough to get me going again. </p>\n"}, {"tags": ["c++", "c", "assembly", "embedded", "bootloader"], "comments": [{"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 1, "creation_date": 1470823411, "post_id": 38870023, "comment_id": 65102499, "body": "DLL? That&#39;s a Win32 thing, not embedded and certainly not related to bootloaders. In particular, DLL&#39;s run in the address space of a process. And those have <i>virtual</i> address spaces."}, {"owner": {"reputation": 1, "user_id": 6699411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b65b1db66efcaecc8da024af6240f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Mohab Altlaity", "link": "https://stackoverflow.com/users/6699411/mohab-altlaity"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1470824114, "post_id": 38870023, "comment_id": 65102960, "body": "Yes, you are write, i mean it is used as a hex and s19 files .. i don&#39;t have any ability to modify in its code .. i&#39;ll modify in the original post .. Thank you .."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1470824677, "post_id": 38870023, "comment_id": 65103322, "body": "IOW, the DLL contains an S19/hex file to burn something into an EPROM or some such, or to be used in an emulator?"}, {"owner": {"reputation": 1, "user_id": 6699411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b65b1db66efcaecc8da024af6240f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Mohab Altlaity", "link": "https://stackoverflow.com/users/6699411/mohab-altlaity"}, "edited": false, "score": 0, "creation_date": 1470825293, "post_id": 38870023, "comment_id": 65103739, "body": "To burn into EPROM .. it is used in a real target &quot;MPC&quot;"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1470825725, "post_id": 38870023, "comment_id": 65104027, "body": "What lands into EPROM, should have byte at address <code>0x00020000</code> set to <code>0xE9</code> (the other byte at <code>0x00020001</code> can be set to anything, on big-endian platform .. on little-endian it&#39;s the other way around <code>0x00020000</code> being ignored and <code>0x00020001</code> must have <code>0xE9</code>). I don&#39;t get what you are asking, whatever you put in <code>0x00040000</code> will be in <code>0x00040000</code>, unless some instruction loads that value, and puts it into <code>0x00020000</code> (on the host platform). But you probably don&#39;t ask for that, you probably want to patch the source data before being burned into EPROM?"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1470825927, "post_id": 38870023, "comment_id": 65104167, "body": "Unless you can change also the bootloader, to modify the <code>0x00020000</code> into <code>0x00040000</code>, then the 16b value at <code>0x00020000</code> will be ignored completely, and 16b value at <code>0x00040000</code> will be tested. Then again, you can then simply remove the whole check also, if you wish (if you can modify bootloader). If you can&#39;t modify bootloader, better put that <code>0xE900</code> at <code>0x00020000</code>. No way around that."}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 6231882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xXkB8.jpg?s=128&g=1", "display_name": "OpalApps", "link": "https://stackoverflow.com/users/6231882/opalapps"}, "is_accepted": false, "score": 1, "last_activity_date": 1470921802, "creation_date": 1470921802, "answer_id": 38897649, "question_id": 38870023, "link": "https://stackoverflow.com/questions/38870023/how-to-dereference-a-specific-address-in-memory-through-dereferencing-another-ad/38897649#38897649", "title": "How to dereference a specific address in memory through dereferencing another address in memory?", "body": "<p>At 0x00020000 you can put the starting point of the code that is aware of your 0x00040000 \"extensions\". Then, without any further midifications your bootloader will be booting that code as usualy, and that code (let's refer to it as a \"secodary bootloader\") will boot the code you placed under 0x00040000.</p>\n"}], "owner": {"reputation": 1, "user_id": 6699411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b65b1db66efcaecc8da024af6240f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Mohab Altlaity", "link": "https://stackoverflow.com/users/6699411/mohab-altlaity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470921802, "creation_date": 1470822993, "last_edit_date": 1470824368, "question_id": 38870023, "link": "https://stackoverflow.com/questions/38870023/how-to-dereference-a-specific-address-in-memory-through-dereferencing-another-ad", "title": "How to dereference a specific address in memory through dereferencing another address in memory?", "body": "<p>I'm using a bootloader as a hex and s19 files in my project, so i'm not allowed to modify its content. In this bootloader there is a part implemented in the following way to verify if my application is a valid application:</p>\n\n<pre><code>#define CHECK_PATTERN_ADDRESS ((int32)0x00020000)\n#define VALID_PATTERN             ((int16)0xE900)\n#define VALID_PATTERN_MASK        ((int16)0xFF00)\n\n    int16    pattern_data = *(int16 *)CHECK_PATTERN_ADDRESS;\n    if ((pattern_data &amp; VALID_PATTERN_MASK) == VALID_PATTERN)\n    {\n        //Valid application\n    }\n    else\n    {\n        //Not Valid application\n    }\n</code></pre>\n\n<p>From the above code, for the bootloader to consider my application as valid, it is needed to put the valid pattern in the mentioned address \"0x00020000\". </p>\n\n<p>This pattern is loaded directly to this address while downloading the application. </p>\n\n<p>This is done by using an assembly file containing this pattern and by specifying the address where it will be loaded in the memory through the linker file.</p>\n\n<p>So, currently the valid pattern is loaded successfully in the mentioned address \"0x00020000\" during the download process of my application.</p>\n\n<p><strong>The main constrain is:</strong></p>\n\n<p>The bootloader should find the valid pattern in this specific address \"0x00020000\"</p>\n\n<p><strong>The problem is:</strong></p>\n\n<p>I need to add my valid pattern in another address \"let's say 0x00040000\" while the DLL will keep de-referencing the data from the requested address \"0x00020000\" ..</p>\n\n<p>Still, it is Okay for me to add any data through an assembly file to the original address \"0x00020000\", or to directly add any specific hex data to this address.</p>\n\n<p><strong>The Question is:</strong></p>\n\n<p>What can i load in this address \"0x00020000\", such that when the bootloader uses it in its code \"as provided above\" it will take the values loaded in the other address \"0x00040000\"</p>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1470821776, "post_id": 38869482, "comment_id": 65101398, "body": "<code>k</code> is uninitialised."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 4, "last_activity_date": 1470821819, "creation_date": 1470821819, "answer_id": 38869563, "question_id": 38869482, "link": "https://stackoverflow.com/questions/38869482/c-program-doesnt-print-first-line-row-but-prints-all-the-others/38869563#38869563", "title": "C program doesn&#39;t print first line (row) but prints all the others", "body": "<p>The program doesn't work as you expect because you have <em>undefined behavior</em> in the code, since you use the uninitialized variable <code>k</code> before it is initialized.</p>\n\n<p>Uninitialized variables have an <em>indeterminate</em> value, and using them (except to initialize the variable) is undefined behavior.</p>\n\n<p>You should initialize <code>k</code> before you use it, not only at the end of the outer loop. Something like</p>\n\n<pre><code>for(i=rows,k=0; i&gt;=1; i--,k=0)\n//        ^^^^\n// Added initial initialization\n</code></pre>\n\n<p><strong><em>Or</em></strong> since you don't use <code>k</code> except in the <code>while</code> loop, why not turn it into a <code>for</code> loop? Like</p>\n\n<pre><code>for (int k = 0; k &lt; 2 * i - 1; ++k)\n    printf(\"* \");\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1470822304, "post_id": 38869585, "comment_id": 65101743, "body": "Looks strange but <code>gcc</code> don&#39;t emmit a warning even with <code>Wall</code> or <code>Wuninitialized</code> flags on"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1470822367, "post_id": 38869585, "comment_id": 65101789, "body": "@AlterMann: Strange indeed... I use <code>clang</code> and get the warning with <code>-Weverything</code>.  Try <code>-Wall -W</code>."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1470822641, "post_id": 38869585, "comment_id": 65101981, "body": "Yep!! related: <a href=\"http://stackoverflow.com/questions/17705880/gcc-failing-to-warn-of-uninitialized-variable\" title=\"gcc failing to warn of uninitialized variable\">stackoverflow.com/questions/17705880/&hellip;</a>"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1470822795, "post_id": 38869585, "comment_id": 65102076, "body": "mmm, it works when used with some optimization: <code>-O2</code>, really strange"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1470822891, "post_id": 38869585, "comment_id": 65102138, "body": "@AlterMann: I guess the uninitialized variable analysis is performed as a side effect of life time analysis and register allocation performed only with <code>-O2</code> and above."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1470822923, "last_edit_date": 1470822923, "creation_date": 1470821863, "answer_id": 38869585, "question_id": 38869482, "link": "https://stackoverflow.com/questions/38869482/c-program-doesnt-print-first-line-row-but-prints-all-the-others/38869585#38869585", "title": "C program doesn&#39;t print first line (row) but prints all the others", "body": "<p>You only initialize <code>k</code> in the increment part of the <code>for</code> loop... Hence <code>k</code> is uninitialized for the first iteration.  It happens to have a <code>0</code> or negative value, but its initial value is actually indeterminate: the program invokes undefined behavior.</p>\n\n<p>If you compile with <code>gcc -Wall -W -O2</code> or <code>clang -Weverything -O2</code>, the compiler will warn you about this.</p>\n\n<p>You should always use standard idioms, it helps avoid such mistakes.</p>\n\n<p>Here is an improved version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    int k, i, space, rows;\n\n    printf(\"Enter the number of rows: \");\n    if (scanf(\"%d\", &amp;rows) != 1)\n        return 1;\n\n    printf(\"\\n\");\n\n    for (i = rows; i &gt; 0; i--) {\n        for (space = 0; space &lt; rows - i; space++) {\n            printf(\"  \");\n        }\n        printf(\"smth\");\n        for (k = 0; k &lt; 2 * i - 1; k++) {\n            printf(\"* \");\n        }\n        printf(\"\\n\");\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6699185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e0418d589b7213b5b9268efb47c590?s=128&d=identicon&r=PG&f=1", "display_name": "NoName", "link": "https://stackoverflow.com/users/6699185/noname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 38869563, "answer_count": 2, "score": -1, "last_activity_date": 1470824665, "creation_date": 1470821556, "last_edit_date": 1470822738, "question_id": 38869482, "link": "https://stackoverflow.com/questions/38869482/c-program-doesnt-print-first-line-row-but-prints-all-the-others", "title": "C program doesn&#39;t print first line (row) but prints all the others", "body": "<p>I'm trying to print an inverted pyramid(or triangle) with <code>*</code>, but when I run the following code it <em>skips</em> the <code>for</code> loop for <code>i=rows</code>, i.e. doesn't print any <code>*</code>,\nthe second iteration goes <em>smoothly</em>. I assume the problem is within <code>while</code> loop but I just don't see it clearly.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int k, i, space, rows;\n\n    printf(\"Enter the number of rows: \");\n    scanf(\"%d\", &amp;rows);\n    printf(\"\\n\");\n\n    for (i = rows; i &gt;= 1; i--, k = 0) {\n        for (space = 1; space &lt;= rows - i; space++) {\n            printf(\"  \");\n        }\n        printf(\"smth\");\n        while (k &lt; 2 * i - 1) {\n            printf(\"* \");\n            k++;\n        }\n        printf(\"\\n\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "macos"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1470821519, "post_id": 38869320, "comment_id": 65101219, "body": "Using <a href=\"https://developer.apple.com/library/ios/documentation/System/Conceptual/ManPages_iPhoneOS/man3/utime.3.html\" rel=\"nofollow noreferrer\"><code>utime</code></a> wouldn&#39;t work anyway, as you can only set the access and modification times with it, not the creation time. To change the creation time the only way is to create a new file, copy the contents, and rename it as the new file. Then the creation time will be &quot;now&quot;. You can&#39;t, in user-space, change the creation time once it has been set."}, {"owner": {"reputation": 12250, "user_id": 1054378, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ee6a1ed3a298ed2a65e7c683f527860d?s=128&d=identicon&r=PG", "display_name": "herzbube", "link": "https://stackoverflow.com/users/1054378/herzbube"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1470821926, "post_id": 38869320, "comment_id": 65101500, "body": "@JoachimPileborg If you read the answer that I have referenced you will see that <code>utimes()</code> adjusts the creation time under some circumstances. <a href=\"https://www.freebsd.org/cgi/man.cgi?query=utimes&amp;sektion=2\" rel=\"nofollow noreferrer\">Here&#39;s a direct link</a> to the BSD man page of <code>utimes()</code> that specifies the behaviour. I admit that I have not tested the behaviour myself, but its operation is in evidence if you run <code>touch -t</code> on the command line and set a modification time that is older than the file&#39;s current creation time."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1470844648, "post_id": 38869320, "comment_id": 65117799, "body": "Most Unix file systems don&#39;t even store creation time."}], "answers": [{"comments": [{"owner": {"reputation": 12250, "user_id": 1054378, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ee6a1ed3a298ed2a65e7c683f527860d?s=128&d=identicon&r=PG", "display_name": "herzbube", "link": "https://stackoverflow.com/users/1054378/herzbube"}, "edited": false, "score": 0, "creation_date": 1470918960, "post_id": 38878144, "comment_id": 65152033, "body": "Thanks for taking the time to put this together. The humour is much appreciated :-) but as you note yourself, this solution is less than ideal."}, {"owner": {"reputation": 6610, "user_id": 6541659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b9f448206061d0711752562bfaf0546?s=128&d=identicon&r=PG&f=1", "display_name": "aichao", "link": "https://stackoverflow.com/users/6541659/aichao"}, "reply_to_user": {"reputation": 12250, "user_id": 1054378, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ee6a1ed3a298ed2a65e7c683f527860d?s=128&d=identicon&r=PG", "display_name": "herzbube", "link": "https://stackoverflow.com/users/1054378/herzbube"}, "edited": false, "score": 0, "creation_date": 1470919171, "post_id": 38878144, "comment_id": 65152195, "body": "Thanks for asking the question. This was the most fun I had in my 40 days on SO :-)"}, {"owner": {"reputation": 736, "user_id": 1118820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7a96c7abe238afa6c84bbbb8444224?s=128&d=identicon&r=PG", "display_name": "Able Mac", "link": "https://stackoverflow.com/users/1118820/able-mac"}, "edited": false, "score": 0, "creation_date": 1562202119, "post_id": 38878144, "comment_id": 100307426, "body": "Reminds me of a program written in High School, shrank all system fonts to 1, making it near impossible to control anything with the mouse (gag app).  Changing the system time a lot and often... that could be even worse. -- Calendars, log files, emails, expiry dates, renewal prompts, oh my!"}], "tags": [], "owner": {"reputation": 6610, "user_id": 6541659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b9f448206061d0711752562bfaf0546?s=128&d=identicon&r=PG&f=1", "display_name": "aichao", "link": "https://stackoverflow.com/users/6541659/aichao"}, "is_accepted": false, "score": 0, "last_activity_date": 1470873450, "last_edit_date": 1495535320, "creation_date": 1470844106, "answer_id": 38878144, "question_id": 38869320, "link": "https://stackoverflow.com/questions/38869320/how-do-i-change-the-creation-time-of-a-file-to-a-newer-date-in-mac-os-x/38878144#38878144", "title": "How do I change the creation time of a file to a newer date in Mac OS X?", "body": "<p>BTW, I have no idea if this is safe, secure, whatever. So, do this at your own risk.</p>\n\n<p>On OS X, you can sort of do this by setting the time of the day to the future and then copying the file (and renaming it back). It is not the same file with its creation time modified; it is a copy with the creation time you set. </p>\n\n<p>Some code (I got the code to set the time of the day from <a href=\"https://stackoverflow.com/questions/35353766/how-to-use-settimeofday2\">here</a>):</p>\n\n<pre><code>#include &lt;sys/time.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;copyfile.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc, char *argv[]) {\n  struct timeval tv_now, tv_set;\n  copyfile_state_t s;\n  struct stat st;\n  // retrieve original stat\n  if (stat(argv[2], &amp;st) &lt; 0)\n    perror(\"stat\");\n  // get current time of day\n  if (gettimeofday(&amp;tv_now, 0) == -1)\n    perror(\"gettimeofday\");\n  // set time of day to +argv[1] days\n  tv_set = tv_now;\n  tv_set.tv_sec += 86400 * atoi(argv[1]);\n  if (settimeofday(&amp;tv_set, 0) == -1)\n    perror(\"settimeofday to future\");\n  // copy the file to a temporary, copy everythig except stat\n  s = copyfile_state_alloc();\n  if (copyfile(argv[2], \".eighty_eight_miles_per_hour\", s, COPYFILE_ACL | COPYFILE_XATTR | COPYFILE_DATA) &lt; 0)\n    perror(\"copy file\");\n  copyfile_state_free(s);\n  // rename it back to original name\n  if (rename(\".eighty_eight_miles_per_hour\", argv[2]) &lt; 0)\n    perror(\"rename file\");\n  // restore file owner, group, and mode\n  if (chown(argv[2], st.st_uid, st.st_gid) &lt; 0)\n    perror(\"chown\");\n  if (chmod(argv[2], st.st_mode) &lt; 0)\n    perror(\"chmod\");\n  // reset current time of day\n  if (settimeofday(&amp;tv_now, 0) == -1)\n    perror(\"settimeofday back to now\");\n\n  return 0;\n}\n</code></pre>\n\n<p>I call this program the <code>flux_capacitor</code>. The first command line argument is the number of days forward to set the file's creation date, and the second argument is the file name. You have to run this program as <code>root</code> to set the time.</p>\n\n<p>Observe, as I send the <code>delorean</code> forward in time by 2 days.</p>\n\n<pre><code>[ronin:~/Documents/CPP] aichao% touch delorean\n[ronin:~/Documents/CPP] aichao% ls -l delorean\n-rw-r--r--  1 aichao  staff  0 Aug 10 11:43 delorean\n[ronin:~/Documents/CPP] aichao% su\nPassword:\nsh-3.2# ./flux_capacitor 2 delorean\nsh-3.2# exit\nexit\n[ronin:~/Documents/CPP] aichao% ls -l delorean\n-rw-r--r--  1 aichao  staff  0 Aug 12  2016 delorean\n[ronin:~/Documents/CPP] aichao% date\nWed Aug 10 11:43:47 EDT 2016\n</code></pre>\n\n<p>and in the Finder:</p>\n\n<p><a href=\"https://i.stack.imgur.com/68cti.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/68cti.png\" alt=\"Delorean\"></a></p>\n\n<p>Note that I only restore the original owner, group, and mode from the <code>stat</code> for the file. I don't think you can or want to do more than that, but I don't know. Obviously, links to the file will be broken.</p>\n"}, {"comments": [{"owner": {"reputation": 12250, "user_id": 1054378, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ee6a1ed3a298ed2a65e7c683f527860d?s=128&d=identicon&r=PG", "display_name": "herzbube", "link": "https://stackoverflow.com/users/1054378/herzbube"}, "edited": false, "score": 0, "creation_date": 1470918095, "post_id": 38885787, "comment_id": 65151377, "body": "I tested this with a minimal example, and it does work, indeed! Just putting together the example has been a hassle, though, because I am not familiar with Core Foundation. In the meantime, I have found an alternative that also works and that uses Objective-C / Cocoa (<a href=\"http://stackoverflow.com/a/16302660/1054378\">link to the SO answer</a>). I will go for that solution because C/C++ can easily be mixed with Objective-C, and life is so much easier with Cocoa&#39;s higher-level APIs."}], "tags": [], "owner": {"reputation": 83109, "user_id": 1312143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d64f50f989e564c337a8a8bd653b8e6?s=128&d=identicon&r=PG", "display_name": "Ken Thomases", "link": "https://stackoverflow.com/users/1312143/ken-thomases"}, "is_accepted": true, "score": 1, "last_activity_date": 1470918635, "last_edit_date": 1470918635, "creation_date": 1470877610, "answer_id": 38885787, "question_id": 38869320, "link": "https://stackoverflow.com/questions/38869320/how-do-i-change-the-creation-time-of-a-file-to-a-newer-date-in-mac-os-x/38885787#38885787", "title": "How do I change the creation time of a file to a newer date in Mac OS X?", "body": "<p>Haven't tried it, but according to the docs, the <code>NSURL</code> resource value under the key <code>NSURLCreationDateKey</code> is read-write. Since you specified C or C++, you'd use the corresponding <code>CFURL</code> API. So, you'd call:</p>\n\n<pre><code>CFURLRef url = /* ... */\nCFDateRef date = /* ... */\nCFErrorRef error;\nif (!CFURLSetResourcePropertyForKey(url, kCFURLCreationDateKey, date, &amp;error))\n    /* handle error */;\n</code></pre>\n\n<hr>\n\n<p>EDIT: A minimal example</p>\n\n<pre><code>const char* fileName = \"/path/to/file\";\nsize_t fileNameStringLength = strlen(fileName);\nBoolean isDirectory = false;\nCFURLRef url = CFURLCreateFromFileSystemRepresentation(\n   kCFAllocatorDefault,\n   (const UInt8*)fileName,\n   fileNameStringLength,\n   isDirectory);\n\n// Seconds since 1 January, 2001 00:00:00 GMT\nCFAbsoluteTime absTime = CFAbsoluteTimeGetCurrent();\nCFAbsoluteTime adjustedCreationTime = absTime - 3600;\nCFDateRef date = CFDateCreate(\n    kCFAllocatorDefault,\n    adjustedCreationTime);\n\nCFErrorRef error;\nif (!CFURLSetResourcePropertyForKey(url, kCFURLCreationDateKey, date, &amp;error))\n{\n  fprintf(stderr, \"an error occurred\\n\");\n  exit(1);\n}\n\nCFRelease(url);\nCFRelease(date);\n</code></pre>\n"}], "owner": {"reputation": 12250, "user_id": 1054378, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ee6a1ed3a298ed2a65e7c683f527860d?s=128&d=identicon&r=PG", "display_name": "herzbube", "link": "https://stackoverflow.com/users/1054378/herzbube"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 906, "favorite_count": 0, "accepted_answer_id": 38885787, "answer_count": 2, "score": 1, "last_activity_date": 1470918635, "creation_date": 1470821203, "last_edit_date": 1495541451, "question_id": 38869320, "link": "https://stackoverflow.com/questions/38869320/how-do-i-change-the-creation-time-of-a-file-to-a-newer-date-in-mac-os-x", "title": "How do I change the creation time of a file to a newer date in Mac OS X?", "body": "<p>On Mac OS X, using C and/or C++, I want to change the creation time of a file to an arbitrary date/time. I have found a number of solutions, notably <a href=\"https://stackoverflow.com/a/33587033/1054378\">this StackOverflow answer</a>, that allow to set the creation time to an <strong>older</strong> date, but this is not sufficient for me - I also want to be able to set a <strong>newer</strong> date. Using the <code>utimes()</code> function therefore is not the solution I am looking for.</p>\n\n<p>I know that setting a newer creation time must be possible somehow, because the <code>SetFile</code> utility from Apple's developer command line tools can do it, but so far my search-fu has failed to uncover any hints that bring me closer to a solution.</p>\n\n<p>Does anyone know of a way how I can achieve my goal?</p>\n\n<p>Why do I want to do this myself, why can't I use <code>SetFile</code>?</p>\n\n<ul>\n<li>The <code>SetFile</code> command line utility is deprecated (see <code>man SetFile</code>), so it's bound to go away some time in the future</li>\n<li>I want to create a utility that allows me to specify a time delta to add to/subtract from the current creation time. The <code>SetFile</code> utility does not have any convenient command line arguments to do this.</li>\n<li>Last but not least: Curiosity!</li>\n</ul>\n"}, {"tags": ["c", "arrays", "function", "char", "structure"], "comments": [{"owner": {"reputation": 1248, "user_id": 1791872, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6nnz7.png?s=128&g=1", "display_name": "flau", "link": "https://stackoverflow.com/users/1791872/flau"}, "edited": false, "score": 4, "creation_date": 1470820912, "post_id": 38869164, "comment_id": 65100701, "body": "&quot;I get an error&quot; - What error?"}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 6, "creation_date": 1470820930, "post_id": 38869164, "comment_id": 65100717, "body": "And how is <code>Filepath</code> defined and initialized?"}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1470821015, "post_id": 38869164, "comment_id": 65100794, "body": "Please add a minimal example that shows the error (and include the error in your question)."}, {"owner": {"reputation": 21405, "user_id": 453590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fbefde65228a384a59eb49e8a46c4e7b?s=128&d=identicon&r=PG", "display_name": "haylem", "link": "https://stackoverflow.com/users/453590/haylem"}, "edited": false, "score": 0, "creation_date": 1470821258, "post_id": 38869164, "comment_id": 65101001, "body": "Compiles fine for a super minimal exampel: <a href=\"https://gist.github.com/anonymous/f463003547050e14aef069974e57ad95\" rel=\"nofollow noreferrer\">gist.github.com/anonymous/f463003547050e14aef069974e57ad95</a> . What&#39;s your issue."}, {"owner": {"reputation": 7889, "user_id": 1911064, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/F8Vxe.jpg?s=128&g=1", "display_name": "Axel Kemper", "link": "https://stackoverflow.com/users/1911064/axel-kemper"}, "edited": false, "score": 2, "creation_date": 1470821385, "post_id": 38869164, "comment_id": 65101114, "body": "To copy a string, you cannot just assign it but have to use strcpy(Filepath.InstrumentDB, &quot;...&quot;)"}, {"owner": {"reputation": 123, "user_id": 6626066, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9e3fb7a16875b0cc9b6133b8d0cc2118?s=128&d=identicon&r=PG&f=1", "display_name": "Mst137", "link": "https://stackoverflow.com/users/6626066/mst137"}, "reply_to_user": {"reputation": 7889, "user_id": 1911064, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/F8Vxe.jpg?s=128&g=1", "display_name": "Axel Kemper", "link": "https://stackoverflow.com/users/1911064/axel-kemper"}, "edited": false, "score": 0, "creation_date": 1470821636, "post_id": 38869164, "comment_id": 65101301, "body": "@AxelKemper thanks, thats fixed it. The fact it worked when using char address[128]=&quot;...&quot;; is confusing though if thats the case. However I should have realised as I have had this same error before!"}, {"owner": {"reputation": 21405, "user_id": 453590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fbefde65228a384a59eb49e8a46c4e7b?s=128&d=identicon&r=PG", "display_name": "haylem", "link": "https://stackoverflow.com/users/453590/haylem"}, "edited": false, "score": 0, "creation_date": 1470822061, "post_id": 38869164, "comment_id": 65101596, "body": "@Mst137: this scenario works because it&#39;s initialization during allocation. It&#39;s a totally different case."}], "answers": [{"comments": [{"owner": {"reputation": 1248, "user_id": 1791872, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6nnz7.png?s=128&g=1", "display_name": "flau", "link": "https://stackoverflow.com/users/1791872/flau"}, "edited": false, "score": 2, "creation_date": 1470821627, "post_id": 38869473, "comment_id": 65101294, "body": "Should perhaps use <code>strncpy</code> rather than <code>strcpy</code>."}, {"owner": {"reputation": 21405, "user_id": 453590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fbefde65228a384a59eb49e8a46c4e7b?s=128&d=identicon&r=PG", "display_name": "haylem", "link": "https://stackoverflow.com/users/453590/haylem"}, "reply_to_user": {"reputation": 1248, "user_id": 1791872, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6nnz7.png?s=128&g=1", "display_name": "flau", "link": "https://stackoverflow.com/users/1791872/flau"}, "edited": false, "score": 0, "creation_date": 1470821861, "post_id": 38869473, "comment_id": 65101456, "body": "@iwin: haven&#39;t coded in C in a few years. Why would this be an issue in this simple case, where the string is a static string not coming from an input? If this was user-input or a passed variable, I&#39;d agree with you."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1470822378, "post_id": 38869473, "comment_id": 65101797, "body": "@haylem, because the struct definition may be tucked away in some header, while someone innocently changes the static initializer and forgets to count the characters."}, {"owner": {"reputation": 21405, "user_id": 453590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fbefde65228a384a59eb49e8a46c4e7b?s=128&d=identicon&r=PG", "display_name": "haylem", "link": "https://stackoverflow.com/users/453590/haylem"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1470822556, "post_id": 38869473, "comment_id": 65101921, "body": "@StoryTeller: right. So that&#39;s what I&#39;m saying: it&#39;s not an issue for this example."}, {"owner": {"reputation": 21405, "user_id": 453590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fbefde65228a384a59eb49e8a46c4e7b?s=128&d=identicon&r=PG", "display_name": "haylem", "link": "https://stackoverflow.com/users/453590/haylem"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1470822649, "post_id": 38869473, "comment_id": 65101986, "body": "@StoryTeller: and in this case, dealing with strings, then <code>strlcpy</code> would be the more correct approach anyways."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1470822689, "post_id": 38869473, "comment_id": 65102014, "body": "It is for the OP where the path is quite long. IMO answers should strive to answer the question in the best and safest way. Not just be internally correct. You got <i>my</i> vote, but I still find this a weak point in your answer."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1470822729, "post_id": 38869473, "comment_id": 65102038, "body": "Not if you are bound to using only the standard library. But we digress."}, {"owner": {"reputation": 21405, "user_id": 453590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fbefde65228a384a59eb49e8a46c4e7b?s=128&d=identicon&r=PG", "display_name": "haylem", "link": "https://stackoverflow.com/users/453590/haylem"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1470822835, "post_id": 38869473, "comment_id": 65102102, "body": "@StoryTeller: Hmm, I&#39;d generally agree, but I also sometimes find that packing too much in answer is not the right way, as it can bring deluge of - valid but overwhelming - questions for the OP. If Use strncpy, then he&#39;ll have to understand sizeof() as well, for instance. And null-terminated strings, which he may not understand yet. As the OP seemed somewhat new, I didn&#39;t want to pile too much on. Whereas if it was a question security.stackexchange.com or cryptography.stackexchange.com, I&#39;d definitely lean your way."}, {"owner": {"reputation": 21405, "user_id": 453590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fbefde65228a384a59eb49e8a46c4e7b?s=128&d=identicon&r=PG", "display_name": "haylem", "link": "https://stackoverflow.com/users/453590/haylem"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1470822918, "post_id": 38869473, "comment_id": 65102154, "body": "@StoryTeller: true about the standard library, my bad, it&#39;s not part of POSIX either. Sorry. Like i said, haven&#39;t coded C in years, so I only fired up an emacs and compiler for a quick whirl. I was more afraid that iwin was pointing out a gap in my knowledge or that my understanding got obsolete. Thanks for correcting me."}, {"owner": {"reputation": 21405, "user_id": 453590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fbefde65228a384a59eb49e8a46c4e7b?s=128&d=identicon&r=PG", "display_name": "haylem", "link": "https://stackoverflow.com/users/453590/haylem"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1470827330, "post_id": 38869473, "comment_id": 65105073, "body": "@StoryTeller: amended the answer to cover that, though by leaving the code sample in its simple form."}, {"owner": {"reputation": 21405, "user_id": 453590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fbefde65228a384a59eb49e8a46c4e7b?s=128&d=identicon&r=PG", "display_name": "haylem", "link": "https://stackoverflow.com/users/453590/haylem"}, "reply_to_user": {"reputation": 1248, "user_id": 1791872, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6nnz7.png?s=128&g=1", "display_name": "flau", "link": "https://stackoverflow.com/users/1791872/flau"}, "edited": false, "score": 1, "creation_date": 1470827337, "post_id": 38869473, "comment_id": 65105079, "body": "@iwin: amended. Thanks."}], "tags": [], "owner": {"reputation": 21405, "user_id": 453590, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fbefde65228a384a59eb49e8a46c4e7b?s=128&d=identicon&r=PG", "display_name": "haylem", "link": "https://stackoverflow.com/users/453590/haylem"}, "is_accepted": true, "score": 3, "last_activity_date": 1470827304, "last_edit_date": 1470827304, "creation_date": 1470821541, "answer_id": 38869473, "question_id": 38869164, "link": "https://stackoverflow.com/questions/38869164/passing-part-of-a-structure-in-c/38869473#38869473", "title": "Passing part of a structure in C", "body": "<h2>Invalid Initialization</h2>\n\n<p>Your code is invalid:</p>\n\n<pre><code>Address Filepath;\nFilepath.InstrumentDB = \"/root/BBBTest/Instruments.db\";\n</code></pre>\n\n<p>If I try this with a minimal example, I get this error with LLVM 7.3:</p>\n\n<pre><code>~/tmp&gt; gcc -Wall -pedantic -ansi test.c\ntest.c:19:24: error: array type 'char [128]' is not assignable\n  address.InstrumentDB = \"/root/BBBTest/Instruments.db\";\n  ~~~~~~~~~~~~~~~~~~~~ ^\n</code></pre>\n\n<p>You are attempting to override a static initializer. The memory for your InstrumentDB field is already allocated at when you create your structure. Instead, simply reuse it by copying the data you need.</p>\n\n<h2>Working Minimal Examples</h2>\n\n<h3>With a Dynamic Copy</h3>\n\n<p>This works as intended:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n\ntypedef struct {\n  char InstrumentDB[128];\n} Address;\n\nvoid OpenDatabase(char* filepath) {\n  /* do stuff */\n  printf(\"%s\\n\", filepath);\n}\n\n\nint main(int ac, char **av) {\n  Address address;\n  strcpy(address.InstrumentDB, \"test\");\n  OpenDatabase(address.InstrumentDB);\n}\n</code></pre>\n\n<p><em>A Quick Note on String Copy Actions:</em></p>\n\n<p>C-strings are null-terminated by convention. Note that in the above example I used the <code>strcpy()</code> function for the sake of simplicity. However, should your input string come from a non-static source (ie I/O of any kind like user-input, file input, ...), not be null-termined, or your software be constructed in a way that may allow to modify the intended purpose, you'd want to guard against <a href=\"https://en.wikipedia.org/wiki/Buffer_overflow\" rel=\"nofollow\">buffer overflow/overrun</a> errors by using explicit copy actions (for instance <code>strncpy</code>, or <code>strlcpy</code>/<code>lstrcpy</code>, depending on target environments).</p>\n\n<p>Thanks to users StoryTeller and iwin for pointing this out.</p>\n\n<h3>With a Static Initialization</h3>\n\n<p>Replacing the initialization line in the sample above with this would also work:</p>\n\n<pre><code>int main(int ac, char **av) {\n  Address address = {\n    \"test2\"\n  };\n  OpenDatabase(address.InstrumentDB);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1470821750, "creation_date": 1470821750, "answer_id": 38869538, "question_id": 38869164, "link": "https://stackoverflow.com/questions/38869164/passing-part-of-a-structure-in-c/38869538#38869538", "title": "Passing part of a structure in C", "body": "<p>An array cannot be assigned to.  You'll get the same type of error if you do</p>\n\n<pre><code>int main()\n{\n     char buf[10];\n     buf = \"Hello\";\n}\n</code></pre>\n\n<p>Instead, you need to use string functions</p>\n\n<pre><code>#include &lt;string.h&gt;\nint main()\n{\n     char buf[10];\n     strcpy(buf, \"Hello\");\n}\n</code></pre>\n\n<p>More generally, you need to read up on strings in C.    The reason <code>&lt;string.h&gt;</code> exists is because numerous operations involving strings (which are represented as an array of <code>char</code>) do not work in the way you are expecting.</p>\n"}], "owner": {"reputation": 123, "user_id": 6626066, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9e3fb7a16875b0cc9b6133b8d0cc2118?s=128&d=identicon&r=PG&f=1", "display_name": "Mst137", "link": "https://stackoverflow.com/users/6626066/mst137"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 38869473, "answer_count": 2, "score": 1, "last_activity_date": 1470827304, "creation_date": 1470820798, "last_edit_date": 1470824504, "question_id": 38869164, "link": "https://stackoverflow.com/questions/38869164/passing-part-of-a-structure-in-c", "title": "Passing part of a structure in C", "body": "<p>I have a structure declared like so:</p>\n\n<pre><code>typedef struct {\n    char InstrumentDB[128];\n    char GeneralSettingsDB[128];\n    char LiveDB[128];\n    char SystemsDB[128];\n} Address;\n</code></pre>\n\n<p>However when I try to call the function <code>OpenDatabase(char* filepath, ...)</code> I get an error. I call it like this: </p>\n\n<pre><code>OpenDatabase(Filepath.InstrumentDB, db);\n</code></pre>\n\n<p>However when I create a new char array of the same size but in a separate variable not attributed to the structure it works? Why is this? Surely they are of the same type?</p>\n\n<p>EDIT: Filepath.InstrumentDB is declared like this :</p>\n\n<pre><code>Address Filepath;\nFilepath.InstrumentDB = \"/root/BBBTest/Instruments.db\";\n</code></pre>\n\n<p>And this is the error i get: <code>error: incompatible types when assigning to type \u2018char[128]\u2019 from type \u2018char *\u2019</code></p>\n"}, {"tags": ["c++", "c", "windows", "mingw", "mingw-w64"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1470820862, "post_id": 38868858, "comment_id": 65100667, "body": "Maybe <a href=\"http://stackoverflow.com/a/18570757/3436922\">this answer</a> helps"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1470820900, "post_id": 38868858, "comment_id": 65100691, "body": "You can what happens using <code>perror</code>: <code>if(!tmpnam(fname)) {perror(&quot;tmpnam&quot;); exit(EXIT_FAILURE);}</code>"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1470821224, "post_id": 38868858, "comment_id": 65100980, "body": "@AlterMann I think <code>tmpnam</code> successes &#39;cause the return value is checked. The problem is that the returned file name point to root  and the program is not allowed to write there.."}, {"owner": {"reputation": 5847, "user_id": 2361316, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/zmrBr.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/2361316/joe"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1470821300, "post_id": 38868858, "comment_id": 65101037, "body": "@LPs not really. A filename beginning with a slash in windows is relative to the current partition root, not to the current folder. something neither the top voted comment nor the top voted answer appear to understand on that question. Also behavior obviously differs between MSVC and MinGW so I can&#39;t simply prepend a dot or something."}, {"owner": {"reputation": 5847, "user_id": 2361316, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/zmrBr.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/2361316/joe"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1470821362, "post_id": 38868858, "comment_id": 65101087, "body": "@AlterMann failure of tmpnam is already reported via the return code. And it doesn&#39;t fail."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1470821372, "post_id": 38868858, "comment_id": 65101095, "body": "@LPs, oh, I see, then I suggest to check <code>perror(&quot;fopen&quot;);</code>"}, {"owner": {"reputation": 5847, "user_id": 2361316, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/zmrBr.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/2361316/joe"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1470821404, "post_id": 38868858, "comment_id": 65101128, "body": "@AlterMann the return code of fopen is checked as well. that is not the issue."}, {"owner": {"reputation": 8425, "user_id": 1396822, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f2e818842b0436e98b279af7f69997cb?s=128&d=identicon&r=PG", "display_name": "aka.nice", "link": "https://stackoverflow.com/users/1396822/aka-nice"}, "edited": false, "score": 0, "creation_date": 1569354154, "post_id": 38868858, "comment_id": 102567957, "body": "I have similar behavior in cygwin64, <code>tmpnam</code> will answer \\s4so. not even trying to prepend a %TMP% directory (but such substitution does not make sense in cygwin, does it?). It badly breaks programs using <code>tmpnam</code> (for example, I cannot compile ATLAS <a href=\"http://math-atlas.sourceforge.net/\" rel=\"nofollow noreferrer\">math-atlas.sourceforge.net</a>)."}], "answers": [{"comments": [{"owner": {"reputation": 5847, "user_id": 2361316, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/zmrBr.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/2361316/joe"}, "edited": false, "score": 0, "creation_date": 1470822166, "post_id": 38868946, "comment_id": 65101655, "body": "changing the definition of <code>_P_tmpdir</code> does not magically change what <code>tmpnam</code> returns. For MinGW the only flag affecting <code>_P_tmpdir</code> <code>POSIX</code> which chooses between <code>&quot;&#47;&quot;</code> and <code>&quot;\\\\&quot;</code>. Furthermore <code>&#47;tmp</code> would be just as wrong on Windows."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 5847, "user_id": 2361316, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/zmrBr.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/2361316/joe"}, "edited": false, "score": 0, "creation_date": 1470822305, "post_id": 38868946, "comment_id": 65101746, "body": "@Joe Sorry, I&#39;m not getting you."}, {"owner": {"reputation": 5847, "user_id": 2361316, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/zmrBr.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/2361316/joe"}, "edited": false, "score": 0, "creation_date": 1470822361, "post_id": 38868946, "comment_id": 65101784, "body": "the change would have to be done at compile time of the CRT."}, {"owner": {"reputation": 5847, "user_id": 2361316, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/zmrBr.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/2361316/joe"}, "edited": false, "score": 0, "creation_date": 1470822746, "post_id": 38868946, "comment_id": 65102049, "body": "the whole <code>P_tmpdir</code> is also a POSIX thing, and not related to the C standard at all, which only specifies that <code>tmpnam</code> &quot;[...] generates a string that is a valid file name and that is not the same as the name of an existing file.&quot;"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 5847, "user_id": 2361316, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/zmrBr.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/2361316/joe"}, "edited": false, "score": 0, "creation_date": 1470822907, "post_id": 38868946, "comment_id": 65102148, "body": "Did you look at the linked linux <a href=\"http://man7.org/linux/man-pages/man3/tmpnam.3.html\" rel=\"nofollow noreferrer\">man</a>? It isn&#39;t a &quot;POSIX thing&quot; , is is conforming to C89, C99. Moreover <code>gcc</code> with <code>-std=c11</code> wanrs: <code>warning: the use of </code>tmpnam&#39; is dangerous, better use <code>mkstemp&#39;</code>"}, {"owner": {"reputation": 5847, "user_id": 2361316, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/zmrBr.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/2361316/joe"}, "edited": false, "score": 0, "creation_date": 1470823017, "post_id": 38868946, "comment_id": 65102228, "body": "That it conforms to C89/C99 doesn&#39;t mean that <code>P_tmpdir</code> wasn&#39;t added by POSIX (which it was), and is not part of the C standard. <code>mkstemp</code> is a POSIX function that does not exist on Windows, which is why that warning doesn&#39;t exist on windows."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 5847, "user_id": 2361316, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/zmrBr.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/2361316/joe"}, "edited": false, "score": 0, "creation_date": 1470823131, "post_id": 38868946, "comment_id": 65102298, "body": "BTW The issue is: that function has different implementations between platforms. So you have to manage those differences, as stated in the answer."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1470824548, "last_edit_date": 1470824548, "creation_date": 1470820269, "answer_id": 38868946, "question_id": 38868858, "link": "https://stackoverflow.com/questions/38868858/fopen-of-file-name-created-by-tmpnam-fails-on-mingw/38868946#38868946", "title": "fopen of file name created by tmpnam fails on mingw", "body": "<p>Looking at <a href=\"https://msdn.microsoft.com/en-us/library/hs3e7355.aspx\" rel=\"nofollow\">MSDN</a></p>\n\n<blockquote>\n  <ul>\n  <li><p>If the TMP environment variable is defined and set to a valid directory name, unique file names will be generated for the directory specified by TMP.</p></li>\n  <li><p>If the TMP environment variable is not defined or if it is set to the name of a directory that does not exist, <code>_tempnam</code> will use the dir parameter as the path for which it will generate unique names.</p></li>\n  <li><p>If the TMP environment variable is not defined or if it is set to the name of a directory that does not exist, and if dir is either NULL or set to the name of a directory that does not exist, <code>_tempnam</code> will use the current working directory to generate unique names. Currently, if both TMP and dir specify names of directories that do not exist, the _tempnam function call will fail.</p></li>\n  </ul>\n</blockquote>\n\n<p><sup>Emphasis mine</sup></p>\n\n<p>It seems that the behavior is redefined on windows. </p>\n\n<p>That is not the linux behavior defined my <a href=\"http://man7.org/linux/man-pages/man3/tmpnam.3.html\" rel=\"nofollow\">man</a></p>\n\n<blockquote>\n  <p>The pathname that is created, has a directory prefix <code>P_tmpdir</code>.  (Both\n         L_tmpnam and <strong>P_tmpdir are defined in <code>&lt;stdio.h&gt;</code></strong>, just like the <code>TMP_MAX</code>\n         mentioned below.)</p>\n</blockquote>\n\n<p><sup>Emphasis mine</sup></p>\n\n<p>On my system <code>P_tmpdir</code> is set to <code>\"/tmp\"</code> and the code works well returning <code>/tmp/something</code></p>\n\n<p>Moreover looking into stdio.h you can find out that the declaration of P_tmpdir has conditions:</p>\n\n<pre><code>#if defined __USE_SVID || defined __USE_XOPEN\n/* Default path prefix for `tempnam' and `tmpnam'.  */\n# define P_tmpdir   \"/tmp\"\n#endif\n</code></pre>\n\n<p>Take care of those settings: on my <code>features.h</code> file <code>__USE_SVID</code> is define to <code>1</code></p>\n\n<p>In simple words: <strong>you have to take care of the platform because windows behave differently than linux</strong></p>\n"}, {"comments": [{"owner": {"reputation": 5847, "user_id": 2361316, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/zmrBr.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/2361316/joe"}, "edited": false, "score": 1, "creation_date": 1470828075, "post_id": 38870419, "comment_id": 65105583, "body": "That the standard doesn&#39;t specify where it should be located does not mean that an implementation that never returns a usable path should be considered &quot;ok&quot;. But good to know that MSVC used to have the same bug. Probably just an artifact of MinGW blindly using msvcrt.dll (which technically shouldn&#39;t be used at all)"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1470823957, "creation_date": 1470823957, "answer_id": 38870419, "question_id": 38868858, "link": "https://stackoverflow.com/questions/38868858/fopen-of-file-name-created-by-tmpnam-fails-on-mingw/38870419#38870419", "title": "fopen of file name created by tmpnam fails on mingw", "body": "<blockquote>\n  <p>However, why does this happen? Am I missing a call, or is this a bug?</p>\n</blockquote>\n\n<p>The standard doesn't specify where the file is to be located. So this is not a bug, it's an example of two different implementations of <code>tmpnam</code></p>\n\n<p>BTW: Before Visual C++ 2015, Visual C++ also used the root of the drive. See <a href=\"https://msdn.microsoft.com/en-us/library/bb531344.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/bb531344.aspx</a> </p>\n"}], "owner": {"reputation": 5847, "user_id": 2361316, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/zmrBr.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/2361316/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 792, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1470824548, "creation_date": 1470820062, "last_edit_date": 1470821919, "question_id": 38868858, "link": "https://stackoverflow.com/questions/38868858/fopen-of-file-name-created-by-tmpnam-fails-on-mingw", "title": "fopen of file name created by tmpnam fails on mingw", "body": "<p>I have a program that generates a temporary filename via <code>tmpname</code> and attempts to open that file afterwards via <code>fopen</code>. However, this consistently fails when the program is built using MinGW, but consistently works on the same machine when built using VS2015. Here is a simple test:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char** argv)\n{\n    char fname[L_tmpnam];\n    if(!tmpnam(fname)) return EXIT_FAILURE;\n    printf(\"%s\\n\", fname);\n    FILE * f = fopen(fname, \"wb\");\n    if(!f) return EXIT_FAILURE;\n    fclose(f);\n    remove(fname);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Building and running using gcc via</p>\n\n<pre><code>gcc test.c &amp;&amp; a &amp;&amp; echo ok || echo failed\n</code></pre>\n\n<p>outputs</p>\n\n<pre><code>\\s4so.\nfailed\n</code></pre>\n\n<p>Built and run using VS2015 via</p>\n\n<pre><code>cl test.c &amp;&amp; test &amp;&amp; echo ok || echo failed\n</code></pre>\n\n<p>produces</p>\n\n<pre><code>%TMP%\\s11w.0\nok\n</code></pre>\n\n<p>where <code>%TMP%</code> is the value of the TMP environment variable.</p>\n\n<p>The reason for the failure is obvious (MinGW does not add the TMP folder and instead tries to write to the root directory of the current drive to which the user does not have write access). However, why does this happen? Am I missing a call, or is this a bug?</p>\n"}, {"tags": ["c", "gnu-make"], "comments": [{"owner": {"reputation": 6792, "user_id": 254343, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/YEat6.png?s=128&g=1", "display_name": "amn", "link": "https://stackoverflow.com/users/254343/amn"}, "edited": false, "score": 0, "creation_date": 1470817946, "post_id": 38867940, "comment_id": 65098743, "body": "Could you please provide your command line when invoking <code>make</code>? Also the platform and which <code>make</code> it is?"}, {"owner": {"reputation": 110, "user_id": 975246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f1a2d9c0b4cc406ba9d8f583073bad8?s=128&d=identicon&r=PG", "display_name": "Keroronsk", "link": "https://stackoverflow.com/users/975246/keroronsk"}, "reply_to_user": {"reputation": 6792, "user_id": 254343, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/YEat6.png?s=128&g=1", "display_name": "amn", "link": "https://stackoverflow.com/users/254343/amn"}, "edited": false, "score": 0, "creation_date": 1470818173, "post_id": 38867940, "comment_id": 65098865, "body": "I just type make in my MinGW-w64 Win64 Shell (I&#39;m running Windows 8.1)."}, {"owner": {"reputation": 110, "user_id": 975246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f1a2d9c0b4cc406ba9d8f583073bad8?s=128&d=identicon&r=PG", "display_name": "Keroronsk", "link": "https://stackoverflow.com/users/975246/keroronsk"}, "reply_to_user": {"reputation": 6792, "user_id": 254343, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/YEat6.png?s=128&g=1", "display_name": "amn", "link": "https://stackoverflow.com/users/254343/amn"}, "edited": false, "score": 0, "creation_date": 1470818229, "post_id": 38867940, "comment_id": 65098905, "body": "BTW despite this dependecy check problem, project is building properly."}, {"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "edited": false, "score": 0, "creation_date": 1470818282, "post_id": 38867940, "comment_id": 65098947, "body": "mingw, dependency problems, Windows 8.1, doesn&#39;t sound good..."}, {"owner": {"reputation": 6792, "user_id": 254343, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/YEat6.png?s=128&g=1", "display_name": "amn", "link": "https://stackoverflow.com/users/254343/amn"}, "edited": false, "score": 0, "creation_date": 1470818317, "post_id": 38867940, "comment_id": 65098970, "body": "@Keroronsk Alright, so far so good. Why do you have a dash (<code>-</code>) in front of <code>&quot;$(CC)&quot;</code>? This completely trips my attempts to test your makefile."}, {"owner": {"reputation": 110, "user_id": 975246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f1a2d9c0b4cc406ba9d8f583073bad8?s=128&d=identicon&r=PG", "display_name": "Keroronsk", "link": "https://stackoverflow.com/users/975246/keroronsk"}, "reply_to_user": {"reputation": 6792, "user_id": 254343, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/YEat6.png?s=128&g=1", "display_name": "amn", "link": "https://stackoverflow.com/users/254343/amn"}, "edited": false, "score": 0, "creation_date": 1470818463, "post_id": 38867940, "comment_id": 65099054, "body": "@amn I guess I just copy-pasted it from manual, or something. Project building without it too (just checked)."}, {"owner": {"reputation": 110, "user_id": 975246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f1a2d9c0b4cc406ba9d8f583073bad8?s=128&d=identicon&r=PG", "display_name": "Keroronsk", "link": "https://stackoverflow.com/users/975246/keroronsk"}, "edited": false, "score": 0, "creation_date": 1470818599, "post_id": 38867940, "comment_id": 65099146, "body": "Here is my complete  makefile: <a href=\"https://paste.ee/p/wZhS8\" rel=\"nofollow noreferrer\">paste.ee/p/wZhS8</a>"}, {"owner": {"reputation": 6792, "user_id": 254343, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/YEat6.png?s=128&g=1", "display_name": "amn", "link": "https://stackoverflow.com/users/254343/amn"}, "edited": false, "score": 1, "creation_date": 1470820165, "post_id": 38867940, "comment_id": 65100145, "body": "<code>make</code> only considers the first found rule when invoked without expliti target(s). If you want it to consider all your rules, move <code>all: ...</code> so that it is the first rule <code>make</code> finds."}], "answers": [{"comments": [{"owner": {"reputation": 110, "user_id": 975246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f1a2d9c0b4cc406ba9d8f583073bad8?s=128&d=identicon&r=PG", "display_name": "Keroronsk", "link": "https://stackoverflow.com/users/975246/keroronsk"}, "edited": false, "score": 0, "creation_date": 1470820739, "post_id": 38868997, "comment_id": 65100576, "body": "Thank you, now it makes sense. I guess the case is closed now."}], "tags": [], "owner": {"reputation": 887, "user_id": 5998125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GGGFf.jpg?s=128&g=1", "display_name": "Martin Hierholzer", "link": "https://stackoverflow.com/users/5998125/martin-hierholzer"}, "is_accepted": true, "score": 3, "last_activity_date": 1470820417, "creation_date": 1470820417, "answer_id": 38868997, "question_id": 38867940, "link": "https://stackoverflow.com/questions/38867940/gnu-make-ignore-all-rules-except-first/38868997#38868997", "title": "GNU Make ignore all rules except first", "body": "<p>If you just run \"make\", the first non-implicit rule gets executed, which just builds main.obj. You need to add another target building all output files, e.g. called \"all\":</p>\n\n<pre><code>all: main.obj CustomHTTPApp.obj CustomSNMPApp.obj\n\n%.obj: %.c\n    $(COMPILE)\n\nmain.obj: main.c currtype.h\n    $(COMPILE)\nCustomHTTPApp.obj: CustomHTTPApp.c currtype.h\n    $(COMPILE)\nCustomSNMPApp.obj: CustomSNMPApp.c currtype.h\n    $(COMPILE)\n\nCOMPILE = \"$(CC)\" -C $&lt; $(CFLAGS) $(INCLUDE_STACK)\n</code></pre>\n"}], "owner": {"reputation": 110, "user_id": 975246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f1a2d9c0b4cc406ba9d8f583073bad8?s=128&d=identicon&r=PG", "display_name": "Keroronsk", "link": "https://stackoverflow.com/users/975246/keroronsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 1, "accepted_answer_id": 38868997, "answer_count": 1, "score": 0, "last_activity_date": 1470820417, "creation_date": 1470817491, "question_id": 38867940, "link": "https://stackoverflow.com/questions/38867940/gnu-make-ignore-all-rules-except-first", "title": "GNU Make ignore all rules except first", "body": "<p>I have a project with a bunch of source file, some of them (but not all) must be rebuilded after one specific *.h file is changed (currtype.h). I have explicit rule for this in my makefile:</p>\n\n<pre><code>%.obj: %.c\n    $(COMPILE)\n\nmain.obj: main.c currtype.h\n    $(COMPILE)\nCustomHTTPApp.obj: CustomHTTPApp.c currtype.h\n    $(COMPILE)\nCustomSNMPApp.obj: CustomSNMPApp.c currtype.h\n    $(COMPILE)\n\nCOMPILE = -\"$(CC)\" -C $&lt; $(CFLAGS) $(INCLUDE_STACK)\n</code></pre>\n\n<p>But than I change my currtype.h I see only main.c being recompiled. If I put CustomHTTPApp on the first line and main.c on second, then only CustomHTTPApp is recompiled etc. How this can be fixed? </p>\n"}, {"tags": ["c++", "c", "windows", "curl", "uwp"], "answers": [{"comments": [{"owner": {"reputation": 524, "user_id": 6033411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9db812a6ea291d3c74b97613d59c32d8?s=128&d=identicon&r=PG&f=1", "display_name": "galsh83", "link": "https://stackoverflow.com/users/6033411/galsh83"}, "edited": false, "score": 0, "creation_date": 1470832184, "post_id": 38869481, "comment_id": 65108349, "body": "Thanks for your help. I compiled the project with /showincludes and I found that <code>winsock.h</code> gets included implicitly by the pch.h and that&#39;s where the <code>_WINSOCKAPI_</code> definition comes from. As I mentioned in my question, having <code>winsock.h</code> included does not work well in UWP, because there&#39;s a preprocessor instruction that excludes the needed typedef of <code>SOCKET</code>."}], "tags": [], "owner": {"reputation": 1022, "user_id": 1862728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11fb8c2aa0e5f1a476b0cb2a5311d59?s=128&d=identicon&r=PG", "display_name": "sb9", "link": "https://stackoverflow.com/users/1862728/sb9"}, "is_accepted": false, "score": 1, "last_activity_date": 1470821554, "creation_date": 1470821554, "answer_id": 38869481, "question_id": 38867778, "link": "https://stackoverflow.com/questions/38867778/using-curl-in-a-windows-universal-app/38869481#38869481", "title": "Using curl in a Windows Universal App", "body": "<p>Generally it should be no problem to include &lt;winsock2.h&gt; before &lt;curl/curl.h&gt;. But you're also right that it should work without that, because curl.h should include that file if necessary. \nAs it does not in your case, _WINSOCKAPI_ must be defined somewhere else. Perhaps it's defined in the preprocessor area of the project settings, i.e. it is provided via /D compiler flag. Did you already look there? Also look at the compiler command line, that is used to compile your file, is there a flag that defines _WINSOCKAPI_?</p>\n\n<p>BTW, the reason why curl includes &lt;winsock2.h&gt; conditionally is as follows: Windows has two different socket libraries, winsock and winsock2 (which is to prefer). Both cannot coexistent with each other. \nIf you need to use winsock instead of winsock2 for some reason you may include &lt;winsock.h&gt; before &lt;curl/curl.h&gt;, and it will work as well.</p>\n"}, {"tags": [], "owner": {"reputation": 524, "user_id": 6033411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9db812a6ea291d3c74b97613d59c32d8?s=128&d=identicon&r=PG&f=1", "display_name": "galsh83", "link": "https://stackoverflow.com/users/6033411/galsh83"}, "is_accepted": true, "score": 0, "last_activity_date": 1470832322, "creation_date": 1470832322, "answer_id": 38873532, "question_id": 38867778, "link": "https://stackoverflow.com/questions/38867778/using-curl-in-a-windows-universal-app/38873532#38873532", "title": "Using curl in a Windows Universal App", "body": "<p>I confirmed that <code>winsock.h</code> is being included by the following include chain: <code>pch.h &gt; collection.h &gt; agile.h &gt; wrl\\client.h &gt; unknwn.h &gt; rpc.h &gt; windows.h &gt; winsock.h</code>. <code>pch.h</code> is generated by Visual Studio, and is part of the Universal blank app template.</p>\n\n<p>My workaround is not ideal because this will get <code>winsock.h</code> and <code>winsock2.h</code> both included, and the comment in <code>curl.h</code> says they can't co-exist.</p>\n\n<p>However, I did find that in <code>windows.h</code>, the inclusion of <code>winsock.h</code> is wrapped with <code>#ifndef WIN32_LEAN_AND_MEAN</code>, i.e., I can prevent <code>winsock.h</code> from being included by adding the <code>WIN32_LEAN_AND_MEAN</code> define.</p>\n\n<p>I tried it and successfully issued a simple https request from a UWP app.</p>\n\n<p>So to summarize - when using curl in a UWP app, you must add the preprocessor definition <code>WIN32_LEAN_AND_MEAN</code>.</p>\n"}], "owner": {"reputation": 524, "user_id": 6033411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9db812a6ea291d3c74b97613d59c32d8?s=128&d=identicon&r=PG&f=1", "display_name": "galsh83", "link": "https://stackoverflow.com/users/6033411/galsh83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1405, "favorite_count": 0, "accepted_answer_id": 38873532, "answer_count": 2, "score": 2, "last_activity_date": 1470832322, "creation_date": 1470817007, "last_edit_date": 1470817887, "question_id": 38867778, "link": "https://stackoverflow.com/questions/38867778/using-curl-in-a-windows-universal-app", "title": "Using curl in a Windows Universal App", "body": "<p>I want to use curl in a Windows Universal App (x64).</p>\n\n<p>I managed to get it working, but I had to use a workaround that seems hackish, and I want to confirm that it is needed. </p>\n\n<p><strong>TL;DR</strong> - I had to add an <code>#include &lt;winsock2.h&gt;</code> statement before the <code>#include &lt;curl\\curl.h&gt;</code> statement, to get it to work. I want to know if it\u2019s truly needed on UWP.</p>\n\n<p>I built curl with openssl by following the curl install guide <a href=\"https://curl.haxx.se/docs/install.html]\" rel=\"nofollow\">here</a>. I created a blank universal app in Visual Studio 2015 update 3, and added curl and openssl binaries and includes in the appropriate places. Then added a <code>#include &lt;curl\\curl.h&gt;</code> at the top of the file and got the following error:</p>\n\n<p><code>error C4430: missing type specifier - int assumed. Note: C++ does not support default-int</code> for the line <code>typedef SOCKET curl_socket_t;</code> in <code>curl.h</code>.</p>\n\n<p>At the top of <code>curl.h</code> I saw that the following preprocessor macros prevent the inclusion of <code>winsock2.h</code> which defines <code>SOCKET</code>:</p>\n\n<pre><code>#if !(defined(_WINSOCKAPI_) || defined(_WINSOCK_H) || \\\n      defined(__LWIP_OPT_H__) || defined(LWIP_HDR_OPT_H))\n/* The check above prevents the winsock2 inclusion if winsock.h already was\n   included, since they can't co-exist without problems */\n    #include &lt;winsock2.h&gt;\n    #include &lt;ws2tcpip.h&gt;\n#endif\n</code></pre>\n\n<p>Removing the <code>defined(_WINSOCKAPI_)</code> condition restores the statement and everything compiles fine, meaning that somewhere <code>winsock.h</code> is included and that on UWP it does not defined <code>SOCKET</code>.</p>\n\n<p>Indeed, looking at <code>winsock.h</code> I can see that the <code>typedef</code> which defines <code>SOCKET</code> is wrapped with </p>\n\n<pre><code>#if WINAPI_FAMILY_PARTITION(WINAPI_PARTITION_DESKTOP)\n</code></pre>\n\n<p>which does not hold for a universal app.</p>\n\n<p>However, in <code>winsock2.h</code> there\u2019s an equivalent <code>typedef</code> for <code>SOCKET</code> which is not dropped by the preprocessor.</p>\n\n<p>Adding <code>#include &lt;winsock2.h&gt;</code> before the <code>#include &lt;curl\\curl.h&gt;</code> statement makes everything work, but I suspect this is not the best way to solve this issue.</p>\n\n<p>So my question is, is this the proper way to use curl on UWP or has anyone found a better solution?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "postgresql", "postgres-ext"], "comments": [{"owner": {"reputation": 847, "user_id": 1123335, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kvTBl.jpg?s=128&g=1", "display_name": "pnorton", "link": "https://stackoverflow.com/users/1123335/pnorton"}, "edited": false, "score": 0, "creation_date": 1470856067, "post_id": 38867671, "comment_id": 65124310, "body": "Have you thought about using Cygwin? Ref <a href=\"https://www.cygwin.com/\" rel=\"nofollow noreferrer\">cygwin.com</a>"}], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 5293873, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FFh_cD_aWUA/AAAAAAAAAAI/AAAAAAAAACU/SI3ALLu78UE/photo.jpg?sz=128", "display_name": "Michael Jameson", "link": "https://stackoverflow.com/users/5293873/michael-jameson"}, "is_accepted": false, "score": 0, "last_activity_date": 1524090735, "last_edit_date": 1524090735, "creation_date": 1501110420, "answer_id": 45338835, "question_id": 38867671, "link": "https://stackoverflow.com/questions/38867671/how-to-install-pgaudit-extension/45338835#45338835", "title": "How to install pgAudit extension?", "body": "<p>The BigSQL distribution of postgreSQL comes with tools to install community extensions like pgAudit. See <a href=\"https://www.openscg.com/bigsql/docs/security/pgaudit\" rel=\"nofollow noreferrer\">https://www.openscg.com/bigsql/docs/security/pgaudit</a> for details.</p>\n\n<p>Alternatively, you can follow the steps <a href=\"https://wiki.postgresql.org/wiki/Building_and_Installing_PostgreSQL_Extension_Modules#Building_in_contrib_in_a_build_tree\" rel=\"nofollow noreferrer\">here</a> to build the dll yourself. I have successfully used this method to create a working distribution with pgAudit.</p>\n"}], "owner": {"reputation": 524, "user_id": 2837853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a78407de6540e9bcf0793fcfac2b574c?s=128&d=identicon&r=PG&f=1", "display_name": "mban94", "link": "https://stackoverflow.com/users/2837853/mban94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2779, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1550907572, "creation_date": 1470816606, "question_id": 38867671, "link": "https://stackoverflow.com/questions/38867671/how-to-install-pgaudit-extension", "title": "How to install pgAudit extension?", "body": "<p>I have postgreSQL 9.5 installed on Windows. I've cloned <a href=\"https://github.com/pgaudit/pgaudit\" rel=\"nofollow\">pgAudit</a> repository and tried to install but there is no dll file in this repository and I could not build it.</p>\n\n<p>I am new to postgreSQL extensions, so anybody know the better way to do this? or what I have to do to install this extension?</p>\n"}, {"tags": ["c", "struct", "synchronization", "pthreads", "mutex"], "comments": [{"owner": {"reputation": 685, "user_id": 6475848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5Dkrb.jpg?s=128&g=1", "display_name": "Raskayu", "link": "https://stackoverflow.com/users/6475848/raskayu"}, "edited": false, "score": 0, "creation_date": 1470817536, "post_id": 38867429, "comment_id": 65098524, "body": "I recomend use <a href=\"http://stackoverflow.com/questions/15182328/semaphore-implementation\">Semaphores</a> insted of mutex to syncronize threads"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1470819198, "post_id": 38867429, "comment_id": 65099516, "body": "In order to evaluate a solution, it&#39;s necessary to understand what the problem is. To me this seems a XY problem. See <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\" title=\"what is the xy problem\">meta.stackexchange.com/questions/66377/what-is-the-xy-proble&zwnj;&#8203;m</a>"}, {"owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 0, "creation_date": 1470820115, "post_id": 38867429, "comment_id": 65100113, "body": "The problem is that I create code like task queue, thread pool, threads manager, that all use global synchronization objects. Than I realize what if I now need to create too such globally synchronized threads managers or threads pools? I will have separated thread pools/thread managers 1) to receive and handle requests from client and 2) to send server events notifications. And such thread pools/thread managers will reuse the same global mutex which seems to me odd. So I ask whether associating this mutexes, cond vars, with instances (structs) is a good and safe idea."}], "answers": [{"comments": [{"owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 0, "creation_date": 1470818735, "post_id": 38867642, "comment_id": 65099222, "body": "But if i use them while enqueueing/dequeueing task on the queue enqueue()/dequeue() operations how the queue could not exists. Yeah I think mutex should be global only if there isn&#39;t possible do get access to struct object. But if I have functions like: task_queue_init(), task_queue_destroy(), task_queue_enqueue(), task_queue_dequeue(), etc that takes as it&#39;s first param task queue object than inside this method synchronization object is always available from task_queue struct"}, {"owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 0, "creation_date": 1470818783, "post_id": 38867642, "comment_id": 65099251, "body": "I think that problem with this mutex, cond as fields of struct will be only i I would like to use signals and signal_handlers as there isn&#39;t possible to pass arguments"}, {"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "reply_to_user": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 0, "creation_date": 1470818978, "post_id": 38867642, "comment_id": 65099373, "body": "@Micha\u0142Ziobro you can delete queue while there will be still pointers in your code to deleted queue, you can&#39;t then use these pointers to acquire the mutex"}, {"owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 0, "creation_date": 1470819555, "post_id": 38867642, "comment_id": 65099756, "body": "yeah but yo think that using mutex as global variable is better approach? If I create 2 separate task queues and will use them simultanously than mutex will be reused between both task queues. I have also thread pool synchornized with mutex so I use in my app 2 thread pools and they reuse 1 global mutex it seems odd, I think it is more logical when given instance of data structure have it&#39;s own mutex or cond variable."}, {"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "reply_to_user": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 0, "creation_date": 1470822474, "post_id": 38867642, "comment_id": 65101862, "body": "each queue can have it&#39;s own mutex, you can store them in global table"}, {"owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 0, "creation_date": 1470822754, "post_id": 38867642, "comment_id": 65102056, "body": "Global table is better than storing them inside struct?"}, {"owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 0, "creation_date": 1470823589, "post_id": 38867642, "comment_id": 65102617, "body": "&quot;still pointers in your code to deleted queue&quot; when I deleted queue it means I don&#39;t want it to be used anymore in program? So what&#39;s the problem here? If queue is deallocated what is the aim of accessing it somewhere else? Mutex will be associated with this queue so when it doesn&#39;t exists why I need to use it to sync access to deallocated queue?"}, {"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "reply_to_user": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 0, "creation_date": 1470823659, "post_id": 38867642, "comment_id": 65102663, "body": "This wasn&#39;t answer to what is better but a hint to address your problem about having one mutex per all queues - you can have table of mutexes, each per queue. Addressing your last comment: the need to access queue would be the same as usually, but problem is you may not know that queue has been deleted, when you delete from one thread while other threads keep pointers to that queue."}, {"owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "edited": false, "score": 0, "creation_date": 1470823763, "post_id": 38867642, "comment_id": 65102733, "body": "Nonetheless I think Global Table is also good concept that I will think more about but It seems this solution needs more code. Such table should be variable length so reallocation in C needed, etc. Some association needed between struct and global table. Here what If struct is deallocated? Than index of mutex in Global Table is also lost. So I need to check if struct is null or not!"}], "tags": [], "owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "is_accepted": false, "score": 0, "last_activity_date": 1470816539, "creation_date": 1470816539, "answer_id": 38867642, "question_id": 38867429, "link": "https://stackoverflow.com/questions/38867429/synchronization-objects-in-c-and-its-association-with-structs-of-data-structures/38867642#38867642", "title": "Synchronization objects in C and its association with structs of data structures", "body": "<p>If you plan to use task queue from places in the code where you can't guarantee task queue still exists then mutex and condition variable can't be a member variables - you must be sure at least they exist so you can touch them.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6695299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5738953c340684736032a7fe61b3f27f?s=128&d=identicon&r=PG&f=1", "display_name": "F. Anklam", "link": "https://stackoverflow.com/users/6695299/f-anklam"}, "is_accepted": false, "score": 1, "last_activity_date": 1470825107, "last_edit_date": 1470825107, "creation_date": 1470824087, "answer_id": 38870475, "question_id": 38867429, "link": "https://stackoverflow.com/questions/38867429/synchronization-objects-in-c-and-its-association-with-structs-of-data-structures/38870475#38870475", "title": "Synchronization objects in C and its association with structs of data structures", "body": "<p>(Beforehand I should mention I am coming from OpenMP and WinAPI, not POSIX.)</p>\n\n<p>The optimal solution is depending on the structure, information passing between and runtime-behaviour of the tasks.</p>\n\n<p>If my understanding of the question is correct, it is intended to allocate the task queues and their necessary infrastructure at runtime. In this case placing the infrastructure in the structs is not incorrect. To my knowledge in most cases allocation at runtime is done as heap allocation which in turn means read/write access from all tasks of the process to the same locations in the heap memory of the process. Depending on the frequency of accesses this may or may not cause performance issues (\"false sharing\", as a rule of thumb try to avoid process-global data).</p>\n\n<p>If(!) on the other hand ...</p>\n\n<p>a) more than one (master) tasks will exist, each using it's own task queues and their necessary infrastructure</p>\n\n<p>b.1) either an enqueued (worker) task does not need to access the infrastructure of it's task queue</p>\n\n<p>b.2) or information about the task queue's infrastructure is passed between an enqueued (worker) task and it's using (master) task (task-/thread-private copies in and out)</p>\n\n<p>... it is possible to avoid some of the memory access issues by allocation on the stack memory of the using (master) task. In this case I would use arrays with a predefined, sufficient size. This could be a single one-dimensional array of structs as you propose. It would be also possible to use various one-dimensional arrays, each with the same number of elements. Each of the arrays holds elements of one type of information: one array for the task queues, one array for the task queue's mutexes and so on. Then the same task queue and it's infrastructure is accessed by accessing the various arrays with the same array index. Depending on circumstance this can be of advantage in passing information about the task queue in and out of the enqueued (worker) tasks.</p>\n"}], "owner": {"reputation": 7138, "user_id": 4415642, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/253d1dc6571ed728099ff96b693f5b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Ziobro", "link": "https://stackoverflow.com/users/4415642/micha%c5%82-ziobro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1470825107, "creation_date": 1470815860, "question_id": 38867429, "link": "https://stackoverflow.com/questions/38867429/synchronization-objects-in-c-and-its-association-with-structs-of-data-structures", "title": "Synchronization objects in C and its association with structs of data structures", "body": "<p>I have written some data structures in C like task queue used by thread pool. It is synchronized with mutex and conditional variable objects. \nI make it like this: </p>\n\n<pre><code>struct task_queue { \n  // some fields\n};\n\ntypedef struct task_queue task_queue_t; \n\nstatic pthread_mutex_t mutex; \nstatic pthread_cond_t cond; \n\ntask_queue_init(task_queue_t **tq);\ntask_queue_destroy(task_queue_t *tq); \n</code></pre>\n\n<p>But now I think that such approach is rather wrong as when I create with <strong>task_queue_init()</strong> several instances of task_queue struct in my program than they will be synchronized by the same pthread_mutex_t, pthread_cond_t objects. I think that I have seen such <strong>static</strong> synchronization objects declarations somewhere previously and I have used it in my code. </p>\n\n<p>My question is to make sure myself that I am planning to do it right way i.e put this synchronization objects always inside this struct task_queue, or other synchronized data structure struct like below: </p>\n\n<pre><code>struct task_queue { \n   // hitherto fields\n   pthread_mutex_t mutex;\n   pthread_cond_t cond; \n}\ntypedef struct task_queue task_queue_t; \n\n//and initialize/destroy them in \ntask_queue_init(task_queue_t **tq); \ntask_queue_destroy(task_queue_t *tq); \n</code></pre>\n\n<p>Maybe I should use pointers to mutex, cond in this struct?</p>\n"}, {"tags": ["c", "macros", "posix"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1470813928, "post_id": 38866686, "comment_id": 65096368, "body": "When you get a crash such as segmentation fault, your first action should not be to redefine special macros. Instead it should be to <i>debug</i> the application, to find the location and the cause of the crash. Just because it <i>seems</i> to work, it&#39;s not guaranteed that the underlying problem is actually fixed. You might still have the undefined behavior in the code, and the crash (or other unexpected behavior) might come back when you least expect it."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 2, "creation_date": 1470814016, "post_id": 38866686, "comment_id": 65096423, "body": "Is your code multi-threaded? That could explain it because <code>199506</code> introduced threads (and without it your C library may not include thread safety constructs). Otherwise, it&#39;s hard to tell without looking at any code."}, {"owner": {"reputation": 353, "user_id": 4780122, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1573344742944271/picture?type=large", "display_name": "AjanO", "link": "https://stackoverflow.com/users/4780122/ajano"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1470830610, "post_id": 38866686, "comment_id": 65107263, "body": "@Joachim: Thx for your suggestion. I am aware that my approach is not a professional one. Unfortunately, my debugging skills are almost inexistent."}, {"owner": {"reputation": 353, "user_id": 4780122, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1573344742944271/picture?type=large", "display_name": "AjanO", "link": "https://stackoverflow.com/users/4780122/ajano"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1470830632, "post_id": 38866686, "comment_id": 65107279, "body": "@P.P. : Thank you for your replay. I have to check more what multi-thread means and if it exists in this context."}, {"owner": {"reputation": 353, "user_id": 4780122, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1573344742944271/picture?type=large", "display_name": "AjanO", "link": "https://stackoverflow.com/users/4780122/ajano"}, "edited": false, "score": 0, "creation_date": 1473179903, "post_id": 38866686, "comment_id": 66037619, "body": "@PP: You were correct."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 3165727, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004879325047/picture?type=large", "display_name": "Terrance Chen", "link": "https://stackoverflow.com/users/3165727/terrance-chen"}, "is_accepted": false, "score": 1, "last_activity_date": 1470831870, "last_edit_date": 1470831870, "creation_date": 1470814878, "answer_id": 38867112, "question_id": 38866686, "link": "https://stackoverflow.com/questions/38866686/macro-posix-c-source/38867112#38867112", "title": "Macro posix_c_source", "body": "<p>though it is only 1 line of code,but it may make big difference,POSIX is a standard,it define the interface between OS and applications,and it has many different version(you can think it similar with a hardware USB standard , it has many version, like USB 1.0 and USB 2.0).</p>\n\n<p>sometimes programmer can't determine which platform the program will be work on , it may run on Linux , may run on windows, maybe the system provide old standard interface, maybe a new one.</p>\n\n<p>So , programmer add this kind of macros, write codes for many different interface,for example ,a source code like this:</p>\n\n<pre><code>#define WIN\n#ifdef WIN\n    &lt;part 1:1000 lines of code&gt;\n#endif\n#ifdef LINUX\n    &lt;part 2:1000 lines of code&gt;\n#endif \n    &lt;1000 lines that not depend on system , can both run on Linux and Windows.&gt;\n</code></pre>\n\n<p>the compiler will compile part 1(discard part 2), but when you change  <strong>#define WIN</strong> to <strong>#define LINUX</strong> , it will contain part 2(and discard part 1) ! you may think you only changed 1 line , but the compiler may choose or discard thousands of lines (maybe even more ,maybe less, that depend on the code)</p>\n"}], "owner": {"reputation": 353, "user_id": 4780122, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1573344742944271/picture?type=large", "display_name": "AjanO", "link": "https://stackoverflow.com/users/4780122/ajano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470831870, "creation_date": 1470813655, "question_id": 38866686, "link": "https://stackoverflow.com/questions/38866686/macro-posix-c-source", "title": "Macro posix_c_source", "body": "<p>I have the original code that is meant to compile in Windows and Linux using gcc.\nIt works fine even under cygwin. Now, when I try to compile for iOS</p>\n\n<pre><code>echo $OSTYPE\ndarwin14\n</code></pre>\n\n<p>everything seems fine and a build is successfully obtained. However, when I tried to run the CUI app, a message <strong>Segmentation fault 11</strong> is displayed.</p>\n\n<p>After a couple of days searching on internet, by chance I found this <a href=\"http://www.gnu.org/software/libc/manual/html_node/Feature-Test-Macros.html\" rel=\"nofollow\">link</a>.</p>\n\n<p>As a result, I made the following change in one of the *.c file</p>\n\n<pre><code>-#define _POSIX_C_SOURCE 199309\n+#define _POSIX_C_SOURCE 199506\n</code></pre>\n\n<p>and the new build works fine. Although I am not a programmer, I am wondering what would be so significant different between these two macros? Could you comment on why such change becomes so significant.</p>\n"}, {"tags": ["c", "visual-studio-2015", "32bit-64bit"], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 4, "last_activity_date": 1470813181, "creation_date": 1470813181, "answer_id": 38866537, "question_id": 38866493, "link": "https://stackoverflow.com/questions/38866493/format-specifier-32-bit-64-bit/38866537#38866537", "title": "Format specifier 32 bit - 64 bit", "body": "<p>The <em>type</em> of <code>sizeof</code> is a <code>size_t</code>.</p>\n\n<p>Use <code>%zu</code> as the format specifier for that type. It's guaranteed to be well-defined for all platforms.</p>\n"}], "owner": {"reputation": 371, "user_id": 1829080, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QSjVx.jpg?s=128&g=1", "display_name": "pistach", "link": "https://stackoverflow.com/users/1829080/pistach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 1, "closed_date": 1470815803, "accepted_answer_id": 38866537, "answer_count": 1, "score": 2, "last_activity_date": 1470813181, "creation_date": 1470813006, "question_id": 38866493, "link": "https://stackoverflow.com/questions/38866493/format-specifier-32-bit-64-bit", "closed_reason": "Duplicate", "title": "Format specifier 32 bit - 64 bit", "body": "<p>I'm using Visual Studio 2015 to build a project on 32bit platform and on 64 bit platform.</p>\n\n<p>Sizeof returns an unsigned int in the 32 bit platform and an unsigned __int64 in the 64 bit platform.</p>\n\n<p>I have the following code : </p>\n\n<pre><code>printf (\"limit is %u. \\n\",sizeof(var));\n</code></pre>\n\n<p>I need to compile the same code on both platforms. Using the format specifier %u gives a warning in 64bit, using %I64u gives a warning in 32bit. Is there a way to use a formatspecifier on both platforms without writing the printf 2 times (with ifdef _WIN32). I have a lot of these warnings in my project. This would be a lot of work and wouldn't look 'clean'.</p>\n"}, {"tags": ["c++", "c", "macos", "gcc"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1470817813, "post_id": 38866379, "comment_id": 65098674, "body": "The clang compiler should be fine, and the Accelerate framework should already be installed."}], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 578465, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f3388f247328aad3ee4ca25a1cfed4fe?s=128&d=identicon&r=PG&f=1", "display_name": "sdeveloper", "link": "https://stackoverflow.com/users/578465/sdeveloper"}, "is_accepted": false, "score": 0, "last_activity_date": 1470846327, "last_edit_date": 1495539859, "creation_date": 1470846327, "answer_id": 38878879, "question_id": 38866379, "link": "https://stackoverflow.com/questions/38866379/building-levmar-on-mac-yosemite/38878879#38878879", "title": "Building levmar on Mac Yosemite", "body": "<p>I used the Makefile from <a href=\"https://stackoverflow.com/questions/2539735/trying-to-build-the-levmar-math-library-on-a-mac-using-the-accelerate-framework\">Trying to build the LEVMAR math library on a mac using the Accelerate Framework</a> posted by Janos and it works for levmar-2.6 using clang and Accelerate framework. </p>\n"}], "owner": {"reputation": 129, "user_id": 578465, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f3388f247328aad3ee4ca25a1cfed4fe?s=128&d=identicon&r=PG&f=1", "display_name": "sdeveloper", "link": "https://stackoverflow.com/users/578465/sdeveloper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470846327, "creation_date": 1470812550, "last_edit_date": 1495539859, "question_id": 38866379, "link": "https://stackoverflow.com/questions/38866379/building-levmar-on-mac-yosemite", "title": "Building levmar on Mac Yosemite", "body": "<p>Hi I want to build levmar (Levenberg Marquardt) C++ library on Mac. It comes with a makefile (<a href=\"http://users.ics.forth.gr/~lourakis/levmar/index.html\" rel=\"nofollow noreferrer\">http://users.ics.forth.gr/~lourakis/levmar/index.html</a>) but I have some questions about how to use it on Mac (Yosemite)</p>\n\n<p>(1) The gcc I have currently installed on Mac is in fact clang. I can confirm this if I run gcc -v on the terminal. Should I install proper gcc before building levmar?</p>\n\n<p>(2) Levmar recommends using LAPACK (Linear Algebra Library). Again, I have been reading on another stack overflow post (<a href=\"https://stackoverflow.com/questions/2539735/trying-to-build-the-levmar-math-library-on-a-mac-using-the-accelerate-framework\">Trying to build the LEVMAR math library on a mac using the Accelerate Framework</a>) that they were using Mac OS Accelerate framework that comes with LAPACK. Does anyone know how do I get that on yosemite? Or should I be building LAPACK standalone on mac first?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c", "file", "random"], "comments": [{"owner": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "edited": false, "score": 1, "creation_date": 1470812614, "post_id": 38866364, "comment_id": 65095626, "body": "number is declared as a char pointer!"}, {"owner": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "edited": false, "score": 0, "creation_date": 1470813962, "post_id": 38866364, "comment_id": 65096387, "body": "you didn&#39;t understand my hint....."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1470816872, "post_id": 38866364, "comment_id": 65098136, "body": "You could also just use the <i>openssl</i> library and generate a sha512 sum on a string or file and take any 50 digits you like."}], "answers": [{"tags": [], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "is_accepted": true, "score": 1, "last_activity_date": 1470816436, "last_edit_date": 1495540458, "creation_date": 1470813098, "answer_id": 38866514, "question_id": 38866364, "link": "https://stackoverflow.com/questions/38866364/generating-a-very-large-random-number-and-storing-it-in-string-buffer-and-writin/38866514#38866514", "title": "Generating a very large random number and storing it in string buffer and writing it to file", "body": "<pre><code>char buf1[50], *number;\nnumber = rand() % 100000000000000000000000000000000000000000000000000000000000000000000000;\n</code></pre>\n\n<p>First, <code>number</code> is a <code>char *</code> and <code>rand</code> returns <code>int</code>. Second, since <code>int</code> can't hold more than 2 <strong><em>to the power of 32</em></strong> - 1, using modulo with such a high number (10^???) is useless. I would suggest looking at <a href=\"https://stackoverflow.com/questions/13503671/random-number-bigger-than-100-000\">this answer</a> for a portable solution for 64-bit numbers, but it's still lower than what you tried</p>\n\n<p><strong>EDIT:</strong> second option, that would enable you to generate as-big-as-you-want numbers can be this:</p>\n\n<ol>\n<li>create a large array (number of digits)</li>\n<li>generate random digit ( 0 &lt;= x &lt;= 9)</li>\n<li>append this digit to array</li>\n<li>repeat until you have the number of digits you want</li>\n</ol>\n\n<p><strong><em>EXAMPLE:</em></strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main(void) {\ntime_t t;\nint i = 0;\nsrand((unsigned) time(&amp;t));\n\nconst int SIZE = 1500;\nchar num[SIZE];\nfor(i = 0; i &lt; SIZE; i++)\n    num[i] = (char)(rand() % 10 + 48);\nnum[SIZE] = '\\0';\nprintf(\"%s\", num);\ngetchar();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 6364347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30fc237ee4b05c9da4087a3f721c6eda?s=128&d=identicon&r=PG&f=1", "display_name": "baldychristophe", "link": "https://stackoverflow.com/users/6364347/baldychristophe"}, "is_accepted": false, "score": 1, "last_activity_date": 1470813511, "creation_date": 1470813511, "answer_id": 38866639, "question_id": 38866364, "link": "https://stackoverflow.com/questions/38866364/generating-a-very-large-random-number-and-storing-it-in-string-buffer-and-writin/38866639#38866639", "title": "Generating a very large random number and storing it in string buffer and writing it to file", "body": "<p>Why don't you concatenate in one string several randomly generated <code>unsigned int</code> up until you have a \"number\" with the right number of digits? </p>\n"}, {"tags": [], "owner": {"reputation": 14257, "user_id": 820127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f8fffeec4f2ba3e75aebe941e4e5dd?s=128&d=identicon&r=PG", "display_name": "rossum", "link": "https://stackoverflow.com/users/820127/rossum"}, "is_accepted": false, "score": 0, "last_activity_date": 1470829898, "creation_date": 1470829898, "answer_id": 38872665, "question_id": 38866364, "link": "https://stackoverflow.com/questions/38866364/generating-a-very-large-random-number-and-storing-it-in-string-buffer-and-writin/38872665#38872665", "title": "Generating a very large random number and storing it in string buffer and writing it to file", "body": "<ol>\n<li><p>Declare a character array, <code>digits[]</code> long enough to hold your number and the terminating \\0.</p></li>\n<li><p>Pick a random character in the range '1'..'9' and put it in <code>digits[0]</code>.  This avoids leading zeros.</p></li>\n<li><p>Pick a random character in the range '0'..'9' and put it in the next vacant position in <code>digits[]</code>.</p></li>\n<li><p>Repeat #3 until <code>digits[]</code> has only the last slot unfilled.</p></li>\n<li><p>Insert the terminating \\0 into the last position of <code>digits[]</code>.</p></li>\n</ol>\n\n<p>You now have your large number in a character array/string.  I assume you can write a string to a file.</p>\n"}], "owner": {"reputation": 29, "user_id": 6672731, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/deed890bb53c43bdae760dc3fd5df24c?s=128&d=identicon&r=PG&f=1", "display_name": "Naman", "link": "https://stackoverflow.com/users/6672731/naman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 38866514, "answer_count": 3, "score": -1, "last_activity_date": 1470829898, "creation_date": 1470812515, "question_id": 38866364, "link": "https://stackoverflow.com/questions/38866364/generating-a-very-large-random-number-and-storing-it-in-string-buffer-and-writin", "title": "Generating a very large random number and storing it in string buffer and writing it to file", "body": "<p>I'm making a C code that generates a very large random number(say 50 digits), and then store it in the string buffer and copy this to a text file. \nPlease refer the code that I have written for the same:</p>\n\n<pre><code>FILE *fp;\nchar first_num[MAX];\nchar second_num[MAX];\nchar *answer;\nint i,test_cases,numbers;\n\n\nfp = fopen(\"data.txt\", \"w+\");\nif(fp==NULL)\n{\n    printf(\"Error opening file\\n\");\n    exit(1);\n}  \nprintf(\"How many number combinations you wish to enter?\\n\");\nscanf(\"%d\",&amp;numbers);\nfor(i=0;i&lt;(2*numbers);i++)\n{\n    char buf1[50], *number;\n    number = rand() % 100000000000000000000000000000000000000000000000000000000000000000000000;\n    sprintf(buf1, \"%s\", number);\n    fprintf(fp,\"%s\",buf1);\n}\n\nfclose(fp);\n</code></pre>\n\n<p>But I get a floating point exception and my code is dumped.\nCan anyone help me out in the same. I'm actually trying to multiply those random numbers once they are stored in the file as strings.</p>\n"}, {"tags": ["c", "multithreading", "serial-port", "uart", "tty"], "comments": [{"owner": {"reputation": 685, "user_id": 6475848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5Dkrb.jpg?s=128&g=1", "display_name": "Raskayu", "link": "https://stackoverflow.com/users/6475848/raskayu"}, "edited": false, "score": 0, "creation_date": 1470812175, "post_id": 38866144, "comment_id": 65095389, "body": "So, you have 2 COM ports with 2 threads, 1 port for thread. The thread writes to it&#39;s COM port or to a common one?"}, {"owner": {"reputation": 186, "user_id": 6685157, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BV9ax8DzQo4/AAAAAAAAAAI/AAAAAAAABbI/prpGhFH7U9o/photo.jpg?sz=128", "display_name": "Sathish V", "link": "https://stackoverflow.com/users/6685157/sathish-v"}, "edited": false, "score": 0, "creation_date": 1470813037, "post_id": 38866144, "comment_id": 65095858, "body": "The code you given is single thread in which you are trying to read from one port(rfidcom) and write to other port(uartCom). So Inside the thread the code is sequential. so no way write is asynchronous. Write will get execute once read is done reading from rfid device(100 bytes or less than that). Is its the case that the buffer size what is given to read is small?"}, {"owner": {"reputation": 159, "user_id": 808136, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/044e97258a634ae811714a90fa901b70?s=128&d=identicon&r=PG", "display_name": "Tobi", "link": "https://stackoverflow.com/users/808136/tobi"}, "edited": false, "score": 0, "creation_date": 1470813358, "post_id": 38866144, "comment_id": 65096025, "body": "Sorry, maybe the question was misleading. It&#39;s ok for &#39;write&#39; to write only what was received in read. At the UART side I i.e. have a TeraTerm running watching for the output of the RFID module, that has to be send over to the UART. Sometimes I receive via UART &quot;2FEF0000&quot; and the the next time I get &quot;2FEF00001000\\r&quot;. So maybe the problem is more like write is not writing everything at it is buffered? Is there a way to force write all characters still in the buffer?"}, {"owner": {"reputation": 186, "user_id": 6685157, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BV9ax8DzQo4/AAAAAAAAAAI/AAAAAAAABbI/prpGhFH7U9o/photo.jpg?sz=128", "display_name": "Sathish V", "link": "https://stackoverflow.com/users/6685157/sathish-v"}, "edited": false, "score": 0, "creation_date": 1470813612, "post_id": 38866144, "comment_id": 65096167, "body": "So you have a teraterm listening for RFID output, and your own application , that should Sent it to uartCom, is that right?"}, {"owner": {"reputation": 186, "user_id": 6685157, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BV9ax8DzQo4/AAAAAAAAAAI/AAAAAAAABbI/prpGhFH7U9o/photo.jpg?sz=128", "display_name": "Sathish V", "link": "https://stackoverflow.com/users/6685157/sathish-v"}, "edited": false, "score": 0, "creation_date": 1470813908, "post_id": 38866144, "comment_id": 65096350, "body": "when you say &quot;I receive via UART &quot;2FEF0000&quot;&quot; through what you seeing the output of the UARTCom?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1470814663, "post_id": 38866144, "comment_id": 65096825, "body": "As stated into my answer you should loop receiving 1 char per time until <code>&#39;\\r&#39;</code> char is received. So you can send data via UART."}, {"owner": {"reputation": 159, "user_id": 808136, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/044e97258a634ae811714a90fa901b70?s=128&d=identicon&r=PG", "display_name": "Tobi", "link": "https://stackoverflow.com/users/808136/tobi"}, "edited": false, "score": 0, "creation_date": 1470815908, "post_id": 38866144, "comment_id": 65097587, "body": "That doesn&#39;t work sadly, because there also is a firmware write mode without \\r&#39;s."}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1470819190, "post_id": 38866144, "comment_id": 65099510, "body": "If you used non-canonical blocking I/O, then you would not have to worry about adding a delay and/or draining the buffers.  See <a href=\"http://stackoverflow.com/questions/25996171/linux-blocking-vs-non-blocking-serial-read/26006680#26006680\" title=\"linux blocking vs non blocking serial read\">stackoverflow.com/questions/25996171/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1470818908, "post_id": 38866334, "comment_id": 65099325, "body": "@sawdust true. It is just an example to explain better the concept. BTW you are free to post your efficient code as an answer... ;)"}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1470815317, "last_edit_date": 1470815317, "creation_date": 1470812430, "answer_id": 38866334, "question_id": 38866144, "link": "https://stackoverflow.com/questions/38866144/connecting-two-serial-ports-in-c/38866334#38866334", "title": "Connecting two serial ports in C", "body": "<p>Looking at the <a href=\"http://linux.die.net/man/2/read\" rel=\"nofollow\">man</a>:</p>\n\n<blockquote>\n  <p><strong>read()</strong> <em>attempts to read <strong>up to</strong> count</em> bytes from file descriptor fd into the buffer starting at buf.</p>\n</blockquote>\n\n<p>In other words<code>read</code> does not grants to return all bytes send by other task, can give you a single byte up to <code>sizeof(rfid_read_buffer)-1</code></p>\n\n<p>What you can do is:</p>\n\n<ol>\n<li>loop reading from <code>rfidCom</code> until the number of chars matches the number of chars sent. </li>\n<li>You can use a specific terminator of messages and check for it to validate received message</li>\n<li>encapsulate chars into a protocol message with an header that embed the message length, so the receiver can count the received chars and stop reading when last char is received.</li>\n</ol>\n\n<p>For example:</p>\n\n<pre><code>void *rfid_to_uart_thread(void *)\n{\n    char rfid_read_buffer[100] = {0};\n\n    int writeCounter;\n    char RXchar;\n    ssize_t retVal;\n    bool send = false;\n\n    do\n    {\n        memset(rfid_read_buffer, 0x00, sizeof(rfid_read_buffer));\n        send = true;\n\n        do\n        {\n            retVal = read(rfidCom, &amp;RXchar, 1);\n\n            if (retVal &gt; 0)\n            {\n                rfid_read_buffer[writeCounter] = RXchar;\n\n                writeCounter++;\n            }\n            else if (retVal &lt; 0)\n            {\n                send = false;\n                RXchar = '\\r'\n                break;\n            }\n            else\n            {\n                usleep(25);\n            }\n        }\n        while(RXchar != '\\r');\n\n\n        if (send)\n        {\n            write(uartCom, rfid_read_buffer, writeCounter);\n        }\n    }\n    while (!bKillBridgeThreads);\n\n    return NULL;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1610, "user_id": 502189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cba4d424ecb01d45a923636bef46cc7?s=128&d=identicon&r=PG", "display_name": "rjp", "link": "https://stackoverflow.com/users/502189/rjp"}, "edited": false, "score": 0, "creation_date": 1470941857, "post_id": 38867460, "comment_id": 65166873, "body": "I would really like to know how the ioctl to send a break character became the ioctl to wait until the transmit buffer has emptied."}], "tags": [], "owner": {"reputation": 159, "user_id": 808136, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/044e97258a634ae811714a90fa901b70?s=128&d=identicon&r=PG", "display_name": "Tobi", "link": "https://stackoverflow.com/users/808136/tobi"}, "is_accepted": false, "score": 0, "last_activity_date": 1470816428, "last_edit_date": 1470816428, "creation_date": 1470816006, "answer_id": 38867460, "question_id": 38866144, "link": "https://stackoverflow.com/questions/38866144/connecting-two-serial-ports-in-c/38867460#38867460", "title": "Connecting two serial ports in C", "body": "<p>OK, I've found a solution to my problem I think.</p>\n\n<pre><code>void *rfid_to_uart_thread(void *) {\nchar rfid_read_buffer[10];\nssize_t writeCounter = -1;\n\ndo {\n    writeCounter = read(rfidCom, &amp;rfid_read_buffer, sizeof(rfid_read_buffer)-1);\n    if (writeCounter&gt;0){\n        rfid_read_buffer[writeCounter] = 0;\n        LOGE(\"RFID -&gt; UART: %s\", rfid_read_buffer);\n        write(uartCom, rfid_read_buffer, writeCounter);\n    }else{\n        usleep(25);\n    }\n    tcdrain(uartCom);\n} while (!bKillBridgeThreads);\n\nreturn NULL;}\n</code></pre>\n\n<p>I've created my own define for a tcdrain, because the Android NDK I am using is not offering it in termios.h\nNow, all the values seem to get transmitted to the UART port.</p>\n\n<p>tcdrain is now defined as:</p>\n\n<pre><code>#define tcdrain(fd) ioctl(fd, TCSBRK, 1)\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 808136, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/044e97258a634ae811714a90fa901b70?s=128&d=identicon&r=PG", "display_name": "Tobi", "link": "https://stackoverflow.com/users/808136/tobi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1470816428, "creation_date": 1470811706, "question_id": 38866144, "link": "https://stackoverflow.com/questions/38866144/connecting-two-serial-ports-in-c", "title": "Connecting two serial ports in C", "body": "<p>I want to connect/bridge two serial ports in C. \nI have 2 threads reading the ports, and writing to the other port.\nHere is one example:</p>\n\n<pre><code>void *rfid_to_uart_thread(void *) {\nchar rfid_read_buffer[100];\nint writeCounter;\ndo {\n    writeCounter = read(rfidCom, rfid_read_buffer, sizeof(rfid_read_buffer)-1);\n    if (writeCounter &gt; 0) {\n        write(uartCom, rfid_read_buffer, writeCounter);\n    } else\n        usleep(25);\n\n\n\n} while (!bKillBridgeThreads);\n\nreturn NULL;}\n</code></pre>\n\n<p>The problem is, it seems that the writes are too slow. I often receive only half of the String on the other side. It seems like the write is asynchronously and thus the buffer is overwritten again in the next loop and overwrites the last 'write', so that the data is crippled?!\nIs that right?</p>\n\n<p>The ports are opened NON_BLOCKING and RW, Baudrate is and has to be 9600.</p>\n"}, {"tags": ["c", "algorithm", "performance", "data-structures", "stack"], "comments": [{"owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 2, "creation_date": 1470814336, "post_id": 38866081, "comment_id": 65096629, "body": "why not use linked list instead of array for internal storage ?"}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1470814434, "post_id": 38866081, "comment_id": 65096677, "body": "You let the code provided as a start at hackerrank goad you into solving this using stacks (which may be an acceptable purpose for an exercise like this). Think about what you could do <i>reading the values of the second stack</i>."}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 1, "creation_date": 1470814943, "post_id": 38866081, "comment_id": 65096988, "body": "(Think about <a href=\"https://isocpp.org/wiki/faq/const-correctness\" rel=\"nofollow noreferrer\">const correctness</a>. For a more versatile stack, have <code>pop()</code> return the former top. Consider declaring <code>long sum;</code>.)"}], "answers": [{"comments": [{"owner": {"reputation": 1115, "user_id": 6544408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3f30b2ea793e58029995eea15b4fc2c4?s=128&d=identicon&r=PG&f=1", "display_name": "yobro97", "link": "https://stackoverflow.com/users/6544408/yobro97"}, "edited": false, "score": 0, "creation_date": 1470818234, "post_id": 38866571, "comment_id": 65098907, "body": "<code>if(stack1-&gt;sum &gt; stack2-&gt;sum &amp;&amp; stack1-&gt;sum &gt; stack3-&gt;sum)</code> , <code>if(stack2-&gt;sum &gt; stack1-&gt;sum &amp;&amp; stack2-&gt;sum &gt; stack3-&gt;sum)</code> , ` if(stack3-&gt;sum &gt; stack2-&gt;sum &amp;&amp; stack3-&gt;sum &gt; stack1-&gt;sum)` .......isn&#39;t it the same thing which I have done?....correct me if I m wrong."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 1115, "user_id": 6544408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3f30b2ea793e58029995eea15b4fc2c4?s=128&d=identicon&r=PG&f=1", "display_name": "yobro97", "link": "https://stackoverflow.com/users/6544408/yobro97"}, "edited": false, "score": 0, "creation_date": 1470854971, "post_id": 38866571, "comment_id": 65123685, "body": "@yobro97 There were other flaws in your code as pointed out in the accepted answer. In particular, consider what happens when the sums are 20,20, and 10. Since your code looks for one stack to be higher than both other stacks, it won&#39;t do anything if the two largest stacks are equal. But this answer would choose <code>stack2</code> as <code>high</code> and <code>stack3</code> as <code>low</code>, and would pop from <code>stack2</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 1115, "user_id": 6544408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3f30b2ea793e58029995eea15b4fc2c4?s=128&d=identicon&r=PG&f=1", "display_name": "yobro97", "link": "https://stackoverflow.com/users/6544408/yobro97"}, "edited": false, "score": 0, "creation_date": 1470854976, "post_id": 38866571, "comment_id": 65123693, "body": "Having said that, I didn&#39;t fully analyze your code to find that problem. I just had a bad feeling about the way the loop was written: way too many branch points. Branch points (places in the code where the processor needs to make a decision) can slow a processor down significantly (by causing pipeline stalls). Your code has 8 branch points in the loop (not counting the branch points in the <code>pop</code> function). My code has 1. So my loop will run faster. As it turns out, that wasn&#39;t the problem, but my solution would have fixed the problem nonetheless."}, {"owner": {"reputation": 1115, "user_id": 6544408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3f30b2ea793e58029995eea15b4fc2c4?s=128&d=identicon&r=PG&f=1", "display_name": "yobro97", "link": "https://stackoverflow.com/users/6544408/yobro97"}, "edited": false, "score": 0, "creation_date": 1470855711, "post_id": 38866571, "comment_id": 65124104, "body": "Thanks for the suggestion......I didn&#39;t have the knowledge about <code>Branch points</code>....it would definitely help me...one question though.....how significantly does it affect the running time?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 1115, "user_id": 6544408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3f30b2ea793e58029995eea15b4fc2c4?s=128&d=identicon&r=PG&f=1", "display_name": "yobro97", "link": "https://stackoverflow.com/users/6544408/yobro97"}, "edited": false, "score": 0, "creation_date": 1470857050, "post_id": 38866571, "comment_id": 65124852, "body": "@yobro97 In this example (replacing 8 branch points with 1), I would expect the <b>loop</b> code to run 2 to 3 times faster. However, it depends a lot on the data in the stacks, since that affects the number of branches actually taken. There&#39;s also the time spent in other parts of the code. For example, If loading the stacks using <code>scanf</code> takes a long time compared with running the loop, then speeding up the loop by 2 to 3 times may only reduce the overall running time by 10 to 20%. That&#39;s where <a href=\"https://en.wikipedia.org/wiki/Profiling_(computer_programming)\" rel=\"nofollow noreferrer\">profiling</a> comes in."}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": false, "score": 2, "last_activity_date": 1470813729, "last_edit_date": 1470813729, "creation_date": 1470813287, "answer_id": 38866571, "question_id": 38866081, "link": "https://stackoverflow.com/questions/38866081/efficient-implementation-of-stacks-in-c/38866571#38866571", "title": "Efficient implementation of stacks in C", "body": "<p>You can speed things up by determining which stack has the highest sum, and then pop from that stack until its sum is equal to or less than the lowest sum.</p>\n\n<p>Code to find the stacks with the highest and lowest sums could look like this</p>\n\n<pre><code>struct Stack *high = (stack1-&gt;sum &gt; stack2-&gt;sum) ? stack1 : stack2;\nstruct Stack *low  = (high == stack1) ? stack2 : stack1;\n\nif ( stack3-&gt;sum &gt; high-&gt;sum )\n    high = stack3;\nelse if ( stack3-&gt;sum &lt; low-&gt;sum )\n    low = stack3;\n</code></pre>\n\n<p>Then the code to reduce the highest sum looks like this</p>\n\n<pre><code>while ( high-&gt;sum &gt; low-&gt;sum )\n    pop( high );\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1115, "user_id": 6544408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3f30b2ea793e58029995eea15b4fc2c4?s=128&d=identicon&r=PG&f=1", "display_name": "yobro97", "link": "https://stackoverflow.com/users/6544408/yobro97"}, "edited": false, "score": 0, "creation_date": 1470824294, "post_id": 38870128, "comment_id": 65103082, "body": "....u were correct about the point (b)....but regarding point (a) in the pop function I have taken the condition is empty. The judge accepted the answer if i included the condition <code>&gt;=</code> instead of <code>&gt;</code> in the if conditions.....Thnx..!!"}], "tags": [], "owner": {"reputation": 12292, "user_id": 1990169, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ohZfn.jpg?s=128&g=1", "display_name": "Abhishek Bansal", "link": "https://stackoverflow.com/users/1990169/abhishek-bansal"}, "is_accepted": true, "score": 1, "last_activity_date": 1470823244, "creation_date": 1470823244, "answer_id": 38870128, "question_id": 38866081, "link": "https://stackoverflow.com/questions/38866081/efficient-implementation-of-stacks-in-c/38870128#38870128", "title": "Efficient implementation of stacks in C", "body": "<p>The reason you might be getting time limit exceeded is because your while loop never ends if </p>\n\n<p>a) Any stack becomes empty. You should add that check in the while loop condition that none of the stacks is empty and then output the minimum sum of all the three stacks.</p>\n\n<p>b) There might be a case where the heights are 20, 10, 10, in that case how would your code work?</p>\n"}], "owner": {"reputation": 1115, "user_id": 6544408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3f30b2ea793e58029995eea15b4fc2c4?s=128&d=identicon&r=PG&f=1", "display_name": "yobro97", "link": "https://stackoverflow.com/users/6544408/yobro97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 749, "favorite_count": 0, "accepted_answer_id": 38870128, "answer_count": 2, "score": 4, "last_activity_date": 1470823244, "creation_date": 1470811518, "last_edit_date": 1470813100, "question_id": 38866081, "link": "https://stackoverflow.com/questions/38866081/efficient-implementation-of-stacks-in-c", "title": "Efficient implementation of stacks in C", "body": "<p><a href=\"https://www.hackerrank.com/challenges/equal-stacks\" rel=\"nofollow\">https://www.hackerrank.com/challenges/equal-stacks</a><br>\nFor this problem, I tried to implement the stack data structure in c. But I am getting timeout for some cases using the following code:</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;stdbool.h&gt;\nstruct Stack{\n    int top;\n    int size;\n    int sum;\n    int* arr;\n};\nstruct Stack* createStack(int size){\n    struct Stack* stack = (struct Stack*)malloc(sizeof(struct Stack));\n    stack-&gt;size=size;\n    stack-&gt;top=-1;\n    stack-&gt;sum=0;\n    stack-&gt;arr = (int*)malloc(sizeof(int)*size);\n    return stack;\n}\nint isempty(struct Stack* stack){\n    if(stack-&gt;top==-1)\n        return 1;\n    return 0;\n}\nvoid push(struct Stack* stack,int term){\n    stack-&gt;top++;\n    stack-&gt;arr[stack-&gt;top]=term;\n    stack-&gt;sum+=term;\n}\nvoid pop(struct Stack* stack){\n    if(isempty(stack)==0){\n        stack-&gt;sum-=stack-&gt;arr[stack-&gt;top];\n        stack-&gt;top--;\n    }\n}\nint main(){\n    int size1,size2,size3;\n    scanf(\"%d %d %d\",&amp;size1,&amp;size2,&amp;size3);\n    int arr1[size1];\n    for(int i=0;i&lt;size1;i++)\n        scanf(\"%d\",&amp;arr1[i]);\n    struct Stack* stack1 = createStack(size1);\n    for(int i=size1-1;i&gt;=0;i--)\n        push(stack1,arr1[i]);\n    int arr2[size2];\n    for(int i=0;i&lt;size2;i++)\n        scanf(\"%d\",&amp;arr2[i]);\n    struct Stack* stack2 = createStack(size2);\n    for(int i=size2-1;i&gt;=0;i--)\n        push(stack2,arr2[i]);\n    int arr3[size3];\n    for(int i=0;i&lt;size3;i++)\n        scanf(\"%d\",&amp;arr3[i]);\n    struct Stack* stack3 = createStack(size3);\n    for(int i=size3-1;i&gt;=0;i--)\n        push(stack3,arr3[i]);\n    while(stack1-&gt;sum!=stack2-&gt;sum || stack2-&gt;sum!=stack3-&gt;sum){\n        if(stack1-&gt;sum &gt; stack2-&gt;sum &amp;&amp; stack1-&gt;sum &gt; stack3-&gt;sum)\n            pop(stack1);\n        if(stack2-&gt;sum &gt; stack1-&gt;sum &amp;&amp; stack2-&gt;sum &gt; stack3-&gt;sum)\n            pop(stack2);\n        if(stack3-&gt;sum &gt; stack2-&gt;sum &amp;&amp; stack3-&gt;sum &gt; stack1-&gt;sum)\n            pop(stack3);\n    }\n    printf(\"%d\\n\",stack1-&gt;sum);\n}\n</code></pre>\n\n<p>Can anyone suggest a better approach using only the stack data structure (preferably in C) ?</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 6589801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/400a80d34ead9791de9601ab0b4f1a49?s=128&d=identicon&r=PG&f=1", "display_name": "user-6589801", "link": "https://stackoverflow.com/users/6589801/user-6589801"}, "edited": false, "score": 0, "creation_date": 1470811249, "post_id": 38865938, "comment_id": 65094848, "body": "Thanku so much @blackbird"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1470835242, "post_id": 38865938, "comment_id": 65110659, "body": "Although this code may help to solve the problem, it doesn&#39;t explain <i>why</i> and/or <i>how</i> it answers the question. Providing this additional context  would significantly improve its long-term value. Please <a href=\"https://stackoverflow.com/posts/38865938/edit\">edit</a> your answer to add explanation, including what limitations and assumptions apply."}], "tags": [], "owner": {"reputation": 2151, "user_id": 2130104, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0JKjv.jpg?s=128&g=1", "display_name": "Mr. Perfectionist", "link": "https://stackoverflow.com/users/2130104/mr-perfectionist"}, "is_accepted": false, "score": 0, "last_activity_date": 1470811030, "creation_date": 1470811030, "answer_id": 38865938, "question_id": 38865855, "link": "https://stackoverflow.com/questions/38865855/usage-of-do-while-loop-for-yes-no-prompt-in-c/38865938#38865938", "title": "usage of do while loop for yes no prompt in c", "body": "<p>You have to use a space before <code>%c</code></p>\n\n<pre><code>scanf(\" %c\", &amp;ch);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1470835351, "post_id": 38865944, "comment_id": 65110748, "body": "Although this code may help to solve the problem, it doesn&#39;t explain <i>why</i> and/or <i>how</i> it answers the question. Providing this additional context  would significantly improve its long-term value. Please <a href=\"https://stackoverflow.com/posts/38865944/edit\">edit</a> your answer to add explanation, including what limitations and assumptions apply."}], "tags": [], "owner": {"reputation": 1560, "user_id": 4303216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-crjc3oGU_5c/AAAAAAAAAAI/AAAAAAAAADc/BTLu8OHFfRM/photo.jpg?sz=128", "display_name": "sameera sy", "link": "https://stackoverflow.com/users/4303216/sameera-sy"}, "is_accepted": false, "score": 0, "last_activity_date": 1470811044, "creation_date": 1470811044, "answer_id": 38865944, "question_id": 38865855, "link": "https://stackoverflow.com/questions/38865855/usage-of-do-while-loop-for-yes-no-prompt-in-c/38865944#38865944", "title": "usage of do while loop for yes no prompt in c", "body": "<p>changing your scanf will solve all the problems</p>\n\n<pre><code>scanf(\" %c\",&amp;ch); //notice space\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 1, "last_activity_date": 1470811210, "creation_date": 1470811210, "answer_id": 38865994, "question_id": 38865855, "link": "https://stackoverflow.com/questions/38865855/usage-of-do-while-loop-for-yes-no-prompt-in-c/38865994#38865994", "title": "usage of do while loop for yes no prompt in c", "body": "<p>Your second <code>scanf</code> is consuming the <code>'\\n'</code> char left into <code>stdin</code> by the <code>dice</code> one</p>\n\n<p>Simply adding a space before format specifier you can consume all chars in stdin before accempting the character inserted by user:</p>\n\n<pre><code>scanf (\" %c\", &amp;ch);\n</code></pre>\n\n<p>In a <code>scanf()</code> format, a blank, tab or newline means 'skip white space if there is any to skip'.</p>\n"}, {"tags": [], "owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "is_accepted": false, "score": 0, "last_activity_date": 1470811795, "creation_date": 1470811795, "answer_id": 38866167, "question_id": 38865855, "link": "https://stackoverflow.com/questions/38865855/usage-of-do-while-loop-for-yes-no-prompt-in-c/38866167#38866167", "title": "usage of do while loop for yes no prompt in c", "body": "<pre><code>printf (\"dice\\n\");\nscanf (\"%d\", &amp;dice);\n</code></pre>\n\n<p>This has left '\\n' in the buffer and your second call to scanf reads this '\\n' instead of 'n' and continues. You must read remaining '\\n' before reading character.</p>\n\n<p>man scanf(3):</p>\n\n<pre><code>   The  format  string  consists  of a sequence of directives which describe how to process the sequence of input characters.  If processing of a directive fails, no\n   further input is read, and scanf() returns.  A \"failure\" can be either of the following: input failure, meaning that input characters were unavailable, or  match\u2010\n   ing failure, meaning that the input was inappropriate (see below).\n\n   A directive is one of the following:\n\n   \u00b7      A sequence of white-space characters (space, tab, newline, etc.; see isspace(3)).  This directive matches any amount of white space, including none, in the\n          input.\n\n   \u00b7      An ordinary character (i.e., one other than white space or '%').  This character must exactly match the next character of input.\n\n   \u00b7      A conversion specification, which commences with a '%' (percent) character.  A sequence of characters from the input is converted according to this  speci\u2010\n          fication,  and the result is placed in the corresponding pointer argument.  If the next item of input does not match the conversion specification, the con\u2010\n          version fails\u2014this is a matching failure.\n</code></pre>\n\n<p>There are two options.</p>\n\n<pre><code>scanf (\" %c\", &amp;ch);\n</code></pre>\n\n<p>or </p>\n\n<pre><code>(void) getchar ();\nscanf (\"%c\", &amp;ch);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1470814079, "last_edit_date": 1470814079, "creation_date": 1470813423, "answer_id": 38866610, "question_id": 38865855, "link": "https://stackoverflow.com/questions/38865855/usage-of-do-while-loop-for-yes-no-prompt-in-c/38866610#38866610", "title": "usage of do while loop for yes no prompt in c", "body": "<p>The biggest problem you have is not accounting for the <code>'\\n'</code> left in your <em>input buffer</em> (<code>stdin</code> here) that results from the user pressing <kbd>Enter</kbd> after entering <code>dice</code> as the <code>%c</code> format specifier will happily take the <code>'\\n'</code> as the user-input for <code>ch</code>.</p>\n\n<p>The next problem is <code>ch</code> should be and <code>int</code> not <code>char</code> or you will never be able to test/trap <code>EOF</code>.</p>\n\n<p>Further, you fail to validate the <code>return</code> of <code>scanf</code> to confirm any of the conversions are valid.</p>\n\n<p>Given the problems associated with taking user input with <code>scanf</code>, you are better served taking user input with <code>fgets</code> and reading the entire line of user input into a buffer of sufficient size for the input and then parsing your numeric values from the buffer with <code>sscanf</code> (or simply subtracting <code>'0'</code> for a single digit).</p>\n\n<p>Putting those pieces together, you could do something like the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define BUFLEN 128\n\nint main () {\n\n    int ch, cash, dice;\n    char buf[BUFLEN] = \"\";\n    printf (\"cash: \");\n\n    if (!fgets (buf, BUFLEN, stdin)) {  /* read/validate cash */\n        fprintf (stderr, \"error: invalid input - cash.\\n\");\n        return 1;\n    }\n    if (sscanf (buf, \"%d\", &amp;cash) != 1) { /* parse cash from buf */\n        fprintf (stderr, \"error: invalid conversion - cash.\\n\");\n        return 1;\n    }\n\n    if (cash &lt; 1000) {\n        printf (\"No\\n\");\n        return 1;\n    }\n\n    do {\n        ch = 'n';  /* set/reset ch to exit each iteration */\n\n        printf (\"dice: \");\n        if (!fgets (buf, BUFLEN, stdin)) { /* read/validate dice */\n            fprintf (stderr, \"error: invalid input - dice.\\n\");\n            break;  /* break on EOF */\n        }\n        /* parse/validate  dice */\n        if (sscanf (buf, \"%d\", &amp;dice) != 1 || dice &lt; 1 || dice &gt; 6) {\n            fprintf (stderr, \"error: invalid conversion - dice.\\n\");\n            ch = 'y';   /* set ch to 'y' */\n            continue;   /* prompt again, etc */\n        }\n\n        if (dice == 1) {\n            cash = cash / 2;  /* note: truncated division */\n            break;\n        }\n        cash = (dice * 100) + cash;\n        printf (\"\\nDo you want to continue? (y/n): \");\n        if (fgets (buf, BUFLEN, stdin))\n            ch = *buf;  /* simply assign first char */\n        else\n            break;  /* exit loop on EOF */\n\n    } while (ch == 'y');\n\n    printf (\"\\nwon = %d\\n\\n\", cash);\n\n    return 0;\n}\n</code></pre>\n\n<p>(note: tests to validate less than 128 chars entered for each input omitted)</p>\n\n<p><strong>Example Use/Input</strong></p>\n\n<pre><code>$ ./bin/rfmt\ncash: 1200\ndice: 7\ninvalid dice.\ndice: 5\n\nDo you want to continue? (y/n): y\ndice: 2\n\nDo you want to continue? (y/n): y\ndice: 6\n\nDo you want to continue? (y/n): n\n\nwon = 2500\n</code></pre>\n\n<p>Look over all the answer and decide whether you want to go with <code>scanf</code> or <code>fgets/sscanf</code>. Both are doable, you just lose a bit of flexibility when you couple both your read and parse in a single <code>scanf</code> call. Let me know if you have any questions.</p>\n"}], "owner": {"reputation": 119, "user_id": 6589801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/400a80d34ead9791de9601ab0b4f1a49?s=128&d=identicon&r=PG&f=1", "display_name": "user-6589801", "link": "https://stackoverflow.com/users/6589801/user-6589801"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3751, "favorite_count": 0, "answer_count": 5, "score": -3, "last_activity_date": 1470814079, "creation_date": 1470810737, "last_edit_date": 1470811984, "question_id": 38865855, "link": "https://stackoverflow.com/questions/38865855/usage-of-do-while-loop-for-yes-no-prompt-in-c", "title": "usage of do while loop for yes no prompt in c", "body": "<p>I am learning to code in c online and was trying this program to use the do while loop</p>\n\n<p>This is a program for a dice game</p>\n\n<p>A player can enter the game with minimum amount of <code>1000</code>.</p>\n\n<p>A player can take any number of chances. If the value of the <code>dice</code> is <code>1</code>, the player leaves the game with half the amount. </p>\n\n<p>If the value is other than <code>1</code>, the total amount is raised by multiple of <code>100*value</code> of <code>dice</code>.</p>\n\n<p>If the player quits, he/she leaves the game with amount he/she has got. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main () {\n\n    int cash, dice;\n    char ch;\n    printf (\"cash\\n\");\n    scanf (\"%d\", &amp;cash);\n    if (cash &lt; 1000) {\n        printf (\"No\\n\");\n        exit (0);\n    }\n    else {\n        do {\n            printf (\"dice\\n\");\n            scanf (\"%d\", &amp;dice);\n            while (dice &lt; 1 || dice &gt; 6) {\n                printf (\"\\n invalid\");\n                printf (\"dice\\n\");\n                scanf (\"%d\", &amp;dice);\n            }\n            if (dice == 1) {\n                cash = cash / 2;\n                break;\n            }\n\n            cash = (dice * 100) + cash;\n            printf (\"Do you want to continue\");\n            scanf (\"%c\", &amp;ch);\n\n        } while (ch == 'y');\n    }\n    printf (\"won=%d\", cash);\n\n    return 0;\n}\n</code></pre>\n\n<p>This program isn't accepting the <code>y</code> or <code>n</code> input.\nIt displays the statement <code>do you want to continue</code>\nand directly goes to won statement.</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "edited": false, "score": 0, "creation_date": 1470810171, "post_id": 38865614, "comment_id": 65094233, "body": "<a href=\"http://stackoverflow.com/documentation/c/364/undefined-behavior/6644/modify-string-literal#t=201608100622195552693\">stackoverflow.com/documentation/c/364/undefined-behavior/664&zwnj;&#8203;4/&hellip;</a>"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1470810180, "post_id": 38865614, "comment_id": 65094239, "body": "Your are trying to cut a <code>string literal</code>, that is <code>const char *</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1692, "user_id": 6588224, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fa171624f6e8b69a48e9f0b71a5dcd1a?s=128&d=identicon&r=PG&f=1", "display_name": "Jin", "link": "https://stackoverflow.com/users/6588224/jin"}, "edited": false, "score": 0, "creation_date": 1470810233, "post_id": 38865658, "comment_id": 65094280, "body": "then i guess the solution would be to assign the string to a char array?"}], "tags": [], "owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "is_accepted": true, "score": 4, "last_activity_date": 1470877923, "last_edit_date": 1470877923, "creation_date": 1470810020, "answer_id": 38865658, "question_id": 38865614, "link": "https://stackoverflow.com/questions/38865614/whats-wrong-with-this-function-that-shortens-strings/38865658#38865658", "title": "What&#39;s wrong with this function that shortens strings?", "body": "<p>In standard C and C++, string literals (<code>\"these\"</code>) are read-only.</p>\n\n<p>Typically these are located in read-only memory. By writing to <code>str</code> in your specific example your program attempts write to write-protected memory, which is disallowed by the OS (or the runtime, if applicable) which causes an abnormal program termination. If you were writing C++ the compiler might complain that you were passing a <code>const char*</code> to a function that accepted a non-<code>const</code> argument.</p>\n\n<p>You have four options:</p>\n\n<ol>\n<li><p>Tell the compiler to put the `\"Hello People!!\" string in a writable data area instead of write-protected data when building or initializing the program - this would require a compiler or platform-specific feature and is not part of standard C or C++.</p></li>\n<li><p>Use an OS-specific command to make the memory area writable (have fun!)</p></li>\n<li><p>Copy the string to a mutable buffer before you modify it.</p></li>\n<li><p>Use <code>char str[] = \"Hello People!!\";</code> - this is basically the same as option 3 but the compiler does it for you. Be careful when leaving scope, however.</p></li>\n</ol>\n\n<p>Note that inserting null characters into a string buffer as a means of shortening a string can be a bad idea because it hides the extra space in the allocated buffer. Generally you should treat strings as immutable, and if you want to be efficient by re-using strings in a copy-on-write fashion then use <code>start/end</code> pairs that point to an extant buffer instead of relying on null-termination.</p>\n"}, {"tags": [], "owner": {"reputation": 32921, "user_id": 5771269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6a5b618f5bd197150a6186318beba7?s=128&d=identicon&r=PG&f=1", "display_name": "cdlane", "link": "https://stackoverflow.com/users/5771269/cdlane"}, "is_accepted": false, "score": 2, "last_activity_date": 1470812579, "last_edit_date": 1470812579, "creation_date": 1470810277, "answer_id": 38865728, "question_id": 38865614, "link": "https://stackoverflow.com/questions/38865614/whats-wrong-with-this-function-that-shortens-strings/38865728#38865728", "title": "What&#39;s wrong with this function that shortens strings?", "body": "<p>You can use your static string to initialize memory that <em>you</em> allocate and it should work fine:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid fit(char *string, size_t size);\n\nint main(void)\n{\n    char string[] = \"Hello People!!\";\n\n    fit(string, 6);\n\n    printf(\"%s\\n\", string);\n\n    return 0;\n}\n\nvoid fit(char *string, size_t size)\n{\n    if (strlen(string) &gt; size)\n        string[size] = '\\0';\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 32921, "user_id": 5771269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6a5b618f5bd197150a6186318beba7?s=128&d=identicon&r=PG&f=1", "display_name": "cdlane", "link": "https://stackoverflow.com/users/5771269/cdlane"}, "edited": false, "score": 1, "creation_date": 1470812502, "post_id": 38865736, "comment_id": 65095564, "body": "Your second solution prints garbage if a <code>size</code> larger than <code>strlen(str)</code> is passed.  It might be safer to initialize <code>cutString</code>."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 2, "last_activity_date": 1470812636, "last_edit_date": 1470812636, "creation_date": 1470810310, "answer_id": 38865736, "question_id": 38865614, "link": "https://stackoverflow.com/questions/38865614/whats-wrong-with-this-function-that-shortens-strings/38865736#38865736", "title": "What&#39;s wrong with this function that shortens strings?", "body": "<p>Your are trying to cut a <code>string literal</code>, that is <code>const char *</code>, that is write protected.</p>\n\n<p>You can change the code as:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid fit(char *str, unsigned int size);\n\nint main(void)\n{\n    char test[] = \"Hello People!!\";\n\n    fit(test, 6);\n}\n\nvoid fit(char *str,unsigned int size)\n{\n    if ( strlen(str) &gt; size)\n    {\n        str[size] = '\\0';\n        printf(\"%s\\n\", str);\n    }\n    else\n    {\n        fprintf(stderr, \"Size passed greater than string length!\\n\");\n    }\n}\n</code></pre>\n\n<p>As you can see you are initializing an array of char (C-String) with literal string. So passing that array by reference (using <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> arrays <em>decay</em> to pointers when passed to a function) you can modify it and the result is what you expected.</p>\n\n<p>A second solution is to create a new temp string inside the <code>fit</code> func:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid fit(char *str, size_t size);\n\nint main(void)\n{\n    fit(\"Hello People!!\", 6);\n}\n\nvoid fit(char *str, size_t size)\n{\n    // One char is added to store null terminator into new string\n    char cutString[size+1] = {0};\n\n    if ( strlen(str) &gt; size)\n    {\n        for (size_t i=0; i&lt;size; i++)\n        {\n            cutString[i] = str[i];\n        }\n        cutString[size] = '\\0';\n\n        printf(\"%s\\n\", cutString);\n    }\n    else\n    {\n       fprintf(stderr, \"Size passed greater than string length!\\n\");\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1692, "user_id": 6588224, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fa171624f6e8b69a48e9f0b71a5dcd1a?s=128&d=identicon&r=PG&f=1", "display_name": "Jin", "link": "https://stackoverflow.com/users/6588224/jin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 38865658, "answer_count": 3, "score": 0, "last_activity_date": 1470877923, "creation_date": 1470809875, "question_id": 38865614, "link": "https://stackoverflow.com/questions/38865614/whats-wrong-with-this-function-that-shortens-strings", "title": "What&#39;s wrong with this function that shortens strings?", "body": "<p>I have defined a function in C which shortens long strings to fixed size and prints the shortened string. The function goes like this:</p>\n\n<pre><code>void fit(char *str,unsigned int size) // shorten long strings to fixed size, \"size\" and prints the shortened string.\n{\n    if ( strlen(str) &gt; size)\n        str[size] = '\\0';  \n    printf(\"%s\", str);  // prints the shortened string\n}\n</code></pre>\n\n<p>If I run this function, the compilers points out no warning nor error but the execution stops. What part of the code makes the execution stop?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid fit(char *str, unsigned int size);\n\nint main(void)\n{\n    fit(\"Hello People!!\", 6);\n}\n\nvoid fit(char *str,unsigned int size)\n{\n    if ( strlen(str) &gt; size)\n        str[size] = '\\0';\n    printf(\"%s\", str);\n}\n</code></pre>\n"}, {"tags": ["c", "data-structures", "programming-languages"], "comments": [{"owner": {"reputation": 669, "user_id": 3611519, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3wCQx.jpg?s=128&g=1", "display_name": "New", "link": "https://stackoverflow.com/users/3611519/new"}, "edited": false, "score": 1, "creation_date": 1470806518, "post_id": 38864771, "comment_id": 65092698, "body": "Please do refer this question in SO itself <a href=\"http://stackoverflow.com/questions/2252896/how-to-store-a-very-long-integer-value-in-a-c-program-for-an-exam-98474737475\" title=\"how to store a very long integer value in a c program for an exam 98474737475\">stackoverflow.com/questions/2252896/&hellip;</a>"}, {"owner": {"reputation": 33, "user_id": 6698587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Xonk.jpg?s=128&g=1", "display_name": "nalostta", "link": "https://stackoverflow.com/users/6698587/nalostta"}, "reply_to_user": {"reputation": 669, "user_id": 3611519, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3wCQx.jpg?s=128&g=1", "display_name": "New", "link": "https://stackoverflow.com/users/3611519/new"}, "edited": false, "score": 0, "creation_date": 1470806966, "post_id": 38864771, "comment_id": 65092842, "body": "The methods presented in the link make performing operations quite cumbersome...but i guess its okay...ill figure it out. However do read the alternate question...."}, {"owner": {"reputation": 297030, "user_id": 1226963, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/yjY1E.png?s=128&g=1", "display_name": "rmaddy", "link": "https://stackoverflow.com/users/1226963/rmaddy"}, "edited": false, "score": 0, "creation_date": 1470807247, "post_id": 38864771, "comment_id": 65092927, "body": "Which is it? C or Objective-C? Huge difference in your options."}, {"owner": {"reputation": 33, "user_id": 6698587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Xonk.jpg?s=128&g=1", "display_name": "nalostta", "link": "https://stackoverflow.com/users/6698587/nalostta"}, "edited": false, "score": 0, "creation_date": 1470807327, "post_id": 38864771, "comment_id": 65092952, "body": "C... Sorry my bad i was not aware of the difference.."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1470807464, "post_id": 38864771, "comment_id": 65093003, "body": "Look up &#39;multi-precision arithmetic&#39; and libraries such as <a href=\"http://gmplib.org/\" rel=\"nofollow noreferrer\">GMP</a> or the BN (big number) section of <a href=\"http://openssl.org/\" rel=\"nofollow noreferrer\">OpenSSL</a>, etc.  It also appears from the <a href=\"https://stackoverflow.com/questions/tagged/boost-multiprecision\">boost-multiprecision</a> tag that there is a Boost library in C++ for the job."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1470807541, "post_id": 38864771, "comment_id": 65093028, "body": "You know you can have arrays of arrays, right? Or arrays of pointers to arrays."}, {"owner": {"reputation": 33, "user_id": 6698587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Xonk.jpg?s=128&g=1", "display_name": "nalostta", "link": "https://stackoverflow.com/users/6698587/nalostta"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1470807773, "post_id": 38864771, "comment_id": 65093118, "body": "@immibis But then representing the series as a number makes comparitively more sense as i have add certain digits to the series from both the right and the left...in an array, adding number is feasible for only one side..adding it from both the sides is i guess quite difficult..."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470807811, "post_id": 38864771, "comment_id": 65093138, "body": "\u2026and\u2026   For floating-point arithmetic, you might investigate <a href=\"http://www.mpfr.org/\" rel=\"nofollow noreferrer\">MPFR</a>, and there&#39;s <a href=\"http://www.multiprecision.org/\" rel=\"nofollow noreferrer\">MPC</a> for complex arithmetic.  The GMP, MPFR and MPC libraries are used by GCC."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470807938, "post_id": 38864771, "comment_id": 65093190, "body": "&#39;Representing the series&#39; \u2014 what are we dealing with here?  It&#39;s beginning to sound like an <a href=\"http://mywiki.wooledge.org/XyProblem\" rel=\"nofollow noreferrer\">XY Problem</a>.  Are you dealing with numbers, or some sort of series, or something else?  You can use list representations for a series, and you can easily add items at the start, end or middle of a list.  And, to answer your alternative question: no \u2014 there isn&#39;t a way to avoid using an array or some similar structure to store massively multi-digit numbers with arbitrary precision."}, {"owner": {"reputation": 33, "user_id": 6698587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Xonk.jpg?s=128&g=1", "display_name": "nalostta", "link": "https://stackoverflow.com/users/6698587/nalostta"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470808038, "post_id": 38864771, "comment_id": 65093236, "body": "@JonathanLeffler its a series but i chose to represent it as a really big number for the sake of convenience"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1470808143, "post_id": 38864771, "comment_id": 65093286, "body": "Convenience or inconvenience?  At the moment, it sounds more like inconvenience.  But I may just be out of my depth \u2014 I don&#39;t know what sort of series you&#39;re storing or how you store it as a single massively multi-digit number.  That&#39;d be the XY Problem aspects of your question springing to the fore."}, {"owner": {"reputation": 33, "user_id": 6698587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Xonk.jpg?s=128&g=1", "display_name": "nalostta", "link": "https://stackoverflow.com/users/6698587/nalostta"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470808315, "post_id": 38864771, "comment_id": 65093356, "body": "@JonathanLeffler. Do u know abt codechef?..."}, {"owner": {"reputation": 33, "user_id": 6698587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Xonk.jpg?s=128&g=1", "display_name": "nalostta", "link": "https://stackoverflow.com/users/6698587/nalostta"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470808677, "post_id": 38864771, "comment_id": 65093470, "body": "@JonathanLeffler codechef is a website ...theres a question m tryin to solve....it involves a series of numbers of whom i have to find permutations but the catch is that the permutations are guided by certain rules that make my life tough...\ud83d\ude05"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470808740, "post_id": 38864771, "comment_id": 65093494, "body": "OK; what I was thinking of as &#39;code chef&#39; clearly isn&#39;t what you mean by it."}], "answers": [{"tags": [], "owner": {"reputation": 1362, "user_id": 6386250, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/brwvr.jpg?s=128&g=1", "display_name": "Dr.Haimovitz", "link": "https://stackoverflow.com/users/6386250/dr-haimovitz"}, "is_accepted": false, "score": -1, "last_activity_date": 1470809268, "creation_date": 1470809268, "answer_id": 38865457, "question_id": 38864771, "link": "https://stackoverflow.com/questions/38864771/representing-large-numbers-in-c/38865457#38865457", "title": "Representing Large numbers in C?", "body": "<p>You can do it by storing the numbers as strings , here is an example for summing the numbers that are represnet that way (its in c++ but should be easy enough to convert it to c):</p>\n\n<pre><code>    string add (string &amp;s1, string &amp;s2){\n    int carry=0,sum,i;\n\n    string  min=s1,\n    max=s2,\n    result = \"\";\n\n    if (s1.length()&gt;s2.length()){\n        max = s1;\n        min = s2;\n    } else {\n        max = s2;\n        min = s1;\n    }\n\n    for (i = min.length()-1; i&gt;=0; i--){\n        sum = min[i] + max[i + max.length() - min.length()] + carry - 2*'0';\n\n        carry = sum/10;\n        sum %=10;\n\n        result = (char)(sum + '0') + result;\n    }\n\n    i = max.length() - min.length()-1;\n\n    while (i&gt;=0){\n        sum = max[i] + carry - '0';\n        carry = sum/10;\n        sum%=10;\n\n        result = (char)(sum + '0') + result;\n        i--;\n    }\n\n    if (carry!=0){\n        result = (char)(carry + '0') + result;\n    }       \n\n    return result;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6698587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Xonk.jpg?s=128&g=1", "display_name": "nalostta", "link": "https://stackoverflow.com/users/6698587/nalostta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1238, "favorite_count": 1, "closed_date": 1470809065, "answer_count": 1, "score": -1, "last_activity_date": 1470809268, "creation_date": 1470806169, "last_edit_date": 1470807349, "question_id": 38864771, "link": "https://stackoverflow.com/questions/38864771/representing-large-numbers-in-c", "closed_reason": "Duplicate", "title": "Representing Large numbers in C?", "body": "<p>How can i represent(store) large numbers in C of length upto 100 digits or more?</p>\n\n<p>Or alternatively.,</p>\n\n<p>Is there any way to store a series in a variable(and not array since i have to make an array of series itself)</p>\n"}, {"tags": ["c", "linux", "unix", "ipc"], "answers": [{"comments": [{"owner": {"reputation": 458, "user_id": 4720686, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1e6d09785dc874defe437f269dbb7d56?s=128&d=identicon&r=PG&f=1", "display_name": "arjun gaur", "link": "https://stackoverflow.com/users/4720686/arjun-gaur"}, "edited": false, "score": 0, "creation_date": 1470813501, "post_id": 38865115, "comment_id": 65096107, "body": "it&#39;s showing 0 in both lspid ,lrpid. Is it because no process has read or written to the queues?"}, {"owner": {"reputation": 4480, "user_id": 5595825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/185741aa854cd8ac5a7720f639cddbf8?s=128&d=identicon&r=PG&f=1", "display_name": "pah", "link": "https://stackoverflow.com/users/5595825/pah"}, "reply_to_user": {"reputation": 458, "user_id": 4720686, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1e6d09785dc874defe437f269dbb7d56?s=128&d=identicon&r=PG&f=1", "display_name": "arjun gaur", "link": "https://stackoverflow.com/users/4720686/arjun-gaur"}, "edited": false, "score": 0, "creation_date": 1470828965, "post_id": 38865115, "comment_id": 65106154, "body": "@arjungaur Exactly."}], "tags": [], "owner": {"reputation": 4480, "user_id": 5595825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/185741aa854cd8ac5a7720f639cddbf8?s=128&d=identicon&r=PG&f=1", "display_name": "pah", "link": "https://stackoverflow.com/users/5595825/pah"}, "is_accepted": false, "score": 0, "last_activity_date": 1470807894, "creation_date": 1470807894, "answer_id": 38865115, "question_id": 38864709, "link": "https://stackoverflow.com/questions/38864709/how-to-determine-which-process-is-using-a-queue/38865115#38865115", "title": "how to determine which process is using a queue?", "body": "<p>You can only retrieve the last PID that called <code>msgsnd()</code> and the last PID that called <code>msgrcv()</code> for the specified System V message queue.</p>\n\n<p>You can use:</p>\n\n<pre><code>ipcs -q -p\n</code></pre>\n\n<p>It will output:</p>\n\n<pre><code>------ Message Queues PIDs --------\nmsqid      owner      lspid      lrpid     \n</code></pre>\n\n<p>Where:</p>\n\n<ul>\n<li><strong><code>lspid</code></strong> - PID of last <code>msgsnd()</code></li>\n<li><strong><code>lrpid</code></strong> - PID of last <code>msgrcv()</code></li>\n</ul>\n"}], "owner": {"reputation": 458, "user_id": 4720686, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1e6d09785dc874defe437f269dbb7d56?s=128&d=identicon&r=PG&f=1", "display_name": "arjun gaur", "link": "https://stackoverflow.com/users/4720686/arjun-gaur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1508, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470807894, "creation_date": 1470805898, "question_id": 38864709, "link": "https://stackoverflow.com/questions/38864709/how-to-determine-which-process-is-using-a-queue", "title": "how to determine which process is using a queue?", "body": "<p>I have a message queue id, i need to determine which processes are reading from and writing to that queue.\nIs there a possible option that can be used with 'ipcs'?</p>\n\n<pre><code>ipcs -q|grep qid \n</code></pre>\n\n<p>this doesn't provide those details.\nThanks</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1470805103, "post_id": 38864558, "comment_id": 65092210, "body": "How are you calling it, what is it supposed to do, and why isn&#39;t it indented?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1470805649, "post_id": 38864558, "comment_id": 65092393, "body": "Please post a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470805813, "post_id": 38864558, "comment_id": 65092445, "body": "The code as written works fine with a program like this: <code>int main(void) {     char *t1 = test(&quot;Hello World&quot;);      if (t1 != 0)         printf(&quot;[%s]\\n&quot;, t1);     free(t1);      return 0; }</code> \u2014 assuming you include the mighty trio of headers (<code>&lt;stdio.h&gt;</code>, <code>&lt;stdlib.h&gt;</code> and <code>&lt;string.h&gt;</code>) \u2014 and <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\"><code>valgrind</code></a> gives it a clean bill of health.  So either you&#39;ve fixed the code while getting it clean enough to compile, or your problem is elsewhere.  IMNSHO, of course."}, {"owner": {"reputation": 21, "user_id": 6592703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/961bb189d49609ac3c497ff9ea9306a6?s=128&d=identicon&r=PG&f=1", "display_name": "Pushpa", "link": "https://stackoverflow.com/users/6592703/pushpa"}, "edited": false, "score": 0, "creation_date": 1470805939, "post_id": 38864558, "comment_id": 65092507, "body": "When i compile with normal gcc it works fine. This issue is seen with x86 64 bit compiler."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470806031, "post_id": 38864558, "comment_id": 65092539, "body": "Are you including the headers?  I tested on Mac OS X 10.11.6 with GCC 6.1.0 with a 64-bit compilation (an Intel x86_64 platform).  You could run into problems if you didn&#39;t include the headers and the compiler was too old and/or assumed that <code>malloc()</code> returned an <code>int</code> because it didn&#39;t have a declaration."}, {"owner": {"reputation": 21, "user_id": 6592703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/961bb189d49609ac3c497ff9ea9306a6?s=128&d=identicon&r=PG&f=1", "display_name": "Pushpa", "link": "https://stackoverflow.com/users/6592703/pushpa"}, "edited": false, "score": 0, "creation_date": 1470806129, "post_id": 38864558, "comment_id": 65092575, "body": "Yes. I have included headers. I see that &quot;\\b\\b&quot; gets copied to str3. after that it crashes."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470806230, "post_id": 38864558, "comment_id": 65092612, "body": "How exactly do you call <code>test()</code>?  Make your code complete: we can&#39;t debug the non-working code if you don&#39;t provide the non-working code.  That sounds as if you&#39;re passing an improper pointer as the argument to the <code>test()</code> function.  It doesn&#39;t sound as if <code>malloc()</code> is failing, though for maximum safety (or production code) you should check for that before using the returned value."}, {"owner": {"reputation": 21, "user_id": 6592703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/961bb189d49609ac3c497ff9ea9306a6?s=128&d=identicon&r=PG&f=1", "display_name": "Pushpa", "link": "https://stackoverflow.com/users/6592703/pushpa"}, "edited": false, "score": 0, "creation_date": 1470806718, "post_id": 38864558, "comment_id": 65092758, "body": "Thanks Jonathan. I am passing register char * to the function. Is it because of that  ?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1470806762, "post_id": 38864558, "comment_id": 65092776, "body": "The problem is that you didn&#39;t declare <code>test</code> before you used it, so the compiler assumes it returns an <code>int</code> when it is called, but that doesn&#39;t work properly on 64-bit (because <code>sizeof(int) != sizeof(char *)</code> on 64-bit, but it coincidentally &#39;works&#39; on 32-bit because there <code>sizeof(int) == sizeof(char *)</code>.  But the compiler should be shrieking at you.  How many warnings are you ignoring?  Which version of GCC are you actually using, on which platform.  At minimum, add <code>-std=c11 -Wall -Wextra</code>; I add other options to that list before I&#39;ll risk posting code here on SO."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470807091, "post_id": 38864558, "comment_id": 65092876, "body": "Also note that there is no point in using <code>register</code> in modern C code.  The compiler basically ignores it (though it will complain if you try to take the address of a <code>register</code> variable).  <a href=\"http://stackoverflow.com/questions/1549685/how-can-i-use-a-variable-as-a-variable-name-in-perl\">C++17</a> is removing <code>register</code> as an active keyword, though reserving it for future (re)use."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1470807322, "post_id": 38864558, "comment_id": 65092948, "body": "Note that at this stage of your C programming career, if the compiler generates a warning, treat it as an error that must be fixed before running the program.  In fact, if you&#39;ve got any sense, you&#39;ll use that as a guideline for the indefinite future.  I&#39;ve only been coding in C for 30+ years, and if there&#39;s a warning, I make sure I fully understand what it means and why I&#39;m getting it before ignoring it.  I&#39;ll go to considerable lengths to make sure that my code compiles with zero warnings under stringent options and with <code>-Werror</code> (which forces GCC to treat warnings as errors)."}], "answers": [{"tags": [], "owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "is_accepted": false, "score": 0, "last_activity_date": 1470812429, "creation_date": 1470812429, "answer_id": 38866333, "question_id": 38864558, "link": "https://stackoverflow.com/questions/38864558/segmentation-in-string-copy-in-c/38866333#38866333", "title": "Segmentation in string copy in C", "body": "<p>Your issue is that you didn't declare your function <code>test</code> properly. You have to declare every function that is used before it is used, be it by putting the actual function above or writing a function declaration.</p>\n\n<p>As soon as you do that, your code works:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nchar *test (char *str); // this is the function declaration\nint main(void) {\n    register char *str = \"Hello World\";\n    char *ans;\n    ans = test(str);\n    if(!ans)\n        return 1;\n    free(ans);\n    return 0;\n}\nchar *test(char *str) {\n\n         char *str1 ;\n         char *str2;\n         char *str3;\n         str1 = malloc(strlen(str) + 5);\n         str2 = str;\n         str3 = str1;\n         *str3++ = '\\b';\n         *str3++ = '\\b';\n         while(*str2)\n             *str3++ = *str2++;\n         *str3++ = '\\f';\n         *str3++ = '\\f';\n         *str3 = '\\0';\n         return (str1);\n}\n</code></pre>\n\n<p>Demo: <a href=\"https://ideone.com/HIXyMs\" rel=\"nofollow\">https://ideone.com/HIXyMs</a></p>\n"}], "owner": {"reputation": 21, "user_id": 6592703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/961bb189d49609ac3c497ff9ea9306a6?s=128&d=identicon&r=PG&f=1", "display_name": "Pushpa", "link": "https://stackoverflow.com/users/6592703/pushpa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1470812429, "creation_date": 1470805052, "last_edit_date": 1470806968, "question_id": 38864558, "link": "https://stackoverflow.com/questions/38864558/segmentation-in-string-copy-in-c", "title": "Segmentation in string copy in C", "body": "<p>I am getting <code>segmentation fault</code> in the below <code>while</code> loop.</p>\n\n<pre><code>int main() {\n    register char *str = \"Hello World\";\n    char *ans;\n    ans = test(str);\n    if(!ans)\n        return 1;\n    free(ans);\n    return 0;\n}\nchar *test(char *str) {\n\n         char *str1 ;\n         char *str2;\n         char *str3;\n         str1 = malloc(strlen(str) + 5);\n         str2 = str;\n         str3 = str1;\n         *str3++ = '\\b';\n         *str3++ = '\\b';\n         while(*str2)\n             *str3++ = *str2++;\n         *str3++ = '\\f';\n         *str3++ = '\\f';\n         *str3 = '\\0';\n         return (str1);\n}\n</code></pre>\n\n<p>I think I am getting <code>segmentation fault</code> in <code>while</code> loop.  Could you please suggest why?  I am calling this as <code>char *ans = test(string)</code> where <code>string</code> is <code>register char *string</code>. Let us say, I have <code>hello world</code> in the string. My intention is to return <code>\\b\\bHello World\\f\\f</code> from <code>test()</code>.</p>\n"}, {"tags": ["c", "ffmpeg"], "answers": [{"tags": [], "owner": {"reputation": 831, "user_id": 1912249, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/114d09568966cf699bda2fdebe638ae1?s=128&d=identicon&r=PG", "display_name": "Victor.dMdB", "link": "https://stackoverflow.com/users/1912249/victor-dmdb"}, "is_accepted": false, "score": 0, "last_activity_date": 1470808919, "last_edit_date": 1470808919, "creation_date": 1470807807, "answer_id": 38865095, "question_id": 38864119, "link": "https://stackoverflow.com/questions/38864119/custom-real-time-input-for-ffmpeg-in-c/38865095#38865095", "title": "Custom real-time input for ffmpeg in C", "body": "<p>It was something to do with my read function, nothing to do with the avformat_open_input. I was writing over the pointer as <a href=\"http://www.ffmpeg.org/doxygen/trunk/doc_2examples_2avio_reading_8c-example.html\" rel=\"nofollow\">per described here</a> (see read_packet function). After thinking about it more yes it made sense to do, given the the read function should increment the pointer to the beginning of the next frame.</p>\n"}], "owner": {"reputation": 831, "user_id": 1912249, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/114d09568966cf699bda2fdebe638ae1?s=128&d=identicon&r=PG", "display_name": "Victor.dMdB", "link": "https://stackoverflow.com/users/1912249/victor-dmdb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470808919, "creation_date": 1470802561, "last_edit_date": 1495540858, "question_id": 38864119, "link": "https://stackoverflow.com/questions/38864119/custom-real-time-input-for-ffmpeg-in-c", "title": "Custom real-time input for ffmpeg in C", "body": "<p>I'm implementing a custom io with avformat_alloc_context and avio_alloc_context to be able to read the output of another function in real-time. A buffer is populated by this function in a boost asio thread, while ffmpeg is reading this buffer from another thread.</p>\n\n<p>I initialise an io buffer where this function writes into, and which ffmpeg reads:</p>\n\n<pre><code>BufferData input_buffer = {0};\ninput_buffer.size = 65536;\ninput_buffer.ptr = (uint8_t *) av_malloc(buf_size);\nmemset(input_buffer.ptr,'0',100); \n\nfprintf(stdout, \"initialisation: buffer pointer %p buffer data pointer: %p\\n\", &amp;input_buffer, input_buffer.ptr);\n</code></pre>\n\n<p>Why i do the memset <a href=\"https://stackoverflow.com/questions/38829651/ffmpeg-avformat-open-input-returning-averror-invaliddata?noredirect=1#comment65041998_38829651\">is explained here</a>.\nThen to test out the pointer address I did:</p>\n\n<pre><code>BufferData * decode_buffer;\ndecode_buffer-&gt;size = 65536;\ndecode_buffer-&gt;ptr = (uint8_t *) av_malloc(decode_buffer-&gt;size);\n\nAVIOContext * av_io_ctx = avio_alloc_context(decode_buffer-&gt;ptr, decode_buffer-&gt;size, 0, &amp;input_buffer, &amp;read_function, NULL, NULL);\n\nAVFormatContext *av_fmt_ctx = avformat_alloc_context();\nav_fmt_ctx-&gt;pb = av_io_ctx;\n\n\nBufferData * tmpPtr = (BufferData * ) video_input_file-&gt;av_io_ctx-&gt;opaque;\n\nfprintf(stdout, \"video decoder before: buffer pointer %p, buffer data pointer: %p\\n\", tmpPtr, tmpPtr-&gt;ptr);\n\nopen_res = avformat_open_input(&amp;av_fmt_ctx, \"anyname\", in_fmt, options ? &amp;options : NULL);\n\nfprintf(stdout, \"video decoder after: buffer pointer %p, buffer data pointer: %p\\n\", tmpPtr, tmpPtr-&gt;ptr);\n</code></pre>\n\n<p>For reference</p>\n\n<pre><code>typedef struct {\n    uint8_t *ptr;\n    size_t size;\n} BufferData;\n</code></pre>\n\n<p>The read function</p>\n\n<pre><code>static int read_function(void* opaque, uint8_t* buf, int buf_size) {\n    BufferData *bd = (BufferData *) opaque;\n    buf_size = FFMIN(buf_size, bd-&gt;size);\n    memcpy(buf, bd-&gt;ptr, buf_size);\n    bd-&gt;ptr  += buf_size; //This seemed to cause the problem\n    bd-&gt;size -= buf_size;\n    return buf_size;\n}\n</code></pre>\n\n<p>And the result will be:</p>\n\n<pre><code>initialisation: buffer pointer 0x7f2c4a613620, buffer data pointer: 0x7f2c48c56040\n\nvideo decoder before: buffer pointer 0x7f2c4a613620, buffer data pointer: 0x7f2c48c56040\n\nvideo decoder after: buffer pointer 0x7f2c4a613620, buffer data pointer: 0x7f2c49e24b50\n</code></pre>\n\n<p>Is it a normal behaviour that the buffer data ptr is changed by avformat_open_input? since I would like to keep the initial pointer address given I am using it in another function, and have malloced it the required memory.</p>\n"}, {"tags": ["c", "string", "pointers", "server", "strsep"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 3, "creation_date": 1470802528, "post_id": 38864073, "comment_id": 65091384, "body": "Have you considered that this code is buggy and is doing wrong things? For example, <code>char** copyofLine = malloc(sizeof(char**)); strcpy(*copyofLine, line);</code> is just entirely wrong and causes memory corruption. <code>*copyofLine</code> is an unintialised value and is not a valid pointer to a char buffer. Doesn&#39;t fill one with confidence for any of the rest of the code including the <code>strsep</code> calls shown."}, {"owner": {"reputation": 1078, "user_id": 734744, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3a20b00349cbb9c96c21c307a74487a7?s=128&d=identicon&r=PG", "display_name": "Sameer Naik", "link": "https://stackoverflow.com/users/734744/sameer-naik"}, "edited": false, "score": 2, "creation_date": 1470803094, "post_id": 38864073, "comment_id": 65091524, "body": "and &quot;]&quot; + 1 looks odd to me. it produces this warning. <code>warning: initialization makes pointer from integer without a cast [enabled by default]</code> so it points to a string which is after the string &quot;]&quot; in memory, most likely to NULL character if I am thinking right."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1470803583, "post_id": 38864073, "comment_id": 65091664, "body": "My guess is that the <code>+1</code> is supposed to be outside the <code>strsep</code> call. To move the string past an opening <code>[</code>. That is, should be: <code>abs_path = strsep(copyofLine, &quot;]&quot;)+1;</code>. We don&#39;t actually know the full context of this program. You claim the string is html but it may not be. It may be a json encoded html for example."}, {"owner": {"reputation": 1078, "user_id": 734744, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3a20b00349cbb9c96c21c307a74487a7?s=128&d=identicon&r=PG", "display_name": "Sameer Naik", "link": "https://stackoverflow.com/users/734744/sameer-naik"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1470805237, "post_id": 38864073, "comment_id": 65092249, "body": "@kaylum Looks like this is the request line received by a web server like <code>GET &#47;somepage?a=b&amp;c=d HTTP&#47;1.1</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1470810532, "post_id": 38864073, "comment_id": 65094452, "body": "Concur with the skeptics of the original code. It looks to parse a <code>GET</code> request, parsing <code>GET</code> first and then parsing everything from that point <i>up to, and including,</i> the closing <code>&#39;]&#39;</code>, and then parsing everything up to the first <code>&#39;\\&#39;</code> (which it expects to be <code>&quot;HTTP&#47;1.1&quot;</code> (How old is this code? Internet RFC 2616  1999). So it appears to be looking for <code>&#39;GET [some stuff]HTTP&#47;1.1\\&#39;</code> (with the error <code>&quot;]&quot; + 1</code> noted in the earlier comments)"}], "owner": {"reputation": 437, "user_id": 6557079, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7ade9a92d724b19b0c7cc35bb300fc7d?s=128&d=identicon&r=PG&f=1", "display_name": "gloopit", "link": "https://stackoverflow.com/users/6557079/gloopit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1470802193, "creation_date": 1470802193, "question_id": 38864073, "link": "https://stackoverflow.com/questions/38864073/how-is-strsep-working-here-why", "title": "How is strsep working here? Why?", "body": "<p>I am trying to learn about writing servers in C and have come across something that is really confusing me. I have been trying to understand some code (not mine). I understand most of it...except this one crucial element in this <code>parse</code> function.</p>\n\n<p>Specifically, how is <code>strsep()</code> working in the code below?</p>\n\n<p>I thought that <code>strsep()</code> finds a point (token?) in which to stop within a string and then chops the end off, storing the remainder within a new variable. Such as finding the <code>method</code> within the requestline: <code>method = strsep(copyofLine, \" \");</code></p>\n\n<p>This makes sense to me here.</p>\n\n<p>However I don't understand how it works with this: </p>\n\n<p><code>//put request-target in abs_path\n    abs_path = strsep(copyofLine, \"]\" + 1);</code></p>\n\n<p>Why would there be a <code>]</code> in an HTTP request line?</p>\n\n<p>and also here:</p>\n\n<p><code>HTTP_version = strsep(copyofLine, \"\\\\\");</code></p>\n\n<p>Why would there be a backwards slash? Please explain.</p>\n\n<p>Below is the full function. Thank you.</p>\n\n<pre><code>/**\n * Parses a request-line, storing its absolute-path at abs_path \n * and its query string at query, both of which are assumed\n * to be at least of length LimitRequestLine + 1.\n */\nbool parse(const char* line, char* abs_path, char* query)\n{\n    //allocate memory for copy of line\n    char** copyofLine = malloc(sizeof(char**));\n    //copy line into new variable\n    strcpy(*copyofLine, line);\n    //allocate memory for method and copy actual method into it\n    char* method = malloc(sizeof(char*));\n    method = strsep(copyofLine, \" \");\n    //if method is not get, respond to browser with error 405 and return false\n    if (strcasecmp(method, \"GET\") != 0) {\n        error(405);\n        return false;\n    }\n    //put request-target in abs_path\n    abs_path = strsep(copyofLine, \"]\" + 1);\n    //if request-target does not begin with /, respond with 501 and return false\n    if (abs_path[0] != '/') {\n        error(501);\n        return false;\n    }\n    char* HTTP_version = malloc(sizeof(char*));\n    HTTP_version = strsep(copyofLine, \"\\\\\");\n    if(strcasecmp(HTTP_version, \"HTTP/1.1\") != 0) {\n        error(505);\n        return false;\n    }\n    //if request-target contains a \"\", respond with error 400 and return false\n    char* c = abs_path;\n    if (strchr(\"\\\"\", *c)) {\n        error(400);\n        return false;\n    }\n    //allocate memory for copy of abs_patg\n    char** copyofAbs_path = malloc(sizeof(char**));\n    //copy line into new variable\n    strcpy(*copyofAbs_path, abs_path);\n    for (int i = 0, n = strlen(*copyofAbs_path); i &lt; n; i++) {\n        for (int j = 0, m = strlen(*copyofAbs_path) - i; j &lt; m; j++) {\n            if (*copyofAbs_path[i] == '/' &amp;&amp; *copyofAbs_path[i+1] == '?') query[j] = *copyofAbs_path[i+2];\n            if (*copyofAbs_path[i] == '/' &amp;&amp; *copyofAbs_path[i+1] != '?') query[j] = *copyofAbs_path[i+1];\n            // if (strlen(query)) &lt; 1) query = \"\";\n            if (query[j] == '\\0') break;\n        }\n    }\n\n    free(HTTP_version);\n    free(c);\n    free(method);\n    free(copyofLine);\n    free(copyofAbs_path);\n    return false;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "initialization"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 5, "creation_date": 1470797480, "post_id": 38863476, "comment_id": 65090330, "body": "It points to an indeterminate location \u2014 you can&#39;t readily predict where it will point, but it is unlikely to random in any strict meaning of the term.  What error does occur when you use <code>printf(&quot;%p&quot;, ptr);</code>?  You could be being told that <code>%p</code> expects a <code>void *</code> and you are passing a <code>char *</code> (not the same thing).  You might not be seeing any output because you don&#39;t have a newline at the end of the printing.  You might be suffering from something else.  You&#39;ve not shown an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) or the error message you get, so we can&#39;t help you."}, {"owner": {"reputation": 86, "user_id": 6517623, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIxwo.png?s=128&g=1", "display_name": "Hedron", "link": "https://stackoverflow.com/users/6517623/hedron"}, "edited": false, "score": 0, "creation_date": 1470797768, "post_id": 38863476, "comment_id": 65090389, "body": "Why wouldn&#39;t it just point to null(0x0)?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1470797796, "post_id": 38863476, "comment_id": 65090392, "body": "&quot;And it says that uninitialized pointer <b>might</b> point to anywhere&quot; is true. &quot;Since uninitialized pointer ptr points to some random location&quot; is not necessarily true.  It may also have a trap value that when referenced kills the code.  It may have an illegal value the makes no sense to interpret as a pointer.   It is not <i>initialized</i>.  It is UB -undefined behavior."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "reply_to_user": {"reputation": 86, "user_id": 6517623, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIxwo.png?s=128&g=1", "display_name": "Hedron", "link": "https://stackoverflow.com/users/6517623/hedron"}, "edited": false, "score": 0, "creation_date": 1470798048, "post_id": 38863476, "comment_id": 65090441, "body": "@hedron It can depending on where/how the pointer is declared. Non-auto variables (e.g. globals) are indeed initialised to zero. But I guess you are asking why it can&#39;t always be initialised to 0 - the answer is because C is a minimialist language. It costs something (e.g. cpu time) to do implicit initialisation. So why pay that cost when correctly written code will do an explicit init anyway?"}, {"owner": {"reputation": 4426, "user_id": 450609, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6708bd9ccabfcb1cf6863fb32f32d1de?s=128&d=identicon&r=PG", "display_name": "dave", "link": "https://stackoverflow.com/users/450609/dave"}, "edited": false, "score": 0, "creation_date": 1470798629, "post_id": 38863476, "comment_id": 65090551, "body": "Works for me (linux x86_64/gcc 4.4.7), and prints out 0, using printf with <code>%p</code> and casting to <code>(void *)</code> gives me the output &quot;(nil)&quot;.  So this is obviously your compiler.  I don&#39;t think this should be UB (we aren&#39;t dereferencing the pointer then again the output is likely to be implementation defined .... which is slightly different from UB)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 4426, "user_id": 450609, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6708bd9ccabfcb1cf6863fb32f32d1de?s=128&d=identicon&r=PG", "display_name": "dave", "link": "https://stackoverflow.com/users/450609/dave"}, "edited": false, "score": 1, "creation_date": 1470798796, "post_id": 38863476, "comment_id": 65090571, "body": "@dave it is UB according to the C Standard (using an uninitialized variable)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1470810763, "post_id": 38863476, "comment_id": 65094585, "body": "@M.M It is not necessarily UB, the value is indeterminate. It could either be a garbage value (unspecified behavior) or a trap representation (undefined behavior)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1470810986, "post_id": 38863476, "comment_id": 65094712, "body": "@Lundin See C11 6.3.2.1/2 and <a href=\"http://stackoverflow.com/questions/25074180/\">stackoverflow.com/questions/25074180</a>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1470844837, "post_id": 38863476, "comment_id": 65117903, "body": "@Lundin: It <i>is</i> necessarily undefined behavior."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1470895974, "post_id": 38863476, "comment_id": 65137294, "body": "This is yet another dead horse debate that&#39;s been discussed on SO many times before. Yeah in case you just print the uninitialized pointer itself then it is UB because it could have been declared as <code>register</code>. That&#39;s a special case. Otherwise, if the address of the variable was taken, it is only UB in case of trap representations."}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1470844946, "post_id": 38864507, "comment_id": 65117974, "body": "In fact, dereferencing an uninitialized pointer <i>always</i> has undefined behavior, even if it happens by coincidence to contain the address of some valid object. The standard explicitly says so; see <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a> 6.3.2.1p2 (thanks to M.M for the citation)."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1574260463, "post_id": 38864507, "comment_id": 104169110, "body": "You might want to consider revising this answer, the variable is an automatic one, having never had its address taken, it is UB as in <b>UB</b>, even if you do null check it..."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1470804705, "creation_date": 1470804705, "answer_id": 38864507, "question_id": 38863476, "link": "https://stackoverflow.com/questions/38863476/confusion-about-the-fact-that-uninitialized-pointer-points-to-anywhere/38864507#38864507", "title": "Confusion about the fact that uninitialized pointer points to anywhere", "body": "<p>The contents of an unitialized <code>auto</code> variable (pointer type or otherwise) are <em>indeterminate</em>; in practice, it's whatever was last written to that memory location.  The odds that this random bit pattern corresponds to a valid address<sup>1</sup> in your program are pretty low; it may even be a <em>trap representation</em> (a bit pattern that does not correspond to a legal value for the type). </p>\n\n<p>Attempting to dereference an invalid pointer value results in undefined behavior; <em>any</em> result is possible.  Your code may crash outright, it may run with no <em>apparent</em> issues, it may leave your system in a bad state.</p>\n\n<p><hr>\n<sup></p>\n\n<ol>\n<li>That is, the address of an object or function defined in your program, or a dynamic object allocated with <code>malloc</code> or similar.\n</ol>\n\n<p></sup></p>\n"}], "owner": {"reputation": 1692, "user_id": 6588224, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fa171624f6e8b69a48e9f0b71a5dcd1a?s=128&d=identicon&r=PG&f=1", "display_name": "Jin", "link": "https://stackoverflow.com/users/6588224/jin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1470804705, "creation_date": 1470797295, "last_edit_date": 1470799283, "question_id": 38863476, "link": "https://stackoverflow.com/questions/38863476/confusion-about-the-fact-that-uninitialized-pointer-points-to-anywhere", "title": "Confusion about the fact that uninitialized pointer points to anywhere", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int *ptr;\n    printf(\"%p\", ptr); // Error: uninitialized local variable 'ptr' used\n                       // Output is \"0\"\n}\n</code></pre>\n\n<p>I'm reading <a href=\"http://c-faq.com/null/null1.html\" rel=\"nofollow\">C-FAQ</a> about null pointer. And it says that uninitialized pointer might point to anywhere. Does that mean it points to random location in memory? Also if this statement is true, why does error occur if i try <code>printf(\"%p\",ptr)</code>? Since uninitialized pointer <code>ptr</code> points to some random location, it seems that it must print out this random location! </p>\n"}, {"tags": ["c", "include", "undefined-reference"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1470797000, "post_id": 38863425, "comment_id": 65090217, "body": "Please do not post links to images; post the code!"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 2, "creation_date": 1470797091, "post_id": 38863425, "comment_id": 65090236, "body": "A function is <i>declared</i> in a header file, but it is <i>defined</i> in <code>.c</code>, <code>.o</code> (<code>.obj</code>), <code>.a</code> (<code>.lib</code>) or <code>.so</code> (<code>.dll</code>) files. If you only copied the <i>include</i> directory, you have the function <i>declared</i>, but not <i>defined</i>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1470797092, "post_id": 38863425, "comment_id": 65090238, "body": "You should post the command you&#39;re using to link the files.  Are you including the correct library when you run the linker?  The compilation to object file appears to be working OK; it is the linking that is failing."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1470797117, "post_id": 38863425, "comment_id": 65090241, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}, {"owner": {"reputation": 193, "user_id": 1666054, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/345ddbd186fe874b2a0a15826ca3f8b2?s=128&d=identicon&r=PG", "display_name": "learningtofly", "link": "https://stackoverflow.com/users/1666054/learningtofly"}, "edited": false, "score": 0, "creation_date": 1470798069, "post_id": 38863425, "comment_id": 65090444, "body": "I have edited the post to add my code"}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 1666054, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/345ddbd186fe874b2a0a15826ca3f8b2?s=128&d=identicon&r=PG", "display_name": "learningtofly", "link": "https://stackoverflow.com/users/1666054/learningtofly"}, "edited": false, "score": 0, "creation_date": 1470798868, "post_id": 38863550, "comment_id": 65090587, "body": "Thank you for this answer.  I added libssl.a and libcrypto.a to my sourcecode directory and then to my makefile and it compiled correctly.  I am new to C and eclipse so this answer was written in a manner I was able to understand."}, {"owner": {"reputation": 7429, "user_id": 4811873, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/2ef5bab087ac0b70e03e34b0b0009fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Robinson", "link": "https://stackoverflow.com/users/4811873/mike-robinson"}, "reply_to_user": {"reputation": 193, "user_id": 1666054, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/345ddbd186fe874b2a0a15826ca3f8b2?s=128&d=identicon&r=PG", "display_name": "learningtofly", "link": "https://stackoverflow.com/users/1666054/learningtofly"}, "edited": false, "score": 0, "creation_date": 1470840120, "post_id": 38863550, "comment_id": 65114565, "body": "Yes, and it would be more-correct to say that &quot;it <b>linked</b> correctly.&quot; You see, the <code>gcc</code> command <i>(et al)</i> ordinarily does both: it compiles the files (to produce <code>.a</code> files containing object-code), then it <i>links</i> everything to produce a single, (fairly ...) self-contained file: &quot;an executable.&quot; Two distinct operations are therefore performed, but unobtrusively. (Eclipse hides details even more.) By adding these two (so-called &quot;static,&quot; <i>vs</i>. &quot;dynamic&quot; ...) libraries to the mix, you enabled the linker to successfully find all of the assets that it needed."}], "tags": [], "owner": {"reputation": 7429, "user_id": 4811873, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/2ef5bab087ac0b70e03e34b0b0009fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Robinson", "link": "https://stackoverflow.com/users/4811873/mike-robinson"}, "is_accepted": true, "score": 1, "last_activity_date": 1470797893, "creation_date": 1470797893, "answer_id": 38863550, "question_id": 38863425, "link": "https://stackoverflow.com/questions/38863425/why-is-a-function-in-a-c-header-file-available-in-main-c-but-errors-as-undefine/38863550#38863550", "title": "Why is a function in a C header file available in main.c, but errors as undefined at compile time?", "body": "<p>The purpose of a <code>.h</code> <em>header</em> file is to describe what a particular function \"looks like,\" so that correct code can be generated to make a call to that function.</p>\n\n<p>But this, by itself, does not provide <em>the function itself!</em> </p>\n\n<p>The final process of \"linking all of the various compiler-outputs and libraries into 'a <em>complete</em> thing that can actually be <em>run'\"</em> is performed by a separate program altogether ... which, appropriately enough, is called a \"linker.\"</p>\n\n<p>The subroutines that you refer-to could come from several places: &nbsp; from another, separately-compiled, source program, <em>or</em> from a library. (If from a library, that library might be \"statically\" or \"dynamically\" linked.) Nevertheless, <em>somehow,</em> the necessary object-code must be found, so that they can be incorporated into the final executable.</p>\n\n<p>OpenSSL subroutines, undoubtedly, come from a <em>library</em> (that is part of OpenSSL). Therefore, your Eclipse project probably does not presently contain a reference to that library, so that it can be found when needed.</p>\n"}], "owner": {"reputation": 193, "user_id": 1666054, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/345ddbd186fe874b2a0a15826ca3f8b2?s=128&d=identicon&r=PG", "display_name": "learningtofly", "link": "https://stackoverflow.com/users/1666054/learningtofly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "accepted_answer_id": 38863550, "answer_count": 1, "score": -1, "last_activity_date": 1470798049, "creation_date": 1470796852, "last_edit_date": 1470798049, "question_id": 38863425, "link": "https://stackoverflow.com/questions/38863425/why-is-a-function-in-a-c-header-file-available-in-main-c-but-errors-as-undefine", "title": "Why is a function in a C header file available in main.c, but errors as undefined at compile time?", "body": "<p>I have a C project in Eclipse (Neon) on Ubuntu 15.10.  I have downloaded the OpenSSL library.</p>\n\n<p>I have included <code>openssl/bn.h</code> in my preprocessor directives.  In my <code>main.c</code> file, I can refer to <code>BN_new()</code>, a function in <code>bn.h</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0tsq3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0tsq3.png\" alt=\"bn.h\"></a></p>\n\n<p>However, when I try to compile, I get an undefined reference for all calls into <code>bn.h</code> (<code>BN_new()</code>, <code>BN_free()</code>, etc).</p>\n\n<p><a href=\"https://i.stack.imgur.com/eCsXP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eCsXP.png\" alt=\"BN_new undefined\"></a></p>\n\n<p>As a side note, I copied the contents of <code>openssl-1.0.2h/include/openssl</code> to my <code>/usr/include/</code> directory.</p>\n\n<p>Why is this error happening at compile time?</p>\n\n<p>my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"jpake.h\"\n#include &lt;openssl/crypto.h&gt;\n#include &lt;openssl/sha.h&gt;\n#include &lt;openssl/err.h&gt;\n#include &lt;openssl/bn.h&gt;\n#include &lt;memory.h&gt;\n\n/*\n * In the definition, (xa, xb, xc, xd) are Alice's (x1, x2, x3, x4) or    \n * Bob's (x3, x4, x1, x2). If you see what I mean.\n */\ntypedef struct\n{\nchar *name;  /* Must be unique */\nchar *peer_name;\nBIGNUM *p;\nBIGNUM *g;\nBIGNUM *q;\nBIGNUM *gxc; /* Alice's g^{x3} or Bob's g^{x1} */\nBIGNUM *gxd; /* Alice's g^{x4} or Bob's g^{x2} */\n} JPAKE_CTX_PUBLIC;\n\n\nstruct JPAKE_CTX\n{\n JPAKE_CTX_PUBLIC p;\n BIGNUM *secret;   /* The shared secret */\n BN_CTX *ctx;\n BIGNUM *xa;       /* Alice's x1 or Bob's x3 */\n BIGNUM *xb;       /* Alice's x2 or Bob's x4 */\n BIGNUM *key;      /* The calculated (shared) key */\n };\n\nstatic void JPAKE_ZKP_init(JPAKE_ZKP *zkp)\n{\nzkp-&gt;gr = BN_new();\nzkp-&gt;b = BN_new();\n}\n\nstatic void JPAKE_ZKP_release(JPAKE_ZKP *zkp)\n{\nBN_free(zkp-&gt;b);\nBN_free(zkp-&gt;gr);\n}\n\ntypedef struct\n{\nconst char *name;   //must be unique\nint base;           //1 for Alice, 3 for Bob. Only used for printing stuff\n\n\n}JPakeUserPublic;\n\n\ntypedef struct\n{\nJPakeUserPublic p;\nBIGNUM *secret; //the shared secret\nBIGNUM *key;    //the calculated (shared) key\nBIGNUM *xa;     //ALice's x1 or Bob's x3\nBIGNUM *xb;     //ALice's x2 or Bob's x4\n\n}JPakeUser;\n\nint main(int argc, char **argv)\n{\nJPakeUser alice, bob;\nalice.p.name = \"Alice\";\nalice.p.base = 1;\nbob.p.name = \"Bob\";\nbob.p.base = 3;\n\nputs(alice.p.name);\n}\n</code></pre>\n\n<p>I am not a new developer but I AM new to C and eclipse so I have been battling this for awhile. I have been experimenting with the makefile for this project also.  Here is my makefile (it is modified from a C++ example):</p>\n\n<pre><code>all: hash4.exe\n\nclean:\n    rm jpakedemo.o hash4.exe\n\nhash4.exe: jpakedemo.c\n    gcc -g -o hash4 jpakedemo.c\n\njpakedemo.o:\n    gcc -c -g jpakedemo.c\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 3, "creation_date": 1470795063, "post_id": 38863162, "comment_id": 65089783, "body": "<i>The compiler then looks for the C file associated with X.h.</i> -- What??  Where did you come up with this?"}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1470795476, "post_id": 38863162, "comment_id": 65089874, "body": "Are you implying that adding <code>#include &quot;X.c&quot;</code> is necessary for all header files? (which <code>X</code> is the name of your header file)"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 2, "creation_date": 1470795643, "post_id": 38863162, "comment_id": 65089903, "body": "I don&#39;t know where to start unraveling all the things you are incorrect about w.r.t header files.  You stated things that you thought happened, when none of those things happen.  The compiler doesn&#39;t go searching other <code>C</code> modules to see what they&#39;ve included."}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1470795740, "post_id": 38863162, "comment_id": 65089935, "body": "Please, instead of mocking my misunderstanding, can you enlighten me about how I&#39;m misinformed?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1470795796, "post_id": 38863162, "comment_id": 65089949, "body": "@Hatefiend No. You tell the compiler which <code>.c</code> files to compile - either directly on the command line or via a build system like Make. The compiler does not automatically go looking for <code>.c</code> files based on header files. As for pragma once, it prevents multiple inclusion within a <i>single</i> source file. It does not prevent inclusion of the same header file from a <i>different</i> source file. The latter is what you have and is what is causing the multiple definition link errors."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1470795937, "post_id": 38863162, "comment_id": 65089981, "body": "@Hatefiend It isn&#39;t mocking.  You presented a scenario that is totally wrong and given that, would need to have an explanation from us starting from the beginning concerning the build process, header files, etc."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470796246, "post_id": 38863162, "comment_id": 65090048, "body": "Read the first section of <a href=\"http://stackoverflow.com/questions/1433204/\">How do I use <code>extern</code> to share variables between source files</a>.  Your headers are <i>defining</i> and not <i>declaring</i> the variables because of the initializers, so each file that includes the header defines the variable.  When you link separate object files that included the headers, the symbols collide.  You simply mustn&#39;t define variables in a header if more than one source file in a program will include it \u2014 and the whole point of headers is to allow information to be shared."}, {"owner": {"user_type": "does_not_exist", "display_name": "user349594"}, "edited": false, "score": 1, "creation_date": 1470796267, "post_id": 38863162, "comment_id": 65090054, "body": "In general, whenever you ask about compilation or linkage issues, it helps if you also provide info about platform and compiler, and anything that might be atypical about the build (e.g. symlinks). I seriously doubt it&#39;s the case here, pragma once is very common, but not strictly part of the standard, neither is how file recognition is implemented by the pre compile chain (e.g. if it uses file identities instead of parsing it it can be broken by symlinks, whereas ifdef guards won&#39;t be)."}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470803703, "post_id": 38863162, "comment_id": 65091711, "body": "@JonathanLeffler in regards to your &gt;read the first section comment, are you saying that I shouldn&#39;t necessarily put all instance variables in my <code>.h</code> files? By instance variable, I mean a variable that is used only in the source file it&#39;s defined in and is used in many different functions in that source file. I was under the impression that such a variable should always go in your <code>.h</code> file, even though you have no intention of another <code>.c</code> file ever using it."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470803835, "post_id": 38863162, "comment_id": 65091763, "body": "If the variables are used in a single source file and not outside that source file, then those variables should not be in <i>any</i> header whatsoever and they should all be <code>static</code> so that no-one is enticed into using them.  Anything private \u2014 anything that is not needed outside the current source file \u2014 should be static and not in a header.  So, if you have a private structure type, that should be present only in the one source file and not in any header."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470803911, "post_id": 38863162, "comment_id": 65091784, "body": "Conversely, if the variables are used in multiple source files, then they must be declared in a header, and that header should be used in the source file where the variables are defined, and it should be used in every source file that references the variables.  And the variables declared in the header should be prefixed with <code>extern</code>.  \u2014\u2014 One side-effect of this is that you should never have variable declarations with an <code>extern</code> prefix in a source file.  There should be a header that gives the declaration for the variable."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470804159, "post_id": 38863162, "comment_id": 65091855, "body": "Similarly, there should never be an <code>extern</code> declaration of a function in a source file.  Either the function should be declared in a header, or the function should be <code>static</code>.  If you have to write a variable or function declaration (as opposed to definition) in a source file, your code is improperly factored.  (There&#39;s an awful lot of code out there that is imperfect in this regard \u2014 but there&#39;s no harm in aiming for perfection.  I&#39;ve worked on ancient code bases where these rules were not followed; it makes life hell when you&#39;re trying to make what should be innocuous changes.)"}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470805009, "post_id": 38863162, "comment_id": 65092174, "body": "Oh wow that makes a lot of sense. I actually thought that <code>static</code> just didn&#39;t work because my compiler would always say <code>static</code> keyword ignored but it&#39;s because I defined EVERYTHING in my header file. Something that is <code>static</code> but is also in a header file is counterproductive right? It&#39;s nonsensical? Also, I really don&#39;t want to declare every variable that I want other files to manipulate <code>extern</code>. Can&#39;t I just put header guards on every single <code>.h</code> file I have and be done with it?"}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1470795710, "post_id": 38863232, "comment_id": 65089926, "body": "Might be worth expanding &quot;<code>#pragma once</code> is used for duplicated including&quot; to &quot;<code>#pragma once</code> is used for duplicated including within a single compilation unit (.c file in this case)&quot;"}, {"owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1470795891, "post_id": 38863232, "comment_id": 65089968, "body": "@user4581301 Yes, it&#39;s important."}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470803461, "post_id": 38863232, "comment_id": 65091625, "body": "In what situation would I have a single translation unit? Is that when I have only one file, or only <code>.c</code> files?"}, {"owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "reply_to_user": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470804196, "post_id": 38863232, "comment_id": 65091871, "body": "@Hatefiend In your code you have three compilation unit. You compile three .c file, and then link them, right? Multiple definition error occurs at link time here."}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470804720, "post_id": 38863232, "comment_id": 65092074, "body": "Okay so you say <code>#pragma once</code> only protects me when it&#39;s a single translation unit. That means that in order for that to actually protect me, I&#39;d have to attempt to somehow <code>#include</code> the same <code>.c</code> or <code>.h</code> file that I&#39;m already inside of? When would that ever happen or ever be useful?"}, {"owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "reply_to_user": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470804936, "post_id": 38863232, "comment_id": 65092150, "body": "@Hatefiend Suppose you have a common .h file (like <code>comm.h</code>), which is include in both <code>X.h</code> and <code>Y.h</code>. And <code>Main.c</code> includes both <code>X.h</code> and <code>Y.h</code>, <code>#pragma once</code> could guarantee that <code>comm.h</code> would be included only once in <code>Main.c</code> (the single translation unit)."}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470805131, "post_id": 38863232, "comment_id": 65092220, "body": "But I thought <code>comm.h</code> and <code>comm.c</code> (even if <code>comm.c</code> doesn&#39;t exist) are combined into one translation unit, thenn <code>x</code> and <code>y</code> are each combined into their own translation units, and then <code>main.c</code> is it&#39;s own translation unit making four, and thus <code>#pragma once</code> doesn&#39;t help you?"}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1470805325, "post_id": 38863232, "comment_id": 65092277, "body": "The contents of header files are copy/pasted into any source file that <code>#include</code>s them (directly or indirectly) as I show in my answer.  There is no special relationship between <code>comm.h</code> and <code>comm.c</code>."}, {"owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "reply_to_user": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470805670, "post_id": 38863232, "comment_id": 65092396, "body": "@Hatefiend Let&#39;s make it simple. Suppose there&#39;s only one .c file, <code>Main.c</code>. So there&#39;s only one translation unit. <code>Main.c</code> includes <code>X.h</code> and <code>Y.h</code>, and <code>X.h</code> and <code>Y.h</code> both include <code>comm.h</code>. If you don&#39;t use <code>#pragma once</code>, <code>comm.h</code> will be included twice for <code>Main.c</code>, compile might fail."}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470806012, "post_id": 38863232, "comment_id": 65092533, "body": "@songyuanyao I see what you mean. Now my next question is: don&#39;t header guards protect against that? If then answer is yes, that means that not only do header guards protect against multiple translation unit compilation, but then they also protect against single as well. So then it goes back to then question of why use <code>#pragma once </code> if header guards are definitively better"}, {"owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "reply_to_user": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470806369, "post_id": 38863232, "comment_id": 65092651, "body": "@Hatefiend Sorry can&#39;t get what you mean. Header guard (<code>#pragma once</code>) only guards within single translation unit, not multiple."}], "tags": [], "owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "is_accepted": true, "score": 5, "last_activity_date": 1470796697, "last_edit_date": 1470796697, "creation_date": 1470795484, "answer_id": 38863232, "question_id": 38863162, "link": "https://stackoverflow.com/questions/38863162/linker-error-for-multiply-defined-symbols/38863232#38863232", "title": "Linker error for multiply defined symbols", "body": "<blockquote>\n  <p>but <code>#pragma once</code> SHOULD guard against that</p>\n</blockquote>\n\n<p><code>#pragma once</code> is used to avoid reduplicate including within <strong>single translation unit</strong> (<code>.c</code> file in this case), but it can't prevent multiple definition crossing multiple translation unit.</p>\n\n<p>You're defining global variable <code>ONE</code> and <code>TWO</code> in <code>.h</code> file, and they're included in multiple translation unit and cause multiple definition error.</p>\n\n<p>For example, finally, <code>ONE</code> will be defined in <code>X.c</code> and <code>Main.c</code>, <code>TWO</code> will be defined in <code>Y.c</code>, <code>X.c</code> and <code>Main.c</code>.</p>\n\n<p>You should declare <code>ONE</code> and <code>TWO</code> in <code>.h</code> file (by using <code>extern</code>), and define them in <code>.c</code> file.</p>\n\n<p>X.h</p>\n\n<pre><code>#pragma once\n\n#include \"Y.h\"\n\nextern int ONE;\nint combine();\n</code></pre>\n\n<p>X.c</p>\n\n<pre><code>#include \"X.h\"\n\nint ONE = 1;\n\nint combine()\n{\n    return ONE + TWO;\n}\n</code></pre>\n\n<p>Y.h</p>\n\n<pre><code>#pragma once\n\nextern int TWO;\n</code></pre>\n\n<p>Y.c</p>\n\n<pre><code>#include \"Y.h\"\n\nint TWO = 2;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470802822, "post_id": 38863342, "comment_id": 65091459, "body": "In this case I&#39;m using C, but I take it the advice is the same? I find it odd though because Microsoft Visual Studio automatically puts <code>#pragma once</code> at the begninning of every <code>.h</code> file. I thought this was the program&#39;s way to telling me that I am guarded vs. re-definitions. Also, when would you ever have a single source module? I use <code>.h</code> files in every single C/C++ program I&#39;ve ever made since I was taught that was good practice. Does this mean that single source module = <code>#pragma once</code> and multiple source modules = <code>header guards</code>?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "reply_to_user": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470826917, "post_id": 38863342, "comment_id": 65104787, "body": "Doesn&#39;t matter if it&#39;s C or C++. Yes, it&#39;s guarded against <b><i>re-definitions in the same source module only</i></b>. What part of &quot;it doesn&#39;t guard anything against redefinitions in multiple source modules&quot; you cannot understand? There is no way to guard against redefinitions in multiple modules. Define &quot;int a=0;&quot; in one module, and &quot;int b=0;&quot; in another, and you have multiple definitions. A compiler compiles one source module at a time. It has no possible way of knowing what might or might not be declared in some other source module. Stop using the pragma as a crutch. Learn how scoping works."}], "tags": [], "owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "is_accepted": false, "score": 0, "last_activity_date": 1470796230, "creation_date": 1470796230, "answer_id": 38863342, "question_id": 38863162, "link": "https://stackoverflow.com/questions/38863162/linker-error-for-multiply-defined-symbols/38863342#38863342", "title": "Linker error for multiply defined symbols", "body": "<p><code>#pragma once</code> prevents a header file from getting included more than once when compiling a single source module.</p>\n\n<p>That's all it does.</p>\n\n<p>Your header file is getting included from two different source modules.</p>\n\n<p>That header file declares and defines an object in global scope.</p>\n\n<p>Both of your two source modules, therefore, end up defining the same object in global scope.</p>\n\n<p>And that's where the duplicate symbol definition comes from.</p>\n\n<p><code>#pragma once</code> is not a substitute for knowing and understanding C++ scoping rules.</p>\n"}, {"comments": [{"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470803209, "post_id": 38863376, "comment_id": 65091555, "body": "Thank you for your response. So here I&#39;m taking away a few possibilities. I can either A) use header guards in every single <code>.h</code> file I make, and <b>not</b> using <code>#pragma once</code> B) I could do as you said, and define every single global variable I make in every single <code>.h</code> file (sounds awful in the case that I have 100+ files in a single compilation unit), or C) I could label every single global variable I make <code>extern</code> which also sounds like a pain because initially I might write a lot of variables as not needing to be used by another file and then decide I actually need to later. Am I right?"}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "reply_to_user": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470803607, "post_id": 38863376, "comment_id": 65091676, "body": "In general, you must only declare globals in your headers, and define them in a single .c file.  Using <code>#ifndef</code> header guards will not fix your problem, and defining your globals in every header file will only make things worse.  In general, every symbol must have exactly one definition in your program, and defining a global in a header that&#39;s included in multiple .c files will cause that symbol to be defined multiple times."}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470805325, "post_id": 38863376, "comment_id": 65092276, "body": "I&#39;m still not quite there in terms of understanding you. If I define the global variable <code>int x = 5</code> in one header file, there&#39;s my one definition. Now if any other file in any other translation unit comes into that <code>.h</code> file, header guards say nope and they just leave the file without reading any of it right? Then there&#39;s no need for <code>extern</code> <code>pragma once</code> or typing out the same variables in a billion different files"}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "reply_to_user": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470805619, "post_id": 38863376, "comment_id": 65092386, "body": "The contents of a header file are simply copy/pasted into any file that <code>#include</code>s it.  Headers are not compiled separately, and nothing ever &quot;comes into&quot; a header file.  In my answer, I&#39;ve shown exactly what each translation unit will look like to the compiler.  It sees nothing else."}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470806275, "post_id": 38863376, "comment_id": 65092621, "body": "Here&#39;s one other thing. I was reading <a href=\"http://stackoverflow.com/questions/1143936/pragma-once-vs-include-guards\">this post</a> and people were basically implying that <code>#pragma once</code> and header guards were almost exactly the same. And yet, header guards have the ability to solve my problem in the original post, do they not? They can handle protection from multiple translation units?&quot;"}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "reply_to_user": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470806599, "post_id": 38863376, "comment_id": 65092720, "body": "No, <code>#ifndef</code> guards and <code>#pragma once</code> do basically the same thing.  Both guard a header from being included multiple times in a single translation unit."}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470807390, "post_id": 38863376, "comment_id": 65092975, "body": "Okay yeah it&#39;s safe to say that I just don&#39;t understand this multiple translation units thing then. I&#39;ve been doing C++ for like over a year now and have had projects with like a dozen .h files all including eachother in a spiderweb mesh of includes. How am I only running into this problem now?"}, {"owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "reply_to_user": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470807848, "post_id": 38863376, "comment_id": 65093151, "body": "@Hatefiend Case by case. Maybe they all obey the rule of &quot;declare in .h file, define in .c file&quot;. i.e. Don&#39;t define in .h file."}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "reply_to_user": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "edited": false, "score": 0, "creation_date": 1470808056, "post_id": 38863376, "comment_id": 65093244, "body": "@songyuanyao Is that rule being broken in my original post?"}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1470808142, "post_id": 38863376, "comment_id": 65093285, "body": "Yes, you&#39;re defining <code>ONE</code> and <code>TWO</code> in your headers, not just declaring them."}, {"owner": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "reply_to_user": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470808158, "post_id": 38863376, "comment_id": 65093292, "body": "@Hatefiend Yes. <code>int ONE = 1;</code> is definition, that&#39;s why I said you should use <code>extern int ONE;</code> to make it a declaration."}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "reply_to_user": {"reputation": 144568, "user_id": 3309790, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d1c7e499132b9945b412ac79d0e22f7?s=128&d=identicon&r=PG&f=1", "display_name": "songyuanyao", "link": "https://stackoverflow.com/users/3309790/songyuanyao"}, "edited": false, "score": 0, "creation_date": 1470808336, "post_id": 38863376, "comment_id": 65093366, "body": "@songyuanyao that is also a definition.  A declaration would just be <code>extern int ONE;</code> in the header and <code>int ONE = 1;</code> in exactly one source file."}, {"owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "edited": false, "score": 0, "creation_date": 1470810949, "post_id": 38863376, "comment_id": 65094695, "body": "Ohhhh that&#39;s interesting. Let&#39;s say ONE and TWO were both declared without the <code>=</code>, meaning they have no definition yet. Would I still have this problem in the original post? Or is <code>extern</code> still needed?"}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1470811387, "post_id": 38863376, "comment_id": 65094940, "body": "Yes, without <code>extern</code> the variable will be default-initialized when declared.  <code>extern</code> basically says &quot;This is just a declaration; look for the definition later at link time&quot;."}], "tags": [], "owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "is_accepted": false, "score": 1, "last_activity_date": 1470796445, "creation_date": 1470796445, "answer_id": 38863376, "question_id": 38863162, "link": "https://stackoverflow.com/questions/38863162/linker-error-for-multiply-defined-symbols/38863376#38863376", "title": "Linker error for multiply defined symbols", "body": "<p><code>#pragma once</code> only guards against the same header being included twice in the same compilation unit.  It does not prevent problems when you define the same variable in multiple compilation units.</p>\n\n<p>To see what's wrong, let's walk through what each compilation unit looks like as it's being compiled.</p>\n\n<p>After preprocessing, X.c ends up looking like this:</p>\n\n<pre><code>int TWO = 2;\n\nint ONE = 1;\n\nint combine();\n\nint combine()\n{\n    return ONE + TWO;\n}\n</code></pre>\n\n<p>As you can see, it contains definitions for the symbols <code>TWO</code>, <code>ONE</code>, and <code>combine</code>.</p>\n\n<p>Y.c ends up looking like this:</p>\n\n<pre><code>int TWO = 2;\n</code></pre>\n\n<p>It also defines the symbol <code>TWO</code>.</p>\n\n<p>main.c looks like this:</p>\n\n<pre><code>int TWO = 2;\n\nint ONE = 1;\n\nint combine();\n\nint main()\n{\n    int fusion = combine();\n\n    return 0;\n}\n</code></pre>\n\n<p>So it also has definitions for <code>TWO</code> and <code>ONE</code>, along with <code>main</code>.</p>\n\n<p>So after compilation, we end up with 3 object files, all three of which have definitions for <code>TWO</code>, and two of which have definitions for <code>ONE</code>.  When we get to linking, the linker sees references to <code>ONE</code> and <code>TWO</code> in the definition of <code>combine</code> and goes looking for those symbols' definitions.  Since they're defined in multiple places, it throws an error and gives up.</p>\n\n<p>You can fix this problem by <em>declaring</em> <code>ONE</code> and <code>TWO</code> in X.h and Y.h and <em>defining</em> <code>ONE</code> and <code>TWO</code> in X.c and Y.c.</p>\n"}], "owner": {"reputation": 2955, "user_id": 4718288, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee409c8a881d44d6fa6d728445962103?s=128&d=identicon&r=PG&f=1", "display_name": "Hatefiend", "link": "https://stackoverflow.com/users/4718288/hatefiend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3655, "favorite_count": 2, "accepted_answer_id": 38863232, "answer_count": 3, "score": 0, "last_activity_date": 1558339285, "creation_date": 1470795009, "last_edit_date": 1470796579, "question_id": 38863162, "link": "https://stackoverflow.com/questions/38863162/linker-error-for-multiply-defined-symbols", "title": "Linker error for multiply defined symbols", "body": "<p>I have the following file structure:</p>\n\n<p><strong>X.h</strong></p>\n\n<pre><code>#pragma once\n\n#include \"Y.h\"\n\nint ONE = 1;\n\nint combine();\n</code></pre>\n\n<p><strong>X.c</strong></p>\n\n<pre><code>#include \"X.h\"\n\nint combine()\n{\n    return ONE + TWO;\n}\n</code></pre>\n\n<p><strong>Y.h</strong></p>\n\n<pre><code>#pragma once\n\nint TWO = 2;\n</code></pre>\n\n<p><strong>Y.c</strong></p>\n\n<pre><code>#include \"Y.h\"\n</code></pre>\n\n<p><strong>Main.c</strong></p>\n\n<pre><code>#include \"X.h\"\n\nint main()\n{\n    int fusion = combine();\n\n    return 0;\n}\n</code></pre>\n\n<p>I get the following errors:</p>\n\n<pre><code>LNK1169 one or more multiply defined symbols found\n\nLNK2005 _ONE already defined in Main.obj\n\nLNK2005 _TWO already defined in Main.obj\n\nKLNK2005 _TWO already defined in Main.obj\n</code></pre>\n\n<p>This makes zero sense. If we start at <code>Main.c</code> the compiler must include <code>X.h</code>. The compiler then looks for the C file associated with <code>X.h</code>. Inside <code>X.c</code> it needs to include <code>X.h</code> but <code>#pragma once</code> <em>SHOULD</em> guard against that. Then it needs to include <code>Y.h</code>. It looks for the C file and finds <code>Y.c</code> which says to include <code>Y.h</code>, but <code>Y.h</code> has already been included. Then, it returns to Main.c and should successfully compile... but nope. </p>\n\n<p>I can add <code>/FORCE</code> to my project settings which makes my code run perfectly but still outputs the:</p>\n\n<p><code>ONE has already been defined, second definition ignored.</code> </p>\n"}, {"tags": ["c", "pointers", "pass-by-reference"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1470794644, "post_id": 38863094, "comment_id": 65089693, "body": "When code invokes undefined behavior, then <i>sometimes</i> it seems to &quot;work&quot;.  Save time - enable compiler warnings."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1470794886, "post_id": 38863094, "comment_id": 65089744, "body": "I wouldn&#39;t say &quot;seems to&quot; - undefined means undefined, meaning that on specific compilers or systems an operation that is &quot;undefined&quot; does exactly what the author intended"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1470794996, "post_id": 38863094, "comment_id": 65089769, "body": "@GovindParmar this code is actually a <i>constraint violation</i>  (2 of them in fact), the compiler must issue a diagnostic message (and any executable produced is meaningless)"}], "answers": [{"tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": true, "score": 5, "last_activity_date": 1470794564, "creation_date": 1470794564, "answer_id": 38863104, "question_id": 38863094, "link": "https://stackoverflow.com/questions/38863094/the-below-code-snippets-produce-the-same-output-but-which-is-right/38863104#38863104", "title": "The below code snippets produce the same output. But which is right?", "body": "<p>The first one should not compile, because <code>&amp;str</code> is a <code>char**</code>, but the function is declared to take a <code>char*</code>.</p>\n\n<p>Additionally, in <code>*msg = \"World\";</code>, <code>\"World\"</code> is a <code>char*</code> but <code>*msg</code> is a single <code>char</code>.</p>\n"}], "owner": {"reputation": 92, "user_id": 5407101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0291c8ac12d1596b98317250c78427?s=128&d=identicon&r=PG&f=1", "display_name": "Srikar", "link": "https://stackoverflow.com/users/5407101/srikar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 38863104, "answer_count": 1, "score": -1, "last_activity_date": 1470794564, "creation_date": 1470794472, "question_id": 38863094, "link": "https://stackoverflow.com/questions/38863094/the-below-code-snippets-produce-the-same-output-but-which-is-right", "title": "The below code snippets produce the same output. But which is right?", "body": "<p>The below code snippet is the wrong one.......but seems to work correctly</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid fun(char* msg);\n\nint main()\n{\n    char* str = \"Hello\";\n    printf(\"%s\\n\",str);\n\n    fun(&amp;str);\n\n    printf(\"%s\\n\",str);\n    return 0;\n\n}\n\nvoid fun(char* msg){\n    *msg = \"World\";\n\n}\n</code></pre>\n\n<p>And now the correct code snippet </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid fun(char** msg);\n\nint main()\n{\n    char* str = \"Hello\";\n    printf(\"%s\\n\",str);\n\n    fun(&amp;str);\n\n    printf(\"%s\\n\",str);\n    return 0;\n\n}\n\nvoid fun(char** msg){\n    *msg = \"World\";\n\n}\n</code></pre>\n\n<p><strong><em>The objective of the above code is to modify the value of str.</em></strong> \nBoth codes produce the same output but why does the wrong code seems to work correctly in this case.</p>\n"}, {"tags": ["c", "graphics", "vulkan"], "answers": [{"tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": true, "score": 5, "last_activity_date": 1470794006, "creation_date": 1470794006, "answer_id": 38863042, "question_id": 38862854, "link": "https://stackoverflow.com/questions/38862854/correct-length-of-vkpipelinemultisamplestatecreateinfo-psamplemask/38863042#38863042", "title": "Correct length of VkPipelineMultisampleStateCreateInfo.pSampleMask", "body": "<p>When they say \"rasterizationSamples\" in the formula they almost certainly mean \"the number of rasterization samples\", not \"the value of the rasterizationSamples bitmask\".</p>\n\n<p>Additionally, \u2308...\u2309 means to round up to the nearest integer.</p>\n\n<p>So, for rasterization sample counts from 1 to 32 (bitmask values 0x01 to 0x20), pSampleMask points to a single value. For rasterization sample counts from 33 to 64 (bitmask value 0x40), it points to an array of two values.</p>\n\n<p>I notice that the bitmask's value line up with the description of each bit (64 has the value 64, and so on) but it could be coincidence.</p>\n"}, {"tags": [], "owner": {"reputation": 8395, "user_id": 3007154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7293bd97c47febd218463c27b394c6?s=128&d=identicon&r=PG&f=1", "display_name": "krOoze", "link": "https://stackoverflow.com/users/3007154/krooze"}, "is_accepted": false, "score": 1, "last_activity_date": 1470833490, "last_edit_date": 1470833490, "creation_date": 1470822448, "answer_id": 38869833, "question_id": 38862854, "link": "https://stackoverflow.com/questions/38862854/correct-length-of-vkpipelinemultisamplestatecreateinfo-psamplemask/38869833#38869833", "title": "Correct length of VkPipelineMultisampleStateCreateInfo.pSampleMask", "body": "<p>The <code>rasterizationSamples</code> must be only one of the <code>SampleCountFlagBits</code> values (<strong>not</strong> a bitwised | value).</p>\n\n<p>Simply speaking, then you need the amount of bits in <code>pSampleMask</code> array (consisting of 32 b values) to be greater or equal to the amount of samples as specified by <code>rasterizationSamples</code>. (i.e. one <code>VkSampleMask := uint32_t</code> for all of them except for <code>SAMPLE_COUNT_64</code>, which needs two)</p>\n\n<p>It is somewhat funny that they didn't choose single uint64_t for the purpose. (maybe they plan adding 128 samples :)</p>\n"}], "owner": {"reputation": 1150, "user_id": 4304439, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-jHPT3g8LI-E/AAAAAAAAAAI/AAAAAAAABMc/-0RJRebP8tg/photo.jpg?sz=128", "display_name": "Alex Byrth", "link": "https://stackoverflow.com/users/4304439/alex-byrth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 38863042, "answer_count": 2, "score": 2, "last_activity_date": 1470833490, "creation_date": 1470792410, "last_edit_date": 1470801015, "question_id": 38862854, "link": "https://stackoverflow.com/questions/38862854/correct-length-of-vkpipelinemultisamplestatecreateinfo-psamplemask", "title": "Correct length of VkPipelineMultisampleStateCreateInfo.pSampleMask", "body": "<p>Unlike other Vulkan's structs, where all <code>type pArrayName*;</code> has a companion <code>uint32_t arrayNameCount</code> with array length, struct  <code>VkPipelineMultisampleStateCreateInfo</code> does not define any <code>sampleMaskCount</code> for field <code>const VkSampleMask* pSampleMask;</code>.</p>\n\n<p>The <a href=\"https://www.khronos.org/registry/vulkan/specs/1.0/man/html/VkPipelineMultisampleStateCreateInfo.html\" rel=\"nofollow\" title=\"Vulkan docs\">Vulkan docs</a> says the following about valid usage:</p>\n\n<blockquote>\n  <p><em>\"If pSampleMask is not NULL, pSampleMask must be a pointer to an array of \u2308rasterizationSamples / 32\u2309 VkSampleMask values.\"</em> </p>\n</blockquote>\n\n<p>But  <code>VkSampleCountFlagBits rasterizationSamples;</code> is a bitwise value:</p>\n\n<blockquote>\n  <p>rasterizationSamples is a VkSampleCountFlagBits specifying the number of samples per pixel used in rasterization. </p>\n</blockquote>\n\n<p>So far so good. </p>\n\n<p>But VkSampleCountFlagBits is a enumeration of power of 2 values, ranging from 0x01 to 0x40 (or 01 to 64 decimal). Possible ANDed values may ranges from 01 to 127.\nSo I guess bitwise values ranging from 1 to 31 will result in a <code>pSampleMask</code>  with length 0; values from 32 to 63 will give length 2, and so on.</p>\n\n<p>Is that correct ? \nI'm felling really really dumb !</p>\n"}, {"tags": ["c", "serial-port", "vxworks"], "answers": [{"tags": [], "owner": {"reputation": 62, "user_id": 6467273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c2e1169631adc7edf1184611a17bec1?s=128&d=identicon&r=PG&f=1", "display_name": "jhagen", "link": "https://stackoverflow.com/users/6467273/jhagen"}, "is_accepted": true, "score": 0, "last_activity_date": 1470792571, "creation_date": 1470792571, "answer_id": 38862883, "question_id": 38862445, "link": "https://stackoverflow.com/questions/38862445/sending-binary-data-to-serial-port-using-vxworks-c/38862883#38862883", "title": "Sending Binary Data to serial port using VxWorks C", "body": "<p>It will write out \"001  \\0  \\0  \\0  \\b 002 003\" to  /tyCo/0 which is what is expected.\nWhy do you need to write it one byte at a time?</p>\n\n<p>Make sure the TEST.txt file does not have anything in it after the 7 bytes before you write to it since you are only writing 7 bytes.  You could also remove the TEST.txt file, touch the file so it exists and then it will only have the 7 bytes that you write to it.</p>\n"}], "owner": {"reputation": 31, "user_id": 6679306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dccfed3c58e49d153e7ab4f7e46f5d1?s=128&d=identicon&r=PG&f=1", "display_name": "Dimitri Herr", "link": "https://stackoverflow.com/users/6679306/dimitri-herr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 893, "favorite_count": 0, "accepted_answer_id": 38862883, "answer_count": 1, "score": 0, "last_activity_date": 1470792571, "creation_date": 1470788924, "question_id": 38862445, "link": "https://stackoverflow.com/questions/38862445/sending-binary-data-to-serial-port-using-vxworks-c", "title": "Sending Binary Data to serial port using VxWorks C", "body": "<p>Hello I am trying to program my UEIPAC 600-1G cube to receive data from a temperature sensor.  In order to activate the sensor I have to send it binary data.  I am trying to send chars set as hex values but something is wrong.  I have tested by dumping the data into a text file and I get spaces followed by some giberish characters. How do I send Binary data through a serial port?</p>\n\n<pre><code>struct timespec tim, tim2;\nunsigned char access_code[] =\"       \";\nint bytes=256; /*num of bytes to read at a time*/\nchar re[bytes]; \nint re_len = 0;\nint n_access = 0;   /* store number of bytes written from access code */\nint n_read =0;\nint i=0;\nint baud=0;\nint bytes_written=0;\n/* hold the file descriptor */ \nint fd = 0;  \naccess_code[0]=0x01; /*fill access code with correct hex data */\naccess_code[1]=0x00;\naccess_code[2]=0x00;\naccess_code[3]=0x00;\naccess_code[4]=0x08;\naccess_code[5]=0x02;\naccess_code[6]=0x03;\nre_len = bytes;\nmemset(re, 0, sizeof(char)*bytes);\n//nanopause initialization data\ntim.tv_sec = 0;\ntim.tv_nsec = 95000000;\n/* open the device for writing and reading later. */ \nfd = open( \"/tyCo/0\", O_RDWR, 0);\n//fd = open(\"TEST.txt\", O_RDWR, 0);\n//baud = ioctl(fd, FIOBAUDRATE, 19200); /*note test length maybe 576000 b/c terminal*/\n\nfor (i=0;i&lt;7;i++){\n    n_access = n_access+write( fd, &amp;access_code[i], 1); /* write */ \n}\nlogfile=fopen (\"LOGFILE.txt\",\"a\"); /* open log file*/\noutputfile=fopen (\"SENSORDATA.txt\",\"a\"); /* open output file*/\nif(fd&lt;0)  /* check for open error */\n    fprintf(logfile,\"%s\",\"\\nerror opening file\\n\");\nfprintf(logfile,\"%s\" \"%d\" \"%c\",\"number of access code bytes written: \",n_access,'\\n'); /* display bytes written*/\n//step 1 call completed now pause with nano pause\nif(nanosleep(&amp;tim,&amp;tim2)&lt;0){\n    fprintf(logfile,\"%s\",\"Nano sleep system call failed \\n\");\n}\n//step 2 complete now read with read code\nn_read = read( fd, re, re_len); /* read */\nif(n_read&lt;0)\n    fprintf(logfile,\"%s\",\"error reading serial data from sensor\\n\");\nbytes_written=fprintf(outputfile,\"%s\",re);\nfprintf(logfile,\"%s\" \"%d\" \"%c\",\"call and response executed number of bytes written: \",bytes_written,'\\n');\n\n//baud = ioctl(fd, FIOBAUDRATE, 57600);\nclose( fd ); /* close */ \nfclose(logfile);\nfclose(outputfile);\n</code></pre>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470796870, "post_id": 38862258, "comment_id": 65090180, "body": "Yes, you could get some mixed data from two versions of the file, though the chances of that happening depend on the size of the file and how Foo writes the file and how Bar reads the file.  One possibility is to have Bar use <code>mmap()</code> with a private mapping to read the file; that should give you a consistent snapshot of the file (probably).  You&#39;d have to remap the memory on each cycle, though."}], "answers": [{"comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1470849254, "post_id": 38862605, "comment_id": 65120488, "body": "Additionally, <code>fcntl()</code> locks work fine on NFS mounts (unless the server is configured to not support locking), whereas <code>flock()</code> locks might or might not work, depending on kernel (if Linux) and OS (like BSDs). On the other hand, in Linux, even scripts can use <code>flock</code> locks via the <a href=\"http://man7.org/linux/man-pages/man1/flock.1.html\" rel=\"nofollow noreferrer\"><code>flock</code></a> utility (provided by util-linux, should be installed in all Linux distros); for example, if you want to flock a file while editing it in nano/vi/vim/emacs/gedit/other program, even if that program does not take an advisory lock. Which is why ..."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1470849383, "post_id": 38862605, "comment_id": 65120544, "body": "... it is imperative for the data producer (Foo) to either use a temporary file (in which case readers get a consistent snapshot even without advisory locking), or advisory locking. My own answer basically parallels yours, except for my unavoidable verbosity (which many do not like). :)"}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 0, "last_activity_date": 1470790298, "creation_date": 1470790298, "answer_id": 38862605, "question_id": 38862258, "link": "https://stackoverflow.com/questions/38862258/linux-reading-file-while-other-program-might-modify-it/38862605#38862605", "title": "Linux: Reading file while other program might modify it", "body": "<p>This is difficult to do robustly without Foo's cooperation.\nUnixes have two main kinds of file locking:</p>\n\n<ul>\n<li>range locking with <a href=\"http://linux.die.net/man/2/fcntl\" rel=\"nofollow\">fcntl(2)</a></li>\n<li>always-whole-file locking with <a href=\"http://linux.die.net/man/2/flock\" rel=\"nofollow\">flock(2)</a></li>\n</ul>\n\n<p>Ideally, you use either of these in cooperative mode (<em>advisory locking</em>), where all participants attempt to acquire the lock and only one will get it at a time.</p>\n\n<p>Without the other program's cooperation, your only recourse, as far as I know is <em>mandatory locking</em>, which you can have with <em>fcntl</em> if you allow it on the filesystem, but the manpage mentions that the Linux implementation is unreliable.</p>\n"}, {"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 1, "last_activity_date": 1470828858, "creation_date": 1470828858, "answer_id": 38872315, "question_id": 38862258, "link": "https://stackoverflow.com/questions/38862258/linux-reading-file-while-other-program-might-modify-it/38872315#38872315", "title": "Linux: Reading file while other program might modify it", "body": "<p>Typically, Foo should not simply rewrite the contents of the file again and again, but create a new temporary file, and replace the old file with the temporary file when it is done (using <a href=\"http://man7.org/linux/man-pages/man2/link.2.html\" rel=\"nofollow\"><code>link()</code></a>). In this case, simply opening the file (at any point in time) will give the reader a consistent snapshot of the contents, because of how typical POSIX filesystems work. (After opening the file, the file descriptor will refer to the same inode/contents, even if the file gets deleted or replaced; the disk space will be released only after the last open file descriptor of a deleted/replaced file is closed.)</p>\n\n<p>If Foo does rewrite the same file (without a temporary file) over and over, the recommended solution would be for both Foo and Bar to use <a href=\"http://man7.org/linux/man-pages/man2/fcntl.2.html\" rel=\"nofollow\"><code>fcntl()</code></a>-based advisory locking. (However, using a temporary file and renaming/linking it over the actual file when complete, would be even better.)</p>\n\n<p>(While <a href=\"http://man7.org/linux/man-pages/man2/flock.2.html\" rel=\"nofollow\"><code>flock()</code></a>-based locking might seem easier, it is actually a bit of a guessing game whether it works on NFS mounts or not. <code>fcntl()</code> works, unless the NFS server is configured not to support locking. Which is a bit of an issue on some commercial web hosts, actually.)</p>\n\n<p>If you cannot modify the behaviour of Foo, and it does not use advisory locking, there are still some options in Linux.</p>\n\n<p>If Foo closes the file -- i.e., Bar is the only one to open the file --, then taking an exclusive file lease (using <a href=\"http://man7.org/linux/man-pages/man2/fcntl.2.html\" rel=\"nofollow\"><code>fcntl(descriptor, F_SETLEASE, F_WRLCK)</code></a> is a workable solution. You can only get an exclusive file lease if <code>descriptor</code> is the only open descriptor on the file, and the owner user of the file is the same as the process UID (or the process has the <code>CAP_LEASE</code> capability). If any other process tries to open or truncate the file, the lease owner gets signaled (<code>SIGIO</code> by default), and has up to <code>/proc/sys/fs/lease-break-time</code> seconds to downgrade or release the lease. The opener is blocked for the duration, which allows Bar to either cancel the processing, or copy the file for later processing.</p>\n\n<p>The other option for Bar is rather violent. It can monitor the file say once per second, and when the file is old enough -- say, a few seconds --, pause Foo by sending it a <code>SIGSTOP</code> signal, checking <a href=\"http://man7.org/linux/man-pages/man5/proc.5.html\" rel=\"nofollow\"><code>/proc/FOOPID/stat</code></a> until it gets stopped, and rechecking the file statistics to verify it's still old, until making a temporary copy of it (either in memory, or on disk) for processing. After the file is read/copied, Bar can let Foo continue by sending it a <code>SIGCONT</code> signal.</p>\n\n<p>Some filesystems may support file snapshots, but in my opinion, one of the above are much saner than relying on nonstandard filesystem support to function correctly. If Foo cannot be modified to co-operate, it is time to refactor it out of the picture. You do not want to be a hostage for a black box out of your control, so the sooner you replace it with something more user/administrator-friendly, the better you'll be in the long term. </p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1470919720, "creation_date": 1470919720, "answer_id": 38896858, "question_id": 38862258, "link": "https://stackoverflow.com/questions/38862258/linux-reading-file-while-other-program-might-modify-it/38896858#38896858", "title": "Linux: Reading file while other program might modify it", "body": "<p>In all UN*X systems, what is warranted to happen atomically is the <code>write(2)</code> or <code>read(2)</code> system calls.  The kernel even locks the file inode in memory, so while you are <code>read(2)</code>ing or <code>write(2)</code>ing it, it would not change.</p>\n\n<p>For more spatial atomicity, you have to lock the whole file.  You can use the file locking tools available to lock different regions of a file.  Some are advisory (you can force an skip over them) and others are mandatory (you are blocked until the other side unblocks the file region)</p>\n\n<p>See <code>fcntl(2)</code> and the options <code>F_GETLK</code>, <code>F_SETLK</code> and <code>F_SETLKW</code> to get lock info, set lock for reading or writing, respectively.</p>\n"}], "owner": {"reputation": 13, "user_id": 6697925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3850438002146d24689a407be9eb5791?s=128&d=identicon&r=PG", "display_name": "BananaBlender", "link": "https://stackoverflow.com/users/6697925/bananablender"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "accepted_answer_id": 38872315, "answer_count": 3, "score": 1, "last_activity_date": 1470919720, "creation_date": 1470787244, "question_id": 38862258, "link": "https://stackoverflow.com/questions/38862258/linux-reading-file-while-other-program-might-modify-it", "title": "Linux: Reading file while other program might modify it", "body": "<p>A program Foo periodically updates a file and calls my C program Bar to process the file.</p>\n\n<p>The issue is that the Foo might update the file, call Bar to process it, and while Bar reads the file, Foo might update the file again.</p>\n\n<p>Is it possible for Bar to read the file in inconsistent state, e.g. read first half of the file as written by first Foo and the other half as written by the second Foo? If so, how would I prevent that, assuming I can modify only Bar's code?</p>\n"}, {"tags": ["c", "windows", "utf-8"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user719662"}, "edited": false, "score": 0, "creation_date": 1470784952, "post_id": 38861910, "comment_id": 65087630, "body": "although the dupe I linked is for C++, the answer is <i>exactly</i> the same. Firstly, you&#39;d have to define what you mean by &quot;console&quot; - different TTYs will act differently vs character encodings."}, {"owner": {"reputation": 11569, "user_id": 502399, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ccf39757e9c47ae99df42bdb286c6e5c?s=128&d=identicon&r=PG", "display_name": "Tavian Barnes", "link": "https://stackoverflow.com/users/502399/tavian-barnes"}, "edited": false, "score": 3, "creation_date": 1470785056, "post_id": 38861910, "comment_id": 65087659, "body": "Your code is printing UTF-8.  Your <i>terminal</i> is not interpreting it as UTF-8, however."}, {"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "reply_to_user": {"reputation": 11569, "user_id": 502399, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ccf39757e9c47ae99df42bdb286c6e5c?s=128&d=identicon&r=PG", "display_name": "Tavian Barnes", "link": "https://stackoverflow.com/users/502399/tavian-barnes"}, "edited": false, "score": 2, "creation_date": 1470785647, "post_id": 38861910, "comment_id": 65087814, "body": "@TavianBarnes is correct.  I compiled your code and I get \u3042 while on ubuntu terminal ... Please run this in your console    echo -e &#39;\\xe2\\x82\\xac&#39;   ...  you will see \u20ac   if your console is UNF-8"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470786367, "post_id": 38861910, "comment_id": 65088019, "body": "Mac OS X 10.11.6 is also OK with displaying the hiragana."}], "owner": {"reputation": 317, "user_id": 5740336, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ad3989bbac3559d416a7ec3f98881be0?s=128&d=identicon&r=PG&f=1", "display_name": "MyName", "link": "https://stackoverflow.com/users/5740336/myname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "closed_date": 1470786329, "answer_count": 0, "score": 2, "last_activity_date": 1470786262, "creation_date": 1470784777, "last_edit_date": 1470786262, "question_id": 38861910, "link": "https://stackoverflow.com/questions/38861910/print-utf-8-in-c-on-windows", "closed_reason": "Duplicate", "title": "Print utf-8 in C on Windows", "body": "<p>I am looking for a way of printing characters which are represented in UTF-8 as an array of bytes. I've found this approach (below), but I didn't get the expected result \u3042. Instead of it, I got Russian letters \u0443\u0411\u0412.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n\nint main()\n{\n    char s[]={0xe3,0x81,0x82, 0x00};\n    printf(\"%s\",s);\n    _getch();\n    return 0;\n}\n</code></pre>\n\n<p>Could you kindly advise me the best way of printing utf-8 strings in console? (It is necessary for parsing asn.1 utf-8 strings.)</p>\n"}, {"tags": ["c", "hashtable", "glib"], "comments": [{"owner": {"reputation": 702, "user_id": 3560192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0TwaN.png?s=128&g=1", "display_name": "Alexguitar", "link": "https://stackoverflow.com/users/3560192/alexguitar"}, "edited": false, "score": 1, "creation_date": 1470785064, "post_id": 38861907, "comment_id": 65087662, "body": "It seems you have a global <code>GHashTable *table</code> and a local one which is contained in the main function"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1470789878, "post_id": 38861907, "comment_id": 65088772, "body": "Every time you call <code>g_strdup (key)</code> or <code>g_strdup (value)</code> and fail to preserve a pointer to the starting address for the block of memory allocated, you create a <i>memory leak</i>."}, {"owner": {"reputation": 524, "user_id": 1489602, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e940c16d1be5afc5d6a9be9818d3eb6?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Horowitz", "link": "https://stackoverflow.com/users/1489602/benjamin-horowitz"}, "edited": false, "score": 0, "creation_date": 1470790184, "post_id": 38861907, "comment_id": 65088824, "body": "How would one go about preserving the pointer to the starting address in this context?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1470799908, "post_id": 38861907, "comment_id": 65090779, "body": "You only need <code>g_strdup</code> passing to <code>g_hash_table_insert</code> (it will store the pointer and free the memory when the hash table is freed), for <code>g_hash_table_lookup</code>, you can simply pass <code>key</code> (the lookup will be preformed on the value passed and there is no need to allocate memory and permanently store a copy). Your larger problems are due to passing invalid parameters. (you are not passing pointers where required) See <a href=\"https://developer.gnome.org/glib/stable/glib-Hash-Tables.html\" rel=\"nofollow noreferrer\"><b>Hash Tables</b></a>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1470805482, "post_id": 38861907, "comment_id": 65092342, "body": "Specifically <code>key = g_new (gchar, 1);</code> and <code>value = g_new (gchar, 1);</code> create <code>gpointer</code> type cast to <code>gchar</code> allocating <code>1</code> char (or <code>gchar</code>). That isn&#39;t adequate storage for a <code>string</code> (<i>nul-terminated</i> array of chars) you attempt to create with e.g. <code>sprintf(key,&quot;%d %i&quot;, x,l);</code> (not to mention to standard C/glib mix/match) Take a look at <a href=\"https://developer.gnome.org/glib/stable/glib-String-Utility-Functions.html#g-sprintf\" rel=\"nofollow noreferrer\"><b>g_sprintf ()</b></a>"}], "owner": {"reputation": 524, "user_id": 1489602, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e940c16d1be5afc5d6a9be9818d3eb6?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Horowitz", "link": "https://stackoverflow.com/users/1489602/benjamin-horowitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2847, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1470784737, "creation_date": 1470784737, "question_id": 38861907, "link": "https://stackoverflow.com/questions/38861907/glib-critical-error-using-ghashtable", "title": "GLib-CRITICAL error using GHashTable", "body": "<p>I'm attempting to use GLib to create a way to cache a function output for future fast calculations. Here is an example of the implementation I'm using...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;glib.h&gt;\n#include &lt;math.h&gt;\n\nstatic GHashTable *table;\n\ndouble P_l(double x,int lmax){\n  //double pl;\n  double p[lmax+2];\n  int l;\n\n  p[0] = 1.;\n  p[1] = x;\n  for (l = 1; l &lt; lmax; ++l)\n  {\n    p[l+1] = ((2.*l+1.)*x*p[l]-l*p[l-1])/(l+1.);\n  }\n //printf(\"cost = %E, l = %i, Pl = %E\\n\", x, lmax, p[lmax]);\n  return p[lmax];\n}\n\n\ndouble cached_P_l(double x,\n                                int l\n                                ) {\n  gchar *key;\n  gchar *value;\n  key = g_new (gchar, 1);\n  value = g_new (gchar, 1);\n  double answer;\n  sprintf(key,\"%d %i\", x,l);\n    if(g_hash_table_lookup(table, g_strdup (key)) == NULL){\n\n    answer = P_l(x,l);\n        printf(\"NOT FOUND IN LIST \\n\");\n    sprintf(value, \"%f\", answer);\n    g_hash_table_insert (table, g_strdup (key), g_strdup (value));\n    }\n    else{\n        printf(\"FOUND IN LIST \\n\");\n        printf(\"VALUE: %f \\n\",atof(g_hash_table_lookup(table, g_strdup (key))));\n\n}\n}\n\nint main(){\n\n  GHashTable* table = g_hash_table_new_full (g_str_hash, g_str_equal, g_free, g_free);\n\n  double x=1.;\n  int l =2;\n  cached_P_l(x,l);\n  l=3;\n  cached_P_l(x,l);\n  cached_P_l(x,l);\n\n  return 0;\n}\n</code></pre>\n\n<p>The code compiled fine, but when I run the code I get the following cryptic (to me at least) error:</p>\n\n<pre><code>(process:32996): GLib-CRITICAL **: g_hash_table_lookup: assertion 'hash_table != NULL' failed\nNOT FOUND IN LIST \n\n(process:32996): GLib-CRITICAL **: g_hash_table_insert_internal: assertion 'hash_table != NULL' failed\n\n(process:32996): GLib-CRITICAL **: g_hash_table_lookup: assertion 'hash_table != NULL' failed\nNOT FOUND IN LIST \n\n(process:32996): GLib-CRITICAL **: g_hash_table_insert_internal: assertion 'hash_table != NULL' failed\n</code></pre>\n"}, {"tags": ["c", "valgrind"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1470784396, "post_id": 38861700, "comment_id": 65087500, "body": "Compile your code with debugging symbols enabled so that valgrind will give code line numbers in its output. That will greatly assist others (and you) in diagnosing the problem."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470786537, "post_id": 38861700, "comment_id": 65088054, "body": "Please indent your code in a more orthodox style, too.  It may be that you have a mixture of tabs and blanks; avoid that for code posted to SO.  Use blanks only.  You may need to detab your file.  One way on Unix-like systems is <code>pr -e8 -l1 -t input.c &gt; output.detabbed</code>."}, {"owner": {"reputation": 4203, "user_id": 618677, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0474a21ea751fc27f84147ca7feae93b?s=128&d=identicon&r=PG", "display_name": "user618677", "link": "https://stackoverflow.com/users/618677/user618677"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1471043689, "post_id": 38861700, "comment_id": 65212142, "body": "@JonathanLeffler, Thanks. I just learnt something new. I have solved this issue, I noticed that if in my list next pointer is accessed and it has no memory created for it , then the above named error would be triggered. I have learnt to always assign NULL to such."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1471043903, "post_id": 38861700, "comment_id": 65212196, "body": "The memory allocated by <code>malloc()</code> has indeterminate contents.  This is normally fine; you&#39;re about to write to every member of the structure.  If you&#39;re not, it is usually better to use <code>calloc()</code> which zeroes the allocated memory for you \u2014 all bytes zero.  This is at least determinate.  It is wasteful to use <code>calloc()</code>, though, if you&#39;re going to overwrite everything (but it protects you against changes \u2014 additions \u2014 to the structure that you&#39;re allocating, and you may decide the future-proofing is sufficiently beneficial to outweigh the not usually very significant cost)."}], "owner": {"reputation": 4203, "user_id": 618677, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0474a21ea751fc27f84147ca7feae93b?s=128&d=identicon&r=PG", "display_name": "user618677", "link": "https://stackoverflow.com/users/618677/user618677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1470784986, "creation_date": 1470783297, "last_edit_date": 1470784986, "question_id": 38861700, "link": "https://stackoverflow.com/questions/38861700/valgrinds-error-message", "title": "Valgrind&#39;s error message", "body": "<p>I got \"Conditional jump or move depends on uninitialised value(s)\" , and it is coming from function <code>process_server()</code>. I have tried to figure out where it is coming, but to no avail. </p>\n\n<p>Message from <code>valgrind</code>.</p>\n\n<blockquote>\n==2468== Conditional jump or move depends on uninitialised value(s)<br />\n==2468==    at 0x402B3D: process_server (in /home/emeka/Desktop/dump/project/serverd)<br />\n==2468==    by 0x402DB3: main (in /home/emeka/Desktop/dump/project/serverd)<br />\n==2468== \n</blockquote>\n\n<pre><code>#include \"signal.h\"\n#include \"string.h\"\n#include \"sys/types.h\"\n#include \"unistd.h\"\n#include \"sys/socket.h\"\n#include \"netinet/in.h\"\n#include \"arpa/inet.h\"\n#include \"netdb.h\"\n#include \"stdlib.h\"\n#include \"ctype.h\"\n#include \"stdio.h\"\n#include \"utility.h\"\n#include \"route.c\"\n#include \"tokenize.c\"\n#include \"bridge.c\"\n\n\n\n\n#define PORT 1253\n#define ADDRESS \"127.0.0.1\"\n#define START  \"start\"\n#define  STOP  \"stop\"\n#define LISTENQ 4\n\ntypedef struct sockaddr SA;\n//#define INET6_ADDRSTRLEN 3000\nrequested_data *re_data;\n\nint switch_ch;\nstruct sockaddr_in serveraddr;\n\nint start_server(int port){\n    int listenid;\n    int optval=1;\n    typedef struct sockaddr SA;\n    if((listenid = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0) {\n        error_message(\"Error in startServer &lt;Failed to create socket&gt;\");\n    }\n    if (setsockopt(listenid, SOL_SOCKET, SO_REUSEADDR,\n                   (const void *)&amp;optval , sizeof(int)) &lt; 0)\n            return -1;\n    memset(&amp;serveraddr, 0, sizeof(serveraddr));\n    serveraddr.sin_family = AF_INET;\n    serveraddr.sin_addr.s_addr = htonl(INADDR_ANY);\n    serveraddr.sin_port = htons((unsigned short)port);\n    if(bind(listenid, (SA*)&amp;serveraddr, sizeof(serveraddr)) &lt; 0) {\n        error_message(\"Error in startServer &lt;Failed to bind socket&gt;\");\n    }\n    if(listen(listenid, LISTENQ) &lt; 0) {\n        error_message(\"Error in startServer &lt;Failed to listen&gt;\");\n    }\n\n\n    return listenid;\n}\n\n\nvoid *get_in_addr(struct sockaddr *sa)\n{\n    if (sa-&gt;sa_family == AF_INET) {\n        return &amp;(((struct sockaddr_in*)sa)-&gt;sin_addr);\n    }\n\n    return &amp;(((struct sockaddr_in6*)sa)-&gt;sin6_addr);\n}\n\nvoid process_server(int listenid){\n    char remoteIP[INET6_ADDRSTRLEN];\n    int fd, read_size;\n        const int buffer_size = 1000;\n    char *client_message = malloc(sizeof(char) * buffer_size);\n        if(!client_message){\n           printf(\"Not enough memory\");\n           abort();\n         }\n    struct sockaddr_storage remoteaddr; // client address\n    socklen_t addrlen;\n    addrlen = sizeof remoteaddr;\n    char *gen, gen_int = 0, supplied_answer;\n        while((fd = accept(listenid, (struct sockaddr *)&amp;remoteaddr, &amp;addrlen))) {\n        while((read_size = recv(fd, client_message, buffer_size, 0)) &gt; 0) {\n            printf(\"%s\", client_message);\n            re_data = router(client_message, read_size);\n            printf(\"Method %s --url::%s=+++\\n\", re_data-&gt;method, re_data-&gt;url);\n            switch_ch = 1;\n            free(client_message);\n            client_message = malloc(sizeof(char) * buffer_size);\n            if(!client_message){\n                printf(\"Not enough memory\");\n                abort();\n            }\n            break;\n\n        }\n        printf(\"DE server: new connection from %s on \"\n                            \"socket %d\\n\",\n                            inet_ntop(remoteaddr.ss_family,\n                                get_in_addr((struct sockaddr*)&amp;remoteaddr),\n                                remoteIP, INET6_ADDRSTRLEN),fd);\n        str_query *rem_data;\n        str_query *header_meta = re_data-&gt;meta_data;\n         while(header_meta){\n            if(strncasecmp(re_data-&gt;method, \"PUT\", 3) == 0){\n                if(strncasecmp(re_data-&gt;url, \"/answer\", 7) == 0){\n                    if(strlen(re_data-&gt;url) == 7){\n                        if(strncasecmp(header_meta-&gt;req_name, \"question\", 8) == 0){\n\n                            int res_int = parse_input(header_meta-&gt;req_value);\n\n                            if(gen_int == res_int &amp;&amp; supplied_answer == res_int){\n                                send(fd, \"HTTP status 200 OK\" , 18, 0);\n                            } else {\n                                send(fd, \"400 Bad Request\" , 15, 0);\n                            }\n\n                            printf(\"\\n Resulted from computation  of %s  result :: %d\\n\", header_meta-&gt;req_name, res_int);\n\n                        }\n                    }\n\n                }\n            }\n            if(switch_ch){\n                if(strncasecmp(re_data-&gt;url, \"/question\" , 9) == 0){\n                    if(strncasecmp(re_data-&gt;method, \"GET\", 3) == 0){\n                        gen = pmain();\n                        send(fd, gen, strlen(gen), 0);\n                        gen_int = parse_input(gen);\n                        switch_ch = 0;\n                        printf(\"\\n Resulted from generated computation  of %s  result :: %d\\n\", header_meta-&gt;req_name, gen_int);\n                        free(gen);\n                    }\n                }\n            }\n            if(strncasecmp(header_meta-&gt;req_name, \"answer\", 8) == 0){\n                supplied_answer = atoi(header_meta-&gt;req_value);\n\n            }\n\n            printf(\"\\nname %s    value %s\\n\", header_meta-&gt;req_name, header_meta-&gt;req_value);\n            rem_data = header_meta;\n            header_meta = header_meta-&gt;next;\n            free(rem_data-&gt;req_name);\n                        free(rem_data-&gt;req_value);\n\n            free(rem_data);\n\n        }   \n        if(!client_message){\n           free(client_message);\n        }   \n        free(re_data);\n        close(fd);\n    }\n    return;\n\n}\n\n\nint main(int argc, char **argv) {\n    int port, pid, server_conn = 1;\n    int internet_address_len = 15;\n    char serAdd[internet_address_len];\n    char strAction[7];\n    if(argc == 1) {\n        port = PORT;\n        strcpy(serAdd, ADDRESS);\n    } else if(argc == 2){\n        port = atoi(argv[1]);\n        strcpy(serAdd, ADDRESS);\n    } else if(argc == 3) {\n        port = atoi(argv[1]);\n        int n = strlen(argv[2]);\n        strncpy(serAdd, argv[2], n);\n        if(n &gt;= internet_address_len){\n            error_message(\"Internet address is incorrect\");\n        }\n        serAdd[n] = '\\0';\n    }\n    printf(\"\\n\\tDE is a basic server built to carry out simple things\\n\"\n            \"\\t-----    -----\\n\"\n            \"\\t|    |   |\\n\"\n            \"\\t|    |   -----\\n\"\n            \"\\t|    |   |\\n\"\n            \"\\t-----    -----\\n\"\n           \"\\tMethods implemented [Get &amp; Put]\\n\"\n           \"\\tTo start type start\\n\"\n            \"\\tTo stop type stop\\nDE]\");\n    scanf(\"%s\", strAction);\n    if (strcmp(strAction, START) == 0){\n        printf(\"Server %sed\\n\", START);\n        int listenid = start_server(port);\n        printf(\"listen on port %d &amp; listening is %d\\nDE]\", port,listenid);\n        signal(SIGPIPE, SIG_IGN);\n        while(server_conn) {\n            pid =fork();\n            if(pid == 0) {\n                process_server(listenid);\n                break;              \n            }\n            scanf(\"%s\", strAction);\n            if (strcmp(strAction, STOP) == 0) {\n                close(listenid);\n                return 0;\n            }\n\n        }\n\n    }\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "r", "debugging", "interface", "gdb"], "comments": [{"owner": {"reputation": 17207, "user_id": 1869097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041dd995b50ecacbea065e588a4f81cf?s=128&d=identicon&r=PG", "display_name": "nrussell", "link": "https://stackoverflow.com/users/1869097/nrussell"}, "edited": false, "score": 0, "creation_date": 1470782752, "post_id": 38861564, "comment_id": 65087053, "body": "I don&#39;t see why not. Did you try starting R in debug mode (<code>R --debugger=gdb</code>)?"}, {"owner": {"reputation": 14929, "user_id": 2051137, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/1sIMq.jpg?s=128&g=1", "display_name": "Remi.b", "link": "https://stackoverflow.com/users/2051137/remi-b"}, "reply_to_user": {"reputation": 17207, "user_id": 1869097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041dd995b50ecacbea065e588a4f81cf?s=128&d=identicon&r=PG", "display_name": "nrussell", "link": "https://stackoverflow.com/users/1869097/nrussell"}, "edited": false, "score": 0, "creation_date": 1470784503, "post_id": 38861564, "comment_id": 65087524, "body": "I am a bit confused as I am used to follow the <code>gdb</code> command by an executable. When I do <code>R --debugger=gdb</code>, R opens (there is no <code>(dgb)</code> prompt). I can then source() my R.wrapper and it executes but I don&#39;t seem to have the gdb interface. Just like before, we reach the segmentation fault in the middle of the <code>C</code> code and I receive a message from <code>R</code> informing me of the segmentation fault. It just looked like it was before. Can you help me out?"}, {"owner": {"reputation": 17207, "user_id": 1869097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041dd995b50ecacbea065e588a4f81cf?s=128&d=identicon&r=PG", "display_name": "nrussell", "link": "https://stackoverflow.com/users/1869097/nrussell"}, "edited": false, "score": 0, "creation_date": 1470784693, "post_id": 38861564, "comment_id": 65087569, "body": "You definitely have <code>gdb</code> installed right? Also, which operating system are you on? <code>gdb</code> should have started right up with the command above; I will add a more detailed example below in a minute to demonstrate."}, {"owner": {"reputation": 14929, "user_id": 2051137, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/1sIMq.jpg?s=128&g=1", "display_name": "Remi.b", "link": "https://stackoverflow.com/users/2051137/remi-b"}, "reply_to_user": {"reputation": 17207, "user_id": 1869097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041dd995b50ecacbea065e588a4f81cf?s=128&d=identicon&r=PG", "display_name": "nrussell", "link": "https://stackoverflow.com/users/1869097/nrussell"}, "edited": false, "score": 0, "creation_date": 1470784959, "post_id": 38861564, "comment_id": 65087635, "body": "Yes, <code>gdb</code> is installed and it works fine on executable. I am on MAC OS X 10.11.3 (info added to post). Thanks for your help!"}, {"owner": {"reputation": 17207, "user_id": 1869097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041dd995b50ecacbea065e588a4f81cf?s=128&d=identicon&r=PG", "display_name": "nrussell", "link": "https://stackoverflow.com/users/1869097/nrussell"}, "edited": false, "score": 0, "creation_date": 1470785135, "post_id": 38861564, "comment_id": 65087677, "body": "Out of curiosity, can you try passing the full path to <code>gdb</code>, e.g. <code>R -d &#47;path&#47;to&#47;gdb</code>, instead of just <code>R -d gdb</code>?"}, {"owner": {"reputation": 14929, "user_id": 2051137, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/1sIMq.jpg?s=128&g=1", "display_name": "Remi.b", "link": "https://stackoverflow.com/users/2051137/remi-b"}, "reply_to_user": {"reputation": 17207, "user_id": 1869097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041dd995b50ecacbea065e588a4f81cf?s=128&d=identicon&r=PG", "display_name": "nrussell", "link": "https://stackoverflow.com/users/1869097/nrussell"}, "edited": false, "score": 0, "creation_date": 1470785376, "post_id": 38861564, "comment_id": 65087745, "body": "Oh this seems to work! .... I got it I had some trouble with my gdb actually... was not correctly installed actually (despite what I said above!). Fixed now, it works with <code>R -d gdb</code> as well. You can probably amek an answer out of your comment if you want"}, {"owner": {"reputation": 14929, "user_id": 2051137, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/1sIMq.jpg?s=128&g=1", "display_name": "Remi.b", "link": "https://stackoverflow.com/users/2051137/remi-b"}, "reply_to_user": {"reputation": 17207, "user_id": 1869097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041dd995b50ecacbea065e588a4f81cf?s=128&d=identicon&r=PG", "display_name": "nrussell", "link": "https://stackoverflow.com/users/1869097/nrussell"}, "edited": false, "score": 1, "creation_date": 1470786279, "post_id": 38861564, "comment_id": 65087994, "body": "I actually still have trouble but I realize my question is not specific about the .C interface but about the use of <code>gdb</code> with R. I guess I will just let you post your answer and will open a new post that explain more accurately what kind of error message I get with <code>R -d gdb</code>. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 17207, "user_id": 1869097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041dd995b50ecacbea065e588a4f81cf?s=128&d=identicon&r=PG", "display_name": "nrussell", "link": "https://stackoverflow.com/users/1869097/nrussell"}, "is_accepted": true, "score": 3, "last_activity_date": 1470786829, "last_edit_date": 1470786829, "creation_date": 1470786314, "answer_id": 38862133, "question_id": 38861564, "link": "https://stackoverflow.com/questions/38861564/gdb-with-with-the-c-interface-shared-object/38862133#38862133", "title": "gdb with with the .C interface (shared object)", "body": "<p>Whether you are calling compiled code via <code>.C</code> or <code>.Call</code> should not matter WRT to debugging an R session via <code>gdb</code>. As an example, consider the code below which <strong>intentionally causes a segfault</strong> (on my system) by dereferencing a null pointer: </p>\n\n<pre><code>#include &lt;R.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid rtest(void)\n{\n    int* p = NULL;\n    printf(\"%d\\n\", *p);\n} \n</code></pre>\n\n<p>Compile this with <code>R CMD SHLIB rtest.c</code>, and start R using either of </p>\n\n<ul>\n<li><code>R -d /path/to/gdb</code> </li>\n<li><code>R --debugger=/path/to/gdb</code> </li>\n</ul>\n\n<p>Or, if <code>gdb</code> is on your <code>PATH</code>, you don't need the full file path above. At any rate, start the R session: </p>\n\n<pre><code>nathan@nathan-deb:/tmp$ R --debugger=gdb\n\n#GNU gdb (Debian 7.7.1+dfsg-5) 7.7.1\n#Copyright (C) 2014 Free Software Foundation, Inc.\n#License GPLv3+: GNU GPL version 3 or later \n#\n# omitted\n#\n#Reading symbols from /usr/local/lib/R/bin/exec/R...done.\n#\n(gdb) r \n</code></pre>\n\n<p>Then load the shared library, call the function, and proceed with your debugging session: </p>\n\n<pre><code>dyn.load(\"rtest.so\")\nf &lt;- function() .C(\"rtest\")\nf()\n\n#Program received signal SIGSEGV, Segmentation fault.\n#rtest () at rtest.c:8\n#8      printf(\"%d\\n\", *p);\n</code></pre>\n"}], "owner": {"reputation": 14929, "user_id": 2051137, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/1sIMq.jpg?s=128&g=1", "display_name": "Remi.b", "link": "https://stackoverflow.com/users/2051137/remi-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 38862133, "answer_count": 1, "score": 0, "last_activity_date": 1470786829, "creation_date": 1470782436, "last_edit_date": 1470784989, "question_id": 38861564, "link": "https://stackoverflow.com/questions/38861564/gdb-with-with-the-c-interface-shared-object", "title": "gdb with with the .C interface (shared object)", "body": "<p>I am calling a shared object coded in <code>C</code> from a <code>R</code> wrapper via the <a href=\"http://www.biostat.jhsph.edu/~rpeng/docs/interface.pdf\" rel=\"nofollow\">.C</a>. The <code>C</code> code cause segmentation faults and I would like to use <a href=\"https://www.gnu.org/software/gdb/\" rel=\"nofollow\">gdb</a> to help me debug this code.</p>\n\n<p>Is it possible to use <code>gdb</code> with the .C interface?</p>\n\n<p>I am on MAC OSX 10.11.3</p>\n"}, {"tags": ["c", "if-statement", "switch-statement"], "comments": [{"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1470781987, "post_id": 38861473, "comment_id": 65086835, "body": "You kind of could, with a major hack.. I don&#39;t recommend it."}, {"owner": {"reputation": 437, "user_id": 6557079, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7ade9a92d724b19b0c7cc35bb300fc7d?s=128&d=identicon&r=PG&f=1", "display_name": "gloopit", "link": "https://stackoverflow.com/users/6557079/gloopit"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1470782008, "post_id": 38861473, "comment_id": 65086840, "body": "I&#39;m a beginner, not looking to get too crazy just for the sake of it haha"}, {"owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "edited": false, "score": 0, "creation_date": 1470782077, "post_id": 38861473, "comment_id": 65086856, "body": "You can&#39;t, not without a direct equals comparison."}, {"owner": {"reputation": 15224, "user_id": 2397327, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b1b4bb1ed29f123c55b9c916212f47ed?s=128&d=identicon&r=PG", "display_name": "Jonathan Lam", "link": "https://stackoverflow.com/users/2397327/jonathan-lam"}, "edited": false, "score": 0, "creation_date": 1470782244, "post_id": 38861473, "comment_id": 65086903, "body": "I believe you could do it in a more DRY method, but not with a switch statement -- are you open to that?"}, {"owner": {"reputation": 437, "user_id": 6557079, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7ade9a92d724b19b0c7cc35bb300fc7d?s=128&d=identicon&r=PG&f=1", "display_name": "gloopit", "link": "https://stackoverflow.com/users/6557079/gloopit"}, "edited": false, "score": 0, "creation_date": 1470782311, "post_id": 38861473, "comment_id": 65086924, "body": "yup, that&#39;s what I was going with by trying to implement a switch!"}], "answers": [{"tags": [], "owner": {"reputation": 2626, "user_id": 300290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wI1od.png?s=128&g=1", "display_name": "Mike Andrews", "link": "https://stackoverflow.com/users/300290/mike-andrews"}, "is_accepted": true, "score": 4, "last_activity_date": 1470782690, "creation_date": 1470782690, "answer_id": 38861606, "question_id": 38861473, "link": "https://stackoverflow.com/questions/38861473/how-can-i-write-this-as-a-switch-statement/38861606#38861606", "title": "How can I write this as a switch statement?", "body": "<p>As the comments have indicated, you can't.  What you can do is make it table-driven, which is probably what @Lambda Ninja intended as more DRY.  Something like this?</p>\n\n<pre><code>typedef struct pair_s {\n    const char *first;\n    const char *second;\n} pair;\n\nconst char *lookup(const char *path)\n{\n    static pair content_types[] = {\n        { \"CSS\", \"text/css\" },\n        { \"HTML\", \"text/html\" },\n        { \"GIF\", \"image/gif\" },\n        { \"ICO\", \"image/x-icon\" },\n        // ... etc.\n        { \"\", \"\" }, // terminator\n    };\n\n    for (int i = 0; *content_types[i].first != '\\0'; i++) {\n        if (strcasecmp(path, content_types[i].first) == 0)\n            return content_types[i].second;\n    }\n\n    return NULL;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 905, "user_id": 2638371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uZefP.png?s=128&g=1", "display_name": "imbearr", "link": "https://stackoverflow.com/users/2638371/imbearr"}, "edited": false, "score": 0, "creation_date": 1470822575, "post_id": 38869704, "comment_id": 65101931, "body": "Big range of archs have <code>sizeof(int)==2</code>, so your code must use fixed width integer types from <code>&lt;cstdint.h&gt;</code>. Type <code>uint32_t</code> always will have <code>sizeof(uint32_t)==4</code>."}, {"owner": {"reputation": 11, "user_id": 3929991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dec312882238a8822952f7f971d1e06e?s=128&d=identicon&r=PG&f=1", "display_name": "aa599", "link": "https://stackoverflow.com/users/3929991/aa599"}, "reply_to_user": {"reputation": 905, "user_id": 2638371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uZefP.png?s=128&g=1", "display_name": "imbearr", "link": "https://stackoverflow.com/users/2638371/imbearr"}, "edited": false, "score": 0, "creation_date": 1470826193, "post_id": 38869704, "comment_id": 65104330, "body": "Good point. I did add a check for sizeof(int), and using a long would be better, but the main point of my answer was mapping strings to a form accessible to switch, rather than producing releasable code. I&#39;m new here, so maybe that wasn&#39;t ok. I&#39;ll edit the code."}, {"owner": {"reputation": 905, "user_id": 2638371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uZefP.png?s=128&g=1", "display_name": "imbearr", "link": "https://stackoverflow.com/users/2638371/imbearr"}, "edited": false, "score": 0, "creation_date": 1470827121, "post_id": 38869704, "comment_id": 65104923, "body": "Answer which content only main point it&#39;s good for me (imho) and for you (because this save your time), but there exist <a href=\"http://stackoverflow.com/help/how-to-answer\">some recommendations</a>, and your answer contains some non-critical errors and won&#39;t be upvoted by biggest part of users who just copypaste your code."}, {"owner": {"reputation": 11, "user_id": 3929991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dec312882238a8822952f7f971d1e06e?s=128&d=identicon&r=PG&f=1", "display_name": "aa599", "link": "https://stackoverflow.com/users/3929991/aa599"}, "reply_to_user": {"reputation": 1431, "user_id": 1258302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r06hH.jpg?s=128&g=1", "display_name": "yellowantphil", "link": "https://stackoverflow.com/users/1258302/yellowantphil"}, "edited": false, "score": 0, "creation_date": 1470903145, "post_id": 38869704, "comment_id": 65141499, "body": "@yellowantphil I never normally return in a switch (I&#39;m an only-exit-at-the-bottom-of-the-function kinda guy), so I had some conflict with the requestors in-switch returns and my own need to have breaks."}], "tags": [], "owner": {"reputation": 11, "user_id": 3929991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dec312882238a8822952f7f971d1e06e?s=128&d=identicon&r=PG&f=1", "display_name": "aa599", "link": "https://stackoverflow.com/users/3929991/aa599"}, "is_accepted": false, "score": 1, "last_activity_date": 1470830823, "last_edit_date": 1470830823, "creation_date": 1470822136, "answer_id": 38869704, "question_id": 38861473, "link": "https://stackoverflow.com/questions/38861473/how-can-i-write-this-as-a-switch-statement/38869704#38869704", "title": "How can I write this as a switch statement?", "body": "<p>Because C switch can only test primitive types, you need to map the strings to one of those types.\nHappily, the strings you want to test have few enough characters to fit in an int, so you could use the bitwise operators to combine the characters into unique values, testable by switch:</p>\n\n<pre><code>#define VAL_CSS  ( ((('C'&lt;&lt;8)|'S')&lt;&lt;8)|'S')\n#define VAL_HTML ((((('H'&lt;&lt;8)|'T')&lt;&lt;8)|'M')&lt;&lt;8|'L')\n#define VAL_GIF  ( ((('G'&lt;&lt;8)|'I')&lt;&lt;8)|'F')\n#define VAL_ICO  ( ((('I'&lt;&lt;8)|'C')&lt;&lt;8)|'O')\n#define VAL_JPG  ( ((('J'&lt;&lt;8)|'P')&lt;&lt;8)|'G')\n#define VAL_JS   (   ('J'&lt;&lt;8)|'S')\n#define VAL_PHP  ( ((('P'&lt;&lt;8)|'H')&lt;&lt;8)|'P')\n#define VAL_PNG  ( ((('P'&lt;&lt;8)|'N')&lt;&lt;8)|'G')\n\nconst char* lookup(const char* path) { /* \"ext\" might be a better name than \"path\" */\n  if (path != NULL)\n    if (strlen(path) &lt;= sizeof(uint32_t)) { /* check it'll fit */\n      uint32_t val = 0;\n      while (*path) \n        val = val&lt;&lt;8 | toupper(*path++); /* same as in #defines */\n\n      switch (val) {\n        case VAL_CSS:  return \"text/css\";        break;\n        case VAL_HTML: return \"text/html\";       break;\n        case VAL_GIF:  return \"image/gif\";       break;\n        case VAL_ICO:  return \"image/x-icon\";    break;\n        case VAL_JPG:  return \"image/jpeg\";      break;\n        case VAL_JS:   return \"text/javascript\"; break;\n        case VAL_PHP:  return \"text/x-php\";      break;\n        case VAL_PNG:  return \"image/png\";       break;\n      }\n    }\n\n  return NULL;\n}\n</code></pre>\n"}], "owner": {"reputation": 437, "user_id": 6557079, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7ade9a92d724b19b0c7cc35bb300fc7d?s=128&d=identicon&r=PG&f=1", "display_name": "gloopit", "link": "https://stackoverflow.com/users/6557079/gloopit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 38861606, "answer_count": 2, "score": 1, "last_activity_date": 1470830823, "creation_date": 1470781902, "question_id": 38861473, "link": "https://stackoverflow.com/questions/38861473/how-can-i-write-this-as-a-switch-statement", "title": "How can I write this as a switch statement?", "body": "<p>I'm having a little trouble trying to rewrite this collection of if statements as a switch statement.</p>\n\n<p>This isn't an exercise or anything, I just really like the look of switch statements. I'm having trouble figuring it out with a function in the if condition on this however.</p>\n\n<pre><code>const char* lookup(const char* path)\n{\n    //if a path exists, compare path to given extensions\n    //if there is a match, return the appropriate output\n    if (path != NULL) {\n        //using strcasecmp is useful b/c capitalization is overlooked when looking for a match\n        if (strcasecmp(path, \"CSS\") == 0) return \"text/css\";\n        if (strcasecmp(path, \"HTML\") == 0) return \"text/html\";\n        if (strcasecmp(path, \"GIF\") == 0) return \"image/gif\";\n        if (strcasecmp(path, \"ICO\") == 0) return \"image/x-icon\";\n        if (strcasecmp(path, \"JPG\") == 0) return \"image/jpeg\";\n        if (strcasecmp(path, \"JS\") == 0) return \"text/javascript\";\n        if (strcasecmp(path, \"PHP\") == 0) return \"text/x-php\";\n        if (strcasecmp(path, \"PNG\") == 0) return \"image/png\";\n    }\n    //if there is no path, return NULL\n    return NULL;\n}\n</code></pre>\n\n<p>Is it possible to do this, is there any benefit or am I wasting time?</p>\n"}, {"tags": ["c++", "c", "language-lawyer"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1470782050, "post_id": 38861423, "comment_id": 65086851, "body": "<i>but the input types have different sizes.</i> -- Don&#39;t you think what is more important is that the types are signed / unsigned rather than the size of these types?"}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1470782335, "post_id": 38861423, "comment_id": 65086934, "body": "@PaulMcKenzie: Yes, the input types have mixed sign.  However, this is not a difference between <code>g1()</code> and <code>g2()</code>."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 1, "creation_date": 1470782490, "post_id": 38861423, "comment_id": 65086980, "body": "See <a href=\"http://stackoverflow.com/questions/2280663/in-a-c-expression-where-unsigned-int-and-signed-int-are-present-which-type-will\" title=\"in a c expression where unsigned int and signed int are present which type will\">stackoverflow.com/questions/2280663/&hellip;</a> to explain <code>g1</code>, the negative number is converted to a very large unsigned number. For <code>g2</code>, both are converted to <code>int</code> which has enough range to handle both inputs without loss."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 1, "creation_date": 1470782617, "post_id": 38861423, "comment_id": 65087010, "body": "I don&#39;t know why but: in g1() <code>decltype(a+b)</code> is unsigned; in g2() <code>decltype(a+b)</code> is signed.   Try <code>decltype(a+b) r = a+b; return r&lt;9;</code> and debug it."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 1, "creation_date": 1470787434, "post_id": 38861423, "comment_id": 65088250, "body": "FWIW: The code in the dup question would likely trigger compiler warnings, whereas my code did not (in either C or C++).  Nevertheless, the answers are closely related -- even though that question does not specify C++."}], "answers": [{"comments": [{"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1470784930, "post_id": 38861654, "comment_id": 65087627, "body": "I can&#39;t figure out what you are referencing as &quot;10.5.5&quot;.  Your link was to 5.11."}, {"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "reply_to_user": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1470788586, "post_id": 38861654, "comment_id": 65088490, "body": "@nobar My bad, I was looking at a local, outdated draft. (11.5.5)  is the fifth bullet point of the fifth bullet point in paragraph 11."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1470842597, "post_id": 38861654, "comment_id": 65116337, "body": "This is IMO a bit unclear: <code>a</code> and <code>b</code> are not converted due to the &quot;usual arithmetic conversion&quot; but due to &quot;integer promotion&quot; (which happens first). At least that&#39;d be my understanding of the exact wording in the standard."}, {"owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 1, "creation_date": 1470846921, "post_id": 38861654, "comment_id": 65119194, "body": "@DanielJour My interpretation is that promotion is only applied because the fifth top-level bullet point applies."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1470859292, "post_id": 38861654, "comment_id": 65126010, "body": "@Columbo Yes, that makes more sense than my interpretation."}], "tags": [], "owner": {"reputation": 56893, "user_id": 3647361, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xvjhM.png?s=128&g=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/3647361/columbo"}, "is_accepted": false, "score": 3, "last_activity_date": 1470788541, "last_edit_date": 1470788541, "creation_date": 1470783044, "answer_id": 38861654, "question_id": 38861423, "link": "https://stackoverflow.com/questions/38861423/mixed-sign-integer-math-depends-on-variable-size/38861654#38861654", "title": "mixed-sign integer math depends on variable size", "body": "<p>As a result of the <a href=\"http://eel.is/c++draft/expr#11\" rel=\"nofollow\">usual arithmetic conversions</a>, both <code>a</code> and <code>b</code> in <code>g2</code>'s body are promoted to <code>int</code>, which is why that function works perfectly well. </p>\n\n<p>For <code>g1</code>, because (<code>u</code>)<code>int32_t</code> does not have a rank less than that of <code>int</code>, no promotion occurs, and the very last bullet point (11.5.5) applies. Both operands are converted to the unsigned type, which - in <code>a</code>'s case - causes an underflow, producing a value much greater than 9. Hence <code>g1</code> returned <code>1</code> (<code>true</code>).</p>\n"}], "owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 2, "closed_date": 1470786285, "answer_count": 1, "score": 3, "last_activity_date": 1470788541, "creation_date": 1470781658, "question_id": 38861423, "link": "https://stackoverflow.com/questions/38861423/mixed-sign-integer-math-depends-on-variable-size", "closed_reason": "Duplicate", "title": "mixed-sign integer math depends on variable size", "body": "<p>Functions <code>g1()</code> and <code>g2()</code> have identical logic, but the input types have different sizes.  Why do they return different results for negative sums?</p>\n\n<pre><code>/*BINFMTCXX: -Wall -Werror -Wextra -std=c++11\n*/\n\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nchar g1( int32_t a, uint32_t b ) { return a+b&lt;9; } // fails when a+b is negative\nchar g2( int16_t a, uint16_t b ) { return a+b&lt;9; } // works if no overflow\n\nint main()\n   {\n\n   for ( int a=-2, b=0; a&lt;=2; a++ )\n      {\n      fprintf(stderr,\"a=%+d, b=%d, g1=%+d, g2=%+d %s\\n\", a, b, g1(a,b), g2(a,b), g1(a,b)==g2(a,b)?\"\":\"!\" );\n      }\n\n   return 0;\n   }\n</code></pre>\n\n<p>When I run it, it shows that <code>g1()</code> fails when <code>a+b</code> is negative:</p>\n\n<pre><code>$ ./mixed_sign_math_per_size.cpp\na=-2, b=0, g1=+0, g2=+1 !\na=-1, b=0, g1=+0, g2=+1 !\na=+0, b=0, g1=+1, g2=+1 \na=+1, b=0, g1=+1, g2=+1 \na=+2, b=0, g1=+1, g2=+1 \n</code></pre>\n\n<p>The results are the same in C and C++.</p>\n"}, {"tags": ["c++", "c", "struct", "memory-alignment", "struct-member-alignment"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1470780390, "post_id": 38861172, "comment_id": 65086317, "body": "Padding ........................."}, {"owner": {"reputation": 155, "user_id": 3874920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6495d61149eff14af6d0daed81237b66?s=128&d=identicon&r=PG&f=1", "display_name": "rhynodegreat", "link": "https://stackoverflow.com/users/3874920/rhynodegreat"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1470780484, "post_id": 38861172, "comment_id": 65086353, "body": "But why do only those fields get padded? Both of them are offset by multiple of 16, so why would the next field need padding?"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1470780533, "post_id": 38861172, "comment_id": 65086376, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6 He, nice. :)"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1470780581, "post_id": 38861172, "comment_id": 65086393, "body": "It&#39;s about alignment to 64 bit addresses that will be better achieved for being accessed with the CPU&#39;s chache line."}, {"owner": {"reputation": 3599, "user_id": 2487517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cRCpa.jpg?s=128&g=1", "display_name": "Tibrogargan", "link": "https://stackoverflow.com/users/2487517/tibrogargan"}, "edited": false, "score": 2, "creation_date": 1470780624, "post_id": 38861172, "comment_id": 65086406, "body": "The offset of a field depends on it&#39;s type, and where the previous field ends; not the type of the previous field."}, {"owner": {"reputation": 155, "user_id": 3874920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6495d61149eff14af6d0daed81237b66?s=128&d=identicon&r=PG&f=1", "display_name": "rhynodegreat", "link": "https://stackoverflow.com/users/3874920/rhynodegreat"}, "edited": false, "score": 0, "creation_date": 1470780712, "post_id": 38861172, "comment_id": 65086440, "body": "I understand that. Every other <code>uint32_t</code> field only takes up 4 bytes and is not padded."}, {"owner": {"reputation": 3599, "user_id": 2487517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cRCpa.jpg?s=128&g=1", "display_name": "Tibrogargan", "link": "https://stackoverflow.com/users/2487517/tibrogargan"}, "edited": false, "score": 0, "creation_date": 1470780788, "post_id": 38861172, "comment_id": 65086466, "body": "surface is not probably a standard uint32_t, see Nicol Bolas&#39;s answer."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 3874920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6495d61149eff14af6d0daed81237b66?s=128&d=identicon&r=PG&f=1", "display_name": "rhynodegreat", "link": "https://stackoverflow.com/users/3874920/rhynodegreat"}, "edited": false, "score": 0, "creation_date": 1470780772, "post_id": 38861228, "comment_id": 65086460, "body": "The issue is that <code>flags</code> is taking up 8 bytes."}, {"owner": {"reputation": 374829, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 155, "user_id": 3874920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6495d61149eff14af6d0daed81237b66?s=128&d=identicon&r=PG&f=1", "display_name": "rhynodegreat", "link": "https://stackoverflow.com/users/3874920/rhynodegreat"}, "edited": false, "score": 6, "creation_date": 1470780793, "post_id": 38861228, "comment_id": 65086468, "body": "@rhynodegreat: No, it isn&#39;t. It takes up 4 bytes. Following it are four <i>unusued bytes</i>, so that the next field can be 8-byte aligned."}, {"owner": {"reputation": 155, "user_id": 3874920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6495d61149eff14af6d0daed81237b66?s=128&d=identicon&r=PG&f=1", "display_name": "rhynodegreat", "link": "https://stackoverflow.com/users/3874920/rhynodegreat"}, "edited": false, "score": 1, "creation_date": 1470780906, "post_id": 38861228, "comment_id": 65086513, "body": "Ah, so the padding is added because the next field is 8 bytes and needs to be aligned. Same with <code>queueFamilyIndexCount</code>, which is followed by a pointer."}, {"owner": {"reputation": 3599, "user_id": 2487517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cRCpa.jpg?s=128&g=1", "display_name": "Tibrogargan", "link": "https://stackoverflow.com/users/2487517/tibrogargan"}, "edited": false, "score": 0, "creation_date": 1470781114, "post_id": 38861228, "comment_id": 65086588, "body": "Technically there is no &quot;padding&quot;, just alignment.  <code>surface</code> is aligned at a multiple of 8 bytes because it&#39;s a 64 bit value.  If you inserted another uint32_t between <code>flags</code> and <code>surface</code>, the offset to <code>surface</code> would remain the same."}], "tags": [], "owner": {"reputation": 374829, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": true, "score": 4, "last_activity_date": 1470780885, "last_edit_date": 1470780885, "creation_date": 1470780648, "answer_id": 38861228, "question_id": 38861172, "link": "https://stackoverflow.com/questions/38861172/whats-the-reason-for-this-structs-alignment/38861228#38861228", "title": "What&#39;s the reason for this struct&#39;s alignment?", "body": "<p><code>VkSurfaceKHR</code> is a non-dispatchable handle. Which, by Vulkan's definitions, is a 64-bit integer. And therefore it must have 8-byte alignment.</p>\n\n<p>When structures are being laid out, the compiler will ensure that each member gets the alignment that the type requires. If <code>surface</code> had come immediately after <code>flags</code>, it would not have 8-byte alignment. Thus, the compiler inserts 4 bytes of padding between the two.</p>\n"}, {"comments": [{"owner": {"reputation": 3599, "user_id": 2487517, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cRCpa.jpg?s=128&g=1", "display_name": "Tibrogargan", "link": "https://stackoverflow.com/users/2487517/tibrogargan"}, "edited": false, "score": 0, "creation_date": 1470781718, "post_id": 38861386, "comment_id": 65086775, "body": "you can use the empty space"}], "tags": [], "owner": {"reputation": 7526, "user_id": 4108376, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/163807162a115b27e50f5f5f2b90de26?s=128&d=identicon&r=PG&f=1", "display_name": "tmlen", "link": "https://stackoverflow.com/users/4108376/tmlen"}, "is_accepted": false, "score": 1, "last_activity_date": 1470815544, "last_edit_date": 1470815544, "creation_date": 1470781420, "answer_id": 38861386, "question_id": 38861172, "link": "https://stackoverflow.com/questions/38861172/whats-the-reason-for-this-structs-alignment/38861386#38861386", "title": "What&#39;s the reason for this struct&#39;s alignment?", "body": "<p>All type have a size <code>sizeof(T)</code>, and an alignment requirement <code>alignof(T)</code>. Instances of it always need to be laid out in memory at addresses that are multiple of <code>alignof(T)</code>.</p>\n\n<p>In a struct, the compiler automatically inserts <em>padding</em> between the elements such that this requirement is fulfilled for all its elements, relative to the start address of the struct (i.e. for the <code>offsetof</code> values). This is empty space between subsequent struct elements.</p>\n\n<p>It also sets the <code>alignof</code> of the whole struct, such that all its elements will be correctly aligned in memory. For example on a typical 64 bit platform:</p>\n\n<pre><code>struct A {\n    char c;    // sizeof(char) == 1; alignof(char) == 1\n    int* ptr;  // sizeof(char) == 8; alignof(char) == 8\n}\n</code></pre>\n\n<p>Pointers have a size of 8 byte (64 bit), and also an alignment requirement of 8 byte. In this struct there will be 7 bytes of padding between <code>c</code> and <code>ptr</code>, such that <code>offsetof(A, c) == 0</code> and <code>offsetof(A, ptr) == 8</code>. And <code>alignof(A) == 8</code>. Whenever an instance <code>A a</code> is created (on stack or on heap), <code>&amp;a % 8 == 0</code>, and so <code>&amp;(a.ptr) % 8 == 0</code>.</p>\n\n<hr>\n\n<p>This is done because some CPU instructions (for example SIMD vector instructions) require their operands to be aligned at word boundaries, i.e. multiples of 8 (or 4 for 32 bit) in memory. Without the proper alignment these instructions could not be directly used and the program would become slower.</p>\n\n<hr>\n\n<p>In this example <code>VkSurfaceKHR</code> and <code>pQueueFamilyIndices</code> are pointers with <code>alignof == 8</code>.</p>\n"}], "owner": {"reputation": 155, "user_id": 3874920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6495d61149eff14af6d0daed81237b66?s=128&d=identicon&r=PG&f=1", "display_name": "rhynodegreat", "link": "https://stackoverflow.com/users/3874920/rhynodegreat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "accepted_answer_id": 38861228, "answer_count": 2, "score": 2, "last_activity_date": 1470815544, "creation_date": 1470780334, "question_id": 38861172, "link": "https://stackoverflow.com/questions/38861172/whats-the-reason-for-this-structs-alignment", "title": "What&#39;s the reason for this struct&#39;s alignment?", "body": "<p>In the Vulkan header <code>vulkan.h</code> there is a struct defined as </p>\n\n<pre><code>typedef struct VkSwapchainCreateInfoKHR {\n    VkStructureType                  sType;\n    const void*                      pNext;\n    VkSwapchainCreateFlagsKHR        flags;\n    VkSurfaceKHR                     surface;\n    uint32_t                         minImageCount;\n    VkFormat                         imageFormat;\n    VkColorSpaceKHR                  imageColorSpace;\n    VkExtent2D                       imageExtent;\n    uint32_t                         imageArrayLayers;\n    VkImageUsageFlags                imageUsage;\n    VkSharingMode                    imageSharingMode;\n    uint32_t                         queueFamilyIndexCount;\n    const uint32_t*                  pQueueFamilyIndices;\n    VkSurfaceTransformFlagBitsKHR    preTransform;\n    VkCompositeAlphaFlagBitsKHR      compositeAlpha;\n    VkPresentModeKHR                 presentMode;\n    VkBool32                         clipped;\n    VkSwapchainKHR                   oldSwapchain;\n} VkSwapchainCreateInfoKHR;\n</code></pre>\n\n<p>I've used the following code to see each field's alignment (Visual Studio 2015)</p>\n\n<pre><code>    std::cout &lt;&lt;\n        \"sType: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, sType) &lt;&lt; std::endl &lt;&lt;\n        \"pNext: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, pNext) &lt;&lt; std::endl &lt;&lt;\n        \"flags: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, flags) &lt;&lt; std::endl &lt;&lt;\n        \"surface: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, surface) &lt;&lt; std::endl &lt;&lt;\n        \"minImageCount: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, minImageCount) &lt;&lt; std::endl &lt;&lt;\n        \"imageFormat: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, imageFormat) &lt;&lt; std::endl &lt;&lt;\n        \"imageColorSpace: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, imageColorSpace) &lt;&lt; std::endl &lt;&lt;\n        \"imageExtent: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, imageExtent) &lt;&lt; std::endl &lt;&lt;\n        \"imageArrayLayers: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, imageArrayLayers) &lt;&lt; std::endl &lt;&lt;\n        \"imageUsage: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, imageUsage) &lt;&lt; std::endl &lt;&lt;\n        \"imageSharingMode: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, imageSharingMode) &lt;&lt; std::endl &lt;&lt;\n        \"queueFamilyIndexCount: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, queueFamilyIndexCount) &lt;&lt; std::endl &lt;&lt;\n        \"pQueueFamilyIndices: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, pQueueFamilyIndices) &lt;&lt; std::endl &lt;&lt;\n        \"preTransform: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, preTransform) &lt;&lt; std::endl &lt;&lt;\n        \"compositeAlpha: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, compositeAlpha) &lt;&lt; std::endl &lt;&lt;\n        \"presentMode: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, presentMode) &lt;&lt; std::endl &lt;&lt;\n        \"clipped: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, clipped) &lt;&lt; std::endl &lt;&lt;\n        \"oldSwapchain: \" &lt;&lt; offsetof(VkSwapchainCreateInfoKHR, oldSwapchain) &lt;&lt; std::endl &lt;&lt;\n        std::endl;\n</code></pre>\n\n<p>And got these results</p>\n\n<pre><code>sType: 0\npNext: 8\nflags: 16\nsurface: 24\nminImageCount: 32\nimageFormat: 36\nimageColorSpace: 40\nimageExtent: 44\nimageArrayLayers: 52\nimageUsageFlags: 56\nimageSharingMode: 60\nqueueFamilyIndexCount: 64\npQueueFamilyIndices: 72\npreTransform: 80\ncompositeAlpha: 84\npresentMode: 88\nclipped: 92\noldSwapchain: 96\n</code></pre>\n\n<p>Between the fields <code>flags</code> and <code>surface</code> there is an 8 byte gap, even though <code>flags</code> has an underlying type of <code>uint32_t</code>. The same is true with the fields <code>queueFamilyIndexCount</code> and <code>pQueueFamilyIndices</code>. Why do <code>flags</code> and <code>queueFamilyIndexCount</code> take up 8 bytes when they are only 4 bytes wide and every other field of type <code>uint32_t</code> takes up only 4 bytes? Is there something special about the memory alignment requirements at those offsets?</p>\n"}, {"tags": ["c", "types", "floating-point", "precision"], "comments": [{"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 5, "creation_date": 1470779848, "post_id": 38861057, "comment_id": 65086115, "body": "Have you ever wondered what the \u201cfloating\u201d in \u201cfloating-point\u201d meant? It means you can represent 1.2e-38 with 6 decimal places of precision. This said, do not try to think in decimal about binary floating-point."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1470780098, "post_id": 38861057, "comment_id": 65086206, "body": "1.2 is two decimal digits. The exponent has nothing to do with it. <a href=\"https://en.wikipedia.org/wiki/Significant_figures#Scientific_notation\" rel=\"nofollow noreferrer\">See this link</a>. <a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format#IEEE_754_single-precision_binary_floating-point_format:_binary32\" rel=\"nofollow noreferrer\">This link may also be useful</a>."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1470780209, "post_id": 38861057, "comment_id": 65086249, "body": "How many digits did it just take you to represent 1.2E-38 when you were typing this up?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1470785602, "post_id": 38861057, "comment_id": 65087799, "body": "0.000000000000000000012 has 21 decimal places, and 2 decimal places <i>of precision</i>."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1470791267, "post_id": 38861057, "comment_id": 65089048, "body": "stop thinking decimal, it is a binary format not a decimal format.  think of how many bits of mantissa not decimal digits."}, {"owner": {"reputation": 38231, "user_id": 68204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0a9dcffcc6539e462406647d2aed6fb?s=128&d=identicon&r=PG", "display_name": "RBerteig", "link": "https://stackoverflow.com/users/68204/rberteig"}, "edited": false, "score": 0, "creation_date": 1470802935, "post_id": 38861057, "comment_id": 65091487, "body": "The words &quot;precision&quot;, and &quot;range&quot; all have specific technical meanings."}], "answers": [{"tags": [], "owner": {"reputation": 2133, "user_id": 5447208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f8eb976d91e3b7bb21366a68d1a70f?s=128&d=identicon&r=PG&f=1", "display_name": "Cody", "link": "https://stackoverflow.com/users/5447208/cody"}, "is_accepted": false, "score": 0, "last_activity_date": 1470780641, "creation_date": 1470780641, "answer_id": 38861227, "question_id": 38861057, "link": "https://stackoverflow.com/questions/38861057/ranges-of-floating-point-in-c-programming-language/38861227#38861227", "title": "Ranges of floating point in C programming language", "body": "<p>Short answer, floating point numbers use exponents to represent the numbers, not 2's compliment like integers.  user3386109's links explain it, but <a href=\"http://www.h-schmidt.net/FloatConverter/IEEE754.html\" rel=\"nofollow\">here is a link to an interactive app</a> to let you see how each bit affects the final result.  I think you playing around with that will help more than an explanation or link to a Wikipedia page ever will.</p>\n"}, {"comments": [{"owner": {"reputation": 6223, "user_id": 2726892, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/DE8Dn.png?s=128&g=1", "display_name": "MooseBoys", "link": "https://stackoverflow.com/users/2726892/mooseboys"}, "edited": false, "score": 0, "creation_date": 1470782259, "post_id": 38861251, "comment_id": 65086907, "body": "As a more concrete example, the closest representation of the value <i>100/3</i> in <code>float</code> is <code>33.33333206...</code>. As you can see, only the 7 most significant decimal digits are meaningful. Note that depending on your definition of <i>precision</i>, <code>float</code> can have either 6 or 7 decimal digits of precision. <a href=\"http://www.exploringbinary.com/decimal-precision-of-binary-floating-point-numbers/\" rel=\"nofollow noreferrer\">This page</a> has a pretty good write-up on the details."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 4, "last_activity_date": 1595359558, "last_edit_date": 1595359558, "creation_date": 1470780736, "answer_id": 38861251, "question_id": 38861057, "link": "https://stackoverflow.com/questions/38861057/ranges-of-floating-point-in-c-programming-language/38861251#38861251", "title": "Ranges of floating point in C programming language", "body": "<p>Precision in floating point refers to the number of <em>leading significant</em> digits.</p>\n<p>For common <code>float</code>, it can be considered to have <a href=\"https://stackoverflow.com/q/49961587/2410359\">at least 6 decimal</a> digits of significance.</p>\n<hr />\n<p>Recall that floating point numbers are distributed logarithmically.  There are about as many different FP number from 0.1 to 0.2 as between 10 to 20 as between 0.000001 to 0.000002 as between 1,000,000 to 2,000,000.</p>\n<p>Notice that the digits for the next FP number changes by a small amount in the right most digits.</p>\n<pre><code>printf(&quot;FLT_MIN  %.*e\\n&quot;, FLT_DECIMAL_DIG - 1, FLT_MIN);\nprintf(&quot;FLT_MIN+ %.*e\\n&quot;, FLT_DECIMAL_DIG - 1, nextafterf(FLT_MIN, 1.0));\nprintf(&quot;one      %.*e\\n&quot;, FLT_DECIMAL_DIG - 1, 1.0);\nprintf(&quot;one+     %.*e\\n&quot;, FLT_DECIMAL_DIG - 1, nextafterf(1.0, 2.0));\nprintf(&quot;FLT_MIN- %.*e\\n&quot;, FLT_DECIMAL_DIG - 1, nextafterf(FLT_MAX, 1.0));\nprintf(&quot;FLT_MAX  %.*e\\n&quot;, FLT_DECIMAL_DIG - 1, FLT_MAX);\n</code></pre>\n<p>Output</p>\n<pre><code>FLT_MIN  1.17549435e-38\nFLT_MIN+ 1.17549449e-38\n\none      1.00000000e+00\none+     1.00000012e+00\n\nFLT_MAX- 3.40282326e+38\nFLT_MAX  3.40282347e+38\n</code></pre>\n<p>The difference between two successive FP number is often called the unit-(in-the)-last-place <a href=\"https://en.wikipedia.org/wiki/Unit_in_the_last_place\" rel=\"nofollow noreferrer\">ULP</a>.  It is this difference, as compared to the number that is the &quot;precision&quot;.  This difference for <a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format\" rel=\"nofollow noreferrer\">binary32</a> is constant for every power of 2, then it doubles with increasing power-of-2.</p>\n<p>Note the difference of consecutive <code>float</code> numbers just above 1.0 is 2<sup>-23</sup>  or 1.0/8,388,608 or <code>0.000000119...</code>.  This is the definition of <code>FLT_EPSILON</code>.  Some consider that the &quot;precision&quot;.  C specifies that the <em>most</em> this can be is <code>1E-5</code> or 1 part in 100,000.</p>\n<p>C does not specify the <code>float</code> behave exactly like the commonly employed <a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format\" rel=\"nofollow noreferrer\">binary32</a>, so expect some variations.</p>\n"}, {"tags": [], "owner": {"reputation": 331, "user_id": 10202131, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S1QO2.jpg?s=128&g=1", "display_name": "Md. A. Barik", "link": "https://stackoverflow.com/users/10202131/md-a-barik"}, "is_accepted": false, "score": 0, "last_activity_date": 1564017185, "last_edit_date": 1592644375, "creation_date": 1564017185, "answer_id": 57193028, "question_id": 38861057, "link": "https://stackoverflow.com/questions/38861057/ranges-of-floating-point-in-c-programming-language/57193028#57193028", "title": "Ranges of floating point in C programming language", "body": "<p>Computer store floating values using scientific notation.\nIf the floating point value is 293.990933 then the scientific notation is 0.293990933 * 10^3</p>\n<blockquote>\n<p><em>Here 0 sign bit</em></p>\n<p><em><strong>293990933 is called mantisa</strong></em></p>\n<p>3 is called exponent</p>\n</blockquote>\n<p>Reserved: for sign bit 1 binary digit.\nFor mantisa, it can have 24 bits and the rest of 32 will be for exponent!</p>\n<p>When you use %f it return 6 fraction of the number, by default!</p>\n"}], "owner": {"reputation": 1241, "user_id": 1286970, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/b5ff5f3cca9e0204db87f956276a1809?s=128&d=identicon&r=PG", "display_name": "Zaratruta", "link": "https://stackoverflow.com/users/1286970/zaratruta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1595359558, "creation_date": 1470779716, "question_id": 38861057, "link": "https://stackoverflow.com/questions/38861057/ranges-of-floating-point-in-c-programming-language", "title": "Ranges of floating point in C programming language", "body": "<p>According to <a href=\"http://www.tutorialspoint.com/cprogramming/c_data_types.htm\" rel=\"nofollow\">this link</a>, the FLOAT data type in C ranges from 1.2E-38 to 3.4E+38 and has 6 decimal places of precision.</p>\n\n<p>However, in my point of view, the value 1.2E-38 requires much more that 6 decimal places of precision for being represented.</p>\n\n<p>What is wrong in my reasoning?</p>\n"}, {"tags": ["c", "types", "lvalue"], "comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470779481, "post_id": 38860891, "comment_id": 65085976, "body": "@EugeneSh.: Add a reference and that&#39;s an answer."}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470779841, "post_id": 38861013, "comment_id": 65086113, "body": "It seems that the statement <i>&quot;all the side effects on arguments are completed before function entered&quot;</i> is misleading. How does it apply here? What is the side effect here? The increment of <code>n</code>? But it is not happening before the call. <code>p+n</code> is evaluated with the <i>previous</i> value of <code>n</code>"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470780272, "post_id": 38861013, "comment_id": 65086275, "body": "@EugeneSh.; Actually it seems question lack some information. In this case value computation of <code>p+n</code>. OP says: <i>I&#39;d assume that a compiler would calculate a result of function, and then increment <code>p + n</code></i>. But, opposite is true. <code>p+n</code> will be calculated first and then function will return its result."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470780708, "post_id": 38861013, "comment_id": 65086438, "body": "@EugeneSh.; No. Standard says: <i>The presence of a sequence point between the evaluation of expressions A and B implies that <b>every value computation and side effect</b> associated with A is sequenced before every value computation and side effect associated with B.</i> Its not only about side effect but also abot value computations. In this case I am talking about value computation of <code>p+n</code> as there is no side effect associated with the argument."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470780745, "post_id": 38861013, "comment_id": 65086449, "body": "So I think it has actually little to do with sequence points. It&#39;s just a regular read-evaluate-store computation."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470780879, "post_id": 38861013, "comment_id": 65086500, "body": "@EugeneSh.; Yes. Nothing to worry about. I think OP just overthink on it."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": true, "score": 2, "last_activity_date": 1470779939, "last_edit_date": 1470779939, "creation_date": 1470779440, "answer_id": 38861013, "question_id": 38860891, "link": "https://stackoverflow.com/questions/38860891/lvalue-and-function-result-dependency/38861013#38861013", "title": "lvalue and function result -- dependency?", "body": "<p>There is a sequence point before a function enter in function call. It means that every value computation and the side effects associated with an argument are completed before function entered in a function call. </p>\n\n<p>C11-\u00a76.5.2.2/10:</p>\n\n<blockquote>\n  <p>There is a sequence point after the evaluations of the function designator and the actual arguments but before the actual call.  </p>\n</blockquote>\n\n<p>So, in case of  </p>\n\n<pre><code>n += func(p + n);  \n</code></pre>\n\n<p><code>p + n</code> will be calculated before the function call. </p>\n"}, {"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470780181, "post_id": 38861027, "comment_id": 65086239, "body": "How can it be explained in terms of sequence points, if they are relevant here at all? Seems like they are not. there is no side effects here."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470780994, "post_id": 38861027, "comment_id": 65086547, "body": "@EugeneSh., Even though a function call involves a sequence point, that applies only to the evaluation of its arguments, I don&#39;t think it is relevant to deciding whether <code>n += func(p+n);</code> is well defined."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1470779540, "creation_date": 1470779540, "answer_id": 38861027, "question_id": 38860891, "link": "https://stackoverflow.com/questions/38860891/lvalue-and-function-result-dependency/38861027#38861027", "title": "lvalue and function result -- dependency?", "body": "<pre><code>n += func(p + n);\n</code></pre>\n\n<p>is well defined since <code>n</code> is accessed for writing only after the function call is completed. The function call can be completed only after reading the value of <code>n</code>.</p>\n"}], "owner": {"reputation": 4740, "user_id": 738154, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f2c009cb225b8ecee8de486630c37225?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/738154/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 38861013, "answer_count": 2, "score": 0, "last_activity_date": 1470779939, "creation_date": 1470778857, "question_id": 38860891, "link": "https://stackoverflow.com/questions/38860891/lvalue-and-function-result-dependency", "title": "lvalue and function result -- dependency?", "body": "<p>Consider the following snippet:</p>\n\n<pre><code>int func(char *ptr);\n...\nn += func(p + n);\n</code></pre>\n\n<p>Does this code yield undefined behaviour, since the function's argument depends on lvalue? I'd assume that a compiler would calculate a result of function, and then increment <code>p + n</code>, or this probably is compiler specific?</p>\n"}, {"tags": ["c", "gcc", "llvm"], "comments": [{"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 1, "creation_date": 1470777224, "post_id": 38860480, "comment_id": 65085030, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/3098380/how-to-deal-with-duplicated-function-name-within-c\">How to deal with duplicated function name within C?</a>"}, {"owner": {"reputation": 28330, "user_id": 298054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dffcc86140441472cfb6119375a9d7?s=128&d=identicon&r=PG", "display_name": "jweyrich", "link": "https://stackoverflow.com/users/298054/jweyrich"}, "edited": false, "score": 0, "creation_date": 1470777289, "post_id": 38860480, "comment_id": 65085068, "body": "Currently your <code>b.c</code> doesn&#39;t see the declaration of <code>a()</code>. Missing an <code>#include &quot;a.h&quot;</code> in <code>b.c</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1470777587, "post_id": 38860480, "comment_id": 65085207, "body": "Suggest dropping the C++ tag"}, {"owner": {"reputation": 1610, "user_id": 502189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cba4d424ecb01d45a923636bef46cc7?s=128&d=identicon&r=PG", "display_name": "rjp", "link": "https://stackoverflow.com/users/502189/rjp"}, "edited": false, "score": 0, "creation_date": 1470779064, "post_id": 38860480, "comment_id": 65085803, "body": "What happens if you don&#39;t include <code>a.a</code> in the compilation of main? Does everything link properly? It looks to me like you&#39;ve got <code>a.a</code> and <code>b.o</code> inside of archive <code>b.a</code>, so will the linker actually find <code>a.o</code> inside of <code>a.a</code> inside of <code>b.a</code>?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1470779152, "post_id": 38860480, "comment_id": 65085834, "body": "Libraries are only searched if needed. Since <code>a</code> has already been imported from <code>a.a</code>, the linker doesn&#39;t bother searching for <code>a</code> in <code>b.a</code>."}, {"owner": {"reputation": 126, "user_id": 6062287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8efa467a2a76237dba36aea604fbc31?s=128&d=identicon&r=PG&f=1", "display_name": "R Jesu", "link": "https://stackoverflow.com/users/6062287/r-jesu"}, "edited": false, "score": 0, "creation_date": 1470876038, "post_id": 38860480, "comment_id": 65131838, "body": "C++ tag dropped. Project in question is written entirely in C++, but I agree it doesn&#39;t seem relevant to the question."}, {"owner": {"reputation": 126, "user_id": 6062287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8efa467a2a76237dba36aea604fbc31?s=128&d=identicon&r=PG&f=1", "display_name": "R Jesu", "link": "https://stackoverflow.com/users/6062287/r-jesu"}, "edited": false, "score": 0, "creation_date": 1470876090, "post_id": 38860480, "comment_id": 65131850, "body": "Not a duplicate of the suggested questions. Functions are defined once, but I&#39;m trying to break the linker with how I include static archives. Linker seems to be robust so it&#39;s more of a question of semantics and practices."}, {"owner": {"reputation": 126, "user_id": 6062287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8efa467a2a76237dba36aea604fbc31?s=128&d=identicon&r=PG&f=1", "display_name": "R Jesu", "link": "https://stackoverflow.com/users/6062287/r-jesu"}, "edited": false, "score": 0, "creation_date": 1470876246, "post_id": 38860480, "comment_id": 65131882, "body": "I think that user3386109&#39;s answer is the answer that I am looking for; it suggests that dynamic naming has taken care of this. I feel like it would be more likely to have duplicate symbol errors than code included twice in the linking stage."}], "answers": [{"comments": [{"owner": {"reputation": 126, "user_id": 6062287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8efa467a2a76237dba36aea604fbc31?s=128&d=identicon&r=PG&f=1", "display_name": "R Jesu", "link": "https://stackoverflow.com/users/6062287/r-jesu"}, "edited": false, "score": 0, "creation_date": 1470872507, "post_id": 38860963, "comment_id": 65131018, "body": "Thank you for your well informed response. I should clarify my &#39;multiple paths&#39; statement by saying that when I link the binary with a.a and b.a, b.a has functions that are also defined in a.a, but the linker has been smart enough in this case to pick one. I&#39;m concerned with cases where it may not."}, {"owner": {"reputation": 126, "user_id": 6062287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8efa467a2a76237dba36aea604fbc31?s=128&d=identicon&r=PG&f=1", "display_name": "R Jesu", "link": "https://stackoverflow.com/users/6062287/r-jesu"}, "edited": false, "score": 0, "creation_date": 1470872604, "post_id": 38860963, "comment_id": 65131038, "body": "I have a common code archive that is included from multiple binaries, and I also have some of the code from one of those binaries pulled into another one. There are two ways of compiling this project. One is monolithic, one is not. That&#39;s the basic idea."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1470779189, "creation_date": 1470779189, "answer_id": 38860963, "question_id": 38860480, "link": "https://stackoverflow.com/questions/38860480/c-linker-and-duplicate-symbols/38860963#38860963", "title": "C linker and duplicate symbols", "body": "<blockquote>\n  <p>My question is: is this behavior circumstantial to my test or is it standard, and can I expect the same behavior from other compilers?</p>\n</blockquote>\n\n<p>As far as the compiler itself is concerned, there is no issue: you have one definition for each function among your sources.</p>\n\n<p>As far as <code>ar</code> is concerned, you also have no issue: neither of the archives you built contains any duplicate symbols.</p>\n\n<p>Different linkers may exhibit different behaviors, however.  It is conceivable that some would reject linking archives that contain duplicate external symbols.  Typical UNIX linkers will handle the situation you present, but they may vary in some details, such as whether a duplicate copy of function <code>a()</code> is included in the binary.</p>\n\n<blockquote>\n  <p>Obviously duplicate code is one problem, however there could be duplicate global references as well. Is it safe/good practice to build a large application that has multiple dependency paths to the same static archive?</p>\n</blockquote>\n\n<p>\"Multiple paths to the same static archive\" does not seem to be a good characterization of the situation you present.  In neither case do you provide the same archive more than once.  Rather, in the <code>b</code> case you provide different archives with duplicate members.  Linkers generally do not have problems with specifying the same archive multiple times in the same link command.  Under some circumstances it may even be necessary to do so; it should not present a problem.</p>\n\n<p>Providing distinct archives with duplicate members <em>probably</em> will not present a problem, except possibly for bloating your code with duplicate function implementations.  This is a bit less certain, but I doubt it would present a problem in practice.</p>\n\n<p>Whether that's good practice is a matter of opinion, but I'm inclined to think not.  It's also not clear to me what gain you seen in such an approach.  On the other hand, I won't be sharpening any stakes or preparing any kindling if you decide to go ahead anyway.</p>\n"}], "owner": {"reputation": 126, "user_id": 6062287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8efa467a2a76237dba36aea604fbc31?s=128&d=identicon&r=PG&f=1", "display_name": "R Jesu", "link": "https://stackoverflow.com/users/6062287/r-jesu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1125, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470872395, "creation_date": 1470776990, "last_edit_date": 1470872395, "question_id": 38860480, "link": "https://stackoverflow.com/questions/38860480/c-linker-and-duplicate-symbols", "title": "C linker and duplicate symbols", "body": "<p>I did an experiment to see what kind of assembly language would be generate if I try to get the same function to compile in there twice. I did the following:</p>\n\n<p>I created two simple test files and their corresponding headers. Let's call them a.c/a.h, and b.c/b.h. Here are the contents of those files:</p>\n\n<p>a.h:</p>\n\n<pre><code>#ifndef __A_H__\n#define __A_H__\n\nint a( void );\n\n#endif\n</code></pre>\n\n<p>b.h:</p>\n\n<pre><code>#ifndef __B_H__\n#define __B_H__\n\nint b( void );\n\n#endif\n</code></pre>\n\n<p>a.c:</p>\n\n<pre><code>#include \"a.h\"\n\nint a( void )\n{\n    return 1;\n}\n</code></pre>\n\n<p>b.c:</p>\n\n<pre><code>#include \"b.h\"\n#include \"a.h\"\n\nint b( void )\n{\n    return 1 + a();\n}\n</code></pre>\n\n<p>I then created a static archive for a:</p>\n\n<pre><code>gcc -c a.c -o a.o\nar -rsc a.a a.o\n</code></pre>\n\n<p>and the same for b, including the static archive for a this time:</p>\n\n<pre><code>gcc -c b.c -o b.o\nar -rsc b.a a.a b.o\n</code></pre>\n\n<p>At this point, I disassemble the static archive for b to verify that it has assembly code for both functions a() and b(). It does.</p>\n\n<p>Now, I define one last file:</p>\n\n<p>main.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#include \"a.h\"\n#include \"b.h\"\n\nint main( void )\n{\n    printf( \"%d %d\\n\", a(), b() );\n\n    return 0;\n}\n</code></pre>\n\n<p>and I compile it thusly:</p>\n\n<pre><code>gcc main.c a.a b.a -o main\n</code></pre>\n\n<p>This works fine. When I disassemble it, I see the following definitions for a and b in the code:</p>\n\n<pre><code>140 0000000000400561 &lt;a&gt;:\n141   400561:   55                      push   %rbp\n142   400562:   48 89 e5                mov    %rsp,%rbp\n143   400565:   b8 01 00 00 00          mov    $0x1,%eax\n144   40056a:   5d                      pop    %rbp\n145   40056b:   c3                      retq\n146 \n147 000000000040056c &lt;b&gt;:\n148   40056c:   55                      push   %rbp\n149   40056d:   48 89 e5                mov    %rsp,%rbp\n150   400570:   e8 ec ff ff ff          callq  400561 &lt;a&gt;\n151   400575:   83 c0 01                add    $0x1,%eax\n152   400578:   5d                      pop    %rbp\n153   400579:   c3                      retq\n154   40057a:   66 0f 1f 44 00 00       nopw   0x0(%rax,%rax,1)\n</code></pre>\n\n<p>As you can see, the code has clearly defined b as calling a rather than inlining it, however, there is only one definition of a in the code, no duplicates.</p>\n\n<p>It seems that gcc has either:</p>\n\n<ol>\n<li>Detected the duplicate object code and removed the duplicates\n--or--</li>\n<li>the b archive was used first, and it included the reference to int a(), so the a archive was ignored.</li>\n</ol>\n\n<p><strong>My question is: is this behavior circumstantial to my test or is it standard, and can I expect the same behavior from other compilers? Obviously duplicate code is one problem, however there could be duplicate global references as well. Is it safe/good practice to build a large application that has multiple dependency paths to the same static archive? Are there less obvious situations than just duplicate symbol names where issues can arise when doing this?</strong></p>\n\n<p>Asking this because I've been playing with this idea for a project I'm on, and want to make the right choices.</p>\n"}, {"tags": ["c", "cyclomatic-complexity"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470778234, "post_id": 38860460, "comment_id": 65085472, "body": "<i>&quot;...however it only gives..&quot;</i>- What is <i>it</i>? A tool you have? Find another tool for evaluating the whole code."}, {"owner": {"reputation": 9, "user_id": 971950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48e15cabddd47b1983c06535fbbb9d69?s=128&d=identicon&r=PG&f=1", "display_name": "yangjeep", "link": "https://stackoverflow.com/users/971950/yangjeep"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1473707311, "post_id": 38860460, "comment_id": 66235402, "body": "<a href=\"https://people.debian.org/~bame/pmccabe/pmccabe.1\" rel=\"nofollow noreferrer\">people.debian.org/~bame/pmccabe/pmccabe.1</a> it does give the number of whole code base, but it just simply add up the numbers...."}], "answers": [{"tags": [], "owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "is_accepted": false, "score": 1, "last_activity_date": 1470781498, "creation_date": 1470781498, "answer_id": 38861396, "question_id": 38860460, "link": "https://stackoverflow.com/questions/38860460/c-code-complexity-metrics-for-the-whole-code-base/38861396#38861396", "title": "C Code complexity metrics for the whole code base", "body": "<p>The McCabe code complexity metric is <em>meant</em> for functions, not whole programs. In simple words: if a function has a McCabe number over a certain limit (vulga: spaghetti code) you should  break it up into several simpler functions.</p>\n\n<p>The actual measure is the number of possible paths. That is relatively easy fro single functions but quite complicated for several functions if they are dependent, that is, if these functions call each other.</p>\n\n<p>So if you have independent functions (e.g.: a library) you can just add them but if they are dependent (e.g.: a full-fledged program) you have to count all possible path trough the whole program. If a node is a function you have to include the McCabe number and if not (e.g.: a simple branch) you can include it as 1 (one) just as in a single function.</p>\n\n<p>So:</p>\n\n<ul>\n<li>independent functions: add them all</li>\n<li>independent functions:\n\n<ul>\n<li>called in a linear way (a single path): add them all</li>\n<li>called in two ways (two linear paths): add functions in each path and add both paths, just like branches in a function</li>\n<li>called in <em>n</em> ways (<em>n</em> linear paths): add functions in each path and add all paths, just like branches in a function</li>\n<li>dependent functions: like above, but because you need to count all possible paths you get into large numbers quite quickly.</li>\n</ul></li>\n</ul>\n\n<p>You can automate it all, of course. OK, you need to write a parser for your language that is able to count all possible paths and if that is worth the money&hellip;I don't know.</p>\n\n<p>And furthermore: you reduce the MacCabe number of a function by splitting a large function into several simpler ones. Now, how do you do it with a full program? Split it into several simpler programs/libraries? Yes, I think that would work, so your idea seems sound.</p>\n\n<p>But it is still a lot of work.</p>\n\n<p>BTW: it might be a pet peeve of me but I don't think that the number of LoCs have a lot to do with complexity. LoCs are a really bad metric for anything but the number of lines of code.</p>\n"}], "owner": {"reputation": 9, "user_id": 971950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48e15cabddd47b1983c06535fbbb9d69?s=128&d=identicon&r=PG&f=1", "display_name": "yangjeep", "link": "https://stackoverflow.com/users/971950/yangjeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "closed_date": 1484954925, "answer_count": 1, "score": 0, "last_activity_date": 1470948145, "creation_date": 1470776908, "question_id": 38860460, "link": "https://stackoverflow.com/questions/38860460/c-code-complexity-metrics-for-the-whole-code-base", "closed_reason": "Needs more focus", "title": "C Code complexity metrics for the whole code base", "body": "<p>I'm using Mccabe code complexity as my metric to evaluate my code base, however it only gives the code complexity score of each individual function. \nThe overall code complexity score is given by the sum of scores of all functions in my code base. \nI'm trying to come up with a normalized metric (taking line-of-code into account) to reflect the trend of our effort in reducing the complexity in the code base over time. (As we know removing/adding functions will change the complexity score, but the complexity doesn't change).\nIs there a standard way to do it? I mean like average complexity kinda thing?</p>\n"}, {"tags": ["c", "gcc", "crt"], "comments": [{"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1470776662, "post_id": 38860373, "comment_id": 65084796, "body": "Do you have a motivation for wanting to reduce the file size, or is this just purely out of curiosity?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470776706, "post_id": 38860373, "comment_id": 65084812, "body": "Take a look <a href=\"http://stackoverflow.com/questions/6687630/how-to-remove-unused-c-c-symbols-with-gcc-and-ld\">here</a>"}, {"owner": {"reputation": 5004, "user_id": 1306666, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7498f59ac88cd1dc347a15f65ad4a713?s=128&d=identicon&r=PG", "display_name": "nebuch", "link": "https://stackoverflow.com/users/1306666/nebuch"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470776758, "post_id": 38860373, "comment_id": 65084836, "body": "@EugeneSh. The symbols in the crt <i>are</i> used, but they don&#39;t do anything useful in my example case."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470776789, "post_id": 38860373, "comment_id": 65084853, "body": "If they don&#39;t do anything useful - they are not used."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470776935, "post_id": 38860373, "comment_id": 65084910, "body": "And you can always compile without the standard startup code <code>-nostartfiles</code>. But then you will have the hassle to replace it."}, {"owner": {"reputation": 5004, "user_id": 1306666, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7498f59ac88cd1dc347a15f65ad4a713?s=128&d=identicon&r=PG", "display_name": "nebuch", "link": "https://stackoverflow.com/users/1306666/nebuch"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470777199, "post_id": 38860373, "comment_id": 65085018, "body": "@EugeneSh. objdump reveals that at startup code to enable gprof profiling does run, but I will never be using gprof with this binary; in this case useless code is used"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1470777480, "post_id": 38860373, "comment_id": 65085165, "body": "If it can&#39;t be removed with the linker as unused, you have no choice but use a different startup code."}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1470777709, "post_id": 38860373, "comment_id": 65085259, "body": "Doesn&#39;t work with <code>gcc-4.8.real (Ubuntu 4.8.5-2ubuntu1~14.04.1) 4.8.5</code> it gives <code>bash: .&#47;foo2: Accessing a corrupted shared library</code> I needed to exchange <code>&#47;lib&#47;i386-linux-gnu&#47;ld-linux.so.2</code> in the linker command with <code>&#47;lib64&#47;ld-linux-x86-64.so.2</code> although the first one links to the second one. Just information if somebody wants to repeat it with an older version."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1618521756, "post_id": 49475709, "comment_id": 118633945, "body": "re: args: <a href=\"https://stackoverflow.com/q/50260855\">How Get arguments value using inline assembly in C without Glibc?</a>"}], "tags": [], "owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "is_accepted": true, "score": 7, "last_activity_date": 1521980721, "last_edit_date": 1521980721, "creation_date": 1521980112, "answer_id": 49475709, "question_id": 38860373, "link": "https://stackoverflow.com/questions/38860373/how-to-avoid-c-runtime-crt-o-garbage/49475709#49475709", "title": "How to avoid C runtime (crt*.o) garbage", "body": "<p>With gcc/clang you can use <code>-nostartfiles</code>, but the c library you are using may depend on its own <code>_start()</code> implementation for dynamic linking.  Since you are on Linux, I would recommend using a static build of musl-libc.</p>\n\n<p>Alternatively you could just implement the <code>write()</code> and <code>exit()</code> systemcalls and add the '\\n' to your string to avoid the c library altogether by using <code>_start()</code> instead of <code>main()</code>.   If you need access to argc, argv and envp, you will need some inline assembly to access the stack (Linux passes these on the stack for all ELF binaries regardless of the architecture).</p>\n"}], "owner": {"reputation": 5004, "user_id": 1306666, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7498f59ac88cd1dc347a15f65ad4a713?s=128&d=identicon&r=PG", "display_name": "nebuch", "link": "https://stackoverflow.com/users/1306666/nebuch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 0, "accepted_answer_id": 49475709, "answer_count": 1, "score": 3, "last_activity_date": 1521980721, "creation_date": 1470776565, "last_edit_date": 1470776668, "question_id": 38860373, "link": "https://stackoverflow.com/questions/38860373/how-to-avoid-c-runtime-crt-o-garbage", "title": "How to avoid C runtime (crt*.o) garbage", "body": "<p>I have two C source files</p>\n\n<p><code>foo1.c</code>:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    puts(\"hello world\");\n    return 0;\n}\n</code></pre>\n\n<p>and <code>foo2.c</code>:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid _start(void)\n{\n    puts(\"hello world\");\n    exit(0);\n}\n</code></pre>\n\n<p>and I compile them like so on my i386 GNU/Linux platform:</p>\n\n<pre><code>$ #compile foo1\n$ cc -o foo1 foo1.c\n$ #compile foo2\n$ cc -S foo2.c\n$ as -o foo2.o foo2.s\n$ ld -o foo2 -dynamic-linker /lib/i386-linux-gnu/ld-linux.so.2 -lc foo2.o\n$ #notice that crt1.o and others are missing\n</code></pre>\n\n<p>The outputted executables do the same thing from a user's perspective.</p>\n\n<pre><code>$ ./foo1\nhello world\n$ ./foo2\nhello world\n</code></pre>\n\n<p>But they are different:</p>\n\n<pre><code>$ wc -c foo1\n5000\n$ wc -c foo2\n2208\n$ objdump -d foo1 | wc -l\n238\n$ objdump -d foo2 | wc -l\n35\n</code></pre>\n\n<p>Even when I enable gcc's <code>-Os</code> option to optimize size,</p>\n\n<pre><code>$ #compile foo1\n$ gcc -o foo1 foo1.c -Os\n</code></pre>\n\n<p>it is not much smaller:</p>\n\n<pre><code>$ wc -c foo1\n4908\n$ objdump -d foo1 | wc -l\n229\n</code></pre>\n\n<p>Is there any way to get GCC to optimize out the parts of <code>crt1.o</code> and friends which I suspect contribute to this bloated filesize without resorting to nonstandard code and weird (and likely harmful in some cases) compilation? My GCC's version string is \"<code>gcc (Debian 4.9.2-10) 4.9.2</code>\".</p>\n"}, {"tags": ["c", "gcc", "map-files"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470775506, "post_id": 38860073, "comment_id": 65084239, "body": "Do you have a specific example?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6296837"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470775647, "post_id": 38860073, "comment_id": 65084325, "body": "What kind of example? I can&#39;t post the binary and map files for various reasons, though I guess I can try to reproduce it in a simple example."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470775683, "post_id": 38860073, "comment_id": 65084343, "body": "That&#39;s what you should do, yes."}], "owner": {"user_type": "does_not_exist", "display_name": "user6296837"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1470775369, "creation_date": 1470775369, "question_id": 38860073, "link": "https://stackoverflow.com/questions/38860073/discrepancy-between-binary-and-map-file", "title": "Discrepancy between binary and map file", "body": "<p>I noticed something peculiar while inspecting a map file produced with the <code>-Map=mapfile</code> option of the GNU linker. It listed a couple of symbols as belonging to the <code>.text</code> section, whereas the binary's symbol table lists them as part of the <code>.rodata</code> section. I suspect that this is some sort of cheeky optimization, as the compiler probably determined that those symbols are only ever read, but what surprises me is that the map file doesn't reflect that. My understanding is the linking is pretty much the final stage of the compilation process and all optimization happens before it. Is that correct? Why were these symbols optimized afterwards?</p>\n\n<p>As you've probably inferred, the toolchain is GCC. The source code is written in C.</p>\n"}, {"tags": ["c", "arrays", "initialization"], "comments": [{"owner": {"reputation": 8388, "user_id": 5890227, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/M6Of5.png?s=128&g=1", "display_name": "Khalil Khalaf", "link": "https://stackoverflow.com/users/5890227/khalil-khalaf"}, "edited": false, "score": 0, "creation_date": 1470775432, "post_id": 38860046, "comment_id": 65084198, "body": "It depends on how do you populate your array. Do you know where the valid indexes upfront?"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 9, "creation_date": 1470775897, "post_id": 38860046, "comment_id": 65084448, "body": "BTW, this is intialization and not assignment. Assignment to arrays is not possible in C and C++."}, {"owner": {"reputation": 697, "user_id": 8667423, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/537e0ba00355c2a7431d571a2917824f?s=128&d=identicon&r=PG&f=1", "display_name": "rimalroshan", "link": "https://stackoverflow.com/users/8667423/rimalroshan"}, "edited": false, "score": 0, "creation_date": 1542087460, "post_id": 38860046, "comment_id": 93431468, "body": "same question but for java can somebody adddress that?"}], "answers": [{"comments": [{"owner": {"reputation": 1329, "user_id": 3657155, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3d10c4c9f89de2e3b98307c4c2b17c7e?s=128&d=identicon&r=PG&f=1", "display_name": "kaetzacoatl", "link": "https://stackoverflow.com/users/3657155/kaetzacoatl"}, "edited": false, "score": 0, "creation_date": 1470775604, "post_id": 38860092, "comment_id": 65084300, "body": "This is exactly what I searched. Thanks a lot!"}, {"owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "reply_to_user": {"reputation": 19910, "user_id": 1621391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ec331963e9d60347c1e80e294b14940c?s=128&d=identicon&r=PG", "display_name": "WhiZTiM", "link": "https://stackoverflow.com/users/1621391/whiztim"}, "edited": false, "score": 2, "creation_date": 1470775621, "post_id": 38860092, "comment_id": 65084312, "body": "@WhiZTiM designated initializers is C not C++"}, {"owner": {"reputation": 1854, "user_id": 6539544, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0075a1be0f17b9ac03dbb0b9b27d5aab?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav Bajaj", "link": "https://stackoverflow.com/users/6539544/vaibhav-bajaj"}, "edited": false, "score": 0, "creation_date": 1470775640, "post_id": 38860092, "comment_id": 65084323, "body": "Could you tell me a variant of that which allows you to initialize all values of an array to a single value."}, {"owner": {"reputation": 8388, "user_id": 5890227, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/M6Of5.png?s=128&g=1", "display_name": "Khalil Khalaf", "link": "https://stackoverflow.com/users/5890227/khalil-khalaf"}, "edited": false, "score": 0, "creation_date": 1470775703, "post_id": 38860092, "comment_id": 65084356, "body": "Nice approach! Can we use unknown values for the indexes? Something like <code>{[i] = 1, [j] = 2, [k] = 3};</code> where <code>i</code>, <code>j</code>, and <code>k</code> are to be assigned on run time?"}, {"owner": {"reputation": 1854, "user_id": 6539544, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0075a1be0f17b9ac03dbb0b9b27d5aab?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav Bajaj", "link": "https://stackoverflow.com/users/6539544/vaibhav-bajaj"}, "edited": false, "score": 0, "creation_date": 1470775728, "post_id": 38860092, "comment_id": 65084367, "body": "Nvm my comment, I will just use <code>fill</code>"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 8388, "user_id": 5890227, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/M6Of5.png?s=128&g=1", "display_name": "Khalil Khalaf", "link": "https://stackoverflow.com/users/5890227/khalil-khalaf"}, "edited": false, "score": 2, "creation_date": 1470775926, "post_id": 38860092, "comment_id": 65084459, "body": "@FirstStep You deal with noncostant array index in initializer. So the answer is no."}, {"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 0, "creation_date": 1470775979, "post_id": 38860092, "comment_id": 65084482, "body": "Interesting to see something supported by C but not C++, given that C++ was supposed to be backwards compatible with C."}, {"owner": {"reputation": 7737, "user_id": 3410396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc26b280cedaa721d90828a80e39706?s=128&d=identicon&r=PG&f=1", "display_name": "Revolver_Ocelot", "link": "https://stackoverflow.com/users/3410396/revolver-ocelot"}, "reply_to_user": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 3, "creation_date": 1470776074, "post_id": 38860092, "comment_id": 65084521, "body": "@ray C++ is not compatible with C. They do have common subset, but even there, there are many differences. Also there are many, many things in C which are not supported in C++. Just look at C11."}, {"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "reply_to_user": {"reputation": 7737, "user_id": 3410396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc26b280cedaa721d90828a80e39706?s=128&d=identicon&r=PG&f=1", "display_name": "Revolver_Ocelot", "link": "https://stackoverflow.com/users/3410396/revolver-ocelot"}, "edited": false, "score": 1, "creation_date": 1470776140, "post_id": 38860092, "comment_id": 65084558, "body": "@Revolver_Ocelot: I said it <i>was</i> supposed to be b/c that&#39;s how it had actually started."}, {"owner": {"reputation": 197, "user_id": 3218299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aed38b33e8a9b121748f34b4d9dfcb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Kennet", "link": "https://stackoverflow.com/users/3218299/kennet"}, "edited": false, "score": 0, "creation_date": 1470776166, "post_id": 38860092, "comment_id": 65084574, "body": "For c++ how about just using int array[12] = {0}; {[8] = 3; [0] = 1; [4] = 2;} I know ist just plain code but is almost identical"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 8388, "user_id": 5890227, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/M6Of5.png?s=128&g=1", "display_name": "Khalil Khalaf", "link": "https://stackoverflow.com/users/5890227/khalil-khalaf"}, "edited": false, "score": 0, "creation_date": 1470776254, "post_id": 38860092, "comment_id": 65084615, "body": "@FirstStep; No. They must be some integer constants."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 197, "user_id": 3218299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aed38b33e8a9b121748f34b4d9dfcb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Kennet", "link": "https://stackoverflow.com/users/3218299/kennet"}, "edited": false, "score": 0, "creation_date": 1470776470, "post_id": 38860092, "comment_id": 65084710, "body": "@Kennet; No. Will not work. Unfortunately there is no equivalent for c designated initializer in c++"}, {"owner": {"reputation": 197, "user_id": 3218299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aed38b33e8a9b121748f34b4d9dfcb1a?s=128&d=identicon&r=PG&f=1", "display_name": "Kennet", "link": "https://stackoverflow.com/users/3218299/kennet"}, "edited": false, "score": 0, "creation_date": 1470776473, "post_id": 38860092, "comment_id": 65084712, "body": "Ups. Yes of cause. That was a bit to fast."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "reply_to_user": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "edited": false, "score": 0, "creation_date": 1470776523, "post_id": 38860092, "comment_id": 65084737, "body": "@Christophe If you are programming C with a compiler that only supports <i>decades</i> old archaic version of the language (C89), then lack of designated initializers is probably least of your headaches... ;-)"}, {"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1470776840, "post_id": 38860092, "comment_id": 65084872, "body": "@hyde sorry I thought it was a c++ question and tried c++14 conformance with an uptodate compiler..."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 8388, "user_id": 5890227, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/M6Of5.png?s=128&g=1", "display_name": "Khalil Khalaf", "link": "https://stackoverflow.com/users/5890227/khalil-khalaf"}, "edited": false, "score": 0, "creation_date": 1470777253, "post_id": 38860092, "comment_id": 65085045, "body": "@FirstStep True constants are only with <code>define</code> so <a href=\"http://ideone.com/DHz9mc\" rel=\"nofollow noreferrer\">This is ok</a> , but <a href=\"http://ideone.com/w0YAbJ\" rel=\"nofollow noreferrer\">This is wrong</a>."}, {"owner": {"reputation": 1775, "user_id": 3715151, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8gMtb.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3715151/daniel"}, "edited": false, "score": 0, "creation_date": 1579262854, "post_id": 38860092, "comment_id": 105716840, "body": "Looks like the black sheep doesn&#39;t support this. \ud83d\ude2c"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 1775, "user_id": 3715151, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8gMtb.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3715151/daniel"}, "edited": false, "score": 0, "creation_date": 1579264656, "post_id": 38860092, "comment_id": 105717693, "body": "@Daniel Didn&#39;t get it?"}, {"owner": {"reputation": 1775, "user_id": 3715151, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8gMtb.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3715151/daniel"}, "edited": false, "score": 0, "creation_date": 1579266597, "post_id": 38860092, "comment_id": 105718616, "body": "@haccks: I meant C++"}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": true, "score": 80, "last_activity_date": 1471617477, "last_edit_date": 1471617477, "creation_date": 1470775439, "answer_id": 38860092, "question_id": 38860046, "link": "https://stackoverflow.com/questions/38860046/how-to-initialize-only-few-elements-of-an-array-with-some-values/38860092#38860092", "title": "How to initialize only few elements of an array with some values?", "body": "<blockquote>\n  <p>Is it possible to skip this values and only assign the values 1, 2 and 3?  </p>\n</blockquote>\n\n<p>In C, Yes. Use designated initializer (added in C99 and not supported in C++).  </p>\n\n<pre><code>int array[12] = {[0] = 1, [4] = 2, [8] = 3};  \n</code></pre>\n\n<p>Above initializer will initialize element <code>0</code>, <code>4</code> and <code>8</code> of array <code>array</code> with values <code>1</code>, <code>2</code> and <code>3</code> respectively. Rest elements will be initialized with <code>0</code>. This will be equivalent to  </p>\n\n<pre><code> int array[12] = {1, 0, 0, 0, 2, 0, 0, 0, 3, 0, 0, 0};   \n</code></pre>\n\n<p>The best part is that the order in which elements are listed doesn't matter. One can also write like  </p>\n\n<pre><code> int array[12] = {[8] = 3, [0] = 1, [4] = 2}; \n</code></pre>\n\n<p>But note that the expression inside <code>[ ]</code> shall be an <em>integer constant expression</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 4, "creation_date": 1470825324, "post_id": 38864539, "comment_id": 65103768, "body": "What is wrong with <code>memset(array, 0, sizeof array);</code> ?"}, {"owner": {"reputation": 28386, "user_id": 5666987, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/guTdN.jpg?s=128&g=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/5666987/ian"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1470836019, "post_id": 38864539, "comment_id": 65111223, "body": "that&#39;s ok actually. using <code>sizeof(data_type) * data_type_size</code> - Just my habit... :)"}], "tags": [], "owner": {"reputation": 28386, "user_id": 5666987, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/guTdN.jpg?s=128&g=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/5666987/ian"}, "is_accepted": false, "score": 6, "last_activity_date": 1470804922, "creation_date": 1470804922, "answer_id": 38864539, "question_id": 38860046, "link": "https://stackoverflow.com/questions/38860046/how-to-initialize-only-few-elements-of-an-array-with-some-values/38864539#38864539", "title": "How to initialize only few elements of an array with some values?", "body": "<p>An alternative way to do it would be to give default value by <code>memset</code> for all elements in the array, and then assign the specific elements:</p>\n\n<pre><code>int array[12];\nmemset(array, 0, sizeof(int) * 12); //if the default value is 0, this may not be needed\narray[0] = 1; array[4] = 2; array[8] = 3;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 13, "last_activity_date": 1470835855, "last_edit_date": 1470835855, "creation_date": 1470821036, "answer_id": 38869257, "question_id": 38860046, "link": "https://stackoverflow.com/questions/38860046/how-to-initialize-only-few-elements-of-an-array-with-some-values/38869257#38869257", "title": "How to initialize only few elements of an array with some values?", "body": "<p>Here is my trivial approach:</p>\n\n<pre><code>int array[12] = {0};\narray[0] = 1; array[4] = 2; array[8] = 3;\n</code></pre>\n\n<p>However, technically speaking, this is not \"initializing\" the array :)</p>\n"}, {"tags": [], "owner": {"reputation": 1775, "user_id": 3715151, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8gMtb.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3715151/daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1579263429, "creation_date": 1579263429, "answer_id": 59787192, "question_id": 38860046, "link": "https://stackoverflow.com/questions/38860046/how-to-initialize-only-few-elements-of-an-array-with-some-values/59787192#59787192", "title": "How to initialize only few elements of an array with some values?", "body": "<h2>Standard C17</h2>\n\n<p>The standard (C17, N2176) has an interesting example in \u00a7 6.7.9(37):</p>\n\n<blockquote>\n  <p><strong>EXAMPLE 13</strong> Space can be \u201callocated\u201d from both ends of an array by using a single designator:</p>\n  \n  <pre><code>int a[MAX] = {\n    1, 3, 5, 7, 9, [MAX-5] = 8, 6, 4, 2, 0\n};\n</code></pre>\n  \n  <p>In the above, if <code>MAX</code> is greater than ten, there will be some\n  zero-valued elements in the middle; if it is less than ten, some of\n  the values provided by the first five initializers will be overridden\n  by the second five.</p>\n</blockquote>\n\n<h2>Example</h2>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define MAX 12\n\nint main(void)\n{\n    // n2176, \u00a7 6.7.9(37)\n    int a[MAX] = {\n        1, 3, 5, 7, 9, [MAX-5] = 8, 6, 4, 2, 0\n    };\n\n    for (size_t i = 0; i &lt; MAX; i++) {\n        printf(\"%d\\n\", a[i]);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<h3>Output:</h3>\n\n<pre><code>1\n3\n5\n7\n9\n0  &lt;-- middle element, defaults to zero\n0  &lt;-- middle element, defaults to zero\n8\n6\n4\n2\n0\n</code></pre>\n"}], "owner": {"reputation": 1329, "user_id": 3657155, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3d10c4c9f89de2e3b98307c4c2b17c7e?s=128&d=identicon&r=PG&f=1", "display_name": "kaetzacoatl", "link": "https://stackoverflow.com/users/3657155/kaetzacoatl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7570, "favorite_count": 11, "accepted_answer_id": 38860092, "answer_count": 4, "score": 45, "last_activity_date": 1579263429, "creation_date": 1470775277, "last_edit_date": 1471627970, "question_id": 38860046, "link": "https://stackoverflow.com/questions/38860046/how-to-initialize-only-few-elements-of-an-array-with-some-values", "title": "How to initialize only few elements of an array with some values?", "body": "<p>This might be a stupid question, but is it possible to assign <strong>some</strong> values to an array instead of all? To clarify what I want:</p>\n\n<p>If I need an array like <code>{1,0,0,0,2,0,0,0,3,0,0,0}</code> I can create it like:</p>\n\n<pre><code>int array[] = {1,0,0,0,2,0,0,0,3,0,0,0};\n</code></pre>\n\n<p>Most values of this array are '0'. Is it possible to skip this values and only assign the values 1, 2 and 3? I think of something like:</p>\n\n<pre><code>int array[12] = {0: 1, 4: 2, 8: 3};\n</code></pre>\n"}, {"tags": ["c", "switch-statement", "long-integer", "lint"], "comments": [{"owner": {"reputation": 6316, "user_id": 3323096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1227f90127f0f7b8678a8c13261f48b4?s=128&d=identicon&r=PG", "display_name": "Vality", "link": "https://stackoverflow.com/users/3323096/vality"}, "edited": false, "score": 0, "creation_date": 1470779598, "post_id": 38860040, "comment_id": 65086027, "body": "I am really confused by this code. Why are you adding those K, M, T, G suffixes to the integer literals? I am not entirely familiar with them. What do they do"}, {"owner": {"reputation": 2405, "user_id": 1874105, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/PHZzq.jpg?s=128&g=1", "display_name": "L Lawliet", "link": "https://stackoverflow.com/users/1874105/l-lawliet"}, "reply_to_user": {"reputation": 6316, "user_id": 3323096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1227f90127f0f7b8678a8c13261f48b4?s=128&d=identicon&r=PG", "display_name": "Vality", "link": "https://stackoverflow.com/users/3323096/vality"}, "edited": false, "score": 0, "creation_date": 1470790214, "post_id": 38860040, "comment_id": 65088832, "body": "@Vality just a quick way to say 1 KiloByte, 1 GigaByte, 1 TeraByte and so on to give an easy to read example where large case value could be justified."}, {"owner": {"reputation": 6316, "user_id": 3323096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1227f90127f0f7b8678a8c13261f48b4?s=128&d=identicon&r=PG", "display_name": "Vality", "link": "https://stackoverflow.com/users/3323096/vality"}, "edited": false, "score": 0, "creation_date": 1470803789, "post_id": 38860040, "comment_id": 65091743, "body": "I have made a go at answering the question as is, however I suggest you take a quick look at <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> . We prefer a minimal example that can actually be built and run, and produces the symptom described. So if possible provide some build-able code and enough info on your tools that we can reproduce your problem. Hopefully if so I might be able to give a more helpful answer."}, {"owner": {"reputation": 2405, "user_id": 1874105, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/PHZzq.jpg?s=128&g=1", "display_name": "L Lawliet", "link": "https://stackoverflow.com/users/1874105/l-lawliet"}, "reply_to_user": {"reputation": 6316, "user_id": 3323096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1227f90127f0f7b8678a8c13261f48b4?s=128&d=identicon&r=PG", "display_name": "Vality", "link": "https://stackoverflow.com/users/3323096/vality"}, "edited": false, "score": 0, "creation_date": 1470862805, "post_id": 38860040, "comment_id": 65127814, "body": "@ValityI appreciate you trying to make it more compilable, but I think a simple switch statement in C was perfectly making the point. This was more of a C standards related question so I don&#39;t see why compiler and all  such information is relevant. I assumed considering how common mega, kilo, giga etc are these days, saying 1M, 1G makes sufficient sense if it&#39;s not a code debugging issue. Also these suffixes generally imply power of 2 by the way."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1470864192, "post_id": 38860040, "comment_id": 65128439, "body": "What is the range of <code>unsigned long</code> on your system? If it&#39;s 32 bits, then <code>1L &lt;&lt; 40</code> has undefined behavior. There are a lot of different lint programs; exactly which one are you using (and what is &quot;UB4&quot;)? The only Google hits I get for &quot;Illegal Argument to Switch: Size Exceeds&quot; are your question and a copy of it on a site that apparently steals content from Stack Overflow."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1470864608, "post_id": 38860040, "comment_id": 65128618, "body": "(I&#39;ve reported the site; see <a href=\"http://meta.stackoverflow.com/q/253906/827263\">meta.stackoverflow.com/q/253906/827263</a>)"}, {"owner": {"reputation": 2405, "user_id": 1874105, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/PHZzq.jpg?s=128&g=1", "display_name": "L Lawliet", "link": "https://stackoverflow.com/users/1874105/l-lawliet"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1470865437, "post_id": 38860040, "comment_id": 65128933, "body": "@KeithThompson Thanks for reporting the site. :) I am on a 64 bit system. UB4 is just alias for 4 byte unsigned int. Lint I am using is custom &#39;splint&#39; build with support for specific aliases. I can&#39;t go in detail of why it&#39;s a custom version and not the splint version that you get from repo but essentially the linting part is identical to splint."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1470870265, "post_id": 38860040, "comment_id": 65130459, "body": "Please post a <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>. Also include in the program some output to verify the size of <code>unsigned long</code>, don&#39;t just assume &quot;oh i&#39;m on a 64bit system, it will be 64bit&quot;"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1470875947, "post_id": 38860040, "comment_id": 65131824, "body": "In 64-bit Windows long is 32 bits. The size of a type and register size have no relation whatsoever"}], "answers": [{"comments": [{"owner": {"reputation": 2405, "user_id": 1874105, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/PHZzq.jpg?s=128&g=1", "display_name": "L Lawliet", "link": "https://stackoverflow.com/users/1874105/l-lawliet"}, "edited": false, "score": 0, "creation_date": 1470863697, "post_id": 38864310, "comment_id": 65128182, "body": "Any link to some C standard docs to back up your claim ? Since it&#39;s compiling fine I know that the C most likely shouldn&#39;t have any issue with it but this can also just gcc going the extra mile. If it&#39;s not officially supported, this can cause issues with other compilers or later on which I want avoid. Apart from that it would also be good to know for future.   Since linux lint enforces the C standards more rigidly, if its complaining, its best to check. Eg. gcc won&#39;t cry about line comment in C code but lint would which are not by C standards. I wanted to know if it was the same case here."}, {"owner": {"reputation": 2405, "user_id": 1874105, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/PHZzq.jpg?s=128&g=1", "display_name": "L Lawliet", "link": "https://stackoverflow.com/users/1874105/l-lawliet"}, "edited": false, "score": 0, "creation_date": 1470863868, "post_id": 38864310, "comment_id": 65128272, "body": "No exceeding the case clause limit is not the problem here. And like I said i am not getting an &#39;Error&#39; from lint or gcc but it&#39;s just a &#39;Warning&#39;"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 2405, "user_id": 1874105, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/PHZzq.jpg?s=128&g=1", "display_name": "L Lawliet", "link": "https://stackoverflow.com/users/1874105/l-lawliet"}, "edited": false, "score": 0, "creation_date": 1470864075, "post_id": 38864310, "comment_id": 65128385, "body": "@Siddharth: <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a>: &quot;The controlling expression of a <b><code>switch</code></b> statement shall have integer type.&quot;. There is no restriction that would forbid using <code>unsigned long</code>."}, {"owner": {"reputation": 2405, "user_id": 1874105, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/PHZzq.jpg?s=128&g=1", "display_name": "L Lawliet", "link": "https://stackoverflow.com/users/1874105/l-lawliet"}, "edited": false, "score": 0, "creation_date": 1470864236, "post_id": 38864310, "comment_id": 65128466, "body": "Also about the MCVE, I mean no disrespect, but I am not sure how much more simple do I need to make a straight forward switch statement switching on an unsigned long variable. Just put in any value even 0 and try to lint the c file. You will hit the warning. It makes sense for debugging or even a little more complex code example but that&#39;s totally not the case here."}, {"owner": {"reputation": 6316, "user_id": 3323096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1227f90127f0f7b8678a8c13261f48b4?s=128&d=identicon&r=PG", "display_name": "Vality", "link": "https://stackoverflow.com/users/3323096/vality"}, "reply_to_user": {"reputation": 2405, "user_id": 1874105, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/PHZzq.jpg?s=128&g=1", "display_name": "L Lawliet", "link": "https://stackoverflow.com/users/1874105/l-lawliet"}, "edited": false, "score": 0, "creation_date": 1470867042, "post_id": 38864310, "comment_id": 65129542, "body": "@Siddharth for an MCVE the problem is not the minimal, but the complete. Your given code does not compile. It is not in a function, there is no main and there is even some illegal syntax. Nobody can run your code as it is. It should be an actual usable C program ideally or at least a function someone can compile."}], "tags": [], "owner": {"reputation": 6316, "user_id": 3323096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1227f90127f0f7b8678a8c13261f48b4?s=128&d=identicon&r=PG", "display_name": "Vality", "link": "https://stackoverflow.com/users/3323096/vality"}, "is_accepted": false, "score": 0, "last_activity_date": 1470803563, "creation_date": 1470803563, "answer_id": 38864310, "question_id": 38860040, "link": "https://stackoverflow.com/questions/38860040/lint-warning-with-unsigned-long-in-switch-statement/38864310#38864310", "title": "lint warning with unsigned long in switch statement", "body": "<p>No, unlike Java, C permits that the control statement of a switch statement be any integer type. This includes <code>int</code>, <code>long</code>, <code>unsigned long</code>, <code>uint32_t</code> and pretty much any other integral type defined in the standard.</p>\n\n<p>Unfortunately your code does not seem to be real working code, and is certainly not a MCVE so I can only speculate on the actual issue at hand. In addition I do not know which linting software or compiler you use so cannot easily look up the error message.</p>\n\n<p>However I suspect that the most likely problem is that the largest of your case labels exceeds the maximum value of the control statement's type. For example if unsigned long is 32 bits on your system your program may have a case label larger than that therefore a warning would be appropriate if this label cannot occur.</p>\n\n<p>Another possibility is that your switch has more labels than the implementation limit for cases in a single switch on your system. An implementation is allowed to set this limit.</p>\n\n<p>I would likely be able to give more helpful info if an actual MCVE was given but as it is my answer is as given.</p>\n\n<p><strong>TLDR: Yes, a switch can use <code>unsigned long</code> or any other integer type</strong></p>\n"}], "owner": {"reputation": 2405, "user_id": 1874105, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/PHZzq.jpg?s=128&g=1", "display_name": "L Lawliet", "link": "https://stackoverflow.com/users/1874105/l-lawliet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1234, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470863954, "creation_date": 1470775248, "last_edit_date": 1495542176, "question_id": 38860040, "link": "https://stackoverflow.com/questions/38860040/lint-warning-with-unsigned-long-in-switch-statement", "title": "lint warning with unsigned long in switch statement", "body": "<p>I have the following C code:</p>\n\n<pre><code>unsigned long val = &lt;my_size&gt;;\n\nswitch(val)\n{\n case (1L&lt;&lt;10): // 1KB\n  // Do something\n  break;\n case 1L&lt;&lt;20:  // 1MB\n  // Do somnething\n  break;\n case (1L&lt;&lt;30): // 1GB\n  // Do something \n  break;\n case (1L&lt;&lt;40): // 1TB\n  // Do something\n  break;\n // Other cases\n default:\n  // Do something\n  break;\n}\n</code></pre>\n\n<p>Now lint is giving me a warning saying<br>\n\"Warning:44 Illegal Argument to Switch: Size Exceeds UB4\"</p>\n\n<p>So is it valid to use switch on a <code>unsigned long</code>?</p>\n\n<p>I don't get any compilation errors but want to make sure my code works properly and there are no funny rollover type stuff going on.</p>\n\n<p>There won't be too many case labels in the switch. </p>\n\n<p>I was reading on this and came across - <a href=\"https://stackoverflow.com/questions/2676210/why-cant-your-switch-statement-data-type-be-long-java\">Why can&#39;t your switch statement data type be long, Java?</a></p>\n\n<p>It looks like switch statement type shouldn't be long in case of Java. Is it true for C as well?</p>\n\n<p>If needed:\n1. I am using linux lint\n2. gcc for compiler\n3. platform is linux 64 bit</p>\n"}, {"tags": ["c", "linux", "gcc", "ada", "gnat"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1470773995, "post_id": 38859676, "comment_id": 65083516, "body": "Show us how you link your code."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 1, "creation_date": 1470774020, "post_id": 38859676, "comment_id": 65083524, "body": "<code>gcc -c</code> does compiling but no linking.  What command are you using to link, where the actual error occurs?"}, {"owner": {"reputation": 105, "user_id": 5921147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de28daa68dc73d0cd8e8e0a2869403b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/5921147/nautilus"}, "edited": false, "score": 0, "creation_date": 1470774153, "post_id": 38859676, "comment_id": 65083589, "body": "The linking is being done by <code>gnatmake</code>. The actual linking part is done using the gnatmake flag <code>-largs</code> that is followed by <code>file_name.o</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470774243, "post_id": 38859676, "comment_id": 65083627, "body": "Update the question to show the actual linking line.  You&#39;ll need to add something to it to make the linker scan the pthread library.  And it appears that the problem is in the <code>gnatmake</code> facility \u2014 it isn&#39;t linking what you need to link.  Suggesting that GCC is at fault seems like it might be misdirecting the blame."}, {"owner": {"reputation": 105, "user_id": 5921147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de28daa68dc73d0cd8e8e0a2869403b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/5921147/nautilus"}, "edited": false, "score": 0, "creation_date": 1470774332, "post_id": 38859676, "comment_id": 65083666, "body": "The actual line is inside of a make file. But, it is roughly <code>gnatmake main.adb -o -largs c_file_name.o</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1470774464, "post_id": 38859676, "comment_id": 65083733, "body": "That is not updating the question: it is adding another comment.  Please edit the question to include the relevant information.  Is <code>gnatmake</code> the Gnat linker process?  If so, you might need to add <code>-lpthread</code> after the <code>c_file_name.o</code> argument.  Or you might need to RTFM on <code>gnatmake</code>.  Does Gnat allow you to mix Ada threads with POSIX threads?"}, {"owner": {"reputation": 105, "user_id": 5921147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de28daa68dc73d0cd8e8e0a2869403b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/5921147/nautilus"}, "edited": false, "score": 0, "creation_date": 1470774820, "post_id": 38859676, "comment_id": 65083886, "body": "Yep I just figured that out, thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 5921147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de28daa68dc73d0cd8e8e0a2869403b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/5921147/nautilus"}, "edited": false, "score": 0, "creation_date": 1470774040, "post_id": 38859716, "comment_id": 65083534, "body": "I did not include my linking code. What I included was just for compiling the stand alone C file. gnatmake is what does the linking."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 105, "user_id": 5921147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de28daa68dc73d0cd8e8e0a2869403b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/5921147/nautilus"}, "edited": false, "score": 1, "creation_date": 1470774099, "post_id": 38859716, "comment_id": 65083569, "body": "@user289882: Great. But, as I said above, that line is irrelevant. There are no problems there. That line does not produce the error you quoted. The error is produced by your <i>linking</i> line. That&#39;s where you are supposed to specify <code>-lpthread</code>. And you haven&#39;t."}, {"owner": {"reputation": 105, "user_id": 5921147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de28daa68dc73d0cd8e8e0a2869403b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/5921147/nautilus"}, "edited": false, "score": 0, "creation_date": 1470774527, "post_id": 38859716, "comment_id": 65083765, "body": "Okay I added it to gnatmake and it worked, thanks. I am new to using ADA so it is more or less a learning experience right now. Thank you!"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 105, "user_id": 5921147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de28daa68dc73d0cd8e8e0a2869403b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/5921147/nautilus"}, "edited": false, "score": 1, "creation_date": 1470776116, "post_id": 38859716, "comment_id": 65084546, "body": "@user289882: One thing to keep in mind: It&#39;s &quot;Ada&quot;, not &quot;ADA&quot;. It&#39;s not an acronym, it&#39;s named after a person."}, {"owner": {"reputation": 105, "user_id": 5921147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de28daa68dc73d0cd8e8e0a2869403b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/5921147/nautilus"}, "edited": false, "score": 0, "creation_date": 1470776430, "post_id": 38859716, "comment_id": 65084694, "body": "I say ADA instead of Ada because of a convention in the company / project that I work on. It is purely out of habit. I know that it is not an acronym."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 4, "last_activity_date": 1470774384, "last_edit_date": 1470774384, "creation_date": 1470773993, "answer_id": 38859716, "question_id": 38859676, "link": "https://stackoverflow.com/questions/38859676/cannot-get-mixed-c-and-ada-program-to-link-with-pthread-library/38859716#38859716", "title": "Cannot get mixed C and Ada program to link with pthread library", "body": "<p>If you are using <code>-c</code> switch, you are not linking your code. You are simply compiling it into object files. There's no point in specifying the libraries at this stage. Your <code>-l</code> parameter is simply ignored - it has no effect and no meaningful purpose when <code>-c</code> is present.</p>\n\n<p>The libraries are supposed to be supplied at the moment of <em>linking</em>,  i.e. at the moment when you combine your object files into the final executable (without <code>-c</code>, of course). You are not showing us that command line. That linking line is exactly where you have to add your <code>-lpthread</code> parameter.</p>\n"}], "owner": {"reputation": 105, "user_id": 5921147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de28daa68dc73d0cd8e8e0a2869403b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilus", "link": "https://stackoverflow.com/users/5921147/nautilus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 38859716, "answer_count": 1, "score": 1, "last_activity_date": 1470774987, "creation_date": 1470773855, "last_edit_date": 1470774987, "question_id": 38859676, "link": "https://stackoverflow.com/questions/38859676/cannot-get-mixed-c-and-ada-program-to-link-with-pthread-library", "title": "Cannot get mixed C and Ada program to link with pthread library", "body": "<p>I am writing a program in C. I am getting the error:</p>\n\n<pre><code>file_name.c:(.text+0x5d): undefined reference to `pthread_create'\n</code></pre>\n\n<p>This specific error comes up when gcc is linking my file_name.o with my main ADA file. </p>\n\n<p>For the actual compilation of the C file, I have tried using both:</p>\n\n<pre><code>gcc -c -pthread file_name.c \n</code></pre>\n\n<p>as well as:</p>\n\n<pre><code>gcc -c file_name.c -lpthread\n</code></pre>\n\n<p>Neither of these seem to work. Any thoughts?</p>\n\n<p><strong>UPDATE:</strong>\nOne thing I did not realize is that when combining C and ADA, the C libraries are included when using <a href=\"https://gcc.gnu.org/onlinedocs/gnat_ugn/Switches-for-gnatmake.html\" rel=\"nofollow\"><code>gnatmake</code></a>.</p>\n\n<p>The problem was solved by using: </p>\n\n<pre><code> gnatmake ada_file.adb -o -largs c_file.o -lpthread\n</code></pre>\n"}, {"tags": ["php", "c", "struct"], "comments": [{"owner": {"reputation": 26033, "user_id": 1047662, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8aXzf.jpg?s=128&g=1", "display_name": "Cyclonecode", "link": "https://stackoverflow.com/users/1047662/cyclonecode"}, "edited": false, "score": 1, "creation_date": 1470773938, "post_id": 38859621, "comment_id": 65083492, "body": "<code>$unpacked = unpack(&#39;15C&#39;, $binary_string);</code>?"}, {"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1470774322, "post_id": 38859621, "comment_id": 65083658, "body": "php doesn&#39;t provide anything like structs. you can&#39;t suck bytes directly into a php memory location and then start treating that memory as a struct, because PHP&#39;s memory internals are nowhere near as simplistic as C&#39;s. you can read in all the binary data you want into a string, but you can&#39;t apply C-style struct-like meaning to that byte sequence."}], "answers": [{"comments": [{"owner": {"reputation": 1317, "user_id": 2472068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad18332b7a20951fed5193b919caf848?s=128&d=identicon&r=PG", "display_name": "Vlad Vladimir Hercules", "link": "https://stackoverflow.com/users/2472068/vlad-vladimir-hercules"}, "edited": false, "score": 0, "creation_date": 1470775245, "post_id": 38859997, "comment_id": 65084106, "body": "the binary file was generated in C using a structure similar to what i have posted in the main question. I need to unpack it in PHP, idea is that user would upload it online."}, {"owner": {"reputation": 26033, "user_id": 1047662, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8aXzf.jpg?s=128&g=1", "display_name": "Cyclonecode", "link": "https://stackoverflow.com/users/1047662/cyclonecode"}, "reply_to_user": {"reputation": 1317, "user_id": 2472068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad18332b7a20951fed5193b919caf848?s=128&d=identicon&r=PG", "display_name": "Vlad Vladimir Hercules", "link": "https://stackoverflow.com/users/2472068/vlad-vladimir-hercules"}, "edited": false, "score": 0, "creation_date": 1470775320, "post_id": 38859997, "comment_id": 65084135, "body": "The above shows how you can unpack it using php. Every third element in the <code>$unpacked</code> array will hold <code>Day</code>, <code>Month</code> and <code>Year</code> for every structure."}, {"owner": {"reputation": 1317, "user_id": 2472068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad18332b7a20951fed5193b919caf848?s=128&d=identicon&r=PG", "display_name": "Vlad Vladimir Hercules", "link": "https://stackoverflow.com/users/2472068/vlad-vladimir-hercules"}, "edited": false, "score": 1, "creation_date": 1470777349, "post_id": 38859997, "comment_id": 65085100, "body": "After looking at your code and at the structure that I have (150+ lines of it) I have noticed that completed binary files has data everywhere and it is seem to me that it is up to me how many should have structure A and which lines should have structure B. I like the way you have an class and put data into it."}, {"owner": {"reputation": 1317, "user_id": 2472068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad18332b7a20951fed5193b919caf848?s=128&d=identicon&r=PG", "display_name": "Vlad Vladimir Hercules", "link": "https://stackoverflow.com/users/2472068/vlad-vladimir-hercules"}, "edited": false, "score": 0, "creation_date": 1478858686, "post_id": 38859997, "comment_id": 68329505, "body": "I have tried using your later code but still not much luck... my file has some line breaks, might be something to do with it? while i was able to decode first few stings i am strugling to decode everything after a line break in the binary file"}, {"owner": {"reputation": 26033, "user_id": 1047662, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8aXzf.jpg?s=128&g=1", "display_name": "Cyclonecode", "link": "https://stackoverflow.com/users/1047662/cyclonecode"}, "reply_to_user": {"reputation": 1317, "user_id": 2472068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad18332b7a20951fed5193b919caf848?s=128&d=identicon&r=PG", "display_name": "Vlad Vladimir Hercules", "link": "https://stackoverflow.com/users/2472068/vlad-vladimir-hercules"}, "edited": false, "score": 0, "creation_date": 1478861842, "post_id": 38859997, "comment_id": 68331389, "body": "@user3402600 - Can you edit your question and add an complete example of your data? Have you also packed your structure so the data does not gets padded? Check out the link about padding and packing that I added above: <a href=\"http://stackoverflow.com/questions/4306186/structure-padding-and-packing\" title=\"structure padding and packing\">stackoverflow.com/questions/4306186/&hellip;</a>"}, {"owner": {"reputation": 1317, "user_id": 2472068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad18332b7a20951fed5193b919caf848?s=128&d=identicon&r=PG", "display_name": "Vlad Vladimir Hercules", "link": "https://stackoverflow.com/users/2472068/vlad-vladimir-hercules"}, "edited": false, "score": 0, "creation_date": 1478865081, "post_id": 38859997, "comment_id": 68333169, "body": "Sure, I will update the question, complete data is 160 lines long, so I will attach a snippet; The binary file is created by someone else and I have no control over it. However, based on the link sent by you I do believe that data is most likely to be padded."}, {"owner": {"reputation": 26033, "user_id": 1047662, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8aXzf.jpg?s=128&g=1", "display_name": "Cyclonecode", "link": "https://stackoverflow.com/users/1047662/cyclonecode"}, "reply_to_user": {"reputation": 1317, "user_id": 2472068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad18332b7a20951fed5193b919caf848?s=128&d=identicon&r=PG", "display_name": "Vlad Vladimir Hercules", "link": "https://stackoverflow.com/users/2472068/vlad-vladimir-hercules"}, "edited": false, "score": 0, "creation_date": 1478866740, "post_id": 38859997, "comment_id": 68334019, "body": "@user3402600 - You can easily see if the file is padded if you know how many entries it should hold. Then you simply compare the filesize against the <code>sizeof(FILE_HEADER_tag) * NUM_ENTRIES</code> - Notice that this structure <b>must</b> be packed. If each entry is padded in the file, you&#39;ll need to figure out how its padded =)"}, {"owner": {"reputation": 26033, "user_id": 1047662, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8aXzf.jpg?s=128&g=1", "display_name": "Cyclonecode", "link": "https://stackoverflow.com/users/1047662/cyclonecode"}, "reply_to_user": {"reputation": 1317, "user_id": 2472068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad18332b7a20951fed5193b919caf848?s=128&d=identicon&r=PG", "display_name": "Vlad Vladimir Hercules", "link": "https://stackoverflow.com/users/2472068/vlad-vladimir-hercules"}, "edited": false, "score": 0, "creation_date": 1478879844, "post_id": 38859997, "comment_id": 68341655, "body": "@user3402600 - Best would if you could give me the binary file so I can check how it&#39;s structured."}, {"owner": {"reputation": 1317, "user_id": 2472068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad18332b7a20951fed5193b919caf848?s=128&d=identicon&r=PG", "display_name": "Vlad Vladimir Hercules", "link": "https://stackoverflow.com/users/2472068/vlad-vladimir-hercules"}, "edited": false, "score": 1, "creation_date": 1479570427, "post_id": 38859997, "comment_id": 68618888, "body": "I&#39;ve managed to get it done. The Issue was with pointers, file had blocks of code; each block had different meaning and had a specific type, type defined the start and the end of the block. So essentially i have grabbed the block from starting point to ending point and decoded the way you have described."}], "tags": [], "owner": {"reputation": 26033, "user_id": 1047662, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8aXzf.jpg?s=128&g=1", "display_name": "Cyclonecode", "link": "https://stackoverflow.com/users/1047662/cyclonecode"}, "is_accepted": true, "score": 5, "last_activity_date": 1470822754, "last_edit_date": 1495535569, "creation_date": 1470775082, "answer_id": 38859997, "question_id": 38859621, "link": "https://stackoverflow.com/questions/38859621/reading-binary-files-in-php/38859997#38859997", "title": "Reading Binary Files in PHP", "body": "<p>I'm not really sure what you are trying to achieve here. If you have a binary file generated from the above c code then you could read and upack its content like this:</p>\n\n<pre><code>// get size of the binary file\n$filesize = filesize('filename.bin');\n// open file for reading in binary mode\n$fp = fopen('filename.bin', 'rb');\n// read the entire file into a binary string\n$binary = fread($fp, $filesize);\n// finally close the file\nfclose($fp);\n\n// unpack the data - notice that we create a format code using 'C%d'\n// that will unpack the size of the file in unsigned chars\n$unpacked = unpack(sprintf('C%d', $filesize), $binary);\n\n// reset array keys\n$unpacked = array_values($unpacked);\n\n// this variable holds the size of *one* structure in the file\n$block_size = 3;\n// figure out the number of blocks in the file\n$block_count = $file_size/$block_size;\n\n// you now should have an array where each element represents a\n// unsigned char from the binary file, so to display Day, Month and Year\nfor ($i = 0, $j = 0; $i &lt; $block_count; $i++, $j+=$block_size) {\n   print 'Day: ' . $unpacked[$j] . '&lt;br /&gt;';\n   print 'Month: ' . $unpacked[$j+1] . '&lt;br /&gt;';\n   print 'Year: ' . $unpacked[$j+2] . '&lt;br /&gt;&lt;br /&gt;';\n}\n</code></pre>\n\n<p>Of course you could also create an object to hold the data:</p>\n\n<pre><code>class DATE_OF_BIRTH {\n  public $Day;\n  public $Month;\n  public $Year;\n\n  public function __construct($Day, $Month, $Year) {\n      $this-&gt;Day = $Day;\n      $this-&gt;Month = $Month;\n      $this-&gt;Year = $Year;\n  }\n}\n\n$Birth = [];\n\nfor ($i = 0, $j = 0; $i &lt; $block_count; $i++, $j+=$block_size) {\n   $Birth[] = new DATE_OF_BIRTH(\n       $unpacked[$j], \n       $unpacked[$j+1], \n       $unpacked[$j+2]\n   );\n}\n</code></pre>\n\n<p>Another approach would be to slice it at each third element:</p>\n\n<pre><code>$Birth = [];    \n\nfor ($i = 0; $i &lt; $block_count; $i++) {\n  // slice one read structure from the array\n  $slice = array_slice($unpacked, $i * $block_size, $block_size);\n\n  // combine the extracted array containing Day, Month and Year\n  // with the appropriate keys\n  $slice = array_combine(array('Day', 'Month', 'Year'), $slice);\n\n  $Birth[] = $slice;\n}\n</code></pre>\n\n<p>You should also be aware that this could become much more complicated depending on what data your structure contains, consider this small c program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n// pack structure members with a 1 byte aligment\nstruct __attribute__((__packed__)) person_t {\n  char name[5];\n  unsigned int age;\n};\n\nstruct person_t persons[2] = {\n  {\n    { \n      'l', 'i', 's', 'a', 0 \n    },\n    16\n  },\n  {\n    { \n       'c', 'o', 'r', 'n', 0 \n    },\n    52\n  }\n};\n\nint main(int argc, char** argv) {\n  FILE* fp = fopen(\"binary.bin\", \"wb\");\n  fwrite(persons, sizeof(persons), 1, fp);\n  fclose(fp);\n  return 0;\n}\n</code></pre>\n\n<p>The above will write each packed structure into the file <code>binary.bin</code>, the size will be exactly 18 bytes. To get a better grasp on alignment/packing you can check out this so post: <a href=\"https://stackoverflow.com/questions/4306186/structure-padding-and-packing\">Structure padding and packing</a></p>\n\n<p>Then in you php code you could read each block in a loop like so:</p>\n\n<pre><code>$filesize = filesize(\"binary.bin\");\n$fp = fopen(\"binary.bin\", \"rb\");\n$binary = fread($fp, $filesize);\nfclose($fp);\n\n// this variable holds the size of *one* structure\n$block_size = 9;\n$num_blocks = $filesize/$block_size;\n\n// extract each block in a loop from the binary string\nfor ($i = 0, $offset = 0; $i &lt; $num_blocks; $i++, $offset += $block_size) {\n   $unpacked_block = unpack(\"C5char/Iint\", substr($binary, $offset));\n   $unpacked_block = array_values($unpacked_block);\n\n   // walk over the 'name' part and get the ascii value\n   array_walk($unpacked_block, function(&amp;$item, $key) {\n      if($key &lt; 5) {\n        $item = chr($item);\n      }\n   });\n   $name = implode('', array_slice($unpacked_block, 0, 5));\n   $age = implode('', array_slice($unpacked_block, 5, 1));\n   print 'name: ' . $name . '&lt;br /&gt;';\n   print 'age: ' . $age . '&lt;br /&gt;';\n}\n</code></pre>\n"}], "owner": {"reputation": 1317, "user_id": 2472068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad18332b7a20951fed5193b919caf848?s=128&d=identicon&r=PG", "display_name": "Vlad Vladimir Hercules", "link": "https://stackoverflow.com/users/2472068/vlad-vladimir-hercules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15193, "favorite_count": 3, "accepted_answer_id": 38859997, "answer_count": 1, "score": 4, "last_activity_date": 1478865752, "creation_date": 1470773620, "last_edit_date": 1478865752, "question_id": 38859621, "link": "https://stackoverflow.com/questions/38859621/reading-binary-files-in-php", "title": "Reading Binary Files in PHP", "body": "<p>Is there any comprehensive information on how binary files can be read? I found information on the PHP website (<a href=\"http://www.php.net/manual/en/function.pack.php\" rel=\"nofollow noreferrer\">http://www.php.net/manual/en/function.pack.php</a>) but I am struggling to understand on how to handle \"typedef struct\" and struct uses.</p>\n\n<p>I have a long binary file with many blocks, each block can be represented us C struct. This C struct has various \"typedef struct\" similar to what i have come up with below:</p>\n\n<pre><code>typedef struct\n{ \n unsigned char Day;\n unsigned char Month;\n unsigned char Year;\n} DATE_OF_BIRTH;\n#define USER_TYPE 5\nDATE_OF_BIRTH Birth[2];\\\n</code></pre>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>I have a structure below, this is a part of a bigger structure</p>\n\n<pre><code>typedef struct FILE_HEADER_tag\n{\n    int Type;\n    int Version;\n    unsigned long Model;\n    unsigned long Number;\n    int Class;\n\n    int TemplateLoaded;\n    char TemplateName[32];\n    RTC_TIME_DATE StartTime;\n    RTC_TIME_DATE CurrentCal;\n    RTC_TIME_DATE OriginalCal;\n    TEMPLATE_SETTINGS;\n    int EndType;\n} FILE_HEADER;\n\ntypedef struct\n{\n unsigned char Second;\n unsigned char Minute;\n unsigned char Hour;\n unsigned char Day;\n unsigned char Month;\n unsigned char Year;\n} RTC_TIME_DATE;\n</code></pre>\n\n<p>The binary file is full of line breaks and I was able to decode the first line of it, which returned correct: type, version, model, number and a class. I think I have also decoded two next variable, but i am not sure of it because StartTime returns some gibberish.</p>\n\n<p>At the moment I am looping through the lines from the binary file and trying to unpack each one:</p>\n\n<pre><code>$i = 1;\nwhile (($line = fgets($handle)) !== false) {\n    // process the line read.\n    var_dump($line);\n    if($i == 1) {\n        $unpacked = unpack('iType/iVersion/LModel/LNumber/iClass/iTemplateLoaded', $line );\n    }if($i == 2) {\n        $i++;\n        continue;\n    }if($i == 3) { \n        $unpacked = unpack('C32TemplateName/CStartTime[Second]/CStartTime[Minute]/CStartTime[Hour]/CStartTime[Day]/CStartTime[Month]/CStartTime[Year]', $line);\n    }\n\n    print \"&lt;pre&gt;\";\n    var_dump($unpacked);\n    print \"&lt;/pre&gt;\";\n\n    $i++;\n\n    if($i == 4) { exit; }\n}\n</code></pre>\n"}, {"tags": ["c", "for-loop", "struct", "bubble-sort"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1470773717, "post_id": 38859310, "comment_id": 65083391, "body": "First of all, follow the specification \u2013 &quot;a name with exactly 3 letters&quot; and <code>char name[10];</code> don&#39;t agree."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470775577, "post_id": 38859310, "comment_id": 65084282, "body": "Note that (a) <code>%c</code> reads a single character (<code>%3c</code> would read three), (b) there&#39;s a type mismatch in the <code>printf()</code> with <code>%c</code> expecting a <code>char</code> and <code>books[i].name</code> passing a <code>char *</code>.  You need to be careful printing; you don&#39;t have a null terminated string.  I suppose <code>%3c</code> should do the job on output too \u2014 but check the manual (e.g. <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/printf.html\" rel=\"nofollow noreferrer\"><code>printf()</code></a>) very carefully.  I&#39;d have to double check; I&#39;ve not used that notation this millennium.  When scanning, you probably want a space before the <code>%3c</code> because <code>%3c</code> doesn&#39;t skip it."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1470775663, "post_id": 38859310, "comment_id": 65084331, "body": "Your swap algorithm <code>books[j].price = tmp;             books[j].price = books.price[j+1];             books.price[j+1] = tmp;</code> should assign to <code>tmp</code> first: <code>tmp = books[j].price;</code> rather than vice versa."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1470775812, "post_id": 38859310, "comment_id": 65084402, "body": "You should check each <code>scanf()</code> operation to ensure you are successful."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6687971, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9q_c8jabU0s/AAAAAAAAAAI/AAAAAAAAB5c/o_QTDaCK0Aw/photo.jpg?sz=128", "display_name": "Manik Sharma", "link": "https://stackoverflow.com/users/6687971/manik-sharma"}, "edited": false, "score": 0, "creation_date": 1470775487, "post_id": 38859393, "comment_id": 65084229, "body": "I don&#39;t really understand. Can you write the function with the bubble sort?"}, {"owner": {"reputation": 2133, "user_id": 5447208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f8eb976d91e3b7bb21366a68d1a70f?s=128&d=identicon&r=PG&f=1", "display_name": "Cody", "link": "https://stackoverflow.com/users/5447208/cody"}, "reply_to_user": {"reputation": 3, "user_id": 6687971, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9q_c8jabU0s/AAAAAAAAAAI/AAAAAAAAB5c/o_QTDaCK0Aw/photo.jpg?sz=128", "display_name": "Manik Sharma", "link": "https://stackoverflow.com/users/6687971/manik-sharma"}, "edited": false, "score": 0, "creation_date": 1470776210, "post_id": 38859393, "comment_id": 65084594, "body": "It looked like you were doing a homework assignment so I didn&#39;t want to give you the whole thing.  I&#39;ll expand this answer to show you how to pass an array in."}], "tags": [], "owner": {"reputation": 2133, "user_id": 5447208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f8eb976d91e3b7bb21366a68d1a70f?s=128&d=identicon&r=PG&f=1", "display_name": "Cody", "link": "https://stackoverflow.com/users/5447208/cody"}, "is_accepted": false, "score": 2, "last_activity_date": 1470777353, "last_edit_date": 1470777353, "creation_date": 1470772630, "answer_id": 38859393, "question_id": 38859310, "link": "https://stackoverflow.com/questions/38859310/passing-structures-to-functions-in-c/38859393#38859393", "title": "Passing structures to functions in C", "body": "<p>So you have your struct</p>\n\n<pre><code>struct Book{\n   char name[10];\n   int pagec;\n   int price;\n};\n</code></pre>\n\n<p>You can pass it in by passing in a pointer to it using the \"address of\" operator</p>\n\n<pre><code>void receivingFunction(Book* myBook)\n{\n   printf(\"%s\", myBook-&gt;name);\n}\n\nvoid sendingFunction()\n{\n   Book myBook;\n   //set values in myBook\n   receivingFunction(&amp;myBook);\n}\n</code></pre>\n\n<p>Notice that when you are working with the pointer to book, you access members using the <code>-&gt;</code> operator, not the <code>.</code> operator.</p>\n\n<p>Now that example above is just for passing in a single instance.  What if you want to pass in an array?  It'll look something like this.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nstruct Book{\n   char name[4]; //other answers explain well why I changed this to 4\n   int pagec;\n   int price;\n};\n\nvoid BookSorter(struct Book books[10], int booksLength)\n{\n    int i;\n    for(i = 0; i &lt; booksLength; i++)\n    {\n       printf(\"%s %d %d\\n\",  books[i].name, books[i].pagec, books[i].price);\n    }\n}\n\nint main(void)\n{\n  Book books[10];\n  //define your values for books here\n  //mine are junk values since this is just an example\n  for(int i = 0; i &lt; 10; i++)\n  {\n      strncpy(books[i].name, \"aaa\", 4);\n      books[i].pagec = 4;\n      books[i].price = 10;\n  }\n  //\n  BookSorter(books, 10);\n}\n</code></pre>\n\n<p>From here you can modify your bubble sort to iterate through your array instances and swap them.  I'm not going to include that part because 1) it is beyond the scope of your original question about passing structs and 2) it really looks like you're doing homework and I don't want to give you all of it.  The comments below your question address ways to fix your bubble sort, one I haven't seen yet is that you're just swapping the prices of the books, not the books themselves.  Your temp variable should be a <code>struct Book</code>, not an <code>int</code>.  Your swapping just swaps the prices of the books, which will lead to them being assigned to the wrong book for the final printing out of the answer, with the books and page counts being left in the same order they were read in.  It looks like you used this example code (or maybe one of a million like it), but here it is if you need a <a href=\"http://www.programmingsimplified.com/c/source-code/c-program-bubble-sort\" rel=\"nofollow\">reference for implementing bubble sort</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 2, "last_activity_date": 1470773869, "creation_date": 1470773869, "answer_id": 38859682, "question_id": 38859310, "link": "https://stackoverflow.com/questions/38859310/passing-structures-to-functions-in-c/38859682#38859682", "title": "Passing structures to functions in C", "body": "<p><code>books[n]</code> is <em>one</em> <code>struct Book</code> (or would be, if the array had <code>n+1</code> elements).</p>\n\n<p>The name of the array is just <code>books</code>, and this is what you should pass to the function:</p>\n\n<pre><code>price(n, books);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1470776420, "post_id": 38860206, "comment_id": 65084687, "body": "That was just c&amp;p (and correction of the wrong first line of the swap). And I tested with only three books. Oopsie! Thanks! Do you know when I did a bubble-sort the last time? I think it is quite a bit more than one decade ago ;-)"}, {"owner": {"reputation": 2133, "user_id": 5447208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f8eb976d91e3b7bb21366a68d1a70f?s=128&d=identicon&r=PG&f=1", "display_name": "Cody", "link": "https://stackoverflow.com/users/5447208/cody"}, "edited": false, "score": 0, "creation_date": 1470777492, "post_id": 38860206, "comment_id": 65085168, "body": "While I would generally agree with this answer, it appears to me that the OP is new to C so I tried to work around using <code>malloc</code> and lots of pointers for mine."}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "reply_to_user": {"reputation": 2133, "user_id": 5447208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f8eb976d91e3b7bb21366a68d1a70f?s=128&d=identicon&r=PG&f=1", "display_name": "Cody", "link": "https://stackoverflow.com/users/5447208/cody"}, "edited": false, "score": 0, "creation_date": 1470779062, "post_id": 38860206, "comment_id": 65085802, "body": "The assignment says nothing about a fixed number of books. You can do it without <code>malloc</code> but things like <code>struct books_t = books[n];</code> does not work with every compiler, especially not with every online-compilers. It is C, for Dennis&#39;s sake! You are supposed to be well versed with the use of pointers! And I think it is simpler with pointers."}, {"owner": {"reputation": 2133, "user_id": 5447208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f8eb976d91e3b7bb21366a68d1a70f?s=128&d=identicon&r=PG&f=1", "display_name": "Cody", "link": "https://stackoverflow.com/users/5447208/cody"}, "edited": false, "score": 0, "creation_date": 1470783118, "post_id": 38860206, "comment_id": 65087153, "body": "I agree with all of that, but given the time of year and difficulty of the problem, I&#39;m guessing the OP just started an intro to C course.  Over complicating it at this stage of learning isn&#39;t helpful."}], "tags": [], "owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "is_accepted": true, "score": 2, "last_activity_date": 1470776407, "last_edit_date": 1470776407, "creation_date": 1470775896, "answer_id": 38860206, "question_id": 38859310, "link": "https://stackoverflow.com/questions/38859310/passing-structures-to-functions-in-c/38860206#38860206", "title": "Passing structures to functions in C", "body": "<p>The part of your question about how to pass a <code>struct</code> seems to have been well answered, let me get on the second part: how I would tackle that question.</p>\n\n<p>What the struct should be is described well, so we can write without much thinking:</p>\n\n<pre><code>/*\n    Define a struct named: Book.\n    Each book should have a name with exactly 3 letters (abbreviation).\n    Each book should also have a page count (integer), \n    and a price (integer). \n*/\ntypedef struct book {\n  // three characters plus '\\0'\n  char name[4];\n  int pagec;\n  int price;\n} book_t;\n</code></pre>\n\n<p>(No need for a <code>typedef</code> you can leave that part out and use the struct directly with <code>struct books</code>)</p>\n\n<p>They want three functions, one is <code>main()</code> we can use it as one of the three. I think getting the info, allocating the memory etc. is a good use of the <code>main()</code> function here.</p>\n\n<pre><code>/*\n    Write a program which \n\n        reads an integer n first, \n        then reads the names, \n        page counts \n        and prices of n books.\n*/\nint main()\n{\n  int n, i;\n  book_t **books;\n\n  puts(\"How many books?\");\n  scanf(\"%d\", &amp;n);\n\n  // we need enough memory to safe \"n\" structs\n  // at first allocate memory for n pointers\n  books = malloc(n * sizeof(book_t *));\n  // at each pointer allocate enough memory for one struct books\n  for (i = 0; i &lt; n; i++) {\n    books[i] = malloc(sizeof(book_t));\n  }\n  // red the info from stdin\n  for (i = 0; i &lt; n; i++) {\n    printf(\"Name of book (3 letter abbrev.):\");\n    scanf(\"%3s\", books[i]-&gt;name);\n    printf(\"Number of pages:\");\n    scanf(\"%d\", &amp;books[i]-&gt;pagec);\n    printf(\"Price of book (incl. taxes):\");\n    scanf(\"%d\", &amp;books[i]-&gt;price);\n  }\n  // call function to sort them\n  sort_books(books, n);\n  // call a function to print the sorted list\n  print_books(books, n);\n  // we don't need the memory anymore, so free it\n  // at first free the individual structs\n  for (i = 0; i &lt; n; i++) {\n    free(books[i]);\n  }\n  // then free the memory holding all of the pointers\n  free(books);\n\n  exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>The two functions for printing and sorting are similar in argument handling</p>\n\n<pre><code>/*\n    Write a function which takes an array of books,\n    and sorts them according to their prices.\n\n   Doesn't say something about output, so sort in situ\n*/\nvoid sort_books(book_t ** books, int length)\n{\n  // OP had bubble sort, so lets do a bubble sort. Why not?\n  int i, j;\n  book_t *tmp;\n  for (i = 0; i &lt; length - 1; i++) {\n    for (j = 0; j &lt; length -i - 1; j++) {\n      if (books[j]-&gt;price &lt; books[j + 1]-&gt;price) {\n        tmp = books[j];\n        books[j] = books[j + 1];\n        books[j + 1] = tmp;\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>Printing them all is quite straightforward</p>\n\n<pre><code>/*\n   Using that function, your program should \n       print the names and page counts of each book with the order of their prices. \n*/\nvoid print_books(book_t ** books, int length)\n{\n  int i;\n  for (i = 0; i &lt; length; i++) {\n    printf(\"Name %s, pages %d, price %d\\n\",\n       books[i]-&gt;name, books[i]-&gt;pagec, books[i]-&gt;price);\n  }\n}\n</code></pre>\n\n<p>It doesn't say anything about the exact order, I took the liberty to use a descending order (from highest to lowest).  If you want an ascending order (from lowest to highest) change the comparing in the sorting algorithm:</p>\n\n<pre><code>void sort_books(book_t ** books, int length)\n{\n  // OP had bubble sort, so lets do a bubble sort\n  int i, j;\n  book_t *tmp;\n  for (i = 0; i &lt; length - 1; i++) {\n    for (j = 0; j &lt; length - i - 1; j++) {\n      // if (books[j]-&gt;price &lt; books[j + 1]-&gt;price) {\n      if (books[j]-&gt;price &gt; books[j + 1]-&gt;price) {\n         tmp = books[j];\n         books[j] = books[j + 1];\n         books[j + 1] = tmp;\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>Please be aware that I omitted <strong>all</strong> checks! You need to check the returns of <code>malloc()</code> and <code>scanf()</code>, if <code>n</code> is an integer, if all of the other numbers are numbers and so on!</p>\n"}], "owner": {"reputation": 3, "user_id": 6687971, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9q_c8jabU0s/AAAAAAAAAAI/AAAAAAAAB5c/o_QTDaCK0Aw/photo.jpg?sz=128", "display_name": "Manik Sharma", "link": "https://stackoverflow.com/users/6687971/manik-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 630, "favorite_count": 0, "accepted_answer_id": 38860206, "answer_count": 3, "score": 0, "last_activity_date": 1582268302, "creation_date": 1470772317, "last_edit_date": 1582268302, "question_id": 38859310, "link": "https://stackoverflow.com/questions/38859310/passing-structures-to-functions-in-c", "title": "Passing structures to functions in C", "body": "<blockquote>\n  <p>Define a struct named <code>Book</code>. Each book should have a name with\n  exactly 3 letters (abbreviation). Each book should also have a page\n  count (integer), and a price (integer). </p>\n  \n  <p>Write a program which reads an integer <code>n</code> first, then reads the\n  <code>names</code>, <code>page counts</code> and <code>prices</code> of <code>n</code> books. </p>\n  \n  <p>Write a function which takes an array of books, and sorts them\n  according to their prices. Using that function, your program should\n  print the names and page counts of each book with the order of their\n  prices.</p>\n</blockquote>\n\n<h2>My Question</h2>\n\n<p>Can someone explain to me how to pass a structure into a function and get this code to work? Or how they would go tackle this question.</p>\n\n<pre><code>struct Book{\nchar name[3];\nint pagec;\nint price;\n};\n\n\nvoid price(int size, struct Book books[size]){\nint i,j, tmp;\nfor(i=0; i&lt;size; i++){\n    for(j=0; j&lt;size-1; j++){\n        if(books[j].price &lt; books[j+1].price){\n            books[j].price = tmp;\n            books[j].price = books.price[j+1];\n            books.price[j+1] = tmp;\n         }\n      }\n   }\n}\n\nint main(void) {\nint n;\nscanf(\"%d\", &amp;n);\nstruct Book books[n];\nint i,j;\nfor(i=0; i&lt;n; i++){\n    for(j=0; i&lt;1; j++){\n    scanf(\"%c\", &amp;books[i].name);\n    scanf(\"%d\", &amp;books[i].pagec);\n    scanf(\"%d\", &amp;books[i].price);\n    }\n   }\n\nprice(n, books[n]);\nfor(i=0; i&lt;n; i++){\n    printf(\"%c: %d - %d\",books[i].name, books[i].pagec, books[i].price);\n}\n</code></pre>\n"}, {"tags": ["c", "timer", "embed", "embedded-linux"], "comments": [{"owner": {"reputation": 86, "user_id": 6517623, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIxwo.png?s=128&g=1", "display_name": "Hedron", "link": "https://stackoverflow.com/users/6517623/hedron"}, "edited": false, "score": 0, "creation_date": 1470772227, "post_id": 38859193, "comment_id": 65082708, "body": "This might be a duplicate of <a href=\"http://stackoverflow.com/questions/3673226/how-to-print-time-in-format-2009-08-10-181754-811\">this</a>"}, {"owner": {"reputation": 487, "user_id": 5765649, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1bc924d8741fe6c132d2dea0e7eedc23?s=128&d=identicon&r=PG&f=1", "display_name": "singa1994", "link": "https://stackoverflow.com/users/5765649/singa1994"}, "reply_to_user": {"reputation": 86, "user_id": 6517623, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIxwo.png?s=128&g=1", "display_name": "Hedron", "link": "https://stackoverflow.com/users/6517623/hedron"}, "edited": false, "score": 0, "creation_date": 1470773614, "post_id": 38859193, "comment_id": 65083330, "body": "It is . But i dont know if this format will be working in RTOS like QNX . Because i dont have experince in the past with embedded systems."}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1470777932, "post_id": 38859193, "comment_id": 65085346, "body": "<i>&quot;Is it safe to use ...&quot;</i> -- Clarify what you mean by <i>&quot;safe&quot;</i>."}, {"owner": {"reputation": 487, "user_id": 5765649, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1bc924d8741fe6c132d2dea0e7eedc23?s=128&d=identicon&r=PG&f=1", "display_name": "singa1994", "link": "https://stackoverflow.com/users/5765649/singa1994"}, "reply_to_user": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1470778548, "post_id": 38859193, "comment_id": 65085605, "body": "@sawdust I want to implement this Timer/Clock in C in an EMPTY Virtual Machine ,running a simple RTOS.Would this give me a good an accurate result?"}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1470780573, "post_id": 38859193, "comment_id": 65086388, "body": "No.  A delay of unknown accuracy and the precision no better than the time unit you&#39;re tracking in a scheduled thread (of unknown priority) is not able to maintain any decent level of accuracy."}, {"owner": {"reputation": 487, "user_id": 5765649, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1bc924d8741fe6c132d2dea0e7eedc23?s=128&d=identicon&r=PG&f=1", "display_name": "singa1994", "link": "https://stackoverflow.com/users/5765649/singa1994"}, "edited": false, "score": 0, "creation_date": 1470781300, "post_id": 38859193, "comment_id": 65086640, "body": "Can you recommend me something so that i can have a normally accurate result?"}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1470805565, "post_id": 38859193, "comment_id": 65092369, "body": "See <a href=\"http://www.2net.co.uk/tutorial/periodic_threads\" rel=\"nofollow noreferrer\">periodic tasks in Linux</a>"}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1470805902, "post_id": 38859193, "comment_id": 65092492, "body": "And build your Linux kernel with high-resolution timer support and kernel preemption."}], "answers": [{"comments": [{"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 1, "creation_date": 1470778173, "post_id": 38859245, "comment_id": 65085446, "body": "The Linux man page for sleep states the argument is for number of seconds.  And the question is tagged <code>embedded-linux</code>.  So your first paragraph (or half of your answer) raises an irrelevant point."}], "tags": [], "owner": {"reputation": 80, "user_id": 3397008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82872eaa81d21541b9c1b32f48face0c?s=128&d=identicon&r=PG&f=1", "display_name": "user3397008", "link": "https://stackoverflow.com/users/3397008/user3397008"}, "is_accepted": true, "score": 1, "last_activity_date": 1470772044, "creation_date": 1470772044, "answer_id": 38859245, "question_id": 38859193, "link": "https://stackoverflow.com/questions/38859193/embedded-programming-implementation-of-real-time-clock-c-programming/38859245#38859245", "title": "Embedded programming. Implementation of real time clock .C programming", "body": "<p>You will have to check whether in your particular embedded system, sleep(1) will sleep the system for 1 second. In many of the embedded boards I have used, sleep takes the argument in milliseconds. So for 1 second sleep you would have to use sleep(1000). </p>\n\n<p>If you are not too worried about accuracy then yes you can use this method. however, this will not be as accurate as you using a timer or an RTC. so for example if you want your system to do something when seconds reaches 30, a better way might be to setup a timer or an RTC alarm (based on what your embedded platform has) to more accurately measure out that time. </p>\n"}], "owner": {"reputation": 487, "user_id": 5765649, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1bc924d8741fe6c132d2dea0e7eedc23?s=128&d=identicon&r=PG&f=1", "display_name": "singa1994", "link": "https://stackoverflow.com/users/5765649/singa1994"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1194, "favorite_count": 0, "accepted_answer_id": 38859245, "answer_count": 1, "score": 0, "last_activity_date": 1470772075, "creation_date": 1470771860, "last_edit_date": 1470772075, "question_id": 38859193, "link": "https://stackoverflow.com/questions/38859193/embedded-programming-implementation-of-real-time-clock-c-programming", "title": "Embedded programming. Implementation of real time clock .C programming", "body": "<p>I want to implement a real time clock and timer , that prints on screen current time like this. : \" HOURS:MINUTES:SECONDS \"</p>\n\n<p>Is it safe to use :</p>\n\n<pre><code>      While(1){\n      .....Do sth\n      sleep(1);\n      .....Do sth\n      }\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>     seconds+=1;\n</code></pre>\n\n<p>For measure of one second pass?</p>\n"}, {"tags": ["c", "memory"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1470773182, "post_id": 38859176, "comment_id": 65083133, "body": "I&#39;m not sure, but I&#39;d guess that the &#39;sanity word&#39; (a magic number) gives you reassurance that the data is of the type you expect (and the hash tells you it has the correct content).  If you have just the hash (CRC) of the data, you know whether it has been changed, but you don&#39;t know whether it is of the type you expect except that the hash matches the data.  Unless you&#39;re short of space \u2014 really need the extra 4 bytes for something else (which cannot be ruled out in environments where EEPROMs are most often used) \u2014 then it is probably safest to stay with both the sanity word and the hash."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 1, "creation_date": 1470779046, "post_id": 38859176, "comment_id": 65085797, "body": "In addition to everything Jonathan Leffler said, suppose you had two different devices that took ROMs.  Having an easy way for the device to check that the right kind of ROM is installed by just looking at the first few bytes could be an advantage to computing a CRC or other digest for the entire ROM, especially if the devices have different addressable ranges."}], "owner": {"reputation": 771, "user_id": 2533386, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ak4D6.jpg?s=128&g=1", "display_name": "ryeager", "link": "https://stackoverflow.com/users/2533386/ryeager"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1470771787, "creation_date": 1470771787, "question_id": 38859176, "link": "https://stackoverflow.com/questions/38859176/what-is-the-purpose-of-a-memory-sanity-word", "title": "What is the purpose of a memory Sanity Word?", "body": "<p>I have always seen non volatile memory (such as an EEPROM) tagged at the front with a \"Sanity\" word (first word is set to a special chosen number).  I understand that this can help identify if the data in that NVM is \"valid\" or not, but I have also seen it used in addition to a CRC of the data.  </p>\n\n<p>What is the general purpose of a sanity word (if different from above), and is there any reason to use a sanity word in addition to a CRC/hash?</p>\n"}, {"tags": ["c", "pebble-watch", "pebble-sdk"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470769783, "post_id": 38858594, "comment_id": 65081339, "body": "Why the second snipped is failing, again? It is the correct way to do things. The only thing, that I don&#39;t see a point of passing a pointer to <code>time</code> instead of just it&#39;s value. And.. the formatting. Don&#39;t save on newlines."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1470770061, "post_id": 38858594, "comment_id": 65081509, "body": "You cannot directly pass an array as a function argument. The usual way to pass an array indirectly is to pass two arguments: the address of the 0th element, and the length of the array. (In some cases, you can omit the size argument if the size can be determined from the contents of the array; for example the end of a string is indicated by the <code>&#39;\\0&#39;</code> null character.) I&#39;m not sure why you&#39;d need a pointer to a pointer. I note that you haven&#39;t shown us the definition of the array object you want to pass."}, {"owner": {"reputation": 301, "user_id": 2125456, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/372ba3a1f71c9de56ea9262ad13b1565?s=128&d=identicon&r=PG", "display_name": "kjl", "link": "https://stackoverflow.com/users/2125456/kjl"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1470770702, "post_id": 38858594, "comment_id": 65081842, "body": "@KeithThompson I&#39;m looking for way that will work without a character indicating the end of the array."}, {"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "edited": false, "score": 0, "creation_date": 1470771280, "post_id": 38858594, "comment_id": 65082156, "body": "Remember that <a href=\"http://stackoverflow.com/questions/4305673/does-c-have-references\">C does <i>not</i> have references</a>. There is an implicit array to pointer decay that occurs when passing arrays into functions. Check <a href=\"http://en.cppreference.com/w/c/language/array\" rel=\"nofollow noreferrer\">this</a> out for more on arrays in C."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1470771468, "post_id": 38858594, "comment_id": 65082271, "body": "Re your edit: as an answer says, you cannot find the size of an array passed to a function. You have to tell it that too. Within the function, <code>sizeof</code> the pointer argument will never give anything but the size of the pointer itself (not the array) <i>even if you state the array dimension in the argument</i>."}, {"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "edited": false, "score": 0, "creation_date": 1470782921, "post_id": 38858594, "comment_id": 65087105, "body": "You are working off of a false premise. Yes, <code>sizeof</code> will prevent pointer decay <i>if the thing being passed to it is an array</i>. But as soon as you pass it into a function, it decays. Even if you take the address of the array and pass that into the function, it decays. Unless you handle the array right away, it will decay when you pass it to a function. If you can solve the halting problem, then we can help you make the function do magic."}], "answers": [{"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1470771126, "post_id": 38858800, "comment_id": 65082067, "body": "Just a nit, but the two statements are not equivalent.  <code>*(arr+9)</code> is  equivalent to <code>arr[9]</code>.  The indices are zero based.  i.e. <code>*(arr+0)</code> same as <code>arr[0]</code>."}], "tags": [], "owner": {"reputation": 594, "user_id": 6040113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a03cab99436994f7bc68df23f674729?s=128&d=identicon&r=PG&f=1", "display_name": "monkeyStix", "link": "https://stackoverflow.com/users/6040113/monkeystix"}, "is_accepted": false, "score": 0, "last_activity_date": 1470773457, "last_edit_date": 1470773457, "creation_date": 1470770420, "answer_id": 38858800, "question_id": 38858594, "link": "https://stackoverflow.com/questions/38858594/how-to-pass-a-pointer-to-an-array-without-decay-and-use-the-reference-in-a-fu/38858800#38858800", "title": "How to pass a pointer to an array without decay, and use the &#39;reference&#39; in a function for barbarrians?", "body": "<p>When you declare an array, what c does in the background is basically just allocate enough memory for the size you want and then giving you a pointer. when you say</p>\n\n<pre><code>int arr[20];\n</code></pre>\n\n<p>what is effectively happening is that c is allocating enough memory for 20 ints and gives you a pointer named arr(there is some difference but for simplicity's sake I am explaining it this way), so if a function's signature requires a pointer to an int, you can pass it the array.</p>\n\n<pre><code>void foo(int *);\nfoo(arr);      */ works */\n</code></pre>\n\n<p>this works, so there is no need to use a pointer to a pointer, although you will have to specify the size, because a c array is basically just a pointer that points to some memory, so you can either receive the size as a parameter or mark the last element of the array in a manner similar to how the end of a string of chars is marked(using a null terminator).\nwhen you use the [] operator, c just offsets the pointer and dereferences it, so these two statements are equivalent(one being less readable)</p>\n\n<pre><code>arr[10] = somevalue;\n*(arr+10) = somevalue;\n// In general, arr[n] is equivalent to *(arr+n).\n</code></pre>\n\n<p>hope this helps you understand it a little better even though my explanation was a little simplistic.</p>\n"}, {"comments": [{"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1470783113, "post_id": 38859040, "comment_id": 65087151, "body": "Comments are not for extended discussion; this conversation has been <a href=\"http://chat.stackoverflow.com/rooms/120553/discussion-on-answer-by-sps-how-to-pass-a-pointer-to-an-array-without-decay-and\">moved to chat</a>."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1470783155, "post_id": 38859040, "comment_id": 65087168, "body": "@sps Again, you don&#39;t need to search something you already know :))"}, {"owner": {"reputation": 2630, "user_id": 4065269, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/90c9cd69a6663c31758d6cd6043dfcc3?s=128&d=identicon&r=PG&f=1", "display_name": "sps", "link": "https://stackoverflow.com/users/4065269/sps"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1470783607, "post_id": 38859040, "comment_id": 65087295, "body": "@Michi OP wants to search for it in a function. You have still not understood the question. OP wants to write a function which calculates <code>10</code> for <code>char arr[10];</code> , <code>15</code> for <code>char arr[15];</code>, and <code>20</code> for <code>char arr[20];</code> by passing onle ONE argument to that function. Please reply  if you do write that function. More preferable please post an answer with your solution for array of char type."}], "tags": [], "owner": {"reputation": 2630, "user_id": 4065269, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/90c9cd69a6663c31758d6cd6043dfcc3?s=128&d=identicon&r=PG&f=1", "display_name": "sps", "link": "https://stackoverflow.com/users/4065269/sps"}, "is_accepted": false, "score": 3, "last_activity_date": 1470778555, "last_edit_date": 1470778555, "creation_date": 1470771266, "answer_id": 38859040, "question_id": 38858594, "link": "https://stackoverflow.com/questions/38858594/how-to-pass-a-pointer-to-an-array-without-decay-and-use-the-reference-in-a-fu/38859040#38859040", "title": "How to pass a pointer to an array without decay, and use the &#39;reference&#39; in a function for barbarrians?", "body": "<p>In <code>C</code>, you <strong>cannot</strong> find the size of the array in the called function. Caller function <strong>has to pass</strong> one more argument stating the size of array.</p>\n\n<hr>\n\n<p>Let us see some examples to see why this is not possbile.</p>\n\n<p><strong>First</strong> you will try to pass the array as an argument when you call the function. However, note that when you pass an array as an argument, it automatically deays to a pointer to the datatype of its element. And this will prevent the <code>called</code> function from calculating the size of array using <code>sizeof</code> operator.</p>\n\n<p>For example, </p>\n\n<pre><code>int main(void)\n{\n    int arr_a[2] = {22, 33};\n    int arr_b[5] = {6, 7, 8, 9, 10};\n\n    foo(arr_a); // Here arr_a decays to an `int *`\n    foo(arr_b); // Here arr_b decays to an `int *` too\n\n    return 0;\n}\n\nvoid foo(int *arr)\n{\n    sizeof(arr); \n    /* Here sizeof(arr) will always give the size of \n     * an `int *` which maybe 4 or 8 bytes depending\n     * on platform. It does not matter weather arr_a\n     * or arr_b was passed from main.   \n     * And because sizeof(arr) always gives the sameresult, \n     * we cannot use sizeof(arr)/sizeof(arr[0]) to calculate \n     * the size of array that was passed.\n     */\n\n     /* This value will always be the same, \n      * regardless of what was passed */\n     sizeof(arr)/sizeof(arr[0]); \n\n}\n</code></pre>\n\n<p>Also, note that that:</p>\n\n<pre><code>void foo(int arr[]) { ... }\n</code></pre>\n\n<p>is equivalent to:</p>\n\n<pre><code>void foo(int *arr) { ... }\n</code></pre>\n\n<p>Compiler will silently change <code>int arr[]</code> into <code>int *arr</code>. So having <code>int arr[]</code> as a parameter will not make any difference.</p>\n\n<p><strong>Next</strong>, you may think of passing the address of array (by doing <code>&amp;arr_name</code>). However, please note that, <code>&amp;arr_name</code> is a <code>pointer to array (of some DEFINITE size)</code>, which is <strong>different</strong> from a <code>pointer to pointer to underlying datatype</code>. This time you do something like this.</p>\n\n<pre><code>void foo(void) {\n    int arr_a[2] = {22, 33};\n    int arr_b[3] = {7, 8, 9};\n     bar(&amp;arr_a); // Note here that type of `&amp;arr_a`  is `int (*)[2]`,\n                  // i.e. a `pointer to int array of 2 elements`, which is\n                  // different from a `pionter to pointer to int`\n\n     bar(&amp;arr_b); // Note here that type of `&amp;arr_b`  is `int (*)[3]`,\n                  // i.e. a `pointer to int array of 3 elements`, which is\n                  // different from a `int (*)[2]`, \n                  // i.e a `pointer to int array of 2 elements`\n                  // Note that this will give ERROR. See comments in bar()\n    return 0;\n}\n\nvoid bar(int (*arr)[2]) {\n     /* \n      * The caller of this function can ONLY pass int arrays with\n      * 2 elements. Caller CANNOT pass int array with 3 elemens, or\n      * 1 element, or 5 element.\n      * This means you ALWAYS KNOW the size of arrays being passed,\n      * and although you can calculate the size by doing\n      * sizeof(*arr)/sizeof(*arr[0]); \n      * There is no point in calculating it - you alreay know the size \n      */\n}\n</code></pre>\n\n<p>So, basically you cannot even pass <code>pointer to the array</code> by passing <code>&amp;array_name</code> to solve this problem, because you will need different functions for accepting arrays of different sizes. Like, <code>void bar_2(int (*arr)[2]) {...}</code> to accept <code>pointer to array of 2 integers</code>, and <code>void bar_3(int (*arr)[3]) {...}</code> to accept <code>pointer to array of 3 integers</code>. Besides, there is no point in calculating the size in these functions, as you will already know it.</p>\n\n<p><strong>Lastly</strong>, you will try passing a <code>pointer to pointer to the underlying datatype</code>. So you do something like:</p>\n\n<pre><code>void foo() {\n    int arr_a[2] = {22, 33};\n    int arr_b[5] = {6, 7, 8, 9, 10};\n    int *ptr;\n    ptr = &amp;arr_a[0];\n    bar(&amp;ptr); // Passing pointer to pointer to int (int **)\n    ptr = &amp;arr_b[0];\n    bar(&amp;ptr); // Passing pointer to pointer to int (int **)\n}\n\nvoid bar(int **pptr) {\n    sizeof(*pptr);\n    /* This will always be the same. \n     * i.e. the size of an integer pointer \n     * So here again you cannot use \n     * sizeof(*pptr)/sizeof((*pptr)[0]) to calculate the size\n     * as it will always give the same result */\n\n     sizeof(*pptr)/sizeof((*pptr)[0]) // Always same, no matter what was\n                                      // passed by the caller\n}\n</code></pre>\n\n<p>You see that passing a <code>pointer to pointer to underlying datatype</code> also does not solve this problem.</p>\n\n<p>So, you see that no matter what you do, you CANNOT find the size of array by using <code>sizeof()</code> in the called function. The called function can know the size of the array <strong>only if</strong> the caller passes this info.</p>\n\n<hr>\n\n<p>As a side note, there is an issue in your code. When you are doing</p>\n\n<pre><code> i = 0; while (now &gt; hourLongs[i] &amp;&amp; i &lt; j){i++;}  // AND\n i = 0; while (*time&gt; (timeList_pointer)[i] &amp;&amp; i &lt; size){i++;} \n</code></pre>\n\n<p>The order of your conditions in <code>while</code> loop should be other way round.  It should be </p>\n\n<pre><code> i = 0; while ( i &lt; j &amp;&amp; now &gt; hourLongs[i]){i++;}  // AND\n i = 0; while (i &lt; size &amp;&amp; *time&gt; (timeList_pointer)[i]){i++;} \n</code></pre>\n\n<p>This is because, you have to first check that <code>i</code> is within the bounds of array, and then only evaluate <code>hourLongs[i]</code> or <code>(timeList_pointer)[i]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1470772238, "creation_date": 1470772238, "answer_id": 38859293, "question_id": 38858594, "link": "https://stackoverflow.com/questions/38858594/how-to-pass-a-pointer-to-an-array-without-decay-and-use-the-reference-in-a-fu/38859293#38859293", "title": "How to pass a pointer to an array without decay, and use the &#39;reference&#39; in a function for barbarrians?", "body": "<p>As others have stated, you cannot pass an array to a function and get its size due to how arrays decay to a pointer to the first element when passed to a function.  So you need to pass in the array and its size to your function.</p>\n\n<p>There is a roundabout way of passing an array to a function so you can get its size, however it only works for arrays of a fixed size.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid test1(int (*a)[10])\n{\n    int i;\n    printf(\"size=%zu\\n\",sizeof(*a));\n    for (i=0;i&lt;sizeof(*a)/sizeof((*a)[0]);i++) {\n        printf(\"%d\\n\",(*a)[i]);\n    }\n}\n\nint main()\n{\n    int a[10] = {1,2,3,4,5,6,7,8,9,10};\n    test1(&amp;a);\n    return 0;\n}\n</code></pre>\n\n<p>The above code allow you to pass a pointer to an array of a fixed size.  You can then dereference that pointer to get the number of elements as <code>sizeof(*a)/sizeof((*a)[0])</code>.  </p>\n\n<p>However, you can only pass a <code>int [10]</code> array to this function.  You can't pass an array of any other size.  So in this case, you can simply replace the above expression with <code>10</code> since the size is known.</p>\n"}], "owner": {"reputation": 301, "user_id": 2125456, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/372ba3a1f71c9de56ea9262ad13b1565?s=128&d=identicon&r=PG", "display_name": "kjl", "link": "https://stackoverflow.com/users/2125456/kjl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1544, "favorite_count": 2, "answer_count": 3, "score": 2, "last_activity_date": 1470778555, "creation_date": 1470769625, "last_edit_date": 1495535631, "question_id": 38858594, "link": "https://stackoverflow.com/questions/38858594/how-to-pass-a-pointer-to-an-array-without-decay-and-use-the-reference-in-a-fu", "title": "How to pass a pointer to an array without decay, and use the &#39;reference&#39; in a function for barbarrians?", "body": "<p>I've read many discussions on passing arrays to functions. They seem to be written for people who are fluent in C. I am a barbarian not yet fluent in C.</p>\n\n<p>From what I've read in other discussions <strong>it should be possible to pass an array without pointer decay. Yet, I need help implementing this.</strong></p>\n\n<p>Please give me a concise example of how to pass an array as a pointer of a pointer and determine it's size within the function to which it is passed. </p>\n\n<p>If the array is changed in the function, I want the source of the array to be changed. And I want to minimize additional allocation of memory.\nAnd, if at all possible, I'd like to <strong>size the array within the function.</strong></p>\n\n<p>This code works without passing.</p>\n\n<pre><code>// this works\nj = sizeof(hourLongs)/sizeof(hourLongs[0]);\ni = 0; while (now &gt; hourLongs[i] &amp;&amp; i &lt; j){i++;}  \nhour = --i; \n</code></pre>\n\n<p>This works but fails to size the array within the function.</p>\n\n<pre><code>hour = compareToLongs(&amp;now, hourLongs, (int)(sizeof(hourLongs)/sizeof(hourLongs[0])) ); \n\n// long *, long * , int -&gt; int \n// compare time to array of times.\nstatic int compareToLongs(long * time, long * timeList_pointer, int size){\n  i = 0; while (*time&gt; (timeList_pointer)[i] &amp;&amp; i &lt; size){i++;}  \n  return --i;\n}\n</code></pre>\n\n<p>I'd like to pass the array in a way that will allow me to find it's size within the function. Something like the following, minus my errors.</p>\n\n<pre><code>hour = compareToLongs(&amp;now, &amp;hourLongs); \n\n// long *, (long (*) [])*  -&gt; int \n// compare time to array of times.\nstatic int compareToLongs(long * time, long ** timeList_pointer){\n  int size = (int)(sizeof(*timeList_pointer)/sizeof(*timeList_pointer[0]));\n  i = 0; while (*time&gt; (i &lt; size &amp;&amp; *timeList_pointer)[i]){i++;}\n  free(size);  \n  return --i;\n}\n</code></pre>\n\n<p>Edit: hourLongs is an array of long integers.</p>\n\n<p>Edit: Regarding the title, I used the word 'reference' in the vernacular so that other barbarians like me may find the question.</p>\n\n<p>Edit: I'm really looking for a way to size an array of integers within a function.</p>\n\n<pre><code>sizeof(array)\n</code></pre>\n\n<p>gives a some address to sizeof() that allows the size to be determined. It is that address that I would like to pass to my function.</p>\n\n<p>Is there a reason why I cant pass that which is passed to sizeof() to my function?</p>\n\n<p>Edit: as the operation of sizeof() suggests it is possible for an array to be passed without \"pointer decay\". user529758 gives three examples in <a href=\"https://stackoverflow.com/questions/17752978/exception-to-array-not-decaying-into-a-pointer\">this discussion</a></p>\n\n<pre><code>in C99 there are three fundamental cases, namely:\n1. when it's the argument of the &amp; (address-of) operator.\n2. when it's the argument of the sizeof operator.\n3. When it's a string literal of type char [N + 1] or a wide string literal of type wchar_t [N + 1] (N is the length of the string) which is used to initialize an array, as in char str[] = \"foo\"; or wchar_t wstr[] = L\"foo\";.\n</code></pre>\n\n<p>What I seek to do should be possible using &amp;array.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1470768124, "post_id": 38858159, "comment_id": 65080477, "body": "At the first call to <code>strlen(name)</code>, <code>name</code> is uninitialized, and it will cause an undefined behavior."}, {"owner": {"reputation": 37, "user_id": 3887679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/016b4e4d5e5dc710aca2d49bd3df42c8?s=128&d=identicon&r=PG&f=1", "display_name": "Casz146", "link": "https://stackoverflow.com/users/3887679/casz146"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470768258, "post_id": 38858159, "comment_id": 65080548, "body": "But why doesn&#39;t it do that when the outlined part isn&#39;t there? Then it asks the question."}, {"owner": {"reputation": 551, "user_id": 4811421, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-arrE9IQuW7o/AAAAAAAAAAI/AAAAAAAADrE/teN4DXBv_-M/photo.jpg?sz=128", "display_name": "Shreyan Mehta", "link": "https://stackoverflow.com/users/4811421/shreyan-mehta"}, "edited": false, "score": 1, "creation_date": 1470768285, "post_id": 38858159, "comment_id": 65080562, "body": "Since you are new. .it&#39;s the perfect time to learn how to use a debugger...so that you would be able to find where the code is going haywire....also since if u do some big codes...then it would be highly helpful"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 3887679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/016b4e4d5e5dc710aca2d49bd3df42c8?s=128&d=identicon&r=PG&f=1", "display_name": "Casz146", "link": "https://stackoverflow.com/users/3887679/casz146"}, "edited": false, "score": 0, "creation_date": 1470768542, "post_id": 38858208, "comment_id": 65080693, "body": "That made a lot clear, thanks a lot! I&#39;ll also start using a debugger."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1470768251, "creation_date": 1470768251, "answer_id": 38858208, "question_id": 38858159, "link": "https://stackoverflow.com/questions/38858159/skipping-entire-for-loop-when-adding-code-inside-the-loop/38858208#38858208", "title": "Skipping entire &quot;for loop&quot; when adding code inside the loop", "body": "<p>Lets look at these two lines:</p>\n\n<pre><code>char name[21],filename[21],cpf[16];\n...\nfor ( ;strlen(name)&lt;3; ) {\n</code></pre>\n\n<p>First you declare the array <code>name</code> (and some others), but you don't initialize it. Then you use the uninitialized in a call to <code>strlen</code>. That will lead to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\"><em>undefined behavior</em></a> because the contents of <code>name</code> is <em>indeterminate</em>.</p>\n\n<p>You must explicitly initialize the array, or any other local variables, before you use it.</p>\n\n<p>Simplest way is doing something like</p>\n\n<pre><code>char name[21] = \"\", ...;\n</code></pre>\n\n<hr>\n\n<p>As for why the code behaves differently in different situation is because of the <em>undefined behavior</em>. Undefined behavior is, by its very definition, <em>undefined</em>. It means just about anything can happen, even to <em>seemingly</em> work fine. It could also crash or cause <a href=\"http://www.catb.org/jargon/html/N/nasal-demons.html\" rel=\"nofollow\">nasal demons</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "is_accepted": false, "score": 1, "last_activity_date": 1470768262, "creation_date": 1470768262, "answer_id": 38858213, "question_id": 38858159, "link": "https://stackoverflow.com/questions/38858159/skipping-entire-for-loop-when-adding-code-inside-the-loop/38858213#38858213", "title": "Skipping entire &quot;for loop&quot; when adding code inside the loop", "body": "<p>You've left <code>name</code> unitialized, so <code>strlen(name)</code> is undefined behavior and seems to return <code>false</code>. To avoid this, try changing your <code>for</code> loop to a <code>do while</code> loop, which will always run once before checking the condition. This could look like:</p>\n\n<pre><code>do {\n    //loop body that initializes name\n} while (strlen(name) &lt; 3);\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3887679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/016b4e4d5e5dc710aca2d49bd3df42c8?s=128&d=identicon&r=PG&f=1", "display_name": "Casz146", "link": "https://stackoverflow.com/users/3887679/casz146"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 38858208, "answer_count": 2, "score": 0, "last_activity_date": 1470768262, "creation_date": 1470768058, "question_id": 38858159, "link": "https://stackoverflow.com/questions/38858159/skipping-entire-for-loop-when-adding-code-inside-the-loop", "title": "Skipping entire &quot;for loop&quot; when adding code inside the loop", "body": "<p>I'm a beginner to C and have been trying to develop a few programs, but I'm currently stuck. The problem is as follows: When I run the code below, it skips over the whole \"Type your name\" part and skips immediately so the \"Type your CPF\" part. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid append(char subject[], const char insert[], int pos) {\n    char buf[100] = {}; \n\n    strncpy(buf, subject, pos); \n    int len = strlen(buf);\n    strcpy(buf+len, insert); \n    len += strlen(insert);  \n    strcpy(buf+len, subject+pos); \n\n    strcpy(subject, buf);   \n}\n\nint main() {\n    int i,j;\n    char name[21],filename[21],cpf[16];\n    FILE *fp;\n\n    for ( ;strlen(name)&lt;3; ) {\n        name[0] = 0;\n        printf(\"Type your name (max characters: 20, no numbers allowed) \\n\");\n        fflush (stdout);\n        fgets(name,21,stdin);\n        for(i=0; name[i]!='\\0'; ++i) {\n            while (!((name[i]&gt;='a'&amp;&amp;name[i]&lt;='z') || (name[i]&gt;='A'&amp;&amp;name[i]&lt;='Z' || name[i]=='\\0'))) {\n                for(j=i;name[j]!='\\0';++j) {\n                name[j]=name[j+1];\n                }\n            name[j]='\\0';\n            }\n        }\n        strtok(name, \"\\n\");\n        strcpy(filename,name);\n        strcat(filename, \".txt\");\n    }\n    fp = fopen(filename,\"a\");\n    fprintf(fp,\"Name:\");\n    fprintf(fp, name);\n    fflush(stdin);\n\n    for ( ;strlen(cpf)&lt;11 || strlen(cpf)&gt;11; ) {\n        printf(\"Please enter your CPF, consisting of 11 numbers:\\n\");\n        scanf(\"%s\",&amp;cpf);\n    }\n    append(cpf,\".\",3);\n    append(cpf,\".\",7);\n    append(cpf,\"-\",11);\n    fprintf(fp,\"\\nCPF: \");\n    fprintf(fp, cpf);\n    system(\"pause\");\n}\n</code></pre>\n\n<p>However, when I comment the part below it runs normally.</p>\n\n<pre><code>//      for(i=0; name[i]!='\\0'; ++i) {\n//          while (!((name[i]&gt;='a'&amp;&amp;name[i]&lt;='z') || (name[i]&gt;='A'&amp;&amp;name[i]&lt;='Z' || name[i]=='\\0'))) {\n//              for(j=i;name[j]!='\\0';++j) {\n//                name[j]=name[j+1];\n//              }\n//            name[j]='\\0';\n//          }\n//      }\n</code></pre>\n\n<p>As you can see, I want the code to remove all extra characters from the name and just make the name alphabetical characters, but I'm not sure why it skips the whole \"for-loop\" when I enter this particular part.</p>\n\n<p>Any suggestions? Also since I'm new to C I may have included too much code, feel free to tell me and I'll remove irrelevant parts.</p>\n"}, {"tags": ["c", "syntax", "while-loop", "fgetc"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1470767478, "post_id": 38857976, "comment_id": 65080163, "body": "The body of the work, is within the <code>while</code> statement. It skips alphabet characters from the file."}, {"owner": {"reputation": 31465, "user_id": 128384, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf6f92bfb2a16c0e2c6ca7aef4440862?s=128&d=identicon&r=PG", "display_name": "stijn", "link": "https://stackoverflow.com/users/128384/stijn"}, "edited": false, "score": 0, "creation_date": 1470767517, "post_id": 38857976, "comment_id": 65080186, "body": "<i>why?</i> because there&#39;s nothing to do in the loop <i>what does it do?</i> what the comment says: consume remainder of alphabetical string i.e. read until EOF or a non-alphabetical character found"}, {"owner": {"reputation": 164, "user_id": 5046496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c7c9345c3aa388d3df3f107072d9b631?s=128&d=identicon&r=PG&f=1", "display_name": "Dominic", "link": "https://stackoverflow.com/users/5046496/dominic"}, "edited": false, "score": 0, "creation_date": 1470767537, "post_id": 38857976, "comment_id": 65080207, "body": "It&#39;s setting &#39;c&#39; equal to the contents of the file.  However, from code shown c looks unused other than being set to the value of the file."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1470767559, "post_id": 38857976, "comment_id": 65080216, "body": "The fact that this is obvious to old cats doesn&#39;t make it a poor quality question. UV&#39;d"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1470777125, "post_id": 38857976, "comment_id": 65084979, "body": "Note: <code>int c; ....while ((c = fgetc(fp)) != EOF &amp;&amp; isalpha(c));</code> can simplify to <code>while (isalpha(c = fgetc(fp)));</code> as <code>EOF</code> is not an alpha and <code>isalpha(EOF)</code> is defined."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1470769359, "last_edit_date": 1470769359, "creation_date": 1470767611, "answer_id": 38858045, "question_id": 38857976, "link": "https://stackoverflow.com/questions/38857976/why-is-while-written-here-with-no-body/38858045#38858045", "title": "why is while written here with no body?", "body": "<blockquote>\n  <p><em>why is while written here with no body?</em></p>\n</blockquote>\n\n<p>TL;DR - because, it can be written and it serves the desired purpose of the code.</p>\n\n<p>To elaborate, in the code</p>\n\n<pre><code>while ((c = fgetc(fp)) != EOF &amp;&amp; isalpha(c));\n</code></pre>\n\n<p>the <code>&amp;&amp;</code> operator and its properties are being utilized as part of the controlling expression which serves the purpose of the loop statement. The condition check in <code>while</code> remains <em>TRUE</em> (1) as long as both the operands of <code>&amp;&amp;</code> evaluates to TRUE (1). Once either of them is not <em>TRUE</em>, the loop ends. </p>\n\n<p>Just to be clear, till <code>(c = fgetc(fp)) != EOF</code> <strong>and</strong> <code>isalpha(c)</code> evaluates to non-zero value (TRUE), the loop coninues (with an empty body).</p>\n\n<p>The main pages of <a href=\"http://linux.die.net/man/3/fgetc\" rel=\"nofollow\"><code>fgetc()</code></a> and <a href=\"http://linux.die.net/man/3/isalpha\" rel=\"nofollow\"><code>isalpha()</code></a> may be of further help.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 4, "last_activity_date": 1470767621, "creation_date": 1470767621, "answer_id": 38858051, "question_id": 38857976, "link": "https://stackoverflow.com/questions/38857976/why-is-while-written-here-with-no-body/38858051#38858051", "title": "why is while written here with no body?", "body": "<p>To better understand what's happening, the loop can be rewritten as follows:</p>\n\n<pre><code>do {\n    c = fgetc(fp);\n} while (c != EOF &amp;&amp; isalpha(c)); \n</code></pre>\n\n<p>It reads a character from the file descriptor, then checks to see if it is either an alphabetic character or EOF.</p>\n\n<p>What the original loop is doing is performing the assignment as a subexpression within the conditional, so that leave the body blank.</p>\n"}, {"tags": [], "owner": {"reputation": 919, "user_id": 3095460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utTEO.jpg?s=128&g=1", "display_name": "Sridhar Nagarajan", "link": "https://stackoverflow.com/users/3095460/sridhar-nagarajan"}, "is_accepted": false, "score": 0, "last_activity_date": 1470767700, "creation_date": 1470767700, "answer_id": 38858067, "question_id": 38857976, "link": "https://stackoverflow.com/questions/38857976/why-is-while-written-here-with-no-body/38858067#38858067", "title": "why is while written here with no body?", "body": "<p>The comment clearly mentions the purpose of the code.<br>\n<code>// consume remainder of alphabetical string\n            while ((c = fgetc(fp)) != EOF &amp;&amp; isalpha(c));</code> </p>\n\n<p>Function <code>fgetc</code> on each invocation reads a character from the file pointer <code>fp</code>. \nOn reading it skips the next sequence of alphabets until it reaches something else ex a digit.</p>\n"}, {"tags": [], "owner": {"reputation": 114, "user_id": 5155068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c2faa14450f1a63160d1a4521d9b0ca?s=128&d=identicon&r=PG&f=1", "display_name": "Sanjeev Kumar", "link": "https://stackoverflow.com/users/5155068/sanjeev-kumar"}, "is_accepted": true, "score": 4, "last_activity_date": 1470767729, "creation_date": 1470767729, "answer_id": 38858075, "question_id": 38857976, "link": "https://stackoverflow.com/questions/38857976/why-is-while-written-here-with-no-body/38858075#38858075", "title": "why is while written here with no body?", "body": "<p>Once it has parsed string of length <b>LENGTH</b>, it should ignore all the subsequent characters. Thus, in the body of the while loop:</p>\n\n<pre><code>c = fgetc(fp)) != EOF //get c from file pointer and check if it is not EOF\nisalpha(c) //and also it is an alphabet because alphabets can only make a word\n</code></pre>\n\n<p>If both conditions are true, keep parsing and ignoring. Moment you encounter a character other than alphabet or just an EOF, reset index and ma be go to next line.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1470777312, "post_id": 38858211, "comment_id": 65085088, "body": "<code>fgetc()</code> returns <code>int</code> instead of <code>char</code>.  For details, read <a href=\"http://www.cplusplus.com/reference/cstdio/fgetc/\" rel=\"nofollow noreferrer\">fgetc</a>.  As written <code>while (c != EOF &amp;&amp; isalpha(c))     c = fgetc(fp);</code> can enter into an infinite loop on platforms where <code>char</code> is unsigned."}], "tags": [], "owner": {"reputation": 86, "user_id": 6517623, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIxwo.png?s=128&g=1", "display_name": "Hedron", "link": "https://stackoverflow.com/users/6517623/hedron"}, "is_accepted": false, "score": 0, "last_activity_date": 1470779061, "last_edit_date": 1470779061, "creation_date": 1470768259, "answer_id": 38858211, "question_id": 38857976, "link": "https://stackoverflow.com/questions/38857976/why-is-while-written-here-with-no-body/38858211#38858211", "title": "why is while written here with no body?", "body": "<p>So if you read the documentation on <a href=\"http://www.cplusplus.com/reference/cstdio/fgetc/\" rel=\"nofollow\">fgetc</a> it says that it when successful it will return <strong><em>the character currently pointed by the internal file position indicator</em></strong> or EOF. So that while loop is just assigning c to the next character in the file, checking if its not and <code>EOF</code> and making sure its a <code>alpha character</code> and it continues doing that until those conditions are not true. That loop could be re-written to:</p>\n\n<pre><code>int c = fgetc(fp);\nwhile (c != EOF &amp;&amp; isalpha(c))\n    c = fgetc(fp);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2630, "user_id": 4065269, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/90c9cd69a6663c31758d6cd6043dfcc3?s=128&d=identicon&r=PG&f=1", "display_name": "sps", "link": "https://stackoverflow.com/users/4065269/sps"}, "is_accepted": false, "score": 1, "last_activity_date": 1470769004, "last_edit_date": 1470769004, "creation_date": 1470768693, "answer_id": 38858333, "question_id": 38857976, "link": "https://stackoverflow.com/questions/38857976/why-is-while-written-here-with-no-body/38858333#38858333", "title": "why is while written here with no body?", "body": "<p>This <code>while</code> is written with no body, because the action is carried out in the <code>condition</code> part of the <code>while</code> loop.</p>\n\n<p>If you see the condition of the loop it is:</p>\n\n<pre><code>((c = fgetc(fp)) != EOF &amp;&amp; isalpha(c))\n</code></pre>\n\n<p>When first condition - i.e. <code>(c = fgetc(fp)) != EOF</code> - is evaluated, <code>c = fgetc(fp)</code> gets executed, which reads one byte from your file. This byte is first checked if it is <code>EOF</code>, which signifies end of file, and if not EOF then it is checked if it is a non-alphabet character.</p>\n\n<p>This action of reading one byte from the file continues either untill either a non-alphabet character is read, or the end of file is reached.</p>\n\n<p>So, what this snippet of code basically does is, whenever <code>index</code> becomes more than <code>LENGTH</code>, it first reads remaining <code>alphabets</code> - without doing anything -, untill a non-alpbabet is read or the end of file is reached. And then it sets<code>index</code> to <code>0</code>. </p>\n\n<p>That while could be written differently too, so that it would not have an empty body. However, what you have seen is a common <code>idiom</code> in <code>C</code>.</p>\n"}], "owner": {"reputation": 191, "user_id": 6548856, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b682922c9824936393a91c8a35df982?s=128&d=identicon&r=PG&f=1", "display_name": "A.Emad", "link": "https://stackoverflow.com/users/6548856/a-emad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 38858075, "answer_count": 6, "score": 3, "last_activity_date": 1470779061, "creation_date": 1470767382, "last_edit_date": 1470768474, "question_id": 38857976, "link": "https://stackoverflow.com/questions/38857976/why-is-while-written-here-with-no-body", "title": "why is while written here with no body?", "body": "<p>why is the while loop written in this code with no body? what does it do? \nThe index and length are both integers and I am reading from a txt file. </p>\n\n<pre><code>  // ignore alphabetical strings too long to be words\n        if (index &gt; LENGTH)\n        {\n            // consume remainder of alphabetical string\n            while ((c = fgetc(fp)) != EOF &amp;&amp; isalpha(c));\n\n            // prepare for new word\n            index = 0;\n        }\n</code></pre>\n"}, {"tags": ["c", "linux", "dynamic-linking"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470766599, "post_id": 38857741, "comment_id": 65079714, "body": "<code>ld.so</code> is not a part of the kernel, but is loaded by it."}, {"owner": {"reputation": 1299, "user_id": 810632, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0b1fd54092d295a54910bb4202cc2c50?s=128&d=identicon&r=PG", "display_name": "nephtes", "link": "https://stackoverflow.com/users/810632/nephtes"}, "edited": false, "score": 0, "creation_date": 1470766708, "post_id": 38857741, "comment_id": 65079765, "body": "It&#39;s actually part of GNU libc on Linux; see <a href=\"http://www.cs.virginia.edu/~dww4s/articles/ld_linux.html\" rel=\"nofollow noreferrer\">cs.virginia.edu/~dww4s/articles/ld_linux.html</a>"}, {"owner": {"reputation": 127, "user_id": 5781079, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-p6fEVLJjskk/AAAAAAAAAAI/AAAAAAAAAMI/ias3mr1ibc4/photo.jpg?sz=128", "display_name": "NotAPro", "link": "https://stackoverflow.com/users/5781079/notapro"}, "reply_to_user": {"reputation": 1299, "user_id": 810632, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0b1fd54092d295a54910bb4202cc2c50?s=128&d=identicon&r=PG", "display_name": "nephtes", "link": "https://stackoverflow.com/users/810632/nephtes"}, "edited": false, "score": 0, "creation_date": 1585699319, "post_id": 38857741, "comment_id": 107853241, "body": "@nephtes That link doesn&#39;t work; 403 error."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5746986"}, "edited": false, "score": 0, "creation_date": 1470804949, "post_id": 38857878, "comment_id": 65092155, "body": "@criag . As I have noticed , every process(vlc player, chrome) had the shared library <b>ld.so</b> as part of their address space. So primarily loader after loading the executable(code &amp; data) onto memory , It loads&amp; maps <b>dynamic linker (.so)</b> to its address space which further Loads shared Libraries , map &amp; resolve references to libraries. It then calls entry function (_start) . Is this correct ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5746986"}, "edited": false, "score": 0, "creation_date": 1472351053, "post_id": 38857878, "comment_id": 65716080, "body": "@craig. I have used the program <b><i>ldd</i></b> already which prints the shared dependencies ."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1472353852, "post_id": 38857878, "comment_id": 65716408, "body": "I would have guessed that you were familiar with <code>ldd</code>, I mentioned it [and other things] to produce a complete answer. Actually, <code>ldd</code> is a shell script. It simply sets the environment variable <code>LD_TRACE_LOADED_OBJECTS</code> and then does an <code>exec</code> of <code>&#47;usr&#47;bin&#47;vlc</code>. The ELF interpreter [for <code>vlc</code>] notices this variable and does the printing (and terminates rather than full execution). <code>ld.so</code> can&#39;t use program arguments, so to provide it with options, environment variables are set. The manpage has a fairly complete list (e.g. <code>man ld.so</code>)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5746986"}, "edited": false, "score": 0, "creation_date": 1472365134, "post_id": 38857878, "comment_id": 65717962, "body": "@CraigEstey , ok, i got it now."}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": true, "score": 14, "last_activity_date": 1470869337, "last_edit_date": 1495541869, "creation_date": 1470766956, "answer_id": 38857878, "question_id": 38857741, "link": "https://stackoverflow.com/questions/38857741/is-dynamic-linker-part-of-kernel-or-gcc-library-on-linux-systems/38857878#38857878", "title": "Is Dynamic Linker part of Kernel or GCC Library on Linux Systems?", "body": "<p>In an ELF executable, this is referred to as the \"ELF interpreter\". On linux (e.g.) this is <code>/lib64/ld-linux-x86-64.so.2</code></p>\n\n<p>This is <em>not</em> part of the kernel and [generally] with <code>glibc</code> et. al.</p>\n\n<p>When the kernel executes an ELF executable, it must map the executable into userspace memory. It then looks inside for a special sub-section known as <code>INTERP</code> [which contains a string that is the full path].</p>\n\n<p>The kernel then maps the interpreter into userspace memory and transfers control to it. Then, the interpreter does the necessary linking/loading and starts the program.</p>\n\n<p>Because <code>ELF</code> stands for \"extensible linker format\", this allows many different sub-sections with the ELF file.</p>\n\n<p>Rather than burdening the kernel with having to know about all the myriad of extensions, the ELF interpreter that is paired with the file knows.</p>\n\n<p>Although usually only one format is used on a given system, there can be several different variants of ELF files on a system, each with its own ELF interpreter.</p>\n\n<p>This would allow [say] a BSD ELF file to be run on a linux system [with other adjustments/support] because the ELF file would point to the BSD ELF interpreter rather than the linux one.</p>\n\n<hr>\n\n<p><strong>UPDATE:</strong></p>\n\n<blockquote>\n  <p>every process(vlc player, chrome) had the shared library ld.so as part of their address space.</p>\n</blockquote>\n\n<p>Yes. I assume you're looking at <code>/proc/&lt;pid&gt;/maps</code>. These are <em>mappings</em> (e.g. like using <code>mmap</code>) to the files. That is somewhat different than \"loading\", which can imply [symbol] <em>linking</em>.</p>\n\n<blockquote>\n  <p>So primarily loader after loading the executable(code &amp; data) onto memory , It loads&amp; maps dynamic linker (.so) to its address space</p>\n</blockquote>\n\n<p>The best way to understand this is to rephrase what you just said:</p>\n\n<p><em>So primarily <strong>the kernel</strong> after <strong>mapping</strong> the executable(code &amp; data) onto memory, <strong>the kernel</strong> maps dynamic linker (.so) to <strong>the program</strong> address space</em></p>\n\n<p>That is essentially correct. The kernel also maps other things, such as the <code>bss</code> segment and the stack. It then \"pushes\" <code>argc</code>, <code>argv</code>, and <code>envp</code> [the space for environment variables] onto the stack.</p>\n\n<p>Then, having determined the start address of <code>ld.so</code> [by reading a special section of the file], it sets that as the resume address and starts the thread.</p>\n\n<p>Up until now, it has been the kernel doing things. The kernel does little to no symbol <em>linking</em>.</p>\n\n<p>Now, <code>ld.so</code> takes over ...</p>\n\n<blockquote>\n  <p>which further Loads shared Libraries , map &amp; resolve references to libraries. It then calls entry function (_start)</p>\n</blockquote>\n\n<p>Because the original executable (e.g. <code>vlc</code>) has been mapped into memory, <code>ld.so</code> can examine it for the list of shared libraries that it needs. It <em>maps</em> these into memory, but does <em>not</em> necessarily <em>link</em> the symbols right away.</p>\n\n<p>Mapping is easy and quick--just an <code>mmap</code> call.</p>\n\n<p>The start address of the executable [<em>not</em> to be confused with the start address of <code>ld.so</code>], is taken from a special section of the ELF executable. Although, the symbol associated with this start address has been traditionally called <code>_start</code>, it could actually be named anything (e.g. <code>__my_start</code>) as it is what is in the section data that determines the start address and <em>not</em> address of the symbol <code>_start</code></p>\n\n<p>Linking symbol references to symbol definitions is a time consuming process. So, this is deferred until the symbol is actually used. That is, if a program has references to <code>printf</code>, the linker doesn't actually try to link in <code>printf</code> until the first time the program actually <em>calls</em> <code>printf</code></p>\n\n<p>This is sometimes called \"link-on-demand\" or \"on-demand-linking\". See my answer here: <a href=\"https://stackoverflow.com/questions/37047977/which-segments-are-affected-by-a-copy-on-write/37060802#37060802\">Which segments are affected by a copy-on-write?</a> for a more detailed explanation of that and what actually happens when an executable is mapped into userspace.</p>\n\n<p>If you're interested, you could do <code>ldd /usr/bin/vlc</code> to get a list of the shared libraries it uses. If you looked at the output of <code>readelf -a /usr/bin/vlc</code>, you'll see these same shared libraries. Also, you'd get the full path of the ELF interpreter and could do <code>readelf -a &lt;full_path_to_interpreter&gt;</code> and note some of the differences. You could repeat the process for any <code>.so</code> files that <code>vlc</code> wanted.</p>\n\n<p>Combining all that with <code>/proc/&lt;pid&gt;maps</code> et. al. might help with your understanding.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5746986"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2713, "favorite_count": 6, "accepted_answer_id": 38857878, "answer_count": 1, "score": 7, "last_activity_date": 1472353312, "creation_date": 1470766377, "last_edit_date": 1592644375, "question_id": 38857741, "link": "https://stackoverflow.com/questions/38857741/is-dynamic-linker-part-of-kernel-or-gcc-library-on-linux-systems", "title": "Is Dynamic Linker part of Kernel or GCC Library on Linux Systems?", "body": "<p>Is Dynamic Linker (aka Program Interpreter,Link Loader) part of Kernel or GCC  Library ?</p>\n<p><strong>UPDATE</strong> (28-08-16) :</p>\n<p>I have found that the default path for <em>dynamic linker</em> that every binary (i.e linked against a shared library) uses <code>/lib64/ld-linux-x86-64.so.2</code> is a link to the shared library <code>/lib/x86_64-linux-gnu/ld-2.23.so</code> which is the actual dynamic linker.</p>\n<p>And It is part of <code>libc6 (2.23-0ubuntu3)</code> package viz. <a href=\"http://packages.ubuntu.com/xenial/amd64/libc6/filelist\" rel=\"noreferrer\">GNU C Library: Shared libraries</a> in ubuntu for AMD64 architectures.</p>\n<p>My actual question was</p>\n<p>what would happen to all the applications that are dynamically linked (all,now a days), if this helper program (<strong>ld-2.23.so</strong>) doesn't exist ?</p>\n<p>And answer to that is &quot; no application would run, even the shell program &quot;.  I've tried it on virutal machine.</p>\n"}, {"tags": ["c++", "c", "language-lawyer", "undefined-behavior", "micro-optimization"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1470764186, "post_id": 38857155, "comment_id": 65078457, "body": "What part of this do you suspect is undefined behavior and why?"}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1470764253, "post_id": 38857155, "comment_id": 65078488, "body": "@NathanOliver: The cast to <code>unsigned</code> may reinterpret the bits."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1470764336, "post_id": 38857155, "comment_id": 65078531, "body": "Why cast to unsigned if the result can be negative?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 2, "creation_date": 1470764366, "post_id": 38857155, "comment_id": 65078552, "body": "Why do you think this implementation would be more optimized? Did you check what the compiler emits acually?"}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 4, "creation_date": 1470764378, "post_id": 38857155, "comment_id": 65078556, "body": "That cast is completely superfluous anyway."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1470764432, "post_id": 38857155, "comment_id": 65078584, "body": "@nobar It does not reinterpret any bits, it yields the representative of the casted number&#39;s equivalence class that fits into the range of <code>unsigned</code>. (Well, it might do that by reinterpreting bits, but you need not care about that.)"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 1, "creation_date": 1470764488, "post_id": 38857155, "comment_id": 65078609, "body": "In the second case that cast may result in a huge number if the sum turns out to be negative, and this function will most likely return a <code>1</code> when it should actually be a zero."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1470764506, "post_id": 38857155, "comment_id": 65078621, "body": "@EugeneSh. @T.C.: Without the cast, it doesn&#39;t work correctly.  Negative numbers are mapped into the high-end of positive values -- which are above the <code>b</code> threshold."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1470764563, "post_id": 38857155, "comment_id": 65078660, "body": "@\u03c0\u03ac\u03bd\u03c4\u03b1\u1fe5\u03b5\u1fd6: The bottom part of my question addresses your comment directly."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1470764612, "post_id": 38857155, "comment_id": 65078684, "body": "@nobar If you see a difference without the cast, I would like to see a MCVE for that. <code>a</code> gets promoted to <code>unsigned</code> before the addition is performed anyways, and the result is an <code>unsigned</code> again. (At least in C++, but afaik that holds in C too.)"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1470764645, "post_id": 38857155, "comment_id": 65078702, "body": "Did you try <code>return ((a&lt;0) ? (a&lt;=b) : (-a&lt;=b));</code> ?"}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1470764862, "post_id": 38857155, "comment_id": 65078820, "body": "@dbush: Just tested your suggestion (with fix to <code>a&gt;0</code>).  This produces 5 instructions of which one is a branch (that I would like to avoid)."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1470764992, "post_id": 38857155, "comment_id": 65078881, "body": "<code>a*a &lt;= b*b</code> - no branches..Overflow danger, though"}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 2, "creation_date": 1470765570, "post_id": 38857155, "comment_id": 65079152, "body": "@BaummitAugen: I made a mistake here due to testing multiple scenarios.  The cast <i>was</i> superfluous as this was originally posted because it is implicit based on the type of <code>b</code> being <code>unsigned</code>.  I should have left <code>b</code> as type <code>int</code>, and will make that edit now."}, {"owner": {"reputation": 1610, "user_id": 502189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cba4d424ecb01d45a923636bef46cc7?s=128&d=identicon&r=PG", "display_name": "rjp", "link": "https://stackoverflow.com/users/502189/rjp"}, "edited": false, "score": 3, "creation_date": 1470765613, "post_id": 38857155, "comment_id": 65079178, "body": "Did you check that the 6 instruction are actually slower than the 4 instructions? That&#39;s not always the case."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "reply_to_user": {"reputation": 1610, "user_id": 502189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cba4d424ecb01d45a923636bef46cc7?s=128&d=identicon&r=PG", "display_name": "rjp", "link": "https://stackoverflow.com/users/502189/rjp"}, "edited": false, "score": 0, "creation_date": 1470765935, "post_id": 38857155, "comment_id": 65079334, "body": "@rjp: Good point.  But the instruction counts given here are only for the sake of interest.  I want to give the formula that is generally simplest in order to help the compiler.  Real testing on my deeply embedded platform will come later."}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1470766292, "post_id": 38857155, "comment_id": 65079515, "body": "The two functions don&#39;t return the same values. <a href=\"http://ideone.com/ahbzMk\" rel=\"nofollow noreferrer\">ideone.com/ahbzMk</a>"}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "reply_to_user": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 2, "creation_date": 1470766531, "post_id": 38857155, "comment_id": 65079669, "body": "@kfsone: <code>b</code> is meant to always be non-negative."}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 1, "creation_date": 1470766627, "post_id": 38857155, "comment_id": 65079728, "body": "Then it should be <code>char f2(int a, unsigned int b) { return unsigned(a) + b &lt;= 2*b;}</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1470767327, "post_id": 38857155, "comment_id": 65080083, "body": "That&#39;s not valid C."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 1, "creation_date": 1470767338, "post_id": 38857155, "comment_id": 65080088, "body": "Language lawyering is hard :).  I will revert and expand the question.  In my mind, the exact way that I specified the function isn&#39;t the interesting thing -- but rather it&#39;s the idea of using a wraparound in this way.  So an answer would be fine if it noted a slightly different way to write the function as long as the wraparound concern was addressed."}, {"owner": {"reputation": 1431, "user_id": 1258302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r06hH.jpg?s=128&g=1", "display_name": "yellowantphil", "link": "https://stackoverflow.com/users/1258302/yellowantphil"}, "edited": false, "score": 2, "creation_date": 1470767533, "post_id": 38857155, "comment_id": 65080199, "body": "The answers are confusing because you changed the question after you got two answers."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1470767882, "post_id": 38857155, "comment_id": 65080369, "body": "&quot;is this a valid optimization for typical hardware and C compilers?&quot; and <code>unsigned(a+b)</code> are confusing  as that code does not compile in C."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1470768356, "post_id": 38857155, "comment_id": 65080596, "body": "@PSkocik Unclear, what is the usefulness of <code>int a; ... (int)((unsigned int)a)</code>? Is not the result typically <code>a</code>?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1610, "user_id": 502189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cba4d424ecb01d45a923636bef46cc7?s=128&d=identicon&r=PG", "display_name": "rjp", "link": "https://stackoverflow.com/users/502189/rjp"}, "edited": false, "score": 1, "creation_date": 1470768808, "post_id": 38857155, "comment_id": 65080809, "body": "@rjp: I agree it&#39;s sloppy and a bad idea to just talk about instruction counts for micro-optimizations like this.  But in this case, the instructions in question are all cheap (according to the compiler output: <a href=\"https://godbolt.org/g/v9XcyE\" rel=\"nofollow noreferrer\">godbolt.org/g/v9XcyE</a>), and if anything the version with more instructions uses a more expensive instruction.  (<code>sar</code> can&#39;t run on as many execution ports on Intel SnB-family CPUs.)  Two independent <code>add</code>s are cheaper than <code>mov</code> / <code>sar</code> / <code>xor</code> / <code>sub</code>.  clang uses mov/neg/cmov, which is still more expensive (especially on pre-Broadwell).  (See the x86 tag wiki)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1470769368, "post_id": 38857155, "comment_id": 65081118, "body": "Suggest <code>inline bool f2(int a, int b) { return a+b &lt;= 2u * b; }</code>  (<code>bool</code> and <code>2u</code>)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1470769399, "post_id": 38857155, "comment_id": 65081137, "body": "And BTW, the original <code>_Bool f2_unsigned( int a, unsigned b ) { return (unsigned)(a+b)&lt;=2*b; }</code> compiles to identical x86-64 code as the updated <code>_Bool f2_signed( int a, int b ) { return (unsigned)(a+b)&lt;=2*b; }</code>.  <a href=\"https://godbolt.org/g/3MdK8o\" rel=\"nofollow noreferrer\">godbolt.org/g/3MdK8o</a> (also including chux&#39;s version).  (I assume you&#39;d only use this as an inline function, so using <code>_Bool</code> to indicate to the caller that the return value is guaranteed to be a zero or one, not just any non-zero value doesn&#39;t gain anything.)  <code>_Bool</code> is a C99 built-in type; <code>#include &lt;stdbool.h&gt;</code> for the typedef for <code>bool</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1470769533, "post_id": 38857155, "comment_id": 65081190, "body": "@Peter Cordes  Any particular reason/need for the <code>(unsigned)</code> cast?  <code>_Bool f2_unsigned( int a, unsigned b ) { return a+b &lt;= 2*b; }</code> looks sufficient."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1470769609, "post_id": 38857155, "comment_id": 65081235, "body": "@chux: no.  Those are the OP&#39;s code, not my suggestion.  Just pointing out that the controversial edit that changes the question from a language lawyer perspective doesn&#39;t change the asm for gcc targeting x86, for whatever that&#39;s worth.  (And no, that doesn&#39;t mean it&#39;s necessarily safe or the same after inlining).  Your <code>2*b</code> or <code>2u * b</code> code compiles to the same good code as the OP&#39;s more efficient possibly-unsafe version."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1470771814, "post_id": 38857155, "comment_id": 65082490, "body": "@chux: Yes, thanks.  Using <code>2u</code> does resolve a &quot;sign-compare&quot; warning in my <code>f3()</code>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1470781627, "post_id": 38857155, "comment_id": 65086740, "body": "Oops, update: making <code>b</code> signed does change the asm for <code>f1</code>, but not for <code>f2</code>.  This is because <code>abs(int)</code> still returns <code>int</code>, so <code>f1(int, int)</code> does a signed compare (<code>setle</code> instead of <code>setbe</code>), like <code>f3</code>.  <a href=\"https://godbolt.org/g/bOZsa1\" rel=\"nofollow noreferrer\">All versions on the Godbolt compiler explorer</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1470840434, "post_id": 38857155, "comment_id": 65114815, "body": "Have you consider a macro? <code>#define F4(a,b) ((unsigned)((a)+(b)) &lt;= 2u*(b))</code>?"}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1470887234, "post_id": 38857155, "comment_id": 65134330, "body": "@chux: I&#39;m assuming that the functions would be inlined by the compiler -- but if not, I would probably use a macro like the one you suggest."}], "answers": [{"comments": [{"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 2, "creation_date": 1470765790, "post_id": 38857537, "comment_id": 65079268, "body": "Arr ... that edit changing the b type to a signed integer came while I wrote the answer."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1470766087, "post_id": 38857537, "comment_id": 65079414, "body": "I really want to roll it back as it makes this answer and all of the comments pointless."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1470766317, "post_id": 38857537, "comment_id": 65079535, "body": "@NathanOliver: The comments noted that the cast was superfluous, but that didn&#39;t affect the point of the question."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 1, "creation_date": 1470766484, "post_id": 38857537, "comment_id": 65079638, "body": "@nobar: The cast was superfluous because it applied <i>after</i> promotion happened while evaluating <code>a+b</code>.  Changing <code>b</code>&#39;s type <i>does</i> have an effect.  Read carefully what people are saying about how promotion happens when a binary operator has two operands of different types."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1470766786, "post_id": 38857537, "comment_id": 65079816, "body": "@nobar The edit changes the behavior of the entire code block as unsigned integer overflow is well defined.  Now that you do not have that you have a different question."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 5, "creation_date": 1470767150, "post_id": 38857537, "comment_id": 65079988, "body": "@EOF I tend to disagree: &quot; \u2014 The rank of any unsigned integer type shall equal the rank of the corresponding signed integer type, if any.&quot; Equal rank means conversion to unsigned."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1470816675, "post_id": 38857537, "comment_id": 65098044, "body": "@EOF No problem, I had to look it up myself ^^ I reworded it to be hopefully less hand waving but still concise."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1470840513, "post_id": 38857537, "comment_id": 65114871, "body": "&quot;Using a signed type .. does not make much sense&quot; -- I think this question demonstrated that using <code>unsigned</code> types is generally a bad idea.  Look at the confusion it caused.  I actually only did it for documentation purposes -- because it was more concise than adding <code>assert(bound&gt;=0)</code>, but it turned out to be a mistake.  In my opinion, <a href=\"http://stackoverflow.com/q/38861423/86967\">the &quot;usual arithmetic conversions&quot; are not sensible</a> if you assume that arithmetic is more likely to involve negative values than to overflow signed values."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1470842769, "post_id": 38857537, "comment_id": 65116471, "body": "@nobar This question demonstrated that editing the question (or not posting the actual code one is working on in the first place) may indeed cause lot&#39;s of confusion ;) But I agree that the conversions are confusing. Banning <code>unsigned</code> is a far too drastic move IMO, though."}], "tags": [], "owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "is_accepted": false, "score": 3, "last_activity_date": 1470816200, "last_edit_date": 1470816200, "creation_date": 1470765657, "answer_id": 38857537, "question_id": 38857155, "link": "https://stackoverflow.com/questions/38857155/threshold-an-absolute-value/38857537#38857537", "title": "Threshold an absolute value", "body": "<p>Starting with the original code with signature</p>\n\n<pre><code>char f2( int a, unsigned b );\n</code></pre>\n\n<p>this contains the expression </p>\n\n<pre><code>a + b\n</code></pre>\n\n<p>Since one of these operands has a signed and the other an (corresponding) unsigned integer type (thus they have the same \"integer conversion rank\"), then - following the \"Usual arithmetic conversions\" (\u00a7 6.3.1.8) - the operand with signed integer type is converted to the unsigned type of the other operand.</p>\n\n<p>Conversion to an unsigned integer type is well defined, even if the value in question cannot be represented by the new type:</p>\n\n<blockquote>\n  <p>[..] if the new type is unsigned, the value is converted by repeatedly adding or subtracting one more than the maximum value that can be represented in the new type until the value is in the range of the new type. 60</p>\n  \n  <p>\u00a7 6.3.1.3/2</p>\n</blockquote>\n\n<p><em>Footnote 60 just says that the described arithmetic works with the mathematical value, not the typed one.</em></p>\n\n<p>Now, with the updated code</p>\n\n<pre><code>char f2_updated( int a, int b ); // called f3 in the question\n</code></pre>\n\n<p>things would look different. But since <code>b</code> is assumed to be non-negative, and assuming that <code>INT_MAX &lt;= UINT_MAX</code> you can convert <code>b</code> to an <code>unsigned</code> without fearing it to have a different mathematical value afterwards. Thus you could write</p>\n\n<pre><code>char f2_updated( int a, int b ) {\n  return f2(a, (unsigned)b); // cast unnecessary but to make it clear\n}\n</code></pre>\n\n<p>Looking again at <code>f2</code> the expression <code>2*b</code> further limits the allowed range of <code>b</code> to be not larger than <code>UINT_MAX/2</code> (otherwise the mathematical result would be wrong).\nSo as long as you stay within these bounds, every thing is fine.</p>\n\n<p><em>Note: Unsigned types do not overflow, they \"wrap\" according to modular arithmetic.</em></p>\n\n<p><em>Quotes from N1570 (a C11 working draft)</em></p>\n\n<hr>\n\n<p>A final remark:</p>\n\n<p>IMO the only really reasonable choice to write this function is as</p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n#include &lt;assert.h&gt;\nbool abs_bounded(int value, unsigned bound) {\n  assert(bound &lt;= (UINT_MAX / 2));\n  /* NOTE: Casting to unsigned makes the implicit conversion that\n           otherwise would happen explicit. */\n  return ((unsigned)value + bound) &lt;= (2 * bound);\n}\n</code></pre>\n\n<p>Using a signed type for the <code>bound</code> does not make much sense, because the absolute of a value cannot be less than a negative number. <code>abs_bounded(value, something_negative)</code> would be always false. If there's the possibility of a negative bound, then I'd catch this outside of this function (otherwise it does \"too much\"), like:</p>\n\n<pre><code>int some_bound;\n// ...\nif ((some_bound &gt;= 0) &amp;&amp; abs_bounded(my_value, some_bound)) {\n  // yeeeha\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1470775182, "post_id": 38857702, "comment_id": 65084071, "body": "This answer seems to address only the boundary issues.  I attempted to explicitly exclude these by saying &quot;no risk of overflow&quot;."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1470823385, "post_id": 38857702, "comment_id": 65102479, "body": "@nobar: you only did so after I pointed them out.  Modifying the question in a way that makes the answers irrelevant should only be done with EDIT: paragraphs.  I answered the <b>valid</b> part of the question and hinted as to when it is <b>invalid</b>. See my updated answer for the <b>optimization</b> part of the question."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1470823750, "last_edit_date": 1470823750, "creation_date": 1470766261, "answer_id": 38857702, "question_id": 38857155, "link": "https://stackoverflow.com/questions/38857155/threshold-an-absolute-value/38857702#38857702", "title": "Threshold an absolute value", "body": "<p>To determine if the 2 expressions are equivalent for your purpose, you must study the domain of definition:</p>\n\n<ul>\n<li><p><code>abs(a) &lt;= b</code> is defined for all values of <code>int a</code> and <code>unsigned b</code>, with just one special case for <code>a = INT_MIN;</code>. On 2s complement architectures, <code>abs(INT_MIN)</code> is not defined but most likely evaluates to <code>INT_MIN</code>, which converted to <code>unsigned</code> as required for the <code>&lt;=</code> with an <code>unsigned</code> value, yields the correct value.</p></li>\n<li><p><code>(unsigned)(a+b) &lt;= 2*b</code> may produce a different result for <code>b &gt; UINT_MAX/2</code>.  For example, it will evaluate to false for <code>a = 1</code> and <code>b = UINT_MAX/2+1</code>. There might be more cases where you alternate formula gives an incorrect result.</p></li>\n</ul>\n\n<p><strong>EDIT:</strong> OK, the question was edited... and <code>b</code> is now an <code>int</code>.</p>\n\n<p>Note that <code>a+b</code> invokes undefined behavior in case of overflow and the same for <code>2*b</code>.  So you make the assumption that neither <code>a+b</code> nor <code>2*b</code> overflow.  Furthermore, if <code>b</code> is negative, you little trick does not work.</p>\n\n<p>If <code>a</code> is in the range <code>-INT_MAX/2..INT_MAX/2</code> and <code>b</code> in the range <code>0..INT_MAX/2</code>, it seems to function as expected.  The behavior is identical in C and C++.</p>\n\n<p>Whether it is an optimization depends completely on the compiler, command line options, hardware capabilities, surrounding code, inlining, etc.  You already address this part and tell us that you shave one or two instructions... Just remember that this kind of micro-optimization is not absolute.  Even counting instructions does not necessarily help find the <strong>best</strong> performance.  Did you perform some benchmarks to measure if this <em>optimization</em> is worthwhile? Is the difference even measurable?</p>\n\n<p>Micro-optimizing such a piece of code is self-defeating: it makes the code less readable and potentially incorrect. <code>b</code> might not be negative in the current version, but if the next maintainer changes that, he/she might not see the potential implications.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1470774334, "post_id": 38859234, "comment_id": 65083668, "body": "To make no <code>UINT_MAX &gt; INT_MAX</code> assumption, use <code>return (a &gt;= 0 &amp;&amp; a &lt;= b) || (b &amp;&amp; a &lt; 0 &amp;&amp; -1 - a &lt;= b-1) || (b==0 &amp;&amp; a== 0);</code>  If <code>b</code> is a constant, much code will optimize out."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1470773809, "last_edit_date": 1470773809, "creation_date": 1470772010, "answer_id": 38859234, "question_id": 38857155, "link": "https://stackoverflow.com/questions/38857155/threshold-an-absolute-value/38859234#38859234", "title": "Threshold an absolute value", "body": "<p>As OP wants fast and portable code (and <code>b</code> is positive), it <em>first</em> makes sense to code safely: </p>\n\n<pre><code>// return abs(a) &lt;= b;\ninline bool f1_safe(int a, unsigned b ) { \n  return (a &gt;= 0 &amp;&amp; a &lt;= b) || (a &lt; 0 &amp;&amp; 0u - a &lt;= b);\n}\n</code></pre>\n\n<p>This works for <strong>all</strong> <code>a,b</code> (assuming <code>UINT_MAX &gt; INT_MAX</code>).  Next, compare alternatives using an <em>optimized</em> compile (let the compiler do what it does best).</p>\n\n<hr>\n\n<p>The following slight variation on OP's code will work in C/C++ but risks portability issues unless \"Assuming non-negative b and no risk of overflow\" can be certain on <strong>all</strong> target machines.</p>\n\n<pre><code>bool f2(int a, unsigned b) { return a+b &lt;= b*2; }\n</code></pre>\n\n<p>In the end, OP goal of fast and portable code may find code the works optimally for the select platform, but not with others - such is micro-optimization.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1470792402, "post_id": 38862427, "comment_id": 65089254, "body": "You could be more specific and say &quot;two&#39;s complement platforms&quot;, not just &quot;compliant platforms&quot;, if that&#39;s the requirement.  That latter is like saying &quot;it works on platforms where it works&quot;.  What happens when you cast a negative <code>int</code> to unsigned on a one&#39;s complement or sign/magnitude machine?  And is this code still safe on such a machine?  It&#39;s still useful as long as it&#39;s free of possible signed overflows or other UB, but it would be interesting to know if it&#39;s safe in general, or exactly where it would go wrong on non-two&#39;s complement C implementations."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1470792803, "post_id": 38862427, "comment_id": 65089322, "body": "@PeterCordes: By &quot;compliant&quot;, I meant &quot;language-standard compliant&quot;.  I think the standard pretty-much implies two&#39;s complement, without out-right requiring it.  As I understand it, weird hardware would have to use workarounds to achieve language compliance.  Workarounds like &quot;repeatedly adding or subtracting one more than the maximum value that can be represented...&quot;."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1470793100, "post_id": 38862427, "comment_id": 65089377, "body": "Yeah, I haven&#39;t thought through the implications of that wording either, but I&#39;m not sure it&#39;s very expensive.  It probably takes at most one branch to implement that wording, and casts from unsigned to int don&#39;t happen all the time.  It&#39;s disappointing the standard refuses to actually standardize two&#39;s complement for anything other than atomic <code>int</code>, or stuff like arithmetic right shift of signed <code>int</code>.  The standard is too weak for its own good; I like what I&#39;ve seen of Rust so far (esp. built-in popcnt and stuff), but haven&#39;t really done anything with it."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1470863574, "post_id": 38862427, "comment_id": 65128126, "body": "The version which adds two <code>int</code> values without casting or coercing either to an unsigned type first will invoke UB for some combinations of operands.  Even thought the C89 rationale implies an intention that when code performs arithmetic on two int values and immediately converts the result to an unsigned type which is not larger than &quot;int&quot;, silent-wraparound two&#39;s-complement implementations should behave as though the operation was performed on unsigned values (since there&#39;s no defined case where it wouldn&#39;t) some compilers use integer overflow even in such cases as an excuse for wackiness."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1470864255, "post_id": 38862427, "comment_id": 65128477, "body": "One of the problems faced by the authors of C89 was the fact that some implementations promoted short unsigned types to int, while others promoted to unsigned.  It&#39;s too bad C89 didn&#39;t resolve this issue by defining qualifiers to distinguish e.g. 16-bit types that represent numbers 0-65535 from 16-bit types that represent mod-65536 equivalence classes.  Unqualified unsigned types could then behave in Implementation-defined fashion, while code wanting numbers or modular arithmetic could specify what it wanted."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1470886947, "post_id": 38862427, "comment_id": 65134244, "body": "@supercat: I&#39;m assuming you&#39;re talking about signed integer overflow when you mention UB.  I&#39;m not concerned about that here.  I figure UB on signed integer overflow is a reasonable outcome.  It&#39;s up to the programmer to make sure the type is large enough for the math."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1470927459, "post_id": 38862427, "comment_id": 65158518, "body": "@nobar: When the C Standard was written, and for a long time after, the majority of (e.g. 16-bit) compilers would have processed f3(16384,24576) by performing an addition that yields either 40960 or -24576 and a multiplication that yields either 49152 or -16384.  It would then convert both results to unsigned (yielding 40960 and 49152, respectively), and performed the comparison.  Recently, however, it has become fashionable for compilers to treat integer overflow--even in formerly-benign situations like the above--in ways that can cause arbitrary side-effects on other code."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1491882273, "post_id": 38862427, "comment_id": 73736563, "body": "Related: <a href=\"http://stackoverflow.com/q/43336218/86967\">Why does C++ standard specify signed integer be cast to unsigned in binary operations with mixed signedness?</a>"}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1582999511, "post_id": 38862427, "comment_id": 106972352, "body": "Whether or not these, and related, operations are &quot;undefined behavior&quot; is, um, complicated: <a href=\"https://stackoverflow.com/a/17205195/86967\">signed overflow is UB</a>, <a href=\"https://stackoverflow.com/q/16188263/86967\">signed overflow is UB</a>.  When talking about UB, it is necessary to be precise about the details of the operation."}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1583000411, "post_id": 38862427, "comment_id": 106972662, "body": "For shift-left it is even more confusing (or version dependent): <a href=\"https://stackoverflow.com/q/3784996\">stackoverflow.com/q/3784996</a>"}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1583001882, "post_id": 38862427, "comment_id": 106973102, "body": "Is this undefined behavior? <a href=\"https://stackoverflow.com/q/60455240/86967\">unsigned long cannot hold the correct number over 2,147,483,647</a>"}], "tags": [], "owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "is_accepted": false, "score": 1, "last_activity_date": 1470843283, "last_edit_date": 1495540951, "creation_date": 1470788810, "answer_id": 38862427, "question_id": 38857155, "link": "https://stackoverflow.com/questions/38857155/threshold-an-absolute-value/38862427#38862427", "title": "Threshold an absolute value", "body": "<p>Yes, this is portable to compliant platforms.  The conversion from signed to unsigned is well defined:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/37450336/86967\">Conversion between signed integer and unsigned integer</a></li>\n<li><a href=\"https://stackoverflow.com/q/4975340/86967\">int to unsigned int conversion</a></li>\n<li><a href=\"https://stackoverflow.com/q/50605\">Signed to unsigned conversion in C - is it always safe?</a></li>\n</ul>\n\n<p>The description in the C spec is a bit contrived:</p>\n\n<blockquote>\n  <p>if the new type is unsigned, the value is converted by repeatedly\n  adding or subtracting one more than the maximum value that can be\n  represented in the new type until the value is in the range of the new\n  type.</p>\n</blockquote>\n\n<p>The <a href=\"http://eel.is/c++draft/conv#integral-2\" rel=\"nofollow noreferrer\">C++ spec</a> addresses the same conversion in a more sensible way:</p>\n\n<blockquote>\n  <p>In a two's complement representation, this conversion is conceptual\n  and there is no change in the bit pattern</p>\n</blockquote>\n\n<hr>\n\n<p>In the question, <code>f2()</code> and <code>f3()</code> achieve the same results in a <em>slightly</em> different way.</p>\n\n<ul>\n<li>In <code>f2()</code> the presence of the <code>unsigned</code> operand causes a conversion of the <code>signed</code> operand as required <a href=\"http://eel.is/c++draft/expr#11\" rel=\"nofollow noreferrer\">here</a> for C++.  The unsigned addition may-or-may-not then result in a wrap-around past zero, which is also well defined [citation needed].</li>\n<li>In <code>f3()</code> the addition occurs in signed representation with no trickiness, and then the result is (explicitly) converted to unsigned.  So  this is slightly simpler than <code>f2()</code> (and also more clear).</li>\n</ul>\n\n<p>In both cases, the you end up with the same unsigned representation of the sum, which can then be compared (as unsigned) to <code>2*b</code>.  And the <em>trick</em> of treating a signed value as an unsigned type allows you to check a two-sided range with only a single comparison.  Note also that this is a bit more flexible than using the <code>abs()</code> function since the trick doesn't require that the range be centered around zero.</p>\n\n<hr>\n\n<h2>Commentary on the \"usual arithmetic conversions\"</h2>\n\n<p>I think this question demonstrated that using unsigned types is generally a bad idea. Look at the confusion it caused here.</p>\n\n<p>It can be tempting to use <code>unsigned</code> for documentation purposes (or to take advantage of the shifted value range), but due to the conversion rules, this may tend to be a mistake. In my opinion, the \"usual arithmetic conversions\" are not sensible if you assume that arithmetic is more likely to involve negative values than to overflow signed values.</p>\n\n<p>I asked this followup question to clarify the point: <a href=\"https://stackoverflow.com/q/38861423/86967\">mixed-sign integer math depends on variable size</a>.  One new thing that I have learned is that mixed-sign operations are <em>not</em> generally portable because the conversion type will <a href=\"http://eel.is/c++draft/conv.prom#1\" rel=\"nofollow noreferrer\">depend on the size relative to that of <code>int</code></a>.</p>\n\n<p>In summary: <em>Using type declarations or casts to perform unsigned operations is a low-level coding style that should be approached with the requisite caution.</em></p>\n"}], "owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "answer_count": 4, "score": 6, "last_activity_date": 1470843283, "creation_date": 1470764105, "last_edit_date": 1470770423, "question_id": 38857155, "link": "https://stackoverflow.com/questions/38857155/threshold-an-absolute-value", "title": "Threshold an absolute value", "body": "<p>I have the following function:</p>\n\n<pre><code>char f1( int a, unsigned b ) { return abs(a) &lt;= b; }\n</code></pre>\n\n<p>For execution speed, I want to rewrite it as follows:</p>\n\n<pre><code>char f2( int a, unsigned b ) { return (unsigned)(a+b) &lt;= 2*b; } // redundant cast\n</code></pre>\n\n<p>Or alternatively with this signature that could have subtle implications even for non-negative <code>b</code>:</p>\n\n<pre><code>char f3( int a, int b )      { return (unsigned)(a+b) &lt;= 2*b; }\n</code></pre>\n\n<p>Both of these alternatives work under a simple test on one platform, but I need it to portable.  Assuming non-negative <code>b</code> and no risk of overflow, is this a valid optimization for typical hardware and C compilers?  Is it also valid for C++?</p>\n\n<hr>\n\n<p><em>Note: As C++ on gcc 4.8 x86_64 with <code>-O3</code>, <code>f1()</code> uses 6 machine instructions and <code>f2()</code> uses 4.  The instructions for <code>f3()</code> are identical to those for <code>f2()</code>.  Also of interest: if <code>b</code> is given as a literal, both functions compile to 3 instructions that directly map to the operations specified in <code>f2()</code>.</em></p>\n"}, {"tags": ["c", "windows", "mingw", "pdcurses"], "comments": [{"owner": {"reputation": 201, "user_id": 6566675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lDqPG.png?s=128&g=1", "display_name": "clarasoft-it", "link": "https://stackoverflow.com/users/6566675/clarasoft-it"}, "edited": false, "score": 0, "creation_date": 1470766024, "post_id": 38857064, "comment_id": 65079383, "body": "The GLYPHSET structure is defined in wingdi.h. Perhaps you did not include windows.h ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6696846"}, "reply_to_user": {"reputation": 201, "user_id": 6566675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lDqPG.png?s=128&g=1", "display_name": "clarasoft-it", "link": "https://stackoverflow.com/users/6566675/clarasoft-it"}, "edited": false, "score": 0, "creation_date": 1470863337, "post_id": 38857064, "comment_id": 65128027, "body": "It is really strange, but this file includes windows.h..."}, {"owner": {"reputation": 201, "user_id": 6566675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lDqPG.png?s=128&g=1", "display_name": "clarasoft-it", "link": "https://stackoverflow.com/users/6566675/clarasoft-it"}, "edited": false, "score": 0, "creation_date": 1470863897, "post_id": 38857064, "comment_id": 65128285, "body": "you couid do a word search for GLYPHSET in the include files directory to find out in which header file it is defined and then include it"}], "owner": {"user_type": "does_not_exist", "display_name": "user6696846"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1470763746, "creation_date": 1470763746, "question_id": 38857064, "link": "https://stackoverflow.com/questions/38857064/pdcurses-win32a-build-with-mingw", "title": "PDCurses Win32a build with mingw", "body": "<p>I try to build PDCurses using MinGW, but have a problem in the second file which is specific for win32a:</p>\n\n<pre><code>..PDCurses-master\\win32a&gt;mingw32-make -f mingwin32.mak WIDE=Y UTF8=Y\n\n...\ngcc -c -O4 -Wall -I.. -DPDC_WIDE -DPDC_FORCE_UTF8 ../pdcurses/window.c\ngcc -c -O4 -Wall -I.. -DPDC_WIDE -DPDC_FORCE_UTF8 ../pdcurses/debug.c\ngcc -c -O4 -Wall -I.. -DPDC_WIDE -DPDC_FORCE_UTF8 ../win32a/pdcclip.c\ngcc -c -O4 -Wall -I.. -DPDC_WIDE -DPDC_FORCE_UTF8 ../win32a/pdcdisp.c\n../win32a/pdcdisp.c:451:1: error: unknown type name 'GLYPHSET'\n GLYPHSET *PDC_unicode_range_data = NULL;\n ^\n</code></pre>\n\n<p>And some other errors in lines 450 - 470. \nI have already reinstall MinGW, but the problem is the same. What am i doing wrong?</p>\n"}, {"tags": ["c", "getchar", "puts"], "comments": [{"owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "edited": false, "score": 5, "creation_date": 1470760082, "post_id": 38856025, "comment_id": 65076269, "body": "It&#39;s not <a href=\"http://www.tutorialspoint.com/cprogramming/c_strings.htm\" rel=\"nofollow noreferrer\"><code>\\0</code>-terminated</a>"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 1, "creation_date": 1470762138, "post_id": 38856025, "comment_id": 65077448, "body": "The word &quot;time&quot; is just what&#39;s left over in the memory occupied by <code>word</code>, it&#39;s a complete coincidence."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1470762423, "post_id": 38856025, "comment_id": 65077588, "body": "<code>getchar</code> returns an <code>int</code>, not a <code>char</code> intentionally!"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1470823983, "post_id": 38856025, "comment_id": 65102883, "body": "@Iamnotgoodatfindingname: can you accept one of the answers by clicking on the grey checkmark below its score?"}], "answers": [{"comments": [{"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 2, "creation_date": 1470762274, "post_id": 38856614, "comment_id": 65077514, "body": "<code>0</code> works just as well as <code>&#39;\\0&#39;</code>. I only mention it in case you come across it in other code."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1470770032, "post_id": 38856614, "comment_id": 65081491, "body": "Recommend <code>int ch = getchar() ... while(ch != &#39;\\n&#39; &amp;&amp; ch != EOF &amp;&amp; i++ &lt; 100){</code>"}], "tags": [], "owner": {"reputation": 2630, "user_id": 4065269, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/90c9cd69a6663c31758d6cd6043dfcc3?s=128&d=identicon&r=PG&f=1", "display_name": "sps", "link": "https://stackoverflow.com/users/4065269/sps"}, "is_accepted": true, "score": 2, "last_activity_date": 1470763357, "last_edit_date": 1470763357, "creation_date": 1470762104, "answer_id": 38856614, "question_id": 38856025, "link": "https://stackoverflow.com/questions/38856025/puts-output-is-appended-time-string/38856614#38856614", "title": "puts() output is appended &quot;time&quot; string", "body": "<p><code>puts</code> expects a pointer to <code>string</code>. And a <code>string</code> needs to have a terminating <code>null character</code> - <code>\\0</code> - to signify where the string ends. </p>\n\n<p>But in your case, you did not write the <code>\\0</code> at the end to signify that the string ends there.</p>\n\n<p>You need to do:</p>\n\n<pre><code>char ch = getchar(), word[100], *p = word;\n\n/* Also check that you are not writing more than 100 chars */\nint i = 1;\nwhile(ch != '\\n' &amp;&amp; i++ &lt; 100){  \n    *(p++) = ch; \n    ch = getchar();\n}\n*p = '\\0'; /* write the terminaring null character */\nputs(word);\n</code></pre>\n\n<p>Before, when you were not writing the terminating null character you could not expect anything determinate to print. It could also have been <code>12345678901234567AnyOtherWord</code> or something. </p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1470770128, "post_id": 38857043, "comment_id": 65081546, "body": "Nice line consumption and <code>EOF</code> check."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1470763669, "creation_date": 1470763669, "answer_id": 38857043, "question_id": 38856025, "link": "https://stackoverflow.com/questions/38856025/puts-output-is-appended-time-string/38857043#38857043", "title": "puts() output is appended &quot;time&quot; string", "body": "<p>There are multiple issues in your code:</p>\n\n<ul>\n<li>You do not null terminate the string you pass to <code>puts()</code>, invoking undefined behavior... in your case, whatever characters happen to be present in <code>word</code> after the last one read from <code>stdin</code> are printed after these and until (hopefully) a <code>'\\0'</code> byte is finally found in memory.</li>\n<li>You read a byte from <code>stdin</code> into a <code>char</code> variable: this does not allow you to check for <code>EOF</code>, and indeed you do not.</li>\n<li>If you read a long line, you will write bytes beyond the end if the <code>word</code> array, invoking undefined behavior.  If the end of file is encountered before a <code>'\\n'</code> is read from <code>stdin</code>, you will definitely write beyond the end of the buffer...  Try for example giving an empty file as input for your program.</li>\n</ul>\n\n<p>Here is a corrected version:</p>\n\n<pre><code>char word[100];\nchar *p = word;\nint ch;\n\nwhile ((ch = getchar()) != EOF &amp;&amp; ch != '\\n') {\n    /* check for long line: in this case, we truncate the line */\n    if (p &lt; word + sizeof(word) - 1) {\n        *p++ = ch;\n    }\n}\n*p = '\\0';\nputs(word);\n</code></pre>\n"}], "owner": {"reputation": 381, "user_id": 6595960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7a52ac0134df5051893d34af75e9bda?s=128&d=identicon&r=PG&f=1", "display_name": "I am not good at finding name", "link": "https://stackoverflow.com/users/6595960/i-am-not-good-at-finding-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 38856614, "answer_count": 2, "score": 2, "last_activity_date": 1470767689, "creation_date": 1470760026, "last_edit_date": 1470767689, "question_id": 38856025, "link": "https://stackoverflow.com/questions/38856025/puts-output-is-appended-time-string", "title": "puts() output is appended &quot;time&quot; string", "body": "<p>I get very unexpected output from quite simple code</p>\n\n<pre><code>char ch = getchar(), word[100], *p = word;\n\nwhile (ch != '\\n') {\n    *(p++) = ch;\n    ch = getchar();\n}\nputs(word);\n</code></pre>\n\n<p>output of any 17 character input is appended by \"time\" like</p>\n\n<pre><code>12345678901234567time\n</code></pre>\n\n<p>if exceeds \"time\" is overwritten like</p>\n\n<pre><code>1234567890123456789me\n</code></pre>\n\n<p>Am I doing something wrong?</p>\n"}]