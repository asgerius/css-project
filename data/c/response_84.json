[{"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1471476822, "post_id": 39007753, "comment_id": 65367241, "body": "I think you meant <code>p[v]</code> instead of <code>*p(v+1)</code>. BTW, having a global variable called <code>i</code> is a bad idea. Something like <code>queue_count</code> or <code>queueIndex</code> would be better."}, {"owner": {"reputation": 19, "user_id": 6238282, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/661c6d285acbe35719970cbeb48c8c87?s=128&d=identicon&r=PG&f=1", "display_name": "Whatlahuhu", "link": "https://stackoverflow.com/users/6238282/whatlahuhu"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1471478007, "post_id": 39007753, "comment_id": 65367541, "body": "thank you !  it works, and it also can be  *(p + v). I also have another problem that is <code>char queue[100];</code>. I switch  <code>char queue[100];</code> to  <code>int queue[100];</code>"}], "answers": [{"tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": false, "score": 1, "last_activity_date": 1471478098, "creation_date": 1471478098, "answer_id": 39007974, "question_id": 39007753, "link": "https://stackoverflow.com/questions/39007753/error-called-object-is-not-a-function-or-function-pointer/39007974#39007974", "title": "error: called object is not a function or function pointer", "body": "<ul>\n<li>Returning <code>int*</code> converted from <code>char*</code> (converted from <code>char queue[100]</code>) is bad. Use <code>int</code> for <code>queue</code>'s elements.</li>\n<li>As the error message suggests, <code>*p(v+1)</code> is invalid because <code>p</code> is a pointer to not functions but <code>int</code>, so function call operator <code>()</code> cannot be used to it. To access <code>v</code>th element of <code>p</code>, you can use <code>p[v]</code>.</li>\n</ul>\n"}], "owner": {"reputation": 19, "user_id": 6238282, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/661c6d285acbe35719970cbeb48c8c87?s=128&d=identicon&r=PG&f=1", "display_name": "Whatlahuhu", "link": "https://stackoverflow.com/users/6238282/whatlahuhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6206, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1471478098, "creation_date": 1471476580, "question_id": 39007753, "link": "https://stackoverflow.com/questions/39007753/error-called-object-is-not-a-function-or-function-pointer", "title": "error: called object is not a function or function pointer", "body": "<p>I try to insert many values into a queue and delete the first value in the queue. \nHowever, I have an error when I want to print the queue after deleting values. </p>\n\n<p>There is my code:</p>\n\n<pre><code>char queue[100];\nint i=-1;\n\nint *delete_queue(int value){\n\n    int j;\n    for(j= 0; j&lt; 10; j++){\n    queue[j]= queue[j+1];   \n    }\n\n    return queue;\n\n}\n\nvoid insert_queue(int value){\n\n    i= i + 1;\n    queue[i] = value;\n\n}\n\nvoid print_queue(int *p){\n\n    int v;\n    for(v =0; v &lt; 5; v++){\n        printf(\"&gt;&gt; %d \\n\", *p(v+1) );\n    }\n\n}\n\nint main(int argc, char const *argv[])\n{\n    //int v ;\n    int *new_queue;\n    insert_queue(33);\n    insert_queue(22);\n    insert_queue(11);\n\n    new_queue= delete_queue(33);\n    print_queue(new_queue);\n    // for(v =0; v &lt; 5; v++){\n    //  printf(\"&gt;&gt; %d \\n\", *new_queue(v+1) );\n    // }\n\nreturn 0;\n}\n</code></pre>\n\n<p>The error is:</p>\n\n<pre><code>delete_queue_test.c: In function \u2018print_queue\u2019:\ndelete_queue_test.c:33:23: error: called object \u2018p\u2019 is not a function or  \nfunction pointer\nprintf(\"&gt;&gt; %d \\n\", *p(v+1) );\n                   ^\n</code></pre>\n\n<p>please help me fix it, thank you.</p>\n"}, {"tags": ["c", "package", "cross-compiling", "dependency-management", "openwrt"], "comments": [{"owner": {"reputation": 750, "user_id": 5308565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Khffd.jpg?s=128&g=1", "display_name": "Vasily G", "link": "https://stackoverflow.com/users/5308565/vasily-g"}, "edited": false, "score": 0, "creation_date": 1471944783, "post_id": 39007709, "comment_id": 65541616, "body": "Are you sure you have selected correct architecture in menuconfig? What does <code>file build_dir&#47;target-*&#47;scanReport_probe*&#47;scanReportProbe</code> say? Compare it to a binary from your openwrt device (e.g. copy <code>&#47;bin&#47;busybox</code> to your host machine and run <code>file</code> on it)."}, {"owner": {"reputation": 750, "user_id": 5308565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Khffd.jpg?s=128&g=1", "display_name": "Vasily G", "link": "https://stackoverflow.com/users/5308565/vasily-g"}, "edited": false, "score": 0, "creation_date": 1471945125, "post_id": 39007709, "comment_id": 65541873, "body": "Also, try removing <code>define Build&#47;Compile</code> clause and <code>CONFIGURE_VARS</code> assignment - the defaults should work well for you."}, {"owner": {"reputation": 72, "user_id": 2124310, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4a3a88306c7fab9c6835604c27802d62?s=128&d=identicon&r=PG", "display_name": "LuigiDB", "link": "https://stackoverflow.com/users/2124310/luigidb"}, "reply_to_user": {"reputation": 750, "user_id": 5308565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Khffd.jpg?s=128&g=1", "display_name": "Vasily G", "link": "https://stackoverflow.com/users/5308565/vasily-g"}, "edited": false, "score": 0, "creation_date": 1472233092, "post_id": 39007709, "comment_id": 65686068, "body": "Everything is configured correctly. I don&#39;t know why but compiling this repository git://git.openwrt.org/15.05/openwrt.git instead of the trunk solved the problem."}], "answers": [{"comments": [{"owner": {"reputation": 72, "user_id": 2124310, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4a3a88306c7fab9c6835604c27802d62?s=128&d=identicon&r=PG", "display_name": "LuigiDB", "link": "https://stackoverflow.com/users/2124310/luigidb"}, "edited": false, "score": 0, "creation_date": 1471478413, "post_id": 39007812, "comment_id": 65367648, "body": "After the installation every file is in the correct directory and i&#39; ve also tested without the init.d script just to be sure. The executable under the bin folder has execute permission <code>-rwxr-xr-x    1 root     root          1527 Aug 17 17:15 scanReportProbe</code> but also with <code>&#47;bin&#47;scanReportProbe</code> i receive the same error. I test also other repository that i found online and everyone gives me the same error."}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": false, "score": 0, "last_activity_date": 1471477381, "last_edit_date": 1471477381, "creation_date": 1471476963, "answer_id": 39007812, "question_id": 39007709, "link": "https://stackoverflow.com/questions/39007709/error-while-executing-cross-compiled-program-for-openwrt/39007812#39007812", "title": "Error while executing cross-compiled program for openwrt", "body": "<p>For <code>-ash</code>, IIRC, <code>ash</code> is a [boot] shell. It is saying that it can't find a particular command.</p>\n\n<p>So, it may be one of:</p>\n\n<p>(1) In your rc script section, you're doing <code>/etc/init.d/scanReportProbe enable</code> but the package you're building uses <code>scanReport_probe</code>. So, you may need to add or remove an <code>_</code> here or there and/or some other renames so things match up.</p>\n\n<p>(2) If the file structure you gave is the final one, I'm not sure the script is in the right directory.</p>\n\n<p>(3) Are the permissions for the script correct (i.e. has execute)?</p>\n"}], "owner": {"reputation": 72, "user_id": 2124310, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4a3a88306c7fab9c6835604c27802d62?s=128&d=identicon&r=PG", "display_name": "LuigiDB", "link": "https://stackoverflow.com/users/2124310/luigidb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1471477381, "creation_date": 1471476322, "question_id": 39007709, "link": "https://stackoverflow.com/questions/39007709/error-while-executing-cross-compiled-program-for-openwrt", "title": "Error while executing cross-compiled program for openwrt", "body": "<p>I'm trying to export a software to openwrt and i'm able to generate the ipk but the compiled file always gives me this error</p>\n\n<blockquote>\n  <p>-ash: scanReportProbe: not found</p>\n</blockquote>\n\n<p>I've tried everything but i'm not able to make it work. \nTo be complete this is what i have done to prepare the environment:</p>\n\n<pre><code>git clone git://github.com/openwrt/openwrt.git\ncd openwrt\n./scripts/feeds update -a\n./scripts/feeds install -a\nmake defconfig\nmake prereq\nmake menuconfig\n    [here i selected the package with the M and saved the configuration]\nmake tools/install\nmake toolchain/install\nmake package/scanReport_probe/compile\n</code></pre>\n\n<p>I have no idea of to fix this error so i need some hint of solution.</p>\n\n<p>I don't think that the error is in the code but in casse is needed this is my program:\nfile structure</p>\n\n<pre><code>scanReport_probe\n\u251c\u2500\u2500 LICENSE\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 data\n    \u2502   \u2514\u2500\u2500 THIS IS FOR DATA FILES.txt\n    \u251c\u2500\u2500 runScript\n    \u2502   \u2514\u2500\u2500 scanReportProbe\n    \u251c\u2500\u2500 scanReport_probe\n    \u2502   \u251c\u2500\u2500 a.c\n    \u2502   \u2514\u2500\u2500 makefile\n    \u2514\u2500\u2500 scanReport_probe.conf\n</code></pre>\n\n<p>makefile for openwrt</p>\n\n<pre><code>include $(TOPDIR)/rules.mk\n\n# name of package\n# version number of the sources you're using\n# how many times you've released a package based on the above version number\nPKG_NAME:=scanReport_probe\nPKG_VERSION:=1.0\nPKG_RELEASE:=1\nPKG_LICENSE:=MIT\n\n# sources will be unpacked into this directory (you shouldn't need to change this)\nPKG_BUILD_DIR:=$(BUILD_DIR)/$(PKG_NAME)-$(PKG_VERSION)\n\n#needed \ninclude $(INCLUDE_DIR)/package.mk\n\n\n# Metadata; information about what the package is for the ipkg listings\n# to keep things simple, a number of fields have been left at their defaults\n# and are not shown here.\ndefine Package/scanReport_probe\n    SECTION:=utils\n    CATEGORY:=Utilities\n    TITLE:=scanReport_probe\n    URL:=https://github.com/luigiDB/scan-report_probe\n    TITLE:=Scan in monitor mode probe over wifi channel with periodic report to a server through http post.\n    MAINTAINER:=Please refer to github repository page\nendef\n\ndefine Package/scanReport_probe/description\n    This is the best tool ever. \n    Scan probe over wifi and at regualar interval send results via http post.\nendef\n\n\ndefine Build/Prepare\n    mkdir -p $(PKG_BUILD_DIR)\n    $(CP) ./src/* $(PKG_BUILD_DIR)/\nendef\n\n\nCONFIGURE_VARS+= \\\n    CC=\"$(TOOLCHAIN_DIR)/bin/$(TARGET_CC)\"\n\n\ndefine Build/Compile\n    $(MAKE) -C $(PKG_BUILD_DIR)/scanReport_probe $(TARGET_CONFIGURE_OPTS)\nendef\n\n# We'll use the OpenWrt defaults to configure and compile the package. Otherwise we'd need to define\n# Build/Configure - commands to invoke a configure (or similar) script\n# Build/Compile - commands used to run make or otherwise build the source\n\ndefine Package/scanReport_probe/install\n    # Now that we have the source compiled (magic huh?) we need to copy files out of the source\n    # directory and into our ipkg file. These are shell commands, so make sure you start the lines\n    # with a TAB. $(1) here represents the root filesystem on the router.\n    # INSTALL_DIR, INSTALL_BIN, INSTALL_DATA are used for creating a directory, copying an executable, \n    # or a data file. +x is set on the target file for INSTALL_BIN, independent of it's mode on the host.\n\n    # make a directory for the config\n    $(INSTALL_DIR) $(1)/etc/scanReport_probe/\n\n    # copy the config\n    $(INSTALL_CONF) $(PKG_BUILD_DIR)/scanReport_probe.conf $(1)/etc/scanReport_probe\n\n    # make a directory for some random data files required by scanReport_probe\n    $(INSTALL_DIR) $(1)/usr/share/scanReport_probe\n\n    # copy the data files\n    $(INSTALL_DATA) $(PKG_BUILD_DIR)/data/* $(1)/usr/share/scanReport_probe\n\n    #make directory bin\n    $(INSTALL_DIR) $(1)/bin\n\n    # copy the binary\n    $(INSTALL_BIN) $(PKG_BUILD_DIR)/scanReport_probe/scanReportProbe $(1)/bin\n\n    #make the directory init.d in case isn't present\n    $(INSTALL_DIR) $(1)/etc/init.d\n\n    #copy script to init.d\n    $(INSTALL_BIN) $(PKG_BUILD_DIR)/runScript/scanReportProbe $(1)/etc/init.d    \nendef\n\n\n#runned post installation call the enable on the service\ndefine Package/scanReport_probe/postinst\n    #!/bin/sh\n    # check if we are on real system\n    if [ -z \"$${IPKG_INSTROOT}\" ]; then\n        echo \"Enabling rc.d symlink for scanReportProbe\"\n        /etc/init.d/scanReportProbe enable\n    fi\n    exit 0\nendef\n\n\n#runned pre uninstallation call the disable on the service\ndefine Package/scanReport_probe/prerm\n    #!/bin/sh\n    # check if we are on real system\n    if [ -z \"$${IPKG_INSTROOT}\" ]; then\n        echo \"Removing rc.d symlink for scanReportProbe\"\n        /etc/init.d/scanReportProbe disable\n    fi\n    exit 0\nendef\n\n$(eval $(call BuildPackage,scanReport_probe))\n</code></pre>\n\n<p>a.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void)\n{\n        printf(\"Hello World\\n\");\n        return 0;\n}\n</code></pre>\n\n<p>makefile for c program</p>\n\n<pre><code>PROFILE = -O2 -s\nCFLAGS = $(PROFILE)\nLDFLAGS = \n\nall: main\n\n# build it\nmain: a.o\n    $(CC) $(LDFLAGS) a.o -o scanReportProbe\n\na.o: a.c\n    $(CC) $(CFLAGS) -c a.c\n\n# clean it\nclean:\n    rm *.o a\n</code></pre>\n"}, {"tags": ["c", "linux", "linux-kernel", "linux-device-driver"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1471473336, "post_id": 39007266, "comment_id": 65366281, "body": "Physical addresses are meaningless outside the kernel."}, {"owner": {"reputation": 3198, "user_id": 1636521, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/2116626f42d8a2f87ee420ecefb1ec0c?s=128&d=identicon&r=PG", "display_name": "flashburn", "link": "https://stackoverflow.com/users/1636521/flashburn"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1471473718, "post_id": 39007266, "comment_id": 65366410, "body": "@Barmar I know. But that&#39;s not the question I was asking. The question still stands, what type I need to use in user space or what I need to include into my file in order to see the value of <code>physAddr</code>?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1471473725, "post_id": 39007266, "comment_id": 65366413, "body": "<code>unsigned long</code>? <a href=\"http://man.cx/virt_to_phys%289%29\" rel=\"nofollow noreferrer\">man.cx/virt_to_phys%289%29</a>"}], "answers": [{"comments": [{"owner": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 1, "creation_date": 1472164143, "post_id": 39007544, "comment_id": 65654831, "body": "...or a system with 32-bit Linux on 32-bit hardware with physical address extensions and all the memory above the 4GB boundary (<a href=\"http://www.ti.com/product/66AK2H14\" rel=\"nofollow noreferrer\">if you think I&#39;m joking...</a>)."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": false, "score": 1, "last_activity_date": 1471475007, "creation_date": 1471475007, "answer_id": 39007544, "question_id": 39007266, "link": "https://stackoverflow.com/questions/39007266/how-to-return-a-phys-addr-t-type-value-to-user-space/39007544#39007544", "title": "how to return a phys_addr_t type value to user space", "body": "<p>It's either 32 or 64 bits, unsigned.  See here: <a href=\"http://lxr.free-electrons.com/source/include/linux/types.h#L161\" rel=\"nofollow\">http://lxr.free-electrons.com/source/include/linux/types.h#L161</a></p>\n\n<p>You could probably use <code>intptr_t</code> to some extent, but I would be concerned if you end up running on a system with 32-bit Linux on 64-bit hardware.</p>\n"}, {"tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": true, "score": 3, "last_activity_date": 1471475079, "creation_date": 1471475079, "answer_id": 39007555, "question_id": 39007266, "link": "https://stackoverflow.com/questions/39007266/how-to-return-a-phys-addr-t-type-value-to-user-space/39007555#39007555", "title": "how to return a phys_addr_t type value to user space", "body": "<p>Under the full kernel source, in <code>include/linux/types.h</code> we have:</p>\n\n<pre><code>#ifdef CONFIG_PHYS_ADDR_T_64BIT\ntypedef u64 phys_addr_t;\n#else\ntypedef u32 phys_addr_t;\n#endif\n</code></pre>\n\n<p>So, to be safe, just use <code>u64</code>.</p>\n\n<p>Note that this definition is removed from <code>/usr/include/linux/types.h</code>.</p>\n\n<p>However, if you are writing a custom utility that interacts with a custom device and its custom driver, it is okay to skip the <code>/usr/include</code> versions and build directly against the version in (e.g.) <code>/usr/src/kernel/...</code>).</p>\n\n<p>This is not recommended for regular programs [of course]. But, if you are doing a hybrid system that has a lot of things going between the utility and the driver, you can craft it any way you'd like.</p>\n\n<p>For example, a realtime hidef video encoding platform I wrote code for did this. The driver sent data to the device. The device sent data back. The data was sent to the utility/control program which modified the data and sent it back, etc. This was all done with a <em>lot</em> of custom <code>ioctl</code> calls, so we could do whatever was required.</p>\n"}], "owner": {"reputation": 3198, "user_id": 1636521, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/2116626f42d8a2f87ee420ecefb1ec0c?s=128&d=identicon&r=PG", "display_name": "flashburn", "link": "https://stackoverflow.com/users/1636521/flashburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1177, "favorite_count": 0, "accepted_answer_id": 39007555, "answer_count": 2, "score": 1, "last_activity_date": 1471475079, "creation_date": 1471473214, "last_edit_date": 1471474793, "question_id": 39007266, "link": "https://stackoverflow.com/questions/39007266/how-to-return-a-phys-addr-t-type-value-to-user-space", "title": "how to return a phys_addr_t type value to user space", "body": "<p>I need my driver to return <code>phys_addr_t</code> type value through an <code>ioctl</code> call. I need to return this value through a struct which is passed through <code>arg</code>. The question is what type do I use in this struct?</p>\n\n<p>For example, say the following struct is passed through an arg</p>\n\n<pre><code>struct myStruct {\n  int input1;\n  char input2;\n  &lt;type&gt; physAddr;\n} ;\n\n\nsomeStruct.physAddr = virt_to_phys(virtAddr);\n</code></pre>\n\n<p><code>virt_to_phys</code> returns a <code>phys_addr_t</code>, however this type doesn't seem to exist in any of the standard includes. So my question is what type do I need to use in user space for <code>phys_addr_t</code>?</p>\n"}, {"tags": ["c", "disassembly"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1471471756, "post_id": 39007002, "comment_id": 65365760, "body": "The names? How they work? What they do? What is your problem? What have you found out by your search on the web and here or in the documentation of your compiler? How is that even related to gdb? And why should the disassembly show the symbol for <code>printf</code> if apparently <code>puts</code> is called?"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1471473412, "post_id": 39007002, "comment_id": 65366305, "body": "The whole point of standardized behaviour is that you can predict your your program will... behave. Compilers can do whatever they want in order to make the program behave as you expect."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1580923693, "post_id": 39007002, "comment_id": 106260477, "body": "near dup: <a href=\"//stackoverflow.com/a/60080136\">Compiler changes printf to puts</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471471914, "post_id": 39007026, "comment_id": 65365819, "body": "Well, they are not really &quot;built-in&quot;. gcc just knows about their semantics. And that only if compiling for a hosted environment."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471471999, "post_id": 39007026, "comment_id": 65365840, "body": "@Olaf: &quot;Built-in&quot; is probably not a strictly defined term, but these function have been officially referred to as &quot;built-in&quot; for quite a while already: <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1471472307, "post_id": 39007026, "comment_id": 65365956, "body": "@KeithThompson: Actually <code>printf</code> <b>is</b> in the list (do a search), <code>puts</code> too."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471472432, "post_id": 39007026, "comment_id": 65365992, "body": "@AnT: Ok, they state it like that. I find this confusing, though comparing with the gcc-special builtins."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471477650, "post_id": 39007026, "comment_id": 65367452, "body": "@Olaf: Ok, my mistake. I looked at the bulleted list starting with <code>__builtin_alloca</code> rather than searching for the name. But it seems odd to call it &quot;builti-n&quot; if the compiler just generates a call. I suppose it means that its <i>declaration</i>, not its <i>definition</i> is built-in, so the compiler can optimize calls."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1471477669, "post_id": 39007026, "comment_id": 65367460, "body": "@AnT: See my comment above (can&#39;t tag more than one person)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1471550172, "post_id": 39007026, "comment_id": 65403881, "body": "@KeithThompson: That was reason for my initial comment. &quot;Recognised functions&quot; might be a better term. But I somewhat doubt they are really interesetd in changing the documentation here. <i>sigh</i>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1471557955, "post_id": 39007026, "comment_id": 65407099, "body": "I&#39;m deleting my previous incorrect comment. <code>printf</code> and <code>puts</code> <i>are</i> in the list of &quot;built-in&quot; functions, but it seems that they&#39;re &quot;built-in&quot; only in the sense that the compiler recognizes them and treats them specially, not that the compiler will implement them via something other than a <code>call</code> instruction."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 11, "last_activity_date": 1471555169, "last_edit_date": 1471555169, "creation_date": 1471471826, "answer_id": 39007026, "question_id": 39007002, "link": "https://stackoverflow.com/questions/39007002/difference-between-printfplt-and-putsplt/39007026#39007026", "title": "Difference between printf@plt and puts@plt", "body": "<p>In GCC <code>printf</code> and <code>puts</code> are built-in functions. Which means that the compiler has full knowledge of their semantics. In such cases the compiler is free to replace a call to one function with an equivalent call to another, if it thinks that it will produce better (faster and/or more compact) code.</p>\n\n<p><code>puts</code> is a generally more efficient function since it does not have to parse and interpret a format string.</p>\n\n<p>This is exactly what happened in your case. Your first call to <code>printf</code> does not really need any <code>printf</code>-specific features. The format string you supplied to <code>printf</code> is trivial: it has no conversion specifiers in it. The compiler thought that your first call to <code>printf</code> is better served with an equivalent call to <code>puts</code>.</p>\n\n<p>Meanwhile, your second call to <code>printf</code> makes non-trivial use of <code>printf</code> format string, i.e. it relies on <code>printf</code>-specific features. </p>\n\n<p>(Some rather thorough research of this specific matter from 2005: <a href=\"http://www.ciselant.de/projects/gcc_printf/gcc_printf.html\" rel=\"noreferrer\">http://www.ciselant.de/projects/gcc_printf/gcc_printf.html</a>)</p>\n"}, {"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 4, "last_activity_date": 1471471989, "creation_date": 1471471989, "answer_id": 39007064, "question_id": 39007002, "link": "https://stackoverflow.com/questions/39007002/difference-between-printfplt-and-putsplt/39007064#39007064", "title": "Difference between printf@plt and puts@plt", "body": "<p>I don't know about the <code>@plt</code> part, but <code>printf</code> and <code>puts</code> are simply two different standard library functions.  <code>printf</code> takes a format string and zero or more other parameters, possibly of different types. <code>puts</code> takes just a string and prints it, followed by a newline. Consult any C reference for more information, or type</p>\n\n<pre><code>man 3 printf\nman 3 puts\n</code></pre>\n\n<p>assuming you're on a Unix-like system with man pages installed.  (<code>man printf</code> without the <code>3</code> will show you the <code>printf</code> <em>command</em>; you want the <code>printf</code> <em>function</em>.)</p>\n\n<p>Your compiler is able to optimize the call</p>\n\n<pre><code>printf(\"Hello, world\\n\");\n</code></pre>\n\n<p>to the equivalent of:</p>\n\n<pre><code>puts(\"Hello, world\");\n</code></pre>\n\n<p>because it knows what both functions do, so it can determine that they do exactly the same thing.</p>\n\n<p>It can't optimize</p>\n\n<pre><code>printf(\"Hello Word %d\\n\", a);\n</code></pre>\n\n<p>because the value of <code>a</code> is unknown at compile time, so it doesn't print a fixed string. (It might figure it out at higher optimization levels by observing that <code>a</code> is never modified after its initialization).</p>\n\n<p>The disassembler is merely showing you the code generated by the compiler.</p>\n\n<p>(Incidentally, <code>void main(void)</code> is incorrect; use <code>int main(void)</code>.)</p>\n"}, {"tags": [], "owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "is_accepted": false, "score": 2, "last_activity_date": 1471473831, "creation_date": 1471473831, "answer_id": 39007362, "question_id": 39007002, "link": "https://stackoverflow.com/questions/39007002/difference-between-printfplt-and-putsplt/39007362#39007362", "title": "Difference between printf@plt and puts@plt", "body": "<p>The <code>puts</code> and <code>printf</code> functions appear to have the same address because you are looking at <strong>stubs</strong>, and not the real functions.  These stubs load an address from the procedure link table (what the <code>@plt</code> suffix refers to) and then call it.</p>\n\n<p>I'm disassembling a program, and see that it has stubs for both <code>printf</code> and <code>puts</code>:</p>\n\n<pre><code>08048370 &lt;printf@plt&gt;:\n 8048370:       ff 25 04 a0 04 08       jmp    *0x804a004\n 8048376:       68 08 00 00 00          push   $0x8\n 804837b:       e9 d0 ff ff ff          jmp    8048350 &lt;_init+0x3c&gt;\n\n08048380 &lt;puts@plt&gt;:\n 8048380:       ff 25 08 a0 04 08       jmp    *0x804a008\n 8048386:       68 10 00 00 00          push   $0x10\n 804838b:       e9 c0 ff ff ff          jmp    8048350 &lt;_init+0x3c&gt;\n</code></pre>\n\n<p>As you can see, the real functions are somewhere else, and these stubs are only generated for the functions that your program actually uses. If you have a program which calls only one function  and then change it from <code>printf</code> to <code>puts</code>, it's not suprising that the one and only stub is at the same address. The program I just disassembled calls both <code>printf</code> and <code>puts</code>, and so has stubs for both, and consequently they have different addresses.</p>\n"}], "owner": {"reputation": 323, "user_id": 5879125, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56ff28b8a2b0acbd74285f8b22a5f8df?s=128&d=identicon&r=PG&f=1", "display_name": "Berat Postalcioglu", "link": "https://stackoverflow.com/users/5879125/berat-postalcioglu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2591, "favorite_count": 3, "accepted_answer_id": 39007026, "answer_count": 3, "score": 5, "last_activity_date": 1471557817, "creation_date": 1471471624, "last_edit_date": 1471557817, "question_id": 39007002, "link": "https://stackoverflow.com/questions/39007002/difference-between-printfplt-and-putsplt", "title": "Difference between printf@plt and puts@plt", "body": "<p>I've been learning assembly language by disassembling some C code. When I disassemble this basic C code with GDB:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid main(void) {\n    printf(\"Hello World\\n\");\n}\n</code></pre>\n\n<p>Among assembly code, it gives this line:</p>\n\n<pre><code>0x08048424 &lt;+25&gt;:   call   0x80482e0 &lt;puts@plt&gt;\n</code></pre>\n\n<p>However, when I disassemble below code which has an integer in printf function:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid main(void) {\n    int a = 1;\n    printf(\"Hello Word %d\\n\", a);\n}\n</code></pre>\n\n<p>It gives this line:</p>\n\n<pre><code>0x0804842e &lt;+35&gt;:   call   0x80482e0 &lt;printf@plt&gt;\n</code></pre>\n\n<p>What is the difference between printf@plt and puts@plt?</p>\n\n<p>Why disassembler does not recognize printf function without an integer parameter?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1471470866, "post_id": 39006814, "comment_id": 65365404, "body": "You have to use preprocessor macros. For example <code>#define getMem(type, size) malloc((size) * sizeof(type))</code>"}, {"owner": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "edited": false, "score": 0, "creation_date": 1471470916, "post_id": 39006814, "comment_id": 65365420, "body": "Well, I understand your point but I was simply trying to highlight an instance where it might be useful. I&#39;m sure there would be more uses for it."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1471470944, "post_id": 39006814, "comment_id": 65365436, "body": "&quot;Let&#39;s imagine I want to write a simple function that allocates some memory, not any particular type of memory but something more flexible.&quot; - You mean something like <code>malloc</code>?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471471096, "post_id": 39006814, "comment_id": 65365507, "body": "@Olaf, no, not something like <code>malloc</code>, something that would return a <code>void *</code> type that could be used by anything <code>:)</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 27690, "user_id": 362589, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/125a471032cdef6e8de28ff6d54c7324?s=128&d=identicon&r=PG", "display_name": "Dani", "link": "https://stackoverflow.com/users/362589/dani"}, "edited": false, "score": 0, "creation_date": 1471471155, "post_id": 39006814, "comment_id": 65365529, "body": "@Dani: Yes, thanks, this is about C, so stick with C. Not everyone want to bloat his code."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1471471230, "post_id": 39006814, "comment_id": 65365557, "body": "@DavidC.Rankin: Yes, who needs type-safety. (I miss my 68K Assembler ...)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1471471339, "post_id": 39006814, "comment_id": 65365590, "body": "@Nunchy: Such a macro is of little ot no use, but complicates reading the code and is error-prone. Don&#39;t get too fancy with macros. K.I.S.S.!"}, {"owner": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "edited": false, "score": 0, "creation_date": 1471471460, "post_id": 39006814, "comment_id": 65365649, "body": "To be honst I&#39;m disappointed if this can only be done with a macro, and probably won&#39;t use it. Any particular reason why this cannot be done outwithe the pre-processor? there&#39;s absolutely no way?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1471471623, "post_id": 39006814, "comment_id": 65365712, "body": "@Nunchy: This is very basic stuff founded in the C language and its simplicity. If you are not happy with what a language provides, you might want to use a diferent one. As always: use the appropriate tool for your problem. If you only have a hammer ever problem looks like a nail."}, {"owner": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "edited": false, "score": 0, "creation_date": 1471471687, "post_id": 39006814, "comment_id": 65365731, "body": "Dude, I&#39;m not complaining about anything. I don&#39;t think it&#39;s an unreasonable question."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1471472332, "post_id": 39006814, "comment_id": 65365961, "body": "also see <a href=\"http://en.cppreference.com/w/c/language/generic\" rel=\"nofollow noreferrer\">Generics</a> although they are best used in conjunction with macros"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471472367, "post_id": 39006814, "comment_id": 65365976, "body": "&quot;This is NOT about <code>malloc()</code>, or memory allocation, it&#39;s about passing a type as a parameter&quot; --&gt; OK, so it is not about <code>malloc()</code>.  The example posted only uses the <i>size</i> of the type.  Do you have a need where the <i>type</i> is passed/used and is not for determining the <i>size</i>.  Otherwise is seems simple enough to pass <code>sizeof(type)</code>"}, {"owner": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "edited": false, "score": 0, "creation_date": 1471472485, "post_id": 39006814, "comment_id": 65366004, "body": "I&#39;m asking a question about something that piqued my interest and I was curious about. Why is that a problem for some people? Contribute or don&#39;t."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471472964, "post_id": 39006814, "comment_id": 65366165, "body": "BTW: <code>fprintf(stdout, &quot;%s\\n&quot;, va_arg(l, char));</code> is UB as <code>va_arg()</code> returns a value of type <code>char</code> which does not work with <code>&quot;%s&quot;</code>."}, {"owner": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "edited": false, "score": 0, "creation_date": 1471473004, "post_id": 39006814, "comment_id": 65366179, "body": "You&#39;re right -  next time I ask a question I&#39;ll simply ignore the responses. Let me show you.."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1471471045, "post_id": 39006862, "comment_id": 65365476, "body": "This is against common recommendations to use the LHS pointer&#39;s object to calculate the size. And it does not spare much typing."}, {"owner": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "edited": false, "score": 1, "creation_date": 1471471184, "post_id": 39006862, "comment_id": 65365542, "body": "Exactly what I was looking for - just to re-iterate, my initial example was nothing more than a means for me to illustrate my question. I&#39;m not wanting to use this to write some malloc() wrapper. Much appreciated."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1471471352, "post_id": 39006862, "comment_id": 65365596, "body": "Doing assignment in a macro hides a lot of information and makes code using it hard to read and understand. Well, macros in general tend to do that, but the assignment is a really bad case IMO."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1471472992, "post_id": 39006862, "comment_id": 65366173, "body": "@JoachimPileborg I was editing the answer to add my second version, but [AFAICT] it also seems to fulfill Olaf&#39;s comment. How would you reconcile the two? I&#39;ve used the idiom for quite a long time without too many problems. And, (e.g.) <code>gcc</code>&#39;s source [last time I looked] is full of <i>huge</i> multiline macros that do much more stuff. Ordinarily, I would use an all caps macro name. And, when I analyze source that has a macro [mine or anybody else&#39;s], I always look up the definition and never assume anything about what it does."}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": false, "score": 2, "last_activity_date": 1471471237, "last_edit_date": 1471471237, "creation_date": 1471470945, "answer_id": 39006862, "question_id": 39006814, "link": "https://stackoverflow.com/questions/39006814/passing-a-type-as-a-parameter/39006862#39006862", "title": "Passing a type as a parameter", "body": "<p>Do this with a CPP macro:</p>\n\n<pre><code>#define getMem(type, size) \\\n    malloc(sizeof(type) * size)\n</code></pre>\n\n<p>However, personally, I prefer this:</p>\n\n<pre><code>#define getMemOf(ptr, size) \\\n    ptr = malloc(sizeof(*ptr) * size)\n\n// invoke with:\n    getMemOf(ptr, 1000);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471471094, "post_id": 39006877, "comment_id": 65365503, "body": "Seriously: what benefit has this? (I could understand error-checking, but this?)"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1471471937, "last_edit_date": 1471471937, "creation_date": 1471471023, "answer_id": 39006877, "question_id": 39006814, "link": "https://stackoverflow.com/questions/39006814/passing-a-type-as-a-parameter/39006877#39006877", "title": "Passing a type as a parameter", "body": "<p><code>malloc()</code> does not need to know the type to work well, just the <em>size</em> of the type.</p>\n\n<p>Should code want to insure no overflow in the size calculation, a check could be made.</p>\n\n<pre><code>void *getMem(size_t element_count, size_t type_size) {\n  if (element_count &gt; SIZE_MAX/type_size) return NULL;\n  return malloc(element_count * size);\n}\n\n// usage example\nsize_t element_count, \nvoid * p = getMem(element_count, sizeof (char));\n</code></pre>\n\n<p>If one wants zero-ed memory, simple use <code>calloc()</code></p>\n\n<pre><code>// usage example\nsize_t element_count, \nvoid * p = calloc(element_count, sizeof (char));\n</code></pre>\n\n<hr>\n\n<p>Recommend that code not use <code>void *</code> pointers and expresses a type like <code>char</code> separately.  Instead, declare a pointer with a non-<code>void</code> type.</p>\n\n<pre><code>#define ALLOCATE_ASSIGN(addr_ptr, count) (*(addr_ptr)=malloc(sizeof **(addr_ptr) * count))\n\nsome_type *mem;\nALLOCATE_ASSIGN(&amp;mem, element_count);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "edited": false, "score": 0, "creation_date": 1471471262, "post_id": 39006921, "comment_id": 65365564, "body": "I appreciate the input, again it&#39;s not about malloc() it&#39;s about the use of a type as a parameter. Much obliged."}], "tags": [], "owner": {"reputation": 2133, "user_id": 5447208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f8eb976d91e3b7bb21366a68d1a70f?s=128&d=identicon&r=PG&f=1", "display_name": "Cody", "link": "https://stackoverflow.com/users/5447208/cody"}, "is_accepted": false, "score": 0, "last_activity_date": 1471471212, "creation_date": 1471471212, "answer_id": 39006921, "question_id": 39006814, "link": "https://stackoverflow.com/questions/39006814/passing-a-type-as-a-parameter/39006921#39006921", "title": "Passing a type as a parameter", "body": "<p>You are going to end up doing this with <code>sizeof</code> anyway.  I just checked this in Visual Studio, and Microsoft defines it as (across several defines)</p>\n\n<pre><code>#define _INTSIZEOF(n)   ( (sizeof(n) + sizeof(int) - 1) &amp; ~(sizeof(int) - 1) )\n#define _crt_va_arg(ap,t)    ( *(t *)((ap += _INTSIZEOF(t)) - _INTSIZEOF(t)) )\n#define va_arg _crt_va_arg\n</code></pre>\n\n<p>You can find these in vadefs.h.  Long story short, you're not going to get away from using sizeof somewhere, so you should just do it where it is most simple.  Personally I think that'd be just passing the size into your <code>getMem</code> function instead of the type will save you way more headache in the long run.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1471475826, "post_id": 39007291, "comment_id": 65366976, "body": "@Daniel Jour Agree, answer amended."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1471475798, "last_edit_date": 1471475798, "creation_date": 1471473348, "answer_id": 39007291, "question_id": 39006814, "link": "https://stackoverflow.com/questions/39006814/passing-a-type-as-a-parameter/39007291#39007291", "title": "Passing a type as a parameter", "body": "<p><code>_Generic</code> in <strike>C99</strike> C11 may offer something close to OP's need.</p>\n\n<p>Example: Code wants to assign the maximum value of a common integer type.</p>\n\n<pre><code>#define integer_max(X) _Generic((X), \\\n  unsigned long long: ULLONG_MAX, \\\n  long long: LLONG_MAX, \\\n  unsigned long: ULONG_MAX, \\\n  long: LONG_MAX, \\\n  unsigned: UINT_MAX, \\\n  int: INT_MAX, \\\n  unsigned short: USHRT_MAX, \\\n  short: SHRT_MAX, \\\n  unsigned char: UCHAR_MAX, \\\n  signed char: SCHAR_MAX, \\\n  char: CHAR_MAX, \\\n  _Bool: 1, \\\n  default: 1/0 \\\n  )\n\n  // Here the _type_ of `x` is used by integer_max(), not its value.\n  some_integer_type x = integer_max(x);\n</code></pre>\n"}], "owner": {"reputation": 920, "user_id": 5482045, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/930882390318811/picture?type=large", "display_name": "Nunchy", "link": "https://stackoverflow.com/users/5482045/nunchy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1471475798, "creation_date": 1471470671, "last_edit_date": 1471471356, "question_id": 39006814, "link": "https://stackoverflow.com/questions/39006814/passing-a-type-as-a-parameter", "title": "Passing a type as a parameter", "body": "<p>ETA: This is NOT about malloc(), or memory allocation, it's about passing a type as a parameter, like:</p>\n\n<pre><code>va_arg(l, char);\n</code></pre>\n\n<p>I'm using malloc() as a simple example.</p>\n\n<p>This might be a stupid question, or perhaps I'm missing something.</p>\n\n<p>Let's imagine I want to write a simple function that allocates some memory, not any particular type of memory but something more flexible.</p>\n\n<p>Like, say I wanted 1,000 chars allocated and returned. So I'd like a function that I can call like this:</p>\n\n<pre><code>ptr = getMem(char, 1000);\n</code></pre>\n\n<p>Pasing the actual type as a parameter, which could be useful.</p>\n\n<p>Now I know macros like va_arg() can do this:</p>\n\n<pre><code>fprintf(stdout, \"%s\\n\", va_arg(l, char));\n</code></pre>\n\n<p>So I looked into it a bit, it's all rather vague. I found this:</p>\n\n<pre><code>type va_arg(va_list ap, type)\n</code></pre>\n\n<blockquote>\n  <p>Parameters</p>\n</blockquote>\n\n<pre><code>ap \u2212 This is the object of type va_list with information about the additional arguments and their retrieval state. This object should be initialized by an initial call to va_start before the first call to va_arg.\n\ntype \u2212 This is a type name. This type name is used as the type of the expression, this macro expands to.\n</code></pre>\n\n<p>You can see cleary the type for the first parameter is defined as <code>va_list</code>,\nbut the second parameter, the one I'm interested in - is simply specified as <code>type</code>.</p>\n\n<p>So it started to bug me, I've been messing around with bum code like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid *getMem(type, int size) {\n    return malloc(sizeof(type) * size);\n}\n\nint main(void)\n{\n    void    *mem;\n\n    mem = getMem(1000, char);\n\n    if (mem == NULL) {\n        perror(\"malloc()\");\n        exit(EXIT_FAILURE);\n    }\n\n    fprintf(stdout, \"Memory allocated successfully!\\n\");\n    free(mem);\n\n    exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>I've been sniffing around include files trying to figure this out but to no avail, is there a way I can do this?</p>\n\n<p>Sorry if it's a bit vague or nonsensical, but if va_arg() can do it I reckon I should be able to, also.</p>\n\n<p>Much obliged.</p>\n"}, {"tags": ["c", "string", "io"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 3, "creation_date": 1471467458, "post_id": 39006126, "comment_id": 65363939, "body": "Remove the second <code>fgets(name,50,fp);</code>"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1471470020, "post_id": 39006126, "comment_id": 65365092, "body": "The <code>while</code> loop condition does not specify some condition that will cause the loop to terminate whenever it happens inside the body -- it&#39;s an expression that is actually evaluated before each (potential) loop pass to decide whether to execute the loop body (which happens if the result is non-zero).  Putting <code>fgets()</code> in the loop condition will call it when the condition is checked before each loop pass... and the <code>fgets()</code> inside the loop body is independent of it (your loop only ends when the <code>fgets()</code> call in the condition returns <code>NULL</code>, but not when the one in the loop body does)."}], "answers": [{"tags": [], "owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "is_accepted": true, "score": 2, "last_activity_date": 1471467507, "creation_date": 1471467507, "answer_id": 39006167, "question_id": 39006126, "link": "https://stackoverflow.com/questions/39006126/read-strings-from-a-file/39006167#39006167", "title": "Read strings from a file", "body": "<p>You're (f)getting in the <code>while</code> statement <strong>and</strong> inside the loop block, so you're advancing the file position without utilizing what you've read in the internal call. Try this:</p>\n\n<pre><code>while(fgets(name,50,fp)!=NULL)\n{\n  printf(\" %s\",name);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11658, "user_id": 888731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xvcw6.jpg?s=128&g=1", "display_name": "Israel Unterman", "link": "https://stackoverflow.com/users/888731/israel-unterman"}, "is_accepted": false, "score": 0, "last_activity_date": 1471467526, "creation_date": 1471467526, "answer_id": 39006176, "question_id": 39006126, "link": "https://stackoverflow.com/questions/39006126/read-strings-from-a-file/39006176#39006176", "title": "Read strings from a file", "body": "<p>Remove the <code>fgets</code> from the body of the loop. The <code>fgets</code> in the <code>while</code> expression already does the work.</p>\n"}, {"comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1471511321, "post_id": 39014039, "comment_id": 65378933, "body": "OP&#39;s code was line-based. Yours is character-based."}, {"owner": {"reputation": 111, "user_id": 6729845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25902a32485c0e0c6126976546cbf096?s=128&d=identicon&r=PG", "display_name": "hasectic saif", "link": "https://stackoverflow.com/users/6729845/hasectic-saif"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1471546696, "post_id": 39014039, "comment_id": 65402057, "body": "#include &lt;iostream&gt; #include &lt;fstream&gt; #include &lt;string&gt; using namespace std;  int main(int argc, char *argv[]) { QCoreApplication a(argc, argv);  string sLine = &quot;&quot;; ifstream infile;  infile.open(&quot;temp.txt&quot;);  while (!infile.eof()) { getline(infile, sLine); cout &lt;&lt; sLine &lt;&lt; endl; }  infile.close(); cout &lt;&lt; &quot;Read file completed!!&quot; &lt;&lt; endl;  return a.exec(); } # crdeit apolo chung"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1471549746, "post_id": 39014039, "comment_id": 65403636, "body": "OP&#39;s code is C (and the question tagged as such). The code in your comment is C++. And it prints the last line twice."}], "tags": [], "owner": {"reputation": 111, "user_id": 6729845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25902a32485c0e0c6126976546cbf096?s=128&d=identicon&r=PG", "display_name": "hasectic saif", "link": "https://stackoverflow.com/users/6729845/hasectic-saif"}, "is_accepted": false, "score": -2, "last_activity_date": 1471511001, "creation_date": 1471511001, "answer_id": 39014039, "question_id": 39006126, "link": "https://stackoverflow.com/questions/39006126/read-strings-from-a-file/39014039#39014039", "title": "Read strings from a file", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main ()\n{\n\n   FILE *fp;\n   int c;\n\n   fp = fopen(\"file.txt\",\"r\");\n   while(1)\n   {\n      c = fgetc(fp);\n      if( feof(fp) )\n      {\n         break;\n      }\n      printf(\"%c\", c);\n   }\n   fclose(fp);\n   return(0);\n   }\n</code></pre>\n"}], "owner": {"reputation": 346, "user_id": 6709711, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/8tZM5.jpg?s=128&g=1", "display_name": "SynAck", "link": "https://stackoverflow.com/users/6709711/synack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "closed_date": 1471670756, "accepted_answer_id": 39006167, "answer_count": 3, "score": -2, "last_activity_date": 1471511001, "creation_date": 1471467363, "question_id": 39006126, "link": "https://stackoverflow.com/questions/39006126/read-strings-from-a-file", "closed_reason": "Not suitable for this site", "title": "Read strings from a file", "body": "<pre><code> FILE *fp;\nchar name[50];\nfp=fopen(\"stu.txt\",\"r\");\nwhile(fgets(name,50,fp)!=NULL)\n{\n\n    printf(\" %s\",name);\n    fgets(name,50,fp);\n\n}\nfclose(fp);\n</code></pre>\n\n<p>In my file there are 4 names in 4 different lines but the output only displays the 1st and the 3rd name.What's wrong?I know it's very basic but this has taken up a lot of my time.</p>\n"}, {"tags": ["android", "c", "java-native-interface", "android-service", "fork"], "comments": [{"owner": {"reputation": 20970, "user_id": 2252830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7f66d50bf99dc20b5aac2f165c31676?s=128&d=identicon&r=PG", "display_name": "pskink", "link": "https://stackoverflow.com/users/2252830/pskink"}, "edited": false, "score": 0, "creation_date": 1471543066, "post_id": 39006044, "comment_id": 65400095, "body": "maybe <a href=\"http://arunpatole.com/google-chrome/2012/google-chrome-for-android-how-the-sandboxed-processes-are-created/\" rel=\"nofollow noreferrer\">this</a> will help you"}, {"owner": {"reputation": 11, "user_id": 5375707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94495888b0b48d062959da0fd3568530?s=128&d=identicon&r=PG&f=1", "display_name": "lukpueh", "link": "https://stackoverflow.com/users/5375707/lukpueh"}, "reply_to_user": {"reputation": 20970, "user_id": 2252830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7f66d50bf99dc20b5aac2f165c31676?s=128&d=identicon&r=PG", "display_name": "pskink", "link": "https://stackoverflow.com/users/2252830/pskink"}, "edited": false, "score": 0, "creation_date": 1471550686, "post_id": 39006044, "comment_id": 65404127, "body": "@pskink Thanks! Although, this is not exactly what I was hoping for, it looks promising. If the chromium folks can&#39;t find a <i>better</i> way, then I doubt that I will. I&#39;ll update my findings here."}, {"owner": {"reputation": 20970, "user_id": 2252830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7f66d50bf99dc20b5aac2f165c31676?s=128&d=identicon&r=PG", "display_name": "pskink", "link": "https://stackoverflow.com/users/2252830/pskink"}, "edited": false, "score": 0, "creation_date": 1471550925, "post_id": 39006044, "comment_id": 65404248, "body": "seems that the only thing you can do is a fixed pool of isolated Services"}], "owner": {"reputation": 11, "user_id": 5375707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94495888b0b48d062959da0fd3568530?s=128&d=identicon&r=PG&f=1", "display_name": "lukpueh", "link": "https://stackoverflow.com/users/5375707/lukpueh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 982, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1471467023, "creation_date": 1471467023, "last_edit_date": 1592644375, "question_id": 39006044, "link": "https://stackoverflow.com/questions/39006044/repeatedly-fork-android-app-process-where-child-can-access-system-services-via", "title": "Repeatedly fork Android app process, where child can access System Services via JNI", "body": "<p><strong>Context</strong></p>\n<p>I am developing an Android app that embeds a Python interpreter. I use JNI to execute C code and the C-Python API to run Python code and also to make Android functionality available in Python via extensions. The Python interpreter needs to:</p>\n<ul>\n<li>run in its own process</li>\n<li>be able to call itself to start another (many) Python interpreter(s), each in its own process (via Python extension)</li>\n<li>be able to call back into Java and do Android things, e.g. request a System Service to use device sensors (via Python extension)</li>\n</ul>\n<p>Here is a diagram of my current <a href=\"https://github.com/aaaaalbert/sensibility-testbed/blob/native-sensors-jni/docs/sensibility_overview.png\" rel=\"nofollow noreferrer\">implementation</a>.\nIt works pretty well as long as I am in the same process. When I try to fork it gets messy.</p>\n<p><strong>Approach 1 - fork in C using fork()</strong></p>\n<p>The app starts a background Service (in the app\u2019s process). The Service calls a native method where I use the fork() system call. The child process inits Python and the Python extensions. The extensions are used to start new Python interpreters; and call into Java code (via JNI) to e.g. use System Services.\nForking repeatedly (recursively), running Python code, using C-Python extensions and calling back into Java works.</p>\n<p>What does not work is using the Android Application Context from the parent process to use System Services, which leads to segmentation faults. Something that is probably not surprising when one forks and still wants to use stuff from the parent\u2019s address space.</p>\n<p><em>Btw. I get the context from a static function in an Application subclass, where I store it when the app first gets started, which I know is discouraged.</em></p>\n<p><strong>Approach 2 - Let Android fork using android:process</strong></p>\n<p>I let Android fork my background Service by adding android:process to the service definition in AndroidManifest.xml. Then I call a native method that inits Python and the extensions. Now, when I use my extensions to call into Java and use System Services I don\u2019t get segmentation faults. Probably because Android has created a new Virtual Machine, with a fresh context and I don\u2019t have to access anything from the parent process\u2019 address space (especially now that the parent of my new process is Zygote and not my original App process).\nThe problem with this approach is that I can\u2019t start multiple instances of a Service/Process to have multiple Python interpreters.</p>\n<h1>TL;DR</h1>\n<ul>\n<li>When I fork a process in an Android native method, how can I avoid segmentation faults when I try to call System Services in that child process?</li>\n<li>Is there a way to have my App create new processes (ideally with a new Virtual Machine), without specifying them in the AndroidManifest.xml</li>\n</ul>\n<p><strong>Resources</strong> (I don't have enough reputations to post the links)</p>\n<ul>\n<li><em>Android Guide - Process and Threads</em> (This somehow tells me, this is do-able, but not how)</li>\n<li><em>Kivy Python for Android</em> (Interpreter does not fork)</li>\n<li><em>Script Layer for Android</em> (Interpreter forks but does not use JNI to call into Java)</li>\n<li><em>Java ProcessBuilder</em> (Forks a new process to execv a native program, which can\u2019t call into Java)</li>\n</ul>\n"}, {"tags": ["c", "linux", "linux-kernel", "linux-device-driver", "device-driver"], "comments": [{"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1471465813, "post_id": 39005601, "comment_id": 65363139, "body": "I guess this means &#39;you can use either <code>%pa</code> either <code>%pap</code>&#39;. Those might be two options, and the output (<code>0x...</code>) provided to the right may be the output each of these options provides (perhaps the last one gives longer (more precise?) output). But that&#39;s only a guess."}], "answers": [{"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": true, "score": 5, "last_activity_date": 1471466575, "last_edit_date": 1471466575, "creation_date": 1471465808, "answer_id": 39005738, "question_id": 39005601, "link": "https://stackoverflow.com/questions/39005601/meaning-of-p-in-pap-in-the-printk-formats/39005738#39005738", "title": "meaning of p in %pa[p] in the printk formats", "body": "<p>The <code>p</code> in <code>[p]</code> stands for <em><code>phys_addr_t</code></em> when used in <code>%pap</code>. This is analogous to the <code>d</code> in <code>%pad</code> stands for <em><code>dma_addr_t</code></em>, as seen in the cited document:</p>\n\n<pre><code>DMA addresses types dma_addr_t:\n\n    %pad    0x01234567 or 0x0123456789abcdef\n\n    For printing a dma_addr_t type which can vary based on build options,\n    regardless of the width of the CPU data path. Passed by reference.\n</code></pre>\n\n<p>Since it provides no documented difference between <code>%pa</code> and <code>%pap</code>, it means that they behave the same. The contents inside the brackets indicate optional modifiers. This is seen in the definition of <code>%*pE</code> later in the document:</p>\n\n<pre><code>Raw buffer as an escaped string:\n\n    %*pE[achnops]\n...\n    The conversion rules are applied according to an optional combination\n    of flags (see string_escape_mem() kernel documentation for the\n    details):\n        a - ESCAPE_ANY\n        c - ESCAPE_SPECIAL\n        h - ESCAPE_HEX\n        n - ESCAPE_NULL\n        o - ESCAPE_OCTAL\n        p - ESCAPE_NP\n        s - ESCAPE_SPACE\n    By default ESCAPE_ANY_NP is used.\n</code></pre>\n"}], "owner": {"reputation": 3198, "user_id": 1636521, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/2116626f42d8a2f87ee420ecefb1ec0c?s=128&d=identicon&r=PG", "display_name": "flashburn", "link": "https://stackoverflow.com/users/1636521/flashburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 794, "favorite_count": 0, "accepted_answer_id": 39005738, "answer_count": 1, "score": 2, "last_activity_date": 1471466575, "creation_date": 1471465266, "question_id": 39005601, "link": "https://stackoverflow.com/questions/39005601/meaning-of-p-in-pap-in-the-printk-formats", "title": "meaning of p in %pa[p] in the printk formats", "body": "<p>The question is with regard to the printk formats. The documentation that I'm reading is located <a href=\"https://www.kernel.org/doc/Documentation/printk-formats.txt\" rel=\"nofollow\">here</a></p>\n\n<p>Here is an excerpt that I'm asking about:</p>\n\n<pre><code>Physical addresses types phys_addr_t:\n\n    %pa[p]  0x01234567 or 0x0123456789abcdef\n\n    For printing a phys_addr_t type (and its derivatives, such as\n    resource_size_t) which can vary based on build options, regardless of\n    the width of the CPU data path. Passed by reference.\n</code></pre>\n\n<p>What does <code>[p]</code> in <code>%pa[p]</code> stand for? What does it mean?</p>\n"}, {"tags": ["python", "c", "modelica", "fmi", "jmodelica"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471469597, "post_id": 39005445, "comment_id": 65364907, "body": "Any reason you unnecessarily increase complexity by using a C module just  to add two <code>doubles</code>?"}, {"owner": {"reputation": 189, "user_id": 4987652, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-OaWWK_ACvlM/AAAAAAAAAAI/AAAAAAAABmk/k0KrVbz36xc/photo.jpg?sz=128", "display_name": "Justin Shultz", "link": "https://stackoverflow.com/users/4987652/justin-shultz"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471470646, "post_id": 39005445, "comment_id": 65365323, "body": "@Olaf Yes, this is a simple configuration of a much larger model in which we&#39;re using c code to call a python model."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471470840, "post_id": 39005445, "comment_id": 65365390, "body": "Sorry, but that also sounds strange. But as I don&#39;t really know modelica and how it integrates with Python, I leave it at this."}, {"owner": {"reputation": 1053, "user_id": 1093963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0667c73ecfd4bea2e72833fdc44c3d4a?s=128&d=identicon&r=PG", "display_name": "Christian Winther", "link": "https://stackoverflow.com/users/1093963/christian-winther"}, "edited": false, "score": 0, "creation_date": 1471593827, "post_id": 39005445, "comment_id": 65417794, "body": "I&#39;m unable to reproduce the error that you are seeing. Which version of JModelica are you using?"}, {"owner": {"reputation": 189, "user_id": 4987652, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-OaWWK_ACvlM/AAAAAAAAAAI/AAAAAAAABmk/k0KrVbz36xc/photo.jpg?sz=128", "display_name": "Justin Shultz", "link": "https://stackoverflow.com/users/4987652/justin-shultz"}, "reply_to_user": {"reputation": 1053, "user_id": 1093963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0667c73ecfd4bea2e72833fdc44c3d4a?s=128&d=identicon&r=PG", "display_name": "Christian Winther", "link": "https://stackoverflow.com/users/1093963/christian-winther"}, "edited": false, "score": 0, "creation_date": 1471687484, "post_id": 39005445, "comment_id": 65454981, "body": "Hi @Christian Anderson, I am using JModelica 1.17.0."}, {"owner": {"reputation": 1053, "user_id": 1093963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0667c73ecfd4bea2e72833fdc44c3d4a?s=128&d=identicon&r=PG", "display_name": "Christian Winther", "link": "https://stackoverflow.com/users/1093963/christian-winther"}, "edited": false, "score": 1, "creation_date": 1471848280, "post_id": 39005445, "comment_id": 65493715, "body": "Ok I see. A lot has happened since 1.17 so I&#39;d recommend to try out the development version using the available SDK where this seems to be fixed or hold out until 1.18 is available."}, {"owner": {"reputation": 189, "user_id": 4987652, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-OaWWK_ACvlM/AAAAAAAAAAI/AAAAAAAABmk/k0KrVbz36xc/photo.jpg?sz=128", "display_name": "Justin Shultz", "link": "https://stackoverflow.com/users/4987652/justin-shultz"}, "edited": false, "score": 1, "creation_date": 1471896876, "post_id": 39005445, "comment_id": 65523694, "body": "I&#39;m working on a research project for my thesis. I will give the development version a try. Thank you for your time. I will update the post if the development version corrects the problem."}, {"owner": {"reputation": 189, "user_id": 4987652, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-OaWWK_ACvlM/AAAAAAAAAAI/AAAAAAAABmk/k0KrVbz36xc/photo.jpg?sz=128", "display_name": "Justin Shultz", "link": "https://stackoverflow.com/users/4987652/justin-shultz"}, "reply_to_user": {"reputation": 1053, "user_id": 1093963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0667c73ecfd4bea2e72833fdc44c3d4a?s=128&d=identicon&r=PG", "display_name": "Christian Winther", "link": "https://stackoverflow.com/users/1093963/christian-winther"}, "edited": false, "score": 0, "creation_date": 1472073188, "post_id": 39005445, "comment_id": 65611532, "body": "Hi @ChristianAndersson, I have installed the JModelica.org-SDK-1.12 and built from the source. However, when I go to compile the model as an FMU the pylab shell and compile_fmu is unable to find the -lCallAdd.a library file. How were you able to reference this file during compilation of the FMU? Thank you for your time."}], "answers": [{"tags": [], "owner": {"reputation": 189, "user_id": 4987652, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-OaWWK_ACvlM/AAAAAAAAAAI/AAAAAAAABmk/k0KrVbz36xc/photo.jpg?sz=128", "display_name": "Justin Shultz", "link": "https://stackoverflow.com/users/4987652/justin-shultz"}, "is_accepted": false, "score": 0, "last_activity_date": 1472084108, "creation_date": 1472084108, "answer_id": 39134843, "question_id": 39005445, "link": "https://stackoverflow.com/questions/39005445/fmu-variable-values-do-not-match-input/39134843#39134843", "title": "FMU Variable Values Do Not Match Input", "body": "<p>Following @ChristianAndersson's suggestion to update my JModelica installation the problem described in my question above was solved. </p>\n\n<p>JModelica 1.17.0 was release in December, 2015. </p>\n\n<p>JModelica-SDK-1.12.0 was released in February, 2016 and is built from the source code, which fixed the problem and provided me with the expected results. </p>\n"}], "owner": {"reputation": 189, "user_id": 4987652, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-OaWWK_ACvlM/AAAAAAAAAAI/AAAAAAAABmk/k0KrVbz36xc/photo.jpg?sz=128", "display_name": "Justin Shultz", "link": "https://stackoverflow.com/users/4987652/justin-shultz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 464, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1472084108, "creation_date": 1471464687, "question_id": 39005445, "link": "https://stackoverflow.com/questions/39005445/fmu-variable-values-do-not-match-input", "title": "FMU Variable Values Do Not Match Input", "body": "<p>I'm getting some strange behavior in a simple co-simulation that I'm trying to configure. I setup a building energy model in EnergyPlus to test out an FMU generated from JModelica. However, the building energy model would get hung up at the co-simulation step. I then ran the FMU in JModelica and got some very strange results.</p>\n\n<p>The Modelica code is:</p>\n\n<pre><code>model CallAdd\n    input Real FirstInput(start=0);\n    input Real SecondInput(start=0);\n    output Real FMUOutput(start=0); \n    function CAdd\n        input Real x(start=0);\n        input Real y(start=0);\n        output Real z(start=0);\n        external \"C\"  annotation(Library = \"CAdd\", LibraryDirectory = \"modelica://CallAdd\");\n    end CAdd;\nequation\n    FMUOutput = CAdd(FirstInput,SecondInput);\n    annotation(uses(Modelica(version = \"3.2.1\")));\nend CallAdd;\n</code></pre>\n\n<p>The above code references \"CAdd\" which is library file for the c code \"CAdd.c\":</p>\n\n<pre><code>double CAdd(double x, double y){\n    double answer;\n    answer = x + y;\n    return answer;\n}\n</code></pre>\n\n<p>which is compiled into a library file with the below two commands in CMD:</p>\n\n<pre><code>gcc -c CAdd.c -o CAdd.o\nar rcs libCAdd.a CAdd.o\n</code></pre>\n\n<p>I can run the above example in OpenModelica with a wrapper and it works great.</p>\n\n<p>I then used JModelica to compile the above as an FMU for co-simulation. The JModelica compile code is:</p>\n\n<pre><code># Import the compiler function\nfrom pymodelica import compile_fmu\n\n# Specify Modelica model and model file (.mo or .mop)\nmodel_name = \"CallAdd\"\nmo_file = \"CallAdd.mo\"\n\n# Compile the model and save the return argument, for use later if wanted\nmy_fmu = compile_fmu(model_name, mo_file, target=\"cs\")\n</code></pre>\n\n<p>I then simulated the FMU and got the strange results with the JModelica Python code:</p>\n\n<pre><code>from pyfmi import load_fmu\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nmodelName = 'CallAdd'\nnumSteps = 100\ntimeStop = 20\n\n# Load FMU created with the last script\nmyModel = load_fmu(modelName+'.fmu')\n\n# Load options\nopts = myModel.simulate_options()\n\n# Set number of timesteps\nopts['ncp'] = numSteps\n\n# Set up input, needs more than one value to interpolate the input over time. \nt = np.linspace(0.0,timeStop,numSteps)\nu1 = np.sin(t)\nu2 = np.empty(len(t)); u2.fill(5.0)\nu_traj = np.transpose(np.vstack((t,u1,u2)))\ninput_object = (['FirstInput','SecondInput'],u_traj)\n\n# Internalize results\nres = myModel.simulate(final_time=timeStop, input = input_object, options=opts)\n# print 'res: ', res\n\n# Internalize individual results\nFMUTime = res['time']\nFMUIn1 = res['FirstInput']\nFMUIn2 = res['SecondInput']\nFMUOut = res['FMUOutput']\n\nplt.figure(2)\nFMUIn1Plot = plt.plot(t,FMUTime[1:],label='FMUTime')\n# FMUIn1Plot = plt.plot(t,FMUIn1[1:],label='FMUIn1')\n# FMUIn2Plot = plt.plot(t,FMUIn2[1:],label='FMUIn2')\n# FMUOutPlot = plt.plot(t,FMUOut[1:],label='FMUOut')\nplt.grid(True)\nplt.legend()\nplt.ylabel('FMU time [s]')\nplt.xlabel('time [s]')\nplt.show()\n</code></pre>\n\n<p>which resulted in the plot for result \"FMUTime\" vs python \"t\":\n<a href=\"https://i.stack.imgur.com/mev2P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mev2P.png\" alt=\"FMU Time does not match simulation time\"></a></p>\n\n<p>In addition to seeing this strange behavior the input \"FirstInput\" and \"SecondInput\" in the FMU results do not match the u1 and u2 specified in the python code. I'm hoping that someone can help me better understand what is going on.</p>\n\n<p>Best, </p>\n\n<p>Justin </p>\n"}, {"tags": ["c", "linux", "hash", "crc32"], "comments": [{"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 1, "creation_date": 1471465997, "post_id": 39005351, "comment_id": 65363225, "body": "Zlib use whatever CRC algorithm it choose to implement. If you want a different algorithm you&#39;ll need to use a different implementation. If you need a specific algorithm you&#39;ll need to ensure that implementation uses that specific algorithm."}, {"owner": {"reputation": 7797, "user_id": 942746, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/34cf9eae5d595c0b480a7cb42f3722b1?s=128&d=identicon&r=PG", "display_name": "Brian McFarland", "link": "https://stackoverflow.com/users/942746/brian-mcfarland"}, "edited": false, "score": 2, "creation_date": 1471466095, "post_id": 39005351, "comment_id": 65363267, "body": "There are at least five different CRC32 polynomials in relatively common use, and if you add to that different schemes for padding and endianess, maybe 10-20 different ways to get a &quot;crc32&quot; on an identical block of data."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471466738, "post_id": 39005351, "comment_id": 65363587, "body": "<code>unsigned long</code> is not guaranteed a 32 bit type. Get use to <code>stdint.h</code> fixed width types (and for printing macros from  <code>inttypes.h</code>)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1471466839, "post_id": 39005351, "comment_id": 65363631, "body": "@RossRidge: Sure? Sounds pretty bad to me. That makes two versions potentially incompatible."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1471470857, "post_id": 39005351, "comment_id": 65365399, "body": "Possibly related: <a href=\"http://stackoverflow.com/questions/15861058/what-is-the-difference-between-crc32-and-crc32b\">What is the difference between crc32 and crc32b?</a>."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471472555, "post_id": 39005351, "comment_id": 65366031, "body": "@Olaf  Obviously Zlib didn&#39;t choose any algorithm arbitrarily, thye chose to implement the algorithm used by gzip, so it can read and create <code>.gz</code> files that are compatible with gzip. But it not going to implement some other incompatible CRC algorithm for no reason. (Although it did invent its own Adler-32 checksum for it&#39;s own zlib format for performance reasons.) So if the original poster wants some other algorithm then they&#39;re going to have to find a different implementation."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1471473404, "post_id": 39005351, "comment_id": 65366301, "body": "@RossRidge You&#39;re trying to draw a distinction between zlib and gzip which doesn&#39;t really exist. zlib was derived from the gzip source code, by the same authors who created gzip in the first place. They&#39;re effectively one and the same."}, {"owner": {"reputation": 29, "user_id": 6088363, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dacb5df4ce42f69481dad8c380e7ad6b?s=128&d=identicon&r=PG&f=1", "display_name": "TyrantUT", "link": "https://stackoverflow.com/users/6088363/tyrantut"}, "edited": false, "score": 0, "creation_date": 1471475000, "post_id": 39005351, "comment_id": 65366749, "body": "This all sounds great, and thank you for the information but it doesn&#39;t really answer the question. If the website uses mhash then that is the code I need to use. Ill see if I can find some examples and code this up using that."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1471476087, "post_id": 39005351, "comment_id": 65367043, "body": "I thought I did answer you question, but to be explicit, there&#39;s nothing you can do to modify your example code to generate the CRC value you expect using Zlib&#39;s <code>crc32</code> function. You need to use something else that implements the particular CRC algorithm you require. Also note that there&#39;s no universally accepted names for the many different 32-bit CRC variations. Any 32-bit CRC implementation can legitimately be called CRC32."}, {"owner": {"reputation": 29, "user_id": 6088363, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dacb5df4ce42f69481dad8c380e7ad6b?s=128&d=identicon&r=PG&f=1", "display_name": "TyrantUT", "link": "https://stackoverflow.com/users/6088363/tyrantut"}, "edited": false, "score": 0, "creation_date": 1471476509, "post_id": 39005351, "comment_id": 65367157, "body": "Right, I just don&#39;t know exactly which is used to create the one I mentioned. The website seems to be using the one I need, and it was mentioned mhash is the way to do it. So I have to find some example code that works. For some reason, the mhash library that I found is having problems finding their own header files... Weird stuff actually."}, {"owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471487151, "post_id": 39005351, "comment_id": 65369795, "body": "@Olaf: an <code>unsigned long</code> is guaranteed to be <i>at least</i> 32 bits, so it is perfectly fine to use for a 32-bit CRC."}, {"owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "edited": false, "score": 0, "creation_date": 1471487325, "post_id": 39005351, "comment_id": 65369831, "body": "@TyrantUT: How do you know what 32-bit CRC you want? What is the application? Do you have a reference for the definition of the CRC? Your statement: &quot;The website <i>seems</i> to be using the one I need&quot; does not engender confidence."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "edited": false, "score": 0, "creation_date": 1471549905, "post_id": 39005351, "comment_id": 65403727, "body": "@MarkAdler: Typically one wants to use that CRC for some serialised communication, so using the correct type from the start is a good idea. It also is more self-doucmenting to use an appropriate type (like one uses <code>size_t</code> for the result of <code>sizeof</code>)."}, {"owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471550363, "post_id": 39005351, "comment_id": 65403966, "body": "@Olaf: However <code>uint32_t</code> is not guaranteed to exist, whereas <code>unsigned long</code> is guaranteed to exist. So <code>unsigned long</code> is more portable, which is why zlib uses it for the <code>crc32()</code> return value."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "edited": false, "score": 0, "creation_date": 1471550489, "post_id": 39005351, "comment_id": 65404028, "body": "@MarkAdler: Hmm, fair point! I might have thought too many steps ahead. Changing to a recommendation."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6088363, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dacb5df4ce42f69481dad8c380e7ad6b?s=128&d=identicon&r=PG&f=1", "display_name": "TyrantUT", "link": "https://stackoverflow.com/users/6088363/tyrantut"}, "edited": false, "score": 0, "creation_date": 1471475896, "post_id": 39007228, "comment_id": 65366994, "body": "Do you know of a place I can get some working mhash code to work with? I keep getting header errors of functions not found from the example I have."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 29, "user_id": 6088363, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dacb5df4ce42f69481dad8c380e7ad6b?s=128&d=identicon&r=PG&f=1", "display_name": "TyrantUT", "link": "https://stackoverflow.com/users/6088363/tyrantut"}, "edited": false, "score": 0, "creation_date": 1471486752, "post_id": 39007228, "comment_id": 65369683, "body": "Don&#39;t use mhash. It&#39;s old, buggy, and hasn&#39;t been updated since 2008."}], "tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 1, "last_activity_date": 1471472977, "creation_date": 1471472977, "answer_id": 39007228, "question_id": 39005351, "link": "https://stackoverflow.com/questions/39005351/zlib-seems-to-be-returning-crc32b-not-crc32-in-c/39007228#39007228", "title": "ZLIB seems to be returning CRC32B not CRC32 in C", "body": "<p>The results you're getting from your code are correct.</p>\n\n<p>The web site you're referencing is using the (obsolete) mhash library to hash user input, <a href=\"https://blog.box.com/blog/crc32-checksums-the-good-the-bad-and-the-ugly/\" rel=\"nofollow\">whose \"crc32\" implementation uses an uncommon polynomial typically only used for Ethernet checksums</a>. The hash implemented by mhash as \"crc32b\" is, in reality, the one typically referred to as CRC32.</p>\n"}], "owner": {"reputation": 29, "user_id": 6088363, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dacb5df4ce42f69481dad8c380e7ad6b?s=128&d=identicon&r=PG&f=1", "display_name": "TyrantUT", "link": "https://stackoverflow.com/users/6088363/tyrantut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471472977, "creation_date": 1471464280, "last_edit_date": 1471464856, "question_id": 39005351, "link": "https://stackoverflow.com/questions/39005351/zlib-seems-to-be-returning-crc32b-not-crc32-in-c", "title": "ZLIB seems to be returning CRC32B not CRC32 in C", "body": "<p>I have quite a simple program to compute the CRC32 of input strings from stdin and for some reason I am not getting the CRC32, but the CRC32B.</p>\n\n<p>Here is my code</p>\n\n<pre><code>int main( int argc, char *argv[] ) { \n\n  unsigned long crc=0L;\n  unsigned char *stdinput = malloc(1024);\n\n  crc = crc32( 0L, Z_NULL, 0 );\n\n  fgets(stdinput, 1024, stdin);\n\n  crc = crc32( crc, stdinput, strlen(stdinput) - 1 );\n  printf(\"%s 0x%08x\\n\", stdinput, crc );\n\n}\n</code></pre>\n\n<p>I know there are overflow problems in the program, but that's not necessarily my issue.</p>\n\n<p>The problem is the output is like so</p>\n\n<p>echo test | ./crc32\nresults in \n0xd87f7e0c</p>\n\n<p>and not 0xaccf8b33\nVerified here <a href=\"https://www.tools4noobs.com/online_tools/hash/\" rel=\"nofollow\">https://www.tools4noobs.com/online_tools/hash/</a></p>\n\n<p>The output from zlib is definitely using CRC32B and not CRC32.</p>\n\n<p>How would I modify this so I get the correct output?</p>\n\n<p>I'm running this on a Debian 64 bit machine.</p>\n\n<p>Any help with this would be greatly appreciated. Thank you.</p>\n"}, {"tags": ["c++", "c", "gcc", "optimization", "floating-point"], "comments": [{"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 4, "creation_date": 1471463224, "post_id": 39005074, "comment_id": 65361767, "body": "It makes use of undefined behavior? Do have some more details?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 4, "creation_date": 1471463225, "post_id": 39005074, "comment_id": 65361770, "body": "If <code>-fno-fast-math</code> doesn&#39;t make the problem go away, post an example of the code that is affected, please.  (I don&#39;t <i>think</i> <code>-O3</code> turns on <code>-ffast-math</code>, but I could be wrong.  <code>-ffast-math</code> is a euphemism; it enables a broad spectrum of <i>incorrect</i> optimizations on floating-point code.)"}, {"owner": {"reputation": 586, "user_id": 2523394, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d40798a5768de79d43dae9251fb06642?s=128&d=identicon&r=PG", "display_name": "lorniper", "link": "https://stackoverflow.com/users/2523394/lorniper"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1471463340, "post_id": 39005074, "comment_id": 65361833, "body": "@zwol but that doesn&#39;t abide by IEEE-754 right?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1471463399, "post_id": 39005074, "comment_id": 65361861, "body": "Also, if you are using a 32-bit x86 for your code, try <code>-mfpmath=sse</code>.  (This is the default for x86-64.)"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1471463453, "post_id": 39005074, "comment_id": 65361891, "body": "Right, and it also does stuff that&#39;s valid for mathematical real numbers but incorrect for floating-point in general (not just incorrect per the letter of IEEE 754).  Which is why I&#39;m telling you to make sure it&#39;s turned off."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 8, "creation_date": 1471463540, "post_id": 39005074, "comment_id": 65361941, "body": "Post your code. <code>-O3</code> does <b>not</b> include unsafe math optimizations. <code>-Ofast</code> does."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1471465376, "post_id": 39005074, "comment_id": 65362920, "body": "If you have specific requirements, write code using tools that are guaranteed to meet them."}], "answers": [{"tags": [], "owner": {"reputation": 3356, "user_id": 4451432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97b46aba1c1ec6b780b9735f0ec7f885?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Popov", "link": "https://stackoverflow.com/users/4451432/ilya-popov"}, "is_accepted": true, "score": 2, "last_activity_date": 1471465778, "last_edit_date": 1592644375, "creation_date": 1471464265, "answer_id": 39005344, "question_id": 39005074, "link": "https://stackoverflow.com/questions/39005074/wildly-different-behaviour-between-o2-and-o3-optimized-fp-code/39005344#39005344", "title": "wildly different behaviour between O2 and O3 optimized FP code", "body": "<p>From <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.8.5/gcc/Optimize-Options.html#Optimize-Options\" rel=\"nofollow noreferrer\">GCC manual</a>:</p>\n<blockquote>\n<p>-O3</p>\n<p>Optimize yet more. -O3 turns on all optimizations specified by -O2 and also turns on the -finline-functions, -funswitch-loops, -fpredictive-commoning, -fgcse-after-reload, -ftree-vectorize, -fvect-cost-model, -ftree-partial-pre and -fipa-cp-clone options.</p>\n</blockquote>\n<p>No of these optimizations are particularly unsafe. The only optimization that I see can change the result is <code>-ftree-vectorize</code>. In some cases, using vector instructions can change the result compared to FPU instructions. For example, FPU by default uses 80-bit internal precision for doubles, while vector SIMD instructions use 64 bits. Also the implementation of some math functions (like <code>sqrt</code>) may be different.</p>\n<p>You would get much better chance of getting help, if you posted your code, exact compiler flags and information about your hardware (which SIMD instructions does your CPU have).</p>\n<p>You can also directly compare assembly code generated in these two cases.</p>\n<p>PS. But in my experience, the most likely cause is undefined behavior in the program. Typically, uninitialized variable, division by zero, etc. Make sure you compile with high warnings level (<code>-Wall -Wextra -Wpedantic</code>), and use UB Sanitizer.</p>\n"}], "owner": {"reputation": 586, "user_id": 2523394, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d40798a5768de79d43dae9251fb06642?s=128&d=identicon&r=PG", "display_name": "lorniper", "link": "https://stackoverflow.com/users/2523394/lorniper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "closed_date": 1471468271, "accepted_answer_id": 39005344, "answer_count": 1, "score": -5, "last_activity_date": 1471465900, "creation_date": 1471463162, "last_edit_date": 1495535630, "question_id": 39005074, "link": "https://stackoverflow.com/questions/39005074/wildly-different-behaviour-between-o2-and-o3-optimized-fp-code", "closed_reason": "Not suitable for this site", "title": "wildly different behaviour between O2 and O3 optimized FP code", "body": "<p>I am working on some floating-point numerical code, what makes me frustrated is the fact that the behaviour of O3 optimized(GCC 4.8.3)code generates very different result from the O2 case(stable one), and it ends up with numerical disaster as expected.</p>\n\n<p>I looked at <a href=\"https://stackoverflow.com/questions/7517588/different-floating-point-result-with-optimization-enabled-compiler-bug\">this thread</a> which may be relevant, but the answer there does't  fix my problem. I know that what O3 does in addition to O2 is mainly about inlining and loop unrolling. And I am quite sure the reason is due to the floating-point calculation part, because after I explicitly use O2 optimization for that part the results looks fine. </p>\n\n<pre><code>#pragma GCC push_options\n#pragma GCC optimize (\"O2\")\n\nFP computation code (double precision)\n\n#pragma GCC pop_options \n</code></pre>\n\n<p>So my question is, what kind of optimizations O3 does could really make a huge difference for floating-point calculation specifically?</p>\n"}, {"tags": ["c", "rabbitmq", "zeromq"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1471463831, "post_id": 39004723, "comment_id": 65362109, "body": "Ehm - what? How is the programming language (presuming a turing complete, not a DSL) even related to synchronisation concepts? Does the C standard contain <b>any</b> timing behaviour for an implementation?"}, {"owner": {"reputation": 34061, "user_id": 616460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Yiloe.png?s=128&g=1", "display_name": "Jason C", "link": "https://stackoverflow.com/users/616460/jason-c"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1472246745, "post_id": 39004723, "comment_id": 65692002, "body": "@Olaf ZeroMQ and RabbitMQ offer client APIs in various languages. This post is asking about the C client&#39;s specific capabilities. It&#39;s only unclear if you don&#39;t know what ZeroMQ or RabbitMQ are."}], "answers": [{"tags": [], "owner": {"reputation": 396, "user_id": 3403663, "user_type": "registered", "profile_image": "https://graph.facebook.com/767083125/picture?type=large", "display_name": "Larry McQueary", "link": "https://stackoverflow.com/users/3403663/larry-mcqueary"}, "is_accepted": true, "score": 2, "last_activity_date": 1472236963, "last_edit_date": 1472236963, "creation_date": 1472095647, "answer_id": 39136217, "question_id": 39004723, "link": "https://stackoverflow.com/questions/39004723/is-messaging-library-asynchronous-while-it-is-imported-into-c-application/39136217#39136217", "title": "Is messaging library asynchronous while it is imported into C application?", "body": "<p>Yes, both ZeroMQ and RabbitMQ support asynchronous modes of operation, and this applies to the C client library implementations for both (as of this writing).</p>\n"}], "owner": {"reputation": 4627, "user_id": 484243, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d6343a66c64cbc15edbd4120ed39b380?s=128&d=identicon&r=PG", "display_name": "Prem", "link": "https://stackoverflow.com/users/484243/prem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 39136217, "answer_count": 1, "score": 1, "last_activity_date": 1472246801, "creation_date": 1471461866, "last_edit_date": 1472246801, "question_id": 39004723, "link": "https://stackoverflow.com/questions/39004723/is-messaging-library-asynchronous-while-it-is-imported-into-c-application", "title": "Is messaging library asynchronous while it is imported into C application?", "body": "<p>Is ZeroMQ or RabbitMQ asynchronous, even when it is utilized in C programming?</p>\n"}, {"tags": ["c", "memory-management", "free"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 6, "creation_date": 1471461738, "post_id": 39004628, "comment_id": 65361003, "body": "You need to allocate memory also for the terminating null..."}, {"owner": {"reputation": 47412, "user_id": 3141234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/78b45a835031f4ce03a6653b3262b5d3?s=128&d=identicon&r=PG", "display_name": "Alexander", "link": "https://stackoverflow.com/users/3141234/alexander"}, "edited": false, "score": 0, "creation_date": 1471461844, "post_id": 39004628, "comment_id": 65361055, "body": "I suspect one of the functions you&#39;ve called is storing a pointer to the the memory of <code>fullPath</code>, and is (unsuccessfully) trying to access it after it&#39;s been freed."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471461914, "post_id": 39004628, "comment_id": 65361088, "body": "<code>malloc(strlen(path) + strlen(fileData-&gt;d_name) + 1);</code> --&gt; <code>malloc(strlen(path) + 1 &#47;* &#39;&#47;&#39; *&#47; + strlen(fileData-&gt;d_name) + 1 &#47;* null *&#47;);</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471469951, "post_id": 39004628, "comment_id": 65365063, "body": "You do <b>not</b> &quot;allocate space for a <code>char *</code>&quot;!"}], "answers": [{"tags": [], "owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "is_accepted": true, "score": 5, "last_activity_date": 1471462896, "last_edit_date": 1471462896, "creation_date": 1471462051, "answer_id": 39004773, "question_id": 39004628, "link": "https://stackoverflow.com/questions/39004628/failing-to-free-char-pointer-memory-c/39004773#39004773", "title": "failing to free char pointer memory c", "body": "<p>You are not allocating space for the string terminating NUL character. So change allocation to this:</p>\n\n<pre><code>// allocate memory for 1st part, slash, 2nd part and terminating NUL char\nfullPath = malloc(strlen(path) + 1 + strlen(fileData-&gt;d_name) + 1);\n</code></pre>\n\n<p>Note also, in C it's bad practice to cast return value of <code>malloc</code>, so I removed that.</p>\n\n<hr>\n\n<p>It might be an improvement to use <code>snprintf</code>, in case you calculate the length wrong, though is might be a matter of opinion in this case. Anyway, then the code would become</p>\n\n<pre><code>// size for 1st part, slash, 2nd part and terminating NUL char\nsize_t bufsize = strlen(path) + 1 + strlen(fileData-&gt;d_name) + 1;\nfullPath = malloc(bufsize);\n//...\nsnprintf(fullPath, bufsize, \"%s/%s\", path, fileData-&gt;d_name);\n</code></pre>\n\n<p>Then a bug would not cause <em>undefined behavior</em>, but instead produce path with chars chopped of from the end. This is much nicer error situation (file not found error for example) than random crash, not to mention much easier to debug, when you can print the file name and see how it's not right.</p>\n\n<hr>\n\n<p>Some explanation: In the question code, because you allocate 1 byte too little, you cause buffer overlow, which is <em>undefined behavior</em>, so basically anything can happen. For 1 byte buffer overflow, it'd be quite possible that nothing bad would happen, as there <em>might</em> be unused bytes at the end of the allocation. So in a way you got really lucky to catch this so early. You can imagine how hard it's to find a bug, when the program crashes only when string length is exact multiple of 16 and works otherwise... Fortunately there are tools for detecting stuff like this, but best defence is to be a pedantic C programmer, who strives to write good code...</p>\n"}], "owner": {"reputation": 385, "user_id": 2859991, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3c547fb480ac3d021b40efcab7d9f7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Itzko", "link": "https://stackoverflow.com/users/2859991/dvir-itzko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 0, "accepted_answer_id": 39004773, "answer_count": 1, "score": 0, "last_activity_date": 1471462896, "creation_date": 1471461548, "last_edit_date": 1471462166, "question_id": 39004628, "link": "https://stackoverflow.com/questions/39004628/failing-to-free-char-pointer-memory-c", "title": "failing to free char pointer memory c", "body": "<p>I have a problem. I'm allocating space for a <code>char*</code>, but when I'm trying to <code>free</code> the space, my program crashes. </p>\n\n<p>this is the code</p>\n\n<pre><code>fullPath = (char *) malloc(strlen(path) + strlen(fileData-&gt;d_name) + 1);\nif (fullPath == NULL)\n{\n    handleErrors(ERR_ALOCATION_CODE);\n}\nsprintf(fullPath, \"%s/%s\", path, fileData-&gt;d_name);\n//... some more code, I only use fullPath, I don't change it here\nfree(fullPath);\n</code></pre>\n\n<p>The code above failed when trying to <code>free</code>. I would appreciate some help.</p>\n"}, {"tags": ["c", "structure"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471458857, "post_id": 39003798, "comment_id": 65359532, "body": "Is there a sane reason to pass a pointer to point instead of a simple pointer? Maybe you should revisit the chapter in your C book about pointers."}, {"owner": {"reputation": 4535, "user_id": 3478852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vzDyD.jpg?s=128&g=1", "display_name": "Nisse Engstr&#246;m", "link": "https://stackoverflow.com/users/3478852/nisse-engstr%c3%b6m"}, "edited": false, "score": 0, "creation_date": 1471511124, "post_id": 39003798, "comment_id": 65378820, "body": "The only reason that comes to mind is that the memory may need to be reallocated inside <code>func()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5180437, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/82ee3e0a21af261740c43e2488f985e4?s=128&d=identicon&r=PG&f=1", "display_name": "santhosh kgn", "link": "https://stackoverflow.com/users/5180437/santhosh-kgn"}, "edited": false, "score": 0, "creation_date": 1471458998, "post_id": 39003847, "comment_id": 65359612, "body": "in 2nd case how it is working(void func(pstdu *pstu)- what is pstdu *pstu, whether *pstu is pointer to pointer"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 41, "user_id": 5180437, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/82ee3e0a21af261740c43e2488f985e4?s=128&d=identicon&r=PG&f=1", "display_name": "santhosh kgn", "link": "https://stackoverflow.com/users/5180437/santhosh-kgn"}, "edited": false, "score": 0, "creation_date": 1471459151, "post_id": 39003847, "comment_id": 65359684, "body": "@sathish dbush didn&#39;t address the second example is its premise is wrong."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 41, "user_id": 5180437, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/82ee3e0a21af261740c43e2488f985e4?s=128&d=identicon&r=PG&f=1", "display_name": "santhosh kgn", "link": "https://stackoverflow.com/users/5180437/santhosh-kgn"}, "edited": false, "score": 2, "creation_date": 1471459319, "post_id": 39003847, "comment_id": 65359784, "body": "@sathish related, <a href=\"https://stackoverflow.com/questions/750178/is-it-a-good-idea-to-typedef-pointers\">stop hiding pointer types in typedefs</a> and that problem becomes irrelevant. It&#39;s considered by most to be bad practice in all but a <i>very</i> limited number of circumstances (of which this is <i>not</i> one). It usually ends up accomplishing nothing but obfuscating the code and thereby making it harder to work with (which you&#39;re finding out)."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 4, "last_activity_date": 1471460278, "last_edit_date": 1471460278, "creation_date": 1471458358, "answer_id": 39003847, "question_id": 39003798, "link": "https://stackoverflow.com/questions/39003798/how-to-access-struct-member-via-pointer-to-pointer/39003847#39003847", "title": "How to access struct member via pointer to pointer", "body": "<p>You need to dereference the first pointer, then use the pointer-to-member operator:</p>\n\n<pre><code>(*pstu)-&gt;a\n</code></pre>\n\n<p>The parenthesis are required because the pointer-to-member operator has higher precedence than the dereference operator.</p>\n\n<p>This is the same for both cases because <code>stu **</code> and <code>pstdu *</code> represent the same type.  As mentioned in the comments, it's considered bad practice to have a pointer in a <code>typedef</code> because it can hide that fact that a pointer is in use and can become confusing.</p>\n"}], "owner": {"reputation": 41, "user_id": 5180437, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/82ee3e0a21af261740c43e2488f985e4?s=128&d=identicon&r=PG&f=1", "display_name": "santhosh kgn", "link": "https://stackoverflow.com/users/5180437/santhosh-kgn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1306, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471461376, "creation_date": 1471458200, "last_edit_date": 1471461376, "question_id": 39003798, "link": "https://stackoverflow.com/questions/39003798/how-to-access-struct-member-via-pointer-to-pointer", "title": "How to access struct member via pointer to pointer", "body": "<pre><code>typedef struct {\n    int a;\n} stu, *pstdu;\n\nvoid func(stu **pst);\n\nint main() {\n    stu *pst;\n    pst = (stu*)malloc(sizeof(stu));\n    pst-&gt;a = 10;\n    func(&amp;pst);\n}\n\nvoid func(stu **pstu) {\n    /* how to access the variable a */\n}\n</code></pre>\n\n<p>1) Want to access the structure variable a by passing the pointer address,\n   in above function func.</p>\n\n<p>2) In following case how it will behave\n   example:</p>\n\n<pre><code>typedef struct {\n    int a;\n} stu, *pstdu;\n\nvoid func(pstdu *pst);\n\nint main() {\n    stu *pst;\n    pst = (stu*)malloc(sizeof(stu));\n    pst-&gt;a = 10;\n    func(&amp;pst);\n}\n\nvoid func(pstdu *pstu) {\n   /* how to access the variable a */\n}\n</code></pre>\n"}, {"tags": ["c", "dynamic", "arguments", "wrapper", "vxworks"], "answers": [{"tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": false, "score": 3, "last_activity_date": 1471458273, "last_edit_date": 1471458273, "creation_date": 1471457891, "answer_id": 39003727, "question_id": 39003653, "link": "https://stackoverflow.com/questions/39003653/how-do-i-correctly-wrap-a-function-with-dynamic-number-of-args-up/39003727#39003727", "title": "how do I correctly wrap a function with dynamic number of args up?", "body": "<p>The function dbgLog must take an argument of type va_list and not variable arguments via the ellipsis:</p>\n\n<pre><code>void dbgLog(tDbgLog*dbg, const char *mod, const char *func, const char *format, va_list list)\n                                                                                ^^^^^^^\n</code></pre>\n\n<p>The argument list, in the function dbgLog, is then passed to function vsnprintf.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 0, "last_activity_date": 1471458269, "creation_date": 1471458269, "answer_id": 39003824, "question_id": 39003653, "link": "https://stackoverflow.com/questions/39003653/how-do-i-correctly-wrap-a-function-with-dynamic-number-of-args-up/39003824#39003824", "title": "how do I correctly wrap a function with dynamic number of args up?", "body": "<p>There is no portable way to pass the arguments of a vararg function to another vararg function.  You can implement <code>dbgLog</code> by calling a function <code>vdbgLog</code> defined as:</p>\n\n<pre><code>void vdbgLog(tDbgLog *dbg, const char *mod, const char *func,\n             const char *format, va_list ap) {\n    /* your implementation goes here */\n}\n\nvoid dbgLog(tDbgLog *dbg, const char *mod, const char *func, const char *fmt, ...) {\n    va_list args;\n    va_start(args, fmt);\n    vdbgLog(dbg, mod, func, fmt, args);\n    va_end(args);\n}\n</code></pre>\n\n<p>And you can call this function <code>vdbgLog</code> directly from <code>pMonDbgLog</code> as well:</p>\n\n<pre><code>void pMonDbgLog(const char *mod, const char *func, char *fmt, ...) {\n    va_list args;\n    va_start(args, fmt);\n    vdbgLog(g_pdbg, mod, func, fmt, args);\n    va_end(args);\n}\n</code></pre>\n"}], "owner": {"reputation": 9553, "user_id": 1198201, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/Y3RU6.png?s=128&g=1", "display_name": "stdcerr", "link": "https://stackoverflow.com/users/1198201/stdcerr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 1, "accepted_answer_id": 39003824, "answer_count": 2, "score": -1, "last_activity_date": 1471458273, "creation_date": 1471457645, "question_id": 39003653, "link": "https://stackoverflow.com/questions/39003653/how-do-i-correctly-wrap-a-function-with-dynamic-number-of-args-up", "title": "how do I correctly wrap a function with dynamic number of args up?", "body": "<p>I want to wrap a function that looks like: <code>void dbgLog (tDbgLog *dbg, const char *mod, const char *func, const char *format,...)</code> and makes use of <code>vsnprintf()</code> to make it accessible by calling another function, I've tried the following but that doesn't seem to work correctly:</p>\n\n<pre><code>void pMonDbgLog(const char *mod, const char *func, char* fmt, ...)\n{\n    va_list args;\n    va_start(args,fmt);\n    dbgLog(g_pdbg,mod,func,fmt,args);\n    va_end(args);\n}\n</code></pre>\n\n<p>and I again make this accessible through the following macro:<code>#define gDbgLog(fmt,...)      pMonDbgLog(MODULE_NAME,__FUNCTION__,fmt, ##__VA_ARGS__)</code> but turns out that my arguments get messed up. Why is this, I'm wondering?</p>\n"}, {"tags": ["c", "server", "port"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1471457332, "post_id": 39003492, "comment_id": 65358656, "body": "maybe because only port 21 is open on the remote host..? Have you tried a similar scan with nmap? Same/Different results?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471457534, "post_id": 39003492, "comment_id": 65358776, "body": "You say it only shows port 21, therefore that&#39;s wrong. How do you know that&#39;s wrong? Have you proven with other tools that any other ports are open?"}, {"owner": {"reputation": 107, "user_id": 6713389, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6391297cfa5665f03566a8a9c2ff054b?s=128&d=identicon&r=PG&f=1", "display_name": "Dezzy", "link": "https://stackoverflow.com/users/6713389/dezzy"}, "edited": false, "score": 0, "creation_date": 1471457691, "post_id": 39003492, "comment_id": 65358855, "body": "i own the server, i know what ports are open, also nmap showed 30 open ports"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1471466269, "post_id": 39003492, "comment_id": 65363351, "body": "I know you know about <code>nmap</code>. A look at the source of a well-developed bit of code, isn&#39;t cheating and doesn&#39;t prevent you from learning, but sure may save you from making some of the same mistakes that have long since been debugged out of that code <code>:)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "is_accepted": false, "score": 1, "last_activity_date": 1471464853, "last_edit_date": 1471464853, "creation_date": 1471464394, "answer_id": 39005381, "question_id": 39003492, "link": "https://stackoverflow.com/questions/39003492/c-scan-open-ports-on-remote-server/39005381#39005381", "title": "C scan open ports on remote server", "body": "<p>Once a socket is connected, further attempts to <code>connect</code> it are guaranteed to fail with <code>EISCONN</code>. You need to create a new socket in each iteration (and don't forget to close it).</p>\n"}], "owner": {"reputation": 107, "user_id": 6713389, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6391297cfa5665f03566a8a9c2ff054b?s=128&d=identicon&r=PG&f=1", "display_name": "Dezzy", "link": "https://stackoverflow.com/users/6713389/dezzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1471464853, "creation_date": 1471457098, "question_id": 39003492, "link": "https://stackoverflow.com/questions/39003492/c-scan-open-ports-on-remote-server", "title": "C scan open ports on remote server", "body": "<p>I was trying to write a C program that checks for open ports on a remote server. </p>\n\n<p>IMPORTANT: I know there are solutions like nmap or so, but the key here was for me to learn how to program something like this myself. </p>\n\n<p>I have wrote the following code, it gives you a prompt asking for an IP and a Port. </p>\n\n<p>Now there are two solutions:</p>\n\n<p>a) a port number has been entered -> connection to this port will be tested</p>\n\n<p>b) \"scan\" will gets entered -> every port from 1 to 5000 will be checked for successful connection. </p>\n\n<p>So my problem is, whenever i enter \"scan\", only Port 21 will be listed as \"open\". </p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;unistd.h&gt;\n\n#define OK 0\n#define NO_INPUT 1\n#define TOO_LONG 2\n\nstatic int getLine (char *prmpt, char *buff, size_t sz){\n\n    int ch, extra;\n\n    if (prmpt != NULL) {\n        printf(\"%s\", prmpt);\n        fflush(stdout);\n    }\n\n    if (fgets(buff, sz, stdin) == NULL)\n        return NO_INPUT;\n\n    if (buff[strlen(buff)-1] != '\\n') {\n        extra = 0;\n        while (((ch = getchar()) != '\\n') &amp;&amp; (ch != EOF)){\n            extra = 1;\n        }\n        return (extra == 1) ? TOO_LONG : OK;\n    }\n\n    buff[strlen(buff) - 1] = '\\0';\n    return OK;\n}\n\n\n\nint main (int argc, char *argv[])\n{\n\nint socket_desc;\nstruct sockaddr_in server;\n\nsocket_desc = socket(AF_INET, SOCK_STREAM, 0);\n\nif (socket_desc == -1){\n    printf(\"Could not open socket\\n\");\n}\n\nchar ip[30];\nchar port[5];\n\n\n\ngetLine(\"IP&gt; \", ip, sizeof(ip));\ngetLine(\"Port&gt; \", port, sizeof(port));\n\nif (strcmp(\"scan\", port) == 0){\n    puts(\"scanning....\");\n    server.sin_addr.s_addr = inet_addr(ip);\n    server.sin_family = AF_INET;\n\n    for (int i = 1; i &lt; 5000; i++){\n        server.sin_port = htons(i);\n        if (connect(socket_desc, (struct sockaddr * )&amp;server, sizeof(server)) &lt; 0 ) {\n\n        }\n        else {\n            printf(\"Open port: %d\\n\", i);\n        }\n\n\n\n    }\n\n\n}\nelse {\nint iport = atoi(port);\n\nserver.sin_addr.s_addr = inet_addr(ip);\nserver.sin_family = AF_INET;\nserver.sin_port = htons(iport);\n\nif (connect(socket_desc, (struct sockaddr * )&amp;server, sizeof(server)) &lt; 0 )\n{\nputs(\"connect error\");\nreturn 1;\n}\n\nputs(\"Connected\");\n}\n\nreturn 0;\n\n}\n</code></pre>\n\n<p>Why is only the port 21 (FTP) listed as open ? Is it due to the nature of the functions i used, that those are only for data connection (which is port 21 then). Should I use a different function or even maybe a different method (out of my head, maybe ping a port (if possible) instead of trying to connect)</p>\n\n<p>My final goal is to write a program which scans a server and lists the open ports and also what is running on there (SSH, SMTP etc)</p>\n\n<p>thanks for any help!!</p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1471456197, "post_id": 39003222, "comment_id": 65358032, "body": "Where do you set <code>findval</code>?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1471456225, "post_id": 39003222, "comment_id": 65358047, "body": "Please try to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> and show us. Also learn how to use a debuger."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1471456226, "post_id": 39003222, "comment_id": 65358048, "body": "Should <code>findval</code> be <code>find</code>?"}, {"owner": {"reputation": 1455, "user_id": 5339966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0897e935d50e040875b9ea61d8c0851c?s=128&d=identicon&r=PG&f=1", "display_name": "mszymborski", "link": "https://stackoverflow.com/users/5339966/mszymborski"}, "edited": false, "score": 2, "creation_date": 1471456253, "post_id": 39003222, "comment_id": 65358070, "body": "I&#39;d strongly advise to take a look at tools like Valgrind - they will help you in future. A lot."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1471456279, "post_id": 39003222, "comment_id": 65358084, "body": "Side note: Ask yourself how that final <code>else</code> is <i>ever</i> reached. Mental floss it. The only three comparative possible conditions are already covered prior. In fact, everything after the second <code>else if</code> could be removed, and simply replaced by <code>return searchtruth(vals, min , mid , findval);</code> Finally, this code is comparing values from the sequence <code>vals[]</code>, using <code>mid</code> as the index, computed from crunching <code>min</code> and <code>max</code>, but you&#39;re also comparing <code>findval</code> with <code>min</code> and <code>max</code> as if they were values, not indexes into <code>vals[]</code>. Pretty sure that&#39;s a bug too."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1471456280, "post_id": 39003222, "comment_id": 65358085, "body": "I think suspect the problem is in the code that calls this function. Segmentation faults come from misuse of pointers, and there are no pointers in this function."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1471456724, "post_id": 39003222, "comment_id": 65358328, "body": "Did you mean <code>mid = min + ((max - min) &#47; 2);</code>?  You put <code>(min - max)</code>. And what is wrong with <code>mid = (min + max) &#47; 2</code> anyway?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1471456807, "post_id": 39003222, "comment_id": 65358370, "body": "@WeatherVane in order of asked (a) undoubtedly, and (b) potential overflow on <code>max + min</code> (not likely, but never say never)."}, {"owner": {"reputation": 410, "user_id": 5508526, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e6bb216636658818024e5992fc6056a5?s=128&d=identicon&r=PG", "display_name": "P. Str", "link": "https://stackoverflow.com/users/5508526/p-str"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1471456872, "post_id": 39003222, "comment_id": 65358413, "body": "I agree with @Weather Vane. Place a &quot;printf&quot; function to check the  value of mid during every function call. The problem may be the unreasonable value of mid since it is used as index in your &quot;vals&quot; array"}, {"owner": {"reputation": 8, "user_id": 5800619, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HsPPHA4Sv5c/AAAAAAAAAAI/AAAAAAAAAB4/BgSvnCo0ghw/photo.jpg?sz=128", "display_name": "Heatblast016", "link": "https://stackoverflow.com/users/5800619/heatblast016"}, "edited": false, "score": 0, "creation_date": 1471457589, "post_id": 39003222, "comment_id": 65358808, "body": "sorry abt that findval thing, I had edited it, now it is the original program."}, {"owner": {"reputation": 8, "user_id": 5800619, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HsPPHA4Sv5c/AAAAAAAAAAI/AAAAAAAAAB4/BgSvnCo0ghw/photo.jpg?sz=128", "display_name": "Heatblast016", "link": "https://stackoverflow.com/users/5800619/heatblast016"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1471457651, "post_id": 39003222, "comment_id": 65358839, "body": "@WhozCraig It was bugging out before that"}, {"owner": {"reputation": 8, "user_id": 5800619, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HsPPHA4Sv5c/AAAAAAAAAAI/AAAAAAAAAB4/BgSvnCo0ghw/photo.jpg?sz=128", "display_name": "Heatblast016", "link": "https://stackoverflow.com/users/5800619/heatblast016"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1471457720, "post_id": 39003222, "comment_id": 65358874, "body": "@WeatherVane thanks for pointing that out and I didnt think of the other one"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1471457747, "post_id": 39003222, "comment_id": 65358894, "body": "Similarly <code>if(min - max == 1 ... )</code> is incorrect."}, {"owner": {"reputation": 8, "user_id": 5800619, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HsPPHA4Sv5c/AAAAAAAAAAI/AAAAAAAAAB4/BgSvnCo0ghw/photo.jpg?sz=128", "display_name": "Heatblast016", "link": "https://stackoverflow.com/users/5800619/heatblast016"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1471457807, "post_id": 39003222, "comment_id": 65358930, "body": "@WeatherVane I needed some sort of catch to end the recursion"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1471457838, "post_id": 39003222, "comment_id": 65358949, "body": "Yes you do, and it needs to be <code>(max - min)</code> once again"}, {"owner": {"reputation": 8, "user_id": 5800619, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HsPPHA4Sv5c/AAAAAAAAAAI/AAAAAAAAAB4/BgSvnCo0ghw/photo.jpg?sz=128", "display_name": "Heatblast016", "link": "https://stackoverflow.com/users/5800619/heatblast016"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1471457933, "post_id": 39003222, "comment_id": 65359002, "body": "@WeatherVane Thanks. Ill test it and it will probably  work(IDK why I forget to catch that)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1471457980, "post_id": 39003222, "comment_id": 65359029, "body": "Yes, but please do not correct the posted code, it makes the dialog meaningless. Rolled back."}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1471459809, "post_id": 39003222, "comment_id": 65360034, "body": "What are minimum and maximum supposed to represent? From the code, it looks like they are indices into the array. So why are you comparing findval to those values?"}], "answers": [{"comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1471458010, "post_id": 39003740, "comment_id": 65359047, "body": "I&#39;m upticking this because it is correct, regardless of what the now-morphed code looks like. (hate when that happens)."}, {"owner": {"reputation": 8, "user_id": 5800619, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HsPPHA4Sv5c/AAAAAAAAAAI/AAAAAAAAAB4/BgSvnCo0ghw/photo.jpg?sz=128", "display_name": "Heatblast016", "link": "https://stackoverflow.com/users/5800619/heatblast016"}, "edited": false, "score": 0, "creation_date": 1471458119, "post_id": 39003740, "comment_id": 65359109, "body": "It is correct and I am sorry abt editing the code. Thanks"}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 1, "last_activity_date": 1471457942, "creation_date": 1471457942, "answer_id": 39003740, "question_id": 39003222, "link": "https://stackoverflow.com/questions/39003222/c-segmentation-fault-for-no-reason/39003740#39003740", "title": "C segmentation fault for no reason", "body": "<p>There are two places in the code where you use</p>\n\n<pre><code>min - max\n</code></pre>\n\n<p>and in both places it should be</p>\n\n<pre><code>max - min\n</code></pre>\n"}], "owner": {"reputation": 8, "user_id": 5800619, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HsPPHA4Sv5c/AAAAAAAAAAI/AAAAAAAAAB4/BgSvnCo0ghw/photo.jpg?sz=128", "display_name": "Heatblast016", "link": "https://stackoverflow.com/users/5800619/heatblast016"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 39003740, "answer_count": 1, "score": -5, "last_activity_date": 1471457990, "creation_date": 1471456084, "last_edit_date": 1471457990, "question_id": 39003222, "link": "https://stackoverflow.com/questions/39003222/c-segmentation-fault-for-no-reason", "title": "C segmentation fault for no reason", "body": "<p>I am taking edx's cs50 course and have run into a problem in my c code.\nIt gives me a segmentation fault for no obvious reason and all the other answers for this type of problem are too complicated for me to understand(I am a beginner)\nIt is a binary search function that will return true if it finds the value otherwise it will return false.\nthe code is as follows:</p>\n\n<pre><code>bool searchtruth(int vals[],int minimum, int maximum, int findval)\n{\n    int min = minimum;\n    int max = maximum;\n    if(min - max == 1 &amp;&amp; (findval &lt; max &amp;&amp;findval &gt; min))\n    {\n        return false;\n    }\n    int mid = min + ((min - max) / 2);\n    if(vals[mid] == findval)\n    {\n        return true;\n    }\n    else if(vals[mid] &lt; findval)\n    {\n        return searchtruth(vals, mid , max, findval);\n    }\n    else if(vals[mid] &gt; findval)\n    {\n        return searchtruth(vals, min , mid , findval);\n    }\n    else\n    {\n        return false;\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2131, "user_id": 3726169, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ad0f33269912ab7a2fb9f30df6f2d392?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Chesterfield", "link": "https://stackoverflow.com/users/3726169/jon-chesterfield"}, "edited": false, "score": 0, "creation_date": 1471456117, "post_id": 39003181, "comment_id": 65357988, "body": "assigned rightmost first"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1471456306, "post_id": 39003181, "comment_id": 65358100, "body": "These are called &quot;assignments&quot;, not &quot;definitions&quot;."}, {"owner": {"reputation": 2060, "user_id": 2561805, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ad2d8c097cfaa8fdc3ac87bfa9b8d277?s=128&d=identicon&r=PG", "display_name": "goo", "link": "https://stackoverflow.com/users/2561805/goo"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1471456858, "post_id": 39003181, "comment_id": 65358402, "body": "@aschepler edited. That is correct."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1471461512, "post_id": 39003181, "comment_id": 65360882, "body": "Too bad this post did not show the declaration of <code>a[], b[], c[]</code> as that can make a difference."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471463114, "post_id": 39003181, "comment_id": 65361704, "body": "@chux: Neither does the dup :-(. That&#39;s why I think a comprehensive answer should be given."}], "answers": [{"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 2, "creation_date": 1471458790, "post_id": 39003283, "comment_id": 65359483, "body": "There aren&#39;t any sequence points in direct assignments, unlike in the bottom example. Therefore not strictly equivalent."}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 2, "creation_date": 1471460028, "post_id": 39003283, "comment_id": 65360147, "body": "The equivalence you mention is technically not quite correct. (but has the same effect as if it were). For <code>a = b = c = 0</code> the equivalence is <code>c=0; b=c; a=b;</code> (and also accepting @2501&#39;s explanation of not quite equivalent)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1471460530, "post_id": 39003283, "comment_id": 65360432, "body": "They are also not equivalent for <code>volatile</code> qualified lvalues for the LHS of all but the leftmost assignment. And they also might not have the &quot;same effect&quot;."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471460683, "post_id": 39003283, "comment_id": 65360507, "body": "@Olaf It&#39;s quite obvious. So, if you are going to take exception to &quot;same effect&quot; and downvote, I am fine with it."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1471460760, "post_id": 39003283, "comment_id": 65360541, "body": "@P.P.: For <code>volatile</code> lvalues, this is a very dangerous thing, as the standard does not even require an implementation to have a consistent behaviour. See the dup."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1471461541, "post_id": 39003283, "comment_id": 65360900, "body": "@Olaf In fact, this could even be UB. If <code>a</code> has fewer elements than <code>level</code>, there&#39;s an out of bound access. Or if they were declared as: <code>int i = 0; int *a = &amp;i; int *b = &amp;i; int *c = &amp;i;</code> and assuming <code>level</code>&gt;0, there&#39;s also UB. I am sure many similar issues can be &quot;invented&quot; without seeing how the objects involved are declared."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1471461773, "post_id": 39003283, "comment_id": 65361028, "body": "@P.P. Actually assuming at least two of those pointers point to the same object, the behavior is undefined due to lack of sequence points."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1471461815, "post_id": 39003283, "comment_id": 65361047, "body": "@2501 ...which is what I just said in the comment above?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1471461943, "post_id": 39003283, "comment_id": 65361107, "body": "@P.P. Great, I see that now."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1471462973, "post_id": 39003283, "comment_id": 65361646, "body": "@P.P.: That is not a matter of &quot;invention&quot;, but a very existent problem. No need to construct some UB here. But I well understand if one never worked with <code>volatile</code> lvalues, the problem seems to be far-fetched. For an embedded engineer, this is a very present issue."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471467236, "post_id": 39003283, "comment_id": 65363852, "body": "@Olaf (Let&#39;s just assume you are the only one that knows about <code>volatile</code> qualified objects and put it aside). I am sure out-of-bounds access is also a very real issue for an embedded engineer. The point is that you are basing your argument on <i>what if it&#39;s volatile qualified?</i> and I am saying one could make similar argument for other cases too. Somehow <i>your</i> &quot;what if&quot; is a real issue whereas others are not?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471469072, "post_id": 39003283, "comment_id": 65364690, "body": "@P.P.: Again: there is a significant difference assuming invalid code like you do or valid code! Feel free to revenge-DV, I&#39;m out of this nonsense!"}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 3, "last_activity_date": 1471460545, "last_edit_date": 1471460545, "creation_date": 1471456338, "answer_id": 39003283, "question_id": 39003181, "link": "https://stackoverflow.com/questions/39003181/back-to-back-assignments-in-c/39003283#39003283", "title": "Back-to-back assignments in C", "body": "<pre><code> a[i] = b[i] = c[i] = 0;\n</code></pre>\n\n<p>is parsed as:</p>\n\n<pre><code> a[i] = (b[i] = (c[i] = 0));\n</code></pre>\n\n<p>and has the same effect as:</p>\n\n<pre><code> a[i] = 0;\n b[i] = 0;\n c[i] = 0;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1471461687, "post_id": 39004525, "comment_id": 65360973, "body": "This answer says &quot;First 0 is assigned to ...&quot; and &quot;value of ... is assigned ...&quot;.  As I see it, there are no sequence points, so an optimizing compiler may re-order the assignments such as assigning <code>0</code> to <code>a[i]</code> and then the others."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1471462089, "post_id": 39004525, "comment_id": 65361167, "body": "<i>assignment statements are evaluated from right to left.</i> Incorrect. Right to left associativity has nothing to do with order of evaluation."}], "tags": [], "owner": {"reputation": 1624, "user_id": 5889270, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/WP9Wo.png?s=128&g=1", "display_name": "asad_hussain", "link": "https://stackoverflow.com/users/5889270/asad-hussain"}, "is_accepted": false, "score": 0, "last_activity_date": 1471461143, "creation_date": 1471461143, "answer_id": 39004525, "question_id": 39003181, "link": "https://stackoverflow.com/questions/39003181/back-to-back-assignments-in-c/39004525#39004525", "title": "Back-to-back assignments in C", "body": "<p>The processing of above code goes as follows ...</p>\n\n<p>First <code>0</code> is assigned to <code>c[i]</code> and then value of <code>c[i]</code> is assigned to <code>b[i]</code> and then the value of <code>b[i]</code> is assigned to <code>a[i]</code>.</p>\n\n<p>So,overall to clear your concept,u should keep in mind from now that such assignment statements are evaluated from <code>right to left</code>.</p>\n"}], "owner": {"reputation": 2060, "user_id": 2561805, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ad2d8c097cfaa8fdc3ac87bfa9b8d277?s=128&d=identicon&r=PG", "display_name": "goo", "link": "https://stackoverflow.com/users/2561805/goo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "closed_date": 1471462264, "accepted_answer_id": 39003283, "answer_count": 2, "score": 1, "last_activity_date": 1471461143, "creation_date": 1471455951, "last_edit_date": 1471456962, "question_id": 39003181, "link": "https://stackoverflow.com/questions/39003181/back-to-back-assignments-in-c", "closed_reason": "Duplicate", "title": "Back-to-back assignments in C", "body": "<p>I came across this code today:</p>\n\n<pre><code>for (i = 0; i &lt; level; i++) {\n    a[i] = b[i] = c[i] = 0;\n}\n</code></pre>\n\n<p>What is the meaning of the code located inside the for loop?</p>\n"}, {"tags": ["c", "string", "char"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1471455272, "post_id": 39002974, "comment_id": 65357547, "body": "The return type is <code>char *</code>, which is a pointer to the string literal."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1471455324, "post_id": 39002974, "comment_id": 65357576, "body": "String literals are arrays of <code>char</code>, and when using it you get a pointer to the first element in the array, i.e. a pointer to the first character. Also note that arrays decays to a pointer to the first element, so when you do <code>return Hello</code> in the second program it&#39;s the same as doing <code>return &amp;Hello[0]</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1471455434, "post_id": 39002974, "comment_id": 65357633, "body": "Note that in your second program you have a memory leak. You allocate memory in the loop in the <code>main</code> function, and assign it to <code>result[i]</code>. Directly afterwards you reassign to the very same <code>result[i]</code> making you lose the first pointer."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1471541229, "post_id": 39002974, "comment_id": 65399084, "body": "@ryan: can you accept one of the answers by clicking on the grey checkmark below its score?"}], "answers": [{"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1471458696, "post_id": 39003149, "comment_id": 65359433, "body": "Great answer, unfortunately strdup is not in the C lib."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1471465116, "post_id": 39003149, "comment_id": 65362766, "body": "Detail: The string literal is stored as a null terminated &lt;strike&gt;<code>const</code>&lt;/strike&gt; array of <code>char</code>.  Attempting to change the string literal is UB, but it is type <code>char *</code> and should be treated as <code>const char*</code>."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1471509034, "post_id": 39003149, "comment_id": 65377614, "body": "@2501: you are correct, <code>strdup()</code> is not defined in the C Standard, but it is present in many C libraries because it is part of Posix.  Why the Standard&#39;s committee would focus on some obscure extensions and fail to standardize Posix functions is incomprehensible."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1471515214, "post_id": 39003149, "comment_id": 65381521, "body": "I can&#39;t upvote if you don&#39;t mention the nature of this non-standard function in the answer."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471515278, "post_id": 39003149, "comment_id": 65381574, "body": "@chux The type of a string literal &quot;hello&quot; is <code>char[6]</code> not <code>char*</code>."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1471515634, "post_id": 39003149, "comment_id": 65381786, "body": "@2501: I edited the answer with an explanation about <code>strdup()</code>, what do you think is missing?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1471527186, "post_id": 39003149, "comment_id": 65389558, "body": "@2501 True,  <code>&quot;hello&quot;</code> is <code>char[6]</code> and not <code>char *</code> nor <code>const char *</code>."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 3, "last_activity_date": 1471515833, "last_edit_date": 1471515833, "creation_date": 1471455859, "answer_id": 39003149, "question_id": 39002974, "link": "https://stackoverflow.com/questions/39002974/if-c-can-return-only-one-valueint-char-etc-then-how-does-it-returns-charact/39003149#39003149", "title": "If C can return only one value(int , char etc.) then how does it returns character string literal(array of chars)?", "body": "<p>The statement <code>return \"hello World\";</code> returns a <code>char *</code>: a pointer to the first character of the string literal <code>\"hello World\"</code>. This string literal is stored as a null terminated array of 12 <code>char</code>. It is usually stored in memory along with other const data of the program.</p>\n\n<p>Attempting to modify this array invokes undefined behavior. It should be considered <code>const</code> and handled via <code>const char *</code>. It would be safer to define this function as</p>\n\n<pre><code>const char *returnString(void) {\n    return \"hello World\";\n}\n</code></pre>\n\n<p>Furthermore, you should not use the <code>&amp;</code> on the function call in your <code>printf</code> statement.  It should read:</p>\n\n<pre><code>int main(void) {\n    printf(\"\\n%p\\n\", (void*)returnString());\n    return 0;\n}\n</code></pre>\n\n<p>Regarding your second question, you should return a copy of the string in <code>Hello</code>.  Use this simple method:</p>\n\n<pre><code>if (strcmp(str, \"hello\") == 0)\n    return strdup(Hello);\n</code></pre>\n\n<p><code>strdup()</code> is not defined in the C Standard, but is specified in the Posix standard.  If it is not available in your system, it can be defined as:</p>\n\n<pre><code>char *strdup(const char *s) {\n    char *p = malloc(strlen(s) + 1);\n    if (p) strcpy(p, s);\n    return p;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1471463195, "post_id": 39003211, "comment_id": 65361747, "body": "You could use <code>static char buf[16] = &quot;hello, world&quot;;</code> in <code>d</code> (instead of needing <code>strcpy()</code>).  You should also show <code>void f(char *buffer, size_t buflen) { if (buflen &gt;= sizeof(&quot;hello world&quot;)) strcpy(buffer, &quot;hello world&quot;); else { assert(buflen &gt; 0); buffer[0] = &#39;\\0&#39;; } }</code>.  That avoids the risk of buffer overflow that you assert makes <code>e</code> undesirable.  How big the risk is depends on what the function does.  With the trivial ones here, the risk is low.  It is not always low.  <code>f</code> is pretty safe \u2014 the only isses relate to null pointer for the buffer or a zero size for the buffer length."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471464868, "post_id": 39003211, "comment_id": 65362639, "body": "More precise: <code>a()</code> returns a pointer: <code>char *</code>.  That pointer has a value of the address of the beginning of a string literal."}], "tags": [], "owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "is_accepted": false, "score": 3, "last_activity_date": 1585051220, "last_edit_date": 1585051220, "creation_date": 1471456047, "answer_id": 39003211, "question_id": 39002974, "link": "https://stackoverflow.com/questions/39002974/if-c-can-return-only-one-valueint-char-etc-then-how-does-it-returns-charact/39003211#39003211", "title": "If C can return only one value(int , char etc.) then how does it returns character string literal(array of chars)?", "body": "<p>The location of where a string is allocated depends how you write it. These all return strings, but in different ways:</p>\n\n<pre><code>const char *a()\n{\n    return \"hello, world\";\n}\n\nchar *b()\n{\n    return strdup(\"hello, world\");\n}\n\nchar *c()\n{\n    char buf[16];\n    strcpy(buf, \"hello, world\");\n    return buf; /* wrong */\n}\n\nchar *d()\n{\n    static char buf[16];\n    strcpy(buf, \"hello, world\");\n    return buf;\n}\n\nvoid e(char *buf)\n{\n    strcpy(buf, \"hello, world\");\n}\n</code></pre>\n\n<p><code>a</code> returns a string literal. It is stored in read-only memory and cannot be changed. </p>\n\n<p><code>b</code> returns a string allocated on the heap. It must be freed with a call to <code>free</code>.</p>\n\n<p><code>c</code> returns a string allocated on the stack. It is wrong, however, because you cannot return a pointer to a local variable, in this case <code>buf</code>. When the closing brace is reached, the object being referenced no longer exists.</p>\n\n<p><code>d</code> offers an improvement to <code>c</code>. When the variable is declared <code>static</code>, it is (on many compilers) stored in the <code>.bss</code> segment. It is not a correction, however, because it isn't thread safe.</p>\n\n<p><code>e</code> returns a string not via the return mechanism, but by filling in an address. This code is not recommended, because buffer overflows may occur. The argument to <code>e</code> can be allocated either on the stack or heap, by the caller. As long as there is enough space to perform a copy, it will work.</p>\n\n<p>Improved version of <code>e</code>:</p>\n\n<pre><code>/* n is the size of buf, in chars */\nvoid eImproved(char *buf, size_t n)\n{\n    if (n &gt; sizeof \"hello, world\") /* enough room in buf for copy */\n        strcpy(buf, \"hello, world\");\n    else\n        buf[0] = '\\0';             /* if not enough room, make buf empty */\n}\n</code></pre>\n\n<p>If you want to print the address, use <code>%p</code> in printf:</p>\n\n<pre><code>printf(\"%p\", a());\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6220464, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/27dd7066424fc5ab4b2c5dcc4a39a086?s=128&d=identicon&r=PG&f=1", "display_name": "ryan", "link": "https://stackoverflow.com/users/6220464/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1585051220, "creation_date": 1471455182, "last_edit_date": 1471458970, "question_id": 39002974, "link": "https://stackoverflow.com/questions/39002974/if-c-can-return-only-one-valueint-char-etc-then-how-does-it-returns-charact", "title": "If C can return only one value(int , char etc.) then how does it returns character string literal(array of chars)?", "body": "<pre><code>char *returnString()\n{\n    return \"hello World\";\n}\n\nint main()\n{\n    printf(\"\\n %p \", &amp;returnString());\n    return 0;\n}\n</code></pre>\n\n<p>what does <code>returnString()</code> returns here ? does it returns address of <code>'h'</code>?<br>\nif it then where is <code>\"hello world\"</code> is stored(stack / heap) ? how to see (print) address of it ?</p>\n\n<pre><code>char Hello[] = \"It's Hello\";\n\nchar something[] = \"something like \";\n\nchar *readInput(char str[]) {\n    char *tempStr = NULL;\n    if (strcmp(str, \"hello\") == 0)\n        return Hello;\n\n    tempStr = (char *)malloc((strlen(something)) + (strlen(str)) + 1);\n\n    strcpy(tempStr, something);\n    strcat(tempStr, str);\n\n    return tempStr;\n}\n\nint main() {\n    int i;\n    char *userInput[] = { \"hello\", \"xyz\", \"hello\",  \"abc\" };\n    char **result = (char **)malloc(sizeof(char *) * (4));\n\n    for (i = 0; i &lt; 4; i++) {\n        result[i] = (char *)malloc(15);\n\n        result[i] = readInput(userInput[i]);\n    }\n    printf(\"\\n\\n\");\n\n    strcpy(Hello, \"String is Changed\"); // this should not affect result[0] &amp;&amp; result[2]\n\n    for (i = 0; i &lt; 4; i++)\n        printf(\"\\t\\t %s\", result[i]);\n\n    printf(\"\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>What modification should be done in 2nd program so that even after this ---> <code>strcpy(Hello, \"String is Changed\");</code>  values of <code>result[0]</code>  and <code>result[2]</code> not get changed.</p>\n"}, {"tags": ["c", "xcode", "redirect", "terminal"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1471455224, "post_id": 39002633, "comment_id": 65357527, "body": "Build failures in Xcode can be found in the warning/error list of the main project tree (left side by default of the Xcode UI). Fourth icon from the left, looks like a little triangle. Click it, You can then click each (or all) of your warnings/errors and copy them to the clipboard, then paste them in your question. We can&#39;t see your screenshot, so you may as well fix it by doing this right."}, {"owner": {"reputation": 1, "user_id": 6727383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b1430a91fb2fd7cb09c2e899d05054?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Gilardenghi", "link": "https://stackoverflow.com/users/6727383/luca-gilardenghi"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1471688067, "post_id": 39002633, "comment_id": 65455111, "body": "Sorry you cant see the print screen, this is the error:"}, {"owner": {"reputation": 1, "user_id": 6727383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b1430a91fb2fd7cb09c2e899d05054?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Gilardenghi", "link": "https://stackoverflow.com/users/6727383/luca-gilardenghi"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1471688135, "post_id": 39002633, "comment_id": 65455127, "body": "export arch=x86_64     export variant=normal     /usr/bin/make  make: *** No targets specified and no makefile found.  Stop. Command /usr/bin/make failed with exit code 2"}], "owner": {"reputation": 1, "user_id": 6727383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b1430a91fb2fd7cb09c2e899d05054?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Gilardenghi", "link": "https://stackoverflow.com/users/6727383/luca-gilardenghi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1471455258, "creation_date": 1471453980, "last_edit_date": 1471455258, "question_id": 39002633, "link": "https://stackoverflow.com/questions/39002633/xcode-to-compile-programs", "title": "xcode to compile programs", "body": "<p>I'm starting out trying to get to grips with CS- learning the basics of C using a book recommended by a friend \"A book on C\" by <em>Al Kelley and Ira Pohl</em>. I am using Xcode OSX El Capitan on a Mac.</p>\n\n<p>I am trying to test one of the examples of code they are using to illustrate the scanf() function, heres the program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main(void)\n{\n    int i;\n    double  x, min, max, sum, avg;\n\n    if (scanf(\"%lf\", &amp;x) !=1){\n        printf(\"No data found\\n\");\n        exit(1);\n    }\n\n    min = max = sum = avg = x;\n    printf(\"%5s%9s%9s%9s%12s%12s\\n%5s%9s%9s%9s%12s%12s\\n\\n\",\n           \"Count\", \"Item\", \"Min\", \"Max\", \"Sum\", \"Average\",\n           \"-----\", \"----\", \"---\", \"---\", \"---\", \"-------\");\n    printf(\"%5d%9.1f%9.1f%9.1f%12.3f%12.3f\\n\",\n           1, x, min, max, sum, avg);\n\n    for (i = 2; scanf(\"%lf\", &amp;x) == 1; ++i) {\n        if (x &lt; 2)\n            min = x;\n        else if (x &gt; max)\n            max = x;\n        sum += x;\n        avg = sum / i;\n        printf (\"%5d%9.1f%9.1f%9.1f%12.3f%12.3f\\n\",\n                i, x, min, max, sum, avg);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>To test the program I tried to build it in Xcode and got this error:</p>\n\n<p>!Screen Shot 2016-08-17 at 18.02.42.png</p>\n\n<p>I realise its probably a very basic problem probably caused by incorrect settings in Xcode becasue I compiled the file in Terminal and it compiled just fine.</p>\n\n<p>My second question relates to compiling in Terminal. I successfully compiled the program using \"cc running_sum.c\" but when I type in the command \"running_sum &lt; data\" (to redirect the input to another text file with some values\") the program cant find the values and prints \"no data found\" as it should when nothing is found.</p>\n\n<p>Can anyone kindly enlighten me how to solve the problem with Xcode build errors and secondly how to correctly redirect the input of the file in Terminal (and xcode too as that would be useful in the future).</p>\n\n<p>Many thanks,</p>\n\n<p>Luca</p>\n"}, {"tags": ["c", "printf", "stderr"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1471452142, "post_id": 39002052, "comment_id": 65355842, "body": "What&#39;s so &quot;strange&quot; about it&#39;s syntax? It&#39;s print <i>where</i>, <i>how</i> and <i>what</i>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1471452399, "post_id": 39002052, "comment_id": 65355977, "body": "I am focusing on it. The only problem which is arising from the question, that you find the solution &quot;strange&quot;. Otherwise there is no question. Use <code>fprintf</code>."}, {"owner": {"reputation": 1781, "user_id": 6706176, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ee68c5e149f63ec9e31ad0c152a48656?s=128&d=identicon&r=PG&f=1", "display_name": "wad", "link": "https://stackoverflow.com/users/6706176/wad"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1471452559, "post_id": 39002052, "comment_id": 65356072, "body": "@Eugene. I agree with you. I thought it was strange as I did not realize stderr is a FILE :)"}], "answers": [{"comments": [{"owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "edited": false, "score": 0, "creation_date": 1600734429, "post_id": 39002101, "comment_id": 113174954, "body": "This is unrelated to the OP and is worded confusingly.  sprintf will &quot;print&quot; to a string and cannot print to stderr."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 5, "last_activity_date": 1471452184, "creation_date": 1471452184, "answer_id": 39002101, "question_id": 39002052, "link": "https://stackoverflow.com/questions/39002052/how-i-can-print-to-stderr-in-c/39002101#39002101", "title": "How I can print to stderr in C?", "body": "<p>Do you know <code>sprintf</code>? It's basically the same thing with <code>fprintf</code>. The first argument is the destination (the file in the case of <code>fprintf</code> i.e. <code>stderr</code>), the second argument is the format string, and the rest are the arguments as usual.</p>\n\n<p>I also recommend <a href=\"http://en.cppreference.com/w/c/io/fprintf\" rel=\"noreferrer\">this <code>printf</code> (and family) reference</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": false, "score": 41, "last_activity_date": 1603805717, "last_edit_date": 1603805717, "creation_date": 1471452522, "answer_id": 39002219, "question_id": 39002052, "link": "https://stackoverflow.com/questions/39002052/how-i-can-print-to-stderr-in-c/39002219#39002219", "title": "How I can print to stderr in C?", "body": "<p>Some examples of formatted output to stdout and stderr:</p>\n<pre><code>printf(&quot;%s&quot;, &quot;Hello world\\n&quot;);              // &quot;Hello world&quot; on stdout (using printf)\nfprintf(stdout, &quot;%s&quot;, &quot;Hello world\\n&quot;);     // &quot;Hello world&quot; on stdout (using fprintf)\nfprintf(stderr, &quot;%s&quot;, &quot;Stack overflow!\\n&quot;); // Error message on stderr (using fprintf)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": true, "score": 202, "last_activity_date": 1471452610, "creation_date": 1471452610, "answer_id": 39002243, "question_id": 39002052, "link": "https://stackoverflow.com/questions/39002052/how-i-can-print-to-stderr-in-c/39002243#39002243", "title": "How I can print to stderr in C?", "body": "<p>The syntax is almost the same as <code>printf</code>. With <code>printf</code> you give the string format and its contents ie:</p>\n\n<pre><code>printf(\"my %s has %d chars\\n\", \"string format\", 30);\n</code></pre>\n\n<p>With <code>fprintf</code> it is the same, except now you are also specifying the place to print to:</p>\n\n<pre><code>File *myFile;\n...\nfprintf( myFile, \"my %s has %d chars\\n\", \"string format\", 30);\n</code></pre>\n\n<p>Or in your case:</p>\n\n<pre><code>fprintf( stderr, \"my %s has %d chars\\n\", \"string format\", 30);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 6729845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25902a32485c0e0c6126976546cbf096?s=128&d=identicon&r=PG", "display_name": "hasectic saif", "link": "https://stackoverflow.com/users/6729845/hasectic-saif"}, "is_accepted": false, "score": 11, "last_activity_date": 1471511250, "creation_date": 1471511250, "answer_id": 39014121, "question_id": 39002052, "link": "https://stackoverflow.com/questions/39002052/how-i-can-print-to-stderr-in-c/39014121#39014121", "title": "How I can print to stderr in C?", "body": "<pre><code>#include&lt;stdio.h&gt;\n\nint main ( ) {\n    printf( \"hello \" );\n    fprintf( stderr, \"HELP!\" );\n    printf( \" world\\n\" );\n    return 0;\n}\n\n$ ./a.exe\nHELP!hello  world\n$ ./a.exe 2&gt; tmp1\nhello  world\n$ ./a.exe 1&gt; tmp1\nHELP!$\n</code></pre>\n\n<ol>\n<li><p>stderr is usually unbuffered and stdout usually is. This can lead to odd looking output like this, which suggests code is executing in the wrong order. It isn't, it's just that the stdout buffer has yet to be flushed.\nRedirected or piped streams would of course not see this interleave as they would normally only see the output of stdout only or stderr only.</p></li>\n<li><p>Although initially both stdout and stderr come to the console, both are separate and can be individually redirected.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1556613814, "post_id": 42546105, "comment_id": 98488392, "body": "This doesn&#39;t add anything to the previous answers and doesn&#39;t really answer the question."}, {"owner": {"reputation": 121, "user_id": 2476535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a868d8baa8a0827a42c3741e0145da22?s=128&d=identicon&r=PG", "display_name": "BlueChip", "link": "https://stackoverflow.com/users/2476535/bluechip"}, "edited": false, "score": 3, "creation_date": 1592068549, "post_id": 42546105, "comment_id": 110294699, "body": "That sprintf() statement causes memory corruption! ...I highly advise you read up on how pointers, arrays, and strings work."}], "tags": [], "owner": {"reputation": 64, "user_id": 5615328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mIzTu.png?s=128&g=1", "display_name": "winterli", "link": "https://stackoverflow.com/users/5615328/winterli"}, "is_accepted": false, "score": -4, "last_activity_date": 1488424112, "creation_date": 1488424112, "answer_id": 42546105, "question_id": 39002052, "link": "https://stackoverflow.com/questions/39002052/how-i-can-print-to-stderr-in-c/42546105#42546105", "title": "How I can print to stderr in C?", "body": "<p>To print your context ,you can write code like this :</p>\n\n<pre><code>FILE *fp;\nchar *of;\nsprintf(of,\"%s%s\",text1,text2);\nfp=fopen(of,'w');\nfprintf(fp,\"your print line\");\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2652, "user_id": 5445670, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrwS2.png?s=128&g=1", "display_name": "Solomon Ucko", "link": "https://stackoverflow.com/users/5445670/solomon-ucko"}, "edited": false, "score": 0, "creation_date": 1597519643, "post_id": 42763009, "comment_id": 112161565, "body": "You could also give it a separate name, perhaps <code>eprintf</code> or something. (:O This is actually GCC (3.2)&#39;s example of a variadic macro: <a href=\"https://gcc.gnu.org/onlinedocs/gcc-3.2/cpp/Variadic-Macros.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc-3.2/cpp/Variadic-Macros.html</a>)"}], "tags": [], "owner": {"reputation": 51, "user_id": 5090018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t1Ana.jpg?s=128&g=1", "display_name": "lxiange", "link": "https://stackoverflow.com/users/5090018/lxiange"}, "is_accepted": false, "score": 5, "last_activity_date": 1489406027, "creation_date": 1489406027, "answer_id": 42763009, "question_id": 39002052, "link": "https://stackoverflow.com/questions/39002052/how-i-can-print-to-stderr-in-c/42763009#42763009", "title": "How I can print to stderr in C?", "body": "<p>If you don't want to modify current codes and just for debug usage.</p>\n\n<p>Add this macro:</p>\n\n<pre><code>#define printf(args...) fprintf(stderr, ##args)\n//under GCC\n#define printf(args...) fprintf(stderr, __VA_ARGS__)\n//under MSVC\n</code></pre>\n\n<p>Change <code>stderr</code> to <code>stdout</code> if you want to roll back.</p>\n\n<p>It's helpful for debug, but it's not a good practice.</p>\n"}], "owner": {"reputation": 1781, "user_id": 6706176, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ee68c5e149f63ec9e31ad0c152a48656?s=128&d=identicon&r=PG&f=1", "display_name": "wad", "link": "https://stackoverflow.com/users/6706176/wad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273438, "favorite_count": 25, "accepted_answer_id": 39002243, "answer_count": 6, "score": 142, "last_activity_date": 1603805717, "creation_date": 1471452020, "last_edit_date": 1486987383, "question_id": 39002052, "link": "https://stackoverflow.com/questions/39002052/how-i-can-print-to-stderr-in-c", "title": "How I can print to stderr in C?", "body": "<p>In C, Printing to stdout is easy, with <code>printf</code> from <code>stdio.h</code>.</p>\n\n<p>However, how can print to stderr? We can use <code>fprintf</code> to achieve it apparently, but its syntax seems strange. Maybe we can use <code>printf</code> to print to stderr?</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 37, "user_id": 3887679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/016b4e4d5e5dc710aca2d49bd3df42c8?s=128&d=identicon&r=PG&f=1", "display_name": "Casz146", "link": "https://stackoverflow.com/users/3887679/casz146"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1471450903, "post_id": 39001621, "comment_id": 65355169, "body": "It worked, but why is the ampersand not necessary here? While in the other thread it was there?"}, {"owner": {"reputation": 37, "user_id": 3887679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/016b4e4d5e5dc710aca2d49bd3df42c8?s=128&d=identicon&r=PG&f=1", "display_name": "Casz146", "link": "https://stackoverflow.com/users/3887679/casz146"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1471451194, "post_id": 39001621, "comment_id": 65355335, "body": "I see, thank you for the quick answer!"}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 1, "last_activity_date": 1471454435, "creation_date": 1471454435, "answer_id": 39002776, "question_id": 39001621, "link": "https://stackoverflow.com/questions/39001621/reading-lines-from-csv-file-and-separating-into-values-sscanf-sigsegv/39002776#39002776", "title": "Reading lines from CSV file and separating into values (sscanf SIGSEGV)", "body": "<p>The arguments to your <code>sscanf</code> are incorrect, its should be:</p>\n\n<pre><code>sscanf(str[i], \"%19[^,], %f\", names[i], &amp;grades[i]);\n</code></pre>\n\n<p><code>names[i]</code> is a <code>char</code> array, so you should not pass its address, but the address of its first element, which is either <code>&amp;names[i][0]</code> or simply <code>names[i]</code>.</p>\n\n<p>Conversely, <code>grades[i]</code> is a <code>float</code>.  You must pass its address as <code>&amp;grades[i]</code> or possibly <code>grades + i</code>, but it is less readable.</p>\n\n<p>And you should check the return value to verify in the input string was correctly converted.</p>\n\n<p>Also remove the extra <code>;</code> at the end of the <code>for</code> block.</p>\n"}], "owner": {"reputation": 37, "user_id": 3887679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/016b4e4d5e5dc710aca2d49bd3df42c8?s=128&d=identicon&r=PG&f=1", "display_name": "Casz146", "link": "https://stackoverflow.com/users/3887679/casz146"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "accepted_answer_id": 39002776, "answer_count": 1, "score": 1, "last_activity_date": 1471454515, "creation_date": 1471450507, "last_edit_date": 1495540847, "question_id": 39001621, "link": "https://stackoverflow.com/questions/39001621/reading-lines-from-csv-file-and-separating-into-values-sscanf-sigsegv", "title": "Reading lines from CSV file and separating into values (sscanf SIGSEGV)", "body": "<p>I have been working on a program that wants to read 10 lines from a csv file and separate the name and the grade. I have used the documentation provided here <a href=\"https://stackoverflow.com/questions/18737117/reading-values-from-csv-file-into-variables\">Reading values from CSV file into variables</a></p>\n\n<p>Unfortunately, my code throws a <code>SIGSEGV</code> when coming to the line with the <code>sscanf</code> statement. I have tried to remove the <code>,</code> between <code>%[^,]</code> and <code>%f</code>, after which it works but only gets the names, not the grades, which defeats the purpose.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    char str[10][30], names[10][20];\n    FILE *fp;\n    int i; \n    float grades[10];\n\n    fp = fopen(\"names.txt\", \"rt\");\n\n    for (i = 0; i &lt; 10; i++) {\n        fgets(str[i], 30, fp);\n        sscanf(str[i], \"%[^,], %f\", &amp;names[i], grades[i]);\n        printf(\"%s \", names[i]);\n        printf(\"%f \", grades[i]);\n    };\n}\n</code></pre>\n\n<p>This is the content of the csv file:</p>\n\n<pre><code>Bob,8\nCarla,7\nJack,5\nJulie,3\nGoncalo,9\nVera,6\nJesse,8\nJames,8\nFrancis,10\nMonica,6\n</code></pre>\n\n<p>Thank you for your help, if you need any other information please don't hesitate to ask.</p>\n"}, {"tags": ["c", "cmake", "clang", "qt-creator", "clang-static-analyzer"], "comments": [{"owner": {"reputation": 4792, "user_id": 588243, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7134a1b3bb60919edcbf78eab4e0992d?s=128&d=identicon&r=PG", "display_name": "Torbj&#246;rn", "link": "https://stackoverflow.com/users/588243/torbj%c3%b6rn"}, "edited": false, "score": 0, "creation_date": 1471500075, "post_id": 39001501, "comment_id": 65373239, "body": "How have you specified the CMake project? When you are only doing C, use <code>project(myProject LANGUAGES C)</code>. This will tell CMake not to consider a C++ compiler."}, {"owner": {"reputation": 622, "user_id": 707380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271b72ce6466881e270bdc55651ec9d2?s=128&d=identicon&r=PG", "display_name": "trafalgarx", "link": "https://stackoverflow.com/users/707380/trafalgarx"}, "reply_to_user": {"reputation": 4792, "user_id": 588243, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7134a1b3bb60919edcbf78eab4e0992d?s=128&d=identicon&r=PG", "display_name": "Torbj&#246;rn", "link": "https://stackoverflow.com/users/588243/torbj%c3%b6rn"}, "edited": false, "score": 0, "creation_date": 1471512624, "post_id": 39001501, "comment_id": 65379832, "body": "@Torbj&#246;rn Yes, I set lang in &quot;project&quot; command. Also note that for CMake ver. &lt; 3.0 need write <code>project(myProject C)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 82430, "user_id": 17833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExIEf.png?s=128&g=1", "display_name": "Petesh", "link": "https://stackoverflow.com/users/17833/petesh"}, "edited": false, "score": 1, "creation_date": 1471452670, "post_id": 39001620, "comment_id": 65356133, "body": "\u2026 although this is a less than desirable way of doing this - you should be using <a href=\"http://stackoverflow.com/questions/23995019/what-is-the-modern-method-for-setting-general-compile-flags-in-cmake\"><code>target_compile_options</code></a> although the semantics seem quite obtuse to me"}], "tags": [], "owner": {"reputation": 82430, "user_id": 17833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExIEf.png?s=128&g=1", "display_name": "Petesh", "link": "https://stackoverflow.com/users/17833/petesh"}, "is_accepted": false, "score": 3, "last_activity_date": 1471451465, "last_edit_date": 1471451465, "creation_date": 1471450496, "answer_id": 39001620, "question_id": 39001501, "link": "https://stackoverflow.com/questions/39001501/how-to-set-language-standard-std-for-clang-static-analyzer-in-qt-creator/39001620#39001620", "title": "How to set language standard (-std) for Clang static analyzer in Qt Creator", "body": "<p>The variable <code>CMAKE_C_FLAGS</code> is for <code>C</code> code, and not for <code>C++</code> code. You should be adding it to the <code>CMAKE_CXX_FLAGS</code> instead.</p>\n\n<pre><code>set(CMAKE_CXX_FLAGS \"-std=gnu++11 ${CMAKE_CXX_FLAGS}\")\n</code></pre>\n\n<p>and to retain <code>-std=gnu99</code> for C code, you would add:</p>\n\n<pre><code>set(CMAKE_C_FLAGS \"-std=gnu99 ${CMAKE_C_FLAGS}\") \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "edited": false, "score": 0, "creation_date": 1503567175, "post_id": 39010149, "comment_id": 78673700, "body": "How do I find this information from the manual? It seems CMake has millions of variables and I just have to guess it or look for them on SO."}, {"owner": {"reputation": 4792, "user_id": 588243, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7134a1b3bb60919edcbf78eab4e0992d?s=128&d=identicon&r=PG", "display_name": "Torbj&#246;rn", "link": "https://stackoverflow.com/users/588243/torbj%c3%b6rn"}, "reply_to_user": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "edited": false, "score": 0, "creation_date": 1503569913, "post_id": 39010149, "comment_id": 78675667, "body": "@nowox This is the entry page for the <a href=\"https://cmake.org/cmake/help/latest/manual/cmake-compile-features.7.html\" rel=\"nofollow noreferrer\">compile-features</a>. It&#39;s linked on the main page of the official CMake documentation, which has greatly improved in the recent years."}, {"owner": {"reputation": 82430, "user_id": 17833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExIEf.png?s=128&g=1", "display_name": "Petesh", "link": "https://stackoverflow.com/users/17833/petesh"}, "edited": false, "score": 0, "creation_date": 1583408945, "post_id": 39010149, "comment_id": 107110807, "body": "Bear in mind that that&#39;s for the <code>C</code> standard and not the <code>C++</code> standard, which is defined by the <code>CMAKE_CXX_STANDARD</code> variable. The problem the OP was having was in relation to setting the standard flags for the C compiler, instead of the C++ compiler."}], "tags": [], "owner": {"reputation": 4792, "user_id": 588243, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7134a1b3bb60919edcbf78eab4e0992d?s=128&d=identicon&r=PG", "display_name": "Torbj&#246;rn", "link": "https://stackoverflow.com/users/588243/torbj%c3%b6rn"}, "is_accepted": false, "score": 3, "last_activity_date": 1471500009, "last_edit_date": 1471500009, "creation_date": 1471495360, "answer_id": 39010149, "question_id": 39001501, "link": "https://stackoverflow.com/questions/39001501/how-to-set-language-standard-std-for-clang-static-analyzer-in-qt-creator/39010149#39010149", "title": "How to set language standard (-std) for Clang static analyzer in Qt Creator", "body": "<p>The classic approach has been given in the answer by @Petesh.</p>\n\n<p>If you just want to specify the exact C standard version the compiler should comply to, use the global variables <a href=\"https://cmake.org/cmake/help/v3.4/variable/CMAKE_C_STANDARD.html\" rel=\"nofollow\"><code>CMAKE_C_STANDARD</code></a> and <a href=\"https://cmake.org/cmake/help/v3.4/variable/CMAKE_C_STANDARD_REQUIRED.html\" rel=\"nofollow\"><code>CMAKE_C_STANDARD_REQUIRED</code></a>.</p>\n\n<p>In your case that would be</p>\n\n<pre><code>set(CMAKE_C_STANDARD 99)\nset(CMAKE_C_STANDARD_REQUIRED TRUE)\n</code></pre>\n\n<p>CMake will then figure out the exact command options for the detected compiler on its own and add them to all invocations of the compiler.</p>\n\n<p>To overwrite this global setting for a specific target, modify the corresponding target properties:</p>\n\n<pre><code>set_target_properties(myTarget\n                      PROPERTIES C_STANDARD 11\n                                 C_STANDARD_REQUIRED ON)\n</code></pre>\n\n<hr>\n\n<p>An in-depth description of the compile feature options is described in the official CMake documentation: <a href=\"https://cmake.org/cmake/help/v3.4/manual/cmake-compile-features.7.html\" rel=\"nofollow\">target compile features</a>. Via these <em>compile features</em> it's also possible to require that the detected compiler supports a specific set of language features independent of the language standard:</p>\n\n<pre><code>target_compile_features(myTarget\n                        PUBLIC c_variadic_macros  # ISO/IEC 9899:1999\n                        PRIVATE c_static_assert   # ISO/IEC 9899:2011\n)\n</code></pre>\n"}], "owner": {"reputation": 622, "user_id": 707380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/271b72ce6466881e270bdc55651ec9d2?s=128&d=identicon&r=PG", "display_name": "trafalgarx", "link": "https://stackoverflow.com/users/707380/trafalgarx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1776, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1471513477, "creation_date": 1471450116, "last_edit_date": 1471513477, "question_id": 39001501, "link": "https://stackoverflow.com/questions/39001501/how-to-set-language-standard-std-for-clang-static-analyzer-in-qt-creator", "title": "How to set language standard (-std) for Clang static analyzer in Qt Creator", "body": "<p>I write my project in C using QtCreator as IDE and CMake for build. QtCreator ver. >= 4.0.0 include Clang static analyzer, that I try to use.</p>\n\n<p>In my CMakeLists.txt set:</p>\n\n<p><code>set(CMAKE_C_FLAGS \"-std=gnu99 ${CMAKE_C_FLAGS}\")</code></p>\n\n<p>When I launch analysis in console get errors:</p>\n\n<p><code>error: invalid argument '-std=gnu++11' not allowed with 'C/ObjC'</code></p>\n\n<p>How to pass '-std=gnu99' to clang analyzer? Maybe it's hardcoded in QtCreator plugin sources?</p>\n\n<p><strong>UDP1</strong>: Seems like it's the QtCreator bug: <a href=\"https://bugreports.qt.io/browse/QTCREATORBUG-16290\" rel=\"nofollow\">https://bugreports.qt.io/browse/QTCREATORBUG-16290</a></p>\n"}, {"tags": ["c", "embedded", "pwm", "lpc", "nxp-microcontroller"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471449429, "post_id": 39001286, "comment_id": 65354267, "body": "How does one &quot;control PWM <b>input</b>&quot;?"}, {"owner": {"reputation": 705, "user_id": 5116789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/u5Zc7.jpg?s=128&g=1", "display_name": "LaneL", "link": "https://stackoverflow.com/users/5116789/lanel"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471449489, "post_id": 39001286, "comment_id": 65354303, "body": "@Olaf Thank you. Question has been edited."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1471501322, "post_id": 39002553, "comment_id": 65373694, "body": "Pausing the timer sounds wrong. Shouldn&#39;t you rather wait with clearing the interrupt source until all work is done?"}, {"owner": {"reputation": 705, "user_id": 5116789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/u5Zc7.jpg?s=128&g=1", "display_name": "LaneL", "link": "https://stackoverflow.com/users/5116789/lanel"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1471529559, "post_id": 39002553, "comment_id": 65391369, "body": "@Lundin I had that concern as well, but for high frequencies, the timer will get ahead of the match register and it will never interrupt on the next rising/falling edge. I tried clearing the interrupt at the end of the ISR as well but it didn&#39;t seem to make any difference."}], "tags": [], "owner": {"reputation": 705, "user_id": 5116789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/u5Zc7.jpg?s=128&g=1", "display_name": "LaneL", "link": "https://stackoverflow.com/users/5116789/lanel"}, "is_accepted": true, "score": 0, "last_activity_date": 1471453680, "creation_date": 1471453680, "answer_id": 39002553, "question_id": 39001286, "link": "https://stackoverflow.com/questions/39001286/how-to-setup-pwm-output-on-an-lpc11cxx-series-microcontroller-without-any-timer/39002553#39002553", "title": "How to setup PWM output on an LPC11CXX series microcontroller without any timer resets", "body": "<p>I figured it out. There were 2 things going wrong here.</p>\n\n<p>The I/O configuration was incorrect. After reading the documentation, I found out that the function needs to be set to 1 for GPIO. 0 is a reserved function.</p>\n\n<pre><code> IOCON_R_PIO1_1_bit.FUNC = 1;\n</code></pre>\n\n<p>The second thing going wrong here was that I needed to pause the timer to process the ISR.</p>\n\n<pre><code>/* If interrupt was from MR0 */\nif(LPC_TMR32B1-&gt;IR &amp; (1&lt;&lt;0))\n{\n    /* Pause timer */\n    LPC_TMR32B1-&gt;TCR = 0; \n\n    /* Clear interrupt */\n    LPC_TMR32B1-&gt;IR = (1&lt;&lt;0);\n\n    if(GPIO1DATA_bit.P1_1 == 1)\n    {\n       LPC_TMR32B1-&gt;MR0 = LPC_TMR32B1-&gt;TC + OutputChan0MatchPeriodFalling;\n       GPIO1DATA_bit.P1_1 = 0;\n    }\n    else if(GPIO1DATA_bit.P1_1 == 0)\n    {\n       LPC_TMR32B1-&gt;MR0 = LPC_TMR32B1-&gt;TC + OutputChan0MatchPeriodRising;\n       GPIO1DATA_bit.P1_1 = 1;\n    } \n\n    /* Restart timer */\n    LPC_TMR32B1-&gt;TCR = 1; \n}\n</code></pre>\n"}], "owner": {"reputation": 705, "user_id": 5116789, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/u5Zc7.jpg?s=128&g=1", "display_name": "LaneL", "link": "https://stackoverflow.com/users/5116789/lanel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 39002553, "answer_count": 1, "score": 0, "last_activity_date": 1471453680, "creation_date": 1471449376, "last_edit_date": 1471449439, "question_id": 39001286, "link": "https://stackoverflow.com/questions/39001286/how-to-setup-pwm-output-on-an-lpc11cxx-series-microcontroller-without-any-timer", "title": "How to setup PWM output on an LPC11CXX series microcontroller without any timer resets", "body": "<p>Background: I have this LPC11C24 microcontroller that I'm working on that uses a single 32 bit timer to read PWM input on one pin and control PWM outputs on 2 other pins. Being that input and output are on the same timer, I do not do any resets of the timer register (TC). For output in particular, I'm trying to set it up so that the match register will continuously increment with either the time when the signal should be HIGH or a signal is LOW respectfully.</p>\n\n<p>Example: If I have a period of 10000 ticks and my duty cycle is 50%, every time I get an interrupt, I want to add 5000 to MR0 to prepare for the next interrupt.</p>\n\n<p>Initialization:</p>\n\n<pre><code>IOCON_R_PIO1_1_bit.FUNC = 0;\nIOCON_R_PIO1_1_bit.MODE = 0;  \nGPIO1DIR_bit.P1_1 = 1;\n\nLPC_TMR32B1-&gt;MCR |= (1&lt;&lt;0); /* Interrupt when MR0 matches TC */\nLPC_TMR32B1-&gt;MR0 = 0; /* zero the match value */\n</code></pre>\n\n<p>ISR:</p>\n\n<pre><code>/* If interrupt was from MR0 */\nif(LPC_TMR32B1-&gt;IR &amp; (1&lt;&lt;0))\n{\n    /* Clear the interrrupt */\n    LPC_TMR32B1-&gt;IR = (1&lt;&lt;0);\n\n    if(GPIO1DATA_bit.P1_1 == 1)\n    {\n       LPC_TMR32B1-&gt;MR0 = LPC_TMR32B1-&gt;TC;\n       LPC_TMR32B1-&gt;MR0 += OutputChan0MatchPeriodFalling;\n       GPIO1DATA_bit.P1_1 = 0;\n    }\n    else if(GPIO1DATA_bit.P1_1 == 0)\n    {\n       LPC_TMR32B1-&gt;MR0 = LPC_TMR32B1-&gt;TC;\n       LPC_TMR32B1-&gt;MR0 += OutputChan0MatchPeriodRising;\n       GPIO1DATA_bit.P1_1 = 1;\n    } \n}\n</code></pre>\n\n<p>When I probe this pin I get no output whatsoever, so I'm not sure what I'm doing wrong. Another problem I'm having is that I am not getting interrupts except for when I provide a new duty cycle from some external code (which basically just sets MR0 = TC). I think it's because TC is getting ahead of MR0 but I'm not sure how to prevent that. Thank you so much! Please let me know if I can provide any additional information.</p>\n"}, {"tags": ["c", "arrays", "multidimensional-array"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 4, "creation_date": 1471449430, "post_id": 39001264, "comment_id": 65354268, "body": "This is not initialization. Initialization would be <code>int A[2][2] = {{1,2}};</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471449573, "post_id": 39001264, "comment_id": 65354345, "body": "You cannot <b>assign</b> an array to an array. And there is no partial <i>initialisation</i> in C."}, {"owner": {"reputation": 3, "user_id": 6727173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/049330a3744d9225ac91ad5377a63ee2?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6727173/bob"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1471449734, "post_id": 39001264, "comment_id": 65354440, "body": "@EOF Isn&#39;t it though? Without assignment the array has garbage values so that would lead me to believe the first assignment no matter where is the array&#39;s initialization."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1471449920, "post_id": 39001264, "comment_id": 65354547, "body": "@Bob C11 draft standard n1570: <i>6.7 Declarations 6.7.9 Initialization</i> Initialization is part of declaration. You&#39;re trying to <i>assign</i> something."}, {"owner": {"reputation": 3, "user_id": 6727173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/049330a3744d9225ac91ad5377a63ee2?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6727173/bob"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1471450171, "post_id": 39001264, "comment_id": 65354717, "body": "@EOF Alright, thanks for the clarification."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471452663, "post_id": 39001264, "comment_id": 65356132, "body": "Questions about 2D arrays are easier to discuss and answers are more clear when the size of the dimensions differ.  IOWs, use <code>int A[3][2];</code>"}], "answers": [{"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": true, "score": 2, "last_activity_date": 1471449465, "creation_date": 1471449465, "answer_id": 39001307, "question_id": 39001264, "link": "https://stackoverflow.com/questions/39001264/initializing-part-of-a-multidimensional-array-with-a-list-of-constants-in-c/39001307#39001307", "title": "Initializing part of a multidimensional array with a list of constants in C", "body": "<p>Initializers do not work like that. You should initialize it at the time of declaration as  </p>\n\n<pre><code>int A[2][2] = { {1, 2} };        // Rest elements will be initialized to 0\n</code></pre>\n\n<p>or using designated initializer</p>\n\n<pre><code>int A[2][2] = { [0] = {1, 2} };  // C99 and later\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1471449710, "last_edit_date": 1471449710, "creation_date": 1471449485, "answer_id": 39001316, "question_id": 39001264, "link": "https://stackoverflow.com/questions/39001264/initializing-part-of-a-multidimensional-array-with-a-list-of-constants-in-c/39001316#39001316", "title": "Initializing part of a multidimensional array with a list of constants in C", "body": "<p>What you're doing is not <em>initializing</em> (which is done <em>only</em> when the variable is declared) but <em>assigning</em>.  An array is a non-modifiable lvalue, which means it has an address but can't be assigned to.</p>\n\n<p>You can explicitly set just the first element as follows:</p>\n\n<pre><code>int A[2][2] = {{1, 2}};\n</code></pre>\n\n<p>When initializing an array or struct, any unspecified values in an initializer are set to 0.</p>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1471449507, "creation_date": 1471449507, "answer_id": 39001322, "question_id": 39001264, "link": "https://stackoverflow.com/questions/39001264/initializing-part-of-a-multidimensional-array-with-a-list-of-constants-in-c/39001322#39001322", "title": "Initializing part of a multidimensional array with a list of constants in C", "body": "<p>You aren't initializing; you're trying to assign, and you can't do array assignment in C.</p>\n\n<p>To be initialization, it would be part of the variable definition:</p>\n\n<pre><code>int A[2][2] = { { 1, 2 } };\n</code></pre>\n\n<p>This initializes the first row of the matrix explicitly leaving the rest as zeros.</p>\n"}], "owner": {"reputation": 3, "user_id": 6727173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/049330a3744d9225ac91ad5377a63ee2?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6727173/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 39001307, "answer_count": 3, "score": -2, "last_activity_date": 1471449710, "creation_date": 1471449321, "last_edit_date": 1471449686, "question_id": 39001264, "link": "https://stackoverflow.com/questions/39001264/initializing-part-of-a-multidimensional-array-with-a-list-of-constants-in-c", "title": "Initializing part of a multidimensional array with a list of constants in C", "body": "<p>Say I have an array</p>\n\n<pre><code>int A[2][2];\n</code></pre>\n\n<p>and I want to initialize only the first row with a list of constants like so</p>\n\n<pre><code>A[0] = {\n    1,\n    2\n};\n</code></pre>\n\n<p><strong>Unfortunately the compiler returns.</strong></p>\n\n<p><strong>error:</strong> </p>\n\n<pre><code>expected expression before '{' token_.\n</code></pre>\n\n<p>Although this example is small, think big. I know there are some obtuse ways of doing it but it would shock me if there wasn't an efficient solution.</p>\n"}, {"tags": ["c", "windows"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471449310, "post_id": 39001213, "comment_id": 65354191, "body": "Dumping a wall of code without further explanation and expecting us to - what? This is no personal tutoring/debugging service. How about using the debugger and find out yourself?"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1471494934, "post_id": 39001213, "comment_id": 65371761, "body": "What do you want to learn about <code>gotoxy</code>? It&#39;s function which you defined yourself, it calls <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms686025(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>SetConsoleCursorPosition</code></a>"}], "owner": {"reputation": 87, "user_id": 6713937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1286715981363030/picture?type=large", "display_name": "Alif Khair", "link": "https://stackoverflow.com/users/6713937/alif-khair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 697, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1471449187, "creation_date": 1471449187, "question_id": 39001213, "link": "https://stackoverflow.com/questions/39001213/c-program-gotoxy-on-second-screen", "title": "C Program GOTOXY on second screen", "body": "<p>The first screen, gotoxy code is working. But in second screen. Nothing happens, like, it does not read the gotoxy code at all. Please enlighten me about the problem. </p>\n\n<p>Here is the 1st screen : </p>\n\n<p><a href=\"https://i.stack.imgur.com/K6Et4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K6Et4.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the 2nd screen : </p>\n\n<p><a href=\"https://i.stack.imgur.com/P3Iba.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P3Iba.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the code. I would love to learn more about gotoxy. \nThank you in advance. </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>#include &lt;stdio.h&gt;\r\n#include &lt;stdlib.h&gt;\r\n#include &lt;windows.h&gt;\r\n#include &lt;ctype.h&gt;\r\n\r\nvoid gotoxy( int column, int line );\r\nint main();\r\nint addProduct();\r\n\r\nstruct product\r\n{\r\n    int quantity, reorder, i, id;\r\n    char name[20];\r\n    float price;\r\n};\r\n\r\nCOORD coord = {0, 0};\r\n\r\nvoid gotoxy (int x, int y)\r\n{\r\ncoord.X = x; coord.Y = y;\r\n\r\nSetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE), coord);\r\n}\r\n\r\nint main()\r\n{\r\nint choice;\r\n\r\n        gotoxy(17,5);\r\n        printf(\"\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2 SYZ INVENTORY PROGRAM \\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\");\r\n\r\n        gotoxy(17,18);\r\n        printf(\"\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\");\r\n\r\n    gotoxy(22,8);\r\n    printf(\"1. Add Product\\n\\n\");\r\n\r\n    gotoxy(22,10);\r\n    printf(\"2. Display Product\\n\\n\");\r\n\r\n    gotoxy(22,12);\r\n    printf(\"3. Search Product\\n\\n\");\r\n\r\n    gotoxy(22,14);\r\n    printf(\"4. Reorder Level of Product\\n\\n\");\r\n\r\n    gotoxy(22,16);\r\n    printf(\"5. Update Product\\n\\n\");\r\n\r\n    gotoxy(22,20);\r\n    printf(\"Please Enter Your Choice : \");\r\n    scanf(\" %d\", &amp;choice);\r\n\r\n        switch(choice)\r\n            {\r\n            case 1 :    addProduct();\r\n                        break;\r\n\r\n            case 2 :    displayProduct();\r\n                        break;\r\n\r\n            case 3 :    searchProduct();\r\n                        break;\r\n\r\n            case 4 :    reorderProduct();\r\n                        break;\r\n\r\n            case 5 :    updateProduct();\r\n                        break;\r\n\r\n            default :   printf(\"Wrong input. Please try again.\");\r\n                        system(\"cls\");\r\n                        main();\r\n\r\n            }\r\nreturn (0);\r\n}\r\n\r\n\r\n\r\n\r\nint addProduct()\r\n{\r\n    FILE * fp;\r\n\r\n    int i=0;\r\n    struct product a;\r\n    system(\"cls\");\r\n\r\n    char checker;\r\n\r\n    gotoxy(17,5);\r\n        printf(\"\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2 SYZ INVENTORY PROGRAM \\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\");\r\n\r\n        gotoxy(17,18);\r\n        printf(\"\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\\xB2\");\r\n\r\n\r\n\r\n        do\r\n        {\r\n\r\n\r\n        fp = fopen(\"inventory.txt\",\"a+t\");\r\n        system(\"cls\");\r\n\r\n        printf(\"Enter product ID : \");\r\n        scanf(\" %d\", &amp;a.id);\r\n\r\n        printf(\"Enter product name : \");\r\n        scanf(\" %s\", a.name);\r\n\r\n        printf(\"Enter product quantity : \");\r\n        scanf(\" %d\", &amp;a.quantity);\r\n\r\n        printf(\"Enter product price : \");\r\n        scanf(\" %f\", &amp;a.price);\r\n\r\n        fprintf(fp, \"%d %s %d %f\\n\\n\", a.id, a.name, a.quantity, a.price);\r\n        printf(\"Record saved!\\n\\n\");\r\n\r\n        fclose(fp);\r\n\r\n        printf(\"Do you want to enter new product? Y / N : \");\r\n\r\n        scanf(\" %c\", &amp;checker);\r\n        checker = toupper(checker);\r\n\r\n        i++;\r\n\r\n        system(\"cls\");\r\n        }\r\n        while(checker=='Y');\r\n\r\n\r\n        if(checker == 'N')\r\n            {\r\n             main();\r\n            }\r\n\r\n        else\r\n            {\r\n            do{\r\n            printf(\"Do you want to enter new product? Y / N : \");\r\n            scanf(\" %c\", &amp;checker);\r\n            checker = toupper(checker);\r\n                }while(checker != 'Y' &amp;&amp; checker != 'N');\r\n\r\n           if(checker == 'Y'){addProduct();}\r\n\r\n           if(checker == 'N'){\r\n                                system(\"cls\");\r\n                                main();}\r\n\r\n            }\r\n\r\nreturn(0);\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["c", "object", "lvalue"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471449237, "post_id": 39001202, "comment_id": 65354144, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/11105284/c-how-to-identify-rvalue-and-lvalue\">C How to identify rvalue and lvalue?</a>"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1471449283, "post_id": 39001202, "comment_id": 65354172, "body": "C11 draft standard n1570, <i>6.3 Conversions 6.3.2.1 Lvalues, arrays, and function designators 3 Except when it is the operand of the sizeof operator, the _Alignof operator, or the unary &amp; operator, or is a string literal used to initialize an array, an expression that has type \u2018\u2018array of type\u2019\u2019 is converted to an expression with type \u2018\u2018pointer to type\u2019\u2019 that points to the initial element of the array object and is not an lvalue. If the array object has register storage class, the behavior is undefined.</i>"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1471450343, "post_id": 39001202, "comment_id": 65354822, "body": "It depends on the context. Please provide that context."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471451135, "post_id": 39001202, "comment_id": 65355296, "body": "@chux: I fixed the typo."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1471451273, "post_id": 39001202, "comment_id": 65355376, "body": "<code>ranks+3</code> is definitely not an lvalue. <code>ranks</code> is an lvalue in the context of <code>sizeof ranks</code> or <code>&amp;ranks</code> (in those cases it refers to the entire array object, not to the address of its initial element). It is not an lvalue in other contexts."}, {"owner": {"reputation": 1692, "user_id": 6588224, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fa171624f6e8b69a48e9f0b71a5dcd1a?s=128&d=identicon&r=PG&f=1", "display_name": "Jin", "link": "https://stackoverflow.com/users/6588224/jin"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1471452754, "post_id": 39001202, "comment_id": 65356170, "body": "@KeithThompson So pointers cannot be lvalues except for special cases? But doesn&#39;t address of memory refer to object just like identifiers refer to objects? So I still think that pointers can be called lvalues!"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1471453938, "post_id": 39001202, "comment_id": 65356806, "body": "@Jin: a pointer <i>value</i> cannot be an lvalue; you must dereference that pointer <i>value</i> with either the unary <code>*</code> or subscript <code>[]</code> operators to manipulate the contents of that memory address."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1471457468, "post_id": 39001202, "comment_id": 65358731, "body": "@Jin: An lvalue is a kind of expression, not a kind of value, defined by the C11 standard as &quot;an expression (with an object type other than void) that potentially designates an object&quot;. An expression of pointer type can certainly be an lvalue if it designates an object of pointer type. I recommend using the word &quot;pointer&quot; as an adjective, not as a noun. We can have pointer values, pointer objects, pointer types, pointer expressions, and so forth. The phrase &quot;a pointer&quot; can be ambiguous."}, {"owner": {"reputation": 1692, "user_id": 6588224, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fa171624f6e8b69a48e9f0b71a5dcd1a?s=128&d=identicon&r=PG&f=1", "display_name": "Jin", "link": "https://stackoverflow.com/users/6588224/jin"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1471480071, "post_id": 39001202, "comment_id": 65368067, "body": "@JohnBode @KeithThompson : Isn&#39;t <code>ranks</code> a pointer type expression, not a kind of value?"}], "answers": [{"comments": [{"owner": {"reputation": 1692, "user_id": 6588224, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fa171624f6e8b69a48e9f0b71a5dcd1a?s=128&d=identicon&r=PG&f=1", "display_name": "Jin", "link": "https://stackoverflow.com/users/6588224/jin"}, "edited": false, "score": 0, "creation_date": 1471453586, "post_id": 39002444, "comment_id": 65356633, "body": "If I add a statement &#39;int x = 5&#39; and &#39;ranks = &amp;x&#39;, can&#39;t we say that &#39;ranks&#39; refer to object?"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "reply_to_user": {"reputation": 1692, "user_id": 6588224, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fa171624f6e8b69a48e9f0b71a5dcd1a?s=128&d=identicon&r=PG&f=1", "display_name": "Jin", "link": "https://stackoverflow.com/users/6588224/jin"}, "edited": false, "score": 0, "creation_date": 1471453715, "post_id": 39002444, "comment_id": 65356699, "body": "@Jin If <code>ranks</code> is <code>int ranks[10]</code>, <code>ranks=&amp;x</code> won&#39;t compile.  It would compile for <code>int *ranks;</code>.  This is one of the situations in which arrays and pointers are not perfectly interchangeable."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 1692, "user_id": 6588224, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fa171624f6e8b69a48e9f0b71a5dcd1a?s=128&d=identicon&r=PG&f=1", "display_name": "Jin", "link": "https://stackoverflow.com/users/6588224/jin"}, "edited": false, "score": 0, "creation_date": 1471453729, "post_id": 39002444, "comment_id": 65356708, "body": "@Jin: you can&#39;t assign to <code>ranks</code>; array expressions cannot be the target of an assignment operator."}], "tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": false, "score": 2, "last_activity_date": 1471453639, "last_edit_date": 1471453639, "creation_date": 1471453315, "answer_id": 39002444, "question_id": 39001202, "link": "https://stackoverflow.com/questions/39001202/are-these-pointer-lvalues/39002444#39002444", "title": "Are these pointer lvalues?", "body": "<p>In this context, the names aren't lvalues, but they can be dereferenced with <code>*</code> to form lvalues.  For example:</p>\n\n<pre><code>int ranks[10];\n// ranks = 42; &lt;--- doesn't compile!   error: assignment to expression with array type\n*ranks = 42;   // OK: same as ranks[0] = 42\n//ranks+3 = 42; &lt;--- error: lvalue required as left operand of assignment\n*(ranks+3) = 42; //OK: same as ranks[3] = 42\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/17753057/2877364\">This answer</a> lists the few cases in C when the name of an array <em>doesn't</em> decay to a pointer to the array's first element.  On the left-hand side of an assignment isn't one of those cases.  Therefore, in <code>ranks = ...</code>, <code>ranks</code> is (decays to, acts as) a pointer to the first element of the array.  You have to dereference that pointer (<code>*ranks</code>) to get one of the array elements as an lvalue.</p>\n\n<p>Just don't ask me what an lvalue is.  I know it when I see it. :)</p>\n\n<p>Tested on gcc.</p>\n"}, {"comments": [{"owner": {"reputation": 1692, "user_id": 6588224, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fa171624f6e8b69a48e9f0b71a5dcd1a?s=128&d=identicon&r=PG&f=1", "display_name": "Jin", "link": "https://stackoverflow.com/users/6588224/jin"}, "edited": false, "score": 0, "creation_date": 1471479387, "post_id": 39002556, "comment_id": 65367890, "body": "If I add <code>int x = 10&#39; and </code>x=0&#39; to my code and apply your logic, since x is an int expression then <code>x=0</code>would be equivalent to `10=0&#39;..?"}, {"owner": {"reputation": 1692, "user_id": 6588224, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fa171624f6e8b69a48e9f0b71a5dcd1a?s=128&d=identicon&r=PG&f=1", "display_name": "Jin", "link": "https://stackoverflow.com/users/6588224/jin"}, "edited": false, "score": 0, "creation_date": 1471484852, "post_id": 39002556, "comment_id": 65369205, "body": "Why doesn&#39;t your logic apply to int expression? I think the difference originates from fact that the compiler simply evaluates <code>ranks</code> as <code>0xdeadbeef</code> while the compiler doesn&#39;t evaluate <code>x</code> as <code>10</code>?"}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 3, "last_activity_date": 1471453689, "creation_date": 1471453689, "answer_id": 39002556, "question_id": 39001202, "link": "https://stackoverflow.com/questions/39001202/are-these-pointer-lvalues/39002556#39002556", "title": "Are these pointer lvalues?", "body": "<p><code>ranks+3</code> is not an lvalue for the same reason that <code>1+3</code> is not an lvalue; the result is simply a numerical (pointer) <em>value</em>, not a reference to an object.  </p>\n\n<p>Put another way, if the result of <code>ranks + 3</code> is <code>0xdeadbeef</code>, you cannot write</p>\n\n<pre><code>0xdeadbeef = 10;\n</code></pre>\n\n<p>for the same reason you cannot write</p>\n\n<pre><code>4 = 10;\n</code></pre>\n\n<p>However, <code>*(ranks+3)</code> <em>is</em> an lvalue, because you are <em>dereferencing</em> that pointer value; it is the 4<sup>th</sup> element of the <code>ranks</code> array, and is equivalent to <code>ranks[3]</code>.  </p>\n\n<p>Similarly, <code>ranks</code> is not an lvalue except in the context of <code>sizeof</code> or the unary <code>&amp;</code> operator.  Since array expressions \"decay\" to pointer expressions in most contexts, you again wind up with the situation of</p>\n\n<pre><code>ranks = 10;\n</code></pre>\n\n<p>being equivalent to</p>\n\n<pre><code>0xdeadbeef = 10;  \n</code></pre>\n\n<p>Again, you'd have to <em>dereference</em> <code>ranks</code> as either <code>*ranks</code> or <code>ranks[0]</code> for it to be an lvalue.  </p>\n"}], "owner": {"reputation": 1692, "user_id": 6588224, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fa171624f6e8b69a48e9f0b71a5dcd1a?s=128&d=identicon&r=PG&f=1", "display_name": "Jin", "link": "https://stackoverflow.com/users/6588224/jin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1471453689, "creation_date": 1471449154, "last_edit_date": 1471451125, "question_id": 39001202, "link": "https://stackoverflow.com/questions/39001202/are-these-pointer-lvalues", "title": "Are these pointer lvalues?", "body": "<p>According to \"<a href=\"http://careferencemanual.com/\" rel=\"nofollow\">C - A Reference Manual</a>\", an lvalue is an expression that refers to an object in such a way that the object may be examined or altered.</p>\n\n<p>For example, </p>\n\n<pre><code>int ranks[10];\n</code></pre>\n\n<p>Then are <code>ranks</code> and <code>ranks+3</code> lvalues? Since <code>ranks</code>(pointer to first element of array) and <code>ranks+3</code>(pointer to fourth element of array) refer to objects, I guess they are lvalues -- or are they not lvalues?</p>\n"}, {"tags": ["c", "kernighan-and-ritchie"], "comments": [{"owner": {"reputation": 410, "user_id": 5508526, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e6bb216636658818024e5992fc6056a5?s=128&d=identicon&r=PG", "display_name": "P. Str", "link": "https://stackoverflow.com/users/5508526/p-str"}, "edited": false, "score": 0, "creation_date": 1471450405, "post_id": 39001200, "comment_id": 65354855, "body": "Do you mean replace consecutive blacks with a single blank, right?"}, {"owner": {"reputation": 15, "user_id": 4880345, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/74b6a2cf6afc8e66ee0cfddb5e6e2cb5?s=128&d=identicon&r=PG&f=1", "display_name": "Thenoobienoob", "link": "https://stackoverflow.com/users/4880345/thenoobienoob"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471451281, "post_id": 39001200, "comment_id": 65355381, "body": "Yes. This seems not to be working @chux. I did something similar before, but this brings the blanks back to 0. When writing my name, my name is then without spaces"}, {"owner": {"reputation": 14460, "user_id": 1404311, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j4CQ5.jpg?s=128&g=1", "display_name": "Scott Mermelstein", "link": "https://stackoverflow.com/users/1404311/scott-mermelstein"}, "edited": false, "score": 2, "creation_date": 1471451830, "post_id": 39001200, "comment_id": 65355674, "body": "The answers given aren&#39;t bad, but they don&#39;t help you to understand what&#39;s wrong with your code.  If you&#39;re new to programming, learning to trace through your code is important.  So, some questions to help you find the bugs in <i>your</i> code, rather than replacing it with someone else&#39;s:  What will happen if your input is &#39;The...noobie.....noob&#39; [. = space]?  Go through the loop manually for each character.  Keep track of the value of blanks, and ask yourself when you should be doing the putchar, and when you&#39;re doing it now.  What will happen to the behavior when you get between words 2 and 3?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4880345, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/74b6a2cf6afc8e66ee0cfddb5e6e2cb5?s=128&d=identicon&r=PG&f=1", "display_name": "Thenoobienoob", "link": "https://stackoverflow.com/users/4880345/thenoobienoob"}, "edited": false, "score": 0, "creation_date": 1471451755, "post_id": 39001685, "comment_id": 65355624, "body": "Haven&#39;t had the isalpha function in the book yet. Just started and am on page 20. I tried to input the code though, but it does not seem to work unfortunately."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1471454499, "post_id": 39001685, "comment_id": 65357138, "body": "<code>isalpha</code> is not equal to <code>not(isspace)</code>, which makes me wonder why you introduced that function to noobienoob."}], "tags": [], "owner": {"reputation": 19, "user_id": 1638771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca93a67417467700fe1d30e96098d72c?s=128&d=identicon&r=PG", "display_name": "user1638771", "link": "https://stackoverflow.com/users/1638771/user1638771"}, "is_accepted": false, "score": 1, "last_activity_date": 1471450696, "creation_date": 1471450696, "answer_id": 39001685, "question_id": 39001200, "link": "https://stackoverflow.com/questions/39001200/how-do-i-replace-more-than-one-blank-in-c-programming-with-one-blank/39001685#39001685", "title": "How do I replace more than one blank in c programming with one blank?", "body": "<p>I guess you are trying to write a program that get something like this as input:</p>\n\n<pre><code>John        David       Doe\n</code></pre>\n\n<p>and display this as output:</p>\n\n<pre><code>John David Doe\n</code></pre>\n\n<p>by removing all extra spaces. This should work:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    int c; // getchar value\n    int blanks = 0; // counting the amount of blanks. If more than one then  replace with blanks_2\n\n    printf(\"Enter your name please\\n\");\n\n    while((c = getchar()) != EOF)\n    {\n        if(c == ' ')\n        {\n            // count blanks\n            ++blanks;\n\n            if (blanks==1)     \n                putchar(c); // display only the 1st blank\n        }\n\n        if(isalpha(c))\n        {\n            putchar(c);\n            blanks=0; // reset blanks counter as c is an alpha character\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 4880345, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/74b6a2cf6afc8e66ee0cfddb5e6e2cb5?s=128&d=identicon&r=PG&f=1", "display_name": "Thenoobienoob", "link": "https://stackoverflow.com/users/4880345/thenoobienoob"}, "edited": false, "score": 0, "creation_date": 1471460871, "post_id": 39001833, "comment_id": 65360592, "body": "okay thank you for your constructive feedback. It seems to work, i understand the first part of the loop, however could you explain me why it is necessary to add a blank everytime i visit a non -blank character?"}, {"owner": {"reputation": 410, "user_id": 5508526, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e6bb216636658818024e5992fc6056a5?s=128&d=identicon&r=PG", "display_name": "P. Str", "link": "https://stackoverflow.com/users/5508526/p-str"}, "reply_to_user": {"reputation": 15, "user_id": 4880345, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/74b6a2cf6afc8e66ee0cfddb5e6e2cb5?s=128&d=identicon&r=PG&f=1", "display_name": "Thenoobienoob", "link": "https://stackoverflow.com/users/4880345/thenoobienoob"}, "edited": false, "score": 0, "creation_date": 1471463891, "post_id": 39001833, "comment_id": 65362141, "body": "The information that blank character(s) is/are visited is hold in blankfound variable. When the current character is a non-blank character the blankfound variable is checked for its value. If it&#39;s 1, this means that prior to the current non-blank character at least one blank character exists. So, before printing the current character value you should print a blank character as the task requires. And of course ... you should also turn the blankfound back to 0 in order to identify possible future blank characters."}], "tags": [], "owner": {"reputation": 410, "user_id": 5508526, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e6bb216636658818024e5992fc6056a5?s=128&d=identicon&r=PG", "display_name": "P. Str", "link": "https://stackoverflow.com/users/5508526/p-str"}, "is_accepted": false, "score": 1, "last_activity_date": 1471451189, "creation_date": 1471451189, "answer_id": 39001833, "question_id": 39001200, "link": "https://stackoverflow.com/questions/39001200/how-do-i-replace-more-than-one-blank-in-c-programming-with-one-blank/39001833#39001833", "title": "How do I replace more than one blank in c programming with one blank?", "body": "<p>You do not need to count the exact number of blanks. Once you find a blank \"raise a flag\" that blank is found. When you revisit a non-blank character print a blank and turn the flag back to 0. Moreover, insert \"continue\" statements in your code to avoid unecessary checks:</p>\n\n<pre><code>int main(void)\n{\n   int c; // getchar value\n   int blankfound = 0;\n\n   printf(\"Enter your name please\\n\");\n\n   while((c = getchar()) != EOF){\n      if(c == ' '){\n         blankfound = 1;\n         continue;\n      }\n      if(c &gt;= 'a' &amp;&amp; c &lt;= 'z'){\n         if (blankfound == 1)\n         {\n             putchar(' ');\n             blankfound = 0;\n         }\n         putchar(c);\n         continue;\n      }\n      if (c &gt;= 'A' &amp;&amp; c &lt;= 'Z'){\n          if (blankfound == 1)\n          {\n             putchar(' ');\n             blankfound = 0;\n          }\n          putchar(c);\n          continue;\n      }\n\n }\n\nreturn 0;\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1471452181, "last_edit_date": 1471452181, "creation_date": 1471451832, "answer_id": 39002003, "question_id": 39001200, "link": "https://stackoverflow.com/questions/39001200/how-do-i-replace-more-than-one-blank-in-c-programming-with-one-blank/39002003#39002003", "title": "How do I replace more than one blank in c programming with one blank?", "body": "<p>Many of these learner code assignments work on the idea of function based on a <em>previous</em> character.</p>\n\n<p>Consider the following layout</p>\n\n<pre><code>int previous = something();\nwhile ((c =  getchar()) != EOF) {\n  do_stuff(previous, c);\n  previous = c;\n}\n</code></pre>\n\n<p>For OP, that would be: If the character is not a space or the previous character was not a space, print it.</p>\n\n<pre><code>printf(\"Enter your name please\\n\");\nint previous = 0;\nint c;\nwhile((c = getchar()) != EOF) {\n  if ((c != ' ') || (previous != ' ')) {\n    putchar(' ');\n  }\n  previous = c;\n}\n</code></pre>\n\n<p>Simplifying the algorithm helps one see flaws like below.  <code>blanks</code> is not reset when a letter appears. It prints when 1 or more spaces encountered.</p>\n\n<pre><code>if(c == ' '){\n    ++blanks;\n\n    if (blanks &gt;= 1){\n        putchar(blankos);   }\n    }\nif(c &gt;= 'a' &amp;&amp; c &lt;= 'z'){\n    putchar(c);\n}\nif (c &gt;= 'A' &amp;&amp; c &lt;= 'Z'){\n    putchar(c);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 14818012, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/101b22165535245bb912ffc9b1fa7504?s=128&d=identicon&r=PG", "display_name": "mouseegg", "link": "https://stackoverflow.com/users/14818012/mouseegg"}, "edited": false, "score": 0, "creation_date": 1607866976, "post_id": 65276238, "comment_id": 115401469, "body": "Used <code>gcc -ansi</code> for compile"}], "tags": [], "owner": {"reputation": 1, "user_id": 14818012, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/101b22165535245bb912ffc9b1fa7504?s=128&d=identicon&r=PG", "display_name": "mouseegg", "link": "https://stackoverflow.com/users/14818012/mouseegg"}, "is_accepted": false, "score": 0, "last_activity_date": 1607866495, "creation_date": 1607866495, "answer_id": 65276238, "question_id": 39001200, "link": "https://stackoverflow.com/questions/39001200/how-do-i-replace-more-than-one-blank-in-c-programming-with-one-blank/65276238#65276238", "title": "How do I replace more than one blank in c programming with one blank?", "body": "<p>Reference to previous chapters (Used only 'while' and 'if'), my code look like this.</p>\n<pre><code>#include &lt;stdio.h&gt;\n\nmain()\n{\n    int c;\n\n    while ((c = getchar()) != EOF) {\n        if (c == ' ') {\n            putchar(c);\n            while ((c = getchar()) == ' ')\n                ; \n        }\n        putchar(c);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4880345, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/74b6a2cf6afc8e66ee0cfddb5e6e2cb5?s=128&d=identicon&r=PG&f=1", "display_name": "Thenoobienoob", "link": "https://stackoverflow.com/users/4880345/thenoobienoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1607866495, "creation_date": 1471449147, "last_edit_date": 1471454307, "question_id": 39001200, "link": "https://stackoverflow.com/questions/39001200/how-do-i-replace-more-than-one-blank-in-c-programming-with-one-blank", "title": "How do I replace more than one blank in c programming with one blank?", "body": "<p>I am new to programming, and I have decided to start with c. I am using the book of K &amp; R, and there is this exercise, which asks to write a program that copies input to output , replacing one or more blanks with a single blank. However when I wrote my program (and I am sure it's not correct but that's okay, since I am here to learn) I was wondering what I am doing wrong. Also a note: when I type my name with 3 blanks it's reduced to two, but when using two or one blank(s) nothing happens. Code posted below</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint main(void)\n{\nint c; // getchar value\nint blanks = 0; // counting the amount of blanks. If more than one then  replace with blanks_2\nchar blanks_2 = ' '; //character value for replacement in case blanks is more than one\n\nprintf(\"Enter your name please\\n\");\n\nwhile((c = getchar()) != EOF){\nif(c == ' '){\n    ++blanks;\n\n    if (blanks &gt;= 1){\n        putchar(blankos);   }\n    }\nif(c &gt;= 'a' &amp;&amp; c &lt;= 'z'){\n    putchar(c);\n}\nif (c &gt;= 'A' &amp;&amp; c &lt;= 'Z'){\n    putchar(c);\n}\n\n}\n\nreturn 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "matlab", "matlab-coder"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471449838, "post_id": 39000799, "comment_id": 65354506, "body": "Curious, Why <code>L</code> in <code>length + 1L;</code> and all the casts in the C code?  Better to post definitions of <code>i18, length, copyfrom, i, source_str, buf</code> to see whats is going on.  As the post stands now,  I find it unclear."}, {"owner": {"reputation": 18, "user_id": 2369215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ff535018c07f291cf2e56fb392755a?s=128&d=identicon&r=PG", "display_name": "Petur Olsen", "link": "https://stackoverflow.com/users/2369215/petur-olsen"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471506593, "post_id": 39000799, "comment_id": 65376296, "body": "This is generated code from Matlab. So the L and the casts are Matlab&#39;s decision. I think the L is to avoid and check for integer overflow (I removed some checks in the code). The definitions aren&#39;t really important unless you want to start debugging why the for loop is not generated correctly. But the answer below works, so I will not spend more time on it."}], "answers": [{"comments": [{"owner": {"reputation": 18, "user_id": 2369215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ff535018c07f291cf2e56fb392755a?s=128&d=identicon&r=PG", "display_name": "Petur Olsen", "link": "https://stackoverflow.com/users/2369215/petur-olsen"}, "edited": false, "score": 0, "creation_date": 1471506682, "post_id": 39005830, "comment_id": 65376350, "body": "This worked, thanks! I can not figure out <code>len</code> before the call to <code>_cfun</code>, but it works like this, so that&#39;s perfect."}], "tags": [], "owner": {"reputation": 1814, "user_id": 3297440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b9a3c27ffed7a206aa03f34cde4bce?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Livingston", "link": "https://stackoverflow.com/users/3297440/ryan-livingston"}, "is_accepted": true, "score": 1, "last_activity_date": 1471466128, "creation_date": 1471466128, "answer_id": 39005830, "question_id": 39000799, "link": "https://stackoverflow.com/questions/39000799/converting-a-c-char-array-into-a-matlab-string-using-matlab-coder/39005830#39005830", "title": "Converting a C char array into a Matlab String using Matlab Coder", "body": "<p>It's a bit wasteful, but you could allocate a MATLAB <code>char</code> array and <code>memcpy</code> the data into it:</p>\n\n<pre class=\"lang-matlab prettyprint-override\"><code>mllen = cast(len,'int32'); % or int64\nmlbuf = blanks(mllen); % allocate character vector\ncoder.ceval('memcpy',coder.wref(mlbuf),buf,len);\nuse(mlbuf);\n</code></pre>\n\n<p>You may want a +1 or -1 on sizes based upon whether or not <code>len</code> counts a NULL terminator and if you want it.</p>\n\n<p>If you can somehow figure out <code>len</code> before the call to <code>_cfun</code> then you can just pass <code>mlbuf</code> to <code>_cfun</code> and forget the copy.</p>\n\n<p>The generated code is indexing with 0 and producing an infinite loop because as far as Coder is concerned, <code>buf</code> is a 1-by-1 <code>coder.opaque</code>. You would get an index out of bounds error if you generated a MEX file and ran it.</p>\n"}], "owner": {"reputation": 18, "user_id": 2369215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ff535018c07f291cf2e56fb392755a?s=128&d=identicon&r=PG", "display_name": "Petur Olsen", "link": "https://stackoverflow.com/users/2369215/petur-olsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 39005830, "answer_count": 1, "score": 0, "last_activity_date": 1471466128, "creation_date": 1471447921, "question_id": 39000799, "link": "https://stackoverflow.com/questions/39000799/converting-a-c-char-array-into-a-matlab-string-using-matlab-coder", "title": "Converting a C char array into a Matlab String using Matlab Coder", "body": "<p>I have some code written in Matlab that I am converting into C code using Matlab Coder. </p>\n\n<p>I have written a C function that I want to call from the generated C code. This works, so far so good.</p>\n\n<p>The problem is that one of the parameters to the C function is a char** used to output a string. </p>\n\n<p>I accomplish this by making an opaque char* and using coder.wref to get the char**. But how do I convert the opaque char* to a Matlab string so I can return it from my function?</p>\n\n<p>The code goes something like this:</p>\n\n<pre><code>function [status,out] = cfun()\n    buf = coder.opaque('char *', 'NULL');\n    len = coder.opaque('size_t ', 'NULL');\n    status = 0;\n    status = coder.ceval('_cfun', coder.wref(buf), coder.wref(len));\n\n    out = buf; % How do I convert buf into a Matlab string here??\nend\n</code></pre>\n\n<p>_cfun will write some data to buf and write the length into len.</p>\n\n<p>My current solution, which almost works, is to manually make a char array in Matlab and transfer to data. Like this:</p>\n\n<pre><code>length = cast(len, 'int32');\nout = char(zeros(1,length+1));\nfor i = 1:(length+1)\n    out(i) = cast(buf(i), 'int32');\nend\n</code></pre>\n\n<p>The C code generated from this makes no sense and loops infinitely, but I can manually update it to work. However this requires a manual update every time I rerun the code generation.</p>\n\n<p>The C code looks like this:</p>\n\n<pre><code>i18 = length + 1L;\ncopyfrom = (int)i18;\ni = 1;\nwhile (i &lt;= copyfrom) {\n    source_str-&gt;data[0] = (signed char)(int)buf;\n    i = 2;\n}\n</code></pre>\n\n<p>I can update it to work:</p>\n\n<pre><code>i18 = length + 1L;\ncopyfrom = (int)i18;\ni = 1;\nwhile (i &lt;= copyfrom) {\n    source_str-&gt;data[i-1] = (signed char)(int)(buf[i-1]);\n    i = i+1;\n}\n</code></pre>\n\n<p>So, is there a way to convert the char* + length into a Matlab string? Or is there a better way of doing what I am trying to?</p>\n"}, {"tags": ["c", "windows", "lua", "yaml", "luarocks"], "comments": [{"owner": {"reputation": 71156, "user_id": 1190388, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5391819cc4abe0cb43587c9ef1808dbd?s=128&d=identicon&r=PG", "display_name": "hjpotter92", "link": "https://stackoverflow.com/users/1190388/hjpotter92"}, "edited": false, "score": 0, "creation_date": 1471452703, "post_id": 39000722, "comment_id": 65356146, "body": "Probably because your LuaRocks was installed using mingw (usage of <code>mingw-gcc</code> in the traceback/logs), and the yaml installation is trying to use MS VCR library: <code>-lMSVCR80</code>"}, {"owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "reply_to_user": {"reputation": 71156, "user_id": 1190388, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5391819cc4abe0cb43587c9ef1808dbd?s=128&d=identicon&r=PG", "display_name": "hjpotter92", "link": "https://stackoverflow.com/users/1190388/hjpotter92"}, "edited": false, "score": 0, "creation_date": 1471452869, "post_id": 39000722, "comment_id": 65356238, "body": "@hjpotter92 That&#39;s a good point, I had not spotted that was  Microsoft file. What&#39;s that doing in there ;o  .. his other libs all worked with mingw32-gcc. Any idea how to resolve this? I have MSVC2010 on my PC. <b>edit</b> also his instuction in his git repo say to run <code>luarocks make</code> (once you clone the project) - this also yields the same errors"}, {"owner": {"reputation": 3821, "user_id": 3677376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345ca06e9690f13ec2cde085a7ef6e57?s=128&d=identicon&r=PG&f=1", "display_name": "siffiejoe", "link": "https://stackoverflow.com/users/3677376/siffiejoe"}, "edited": false, "score": 0, "creation_date": 1471455799, "post_id": 39000722, "comment_id": 65357833, "body": "@code_fodder: Try <code>luarocks install yaml-1.1.2-1.src.rock CC=&quot;mingw32-gcc -DYAML_DECLARE_STATIC&quot;</code>"}, {"owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "reply_to_user": {"reputation": 3821, "user_id": 3677376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345ca06e9690f13ec2cde085a7ef6e57?s=128&d=identicon&r=PG&f=1", "display_name": "siffiejoe", "link": "https://stackoverflow.com/users/3677376/siffiejoe"}, "edited": false, "score": 0, "creation_date": 1471503380, "post_id": 39000722, "comment_id": 65374643, "body": "@siffiejoe - hey that worked! ... but then when trying to use yaml I encountered further issues : ((  ... can you take a look at my update to see if you can spot anything? Also since that does answer original question you can post this as an answer, I will mark it up. (btw - how did you know to use DYAML_DECLARE_STATIC?)"}], "answers": [{"comments": [{"owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "edited": false, "score": 0, "creation_date": 1471518217, "post_id": 39015671, "comment_id": 65383424, "body": "awesome answer! - if I could upvote it more I would : )    I have not done all the steps yet, just about to do them, but it gives me great confidence that I know what is going on. Presumably I need to do the same for lub and luafilesystem (path-wise).  Also, yes I added the bug report yesterday, because in my mind it should run out of the box or there should be instructions what to do. But I did not have the in-depth knowledge or reasoning that you have. Maybe you can add this to the bug report (or I can)."}, {"owner": {"reputation": 3821, "user_id": 3677376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345ca06e9690f13ec2cde085a7ef6e57?s=128&d=identicon&r=PG&f=1", "display_name": "siffiejoe", "link": "https://stackoverflow.com/users/3677376/siffiejoe"}, "reply_to_user": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "edited": false, "score": 0, "creation_date": 1471520357, "post_id": 39015671, "comment_id": 65384772, "body": "@code_fodder: lub will need the same addition, yes, but you only have to do it once for both (the yaml-specific portion of the path template was a copy-paste-error on my part -- it&#39;s fixed now). luafilesystem doesn&#39;t have a pure Lua module, so it would be unnecessary there. I&#39;ve added the necessary information and a link to this question to your bug report."}, {"owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "edited": false, "score": 0, "creation_date": 1471521842, "post_id": 39015671, "comment_id": 65385764, "body": "haha, actually after a few goes, I think I came to the same path &quot;pattern&quot; conclusions that you did : )     I still have one bug after doing this update. I am going to add it as an update3 in my main post - just let me know if this needs to go in as a separate question... (ps thanks for updating the bug :)"}, {"owner": {"reputation": 3821, "user_id": 3677376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345ca06e9690f13ec2cde085a7ef6e57?s=128&d=identicon&r=PG&f=1", "display_name": "siffiejoe", "link": "https://stackoverflow.com/users/3677376/siffiejoe"}, "reply_to_user": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "edited": false, "score": 0, "creation_date": 1471526348, "post_id": 39015671, "comment_id": 65388960, "body": "My guess is that MSVC inlines the definition of <code>utime</code> (at least MSVC 10.0 does, which is the version I have installed), so it&#39;s not in the DLL. MinGW on the other hand does not inline, so it needs it in the DLL. Maybe the <code>msvcr80.dll</code> shipped with MinGW <i>does</i> include the function, and you can get away with putting that file in a prominent place, otherwise you probably have to use matching compilers/runtimes, I don&#39;t know. You should open a new question for that. And also try to contact the MinGW people (is there a <code>MinGW</code> tag on SO?!)."}, {"owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "edited": false, "score": 0, "creation_date": 1471555802, "post_id": 39015671, "comment_id": 65406366, "body": "Yeah, I am a bit stuck at this stage - I think you&#39;re right I&#39;ll start another post next week when I get back - thanks for your help : ))"}], "tags": [], "owner": {"reputation": 3821, "user_id": 3677376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345ca06e9690f13ec2cde085a7ef6e57?s=128&d=identicon&r=PG&f=1", "display_name": "siffiejoe", "link": "https://stackoverflow.com/users/3677376/siffiejoe"}, "is_accepted": true, "score": 3, "last_activity_date": 1471520133, "last_edit_date": 1471520133, "creation_date": 1471515629, "answer_id": 39015671, "question_id": 39000722, "link": "https://stackoverflow.com/questions/39000722/issues-installing-yaml-for-lua-with-luarocks-during-the-c-compile/39015671#39015671", "title": "Issues installing yaml for lua with luarocks during the c-compile", "body": "<p>The include file <a href=\"https://github.com/lubyk/yaml/blob/master/src/yaml.h\" rel=\"nofollow\"><code>src/yaml.h</code></a> from the <a href=\"https://github.com/lubyk/yaml\" rel=\"nofollow\">github repository</a> contains the following preprocessor code:</p>\n\n<pre><code>#ifdef WIN32\n#   if defined(YAML_DECLARE_STATIC)\n#       define  YAML_DECLARE(type)  type\n#   elif defined(YAML_DECLARE_EXPORT)\n#       define  YAML_DECLARE(type)  __declspec(dllexport) type\n#   else\n#       define  YAML_DECLARE(type)  __declspec(dllimport) type\n#   endif\n#else\n#   define  YAML_DECLARE(type)  type\n#endif\n</code></pre>\n\n<p>That means that on Windows all yaml-related functions by default are decorated with <code>__declspec(dllimport)</code> (the <code>_imp__</code> prefixes in the linker error messages were hints). Because of this the linker expects those functions to be in an external DLL. But the yaml code is bundled and compiled together with the Lua binding into a single DLL <code>yaml\\core.dll</code>, and so the linker complains. The correct way to fix this is to remove all import/export-related decorations from the yaml functions, and this can be achieved by defining <code>YAML_DECLARE_STATIC</code>. This macro should definitely be set in the rockspec (I'll post a bug report later), but a quick and dirty solution is to set it via the <code>CC</code> variable on the commandline:</p>\n\n<pre><code>luarocks install yaml-1.1.2-1.src.rock CC=\"mingw32-gcc -DYAML_DECLARE_STATIC\"\n</code></pre>\n\n<p>After that there should be a <code>yaml\\core.dll</code> file and a <code>yaml\\init.lua</code> file somewhere in your LuaRocks directory. To use the Lua yaml binding you have to make sure that a <code>require(\"yaml\")</code> loads the <code>yaml\\init.lua</code> file, and that <code>require(\"yaml.core\")</code> loads <code>yaml\\core.dll</code>. This can be achieved by adding to <code>package.path</code>/<code>package.cpath</code> (from within your Lua script) or preferably by adding to <code>LUA_PATH</code>/<code>LUA_CPATH</code>. Since the installed LuaSocket already works, you probably have <code>LUA_PATH</code>/<code>LUA_CPATH</code> mostly set up correctly, but the yaml binding uses a different approach for loading its main Lua module than LuaSocket: LuaSocket has <code>socket.lua</code> for <code>require(\"socket\")</code>, but yaml has <code>yaml\\init.lua</code> for <code>require(\"yaml\")</code>. This approach has the advantage that any Lua submodules (e.g. <code>yaml.a</code>) would be in the same directory as the code for the main Lua module. Anyway, you also have to add</p>\n\n<pre><code>D:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\?\\init.lua\n</code></pre>\n\n<p>to your <code>LUA_PATH</code> environment variable.</p>\n\n<p>Btw., the <code>yaml.lua</code> file you found in the github repository is a symbolic link and won't work correctly on Windows anyway (but it could interfere, so you shouldn't put it into your rocks tree). It's only there for convenience during development.</p>\n"}], "owner": {"reputation": 12462, "user_id": 2298137, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/JN0cS.png?s=128&g=1", "display_name": "code_fodder", "link": "https://stackoverflow.com/users/2298137/code-fodder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 809, "favorite_count": 0, "accepted_answer_id": 39015671, "answer_count": 1, "score": 0, "last_activity_date": 1471522283, "creation_date": 1471447699, "last_edit_date": 1471522283, "question_id": 39000722, "link": "https://stackoverflow.com/questions/39000722/issues-installing-yaml-for-lua-with-luarocks-during-the-c-compile", "title": "Issues installing yaml for lua with luarocks during the c-compile", "body": "<p>I have lua, that I isntalled using luarocks.</p>\n\n<p><strong>Edit:</strong> on a windows system</p>\n\n<p>I successfully installed luasocket by downloading the luasocket-2.0.2-3.win32-x86.rock file from <a href=\"https://luarocks.org/modules/luarocks/luasocket/2.0.2-3\" rel=\"nofollow noreferrer\">v202-3 from here</a>. Its an older version, but it works.</p>\n\n<p>However now I need to install yaml so I can work with yaml files. Now I am forced to install using a *.src.rock file or a .rockspec file.</p>\n\n<p>I have tried:</p>\n\n<p><code>luarocks install yaml</code> which gives:</p>\n\n<pre><code>D:\\user\\workspace\\_lua&gt;luarocks install yaml\nWarning: Failed searching manifest: Failed fetching manifest for https://luarocks.org - Failed downloading https://luarocks.org/manifest - C:\\Users\\user\\AppData\\Local/LuaRocks/Cache/https___luarocks.org/manifest\nWarning: Failed searching manifest: Failed fetching manifest for https://raw.githubusercontent.com/rocks-moonscript-org/moonrocks-mirror/master/ - Failed downloading https://raw.githubusercontent.com/rocks-moonscript-org/moonrocks-mirror/master/manifest - C:\\Users\\user\\AppData\\Local/LuaRocks/Cache/https___raw.githubusercontent.com_rocks-moonscript-org_moonrocks-mirror_master_/manifest\nWarning: Failed searching manifest: Failed fetching manifest for http://luafr.org/moonrocks/ - Failed downloading http://luafr.org/moonrocks/manifest - C:\\Users\\user\\AppData\\Local/LuaRocks/Cache/http___luafr.org_moonrocks_/manifest\nWarning: Failed searching manifest: Failed fetching manifest for http://luarocks.logiceditor.com/rocks - Failed downloading http://luarocks.logiceditor.com/rocks/manifest - C:\\Users\\user\\AppData\\Local/LuaRocks/Cache/http___luarocks.logiceditor.com_rocks/manifest\n\nError: No results matching query were found.\n</code></pre>\n\n<p>So, then I downloaded <code>yaml-1.1.2-1.src.rock</code> and ran the command:\n<code>luarocks install yaml-1.1.2-1.src.rock</code></p>\n\n<p>This told me that I had dependencies yaml --> lub --> luafilesystem. so then I downloaded:</p>\n\n<ul>\n<li>luafilesystem-1.6.3-2.src.rock</li>\n<li>lub-1.1.0-1.src.rock</li>\n<li>yaml-1.1.2-1.src.rock</li>\n</ul>\n\n<p>And I installed them one after the other with the result:</p>\n\n<ul>\n<li><code>luarocks install luafilesystem-1.6.3-2.src.rock</code> - OK</li>\n<li><code>luarocks install lub-1.1.0-1.src.rock</code> - OK</li>\n<li><code>luarocks install yaml-1.1.2-1.src.rock</code> - FAILED, see errors below</li>\n</ul>\n\n<p>Error log:</p>\n\n<pre><code>D:\\user\\downloads\\luarocks-2.3.0-win32\\extras&gt;luarocks install yaml-1.1.2-1.src.rock\nUsing yaml-1.1.2-1.src.rock... switching to 'build' mode\nmingw32-gcc -O2 -c -o src/api.o -ID:/user/install/lua/luarocks/include src/api.c -Isrc\nmingw32-gcc -O2 -c -o src/b64.o -ID:/user/install/lua/luarocks/include src/b64.c -Isrc\nmingw32-gcc -O2 -c -o src/dumper.o -ID:/user/install/lua/luarocks/include src/dumper.c -Isrc\nmingw32-gcc -O2 -c -o src/emitter.o -ID:/user/install/lua/luarocks/include src/emitter.c -Isrc\nmingw32-gcc -O2 -c -o src/loader.o -ID:/user/install/lua/luarocks/include src/loader.c -Isrc\nmingw32-gcc -O2 -c -o src/lyaml.o -ID:/user/install/lua/luarocks/include src/lyaml.c -Isrc\nmingw32-gcc -O2 -c -o src/parser.o -ID:/user/install/lua/luarocks/include src/parser.c -Isrc\nmingw32-gcc -O2 -c -o src/reader.o -ID:/user/install/lua/luarocks/include src/reader.c -Isrc\nmingw32-gcc -O2 -c -o src/scanner.o -ID:/user/install/lua/luarocks/include src/scanner.c -Isrc\nmingw32-gcc -O2 -c -o src/strtod.o -ID:/user/install/lua/luarocks/include src/strtod.c -Isrc\nIn file included from src/strtod.c:23:0:\nsrc/strtod.c:24:17: warning: '_errno' redeclared without dllimport attribute: previous dllimport ignored [-Wattributes]\n extern  int     errno;\n                 ^\nmingw32-gcc -O2 -c -o src/writer.o -ID:/user/install/lua/luarocks/include src/writer.c -Isrc\nmingw32-gcc -shared -o yaml/core.dll src/api.o src/b64.o src/dumper.o src/emitter.o src/loader.o src/lyaml.o src/parser.o src/reader.o src/scanner.o src/strtod.o src/writer.o D:/user/install/lua/luarocks/lua5.1.lib -lMSVCR80\nsrc/api.o:api.c:(.text+0x395): undefined reference to '_imp__yaml_realloc'\nsrc/api.o:api.c:(.text+0x412): undefined reference to '_imp__yaml_string_extend'\n            :\n    LOTS OF THESE\n            :\nsrc/scanner.o:scanner.c:(.text.unlikely+0x29d0): undefined reference to '_imp__yaml_queue_extend'\nsrc/scanner.o:scanner.c:(.text.unlikely+0x29e8): undefined reference to '_imp__yaml_token_delete'\ncollect2.exe: error: ld returned 1 exit status\n\nError: Build error: Failed compiling module yaml/core.dll\n</code></pre>\n\n<p>Does anyone know why this build fails? - I got it directly from here: <code>https://luarocks.org/modules/gaspard/yaml/1.1.2-1</code> which is the most downloaded version... so I guess it should work?</p>\n\n<p>I mean, I can see what the error is... but I don't understand why there should be an error. How can I resolve this?... Any help appreciated :)</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Thanks to siffiejoe's comment, I was able to compile the yaml rock. Here is the output:</p>\n\n<pre><code>D:\\user\\downloads\\luarocks-2.3.0-win32\\extras&gt;luarocks install yaml-1.1.2-1.src.rock CC=\"gcc -DYAML_DECLARE_STATIC\"\nUsing yaml-1.1.2-1.src.rock... switching to 'build' mode\ngcc -DYAML_DECLARE_STATIC -O2 -c -o src/api.o -ID:/user/install/lua/luarocks/include src/api.c -Isrc\ngcc -DYAML_DECLARE_STATIC -O2 -c -o src/b64.o -ID:/user/install/lua/luarocks/include src/b64.c -Isrc\ngcc -DYAML_DECLARE_STATIC -O2 -c -o src/dumper.o -ID:/user/install/lua/luarocks/include src/dumper.c -Isrc\ngcc -DYAML_DECLARE_STATIC -O2 -c -o src/emitter.o -ID:/user/install/lua/luarocks/include src/emitter.c -Isrc\ngcc -DYAML_DECLARE_STATIC -O2 -c -o src/loader.o -ID:/user/install/lua/luarocks/include src/loader.c -Isrc\ngcc -DYAML_DECLARE_STATIC -O2 -c -o src/lyaml.o -ID:/user/install/lua/luarocks/include src/lyaml.c -Isrc\ngcc -DYAML_DECLARE_STATIC -O2 -c -o src/parser.o -ID:/user/install/lua/luarocks/include src/parser.c -Isrc\ngcc -DYAML_DECLARE_STATIC -O2 -c -o src/reader.o -ID:/user/install/lua/luarocks/include src/reader.c -Isrc\ngcc -DYAML_DECLARE_STATIC -O2 -c -o src/scanner.o -ID:/user/install/lua/luarocks/include src/scanner.c -Isrc\ngcc -DYAML_DECLARE_STATIC -O2 -c -o src/strtod.o -ID:/user/install/lua/luarocks/include src/strtod.c -Isrc\nIn file included from src/strtod.c:23:0:\nsrc/strtod.c:24:17: warning: '_errno' redeclared without dllimport attribute: previous dllimport ignored [-Wattributes]\n extern  int     errno;\n                 ^\ngcc -DYAML_DECLARE_STATIC -O2 -c -o src/writer.o -ID:/user/install/lua/luarocks/include src/writer.c -Isrc\nmingw32-gcc -shared -o yaml/core.dll src/api.o src/b64.o src/dumper.o src/emitter.o src/loader.o src/lyaml.o src/parser.o src/reader.o src/scanner.o src/strtod.o src/writer.o D:/user/install/lua/luarocks/lua5.1.lib -lMSVCR80\nUpdating manifest for D:\\user\\install\\lua\\luarocks\\systree/lib/luarocks/rocks\nyaml 1.1.2-1 is now built and installed in D:\\user\\install\\lua\\luarocks\\systree (license: MIT)\n</code></pre>\n\n<p>So it says it is installed. However when I try to use the yaml packge it does not find it:</p>\n\n<pre><code>local yaml = require(\"yaml\")\nlocal data = yaml.load(\"mytest.yaml\")\n</code></pre>\n\n<p>The system reports that it can't find yaml.lua or yaml.dll. I then searched *.lua and *.dll in my luarocks folder I found:</p>\n\n<pre><code>D:\\user\\install\\lua\\luarocks\\systree&gt;dir *.lua *.dll /b /s\nD:\\user\\install\\lua\\luarocks\\systree\\lib\\lua\\5.1\\lfs.dll\nD:\\user\\install\\lua\\luarocks\\systree\\lib\\lua\\5.1\\mime\\core.dll\nD:\\user\\install\\lua\\luarocks\\systree\\lib\\lua\\5.1\\socket\\core.dll\nD:\\user\\install\\lua\\luarocks\\systree\\lib\\lua\\5.1\\yaml\\core.dll\nD:\\user\\install\\lua\\luarocks\\systree\\lib\\luarocks\\rocks\\luafilesystem\\1.6.3-2\\tests\\test.lua\nD:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\ltn12.lua\nD:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\mime.lua\nD:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\socket.lua\nD:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\lub\\Autoload.lua\nD:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\lub\\Dir.lua\nD:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\lub\\init.lua\nD:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\lub\\Param.lua\nD:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\lub\\Template.lua\nD:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\socket\\ftp.lua\nD:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\socket\\http.lua\nD:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\socket\\smtp.lua\nD:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\socket\\tp.lua\nD:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\socket\\url.lua\nD:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\yaml\\init.lua\n</code></pre>\n\n<p>For example, I managed to install luasocket with <code>luarocks install luasocket-2.0.2-3.win32-x86.rock</code> because there was a .rock file available. And so you can see there is a socket.lua. For yaml, lub and luafilesystem I can see various install locations, but there is no .lua or .dll files...\nI searched more for yaml specifically:</p>\n\n<pre><code>D:\\user\\install\\lua\\luarocks\\systree&gt;dir *yaml* /b /s\nD:\\user\\install\\lua\\luarocks\\systree\\lib\\lua\\5.1\\yaml\nD:\\user\\install\\lua\\luarocks\\systree\\lib\\luarocks\\rocks\\yaml\nD:\\user\\install\\lua\\luarocks\\systree\\lib\\luarocks\\rocks\\yaml\\1.1.2-1\\yaml-1.1.2-1.rockspec\nD:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\yaml\n</code></pre>\n\n<p>ehh... so then I went and cloned the project from git (had to download the zip file because my stupid IT blocked my git clone ... (port 443).</p>\n\n<p>So finally got that sorted, then in the yaml-master folder I tried:</p>\n\n<p><code>luarocks make yaml-1.1.2-1.rockspec CC-\"gcc -DYAML_DECLARE_STATIC\"</code></p>\n\n<p>This had the same effect as before. So now I have tried both .src.rock and .rockspec types...</p>\n\n<p>I am stuck again :(</p>\n\n<p><strong>UPDATE 2</strong></p>\n\n<p>When I built from git, there was a file called yaml.lua in the top level. But all it contains is the text <code>yaml/init.lua</code> ... not sure what to do with that - tried copying it into the my <code>..install\\lua\\luarocks\\systree\\share\\lua\\5.1</code> dir, but when I run my test lua projam it gives an error.... what is going on, it can't be this hard to install :(</p>\n\n<p><strong>UPDATE 3</strong></p>\n\n<p>Following on from siffiejoe's great answer, I have more or less got this yaml installed. But I have a bug running it:</p>\n\n<p>Here is my lua script:</p>\n\n<pre><code>package.path = \"D:\\\\user\\\\install\\\\lua\\\\luarocks\\\\systree\\\\share\\\\lua\\\\5.1\\\\?\\\\init.lua;\" .. package.path\nprint(\"package.path: \" .. package.path)\nlocal yaml = require(\"yaml\")\nlocal data = yaml.load(\"mytest.yaml\")\n</code></pre>\n\n<p>I am manually adding the lua path for now while I am testing. When I run this I get the window:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VwfbZ.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VwfbZ.gif\" alt=\"enter image description here\"></a></p>\n\n<p>And my log looks like:</p>\n\n<pre><code>D:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\?\\init.lua;D:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\?.lua;D:\\user\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\?\\init.lua;./?.lua;./?/init.lua;./lua/?.lua;./lua/?/init.lua;D:\\user\\install\\lua\\zerobrane\\lualibs/?/?.lua;D:\\user\\install\\lua\\zerobrane\\lualibs/?.lua;D:\\user\\install\\lua\\zerobrane\\lualibs/?/?/init.lua;D:\\user\\install\\lua\\zerobrane\\lualibs/?/init.lua\nD:\\user\\install\\lua\\zerobrane\\bin\\lua.exe: error loading module 'lfs' from file 'D:\\user\\install\\lua\\luarocks\\systree\\lib\\lua\\5.1\\lfs.dll':\n    The specified procedure could not be found.\n\n\nstack traceback:\n    [C]: at 0x66df0460\n    [C]: in function 'require'\n    ...\\install\\lua\\luarocks\\systree\\share\\lua\\5.1\\lub\\init.lua:17: in main chunk\n    [C]: in function 'require'\n    ...install\\lua\\luarocks\\systree\\share\\lua\\5.1\\yaml\\init.lua:25: in main chunk\n    [C]: in function 'require'\n    D:\\user\\workspace\\_lua\\myluatest.lua:3: in main chunk\n    [C]: at 0x00402a57\nProgram completed in 56.64 seconds (pid: 15856).\n</code></pre>\n\n<p>So it appears to come back to this MSVCR80.dll ... this is not making sense to me, I assume this is do with microsoft... Some things I have read about it could be a corrupt MSVCR80.dll that needs replacing or somthing. But I am not yet sure about why this is occuring. Any thoughts?</p>\n"}, {"tags": ["c", "file-handling"], "comments": [{"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 1, "creation_date": 1471447480, "post_id": 39000622, "comment_id": 65353036, "body": "<code>s</code> may be whatever you want if it represents NUL-terminated sequence of <code>char</code>."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1471447654, "post_id": 39000622, "comment_id": 65353142, "body": "When you pass a variable to a function, you have to keep two things in mind -- the type of the variable and the value of the variable. A char array is good for the type. It is not enough. Its value has to be set appropriately."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1471447655, "post_id": 39000622, "comment_id": 65353144, "body": "Read the manual... google... anything. It&#39;s not difficult research."}, {"owner": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "edited": false, "score": 0, "creation_date": 1471447685, "post_id": 39000622, "comment_id": 65353162, "body": "Maybe RTFM would help? <a href=\"http://man7.org/linux/man-pages/man3/fopen.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/fopen.3.html</a>"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1471447748, "post_id": 39000622, "comment_id": 65353203, "body": "@Jay Khandkar: &quot;null voided&quot;? What does that mean?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1471447814, "post_id": 39000622, "comment_id": 65353233, "body": "Of course, a file opened for reading must exist. You assign the return value from <code>fopen</code> to a <code>FILE *</code> variable, and you must check it is not <code>NULL</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1471448866, "post_id": 39000622, "comment_id": 65353924, "body": "@WeatherVane: the file named doesn&#39;t have to exist to be passed to <code>fopen()</code> \u2014 it has to exist to be opened successfully for reading, but that&#39;s different.  The argument to <code>fopen()</code> should be a valid (non-null) pointer to a null-terminated string.  Lots of strings that could be passed won&#39;t be valid and the <code>fopen()</code> call will therefore fail."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471448959, "post_id": 39000622, "comment_id": 65353975, "body": "Is there any other C function that often and well documented like <code>fopen</code> in the internet? (ok, maybe <code>printf</code>). What did you try to find out` Why does that not work? Did you read what a C-string is?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1471449019, "post_id": 39000622, "comment_id": 65354013, "body": "Detail: Code cannot pass an array.  Instead with <code>char s[100]; ... fopen(s, &quot;r&quot;);</code>, code passed the address of <code>s[0]</code> to <code>fopen()</code>.  That <i>pointer</i> needs to point to a sequence of characters that end with a null character."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471449104, "post_id": 39000622, "comment_id": 65354068, "body": "@chux: Nitpicking on the detail: The pointer needs to point to <code>char</code>. IIRC, <code>wchar_t</code> is also a character type;-)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471449484, "post_id": 39000622, "comment_id": 65354300, "body": "@Oalf &quot;A <i>string</i> is a contiguous sequence of <i>characters</i> terminated by and including the first null character.&quot;. 7.1.1 1.  Seems the spec uses <i>character</i> in this narrow context.   <code>wchar_t</code> represents extended characters.  7.19 2.  and uses <i>wide string</i> in that context."}, {"owner": {"reputation": 111, "user_id": 6667391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56cea37968af33ea03cb7c596ff1c5d?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Khandkar", "link": "https://stackoverflow.com/users/6667391/jay-khandkar"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1471450635, "post_id": 39000622, "comment_id": 65354998, "body": "@AnT Sorry, I meant null terminated"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1471453387, "post_id": 39000622, "comment_id": 65356512, "body": "@JonathanLeffler are you nit-picking too? The question of nul termination had already been answered. I was commenting on the <code>fopen(s, &quot;r&quot;);</code> posted being inadequate."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1471449027, "post_id": 39000696, "comment_id": 65354020, "body": "Strictly speaking it expects a pointer, not a C string, which is an array of <code>char</code>."}], "tags": [], "owner": {"reputation": 395, "user_id": 3989673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38def4defd279dd679ff90c4195d7c5?s=128&d=identicon&r=PG", "display_name": "bigahega", "link": "https://stackoverflow.com/users/3989673/bigahega"}, "is_accepted": false, "score": 1, "last_activity_date": 1471448984, "last_edit_date": 1471448984, "creation_date": 1471447627, "answer_id": 39000696, "question_id": 39000622, "link": "https://stackoverflow.com/questions/39000622/what-can-i-pass-to-fopen/39000696#39000696", "title": "What can I pass to fopen?", "body": "<p>The signature for <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fopen.html\" rel=\"nofollow\"><code>fopen()</code></a> is:</p>\n\n<pre><code>FILE * fopen ( const char * filename, const char * mode );\n</code></pre>\n\n<p>So the <code>filename</code> parameter has to be a valid C string. That's all.</p>\n"}, {"tags": [], "owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "is_accepted": true, "score": 2, "last_activity_date": 1471453660, "last_edit_date": 1471453660, "creation_date": 1471447772, "answer_id": 39000741, "question_id": 39000622, "link": "https://stackoverflow.com/questions/39000622/what-can-i-pass-to-fopen/39000741#39000741", "title": "What can I pass to fopen?", "body": "<p><code>s</code> must be a pointer to a null terminated character array.<a href=\"https://i.stack.imgur.com/5YdY2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5YdY2.png\" alt=\"enter image description here\"></a></p>\n\n<p>The <a href=\"http://linux.die.net/man/3/fopen\" rel=\"nofollow noreferrer\">man pages</a> confirm this</p>\n\n<pre><code>FILE *fopen(const char *path, const char *mode);\n</code></pre>\n\n<p>You can see that it must be null terminated, since no <code>size</code> argument is given.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1471454043, "creation_date": 1471454043, "answer_id": 39002654, "question_id": 39000622, "link": "https://stackoverflow.com/questions/39000622/what-can-i-pass-to-fopen/39002654#39002654", "title": "What can I pass to fopen?", "body": "<p>The exact signature for <code>fopen</code> as specified ni the C11 Standard is:</p>\n\n<pre><code>FILE *fopen(const char * restrict filename, const char * restrict mode);\n</code></pre>\n\n<p>Both <code>filename</code> and <code>mode</code> are just pointers to null terminated arrays of <code>char</code> (<em>aka C strings</em>).</p>\n\n<p>The presence of the <code>restrict</code> keyword seems to indicate that the strings should not overlap, which does not make much sense since they are both <code>const</code> qualified.</p>\n\n<p>When you pass a <code>char</code> array to <code>fopen</code>, a pointer to its first element is passed.  This step is referred to as <em>the array decays into a pointer</em>.  The same happens whenever an array is used in an expression, except as an argument to <code>sizeof</code>.</p>\n"}], "owner": {"reputation": 111, "user_id": 6667391, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56cea37968af33ea03cb7c596ff1c5d?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Khandkar", "link": "https://stackoverflow.com/users/6667391/jay-khandkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1722, "favorite_count": 2, "accepted_answer_id": 39000741, "answer_count": 3, "score": -6, "last_activity_date": 1605814286, "creation_date": 1471447375, "last_edit_date": 1605814286, "question_id": 39000622, "link": "https://stackoverflow.com/questions/39000622/what-can-i-pass-to-fopen", "title": "What can I pass to fopen?", "body": "<p>Can I pass a character array to <code>fopen</code>? For example:</p>\n\n<pre><code>    fopen(s, \"r\");\n</code></pre>\n\n<p>Where <code>s</code> is declared as a character array and is null terminated. </p>\n"}, {"tags": ["c", "string", "sorting", "linked-list"], "comments": [{"owner": {"reputation": 1248, "user_id": 1791872, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6nnz7.png?s=128&g=1", "display_name": "flau", "link": "https://stackoverflow.com/users/1791872/flau"}, "edited": false, "score": 0, "creation_date": 1471447072, "post_id": 39000450, "comment_id": 65352747, "body": "Your sort function does not compile, you&#39;re missing a <code>}</code>"}, {"owner": {"reputation": 346, "user_id": 6709711, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/8tZM5.jpg?s=128&g=1", "display_name": "SynAck", "link": "https://stackoverflow.com/users/6709711/synack"}, "reply_to_user": {"reputation": 1248, "user_id": 1791872, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6nnz7.png?s=128&g=1", "display_name": "flau", "link": "https://stackoverflow.com/users/1791872/flau"}, "edited": false, "score": 0, "creation_date": 1471447200, "post_id": 39000450, "comment_id": 65352836, "body": "oh i m sorry i missed out a } here...i have all the } in my original program"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1471448004, "post_id": 39000450, "comment_id": 65353336, "body": "Your algorithm is an unstable variant of selection sort.  Its time-complexity is  <b>O(N^2)</b>.  Try and implement merge sort, a much more efficient algorithm with worst-case time-complexity of <b>O(N.log(N))</b>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1471449383, "post_id": 39000450, "comment_id": 65354234, "body": "Welcome to Stack Overflow. Please note that the preferred way of saying &#39;thanks&#39; around here is by up-voting good questions and helpful answers (once you have enough reputation to do so), and by accepting the most helpful answer to any question you ask (which also gives you a small boost to your reputation). Please see the <a href=\"https://stackoverflow.com/tour\">About</a> page and also <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask questions here?</a> and <a href=\"http://stackoverflow.com/help/someone-answers\">What do I do when someone answers my question?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 346, "user_id": 6709711, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/8tZM5.jpg?s=128&g=1", "display_name": "SynAck", "link": "https://stackoverflow.com/users/6709711/synack"}, "edited": false, "score": 0, "creation_date": 1471447883, "post_id": 39000666, "comment_id": 65353276, "body": "thanks ,swapping the pointers  works but I&#39;m confused-what is wrong with swapping the data?."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1471448006, "post_id": 39000666, "comment_id": 65353339, "body": "Three reasons: any string might not have the space to store a longer string; and you have not allocated any memory to your scratch space <code>*str</code>; and execution time."}, {"owner": {"reputation": 346, "user_id": 6709711, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/8tZM5.jpg?s=128&g=1", "display_name": "SynAck", "link": "https://stackoverflow.com/users/6709711/synack"}, "edited": false, "score": 0, "creation_date": 1471448186, "post_id": 39000666, "comment_id": 65353462, "body": "got it.Thank&#39;s a lot"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 5, "last_activity_date": 1471447514, "creation_date": 1471447514, "answer_id": 39000666, "question_id": 39000450, "link": "https://stackoverflow.com/questions/39000450/runtime-error-sorting-a-linked-list-of-strings/39000666#39000666", "title": "Runtime error sorting a linked list of strings", "body": "<p><code>char *str; ... strcpy(str,x-&gt;name);</code> copies data pointed to by <code>name</code> to an <em>someplace</em> (it is undefined behavior) as <code>str</code> is an uninitialized pointer.  </p>\n\n<p>Just swap pointers.</p>\n\n<pre><code>       if (strcmp(x-&gt;name,y-&gt;name) &gt; 0) {\n         char *temp = x-&gt;name;\n         x-&gt;name = y-&gt;name;\n         y-&gt;name = temp;\n       }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1471455280, "post_id": 39002702, "comment_id": 65357552, "body": "I&#39;m afraid <code>char str[SIZE_MAX];</code> is not an option because <code>SIZE_MAX</code>, the maximum value of type <code>size_t</code>, is much too large, likely larger than available memory and definitely too much for an automatic variable."}], "tags": [], "owner": {"reputation": 1, "user_id": 6727364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e46e3420be44738ac43066874635d3?s=128&d=identicon&r=PG&f=1", "display_name": "Shailesh", "link": "https://stackoverflow.com/users/6727364/shailesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1471688981, "last_edit_date": 1471688981, "creation_date": 1471454196, "answer_id": 39002702, "question_id": 39000450, "link": "https://stackoverflow.com/questions/39000450/runtime-error-sorting-a-linked-list-of-strings/39002702#39002702", "title": "Runtime error sorting a linked list of strings", "body": "<p><code>char *str;</code> \nThis statement only create a pointer. There is no memory is associated with that;</p>\n\n<p><code>strcpy(char* dest, char* src)</code> simply copies the the content in the memory pointed by <strong>src</strong> to memory point by <strong>dest</strong></p>\n\n<p>In your case <strong>str not pointing to any memory location</strong>;</p>\n\n<p><code>strcpy(str, x-&gt;name)</code></p>\n\n<p>since <strong>str pointing to nothing</strong>, this statement endup with an error because strcpy fails to copy to str</p>\n\n<p>instead of <code>char* str;</code> \nuse <code>char str[SIZE_MAX];</code></p>\n"}], "owner": {"reputation": 346, "user_id": 6709711, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/8tZM5.jpg?s=128&g=1", "display_name": "SynAck", "link": "https://stackoverflow.com/users/6709711/synack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 39000666, "answer_count": 2, "score": 2, "last_activity_date": 1530745309, "creation_date": 1471446886, "last_edit_date": 1530745309, "question_id": 39000450, "link": "https://stackoverflow.com/questions/39000450/runtime-error-sorting-a-linked-list-of-strings", "title": "Runtime error sorting a linked list of strings", "body": "<pre><code>void sort(struct node **s2) {\n    struct node *x, *y;\n    x = *s2;\n    char *str;\n    while (x != NULL) {\n        y = x-&gt;n;\n        while (y != NULL) {\n            if (strcmp(x-&gt;name, y-&gt;name) &gt; 0) {\n                strcpy(str, x-&gt;name);\n                strcpy(x-&gt;name, y-&gt;name);\n                strcpy(y-&gt;name, str);\n            }\n            y = y-&gt;n;\n        }\n        x = x-&gt;n;\n    }\n}\n</code></pre>\n\n<p>This is showing a run time error.\nI don't know whats wrong\nI believe the sorting is correct\nIt's selection sort\nThe structure of my node is:</p>\n\n<pre><code>struct node {\n    char *name;\n    struct node *n;\n};\n</code></pre>\n\n<p>It's showing runtime error.</p>\n"}, {"tags": ["c", "arrays", "string", "pointers", "concatenation"], "comments": [{"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 1, "creation_date": 1471446574, "post_id": 39000320, "comment_id": 65352382, "body": "did you try <code>strcat()</code> ?"}, {"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "reply_to_user": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1471451782, "post_id": 39000320, "comment_id": 65355646, "body": "@deamentiaemundi: No; not really. <a href=\"https://www.google.com/search?q=c+add+strings\" rel=\"nofollow noreferrer\">google.com/search?q=c+add+strings</a>"}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "reply_to_user": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 0, "creation_date": 1471459813, "post_id": 39000320, "comment_id": 65360037, "body": "@SLaks Reseaching yourself? Asking Google even? No, <i>that</i> would be waaay too much! ;-) But serious: it was meant as a little stinger for those users here who think that every poster is highly fluent in English and I was quite serious with &quot;third or fourth&quot; language. Be a more patient, pleeease!"}], "answers": [{"comments": [{"owner": {"reputation": 5751, "user_id": 1101692, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0207bd98c9e3f6f855d82aff720437aa?s=128&d=identicon&r=PG", "display_name": "Shark", "link": "https://stackoverflow.com/users/1101692/shark"}, "edited": false, "score": 1, "creation_date": 1471446646, "post_id": 39000365, "comment_id": 65352428, "body": "Perhaps you should recommend him to allocate/malloc a new buffer equal to the length of both strings?"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 3, "last_activity_date": 1471447404, "last_edit_date": 1471447404, "creation_date": 1471446606, "answer_id": 39000365, "question_id": 39000320, "link": "https://stackoverflow.com/questions/39000320/how-to-add-two-string-in-c-programming-language/39000365#39000365", "title": "How to add two string in C programming language?", "body": "<p>Use standard C function <code>strcat</code> declared in header <code>&lt;string.h&gt;</code>. For example</p>\n\n<pre><code>#include &lt;string.h&gt;\n\n//...\n\nstrcat( samrat, string );\n</code></pre>\n\n<p>Another approach is to create dynamically a new string that will contain the concatenation of these two strings. For example</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n//...\n\nchar *s = malloc( strlen( samrat ) + strlen( string ) + 1 );\n\nif ( s != NULL )\n{\n    strcpy( s, samrat );\n    strcat( s, string );\n}\n\n//...\n\nfree( s );\n</code></pre>\n\n<p>As for your statement</p>\n\n<pre><code>samrat=samrat+string;\n</code></pre>\n\n<p>then array designators are converted (with rare exceptions) to pointers to their first elements in expressions. So you are trying to add two pointers. This operation for pointers is not defined in C. And moreover arrays are non-modifiable lvalues. You may not assign an array with an expression.</p>\n"}, {"tags": [], "owner": {"reputation": 7476, "user_id": 3415258, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/100007912508550/picture?type=large", "display_name": "P45 Imminent", "link": "https://stackoverflow.com/users/3415258/p45-imminent"}, "is_accepted": false, "score": 1, "last_activity_date": 1471446658, "creation_date": 1471446658, "answer_id": 39000382, "question_id": 39000320, "link": "https://stackoverflow.com/questions/39000320/how-to-add-two-string-in-c-programming-language/39000382#39000382", "title": "How to add two string in C programming language?", "body": "<p><code>samrat + string</code> will attempt to add together two pointers of type <code>char*</code>, with a meaningless result.</p>\n\n<p>Use <code>strcat</code> to concatenate two strings: <code>strcat(samrat, string);</code>. Don't forget to ensure that the <code>samrat</code> buffer is large enough to accommodate the result.</p>\n"}], "owner": {"reputation": 5, "user_id": 6609724, "user_type": "registered", "profile_image": "https://graph.facebook.com/1055315927916133/picture?type=large", "display_name": "Samrat Luintel", "link": "https://stackoverflow.com/users/6609724/samrat-luintel"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2524, "favorite_count": 0, "closed_date": 1471446838, "answer_count": 2, "score": -4, "last_activity_date": 1471447404, "creation_date": 1471446465, "last_edit_date": 1471447231, "question_id": 39000320, "link": "https://stackoverflow.com/questions/39000320/how-to-add-two-string-in-c-programming-language", "closed_reason": "Duplicate", "title": "How to add two string in C programming language?", "body": "<p>How to add two string in C?</p>\n\n<p>Have a look at my program that I have made so far.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    char samrat[10]=\"*\";\n    char string[1]=\"*\";\n    samrat=samrat+string;\n}\n</code></pre>\n"}, {"tags": ["java", "c", "pointers", "char", "java-native-interface"], "comments": [{"owner": {"reputation": 91026, "user_id": 131433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e6eeaf8698180e971e169a925d8e0f4f?s=128&d=identicon&r=PG", "display_name": "bmargulies", "link": "https://stackoverflow.com/users/131433/bmargulies"}, "edited": false, "score": 6, "creation_date": 1471445339, "post_id": 38999868, "comment_id": 65351521, "body": "why are you passing &#39;*pchar&#39; and not &#39;pchar&#39;?"}, {"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 0, "creation_date": 1471445537, "post_id": 38999868, "comment_id": 65351660, "body": "Post self-contained code and especially java declaration of native method and its JNI implementation."}, {"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 0, "creation_date": 1471445682, "post_id": 38999868, "comment_id": 65351750, "body": "Bytheway - I see no <code>jchar</code> in code. Where it comes from?"}, {"owner": {"reputation": 51, "user_id": 6726884, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/689adc2eeadc2f84fe3fbb339bad9ccd?s=128&d=identicon&r=PG&f=1", "display_name": "Jas On", "link": "https://stackoverflow.com/users/6726884/jas-on"}, "reply_to_user": {"reputation": 91026, "user_id": 131433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e6eeaf8698180e971e169a925d8e0f4f?s=128&d=identicon&r=PG", "display_name": "bmargulies", "link": "https://stackoverflow.com/users/131433/bmargulies"}, "edited": false, "score": 0, "creation_date": 1471446084, "post_id": 38999868, "comment_id": 65352028, "body": "@bmargulies I printed for testing purposes *pchar and pchar to the console, but pchar lead to NNN\ufffd&lt;\ufffd\ufffd&lt;\ufffd and *pchar to N"}, {"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 0, "creation_date": 1471446300, "post_id": 38999868, "comment_id": 65352187, "body": "Are you sure that <code>initcon()</code>&#39;s <code>parity</code> is a pointer to single char, not to string?"}, {"owner": {"reputation": 51, "user_id": 6726884, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/689adc2eeadc2f84fe3fbb339bad9ccd?s=128&d=identicon&r=PG&f=1", "display_name": "Jas On", "link": "https://stackoverflow.com/users/6726884/jas-on"}, "reply_to_user": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "edited": false, "score": 0, "creation_date": 1471446529, "post_id": 38999868, "comment_id": 65352351, "body": "@Serhio Yes, I got a documentation about the functions from the rs232 library where it is clearly stated that a pointer to a char value is required"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1471601264, "post_id": 38999868, "comment_id": 65422165, "body": "What&#39;s the meaning of the <code>...</code> ellipsis?  In ansi-c it is a specific token with an also specific meaning.  Why don&#39;t you post exact, compilable and testable examples with clear as stated error messages?  Do you think we are all in your head and see things like you?  Think that is such that thing where the fact, all of us should be committing the same mistake as you and will need SO recursively to ask the same question."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6721745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fab3fcd4710362ad706c28521b97f4fb?s=128&d=identicon&r=PG", "display_name": "Alan H.", "link": "https://stackoverflow.com/users/6721745/alan-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1471445524, "creation_date": 1471445524, "answer_id": 38999953, "question_id": 38999868, "link": "https://stackoverflow.com/questions/38999868/c-pointers-invalid-conversion-from-char-to-char/38999953#38999953", "title": "C Pointers - Invalid Conversion from Char to Char*", "body": "<p>If you look at your function parameters you'll see that <code>parity</code>is coming in as a <code>char *</code>, yet further down you have this line:</p>\n\n<pre><code>char p = (char) parity;\n</code></pre>\n\n<p>You're casting a char pointer to a char. You don't need to do this based upon what you appear to need on the next line:</p>\n\n<pre><code>char *pchar = &amp;p;\n</code></pre>\n\n<p>You already have parity as a <code>char *</code> as a result of the parameter being passed in.</p>\n"}, {"tags": [], "owner": {"reputation": 3218, "user_id": 6650970, "user_type": "registered", "profile_image": "https://graph.facebook.com/638903801/picture?type=large", "display_name": "Piotr Wilkin", "link": "https://stackoverflow.com/users/6650970/piotr-wilkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1471445696, "creation_date": 1471445696, "answer_id": 39000027, "question_id": 38999868, "link": "https://stackoverflow.com/questions/38999868/c-pointers-invalid-conversion-from-char-to-char/39000027#39000027", "title": "C Pointers - Invalid Conversion from Char to Char*", "body": "<p>As @bmargulies already pointed out, the problem here is that you are not passing <code>pchar</code> (which is of type <code>(char *)</code>, but <code>*pchar</code>. <code>*</code> is a dereferencing operator and it means \"give me whatever is at the address pointed to by <code>pchar</code>. In other words - a single <code>char</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 91026, "user_id": 131433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e6eeaf8698180e971e169a925d8e0f4f?s=128&d=identicon&r=PG", "display_name": "bmargulies", "link": "https://stackoverflow.com/users/131433/bmargulies"}, "is_accepted": false, "score": 0, "last_activity_date": 1471451977, "creation_date": 1471451977, "answer_id": 39002042, "question_id": 38999868, "link": "https://stackoverflow.com/questions/38999868/c-pointers-invalid-conversion-from-char-to-char/39002042#39002042", "title": "C Pointers - Invalid Conversion from Char to Char*", "body": "<p><code>jchar</code> is a single 16-bit, UTF-16, Unicode character. '&amp;' of it is <em>not</em> <code>char *</code>, and will not work passed to a <code>char *</code>. You need to convert it to the ACP and null-terminate it. <code>WideCharToMultiByte</code> might prove helpful.</p>\n"}], "owner": {"reputation": 51, "user_id": 6726884, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/689adc2eeadc2f84fe3fbb339bad9ccd?s=128&d=identicon&r=PG&f=1", "display_name": "Jas On", "link": "https://stackoverflow.com/users/6726884/jas-on"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 39000027, "answer_count": 3, "score": 0, "last_activity_date": 1471451977, "creation_date": 1471445256, "last_edit_date": 1471447030, "question_id": 38999868, "link": "https://stackoverflow.com/questions/38999868/c-pointers-invalid-conversion-from-char-to-char", "title": "C Pointers - Invalid Conversion from Char to Char*", "body": "<p>I'm currently coding a Java application which loads a native library coded in C.\nA C function which gets called from Java is passed a jchar.\nIn that C function, another library gets loaded with a new function which needs the jchar converted to a char* pointer.\nAll I know about that new function is that it takes a pointer to a char value as parameter (char* parity).</p>\n\n<p>This is my current code:</p>\n\n<pre><code>JNIEXPORT jint JNICALL Java_analyzer_DeclareNative_init (JNIEnv *env, jobject obj, ... , jchar parity, ...) {\n\n    typedef int (__stdcall *Init) (..., char* parity, ...);\n    HINSTANCE hinstLib = LoadLibrary(\"rs232\");\n\n    Init initcon = (Init) GetProcAdress(hinstLib, \"functionname\");\n\n    char p = (char) parity;  //(Typecasting jchar to char)\n    char *pchar = &amp;p;  //(Creating a pointer to p)\n\n    initcon(..., *pchar, ...);\n}\n</code></pre>\n\n<p>When I try to compile this code, it throws following error:\n\"Invalid conversion from char to char*\"</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1471443705, "post_id": 38999273, "comment_id": 65350207, "body": "Pick one language: C or C++."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471443720, "post_id": 38999273, "comment_id": 65350219, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a Minimal, Complete, and Verifiable example."}, {"owner": {"reputation": 5988, "user_id": 1989995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c6513dc6e38a1f5e1da198fda245b055?s=128&d=identicon&r=PG", "display_name": "alexeykuzmin0", "link": "https://stackoverflow.com/users/1989995/alexeykuzmin0"}, "edited": false, "score": 0, "creation_date": 1471443790, "post_id": 38999273, "comment_id": 65350278, "body": "Looks like C, but if it&#39;s really C++ consider using fstream"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1471443838, "post_id": 38999273, "comment_id": 65350326, "body": "That code should have caused the compiler to produce warnings, and if not then you need to enable more warnings. The warnings should have made you think a little, like &quot;doesn&#39;t the arguments to <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\"><code>fscanf</code></a> need to be pointers?&quot; And &quot;if <code>firstName</code> is a pointer to <code>char</code>, then isn&#39;t <code>firstName[i]</code> a single <code>char</code>?&quot;"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1471443896, "post_id": 38999273, "comment_id": 65350372, "body": "And please learn how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1471444149, "post_id": 38999400, "comment_id": 65350608, "body": "That&#39;s not going to work very well. A single contiguous array of  102400 bytes is not the same as an array of ten string pointers."}, {"owner": {"reputation": 69, "user_id": 5102960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8672fc478c36404202e6e268bcb977a4?s=128&d=identicon&r=PG&f=1", "display_name": "madago", "link": "https://stackoverflow.com/users/5102960/madago"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1471444336, "post_id": 38999400, "comment_id": 65350770, "body": "I agree with you if you use an offset instead of index . In that case you should access like this firstName+offset not firstname[i]"}, {"owner": {"reputation": 69, "user_id": 5102960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8672fc478c36404202e6e268bcb977a4?s=128&d=identicon&r=PG&f=1", "display_name": "madago", "link": "https://stackoverflow.com/users/5102960/madago"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1471444524, "post_id": 38999400, "comment_id": 65350907, "body": "Offset is updated as much as string is readed"}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1471446021, "post_id": 38999400, "comment_id": 65351975, "body": "No need to use <code>sizeof(char)</code> since that is 1 by definition."}], "tags": [], "owner": {"reputation": 69, "user_id": 5102960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8672fc478c36404202e6e268bcb977a4?s=128&d=identicon&r=PG&f=1", "display_name": "madago", "link": "https://stackoverflow.com/users/5102960/madago"}, "is_accepted": false, "score": -1, "last_activity_date": 1471444205, "last_edit_date": 1471444205, "creation_date": 1471443937, "answer_id": 38999400, "question_id": 38999273, "link": "https://stackoverflow.com/questions/38999273/handling-strings-inside-files/38999400#38999400", "title": "Handling strings inside Files", "body": "<p>The error in your code is : firstName[i] is a character not a string but you use it like a string by using %s instead of %c. </p>\n\n<p>you should use a char ** instead of char *. </p>\n\n<p>char **firstName = (char**)malloc(10*sizeof(char)*10240);</p>\n\n<p>I think also that 10240 is too much for firstName. Use 255 or less.  </p>\n"}, {"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1471445881, "post_id": 38999736, "comment_id": 65351875, "body": "Right! (it worked but I was lucky). Fixed."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471445894, "post_id": 38999736, "comment_id": 65351882, "body": "Suggest <code>char **firstName = malloc(sizeof *firstName  * nb_names);</code> to avoid coding errors."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471446322, "post_id": 38999736, "comment_id": 65352207, "body": "edited. Thanks for your interest."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 2, "last_activity_date": 1471446301, "last_edit_date": 1471446301, "creation_date": 1471444865, "answer_id": 38999736, "question_id": 38999273, "link": "https://stackoverflow.com/questions/38999273/handling-strings-inside-files/38999736#38999736", "title": "Handling strings inside Files", "body": "<p>Pure C code:</p>\n\n<p>You have to allocate the array of arrays first, then allocate each string one by one\nIt's best to scan the strings into temp strings with a big size, and duplicate the strings later.</p>\n\n<pre><code>int i,nb_names = 10;\nchar **firstName = malloc(sizeof *firstName * nb_names);\nchar **lastName = malloc(sizeof *lastName *nb_names);\nchar tempn[1000],templ[1000];\nfor(i = 0; i&lt;nb_names; i++){\n    fscanf(fp,\"%s %s\", tempn,templ);\n    firstName[i] = strdup(tempn);\n    lastName[i] = strdup(templ);\n\n}\n</code></pre>\n\n<p>Note that I have changed <code>for (int i</code> to <code>for (i</code> because it is not C compliant but rather C++ compliant (or C99, not sure).\nFor C++, drop the mallocs and use <code>std::vector</code> and <code>std:string</code> instead.</p>\n\n<p>I'd recommend to use C++ if you can. I answered a lot of C/C++ questions on people trying (and failing) to allocate 2D arrays properly (including me 5 minutes ago damn :)). C++ using C++ library code is much clearer.</p>\n\n<p>Full C++ example, reading from standard input</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;string&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nint main()\n{\nint nb_names = 10;\nvector&lt;string &gt; firstName(nb_names);\nvector&lt;string &gt; lastName(nb_names);\n\nfor(int i = 0; i&lt;nb_names; i++){\n\n    cin &gt;&gt; firstName[i]; \n    cin &gt;&gt; lastName[i];\n\n}\nreturn 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6726793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bd7f21fa0833a8793ef9845a4d00726?s=128&d=identicon&r=PG&f=1", "display_name": "TheDBeetle", "link": "https://stackoverflow.com/users/6726793/thedbeetle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1471670733, "answer_count": 2, "score": -3, "last_activity_date": 1471446301, "creation_date": 1471443587, "last_edit_date": 1471443711, "question_id": 38999273, "link": "https://stackoverflow.com/questions/38999273/handling-strings-inside-files", "closed_reason": "Not suitable for this site", "title": "Handling strings inside Files", "body": "<p>I'm trying to save data from a file into an array but I've had no luck for now. It's easy to save data after it was read from the file in case it's just numbers, but for example if I'm trying to save strings, the program keeps crashing over and over again. I'm using fscanf(); function since the whole .txt file is written in the same format: \"First Name, Last Name\". Now then, I've tried using the for loop in this way: </p>\n\n<pre><code>char *firstName = (char*)malloc(sizeof(char)*10240);\nchar *lastName = (char*)malloc(sizeof(char)*10240);\nfor(int i = 0; i&lt;10; i++){\n    fscanf(fp, \"%s %s\", firstName[i],lastName[i]);\n}\n</code></pre>\n\n<p>And that's where it crashes.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1471443468, "post_id": 38999185, "comment_id": 65350004, "body": "The first argument of <code>strcat</code> point to a buffer with enough space allocated for the result."}, {"owner": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "edited": false, "score": 0, "creation_date": 1471443514, "post_id": 38999185, "comment_id": 65350044, "body": "I have ran it, and it doesn&#39;t crash by me. Why it crashes by you is because you invoked undefined behavior when you didn&#39;t allocate your pointer properly."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471443920, "post_id": 38999185, "comment_id": 65350395, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a Minimal, Complete, and Verifiable example."}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1471443739, "post_id": 38999237, "comment_id": 65350237, "body": "Actually he needs to allocate enough space to store 4 times the <i>maximum</i> name length, as it is picking the random one each time."}, {"owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471446740, "post_id": 38999237, "comment_id": 65352495, "body": "@chux fixed to use <code>calloc</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471446785, "post_id": 38999237, "comment_id": 65352531, "body": "Consider the signature <code>void *calloc(size_t nmemb, size_t size);</code> uses 2 arguments.  suggest <code>sentence = calloc(13, sizeof *sentence);</code>"}], "tags": [], "owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "is_accepted": false, "score": 1, "last_activity_date": 1471447810, "last_edit_date": 1471447810, "creation_date": 1471443468, "answer_id": 38999237, "question_id": 38999185, "link": "https://stackoverflow.com/questions/38999185/c-program-crashes-after-printing-few-lines/38999237#38999237", "title": "C program crashes after printing few lines", "body": "<pre><code>sentence = strdup(\"\");\n</code></pre>\n\n<p>You're only allocating 1 <code>char</code> for <code>sentence</code>. You need to allocate enough memory to store all 3 animal names (13 = 3 times the longest animal name, goat + 1 null character). Also, use <code>calloc</code> to zero out the string.</p>\n\n<pre><code>sentence = calloc(13, sizeof(char));  /* CORRECT */\n</code></pre>\n\n<p>Also, you're not freeing your memory when you are done:</p>\n\n<pre><code>free(sentence);\n</code></pre>\n\n<p>By the way, you should not use <code>void main()</code> as it is not standards compliant. Use <code>int main()</code> instead.</p>\n"}, {"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1471443899, "post_id": 38999355, "comment_id": 65350377, "body": "Undefined behavior since <code>malloc()</code>ed pointer points to array with <i>indeterminate</i> contents. <code>strcat()</code> requires a null-terminated string as argument."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1471443989, "post_id": 38999355, "comment_id": 65350454, "body": "Use <code>calloc</code> instead... Or set the first character to <code>0</code> explicitly."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1471444024, "post_id": 38999355, "comment_id": 65350502, "body": "@EugeneSh. Or just <code>strcpy()</code> instead of the first <code>strcat()</code>."}, {"owner": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1471444450, "post_id": 38999355, "comment_id": 65350847, "body": "@EugeneSh. Is it now better?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1471444964, "post_id": 38999355, "comment_id": 65351236, "body": "Yes, now the behavior is defined."}], "tags": [], "owner": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "is_accepted": true, "score": 2, "last_activity_date": 1471444433, "last_edit_date": 1471444433, "creation_date": 1471443828, "answer_id": 38999355, "question_id": 38999185, "link": "https://stackoverflow.com/questions/38999185/c-program-crashes-after-printing-few-lines/38999355#38999355", "title": "C program crashes after printing few lines", "body": "<p>Your program crashed because <code>sentence</code> didn't have enough memory allocated to store the string.</p>\n\n<pre><code>void main() {\n\n    char *str[] = {\"Dog\", \"Cat\", \"Hen\", \"Goat\"};\n    char *sentence = NULL; //initialize the string\n    int i;\n    srand(time(NULL));\n\n    for(i=0; i&lt;20; i++) {\n        sentence=malloc(13); // longest string would be GoatGoatGoat + terminating null\n        sentence[0]='\\0';\n        strcat(sentence, str[rand()%4]);\n        strcat(sentence, str[rand()%4]);\n        strcat(sentence, str[rand()%4]);\n        printf(\"%s\\n\", sentence);\n        free(sentence); //always free the allocated memory\n    }\n\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449, "user_id": 4670269, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/qAd0C.png?s=128&g=1", "display_name": "Thorham", "link": "https://stackoverflow.com/users/4670269/thorham"}, "is_accepted": false, "score": 0, "last_activity_date": 1471529544, "creation_date": 1471529544, "answer_id": 39020482, "question_id": 38999185, "link": "https://stackoverflow.com/questions/38999185/c-program-crashes-after-printing-few-lines/39020482#39020482", "title": "C program crashes after printing few lines", "body": "<p>In this case it's a bad idea to allocate and free memory in the loop. It's harmless, but it's much better to reuse allocated memory in this case.</p>\n\n<p>You also don't have to use malloc and free, and can instead declare a char array of a fixed length.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n\nint main()\n{\n    char *str[] = {\"Dog\", \"Cat\", \"Hen\", \"Goat\"};\n    char sentence[64];\n    int i;\n\n    srand(time(NULL));\n\n    for(i = 0; i &lt; 20; i++)\n    {\n        strcpy(sentence, str[rand() % 4]);\n        strcat(sentence, str[rand() % 4]);\n        strcat(sentence, str[rand() % 4]);\n        printf(\"%s\\n\", sentence);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 351, "user_id": 4565144, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/fef5bd11b6e3d7749f2ca8ccf1da1f70?s=128&d=identicon&r=PG&f=1", "display_name": "Raees Khan", "link": "https://stackoverflow.com/users/4565144/raees-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 38999355, "answer_count": 3, "score": -1, "last_activity_date": 1471529544, "creation_date": 1471443321, "question_id": 38999185, "link": "https://stackoverflow.com/questions/38999185/c-program-crashes-after-printing-few-lines", "title": "C program crashes after printing few lines", "body": "<p>I have written this piece of code in C, but when I run it, the program crashes after printing few lines. Please solve the problem.</p>\n\n<p><strong>code:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n\n\nvoid main() {\n\n    char *str[] = {\"Dog\", \"Cat\", \"Hen\", \"Goat\"};\n    char *sentence;\n    int i;\n    srand(time(NULL));\n\n    for(i=0; i&lt;20; i++) {\n        sentence = strdup(\"\");\n        strcat(sentence, str[rand()%4]);\n        strcat(sentence, str[rand()%4]);\n        strcat(sentence, str[rand()%4]);\n        printf(\"%s\\n\", sentence);\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1471443089, "post_id": 38999074, "comment_id": 65349718, "body": "So your compiler does not support VLAs (variable-length arrays). BTW, this function does nothing"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471443136, "post_id": 38999074, "comment_id": 65349744, "body": "<code>void main(void)</code> is an invalid signature for <code>main</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471443685, "post_id": 38999074, "comment_id": 65350195, "body": "Use a standard compliant compiler which support VLAs. Or a C99 compiler."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1471446548, "post_id": 38999074, "comment_id": 65352368, "body": "<a href=\"http://tigcc.ticalc.org/\" rel=\"nofollow noreferrer\">TIGCC</a> is supposed to support VLAs according to &quot;<a href=\"http://tigcc.ticalc.org/doc/gnuexts.html#SEC76\" rel=\"nofollow noreferrer\">Arrays of Variable Length</a>&quot;"}], "owner": {"reputation": 21, "user_id": 6726712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25e32e6cb4689c3d90205ace2f5207c0?s=128&d=identicon&r=PG&f=1", "display_name": "Tom55555", "link": "https://stackoverflow.com/users/6726712/tom55555"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "closed_date": 1471443454, "answer_count": 0, "score": 0, "last_activity_date": 1471443044, "creation_date": 1471443044, "question_id": 38999074, "link": "https://stackoverflow.com/questions/38999074/c-for-ti84-constant-integer-expression-expected", "closed_reason": "Duplicate", "title": "c for ti84 Constant integer expression expected", "body": "<p>I'm writing c code for ti84 plus CE calculator because I'd like to use my functions I wrote for my PC on my calculator. I use an online IDE to compile my programs into the .8xp format that my calculator needs.</p>\n\n<p>When I build this function: </p>\n\n<pre><code>void main(void){\n     int x =5;\n     double array[x];\n}\n</code></pre>\n\n<p>I get this error: \"Constant integer expression expected\"</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1471441480, "post_id": 38998407, "comment_id": 65348470, "body": "oh  nice to hear your problem. What shall we do about it?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1471441490, "post_id": 38998407, "comment_id": 65348476, "body": "I&#39;m voting to close this question as off-topic because clearly a write my code request, not a question. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> page first. :)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1471441496, "post_id": 38998407, "comment_id": 65348482, "body": "Please show your research/debugging effort so far. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> page first."}, {"owner": {"reputation": 60, "user_id": 6590194, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qFn43S6ibdA/AAAAAAAAAAI/AAAAAAAAAC4/n0K7SGgk1cc/photo.jpg?sz=128", "display_name": "Yash Gulati", "link": "https://stackoverflow.com/users/6590194/yash-gulati"}, "edited": false, "score": 0, "creation_date": 1471441584, "post_id": 38998407, "comment_id": 65348552, "body": "I am sorry but is there a way to strip off that new line character."}], "answers": [{"comments": [{"owner": {"reputation": 60, "user_id": 6590194, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qFn43S6ibdA/AAAAAAAAAAI/AAAAAAAAAC4/n0K7SGgk1cc/photo.jpg?sz=128", "display_name": "Yash Gulati", "link": "https://stackoverflow.com/users/6590194/yash-gulati"}, "edited": false, "score": 0, "creation_date": 1471442670, "post_id": 38998688, "comment_id": 65349388, "body": "thanks bro. your idea is working and &lt;pre&gt;line[strcspn(line, &quot;\\n&quot;)] = &#39;\\0&#39;;&lt;/pre&gt; is also working."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1471442737, "post_id": 38998688, "comment_id": 65349451, "body": "Would the downvoter care to explain? this method is simple and safe, it removes the linefeed if present and does nothing if there is no linefeed."}, {"owner": {"reputation": 1613, "user_id": 6413048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05e41c326a8c8c6240e3a8b71e806d58?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6413048/tim"}, "edited": false, "score": 0, "creation_date": 1471442968, "post_id": 38998688, "comment_id": 65349623, "body": "This only removes the first occurrence of <code>\\n</code> which is not what OP is asking (even though he uses fgets, the question itself doesn&#39;t say so). The question is about &quot;the end of char *&quot;. The assertion that the first newline is also the last one may be wrong."}, {"owner": {"reputation": 60, "user_id": 6590194, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qFn43S6ibdA/AAAAAAAAAAI/AAAAAAAAAC4/n0K7SGgk1cc/photo.jpg?sz=128", "display_name": "Yash Gulati", "link": "https://stackoverflow.com/users/6590194/yash-gulati"}, "edited": false, "score": 0, "creation_date": 1471442987, "post_id": 38998688, "comment_id": 65349638, "body": "strtok(line, &quot;\\n&quot;); is also working"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 1613, "user_id": 6413048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05e41c326a8c8c6240e3a8b71e806d58?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6413048/tim"}, "edited": false, "score": 2, "creation_date": 1471443767, "post_id": 38998688, "comment_id": 65350251, "body": "@TimF: I&#39;m afraid you are wrong: there can only be one linefeed in the buffer filled by <code>fgets()</code>, and it is necessarily at the end of the string."}, {"owner": {"reputation": 1613, "user_id": 6413048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05e41c326a8c8c6240e3a8b71e806d58?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6413048/tim"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1471444066, "post_id": 38998688, "comment_id": 65350539, "body": "@chqrlie That&#39;s correct but the question is <code>strip new line character from end from char*</code> and not <code>strip new line character from end from char* given by fgets</code>. The fact that OP uses fgets is not in the title. In my opinion the answer must be related to the title more than to the details OP hides here and there in the description of its problem."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 1613, "user_id": 6413048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05e41c326a8c8c6240e3a8b71e806d58?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6413048/tim"}, "edited": false, "score": 1, "creation_date": 1471444138, "post_id": 38998688, "comment_id": 65350597, "body": "@TimF: come on, the context of the question is unambiguous: <i>I have a <code>char* line</code> on which I used <code>while (fgets(line, line_size, fNames) != NULL)</code>. now the problem is I also get a new line character, which I want to strip.</i>  The question is more general and poorly expressed, but your downvote is excessive.  Mirakurun should have given an explanation, but his answer is correct."}, {"owner": {"reputation": 1613, "user_id": 6413048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05e41c326a8c8c6240e3a8b71e806d58?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6413048/tim"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1471444296, "post_id": 38998688, "comment_id": 65350741, "body": "@chqrlie I won&#39;t say it&#39;s 100% crystal clear nor that it&#39;s unambiguous, but if someone is looking how to remove the newline from the end of a char and find this question (because it does match the title) the person could be disappointed to see the FIRST newline replaced instead of the last (i.e. <code>at the END of char *</code> )"}, {"owner": {"reputation": 1613, "user_id": 6413048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05e41c326a8c8c6240e3a8b71e806d58?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6413048/tim"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1471444436, "post_id": 38998688, "comment_id": 65350834, "body": "@chqrlie And to be fair, I just upvoted your solution because of the last one, since looking for the newline from the end of the char* and not from the beginning is indeed the/a correct answer."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 1613, "user_id": 6413048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05e41c326a8c8c6240e3a8b71e806d58?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6413048/tim"}, "edited": false, "score": 1, "creation_date": 1471444455, "post_id": 38998688, "comment_id": 65350849, "body": "@TimF: I understand your reasoning, but anybody copying code from an answer without some understanding of the context is up for worse disappointments."}, {"owner": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1471444752, "post_id": 38998688, "comment_id": 65351090, "body": "@chqrlie  Well guys, when I answered this question, it didn&#39;t even have the code in it. Look at the edits and find the first version of this question. I wrote it quickly just to give the OP an answer before the question gets closed, so he can continue with his work. There are a lot of people here who would rather vote to close the question than to answer, so I just wanted to help the OP. I voted up your answer chqrlie, it&#39;s very good. All the best!"}], "tags": [], "owner": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "is_accepted": true, "score": 1, "last_activity_date": 1471442025, "creation_date": 1471442025, "answer_id": 38998688, "question_id": 38998407, "link": "https://stackoverflow.com/questions/38998407/strip-new-line-character-from-end-from-char/38998688#38998688", "title": "strip new line character from end from char*", "body": "<p>I think you are searching for this one. It is very easy to use and it does the job.</p>\n\n<pre><code>line[strcspn(line, \"\\n\")] = '\\0';\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 3, "last_activity_date": 1471444558, "last_edit_date": 1471444558, "creation_date": 1471443692, "answer_id": 38999308, "question_id": 38998407, "link": "https://stackoverflow.com/questions/38998407/strip-new-line-character-from-end-from-char/38999308#38999308", "title": "strip new line character from end from char*", "body": "<p>There are problems in your code:</p>\n\n<ul>\n<li><p>You do not check the return value of <code>fopen()</code>, nor that of <code>malloc()</code>.</p></li>\n<li><p><code>strcpy(command, strcat(command,\" -o\"));</code> and <code>strcpy(line, strcat(line, \".lst\"));</code> invoke undefined behavior as you call <code>strcpy</code> on overlapping strings.</p></li>\n<li><p><code>strcpy(command, line);</code> overwrites the string you just copied to <code>command</code> with <code>strcpy(command, \"crunch 8 8 -t \");</code>.</p></li>\n<li><p>You do not check the lengths before copying or concatenating strings into <code>line</code> and <code>command</code>.  You should use <code>snprintf()</code> for both a safer and simpler method.</p></li>\n</ul>\n\n<p>To get rid of the trailing linefeed in <code>line</code> left by <code>fgets()</code>, you can either write:</p>\n\n<pre><code>line[strcspn(line, \"\\n\")] = '\\0';\n</code></pre>\n\n<p>or you can write this:</p>\n\n<pre><code>char *p = strchr(line, '\\n');\nif (p != NULL)\n    *p = '\\0';\n</code></pre>\n\n<p>or even this one that <em>removes the linefeed at the end of the string</em>:</p>\n\n<pre><code>size_t len = strlen(line);\nif (len &gt; 0 &amp;&amp; line[len - 1] == '\\n')\n    line[--len] = '\\0';\n</code></pre>\n\n<p>With both of the latter methods, you can track whether there was indeed a linefeed or not.  The absence of a linefeed at the end of the line can mean one of several possibilities:</p>\n\n<ul>\n<li><p>The line was truncated because it does not fit in the buffer provided.  You should be careful to handle this condition because the string read does not correspond to the actual file contents. It could happen in your case if a filename is longer than 298 bytes, which is possible on many modern file systems.</p></li>\n<li><p>The end of file was reached but no linefeed is present in the file at the end of the last line.  This is probably not an error, but could indicate that the input file was truncated somehow.</p></li>\n<li><p>The input file contains a <code>'\\0'</code> byte, which causes early termination of the line read by <code>fgets()</code>. This would not be allowed as part of a filename and is quite unlikely to occur in text files, unless the file was encoded as ucs2 or UTF-16.</p></li>\n</ul>\n"}], "owner": {"reputation": 60, "user_id": 6590194, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qFn43S6ibdA/AAAAAAAAAAI/AAAAAAAAAC4/n0K7SGgk1cc/photo.jpg?sz=128", "display_name": "Yash Gulati", "link": "https://stackoverflow.com/users/6590194/yash-gulati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 922, "favorite_count": 0, "closed_date": 1471443844, "accepted_answer_id": 38998688, "answer_count": 2, "score": 0, "last_activity_date": 1471444558, "creation_date": 1471441418, "last_edit_date": 1471442922, "question_id": 38998407, "link": "https://stackoverflow.com/questions/38998407/strip-new-line-character-from-end-from-char", "closed_reason": "Duplicate", "title": "strip new line character from end from char*", "body": "<p>I have a <code>char* line</code> on which I used <code>while (fgets(line, line_size, fNames) != NULL)</code>. now the problem is I also get a new line character, which I want to strip.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    int i;\n    char fileName[30];\n    FILE *fNames, *fCurrent;\n    char *line = NULL, command[100];\n    char letters3[3];\n    size_t len = 0;\n    //size_t read;\n    const size_t line_size = 300;\n    line = malloc(line_size);\n    if (access(\"fileNames.lst\", F_OK) == -1)\n        system(\"crunch 3 3 abcd -o fileNames.lst\");\n    else\n        printf(\"fileNames.lst already exists.\\n\");\n    fNames = fopen(\"./fileNames.lst\",\"r\");\n\n    while (fgets(line, line_size, fNames) != NULL) {\n        printf(\"Making File: %s.lst\\n\", line);\n        strcpy(command, \"crunch 8 8 -t \");\n        strcpy(command, line);\n        strcpy(command, strcat(command,\" -o\"));\n        puts(command);\n        strcpy(line, strcat(line, \".lst\"));\n        fCurrent = fopen(line, \"w\");\n        //system(command);\n        fclose(fCurrent);\n        //system(\"read -r -p \\\"Press space to continue...\\\" key\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arduino"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1471441589, "post_id": 38998398, "comment_id": 65348556, "body": "<code>void closeapp {</code> --&gt; <code>void closeapp (void) {</code> and <code>closeapp;</code> --&gt; <code>closeapp();</code> VTC as minor."}], "answers": [{"comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471445131, "post_id": 38999780, "comment_id": 65351374, "body": "Even then, the compiler will probably complain about not having a visible declaration of <code>closeapp()</code> at the time it is called from <code>setup()</code>."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471445391, "post_id": 38999780, "comment_id": 65351556, "body": "Your pre-edit version was better. The result of writing <code>closeapp;</code> is <i>syntactically</i> valid but not <b>semantically</b> valid, i.e. it&#39;s clearly not what the OP wants. It maps to a no-op evaluation of the address of the function. Also, further to my point about the visible declaration, it gets worse: the compiler might error out, <b>or</b> it might just warn (if you have warnings on, which we all do, right?) that it&#39;s going to use a different, assumed signature - which will lead to undefined behaviour if it mismatches... as it probably will."}, {"owner": {"reputation": 1998, "user_id": 772992, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/f4Gy4.jpg?s=128&g=1", "display_name": "hradecek", "link": "https://stackoverflow.com/users/772992/hradecek"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471445712, "post_id": 38999780, "comment_id": 65351767, "body": "Yup, I was editing at the time. Well, I also assume that compiler removes and optimize closeapp; statement by default, as you said it&#39;s noop.  Just to be precise: I meant it is not syntactically valid <b>function call</b>, but it&#39;s true that it is syntactically valid statement."}], "tags": [], "owner": {"reputation": 1998, "user_id": 772992, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/f4Gy4.jpg?s=128&g=1", "display_name": "hradecek", "link": "https://stackoverflow.com/users/772992/hradecek"}, "is_accepted": false, "score": 1, "last_activity_date": 1471445805, "last_edit_date": 1471445805, "creation_date": 1471445004, "answer_id": 38999780, "question_id": 38998398, "link": "https://stackoverflow.com/questions/38998398/closeapp-was-not-declared-in-this-scope/38999780#38999780", "title": "&#39;closeapp&#39; was not declared in this scope", "body": "<p>Function <code>closeapp</code> is not syntactically valid in C language.\nIt should be something like:</p>\n\n<pre><code>void closeapp()\n{\n  cmd(KEY_Q);\n}\n</code></pre>\n\n<p>Moreover function call should be something like:</p>\n\n<pre><code>closeapp();\n</code></pre>\n\n<p>to be syntactically valid.</p>\n\n<p>The last point is, that you shouldn't call function before its implementation. It means either you will provide prototype or put its definition before it's really called.</p>\n\n<p>EDIT FYI: Statement <code>closeapp;</code> is syntactically valid, but it is empty instruction just like <code>42;</code>. Literally it is the address of <code>closeapp</code> function, so basically just a number.</p>\n"}], "owner": {"reputation": 9, "user_id": 6726605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c6b04dbdf75b083adddbe4db8b73029?s=128&d=identicon&r=PG&f=1", "display_name": "M. Heisy", "link": "https://stackoverflow.com/users/6726605/m-heisy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1471445805, "creation_date": 1471441388, "question_id": 38998398, "link": "https://stackoverflow.com/questions/38998398/closeapp-was-not-declared-in-this-scope", "title": "&#39;closeapp&#39; was not declared in this scope", "body": "<p>Hello i change the usbdriveby project.\nIt is just to just the keyboard for fun\nThe error message app :'closeapp' was not declared in this scope.\nHere is the code : </p>\n\n<pre><code>#if defined(CORE_TEENSY)\n#define LED_PIN 11\n#else\n#define LED_PIN 13\n#endif\nvoid setup() {\ndelay(800);\n\n  openapp(\"Terminal\");\n  typeln(\"screen -S SYSTEMUpdater\");\n  typeln(\"say dont use unknown usb sticks because its not safe.\");\n  closeapp;\n}\nvoid openapp(String app)\n{\n  cmd(KEY_SPACE);\n  typeln(app);\n}\nvoid typeln(String chars)\n{\n  Keyboard.print(chars);\n  delay(ds);\n  Keyboard.println(\"\");\n  delay(ds * 4);\n}\nvoid closeapp\n{\n  cmd(KEY_Q);\n}\nvoid k(int key)\n{\n  Keyboard.set_key1(key);\n  Keyboard.send_now();\n  delay(ds/2);\n\n  Keyboard.set_key1(0);\n  Keyboard.send_now();\n  delay(ds/2);\n}\n\nvoid mod(int mod, int key)\n{\n  Keyboard.set_modifier(mod);\n  Keyboard.send_now();\n  Keyboard.set_key1(key);\n  Keyboard.send_now();\n  delay(ds);\n\n  Keyboard.set_modifier(0);\n  Keyboard.set_key1(0);\n  Keyboard.send_now();\n  delay(ds);\n}\n\nvoid ctrl(int key)\n{\n  mod(MODIFIERKEY_CTRL, key);\n}\n\nvoid cmd(int key)\n{\n  mod(MODIFIERKEY_GUI, key);\n}\n\nvoid shift(int key)\n{\n  mod(MODIFIERKEY_SHIFT, key);\n}\n\nvoid loop()\n{\n  digitalWrite(LED_PIN, HIGH);\n  delay(ds/2);\n  digitalWrite(LED_PIN, LOW);\n  delay(ds/2);\n}\n</code></pre>\n\n<p>I searched for the same error but I am pretty sure that  I made an error in the writing.</p>\n"}, {"tags": ["c", "pointers", "memory", "fortran", "fortran-iso-c-binding"], "comments": [{"owner": {"reputation": 9152, "user_id": 1655144, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cbea8e47dae48820261dc2a291f44907?s=128&d=identicon&r=PG", "display_name": "Douglas B. Staple", "link": "https://stackoverflow.com/users/1655144/douglas-b-staple"}, "edited": false, "score": 3, "creation_date": 1471443179, "post_id": 38998241, "comment_id": 65349764, "body": "What mechanism is provided by cJSON for free the memory, if the program were completely written in C?  Considering that you have no explicit malloc, I think whatever memory leak you have is occurring due to memory allocated by cJSON, no?  If this is the case, I would think your <code>c_mem_free</code> should also use whatever mechanism is provided by cJSON.  One troubleshooting step would be to write a small program with such a cJSON allocation in a loop, and to try to demonstrate the memory leak, first with the entire program in C, and then with C+Fortran."}, {"owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "edited": false, "score": 0, "creation_date": 1471447159, "post_id": 38998241, "comment_id": 65352807, "body": "I think a json tag should by added. I don&#39;t know which one, so I am not going to do that."}, {"owner": {"reputation": 59, "user_id": 5823100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce243655c0db18c28883ee24c10d1ffa?s=128&d=identicon&r=PG&f=1", "display_name": "byrdman1982", "link": "https://stackoverflow.com/users/5823100/byrdman1982"}, "reply_to_user": {"reputation": 9152, "user_id": 1655144, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cbea8e47dae48820261dc2a291f44907?s=128&d=identicon&r=PG", "display_name": "Douglas B. Staple", "link": "https://stackoverflow.com/users/1655144/douglas-b-staple"}, "edited": false, "score": 0, "creation_date": 1471454407, "post_id": 38998241, "comment_id": 65357082, "body": "@DouglasB.Staple <code>for ( a = 1; a &lt; 1000000; a = a + 1 ){   cJSON * nml = getnml (my_json_string, nml_name , var_name);   svalue = cJSON_GetObjectItem(nml,var_name)-&gt;valuestring; &#47;&#47; Find the string value   free (nml);   free (svalue);   if (a % 10000 == 0) {printf(&quot;a &#47;n&quot;);}</code> That produces no leak.  The memory stays about the same.  Without free (svalue) the memory used goes way up.   cJSON does have a cJSON_free that just uses free."}, {"owner": {"reputation": 6827, "user_id": 3501546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zzZH7.jpg?s=128&g=1", "display_name": "roygvib", "link": "https://stackoverflow.com/users/3501546/roygvib"}, "edited": false, "score": 0, "creation_date": 1471460738, "post_id": 38998241, "comment_id": 65360531, "body": "cJSON seems to be here <a href=\"https://github.com/DaveGamble/cJSON\" rel=\"nofollow noreferrer\">github.com/DaveGamble/cJSON</a> and it has <a href=\"https://github.com/DaveGamble/cJSON/blob/master/cJSON.c#L80\" rel=\"nofollow noreferrer\">cJSON_Delete</a> but I couldn&#39;t find getnml(). Is this a wrapper for reading Fortran namelist (in which cJSON is created)?"}, {"owner": {"reputation": 59, "user_id": 5823100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce243655c0db18c28883ee24c10d1ffa?s=128&d=identicon&r=PG&f=1", "display_name": "byrdman1982", "link": "https://stackoverflow.com/users/5823100/byrdman1982"}, "reply_to_user": {"reputation": 6827, "user_id": 3501546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zzZH7.jpg?s=128&g=1", "display_name": "roygvib", "link": "https://stackoverflow.com/users/3501546/roygvib"}, "edited": false, "score": 0, "creation_date": 1471519886, "post_id": 38998241, "comment_id": 65384483, "body": "@roygvib It is a wrapper.  The fortran namelist is converted to json, then cJSON is used to get the values of the variables."}, {"owner": {"reputation": 149, "user_id": 4577175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4091facbb309197b70f449660928ce?s=128&d=identicon&r=PG&f=1", "display_name": "Time Laird", "link": "https://stackoverflow.com/users/4577175/time-laird"}, "edited": false, "score": 0, "creation_date": 1471526579, "post_id": 38998241, "comment_id": 65389118, "body": "If you wanted to avoid C altogether, <a href=\"https://github.com/jacobwilliams/json-fortran\" rel=\"nofollow noreferrer\">JSON-Fortran</a> is an option."}, {"owner": {"reputation": 59, "user_id": 5823100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce243655c0db18c28883ee24c10d1ffa?s=128&d=identicon&r=PG&f=1", "display_name": "byrdman1982", "link": "https://stackoverflow.com/users/5823100/byrdman1982"}, "reply_to_user": {"reputation": 149, "user_id": 4577175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4091facbb309197b70f449660928ce?s=128&d=identicon&r=PG&f=1", "display_name": "Time Laird", "link": "https://stackoverflow.com/users/4577175/time-laird"}, "edited": false, "score": 0, "creation_date": 1471543756, "post_id": 38998241, "comment_id": 65400480, "body": "@TimeLaird The JSON needs to be read and parsed in C for use in Fortran.   That&#39;s the nature of the project."}, {"owner": {"reputation": 6827, "user_id": 3501546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zzZH7.jpg?s=128&g=1", "display_name": "roygvib", "link": "https://stackoverflow.com/users/3501546/roygvib"}, "edited": false, "score": 0, "creation_date": 1471547236, "post_id": 38998241, "comment_id": 65402316, "body": "Is there any possibility that getnml() creates a lot of redundant cJSON objects for a single namelist file? Also, cJSON_Print() might need manual deallocation of the returned char string (according to <a href=\"https://github.com/DaveGamble/cJSON/blob/master/cJSON.h#L69\" rel=\"nofollow noreferrer\">the comment</a> in the header file)."}, {"owner": {"reputation": 59, "user_id": 5823100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce243655c0db18c28883ee24c10d1ffa?s=128&d=identicon&r=PG&f=1", "display_name": "byrdman1982", "link": "https://stackoverflow.com/users/5823100/byrdman1982"}, "reply_to_user": {"reputation": 6827, "user_id": 3501546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zzZH7.jpg?s=128&g=1", "display_name": "roygvib", "link": "https://stackoverflow.com/users/3501546/roygvib"}, "edited": false, "score": 0, "creation_date": 1471616099, "post_id": 38998241, "comment_id": 65432030, "body": "@roygvib 1. Yes.  I started parsing the json in each individual function and using cJSON_Delete(nml) and that worked in my integer and double functions which look more like this  <code>int i = cJSON_GetObjectItem(nml,var_name)-&gt;valueint;</code>  Using cJSON_Delete does not work in the function where a string pointer is returned because everything is freed and the pointer points to nothing.  I think I have to be more creative."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 5823100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce243655c0db18c28883ee24c10d1ffa?s=128&d=identicon&r=PG&f=1", "display_name": "byrdman1982", "link": "https://stackoverflow.com/users/5823100/byrdman1982"}, "edited": false, "score": 0, "creation_date": 1471615941, "post_id": 39013057, "comment_id": 65431923, "body": "using cJSON_Delete works in my functions for doubles and integers, but if I use it in my string functions, I end up with empty strings because the string is passed as a pointer."}, {"owner": {"reputation": 1450, "user_id": 2675420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80b7ab9edd5bc4d75452f22fd0f0991b?s=128&d=identicon&r=PG", "display_name": "Jauch", "link": "https://stackoverflow.com/users/2675420/jauch"}, "reply_to_user": {"reputation": 59, "user_id": 5823100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce243655c0db18c28883ee24c10d1ffa?s=128&d=identicon&r=PG&f=1", "display_name": "byrdman1982", "link": "https://stackoverflow.com/users/5823100/byrdman1982"}, "edited": false, "score": 1, "creation_date": 1471616658, "post_id": 39013057, "comment_id": 65432409, "body": "@byrdman1982, this is the expected behavior as they are pointers. If you need to keep the string after reading it from the JSON structure, you should copy it to a string. The question I keep asking myself is why do you need to free immediately? By definition, a memory leak is a problem in code that cause allocated memory to become inaccessible due to a pointer (for example) going out of scope. Are you sure that is cJSON that is doing this?"}, {"owner": {"reputation": 1450, "user_id": 2675420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80b7ab9edd5bc4d75452f22fd0f0991b?s=128&d=identicon&r=PG", "display_name": "Jauch", "link": "https://stackoverflow.com/users/2675420/jauch"}, "reply_to_user": {"reputation": 59, "user_id": 5823100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce243655c0db18c28883ee24c10d1ffa?s=128&d=identicon&r=PG&f=1", "display_name": "byrdman1982", "link": "https://stackoverflow.com/users/5823100/byrdman1982"}, "edited": false, "score": 0, "creation_date": 1471616718, "post_id": 39013057, "comment_id": 65432454, "body": "What exactly is you seeing that you think you have a memory leak?"}], "tags": [], "owner": {"reputation": 1450, "user_id": 2675420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80b7ab9edd5bc4d75452f22fd0f0991b?s=128&d=identicon&r=PG", "display_name": "Jauch", "link": "https://stackoverflow.com/users/2675420/jauch"}, "is_accepted": false, "score": 1, "last_activity_date": 1471508026, "creation_date": 1471508026, "answer_id": 39013057, "question_id": 38998241, "link": "https://stackoverflow.com/questions/38998241/freeing-a-c-pointer-returned-by-a-c-function-to-fortran/39013057#39013057", "title": "Freeing a C pointer returned by a C function to Fortran?", "body": "<p>As a thumbs up rule, you shouldn't \"free\" memory allocated outside your code. \nAnd this is true with cJSON.</p>\n\n<p>Once you parse the object, the tree is construct in memory and you can reach the objects, its values, change it, etc.</p>\n\n<p>After you finish the processing of your file, you can free the memory calling <strong><em>cJSON_Delete(root);</em></strong></p>\n\n<p>This routine will take care of everything for you.</p>\n\n<p>If you want to free objects/nodes as you use them, you can use also <strong><em>cJSON_Delete(node);</em></strong>\nJust remember that this routine is \"recoursive\". So, if you free a node, it will free all the children AND the siblings too, as you can see by the code here:</p>\n\n<pre><code>/* Delete a cJSON structure. */\nvoid cJSON_Delete(cJSON *c)\n{\n    cJSON *next;\n    while (c)\n    {\n        next=c-&gt;next;\n        if (!(c-&gt;type&amp;cJSON_IsReference) &amp;&amp; c-&gt;child) cJSON_Delete(c-&gt;child);\n        if (!(c-&gt;type&amp;cJSON_IsReference) &amp;&amp; c-&gt;valuestring) cJSON_free(c-&gt;valuestring);\n        if (!(c-&gt;type&amp;cJSON_StringIsConst) &amp;&amp; c-&gt;string) cJSON_free(c-&gt;string);\n        cJSON_free(c);\n        c=next;\n    }\n}\n</code></pre>\n\n<p>DON'T use <strong><em>cJSON_Free</em></strong>, as cJSON_Delete will take care of everything, while cJSON_free must be applied to the internal elements of the structure before freeing the structure itself, otherwise you will have a memory leak.</p>\n"}], "owner": {"reputation": 59, "user_id": 5823100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce243655c0db18c28883ee24c10d1ffa?s=128&d=identicon&r=PG&f=1", "display_name": "byrdman1982", "link": "https://stackoverflow.com/users/5823100/byrdman1982"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1471508026, "creation_date": 1471441006, "last_edit_date": 1471441887, "question_id": 38998241, "link": "https://stackoverflow.com/questions/38998241/freeing-a-c-pointer-returned-by-a-c-function-to-fortran", "title": "Freeing a C pointer returned by a C function to Fortran?", "body": "<p>I have a function that returns a char * pointer in C that looks like this</p>\n\n<pre><code>char * string_val (ARGS)\n{\n char * svalue = cJSON_GetObjectItem(nml,var_name)-&gt;valuestring;\n return svalue;\n}\n</code></pre>\n\n<p>In Fortran, I assign this to a C pointer (Using iso_c_binding)</p>\n\n<pre><code>type (c_ptr) :: C_String_ptr\n...\nC_String_ptr = string_val (ARGS)\n</code></pre>\n\n<p>This part works great. \u00a0The string_val function gets called a lot, and I think it's causing a memory leak. \u00a0I am trying to free the memory of the svalue pointer, but I have just run into seg faults and memory dumps. \u00a0I currently have something like this:</p>\n\n<pre><code>     subroutine c_mem_free (cptr) bind(C,name=\"c_mem_free\")\n      use iso_c_binding\n      type (c_ptr)   :: cptr   !&lt; The C pointer whose memory needs to be freed\n     end subroutine\n...\n call c_mem_free(C_String_ptr)\n</code></pre>\n\n<p>where</p>\n\n<pre><code> void c_mem_free (void** addrOfptr)\n{\n  free(*addrOfptr);    /* free the memory pointed to */\n  *addrOfptr=NULL;     /* Nullify the pointer ;) */\n}\n</code></pre>\n\n<p>The traceback points to a problem on the free line. \u00a0I also tried passing changing cptr to value so \n<code>type (c_ptr),VALUE   :: cptr</code>\nand having <code>void*addrOfptr</code> and <code>free(addrOfptr)</code> on the C side, but that didn't seem to work either.  I've also been unsuccessful in finding the memory location of svalue on the Fortran side.  If I use something like</p>\n\n<p><code>write (6,'(z)')loc(C_String_ptr) \n write (6,'(z)')loc(c_loc(C_String_ptr))</code></p>\n\n<p>neither of these gives me the same value as when I printf the location of the memory of svalue.\nHow can I free the memory of the pointer svalue after it's been returned in Fortran?  How can I get the location of the svalue memory in Fortran?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1471440700, "post_id": 38997919, "comment_id": 65347839, "body": "Google &quot;C11 draft&quot; then check 7.1.3. The C standard and POSIX may not necessarily agree."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1471441251, "post_id": 38998123, "comment_id": 65348299, "body": "What is 9899:201x supposed to mean? Why not 2011?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1471442624, "post_id": 38998123, "comment_id": 65349353, "body": "I wasn&#39;t sure if you were referring to something weird like INCITS/ISO 9899-2012... which is the very same C11 standard. When quoting a draft you should probably use the draft name N1570 or some such. Anyway, I have the official ISO 2011 standard and it is identical to the draft in everything that matters. So you can confidently refer to 9899:2011 even if you only have the draft."}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": true, "score": 4, "last_activity_date": 1471441471, "last_edit_date": 1471441471, "creation_date": 1471440677, "answer_id": 38998123, "question_id": 38997919, "link": "https://stackoverflow.com/questions/38997919/is-it-permissible-for-global-static-identifiers-to-begin-with-a-single/38998123#38998123", "title": "Is it permissible for global, static identifiers to begin with a single _?", "body": "<p>Standards reserves prefixes with an underscore<sup>1</sup>.</p>\n\n<hr>\n\n<p><sup>1</sup> (Quoted from: <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow\">ISO/IEC 9899:201x</a> 7.1.3 Reserved identifiers 1)<br>\nAll identifiers that begin with an underscore and either an uppercase letter or another\nunderscore are always reserved for any use.<br>\nAll identifiers that begin with an underscore are always reserved for use as identifiers\nwith file scope in both the ordinary and tag name spaces.</p>\n"}, {"tags": [], "owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "is_accepted": false, "score": 2, "last_activity_date": 1471440688, "creation_date": 1471440688, "answer_id": 38998129, "question_id": 38997919, "link": "https://stackoverflow.com/questions/38997919/is-it-permissible-for-global-static-identifiers-to-begin-with-a-single/38998129#38998129", "title": "Is it permissible for global, static identifiers to begin with a single _?", "body": "<p>It is not safe. Depending on architecture your code may require some relocations even for <code>static</code> objects. As result their names must be visible to linker as well as names of CRT symbols. And this may cause clashes.</p>\n"}], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 1, "accepted_answer_id": 38998123, "answer_count": 2, "score": 9, "last_activity_date": 1471441471, "creation_date": 1471440129, "question_id": 38997919, "link": "https://stackoverflow.com/questions/38997919/is-it-permissible-for-global-static-identifiers-to-begin-with-a-single", "title": "Is it permissible for global, static identifiers to begin with a single _?", "body": "<p>In other words, may <strong>static</strong> (=file-scoped) globals begin with exactly one underscore without creating the possibility of nameclashes with the C implementation?</p>\n\n<p><a href=\"https://www.gnu.org/software/libc/manual/html_node/Reserved-Names.html\">https://www.gnu.org/software/libc/manual/html_node/Reserved-Names.html</a>\nsays that \"... reserved names include all <strong>external</strong> identifiers (global functions and variables) that begin with an underscore (\u2018_\u2019) ...\" (emphasis mine).</p>\n\n<p>I've noticed the Linux kernel starts functions that probably shouldn't be called directly with double underscores.</p>\n\n<p>I find this concept useful, and I find <code>_(_)something</code> slightly easier to read than <code>something_</code> when it comes to distinguishing \"private\" identifiers, but I understand (?) double underscore invite name clashes with the C implementation.</p>\n\n<p>Are global, <strong>static</strong> <code>_variables</code> and <code>_functions</code> safe?</p>\n"}, {"tags": ["python", "c++", "c", "dll"], "comments": [{"owner": {"reputation": 21133, "user_id": 1084416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/RLhZZ.jpg?s=128&g=1", "display_name": "Peter Wood", "link": "https://stackoverflow.com/users/1084416/peter-wood"}, "edited": false, "score": 0, "creation_date": 1471442263, "post_id": 38997898, "comment_id": 65349026, "body": "How do you know it didn&#39;t work?"}, {"owner": {"reputation": 399, "user_id": 2842632, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1195066737/picture?type=large", "display_name": "Ori Frish", "link": "https://stackoverflow.com/users/2842632/ori-frish"}, "reply_to_user": {"reputation": 21133, "user_id": 1084416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/RLhZZ.jpg?s=128&g=1", "display_name": "Peter Wood", "link": "https://stackoverflow.com/users/1084416/peter-wood"}, "edited": false, "score": 0, "creation_date": 1471442416, "post_id": 38997898, "comment_id": 65349169, "body": "I tried activating it the same way above as the tutorial, just replacing the name with a signature from the exports, and I still received an error from python log, says it can&#39;t call the function, &#39;tuple&#39; something...  I&#39;m not working on the same computer I&#39;m typing it, so it&#39;s all from memory, if you need any specific data, tell me"}, {"owner": {"reputation": 21133, "user_id": 1084416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/RLhZZ.jpg?s=128&g=1", "display_name": "Peter Wood", "link": "https://stackoverflow.com/users/1084416/peter-wood"}, "edited": false, "score": 0, "creation_date": 1471442589, "post_id": 38997898, "comment_id": 65349320, "body": "I think we need details; we&#39;re troubleshooting here."}, {"owner": {"reputation": 21133, "user_id": 1084416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/RLhZZ.jpg?s=128&g=1", "display_name": "Peter Wood", "link": "https://stackoverflow.com/users/1084416/peter-wood"}, "edited": false, "score": 0, "creation_date": 1471442771, "post_id": 38997898, "comment_id": 65349478, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1076300/extending-python-with-c-c\">Extending Python with C/C++</a>"}, {"owner": {"reputation": 399, "user_id": 2842632, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1195066737/picture?type=large", "display_name": "Ori Frish", "link": "https://stackoverflow.com/users/2842632/ori-frish"}, "reply_to_user": {"reputation": 21133, "user_id": 1084416, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/RLhZZ.jpg?s=128&g=1", "display_name": "Peter Wood", "link": "https://stackoverflow.com/users/1084416/peter-wood"}, "edited": false, "score": 0, "creation_date": 1471444545, "post_id": 38997898, "comment_id": 65350931, "body": "I saw a tool called SWIG, can it do what I need? to call methods from an object reference"}], "answers": [{"comments": [{"owner": {"reputation": 399, "user_id": 2842632, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1195066737/picture?type=large", "display_name": "Ori Frish", "link": "https://stackoverflow.com/users/2842632/ori-frish"}, "edited": false, "score": 0, "creation_date": 1471443002, "post_id": 38998526, "comment_id": 65349649, "body": "Is there any solution for calling methods in DLLs?"}, {"owner": {"reputation": 5207, "user_id": 6582873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aEx7y.jpg?s=128&g=1", "display_name": "napuzba", "link": "https://stackoverflow.com/users/6582873/napuzba"}, "reply_to_user": {"reputation": 399, "user_id": 2842632, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1195066737/picture?type=large", "display_name": "Ori Frish", "link": "https://stackoverflow.com/users/2842632/ori-frish"}, "edited": false, "score": 0, "creation_date": 1471443671, "post_id": 38998526, "comment_id": 65350184, "body": "You can wrap the methods calls with plain c functions calls or use the tools in the answer."}, {"owner": {"reputation": 399, "user_id": 2842632, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1195066737/picture?type=large", "display_name": "Ori Frish", "link": "https://stackoverflow.com/users/2842632/ori-frish"}, "edited": false, "score": 0, "creation_date": 1471443906, "post_id": 38998526, "comment_id": 65350385, "body": "thought about that one.. I also saw a tool called SWIG, can it do what I need? to call methods from an object reference"}, {"owner": {"reputation": 5207, "user_id": 6582873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aEx7y.jpg?s=128&g=1", "display_name": "napuzba", "link": "https://stackoverflow.com/users/6582873/napuzba"}, "reply_to_user": {"reputation": 399, "user_id": 2842632, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1195066737/picture?type=large", "display_name": "Ori Frish", "link": "https://stackoverflow.com/users/2842632/ori-frish"}, "edited": false, "score": 0, "creation_date": 1471446866, "post_id": 38998526, "comment_id": 65352587, "body": "Unlike <code>ctypes</code> which loads the DLL and call its functions in runtime - with those tools you create a new DLL which wraps the methods. you will be able to use the new DLL from python."}], "tags": [], "owner": {"reputation": 5207, "user_id": 6582873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aEx7y.jpg?s=128&g=1", "display_name": "napuzba", "link": "https://stackoverflow.com/users/6582873/napuzba"}, "is_accepted": false, "score": 0, "last_activity_date": 1471444312, "last_edit_date": 1471444312, "creation_date": 1471441695, "answer_id": 38998526, "question_id": 38997898, "link": "https://stackoverflow.com/questions/38997898/calling-methods-from-c-c-dll-with-python/38998526#38998526", "title": "Calling methods from C/C++ DLL with Python", "body": "<p>Unfortunately, you can not do that easily and in portable way with <code>ctypes</code>.</p>\n\n<p><code>ctypes</code> is designed to call <strong>functions</strong> in DLLs with <strong>C compatible data</strong> types. </p>\n\n<p>Since there is no <a href=\"https://en.wikipedia.org/wiki/Application_binary_interface\" rel=\"nofollow\">standard binary interface</a> for C++, you should know how the compiler which generates the DLL, generates the code (i.e class layout ... ).</p>\n\n<p>A better solution is to create a new DLL which uses the current DLL and wraps the methods as plain c functions. See <a href=\"http://www.boost.org/doc/libs/1_61_0/libs/python/doc/html/index.html\" rel=\"nofollow\">boost.python</a> or <a href=\"http://www.swig.org/\" rel=\"nofollow\">SWIG</a> for more details.</p>\n"}], "owner": {"reputation": 399, "user_id": 2842632, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1195066737/picture?type=large", "display_name": "Ori Frish", "link": "https://stackoverflow.com/users/2842632/ori-frish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2485, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1471444312, "creation_date": 1471440057, "question_id": 38997898, "link": "https://stackoverflow.com/questions/38997898/calling-methods-from-c-c-dll-with-python", "title": "Calling methods from C/C++ DLL with Python", "body": "<p>I do have a tutorial here about calling functions from a c/c++ dll, the example is written here from the <a href=\"https://docs.python.org/3.3/library/ctypes.html#function-prototypes\" rel=\"nofollow\">official tutorial</a>.</p>\n\n<pre><code>WINUSERAPI int WINAPI\nMessageBoxA(\n    HWND hWnd,\n    LPCSTR lpText,\n    LPCSTR lpCaption,\n    UINT uType);\n\nHere is the wrapping with ctypes:\n\n&gt;&gt;&gt;\n&gt;&gt;&gt; from ctypes import c_int, WINFUNCTYPE, windll\n&gt;&gt;&gt; from ctypes.wintypes import HWND, LPCSTR, UINT\n&gt;&gt;&gt; prototype = WINFUNCTYPE(c_int, HWND, LPCSTR, LPCSTR, UINT)\n&gt;&gt;&gt; paramflags = (1, \"hwnd\", 0), (1, \"text\", \"Hi\"), (1, \"caption\", None), (1, \"flags\", 0)\n&gt;&gt;&gt; MessageBox = prototype((\"MessageBoxA\", windll.user32), paramflags)\n&gt;&gt;&gt;\nThe MessageBox foreign function can now be called in these ways:\n\n&gt;&gt;&gt;\n&gt;&gt;&gt; MessageBox()\n&gt;&gt;&gt; MessageBox(text=\"Spam, spam, spam\")\n&gt;&gt;&gt; MessageBox(flags=2, text=\"foo bar\")\n&gt;&gt;&gt;\nA second example demonstrates output parameters. The win32 GetWindowRect function retrieves the dimensions of a specified window by copying them into RECT structure that the caller has to supply. Here is the C declaration:\n\nWINUSERAPI BOOL WINAPI\nGetWindowRect(\n     HWND hWnd,\n     LPRECT lpRect);\nHere is the wrapping with ctypes:\n\n&gt;&gt;&gt;\n&gt;&gt;&gt; from ctypes import POINTER, WINFUNCTYPE, windll, WinError\n&gt;&gt;&gt; from ctypes.wintypes import BOOL, HWND, RECT\n&gt;&gt;&gt; prototype = WINFUNCTYPE(BOOL, HWND, POINTER(RECT))\n&gt;&gt;&gt; paramflags = (1, \"hwnd\"), (2, \"lprect\")\n&gt;&gt;&gt; GetWindowRect = prototype((\"GetWindowRect\", windll.user32), paramflags)\n&gt;&gt;&gt;\n</code></pre>\n\n<p>This example works when the function is external, however, let's assume I have a reference to an object, and I want to call a function from that object with params, how do I do that?</p>\n\n<p>I did saw the log of all function signatures from 'dumpbin -exports', and I tried using the full name of the function, and still it didn't work.</p>\n\n<p>Any other ideas would be blessed.</p>\n"}, {"tags": ["c", "function", "variables", "pthreads"], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 6530287, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ccf6de1e4e1ea515379c2538e46201ea?s=128&d=identicon&r=PG", "display_name": "Volumetricsteve", "link": "https://stackoverflow.com/users/6530287/volumetricsteve"}, "edited": false, "score": 0, "creation_date": 1471822377, "post_id": 38997537, "comment_id": 65487902, "body": "so to dumb things down, you&#39;re making a single thing (your struct) and then you&#39;re passing a pointer to that struct to the function in question when pthread_create is called?"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 183, "user_id": 6530287, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ccf6de1e4e1ea515379c2538e46201ea?s=128&d=identicon&r=PG", "display_name": "Volumetricsteve", "link": "https://stackoverflow.com/users/6530287/volumetricsteve"}, "edited": false, "score": 0, "creation_date": 1471822518, "post_id": 38997537, "comment_id": 65487925, "body": "@Volumetricsteve Yes, that&#39;s it."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1471439212, "creation_date": 1471439212, "answer_id": 38997537, "question_id": 38997370, "link": "https://stackoverflow.com/questions/38997370/in-c-how-do-i-pass-variables-to-functions-in-pthreads-upon-thread-creation/38997537#38997537", "title": "In C, how do I pass variables to functions in Pthreads upon thread creation?", "body": "<p>In order to pass data to a thread you need to prepare the data in some place in memory, and pass a pointer to that place into <code>pthread_create</code>. It is <code>pthread_create</code>'s job to pass that pointer to the runner function of your thread:</p>\n\n<pre><code>typedef struct {\n    long tid;\n    int depth;\n}thread_data;\n...\nvoid *Entropy(void *dataPtr) {\n   thread_data *data= (thread_data*)dataPtr;\n   printf(\"This is where things get done for %li.\\n\", data-&gt;tid);\n   pthread_exit(NULL);\n}\n...\npthread_t threads[NUM_THREADS];\nthread_data data[NUM_THREADS];\n...\nfor(t=0;t&lt;NUM_THREADS;t++) {\n    data[t].tid = t;\n    data[t].depth = depth;\n    rc = pthread_create(&amp;threads[t], NULL, Entropy, (void *)&amp;data[t]);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 183, "user_id": 6530287, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ccf6de1e4e1ea515379c2538e46201ea?s=128&d=identicon&r=PG", "display_name": "Volumetricsteve", "link": "https://stackoverflow.com/users/6530287/volumetricsteve"}, "edited": false, "score": 0, "creation_date": 1471822578, "post_id": 38999311, "comment_id": 65487932, "body": "before I can tackle the rest of your answer, if you could help me through the meaning of &quot;void <i>(</i>)(void *)&quot;  I&#39;d really appreciate it."}, {"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "reply_to_user": {"reputation": 183, "user_id": 6530287, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ccf6de1e4e1ea515379c2538e46201ea?s=128&d=identicon&r=PG", "display_name": "Volumetricsteve", "link": "https://stackoverflow.com/users/6530287/volumetricsteve"}, "edited": false, "score": 0, "creation_date": 1471849474, "post_id": 38999311, "comment_id": 65494317, "body": "@Volumetricsteve I guess you mean <code>void *(*)(void *)</code> it is just a type notation (like <code>int</code>, <code>char *</code>) and it means &quot;pointer to function that receives pointer to void and returns pointer to void&quot;."}], "tags": [], "owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "is_accepted": false, "score": 1, "last_activity_date": 1471443708, "creation_date": 1471443708, "answer_id": 38999311, "question_id": 38997370, "link": "https://stackoverflow.com/questions/38997370/in-c-how-do-i-pass-variables-to-functions-in-pthreads-upon-thread-creation/38999311#38999311", "title": "In C, how do I pass variables to functions in Pthreads upon thread creation?", "body": "<p>Your code crashes since you pass incorrect parameters:</p>\n\n<pre><code>rc = pthread_create(&amp;threads[t], NULL, Entropy(depth), (void *)t);\n                                    // ^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Here you should pass function pointer <code>void *(*)(void *)</code> but you are passing <code>void *</code>, and moreover value is unspecified since <code>Entropy()</code> has no return statement (did you turn warnings on at all?). I guess it should be like this:</p>\n\n<pre><code>rc = pthread_create(&amp;threads[t], NULL, Entropy, (void *)t);\n</code></pre>\n\n<p>Next, how to pass parameter to thread routine? Technically you can use any pointer, but you should think twice about what you are passing. First of all pointed data must be valid when new thread runs. I.e. you shouldn't pass addresses of any locals except if you are sure that thread is finished when you are leaving scope of passed data - use <code>pthread_join(new_thread)</code> at the scope end to achieve that. Another approach is to pass pointer to data at global scope, that is surely valid at any moment. But there is one flaw - such data are visible to all threads, so you may accidentally make a mess. To avoid it - use dynamic memory - allocate data block with <code>malloc()</code> pass pointer to thread and free it in that thread. Latter option reduces chances to corrupt someone's  else data.</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\nlong NUM_THREADS=0;\n\nvoid *Entropy(void *depth)\n{\n   long tid = *((long *)depth);\n   free(depth);\n   printf(\"This is where things get done.\\n\", tid);\n   return NULL;\n}\n\nint main(int argc, char *argv[])\n{\n   NUM_THREADS = sysconf(_SC_NPROCESSORS_ONLN);\n   printf(\"Cores: %i\\n\", NUM_THREADS);\n   pthread_t threads[NUM_THREADS];\n   int rc;\n   long t;\n   int depth;\n   depth = atoi(argv[1]);\n   for(t=0;t&lt;NUM_THREADS;t++){\n     long *arg = malloc(sizeof(*arg));\n     *arg = t;\n     printf(\"In main: creating thread %ld\\n\", t);\n     rc = pthread_create(&amp;threads[t], NULL, Entropy, arg);\n     if (rc){\n       printf(\"ERROR; return code from pthread_create() is %d\\n\", rc);\n       exit(-1);\n       }\n   }\n   for(t=0;t&lt;NUM_THREADS;t++){\n     pthread_join(threads[t], NULL);\n   }\n}\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 6530287, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ccf6de1e4e1ea515379c2538e46201ea?s=128&d=identicon&r=PG", "display_name": "Volumetricsteve", "link": "https://stackoverflow.com/users/6530287/volumetricsteve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 961, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1471443708, "creation_date": 1471438801, "question_id": 38997370, "link": "https://stackoverflow.com/questions/38997370/in-c-how-do-i-pass-variables-to-functions-in-pthreads-upon-thread-creation", "title": "In C, how do I pass variables to functions in Pthreads upon thread creation?", "body": "<p>Working from this example:</p>\n\n<p><a href=\"https://computing.llnl.gov/tutorials/pthreads/samples/hello.c\" rel=\"nofollow\">https://computing.llnl.gov/tutorials/pthreads/samples/hello.c</a></p>\n\n<p>I've worked backwards and tried to edit in what I'm hoping to accomplish.\nI'd like to pass data to the thread being spawned.</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\nlong NUM_THREADS=0;\n\nvoid *Entropy(void *depth)\n{\n   long tid;\n   tid = (long)depth;\n   printf(\"This is where things get done.\\n\", tid);\n   pthread_exit(NULL);\n}\n\nint main(int argc, char *argv[])\n{\n   NUM_THREADS = sysconf(_SC_NPROCESSORS_ONLN);\n   printf(\"Cores: %i\\n\", NUM_THREADS);\n   pthread_t threads[NUM_THREADS];\n   int rc;\n   long t;\n   int depth;\n   depth = atoi(argv[1]);\n   for(t=0;t&lt;NUM_THREADS;t++){\n     printf(\"In main: creating thread %ld\\n\", t);\n     rc = pthread_create(&amp;threads[t], NULL, Entropy(depth), (void *)t);\n     if (rc){\n       printf(\"ERROR; return code from pthread_create() is %d\\n\", rc);\n       exit(-1);\n       }\n     }\n   pthread_exit(NULL);\n}\n</code></pre>\n\n<p>I see on line:</p>\n\n<pre><code>rc = pthread_create(&amp;threads[t], NULL, Entropy(depth), (void *)t);\n</code></pre>\n\n<p>My function Entropy gets called here, so I thought I'd try to tack on some brackets and pass a variable to that function the way I'd seen it done before.  This seems to be a little different though, since this whole line returns something to rc, I wonder if that changes how I pass data to my thread, but I'm not sure how else I'd do it.</p>\n\n<p>Right now this code compiles and runs, int main() goes fine without a hitch but it seg faults the moment it tries to create new threads.</p>\n"}, {"tags": ["c++", "c", "arrays", "string", "pointers"], "comments": [{"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "reply_to_user": {"reputation": 2531, "user_id": 3160529, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/409ccefcab7337f7dc87a4cac668de1d?s=128&d=identicon&r=PG", "display_name": "Shubham", "link": "https://stackoverflow.com/users/3160529/shubham"}, "edited": false, "score": 2, "creation_date": 1471438409, "post_id": 38997119, "comment_id": 65345929, "body": "@Shubham Question is not about compactness of array members but about storing of strings to which that pointers point."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1471438905, "post_id": 38997119, "comment_id": 65346360, "body": "Notice there are other string literals like <code>&quot;  %d\\n&quot;</code> and <code>&quot;  %s \\n&quot;</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471439908, "post_id": 38997119, "comment_id": 65347237, "body": "Why do you even care? Any access beyond an array is undefined behaviour."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1471443788, "post_id": 38997119, "comment_id": 65350273, "body": "No guarantees at all. Plus the compiler can optimize how string literals are stored, if it detects that you use the same strings several times - this is usually called &quot;string pooling&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 1001, "user_id": 4044050, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Fawzb.jpg?s=128&g=1", "display_name": "Debashish", "link": "https://stackoverflow.com/users/4044050/debashish"}, "edited": false, "score": 5, "creation_date": 1471438640, "post_id": 38997175, "comment_id": 65346141, "body": "@Debashish There is nothing more to explain. If you want to know the details on specific system, you need to read your linker manual."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "reply_to_user": {"reputation": 1001, "user_id": 4044050, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Fawzb.jpg?s=128&g=1", "display_name": "Debashish", "link": "https://stackoverflow.com/users/4044050/debashish"}, "edited": false, "score": 2, "creation_date": 1471438673, "post_id": 38997175, "comment_id": 65346170, "body": "@Debashish: In short, it is not dictated by the language standard (neither C nor C++)."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "reply_to_user": {"reputation": 1001, "user_id": 4044050, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Fawzb.jpg?s=128&g=1", "display_name": "Debashish", "link": "https://stackoverflow.com/users/4044050/debashish"}, "edited": false, "score": 3, "creation_date": 1471438778, "post_id": 38997175, "comment_id": 65346262, "body": "@Debashish: In addition, you mind find it interesting to know that if there are two identical literal strings in your code, then the linker might choose to generate only a single copy in the executable image (again, not guaranteed by the standard)."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 3, "creation_date": 1471438862, "post_id": 38997175, "comment_id": 65346326, "body": "@barakmanos ...or if you have, e.g. <code>&quot;string&quot;</code> and <code>&quot;larger string&quot;</code>, it might recognise the redundancy and map the former to the equivalent address <i>within</i> the latter. I&#39;m pretty sure I&#39;ve seen this happen. But it is equally as much of an implementation detail and not guaranteed by the language at all."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1471439929, "post_id": 38997175, "comment_id": 65347246, "body": "It&#39;s compiler, not linker."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1471439999, "post_id": 38997175, "comment_id": 65347306, "body": "There is no requirement for a linker in the C standard. And for actual implementations, it is not only the linker (iff there is one) involved."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1471440011, "post_id": 38997175, "comment_id": 65347319, "body": "@EugeneSh.: See my comment above. Compiler, linker, loader, startup-code, etc."}], "tags": [], "owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "is_accepted": true, "score": 9, "last_activity_date": 1471439096, "last_edit_date": 1471439096, "creation_date": 1471438314, "answer_id": 38997175, "question_id": 38997119, "link": "https://stackoverflow.com/questions/38997119/storing-of-string-literals-in-consecutive-memory-locations/38997175#38997175", "title": "Storing of string literals in consecutive memory locations", "body": "<p>This is a linker decision - to store string literals tightly or not. There is no guaranties. Or even this may be done by compiler - it may create continuous data section that holds all involved literals. But nevertheless actual layout of that section is still implementation-specific and you shouldn't assume anything about it. </p>\n"}, {"comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471439117, "post_id": 38997477, "comment_id": 65346533, "body": "Interesting, but the question was &quot;is this always true?&quot; not &#39;can you show me another example of this or something else happening&#39;. This seems like a comment, not an answer."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 5, "creation_date": 1471439384, "post_id": 38997477, "comment_id": 65346762, "body": "@underscore_t: I think  an example of the assumption being false is an answer -- it can&#39;t always be true. By the way, Id agree that this might be merely kind of a comment, but I thought the example might be helpful and you can&#39;t put that in  a comment readably"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1471440118, "post_id": 38997477, "comment_id": 65347414, "body": "Your code invokes undefined behaviour. And will fail definitively on IL32P64 systems like Windows. And the array declaration is pretty dangerous, at least error-prone. It relies on a C legacy."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471440509, "post_id": 38997477, "comment_id": 65347717, "body": "@OIaf Good point. Why not just use <code>%p</code>, the designated format specifier for pointers? The pointer conversion here violates aliasing rules, and there&#39;s no need to."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471440904, "post_id": 38997477, "comment_id": 65348028, "body": "@olaf Thaks you&#39;re right, In fact I have first testetd with <code>%p</code> and then changed the <code>printf()</code> to have decimal output like in the question. Well, now it&#39;s a cast to <code>intptr_t</code>"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471441223, "post_id": 38997477, "comment_id": 65348272, "body": "Seems better - <code>C99 says that any pointer type can be cast to uintptr_t (or its underlying type) and back to the original pointer type without loss of information or violation of the strict-aliasing rules.</code> So we logically presume the same for <code>intptr_</code>t. But <code>PRIuPTR</code> is for printing <code>uintptr_t</code>, which might not be well-defined. You probably need to change those both to match up. If you don&#39;t want to use <code>void *</code>, <code>uintptr_t</code> seems most sensible, as I&#39;ve never understood <code>intptr_t</code> for anything other than temporarily stashing a pointer in a <code>int</code>... seeing as RAM addresses cannot be negative!"}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471441408, "post_id": 38997477, "comment_id": 65348409, "body": "@underscore_d thanks again, I&#39;ve made it <code>uintptr_t</code> to be sure"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471442687, "post_id": 38997477, "comment_id": 65349398, "body": "@IngoLeonhardt: Printing a pointer via <code>uintptr_t</code> cast is also not defined. Use <code>%p</code>, what is your problem with hexadecimal output? For pointers that is the most clear format. Decimal is close to nonsense."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471442877, "post_id": 38997477, "comment_id": 65349555, "body": "@Olaf as I&#39;ve already answered, I have no problem with hex but wanted to sty close to the original question. And could you pleas explain why the cast is not defined?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471442938, "post_id": 38997477, "comment_id": 65349598, "body": "@IngoLeonhardt: Where did I say <b>the cast</b> is not defined (actually it is not defined how the pointer is converted to the integer, but that is irrelevant for the defined usage). You might want to read about <code>uintptr_t</code> before printing a pointer that way. Long story short: use <code>%p</code> <b>only</b> to print a <b><code>void *</code></b> <b>only</b>."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471443260, "post_id": 38997477, "comment_id": 65349816, "body": "@Olaf I think I&#39;ve got you now. So you mean the two integers printed don&#39;t neccessarily show the string addresses and especially, if they are consecutive or not, right?."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471443628, "post_id": 38997477, "comment_id": 65350142, "body": "@IngoLeonhardt: It is undefined. Just please read the standard!"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1471444107, "post_id": 38997477, "comment_id": 65350575, "body": "@Olaf I agree just to use <code>%p</code> for clearest results and avoiding (more) odd conversions, but do you really mean that the standard <code>PRI?PTR</code> macros produce undefined behaviour when printing their corresponding <code>ptr_t</code> types? That sounds rather absurd. Why else would they exist? Surely they just map to the right specifier for the corresponding numeric type and print that. So if the conversion from real pointer to numeric value and back is well-defined, which it is, so must be printing said value. Sure, it&#39;s not required to be intuitive relative to memory layout/order, but I really doubt it&#39;s UB."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1471444870, "post_id": 38997477, "comment_id": 65351175, "body": "Notes: <code>uintptr_t</code> is an optional type.  Using <code>&quot;%p&quot;</code> does not necessarily print in hexadecimal - although that is common.  It is &quot;implementation-defined manner&quot;"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471447347, "post_id": 38997477, "comment_id": 65352937, "body": "@underscore_d: I also did not say that! Heck, why does nobody read trhe standard and what is guaranteed for <code>uintptr_t</code>? <b>Only</b> conversion forth and back is guaranteed. No arithmetics, no printing, no usage for later reference. They basically exist for non-portable arithmetic in very low-level functions where you really know what you are doing (and which should secured by platform assertions), and to allow passing a pointer or an integer (kind of &quot;union light&quot;)."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471447990, "post_id": 38997477, "comment_id": 65353328, "body": "@Olaf Don&#39;t pawn this off as me &quot;not reading the standard&quot;. I spend a possibly unhealthy amount of my time absorbing what is and is not standard in this language. I&#39;m still waiting for you to explain why the <code>printf</code> format macros such as <code>PRIuPTR</code> exist in the same standard(!) header file if they invoke undefined behaviour. <a href=\"http://www.cplusplus.com/reference/cinttypes/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/cinttypes</a> I&#39;m sure the printed results are likely to be <i>implementation-defined</i> and not necessarily reflect memory layout. But as part of a standard header, they simply cannot be <i>undefined</i> in the sense of common parlance: invoking UB."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471448728, "post_id": 38997477, "comment_id": 65353828, "body": "@underscore_d: And you should read comments carefully. Where exactly did I even mention the macros, less state they invoke UB? Oh, btw.: cplusplus.com does not define the standard (or did that change? Feel free to post the ISO message). Maybe you should read the <b>standard</b>?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471448888, "post_id": 38997477, "comment_id": 65353933, "body": "Well, the fact that Ingo had corrected their answer to avoid obvious UB but you were still posting, vaguely, &quot;It is undefined. Just please read the standard!&quot; could mean a lot of different things. Then you seemed to indicate you were equally against the idea of printing by saying &quot;<b>Only</b> conversion back and forth is guaranteed. No arithmetics, no printing&quot;, which given the use of &quot;guaranteed&quot; and past context sounds like you&#39;re saying something is UB... and the mention of &quot;printing&quot; implies you might&#39;ve been responding to the <code>printf</code> macros. If you&#39;re saying something else, please, clarify."}], "tags": [], "owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "is_accepted": false, "score": 4, "last_activity_date": 1471441320, "last_edit_date": 1471441320, "creation_date": 1471439057, "answer_id": 38997477, "question_id": 38997119, "link": "https://stackoverflow.com/questions/38997119/storing-of-string-literals-in-consecutive-memory-locations/38997477#38997477", "title": "Storing of string literals in consecutive memory locations", "body": "<p>I have an example for you:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;inttypes.h&gt;\n\nchar    *s[] = { \"ball\", \"football\" };\n\nint main( void ) \n{\n    int i;\n\n    for( i=0; i&lt;2; i++ ) {\n        printf( \"%\" PRIuPTR \"\\n\", (uintptr_t)s[i] );\n        // or printf( \"%p\\n\", s[i] ); forr hex output\n    }\n}\n</code></pre>\n\n<p>If I compile and run that program with <code>gcc -O3</code> I get:</p>\n\n<pre><code>4195869\n4195865\n</code></pre>\n\n<p>What happens here is that the optimizer merges both string literal to a single \"football\" so that <code>s[0]</code> becomes <code>s[1] + 4</code>.</p>\n\n<p>That's only one example of what compiler / linker might decide on how to store string literals ...</p>\n"}, {"comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471441438, "post_id": 38998316, "comment_id": 65348437, "body": "What do you mean? Addresses of strings within the image are determined at compile time. Adjustment of address for relocation purposes is performed by the loader; the compiler has nothing to do with that."}, {"owner": {"reputation": 13, "user_id": 6219647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e4bae870586038e9216a1786d4f134?s=128&d=identicon&r=PG&f=1", "display_name": "Srestha1", "link": "https://stackoverflow.com/users/6219647/srestha1"}, "reply_to_user": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471450076, "post_id": 38998316, "comment_id": 65354654, "body": "yes adjustment of addresses is done when linker when it wants some memory location. and after that loader load that address from hard disk. And that is a phase of compilation. that is why I told it is compiler dependent"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471450627, "post_id": 38998316, "comment_id": 65354989, "body": "How does this relate to string literals and their positioning relative to one another? One would assume that the entire section wherein they are contained might have its address adjusted but that they would stick together relatively. Or do you have a specific answer to the question?"}], "tags": [], "owner": {"reputation": 13, "user_id": 6219647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e4bae870586038e9216a1786d4f134?s=128&d=identicon&r=PG&f=1", "display_name": "Srestha1", "link": "https://stackoverflow.com/users/6219647/srestha1"}, "is_accepted": false, "score": -1, "last_activity_date": 1471441183, "creation_date": 1471441183, "answer_id": 38998316, "question_id": 38997119, "link": "https://stackoverflow.com/questions/38997119/storing-of-string-literals-in-consecutive-memory-locations/38998316#38998316", "title": "Storing of string literals in consecutive memory locations", "body": "<p>It will be totally compiler dependent. Compiler can take any address at the time execution started</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471444997, "post_id": 38999737, "comment_id": 65351259, "body": "Are not <i>all</i> arrays contiguous within themselves?  Perhaps show your answer as it relates to two or more arrays."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471445220, "post_id": 38999737, "comment_id": 65351419, "body": "What does this mean? What happens to <i>non-<code>static</code></i> arrays? I think you&#39;re thinking of something different, or perhaps drawing inferences from one platform that aren&#39;t Standardised for all."}, {"owner": {"reputation": 69, "user_id": 5102960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8672fc478c36404202e6e268bcb977a4?s=128&d=identicon&r=PG&f=1", "display_name": "madago", "link": "https://stackoverflow.com/users/5102960/madago"}, "edited": false, "score": 0, "creation_date": 1471445629, "post_id": 38999737, "comment_id": 65351713, "body": "static keyword assume that your variable is global. it&#39;s mean that the max size of your array is not limited according to the stack size."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471447466, "post_id": 38999737, "comment_id": 65353024, "body": "What relevance do allocation strategy or available memory have to whether any array is contiguous (A) within itself or (B) relative to other arrays? And does your &quot;contiguous&quot; here refer to A or B, anyway? A is always true. Other users have already noted that B is entirely implementation-defined."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1471601951, "post_id": 38999737, "comment_id": 65422624, "body": "nope, static memory allocation is compiler dependant, and you cannot assume any storage arrangement."}], "tags": [], "owner": {"reputation": 69, "user_id": 5102960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8672fc478c36404202e6e268bcb977a4?s=128&d=identicon&r=PG&f=1", "display_name": "madago", "link": "https://stackoverflow.com/users/5102960/madago"}, "is_accepted": false, "score": -3, "last_activity_date": 1471444868, "creation_date": 1471444868, "answer_id": 38999737, "question_id": 38997119, "link": "https://stackoverflow.com/questions/38997119/storing-of-string-literals-in-consecutive-memory-locations/38999737#38999737", "title": "Storing of string literals in consecutive memory locations", "body": "<p>Only static arrays are contiguous in memory. ex: char s[1024]. </p>\n"}], "owner": {"reputation": 1001, "user_id": 4044050, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Fawzb.jpg?s=128&g=1", "display_name": "Debashish", "link": "https://stackoverflow.com/users/4044050/debashish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "accepted_answer_id": 38997175, "answer_count": 4, "score": 6, "last_activity_date": 1471444868, "creation_date": 1471438140, "last_edit_date": 1471438562, "question_id": 38997119, "link": "https://stackoverflow.com/questions/38997119/storing-of-string-literals-in-consecutive-memory-locations", "title": "Storing of string literals in consecutive memory locations", "body": "<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;string.h&gt;\n    int main() {\n\n    char *s[] = {\"cricket\",\"tennis\",\"football\"};\n\n    printf(\" String are: \\n\\n\");\n    printf(\"  %s \\n\", *(s));\n    printf(\"  %s \\n\", *(s+1));\n    printf(\"  %s \\n\", *(s+2));\n    printf(\"  \\n\\n\");\n\n    printf(\"  Starting locations of the string are: \\n\\n\");\n\n    printf(\"  %d\\n\",*(s));\n    printf(\"  %d\\n\",*(s+1));\n    printf(\"  %d\\n\",*(s+2));\n    printf(\"  \\n\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>OUTPUT:</p>\n\n<pre><code>String are: \n\ncricket \ntennis \nfootball \n\n\nStarting locations of the string are: \n\n134514112\n134514120\n134514127\n</code></pre>\n\n<p>s is a array of character pointers. s has three elements and each of them are storing the starting address of the string literals.i.e. s[0] is a pointer pointing to the starting address of \"cricket\". etc..</p>\n\n<p>My question is :</p>\n\n<p>By observing these addresses we can see that second string is stored just after the null character of the first string. All three strings are stored in sequential form. Is this always true ?</p>\n"}, {"tags": ["c", "if-statement"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 6, "creation_date": 1471437115, "post_id": 38996718, "comment_id": 65344923, "body": "How to do your homework yourself? What have you tried? Where is your code? What <b>specifically</b> don&#39;t work?"}, {"owner": {"reputation": 253, "user_id": 6509764, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1268508016500512/picture?type=large", "display_name": "Embedded Geek", "link": "https://stackoverflow.com/users/6509764/embedded-geek"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471437187, "post_id": 38996718, "comment_id": 65344974, "body": "I am unable to satisfy above conditions in single if statement"}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1471447378, "post_id": 38996718, "comment_id": 65352956, "body": "The wording of the requirement is unclear. What does it mean &quot;a is less than b by a margin of 2&quot;? There are several possible interpretations of this. One is that <code>a = b-2</code>. Another interpretation is <code>a &lt; b-2</code>. And yet another is <code>a &lt;= b-2</code>.  Then comes the statement &quot;if margin is greater than 2, go to the else condition&#39;. that implies just the opposite - that the difference between a and b  is less than 3."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471442734, "post_id": 38997501, "comment_id": 65349449, "body": "<code>stdlib.h</code> is not necessarily avaliable."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1471439108, "creation_date": 1471439108, "answer_id": 38997501, "question_id": 38996718, "link": "https://stackoverflow.com/questions/38996718/how-to-create-logic-in-if-else-condition/38997501#38997501", "title": "How to create logic in if else condition", "body": "<p>What you're looking for here is to see that <code>a</code> and <code>b</code> differ by no more than 2.  You can do that as follows:</p>\n\n<pre><code>if (abs(a-b) &lt;= 2)\n</code></pre>\n\n<p>This is true if the difference betwen <code>a</code> and <code>b</code> is less than or equal to 2.</p>\n\n<p>If <code>a</code> is 8, 9, 10, 11, or 12, the above evaluates to true.  So this satisfies all the given conditions.</p>\n"}, {"tags": [], "owner": {"reputation": 720, "user_id": 5620762, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/N2xaP.jpg?s=128&g=1", "display_name": "Nutan", "link": "https://stackoverflow.com/users/5620762/nutan"}, "is_accepted": false, "score": 0, "last_activity_date": 1471439119, "creation_date": 1471439119, "answer_id": 38997506, "question_id": 38996718, "link": "https://stackoverflow.com/questions/38996718/how-to-create-logic-in-if-else-condition/38997506#38997506", "title": "How to create logic in if else condition", "body": "<p>Use this way</p>\n\n<pre><code> if(a&gt;=8 &amp;&amp; a&lt;=10)\n  {\n    if ( ( a == b ) || ( a + 2 == b ) || ( a - 2 == b ) )\n     {\n       // write your code here\n     }\n    else{\n     //code of else part if above condition is not satisfied\n    }\n\n  }else{\n    //if value of a is not in range i.e 8 to 10\n   }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86, "user_id": 3641224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1203edee5dfcfaef3f57f440aebce342?s=128&d=identicon&r=PG&f=1", "display_name": "rht", "link": "https://stackoverflow.com/users/3641224/rht"}, "is_accepted": false, "score": 1, "last_activity_date": 1471439127, "creation_date": 1471439127, "answer_id": 38997509, "question_id": 38996718, "link": "https://stackoverflow.com/questions/38996718/how-to-create-logic-in-if-else-condition/38997509#38997509", "title": "How to create logic in if else condition", "body": "<p>Using the absolute value function <code>abs</code> in <code>stdlib.h</code></p>\n\n<pre><code>if (abs(a-b) &lt;= 2)\n    do something;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 389, "user_id": 6494804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12737fef0c31cdd0bc25d4212619858b?s=128&d=identicon&r=PG&f=1", "display_name": "Alexi", "link": "https://stackoverflow.com/users/6494804/alexi"}, "is_accepted": false, "score": 0, "last_activity_date": 1471439246, "creation_date": 1471439246, "answer_id": 38997550, "question_id": 38996718, "link": "https://stackoverflow.com/questions/38996718/how-to-create-logic-in-if-else-condition/38997550#38997550", "title": "How to create logic in if else condition", "body": "<p>a == b is not neccessary.</p>\n\n<pre><code>if ( !((a &lt;= b+2) &amp;&amp; (a &gt;= b-2)) )  // False if \"a\" is between 8 and 12\n</code></pre>\n"}], "owner": {"reputation": 253, "user_id": 6509764, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1268508016500512/picture?type=large", "display_name": "Embedded Geek", "link": "https://stackoverflow.com/users/6509764/embedded-geek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 4, "score": -5, "last_activity_date": 1471439299, "creation_date": 1471436991, "last_edit_date": 1471437897, "question_id": 38996718, "link": "https://stackoverflow.com/questions/38996718/how-to-create-logic-in-if-else-condition", "title": "How to create logic in if else condition", "body": "<p>How to write the following condition using single if else?</p>\n\n<pre><code>int a;  //a can vary from 8 to 12\nint b = 10;\n\na is equal to b\na is less than b by the margin of 2\na is greater than b by the margin of 2\n</code></pre>\n\n<p>In all above cases the if condition should be met. If margin is greater than 2, go to else condtion.</p>\n\n<p>This Condition becomes true when value of a =7 or 13, which is not desirable</p>\n\n<pre><code>if((a == b) || (a &lt;b-2) || (a &gt; b-2))\n</code></pre>\n"}, {"tags": ["c", "performance", "sse", "simd", "intrinsics"], "comments": [{"owner": {"reputation": 4282, "user_id": 165063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJdL7.png?s=128&g=1", "display_name": "Roman Khimov", "link": "https://stackoverflow.com/users/165063/roman-khimov"}, "edited": false, "score": 1, "creation_date": 1471436169, "post_id": 38996265, "comment_id": 65344296, "body": "What is the CPU you&#39;re using?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1471436486, "post_id": 38996265, "comment_id": 65344512, "body": "First of, did you check whether gcc autovectorizes the scalar code? Second, you&#39;re probably going to be memory-bandwidth limited."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1471436837, "post_id": 38996265, "comment_id": 65344748, "body": "As @EOF says, you&#39;re doing almost nothing in your loop (one SIMD arithmetic instruction), so you&#39;ll most likely be memory bandwidth limited when you have large arrays."}, {"owner": {"reputation": 41, "user_id": 2175533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c2ddec6919ac3f1e39400b33840418b?s=128&d=identicon&r=PG", "display_name": "voidbip", "link": "https://stackoverflow.com/users/2175533/voidbip"}, "reply_to_user": {"reputation": 4282, "user_id": 165063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJdL7.png?s=128&g=1", "display_name": "Roman Khimov", "link": "https://stackoverflow.com/users/165063/roman-khimov"}, "edited": false, "score": 1, "creation_date": 1471438281, "post_id": 38996265, "comment_id": 65345834, "body": "@RomanKhimov I have seen this phenomenon on various servers I have access to, but this specific experiment is on a   Intel(R) Xeon(R) CPU E5-2667 v4 @ 3.20GHz w. 504 GB RAM."}, {"owner": {"reputation": 41, "user_id": 2175533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c2ddec6919ac3f1e39400b33840418b?s=128&d=identicon&r=PG", "display_name": "voidbip", "link": "https://stackoverflow.com/users/2175533/voidbip"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1471438392, "post_id": 38996265, "comment_id": 65345915, "body": "@EOF gcc does not appear to be able to autovectorize the code at least given my attempts to make it do so. Also, shouldn&#39;t the memory bandwidth constraint also manifest itself in the for-loop case? I am going linearly through memory in both cases. Granted, in the SIMD case I am striding 16 bytes at a time. I would think both should be well behaved from a memory access standpoint."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1471445948, "post_id": 38996265, "comment_id": 65351921, "body": "You should look at the real times and not just the relative times. Of course, memory bandwidth, caching and other overheads (including VM implementation) affect both benchmarks equally, but that means they will affect the faster one proportionately more."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 2175533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c2ddec6919ac3f1e39400b33840418b?s=128&d=identicon&r=PG", "display_name": "voidbip", "link": "https://stackoverflow.com/users/2175533/voidbip"}, "edited": false, "score": 0, "creation_date": 1471522914, "post_id": 39003260, "comment_id": 65386509, "body": "this is such a detailed answer. Thank you! Given the results you obtained, do you think there is maybe any advantage in software buffering? Basically copying memory from DRAM 32KB at a time (say) into a second software managed buffer and doing the computation there? I would imagine this would font load the performance hit of going out into main memory and not cause a cache miss at ever 64 bytes ( the length of a cache line ). I am not an expert in computer architecture by any means so please feel free to tell me if this is complete crazy talk."}, {"owner": {"reputation": 12209, "user_id": 4926757, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-jsLBa8e0dT0/AAAAAAAAAAI/AAAAAAAAAEc/YqNqYlsSjrU/photo.jpg?sz=128", "display_name": "Rotem", "link": "https://stackoverflow.com/users/4926757/rotem"}, "reply_to_user": {"reputation": 41, "user_id": 2175533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c2ddec6919ac3f1e39400b33840418b?s=128&d=identicon&r=PG", "display_name": "voidbip", "link": "https://stackoverflow.com/users/2175533/voidbip"}, "edited": false, "score": 0, "creation_date": 1471524930, "post_id": 39003260, "comment_id": 65387930, "body": "I used to do it when I programmed to DSP (initiated DMA transfers from external RAM into DSP internal RAM). The modern x86 architecture uses automatic prefetching mechanism that detects memory access pattern (i.e acceding addresses) and reads data into cache before the program uses it. Cache misses is not the problem here, the performance is limited by memory bandwidth (you just can&#39;t read data faster from the DDR SDRAM)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 41, "user_id": 2175533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c2ddec6919ac3f1e39400b33840418b?s=128&d=identicon&r=PG", "display_name": "voidbip", "link": "https://stackoverflow.com/users/2175533/voidbip"}, "edited": false, "score": 0, "creation_date": 1471540556, "post_id": 39003260, "comment_id": 65398718, "body": "@voidbip: That&#39;s a good idea, but actually terrible.  It means none of your computation can overlap with the cache misses you incur while touching the cold memory for the first time.  L1/L2/L3 cache can cache any part of main memory, and extra copying just increases your cache footprint.  Bouncing to a small buffer that stays hot in L1 is useful for very rare cases like <a href=\"https://software.intel.com/en-us/articles/copying-accelerated-video-decode-frame-buffers\" rel=\"nofollow noreferrer\">keeping NT loads from video RAM separate from NT stores to regular RAM</a>.  Until/unless you understand that article, don&#39;t do it."}], "tags": [], "owner": {"reputation": 12209, "user_id": 4926757, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-jsLBa8e0dT0/AAAAAAAAAAI/AAAAAAAAAEc/YqNqYlsSjrU/photo.jpg?sz=128", "display_name": "Rotem", "link": "https://stackoverflow.com/users/4926757/rotem"}, "is_accepted": true, "score": 5, "last_activity_date": 1471522462, "last_edit_date": 1471522462, "creation_date": 1471456233, "answer_id": 39003260, "question_id": 38996265, "link": "https://stackoverflow.com/questions/38996265/slower-sse-performance-on-large-array-sizes/39003260#39003260", "title": "Slower SSE performance on large array sizes", "body": "<p>For large input, the data is outside the cache, and the code is memory bounded.<br>\nFor small input, the data is inside the cache (i.e L1 / L2 / L3 cache), and the code is computation bounded.<br>\nI assume you didn't try to flush the cache, before performance measurement.  </p>\n\n<p>The cache memory is inside the CPU, and the bandwidth between cache memory and ALU (or SSE) units is very high (high bandwidth - less time transferring data).<br>\nYour highest level cache (i.e L3) size is about 4MB to 8MB (depending your CPU model).<br>\nLarger amount of data must be located on the DDR SDRAM, witch is external RAM (outside the CPU).<br>\nThe CPU is connected to the DDR SDRAM with memory bus, with has much lower bandwidth than the cache memory.  </p>\n\n<p>Example:<br>\nAssume your external RAM type is <a href=\"https://en.wikipedia.org/wiki/DDR3_SDRAM\" rel=\"nofollow\">Dual Channel DDR3 SDRAM 1600</a>.\nThe maximum theoretical bandwidth between external RAM and CPU is about 25GB/Sec.  </p>\n\n<p>Reading 100MBytes of data (at 25GB/S) from the RAM to the CPU takes about 100e6 / 25e9 = 4msec.<br>\nFrom my experience the utilized bandwidth is about half of theoretical bandwidth, so the reading time is about 8msec.</p>\n\n<p>The computation time is shorter:<br>\nAssume each iteration of your loop takes about 2 CPU clocks (just an example).<br>\nEach iteration process 16 bytes of data.<br>\nTotal CPU clocks for processing 100MB takes about (100e6 / 16)*2 = 12500000 clks.<br>\nAssume CPU frequency is 3GHz.<br>\nTotal SSE processing time is about 12500000 / 3e9 = 4.2msec.</p>\n\n<p>As you can see, reading the data from external RAM takes twice as much as SSE computation time.  </p>\n\n<p>Since the data transfer and computation occur in parallel, the total time is the maximum of 4.2mesc and 8msec (i.e 8msec).</p>\n\n<p>Lets assume loop without using SSE takes twice as much computation time, so without using SSE the computation time is about 8.4msec.  </p>\n\n<p>In the above example the total improvement of using SSE is about 0.4msec. </p>\n\n<p>Note: The selected numbers are just for example purposes.</p>\n\n<hr>\n\n<p>Benchmarks:<br>\nI did some benchmarks on my system.<br>\nI am using Windows 10 and Visual Studio 2010.<br>\nBenchmark test: Summing 100MBytes of data (summing 25*1024^2 32bits integers).</p>\n\n<p>CPU  </p>\n\n<ul>\n<li>Intel Core i5 3550 (Ivy Bridge).  </li>\n<li>CPU Base frequency is 3.3GHz.  </li>\n<li>Actual Core Speed during the test: 3.6GHz (Turbo boost is enabled).  </li>\n<li>L1 data cache size: 32KBytes.  </li>\n<li>L2 cache size: 256Bytes (single core L2 cache size).  </li>\n<li>L3 cache size: 6MBytes.  </li>\n</ul>\n\n<p>Memory:  </p>\n\n<ul>\n<li>8GB DDR3 Dual channel.  </li>\n<li>RAM Frequency: 666MHz (equivalent to 1333MHz without DDR).  </li>\n<li>Memory theoretical maximum bandwidth: (128*1333/8) / 1024 = 20.8GBytes/Sec.  </li>\n</ul>\n\n<hr>\n\n<ol>\n<li>Sum 100MB as large chunk <strong>with SSE</strong> (data in external RAM).<br>\nProcessing time: 6.22msec</li>\n<li>Sum 1KB 100 times <strong>with SSE</strong> (data inside cache).<br>\nProcessing time: 3.86msec</li>\n<li>Sum 100MB as large chunk <strong>without SSE</strong> (data in external RAM).<br>\nProcessing time: 8.1msec</li>\n<li>Sum 1KB 100 times <strong>without SSE</strong> (data inside cache).<br>\nProcessing time: 4.73msec</li>\n</ol>\n\n<hr>\n\n<p>Utilized memory bandwidth: 100/6.22 = <strong>16GB/Sec</strong> <em>(dividing data size by time)</em>.<br>\nAverage clocks per iteration with SSE (data in cache): (3.6e9*3.86e-3)/(25/4*1024^2) = <strong>2.1 clks/iteration</strong> <em>(dividing total CPU clocks by number of iterations)</em>.  </p>\n"}], "owner": {"reputation": 41, "user_id": 2175533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c2ddec6919ac3f1e39400b33840418b?s=128&d=identicon&r=PG", "display_name": "voidbip", "link": "https://stackoverflow.com/users/2175533/voidbip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 814, "favorite_count": 2, "accepted_answer_id": 39003260, "answer_count": 1, "score": 3, "last_activity_date": 1471522462, "creation_date": 1471435806, "last_edit_date": 1471442469, "question_id": 38996265, "link": "https://stackoverflow.com/questions/38996265/slower-sse-performance-on-large-array-sizes", "title": "Slower SSE performance on large array sizes", "body": "<p>I am new to SSE programming so I am hoping someone out there can help me. I recently implemented a function using GCC SSE intrinsics to compute the sum of an array of 32-bit integers. The code for my implementation is given below.</p>\n\n<pre><code>int ssum(const int *d, unsigned int len)\n{\n  static const unsigned int BLOCKSIZE=4;\n  unsigned int i,remainder;\n  int output;\n  __m128i xmm0, accumulator;\n  __m128i* src;\n\n  remainder = len%BLOCKSIZE;\n  src = (__m128i*)d;\n  accumulator = _mm_loadu_si128(src);\n\n  output = 0;\n  for(i=BLOCKSIZE;i&lt;len-remainder;i+=BLOCKSIZE){\n    xmm0 = _mm_loadu_si128(++src);\n    accumulator = _mm_add_epi32(accumulator,xmm0);\n  }\n\n  accumulator = _mm_add_epi32(accumulator, _mm_srli_si128(accumulator, 8));\n  accumulator = _mm_add_epi32(accumulator, _mm_srli_si128(accumulator, 4));\n  output = _mm_cvtsi128_si32(accumulator);\n\n\n  for(i=len-remainder;i&lt;len;i++){\n    output += d[i];\n  }\n  return output;\n}\n</code></pre>\n\n<p>As you can see, it is a fairly straight forward implementation where I sum the array 4 at a time using the extended xmm registers and then clean up at the end by adding up the remaining elements.</p>\n\n<p>I then compared the performance of this SIMD implementation against just a plain for loop. The result of this experiment is available here: </p>\n\n<p><a href=\"http://i.stack.imgur.com/eWBM6.png\" rel=\"nofollow\">SIMD vs. for-loop</a></p>\n\n<p>As you can see, in comparison to a for loop, this implementation does indeed show about ~60% speedup for a input sizes ( meaning the length of the array ) upto about 5M elements. However, for larger values of the input size the performance, in relation to a for loop, takes a dramatic dive and produces only about a 20% speed up.</p>\n\n<p>I am at a loss to explain this dramatic decrease in performance. I am more or less stepping linearly through memory so the affect of cache misses and page faults should be about the same for both implementations. What am I missing here? Is there any way we can flatten that curve out? Any thoughts would be greatly appreciated. </p>\n"}, {"tags": ["c", "validation", "input"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 3, "creation_date": 1471435072, "post_id": 38995970, "comment_id": 65343536, "body": "Hint: <code>n2 = strtol(p, &amp;p, 10)</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1471435441, "post_id": 38995970, "comment_id": 65343810, "body": "DV for not even reading the man-page of <code>scanf</code>."}, {"owner": {"reputation": 4164, "user_id": 4831822, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_ceYetsPxZc/AAAAAAAAAAI/AAAAAAAAACQ/WjKu3LiDIH0/photo.jpg?sz=128", "display_name": "Steven Summers", "link": "https://stackoverflow.com/users/4831822/steven-summers"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471435859, "post_id": 38995970, "comment_id": 65344084, "body": "@Olaf I did attempt <code>scanf</code> but I could only get it working for valid inputs. Any invalid input as mentioned gives me a strange output and I&#39;m rather confused. Plus the SO question mentioned says to not use <code>scanf</code> so I when for <code>fgets</code> @zwol Made the change but can&#39;t get it to work when trying something valid. Could you please elaborate?"}, {"owner": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "edited": false, "score": 0, "creation_date": 1471436420, "post_id": 38995970, "comment_id": 65344460, "body": "Have you tried using strtok instead of strtol? With strtok you can extract first two entries, no matter how long the input is. After that you can convert them to integer with atoi(). You can also check if the character after the second strtok is newline &quot;\\n&quot; and if it is, it&#39;s valid input. If not, it&#39;s invalid."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1471436424, "post_id": 38995970, "comment_id": 65344464, "body": "Don&#39;t even bother trying to use <code>scanf</code>, it&#39;s broken as specified.  As you have discovered, one of the problems with it is that invalid input is effectively impossible to handle robustly."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1471436513, "post_id": 38995970, "comment_id": 65344531, "body": "If you want more actual help from me, I&#39;m going to need you to elaborate on &quot;made the change but can&#39;t get it to work when trying something valid&quot;.  List the exact inputs you tried, what happened for each, and what you thought should have happened for each.  (Then reread the <code>strtol</code> manpage and possibly light will dawn.)"}, {"owner": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "edited": false, "score": 0, "creation_date": 1471436522, "post_id": 38995970, "comment_id": 65344534, "body": "Also, protip: your pointer p is uninitialized and it points nowhere."}, {"owner": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "edited": false, "score": 0, "creation_date": 1471436791, "post_id": 38995970, "comment_id": 65344719, "body": "You can also use isdigit() for checking if your characters are only digits."}, {"owner": {"reputation": 4164, "user_id": 4831822, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_ceYetsPxZc/AAAAAAAAAAI/AAAAAAAAACQ/WjKu3LiDIH0/photo.jpg?sz=128", "display_name": "Steven Summers", "link": "https://stackoverflow.com/users/4831822/steven-summers"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1471438797, "post_id": 38995970, "comment_id": 65346279, "body": "Many thanks @zwol seems I messed up the logic for the if statements."}], "answers": [{"tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": false, "score": -1, "last_activity_date": 1471437695, "creation_date": 1471437695, "answer_id": 38996960, "question_id": 38995970, "link": "https://stackoverflow.com/questions/38995970/parsing-user-input-for-two-values/38996960#38996960", "title": "Parsing user input for two values", "body": "<p>Once you have the input in a string you could use <code>sscanf</code> normally, but with a trick parameter in the end:</p>\n\n<pre><code>int get_input(int* x, int* y) {\n\n    char* p, buf[LINE_MAX], buf2[LINE_MAX];\n    int n1, n2;\n\n    printf(\"Prompt: \");\n    fgets(buf, sizeof(buf), stdin);\n    if  (sscanf(buf, \"%d%d%s\", &amp;n1, &amp;n2, buf2) == 2) {\n        /* Success */\n        *x = n1;\n        *y = n2;\n        return 1;\n    }\n    /* Failure */\n    return 0;\n}\n</code></pre>\n\n<p>Note: </p>\n\n<p>The 3rd parameter (<code>buf2</code>) is a guard against invalid input efter the second integer. This trick works because you first read the input into a string. If you try to do <code>scanf(\"%d%d%s\", ...)</code> directly, then the user will be prompted for further input until he provides some non-whitespace to put into <code>buf2</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 4164, "user_id": 4831822, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_ceYetsPxZc/AAAAAAAAAAI/AAAAAAAAACQ/WjKu3LiDIH0/photo.jpg?sz=128", "display_name": "Steven Summers", "link": "https://stackoverflow.com/users/4831822/steven-summers"}, "is_accepted": true, "score": 0, "last_activity_date": 1501066540, "last_edit_date": 1501066540, "creation_date": 1501056729, "answer_id": 45321061, "question_id": 38995970, "link": "https://stackoverflow.com/questions/38995970/parsing-user-input-for-two-values/45321061#45321061", "title": "Parsing user input for two values", "body": "<p>What I ended up coming up with, also works for a variable number of values.</p>\n\n<pre><code>bool get_input(int count, int* ref_values) {\n    char buffer[MAX_LINE_LENGTH];\n    char* input = fgets(buffer, sizeof(buffer), stdin);\n    char* end;\n    int i = 0;\n\n    if (feof(stdin)) {\n        clearerr(stdin);\n        return false;\n    }\n\n    for (long val = strtol(input, &amp;end, 10); input != end &amp;&amp; i &lt; count; val = strtol(input, &amp;end, 10), i++) {\n        input = end;\n        if (errno == ERANGE) {\n            errno = 0;\n            return false;\n        }\n\n        if (val &lt;= INT_MIN || val &gt;= INT_MAX) {\n            return false;\n        }\n        ref_values[i] = val;\n    }\n    return i == count &amp;&amp; strlen(input) == 1;\n}\n\nint main(int argc, char** argv) {\n    while (true) {\n        int values[2] = {};\n        printf(\"Enter 2 numbers: \");\n        if (get_input(2, values)) {\n            printf(\"You entered %d %d %d\\n\", values[0], values[1]);\n        } else {\n            printf(\"Invalid\\n\");\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 4164, "user_id": 4831822, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_ceYetsPxZc/AAAAAAAAAAI/AAAAAAAAACQ/WjKu3LiDIH0/photo.jpg?sz=128", "display_name": "Steven Summers", "link": "https://stackoverflow.com/users/4831822/steven-summers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 45321061, "answer_count": 2, "score": 0, "last_activity_date": 1501066540, "creation_date": 1471434996, "last_edit_date": 1495539865, "question_id": 38995970, "link": "https://stackoverflow.com/questions/38995970/parsing-user-input-for-two-values", "title": "Parsing user input for two values", "body": "<p>I have been searching for a few hours and can't seem to find the answer I'm after. My apologies if this ends up being a duplicate.</p>\n\n<p>Now my program asks the user for 2 integers. Example</p>\n\n<pre><code>Prompt: 15 24\n</code></pre>\n\n<p>I after going threw other questions so people have mentioned <code>scanf</code> and <code>fgets</code>. But each of those were for entering one number at a time, whereas I want both from the one input.</p>\n\n<p>My other issue is error checking. Whether they actually entered an integer or something invalid. Example:</p>\n\n<pre><code>Prompt: Hello World\nPrompt: foo 5\nPrompt: 4 bar\nPrompt: foo\nPrompt: \n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>int get_input(int* x, int* y) {\n\n    char* p, buf[LINE_MAX];\n    int n1, n2;\n\n    printf(\"Prompt: \");\n    fgets(buf, sizeof(buf), stdin);\n    n1 = strtol(buf, &amp;p, 10);\n    if (p == buf || *p != '\\n') {\n        return 0;\n    }\n\n    n2 = strtol(buf, &amp;p, 10);\n    if (p == buf || *p != '\\n') {\n        return 0;\n    }\n\n    *x = n1;\n    *y = n2;\n\n    return 1;\n}\n\nint main(int argc, char** argv) {\n    int x, y;\n    if (get_input(&amp;x, &amp;y)) {\n        printf(\"Worked: %d %d\\n\", x, t);\n    } else {\n        printf(\"Invalid\\n\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Some of the error checking is missing, but just really stuck on getting the second value if there is one. Also checking if there are more than 2 values.\nMuch help would be appreciated.</p>\n\n<p>References that got me this far:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/26583717/how-to-scanf-only-integer\">SO Question</a></p>\n\n<p><a href=\"http://en.cppreference.com/w/c/string/byte/strtol\" rel=\"nofollow noreferrer\">strtol doc</a></p>\n"}, {"tags": ["c++", "c", "linker", "global-variables", "extern"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1471435071, "post_id": 38995963, "comment_id": 65343535, "body": "Needs, more, commas, to, be, readable."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471435266, "post_id": 38995963, "comment_id": 65343687, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}, {"owner": {"reputation": 1203, "user_id": 6105043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9590c13dc07ee5a556e0d9ee36711499?s=128&d=identicon&r=PG", "display_name": "Elijan9", "link": "https://stackoverflow.com/users/6105043/elijan9"}, "edited": false, "score": 0, "creation_date": 1471435315, "post_id": 38995963, "comment_id": 65343721, "body": "You probably need to add <code>extern &quot;C&quot;</code> in your program.cpp, because there you <i>will</i> need it. Also you could move <code>_ReParseHtml DllReParseHtml;</code> to your parser.c rather than your program.cpp"}, {"owner": {"reputation": 309, "user_id": 6548285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067202d94212a1178546139addca1cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6548285/vlad"}, "reply_to_user": {"reputation": 1203, "user_id": 6105043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9590c13dc07ee5a556e0d9ee36711499?s=128&d=identicon&r=PG", "display_name": "Elijan9", "link": "https://stackoverflow.com/users/6105043/elijan9"}, "edited": false, "score": 0, "creation_date": 1471435510, "post_id": 38995963, "comment_id": 65343852, "body": "@Elijan9 i need to use it elsewhere on the project in a few other C files. Thats why i declared like that"}, {"owner": {"reputation": 309, "user_id": 6548285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067202d94212a1178546139addca1cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6548285/vlad"}, "reply_to_user": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1471435779, "post_id": 38995963, "comment_id": 65344031, "body": "@KlasLindb&#228;ck its not the dll. I just have the <code>c++</code> project in which i use some pure C code. In that pure C code i need to access the global variables which is declared in my project. In my post, the global variable is the function that is dynamically loaded from the dll in <code>WinMain</code>."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1471440790, "post_id": 38995963, "comment_id": 65347921, "body": "Did you include the header in your C++ file? If you didn&#39;t, the symbol you defined there is a distinct symbol, with internal linkage."}, {"owner": {"reputation": 309, "user_id": 6548285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067202d94212a1178546139addca1cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6548285/vlad"}, "edited": false, "score": 0, "creation_date": 1471440826, "post_id": 38995963, "comment_id": 65347958, "body": "The header with the <code>extern _ReParseHtml DllReParseHtml;</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6726245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1220ce3ef3e6ad5a6e3032a59a4963e?s=128&d=identicon&r=PG&f=1", "display_name": "BTA", "link": "https://stackoverflow.com/users/6726245/bta"}, "is_accepted": false, "score": 0, "last_activity_date": 1471437606, "last_edit_date": 1592644375, "creation_date": 1471437606, "answer_id": 38996929, "question_id": 38995963, "link": "https://stackoverflow.com/questions/38995963/mixed-c-c-sources-doesnt-recognize-extern-variables-on-linkage/38996929#38996929", "title": "Mixed C/C++ sources, doesn&#39;t recognize &#39;extern&#39; variables on linkage", "body": "<p>If I understand you, I do not think your problem comes from the mixing of C and C ++ languages. In fact, a global variable must be declared in a single file without the keyword extern and any other files with that keyword.\nDo not change anything in your file &quot;func_def.h&quot; but make sure the typedef is recognized. Take all the same care with C ++ makes a mangle.\nPlace the beginning of the file directive</p>\n<pre><code>#ifdef __cplusplus\n    extern &quot;C&quot; {\n#endif\n</code></pre>\n<p>and at end of file directive</p>\n<pre><code>#ifdef __cplusplus\n    }\n#endif\n</code></pre>\n<p>In one of your .c files, use the directive</p>\n<h1>define extern</h1>\n<p>This will effectively remove the keyword in a single file.</p>\n<p>Regards: Bernard.</p>\n"}, {"tags": [], "owner": {"reputation": 309, "user_id": 6548285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067202d94212a1178546139addca1cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6548285/vlad"}, "is_accepted": true, "score": 0, "last_activity_date": 1471462620, "creation_date": 1471462620, "answer_id": 39004927, "question_id": 38995963, "link": "https://stackoverflow.com/questions/38995963/mixed-c-c-sources-doesnt-recognize-extern-variables-on-linkage/39004927#39004927", "title": "Mixed C/C++ sources, doesn&#39;t recognize &#39;extern&#39; variables on linkage", "body": "<p>I solved this problem, by making all the prototype function declarations as in a block \"extern \"C\" { }\" . I had to modify the C code, to the c++ standart, removing some constructions, but at least it helped</p>\n"}], "owner": {"reputation": 309, "user_id": 6548285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067202d94212a1178546139addca1cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6548285/vlad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 39004927, "answer_count": 2, "score": -1, "last_activity_date": 1471462620, "creation_date": 1471434973, "question_id": 38995963, "link": "https://stackoverflow.com/questions/38995963/mixed-c-c-sources-doesnt-recognize-extern-variables-on-linkage", "title": "Mixed C/C++ sources, doesn&#39;t recognize &#39;extern&#39; variables on linkage", "body": "<p>I have the C++ project in which i added some pure C gnu library. I was tasked to change some of the functions, that is used there for the ones, that are needed to be loaded dynamically from dll, so what i did is, i declared the prototype, and made an extern variable:</p>\n\n<p>file <strong>prototypes.h</strong>:</p>\n\n<pre><code>typedef char *( __cdecl * _ReParseHtml ) ( DOM * data )\n</code></pre>\n\n<p>file <strong>func_defs.h</strong></p>\n\n<pre><code>extern _ReParseHtml DllReParseHtml;\n</code></pre>\n\n<p>then in my, main file <strong>program.cpp</strong> i declared:</p>\n\n<pre><code>_ReParseHtml DllReParseHtml;\n\nint APIENTRY wWinMain(_In_ HINSTANCE hInstance,\n    _In_opt_ HINSTANCE hPrevInstance,\n    _In_ LPWSTR    lpCmdLine,\n    _In_ int       nCmdShow)\n{\n    HINSTANCE hDLL = LoadLibrary(\"somelib.dll\");\n    if(hDll != 0){\n         DllReParseHtml = (_ReParseHtml)GetProcAddress(hDLL,\n                                       \"ReParseHtml\");\n         //etc\n    }\n}\n</code></pre>\n\n<p>So now i want to use this in the pure <code>.c</code> file which i added:\n<strong>parser.c</strong>:</p>\n\n<pre><code>#include \"func_defs.h\"  // here is the extern _ReParseHtml DllReParseHtml;\n\n int create_source(char * buf)\n {\n      char * modified = DllReParseHtml(buf);\n      // etc..\n }\n</code></pre>\n\n<p>But i get the error <code>LNK2001 unresolved external symbol DllReParseHtml</code>.</p>\n\n<p>The function in purce C source <code>int create_source(char * buf)</code> from which this functions suppose to be called is not in the <code>extern \"C\" { }</code> block, or anything like that.</p>\n"}, {"tags": ["c", "string", "string-parsing"], "answers": [{"tags": [], "owner": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "is_accepted": false, "score": 0, "last_activity_date": 1471441394, "creation_date": 1471441394, "answer_id": 38998400, "question_id": 38995708, "link": "https://stackoverflow.com/questions/38995708/how-to-extract-multi-digit-numbers-from-a-string/38998400#38998400", "title": "How to extract multi-digit numbers from a string?", "body": "<p>I have used a different approach to the problem, but I have solved it and it works. Consider trying this. Btw I have used char *s as a string literal but you can keep it like yours. </p>\n\n<pre><code>main(){\n\n  char *s=\"(5,7) (1,6) (2,4) (10,14) (8,9)\";\n  int i=0,x,n=0;\n  char a[20];\n  x=strlen(s);\n  while(i&lt;x){\n\n    if (isdigit(s[i])) {\n      a[n]=s[i];\n      if (s[i+1]==',' || s[i+1]==')') {\n        a[n+1]=' ';\n        n++;\n      }\n      n++;\n    }\n      i++;\n  }\n  printf(\"%s\\n\", a);\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>tenshi@mashiro:~/projects/test$ ./test \n5 7 1 6 2 4 10 14 8 9 \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "edited": false, "score": 0, "creation_date": 1471441720, "post_id": 38998428, "comment_id": 65348646, "body": "Why so complicated?"}], "tags": [], "owner": {"reputation": 936, "user_id": 5123867, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/50defd909941220da7976d3a8ef55933?s=128&d=identicon&r=PG", "display_name": "Lokesh Sanapalli", "link": "https://stackoverflow.com/users/5123867/lokesh-sanapalli"}, "is_accepted": false, "score": 0, "last_activity_date": 1471441449, "creation_date": 1471441449, "answer_id": 38998428, "question_id": 38995708, "link": "https://stackoverflow.com/questions/38995708/how-to-extract-multi-digit-numbers-from-a-string/38998428#38998428", "title": "How to extract multi-digit numbers from a string?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    // your code goes here\nchar s[100];\nint i=0,x,n=0;\nint a[20];\nprintf(\"Enter the sets:\");\ngets(s);\nx=strlen(s);\nwhile(i&lt;x-1){\n    if(isdigit(s[i]))\n    {\n        if(isdigit(s[i+1]))\n        {\n            a[n]=(s[i]-'0')*10  +(s[i+1]-'0');\n            i++;\n        }\n        else\n        {\n            a[n]=s[i]-'0';\n        }\n        n++;\n    }   \n    i++;\n}\nprintf(\"\\n\");\nfor(i=0;i&lt;n;i++){\n    printf(\"%d\\n\",a[i]);\n}\n    return 0;\n}\n</code></pre>\n\n<p>What about the above code, unfortunately C doesn't have simple string functions like split with Regex(it has split function but i didn't understand well). Alternatively, here is ideone for it <a href=\"https://ideone.com/eRKTbD\" rel=\"nofollow\">https://ideone.com/eRKTbD</a></p>\n"}, {"comments": [{"owner": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "edited": false, "score": 0, "creation_date": 1471443124, "post_id": 38998577, "comment_id": 65349732, "body": "I highly suggest not to accept this as answer, because it&#39;s not correct. It&#39;s correct only for 2 digits numbers, but when it comes to 3 digits and more, it&#39;s not working properly. There are plenty of good answers below."}, {"owner": {"reputation": 86, "user_id": 3641224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1203edee5dfcfaef3f57f440aebce342?s=128&d=identicon&r=PG&f=1", "display_name": "rht", "link": "https://stackoverflow.com/users/3641224/rht"}, "reply_to_user": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "edited": false, "score": 0, "creation_date": 1471444022, "post_id": 38998577, "comment_id": 65350500, "body": "@Mirakurun - Code works for more than two digit numbers if the input is in exact format as in the question. Can you please provide the test cases which broke the code?"}], "tags": [], "owner": {"reputation": 86, "user_id": 3641224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1203edee5dfcfaef3f57f440aebce342?s=128&d=identicon&r=PG&f=1", "display_name": "rht", "link": "https://stackoverflow.com/users/3641224/rht"}, "is_accepted": false, "score": 0, "last_activity_date": 1471441824, "creation_date": 1471441824, "answer_id": 38998577, "question_id": 38995708, "link": "https://stackoverflow.com/questions/38995708/how-to-extract-multi-digit-numbers-from-a-string/38998577#38998577", "title": "How to extract multi-digit numbers from a string?", "body": "<p>If the input is in the exact format as in the question, then you can add two loops inside the main while loop to read one set at a time.</p>\n\n<pre><code>while (i &lt; x)\n{\n    if (s[i] == '(')\n    {\n        // temporary var to store number\n        int num = 0;\n\n        // read first number\n        while (s[++i] != ',')\n            num = num*10 + s[i]-'0';\n        a[n++] = num;\n\n        num = 0;\n        // read second number\n        while (s[++i] != ')')\n            num = num*10 + s[i]-'0';\n        a[n++] = num;\n    }\n    i++;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1471444934, "last_edit_date": 1471444934, "creation_date": 1471441993, "answer_id": 38998669, "question_id": 38995708, "link": "https://stackoverflow.com/questions/38995708/how-to-extract-multi-digit-numbers-from-a-string/38998669#38998669", "title": "How to extract multi-digit numbers from a string?", "body": "<p>Since you only care about the numbers and not any of the delimiters, you can use <code>strtok</code>, which allows for a set of delimiters.</p>\n\n<p>Use the following in place of you existing <code>while</code> loop:</p>\n\n<pre><code>char *p = strtok(s, \"(), \");\nwhile (p) {\n    a[n++] = atoi(p);\n    p = strtok(NULL, \"(), \");\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>5\n7\n1\n6\n2\n4\n10\n14\n8\n9\n</code></pre>\n\n<p>If on the other hand you are particular about the format, you can do the following:</p>\n\n<pre><code>char *start = s, *p1 = NULL, *p2 = NULL, *p3 = NULL;\nif (start) p1 = strchr(start, '(');\nif (p1) p2 = strchr(p1+1, ',');\nif (p2) p3 = strchr(p2+1, ')');\nwhile (p1 &amp;&amp; p2 &amp;&amp; p3) {\n    a[n++] = atoi(p1+1);\n    a[n++] = atoi(p2+1);\n    start = p3+1;\n    if (start) p1 = strchr(start, '(');\n    if (p1) p2 = strchr(p1+1, ',');\n    if (p2) p3 = strchr(p2+1, ')');\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1613, "user_id": 6413048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05e41c326a8c8c6240e3a8b71e806d58?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6413048/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1471442519, "creation_date": 1471442519, "answer_id": 38998876, "question_id": 38995708, "link": "https://stackoverflow.com/questions/38995708/how-to-extract-multi-digit-numbers-from-a-string/38998876#38998876", "title": "How to extract multi-digit numbers from a string?", "body": "<p>If you always have the same format (a,b)(c,d)...(y,z) and the same number of values then this solution works : </p>\n\n<pre><code>char * arr = \"(5,7)(1,6)(2,4)(10,14)(8,9)\";\nint a,b,c,d,e,f,g,h,i,j;\n\nsscanf(arr,\"(%d,%d)(%d,%d)(%d,%d)(%d,%d)(%d,%d)\",&amp;a,&amp;b,&amp;c,&amp;d,&amp;e,&amp;f,&amp;g,&amp;h,&amp;i,&amp;j);\n\nprintf(\"%d %d %d %d %d %d %d %d %d %d\\n\", a, b, c, d, e, f, g, h, i, j);\n</code></pre>\n"}], "owner": {"reputation": 699, "user_id": 5874459, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-0kxk2H8UBF0/AAAAAAAAAAI/AAAAAAAAABw/vYKldQuWlLs/photo.jpg?sz=128", "display_name": "Shanky", "link": "https://stackoverflow.com/users/5874459/shanky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 904, "favorite_count": 0, "accepted_answer_id": 38998669, "answer_count": 5, "score": 2, "last_activity_date": 1471444934, "creation_date": 1471434257, "last_edit_date": 1471436272, "question_id": 38995708, "link": "https://stackoverflow.com/questions/38995708/how-to-extract-multi-digit-numbers-from-a-string", "title": "How to extract multi-digit numbers from a string?", "body": "<p>Firstly, I know similar questions have been asked before but I believe my case is different.</p>\n\n<p>My input string is:</p>\n\n<blockquote>\n  <p>(5,7) (1,6) (2,4) (10,14) (8,9)</p>\n</blockquote>\n\n<p>I wrote the following code for extraction into an array.</p>\n\n<pre><code>main(){\nchar s[100];\nint i=0,x,n=0;\nint a[20];\nprintf(\"Enter the sets:\");\ngets(s);\nx=strlen(s);\nwhile(i&lt;x){\n    if((s[i]=='(' &amp;&amp; s[i+2]==',') || (s[i]==',' &amp;&amp; s[i+2]==')'))\n    {\n        a[n]=s[i+1]-'0';\n        n++;\n    }   \n    i++;\n}\nfor(i=0;i&lt;n;i++){\n    printf(\"%d\\n\",a[i]);\n}\n}\n</code></pre>\n\n<p>The output I get is:</p>\n\n<blockquote>\n  <p>5 7 1 6 2 4 8 9</p>\n</blockquote>\n\n<p>I understand why my code will skip numbers having 2 or more digits.\nPlease suggest some minor changes to the present code to fix this limitation. </p>\n\n<p>P.S.- I'm looking for a solution which doesn't depend on length of the number.</p>\n"}, {"tags": ["c", "ld", "cortex-m"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5654512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10720e9a887a927e9e07a2b1df58cdfa?s=128&d=identicon&r=PG&f=1", "display_name": "eeucalyptus", "link": "https://stackoverflow.com/users/5654512/eeucalyptus"}, "edited": false, "score": 0, "creation_date": 1471441869, "post_id": 38997813, "comment_id": 65348752, "body": "Okay, thank you. This already helps a lot. But isn&#39;t there a way to tell the linker to use both banks for the same section? Although this should fix my current problem, I would like to know how to use both banks as if there was no boundary in between. In my eyes this should just be an alignment issue."}, {"owner": {"reputation": 76, "user_id": 4950336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d42c34a0849a1d4a5237638f92001f6?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen Plyaskin", "link": "https://stackoverflow.com/users/4950336/stephen-plyaskin"}, "reply_to_user": {"reputation": 45, "user_id": 5654512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10720e9a887a927e9e07a2b1df58cdfa?s=128&d=identicon&r=PG&f=1", "display_name": "eeucalyptus", "link": "https://stackoverflow.com/users/5654512/eeucalyptus"}, "edited": false, "score": 1, "creation_date": 1471443687, "post_id": 38997813, "comment_id": 65350197, "body": "<a href=\"https://answers.launchpad.net/gcc-arm-embedded/+question/223976\" rel=\"nofollow noreferrer\">There</a> is a similar problem with the sections. &quot;So  you can just MANUALLY place specific object files.&quot;"}, {"owner": {"reputation": 76, "user_id": 4950336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d42c34a0849a1d4a5237638f92001f6?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen Plyaskin", "link": "https://stackoverflow.com/users/4950336/stephen-plyaskin"}, "reply_to_user": {"reputation": 45, "user_id": 5654512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10720e9a887a927e9e07a2b1df58cdfa?s=128&d=identicon&r=PG&f=1", "display_name": "eeucalyptus", "link": "https://stackoverflow.com/users/5654512/eeucalyptus"}, "edited": false, "score": 0, "creation_date": 1471444245, "post_id": 38997813, "comment_id": 65350692, "body": "<code>.bss2 (NOLOAD) : ALIGN(4) { foo.o(.bss .bss.*) } &gt;RAM2</code>  All <code>.bss</code> data from <i>foo.o</i> will be places into RAM2. Keep attention that you should fill this memory with zeros at startup as regular <code>.bss</code> section."}], "tags": [], "owner": {"reputation": 76, "user_id": 4950336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d42c34a0849a1d4a5237638f92001f6?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen Plyaskin", "link": "https://stackoverflow.com/users/4950336/stephen-plyaskin"}, "is_accepted": true, "score": 0, "last_activity_date": 1471440394, "last_edit_date": 1471440394, "creation_date": 1471439856, "answer_id": 38997813, "question_id": 38995416, "link": "https://stackoverflow.com/questions/38995416/split-section-into-multiple-memory-regions/38997813#38997813", "title": "Split section into multiple memory regions", "body": "<p>For example you have 2 banks at <code>0x20000000</code> and <code>0x20010000</code>. You wants use Bank2 for heap and (main) stack. I assume that you have large <code>.bss</code> because of <code>configTOTAL_HEAP_SIZE</code> in <em>FreeRTOSConfig.h</em>. Now see heap sources in <em>FreeRTOS/Source/portable/MemMang/</em>. There are 5 implementations of <code>pvPortMalloc()</code> that do memory allocation.</p>\n\n<p>Looks at lines in <em>heap_X.c</em> that you use</p>\n\n<pre><code>/* Allocate the memory for the heap. */\n#if( configAPPLICATION_ALLOCATED_HEAP == 1 )\n    /* The application writer has already defined the array used for the RTOS\n    heap - probably so it can be placed in a special segment or address. */\n    extern uint8_t ucHeap[ configTOTAL_HEAP_SIZE ];\n#else\n    static uint8_t ucHeap[ configTOTAL_HEAP_SIZE ];\n#endif /* configAPPLICATION_ALLOCATED_HEAP */\n</code></pre>\n\n<p>So you can set <code>configAPPLICATION_ALLOCATED_HEAP</code> at 1 and say to you linker to place <code>ucHeap</code> at <code>0x20010000</code>.</p>\n\n<p>Another way is writing headers for each device that includes addresses of heap and stack and edit sources.\nFor <em>heap_1.c</em> we can do next changes:</p>\n\n<pre><code>// somewhere in devconfig.h\n#define HEAP_ADDR   0x20010000\n\n// in heap_1.c\n// remove code related ucHeap\n//\n// remove static uint8_t *pucAlignedHeap = NULL;\n// and paste:\nstatic uint8_t *pucAlignedHeap = (uint8_t *)HEAP_ADDR;\n</code></pre>\n\n<p>For <em>heap_2.c</em> and <em>heap_4.c</em> edit function <code>prvHeapInit()</code> as well.</p>\n\n<p>Pay attention to <em>heap_5.c</em> that includes <code>vPortDefineHeapRegions()</code>.</p>\n\n<p>Now <code>pvPortMalloc()</code> will returns pointers to memory in Bank2. <code>pvPortMalloc()</code> used for allocations stacks of tasks, TCB and user varables. Read sources. Location of main stack depends of your device/architecture. For stm32 (ARM) see vector table or how to change MSP register.</p>\n"}], "owner": {"reputation": 45, "user_id": 5654512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10720e9a887a927e9e07a2b1df58cdfa?s=128&d=identicon&r=PG&f=1", "display_name": "eeucalyptus", "link": "https://stackoverflow.com/users/5654512/eeucalyptus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1386, "favorite_count": 1, "accepted_answer_id": 38997813, "answer_count": 1, "score": 1, "last_activity_date": 1471440394, "creation_date": 1471433413, "last_edit_date": 1471437925, "question_id": 38995416, "link": "https://stackoverflow.com/questions/38995416/split-section-into-multiple-memory-regions", "title": "Split section into multiple memory regions", "body": "<p>I'm developing an application on an ARM Cortex-M microcontroller which has two RAM banks \u00e0 64kB. The first bank is directly followed by the second bank in the memory map.</p>\n\n<p>The memory banks are currently split into two regions in my linker script. The first region contains the sections <code>.bss</code> and <code>.data</code>. The second bank is used for <code>.heap</code> and <code>.stack</code>, which only take 1kB each (I'm using a different stack in FreeRTOS, which also manages it's own heap). </p>\n\n<p>My problem is, that <code>.bss</code> is too large for the first bank. Therefore I'd like to move some of it's content to the second bank. </p>\n\n<p>One way to accomplish this would be to create a new section, lets call it <code>.secondbss</code>, which is linked to the second bank. Single variables could then be added to this section using <code>__attribute__((section(\".secondbss\")))</code>. </p>\n\n<p>The reasons why I am not using this solution are</p>\n\n<ul>\n<li><p>I really want to maintain portability of my source code </p></li>\n<li><p>There might be a whole lot of variables that would require this attribute and I don't want to choose the section for every single variable</p></li>\n</ul>\n\n<p>Is there a better solution for this? I already thought of both memories as one region, but I don't know how to prevent the linker from misaligning the data across the boundary between both banks.</p>\n\n<p>How can I solve my problem without using <code>__attribute__</code> flags?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "linux", "cpu-usage"], "comments": [{"owner": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "edited": false, "score": 0, "creation_date": 1471435083, "post_id": 38995257, "comment_id": 65343544, "body": "So do you want to get cpu usage for a single process, or average cpu usage for a moment in time?"}, {"owner": {"reputation": 587, "user_id": 4336150, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/cce821782e6eff5bf46e45e1a00f9fdd?s=128&d=identicon&r=PG&f=1", "display_name": "Chirag", "link": "https://stackoverflow.com/users/4336150/chirag"}, "reply_to_user": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "edited": false, "score": 0, "creation_date": 1471443835, "post_id": 38995257, "comment_id": 65350322, "body": "I want to calculate cpu utilization in % for all the process running on system"}], "answers": [{"comments": [{"owner": {"reputation": 587, "user_id": 4336150, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/cce821782e6eff5bf46e45e1a00f9fdd?s=128&d=identicon&r=PG&f=1", "display_name": "Chirag", "link": "https://stackoverflow.com/users/4336150/chirag"}, "edited": false, "score": 0, "creation_date": 1471443940, "post_id": 38996122, "comment_id": 65350418, "body": "Thank you, but i want to calculate CPU utilization for each process,i think above code will give CPU utilization for each core."}], "tags": [], "owner": {"reputation": 3849, "user_id": 6008453, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3f29d4474cf818b192e452474933ef4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mirakurun", "link": "https://stackoverflow.com/users/6008453/mirakurun"}, "is_accepted": false, "score": 0, "last_activity_date": 1471435423, "creation_date": 1471435423, "answer_id": 38996122, "question_id": 38995257, "link": "https://stackoverflow.com/questions/38995257/how-to-calculate-cpu-utilization-for-all-running-processes-in-linux-using-proc/38996122#38996122", "title": "How to calculate CPU utilization for all running processes in linux using &quot;proc&quot; file system?", "body": "<p>I can give you part of the code I use for my cpu utilization server. It is very accurate. </p>\n\n<pre><code>long double a[4], b[4], loadavg;\nFILE *fp;\nchar dump[50] = {0};\nmemset(dump, 0, 50);\n\nfp = fopen(\"/proc/stat\",\"r\");\nfscanf(fp,\"%*s %Lf %Lf %Lf %Lf\",&amp;a[0],&amp;a[1],&amp;a[2],&amp;a[3]);\nfclose(fp);\nsleep(1);\n\nfp = fopen(\"/proc/stat\",\"r\");\nfscanf(fp,\"%*s %Lf %Lf %Lf %Lf\",&amp;b[0],&amp;b[1],&amp;b[2],&amp;b[3]);\nfclose(fp);\n\nloadavg = ((b[0]+b[1]+b[2]) - (a[0]+a[1]+a[2])) / ((b[0]+b[1]+b[2]+b[3]) - (a[0]+a[1]+a[2]+a[3]));\nloadavg=loadavg*100;\nsprintf(dump, \"%Lf\\n\",loadavg);\nlong double used;\n</code></pre>\n"}], "owner": {"reputation": 587, "user_id": 4336150, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/cce821782e6eff5bf46e45e1a00f9fdd?s=128&d=identicon&r=PG&f=1", "display_name": "Chirag", "link": "https://stackoverflow.com/users/4336150/chirag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 631, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471513228, "creation_date": 1471432911, "last_edit_date": 1495540849, "question_id": 38995257, "link": "https://stackoverflow.com/questions/38995257/how-to-calculate-cpu-utilization-for-all-running-processes-in-linux-using-proc", "title": "How to calculate CPU utilization for all running processes in linux using &quot;proc&quot; file system?", "body": "<p>From <a href=\"https://github.com/fho/code_snippets/blob/master/c/getusage.c\" rel=\"nofollow noreferrer\">This</a> and <a href=\"https://stackoverflow.com/questions/1420426/calculating-cpu-usage-of-a-process-in-linux\">this link</a> i am trying to calculate CPU utilization but it is not coming as expected. <strong>(i.e.</strong> \nMy application is showing CPU utilization as 3% and top is showing 99%.)</p>\n\n<p>I am trying below method,</p>\n\n<pre><code>usage=100*(((utime_ticks_current + cutime_ticks_current + stime_ticks_current + cstime_ticks_current) - (utime_ticks_prev + cutime_ticks_prev + stime_ticks_prev + cstime_ticks_prev)) / (long)(total_cpu_time_current - total_cpu_time_prev))\n\nhere, \nutime_ticks = /proc/pid/stat -&gt; 14th value\nstime_ticks = /proc/pid/stat -&gt; 15th value\ncutime_ticks = /proc/pid/stat -&gt; 16th value\ncstime_ticks = /proc/pid/stat -&gt; 17th value\n\ntotal_cpu_time = /proc/stat -&gt; sum of all 10 values\n</code></pre>\n\n<p>Time difference between current and prev is 1 second.</p>\n\n<p>Also, I have manually checked that all the values for all the variables are correct only.</p>\n\n<p>Please note that i tried the same thing separately for <strong>\"stime , cstime\" and \"utime , cutime\"</strong></p>\n\n<p>I think there is some problem in the way i am calculating it,</p>\n\n<p>Can anyone please help?</p>\n\n<hr>\n\n<p>I only found the solution, I just had to multiply the value with total number of Cores/CPU available.</p>\n\n<hr>\n"}, {"tags": ["c", "unit-testing", "gcc", "makefile", "linker"], "answers": [{"tags": [], "owner": {"reputation": 389, "user_id": 3852496, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a50bc2e9bc820b75dc254e9524769d07?s=128&d=identicon&r=PG&f=1", "display_name": "Greeneco", "link": "https://stackoverflow.com/users/3852496/greeneco"}, "is_accepted": true, "score": 0, "last_activity_date": 1471433089, "creation_date": 1471433089, "answer_id": 38995310, "question_id": 38995065, "link": "https://stackoverflow.com/questions/38995065/undefined-reference-to-unity-begin-and-unity-end/38995310#38995310", "title": "undefined reference to `UNITY_BEGIN&#39; and &#39;UNITY_END&#39;", "body": "<p>I could solve it by not using the release version 2.1.0.\nTo solve it I have cloned the current master branch and it just worked even with <code>UNITY_BEGIN</code> and <code>UNITY_END</code>:</p>\n\n<pre><code>git clone https://github.com/ThrowTheSwitch/Unity.git\n</code></pre>\n"}], "owner": {"reputation": 389, "user_id": 3852496, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a50bc2e9bc820b75dc254e9524769d07?s=128&d=identicon&r=PG&f=1", "display_name": "Greeneco", "link": "https://stackoverflow.com/users/3852496/greeneco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 800, "favorite_count": 0, "accepted_answer_id": 38995310, "answer_count": 1, "score": 0, "last_activity_date": 1471433089, "creation_date": 1471432446, "question_id": 38995065, "link": "https://stackoverflow.com/questions/38995065/undefined-reference-to-unity-begin-and-unity-end", "title": "undefined reference to `UNITY_BEGIN&#39; and &#39;UNITY_END&#39;", "body": "<p>I want to use <a href=\"http://www.throwtheswitch.org/unity/\" rel=\"nofollow\">Unity</a> for making unit test on my C code but I get the following error when compiling:</p>\n\n<pre><code>$ make\ngcc  ../Unity/src/unity.o src/helpers.o src/chess.o src/search.o test/TestCheck.o src/main.o -o checkai\nsrc/main.o: In function `main':\nmain.c:(.text+0x4b): undefined reference to `UNITY_BEGIN'\nmain.c:(.text+0x55): undefined reference to `UNITY_END'\ncollect2: error: ld returned 1 exit status\nmake: *** [Makefile:11: checkai] Error 1\n$ make -n\ngcc  ../Unity/src/unity.o src/helpers.o src/chess.o src/search.o test/TestCheck.o src/main.o -o checkai\n</code></pre>\n\n<p>My main functon just looks like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include \"helpers.h\"\n#include \"chess.h\"\n\n#include \"../../Unity/src/unity.h\"\n//#include \"../test/TestCheck.h\"\n\nvoid test_Smoke(void) {\n    TEST_ASSERT_EQUAL_INT(1, 2);\n}\n\nint main() {\n    version();\n\n    chesspiece chessboard[8][8];\n    initField(chessboard);\n\n    UNITY_BEGIN();\n    RUN_TEST(test_Smoke, 1);\n    return UNITY_END();\n}\n</code></pre>\n\n<p>Do I link something incorrectly? I already tried to change the order of the gcc command but nothing has helped yet.\nWhen I comment out <code>UNITY_BEGIN</code> and <code>UNITY_END</code> I can compile it and the smoke test runs without problems.</p>\n"}, {"tags": ["c", "ffmpeg"], "answers": [{"comments": [{"owner": {"reputation": 2395, "user_id": 3399693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b28819741eb74ef313b9bc7159993028?s=128&d=identicon&r=PG&f=1", "display_name": "laalaguer", "link": "https://stackoverflow.com/users/3399693/laalaguer"}, "edited": false, "score": 0, "creation_date": 1475050206, "post_id": 39012696, "comment_id": 66780271, "body": "I don&#39;t get it, why someone vote -1??? At least leave a comment."}, {"owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "reply_to_user": {"reputation": 2395, "user_id": 3399693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b28819741eb74ef313b9bc7159993028?s=128&d=identicon&r=PG&f=1", "display_name": "laalaguer", "link": "https://stackoverflow.com/users/3399693/laalaguer"}, "edited": false, "score": 0, "creation_date": 1475057169, "post_id": 39012696, "comment_id": 66785226, "body": "forget it, i don&#39;t care :-)"}], "tags": [], "owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1471507947, "last_edit_date": 1471507947, "creation_date": 1471506869, "answer_id": 39012696, "question_id": 38995044, "link": "https://stackoverflow.com/questions/38995044/errors-of-vagetdisplay-and-vagetdisplaydrm/39012696#39012696", "title": "errors of &#39;vaGetDisplay&#39; and `vaGetDisplayDRM&#39;", "body": "<p>after adding -lva-drm and -lva-x11 into Makefile, my compiler complains no error any more :-)</p>\n"}, {"comments": [{"owner": {"reputation": 2395, "user_id": 3399693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b28819741eb74ef313b9bc7159993028?s=128&d=identicon&r=PG&f=1", "display_name": "laalaguer", "link": "https://stackoverflow.com/users/3399693/laalaguer"}, "edited": false, "score": 0, "creation_date": 1475050190, "post_id": 39217028, "comment_id": 66780262, "body": "I don&#39;t get it, why someone vote -1??? At least leave a comment."}, {"owner": {"reputation": 123770, "user_id": 2830850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e48b39b77bf324de9aeefd6c5bfc10c6?s=128&d=identicon&r=PG&f=1", "display_name": "Tarun Lalwani", "link": "https://stackoverflow.com/users/2830850/tarun-lalwani"}, "edited": false, "score": 0, "creation_date": 1507061432, "post_id": 39217028, "comment_id": 80059661, "body": "Can you specify exactly where you made these changes? It is not clear from your answer"}, {"owner": {"reputation": 1290, "user_id": 3741686, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/OBCXg.jpg?s=128&g=1", "display_name": "Davood Falahati", "link": "https://stackoverflow.com/users/3741686/davood-falahati"}, "edited": false, "score": 0, "creation_date": 1512859334, "post_id": 39217028, "comment_id": 82428511, "body": "i get this error : /home/myuser/ffmpeg_sources/ffmpeg/libavutil/hwcontext_vaapi&zwnj;&#8203;.c:1275: error: undefined reference to `vaGetDisplay&#39;"}], "tags": [], "owner": {"reputation": 2395, "user_id": 3399693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b28819741eb74ef313b9bc7159993028?s=128&d=identicon&r=PG&f=1", "display_name": "laalaguer", "link": "https://stackoverflow.com/users/3399693/laalaguer"}, "is_accepted": false, "score": 3, "last_activity_date": 1543486710, "last_edit_date": 1543486710, "creation_date": 1472516069, "answer_id": 39217028, "question_id": 38995044, "link": "https://stackoverflow.com/questions/38995044/errors-of-vagetdisplay-and-vagetdisplaydrm/39217028#39217028", "title": "errors of &#39;vaGetDisplay&#39; and `vaGetDisplayDRM&#39;", "body": "<p>I got the exact same problem when I was trying to compile the latest ffmpeg source code examples. (2016-08-25)</p>\n\n<p>When I have done compiling ffmpeg source, (all dependencies good), then I go to dir:</p>\n\n<pre><code>~/ffmpeg_build/share/ffmpeg/examples$\n</code></pre>\n\n<p>do:</p>\n\n<pre><code>export PKG_CONFIG_PATH=\"$HOME/ffmpeg_build/lib/pkgconfig\"\n</code></pre>\n\n<p>and as instructed as README:</p>\n\n<pre><code>make\n</code></pre>\n\n<p>I got the C files compiled to .o files but cannot get linked. Same error output as:</p>\n\n<pre><code>jack@jack-virtual-machine:~/ffmpeg_build/share/ffmpeg/examples$ make\ncc   avio_reading.o  -pthread -L/home/jack/ffmpeg_build/lib -lavdevice -lavfilter -lpostproc -lavformat -lavcodec -lvdpau -lva-drm -lva-x11 -lva -lxcb-shm -lxcb-xfixes -lxcb-render -lxcb-shape -lxcb -lXau -lXdmcp -lSDL -lasound -lpulse-simple -lpulse -lX11 -lXext -lcaca -lx265 -lstdc++ -lrt -lx264 -ldl -lvpx -lpthread -lvorbisenc -lvorbis -ltheoraenc -ltheoradec -logg -lopus -lmp3lame -lfdk-aac -lass -lharfbuzz -lfontconfig -lfribidi -lexpat -lfreetype -lpng12 -llzma -lbz2 -lz -lswresample -lswscale -lavutil -lm    -o avio_reading\n/home/jack/ffmpeg_build/lib/libavutil.a(hwcontext_vaapi.o): In function `vaapi_device_free':\n/home/jack/ffmpeg_source/FFmpeg/libavutil/hwcontext_vaapi.c:861: undefined reference to `XCloseDisplay'\n/home/jack/ffmpeg_build/lib/libavutil.a(hwcontext_vaapi.o): In function `vaapi_device_create':\n/home/jack/ffmpeg_source/FFmpeg/libavutil/hwcontext_vaapi.c:891: undefined reference to `XOpenDisplay'\n/home/jack/ffmpeg_source/FFmpeg/libavutil/hwcontext_vaapi.c:896: undefined reference to `vaGetDisplay'\n/home/jack/ffmpeg_source/FFmpeg/libavutil/hwcontext_vaapi.c:903: undefined reference to `XDisplayName'\n/home/jack/ffmpeg_source/FFmpeg/libavutil/hwcontext_vaapi.c:917: undefined reference to `vaGetDisplayDRM'\n/home/jack/ffmpeg_source/FFmpeg/libavutil/hwcontext_vaapi.c:893: undefined reference to `XDisplayName'\n/home/jack/ffmpeg_source/FFmpeg/libavutil/hwcontext_vaapi.c:898: undefined reference to `XDisplayName'\n/home/jack/ffmpeg_build/lib/libavutil.a(hwcontext_vdpau.o): In function `vdpau_device_create':\n/home/jack/ffmpeg_source/FFmpeg/libavutil/hwcontext_vdpau.c:431: undefined reference to `XOpenDisplay'\n/home/jack/ffmpeg_source/FFmpeg/libavutil/hwcontext_vdpau.c:437: undefined reference to `XDisplayString'\n/home/jack/ffmpeg_source/FFmpeg/libavutil/hwcontext_vdpau.c:439: undefined reference to `XDefaultScreen'\n/home/jack/ffmpeg_source/FFmpeg/libavutil/hwcontext_vdpau.c:439: undefined reference to `vdp_device_create_x11'\n/home/jack/ffmpeg_source/FFmpeg/libavutil/hwcontext_vdpau.c:433: undefined reference to `XDisplayName'\n/home/jack/ffmpeg_build/lib/libavutil.a(hwcontext_vdpau.o): In function `vdpau_device_free':\n/home/jack/ffmpeg_source/FFmpeg/libavutil/hwcontext_vdpau.c:410: undefined reference to `XCloseDisplay'\ncollect2: error: ld returned 1 exit status\nmake: *** [avio_reading] Error 1\n</code></pre>\n\n<p>I checked your solution here and discovered that although ffmpeg team are using\n<code>pkg-config</code> tool to config, but in the end it is a <code>gcc</code> command line to compile. (see the seconde line of code snippet above)</p>\n\n<p>All the flags below shall be moved to the end of <code>gcc</code> command line just before the <code>-o</code> option:</p>\n\n<p><code>-lX11 -lm  -lvdpau -lva -lva-drm -lva-x11</code></p>\n\n<p>So <strong><em>instead</em></strong> of compiling with the next command line:(the command is long, scroll to right to see full)</p>\n\n<pre><code>cc   avio_reading.o  -pthread -L/home/jack/ffmpeg_build/lib -lavdevice -lavfilter -lpostproc -lavformat -lavcodec -lvdpau -lva-drm -lva-x11 -lva -lxcb-shm -lxcb-xfixes -lxcb-render -lxcb-shape -lxcb -lXau -lXdmcp -lSDL -lasound -lpulse-simple -lpulse -lX11 -lXext -lcaca -lx265 -lstdc++ -lrt -lx264 -ldl -lvpx -lpthread -lvorbisenc -lvorbis -ltheoraenc -ltheoradec -logg -lopus -lmp3lame -lfdk-aac -lass -lharfbuzz -lfontconfig -lfribidi -lexpat -lfreetype -lpng12 -llzma -lbz2 -lz -lswresample -lswscale -lavutil -lm    -o avio_reading\n</code></pre>\n\n<p>I move <strong><em>the flags to the right side end</em></strong> and compile with:(the command is long, scroll to right to see full)</p>\n\n<pre><code>cc   avio_dir_cmd.o  -pthread -L/home/jack/ffmpeg_build/lib -lavdevice -lavfilter -lpostproc -lavformat -lavcodec -lxcb-shm -lxcb-xfixes -lxcb-render -lxcb-shape -lxcb -lXau -lXdmcp -lSDL -lasound -lpulse-simple -lpulse -lXext -lcaca -lx265 -lstdc++ -lrt -lx264 -ldl -lvpx -lpthread -lvorbisenc -lvorbis -ltheoraenc -ltheoradec -logg -lopus -lmp3lame -lfdk-aac -lass -lharfbuzz -lfontconfig -lfribidi -lexpat -lfreetype -lpng12 -llzma -lbz2 -lz -lswresample -lswscale -lavutil  -lX11 -lm  -lvdpau -lva -lva-drm -lva-x11 -o avio_dir_cmd\n</code></pre>\n\n<p>And all the compile errors are gone~!\nI think this is a common error when we compile other examples, or our own projects.</p>\n"}], "owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3983, "favorite_count": 0, "closed_date": 1476062547, "answer_count": 2, "score": 3, "last_activity_date": 1543486710, "creation_date": 1471432395, "last_edit_date": 1471508178, "question_id": 38995044, "link": "https://stackoverflow.com/questions/38995044/errors-of-vagetdisplay-and-vagetdisplaydrm", "closed_reason": "Duplicate", "title": "errors of &#39;vaGetDisplay&#39; and `vaGetDisplayDRM&#39;", "body": "<p>After updating my ubuntu OS from 14.04 to 16.04, I installed the ffmpeg library using the following configurations:</p>\n\n<pre><code>PATH=\"$HOME/bin:$PATH\" PKG_CONFIG_PATH=\"$HOME/ffmpeg_build/lib/pkgconfig\" ./configure \\\n  --prefix=\"$HOME/ffmpeg_build\" \\\n  --pkg-config-flags=\"--static\" \\\n  --extra-cflags=\"-I$HOME/ffmpeg_build/include\" \\\n  --extra-ldflags=\"-L$HOME/ffmpeg_build/lib\" \\\n  --bindir=\"$HOME/bin\" \\\n  --enable-gpl \\\n  --enable-libass \\\n  --enable-libfdk-aac \\\n  --enable-libfreetype \\\n  --enable-libmp3lame \\\n  --enable-libopus \\\n  --enable-libtheora \\\n  --enable-libvorbis \\\n  --enable-libvpx \\\n  --enable-libx264 \\\n  --enable-nonfree\nPATH=\"$HOME/bin:$PATH\" make\nmake install\n</code></pre>\n\n<p>It seemed to me the installation process was ok. After that, I tried to compile my own C source code with the following Makefile:</p>\n\n<p><strong>EDITTED</strong>(adding -lva-drm -lva-x11 at line 10)</p>\n\n<pre><code>FFMPEG_LIBS=    libavdevice                        \\\n                libavformat                        \\\n                libavfilter                        \\\n                libavcodec                         \\\n                libswresample                      \\\n                libswscale                         \\\n                libavutil                          \\\n\nTARGET = video_analysis\nLIBS = -lva -lX11 -lvdpau -lm -lva-drm -lva-x11\nCC = gcc\nCFLAGS += -O2 -g -O0\nCFLAGS := $(shell pkg-config --cflags $(FFMPEG_LIBS)) $(CFLAGS)\nLDLIBS := $(shell pkg-config --libs $(FFMPEG_LIBS)) $(LDLIBS)\n\n.PHONY: default all clean\n\ndefault: $(TARGET)\nall: default\n\nOBJECTS = $(patsubst %.c, %.o, $(wildcard *.c))\nHEADERS = $(wildcard *.h)\n\n%.o: %.c $(HEADERS)\n        $(CC) $(CFLAGS) -c $&lt; -o $@\n\n.PRECIOUS: $(TARGET) $(OBJECTS)\n\n$(TARGET): $(OBJECTS)\n    $(CC) $(OBJECTS) $(LDLIBS) $(LIBS) -o $@\n\nclean:\n    -rm -f *.o\n    -rm -f $(TARGET)\n</code></pre>\n\n<p>However, my compiler complained the following errors:</p>\n\n<pre><code>/root/ffmpeg_build/lib/libavutil.a(hwcontext_vaapi.o): In function `vaapi_device_create':\n/home/widerstand/ffmpeg_sources/ffmpeg/libavutil/hwcontext_vaapi.c:896: undefined reference to `vaGetDisplay'\n/home/widerstand/ffmpeg_sources/ffmpeg/libavutil/hwcontext_vaapi.c:917: undefined reference to `vaGetDisplayDRM'\ncollect2: error: ld returned 1 exit status\nMakefile:30: recipe for target 'video_analysis' failed\nmake: *** [video_analysis] Error 1\n</code></pre>\n\n<p>My question is: in which library do 'vaGetDisplay' and `vaGetDisplayDRM' exist? It's for sure that libva functions properly. I have no clue how to fix the bugs...Thank you in advance!</p>\n"}, {"tags": ["c", "linux", "sockets", "networking", "tcp"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1471431288, "post_id": 38994581, "comment_id": 65341011, "body": "Are you setting TCP_NODELAY or otherwise disabling Nagling? If so, that&#39;s your problem. How exactly are you sending TCP packets? (Most likely, you are doing something wrong in your TCP code, whatever it is.)"}, {"owner": {"reputation": 11, "user_id": 6725762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/296fa368afe4e4d444764d61b6639ad4?s=128&d=identicon&r=PG&f=1", "display_name": "Alban Deruaz", "link": "https://stackoverflow.com/users/6725762/alban-deruaz"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1471431870, "post_id": 38994581, "comment_id": 65341362, "body": "Nagling is not disabled, I will try to see if it improves!"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 2, "creation_date": 1471432068, "post_id": 38994581, "comment_id": 65341495, "body": "Why are you trying to micromanage TCP this way? Do you think you can do a better job than the kernel?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1471432471, "post_id": 38994581, "comment_id": 65341778, "body": "If you&#39;re losing UDP packets your connection is indeed saturated somewhere."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1471448429, "post_id": 38994581, "comment_id": 65353630, "body": "do you know where they are getting dropped? If you can, use a 3rd machine to capture the wireless traffic in promiscuous mode. That will be a good check to see if they&#39;re even making it into the air."}, {"owner": {"reputation": 11, "user_id": 6725762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/296fa368afe4e4d444764d61b6639ad4?s=128&d=identicon&r=PG&f=1", "display_name": "Alban Deruaz", "link": "https://stackoverflow.com/users/6725762/alban-deruaz"}, "edited": false, "score": 0, "creation_date": 1471457467, "post_id": 38994581, "comment_id": 65358729, "body": "Thanks for your comments. i&#39;ve disabled Nagle algorithm, it didn&#39;t improve. I&#39;ll try sniffing packets to see if it reaches the router!"}], "owner": {"reputation": 11, "user_id": 6725762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/296fa368afe4e4d444764d61b6639ad4?s=128&d=identicon&r=PG&f=1", "display_name": "Alban Deruaz", "link": "https://stackoverflow.com/users/6725762/alban-deruaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "closed_date": 1471432477, "answer_count": 0, "score": 1, "last_activity_date": 1471431842, "creation_date": 1471431024, "last_edit_date": 1495541314, "question_id": 38994581, "link": "https://stackoverflow.com/questions/38994581/sending-udp-and-tcp-packets-on-the-same-network-line-how-to-prevent-udp-drops", "closed_reason": "Duplicate", "title": "Sending UDP and TCP packets on the same network line - how to prevent UDP drops?", "body": "<p>I am sending tcp and udp packets to another computer over a wireless connection, using linux sockets in C. TCP packets are sent in chunks of 16KB in a thread, and UDP packets are sent in chunks of 512 bytes in another thread.</p>\n\n<p>I can change the number of TCP packets per second.\nWhen I set a low TCP frequency, I receive every UDP packets.\nHowever, when I start increasing the TCP packet frequency, I start loosing many UDP packets on the receiving side. (95% packets loss when overall bandwidth uses as little as 20% of my wireless' real bandwidth (which is around 3MB/s) )</p>\n\n<p>I know the UDP protocol is a send a pray mechanism, but I would expect to have a low rate of lost packets when the total network bandwidth is far from being saturated!</p>\n\n<ul>\n<li>This is not a duplicate of <a href=\"https://stackoverflow.com/questions/5446302/prevent-tcp-connections-from-causing-udp-packet-loss\">Prevent TCP connections from causing UDP packet loss</a> because my connection is not saturated</li>\n<li>I don't want to send the UDP data embedded in the TCP packets</li>\n<li>I don't mind if some packets are dropped</li>\n</ul>\n\n<p>I have made a second experiment:\nI launched a file transfer with samba while sending udp packets (going towards the target computer). The connection is saturated due to the file transfer (at around 3MB/s), but the UDP packet drop rate is acceptable (around 10%)!!</p>\n\n<p>Why do I get so many drops in a non saturated environment when I'm sending the TCP packets myself? The difference is quite astonishing.</p>\n\n<p>Thank you for your help!</p>\n\n<p>Here is the way the packets are sent:\nInitialization of the socket:</p>\n\n<pre><code>printf(\"Creating socket and listening on port %i\\n\",Params::tcpOutPort);\nsockfd = socket(AF_INET, SOCK_STREAM, 0);\nif (sockfd &lt; 0) \n    printf(\"ERROR opening socket\\n\");\nbzero((char *) &amp;serv_addr, sizeof(serv_addr));\nserv_addr.sin_family = AF_INET;\nserv_addr.sin_addr.s_addr = INADDR_ANY;\nserv_addr.sin_port = htons(Params::tcpOutPort);\n\nint opt=1;\nsetsockopt(sockfd,SOL_SOCKET,SO_REUSEADDR,(const char *)&amp;opt,sizeof(int));\n\nif (bind(sockfd, (struct sockaddr *) &amp;serv_addr,sizeof(serv_addr)) &lt; 0) \n    printf(\"ERROR on binding\\n\");\nlisten(sockfd,5);\nclilen = sizeof(cli_addr);\nnewsockfd = accept(sockfd, (struct sockaddr *) &amp;cli_addr, &amp;clilen);\nif (newsockfd &lt; 0) \n    printf(\"ERROR on accept\\n\");\nelse printf(\"Connected!\\n\");\n</code></pre>\n\n<p>Sending a packet: </p>\n\n<pre><code>leftToSend = size;\nwhile(leftToSend &gt; 0)\n{\n    sent = send(newsockfd,buf+alreadySent,leftToSend &gt; send_blocks ? send_blocks : leftToSend,0);\n    if(sent &gt; -1)\n    {\n        alreadySent += sent;\n        leftToSend -= sent;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "benchmarking", "inline-assembly", "rdtsc"], "comments": [{"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 2, "creation_date": 1471432029, "post_id": 38994549, "comment_id": 65341469, "body": "I&#39;m not expert on GCC inline syntax, but I&#39;d guess that in the second version GCC will generate the <i>movs</i> by itself, so it is a matter of readability. Side note: Shouldn&#39;t <code>rdtsc</code>be <i>surrounded</i> by serializing instructions, not just before? I usually use <code>lfence</code> in favor of <code>CPUID</code> since is it locally serializing and doesn&#39;t clobber any register."}, {"owner": {"reputation": 2731, "user_id": 109414, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2b68fe77303968e573ca1e7004462ae7?s=128&d=identicon&r=PG", "display_name": "Edd Barrett", "link": "https://stackoverflow.com/users/109414/edd-barrett"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1471432197, "post_id": 38994549, "comment_id": 65341570, "body": "I would expect a semi-clever compiler to re-use the output register for the local variable, but I might be wrong."}, {"owner": {"reputation": 2731, "user_id": 109414, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2b68fe77303968e573ca1e7004462ae7?s=128&d=identicon&r=PG", "display_name": "Edd Barrett", "link": "https://stackoverflow.com/users/109414/edd-barrett"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1471432230, "post_id": 38994549, "comment_id": 65341591, "body": "Regarding the <code>lfence</code>, do you have a source which demonstrates?"}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1471432593, "post_id": 38994549, "comment_id": 65341872, "body": "True, indeed. Regarding <code>lfence</code>, what demonstration are you looking for? <code>lfence</code> can be found on the <i>Intel Manual 2</i> where is said it is locally serializing."}, {"owner": {"reputation": 2731, "user_id": 109414, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2b68fe77303968e573ca1e7004462ae7?s=128&d=identicon&r=PG", "display_name": "Edd Barrett", "link": "https://stackoverflow.com/users/109414/edd-barrett"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1471432914, "post_id": 38994549, "comment_id": 65342139, "body": "I was wondering if you had seen <code>lfence</code> it in the context of benchmarking with the TSR. I wonder if the <code>cpuid</code> calls serve the same purpose..."}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 1, "creation_date": 1471435337, "post_id": 38994549, "comment_id": 65343735, "body": "There is something interesting <a href=\"http://akaros.cs.berkeley.edu/lxr/akaros/kern/arch/x86/rdtsc_test.c\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1534606096, "post_id": 38994549, "comment_id": 90770313, "body": "Don&#39;t use <code>rdtsc</code> to measure CPU time (since context switches can occur at any moment). Use OS specific functions (on Linux, see <a href=\"http://man7.org/linux/man-pages/man7/time.7.html\" rel=\"nofollow noreferrer\">time(7)</a> then use <a href=\"http://man7.org/linux/man-pages/man2/clock_gettime.2.html\" rel=\"nofollow noreferrer\">clock_gettime(2)</a>...)"}], "answers": [{"comments": [{"owner": {"reputation": 2731, "user_id": 109414, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2b68fe77303968e573ca1e7004462ae7?s=128&d=identicon&r=PG", "display_name": "Edd Barrett", "link": "https://stackoverflow.com/users/109414/edd-barrett"}, "edited": false, "score": 0, "creation_date": 1471516648, "post_id": 39002894, "comment_id": 65382471, "body": "Thanks for your answer! Actually, we did not want time at all! We wanted a measure of work independent from time, so that frequency changes cannot skew the result. I&#39;ve found a few performance counters which may help, now I will be looking into a lightweight way to access them without using the sledgehammer that is perf. Hopefully you can program the counters from user-space asm code."}, {"owner": {"reputation": 2731, "user_id": 109414, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2b68fe77303968e573ca1e7004462ae7?s=128&d=identicon&r=PG", "display_name": "Edd Barrett", "link": "https://stackoverflow.com/users/109414/edd-barrett"}, "edited": false, "score": 0, "creation_date": 1471533155, "post_id": 39002894, "comment_id": 65393964, "body": "Or maybe you can&#39;t: <a href=\"http://stackoverflow.com/questions/39021662/how-to-configure-and-sample-intel-performance-counters-in-process\" title=\"how to configure and sample intel performance counters in process\">stackoverflow.com/questions/39021662/&hellip;</a>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 2731, "user_id": 109414, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2b68fe77303968e573ca1e7004462ae7?s=128&d=identicon&r=PG", "display_name": "Edd Barrett", "link": "https://stackoverflow.com/users/109414/edd-barrett"}, "edited": false, "score": 0, "creation_date": 1471533580, "post_id": 39002894, "comment_id": 65394272, "body": "You can program counters from user space, but you probably want to pin your threads to cores because PMCs aren&#39;t saved/restored on context switches.  See <a href=\"http://agner.org/optimize/\" rel=\"nofollow noreferrer\">agner.org/optimize</a> for an existing kernel module that gives you PMC access, and also <a href=\"http://stackoverflow.com/questions/38848914/pmu-for-multi-threaded-environment/38984414#38984414\" title=\"pmu for multi threaded environment\">stackoverflow.com/questions/38848914/&hellip;</a> for some discussion of using them."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 6, "last_activity_date": 1534604673, "last_edit_date": 1534604673, "creation_date": 1471454888, "answer_id": 39002894, "question_id": 38994549, "link": "https://stackoverflow.com/questions/38994549/is-intels-timestamp-reading-asm-code-example-using-two-more-registers-than-are/39002894#39002894", "title": "Is Intel&#39;s timestamp reading asm code example using two more registers than are necessary?", "body": "<p>You're correct, the example is clunky.  <strong>Usually if <code>mov</code> is the first or last instruction in an inline-asm statement, you're doing it wrong</strong>, and should have used a constraint to tell the compiler where you want the input, or where the output is.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/34520013/using-base-pointer-register-in-c-inline-asm/34522750#34522750\">my GNU C inline asm guides / links collection</a>, and other links in the <a href=\"/questions/tagged/inline-assembly\" class=\"post-tag\" title=\"show questions tagged &#39;inline-assembly&#39;\" rel=\"tag\">inline-assembly</a> tag wiki.  (The <a href=\"/questions/tagged/x86\" class=\"post-tag\" title=\"show questions tagged &#39;x86&#39;\" rel=\"tag\">x86</a> tag wiki is full of good stuff for asm in general, too.)</p>\n\n<hr>\n\n<p><strong>Or for <code>rdtsc</code> specifically, see <a href=\"https://stackoverflow.com/questions/13772567/get-cpu-cycle-count/51907627#51907627\">Get CPU cycle count?</a></strong> for the <code>__rdtsc()</code> intrinsic, and good inline asm in @Mysticial's answer.</p>\n\n<hr>\n\n<blockquote>\n  <p>it measures in a monotonic unit of time which is immune to the clock speed changing.</p>\n</blockquote>\n\n<p>Yes, on CPUs made within the last 10 years or so.</p>\n\n<p>For profiling, it's often more useful to have times in core clock cycles, not wall-clock time, <a href=\"https://stackoverflow.com/questions/38299023/why-does-this-delay-loop-start-to-run-faster-after-several-iterations-with-no-sl/38300014#38300014\">so your microbenchmark results don't depend on power-saving / turbo.</a>  Performance counters can do this and much more.</p>\n\n<p>Still, if real time is what you want, <code>rdtsc</code> is the lowest-overhead way to get it.</p>\n\n<hr>\n\n<p>And re: discussion in comments: yes <code>cpuid</code> is there to serialize, making sure that <code>rdtsc</code> and following instructions can't begin executing until after CPUID.  You could put another CPUID after RDTSC, but that would increase measurement overhead, and I think give near-zero gain in accuracy / precision.</p>\n\n<p>LFENCE is a cheaper alternative that's useful with RDTSC.  The <a href=\"http://www.felixcloutier.com/x86/LFENCE.html\" rel=\"nofollow noreferrer\">instruction ref manual entry</a> documents the fact that it doesn't let later instructions start executing until it and previous instructions have <em>retired</em> (from the ROB/RS in the out-of-order part of the core).  See <a href=\"https://stackoverflow.com/questions/50494658/are-loads-and-stores-the-only-instructions-that-gets-reordered/50496379#50496379\">Are loads and stores the only instructions that gets reordered?</a>, and for a specific example of using it, see <a href=\"https://stackoverflow.com/questions/51818655/clflush-to-invalidate-cache-line-via-c-function/51830976#51830976\">clflush to invalidate cache line via C function</a>.  Unlike true serializing instructions like <code>cpuid</code>, it doesn't flush the store buffer.</p>\n\n<p>(On recent AMD CPUs without Spectre mitigation enabled, <code>lfence</code> is not even partially serializing, and runs at 4 per clock according to <a href=\"https://agner.org/optimize/\" rel=\"nofollow noreferrer\">Agner Fog's testing</a>.  <a href=\"https://stackoverflow.com/questions/51844886/is-lfence-serializing-on-amd-processors\">Is LFENCE serializing on AMD processors?</a>)</p>\n\n<p>Margaret Bloom dug up <a href=\"http://akaros.cs.berkeley.edu/lxr/akaros/kern/arch/x86/rdtsc_test.c\" rel=\"nofollow noreferrer\">this useful link</a>, which also confirms that LFENCE serializes RDTSC according to Intel's SDM, and has some other stuff about how to do serialization around RDTSC.</p>\n"}, {"comments": [{"owner": {"reputation": 2731, "user_id": 109414, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2b68fe77303968e573ca1e7004462ae7?s=128&d=identicon&r=PG", "display_name": "Edd Barrett", "link": "https://stackoverflow.com/users/109414/edd-barrett"}, "edited": false, "score": 0, "creation_date": 1471516554, "post_id": 39002949, "comment_id": 65382405, "body": "Thanks for your answer. If I could mark two answers correct, I would! They do use <code>cpuid</code> in the document, that&#39;s where I got it from, see page 16."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "reply_to_user": {"reputation": 2731, "user_id": 109414, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2b68fe77303968e573ca1e7004462ae7?s=128&d=identicon&r=PG", "display_name": "Edd Barrett", "link": "https://stackoverflow.com/users/109414/edd-barrett"}, "edited": false, "score": 1, "creation_date": 1471534096, "post_id": 39002949, "comment_id": 65394686, "body": "@EddBarrett  Yah, I know, I&#39;m saying that the author also doesn&#39;t know that the CPUID version of the asm statement in the paper can also be simplified in the same way."}, {"owner": {"reputation": 664, "user_id": 2183666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B89GR.jpg?s=128&g=1", "display_name": "parisa", "link": "https://stackoverflow.com/users/2183666/parisa"}, "edited": false, "score": 0, "creation_date": 1532900158, "post_id": 39002949, "comment_id": 90135006, "body": "Are you sure they misused the term IA64? Or they actually meant Itaninum?"}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "reply_to_user": {"reputation": 664, "user_id": 2183666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B89GR.jpg?s=128&g=1", "display_name": "parisa", "link": "https://stackoverflow.com/users/2183666/parisa"}, "edited": false, "score": 2, "creation_date": 1532909504, "post_id": 39002949, "comment_id": 90136627, "body": "@parisa I&#39;m sure. An Itanium CPU has no EAX or RAX registers, and no RDTSC instruction."}], "tags": [], "owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "is_accepted": false, "score": 3, "last_activity_date": 1471455089, "creation_date": 1471455089, "answer_id": 39002949, "question_id": 38994549, "link": "https://stackoverflow.com/questions/38994549/is-intels-timestamp-reading-asm-code-example-using-two-more-registers-than-are/39002949#39002949", "title": "Is Intel&#39;s timestamp reading asm code example using two more registers than are necessary?", "body": "<p>No, there doesn't seem to be a good reason for the redundant MOV instructions in the inline assembly. The paper first introduces inline assembly with the following statement: </p>\n\n<pre><code>asm volatile (\n    \"RDTSC\\n\\t\"\n    \"mov %%edx, %0\\n\\t\"\n    \"mov %%eax, %1\\n\\t\": \"=r\" (cycles_high1), \"=r\" (cycles_low1));\n</code></pre>\n\n<p>This has the obvious problem that it doesn't tell the compiler that EAX and EDX have been modified by the RDTSC instruction.  The paper points out this mistake and corrects it using clobbers:</p>\n\n<pre><code>asm volatile (\"RDTSC\\n\\t\"\n    \"mov %%edx, %0\\n\\t\"\n    \"mov %%eax, %1\\n\\t\": \"=r\" (cycles_high), \"=r\" (cycles_low)::\n    \u201c%eax\u201d, \u201c%edx\u201d)\n</code></pre>\n\n<p>No other justification is given for writing it this way other than correcting the mistake in the previous example. It appears that the paper's author is simply unaware that it could be written more simply as:</p>\n\n<pre><code>asm volatile (\"RDTSC\\n\\t\"\n    : \"=d\" (cycles_high), \"=a\" (cycles_low));\n</code></pre>\n\n<p>Similarly the author is apparently unaware that there's a simpler version of the improved asm statement that uses RDTSC in combination with CPUID, as you demonstrate in your post.</p>\n\n<p>Note that the author of the paper repeatedly misuses the term \"IA64\" to refer the 64-bit x86 instruction set and architecture (variously referred as x86_64, AMD64 and Intel 64). The <a href=\"https://en.wikipedia.org/wiki/IA-64\" rel=\"nofollow\">IA-64</a> architecture is actually something completely different, it's the one used by Intel's Itaninum CPUs. It has no EAX or RAX registers, and no RDTSC instruction.</p>\n\n<p>While the it doesn't really matter that the authors inline assembly is more complex than it needs to be, this fact combined with the misuse of IA64, something that should've caught by Intel's editors, makes me doubt the credibility of this paper.</p>\n"}], "owner": {"reputation": 2731, "user_id": 109414, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2b68fe77303968e573ca1e7004462ae7?s=128&d=identicon&r=PG", "display_name": "Edd Barrett", "link": "https://stackoverflow.com/users/109414/edd-barrett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1037, "favorite_count": 3, "accepted_answer_id": 39002894, "answer_count": 2, "score": 9, "last_activity_date": 1534614737, "creation_date": 1471430960, "last_edit_date": 1534614737, "question_id": 38994549, "link": "https://stackoverflow.com/questions/38994549/is-intels-timestamp-reading-asm-code-example-using-two-more-registers-than-are", "title": "Is Intel&#39;s timestamp reading asm code example using two more registers than are necessary?", "body": "<p>I'm looking into measuring benchmark performance using the time-stamp register (TSR) found in x86 CPUs. It's a useful register, since it measures in a monotonic unit of time which is immune to the clock\nspeed changing. Very cool.</p>\n\n<p>Here is an Intel document showing asm snippets for reliably benchmarking using the TSR, including using cpuid for pipeline synchronisation. See page 16:</p>\n\n<p><a href=\"http://www.intel.com/content/www/us/en/embedded/training/ia-32-ia-64-benchmark-code-execution-paper.html\" rel=\"noreferrer\">http://www.intel.com/content/www/us/en/embedded/training/ia-32-ia-64-benchmark-code-execution-paper.html</a></p>\n\n<p>To read the start time, it says (I annotated a bit):</p>\n\n<pre><code>__asm volatile (\n    \"cpuid\\n\\t\"             // writes e[abcd]x\n    \"rdtsc\\n\\t\"             // writes edx, eax\n    \"mov %%edx, %0\\n\\t\" \n    \"mov %%eax, %1\\n\\t\"\n    //\n    :\"=r\" (cycles_high), \"=r\" (cycles_low)  // outputs\n    :                                       // inputs\n    :\"%rax\", \"%rbx\", \"%rcx\", \"%rdx\");       // clobber\n</code></pre>\n\n<p>I'm wondering why scratch registers are used to take the values of <code>edx</code>\nand <code>eax</code>. Why not remove the movs and read the TSR value right out of <code>edx</code>\nand <code>eax</code>? Like this:</p>\n\n<pre><code>__asm volatile(                                                             \n    \"cpuid\\n\\t\"\n    \"rdtsc\\n\\t\"\n    //\n    : \"=d\" (cycles_high), \"=a\" (cycles_low) // outputs\n    :                                       // inputs\n    : \"%rbx\", \"%rcx\");                      // clobber     \n</code></pre>\n\n<p>By doing this, you save two registers, reducing the likelihood of the C\ncompiler needing to spill.</p>\n\n<p>Am I right? Or those MOVs are somehow strategic?</p>\n\n<p>(I agree that you do need scratch registers to read the <em>stop</em> time, as\nin that scenario the order of the instructions is reversed: you have\nrdtscp, ..., cpuid. The cpuid instruction destroys the result of rdtscp).</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "arrays", "windows", "pointers", "memory"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1471432641, "post_id": 38994447, "comment_id": 65341908, "body": "Try checking strings in <code>argv</code>, do they actually get re-used? If they do, then you can&#39;t just copy <code>argv</code>, you need to copy each string."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1471436683, "post_id": 38994447, "comment_id": 65344654, "body": "Beware: you speak of 2D/3D arrays, but your code if for arrays of pointers which are different animals..."}, {"owner": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1471437387, "post_id": 38994447, "comment_id": 65345146, "body": "@hyde what do you mean with &quot;get re-used&quot;? I printed out the <i>entries</i> array afterwards and all data was where it should be, also the <i>argv</i> array always contained the current dataset for each callback."}, {"owner": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1471437502, "post_id": 38994447, "comment_id": 65345235, "body": "@SergeBallesta Sorry, yes you&#39;re right."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1471437820, "post_id": 38994447, "comment_id": 65345489, "body": "I mean, you have <code>argv</code> array of pointers to strings (char buffers). You stored the pointers to these buffers to <code>entries[0]</code>. If they get re-used and their contents changed, then it looks like <code>entries[0]</code> changed (the pointers didn&#39;t change, but the data at the char buffers they point to did)."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1471437990, "post_id": 38994447, "comment_id": 65345623, "body": "Use something like <code>printf(&quot;entries[%d][0]=%p&quot;, cbCount, entries[cbCount][0])</code> after your <code>memcpy</code> to see the pointer values nicely."}, {"owner": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1471442191, "post_id": 38994447, "comment_id": 65348975, "body": "@hyde Ah I get it! Since I just memcpy the 2D array with always the same pointers in the first dimension, the values in the 2nd dimension, accessed by the non-changing pointers, seem to never change! Thanks alot. I guess the best way to solve this is to copy plain values while recreating the structure manually again?"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1471442281, "post_id": 38994447, "comment_id": 65349042, "body": "So you checked that this indeed is the problem? If so, I can write an actual answer for it."}, {"owner": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "edited": false, "score": 0, "creation_date": 1471445343, "post_id": 38994447, "comment_id": 65351523, "body": "Yes I think so, the first element of the 2nd dimension points always to the same adress."}, {"owner": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1471532146, "post_id": 38994447, "comment_id": 65393302, "body": "@hyde I didn&#39;t mention you, I hope you were notified anyway!"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1471550714, "post_id": 38994447, "comment_id": 65404143, "body": "No, only the poster of question/answer gets notified, unless you include the @ mention. Anyway, wrote an answer. Feel free to edit it if you want, or let me know if I got it wrong."}, {"owner": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1471552371, "post_id": 38994447, "comment_id": 65404972, "body": "@hyde Good to know. I&#39;m pretty sure that&#39;s the correct answer, going to try this out tomorrow and come back if it&#39;s not, thank you very much!"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1471552520, "post_id": 38994447, "comment_id": 65405041, "body": "Feel free to unaccept the answer and let me know if it&#39;s not right. A bit strange that <a href=\"https://www.sqlite.org/c3ref/exec.html\" rel=\"nofollow noreferrer\">sqlite.org/c3ref/exec.html</a> doesn&#39;t seem to indicate how the <code>argv</code> array should be used... Maybe it&#39;s explained elsewhere in the documentation."}], "answers": [{"tags": [], "owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "is_accepted": true, "score": 1, "last_activity_date": 1471550639, "creation_date": 1471550639, "answer_id": 39026626, "question_id": 38994447, "link": "https://stackoverflow.com/questions/38994447/storing-2d-arrays-in-3d-array/39026626#39026626", "title": "Storing 2D arrays in 3D array", "body": "<p>Converting comments to an answer:</p>\n\n<p>It looks like sqlite re-uses buffers, and actually passes same pointers in the <code>argv</code> vector for different calls.</p>\n\n<p>So when your <code>insertListEntries</code> is called first time (<code>cbCount</code> 0), parameter <code>argv</code> might contain pointer values <code>{ 0x1111100, 0x1111200, 0x1111300, ... }</code>, which you copy to your <code>entries[0]</code> array.</p>\n\n<p>Then, when  <code>insertListEntries</code> is called second time (<code>cbCount</code> 1), the pointer values in <code>argv</code> are at least partially or sometimes the same! This means, the buffers allocated for result data are re-used, their contents changed. Because you copied the pointers to <code>entries[0]</code>, and now copy the possibly same pointers to <code>entries[1]</code>, they will point to same strings, which get overwritten for every call.</p>\n\n<p>Solution is to copy the actual strings, the actual data, instead of just copying pointers to the library's internal buffers.</p>\n"}], "owner": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 39026626, "answer_count": 1, "score": 0, "last_activity_date": 1471550639, "creation_date": 1471430676, "last_edit_date": 1471431235, "question_id": 38994447, "link": "https://stackoverflow.com/questions/38994447/storing-2d-arrays-in-3d-array", "title": "Storing 2D arrays in 3D array", "body": "<p>I'm currently trying to write a callback function for a database request.\nThe function is called for every result/database entry/row, and I want to store its 2D array (array of strings/char *) in an array.\nMy current solution looks like this:</p>\n\n<p>Global declaration:</p>\n\n<pre><code>char ***entries;\n</code></pre>\n\n<p>Allocating memory for the first dimension in a setup function:</p>\n\n<pre><code>entries = HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, sizeof(char **)*200);\n</code></pre>\n\n<p>I'm working with the Windows API/Win32, basically it's malloc with zeroed memory and the last parameter referring to the size.</p>\n\n<p>Initialising callback count and registering callback function for database execute:</p>\n\n<pre><code>cbCount = 0;\nrc = sqlite3_exec(db, sql, insertListEntries, 0, &amp;zErrMsg);\n</code></pre>\n\n<p>Callback function:</p>\n\n<pre><code>static int insertListEntries(void *NotUsed, int argc, char **argv, char **azColName) {\n    entries[cbCount] = HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, sizeof(argv)*argc); \n    memcpy(entries[cbCount], argv, sizeof(argv)*argc);\n    ...\n    cbCount++;\n}\n</code></pre>\n\n<p>Parameters: argc is the size of argv/columns of the data, and argv the string array with the row data. \nI'm simply copying the memory data of argv into the 3D array.</p>\n\n<p>However, the problem is now that for each callback all previous data sets are overwritten with the current result like this:</p>\n\n<p>Callback 1: entries[0] = dataset1</p>\n\n<p>Callback 2: entries[0] = dataset2, entries[1] = dataset2</p>\n\n<p>...</p>\n\n<p>Any ideas? I'm still trying to learn this concept of the \"pointer/array-dualism\" and memory allocation, but the best way for me is by doing it practically. Also, I DID study the theory beforehand alot, but I may have missed something.</p>\n\n<p><strong>Edit</strong>: added cbCount++;</p>\n"}, {"tags": ["c", "macros", "strict-aliasing", "type-punning"], "comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1471430537, "post_id": 38993614, "comment_id": 65340537, "body": "It is impossible to determine that from the code you have shown. Present a SSCCE."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1471430549, "post_id": 38993614, "comment_id": 65340544, "body": "Whether this violates the strict aliasing rule depends on the type of the argument passed for <code>X</code>. If the argument is of type <code>u_int16_t*</code> and points to an object with effective type <code>u_int16_t</code>, and its value can be converted to <code>u_int8_t*</code> (<code>u_int8_t</code> has no stricter alignment requirements than <code>u_int16_t</code>), the behavior is well-defined."}, {"owner": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "edited": false, "score": 0, "creation_date": 1471430664, "post_id": 38993614, "comment_id": 65340610, "body": "I also asked here, so this is why I open this question, just wanna think better <a href=\"https://plus.google.com/u/0/+MicheleCampus/posts/YjUFgDQbDy8?cfem=1\" rel=\"nofollow noreferrer\">plus.google.com/u/0/+MicheleCampus/posts/YjUFgDQbDy8?cfem=1</a>"}, {"owner": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "edited": false, "score": 0, "creation_date": 1471430777, "post_id": 38993614, "comment_id": 65340675, "body": "I&#39;ll modify adding an example of a piece of code."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 1, "creation_date": 1471437842, "post_id": 38993614, "comment_id": 65345508, "body": "Even with your recent addition, there&#39;s still not enough to provide a definitive answer. The type of <code>packet-&gt;payload</code> is <code>const unsigned char *</code>, sure, but what type of object is it actually pointing to? (forgetting for now the whole pointer conversion problem, since most compilers treat a pointer type conversion as returning a pointer to the same object). More specifically: what is the <i>effective type</i> (as per 6.5p7) of the object pointed at by <code>packet-&gt;payload</code>?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1471439991, "post_id": 38993614, "comment_id": 65347300, "body": "You didn&#39;t tell us what types are uint8_t and uint16_t. What are the values of i? What is the element count of the payload array? Where is it pointing to. The example is incomplete."}, {"owner": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1471441187, "post_id": 38993614, "comment_id": 65348248, "body": "@2501 I&#39;m edited the question. I inherited this code and I have to solve many bugs, so I also try to understand better. There are many confusional parts."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1471441279, "post_id": 38993614, "comment_id": 65348317, "body": "@Kyrol My comment refers to the question after the edit."}], "answers": [{"comments": [{"owner": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "edited": false, "score": 0, "creation_date": 1471431083, "post_id": 38994531, "comment_id": 65340877, "body": "I&#39;m going to modify the question putting some code on how the macro is used."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1471431216, "post_id": 38994531, "comment_id": 65340968, "body": "Since we don&#39;t know if u_int8_t is a character type, the behavior may be undefined because of conversion between pointers to incompatible types."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1471431508, "post_id": 38994531, "comment_id": 65341154, "body": "@2501 I wonder if it is possible for an 8-bit fixed-width integer to have stricter alignment restrictions than <code>char</code>. Obviously we can&#39;t rule out the possibility for non-standard types like the ones in the question, but if it were <code>uint8_t</code> I&#39;m not sure it <i>can</i> have stricter alignment restrictions than <code>char</code>."}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1471432391, "post_id": 38994531, "comment_id": 65341713, "body": "@EOF alignment is irrelevant; if <code>u_int8_t</code> is not a character type (<code>char</code>, <code>signed char</code> or <code>unsigned char</code> then the cast is illegal if <code>X</code> is not a compatible pointer. True, there are currently no 8-bit integers that are not character types but there is an extant proposal for an 8-bit non-character type to represent UTF-8 data, and it could be something crazy like an enum."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1471432481, "post_id": 38994531, "comment_id": 65341786, "body": "@ecatmur: C11 draft standard n1570: <i>6.3 Conversions 6.3.2.3 Pointers 7 A pointer to an object type may be converted to a pointer to a different object type. If the resulting pointer is not correctly aligned 68) for the referenced type, the behavior is undefined. Otherwise, when converted back again, the result shall compare equal to the original pointer.</i>"}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1471432720, "post_id": 38994531, "comment_id": 65341972, "body": "@EOF good point, but the remainder of that paragraph says that you can only perform pointer arithmetic (<code>+ O</code>) if the pointer is to a character type."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1471432783, "post_id": 38994531, "comment_id": 65342025, "body": "I don&#39;t know what &quot;u_int8&quot; is, but a compiler which doesn&#39;t treat <code>uint8_t</code> as a character type is useless for real-world applications - the C standard be damned. I very much doubt that such a useless compiler exists in the real world."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1471432810, "post_id": 38994531, "comment_id": 65342043, "body": "It seems EOF is correct, and only alignment matters and not compatibility."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1471432852, "post_id": 38994531, "comment_id": 65342080, "body": "@ecatmur I&#39;m not sure if that last sentence applies to the entire paragraph or just the last sentence."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1471432985, "post_id": 38994531, "comment_id": 65342192, "body": "@2501 I&#39;m not actually quite so sure. If we use ecatmur&#39;s approach (which converts the pointer to <code>void*</code>), the pointer is not round-tripped through a different pointer type. The &quot;<i>Otherwise, when converted <b>back</b> [...]</i>&quot; may not be a relevant guarantee."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1471433084, "post_id": 38994531, "comment_id": 65342254, "body": "@2501, no, you&#39;re right in the first place, though the reasoning is difficult. The paragraph quoted by EOF doesn&#39;t say what the result of the conversion in one direction only is, that is to say, converting some pointer to another pointer type is generally allowed, but there&#39;s no stipulations about what it points to (if anything). All that is required is that it points to the original object <i>when converted back</i> to the original type. This macro if used potentially dereferences a pointer that points at an unknown location."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1471433292, "post_id": 38994531, "comment_id": 65342396, "body": "@davmac Yes I agree. Only my reason is not correct. I should have said different type not incompatible type. This is because compatible types may be different."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1471434190, "post_id": 38994531, "comment_id": 65342962, "body": "@davmac: So, I&#39;ve already conceded that the standard doesn&#39;t guarantee this, but it <i>does</i> beg another question. Is it even logically <i>possible</i> to go through a sequence of reversible steps that end up in the same &quot;state&quot; (type) but with a different value? Is type not equivalent to a thermodynamic state function?"}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1471435498, "post_id": 38994531, "comment_id": 65343846, "body": "@EOF I think a strict interpretation of the standard would suggest that this could be possible, yes. In practice of course many (most? nearly all?) compilers implement pointer conversion as no operation at the machine level, and treat the result as a pointer to the same object but with different type."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1471436240, "post_id": 38994531, "comment_id": 65344350, "body": "@davmac: I&#39;m asking about the <i>logical</i> possibility. Even if pointer conversions <i>do</i> cause changes to the bitwise representation, I don&#39;t see how after <code>Ta* a = foo(); Tb* b = (Tb*)a; Ta* c = (Ta*)b;</code> guarantees <code>a == c</code> without also guaranteeing that after <code>Tb *d = (Tb*)c</code>, <code>b == d</code>."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1471436485, "post_id": 38994531, "comment_id": 65344511, "body": "@EOF in your latter example <code>b == d</code> is guaranteed by the original rule - you take a pointer <code>b</code>, convert it to another type and back, so (assuming alignment constraints are not violated) you must have a value that compares equal with <code>b</code>. The wording of your comment prior lead me to believe you were talking about a case of (in terms of types) A -&gt; B -&gt; C -&gt; A, for which there is no such guarantee. I don&#39;t see any logical problem with the value being different after such a sequence of conversions, though the compiler might have to be deliberately designed to have hostile semantics."}, {"owner": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "edited": false, "score": 0, "creation_date": 1471437476, "post_id": 38994531, "comment_id": 65345216, "body": "I edited the question to be more clear. Thanks to all for discussion"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1471438223, "post_id": 38994531, "comment_id": 65345797, "body": "Text <i>&quot;If you only use it to read objects of type u_int16_t or a compatible type then it&#39;s fine;</i>&quot; is misleading. Code <code>get_u_int16_t(uint16array, 1);</code> will crash and burn on any platform that does not allow unaligned access."}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1471439212, "post_id": 38994531, "comment_id": 65346609, "body": "@user694733 there is no such object as <code>uint1\u200c\u200b6array[0.5]</code> - I&#39;ll try to improve my wording though."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1471440058, "post_id": 38994531, "comment_id": 65347355, "body": "I still don&#39;t like the implication that original macro is somehow fine. Only time when macro doesn&#39;t break horribly is when data type of first argument is matching and offset is correctly calculated, for example <code>get_u_int16_t(uint1\u200c\u200b6array, 2);</code>. But then you could just use <code>uint1\u200c\u200b6array[1]</code>, but that defeats the original point which is to have deserialization function which can extract 16-bit integer from any byte array. Let&#39;s face it; original macro is simply garbage and has no sensible usage."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1471617918, "post_id": 38994531, "comment_id": 65433372, "body": "@user694733: The macro lacks parentheses around its arguments, which is bad given some of the likely ways it might be used, but otherwise it would be fine when targeting dialects of C whose authors recognize that <i>quality</i> compilers intended for embedded or systems programming must be capable of recognizing constructs beyond those mandated by the Standard."}], "tags": [], "owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "is_accepted": false, "score": 2, "last_activity_date": 1471439261, "last_edit_date": 1471439261, "creation_date": 1471430919, "answer_id": 38994531, "question_id": 38993614, "link": "https://stackoverflow.com/questions/38993614/does-this-macro-violate-the-strict-aliasing-rule/38994531#38994531", "title": "Does this macro violate the STRICT ALIASING RULE?", "body": "<p>The macro itself doesn't violate the strict aliasing rule; it depends how you use it. If you only use it to read already existing objects of type <code>u_int16_t</code> or a compatible type then it's fine; if on the other hand you use it to read e.g. parts of a 64-bit integer or a floating-point object then that would be a strict aliasing violation, as well as (possibly) an alignment violation.</p>\n\n<p>As always, you can make the code safe using <code>memcpy</code>:</p>\n\n<pre><code>inline u_int16_t read_u_int16_t(const void *p) {\n    u_int16_t val;\n    memcpy(&amp;val, p, sizeof(val));\n    return val;\n}\n#define get_u_int16_t(X,O)  (read_u_int16_t(((u_int8_t *)X) + O))\n</code></pre>\n\n<p>As @2501 points out this may be invalid if <code>u_int8_t</code> is not a character type, so you should just use <code>char *</code> for pointer arithmetic:</p>\n\n<pre><code>#define get_u_int16_t(X,O)  (read_u_int16_t(((char *)X) + O))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "edited": false, "score": 0, "creation_date": 1471605318, "post_id": 39028816, "comment_id": 65424692, "body": "Thanks for the comment. So in your opinion, the answer in correct and I have to use char * instead u_int8_t as suggest ?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "edited": false, "score": 0, "creation_date": 1471617031, "post_id": 39028816, "comment_id": 65432690, "body": "@Kyrol: Under a strict reading of the rules, there is no guarantee that <code>uint8_t*</code> will be recognized as having the same aliasing guarantees as <code>unsigned char*</code>.  I think the more important point, though, is the importance of selecting a C dialect.  If one is only targeting implementations with known storage layout rules, the advantages a programmer can obtain by exploiting such rules (with aliasing rules disabled) can often exceed the advantages a compiler could obtain via aliasing rules and couldn&#39;t obtain via <code>restrict</code>."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "edited": false, "score": 0, "creation_date": 1471617238, "post_id": 39028816, "comment_id": 65432850, "body": "@Kyrol: Note also that on many embedded platforms, <code>memcpy</code> is absolutely dreadful for small moves.  Assembling things out of <code>unsigned char</code> will often be more than 2x as slow as using <code>uint16_t*</code>; the speed penalty for <code>memcpy</code> can be closer to 10x."}, {"owner": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "edited": false, "score": 0, "creation_date": 1471647604, "post_id": 39028816, "comment_id": 65447208, "body": "Wow, I didn&#39;t know about that issue of <code>memcpy</code>. Actually I think pointers alignment could be an issue: i&#39;m reading this <a href=\"http://stackoverflow.com/questions/227897/how-to-allocate-aligned-memory-only-using-the-standard-library\" title=\"how to allocate aligned memory only using the standard library\">stackoverflow.com/questions/227897/&hellip;</a> ."}, {"owner": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "edited": false, "score": 0, "creation_date": 1471648125, "post_id": 39028816, "comment_id": 65447318, "body": "I don&#39;t understand instead how could be usefull the <code>restrict</code>, because my pointers point to the same location. Thanks for clear me these doubts"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "edited": false, "score": 0, "creation_date": 1471855372, "post_id": 39028816, "comment_id": 65497601, "body": "@Kyrol: Efficient performance requires that a compiler be able to optimize cases where pointers won&#39;t need to alias.  Places where pointers will alias can&#39;t use <code>restrict</code>, but using <code>restrict</code> in the places where it&#39;s safe will avoid the speed penalty associated with disabling type-based aliasing."}], "tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 0, "last_activity_date": 1471561682, "creation_date": 1471561682, "answer_id": 39028816, "question_id": 38993614, "link": "https://stackoverflow.com/questions/38993614/does-this-macro-violate-the-strict-aliasing-rule/39028816#39028816", "title": "Does this macro violate the STRICT ALIASING RULE?", "body": "<p>There are two ways to write code of the type you're interested in:</p>\n\n<ol>\n<li><p>Use pointers of type \"unsigned char*\" to access anything, assemble values out of multiple bytes, and tolerate the performance hit.</p></li>\n<li><p>If you know that pointer alignment won't be an issue, use a dialect of C that doesn't semantically gut it.  GCC can implement such a dialect if invoked with <code>-fno-strict-aliasing</code>, but since gcc has no way to prevent obtuse \"optimizations\" without blocking useful and sensible optimizations, getting good performance from such a dialect may require learning how to use <code>restrict</code>.</p></li>\n</ol>\n\n<p>Some people would argue that approach #1 is better, and for many PC-side programming purposes I'd tend to agree.  For embedded software, however, I would suggest staying away from gcc's default dialect since there's no guarantee that the things gcc regards as defined behavior today will remain so tomorrow.  I'm not sure where the authors of gcc got the notion that the authors of the Standard were trying to specify all of the forms of aliasing that a quality microprocessor implementation should support, rather than establish a minimum baseline for platforms where no forms of type punning other than \"unsigned char\" would be useful.</p>\n"}], "owner": {"reputation": 3126, "user_id": 859453, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b1238bfa1241c414bc0f411984c89487?s=128&d=identicon&r=PG", "display_name": "Kyrol", "link": "https://stackoverflow.com/users/859453/kyrol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1471561682, "creation_date": 1471428382, "last_edit_date": 1471442343, "question_id": 38993614, "link": "https://stackoverflow.com/questions/38993614/does-this-macro-violate-the-strict-aliasing-rule", "title": "Does this macro violate the STRICT ALIASING RULE?", "body": "<p>I'm fixing some code not written by me, so I found this:</p>\n\n<pre><code>#define get_u_int16_t(X,O)  (*(u_int16_t *)(((u_int8_t *)X) + O))\n</code></pre>\n\n<p>How can I change it to keep the rule, if it violating it ?</p>\n\n<p>The macro is called in this way:</p>\n\n<pre><code>if(get_u_int16_t(packet-&gt;payload, i) == ...) { ... }\n</code></pre>\n\n<p>where <strong>payload</strong> is a <code>const unsigned char *</code> and <strong>i</strong> is an <code>unsigned int</code>. </p>\n\n<p>The situation is:</p>\n\n<pre><code>struct orig {\n   [...]\n   struct pkt packet;\n}*;\n\nstruct pkt {\n   [...]\n   const u_int8_t *payload;\n }*;\n</code></pre>\n\n<p>Called in this way:</p>\n\n<pre><code>struct orig * flow;\nstruct pkt * packet = &amp;flow-&gt;packet;\n</code></pre>\n\n<p><strong>payload</strong> is a string</p>\n\n<p><strong>i</strong> begin with a value of <strong>0</strong> and is inside a <code>for</code> that loop for the lenght of payload ( <code>u_int16_t len</code> ):</p>\n\n<pre><code>for(i = 0; i &lt; len; i++) {\n   if(get_u_int16_t(packet-&gt;payload, a) == /*value*/) {\n   // do stuff\n}\n</code></pre>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1471428757, "post_id": 38993551, "comment_id": 65339243, "body": "I saw a similar question several times already, but cannot find the dupe."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1471431188, "post_id": 38993551, "comment_id": 65340944, "body": "There are hundreds of duplicates of this question to be found on SO."}, {"owner": {"reputation": 11, "user_id": 6077982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4293253f1ef0da89ac73ee1d2515aa0d?s=128&d=identicon&r=PG&f=1", "display_name": "Anas Shaikh", "link": "https://stackoverflow.com/users/6077982/anas-shaikh"}, "edited": false, "score": 0, "creation_date": 1471438391, "post_id": 38993551, "comment_id": 65345914, "body": "Hey can u guys provide the links to previously asked identical questions"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6077982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4293253f1ef0da89ac73ee1d2515aa0d?s=128&d=identicon&r=PG&f=1", "display_name": "Anas Shaikh", "link": "https://stackoverflow.com/users/6077982/anas-shaikh"}, "edited": false, "score": 0, "creation_date": 1471440834, "post_id": 38994016, "comment_id": 65347969, "body": "Hey thanks for the reply. I have a question can I do the above in this way, &quot;volatile unsigned short *WDTCTL &quot; , &quot;WDTCTL=0&#215;0120&quot; and then dereference it &quot;*WDTCTL = 0&#215;01&quot; and write whatever I want. Pls reply"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "reply_to_user": {"reputation": 11, "user_id": 6077982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4293253f1ef0da89ac73ee1d2515aa0d?s=128&d=identicon&r=PG&f=1", "display_name": "Anas Shaikh", "link": "https://stackoverflow.com/users/6077982/anas-shaikh"}, "edited": false, "score": 0, "creation_date": 1471495397, "post_id": 38994016, "comment_id": 65371894, "body": "Yes, you can do it like that. However, in your case you are assigning a pointer variable <code>WDCTL</code> which will take some memory. Also you will have to do it for all the registers of the microcontroller, which might take too much memory."}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 1, "last_activity_date": 1471429503, "last_edit_date": 1495540849, "creation_date": 1471429503, "answer_id": 38994016, "question_id": 38993551, "link": "https://stackoverflow.com/questions/38993551/how-to-access-a-particular-register-of-a-microcontroller-using-pointers/38994016#38994016", "title": "how to access a particular register of a microcontroller using pointers", "body": "<blockquote>\n  <p>define WDTCTL     (*((volatile unsigned short *)0x0120))</p>\n</blockquote>\n\n<p>This means that <code>WDTCTL</code> register is at the address <code>0x0120</code>. \n<code>(volatile unsigned short *)</code> will typecast that into a short pointer. \nThen <code>(*((volatile unsigned short *)0x0120))</code> will give the value at that pointer location.</p>\n\n<p>The reason to use <code>volatile</code> here is that for microcontroller addresses, the value can change at any time independently of the C code. The <code>volatile</code> keyword disallows compiler optimizations around this register. </p>\n\n<p>For more information see <a href=\"https://stackoverflow.com/questions/246127/why-is-volatile-needed-in-c\">Why is volatile needed in C?</a></p>\n"}], "owner": {"reputation": 11, "user_id": 6077982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4293253f1ef0da89ac73ee1d2515aa0d?s=128&d=identicon&r=PG&f=1", "display_name": "Anas Shaikh", "link": "https://stackoverflow.com/users/6077982/anas-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1438, "favorite_count": 0, "closed_date": 1471431165, "answer_count": 1, "score": 1, "last_activity_date": 1471433564, "creation_date": 1471428211, "last_edit_date": 1471433564, "question_id": 38993551, "link": "https://stackoverflow.com/questions/38993551/how-to-access-a-particular-register-of-a-microcontroller-using-pointers", "closed_reason": "Duplicate", "title": "how to access a particular register of a microcontroller using pointers", "body": "<p>I wanted to know how to access a particular register in a microcontroller  having mapped at a particular fixed address. I googled about this issue and I found the following:</p>\n\n<pre><code>#define WDTCTL     (*((volatile unsigned short *)0x0120))\n#define P1DIR (*((volatile unsigned char *)0x0022))\n</code></pre>\n\n<p>This method of works absolutely fine but I do not understand how it works. </p>\n\n<p>I  will be glad if someone could explain it to me.</p>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1471428603, "post_id": 38993489, "comment_id": 65339138, "body": "What is your question? It sounds like you are already doing what you need to do. Of course we can&#39;t be sure because you only described your code. File mappings for IPC isn&#39;t exactly easy. Are you sure you chose the right tool for the job."}, {"owner": {"reputation": 100127, "user_id": 67392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95e28ac250c4604a6f9d7e34705c3259?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/67392/richard"}, "edited": false, "score": 0, "creation_date": 1471428704, "post_id": 38993489, "comment_id": 65339210, "body": "You would probably be better off using a <a href=\"https://msdn.microsoft.com/en-us/library/ms684266(v=vs.85).aspx\" rel=\"nofollow noreferrer\">mutex</a> (only one thread at a time) or a read-write lock (either one writer or multiple readers, the inbuilt one is limited to in-process, but one can be built with a mutex and a semaphore). Using a semaphore you&#39;ll end up emulating one of the others."}, {"owner": {"reputation": 117, "user_id": 6490192, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01201441242545235776b971510da135?s=128&d=identicon&r=PG&f=1", "display_name": "DylSmith", "link": "https://stackoverflow.com/users/6490192/dylsmith"}, "edited": false, "score": 0, "creation_date": 1471429150, "post_id": 38993489, "comment_id": 65339548, "body": "I realised question was vague. Edited question and added code."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1471432649, "post_id": 38993489, "comment_id": 65341917, "body": "What value does <code>waitResult</code> have? What are <code>SEMAPHORE_NAME</code> and  <code>MEMORY_MAPPING_NAME</code>? Why did you choose to use a semaphore? Why did you opt for file mapping rather than higher level IPC mechanisms?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1471432662, "post_id": 38993489, "comment_id": 65341927, "body": "Your semaphore doesn&#39;t guard against concurrent reads and writes. As long as no more than 9 threads are reading, the writer can obtain the semaphore as well, and thrash the memory."}, {"owner": {"reputation": 117, "user_id": 6490192, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01201441242545235776b971510da135?s=128&d=identicon&r=PG&f=1", "display_name": "DylSmith", "link": "https://stackoverflow.com/users/6490192/dylsmith"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1471435900, "post_id": 38993489, "comment_id": 65344115, "body": "@DavidHeffernan <code>waitResult</code> is zero. <code>SEMAPHORE_NAME</code> is a defined constant used to name the semaphore. <code>MEMORY_MAPPING_NAME</code> is also a constant that names the mapping, used in <code>CreateFileMapping</code>. I believe file mapping offers better performance (correct me if im wrong) than higher level IPC mechanisms."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1471436408, "post_id": 38993489, "comment_id": 65344451, "body": "Clearly they are constants. I was wondering what value they had though. Whether you used local or global namespace. You know that <code>WAIT_OBJECT_0</code> has value <code>0</code>? So you are executing the <code>WAIT_OBJECT_0</code> case and the <code>default</code> case. You are victim of switch fall through. <a href=\"http://stackoverflow.com/questions/8146106/does-case-switch-work-like-this\" title=\"does case switch work like this\">stackoverflow.com/questions/8146106/&hellip;</a>  That&#39;s the simple answer to your question. That a semaphore seems like the wrong choice remains. I think there are many problems with your code. I would be surprised if memory maps were the best choice for you."}, {"owner": {"reputation": 117, "user_id": 6490192, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01201441242545235776b971510da135?s=128&d=identicon&r=PG&f=1", "display_name": "DylSmith", "link": "https://stackoverflow.com/users/6490192/dylsmith"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1471444046, "post_id": 38993489, "comment_id": 65350515, "body": "@DavidHeffernan You say I have many problems.. what are said problems if I can ask?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1471444241, "post_id": 38993489, "comment_id": 65350688, "body": "Start with the maximum count of 10. Why a semaphore? Why not a mutex? But I&#39;m just repeating what has been stated above."}], "answers": [{"tags": [], "owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "is_accepted": true, "score": 1, "last_activity_date": 1471436584, "last_edit_date": 1495542782, "creation_date": 1471436584, "answer_id": 38996557, "question_id": 38993489, "link": "https://stackoverflow.com/questions/38993489/use-windows-semaphores-to-synchronize-windows-file-mappings/38996557#38996557", "title": "Use Windows Semaphores to synchronize Windows File Mappings", "body": "<p>Your switch statement is subject to fall through. For one of the many discussions that can be found here on Stack Overflow, see <a href=\"https://stackoverflow.com/questions/8146106/does-case-switch-work-like-this\">Does case-switch work like this?</a>.</p>\n\n<p>Your code executes the <code>WAIT_OBJECT_0</code> and then simply continues to the <code>default</code> case. You need to add a <code>break</code> or a <code>return</code> at the very end of the <code>WAIT_OBJECT_0</code> case.</p>\n"}], "owner": {"reputation": 117, "user_id": 6490192, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01201441242545235776b971510da135?s=128&d=identicon&r=PG&f=1", "display_name": "DylSmith", "link": "https://stackoverflow.com/users/6490192/dylsmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 0, "accepted_answer_id": 38996557, "answer_count": 1, "score": 0, "last_activity_date": 1471436584, "creation_date": 1471428013, "last_edit_date": 1471429072, "question_id": 38993489, "link": "https://stackoverflow.com/questions/38993489/use-windows-semaphores-to-synchronize-windows-file-mappings", "title": "Use Windows Semaphores to synchronize Windows File Mappings", "body": "<p>I want to use Windows Semaphores to add synchronization to a Windows File Mapping. So, one process creates the file mapping and another (perhaps multiple other processes) can come in and access the data that is shared. Can anyone give a suggestion as to how this can be done. I have done the following: </p>\n\n<p>In the process that creates the file mapping, I have used <code>CreateSemaphore</code> and specified a name. In another process that attempts to access the data, I use <code>OpenSemaphore</code> to get a handle to the created sempahore, then I call <code>WaitForSingleObject</code>, I then switch on this value, and if its <code>WAIT_OBJECT0</code>, I perform the work, and finally calling <code>ReleaseSemaphore</code> once the work is done.\nI am doing this in C, using a JNI shared library. </p>\n\n<p>The problem is that it simply goes into the default case. Is there anything else that I should do, or am I missing something?</p>\n\n<p>I'm pretty new to how Windows sems work, and I cannot find a concrete example \nof how they work between multiple processes (no threads). If anyone can give any suggestions, It would be much appreciated.  </p>\n\n<p>Here is some code: </p>\n\n<p><strong>Create the file mapping</strong></p>\n\n<pre><code>// create the semaphore here\nsemaphore = CreateSemaphore(\n  NULL,\n  10,\n  10,\n  SEMAPHORE_NAME\n);\n\n// some semaphore error checking\nif (semaphore == NULL) {\n  printf(\"Error occured creating semaphore %d\\n\", GetLastError());\n  return -1;\n}\n\n//create mapping object\nmappedFileHandle = CreateFileMapping (\n  INVALID_HANDLE_VALUE,\n  NULL,\n  PAGE_READWRITE,\n  0,\n  BUFFER_SIZE,\n  MEMORY_MAPPING_NAME\n);\n\nif (mappedFileHandle == NULL) {\n  printf(\"Error creating a mapped file: %d\", GetLastError());\n  return -1;\n}\n\n// map view of a file into address space of a calling process\nbuffer = (LPCTSTR) MapViewOfFile (\n  mappedFileHandle,\n  FILE_MAP_ALL_ACCESS,\n  0,\n  0,\n  BUFFER_SIZE\n);\n\nif (buffer == NULL) {\n  printf(\"Could not map view\");\n  CloseHandle(mappedFileHandle);\n  return -1;\n}\n\nCopyMemory(buffer, str, (_tcslen(str) * sizeof(TCHAR))); // problem!!\nUnmapViewOfFile(buffer);\nCloseHandle(mappedFileHandle);\n//  CloseHandle(semaphore);\n</code></pre>\n\n<p><strong>Process code that gets the data</strong></p>\n\n<pre><code>// try open the semahore\nsemaphore = OpenSemaphore (\n  SEMAPHORE_ALL_ACCESS,\n  NULL,\n  SEMAPHORE_NAME\n);\n\n// some error checking\nif (semaphore == NULL) {\n  printf(\"Could not open semaphore %d\\n\", GetLastError());\n  return -1;\n}\n\nwaitResult = WaitForSingleObject(\n  semaphore,\n  -1 // block\n);\n\n// try to open the file mapping -- SHOULD BE DONE ATOMICALLY\n// ======================================================================\n\nswitch (waitResult) {\n  case WAIT_OBJECT_0:\n          printf(\"Got in wait_result0\");\n          mappedFileHandle = OpenFileMapping (\n            FILE_MAP_ALL_ACCESS,\n            FALSE,\n            MEMORY_MAPPING_NAME\n          );\n\n          if (mappedFileHandle == NULL) {\n            printf(\"Could not open file mapping\");\n            return errorForJavaProgram;\n          }\n\n          // read data here, must be a critical region\n\n          buffer = (LPTSTR) MapViewOfFile(\n            mappedFileHandle,\n            FILE_MAP_ALL_ACCESS,\n            0,\n            0,\n            BUFFER_SIZE\n          );\n\n          if (buffer == NULL) {\n            printf(\"Could not map view\");\n            CloseHandle(mappedFileHandle);\n            return errorForJavaProgram;\n          }\n\n          message = (*env)-&gt;NewStringUTF(env, buffer);\n\n          if (!ReleaseSemaphore(semaphore, 1, NULL)) {\n            printf(\"An error occured releasing the semaphore: %d\\n\", GetLastError());\n            return -1;\n          }\n    default:\n      printf(\"Got to default \\n\");\n} //switch\n</code></pre>\n"}, {"tags": ["c++", "c", "struct", "casting"], "comments": [{"owner": {"reputation": 8564, "user_id": 1043352, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f336066e4f8700aa439943ee4f5ffbd9?s=128&d=identicon&r=PG", "display_name": "Jakub Zaverka", "link": "https://stackoverflow.com/users/1043352/jakub-zaverka"}, "edited": false, "score": 0, "creation_date": 1471427673, "post_id": 38993278, "comment_id": 65338468, "body": "Is do_some_stuff a pure C function (i.e. extern &quot;C&quot;)?"}, {"owner": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "edited": false, "score": 2, "creation_date": 1471427675, "post_id": 38993278, "comment_id": 65338469, "body": "reinterpretation, to &quot;find&quot; parent type is posssible for parameters by reference (or by pointer), but not by value"}, {"owner": {"reputation": 19910, "user_id": 1621391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ec331963e9d60347c1e80e294b14940c?s=128&d=identicon&r=PG", "display_name": "WhiZTiM", "link": "https://stackoverflow.com/users/1621391/whiztim"}, "edited": false, "score": 3, "creation_date": 1471427736, "post_id": 38993278, "comment_id": 65338516, "body": "&quot;...From a number of sources, I have gathered that the safest way to warp this struct in C++ is to subclass it...&quot; - Whoever said that is downright silly. Please, stay away from those sources."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1471427912, "post_id": 38993278, "comment_id": 65338624, "body": "You can cast <code>_a</code> to a <code>Vector2D &amp;</code>, but it is likely to be undefined behavior. The proper way of doing this is to use free functions."}, {"owner": {"reputation": 2037, "user_id": 1468415, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wx7N9.png?s=128&g=1", "display_name": "mvidelgauz", "link": "https://stackoverflow.com/users/1468415/mvidelgauz"}, "reply_to_user": {"reputation": 19910, "user_id": 1621391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ec331963e9d60347c1e80e294b14940c?s=128&d=identicon&r=PG", "display_name": "WhiZTiM", "link": "https://stackoverflow.com/users/1621391/whiztim"}, "edited": false, "score": 0, "creation_date": 1471427950, "post_id": 38993278, "comment_id": 65338651, "body": "@WhiZTiM Do you mind to elaborate on this or give some links? Also, what is a right way instead?"}, {"owner": {"reputation": 1552, "user_id": 3145469, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/40ef74077e497553ad7a6ce20a1fc38b?s=128&d=identicon&r=PG&f=1", "display_name": "MrMobster", "link": "https://stackoverflow.com/users/3145469/mrmobster"}, "reply_to_user": {"reputation": 19910, "user_id": 1621391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ec331963e9d60347c1e80e294b14940c?s=128&d=identicon&r=PG", "display_name": "WhiZTiM", "link": "https://stackoverflow.com/users/1621391/whiztim"}, "edited": false, "score": 0, "creation_date": 1471428309, "post_id": 38993278, "comment_id": 65338927, "body": "@WhiZTiM: would you care to provide a better approach to this problem?"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1471429031, "post_id": 38993278, "comment_id": 65339455, "body": "Maybe you could specify what you mean by &quot;convenience&quot; and &quot;type safety&quot;, because as it stands, it isn&#39;t clear that you need to do anything at all. Just use <code>vector2D</code> as is. Add functionality with non-member functions."}], "answers": [{"comments": [{"owner": {"reputation": 1552, "user_id": 3145469, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/40ef74077e497553ad7a6ce20a1fc38b?s=128&d=identicon&r=PG&f=1", "display_name": "MrMobster", "link": "https://stackoverflow.com/users/3145469/mrmobster"}, "edited": false, "score": 0, "creation_date": 1471428112, "post_id": 38993450, "comment_id": 65338759, "body": "Your answer is certainly correct one but its an answer to a different question. I do not intend to call <code>do_some_stuff</code> from C++ code (that would be indeed quite pointless). I want it to be a C function, taking C data types and reinterpreting those as C++ types."}, {"owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "reply_to_user": {"reputation": 1552, "user_id": 3145469, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/40ef74077e497553ad7a6ce20a1fc38b?s=128&d=identicon&r=PG&f=1", "display_name": "MrMobster", "link": "https://stackoverflow.com/users/3145469/mrmobster"}, "edited": false, "score": 1, "creation_date": 1471428447, "post_id": 38993450, "comment_id": 65339023, "body": "@MrMobster You wanna call <code>do_some_stuff</code> from C with instances of C++ class? For that you&#39;ll have to change the signature of <code>do_some_stuff</code>, can you do that?"}, {"owner": {"reputation": 1552, "user_id": 3145469, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/40ef74077e497553ad7a6ce20a1fc38b?s=128&d=identicon&r=PG&f=1", "display_name": "MrMobster", "link": "https://stackoverflow.com/users/3145469/mrmobster"}, "edited": false, "score": 0, "creation_date": 1471428743, "post_id": 38993450, "comment_id": 65339234, "body": "No, I want to call the C function from C with C structs but inside that function treat the C structs as if they were C++ structs with identical layout."}, {"owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "reply_to_user": {"reputation": 1552, "user_id": 3145469, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/40ef74077e497553ad7a6ce20a1fc38b?s=128&d=identicon&r=PG&f=1", "display_name": "MrMobster", "link": "https://stackoverflow.com/users/3145469/mrmobster"}, "edited": false, "score": 0, "creation_date": 1471429112, "post_id": 38993450, "comment_id": 65339513, "body": "@MrMobster You can use a C struct in C++. The other way around you can&#39;t. A C++ class lives in the C++ realm."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1471429115, "post_id": 38993450, "comment_id": 65339515, "body": "I would say &quot;prefer doing nothing over doing something&quot; if it isn&#39;t clear what doing something would achieve. Or unless you get paid by LOC written."}], "tags": [], "owner": {"reputation": 38854, "user_id": 2352671, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kd1xb.jpg?s=128&g=1", "display_name": "101010", "link": "https://stackoverflow.com/users/2352671/101010"}, "is_accepted": false, "score": 2, "last_activity_date": 1471427923, "creation_date": 1471427923, "answer_id": 38993450, "question_id": 38993278, "link": "https://stackoverflow.com/questions/38993278/extend-c-struct-in-c/38993450#38993450", "title": "Extend C struct in C++", "body": "<p>Prefer composition over inheritance. That is change your C++ <code>class Vector2D</code> to contain an instance of C <code>struct vector2D</code> and interface it:</p>\n\n<pre><code>class Vector2D {\n  vector2D p;\npublic:\n  vector2D&amp; getP() { return p; }\n  vector2D const&amp; getP() const { return p; }\n  float&amp; x() { return p.x; }\n  float&amp; y() { return p.y; }\n  float const&amp; x() const { return p.x; }\n  float const&amp; y() const { return p.y; }\n  // ...\n};\n</code></pre>\n\n<p>And then call the C function as:</p>\n\n<pre><code>Vector2D v1;\nVector2D v2;\n...\nauto p = do_some_stuff(v1.getP(), v2.getP());\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1471428037, "post_id": 38993464, "comment_id": 65338708, "body": "There is no data in <code>Vector2D</code>, so it makes some sense to want to do this."}, {"owner": {"reputation": 1552, "user_id": 3145469, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/40ef74077e497553ad7a6ce20a1fc38b?s=128&d=identicon&r=PG&f=1", "display_name": "MrMobster", "link": "https://stackoverflow.com/users/3145469/mrmobster"}, "edited": false, "score": 0, "creation_date": 1471428267, "post_id": 38993464, "comment_id": 65338883, "body": "Since C++ has no concept of data structure extension, my purpose was to hack the inheritance mechanism to accomplish the same. Note that in this case the subclass is NOT a specialisation as it does not add any new state. The instance layout is identical to the original C struct. The only purpose of the subclass is to add convenient members to be used with the struct."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "reply_to_user": {"reputation": 1552, "user_id": 3145469, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/40ef74077e497553ad7a6ce20a1fc38b?s=128&d=identicon&r=PG&f=1", "display_name": "MrMobster", "link": "https://stackoverflow.com/users/3145469/mrmobster"}, "edited": false, "score": 2, "creation_date": 1471429152, "post_id": 38993464, "comment_id": 65339550, "body": "@MrMobster Just write non-member functions and you&#39;re done."}, {"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "reply_to_user": {"reputation": 1552, "user_id": 3145469, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/40ef74077e497553ad7a6ce20a1fc38b?s=128&d=identicon&r=PG&f=1", "display_name": "MrMobster", "link": "https://stackoverflow.com/users/3145469/mrmobster"}, "edited": false, "score": 1, "creation_date": 1471436726, "post_id": 38993464, "comment_id": 65344683, "body": "@MrMobster nope, that is inherently a misconception: Only one of the following statements can be true: 1. There&#39;s no additional state 2. I can safely cast the types at runtime, because C++ can tell a raw <code>vector2d</code> from a <code>Vector2D</code>."}], "tags": [], "owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "is_accepted": false, "score": 2, "last_activity_date": 1471427965, "creation_date": 1471427965, "answer_id": 38993464, "question_id": 38993278, "link": "https://stackoverflow.com/questions/38993278/extend-c-struct-in-c/38993464#38993464", "title": "Extend C struct in C++", "body": "<blockquote>\n  <p>However, what I am having difficulties figuring out how I can reinterpret the C struct as the extended version. </p>\n</blockquote>\n\n<p>Um, that's not how inheritance works: your daughter class is a specialization of your mother class, so you can interpret a <code>Vector2D</code> as a <code>vector2d</code>, but not  the other way around. </p>\n\n<p>Think about it: where should the extension's data come from if it wasn't there in the first place?</p>\n\n<p>What you can do is implement a constructor or cast operator that takes a <code>vector2d</code> to initialize a new <code>Vector2D</code>.</p>\n\n<p>Other than that, I'd say your whole endeavour is questionable, because it's based on a misunderstanding: The struct you're extending is a C++ class now, different from the C type. </p>\n"}, {"comments": [{"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 2, "creation_date": 1471433317, "post_id": 38994348, "comment_id": 65342412, "body": "that&#39;s undefined behavior."}, {"owner": {"reputation": 1552, "user_id": 3145469, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/40ef74077e497553ad7a6ce20a1fc38b?s=128&d=identicon&r=PG&f=1", "display_name": "MrMobster", "link": "https://stackoverflow.com/users/3145469/mrmobster"}, "reply_to_user": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1471436419, "post_id": 38994348, "comment_id": 65344458, "body": "after looking through the documentation for some more time I am inclined to agree with @bolov. It seems this can&#39;t be done then in a standard-compatible way. A shame, but I will survive."}], "tags": [], "owner": {"reputation": 1552, "user_id": 3145469, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/40ef74077e497553ad7a6ce20a1fc38b?s=128&d=identicon&r=PG&f=1", "display_name": "MrMobster", "link": "https://stackoverflow.com/users/3145469/mrmobster"}, "is_accepted": false, "score": 0, "last_activity_date": 1471430402, "creation_date": 1471430402, "answer_id": 38994348, "question_id": 38993278, "link": "https://stackoverflow.com/questions/38993278/extend-c-struct-in-c/38994348#38994348", "title": "Extend C struct in C++", "body": "<p>After some experimentation, I have figured the way to do it:</p>\n\n<pre><code>Vector2D v = *reinterpret_cast&lt;Vector2D*&gt;(&amp;_v);\n</code></pre>\n\n<p>But juanchopanza's suggestion to use non-member functions is probably the better way to go. </p>\n"}], "owner": {"reputation": 1552, "user_id": 3145469, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/40ef74077e497553ad7a6ce20a1fc38b?s=128&d=identicon&r=PG&f=1", "display_name": "MrMobster", "link": "https://stackoverflow.com/users/3145469/mrmobster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 909, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1471430402, "creation_date": 1471427458, "last_edit_date": 1471428153, "question_id": 38993278, "link": "https://stackoverflow.com/questions/38993278/extend-c-struct-in-c", "title": "Extend C struct in C++", "body": "<p>I have some C structs that I would like to 'extend' in C++ to add some convenience and type safety. For instance, suppose that my struct is </p>\n\n<pre><code>struct vector2D { float x, y; };\n</code></pre>\n\n<p>From a number of sources, I have gathered that the safest way to warp this struct in C++ is to subclass it:</p>\n\n<pre><code>struct Vector2D: vector2D { ... };\n</code></pre>\n\n<p>So far so good. However, what I am having difficulties figuring out how I can reinterpret the C struct as the extended version. Suppose I have a C function </p>\n\n<pre><code>struct vector2D do_some_stuff(struct vector2D _a, struct vector2D _b) {\n ...\n}\n</code></pre>\n\n<p>Within this function, I would like to work with the C++ representation. Since the layouts of <code>struct vector2D</code> and <code>Vector2D</code> are identical, I though that simple cast would work, e.g.</p>\n\n<pre><code>Vector2D a = static_cast&lt;Vector2D&gt;(_a)\n</code></pre>\n\n<p>but this doesn't seem to work. Using a constructor generates horrible boilerplate code. </p>\n\n<p>What is the proper way of doing this, if its at all possible?</p>\n\n<p>Clarification: <code>do_some_stuff</code> is a C function and is only intended to be called from C code. </p>\n"}, {"tags": ["c++", "c", "windows", "winapi", "winhttp"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1471427978, "post_id": 38993073, "comment_id": 65338666, "body": "<i>&quot;If MS Windows has implemented metered connections, there must be some approach to instruct WinHTTP services to not to use specific connections.&quot;</i> - Why?"}, {"owner": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1471428780, "post_id": 38993073, "comment_id": 65339257, "body": "@IInspectable, so that applications can restrict HTTP data usage on metered connections. Today, most traffic is on HTTP. Outlook, for example, is dumb, which would simply warn user if ANY network is metered. This is probably that OS doesn&#39;t have this feature. Browsers are also not able to restrict their web traffic through given adaptor."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1471429297, "post_id": 38993073, "comment_id": 65339661, "body": "That explains why you think there <b>should</b> be a way. It doesn&#39;t explain why you believe that there <b>must</b> be a way. I don&#39;t think that restricting HTTP data usage on metered connections would be a useful setting either. Restricting any traffic, irrespective of protocol, would be reasonable."}, {"owner": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1471429731, "post_id": 38993073, "comment_id": 65339964, "body": "@IInspectable, <i>&quot;Restricting any traffic, irrespective of protocol, would be reasonable&quot;</i> - I agree. But I cannot get a socket-handle out of HINTERNET handle. With sockets, it is very much possible. With WinHTTP functions it is not. Technically, I am looking for solution, and not &quot;should and musts&quot; :)"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1471493568, "post_id": 38993073, "comment_id": 65371371, "body": "&quot;<i>I cannot get a socket-handle out of HINTERNET handle</i>&quot; - actually, you can. Use <code>InternetQueryOption()</code> has an <code>INTERNET_OPTION_DIAGNOSTIC_SOCKET_INFO</code> option that returns an <code>INTERNET_DIAGNOSTIC_SOCKET_INFO</code> struct containing the <code>SOCKET</code> handle."}, {"owner": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1471602341, "post_id": 38993073, "comment_id": 65422888, "body": "@RemyLebeau, thanks for the hint. However, I found that this option is not applicable Windows 7 and above. I would try the same with WinHttp callback(s) and try to bind to specific adapter from there."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1471635916, "post_id": 38993073, "comment_id": 65443130, "body": "@Ajay: Thanks. I hadn&#39;t seen the note about Windows 7 dropping support for <code>INTERNET_OPTION_DIAGNOSTIC_SOCKET_INFO</code>."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1471637281, "post_id": 38993073, "comment_id": 65443782, "body": "@Ajay: I don&#39;t know if the <code>SOCKET</code> handle is provided in any WinHTTP callback, but it should be possible to hunt down manually with some work. The <code>INTERNET_STATUS_CONNECTED_TO_SERVER</code> status gives you the remote address/port pair of the server. Enumerate Windows&#39; TCP tables looking for the same remote address/port pair belonging to your process ID. That will give you the local bound address/port pair. Enumerate your app&#39;s open kernel handles looking for TCP objects, calling <code>getpeername()</code> and <code>getsockname()</code> on them, until you find matching pairs, then you will have the <code>SOCKET</code> handle."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1471637499, "post_id": 38993073, "comment_id": 65443878, "body": "@Ajay: Of course, if you have multiple WinHTTP connections to the same server open at the same time, you would end up with multiple open <code>SOCKET</code> handles, and will not know which socket belongs to which WinHTTP session."}, {"owner": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1471639998, "post_id": 38993073, "comment_id": 65444891, "body": "@RemyLebeau, I appreciate your efforts. Please put all these details as answer (even concise). I will accept it, and will modify it so that it might be useful for others."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1471643415, "post_id": 38993073, "comment_id": 65446113, "body": "@Ajay: The more I think about it, what I said above is useless. While it might be possible to track down the <code>SOCKET</code> in general, it would not work until after the connection has already been established, at which time it is too late to bind the connection to a specific network."}], "answers": [{"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 1, "last_activity_date": 1471643351, "creation_date": 1471643351, "answer_id": 39048137, "question_id": 38993073, "link": "https://stackoverflow.com/questions/38993073/bind-http-connection-to-specific-adapter-hint-metered-connection/39048137#39048137", "title": "Bind HTTP connection to specific adapter (Hint: Metered Connection)", "body": "<p>Unfortunately, neither WinInet nor WinHTTP natively support what you are asking for.</p>\n\n<p>You would likely have to resort to using the WinSock API <code>bind()</code> function to manually bind a WinInet/WinHTTP session socket to the desired network connection.</p>\n\n<p>Prior to Windows 7, you could get a <code>SOCKET</code> handle from an <code>HINTERNET</code> handle by using <code>InternetQueryOption()</code> with the <code>INTERNET_OPTION_DIAGNOSTIC_SOCKET_INFO</code> option.  It fills an <code>INTERNET_DIAGNOSTIC_SOCKET_INFO</code> struct with information about the connection, including the actual <code>SOCKET</code> handle.</p>\n\n<p>However, this option is no longer supported in Windows 7 and later.  And while it might be possible to track down the <code>SOCKET</code> handle manually with some extra work, I don't think it would do you any good.  A socket needs to be bound with <code>bind()</code> before it attempts to connect to a server.  The relevant information provided by WinInet/WinHTTP that could be used to hunt down the <code>SOCKET</code> handle is not made available until the connect attempt is in progress.  Just prior to connecting, the info is not in the TCP routing tables yet.  And one connected, it is too late to re-bind the socket.</p>\n\n<p>So I think you are out of luck on this, unless/until Microsoft exposes a new API to support binding WinInet/WinHTTP sessions, or otherwise expose access to the <code>SOCKET</code> handle again.</p>\n"}], "owner": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 39048137, "answer_count": 1, "score": 0, "last_activity_date": 1564430294, "creation_date": 1471426859, "last_edit_date": 1490004260, "question_id": 38993073, "link": "https://stackoverflow.com/questions/38993073/bind-http-connection-to-specific-adapter-hint-metered-connection", "title": "Bind HTTP connection to specific adapter (Hint: Metered Connection)", "body": "<p>Windows 8 and above has setting to make a Wi-Fi (and other) connection to be metered (and have cost attached to it, but irrelevant here). I've used <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms706556(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Native Wi-Fi API</a> and <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/hh437650(v=vs.85).aspx\" rel=\"nofollow noreferrer\">WCM APIs</a> to find required information.</p>\n\n<p>With sockets, it is possible to bind, selectively send, and ignoring incoming packets from/to the metered-connection. But, how to do this with <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa384257(v=vs.85).aspx\" rel=\"nofollow noreferrer\">WinHTTP APIs</a>?</p>\n\n<p>Some answers on StackOverflow and <a href=\"https://superuser.com/questions/683841/how-to-bind-applications-to-specific-network-adapter\">SuperUser</a> suggest using ForceBindIP, but we cannot simply use it. </p>\n\n<p>If MS Windows has implemented metered connections, ideally there should be some approach to instruct WinHTTP services to not to use specific connections.</p>\n"}, {"tags": ["c", "eclipse", "sqlite", "mingw"], "comments": [{"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 0, "creation_date": 1471425662, "post_id": 38992400, "comment_id": 65337165, "body": "<code>-lsqlite3</code> would be if you link by calling your compiler ( ie: gcc, clang, etc ...), while linking with <code>ld</code> you would use <code>-l sqlite3 -L &lt;searchdir for the static lib&gt;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 1070376, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/685c924ce35a28d0f22f2f0071758807?s=128&d=identicon&r=PG", "display_name": "sax", "link": "https://stackoverflow.com/users/1070376/sax"}, "edited": false, "score": 0, "creation_date": 1471452022, "post_id": 38995332, "comment_id": 65355777, "body": "I added the sqlite.c and sqlite.h to my src folder as you suggested.  I got rid of the paths to the sqlite3 folder I mentioned earlier.  I left in the -lsqlite3 command in the MinGW linker.  I have 3 problems still.  There is a warning triangle on my sqlite3.c file in the src folder.  The line #include &lt;sqlite3.h&gt; says fatal error: sqlite3.h no such file or directory. And during build, it says ..\\src\\RealDealProcessor.c:12:21: fatal error: sqlite3.h: No such file or directory"}, {"owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "reply_to_user": {"reputation": 127, "user_id": 1070376, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/685c924ce35a28d0f22f2f0071758807?s=128&d=identicon&r=PG", "display_name": "sax", "link": "https://stackoverflow.com/users/1070376/sax"}, "edited": false, "score": 0, "creation_date": 1471452134, "post_id": 38995332, "comment_id": 65355839, "body": "Drop the <code>-lsqlite3</code>. You need to add the directory of the .h file to the include path."}, {"owner": {"reputation": 127, "user_id": 1070376, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/685c924ce35a28d0f22f2f0071758807?s=128&d=identicon&r=PG", "display_name": "sax", "link": "https://stackoverflow.com/users/1070376/sax"}, "edited": false, "score": 0, "creation_date": 1471453770, "post_id": 38995332, "comment_id": 65356730, "body": "You are the man!  I think that we got it working.  It built, no errors, and ran as expected. The only problem is that there is still a little warning triangle on the sqlite3.c folder and I have no idea why.  Do you know how I can find out."}, {"owner": {"reputation": 127, "user_id": 1070376, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/685c924ce35a28d0f22f2f0071758807?s=128&d=identicon&r=PG", "display_name": "sax", "link": "https://stackoverflow.com/users/1070376/sax"}, "edited": false, "score": 0, "creation_date": 1471466831, "post_id": 38995332, "comment_id": 65363627, "body": "I don&#39;t know how seriously to take this warning, but this is what it says down in the Problems view: variable &#39;bRc&#39; set but not used [-Wunused-but-set-variable]\tsqlite3.c\t/RealDealProcessor/src&zwnj;&#8203;\tline 26579\tC/C++ Problem"}], "tags": [], "owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "is_accepted": true, "score": 0, "last_activity_date": 1471433154, "creation_date": 1471433154, "answer_id": 38995332, "question_id": 38992400, "link": "https://stackoverflow.com/questions/38992400/i-cannot-get-eclipse-mingw-and-sqlite-to-work-together-for-a-c-program/38995332#38995332", "title": "I cannot get Eclipse MinGW and Sqlite to Work Together for a C program", "body": "<p>The amalgamation is supposed to be compiled together with your other source files. Just add the <code>.c</code> file to your project, as if it were one of your own source files.</p>\n"}], "owner": {"reputation": 127, "user_id": 1070376, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/685c924ce35a28d0f22f2f0071758807?s=128&d=identicon&r=PG", "display_name": "sax", "link": "https://stackoverflow.com/users/1070376/sax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 38995332, "answer_count": 1, "score": 0, "last_activity_date": 1471433154, "creation_date": 1471424919, "last_edit_date": 1471425503, "question_id": 38992400, "link": "https://stackoverflow.com/questions/38992400/i-cannot-get-eclipse-mingw-and-sqlite-to-work-together-for-a-c-program", "title": "I cannot get Eclipse MinGW and Sqlite to Work Together for a C program", "body": "<p>So I have spent the whole day trying to figure this out, and alas I have failed.  I need help!  So I installed Eclipse and MinGW so that I can write a C program.  I am new to all of this.  I need to be able to access an sqlite database.  So I downloaded the sqlite amalgamation and unzipped it to C:/sqlite3 and it contains two .c files and two .h files.  In the examples, I have seen online they include the sqlite.h header file as follows:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;sqlite.h&gt;\n</code></pre>\n\n<p>So I think that I need to add an includes folder holding my sqlite info. So I click on my project and select Properties>C/C++ General>Paths and Symbols.  With the \"Includes\" tab selected and the Language GNU C highlighted, I add the Include directory C:\\sqlite3.  So far no problems, I can build a project that prints my name in the console.</p>\n\n<p>Now I add some sample code from a tutorial site:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;sqlite3.h&gt; \n\nint main(int argc, char* argv[])\n{\n   sqlite3 *db;\n   int rc;\n\n   rc = sqlite3_open(\"test.db\", &amp;db);\n\n   if( rc ){\n      fprintf(stderr, \"Can't open database: %s\\n\", sqlite3_errmsg(db));\n      return(0);\n   }else{\n      fprintf(stderr, \"Opened database successfully\\n\");\n   }\n   sqlite3_close(db);\n}\n</code></pre>\n\n<p>I get 3 errors claiming undefined reference to the sqlite3 functions. So I think I need to add a link to sqlite3 in the compiler. So now I go to Properties>C/C++ Build/Settings and add -lsqlite3 to the MinGW C Linker Command line. Now my errors disappear when I build the project, but I get a compile error that says this:</p>\n\n<pre><code>c:/mingw/bin/../lib/gcc/x86_64-w64-mingw32/6.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lsqlite3\n</code></pre>\n\n<p>It looks like it is looking for the sqlite3 files in the MinGW directories.  I am stuck.  I have tried pasting the file in the MinGW directory and even that doesn't work.  I know that I am missing something obvious to the world, but I only have about 5 pieces of hair left on my head and could really use some insight.  Please help me to get Eclipse set up using MinGW and accessing Sqlite. Thanks!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1471424238, "post_id": 38992147, "comment_id": 65336254, "body": "Undefined behavior for passing the wrong type to a varargs-function."}, {"owner": {"reputation": 12794, "user_id": 865643, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mG7s3.jpg?s=128&g=1", "display_name": "noelicus", "link": "https://stackoverflow.com/users/865643/noelicus"}, "edited": false, "score": 0, "creation_date": 1471424584, "post_id": 38992147, "comment_id": 65336491, "body": "He/she means that your example won&#39;t work and so won&#39;t show anything. But...your question still stands despite your example."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1471424598, "post_id": 38992147, "comment_id": 65336504, "body": "Endianess shouldn&#39;t have an effect. The offset of the first element of a struct should always be zero. The offset of every next element should be larger than that of its predecessor."}, {"owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "edited": false, "score": 0, "creation_date": 1471424678, "post_id": 38992147, "comment_id": 65336550, "body": "The results are next to unbelivable\u2014in most popular architectures zero is equal to NULL pointer, and actual static or automatic variable <code>s</code> could not be allocated at NULL\u2013pointed location. Try to compile and run the program, and show actual results."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 1, "creation_date": 1471425001, "post_id": 38992325, "comment_id": 65336755, "body": "To note: the term &quot;digital word&quot; has no relevance in C. Endianness in C expresses itself in the way integer types are stored in consecutive <code>char</code>-sized cells in C&#39;s memory model."}, {"owner": {"reputation": 2037, "user_id": 1468415, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wx7N9.png?s=128&g=1", "display_name": "mvidelgauz", "link": "https://stackoverflow.com/users/1468415/mvidelgauz"}, "edited": false, "score": 0, "creation_date": 1471425202, "post_id": 38992325, "comment_id": 65336876, "body": "@Rhymoid You are right and that adds to understanding that endianness is not connected to C. &quot;digital word&quot; is term used in <i>endianness</i> article in WikiPedia, which I just quoted"}], "tags": [], "owner": {"reputation": 2037, "user_id": 1468415, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wx7N9.png?s=128&g=1", "display_name": "mvidelgauz", "link": "https://stackoverflow.com/users/1468415/mvidelgauz"}, "is_accepted": false, "score": 5, "last_activity_date": 1471425330, "last_edit_date": 1471425330, "creation_date": 1471424705, "answer_id": 38992325, "question_id": 38992147, "link": "https://stackoverflow.com/questions/38992147/does-the-endianness-affect-how-structure-members-are-stored-into-the-memory/38992325#38992325", "title": "Does the endianness affect how structure members are stored into the memory", "body": "<p><a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow\">Endianness refers to the order of the bytes comprising a <strong>digital word</strong> in computer memory</a></p>\n\n<p>C <code>struct</code> is NOT a <em>digital word</em> (it is not an entity with which CPU deals), so the answer is no, endianness does not affect how structure members are stored into the memory</p>\n\n<p>What does affect how structure members are stored into the memory is <a href=\"https://en.wikipedia.org/wiki/Data_structure_alignment\" rel=\"nofollow\">Data structure alignment</a>, which may add some padding between members to align member address to make it equal to some multiple of the word size</p>\n"}, {"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 5, "last_activity_date": 1471425089, "last_edit_date": 1471425089, "creation_date": 1471424719, "answer_id": 38992330, "question_id": 38992147, "link": "https://stackoverflow.com/questions/38992147/does-the-endianness-affect-how-structure-members-are-stored-into-the-memory/38992330#38992330", "title": "Does the endianness affect how structure members are stored into the memory", "body": "<p>Endianness is not a factor in the process of deciding offsets of <code>struct</code> members. The initial member will always be allocated at offset zero; the remaining members will be allocated at higher offsets in the order they appear in the <code>struct</code> declaration.</p>\n\n<p>System-independent way to code your program is as follows:</p>\n\n<pre><code>struct {\n    uint32_t i;\n    uint32_t i2;\n}s;\nintptr_t p = (intptr_t)&amp;s;\nintptr_t pi = (intptr_t)&amp;s.i;\nintptr_t pi2 = (intptr_t)&amp;s.i2;\nprintf(\"%tu %tu\\n\", pi-p, pi2-p);\n</code></pre>\n\n<p><a href=\"http://ideone.com/q6gypJ\" rel=\"nofollow\">Demo 1.</a> <code>intptr_t</code> lets you treat pointers as if they were integers; <code>%tu</code> format specifier prints <code>ptrdiff_t</code> values as unsigned numbers.</p>\n\n<p>You can also do it like this:</p>\n\n<pre><code>struct S {\n    uint32_t i;\n    uint32_t i2;\n};\nprintf(\"%tu %tu\\n\", offsetof(struct S, i), offsetof(struct S, i2));\n</code></pre>\n\n<p><a href=\"http://ideone.com/cTaYbQ\" rel=\"nofollow\">Demo 2</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 12794, "user_id": 865643, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mG7s3.jpg?s=128&g=1", "display_name": "noelicus", "link": "https://stackoverflow.com/users/865643/noelicus"}, "is_accepted": false, "score": 1, "last_activity_date": 1471424797, "creation_date": 1471424797, "answer_id": 38992361, "question_id": 38992147, "link": "https://stackoverflow.com/questions/38992147/does-the-endianness-affect-how-structure-members-are-stored-into-the-memory/38992361#38992361", "title": "Does the endianness affect how structure members are stored into the memory", "body": "<p>Endianness refers to the order of bytes within the processor's natural types: <code>integers</code> and <code>floats</code>. The top element in a <code>struct</code> will always come first in memory regardless of endianness. You do have to mind out for the gaps as usually structs are padded (byte aligned) dependant on compiler etc. </p>\n"}, {"tags": [], "owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "is_accepted": false, "score": 0, "last_activity_date": 1471424881, "creation_date": 1471424881, "answer_id": 38992386, "question_id": 38992147, "link": "https://stackoverflow.com/questions/38992147/does-the-endianness-affect-how-structure-members-are-stored-into-the-memory/38992386#38992386", "title": "Does the endianness affect how structure members are stored into the memory", "body": "<p>Structure members' layout is implementation dependent, so it can vary between compilers' brands, chosen optimization modes and destination architectures. Generally, though, the endiannes alone is the order of bytes in multi-byte types (like <code>int32</code>), so it shouldn't affect the order of multi-byte chunks of data.</p>\n"}, {"tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": false, "score": 2, "last_activity_date": 1471424948, "creation_date": 1471424948, "answer_id": 38992412, "question_id": 38992147, "link": "https://stackoverflow.com/questions/38992147/does-the-endianness-affect-how-structure-members-are-stored-into-the-memory/38992412#38992412", "title": "Does the endianness affect how structure members are stored into the memory", "body": "<p>Endianness doesn't affect the order of the members.</p>\n\n<p>From N1570 6.7.2.1 Structure and union specifiers:</p>\n\n<blockquote>\n  <ol start=\"6\">\n  <li>As discussed in 6.2.5, a structure is a type consisting of <strong>a sequence of members, whose\n  storage is allocated in an ordered sequence</strong>, and a union is a type consisting of a sequence\n  of members whose storage overlap.</li>\n  </ol>\n</blockquote>\n\n<p>There might be padding bytes in between the members and at the end of structure though.</p>\n"}], "owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1018, "favorite_count": 2, "accepted_answer_id": 38992330, "answer_count": 5, "score": 5, "last_activity_date": 1471425330, "creation_date": 1471424150, "last_edit_date": 1471424314, "question_id": 38992147, "link": "https://stackoverflow.com/questions/38992147/does-the-endianness-affect-how-structure-members-are-stored-into-the-memory", "title": "Does the endianness affect how structure members are stored into the memory", "body": "<pre><code>struct\n{\n    uint32_t i;\n    uint32_t i2;\n}s;\nprintf(\"%p %p\", &amp;s.i, &amp;s.i2);\n</code></pre>\n\n<p>If the example above prints: </p>\n\n<blockquote>\n  <p>0 4</p>\n</blockquote>\n\n<p>That means that the topmost member into the structure is located at the smaller memory address, and the consequent elements are stored at contiguous addresses in increasing order.</p>\n\n<p>What if the platform endianness is inverted? Would that pattern change?\nIs this mentioned somewhere in the specification of some C standard? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 676, "user_id": 2587648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/568109a206e1a38eebd07c885e51a30b?s=128&d=identicon&r=PG", "display_name": "vitalygolub", "link": "https://stackoverflow.com/users/2587648/vitalygolub"}, "edited": false, "score": 1, "creation_date": 1471424039, "post_id": 38992022, "comment_id": 65336131, "body": "printf(&quot;%*.*f\\n&quot;,10,5,123.456);"}], "answers": [{"comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1471424243, "post_id": 38992079, "comment_id": 65336257, "body": "<a href=\"https://ideone.com/TvPkdy\" rel=\"nofollow noreferrer\">Demo</a>"}, {"owner": {"reputation": 738, "user_id": 3902681, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000497258931/picture?type=large", "display_name": "Adrian Grzywaczewski", "link": "https://stackoverflow.com/users/3902681/adrian-grzywaczewski"}, "edited": false, "score": 0, "creation_date": 1471424288, "post_id": 38992079, "comment_id": 65336285, "body": "Thanks your solution works like a charm"}], "tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": false, "score": 2, "last_activity_date": 1471424309, "last_edit_date": 1471424309, "creation_date": 1471423974, "answer_id": 38992079, "question_id": 38992022, "link": "https://stackoverflow.com/questions/38992022/is-it-possible-to-pass-an-integer-to-a-precision-specifier-for-string/38992079#38992079", "title": "Is it possible to pass an integer to a precision specifier for string", "body": "<p>Yes, use <code>*</code> as the precision, which takes another <code>int</code> argument off the argument list (before the argument whose value is to be printed):</p>\n\n<pre><code>void prec_print(double d, int prec)\n{ \n    printf(\"%.*f\\n\", prec, d);\n}\n</code></pre>\n\n<p>(Similarly, the field width may be specified dynamically by using <code>*</code>, too: <code>%*.*f, width, prec, val</code>.)</p>\n"}], "owner": {"reputation": 738, "user_id": 3902681, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000497258931/picture?type=large", "display_name": "Adrian Grzywaczewski", "link": "https://stackoverflow.com/users/3902681/adrian-grzywaczewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "closed_date": 1471424060, "answer_count": 1, "score": 0, "last_activity_date": 1471424903, "creation_date": 1471423785, "last_edit_date": 1471424903, "question_id": 38992022, "link": "https://stackoverflow.com/questions/38992022/is-it-possible-to-pass-an-integer-to-a-precision-specifier-for-string", "closed_reason": "Duplicate", "title": "Is it possible to pass an integer to a precision specifier for string", "body": "<p>I was wondering if it is possible to pass an integer as a precision specifier.</p>\n\n<p>For example if </p>\n\n<pre><code> static void ShouldBeTruncated( char * StringToCheck, int precision )\n{\n  (strlen( StringToCheck )&gt;= precision) ? printf( \"%.15s...\", StringToCheck) : printf( \"%s\", StringToCheck)  ;\n}\n</code></pre>\n\n<p>Is it even possible to replace <code>%.15s</code> with <code>%.&lt;&lt;PRECISION GOES HERE &gt;&gt;s</code> so the length of precision could be specified ? \nIf it is possible, how to do it ?</p>\n"}, {"tags": ["c", "linked-list", "stack"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1471432248, "post_id": 38991851, "comment_id": 65341603, "body": "Note: you don&#39;t <i>need</i> the tail pointer. Not for a stack, anyway."}, {"owner": {"reputation": 2034, "user_id": 4688321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5b21d8c934125839996c5eac897fc1?s=128&d=identicon&r=PG&f=1", "display_name": "kiner_shah", "link": "https://stackoverflow.com/users/4688321/kiner-shah"}, "edited": false, "score": 0, "creation_date": 1471432438, "post_id": 38991851, "comment_id": 65341746, "body": "You are not allocating &quot;start&quot; with any memory and that&#39;s why it&#39;s giving &quot;Segmentation Error&quot;. Plus, you have declared &quot;tail&quot; in the push method; that&#39;s not needed!"}, {"owner": {"reputation": 5956, "user_id": 1249472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7d2ac9163237829d11cbf4ee7d563d?s=128&d=identicon&r=PG", "display_name": "Nikita", "link": "https://stackoverflow.com/users/1249472/nikita"}, "reply_to_user": {"reputation": 2034, "user_id": 4688321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5b21d8c934125839996c5eac897fc1?s=128&d=identicon&r=PG&f=1", "display_name": "kiner_shah", "link": "https://stackoverflow.com/users/4688321/kiner-shah"}, "edited": false, "score": 0, "creation_date": 1471432537, "post_id": 38991851, "comment_id": 65341836, "body": "@kiner_shah <code>start</code> is initialzied by <code>tempNode</code> when <code>start==NULL</code>. So it&#39;s not the reason of the problem"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 2034, "user_id": 4688321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5b21d8c934125839996c5eac897fc1?s=128&d=identicon&r=PG&f=1", "display_name": "kiner_shah", "link": "https://stackoverflow.com/users/4688321/kiner-shah"}, "edited": false, "score": 0, "creation_date": 1471432544, "post_id": 38991851, "comment_id": 65341840, "body": "@kiner_shah <code>start</code> and co <i>are</i> initialised, along with their declaration at global scope."}, {"owner": {"reputation": 2034, "user_id": 4688321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5b21d8c934125839996c5eac897fc1?s=128&d=identicon&r=PG&f=1", "display_name": "kiner_shah", "link": "https://stackoverflow.com/users/4688321/kiner-shah"}, "edited": false, "score": 0, "creation_date": 1471432603, "post_id": 38991851, "comment_id": 65341885, "body": "Ohh, my bad! I guess, I misunderstood that expression!"}, {"owner": {"reputation": 4967, "user_id": 868856, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wXvX2.png?s=128&g=1", "display_name": "Fredrick Gauss", "link": "https://stackoverflow.com/users/868856/fredrick-gauss"}, "edited": false, "score": 1, "creation_date": 1471433485, "post_id": 38991851, "comment_id": 65342520, "body": "Please add <code>else</code> statement to <code>isEmpty</code> function."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 4967, "user_id": 868856, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wXvX2.png?s=128&g=1", "display_name": "Fredrick Gauss", "link": "https://stackoverflow.com/users/868856/fredrick-gauss"}, "edited": false, "score": 1, "creation_date": 1471435116, "post_id": 38991851, "comment_id": 65343571, "body": "@FredrickGauss Good catch. As is, if <code>top != 1</code>, that function invokes UB. So, OP, did you expect the compiler to guess what value you want to return otherwise? What you might want is simply <code>return top == -1</code> to convert the condition to a boolean return value. I mean, you don&#39;t even use that function here, but if you <i>did</i>, it would quickly cause trouble."}], "answers": [{"comments": [{"owner": {"reputation": 2034, "user_id": 4688321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5b21d8c934125839996c5eac897fc1?s=128&d=identicon&r=PG&f=1", "display_name": "kiner_shah", "link": "https://stackoverflow.com/users/4688321/kiner-shah"}, "edited": false, "score": 0, "creation_date": 1471432466, "post_id": 38995038, "comment_id": 65341773, "body": "There are even more errors in the code other than this!"}, {"owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "reply_to_user": {"reputation": 2034, "user_id": 4688321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5b21d8c934125839996c5eac897fc1?s=128&d=identicon&r=PG&f=1", "display_name": "kiner_shah", "link": "https://stackoverflow.com/users/4688321/kiner-shah"}, "edited": false, "score": 0, "creation_date": 1471432704, "post_id": 38995038, "comment_id": 65341959, "body": "@kiner_shah Sure! Even the formatted string <code>printf(&quot;y\\n&quot;)</code> which will prints a new line, and I suspect that is no the exact behaviour he wants. Anyway I answered the problem for the segmentation fault, the focused problem <i>asked</i> in the question. More comments and answers will be more than appreciate, I suppose :)"}, {"owner": {"reputation": 2034, "user_id": 4688321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5b21d8c934125839996c5eac897fc1?s=128&d=identicon&r=PG&f=1", "display_name": "kiner_shah", "link": "https://stackoverflow.com/users/4688321/kiner-shah"}, "edited": false, "score": 0, "creation_date": 1471432892, "post_id": 38995038, "comment_id": 65342116, "body": "I don&#39;t think that was the cause to segmentation fault! The main reason was the double declaration of &quot;tail&quot; pointer in the original code I guess! @Biagio Festa. One in the push function and the other globally!"}, {"owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "reply_to_user": {"reputation": 2034, "user_id": 4688321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5b21d8c934125839996c5eac897fc1?s=128&d=identicon&r=PG&f=1", "display_name": "kiner_shah", "link": "https://stackoverflow.com/users/4688321/kiner-shah"}, "edited": false, "score": 0, "creation_date": 1471434536, "post_id": 38995038, "comment_id": 65343184, "body": "@kiner_shah I thought details were obvious, but they&#39;re not. I tested with <i>gcc</i> compiler and I can ensure you the segmentation fault the question describes is given by that: <i>&quot;It is accepting only one input and not taking further and at the same time it is giving segmentation error&quot;.</i> In fact, <code>scanf</code> expects a pointer, and passing a char makes a seg. error. Try yourself and believe"}, {"owner": {"reputation": 2034, "user_id": 4688321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5b21d8c934125839996c5eac897fc1?s=128&d=identicon&r=PG&f=1", "display_name": "kiner_shah", "link": "https://stackoverflow.com/users/4688321/kiner-shah"}, "edited": false, "score": 0, "creation_date": 1471446343, "post_id": 38995038, "comment_id": 65352225, "body": "I think you are right, according to the problem he mentioned. But, after we fix that, we can still get segmentation fault because of the two &quot;tail&quot; pointers! Try it out because I tried and it did lead to an error!"}], "tags": [], "owner": {"reputation": 8510, "user_id": 6040181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-dQXdInUPrE0/AAAAAAAAAAI/AAAAAAAAAdg/_OLdfGWclsw/photo.jpg?sz=128", "display_name": "Biagio Festa", "link": "https://stackoverflow.com/users/6040181/biagio-festa"}, "is_accepted": false, "score": 0, "last_activity_date": 1471432507, "last_edit_date": 1471432507, "creation_date": 1471432378, "answer_id": 38995038, "question_id": 38991851, "link": "https://stackoverflow.com/questions/38991851/pushing-data-into-stack-using-linkedlist/38995038#38995038", "title": "pushing data into stack using LinkedList", "body": "<p>Take a look at:</p>\n\n<pre><code>scanf(\" %c\",choice);\n</code></pre>\n\n<p>The second parameter should be passed as address, because <code>scanf</code> modifies it.</p>\n\n<p>Try to modify with:</p>\n\n<pre><code>scanf(\"%c\", &amp;choice);\n</code></pre>\n\n<p>I'm not going to explain the reason in detail, because I think you just made a mistake since in some previous lines <code>scanf(\" %c\",&amp;ch);</code> you've invoke right.</p>\n\n<p><em>Note: I'd avoid the space in the <code>scanf</code> string format.</em></p>\n"}, {"comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1471435151, "post_id": 38995219, "comment_id": 65343596, "body": "I&#39;ve not checked the rest of it, but this still has the missing return value in <code>isEmpty()</code>, which causes UB... or would if the OP ever used it!"}, {"owner": {"reputation": 155, "user_id": 6359420, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/1197712216928681/picture?type=large", "display_name": "Nitin Shekhar", "link": "https://stackoverflow.com/users/6359420/nitin-shekhar"}, "edited": false, "score": 0, "creation_date": 1471514967, "post_id": 38995219, "comment_id": 65381361, "body": "thanks alot @kiner_shah  for pointing minor  errors . Since I have written C code after a long tym so I have missed these small things. Thanks...."}, {"owner": {"reputation": 2034, "user_id": 4688321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5b21d8c934125839996c5eac897fc1?s=128&d=identicon&r=PG&f=1", "display_name": "kiner_shah", "link": "https://stackoverflow.com/users/4688321/kiner-shah"}, "reply_to_user": {"reputation": 155, "user_id": 6359420, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/1197712216928681/picture?type=large", "display_name": "Nitin Shekhar", "link": "https://stackoverflow.com/users/6359420/nitin-shekhar"}, "edited": false, "score": 0, "creation_date": 1471621734, "post_id": 38995219, "comment_id": 65435820, "body": "Not a problem @Nitin! ;-)"}], "tags": [], "owner": {"reputation": 2034, "user_id": 4688321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5b21d8c934125839996c5eac897fc1?s=128&d=identicon&r=PG&f=1", "display_name": "kiner_shah", "link": "https://stackoverflow.com/users/4688321/kiner-shah"}, "is_accepted": false, "score": 0, "last_activity_date": 1471446070, "last_edit_date": 1471446070, "creation_date": 1471432794, "answer_id": 38995219, "question_id": 38991851, "link": "https://stackoverflow.com/questions/38991851/pushing-data-into-stack-using-linkedlist/38995219#38995219", "title": "pushing data into stack using LinkedList", "body": "<p>This is a bit modified code! Working code!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;malloc.h&gt;\n\ntypedef struct nodeStack{\n    char op;\n    struct  nodeStack *next;\n}node;\n\n\nnode *start = NULL;\nnode *tail = NULL;\nint top=-1;\n\n\nint isEmpty()\n{\n\n    if(top==-1)\n       return 1;\n    else return 0;\n\n}\n\n\n\nvoid push(char c){\n    node *tempNode;\n\n    tempNode=(node*) malloc(sizeof(node));\n\n    tempNode-&gt;op=c;\n    if(start==NULL){\n        //start = (node*) malloc(sizeof(node));\n        start=tempNode;\n        tail=start;\n        tempNode-&gt;next=NULL;\n        top++;\n    }\n   else{\n        tail-&gt;next=tempNode;\n        tempNode-&gt;next=NULL;\n        tail=tail-&gt;next;\n        top++;\n    }\n\n}\n\n\n/*\n struct node* pop(){\n   if(top==-1){\n       printf(\"stack is empty\");\n        return;\n   }\n\n  else\n   {\n        node *temp;\n       temp=start;\n       while(temp-&gt;next!=tail){\n          temp-&gt;next=NULL;\n          free(tail);\n          tail=temp;\n      }\n  }\n\n }*/\n\n\nvoid displayStack(){\n    node *i;\n    for(i=start;i!=NULL;i=i-&gt;next){\n        printf(\"%c -&gt; \",i-&gt;op);\n    }\n}\n\n\nint main(){\n    int i;\n    int flag=1;\n    char choice='y', ch;\n    printf(\"pushing data into the stack......\");\n    start=NULL; tail=NULL;\n    while(flag){\n        printf(\"enter a character\\n\");\n        scanf(\" %c\",&amp;ch);\n        push(ch);\n        printf(\"want to push more operator (y/n)\");\n        scanf(\" %c\",&amp;choice);\n        if(choice=='y')\n            flag=1;\n        else\n            flag=0;\n\n       }\n\n    displayStack();\n\n  return 0; \n}\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 6359420, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/1197712216928681/picture?type=large", "display_name": "Nitin Shekhar", "link": "https://stackoverflow.com/users/6359420/nitin-shekhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1471446070, "creation_date": 1471423156, "last_edit_date": 1471431681, "question_id": 38991851, "link": "https://stackoverflow.com/questions/38991851/pushing-data-into-stack-using-linkedlist", "title": "pushing data into stack using LinkedList", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;malloc.h&gt;\n\nstruct nodeStack{\n    char operator;\n    struct  nodeStack *next;\n\n};\n\ntypedef struct nodeStack node;\n\nnode *start=NULL;\nnode *tail=NULL;\nint top=-1;\n\n\nint isEmpty()\n{\n\n    if(top==-1)\n        return 1;\n\n}\n\n\n\nvoid push(char c){\n    node *tempNode,*tail;\n\n    tempNode=(node*) malloc(sizeof(node));\n    if(tempNode==NULL){\n        printf(\"Memory Unvailable\\n\");\n        return;\n    }\n\n    tempNode-&gt;operator=c;\n    if(start==NULL){\n        start=tempNode;\n        tail=start;\n        tempNode-&gt;next=NULL;\n        top++;\n    }\n    else{\n        tail-&gt;next=tempNode;\n        tempNode-&gt;next=NULL;\n        tail=tail-&gt;next;\n        top++;\n    }\n\n}\n\n\n/*\nstruct node* pop(){\n    if(top==-1){\n        printf(\"stack is empty\");\n        return;\n    }\n\n    else\n    {\n        node *temp;\n        temp=start;\n        while(temp-&gt;next!=tail){\n            temp-&gt;next=NULL;\n            free(tail);\n            tail=temp;\n        }\n    }\n\n}*/\n\n\nvoid displayStack(){\n    node *i;\n    for(i=start;i!=tail;i=i-&gt;next){\n        printf(\"%c -&gt; \",i-&gt;operator);\n    }\n}\n\n\nint main(){\n    int i;\n    int flag=1;\n    char choice='y';\n    printf(\"pushing data into the stack......\");\n\n   while(flag==1){\n        char ch;\n        printf(\"enter a character\\n\");\n        scanf(\" %c\",&amp;ch);\n        push(ch);\n        printf(\"want to push more operator (y\\n)\");\n        scanf(\" %c\",choice);\n        if(choice=='y')\n            flag=1;\n        else\n            flag=0;\n\n   }\n\n    displayStack();\n\n   return 0; \n}\n</code></pre>\n\n<p>Its giving me segmentation error when I am trying to run this.\nIt is accepting only one input and not taking further and at the same time it is giving segmentation error</p>\n\n<p>Its giving me segmentation error when I am trying to run this.\nIt is accepting only one input and not taking further and at the same time it is giving segmentation error</p>\n"}, {"tags": ["c", "linux", "scanf"], "comments": [{"owner": {"reputation": 14204, "user_id": 4723795, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/980705688614873/picture?type=large", "display_name": "xenteros", "link": "https://stackoverflow.com/users/4723795/xenteros"}, "edited": false, "score": 0, "creation_date": 1471422011, "post_id": 38991431, "comment_id": 65334881, "body": "Could you please explain me what <code>new</code> mean in <code>C</code>?"}, {"owner": {"reputation": 3709, "user_id": 6296435, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/c1Gx3.png?s=128&g=1", "display_name": "Maverick Meerkat", "link": "https://stackoverflow.com/users/6296435/maverick-meerkat"}, "reply_to_user": {"reputation": 14204, "user_id": 4723795, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/980705688614873/picture?type=large", "display_name": "xenteros", "link": "https://stackoverflow.com/users/4723795/xenteros"}, "edited": false, "score": 0, "creation_date": 1471422223, "post_id": 38991431, "comment_id": 65334996, "body": "@xenteros it&#39;s just the name of my new array holding the new values to be appended. Maybe it&#39;s a poor choice of name, since I think new has some meaning in C++, but it doesn&#39;t affect the code. I changed it to new1, and it still acts exactly the same..."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1471422623, "post_id": 38991431, "comment_id": 65335243, "body": "Generally speaking, <code>fseek()</code> is not dependable on text files."}, {"owner": {"reputation": 3709, "user_id": 6296435, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/c1Gx3.png?s=128&g=1", "display_name": "Maverick Meerkat", "link": "https://stackoverflow.com/users/6296435/maverick-meerkat"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1471422668, "post_id": 38991431, "comment_id": 65335263, "body": "@jxh - any other suggestion of what to use? I need to always read the last two lines of the log file..."}, {"owner": {"reputation": 1613, "user_id": 6413048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05e41c326a8c8c6240e3a8b71e806d58?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6413048/tim"}, "edited": false, "score": 0, "creation_date": 1471422755, "post_id": 38991431, "comment_id": 65335309, "body": "It&#39;s a poor choice of name that&#39;s right since 1) it does not describe the variable and 2) it&#39;s a common protected word in many languages. Anyway if in the code you show you refer to a variable or function, please be sure that its declaration IS in the code you show."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1471422986, "post_id": 38991431, "comment_id": 65335446, "body": "I don&#39;t see why <code>-70</code> will always get you to the beginning of the last two lines. Myself, I would probably <code>mmap</code> the file, and search for the last two lines."}, {"owner": {"reputation": 3709, "user_id": 6296435, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/c1Gx3.png?s=128&g=1", "display_name": "Maverick Meerkat", "link": "https://stackoverflow.com/users/6296435/maverick-meerkat"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1471423242, "post_id": 38991431, "comment_id": 65335616, "body": "@jxh - each line contains exactly 34 chars + the EOL character. I think. But you might be right. How can I write it using mmap?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1471423387, "post_id": 38991431, "comment_id": 65335721, "body": "For streams open in text mode, offset shall either be zero or a value returned by a previous call to ftell, and origin shall necessarily be SEEK_SET."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1471423745, "post_id": 38991431, "comment_id": 65335947, "body": "<code>mmap</code> example: <a href=\"http://stackoverflow.com/questions/20460670/reading-a-file-to-string-with-mmap\" title=\"reading a file to string with mmap\">stackoverflow.com/questions/20460670/&hellip;</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471436042, "post_id": 38991431, "comment_id": 65344210, "body": "<code>fseek(fptr, -70, SEEK_END);</code> --&gt; Check its result."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471436234, "post_id": 38991431, "comment_id": 65344345, "body": "&quot;something very strange happens&quot; --&gt; check return values of ` fscanf(fptr, ...`.  Are they as expected?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471436473, "post_id": 38991431, "comment_id": 65344504, "body": "It is not clear <code>rev</code>, as used as an index like <code>new1[rev]</code>, is <i>always</i> in the value range 0 to 10."}], "answers": [{"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 0, "last_activity_date": 1471425511, "creation_date": 1471425511, "answer_id": 38992592, "question_id": 38991431, "link": "https://stackoverflow.com/questions/38991431/trouble-with-fscanf-in-c/38992592#38992592", "title": "Trouble with fscanf() in C", "body": "<p>There is at least one problem in your code. You say that log.txt contains lines and that you add a new line at the end, but your code never output a single <code>'\\n'</code>, so you never write the EOL marker. As you say you use Linux, the end of line <em>on disk</em> is indeed a single character <code>'\\n'</code>, but your code would not work on Windows where it is the pair <code>\"\\r\\n\"</code> => said differently the present code is not portable.</p>\n\n<p>But if you only want to run in on a Unix system, just add a new line after writing the 11 values:</p>\n\n<pre><code>/* append the new arrangement to file */\nfptr = fopen(\"log.txt\", \"a\");\nfor(i = 0; i &lt; 11; i++)\n{\n    fprintf(fptr, \"%d, \", *(new1 + i));\n}\nfputc('\\n', fptr);\nfclose(fptr); \n</code></pre>\n\n<p>I could run it 5 times and it did add 5 lines (of exactly 35 characters...)</p>\n\n<p>But <strong>beware</strong>:\nHere you are essentially processing a text file <em>as if</em> it was a binary file with records of size 35. That is not portable because end of lines are different across architecture, but it is dangerous for another reason: as it is a text file, it can be opened with a text editor, say vi. What would you expect if someone opens the file and inadvertently add some spaces at the end of one of the 2 last lines? The records will not be exactly 35 characters long and you will read wrong values. And as you fail to test any result of you input functions (neither open, nor fscanf) and you do not test that you have read values from 0 to 10 either, your program is likely to crash without any useful message.</p>\n\n<p>TL/DR: do add tests for all your open and fscanf calls, and do control that every line contains all values from 0 to 10</p>\n"}], "owner": {"reputation": 3709, "user_id": 6296435, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/c1Gx3.png?s=128&g=1", "display_name": "Maverick Meerkat", "link": "https://stackoverflow.com/users/6296435/maverick-meerkat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471425511, "creation_date": 1471421780, "last_edit_date": 1471423089, "question_id": 38991431, "link": "https://stackoverflow.com/questions/38991431/trouble-with-fscanf-in-c", "title": "Trouble with fscanf() in C", "body": "<p>I'm reading and writing (append mode) into a file, and something very strange happens. The first time I run it, it reads the file perfectly, and appends the new line perfectly. The second time, it gets stuck reading the file. </p>\n\n<p>What am I doing wrong?</p>\n\n<p>The reading:</p>\n\n<pre><code>fptr = fopen(\"log.txt\", \"r\");\nfseek(fptr, -70, SEEK_END); \nfor(i = 0; i &lt; 11; i++)\n{\n    fscanf(fptr, \"%d, \", llast + i);\n    printf(\"%d \", llast[i]);\n}\n\n/* read the last review */    \nfor(i = 0; i &lt; 11; i++)\n{\n    fscanf(fptr, \"%d, \", last + i);\n    printf(\"%d \", last[i]);\n}\n\nfclose(fptr);\n</code></pre>\n\n<p>The appending:</p>\n\n<pre><code>fptr = fopen(\"log.txt\", \"a\");\nfor(i = 0; i &lt; 11; i++)\n{\n    fprintf(fptr, \"%d, \", *(new + i));\n}\nfprintf(fptr, \"\\n\");\nfclose(fptr); \n</code></pre>\n\n<p>The <code>log.txt</code> file last two lines contain:</p>\n\n<pre><code>7, 4, 0, 10, 2, 8, 9, 5, 6, 3, 1, \n3, 7, 5, 6, 9, 2, 4, 10, 0, 1, 8, \n</code></pre>\n\n<p>The Full Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt; /* for the rand function */\n\nint main()\n{\nint last[11] = {0};\nint llast[11] = {0};\nint new1[11] = {-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1};\nint i = 0, j = 0;\nint rev = 0;\nint flag = 0;\nint big_flag = 0;\nFILE *fptr;\n\nprintf(\"\\nThe last review:\\n\");\nPrintRev();\nprintf(\"\\n\\n\");\n\n/* open the log file of the reviews, and load the last two into arrays */\nfptr = fopen(\"log.txt\", \"r\");\n\n/* read the review before the last review*/\nfseek(fptr, -70, SEEK_END); \n\nfor(i = 0; i &lt; 11; i++)\n{\n    fscanf(fptr, \"%d, \", llast + i);\n    printf(\"%d \", llast[i]);\n}\n\n/* read the last review */    \nfor(i = 0; i &lt; 11; i++)\n{\n    fscanf(fptr, \"%d, \", last + i);\n    printf(\"%d \", last[i]);\n}\n\nfclose(fptr);\n\n/* create a new arrangement of reviewing */\n\n/* the big flag is used for the extreme case when the first 10 reviewers are assigned\n   but a problem occurs in the last remaining option for the last reviewer -\n   so instead of running into a dead end of endless-loop, if there is a problem,\n   we start over again ... */\nwhile(!big_flag)\n{\n    for(i = 0; i &lt; 10; i++)\n    {\n        flag = 0;\n        /* the small flag is used to make sure the first 10 reviewers follow the rules */\n        while(!flag)\n        {\n            rev = (rand() % 11);\n            if((rev != i) &amp;&amp; /* you can't review yourself */\n               (rev != last[i]) &amp;&amp;  /* you can't review the person you did last time */\n               (rev != llast[i]) &amp;&amp; /* let's try without the last-last time */\n               (rev != (i - 1)) &amp;&amp; (rev != (i + 1)) &amp;&amp; /* you can't review your neighbour */\n               (new1[rev] != i)) /* you can't review the person reviewing you */\n            {\n                flag = 1;                \n                /* a reviewer can't review more than one person... so we check if he wasn't\n                   chosen before */\n                for(j = 0; j &lt; i; j++)\n                {\n                    if(rev == new1[j])\n                    {\n                        flag = 0;\n                    }\n                }\n            }\n        }\n        new1[i] = rev;\n    }\n\n    /* find the only remaining id of reviewer */\n    rev = 55; /* sum of 0,1, ... 10 */\n    for(i = 0; i &lt; 10; i++)\n    {\n        rev -= new1[i];\n    }\n    /* check if the remaining id is valid */ \n    if((rev != i) &amp;&amp; \n       (rev != last[i]) &amp;&amp;  \n       (rev != llast[i]) &amp;&amp; /* let's try without the last-last time */\n       (rev != (i - 1)) &amp;&amp; \n       (new1[rev] != i))\n    /* if so, appoint it, and raise the big flag to exit the loop */\n    {\n        new1[10] = rev;\n        big_flag = 1;\n    } \n}\n\n/* append the new arrangement to file */\nfptr = fopen(\"log.txt\", \"a\");\nfor(i = 0; i &lt; 11; i++)\n{\n    fprintf(fptr, \"%d, \", *(new1 + i));\n}\n\nfclose(fptr); \n\n\n\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "gcc"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 5, "creation_date": 1471420269, "post_id": 38990941, "comment_id": 65333868, "body": "You should use neither of your ways. Create a header file with declaretions of functions and <code>#include</code> it."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1471420862, "post_id": 38990941, "comment_id": 65334239, "body": "I think the size difference comes from the prototypes of fonk# functions. When they are not included the compiler &quot;guess&quot; they are functions and allocate some space to store info about them. When they are included that is done elsewhere"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3177100"}, "edited": false, "score": 0, "creation_date": 1471421758, "post_id": 38990941, "comment_id": 65334747, "body": "adding the lines &quot; void fonk0(int );&quot; and  &quot;void fonk1(void );&quot; in main.c as predeclarations, should make it work"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1471423054, "post_id": 38990941, "comment_id": 65335484, "body": "The important topics that you probably want to research are &quot;translation unit&quot; and &quot;linkage&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 4, "last_activity_date": 1471423951, "creation_date": 1471423951, "answer_id": 38992076, "question_id": 38990941, "link": "https://stackoverflow.com/questions/38990941/what-is-difference-between-include-c-file-and-giving-as-a-parameter-in-c/38992076#38992076", "title": "what is difference between include c file and giving as a parameter in C?", "body": "<p>You get the warning because there is no visible function declaration to the code in main. You need to create a header file \"file.h\" with the function prototypes inside, then include that header from main.c and file.c both.</p>\n\n<p>Never <code>#include</code> .c files. It never makes sense and the need for doing so always originates from bad program design. </p>\n"}], "owner": {"reputation": 1483, "user_id": 2646022, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/05ffec904ecdbcb7ab453d3b292a3044?s=128&d=identicon&r=PG&f=1", "display_name": "user4757345", "link": "https://stackoverflow.com/users/2646022/user4757345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 38992076, "answer_count": 1, "score": 0, "last_activity_date": 1471423951, "creation_date": 1471420187, "last_edit_date": 1471420398, "question_id": 38990941, "link": "https://stackoverflow.com/questions/38990941/what-is-difference-between-include-c-file-and-giving-as-a-parameter-in-c", "title": "what is difference between include c file and giving as a parameter in C?", "body": "<p>I have 2 c files. first is <code>main.c</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n//#include \"file.c\"\n\nint main(int argc, char const *argv[])\n{\n    fonk0(5);\n    fonk1();\n    return 0;       \n}\n</code></pre>\n\n<p>and second is <code>file.c</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint aa;\nvoid fonk0(int a)\n{\n    aa=a;\n}\n\nvoid fonk1()\n{\n    printf(\"aa is : %d \\n\", aa);\n}\n</code></pre>\n\n<p>When I compile these files I use this command:</p>\n\n<pre><code>gcc -Wall main.c file.c -o main1\n</code></pre>\n\n<p>it gives warnings</p>\n\n<pre><code>main.c: In function \u2018main\u2019:\nmain.c:7:2: warning: implicit declaration of function \u2018fonk0\u2019 [-Wimplicit-function-declaration]\n  fonk0(5);\n  ^\nmain.c:8:2: warning: implicit declaration of function \u2018fonk1\u2019 [-Wimplicit-function-declaration]\n  fonk1();\n  ^\n</code></pre>\n\n<p>and <code>main1</code> file is 7104 bytes.</p>\n\n<p>After that I added <code>#include \"file.c\"</code> line to <code>main.c</code> and compile it again with this command</p>\n\n<pre><code>gcc -Wall main.c -o main2\n</code></pre>\n\n<p>it gives no warnings</p>\n\n<p>and <code>main2</code> file is 7072 bytes.</p>\n\n<p><code>main1</code> and <code>main2</code> works correctly. So what is the difference between these ways ? Why <code>main1</code> and <code>main2</code> has different file size ? and which way I should use ?</p>\n\n<p>I used <code>debian 8.5</code> and <code>gcc 4.9.2</code>.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "performance", "conditional", "variable-assignment"], "comments": [{"owner": {"reputation": 1705, "user_id": 4608491, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22e6b09884f71ced2b2ba36de05ab764?s=128&d=identicon&r=PG&f=1", "display_name": "123iamking", "link": "https://stackoverflow.com/users/4608491/123iamking"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1471420579, "post_id": 38990923, "comment_id": 65334055, "body": "Thank you for answer me. what about the write and read data part? Does write data affect the memory/ram more than read data?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1471421366, "post_id": 38990923, "comment_id": 65334498, "body": "I&#39;m pretty sure I remember seeing a duplicate of this question about if/when it&#39;s worth it to use an <code>if</code> to avoid an assignment, but can&#39;t find it."}], "answers": [{"comments": [{"owner": {"reputation": 1705, "user_id": 4608491, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22e6b09884f71ced2b2ba36de05ab764?s=128&d=identicon&r=PG&f=1", "display_name": "123iamking", "link": "https://stackoverflow.com/users/4608491/123iamking"}, "edited": false, "score": 0, "creation_date": 1471420796, "post_id": 38991078, "comment_id": 65334187, "body": "What about the write and read data part? Does write data affect the memory/ram more than read data - like write will make ram hotter than read, for instance?"}, {"owner": {"reputation": 1705, "user_id": 4608491, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22e6b09884f71ced2b2ba36de05ab764?s=128&d=identicon&r=PG&f=1", "display_name": "123iamking", "link": "https://stackoverflow.com/users/4608491/123iamking"}, "edited": false, "score": 0, "creation_date": 1471421496, "post_id": 38991078, "comment_id": 65334593, "body": "Oh, I can&#39;t satisfy if I don&#39;t know if write will make ram hotter than read or not?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1705, "user_id": 4608491, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22e6b09884f71ced2b2ba36de05ab764?s=128&d=identicon&r=PG&f=1", "display_name": "123iamking", "link": "https://stackoverflow.com/users/4608491/123iamking"}, "edited": false, "score": 1, "creation_date": 1471421503, "post_id": 38991078, "comment_id": 65334597, "body": "@123iamking: a DRAM write command is probably about the same as a DRAM read command for energy consumption.  But that doesn&#39;t happen for every store in the asm, because of caching.  There&#39;s a huge difference between what the asm does and the memory traffic seen by DRAM.  Do whatever will make your code run in fewer cycles on average, because race-to-sleep is important for CPU core power consumption."}, {"owner": {"reputation": 1705, "user_id": 4608491, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22e6b09884f71ced2b2ba36de05ab764?s=128&d=identicon&r=PG&f=1", "display_name": "123iamking", "link": "https://stackoverflow.com/users/4608491/123iamking"}, "edited": false, "score": 0, "creation_date": 1471421618, "post_id": 38991078, "comment_id": 65334660, "body": "So when we do a statement like int a; a = 3; // code 1 if(a==3){}// Code 2  ==&gt; code 1 and code 2 do the same with physic consumption."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1705, "user_id": 4608491, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22e6b09884f71ced2b2ba36de05ab764?s=128&d=identicon&r=PG&f=1", "display_name": "123iamking", "link": "https://stackoverflow.com/users/4608491/123iamking"}, "edited": false, "score": 0, "creation_date": 1471422021, "post_id": 38991078, "comment_id": 65334889, "body": "@123iamking: Edit your question so you can use code formatting; I can&#39;t make sense of that mess.  But conditional branches will slow your code down.  Always doing a write makes more sense than doing a read / branch / maybe a write in almost all cases."}, {"owner": {"reputation": 1705, "user_id": 4608491, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22e6b09884f71ced2b2ba36de05ab764?s=128&d=identicon&r=PG&f=1", "display_name": "123iamking", "link": "https://stackoverflow.com/users/4608491/123iamking"}, "edited": false, "score": 0, "creation_date": 1471423719, "post_id": 38991078, "comment_id": 65335933, "body": "sorry :p,  So when we do a statement like  int a;   [Enter] a = 3; // code 1  [Enter] if(a==3){}// Code 2  [Enter] ==&gt; code 1 and code 2 do the same with physic consumption.  [Enter] I&#39;m very sorry, StackOverflow don&#39;t allow new line for comment or something"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 1705, "user_id": 4608491, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22e6b09884f71ced2b2ba36de05ab764?s=128&d=identicon&r=PG&f=1", "display_name": "123iamking", "link": "https://stackoverflow.com/users/4608491/123iamking"}, "edited": false, "score": 1, "creation_date": 1471423919, "post_id": 38991078, "comment_id": 65336060, "body": "@123iamking:  That&#39;s why I said to edit that into your question, instead of messing around with unreadable comments.  But <code>if(a==3){}</code> is more efficient because it doesn&#39;t do anything.  The <code>{}</code> is empty, so the compiler doesn&#39;t even need to do the test.  <a href=\"https://godbolt.org/g/Q8GTce\" rel=\"nofollow noreferrer\">godbolt.org/g/Q8GTce</a>."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 1, "last_activity_date": 1471420658, "creation_date": 1471420658, "answer_id": 38991078, "question_id": 38990923, "link": "https://stackoverflow.com/questions/38990923/should-i-reduce-set-variable/38991078#38991078", "title": "Should I reduce set variable", "body": "<p>No.  The assignment will hopefully compile to a move between registers, which is cheaper than a conditional branch.</p>\n\n<p>If <code>health</code> is a global, you might want to manually sink the store to the global out of the loop, but even a store on every iteration isn't too bad.  Repeated stores to the same memory location are cheap, because they will hit in L1 cache.  You can expect a throughput of ~1 per clock, without hogging memory bandwidth for other cores.</p>\n\n<p>Since you tagged this as <code>assembly</code>, see the <a href=\"/questions/tagged/x86\" class=\"post-tag\" title=\"show questions tagged &#39;x86&#39;\" rel=\"tag\">x86</a> tag wiki for links to performance details for that platform, especially Agner Fog's stuff.  A lot of the concepts are similar for other architectures.</p>\n"}], "owner": {"reputation": 1705, "user_id": 4608491, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22e6b09884f71ced2b2ba36de05ab764?s=128&d=identicon&r=PG&f=1", "display_name": "123iamking", "link": "https://stackoverflow.com/users/4608491/123iamking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 38991078, "answer_count": 1, "score": 0, "last_activity_date": 1471441358, "creation_date": 1471420111, "last_edit_date": 1471441358, "question_id": 38990923, "link": "https://stackoverflow.com/questions/38990923/should-i-reduce-set-variable", "title": "Should I reduce set variable", "body": "<p>I have 2 C++ code:</p>\n\n<p>Code 1: Reduce assign variable</p>\n\n<pre><code>While(alive)\n{\nif(health &lt; healthMax) health = healthMax;\n}\n</code></pre>\n\n<p>Code 2: Not reduce assign variable</p>\n\n<pre><code>While(alive)\n{\nhealth = healthMax;\n}\n</code></pre>\n\n<p>I don't know how set and get works, but I personally think that set will change/write the data on memory, and get only read memory, so it's best to get and reduce set - that's why I prefer Code 1 more for now. Am I thinking it right?</p>\n\n<p>Thank you for reading :)</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1471420082, "post_id": 38990848, "comment_id": 65333744, "body": "The behaviour is undefined; anything may happen, including &#39;the program crashes&#39; and &#39;the program appears to work&#39;."}, {"owner": {"reputation": 2533, "user_id": 2925287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/821554321/picture?type=large", "display_name": "Pierre Emmanuel Lallemant", "link": "https://stackoverflow.com/users/2925287/pierre-emmanuel-lallemant"}, "reply_to_user": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1471420517, "post_id": 38990848, "comment_id": 65334011, "body": "@bolov the failure, thx"}], "answers": [{"tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": true, "score": 5, "last_activity_date": 1471420685, "last_edit_date": 1495542785, "creation_date": 1471420120, "answer_id": 38990924, "question_id": 38990848, "link": "https://stackoverflow.com/questions/38990848/what-happens-when-i-cast-uint8-t-array-to-uint32-t/38990924#38990924", "title": "What happens when I cast uint8_t array to uint32_t?", "body": "<p>It's illegal, because it breaks strict aliasing rules, resulting in <a href=\"https://stackoverflow.com/a/4105123/694733\">undefined behaviour</a>. </p>\n\n<p>Use <code>memcpy</code> instead:</p>\n\n<pre><code>memcpy(&amp;i, &amp;arr[1], sizeof(i));\n</code></pre>\n\n<p>But do notice that this code assumes host endianness. If you need endianness independent code, use bit shifting and masking to combine 4 values in to integer, or swap bytes after <code>memcpy</code> (compilers usually offer some kind intrisics for this).</p>\n"}, {"tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 0, "last_activity_date": 1471420420, "creation_date": 1471420420, "answer_id": 38991006, "question_id": 38990848, "link": "https://stackoverflow.com/questions/38990848/what-happens-when-i-cast-uint8-t-array-to-uint32-t/38991006#38991006", "title": "What happens when I cast uint8_t array to uint32_t?", "body": "<p>This undefined behavior due to aliasing rules, you can just use an assignment:</p>\n\n<pre><code>i = arr[1];\n</code></pre>\n\n<p>which converts the <code>uint8_t</code> value to <code>uint32_t</code> value.</p>\n"}, {"tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": false, "score": 3, "last_activity_date": 1471423912, "creation_date": 1471423912, "answer_id": 38992066, "question_id": 38990848, "link": "https://stackoverflow.com/questions/38990848/what-happens-when-i-cast-uint8-t-array-to-uint32-t/38992066#38992066", "title": "What happens when I cast uint8_t array to uint32_t?", "body": "<p>Type punning violates the effective type rules, section 6.5 para 6 and 7 of the C standard. These say that you don't have the right to access an object with a different type than it was declared. (There are some complicated exceptions to these rules, but which don't apply, here.)</p>\n\n<p>Doing so has your program in an undefined state and bad things can happen. As a rule of thumb, never do pointer casts unless you know exactly what you are doing.</p>\n\n<p>If you really need to switch between the byte representation and another type the easiest way is to use a union</p>\n\n<pre><code>union twist {\n  unsigned char c[sizeof(uint32_t)];\n  uint32_t u;\n} val = { .c = { [0] = 7, } };\n\n// now use\nval.u\n</code></pre>\n"}], "owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2981, "favorite_count": 0, "accepted_answer_id": 38990924, "answer_count": 3, "score": 3, "last_activity_date": 1471423912, "creation_date": 1471419874, "question_id": 38990848, "link": "https://stackoverflow.com/questions/38990848/what-happens-when-i-cast-uint8-t-array-to-uint32-t", "title": "What happens when I cast uint8_t array to uint32_t?", "body": "<p>Suppose I have this array:</p>\n\n<pre><code>uint8_t arr[10];\n</code></pre>\n\n<p>located at address <code>0x00</code>.</p>\n\n<p>Then I want to assign part of it to  uint32_t value. Aggregatin of arr[1], arr[2], arr[3] and arr[4] to 32 bit integer. Here is an example:</p>\n\n<pre><code>uint8_t arr[10];\nuint32_t i;\ni = *( (uint32_t *)&amp;arr[1] );\n</code></pre>\n\n<p>What bothers me is that <code>arr[1]</code> is located at address not multiple of four(at address 0x01). So the question is: what would happen on 32bit platform? Is this legal, does it have some disadvantages compared to standard <code>uint32</code> assignments?</p>\n"}, {"tags": ["c", "search", "binary-tree"], "comments": [{"owner": {"reputation": 451, "user_id": 6503727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zlDtA.jpg?s=128&g=1", "display_name": "burakozgul", "link": "https://stackoverflow.com/users/6503727/burakozgul"}, "edited": false, "score": 0, "creation_date": 1471418710, "post_id": 38990437, "comment_id": 65332964, "body": "If tree is not BST, you must traverse all tree linearly (inorder - postorder - preorder) which complexity is O(n)"}, {"owner": {"reputation": 79, "user_id": 6304732, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dee71e9e0873f7b01d872066a014ba7c?s=128&d=identicon&r=PG&f=1", "display_name": "Shubh", "link": "https://stackoverflow.com/users/6304732/shubh"}, "reply_to_user": {"reputation": 451, "user_id": 6503727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zlDtA.jpg?s=128&g=1", "display_name": "burakozgul", "link": "https://stackoverflow.com/users/6503727/burakozgul"}, "edited": false, "score": 0, "creation_date": 1471442777, "post_id": 38990437, "comment_id": 65349481, "body": "Okkk but what if i use the above traversal method BFT...What will be its complexity.Thanks a lot for helping me @burakozgul"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 6304732, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dee71e9e0873f7b01d872066a014ba7c?s=128&d=identicon&r=PG&f=1", "display_name": "Shubh", "link": "https://stackoverflow.com/users/6304732/shubh"}, "edited": false, "score": 0, "creation_date": 1471442591, "post_id": 38990528, "comment_id": 65349323, "body": "Thanks a lot..@nikhil"}], "tags": [], "owner": {"reputation": 694, "user_id": 3419726, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100003552165422/picture?type=large", "display_name": "Nikhil Pathania", "link": "https://stackoverflow.com/users/3419726/nikhil-pathania"}, "is_accepted": true, "score": 4, "last_activity_date": 1471418913, "last_edit_date": 1471418913, "creation_date": 1471418800, "answer_id": 38990528, "question_id": 38990437, "link": "https://stackoverflow.com/questions/38990437/searching-in-a-tree-tree-is-not-bst/38990528#38990528", "title": "Searching in a tree (tree is not BST)", "body": "<p>Problem is in your search funtion, a simple typo<br/></p>\n\n<p><code>if(curr==level)\n{\n</code><strong>if(root->data==num)</strong><br/>\n    <code>printf(\"Found %d at level %d\\n\",root-&gt;data,level);\n    exit(-1);\n    else printf(\"Not Found\\n\");\n }</code><br/> Instead of comparing values you have used an assignment operator which will always print a value.</p>\n"}], "owner": {"reputation": 79, "user_id": 6304732, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dee71e9e0873f7b01d872066a014ba7c?s=128&d=identicon&r=PG&f=1", "display_name": "Shubh", "link": "https://stackoverflow.com/users/6304732/shubh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 38990528, "answer_count": 1, "score": -1, "last_activity_date": 1471732409, "creation_date": 1471418462, "last_edit_date": 1471732409, "question_id": 38990437, "link": "https://stackoverflow.com/questions/38990437/searching-in-a-tree-tree-is-not-bst", "title": "Searching in a tree (tree is not BST)", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n</code></pre>\n\n<p>It just prints whatever data I pass, if possible please suggest for some optimization.</p>\n\n<pre><code>struct node{\nint data;\nstruct node* left;\nstruct node* right;\n};\n</code></pre>\n\n<h2>For new Node Creation</h2>\n\n<pre><code>struct node* newNode(int data)\n{\nstruct node* node= malloc(sizeof(struct node));\nnode-&gt;data=data;\nnode-&gt;left=NULL;\nnode-&gt;right=NULL;\nreturn node;\n}\n</code></pre>\n\n<h2>Returns height of tree</h2>\n\n<pre><code>int height(struct node* root)  //returns height of a tree\n{\nint lheight,rheight;\nif(root==NULL)return;\nelse\n{\n    lheight=height(root-&gt;left);\n    rheight=height(root-&gt;right);\n}\nif(lheight&gt;rheight)\nreturn lheight+1;\nelse return rheight+1;\n}\n</code></pre>\n\n<h2>Search Function</h2>\n\n<pre><code>void levelordersearch(struct node* root,int curr,int level,int num)\n{\nif(root==NULL) return;\nif(curr==level)\n{\n    if(root-&gt;data=num)\n    printf(\"Found %d at level %d\\n\",root-&gt;data,level);\n    exit(-1);\n    else printf(\"Not Found\\n\");\n }\n else\n {\n    levelordersearch(root-&gt;left,curr+1,level,num);\n    levelordersearch(root-&gt;right,curr+1,level,num);\n }\n\n }\n</code></pre>\n\n<h2>For each level traversal</h2>\n\n<pre><code> void level(struct node* root,int data)\n{\nint h,i;\nh=height(root);\nfor(i=1;i&lt;=h;i++)\n{\n    levelordersearch(root,1,i,data);\n}\n}\n</code></pre>\n\n<h2>Driver program to test the Functionality</h2>\n\n<pre><code>int main()\n{\nstruct node *root = newNode(1);\n\nroot-&gt;left = newNode(2);\nroot-&gt;right = newNode(3);\nroot-&gt;left-&gt;left = newNode(4);\nroot-&gt;left-&gt;right = newNode(5); \nlevel(root,90);\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["python", "c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1471416839, "post_id": 38989905, "comment_id": 65331938, "body": "It&#39;s looking for the script in the <i>current working directory</i> which obviously is not what you think it is. Try using an absolute path, or find the absolute path some other way programatically."}, {"owner": {"reputation": 673, "user_id": 4910008, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5f23b3d24343abf121af99ef91515aa2?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4910008/david"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1471421389, "post_id": 38989905, "comment_id": 65334518, "body": "Thank you @Joachim Pileborg,how can I find absolute path at the run time?I can not hardcode it, it won&#39;t work.."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1471527868, "post_id": 38989905, "comment_id": 65390076, "body": "@David You should <b>not</b> edit the answer into the question. Instead post your <i>own</i> answer (possibly more complete than just &quot;use this function&quot;) and accept it."}], "answers": [{"tags": [], "owner": {"reputation": 673, "user_id": 4910008, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5f23b3d24343abf121af99ef91515aa2?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4910008/david"}, "is_accepted": true, "score": 1, "last_activity_date": 1471760931, "last_edit_date": 1471760931, "creation_date": 1471616931, "answer_id": 39041564, "question_id": 38989905, "link": "https://stackoverflow.com/questions/38989905/execute-python-script-from-c/39041564#39041564", "title": "Execute python script from C", "body": "<p>GetModuleFileNameW() function retrieves the fully qualified path for the file that contains the specified module.\nThis way you can find absolute path of the .dll and use _chdir and change the current working directory to that path.</p>\n"}], "owner": {"reputation": 673, "user_id": 4910008, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5f23b3d24343abf121af99ef91515aa2?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4910008/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 2, "accepted_answer_id": 39041564, "answer_count": 1, "score": 0, "last_activity_date": 1471760931, "creation_date": 1471416601, "last_edit_date": 1471617227, "question_id": 38989905, "link": "https://stackoverflow.com/questions/38989905/execute-python-script-from-c", "title": "Execute python script from C", "body": "<p>As part of my C code I run python script,(one of the .dll files runs the script)</p>\n\n<pre><code>getcwd(directory);\nret_value = ShellExecute(NULL,NULL,\"myScript.py\",NULL,directory,0);\n</code></pre>\n\n<p>This is the folder of the program after build.</p>\n\n<p>If I run the .exe from the folder every thing works.</p>\n\n<p><strong>The bug:</strong>\nIf I search program .exe outside the folder and run it the script doesn't run.</p>\n\n<p><a href=\"https://postimg.org/image/aewpx0ofd/\" rel=\"nofollow\"><img src=\"https://s4.postimg.org/417mtrjjh/msg_Vbug.png\" alt=\"msgVbug.png\"></a></p>\n\n<p><strong>Search:</strong>\nIf I run it from here the script doesn't run. \n<a href=\"https://postimg.org/image/f0aqvfkbd/\" rel=\"nofollow\"><img src=\"https://s4.postimg.org/52zq2dcpp/Capturesearch.png\" alt=\"Capturesearch.png\"></a></p>\n"}, {"tags": ["c", "struct", "constants", "self-reference"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1471417553, "post_id": 38989853, "comment_id": 65332309, "body": "If you already init the variables with <code>menuEntry_1 = {title_1, &amp;menuEntry_2, &amp;menuEntry_4, &amp;menuEntry_1, &amp;menuEntry_5};</code>, why would you initialize them again in <code>menu_init</code>?"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1471418103, "post_id": 38989853, "comment_id": 65332618, "body": "Since your struct contains <i>pointers</i> to these (global) variables, I believe you should be able to simply define them and initialize in a single line, i.e. there is no need to have functions for initialization. It&#39;s true that <i>&quot;every variable depends on other variables&quot;</i>, but if you are changing <code>menuEntry_1</code> contents, it doesn&#39;t mean <code>&amp;menuEntry_1</code> will change."}, {"owner": {"reputation": 83, "user_id": 6717391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9909442912d969c1086143969fd53074?s=128&d=identicon&r=PG&f=1", "display_name": "BzFr", "link": "https://stackoverflow.com/users/6717391/bzfr"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1471444527, "post_id": 38989853, "comment_id": 65350909, "body": "@user694733 : I initialize the variables in <code>menu_init</code> if i don&#39;t use them as a <code>const</code>, but if they have to be a <code>const</code> naturally i don&#39;t use <code>menu_init</code>. I was looking for the right way to do it!"}], "answers": [{"tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": true, "score": 6, "last_activity_date": 1471418074, "creation_date": 1471418074, "answer_id": 38990311, "question_id": 38989853, "link": "https://stackoverflow.com/questions/38989853/const-self-referential-structures/38990311#38990311", "title": "Const self-referential structures", "body": "<p>If you want these variables to be <code>const</code>, then you must do the initialization without the function.</p>\n\n<p>But first, let's handle the <code>const</code> in type definition:</p>\n\n<pre><code>typedef struct noFunc_menuEntry_tag noFunc_menuEntry;\nstruct noFunc_menuEntry_tag {\n    const char *text;\n    const noFunc_menuEntry *up_entry;\n    const noFunc_menuEntry *down_entry;\n    const noFunc_menuEntry *back_entry;\n    const noFunc_menuEntry *enter_entry;\n};\n</code></pre>\n\n<p>Then the declarations for the header file:</p>\n\n<pre><code>extern const noFunc_menuEntry menuEntry_1;\nextern const noFunc_menuEntry menuEntry_2;\n ...\n</code></pre>\n\n<p>And finally the definition and initialization in source file:</p>\n\n<pre><code>const noFunc_menuEntry menuEntry_1 = {title_1, &amp;menuEntry_2, &amp;menuEntry_4, &amp;menuEntry_1, &amp;menuEntry_5};\nconst noFunc_menuEntry menuEntry_2 = {title_2, &amp;menuEntry_3, &amp;menuEntry_1, &amp;menuEntry_1, &amp;menuEntry_6};\n ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 1, "creation_date": 1471418310, "post_id": 38990334, "comment_id": 65332739, "body": "I think this is a clean way to do this task."}], "tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 6, "last_activity_date": 1471418151, "creation_date": 1471418151, "answer_id": 38990334, "question_id": 38989853, "link": "https://stackoverflow.com/questions/38989853/const-self-referential-structures/38990334#38990334", "title": "Const self-referential structures", "body": "<p>You could <a href=\"http://ideone.com/JgZ0W4\">use an array</a>, since a bunch of <code>item_i</code> implies you may need to.</p>\n\n<pre><code>typedef struct noFunc_menuEntry_tag {\n    const char *text;\n    const struct noFunc_menuEntry_tag *up_entry;\n    const struct noFunc_menuEntry_tag *down_entry;\n    const struct noFunc_menuEntry_tag *back_entry;\n    const struct noFunc_menuEntry_tag *enter_entry;\n} noFunc_menuEntry;\n\n\nint main(void) {\n    const noFunc_menuEntry menuEntry[4] = {\n        {\"\", &amp;menuEntry[0], &amp;menuEntry[1], &amp;menuEntry[2], &amp;menuEntry[3]},   \n        {\"\", &amp;menuEntry[0], &amp;menuEntry[1], &amp;menuEntry[2], &amp;menuEntry[3]},   \n        {\"\", &amp;menuEntry[0], &amp;menuEntry[1], &amp;menuEntry[2], &amp;menuEntry[3]},   \n        {\"\", &amp;menuEntry[0], &amp;menuEntry[1], &amp;menuEntry[2], &amp;menuEntry[3]},   \n    };\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 107, "user_id": 6607746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y9hkG.jpg?s=128&g=1", "display_name": "Sashank", "link": "https://stackoverflow.com/users/6607746/sashank"}, "is_accepted": false, "score": 1, "last_activity_date": 1471419884, "creation_date": 1471419884, "answer_id": 38990851, "question_id": 38989853, "link": "https://stackoverflow.com/questions/38989853/const-self-referential-structures/38990851#38990851", "title": "Const self-referential structures", "body": "<p>Use <code>extern const</code> in the declaration in the header. <code>extern</code> will only declare the variable for use in the program, without allocating any memory.\nThen proceed with defining it in the main\n<code>const noFunc_menuEntry menuEntry_1 = {title_1, &amp;menuEntry_2, &amp;menuEntry_4, &amp;menuEntry_1, &amp;menuEntry_5}; .. so on</code></p>\n"}], "owner": {"reputation": 83, "user_id": 6717391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9909442912d969c1086143969fd53074?s=128&d=identicon&r=PG&f=1", "display_name": "BzFr", "link": "https://stackoverflow.com/users/6717391/bzfr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 1, "accepted_answer_id": 38990311, "answer_count": 3, "score": 8, "last_activity_date": 1471430288, "creation_date": 1471416428, "last_edit_date": 1471417675, "question_id": 38989853, "link": "https://stackoverflow.com/questions/38989853/const-self-referential-structures", "title": "Const self-referential structures", "body": "<p>I'm writing in C.</p>\n\n<p>I've defined a new type (noFunc_menuEntry) which is made of a self-referential structure.</p>\n\n<pre><code>struct noFunc_menuEntry_tag {\n    const char *text;\n    struct noFunc_menuEntry_tag *up_entry;\n    struct noFunc_menuEntry_tag *down_entry;\n    struct noFunc_menuEntry_tag *back_entry;\n    struct noFunc_menuEntry_tag *enter_entry;\n};\ntypedef struct noFunc_menuEntry_tag noFunc_menuEntry;\n</code></pre>\n\n<p>I need to define a series of variable like this:</p>\n\n<pre><code>menuEntry_1 = {title_1, &amp;menuEntry_2, &amp;menuEntry_4, &amp;menuEntry_1, &amp;menuEntry_5};\nmenuEntry_2 = {title_2, &amp;menuEntry_3, &amp;menuEntry_1, &amp;menuEntry_1, &amp;menuEntry_6};\n</code></pre>\n\n<p>and so on.</p>\n\n<p>So i need to separate declaration and defition of the variable, because every variable depends on other variables. In an header file i've written the declaration</p>\n\n<pre><code>noFunc_menuEntry menuEntry_1, menuEntry_2, menuEntry_3, menuEntry_4, menuEntry_5, menuEntry_6;\n</code></pre>\n\n<p>etc..., and in a .c file in a function i've initialized the variables:</p>\n\n<pre><code>void menu_init(void)\n{\n        menuEntry_1.text = title;\n        menuEntry_1.up_entry = &amp;menuEntry_2\n}\n</code></pre>\n\n<p>and so on for the other members and variables.</p>\n\n<p>However i want my variables to be <code>const</code>:</p>\n\n<pre><code>const noFunc_menuEntry menuEntry_1, menuEntry_2, menuEntry_3, menuEntry_4, menuEntry_5, menuEntry_6;\n</code></pre>\n\n<p>So my question is about separing declaration and definition of <code>const</code> variables of the type i've defined. How can i do? Am i doing something wrong?</p>\n\n<p>Naturally if i simply add <code>const</code> in the declaration, the compiler report me an error when i initialize the variables (i'm trying to write read-only variables).</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": false, "score": 1, "last_activity_date": 1471415719, "creation_date": 1471415719, "answer_id": 38989618, "question_id": 38989549, "link": "https://stackoverflow.com/questions/38989549/right-pad-string-with-0-in-c/38989618#38989618", "title": "Right pad string with 0 in c", "body": "<p>The length argument must be <em>before</em> the data argument, so try this</p>\n\n<pre><code>sprintf((char*)fout,\"%s%0*d\", fa , flen, 0);\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>sprintf((char*)fout,\"%s%0*d\", fa , 0, flen);\n</code></pre>\n\n<p>Quote from <a href=\"http://chimera.roma1.infn.it/SP/COMMON/iso-iec-9899-1990.pdf\" rel=\"nofollow\">N1570</a> 7.21.6.1 The fprintf function, paragraph 5:</p>\n\n<blockquote>\n  <p>As noted above, a field width, or precision, or both, may be indicated by an asterisk. In\n  this case, an int argument supplies the field width or precision. The arguments\n  specifying field width, or precision, or both, shall appear (in that order) before the\n  argument (if any) to be converted.</p>\n</blockquote>\n"}], "owner": {"reputation": 29, "user_id": 6700569, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IIciaGH0rPc/AAAAAAAAAAI/AAAAAAAAIlw/Jxwf1vPRtKk/photo.jpg?sz=128", "display_name": "bhagyashree upadhyay", "link": "https://stackoverflow.com/users/6700569/bhagyashree-upadhyay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1626, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1471415719, "creation_date": 1471415471, "question_id": 38989549, "link": "https://stackoverflow.com/questions/38989549/right-pad-string-with-0-in-c", "title": "Right pad string with 0 in c", "body": "<p>I am using zero left pad in c.Below is the implementation code.</p>\n\n<pre><code>unsigned char* LeftPadZero(unsigned char fa[], int flen)\n{\n\n    unsigned char *fout;\n    int sz;\n    sz = snprintf(NULL,0,\"%s\",fa);\n    fout = (unsigned char*)malloc(flen+sz+1);\n    if(flen &gt; 0)\n    {\n        sprintf((char*)fout,\"%0*d%s\", flen , 0, fa);\n    }\n    else if(flen == 0)\n    {\n        fout = fa;\n    }\n    else\n    {\n        printf(\"Length of number is negative\\n\");\n        return NULL;\n    }\n\n    return fout;\n\n}\n</code></pre>\n\n<p>And now i am trying to do same for Right zero pad.But instead of padding with 0 .the length is getting printed.\nEX: string000 this way it should print.In my case it is printing as string3</p>\n\n<pre><code>unsigned char* RightPadZero(unsigned char fa[], int flen)\n{\n\n    unsigned char *fout;\n    int sz;\n    sz = snprintf(NULL,0,\"%s\",fa);\n    fout = (unsigned char*)malloc(flen+sz+1);\n    if(flen &gt; 0)\n    {\n        sprintf((char*)fout,\"%s%0*d\", fa , 0, flen);\n    }\n    else if(flen == 0)\n    {\n        fout = fa;\n    }\n    else\n    {\n        printf(\"Length of number is negative\\n\");\n        return NULL;\n    }\n\n    return fout;\n\n}\n</code></pre>\n"}, {"tags": ["c", "eclipse", "windows", "gcc", "windows-10"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1471415363, "post_id": 38989470, "comment_id": 65331154, "body": "That means your program has crashed. You should run in a debugger to catch the crash in action to find out where in your code it happens. In the debugger you will also be able to examine variables an their values to help you figure out what might have caused the crash."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1471415552, "post_id": 38989470, "comment_id": 65331247, "body": "Your code should be causing the compiler to emit a lot of warnings, and if not then you need to change the build-settings so it does. Compiler warnings are often equally serious as compiler errors, as they can indicate you doing something wrong that will cause <i>undefined behavior</i> and possibly crashes when running."}], "answers": [{"tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": true, "score": 1, "last_activity_date": 1471415933, "last_edit_date": 1471415933, "creation_date": 1471415323, "answer_id": 38989507, "question_id": 38989470, "link": "https://stackoverflow.com/questions/38989470/programname-exe-has-stopped-working-dialog-in-windows-10/38989507#38989507", "title": "programname.exe has Stopped Working dialog in windows 10", "body": "<p>The part</p>\n\n<pre><code>*firstreference = &amp;first;\n*secondreference = &amp;second;\n</code></pre>\n\n<p>invokes <em>undefined behavior</em> by dereferencing <code>NULL</code>, which is the initial value of static pointer variables with no explicit initialization. Do not do that. To assign pointers to <code>first</code> and <code>second</code>, use</p>\n\n<pre><code>firstreference = &amp;first;\nsecondreference = &amp;second;\n</code></pre>\n\n<p>Also the part</p>\n\n<pre><code>scanf(\"%d\", &amp;inputreference);\nprintf(\"Value entered for second is - %d\", inputreference);\nprintf(\"Entered input reference value is - %d\",&amp;inputreference);\n</code></pre>\n\n<p>invokes <em>undefined behavior</em> by passing pointer to object having wrong type to <code>scanf()</code> and passing data having wrong type to <code>printf()</code>. What you want may be this:</p>\n\n<pre><code>scanf(\"%d\", inputreference);\nprintf(\"Value entered for second is - %d\", *inputreference);\nprintf(\"Entered input reference value is - %d\",*inputreference);\n</code></pre>\n\n<p>One more note is that you should use standard <code>int main(void)</code> in hosted environment instead of <code>void main()</code>, which is illegal in C89 and implementation-defined in C99 or later, unless you have some special reason to use non-standard signature.</p>\n"}], "owner": {"reputation": 1348, "user_id": 2675355, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/AbM69.jpg?s=128&g=1", "display_name": "Shantanu Nandan", "link": "https://stackoverflow.com/users/2675355/shantanu-nandan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 38989507, "answer_count": 1, "score": 1, "last_activity_date": 1471415933, "creation_date": 1471415204, "question_id": 38989470, "link": "https://stackoverflow.com/questions/38989470/programname-exe-has-stopped-working-dialog-in-windows-10", "title": "programname.exe has Stopped Working dialog in windows 10", "body": "<p>I am using Windows 10 , TDM-GCC with Eclipse NEON development tool which is not able to execute the program after clicking on run button, and I don't get to see any error messages it throws after compilation. It shows the Windows 10 dialog for non executed program, where it says \"A problem caused the program to stop working correctly. Windows will close the program and notify you if a solution is available.\"</p>\n\n<p>Program which i am trying to run-</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\n int first;\n int second;\n int *firstreference;\n int *secondreference;\n\n void calledbyvalue(int input);\n void calledbyreference(int *input);\n\n  void calledbyvalue(int input){\n\n   //disabling the buffer\n   setbuf(stdout, NULL);\n\n   printf(\"Enter the first value - \");\n   scanf(\"%d\", &amp;input);\n   printf(\"Value entered for first is - %d\", input);\n   printf(\"Entered input is - %d\",input);\n\n  }\n\n  void calledbyreference(int *inputreference){\n\n    //disabling the buffer\n    setbuf(stdout, NULL);\n\n    printf(\"Enter the second value - \");\n    scanf(\"%d\", &amp;inputreference);\n    printf(\"Value entered for second is - %d\", inputreference);\n    printf(\"Entered input reference value is - %d\",&amp;inputreference);\n\n   }\n\n   void main(){\n\n   *firstreference = &amp;first;\n   *secondreference = &amp;second;\n\n  //Calling user defined functions here .... \n  calledbyvalue(first);\n  calledbyreference(firstreference);\n\n calledbyvalue(second);\n calledbyreference(secondreference);\n\n}\n</code></pre>\n"}, {"tags": ["c", "main"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1471414851, "post_id": 38989371, "comment_id": 65330910, "body": "I don&#39;t have the book, but the statement looks like coding rule for preventing them from writeng dirty code which compiler accepts. Isn&#39;t the book telling the reason for the statement after or before that?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1471415034, "post_id": 38989371, "comment_id": 65330996, "body": "What you&#39;re trying to ask? I&#39;m not very clear with the question."}, {"owner": {"reputation": 2258, "user_id": 3399105, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-twhyJ9NJTFw/AAAAAAAAAAI/AAAAAAAAADA/Nwa0s-0HXvA/photo.jpg?sz=128", "display_name": "Shahid", "link": "https://stackoverflow.com/users/3399105/shahid"}, "edited": false, "score": 0, "creation_date": 1471415073, "post_id": 38989371, "comment_id": 65331016, "body": "You can call functions from other files, cause you have added <code>#include &quot;b.h&quot;</code> in a.c and <code>#include &quot;a.h&quot;</code> in b.c file. Try without including these. You won&#39;t get these."}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1471416092, "creation_date": 1471416092, "answer_id": 38989745, "question_id": 38989371, "link": "https://stackoverflow.com/questions/38989371/why-functions-defined-in-the-same-file-as-main-can-not-be-called-from-other-file/38989745#38989745", "title": "Why functions defined in the same file as main can not be called from other files in the program?", "body": "<p>The cited part is program design advise. </p>\n\n<p>There is nothing in the C language preventing you from putting a function definition anywhere in any linked file, as long as a function declaration is visible to the caller.</p>\n\n<p>But it is very bad practice to have specific files call functions in what should be the top level of the application design. The key to good program design is to write autonomous code modules that only does their designated task and knows as little about the rest of the program as possible.</p>\n\n<p>Having various parts of the application call other, non-related parts is sloppy, messy and leads to <em>tight coupling</em>. Apart from the program turning out a mess to read and maintain, tight coupling also means that bugs will escalate all over the program. Meaning that when you write a bug in one module, you will break completely non-related parts of the program. </p>\n\n<p>To prevent such things, functions located in <code>main</code> should only be helper functions called by <code>main</code> itself, if such functions are needed. They should be declared as <code>static</code> functions to block other parts of the program from getting access to them.</p>\n"}, {"tags": [], "owner": {"reputation": 862, "user_id": 5753034, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/813d3a6cdf75243a4f5fac45207848a2?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaGoku", "link": "https://stackoverflow.com/users/5753034/alphagoku"}, "is_accepted": false, "score": 0, "last_activity_date": 1519102245, "creation_date": 1519102245, "answer_id": 48878057, "question_id": 38989371, "link": "https://stackoverflow.com/questions/38989371/why-functions-defined-in-the-same-file-as-main-can-not-be-called-from-other-file/48878057#48878057", "title": "Why functions defined in the same file as main can not be called from other files in the program?", "body": "<p>In \"a.h\" include the following line:</p>\n\n<pre><code>extern int a;\nextern int b;\n</code></pre>\n\n<p>Then retry your code and check the output.</p>\n"}], "owner": {"reputation": 1, "user_id": 6724683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0ff152ba73aa92883594bcd45b7f173?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Q", "link": "https://stackoverflow.com/users/6724683/joe-q"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1519102245, "creation_date": 1471414769, "question_id": 38989371, "link": "https://stackoverflow.com/questions/38989371/why-functions-defined-in-the-same-file-as-main-can-not-be-called-from-other-file", "title": "Why functions defined in the same file as main can not be called from other files in the program?", "body": "<p>At a rainy weekend, I was reading K. N. King's <strong>C Programming: A Modern Approach</strong>.</p>\n\n<p>And at page 359, it says that \u201c<em>It is possible that there are other functions in the same file as main, so long as they are not called from other files in the program.</em>\u201d</p>\n\n<p>I do not know the reason and I try it like this:</p>\n\n<pre><code>// a.h \nint sum(void);\nint sub(void);\n\n// a.c\n#include &lt;stdio.h&gt;\n#include \"a.h\"\n#include \"b.h\"\n\nint a = 0;\nint b = 1;\n\nint main(int argc, char const *argv[])\n{\nprintf(\"sum = %d,\\nsub = %d,\\ndbl= %d\\n\", sum(), sub(), dbl() );\nreturn 0;\n}\n\nint sum()\n{\nreturn ( a + b );\n}\n\nint sub()\n{\nreturn ( a - b );\n}\n\n\n\n\n// b.h\nint dbl(void);\n\n// b.c\n#include \"a.h\"\n#include \"b.h\"\nint dbl()\n{\nreturn ( sum() + sub() );\n}\n</code></pre>\n\n<p>Then I compile it with </p>\n\n<blockquote>\n  <p>gcc -a.exe a.c b.c</p>\n</blockquote>\n\n<p>at cygwin. Then run a.exe as</p>\n\n<blockquote>\n  <p>./a.exe</p>\n</blockquote>\n\n<p>Every thing goes well with the output \"sum = 1, sub = -1, dbl = 0\". So, who gets wrong, Mr K. N. King, or I ?</p>\n"}, {"tags": ["c++", "c", "fortran"], "comments": [{"owner": {"reputation": 1380, "user_id": 4151327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fsn8K.jpg?s=128&g=1", "display_name": "Anthony Scemama", "link": "https://stackoverflow.com/users/4151327/anthony-scemama"}, "edited": false, "score": 1, "creation_date": 1471424931, "post_id": 38989158, "comment_id": 65336710, "body": "Note: if you take the subroutine out of the Fortran module you will not need the compiler-specific <code>.mod</code> file ay more, and you will be able to call directly the subroutine without the <code>__a_MOD_</code> prefix which is not portable. In my opinion, Fortran libraries should exhibit a module-free interface which makes things easier for users."}, {"owner": {"reputation": 680, "user_id": 6599487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ddd2b21482646c3a8acade4555c324?s=128&d=identicon&r=PG&f=1", "display_name": "Holmz", "link": "https://stackoverflow.com/users/6599487/holmz"}, "edited": false, "score": 0, "creation_date": 1471425221, "post_id": 38989158, "comment_id": 65336893, "body": "There are some no trailing underscore switches that can be useful. Or you can add a trailing underscore in the c. Also if the f90 routine is public or uses a !DEC$ ATTRIBUTES ALIAS:subif2::subif2 then than can help."}, {"owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "reply_to_user": {"reputation": 680, "user_id": 6599487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ddd2b21482646c3a8acade4555c324?s=128&d=identicon&r=PG&f=1", "display_name": "Holmz", "link": "https://stackoverflow.com/users/6599487/holmz"}, "edited": false, "score": 1, "creation_date": 1471426168, "post_id": 38989158, "comment_id": 65337502, "body": "@Holmz <code>bind(C,name=&quot;&quot;)</code> is much better than the old DEC ALIAS. And more importantly, the question is about gfortran and gfortran doesn&#39;t care about <code>DEC ATRTRIBUTES</code> at all. No wonder, it is not DEC but GNU."}, {"owner": {"reputation": 680, "user_id": 6599487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ddd2b21482646c3a8acade4555c324?s=128&d=identicon&r=PG&f=1", "display_name": "Holmz", "link": "https://stackoverflow.com/users/6599487/holmz"}, "reply_to_user": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "edited": false, "score": 0, "creation_date": 1471468786, "post_id": 38989158, "comment_id": 65364552, "body": "@Vladimir glad you remembered the Bind. I am not sure if BIND is &quot;much better&quot;... Basically the needs that were addressed with DEC extensions we&#39;re needs that were acknowledged and got rolled in as &quot;standards&quot;. So DEC became dogma in intent."}, {"owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "reply_to_user": {"reputation": 680, "user_id": 6599487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ddd2b21482646c3a8acade4555c324?s=128&d=identicon&r=PG&f=1", "display_name": "Holmz", "link": "https://stackoverflow.com/users/6599487/holmz"}, "edited": false, "score": 1, "creation_date": 1471471887, "post_id": 38989158, "comment_id": 65365807, "body": "@Holmz It is much better because it does the job in all conforming compilers including that one used in the question. Unlike the DEC directives which are implemented by a single compiler out of many.  (There are different things in other compilers). Notably, the compiler in the question does not implement them. I don&#39;t thing it went to the standard just from DEC, similar capability exists elsewhere as well even in different programming languages."}, {"owner": {"reputation": 574, "user_id": 5842759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b767a74c826a0496d9c9e0d98fc11c3?s=128&d=identicon&r=PG&f=1", "display_name": "jlokimlin", "link": "https://stackoverflow.com/users/5842759/jlokimlin"}, "edited": false, "score": 0, "creation_date": 1471565573, "post_id": 38989158, "comment_id": 65409133, "body": "<code>integer*8</code> is not valid Fortran and was never part of any ISO Fortran standard. You must use <code>kind</code> parameters to control precision in a portable manner. You can get storage based parameters from the intrinsic module <code>ISO_Fortran_env</code>. The C-language integer type <code>long long</code> corresponds to named constant <code>C_LONG_LONG</code> in the intrinsic module <code>ISO_C_binding</code>."}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 1407220, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/abf9e348a0dbc4d23b5da119a3a139d4?s=128&d=identicon&r=PG", "display_name": "user1407220", "link": "https://stackoverflow.com/users/1407220/user1407220"}, "edited": false, "score": 0, "creation_date": 1471414694, "post_id": 38989239, "comment_id": 65330840, "body": "That was quick. Thanks a lot"}], "tags": [], "owner": {"reputation": 11364, "user_id": 5351549, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f5c11fbd301040b24865853a1d73c914?s=128&d=identicon&r=PG&f=1", "display_name": "ewcz", "link": "https://stackoverflow.com/users/5351549/ewcz"}, "is_accepted": true, "score": 3, "last_activity_date": 1471414289, "creation_date": 1471414289, "answer_id": 38989239, "question_id": 38989158, "link": "https://stackoverflow.com/questions/38989158/problems-calling-fortran-library-from-c/38989239#38989239", "title": "Problems calling FORTRAN library from c++", "body": "<p>you have to specify the library after the object file which uses a symbol defined in it, i.e.,</p>\n\n<pre><code>g++ -o testcpp testcpp.o -L. -ltt -lgfortran\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 1407220, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/abf9e348a0dbc4d23b5da119a3a139d4?s=128&d=identicon&r=PG", "display_name": "user1407220", "link": "https://stackoverflow.com/users/1407220/user1407220"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 904, "favorite_count": 1, "accepted_answer_id": 38989239, "answer_count": 1, "score": 1, "last_activity_date": 1471414289, "creation_date": 1471413885, "question_id": 38989158, "link": "https://stackoverflow.com/questions/38989158/problems-calling-fortran-library-from-c", "title": "Problems calling FORTRAN library from c++", "body": "<p>I experience problems calling a FORTRAN subroutine from C++ when the function is put into a library created with \"ar rcs\".</p>\n\n<p>The FORTRAN routine (tt.f90) is:</p>\n\n<pre><code>Module A\ncontains\n  Subroutine SubIF2(ii)\n    Integer*8, Intent(In) :: ii\n    write(*,*) \"hello\", ii\n  End Subroutine SubIF2\nEnd Module A\n</code></pre>\n\n<p>A c++ caller (testcpp.cpp) code is</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\nextern\"C\" {\n  void __a_MOD_subif2(long long int *ii);\n}\nmain(){\n  long long int ii=5;\n  __a_MOD_subif2(&amp;ii);\n  return 0;\n}\n</code></pre>\n\n<p>A fortran caller (testf.f90) code is</p>\n\n<pre><code>Program test\n  use A\n  integer*8 :: i=1\n  call SubIF2(i)\nEnd Program test\n</code></pre>\n\n<p>the makefile is</p>\n\n<pre><code>p=/PathToMyWorkDirectory\nall:\n    gfortran -c tt.f90\n    ar rcs libtt.a tt.o\n    g++ -c testcpp.cpp\n    gfortran -c testf.f90\n    -gfortran -o testf90 testf.o tt.a\n    -g++ tt.o testcpp.o -o testcpp -lgfortran\n    -g++ -L$(p) -ltt testcpp.o -o testcpp -lgfortran\nclean:\n    -rm *.o *.mod\n    -rm testf90\n    -rm testcpp\n</code></pre>\n\n<p>While the \"gfortran -o testf90 testf.o tt.a\" and \"g++ tt.o testcpp.o -o testcpp -lgfortran\" yield a working executable, \"g++ -L$(p) -ltt testcpp.o -o testcpp -lgfortran\" crashes</p>\n\n<pre><code>testcpp.o: In function `main':\ntestcpp.cpp:(.text+0x18): undefined reference to `__a_MOD_subif2'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Since linking works for the fortran executable, I cannot see anything wrong in the library creation.</p>\n\n<p>Any idea what I missing here??</p>\n\n<p>Thanks a lot.</p>\n\n<p>Note: the final fortran function will all be binary, so adjusting the fortran code (e.g. iso_c_binding) is not an option.</p>\n"}, {"tags": ["c", "recursion", "linked-list", "function-parameter"], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 5874459, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-0kxk2H8UBF0/AAAAAAAAAAI/AAAAAAAAABw/vYKldQuWlLs/photo.jpg?sz=128", "display_name": "Shanky", "link": "https://stackoverflow.com/users/5874459/shanky"}, "edited": false, "score": 0, "creation_date": 1471421438, "post_id": 38991204, "comment_id": 65334556, "body": "Oh wow! thanks for your effort. I&#39;m not sure yet what, if something, was wrong with the <code>rev()</code> function. I&#39;m sorry my <code>create()</code> is indeed messy. Thanks again :)"}], "tags": [], "owner": {"reputation": 32921, "user_id": 5771269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6a5b618f5bd197150a6186318beba7?s=128&d=identicon&r=PG&f=1", "display_name": "cdlane", "link": "https://stackoverflow.com/users/5771269/cdlane"}, "is_accepted": true, "score": 0, "last_activity_date": 1471421066, "creation_date": 1471421066, "answer_id": 38991204, "question_id": 38989135, "link": "https://stackoverflow.com/questions/38989135/supplied-parameter-to-the-function-becomes-null/38991204#38991204", "title": "Supplied parameter to the function becomes NULL?", "body": "<p>Specific problems with your code: your <code>main()</code> function lacks sufficient code to test the reversal functionality (e.g. it doesn't create any nodes!); your <code>create()</code> routine really needs a <code>head</code> and <code>tail</code> pointer to work correctly, not the current <code>head</code> and <code>start</code>; your reversal function maintaines the head/start pointer but doesn't handle a tail pointer; you've redundant code in your <code>if</code> and <code>else</code> clauses that can be pulled out of the conditional; you declared <code>rev()</code> a <code>void *</code> instead of simply a <code>void</code>.</p>\n\n<p>I've reworked your code below with addressing the above changes along with some style issues:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nstruct node {\n    int value;\n    struct node *next;\n};\n\n// Global pointers to structure\nstruct node *head = NULL, *tail = NULL;\n\n// Function to add node\n\nvoid create(int data) {\n\n    struct node *temporary = malloc(sizeof(struct node));\n\n    temporary-&gt;value = data;\n    temporary-&gt;next = NULL;\n\n    if (head == NULL) {\n        head = temporary;\n    } else {\n        tail-&gt;next = temporary;\n    }\n\n    tail = temporary;\n}\n\n// Function to reverse the linked list\n\nvoid reverse(struct node *previous, struct node *current) {\n    if (current != NULL) {\n        reverse(current, current-&gt;next);\n        current-&gt;next = previous;\n    } else {\n        head = previous;\n    }\n\n    if (previous != NULL) {\n        tail = previous;\n    }\n }\n\nvoid display(struct node *temporary) {\n    while (temporary != NULL) {\n        printf(\"%d \", temporary-&gt;value);\n        temporary = temporary-&gt;next;\n    }\n    printf(\"\\n\");\n}\n\n// And the related code in main is:\n\nint main() {\n\n    /* Code to insert values */\n    for (int i = 1; i &lt;= 10; i++) {\n        create(i);\n    }\n\n    display(head);\n\n    reverse(NULL, head);\n\n    display(head);\n\n    create(0);\n\n    display(head);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>OUTPUT</strong></p>\n\n<pre><code>&gt; ./a.out\n1 2 3 4 5 6 7 8 9 10 \n10 9 8 7 6 5 4 3 2 1 \n10 9 8 7 6 5 4 3 2 1 0 \n&gt; \n</code></pre>\n\n<p>You should add a routine to free the nodes in the linked list.</p>\n"}], "owner": {"reputation": 699, "user_id": 5874459, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-0kxk2H8UBF0/AAAAAAAAAAI/AAAAAAAAABw/vYKldQuWlLs/photo.jpg?sz=128", "display_name": "Shanky", "link": "https://stackoverflow.com/users/5874459/shanky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 38991204, "answer_count": 1, "score": 0, "last_activity_date": 1480476408, "creation_date": 1471413821, "last_edit_date": 1480476408, "question_id": 38989135, "link": "https://stackoverflow.com/questions/38989135/supplied-parameter-to-the-function-becomes-null", "title": "Supplied parameter to the function becomes NULL?", "body": "<p>I wrote a recursive function to reverse a linked list as follows:</p>\n\n<pre><code>struct node{\nint val;\nstruct node *next;\n};\n//Global pointer to structure\nstruct node *start=NULL,*head=NULL;\n\n\n//*Function to input node*\n\nvoid create(int data){\n\nstruct node *temp;\ntemp=(struct node *)malloc(sizeof(struct node));\nif(start == NULL){\n    temp-&gt;val=data;\n    temp-&gt;next=NULL;\n    start=temp;\n    head=temp;\n}\nelse{\n    temp-&gt;val=data;\n    temp-&gt;next=NULL;\n    head-&gt;next=temp;\n    head=temp;\n    }\n   }\n\n  *Function to reverse the linked list*\n  void* rev(struct node *prev,struct node *cur){\n        if(cur!=NULL){\n        printf(\"Works\");\n        rev(cur,cur-&gt;next);\n        cur-&gt;next=prev;\n    }\n    else{\n        start=prev;\n    }\n\n }\n</code></pre>\n\n<p>And the related code in main is:</p>\n\n<pre><code>  main(){\n  struct node *temp;\n  temp=start;\n  /*Code to insert values*/\n   rev(NULL,temp);\n  }\n</code></pre>\n\n<p>Now the code takes input and prints it perfectly, but after I call <code>rev()</code> function the same traversal function prints nothing.\nI did run the code on debugger line by line n it gave me the following output:</p>\n\n<blockquote>\n  <p>rev (prev=0x0, cur=0x0) </p>\n</blockquote>\n\n<p>Also since <code>cur</code> is somehow NULL, the <code>if</code> part of <code>rev()</code> never gets executed and only the <code>else</code> executes once.\nWhen I take input in my <code>create()</code> function I do update start to the first element of the linked list and even in main a print statement proves it is so.\nBut then why the function <code>rev()</code> always receives input parameters as NULL?</p>\n\n<p>Please comment if any extra information is required.</p>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver", "ipc", "netlink"], "answers": [{"tags": [], "owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "is_accepted": false, "score": 0, "last_activity_date": 1471427230, "creation_date": 1471427230, "answer_id": 38993200, "question_id": 38989116, "link": "https://stackoverflow.com/questions/38989116/error-in-receving-data-from-kernel-using-netlink-at-user-space/38993200#38993200", "title": "Error in receving data from kernel using netlink at user-space", "body": "<p>This code is very wrong and full critique is likely unnecessary, so I'll just point out 2 most obvious types of violations.</p>\n\n<pre><code>char *data;\ndata = kmalloc(4096 * sizeof(char), GFP_KERNEL);\ndata = \"data from kernel\";\n</code></pre>\n\n<p>First a nit: sizeof(char) is guaranteed to be 1. The real problem though is that this instantly overwrites the value of <strong>data</strong>, losing the pointer returned by malloc. This is present in multiple places in the code.</p>\n\n<pre><code>req = (Response *)NLMSG_DATA(nlh);   &lt;--message received from user-space\nprintk(\"Recieved from Userspace:\\n\"); \nprintk(\"index %d\\n\", req[0].index);\nprintk(\"dataSize %d\\n\", req[0].dataSize);\nprintk(\"data: %s\\n\", req[0].data);\n</code></pre>\n\n<p>This code, while likely \"works\", is completely wrong. The userspace buffer (<strong>.data</strong>) cannot be safely accessed in this manner and on some architectures it cannot be accessed at all. It may \"work\" because the complete address space is divided into both the kernel and userspace and the kernel in principle has access there. Problems arise if the pointer is to something totally bogus or within the kernel, or maybe to something unmapped.</p>\n\n<p>The userspace portion of the code tries to do a reverse trick and unsurprisingly that fails -- you can't access kernel memory or there would be no security whatsoever.</p>\n\n<p>The problem only arises because the protocol is wrong. You should have a buffer allocated in userspace and a variable holding its size. Then you can tell the kernel where to put data (and how much tops).</p>\n\n<p>Either way, I think you are not ready for kernel work at this point and as such strongly suggest sticking to userspace for the time being.</p>\n"}], "owner": {"reputation": 1, "user_id": 5931155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4a704f5446201731b3fc5305da9bfaa?s=128&d=identicon&r=PG&f=1", "display_name": "lone_wolf", "link": "https://stackoverflow.com/users/5931155/lone-wolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 313, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471427230, "creation_date": 1471413751, "last_edit_date": 1471415858, "question_id": 38989116, "link": "https://stackoverflow.com/questions/38989116/error-in-receving-data-from-kernel-using-netlink-at-user-space", "title": "Error in receving data from kernel using netlink at user-space", "body": "<p>I writing a kernel module which accepts data(form of a structure) and passes back some data(same structure format) to the user-space. I can successfully receive the message from user but i get segmentation fault while i try tp dereference some of the members of the structure of the data received from kernel. I am using netlink socket API.</p>\n\n<p>Sample code is as below:</p>\n\n<p>user-space.c </p>\n\n<pre><code>#define NETLINK_USER 27\n\n#define MAX_PAYLOAD 10000 /* maximum payload size*/\nstruct sockaddr_nl src_addr, dest_addr;\nstruct nlmsghdr *nlh = NULL;\nstruct iovec iov;\nint sock_fd;\nstruct msghdr msg;\nResponse *p;\nResponse *req;\n\ntest r1;\ntest r2;\n\nint main()\n{\n\nchar *data;\ndata = malloc(4096 * sizeof(char));;\ndata = \"data from user\";\nsock_fd=socket(PF_NETLINK, SOCK_RAW, NETLINK_USER);\nif(sock_fd&lt;0)\nreturn -1;\n\nmemset(&amp;src_addr, 0, sizeof(src_addr));\nsrc_addr.nl_family = AF_NETLINK;\nsrc_addr.nl_pid = getpid(); \n\nbind(sock_fd, (struct sockaddr*)&amp;src_addr, sizeof(src_addr));\n\nmemset(&amp;dest_addr, 0, sizeof(dest_addr));\nmemset(&amp;dest_addr, 0, sizeof(dest_addr));\ndest_addr.nl_family = AF_NETLINK;\ndest_addr.nl_pid = 0; \ndest_addr.nl_groups = 0; \n\nnlh = (struct nlmsghdr *)malloc(NLMSG_SPACE(MAX_PAYLOAD));\nmemset(nlh, 0, NLMSG_SPACE(MAX_PAYLOAD));\nnlh-&gt;nlmsg_len = NLMSG_LENGTH(MAX_PAYLOAD);\nnlh-&gt;nlmsg_pid = getpid();\nnlh-&gt;nlmsg_flags = 0;\n\np = malloc(2*sizeof(Response));\n\np[0].index = 1;\n\np[0].dataSize = 2;\n\np[0].data = data;\np[0].test2 = 3;\np[0].test3 = 4;\np[0].test4 = 5;\n\nr1.t = 10;\nr1.ip_addr = malloc(50*sizeof(char));\nr1.ip_addr = \"192.168.10.2\";\n\np[0].test = &amp;r1;\n\n/* Extra for testing */\np[1].index = 2;\np[1].dataSize = 3;\n//strcpy(p[1].data , \"Data2 from User\");\np[1].data = data;\np[1].test2 = 4;\np[1].test3 = 5;\np[1].test4 = 6;\n\nr2.t = 20;\nr2.ip_addr = malloc(50*sizeof(char));\nr2.ip_addr = \"192.168.20.2\";\n\np[1].test = &amp;r2;\nmemcpy(NLMSG_DATA(nlh), (void *)p, 2 * sizeof(*p));\n\niov.iov_base = (void *)nlh;\niov.iov_len = NLMSG_SPACE(MAX_PAYLOAD);\nmsg.msg_name = (void *)&amp;dest_addr;\nmsg.msg_namelen = sizeof(dest_addr);\nmsg.msg_iov = &amp;iov;\nmsg.msg_iovlen = 1;\n\nprintf(\"Sending message to kernel\\n\");\nsendmsg(sock_fd,&amp;msg,0);\nprintf(\"Waiting for message from kernel\\n\");\n\n/* Read message from kernel */\n//recvmsg(sock_fd, &amp;msg, 0);\nreq = (Response*)NLMSG_DATA(nlh);\n\nprintf(\"Recieved from Kernel:\\n\"); \nprintf(\"index %d\\n\", req[0].index);\nprintf(\"dataSize %d\\n\", req[0].dataSize);\nprintf(\"data: %s\\n\", req[0].data);    &lt;---Segmentation fault from here\nprintf(\"test2 %d\\n\", req[0].test2);\nprintf(\"test3 %d\\n\", req[0].test3);\nprintf(\"test4 %d\\n\", req[0].test4);\n\n\nprintf(\"contents of test structure are %d,%s\\n\",req[0].test-&gt;t,req[0].test-&gt;ip_addr);  &lt;-----Segmentation fault \n\nclose(sock_fd);\n</code></pre>\n\n<p>Kernel_module.c</p>\n\n<pre><code>#include &lt;linux/module.h&gt;\n#include &lt;net/sock.h&gt;\n#include &lt;linux/netlink.h&gt;\n#include &lt;linux/skbuff.h&gt;\n#include &lt;linux/slab.h&gt;\n\n\n#define NETLINK_USER 27\n\nstruct sock *nl_sk = NULL;\ntypedef struct _Response Response;\n\ntypedef struct _test test;\n\n\nstruct _test{\n\n    int t;\n    char *ip_addr;\n};\n\nstruct _Response\n{\n  int index;\n  int dataSize;     \n\nchar *data;\n  int test2;\n  int test3;\n  int test4;\n\n  test *test;\n};\n\n\n\nstatic void hello_nl_recv_msg(struct sk_buff *skb) {\n\nstruct nlmsghdr *nlh;\nint pid;\nstruct sk_buff *skb_out;\nint msg_size;\nint res;\nResponse *req;\nResponse *req1;\ntest t;\n\nt.t = 1;\nt.ip_addr = kmalloc(50*sizeof(char), GFP_KERNEL);\nt.ip_addr = \"129.63.45.1\";\nreq1 = (Response *)kmalloc_array(2, sizeof(Response), GFP_KERNEL);\n\nchar *data;\ndata = kmalloc(4096 * sizeof(char), GFP_KERNEL);\ndata = \"data from kernel\";\nprintk(KERN_INFO \"Entering: %s\\n\", __FUNCTION__);\n\nmsg_size= 2 * sizeof(*req1);\n\n\nreq1[0].index = 100;\nreq1[0].dataSize = 100;\n\nreq1[0].data = data;\nreq1[0].test2 = 100;\nreq1[0].test3 = 100;\nreq1[0].test4 = 100;\nreq1[0].test = &amp;t;\nprintk(\"Sending to Userspace:\\n\"); \n\n\n/*Second set of message*/\nreq1[1].index = 102;\nreq1[1].dataSize = 103;\n//strcpy(req1[1].data , \"Data from Kernel\");\nreq1[1].data = data;\nreq1[1].test2 = 100;\nreq1[1].test3 = 100;\nreq1[1].test4 = 100;\nreq1[1].test = &amp;t;\n\nnlh=(struct nlmsghdr*)skb-&gt;data;\n\nreq = (Response *)NLMSG_DATA(nlh);   &lt;--message received from user-space\n\n\nprintk(\"Recieved from Userspace:\\n\"); \nprintk(\"index %d\\n\", req[0].index);\nprintk(\"dataSize %d\\n\", req[0].dataSize);\nprintk(\"data: %s\\n\", req[0].data);\nprintk(\"test2 %d\\n\", req[0].test2);\nprintk(\"test3 %d\\n\", req[0].test3);\nprintk(\"test4 %d\\n\", req[0].test4);\nprintk(\"contents of test are %d, %s\\n\",req[0].test-&gt;t,req[0].test-&gt;ip_addr);\n\n\nprintk(\"Next set of data\\n\");\nprintk(\"Recieved from Userspace:\\n\"); \nprintk(\"index %d\\n\", req[1].index);\nprintk(\"dataSize %d\\n\", req[1].dataSize);\nprintk(\"data: %s\\n\", req[1].data);\nprintk(\"test2 %d\\n\", req[1].test2);\nprintk(\"test3 %d\\n\", req[1].test3);\nprintk(\"test4 %d\\n\", req[1].test4);\nprintk(\"contents of test are %d, %s\\n\",req[1].test-&gt;t,req[1].test-&gt;ip_addr);\n\npid = nlh-&gt;nlmsg_pid; /*pid of sending process */\n\nskb_out = nlmsg_new(10000,0);\n\nif(!skb_out)\n{\n\n    printk(KERN_ERR \"Failed to allocate new skb\\n\");\n    return;\n\n} \nnlh=nlmsg_put(skb_out,0,0,NLMSG_DONE,10000,0);  \nNETLINK_CB(skb_out).dst_group = 0; /* not in mcast group */\n\n\n\n/*End of second set*/\n\nmemcpy(NLMSG_DATA(nlh), req1, 2 * sizeof(*req1));\n\nres=nlmsg_unicast(nl_sk,skb_out,pid);\n\nif(res&lt;0)\n    printk(KERN_INFO \"Error while sending bak to user\\n\");\n}\n\nstatic int __init hello_init(void) {\n\nprintk(\"Entering: %s\\n\",__FUNCTION__);\n\nstruct netlink_kernel_cfg cfg = {\n    .input = hello_nl_recv_msg,\n};\n\nnl_sk = netlink_kernel_create(&amp;init_net, NETLINK_USER, &amp;cfg);\n\nif(!nl_sk)\n{\n\n    printk(KERN_ALERT \"Error creating socket.\\n\");\n    return -10;\n\n}\n\nreturn 0;\n}\n\nstatic void __exit hello_exit(void) {\n\nprintk(KERN_INFO \"exiting hello module\\n\");\nnetlink_kernel_release(nl_sk);\n}\n\nmodule_init(hello_init); module_exit(hello_exit);\n\nMODULE_LICENSE(\"GPL\");\n\n}\n</code></pre>\n\n<p>global.h</p>\n\n<pre><code>#ifndef __GLOBAL_H\n#define __GLOBAL_H\n\ntypedef struct _Response Response;\ntypedef struct _test test;\n\n\nstruct _test{\n\n        int t;\n        char *ip_addr;\n}; \n\nstruct _Response\n{\n  int index;\n  int dataSize;     \n\n  char *data;\n  int test2;\n  int test3;\n  int test4;\n\n  test *test;\n};\n\n#endif\n</code></pre>\n\n<p>Basically the problem is with the pointers. If i use char data[4096] instead of character pointer, i receive the message. But i get segmentation fault while dereferencing the test structure. How to resolve this issue? </p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "c", "windows", "media-player", "vlc"], "comments": [{"owner": {"reputation": 395, "user_id": 3989673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38def4defd279dd679ff90c4195d7c5?s=128&d=identicon&r=PG", "display_name": "bigahega", "link": "https://stackoverflow.com/users/3989673/bigahega"}, "edited": false, "score": 0, "creation_date": 1471414122, "post_id": 38989041, "comment_id": 65330569, "body": "What did you try and how did it fail? Did you take a look at <a href=\"https://support.microsoft.com/en-us/kb/307395\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/307395</a> ?"}, {"owner": {"reputation": 33, "user_id": 5607064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec1c83fbcac68fce22fae47d7de09378?s=128&d=identicon&r=PG&f=1", "display_name": "Mukesh Pareek", "link": "https://stackoverflow.com/users/5607064/mukesh-pareek"}, "reply_to_user": {"reputation": 395, "user_id": 3989673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38def4defd279dd679ff90c4195d7c5?s=128&d=identicon&r=PG", "display_name": "bigahega", "link": "https://stackoverflow.com/users/3989673/bigahega"}, "edited": false, "score": 0, "creation_date": 1471414463, "post_id": 38989041, "comment_id": 65330742, "body": "I didn&#39;t find any solution to close it."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5607064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec1c83fbcac68fce22fae47d7de09378?s=128&d=identicon&r=PG&f=1", "display_name": "Mukesh Pareek", "link": "https://stackoverflow.com/users/5607064/mukesh-pareek"}, "edited": false, "score": 0, "creation_date": 1471415002, "post_id": 38989225, "comment_id": 65330983, "body": "Hello @Daniel, Thanks ! but what i need is i should be able to close the window at any moment of time"}, {"owner": {"reputation": 1639, "user_id": 4758972, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bkTEz.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/4758972/daniel"}, "reply_to_user": {"reputation": 33, "user_id": 5607064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec1c83fbcac68fce22fae47d7de09378?s=128&d=identicon&r=PG&f=1", "display_name": "Mukesh Pareek", "link": "https://stackoverflow.com/users/5607064/mukesh-pareek"}, "edited": false, "score": 0, "creation_date": 1471415205, "post_id": 38989225, "comment_id": 65331084, "body": "@MukeshPareek uh...why? I don&#39;t get it...You can close the window manually...And you can also set a stop time by using option <code>--stop-time </code>"}, {"owner": {"reputation": 33, "user_id": 5607064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec1c83fbcac68fce22fae47d7de09378?s=128&d=identicon&r=PG&f=1", "display_name": "Mukesh Pareek", "link": "https://stackoverflow.com/users/5607064/mukesh-pareek"}, "edited": false, "score": 0, "creation_date": 1471415329, "post_id": 38989225, "comment_id": 65331140, "body": "I understand that @ Daniel, But i want to close it through a call only"}, {"owner": {"reputation": 1639, "user_id": 4758972, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bkTEz.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/4758972/daniel"}, "reply_to_user": {"reputation": 33, "user_id": 5607064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec1c83fbcac68fce22fae47d7de09378?s=128&d=identicon&r=PG&f=1", "display_name": "Mukesh Pareek", "link": "https://stackoverflow.com/users/5607064/mukesh-pareek"}, "edited": false, "score": 0, "creation_date": 1471416006, "post_id": 38989225, "comment_id": 65331483, "body": "@MukeshPareek I edited the answer, which I think can help u."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 33, "user_id": 5607064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec1c83fbcac68fce22fae47d7de09378?s=128&d=identicon&r=PG&f=1", "display_name": "Mukesh Pareek", "link": "https://stackoverflow.com/users/5607064/mukesh-pareek"}, "edited": false, "score": 0, "creation_date": 1471417811, "post_id": 38989225, "comment_id": 65332449, "body": "@MukeshPareek stop moving the goalposts. You just earned a downvote."}, {"owner": {"reputation": 33, "user_id": 5607064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec1c83fbcac68fce22fae47d7de09378?s=128&d=identicon&r=PG&f=1", "display_name": "Mukesh Pareek", "link": "https://stackoverflow.com/users/5607064/mukesh-pareek"}, "edited": false, "score": 0, "creation_date": 1471425703, "post_id": 38989225, "comment_id": 65337195, "body": "Thanks once again @Daniel"}], "tags": [], "owner": {"reputation": 1639, "user_id": 4758972, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bkTEz.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/4758972/daniel"}, "is_accepted": false, "score": 2, "last_activity_date": 1471899689, "last_edit_date": 1471899689, "creation_date": 1471414221, "answer_id": 38989225, "question_id": 38989041, "link": "https://stackoverflow.com/questions/38989041/how-to-run-a-videofile-using-vlc-player-using-c/38989225#38989225", "title": "How to run a Videofile using VLC player Using C++", "body": "<p>Use option <code>--play-and-exit</code> or <code>vlc://quit</code>, namely  </p>\n\n<p><code>system(\"vlc file:///C:\\\\Users\\\\Documents\\\\Wildlife.wmv --play-and-exit\");</code>  </p>\n\n<p>or  </p>\n\n<p><code>system(\"vlc file:///C:\\\\Users\\\\Documents\\\\Wildlife.wmv --vlc://quit\");</code>  </p>\n\n<p>If you want to use another system call to terminate it, try this on Windows:  </p>\n\n<p><code>system(\"taskkill /im vlc.exe\");</code> </p>\n"}, {"tags": [], "owner": {"reputation": 395, "user_id": 3989673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38def4defd279dd679ff90c4195d7c5?s=128&d=identicon&r=PG", "display_name": "bigahega", "link": "https://stackoverflow.com/users/3989673/bigahega"}, "is_accepted": false, "score": 1, "last_activity_date": 1471415677, "creation_date": 1471415677, "answer_id": 38989605, "question_id": 38989041, "link": "https://stackoverflow.com/questions/38989041/how-to-run-a-videofile-using-vlc-player-using-c/38989605#38989605", "title": "How to run a Videofile using VLC player Using C++", "body": "<p>You need to:</p>\n\n<ol>\n<li>Get all process IDs running at that time using <code>EnumProcesses()</code>:<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682629(v=vs.85).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms682629(v=vs.85).aspx</a></li>\n<li>Call <code>OpenProcess()</code> on each process in that above list and get a <code>HANDLE</code>:<a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ms684320(v=vs.85).aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/windows/desktop/ms684320(v=vs.85).aspx</a></li>\n<li>If you managed to get a <code>HANDLE</code> call <code>GetModuleBaseName()</code> and get the process name:<a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ms683196(v=VS.85).aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/windows/desktop/ms683196(v=VS.85).aspx</a></li>\n<li>Check the name and if you have found your target process in this case \"vlc\", call <code>TerminateProcess()</code>:<a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ms686714(v=VS.85).aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/windows/desktop/ms686714(v=VS.85).aspx</a></li>\n</ol>\n\n<p>This is just a way...</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 5607064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec1c83fbcac68fce22fae47d7de09378?s=128&d=identicon&r=PG&f=1", "display_name": "Mukesh Pareek", "link": "https://stackoverflow.com/users/5607064/mukesh-pareek"}, "edited": false, "score": 0, "creation_date": 1471425677, "post_id": 38991275, "comment_id": 65337172, "body": "Thanks you @ Barmak"}], "tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": true, "score": 1, "last_activity_date": 1471421291, "creation_date": 1471421291, "answer_id": 38991275, "question_id": 38989041, "link": "https://stackoverflow.com/questions/38989041/how-to-run-a-videofile-using-vlc-player-using-c/38991275#38991275", "title": "How to run a Videofile using VLC player Using C++", "body": "<p>Use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682425(v=vs.85).aspx\" rel=\"nofollow\"><code>CreateProcess</code></a> to pass the correct commandline. See the example below. Note the use of <code>\\\"</code> separators.</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n\nint main()\n{\n    const char *appname = \"c:\\\\Program Files (x86)\\\\VideoLAN\\\\VLC\\\\vlc.exe\";\n    const char *filename = \"c:\\\\files\\\\my file.wav\";\n\n    STARTUPINFOA si;\n    PROCESS_INFORMATION pi;\n    memset(&amp;si, 0, sizeof(si));\n    si.cb = sizeof(si);\n    memset(&amp;pi, 0, sizeof(pi));\n\n    char buf[MAX_PATH + 300];\n    wsprintfA(buf, \"%s \\\"%s\\\" --play-and-exit\", appname, filename);\n    CreateProcessA(0, buf, NULL, NULL, FALSE, 0, NULL, NULL, &amp;si, &amp;pi);\n\n    return 0;\n}\n</code></pre>\n\n<p>Use Unicode if that's a proper Windows program.</p>\n"}], "owner": {"reputation": 33, "user_id": 5607064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec1c83fbcac68fce22fae47d7de09378?s=128&d=identicon&r=PG&f=1", "display_name": "Mukesh Pareek", "link": "https://stackoverflow.com/users/5607064/mukesh-pareek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2200, "favorite_count": 1, "accepted_answer_id": 38991275, "answer_count": 3, "score": 0, "last_activity_date": 1471899689, "creation_date": 1471413424, "last_edit_date": 1471413914, "question_id": 38989041, "link": "https://stackoverflow.com/questions/38989041/how-to-run-a-videofile-using-vlc-player-using-c", "title": "How to run a Videofile using VLC player Using C++", "body": "<pre><code>#include&lt;Windows.h&gt;\n\n#include&lt;direct.h&gt;\n\n\n    int main()\n{\n    _chdir`(\"C:\\\\Program Files (x86)\\\\VideoLAN\\\\VLC\");\n    system(\"vlc C:\\\\Users\\\\Documents\\\\Wildlife.wmv\");\n\n    return 0;\n}\n</code></pre>\n\n<p>By using the above code i am successfully able to run the video using vlc player but as the video finishes,still the VLC player window doesn't get close.How to shut the VLC player window?</p>\n\n<p>Please post your valuable suggestion</p>\n"}, {"tags": ["c", "linux", "gcc", "buffer-overflow"], "comments": [{"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 1, "creation_date": 1471412750, "post_id": 38988779, "comment_id": 65330020, "body": "I&#39;m not sure I understand the question... or your <code>printf</code> implementation... You do know <code>system</code> returns an <code>int</code> with the error code (0 if successful), it doesn&#39;t return a string. A simple <code>if(system(...))</code> will give you the error. If you want to print it as anice looking message, you can probably use <a href=\"http://linux.die.net/man/3/strerror\" rel=\"nofollow noreferrer\"><code>strerror</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 86, "user_id": 3641224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1203edee5dfcfaef3f57f440aebce342?s=128&d=identicon&r=PG&f=1", "display_name": "rht", "link": "https://stackoverflow.com/users/3641224/rht"}, "edited": false, "score": 0, "creation_date": 1471413859, "post_id": 38988980, "comment_id": 65330459, "body": "On <code>Ubuntu</code>, first program generates <code>*** stack smashing detected ***</code> error message along with the output and the same happens in the second program. In <code>arch linux</code> too, including the <code>-fstack-protector</code> flag when compiling the <code>vul.c</code> program generates the same output and error messages in both the programs as in <code>Ubuntu</code>. And I don&#39;t understand why <code>printf</code> would crash as the system creates a new process for running <code>vul.c</code> program. If the new process crashes then it will simply return the control back to the <code>system()</code> and printf will print the status. Please correct if wrong."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 86, "user_id": 3641224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1203edee5dfcfaef3f57f440aebce342?s=128&d=identicon&r=PG&f=1", "display_name": "rht", "link": "https://stackoverflow.com/users/3641224/rht"}, "edited": false, "score": 0, "creation_date": 1471414046, "post_id": 38988980, "comment_id": 65330540, "body": "When the control returns to <code>system</code>, then <code>system</code> returns a number to your program. When you use a number in <code>printf</code> it is translated to a string pointer, so <code>printf</code> prints whatever might be at the address of the error code... i.e. 0x0008a (for error-code 139)."}, {"owner": {"reputation": 86, "user_id": 3641224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1203edee5dfcfaef3f57f440aebce342?s=128&d=identicon&r=PG&f=1", "display_name": "rht", "link": "https://stackoverflow.com/users/3641224/rht"}, "edited": false, "score": 0, "creation_date": 1471414451, "post_id": 38988980, "comment_id": 65330735, "body": "I am really sorry. I copied the wrong program. My mistake. Editing the program with correction."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 86, "user_id": 3641224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1203edee5dfcfaef3f57f440aebce342?s=128&d=identicon&r=PG&f=1", "display_name": "rht", "link": "https://stackoverflow.com/users/3641224/rht"}, "edited": false, "score": 0, "creation_date": 1471415148, "post_id": 38988980, "comment_id": 65331051, "body": "@rht - No worries. I updated the answer to reflect the change."}, {"owner": {"reputation": 86, "user_id": 3641224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1203edee5dfcfaef3f57f440aebce342?s=128&d=identicon&r=PG&f=1", "display_name": "rht", "link": "https://stackoverflow.com/users/3641224/rht"}, "edited": false, "score": 0, "creation_date": 1471416467, "post_id": 38988980, "comment_id": 65331719, "body": "Thanks for updating the answer. I know the eror message is irrelevant for <code>exp.c</code>. But how can I get a useful error message for printing as printing the error using <code>strerror()</code> prints <code>Unknown error 139</code>?"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 86, "user_id": 3641224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1203edee5dfcfaef3f57f440aebce342?s=128&d=identicon&r=PG&f=1", "display_name": "rht", "link": "https://stackoverflow.com/users/3641224/rht"}, "edited": false, "score": 0, "creation_date": 1471417712, "post_id": 38988980, "comment_id": 65332381, "body": "@rht there&#39;s also <code>strsignal</code>, I edited my answer to include this option."}, {"owner": {"reputation": 86, "user_id": 3641224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1203edee5dfcfaef3f57f440aebce342?s=128&d=identicon&r=PG&f=1", "display_name": "rht", "link": "https://stackoverflow.com/users/3641224/rht"}, "edited": false, "score": 0, "creation_date": 1471421091, "post_id": 38988980, "comment_id": 65334368, "body": "Passing <code>tmp</code> to <code>strsignal</code> generates the same error message: <code>unknown signal 139</code>. The reason is that there is no signal with this signal number. <code>&#47;usr&#47;include&#47;bits&#47;signum.h</code> contains all the signals with their signal numbers. Passing <code>tmp-128</code> to <code>strsignal</code> works. <a href=\"http://stackoverflow.com/questions/1101957/are-there-any-standard-exit-status-codes-in-linux\" title=\"are there any standard exit status codes in linux\">stackoverflow.com/questions/1101957/&hellip;</a>  <a href=\"http://linux.die.net/man/2/wait\" rel=\"nofollow noreferrer\">linux.die.net/man/2/wait</a>"}, {"owner": {"reputation": 86, "user_id": 3641224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1203edee5dfcfaef3f57f440aebce342?s=128&d=identicon&r=PG&f=1", "display_name": "rht", "link": "https://stackoverflow.com/users/3641224/rht"}, "edited": false, "score": 0, "creation_date": 1471437506, "post_id": 38988980, "comment_id": 65345237, "body": "I posted an answer about the use of <code>strsignal(tmp-128)</code> which I think is not always correct as described in the answer. <a href=\"http://stackoverflow.com/a/38996769/3641224\">stackoverflow.com/a/38996769/3641224</a>"}], "tags": [], "owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "is_accepted": true, "score": 1, "last_activity_date": 1471422144, "last_edit_date": 1495542173, "creation_date": 1471413115, "answer_id": 38988980, "question_id": 38988779, "link": "https://stackoverflow.com/questions/38988779/no-error-message-when-using-system-to-execute-program-with-buffer-overflow-vul/38988980#38988980", "title": "No error message when using system() to execute program with buffer overflow vulnerability", "body": "<p>As I pointed out in my comment,<a href=\"http://linux.die.net/man/3/system\" rel=\"nofollow noreferrer\"><code>system</code></a> returns an int with the programs's return value, which is normally it's error code (0 if successful).</p>\n\n<p>If you want to print the error as a nice looking message, you can probably use <a href=\"http://linux.die.net/man/3/strerror\" rel=\"nofollow noreferrer\"><code>strerror</code></a>.</p>\n\n<p>According to @rht's comment (see my next edit) and the answers to the question referenced in that comment, the returned value will be 0 on success and on error it will be <code>error | 0x80</code>. To get the original error code, use <code>128 - err_code</code>.</p>\n\n<p>try this:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n\nint main(void)\n{\n    int tmp = system(\"./vul $(perl -e 'print \\\"A\\\"x100)\");\n    if(tmp &lt; 0)\n       error(\"Couldn't run system command\");\n    else if(tmp &gt;0)\n       printf(stderr, \"System command returned error: %s\", strerror(128 - tmp));\n    else\n       ; // nothing\n    return 0;\n}\n</code></pre>\n\n<p>The fact that <code>vul.c</code> does (or does not) print an error message should be irrelevant for your <code>exp.c</code> program, since it depends on <code>vul.c</code>'s compile flags values and any default compiler flags - things <code>exp.c</code> can't control.</p>\n\n<p><strong>EDIT(2)</strong> - in answer to the comment.</p>\n\n<p>It could be that the error message returned isn't an <code>errno</code> value, but a signal <code>trap</code> value.</p>\n\n<p>These are sometimes hard to differentiate and I have no good advice about how you can tell which one it is without using <code>memcmp</code> against the answer.</p>\n\n<p>In this case you know <code>vul.c</code> will never return it's <code>errno</code> value, which leaves you only with signal trap errors, so you can use <a href=\"http://linux.die.net/man/3/strsignal\" rel=\"nofollow noreferrer\"><code>strsignal</code></a> to print the error message.</p>\n\n<p>As pointed out in @rht's comment, which references <a href=\"https://stackoverflow.com/questions/1101957/are-there-any-standard-exit-status-codes-in-linux\">this question</a>:</p>\n\n<blockquote>\n  <p>Passing tmp to <code>strsignal</code> generates the same error message: \"unknown signal 139\". The reason is that there is no signal with this signal number. /usr/include/bits/s\u200c\u200bignum.h contains all the signals with their signal numbers. Passing <code>tmp-128</code> to strsignal works.</p>\n</blockquote>\n\n<p>i.e.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string&gt;\n\nint main(void)\n{\n    int tmp = system(\"./vul $(perl -e 'print \\\"A\\\"x100)\");\n    if(tmp &lt; 0)\n       error(\"Couldn't run system command\");\n    else if(tmp &gt;0)\n       printf(stderr, \"System command returned error: %s\", strsignal(tmp - 128));\n    else\n       ; // nothing\n    return 0;\n}\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>The question was edited because it's code was mis-copied. I altered the answer to reflect that change.</p>\n"}, {"tags": [], "owner": {"reputation": 86, "user_id": 3641224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1203edee5dfcfaef3f57f440aebce342?s=128&d=identicon&r=PG&f=1", "display_name": "rht", "link": "https://stackoverflow.com/users/3641224/rht"}, "is_accepted": false, "score": 0, "last_activity_date": 1471414121, "creation_date": 1471414121, "answer_id": 38989203, "question_id": 38988779, "link": "https://stackoverflow.com/questions/38988779/no-error-message-when-using-system-to-execute-program-with-buffer-overflow-vul/38989203#38989203", "title": "No error message when using system() to execute program with buffer overflow vulnerability", "body": "<p>Answering my own 2<sup>nd</sup> question.</p>\n\n<p><code>gcc -Q -v vul.c</code> command displayed the options passed to the <code>gcc</code>. The options in <code>Ubuntu</code> included <code>-fstack-protector-strong</code> flag but not in <code>arch-linux</code>. So in <code>Ubuntu</code>, the flag is passed by default to <code>gcc</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 86, "user_id": 3641224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1203edee5dfcfaef3f57f440aebce342?s=128&d=identicon&r=PG&f=1", "display_name": "rht", "link": "https://stackoverflow.com/users/3641224/rht"}, "edited": false, "score": 0, "creation_date": 1471416723, "post_id": 38989731, "comment_id": 65331871, "body": "Thanks for pointing out missing single quote. I&#39;ll edit the question. And I am trying to get a segmentation fault error message. My question is why the second program is not printing any error messages."}], "tags": [], "owner": {"reputation": 3543, "user_id": 6329118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a20c0ed8a82fd967952e2539203af9?s=128&d=identicon&r=PG&f=1", "display_name": "CWLiu", "link": "https://stackoverflow.com/users/6329118/cwliu"}, "is_accepted": false, "score": 0, "last_activity_date": 1471416044, "creation_date": 1471416044, "answer_id": 38989731, "question_id": 38988779, "link": "https://stackoverflow.com/questions/38988779/no-error-message-when-using-system-to-execute-program-with-buffer-overflow-vul/38989731#38989731", "title": "No error message when using system() to execute program with buffer overflow vulnerability", "body": "<p>There exists two problems in your vul.c and exp.c.</p>\n\n<p>In vul.c,</p>\n\n<pre><code>char buf[10];\n</code></pre>\n\n<p>10 is not sufficient in this case, since the argv[1], i.e., $(perl -e 'print \"A\"x100', is larger than the buffer to be allocated. Enlarge the buf size should fix the segmentation fault.</p>\n\n<p>In exp.c, you're missing one single quote, and should be modified as followed:</p>\n\n<pre><code>printf(\"%d\\n\", system(\"./vul $(perl -e 'print \\\"A\\\"x100')\"));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86, "user_id": 3641224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1203edee5dfcfaef3f57f440aebce342?s=128&d=identicon&r=PG&f=1", "display_name": "rht", "link": "https://stackoverflow.com/users/3641224/rht"}, "is_accepted": false, "score": 1, "last_activity_date": 1471437131, "creation_date": 1471437131, "answer_id": 38996769, "question_id": 38988779, "link": "https://stackoverflow.com/questions/38988779/no-error-message-when-using-system-to-execute-program-with-buffer-overflow-vul/38996769#38996769", "title": "No error message when using system() to execute program with buffer overflow vulnerability", "body": "<p>From my comment to @Myst 's answer for \"passing <code>tmp-128</code> to strsignal()\" function, after experimenting a little I found that it does not work in situations where the program exited normally but returned status other than 0.</p>\n\n<p>Following are the contents of my <code>/usr/include/bits/waitstatus.h</code>:</p>\n\n<pre><code>/* If WIFEXITED(STATUS), the low-order 8 bits of the status.  */\n#define __WEXITSTATUS(status)   (((status) &amp; 0xff00) &gt;&gt; 8)\n\n/* If WIFSIGNALED(STATUS), the terminating signal.  */\n#define __WTERMSIG(status)      ((status) &amp; 0x7f)\n\n/* Nonzero if STATUS indicates normal termination.  */\n#define __WIFEXITED(status)     (__WTERMSIG(status) == 0)\n\n/* Nonzero if STATUS indicates termination by a signal.  */\n#define __WIFSIGNALED(status) \\\n  (((signed char) (((status) &amp; 0x7f) + 1) &gt;&gt; 1) &gt; 0)\n</code></pre>\n\n<p>Above code show that, exit status of a program is a 16bit number, the high order 8 bits of which are the status that the program returned and some/all of the remaining bits are set if the program exited because of a signal, 7 bits of which denote the signal that caused the program to exit. That's why subtracting 128 from the exit status returned by system() will not work in the situation as described above.</p>\n\n<p><a href=\"https://github.com/lattera/glibc/blob/master/sysdeps/posix/system.c\" rel=\"nofollow\">System()'s source code</a></p>\n\n<p>Since system() function too uses <code>fork()</code> to create a new process and waits for the termination of the process, the same method of checking a child process's status in parent process can also be applied here. Following program demonstrates this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    int status = system(\"prg_name\");\n    if (WIFEXITED(status))\n        printf(\"Exited Normally, status = %d\\n\", WEXITSTATUS(status));\n    else if (WIFSIGNALED(status))\n        printf(\"Killed by Signal %d which was %s\\n\", WTERMSIG(status), strsignal(WTERMSIG(status)));\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 86, "user_id": 3641224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1203edee5dfcfaef3f57f440aebce342?s=128&d=identicon&r=PG&f=1", "display_name": "rht", "link": "https://stackoverflow.com/users/3641224/rht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 38988980, "answer_count": 4, "score": 0, "last_activity_date": 1471437131, "creation_date": 1471412019, "last_edit_date": 1471416784, "question_id": 38988779, "link": "https://stackoverflow.com/questions/38988779/no-error-message-when-using-system-to-execute-program-with-buffer-overflow-vul", "title": "No error message when using system() to execute program with buffer overflow vulnerability", "body": "<p>Consider the following program (<code>vul.c</code>) with buffer overflow vulnerability.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char **argv)\n{\n    char buf[10];\n    strcpy(buf, argv[1]);\n    printf(\"%s\\n\", buf);\n    return 0;\n}\n</code></pre>\n\n<p>Above program compiled using <code>gcc -o vul vul.c</code> and executed on <code>arch linux - linux 4.4.16-1-lts x86-64</code> gave following output when executed in terminal with <code>./vul $(perl -e 'print \"A\"x100')</code> command:</p>\n\n<pre><code>AAAAAAAAAAA...A\nSegmentation fault (core dumped)\n</code></pre>\n\n<p>Then checking the program status using <code>echo $?</code> command gave <code>139</code> output.</p>\n\n<p>Following program (<code>exp.c</code>) (for crashing the above program)</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    printf(\"%d\\n\", system(\"./vul $(perl -e 'print \\\"A\\\"x100')\"));\n    return 0;\n}\n</code></pre>\n\n<p>compiled using <code>gcc -o exp exp.c</code> when executed with <code>./exp</code> command on same system gave following output:</p>\n\n<pre><code>AAAAAAAAAAAA...A\n139\n</code></pre>\n\n<p>I have two questions:</p>\n\n<ol>\n<li>Why no error message was generated by 2<sup>nd</sup> program? and,</li>\n<li>I need to compile the program with <code>-fstack-protector</code> flag to enable the <code>*** stack smashing detected ***</code> error messages in <code>arch linux</code> but not in <code>Ubuntu</code>. In <code>Ubuntu</code>, it might be that this flag is include by default in <code>gcc</code> or is there any other reason?</li>\n</ol>\n"}, {"tags": ["c", "multithreading", "atomic"], "comments": [{"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 1, "creation_date": 1471412212, "post_id": 38988737, "comment_id": 65329855, "body": "I voted to close the question because it&#39;s too broad. I believe you should focus your question and tell us what you tried so far. On a personal note, I would probably raise a &quot;stop&quot; flag and join all the threads. This doesn&#39;t promise shutdown, since existing tasks might run forever (they might call themselves)... so I would also make the flag public and check it within self-renewing tasks... I did something similar in a thread pool I wrote for a server."}, {"owner": {"reputation": 1434, "user_id": 309807, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec0f357306832b4876b529e629c4fdec?s=128&d=identicon&r=PG", "display_name": "iam", "link": "https://stackoverflow.com/users/309807/iam"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471412881, "post_id": 38988737, "comment_id": 65330088, "body": "Sorry I think it&#39;s quite specific.  Raising a stop flag doesn&#39;t work nor does a simple atomic count of currently active workers due to no guarantees of when visibility happens between threads.  Tasks causing infinite loops by submitting themselves would be an error in the design of the tasks not the pool itself."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471413314, "post_id": 38988737, "comment_id": 65330260, "body": "Having a specific question doesn&#39;t mean it isn&#39;t too broad. The &quot;too broad&quot; refers to possible answers, side you are asking for &quot;how to...&quot; you might get a lot of opinions about what works. There isn;t a &quot;correct&quot; answer."}, {"owner": {"reputation": 1434, "user_id": 309807, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec0f357306832b4876b529e629c4fdec?s=128&d=identicon&r=PG", "display_name": "iam", "link": "https://stackoverflow.com/users/309807/iam"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471413380, "post_id": 38988737, "comment_id": 65330288, "body": "I&#39;ve edited in some more clarifications and a simplification if that helps?"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471413791, "post_id": 38988737, "comment_id": 65330441, "body": "I read the update and a flag is still your best bet. Every thread should make sure all personal and global queues are empty before returning. If you&#39;re just decreasing a non-bool counter flag, then the higher value threads (the ones leaving the thread pool) don&#39;t need to check the global pool unless the flag is <code>0</code> (the thread pool being closed). I don&#39;t see why this wouldn&#39;t work."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1471414020, "post_id": 38988737, "comment_id": 65330527, "body": "You may want to try this question on <a href=\"http://programmers.stackexchange.com/\"><b>Programmer&#39;s StackExchange</b></a> which in general caters to broader opinion based code design questions."}, {"owner": {"reputation": 1434, "user_id": 309807, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec0f357306832b4876b529e629c4fdec?s=128&d=identicon&r=PG", "display_name": "iam", "link": "https://stackoverflow.com/users/309807/iam"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471414475, "post_id": 38988737, "comment_id": 65330749, "body": "@Myst It won&#39;t work like that because even though a worker may think there is no more work because its local and the global queue are empty, another worker may have generated new work that overspills its local work queue and needs to be added to the global work queue - in which case that first worker should stand a chance to be picking that new work up."}, {"owner": {"reputation": 1434, "user_id": 309807, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec0f357306832b4876b529e629c4fdec?s=128&d=identicon&r=PG", "display_name": "iam", "link": "https://stackoverflow.com/users/309807/iam"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1471414531, "post_id": 38988737, "comment_id": 65330776, "body": "@DavidC.Rankin Thanks I didn&#39;t realise there was a different site for that kind of thing but I am not sure where this question belongs in that regard or how to move it if so."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471414615, "post_id": 38988737, "comment_id": 65330814, "body": "@iam , Yap, that&#39;s true. The threads will not shutdown together unless you sync their shutdown process (probably using an array of &quot;waiting to finish&quot; flags, which I don&#39;t recommend)... But I don&#39;t see the problem. All tasks will be handled. Any spill-overs made by the last thread will eventually get handled by the last thread."}, {"owner": {"reputation": 1434, "user_id": 309807, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec0f357306832b4876b529e629c4fdec?s=128&d=identicon&r=PG", "display_name": "iam", "link": "https://stackoverflow.com/users/309807/iam"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471414814, "post_id": 38988737, "comment_id": 65330895, "body": "@Myst If you think about the case of major work imbalance, where one of the workers generates a large amount of child tasks that should be ideally spread across all workers via the global work queue.  Then you really don&#39;t want any of the other workers to have prematurely exited."}, {"owner": {"reputation": 1434, "user_id": 309807, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec0f357306832b4876b529e629c4fdec?s=128&d=identicon&r=PG", "display_name": "iam", "link": "https://stackoverflow.com/users/309807/iam"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471415218, "post_id": 38988737, "comment_id": 65331089, "body": "@Myst I am not sure if there is maybe some heavyweight but reliable solution using an array of flags/data with a mutex/lock per flag that has to do with each worker being in some sort of stage of promising not to generate new work until a stage of communication between all of them have finished?"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471415566, "post_id": 38988737, "comment_id": 65331261, "body": "@iam - I&#39;m not sure that&#39;s true. We are referring to the last stages of program exit. The difference in performance for the extra workload (multi-threaded vs. a worst case single threaded) probably won&#39;t justify having the other threads poll at a completion flag. But, again, if you want to use two flags instead of one, that&#39;s fine. As to existing solutions, I don&#39;t know of any, but a semaphore might work to count promises (when promises == number of threads, we&#39;re done)..."}, {"owner": {"reputation": 1434, "user_id": 309807, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec0f357306832b4876b529e629c4fdec?s=128&d=identicon&r=PG", "display_name": "iam", "link": "https://stackoverflow.com/users/309807/iam"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471415913, "post_id": 38988737, "comment_id": 65331426, "body": "@Myst Well it&#39;s possible that due to work inbalance a work item may well spawn more work then any that preceded it across all the works previously - so in which case the assumption that things are exiting isn&#39;t really true.  I&#39;m trying to decipher one of the original papers on work stealing queues but it&#39;s hard going unfortunately for me.  Also implementations I have actually found online all have bugs to do with this."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471416489, "post_id": 38988737, "comment_id": 65331737, "body": "@iam , Good luck! I still found that this isn&#39;t worth the extra effort (single threaded execution vs. multi-threaded for the last task cycle), and if that&#39;s the only issue with my <a href=\"https://github.com/boazsegev/c-server-tools/blob/master/src/libasync.c\" rel=\"nofollow noreferrer\">thread pool</a>, I&#39;m probably lucky ;-)"}, {"owner": {"reputation": 6198, "user_id": 839601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6db99aa846a8217f7e2aba6fa198e7c?s=128&d=identicon&r=PG", "display_name": "gnat", "link": "https://stackoverflow.com/users/839601/gnat"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1471418672, "post_id": 38988737, "comment_id": 65332935, "body": "@DavidC.Rankin when referring other sites, it is often helpful to point that <a href=\"http://meta.stackexchange.com/tags/cross-posting/info\">cross-posting is frowned upon</a>"}, {"owner": {"reputation": 26764, "user_id": 144746, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=128&d=identicon&r=PG", "display_name": "Voo", "link": "https://stackoverflow.com/users/144746/voo"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471426166, "post_id": 38988737, "comment_id": 65337501, "body": "@myst doing 99% of the work single threaded under some circumstances doesn&#39;t seem like a &quot;minor issue&quot; - at least for production code to me."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1471426810, "post_id": 38988737, "comment_id": 65337905, "body": "@iam <i>If you think about the case of major work imbalance, where one of the workers generates a large amount of child tasks that should be ideally spread across all workers via the global work queue. Then you really don&#39;t want any of the other workers to have prematurely exited.</i>  Then <b>don&#39;t</b> have the workers exit - have them block on the global queue (assuming that each worker&#39;s local queue can only be populated by the owning worker)."}, {"owner": {"reputation": 1434, "user_id": 309807, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec0f357306832b4876b529e629c4fdec?s=128&d=identicon&r=PG", "display_name": "iam", "link": "https://stackoverflow.com/users/309807/iam"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1471428628, "post_id": 38988737, "comment_id": 65339159, "body": "@AndrewHenle Regards &quot;have them block on the global queue&quot; I am not sure how you intend that to work? Thanks."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1471429350, "post_id": 38988737, "comment_id": 65339694, "body": "@iam You haven&#39;t implemented your work queues such that a worker thread can block in a call to get a unit of work from the queue until there&#39;s actually work in the queue?  <a href=\"https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/BlockingQueue.html\" rel=\"nofollow noreferrer\">Here&#39;s a Java example</a>  Note that it&#39;s implemented in the very basic <code>java.util...</code> class - it&#39;s a fundamental part of the Java specification."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 26764, "user_id": 144746, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=128&d=identicon&r=PG", "display_name": "Voo", "link": "https://stackoverflow.com/users/144746/voo"}, "edited": false, "score": 0, "creation_date": 1471431915, "post_id": 38988737, "comment_id": 65341392, "body": "@Voo , we are talking only about the last cycle of work. If 99% of the work is performed in the last cycle, there&#39;s a whole different issue at stake."}, {"owner": {"reputation": 26764, "user_id": 144746, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=128&d=identicon&r=PG", "display_name": "Voo", "link": "https://stackoverflow.com/users/144746/voo"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471435722, "post_id": 38988737, "comment_id": 65343994, "body": "@Myst Not really. It can happen that all but one thread are finished with all their work while one thread is still working. If you don&#39;t take care all threads finish and only <i>then</i> the last thread generates lots of new data. The whole idea of work stealing is to handle unbalanced workloads, so there&#39;s a reasonable assumption that this case is reasonably handled - at least I would have it. Cilk also doesn&#39;t have this problem, so I&#39;d check out Leiserson&#39;s cilk-5 paper for inspiration (I can look for the paper at home later if need be)."}, {"owner": {"reputation": 1434, "user_id": 309807, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec0f357306832b4876b529e629c4fdec?s=128&d=identicon&r=PG", "display_name": "iam", "link": "https://stackoverflow.com/users/309807/iam"}, "reply_to_user": {"reputation": 26764, "user_id": 144746, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=128&d=identicon&r=PG", "display_name": "Voo", "link": "https://stackoverflow.com/users/144746/voo"}, "edited": false, "score": 0, "creation_date": 1471436228, "post_id": 38988737, "comment_id": 65344342, "body": "@Voo Finally someone who understands the issue more :-)  I didn&#39;t know about clik - I shall have a read thank you."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 26764, "user_id": 144746, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=128&d=identicon&r=PG", "display_name": "Voo", "link": "https://stackoverflow.com/users/144746/voo"}, "edited": false, "score": 0, "creation_date": 1471441682, "post_id": 38988737, "comment_id": 65348619, "body": "@Voo , I understand the possibility but not the context. All threads wait for tasks before the &quot;stop&quot; flag is set. All normal tasks are scheduled before the &quot;stop&quot; flag is set. Before setting the &quot;stop&quot; flag, all high cost schedulers are notified (i.e., incoming IO channels are closed) and clean up tasks are scheduled. Now the &quot;stop&quot; flag is set and we have the tail of the workload and cleanup to contend with. If there are heavy task schedulers still active, it&#39;s a design flaw in the signaling stage. If 99% of the work is now starting it&#39;s a design flaw. Flags are still the answer."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 6198, "user_id": 839601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6db99aa846a8217f7e2aba6fa198e7c?s=128&d=identicon&r=PG", "display_name": "gnat", "link": "https://stackoverflow.com/users/839601/gnat"}, "edited": false, "score": 0, "creation_date": 1471454158, "post_id": 38988737, "comment_id": 65356931, "body": "@gnat - my bad, I should have mentioned a request for migration, etc.. Will do next time."}, {"owner": {"reputation": 26764, "user_id": 144746, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=128&d=identicon&r=PG", "display_name": "Voo", "link": "https://stackoverflow.com/users/144746/voo"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1471503593, "post_id": 38988737, "comment_id": 65374758, "body": "@myst I&#39;m talking about a standard work stealing implementation, so you don&#39;t have anything explicit as &quot; high cost schedulers&quot;. You have tasks that execute, add new work to queues and ask for more work when they finished their current work. I don&#39;t want to know how they&#39;re producing more work. The problem is easy with heavy handed locking but it&#39;s interesting on how to do it efficiently."}], "answers": [{"comments": [{"owner": {"reputation": 1434, "user_id": 309807, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec0f357306832b4876b529e629c4fdec?s=128&d=identicon&r=PG", "display_name": "iam", "link": "https://stackoverflow.com/users/309807/iam"}, "edited": false, "score": 0, "creation_date": 1471413658, "post_id": 38988860, "comment_id": 65330390, "body": "I&#39;m not sure why saving the state of pending tasks are an issue - they are either in global or local work queues or in registers in flight within the worker threads.  There is no overall pool management thread either right now - just a pool of identical worker threads.  The trouble is the fact workers can generate new tasks from the tasks they are running, that can spill out to the global queue, which causes problematic edge cases where workers think other ones may have finished using simple flags or a counter but in fact there is still work left."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 1434, "user_id": 309807, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec0f357306832b4876b529e629c4fdec?s=128&d=identicon&r=PG", "display_name": "iam", "link": "https://stackoverflow.com/users/309807/iam"}, "edited": false, "score": 0, "creation_date": 1471426600, "post_id": 38988860, "comment_id": 65337773, "body": "@iam There&#39;s either work in the queue(s), or there isn&#39;t.  Why should workers care about what other workers are doing?  It seems like you have a way too-complex system that&#39;s out of control."}, {"owner": {"reputation": 1210, "user_id": 5862726, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dyBzTE1yNyc/AAAAAAAAAAI/AAAAAAAAAUs/xIiSMA7_Gko/photo.jpg?sz=128", "display_name": "Todd Knarr", "link": "https://stackoverflow.com/users/5862726/todd-knarr"}, "reply_to_user": {"reputation": 1434, "user_id": 309807, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec0f357306832b4876b529e629c4fdec?s=128&d=identicon&r=PG", "display_name": "iam", "link": "https://stackoverflow.com/users/309807/iam"}, "edited": false, "score": 0, "creation_date": 1471461604, "post_id": 38988860, "comment_id": 65360930, "body": "@iam Exactly. Persistent storage is needed because either you stop threads from generating work (which means they may need to stop mid-task) or you stop them from getting new work (which means unstarted tasks in the queue). You need a management thread because something needs to wait for work threads to stop, restart them if they end early and keep track of whether they&#39;ve all shut down correctly and when the pool is safely and completely shut down."}], "tags": [], "owner": {"reputation": 1210, "user_id": 5862726, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dyBzTE1yNyc/AAAAAAAAAAI/AAAAAAAAAUs/xIiSMA7_Gko/photo.jpg?sz=128", "display_name": "Todd Knarr", "link": "https://stackoverflow.com/users/5862726/todd-knarr"}, "is_accepted": false, "score": -1, "last_activity_date": 1471412465, "creation_date": 1471412465, "answer_id": 38988860, "question_id": 38988737, "link": "https://stackoverflow.com/questions/38988737/correctly-shutting-down-a-work-stealing-thread-pool/38988860#38988860", "title": "Correctly shutting down a work stealing thread pool", "body": "<p>The biggest requirement would be to have some way of saving the definition of each task so the state of pending tasks can be saved to persistent storage. Then implement a \"stop\" flag (with a mutex on it). The method to get a task from the pool for execution checks that flag and, if it's set, returns a \"terminate work thread\" indication (distinct from a \"no tasks available\" result that makes the thread wait and try again). Threads terminate when they get that indication, and the overall pool management thread waits until all work threads have terminated and then terminates the pool. The main program has to wait until the pool is terminated and the pool management thread exits, once that happens it's safe to terminate the program. If the program needs to continue to run and restart the pool later, that's also the condition that must be met before it can do anything that would affect the pool configuration or restart the pool.</p>\n"}], "owner": {"reputation": 1434, "user_id": 309807, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec0f357306832b4876b529e629c4fdec?s=128&d=identicon&r=PG", "display_name": "iam", "link": "https://stackoverflow.com/users/309807/iam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 338, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1471415677, "creation_date": 1471411839, "last_edit_date": 1471415677, "question_id": 38988737, "link": "https://stackoverflow.com/questions/38988737/correctly-shutting-down-a-work-stealing-thread-pool", "title": "Correctly shutting down a work stealing thread pool", "body": "<p>Given a work stealing thread pool system where each work item can generate new tasks in a threads local work queue - that can spill out to a global queue if full.</p>\n\n<p>How would you safely and efficiently coordinate the shutdown of such a system?  Assuming you have basic atomic operations and critical section locks available only.</p>\n\n<p>To clarify some more and simplify.  Say each thread grabs tasks from it's local work queue only (no stealing between other threads queues to simplify).  If it's local work queue is exhausted it will take a lock on the global work queue and steal work to add to its local work queue.  The local work queues require no locks as they are specific to each worker thread.</p>\n\n<p>Using a simple flag or atomic count of 'active' worker threads won't work due to cases where other workers may spill new work onto the global queue where from another worker threads view it may have thought it was the only worker left with work.</p>\n\n<p>All workers should exit only when there is no work left.</p>\n"}, {"tags": ["c", "linux-kernel", "glibc", "gettimeofday", "vdso"], "comments": [{"owner": {"reputation": 112081, "user_id": 2231815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1597c347e309f696ff1738128444702b?s=128&d=identicon&r=PG", "display_name": "rakib_", "link": "https://stackoverflow.com/users/2231815/rakib"}, "edited": false, "score": 0, "creation_date": 1471412834, "post_id": 38987922, "comment_id": 65330062, "body": "Vdso support for 32-bit kernel was added later. Make sure you have checked the kernel versions."}, {"owner": {"reputation": 41, "user_id": 3465381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f770f79815a97fd48d21ab8fb9b27644?s=128&d=identicon&r=PG&f=1", "display_name": "user3465381", "link": "https://stackoverflow.com/users/3465381/user3465381"}, "reply_to_user": {"reputation": 112081, "user_id": 2231815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1597c347e309f696ff1738128444702b?s=128&d=identicon&r=PG", "display_name": "rakib_", "link": "https://stackoverflow.com/users/2231815/rakib"}, "edited": false, "score": 0, "creation_date": 1471425376, "post_id": 38987922, "comment_id": 65336979, "body": "@rakib My kernel is 64 bit, its the <b>application that is 32 bit</b>. As I mentioned in the question on the same kernel, application compiled for 64bit seems to have vdso support."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 3465381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f770f79815a97fd48d21ab8fb9b27644?s=128&d=identicon&r=PG&f=1", "display_name": "user3465381", "link": "https://stackoverflow.com/users/3465381/user3465381"}, "edited": false, "score": 0, "creation_date": 1471503494, "post_id": 39011465, "comment_id": 65374700, "body": "My kernel is 3.4.91. can you explain what this vdso32 what you have shown here.?"}, {"owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "reply_to_user": {"reputation": 41, "user_id": 3465381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f770f79815a97fd48d21ab8fb9b27644?s=128&d=identicon&r=PG&f=1", "display_name": "user3465381", "link": "https://stackoverflow.com/users/3465381/user3465381"}, "edited": false, "score": 0, "creation_date": 1471534034, "post_id": 39011465, "comment_id": 65394641, "body": "I extracted vdso32 from a running process using <a href=\"http://www.trilithium.com/johan/2005/08/linux-gate/\" rel=\"nofollow noreferrer\">trilithium.com/johan/2005/08/linux-gate</a>"}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 0, "last_activity_date": 1471502431, "creation_date": 1471502431, "answer_id": 39011465, "question_id": 38987922, "link": "https://stackoverflow.com/questions/38987922/vdso-gettimeofday-with-64-bit-kernel-application-compiled-for-32-bit/39011465#39011465", "title": "vdso gettimeofday with 64 bit kernel &amp; application compiled for 32 bit", "body": "<p>On my 64-bit Linux 4.4.15, the 32-bit vdso has these symbols:</p>\n\n<pre><code>readelf -Ws vdso32\n\nSymbol table '.dynsym' contains 9 entries:\n   Num:    Value  Size Type    Bind   Vis      Ndx Name\n     0: 00000000     0 NOTYPE  LOCAL  DEFAULT  UND\n     1: 00000ce0     9 FUNC    GLOBAL DEFAULT   12 __kernel_sigreturn@@LINUX_2.5\n     2: 00000d00    13 FUNC    GLOBAL DEFAULT   12 __kernel_vsyscall@@LINUX_2.5\n     3: 00000ad0   438 FUNC    GLOBAL DEFAULT   12 __vdso_gettimeofday@@LINUX_2.6\n     4: 00000c90    42 FUNC    GLOBAL DEFAULT   12 __vdso_time@@LINUX_2.6\n     5: 00000770   853 FUNC    GLOBAL DEFAULT   12 __vdso_clock_gettime@@LINUX_2.6\n     6: 00000cf0     8 FUNC    GLOBAL DEFAULT   12 __kernel_rt_sigreturn@@LINUX_2.5\n     7: 00000000     0 OBJECT  GLOBAL DEFAULT  ABS LINUX_2.5\n     8: 00000000     0 OBJECT  GLOBAL DEFAULT  ABS LINUX_2.6\n</code></pre>\n\n<p>This suggests that the <code>__vdso_gettimeofday</code> you are looking for has been added in kernel 2.6, and that your kernel version is older.</p>\n"}], "owner": {"reputation": 41, "user_id": 3465381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f770f79815a97fd48d21ab8fb9b27644?s=128&d=identicon&r=PG&f=1", "display_name": "user3465381", "link": "https://stackoverflow.com/users/3465381/user3465381"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 600, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1471502431, "creation_date": 1471406577, "question_id": 38987922, "link": "https://stackoverflow.com/questions/38987922/vdso-gettimeofday-with-64-bit-kernel-application-compiled-for-32-bit", "title": "vdso gettimeofday with 64 bit kernel &amp; application compiled for 32 bit", "body": "<p>is vdso supported for a 32 bit application which is running on a 64 bit kernel with glibc version 2.15.? If yes, how do I make it work for 32 bit application running on 64 bit kernel.? Cause even though dlopen on \"linux-vdso.so.1\" is success, dlsym on \"__vdso_gettimeofday\" fails.</p>\n\n<p>On the same system I able to do a dlopen on \"linux-vdso.so.1\" &amp; dlsym on \"__vdso_gettimeofday\" from a application compiled for 64 bit.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 12, "creation_date": 1471406544, "post_id": 38987902, "comment_id": 65328246, "body": "<code>scanf(&quot;%d&quot;, arr[i]);</code> --&gt; <code>scanf(&quot;%d&quot;, &amp;arr[i]);</code> or <code>scanf(&quot;%d&quot;, arr + i);</code>"}, {"owner": {"reputation": 984, "user_id": 6641516, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-b__FzxzSmgU/AAAAAAAAAAI/AAAAAAAABqE/zRhjNLBdLQE/photo.jpg?sz=128", "display_name": "Derick Alangi", "link": "https://stackoverflow.com/users/6641516/derick-alangi"}, "edited": false, "score": 0, "creation_date": 1471406752, "post_id": 38987902, "comment_id": 65328290, "body": "Also, try to make sure the proper header files are included in case you forgot."}, {"owner": {"reputation": 209, "user_id": 2519193, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/10cefc2bef0187a701a036e20f4b9320?s=128&d=identicon&r=PG", "display_name": "user2519193", "link": "https://stackoverflow.com/users/2519193/user2519193"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1471406797, "post_id": 38987902, "comment_id": 65328303, "body": "@BLUEPIXY Thank you, that seemed to work! However, why must I use the address pointer, when arr is already a pointer itself?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1471406866, "post_id": 38987902, "comment_id": 65328320, "body": "@user2519193 <code>arr[i]</code> isn&#39;t pointer."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1471407174, "post_id": 38987902, "comment_id": 65328393, "body": "<code>arr[i]</code> is the same as <code>*(arr+i)</code>,, in both cases the pointer is dereferenced. <code>scanf</code> needs a pointer as its 2nd argument."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1471408190, "post_id": 38987902, "comment_id": 65328610, "body": "@user2519193: Yes, <code>arr</code> is a pointer. But <code>arr[i]</code> is <i>not</i> a pointer. You are supplying <code>arr[i]</code> to <code>scanf</code>. And <code>scanf</code> wants a pointer."}], "answers": [{"tags": [], "owner": {"reputation": 1624, "user_id": 5889270, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/WP9Wo.png?s=128&g=1", "display_name": "asad_hussain", "link": "https://stackoverflow.com/users/5889270/asad-hussain"}, "is_accepted": true, "score": 3, "last_activity_date": 1471408711, "last_edit_date": 1471408711, "creation_date": 1471407183, "answer_id": 38988007, "question_id": 38987902, "link": "https://stackoverflow.com/questions/38987902/why-does-my-c-dynamic-array-give-me-access-violation/38988007#38988007", "title": "Why does my C dynamic array give me access violation?", "body": "<p>In order to store array elements you need to use <code>scanf(\"%d\", &amp;arr[i]);</code> instead of \n<code>scanf(\"%d\", arr[i]);</code></p>\n\n<p><code>&amp;</code> in <code>C</code> is used to refer to address of a variable. So,by using <code>&amp;arr[i]</code> you are telling your program to store the input variable at <code>ith</code> index of array  <code>arr[]</code>.</p>\n\n<p>So the correct code will be  </p>\n\n<pre><code>int *arr;\nint sizeOfArr = 0;\n\nprintf(\"Enter size of arr.\\n\");\nscanf(\"%d\", &amp;sizeOfArr);\n\narr = malloc(sizeOfArr * sizeof(int));\n\nfor (int i = 0; i &lt; sizeOfArr; i++) {\n\n    scanf(\"%d\", &amp;arr[i]); //notice the diff here\n\n}\n</code></pre>\n"}], "owner": {"reputation": 209, "user_id": 2519193, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/10cefc2bef0187a701a036e20f4b9320?s=128&d=identicon&r=PG", "display_name": "user2519193", "link": "https://stackoverflow.com/users/2519193/user2519193"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 38988007, "answer_count": 1, "score": 1, "last_activity_date": 1471409607, "creation_date": 1471406446, "last_edit_date": 1471409607, "question_id": 38987902, "link": "https://stackoverflow.com/questions/38987902/why-does-my-c-dynamic-array-give-me-access-violation", "title": "Why does my C dynamic array give me access violation?", "body": "<p>Here is the code I have.</p>\n\n<pre><code>int *arr;  // Indented this line\nint sizeOfArr = 0;\n\nprintf(\"Enter size of arr.\\n\");\nscanf(\"%d\", &amp;sizeOfArr);\n\narr = malloc(sizeOfArr * sizeof(int));\n\nfor (int i = 0; i &lt; sizeOfArr; i++) {\n\n    scanf(\"%d\", arr[i]);\n\n}\n</code></pre>\n\n<p>For example, if the size of the dynamic array is 5, and I proceed to enter the input \"1 2 3 4 5\", the entire program crashes and gives me access violation.</p>\n"}, {"tags": ["c", "windows", "debugging", "pdb", "debug-symbols"], "answers": [{"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": true, "score": 0, "last_activity_date": 1471410619, "creation_date": 1471410619, "answer_id": 38988521, "question_id": 38987688, "link": "https://stackoverflow.com/questions/38987688/scanning-for-call-instruction-without-a-disassembler/38988521#38988521", "title": "Scanning for &#39;call&#39; instruction without a disassembler?", "body": "<p>Unfortunately, there is not.</p>\n\n<p>The most common opcode for <code>callq</code> in x86_64 code is <code>e8</code>, but there's no way to distinguish an <code>e8</code> meaning <code>callq</code> from an <code>e8</code> in another context (e.g, as part of a constant) without fully disassembling the binary to figure out where each instruction starts. Remember that x86 uses variable-length instructions, so it's not always obvious where instructions start.</p>\n"}], "owner": {"reputation": 4685, "user_id": 1267466, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/S9Xba.jpg?s=128&g=1", "display_name": "vexe", "link": "https://stackoverflow.com/users/1267466/vexe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 38988521, "answer_count": 1, "score": 0, "last_activity_date": 1471410619, "creation_date": 1471404807, "last_edit_date": 1471410354, "question_id": 38987688, "link": "https://stackoverflow.com/questions/38987688/scanning-for-call-instruction-without-a-disassembler", "title": "Scanning for &#39;call&#39; instruction without a disassembler?", "body": "<p>I'm writing a debugger for my text editor in Windows X64. I implemented breakpoints and step-over/step-out. I'm stuck at step-in because I basically need to get the address of the instruction at the current line (which I get via the PDB file and DbgHelp) and the next line, see if there's a 'call' instruction between those addresses, if so we step-in else step-over.</p>\n\n<p>I was wondering if there was a way to get this information (without having to write or use a disassembler) via DbgHelp/PDB? or maybe take advantage of certain byte order of instructions maybe the 'call' is unique and there's only one way its bytes are ordered so I can read byte by byte and see if they match the 'call'? (that way I don't have to do full or even partial disasm)</p>\n\n<p>Ideas? Any help would be appreciated</p>\n"}, {"tags": ["c", "dereference"], "comments": [{"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 3, "creation_date": 1471404691, "post_id": 38987647, "comment_id": 65327858, "body": "I guess because you happened to hit memory that you have access to?"}], "answers": [{"comments": [{"owner": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "edited": false, "score": 0, "creation_date": 1471406939, "post_id": 38987923, "comment_id": 65328343, "body": "but why, like I said, I can always access to <code>0x00020080</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1471415546, "post_id": 38987923, "comment_id": 65331242, "body": "No, it is not undefined behavior at all. The code is perfectly fine as far as C is concerned. The C language mentions nothing about virtual vs physical memory addressing. That is something which is beyond the scope of a programming language standard."}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "reply_to_user": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "edited": false, "score": 0, "creation_date": 1471485704, "post_id": 38987923, "comment_id": 65369426, "body": "@Codino In whatever process you are running, your OS always maps something (code, data, stack, heap, etc.) to that address. What that is you don&#39;t know so you shouldn&#39;t change it.  There are ways to find out. Compilers usually have some switch to generate address maps of compiled code."}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1471485773, "post_id": 38987923, "comment_id": 65369442, "body": "@Lundin, ok, implementation defined."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1471501030, "post_id": 38987923, "comment_id": 65373571, "body": "@MarkTolonen Not that either. Undefined and impl.-defined behavior are C language terms, implying that this is something in scope of the C standard. But C simply does not specify how an ABI maps memory, because that&#39;s not related to the C language."}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1471537412, "post_id": 38987923, "comment_id": 65396766, "body": "@Lundin, I understand that, but I am not quoting the C language spec.  It may be legal C, but it is still a bad idea to write to unknown addresses and the results vary by OS and compiler implementation.  So while the C spec has a specific definition of &quot;implemention defined&quot;, it is still defined by <i>an</i> implementation :)  I took out the terms in my answer."}], "tags": [], "owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "is_accepted": false, "score": 2, "last_activity_date": 1471485849, "last_edit_date": 1471485849, "creation_date": 1471406581, "answer_id": 38987923, "question_id": 38987647, "link": "https://stackoverflow.com/questions/38987647/why-dereference-specific-address-in-visual-studio-sometime-not-lead-to-access-vi/38987923#38987923", "title": "Why dereference specific address in Visual Studio sometime not lead to access violation errors?", "body": "<p>Your process has a virtual memory space. Some addresses are mapped to physical memory and some are not.  It can appear to work if physical memory is mapped into that location, and it doesn't work if it is not. But if you don't know what is at that address, writing to it could very likely corrupt your program. </p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1471415509, "post_id": 38987996, "comment_id": 65331225, "body": "No, it is not undefined behavior at all. The code is perfectly fine as far as C is concerned. The C language mentions nothing about virtual vs physical memory addressing. That is something which is beyond the scope of a programming language standard."}], "tags": [], "owner": {"reputation": 4791, "user_id": 1609614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lvIBD.jpg?s=128&g=1", "display_name": "Ari0nhh", "link": "https://stackoverflow.com/users/1609614/ari0nhh"}, "is_accepted": false, "score": 0, "last_activity_date": 1471407864, "last_edit_date": 1471407864, "creation_date": 1471407076, "answer_id": 38987996, "question_id": 38987647, "link": "https://stackoverflow.com/questions/38987647/why-dereference-specific-address-in-visual-studio-sometime-not-lead-to-access-vi/38987996#38987996", "title": "Why dereference specific address in Visual Studio sometime not lead to access violation errors?", "body": "<p>Because you were lucky. Not only you managed to pick a virtual memory address that has some memory block attached to it, but you also happen upon a memory with a write access. Origin of this memory is largely depending on your application. It could be a process or private heap block, <code>.data</code> section of executable/dll, memory mapped file, or anything else. Successful writing for that memory address could also have some sort of \"persistence\", because on your machine your OS always loading some module/allocating some heap memory at the same address. It will most likely be broken on some other system with different OS version or memory configuration. </p>\n\n<p>Also it is worth pointing out, that writing random memory address is an undefined behavior, so technically anything could happen and it is pointless to expect some behavior patterns from it. </p>\n"}, {"comments": [{"owner": {"reputation": 457342, "user_id": 87234, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FkjBe.png?s=128&g=1", "display_name": "GManNickG", "link": "https://stackoverflow.com/users/87234/gmannickg"}, "reply_to_user": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "edited": false, "score": 0, "creation_date": 1471414411, "post_id": 38988041, "comment_id": 65330718, "body": "@Codino: Undefined behavior means anything can happen, including appearing to work until the day you ship. Your program&#39;s memory layout is probably deterministic enough to make this not crash, for now. There&#39;s really nothing more to wonder, this answer covers it all. Your address happens to work. It probably won&#39;t always work. Don&#39;t do this."}, {"owner": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "edited": false, "score": 0, "creation_date": 1471416888, "post_id": 38988041, "comment_id": 65331969, "body": "I don&#39;t think it is Undefined Behavior. Cannot find out a document mention this case is UB."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "edited": false, "score": 0, "creation_date": 1471447403, "post_id": 38988041, "comment_id": 65352974, "body": "@Codino: I don&#39;t see how your update changes anything."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 1, "last_activity_date": 1471408030, "last_edit_date": 1471408030, "creation_date": 1471407391, "answer_id": 38988041, "question_id": 38987647, "link": "https://stackoverflow.com/questions/38987647/why-dereference-specific-address-in-visual-studio-sometime-not-lead-to-access-vi/38988041#38988041", "title": "Why dereference specific address in Visual Studio sometime not lead to access violation errors?", "body": "<p>\"Access violation error\" is what happens when you access a spot in process virtual address space that has not been \"allocated\" yet from the OS's point of view. The OS and the underlying hardware knows that this area in address space is free/empty and therefore illegal to access. OS-level and hardware-level memory protection mechanisms will immediately trigger the error if you attempt to access such points in the virtual address space.</p>\n\n<p>If some region of address space has already been requested from the OS (\"allocated\"), the OS effectively hands all control over that region to the process and relieves itself from any responsibilities for that region. That memory belongs to the process. The process can do anything with that region of address space - it will not trigger any OS-level memory protection mechanisms.</p>\n\n<p>In your case the address <code>0x00020080</code> just accidentally happened to fall into some already allocated region of address space owned by your process, which is why you can access it successfully. Meanwhile, <code>0x00030080</code> falls into an unallocated region, protected by OS.</p>\n\n<p>P.S. The OS typically offers slightly finer control over what you can do with virtual memory region. A region might be already allocated, yet labeled as \"read-only\". In this case OS-level memory protection mechanisms will allow read-access to that region, but prevent write-access. In your case there's a possibility of <code>0x00030080</code> falling into an already allocated read-only region. In that case it is your attempt to <em>write</em> into it that triggers the error.</p>\n"}], "owner": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1471485849, "creation_date": 1471404524, "last_edit_date": 1471414137, "question_id": 38987647, "link": "https://stackoverflow.com/questions/38987647/why-dereference-specific-address-in-visual-studio-sometime-not-lead-to-access-vi", "title": "Why dereference specific address in Visual Studio sometime not lead to access violation errors?", "body": "<pre><code>int* p =(int*) 0x00030080;\n*p = 255;\n</code></pre>\n\n<p>leads to <em>access violation error</em>.</p>\n\n<p>But this</p>\n\n<pre><code>int* p =(int*) 0x00020080;\n*p = 255;\n</code></pre>\n\n<p>does not.</p>\n\n<p>I understand that they are all virtual memories in RAM so I think maybe I can have right to access <code>0x00020080</code> at this time but it maybe not another time (another executions in my PC or in other PCs). </p>\n\n<p>But the result is that I can always access to <code>0x00020080</code>.</p>\n\n<p>Could you tell me the reason or at least an exist answer in Stackoverflow (which I still not find out) ?</p>\n\n<p>I'm using Visual Studio 2010.</p>\n\n<p><strong>Edit</strong>: Because some of you said it was just a lucky, I have sent this piece of code for all my team (more than 20 computers) and all of them can access to <code>0x00020080</code> without error. So is this lucky or <code>0x00020080</code> is one (of some) fixed memory addresses that we can access through Visual Studio ?</p>\n"}, {"tags": ["c", "pipe"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1471403507, "post_id": 38987499, "comment_id": 65327581, "body": "Are there any reason you or your friend want to use non-standard syntax of function definition?"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1471403596, "post_id": 38987499, "comment_id": 65327600, "body": "The reason may be <code>-Werror</code> option or something. Would you mind disclosing the command line option?"}, {"owner": {"reputation": 585, "user_id": 4617334, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/GwUnw.jpg?s=128&g=1", "display_name": "Madhusoodan P", "link": "https://stackoverflow.com/users/4617334/madhusoodan-p"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1471403601, "post_id": 38987499, "comment_id": 65327603, "body": "@MikeCAT I have no reason but by default the return type is int so we wrote that. But I want to know what is the error, Not intrested in compilation"}, {"owner": {"reputation": 585, "user_id": 4617334, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/GwUnw.jpg?s=128&g=1", "display_name": "Madhusoodan P", "link": "https://stackoverflow.com/users/4617334/madhusoodan-p"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1471403684, "post_id": 38987499, "comment_id": 65327622, "body": "@MikeCAT sure edited"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1471404585, "post_id": 38987499, "comment_id": 65327832, "body": "&quot;is not getting compiled &quot; - you know this <i>how</i>? What is the reported error message from the failed compile attempt ? it belongs, verbatim, in your question."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1471409845, "post_id": 38987499, "comment_id": 65329048, "body": "Note that the style of defining <code>main()</code> without an explicit return type of <code>int</code> was made obsolete (invalid) by the C99 standard.  You should not be coding to the archaic C89/C90 standard which did allow the notation without an explicit return type.  You should be adhering to C11, using <code>gcc -Wall -Wextra -Werror -std=c11</code> (or substituting <code>-std=gnu11</code> if you prefer).  And your code should compile cleanly under those options."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1471410055, "post_id": 38987935, "comment_id": 65329116, "body": "For a full discussion, see <a href=\"http://stackoverflow.com/questions/204476/\">What should <code>main()</code> return in C and C++?</a>"}], "tags": [], "owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "is_accepted": false, "score": 2, "last_activity_date": 1471406629, "creation_date": 1471406629, "answer_id": 38987935, "question_id": 38987499, "link": "https://stackoverflow.com/questions/38987499/this-pipe-program-is-not-compiling/38987935#38987935", "title": "This pipe program is not compiling", "body": "<p>The standard (ISO/IEC 9899-2011) says about <code>main</code>:</p>\n\n<blockquote>\n  <p>5.1.2.2.1 Program startup</p>\n  \n  <p>The function called at program startup is named main. The implementation\n  declares no\n  prototype for this function. It shall be defined with a return type of int and with no\n    parameters:</p>\n\n<pre><code>      int main(void) { /* ... */ }\n</code></pre>\n  \n  <p>or with two parameters (referred to here as argc and argv, though any names may be\n   used, as they are local to the function in which they are declared):</p>\n\n<pre><code>      int main(int argc, char *argv[]) { /* ... */ }\n</code></pre>\n  \n  <p>or equivalent;</p>\n</blockquote>\n\n<p>So that ends it all?<br>\nNo, not that easy. At the end of the quote is a small semicolon and what follows is this little, seemingly innocent part</p>\n\n<blockquote>\n  <p>or in some other implementation-defined manner.</p>\n</blockquote>\n\n<p>Than there is the difference between \"hosted\" (section 5.1.2.2 within an OS and its rules) and \"freestanding\" (in section 5.1.2.1. For example on a small PIC or similar, barely any rules at all and the rest is implementation defined)</p>\n\n<p>The syntax of a function definition is defined in section 6.9.1 where it reads in item 1</p>\n\n<blockquote>\n  <p>The identifier declared in a function definition (which is the name of the function) shall have a function type, as specified by the declarator portion of the function definition.</p>\n</blockquote>\n\n<p>Further detailed in item 2</p>\n\n<blockquote>\n  <p>The return type of a function shall be void or a complete object type other than array type.</p>\n</blockquote>\n\n<p>So any function definition (including <code>main</code>) must have a return type specified.</p>\n\n<p>But see the rules for the \"freestanding environment\" above or better, the lack of them.</p>\n"}], "owner": {"reputation": 585, "user_id": 4617334, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/GwUnw.jpg?s=128&g=1", "display_name": "Madhusoodan P", "link": "https://stackoverflow.com/users/4617334/madhusoodan-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471409948, "creation_date": 1471403449, "last_edit_date": 1471409948, "question_id": 38987499, "link": "https://stackoverflow.com/questions/38987499/this-pipe-program-is-not-compiling", "title": "This pipe program is not compiling", "body": "<p>I am learning OS course.\nWe were taught pipes and this program is not getting compiled in GCC 4.4.7. When we change <code>main</code> to <code>int main</code>, it compiles fine. What is the reason?</p>\n\n<p>Command line:   <code>gcc pipedemo.c</code></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;sys/types.h&gt;\n#include&lt;string.h&gt;\n#include&lt;unistd.h&gt;\n#include&lt;stdlib.h&gt;\n\n#define BUFFER_SIZE 100\n#define READ_END 0\n#define WRITE_END 1\n\nmain()\n{\n        char source[]=\"pipe_program\";\n        char dest[BUFFER_SIZE];\n        char datas[BUFFER_SIZE];\n        char datar[BUFFER_SIZE];\n        int fd1[2],fd2[2];\n        pid_t pid;\n        if(pipe(fd1)==-1)\n        {\n                fprintf(stderr,\"Pipe creation failed\\n\");\n                exit(0);\n        }\n\n       if(pipe(fd2)==-1)\n       {\n           //...\n       }\n       //...\n }\n</code></pre>\n"}, {"tags": ["java", "python", "c"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1471402131, "post_id": 38987327, "comment_id": 65327230, "body": "I don&#39;t think there is because type information cannot be retrieved from variable-length arguments in C."}, {"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 1, "creation_date": 1471402163, "post_id": 38987327, "comment_id": 65327239, "body": "<i>Is there an equivalent format attribute in C?</i> Yes. <i>Apart from the <code>%d</code> and <code>%s</code> things</i> I don&#39;t think so. You could (maybe) write such a feature with a preprocessing step."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1471403112, "post_id": 38987327, "comment_id": 65327486, "body": "I tried something that doesn&#39;t require explicit specifying the type of the variable <a href=\"http://codereview.stackexchange.com/q/115143/29485\">Formatted print without the need to specify type matching specifiers using _Generic</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5156323"}, "edited": false, "score": 0, "creation_date": 1471402729, "post_id": 38987383, "comment_id": 65327385, "body": "Thank you so much."}], "tags": [], "owner": {"reputation": 62518, "user_id": 469300, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f8256aabf1f8938bc2356b1fbeb227f4?s=128&d=identicon&r=PG", "display_name": "slezica", "link": "https://stackoverflow.com/users/469300/slezica"}, "is_accepted": false, "score": 2, "last_activity_date": 1471402579, "creation_date": 1471402579, "answer_id": 38987383, "question_id": 38987327, "link": "https://stackoverflow.com/questions/38987327/format-attribute-of-java-and-python-in-c/38987383#38987383", "title": "Format attribute of Java and Python in C", "body": "<p>It can't be done in C. Not cleanly, at least.</p>\n\n<p>Both Java and Python have <em>strong typing</em>. This means that objects have an intrinsic type that cannot change, and this type is known during the execution of the program. You can transform any object to a string appropriately, because their types are known and they implement the <code>toString()</code>/ <code>__str__()</code> method.</p>\n\n<p>C, in contrast, has <em>weak typing</em>. Types in C are more of an <em>interpretation</em> of the data at a memory address. You can cast anything to anything else. The <code>sprintf()</code> function has no way of knowing what's what.</p>\n\n<p>There are ways of building strings with a generic syntax in C++, if you're interested.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5156323"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1471402579, "creation_date": 1471402012, "last_edit_date": 1471402372, "question_id": 38987327, "link": "https://stackoverflow.com/questions/38987327/format-attribute-of-java-and-python-in-c", "title": "Format attribute of Java and Python in C", "body": "<p>In Python, we could use the format attribute this way: </p>\n\n<pre><code>\"Today is {}/{}/{}\".format(self.day, self.month, self.year) \n</code></pre>\n\n<p>In Java, we could do the same: </p>\n\n<pre><code>MessageFormat.format(\"Today is {0}/{1}/{2}\", this.day, this.month, this.year); \n</code></pre>\n\n<p>Is there an equivalent format attribute in C? Apart from the %d and %s things which are also present in Python along with the format attribute. The later has an advantage as it doesnt require specifying the type of the variable whether a number or a string or whatnot. </p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 4, "creation_date": 1471399926, "post_id": 38987079, "comment_id": 65326752, "body": "<code>if (i == s[0]</code> What is that supposed to do?"}, {"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 1, "creation_date": 1471399926, "post_id": 38987079, "comment_id": 65326753, "body": "What is <code>i == s[0]</code> supposed to test?"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1471399996, "post_id": 38987079, "comment_id": 65326767, "body": "What is <code>string</code> and <code>GetString()</code>?"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 2, "creation_date": 1471400031, "post_id": 38987079, "comment_id": 65326768, "body": "Why you are printing the index instead of the characters?"}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 0, "creation_date": 1471400798, "post_id": 38987079, "comment_id": 65326940, "body": "<code>i == s[0]</code> will never be true unless you really have  a very very long string or an empty string. <code>s[i-1]</code> is out of bound when <code>i == 0</code>."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6454402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/u8PIZ.jpg?s=128&g=1", "display_name": "cerealCode", "link": "https://stackoverflow.com/users/6454402/cerealcode"}, "edited": false, "score": 0, "creation_date": 1471401381, "post_id": 38987177, "comment_id": 65327052, "body": "Thanks for a fast quite a through answer, I will need some time and a lot of googling to fully understand what&#39;s going on :)"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "reply_to_user": {"reputation": 25, "user_id": 6454402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/u8PIZ.jpg?s=128&g=1", "display_name": "cerealCode", "link": "https://stackoverflow.com/users/6454402/cerealcode"}, "edited": false, "score": 0, "creation_date": 1471401499, "post_id": 38987177, "comment_id": 65327089, "body": "Hint for googling: <i>ternary operator</i> is used in <code>(i == 0 ? last_character : s[i-1])</code>"}, {"owner": {"reputation": 25, "user_id": 6454402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/u8PIZ.jpg?s=128&g=1", "display_name": "cerealCode", "link": "https://stackoverflow.com/users/6454402/cerealcode"}, "edited": false, "score": 0, "creation_date": 1471464045, "post_id": 38987177, "comment_id": 65362231, "body": "Thanks for the hint, actually ternary operators might be one of the things I get, I come from Ruby :)"}], "tags": [], "owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "is_accepted": false, "score": 0, "last_activity_date": 1471400747, "creation_date": 1471400747, "answer_id": 38987177, "question_id": 38987079, "link": "https://stackoverflow.com/questions/38987079/return-first-letter-of-each-word-capitalized/38987177#38987177", "title": "Return first letter of each word capitalized", "body": "<ul>\n<li><code>string</code> and <code>GetString</code> is used, but you didn't define them or you didn't disclose the command line or environment where they are defined.</li>\n<li>The condition <code>i == s[0]</code> is nonsense because it compares the index with the character code of the first character. It also may lead to invoking <em>undefined behavior</em> for out-of-range access of <code>s[-1]</code>.</li>\n<li>The printing statement <code>printf(\"%c\",i);</code> is wrong because it prints the index instead of the character.</li>\n</ul>\n\n<p>Try this code, which deals with the first line of the input:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main(void)\n{\n    char s[1024];\n    char last_character = ' '; /* to deal with word lying on multiple chunks */\n\n    /* repeat for the case where the line to deal with is too long to fit in one chunk */\n    while (fgets(s, sizeof(s), stdin) != NULL) {\n        int i;\n        /* calling strlen() in every loop is not effective */\n        for (i = 0; s[i] != '\\0'; i++){\n            /* check if currently looking at the first charater of each words */\n            if(isalpha((unsigned char)s[i]) &amp;&amp; (i == 0 ? last_character : s[i-1]) == ' '){\n                /* cast to unsigned char to avoid undefined behavior invoked by passing out-of-range value */\n                printf(\"%c\", toupper((unsigned char)s[i]));\n                /* incrementing i here may cause skipping the terminating null-character for the new loop condition, so remove it */\n            }\n        }\n        if (i &gt; 0) {\n            /* save the last character in this chunk */\n            last_character = s[i - 1];\n            /* deal with only the first line */\n            if (last_character == '\\n') break;\n        }\n    }\n    putchar('\\n');\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 0, "last_activity_date": 1471403719, "creation_date": 1471403719, "answer_id": 38987535, "question_id": 38987079, "link": "https://stackoverflow.com/questions/38987079/return-first-letter-of-each-word-capitalized/38987535#38987535", "title": "Return first letter of each word capitalized", "body": "<pre><code>string func(string s){\n//take a string, and return the first letter of each word capitalized.\n    char pre = ' ', curr;\n    int new_i = 0;\n\n    for(int org_i = 0; curr = s[org_i]; ++org_i){\n        if(isspace(curr))\n            pre = ' ';\n        else if(pre == ' ')\n            s[new_i++] = toupper(pre = curr);\n    }\n    s[new_i] = 0;\n    return s;\n}\n\nint main(void){\n    string s = GetString();\n\n    puts(func(s));\n    free(s);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1471403989, "creation_date": 1471403989, "answer_id": 38987572, "question_id": 38987079, "link": "https://stackoverflow.com/questions/38987079/return-first-letter-of-each-word-capitalized/38987572#38987572", "title": "Return first letter of each word capitalized", "body": "<p>Rather than use <code>i == s[0]</code> (which likely was meant to be <code>i == 0</code>) simply keep track of the previous character.</p>\n\n<pre><code>char previous = ' ';\n\n// Don't recalculate the length each time, just look for the null character\n// for (int i=0;i&lt;strlen(s);i++){\nfor (; *s; s++){\n    if(previous == ' ' &amp;&amp; isalpha((unsigned char) *s)) {\n      printf(\"%c\",toupper((unsigned char) *s));\n      // or \n      putchar(toupper((unsigned char) *s));\n    }\n    previous = *s; \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 285, "user_id": 4858297, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1461998464091245/picture?type=large", "display_name": "Zvonimir Rudinski", "link": "https://stackoverflow.com/users/4858297/zvonimir-rudinski"}, "is_accepted": false, "score": 0, "last_activity_date": 1484088342, "creation_date": 1484088342, "answer_id": 41579790, "question_id": 38987079, "link": "https://stackoverflow.com/questions/38987079/return-first-letter-of-each-word-capitalized/41579790#41579790", "title": "Return first letter of each word capitalized", "body": "<p>Quite easy frankly.</p>\n\n<pre><code>//First the includes\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;cs50.h&gt;\n\nint main(void) {\n        string str = GetString(); //Here you should enter your string\n        str[0] = toupper(str[0]); //Capitalize the first letter so you don't have to do extra checking in the for loop\n        for (int i = 1; i &lt; strlen(str); i++){ //Start from the second letter(or space) since index 0 is already capitalized\n                if(str[i-1] == ' ') //Check if the previous character was a space\n                        str[i] = toupper(str[i]); //Convert to uppercase\n        }\n        puts(str); //Print out the string, same thing as printf(str);\n}\n</code></pre>\n\n<p>I hope I helped  :)</p>\n"}], "owner": {"reputation": 25, "user_id": 6454402, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/u8PIZ.jpg?s=128&g=1", "display_name": "cerealCode", "link": "https://stackoverflow.com/users/6454402/cerealcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 4, "score": -10, "last_activity_date": 1484088342, "creation_date": 1471399844, "last_edit_date": 1471400917, "question_id": 38987079, "link": "https://stackoverflow.com/questions/38987079/return-first-letter-of-each-word-capitalized", "title": "Return first letter of each word capitalized", "body": "<p>I'm trying to write a function to take a string, and return the first letter of each word capitalized. </p>\n\n<p>Eg: 'The sun in the sky' => TSITS</p>\n\n<p>Here is my code. After tinkering quite a bit I manage to be able to compile; but seems like it only print the spaces of the string</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;cs50.h&gt;   // typedef char *string; string GetString();\n\nint main(void)\n{\n    string s = GetString();\n\n    for (int i=0;i&lt;strlen(s);i++){\n        if(i == s[0] || s[i-1] == ' ' ){\n            s[i] = toupper(s[i]);\n            printf(\"%c\",i);\n            i++;\n        }\n    }\n}\n</code></pre>\n\n<p>What's wrong with it? </p>\n"}, {"tags": ["c", "fgetc"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 4, "creation_date": 1471396137, "post_id": 38986666, "comment_id": 65325959, "body": "Not checking the specification well, I don&#39;t think reading files opened in <code>&quot;w&quot;</code> mode is good."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 5, "creation_date": 1471396167, "post_id": 38986666, "comment_id": 65325964, "body": "You opened the file for writing only, and didn\u2019t seek back to the beginning to re-read it, either. Don\u2019t cast the result of <code>fgetc</code> directly, either, because you\u2019ll either miss out on <code>EOF</code> or treat a valid byte as <code>EOF</code>."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1471396207, "post_id": 38986666, "comment_id": 65325973, "body": "Converting the return value of <code>fgetc()</code> into <code>char</code> and then compareing it with <code>EOF</code> is also bad because doing so will prevent it from distinguishing one of a valid character with <code>EOF</code>. use <code>int</code> instead."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1471396331, "post_id": 38986666, "comment_id": 65326001, "body": "Hmmm, <a href=\"http://melpon.org/wandbox/permlink/xTFS5X7HDf0VLH2T\" rel=\"nofollow noreferrer\">Couldn&#39;t reproduce</a>."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 2, "creation_date": 1471396412, "post_id": 38986666, "comment_id": 65326014, "body": "What happens if <code>&quot;w+&quot;</code> mode is used and <code>rewind(tmp_file);</code> (move file pointer to the beginning of the file) is used just before the <code>do</code> loop?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471397421, "post_id": 38986666, "comment_id": 65326232, "body": "Any reason you cast the result of <code>fgetc</code>? Note: it returns an <code>int</code> for a good reason, use it!"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1471397821, "post_id": 38986666, "comment_id": 65326318, "body": "In addition to the other issues, your <code>do ... while</code> loop tries to print the EOF return from <code>fgetc()</code> before the loop terminates (though it could be an infinite loop on some setups)."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1471413887, "post_id": 38986666, "comment_id": 65330471, "body": "Good error messages are important: <code>if(tmp_file == NULL){ perror(&quot;generaged.txt&quot;); exit(EXIT_FAILURE);}</code>"}], "answers": [{"comments": [{"owner": {"reputation": 585, "user_id": 4617334, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/GwUnw.jpg?s=128&g=1", "display_name": "Madhusoodan P", "link": "https://stackoverflow.com/users/4617334/madhusoodan-p"}, "edited": false, "score": 1, "creation_date": 1471404227, "post_id": 38987340, "comment_id": 65327748, "body": "The file is opened for writing but reading it will give a garbage <code>Unexpected output</code>"}], "tags": [], "owner": {"reputation": 24, "user_id": 5046868, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ibNPU.jpg?s=128&g=1", "display_name": "Chungkil Kim", "link": "https://stackoverflow.com/users/5046868/chungkil-kim"}, "is_accepted": true, "score": -1, "last_activity_date": 1471402183, "creation_date": 1471402183, "answer_id": 38987340, "question_id": 38986666, "link": "https://stackoverflow.com/questions/38986666/using-fputc-and-fgetc-to-write-to-file-ends-up-with-only-0s/38987340#38987340", "title": "using fputc and fgetc to write to file ends up with only 0&#39;s", "body": "<p>like fgetc() func read data from STREAM, STREAM has internal buffer.</p>\n\n<pre><code>FILE *tmp_file = fopen(\"generaged.txt\", \"w\");\n</code></pre>\n\n<p>when u call fopen with w or w+, it clear internal buffer with zero(or readed buffer is zero) &amp; target file is truncate with zero file size. </p>\n\n<pre><code>fputc('H', tmp_file);\nfputc('e', tmp_file);\nfputc('l', tmp_file);\nfputc('l', tmp_file);\nfputc('o', tmp_file);\nfputc('\\n', stdout);\n</code></pre>\n\n<p>this make internal buffer fill with 'Hello\\n', and file pointer to EOF(end-of-file)\nafter then call fgetc(), it will return EOF(this is int type).</p>\n\n<p>you should check after that like bellow</p>\n\n<pre><code>c = (char) fgetc(tmp_file);\nif (c == EOF) break;\n</code></pre>\n\n<p>if you want read Hello\\n from file, call like bellow before do.. while loop</p>\n\n<pre><code>fseek(tmp_file, 0L, SEEK_SET);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1471412172, "post_id": 38988585, "comment_id": 65329839, "body": "I would also emphasize compiling with, at minimum, <code>-Wall -Wextra</code> (and optionally include <code>-pedantic</code>) and then actually reading and fixing any warning generated before considering your code reliable. (very good answer by the way...)"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1471463490, "post_id": 38988585, "comment_id": 65361918, "body": "If the value of <code>EOF</code> (which is a negative <code>int</code>) is within the range of <code>char</code>, he might not have an infinite loop (for example when <code>EOF</code> is -1 and <code>char</code> is signed)... but still wouldn&#39;t be able to distinguish between <code>EOF</code> and one of the legitimate <code>char</code> values."}, {"owner": {"reputation": 6544, "user_id": 451601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/164602d512ce01f188e5a50593b46c5f?s=128&d=identicon&r=PG", "display_name": "James K. Lowden", "link": "https://stackoverflow.com/users/451601/james-k-lowden"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1471558114, "post_id": 38988585, "comment_id": 65407167, "body": "@Dmitri, yes, &quot;might&quot; is the operative word.  Section 6.3.1.3 (Signed and unsigned integers) of the standard says in paragraph 3 <i>[if] the new type is signed and the value cannot be represented in it; the result is implementation-defined.</i>  Even if EOF is -1, it&#39;s not safe to assume it will be received that way on assignment to a signed character type."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1471559015, "post_id": 38988585, "comment_id": 65407467, "body": "With signed <code>char</code> and EOF of -1, I think 6.3.1.3 paragraph 1 covers it: <i>&quot;When a value with integer type is converted to another integer type other than _Bool, if the value can be represented by the new type, it is unchanged.&quot;</i>  Paragraph 3 would apply if the value of EOF were outside the range of <code>char</code>."}, {"owner": {"reputation": 6544, "user_id": 451601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/164602d512ce01f188e5a50593b46c5f?s=128&d=identicon&r=PG", "display_name": "James K. Lowden", "link": "https://stackoverflow.com/users/451601/james-k-lowden"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1471560684, "post_id": 38988585, "comment_id": 65407978, "body": "@Dmitri, I&#39;m convinced.  Thanks for the correction."}], "tags": [], "owner": {"reputation": 6544, "user_id": 451601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/164602d512ce01f188e5a50593b46c5f?s=128&d=identicon&r=PG", "display_name": "James K. Lowden", "link": "https://stackoverflow.com/users/451601/james-k-lowden"}, "is_accepted": false, "score": 1, "last_activity_date": 1471410987, "creation_date": 1471410987, "answer_id": 38988585, "question_id": 38986666, "link": "https://stackoverflow.com/questions/38986666/using-fputc-and-fgetc-to-write-to-file-ends-up-with-only-0s/38988585#38988585", "title": "using fputc and fgetc to write to file ends up with only 0&#39;s", "body": "<blockquote>\n  <p>I've read the man pages</p>\n</blockquote>\n\n<p>but you haven't followed them!  </p>\n\n<pre><code>int fgetc(FILE *stream);\n</code></pre>\n\n<p><strong>fgetc</strong>(3) returns an <code>int</code>.  <code>EOF</code> is also an <code>int</code>.  When you assign the result to <code>char</code> (with or without a cast), you truncate that <code>int</code>.  And, as it happens, that truncated value will never equal <code>EOF</code>.  So your loop never terminates. </p>\n\n<p><code>fgetc</code> returns <code>EOF</code> under two conditions: end-of-file, and error.  To know which, use <strong>feof</strong>(3) and/or <strong>ferror</strong>(3).  </p>\n\n<p>The loop you want comes straight out of K&amp;R:</p>\n\n<pre><code>int ch;\nwhile( (ch = fgetc(tmp_file)) != EOF ) {\n    printf(\"%c \", (char)ch);\n} \nif( !feof(tmp_file) ) {\n    err( EXIT_FAILURE, NULL );\n}\n</code></pre>\n\n<p>That uses the return value only if it's valid, and prints a message if it's not.  You will almost certainly see, <em>Permission denied</em> (EACCES) because the <code>FILE</code> is not open for reading.  If not, <code>fgetc</code> will fail anyway on the first iteration because the file position indicator is at end-of-file after the last <code>fwrite</code> call.  To read the file, use <strong>rewind</strong>(3) first.</p>\n\n<blockquote>\n  <p>and casting to chars</p>\n</blockquote>\n\n<p>As a rule, don't cast, especially not return codes from the standard library.  Figure out what the warning means, and adjust your variables accordingly.  </p>\n\n<p>There are exceptions, though, as the above loop illustrates: when the returned type is <em>larger</em> than the \"valid\" type.  The manual says, </p>\n\n<blockquote>\n  <p><strong>fgetc</strong>(), <strong>getc</strong>() and <strong>getchar</strong>() return the character read as an  unsigned char cast to an int ....</p>\n</blockquote>\n\n<p>Because you <em>know</em> the function returned a character cast as an int, you <em>also</em> know you can cast it back to a character to print it.  </p>\n\n<blockquote>\n  <p>When I open the file in a text editor</p>\n</blockquote>\n\n<p><strong>hexdump</strong>(1) is your friend.  Don't believe your eyes, and don't trust your editor.  See also <code>cat -vte</code> and <strong>vis</strong>(1).  </p>\n"}], "owner": {"reputation": 1672, "user_id": 1115876, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dee3033759b820a3df9f7437d3a9fe31?s=128&d=identicon&r=PG", "display_name": "QuinnFreedman", "link": "https://stackoverflow.com/users/1115876/quinnfreedman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 853, "favorite_count": 0, "accepted_answer_id": 38987340, "answer_count": 2, "score": 0, "last_activity_date": 1471410987, "creation_date": 1471396003, "question_id": 38986666, "link": "https://stackoverflow.com/questions/38986666/using-fputc-and-fgetc-to-write-to-file-ends-up-with-only-0s", "title": "using fputc and fgetc to write to file ends up with only 0&#39;s", "body": "<p>I'm sort of new to c and trying to figure you <code>fputc</code> and <code>fgetc</code>. When I write to stdout, <code>fputc</code> works exactly as I would expect.  But when I write to a file on disk, and then read it back with <code>fgetc</code>, I cant ever get it to print anything other than 0's.</p>\n\n<p>When I open the file in a text editor, it has 'Hello' with 70 spaces after it, so i seem to be doing something sort of wrong in both the reading and writing, but when I use <code>fgetc</code> to read from a file not created in the method below, everything works.</p>\n\n<p>I've read the man pages and tired every combination of \"w\"/\"wb\"/\"w+\" and casting to chars, uints, ints. </p>\n\n<p>This is my code:</p>\n\n<pre><code>    char c;\n    FILE *tmp_file = fopen(\"generaged.txt\", \"w\");\n\n    if (tmp_file == NULL) {\n        printf(\"Unable to open file\");\n        exit(EXIT_FAILURE);\n    }\n\n    //prints nicely to console\n    fputc('H', stdout);\n    fputc('e', stdout);\n    fputc('l', stdout);\n    fputc('l', stdout);\n    fputc('o', stdout);\n    fputc('\\n', stdout);\n\n    //prints a million 0's\n    fputc('H', tmp_file);\n    fputc('e', tmp_file);\n    fputc('l', tmp_file);\n    fputc('l', tmp_file);\n    fputc('o', tmp_file);\n    fputc('\\n', stdout);\n\n    do {\n        c = (char) fgetc(tmp_file);\n        printf(\"%d \", c);\n    } while (c != EOF);\n</code></pre>\n\n<p>It gives the following console output:</p>\n\n<pre><code>Hello\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 -1\n</code></pre>\n"}, {"tags": ["c", "sdl-2"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 6724038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef62567484e22c245319b4935647e2f?s=128&d=identicon&r=PG&f=1", "display_name": "TheMrZZ", "link": "https://stackoverflow.com/users/6724038/themrzz"}, "edited": false, "score": 0, "creation_date": 1471394842, "post_id": 38986519, "comment_id": 65325680, "body": "Ok thank you :) And should I destroy the previously created SDL_Window if the renderer&#39;s creation fails ?"}, {"owner": {"reputation": 7052, "user_id": 3854570, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d7bda3cab79b9bc5570667f8c0e24134?s=128&d=identicon&r=PG&f=1", "display_name": "Nelfeal", "link": "https://stackoverflow.com/users/3854570/nelfeal"}, "reply_to_user": {"reputation": 83, "user_id": 6724038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef62567484e22c245319b4935647e2f?s=128&d=identicon&r=PG&f=1", "display_name": "TheMrZZ", "link": "https://stackoverflow.com/users/6724038/themrzz"}, "edited": false, "score": 1, "creation_date": 1471395482, "post_id": 38986519, "comment_id": 65325825, "body": "You should indeed. <code>SDL_Window</code> and <code>SDL_Renderer</code> are separate entities, even though they work together. <a href=\"https://wiki.libsdl.org/SDL_DestroyWindow\" rel=\"nofollow noreferrer\">You can even call <code>SDL_DestroyWindow</code> with a <code>NULL</code> pointer</a>, it will simply set an error message. Think of it like the couple <code>malloc</code>/<code>free</code>."}, {"owner": {"reputation": 83, "user_id": 6724038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef62567484e22c245319b4935647e2f?s=128&d=identicon&r=PG&f=1", "display_name": "TheMrZZ", "link": "https://stackoverflow.com/users/6724038/themrzz"}, "edited": false, "score": 0, "creation_date": 1471395582, "post_id": 38986519, "comment_id": 65325839, "body": "That&#39;s exactly what I wanted to know ! Thank you Nelxiost."}], "tags": [], "owner": {"reputation": 7052, "user_id": 3854570, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d7bda3cab79b9bc5570667f8c0e24134?s=128&d=identicon&r=PG&f=1", "display_name": "Nelfeal", "link": "https://stackoverflow.com/users/3854570/nelfeal"}, "is_accepted": true, "score": 6, "last_activity_date": 1471394637, "creation_date": 1471394637, "answer_id": 38986519, "question_id": 38986213, "link": "https://stackoverflow.com/questions/38986213/should-i-use-sdl-quit-even-after-a-failed-initialisation/38986519#38986519", "title": "Should I use SDL_Quit() even after a failed initialisation?", "body": "<p>From <a href=\"https://wiki.libsdl.org/SDL_Quit\">the SDL Wiki</a> :</p>\n\n<blockquote>\n  <p>You should call it upon all exit conditions.</p>\n</blockquote>\n\n<p>So, assuming you called <code>SDL_Init</code> before, which is required for using any other SDL function, you should call <code>SDL_Quit</code> no matter what.</p>\n\n<p>Also, from the same page :</p>\n\n<blockquote>\n  <p>It is safe to call this function even in the case of errors in initialization.</p>\n</blockquote>\n\n<p>That means you don't even have to worry about being wrong for calling it.</p>\n\n<p>For convenience, you can use <code>SDL_Quit</code> with <code>atexit</code>, but that is more of a matter of taste.</p>\n"}], "owner": {"reputation": 83, "user_id": 6724038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef62567484e22c245319b4935647e2f?s=128&d=identicon&r=PG&f=1", "display_name": "TheMrZZ", "link": "https://stackoverflow.com/users/6724038/themrzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 879, "favorite_count": 0, "accepted_answer_id": 38986519, "answer_count": 1, "score": 3, "last_activity_date": 1471444803, "creation_date": 1471391974, "last_edit_date": 1471444803, "question_id": 38986213, "link": "https://stackoverflow.com/questions/38986213/should-i-use-sdl-quit-even-after-a-failed-initialisation", "title": "Should I use SDL_Quit() even after a failed initialisation?", "body": "<p>When using SDL2.0, is it reasonable to stop the program without using SDL_Quit() if SDL could not create the window or the renderer ?</p>\n\n<p>For example, can I write (after the SDL initialisation, the window and the renderer creation):</p>\n\n<pre><code>if (!renderer)\n{\n    fprintf(\"Error while creating the renderer: %s\\n\", SDL_GetError());\n    return -1;\n}\n\nSDL_DestroyWindow(window);\nIMG_Quit();\nSDL_Quit();\nreturn 0;\n</code></pre>\n\n<p>Or should I write :</p>\n\n<pre><code>if (!renderer)\n{\n    fprintf(\"Error while creating the renderer: %s\\n\", SDL_GetError());\n    SDL_DestroyWindow(window);\n    SDL_Quit();\n    return -1;\n}\n\nSDL_DestroyWindow(window);\nIMG_Quit();\nSDL_Quit();\nreturn 0;\n</code></pre>\n\n<p>I think the second choice is better, but I'm not sure that it is really useful to close the SDL and to destroy the window even when the renderer wasn't created.</p>\n"}, {"tags": ["c", "algorithm", "data-structures", "binary-tree", "binary-search-tree"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1471390850, "post_id": 38985927, "comment_id": 65324821, "body": "Your program exhibits undefined behavior for accessing an object after its lifetime has ended."}, {"owner": {"reputation": 99, "user_id": 6115169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-89Gc-mdUlEs/AAAAAAAAAAI/AAAAAAAACVw/DmqwnFjQpVM/photo.jpg?sz=128", "display_name": "Danish A. Alvi", "link": "https://stackoverflow.com/users/6115169/danish-a-alvi"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1471391129, "post_id": 38985927, "comment_id": 65324880, "body": "How does the lifetime of the object end? &#39;iterator&#39; is still there, how is it gone?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1471391322, "post_id": 38985927, "comment_id": 65324927, "body": "C11 draft standard n1570: <i>6.2.4 Storage durations of objects 2 The lifetime of an object is the portion of program execution during which storage is guaranteed to be reserved for it.[...] 34) If an object is referred to outside of its lifetime, the behavior is undefined. The value of a pointer becomes indeterminate when the object it points to (or just past) reaches the end of its lifetime. 7.22.3 Memory management functions 1 [...] The lifetime of an allocated object extends from the allocation until the deallocation.[...]</i>"}, {"owner": {"reputation": 99, "user_id": 6115169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-89Gc-mdUlEs/AAAAAAAAAAI/AAAAAAAACVw/DmqwnFjQpVM/photo.jpg?sz=128", "display_name": "Danish A. Alvi", "link": "https://stackoverflow.com/users/6115169/danish-a-alvi"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1471391441, "post_id": 38985927, "comment_id": 65324959, "body": "Okay, so how can I fix this issue then?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1471391481, "post_id": 38985927, "comment_id": 65324967, "body": "Don&#39;t access an object after you <code>free()</code> it? That doesn&#39;t sound <i>too</i> complicated, does it?"}, {"owner": {"reputation": 99, "user_id": 6115169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-89Gc-mdUlEs/AAAAAAAAAAI/AAAAAAAACVw/DmqwnFjQpVM/photo.jpg?sz=128", "display_name": "Danish A. Alvi", "link": "https://stackoverflow.com/users/6115169/danish-a-alvi"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1471392257, "post_id": 38985927, "comment_id": 65325152, "body": "I do not think I am accessing an object after freeing it, i am accessing it before freeing it."}, {"owner": {"reputation": 99, "user_id": 6115169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-89Gc-mdUlEs/AAAAAAAAAAI/AAAAAAAACVw/DmqwnFjQpVM/photo.jpg?sz=128", "display_name": "Danish A. Alvi", "link": "https://stackoverflow.com/users/6115169/danish-a-alvi"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1471393293, "post_id": 38985927, "comment_id": 65325392, "body": "I am sorry. Thanks for your effort though."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1471393866, "post_id": 38985927, "comment_id": 65325496, "body": "You have: <code>if (cursor-&gt;left == NULL &amp;&amp; cursor-&gt;right == NULL) {         \u2026; free(cursor);     }     if (cursor-&gt;left == NULL &amp;&amp; cursor-&gt;right != NULL) { \u2026 } \u2026</code>.  When you free the cursor, your code goes onto the next <code>if</code> block, accessing the freed cursor.  You either need a <code>return</code> or similar after the <code>free(cursor);</code> or you need to use <code>if (cursor-&gt;left == NULL &amp;&amp; cursor-&gt;right == NULL) { \u2026         free(cursor);     }     else if (cursor-&gt;left == NULL &amp;&amp; cursor-&gt;right != NULL) { \u2026 } \u2026</code>."}, {"owner": {"reputation": 99, "user_id": 6115169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-89Gc-mdUlEs/AAAAAAAAAAI/AAAAAAAACVw/DmqwnFjQpVM/photo.jpg?sz=128", "display_name": "Danish A. Alvi", "link": "https://stackoverflow.com/users/6115169/danish-a-alvi"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1471397140, "post_id": 38985927, "comment_id": 65326175, "body": "Thank you for your comment @JonathanLeffler. I changed the remaining ifs to else ifs and added a return to the end of each if/else if code block but still same error. :("}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1471406186, "post_id": 38985927, "comment_id": 65328171, "body": "It very often works out that where there&#39;s one problem, there are several others lurking.  I&#39;m seeing problems when trying to delete the root node of the tree when the tree is non-empty.  The code ends up dereferencing <code>parent-&gt;left</code> when <code>parent</code> is a null pointer.  That leads to a crash.  Your analysis in <code>delete()</code> doesn&#39;t seem to account for a null parent.  Now, there&#39;s a chance that my insertion code is different from yours, but at the least, you need to work out what happens when the value in the root node is deleted. I&#39;m not entirely clear why you have the recursive delete call."}, {"owner": {"reputation": 99, "user_id": 6115169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-89Gc-mdUlEs/AAAAAAAAAAI/AAAAAAAACVw/DmqwnFjQpVM/photo.jpg?sz=128", "display_name": "Danish A. Alvi", "link": "https://stackoverflow.com/users/6115169/danish-a-alvi"}, "edited": false, "score": 0, "creation_date": 1471452613, "post_id": 38985927, "comment_id": 65356110, "body": "I realised what my mistake was. I was assigning the value of iterator-&gt;data to cursor-&gt;data before recursively deleting iterator. it made different nodes in two different locations of the same value, hence violating the BST property. Thank you fo your help!"}], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1471391536, "post_id": 38986153, "comment_id": 65324978, "body": "Considering the function recurses <i>until</i> the <code>cursor</code> has less than two children, the undefined behavior is unavoidable."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 0, "last_activity_date": 1471391806, "last_edit_date": 1471391806, "creation_date": 1471391476, "answer_id": 38986153, "question_id": 38985927, "link": "https://stackoverflow.com/questions/38985927/bst-node-delete-function-failing-at-recursive-call/38986153#38986153", "title": "BST node delete function failing at recursive call", "body": "<p>The problem with your <code>delete</code> function is you do not return after each <code>free(cursor);</code>.  Instead you keep testing the next case, dereferencing <code>cursor</code> that was just freed.  The problem is primarily when <code>cursor</code> has 1 or no children.</p>\n"}], "owner": {"reputation": 99, "user_id": 6115169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-89Gc-mdUlEs/AAAAAAAAAAI/AAAAAAAACVw/DmqwnFjQpVM/photo.jpg?sz=128", "display_name": "Danish A. Alvi", "link": "https://stackoverflow.com/users/6115169/danish-a-alvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 38986153, "answer_count": 1, "score": 1, "last_activity_date": 1471391806, "creation_date": 1471389749, "last_edit_date": 1471391739, "question_id": 38985927, "link": "https://stackoverflow.com/questions/38985927/bst-node-delete-function-failing-at-recursive-call", "title": "BST node delete function failing at recursive call", "body": "<pre><code>void search(struct node **root, struct node **cursor,\n            struct node **parent, int data, int *found) {\n    struct node *iterator = *root;\n\n    *cursor = NULL, *parent = NULL;\n    *found = FALSE;\n\n    while (iterator != NULL) {\n        if (data == iterator-&gt;data) {\n            *found = TRUE;\n            *cursor = iterator;\n            break;\n        } else\n        if (data &lt;= iterator-&gt;data) {\n            *parent = iterator;\n            iterator = iterator-&gt;left;\n        } else {\n            *parent = iterator;\n            iterator = iterator-&gt;right;\n        }\n    }\n}\n\nvoid delete(struct node **root, int data) {\n    int found;\n    struct node *cursor, *parent;\n\n    if (*root == NULL) {\n        printf(\"ERROR! Binary Search Tree Empty!\\n\");\n        exit(0);\n    }\n    search(root, &amp;cursor, &amp;parent, data, &amp;found);\n    if (found == FALSE) {\n        printf(\"ERROR! Element not found in Binary Tree!\\n\");\n        exit(0);\n    }\n    //  If the Node has No Children\n    if (cursor-&gt;left == NULL &amp;&amp; cursor-&gt;right == NULL) {\n        if (parent-&gt;left == cursor) {\n            parent-&gt;left = NULL;\n        } else {\n            parent-&gt;right = NULL;\n        }\n        free(cursor);\n    }\n    if (cursor-&gt;left == NULL &amp;&amp; cursor-&gt;right != NULL) {\n        if (parent-&gt;left == cursor) {\n            parent-&gt;left = cursor-&gt;right;\n        } else {\n            parent-&gt;right = cursor-&gt;right;\n        }\n        free(cursor);\n    }\n    if (cursor-&gt;left != NULL &amp;&amp; cursor-&gt;right == NULL) {\n        if (parent-&gt;left == cursor) {\n            parent-&gt;left = cursor-&gt;left;\n        } else {\n            parent-&gt;right = cursor-&gt;left;\n        }\n        free(cursor);\n    }\n    // If node has two children\n    if (cursor-&gt;left != NULL &amp;&amp; cursor-&gt;right != NULL) {\n        struct node *iterator = cursor;\n        iterator = iterator-&gt;right;\n        while (iterator-&gt;left != NULL) {\n            iterator = iterator-&gt;left;\n        }\n        cursor-&gt;data = iterator-&gt;data;\n        printf(\"\\n%i\\n\", iterator-&gt;data);\n        delete(&amp;iterator, iterator-&gt;data);\n    }\n}\n</code></pre>\n\n<p>I am trying to implement a Binary Search Tree Delete function. I have tested for many BSTs however it fails when I remove a node with two children. It fails at the <strong>recursive</strong> call. It gives a <strong>Segmentation fault 11</strong>. What should I do?</p>\n"}, {"tags": ["c", "linux", "compilation", "openssl", "openvpn"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1482040525, "post_id": 38985889, "comment_id": 69610935, "body": "Also see <a href=\"https://community.openvpn.net/openvpn/ticket/794\" rel=\"nofollow noreferrer\">Issue 794: Process for builing OpenVPN with OpenSSL</a> reported in the OpenVPN issue tracker."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 3080035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p1Q6V.jpg?s=128&g=1", "display_name": "Antony", "link": "https://stackoverflow.com/users/3080035/antony"}, "edited": false, "score": 0, "creation_date": 1471453969, "post_id": 38992373, "comment_id": 65356823, "body": "I think you&#39;re on the right path. /etc/ld.so.conf just includes the *.conf files in the /etc/ld.so.conf.d directory. In that directory, libc.conf points to /usr/local/lib, but the libraries for OpenSSL do not reside there, so it probably resorts to the system defaults. I&#39;ll see what else I can find out."}, {"owner": {"reputation": 113, "user_id": 3080035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p1Q6V.jpg?s=128&g=1", "display_name": "Antony", "link": "https://stackoverflow.com/users/3080035/antony"}, "edited": false, "score": 0, "creation_date": 1471456145, "post_id": 38992373, "comment_id": 65358001, "body": "I tried adding both &quot;/usr/local/ssl&quot; or &quot;/usr/local/ssl/lib&quot; to libc.conf and got the same results. At this point, I don&#39;t really think it matters since the security fixes in 1.0.1t were backported to 1.0.1f on Ubuntu anyway."}], "tags": [], "owner": {"reputation": 6008, "user_id": 325102, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3f053dd9ca8b6f699fe26f4015915391?s=128&d=identicon&r=PG", "display_name": "plaisthos", "link": "https://stackoverflow.com/users/325102/plaisthos"}, "is_accepted": false, "score": 1, "last_activity_date": 1471424847, "creation_date": 1471424847, "answer_id": 38992373, "question_id": 38985889, "link": "https://stackoverflow.com/questions/38985889/build-openvpn-with-specific-openssl-version/38992373#38992373", "title": "Build OpenVPN with specific OpenSSL version", "body": "<p>OpenVPN reports the version of the <strong>runtime library</strong>, so what you are seeing here is linking/dynamic library behaviour. Probably your ld.so.conf is setup to prefer /usr/lib/<em>.so over /usr/local/lib/</em>.so</p>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 3080035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p1Q6V.jpg?s=128&g=1", "display_name": "Antony", "link": "https://stackoverflow.com/users/3080035/antony"}, "edited": false, "score": 0, "creation_date": 1471490783, "post_id": 39006247, "comment_id": 65370665, "body": "I upvoted this, but my rep is too low. I didn&#39;t follow the steps exactly, but this got it working. The issue was, first that I didn&#39;t create the *.so files when I compiled OpenSSL the first time. Second, I wasn&#39;t linking them properly with configure during the OpenVPN build. I re-compiled OpenSSL with an edited form of the command you listed, checked that it was properly linked, skipped the symbolic link since I&#39;d already done that, and compiled openvpn with the command you gave and it worked just fine. So thank you very much for the comprehensive and correct answer."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "reply_to_user": {"reputation": 113, "user_id": 3080035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p1Q6V.jpg?s=128&g=1", "display_name": "Antony", "link": "https://stackoverflow.com/users/3080035/antony"}, "edited": false, "score": 0, "creation_date": 1471491717, "post_id": 39006247, "comment_id": 65370899, "body": "@Antony - I&#39;m guessing (and its only a guess) that this was not quite right: <code>OPENSSL_CFLAGS=&quot;-I&#47;usr&#47;local&#47;ssl&#47;include&#47;&quot;</code>. Those <code>CFLAGS</code> needed to be applied to the entire OpenVPN build, and not just some portion of OpenSSL. I&#39;m not even clear what <code>OPENSSL_CFLAGS</code> and <code>OPENSSL_LIBS</code> does because <code>.&#47;configure --help</code> did not explain it; and Installation notes did not explain it."}, {"owner": {"reputation": 113, "user_id": 3080035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p1Q6V.jpg?s=128&g=1", "display_name": "Antony", "link": "https://stackoverflow.com/users/3080035/antony"}, "edited": false, "score": 0, "creation_date": 1471492404, "post_id": 39006247, "comment_id": 65371067, "body": "I figured it had to be something along those lines. The old flags used to be <code>OPENSSL_SSL_FLAGS</code> and <code>OPENSSL_CRYPTO_FLAGS</code>, but they were removed in later versions it would seem. The OpenVPN and configure documentation aren&#39;t very clear about what they&#39;re used for. Thanks again for your help. I&#39;d been wracking my brain for about 2 days trying to figure out what I was doing wrong."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "reply_to_user": {"reputation": 113, "user_id": 3080035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p1Q6V.jpg?s=128&g=1", "display_name": "Antony", "link": "https://stackoverflow.com/users/3080035/antony"}, "edited": false, "score": 0, "creation_date": 1471578618, "post_id": 39006247, "comment_id": 65411927, "body": "@Antony - I&#39;m thinking <code>OPENSSL_SSL_FLAGS</code>, <code>OPENSSL_CRYPTO_FLAGS</code> and friends <i>may</i> be for building OpenSSL in-tree. I.e., drop OpenSSL into the <code>&lt;openvpn src&gt;</code> directory, and the OpenVPN build system will build OpenSSL for you. But again, its only a guess. If its not that, then I can&#39;t think of other reasons those variables would be useful."}, {"owner": {"reputation": 58765, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "edited": false, "score": 1, "creation_date": 1502723232, "post_id": 39006247, "comment_id": 78312659, "body": "Great write up, thanks. I had to add an additional flag to get the OpenSSL configuration to work: <code>-Wl,--enable-new-dtags,-rpath...</code>."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "reply_to_user": {"reputation": 58765, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "edited": false, "score": 0, "creation_date": 1502768861, "post_id": 39006247, "comment_id": 78330014, "body": "@DuncanJones - Yeah, Linux is pretty f**k&#39;d up when it comes to library paths. They&#39;ve been broken 30 years or so now. The Linux folks need to switch to a scheme like Apple&#39;s <code>install_name</code>. Things should &quot;just work&quot; for the typical user. Let those who want to swizzle and inject do something special."}, {"owner": {"reputation": 220, "user_id": 3295322, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/1a114d13f7cb21d6f699f5ac0b2de8a3?s=128&d=identicon&r=PG&f=1", "display_name": "YouHaveaBigEgo", "link": "https://stackoverflow.com/users/3295322/youhaveabigego"}, "edited": false, "score": 0, "creation_date": 1508141227, "post_id": 39006247, "comment_id": 80476449, "body": "Do I use the same instructions to configure the newer openssl-1.0.2l ? I did: <code>.&#47;config shared no-ssl2 no-ssl3 no-comp enable-ec_nistp_64_gcc_128 -Wl,-rpath=&#47;usr&#47;local&#47;ssl&#47;lib --prefix=&#47;usr&#47;local&#47;ssl</code> but my build fails when I give the make command. make test fails too"}, {"owner": {"reputation": 676, "user_id": 308351, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8830de9fd96ba291ebae62bdf7bf931f?s=128&d=identicon&r=PG", "display_name": "erny", "link": "https://stackoverflow.com/users/308351/erny"}, "edited": false, "score": 0, "creation_date": 1540567512, "post_id": 39006247, "comment_id": 92927140, "body": "Great recipe! I just tried it (OpenVPN 2.4.6) with OS X (10.9.5), linking against openssl (1.0.2p) installed by homebrew. The &quot;-Wl,-rpath=/usr/local/ssl/lib&quot; CFLAGS must be removed: <code>CFLAGS=&quot;-I&#47;usr&#47;local&#47;opt&#47;openssl&#47;include -L&#47;usr&#47;local&#47;opt&#47;openssl&#47;lib&quot; .&#47;configure --disable-lzo</code> Check the build binary with <code>otool -L .&#47;src&#47;openvpn&#47;openvpn</code>  to see what dynamic libs are used. Thx."}, {"owner": {"reputation": 101, "user_id": 9433374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44ff680a9f34e57de12bc92b3cd63111?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro", "link": "https://stackoverflow.com/users/9433374/pedro"}, "edited": false, "score": 0, "creation_date": 1551090597, "post_id": 39006247, "comment_id": 96498775, "body": "If going through this kind of trouble I always keep my libs separate for ease of future maintenance. So I would install openssl into /usr/local/openssl-&lt;version&gt;, openvpn onto /usr/local/openvpn-&lt;version&gt; and do the linking and RPATH&#39;ing specifically to those locations. That way openvpn won&#39;t stop working if the /usr/local/ssl&#39;s library gets upgraded in the future."}, {"owner": {"reputation": 57635, "user_id": 92153, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/ea496ad1627458ccfad06c94842b7624?s=128&d=identicon&r=PG", "display_name": "Houman", "link": "https://stackoverflow.com/users/92153/houman"}, "edited": false, "score": 0, "creation_date": 1594934659, "post_id": 39006247, "comment_id": 111309360, "body": "@jww Thanks for this brilliant tutorial.  After compiling it I get the binary inside <code>&#47;usr&#47;local&#47;sbin&#47;openvpn</code>.  But where is the main folder? Do I place the binary and configs under <code>&#47;etc&#47;openvpn&#47;server&#47;</code> ?"}], "tags": [], "owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "is_accepted": true, "score": 16, "last_activity_date": 1540568032, "last_edit_date": 1540568032, "creation_date": 1471467812, "answer_id": 39006247, "question_id": 38985889, "link": "https://stackoverflow.com/questions/38985889/build-openvpn-with-specific-openssl-version/39006247#39006247", "title": "Build OpenVPN with specific OpenSSL version", "body": "<p>Below is the procedure I used to build OpenVPN with OpenSSL 1.0.2. OpenSSL 1.0.1 <em>vs.</em> 1.0.2 <em>vs.</em> 1.1.0 should not matter. However, some Configure scripts dies on OpenSSL 1.1.0 because 1.1.0 uses <code>OPENSSL_init_ssl</code> rather than <code>SSL_library_init</code>. Note the use of RPATH's on Linux (OS X would use a different technique).</p>\n\n<p>OpenSSL configuration options are mostly documented at <a href=\"http://wiki.openssl.org/index.php/Compilation_and_Installation#Configure_Options\" rel=\"noreferrer\">Compilation and Installation | Configure Options</a> on their wiki. I did <em>not</em> find similar for OpenVPN, and <code>./configure --help</code> was not very helpful. Often, for an Autools project, you need to <code>--with-ssl=&lt;path to ssl root&gt;</code>, but OpenVPN does not appear to have that option. For OpenVPN, the process below went adhoc using Autools <code>CFLAGS</code>.</p>\n\n<p>Both libraries disabled compression because it can leak information. For more details, see <a href=\"http://www.cs.jhu.edu/~cwright/oakland08.pdf\" rel=\"noreferrer\">Spot me if you can: Uncovering spoken phrases in encrypted VoIP conversations</a>. The problem is the variable bit rate encoding, and the fundamental design is prevalent in other compression libraries (like zlib).</p>\n\n<p><strong><em>OpenSSL 1.0.2</em></strong></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ wget https://www.openssl.org/source/openssl-1.0.2h.tar.gz\n$ tar xzf openssl-1.0.2h.tar.gz\n$ cd openssl-1.0.2h\n\n$ ./config shared no-ssl2 no-ssl3 no-comp enable-ec_nistp_64_gcc_128 -Wl,-rpath=/usr/local/ssl/lib --prefix=/usr/local/ssl\n$ make -j 4\n$ make test\n$ sudo make install\n\n# clear program cache\n$ hash -r\n</code></pre>\n\n<p>You can check the <code>openssl</code> program is using the expected shared objects with:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ ldd /usr/local/ssl/bin/openssl\n    linux-vdso.so.1 =&gt;  (0x00007ffc36578000)\n    libssl.so.1.0.0 =&gt; /usr/local/ssl/lib/libssl.so.1.0.0 (0x00007f94b48fb000)\n    libcrypto.so.1.0.0 =&gt; /usr/local/ssl/lib/libcrypto.so.1.0.0 (0x00007f94b448b000)\n    libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f94b40c6000)\n    libdl.so.2 =&gt; /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f94b3ec2000)\n    /lib64/ld-linux-x86-64.so.2 (0x00007f94b4b6c000)\n</code></pre>\n\n<p>You can also make sure the new <code>openssl</code> is on-path with the following. Its not required for your issue, however.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ sudo ln -s /usr/local/ssl/bin/openssl /usr/local/bin/openssl\n$ hash -r\n$ command -v openssl\n/usr/local/bin/openssl\n</code></pre>\n\n<p><strong><em>OpenVPN 2.3.11</em></strong></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ wget https://swupdate.openvpn.org/community/releases/openvpn-2.3.11.tar.gz\n$ tar xzf openvpn-2.3.11.tar.gz\n$ cd openvpn-2.3.11\n\n$ CFLAGS=\"-I/usr/local/ssl/include -Wl,-rpath=/usr/local/ssl/lib -L/usr/local/ssl/lib\" ./configure --disable-lzo\n$ make -j 4\n</code></pre>\n\n<p>Next, check the OpenVPN program to see what its linking to:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ find . -type f -name openvpn\n./src/openvpn/openvpn\n$ ldd ./src/openvpn/openvpn\n    linux-vdso.so.1 =&gt;  (0x00007ffc8bfc4000)\n    libssl.so.1.0.0 =&gt; /usr/local/ssl/lib/libssl.so.1.0.0 (0x00007f74f49f3000)\n    libcrypto.so.1.0.0 =&gt; /usr/local/ssl/lib/libcrypto.so.1.0.0 (0x00007f74f4583000)\n    libdl.so.2 =&gt; /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f74f437f000)\n    libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f74f3fba000)\n    /lib64/ld-linux-x86-64.so.2 (0x00007f74f4c64000)\n</code></pre>\n\n<p>Next, run the self tests:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ make check\n...\nmake[3]: Entering directory `/home/jwalton/openvpn-2.3.11/tests'\n./t_client.sh: cannot find 't_client.rc' in build dir ('..')\n./t_client.sh: or source directory ('.'). SKIPPING TEST.\nSKIP: t_client.sh\nTesting cipher AES-128-CBC... OK\nTesting cipher AES-128-CFB... OK\nTesting cipher AES-128-CFB1... OK\n...\n</code></pre>\n\n<p>Install OpenVPN if it tests OK:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ sudo make install\n$ hash -r\n$ command -v openvpn\n/usr/local/sbin/openvpn\n</code></pre>\n\n<p>Finally, check it:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ /usr/local/sbin/openvpn --version\nOpenVPN 2.3.11 x86_64-unknown-linux-gnu [SSL (OpenSSL)] [EPOLL] [MH] [IPv6] built on Aug 17 2016\nlibrary versions: OpenSSL 1.0.2h  3 May 2016\nOriginally developed by James Yonan\nCopyright (C) 2002-2010 OpenVPN Technologies, Inc. &lt;sales@openvpn.net&gt;\n...\n</code></pre>\n\n<hr>\n\n<p>If interested, you can find a build script to automate the process at <a href=\"https://github.com/noloader/Build-Scripts\" rel=\"noreferrer\">Noloader | Build-Scripts</a>. It includes one for OpenVPN.</p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 6907023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66fce40753160e680a82e777e3549019?s=128&d=identicon&r=PG", "display_name": "dotvotdot", "link": "https://stackoverflow.com/users/6907023/dotvotdot"}, "is_accepted": false, "score": 0, "last_activity_date": 1527107170, "last_edit_date": 1527107170, "creation_date": 1527106551, "answer_id": 50496775, "question_id": 38985889, "link": "https://stackoverflow.com/questions/38985889/build-openvpn-with-specific-openssl-version/50496775#50496775", "title": "Build OpenVPN with specific OpenSSL version", "body": "<p>One solution I have successfully used is the OpenVPN <a href=\"https://community.openvpn.net/openvpn/wiki/BuildingUsingGenericBuildsystem\" rel=\"nofollow noreferrer\">build-system</a></p>\n\n<p>Simply change the OpenSSL source version in <code>generic/build.vars</code> and let it go (as documented)</p>\n\n<p>If you have trouble with options like <code>--dynamicbase</code> or <code>--nxcompat</code> then also disable those flags in <code>generic/build.vars</code></p>\n"}], "owner": {"reputation": 113, "user_id": 3080035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p1Q6V.jpg?s=128&g=1", "display_name": "Antony", "link": "https://stackoverflow.com/users/3080035/antony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15158, "favorite_count": 3, "accepted_answer_id": 39006247, "answer_count": 3, "score": 9, "last_activity_date": 1540568032, "creation_date": 1471389407, "last_edit_date": 1471465344, "question_id": 38985889, "link": "https://stackoverflow.com/questions/38985889/build-openvpn-with-specific-openssl-version", "title": "Build OpenVPN with specific OpenSSL version", "body": "<p>Similar questions have been asked before, but the answers no longer seem to apply as the flags have changed for the configure script. I am trying to compile OpenVPN from the git source on Ubuntu 14.04.5 on both x86 and x64. I have OpenSSL 1.0.1t built and installed to /usr/local/ssl. I've tried various combinations of the configure options and the compiler seems to recognize since</p>\n\n<pre><code>./configure OPENSSL_LIBS=\"-L/usr/local/ssl/ -lssl -lcrypto\" OPENSSL_CFLAGS=\"-I/usr/local/ssl/include/\"\n</code></pre>\n\n<p>finishes with no errors, but <code>./configure OPENSSL_LIBS=\"-L/usr/local/ssl/\" OPENSSL_CFLAGS=\"-I/usr/local/ssl/include/\"</code> results in <code>configure: error: openssl check failed</code>. Once you do make and make install, it still reports the system version of OpenSSL: </p>\n\n<pre><code>root@anonymous:/usr/local/src/openvpn# openvpn --version\nOpenVPN 2.3_git [git:master/d1bd37fd508ee046] x86_64-unknown-linux-gnu [SSL (OpenSSL)]\n[LZO] [LZ4] [EPOLL] [MH] [IPv6] built on Aug 16 2016\nlibrary versions: OpenSSL 1.0.1f 6 Jan 2014, LZO 2.06\nOriginally developed by James Yonan\nCopyright (C) 2002-2010 OpenVPN Technologies, Inc. &lt;sales@openvpn.net&gt;\nCompile time defines: enable_async_push=no enable_comp_stub=no enable_crypto=yes\nenable_crypto_ofb_cfb=yes enable_debug=yes enable_def_auth=yes enable_dlopen=unknown\nenable_dlopen_self=unknown enable_dlopen_self_static=unknown enable_fast_install=yes\nenable_fragment=yes enable_iproute2=no enable_libtool_lock=yes enable_lz4=yes\nenable_lzo=yes enable_management=yes enable_multi=yes enable_multihome=yes enable_pam_dlopen=no\nenable_pedantic=no enable_pf=yes enable_pkcs11=no enable_plugin_auth_pam=yes\nenable_plugin_down_root=yes enable_plugins=yes enable_port_share=yes enable_selinux=no\nenable_server=yes enable_shared=yes enable_shared_with_static_runtimes=no enable_small=no\nenable_static=yes enable_strict=no enable_strict_options=no enable_systemd=no\n enable_werror=no enable_win32_dll=yes enable_x509_alt_username=no with_crypto_library=openssl\nwith_gnu_ld=yes with_mem_check=no with_plugindir='$(libdir)/openvpn/plugins' with_sysroot=no\n</code></pre>\n\n<p>System OpenSSL:</p>\n\n<pre><code>root@anonymous:/usr/local/src/openvpn# openssl version\n\nOpenSSL 1.0.1f 6 Jan 2014\n</code></pre>\n\n<p>Compiled OpenSSL:</p>\n\n<pre><code>root@anonymous:/usr/local/ssl/bin# ./openssl version\n\nOpenSSL 1.0.1t  3 May 2016\n</code></pre>\n\n<p>I know it has to be something simple, but I saw other users asking about this on the OpenVPN Forums with no responses as of yet.</p>\n"}, {"tags": ["c", "sse", "simd", "avx", "avx2"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1471389144, "post_id": 38985793, "comment_id": 65324416, "body": "exact duplicate: producing a filtered copy of an array with AVX2."}, {"owner": {"reputation": 351, "user_id": 1118347, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f8bafc4a11e8e0aeb8cdb3dd354ec95e?s=128&d=identicon&r=PG", "display_name": "nineties", "link": "https://stackoverflow.com/users/1118347/nineties"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1471389304, "post_id": 38985793, "comment_id": 65324473, "body": "My googling skill isn&#39;t quite there yet, but :)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1471395764, "post_id": 38985793, "comment_id": 65325888, "body": "Feel free to upvote my answer there.  I&#39;m still pretty proud of the cool BMI2 trick using <code>pext</code>&#39;s left-packing hardware to generate a shuffle mask. :)"}, {"owner": {"reputation": 351, "user_id": 1118347, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f8bafc4a11e8e0aeb8cdb3dd354ec95e?s=128&d=identicon&r=PG", "display_name": "nineties", "link": "https://stackoverflow.com/users/1118347/nineties"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1471466289, "post_id": 38985793, "comment_id": 65363358, "body": "done :). Thanks. I wish stackoverflow was more thanking friendly"}], "owner": {"reputation": 351, "user_id": 1118347, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f8bafc4a11e8e0aeb8cdb3dd354ec95e?s=128&d=identicon&r=PG", "display_name": "nineties", "link": "https://stackoverflow.com/users/1118347/nineties"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "closed_date": 1471389438, "answer_count": 0, "score": 0, "last_activity_date": 1471388870, "creation_date": 1471388870, "question_id": 38985793, "link": "https://stackoverflow.com/questions/38985793/simd-avx2-mask-store-and-pack", "closed_reason": "Duplicate", "title": "SIMD (AVX2) mask store and pack", "body": "<p>I am trying to perform the following operation in AVX2 code (dest, data, and mask are int32 pointers):</p>\n\n<pre><code>int j=0;\nfor(i=0; i&lt;N; ++i){\n    if (mask[i]){\n        dest[j++] = data[i];\n    }\n}\n</code></pre>\n\n<p>In AVX2, the closest instruction I can find is:</p>\n\n<pre><code>_mm256_maskstore_epi32(dest, (__m256*)mask, (__m256*)data);\n</code></pre>\n\n<p>But then I would need to perform the packing manually, which seems inefficient...</p>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 5, "creation_date": 1471383048, "post_id": 38984777, "comment_id": 65322297, "body": "The first three numbers come from the first printf, and the second three numbers come from the second printf as the stack unwinds. To see that better, try <code>&quot;a:%d &quot;</code> and <code>&quot;b:%d &quot;</code> as the format strings."}, {"owner": {"reputation": 69, "user_id": 4490111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b946b91a38cb6ca147f6a6ce6f7a05e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilles Van Hooff", "link": "https://stackoverflow.com/users/4490111/gilles-van-hooff"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1471383134, "post_id": 38984777, "comment_id": 65322329, "body": "Yeah I get that, but why is it going from 2 to 0, it doesn&#39;t make sense to me?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1471383179, "post_id": 38984777, "comment_id": 65322351, "body": "Your code does nothing since the function is never called."}, {"owner": {"reputation": 69, "user_id": 4490111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b946b91a38cb6ca147f6a6ce6f7a05e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilles Van Hooff", "link": "https://stackoverflow.com/users/4490111/gilles-van-hooff"}, "edited": false, "score": 0, "creation_date": 1471383227, "post_id": 38984777, "comment_id": 65322374, "body": "Yeah I call it in the main, didn&#39;t think it was necessary to post that...."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1471383437, "post_id": 38984777, "comment_id": 65322465, "body": "Try to ask yourself, <b>when</b> does the second <code>printf</code> get called on any iteration?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1471383453, "post_id": 38984777, "comment_id": 65322478, "body": "In your original question you didn&#39;t even state what value you called it with. Readers shouldn&#39;t need to infer that (not that it is very hard)."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1471383545, "post_id": 38984777, "comment_id": 65322521, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/27768992/problems-with-understanding-how-recursion-works-in-c\">Problems with understanding how recursion works in C</a>, or <a href=\"http://stackoverflow.com/q/20714617/69809\">Understanding recursion in the beer bottle example</a>, or <a href=\"http://stackoverflow.com/q/25676961/69809\">Understanding how recursive functions work</a>."}, {"owner": {"reputation": 69, "user_id": 4490111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b946b91a38cb6ca147f6a6ce6f7a05e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilles Van Hooff", "link": "https://stackoverflow.com/users/4490111/gilles-van-hooff"}, "edited": false, "score": 0, "creation_date": 1471384176, "post_id": 38984777, "comment_id": 65322769, "body": "Sorry John. Thanks for the help guys, I understand now!"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 4490111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b946b91a38cb6ca147f6a6ce6f7a05e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilles Van Hooff", "link": "https://stackoverflow.com/users/4490111/gilles-van-hooff"}, "edited": false, "score": 0, "creation_date": 1471383775, "post_id": 38984878, "comment_id": 65322619, "body": "Okay cool so I get why 3 is false and it prints out 2. But why does it also print 1 and 0 after that?"}, {"owner": {"reputation": 7495, "user_id": 3435918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45448e95e672d9eab19df38e4cc4a6fc?s=128&d=identicon&r=PG&f=1", "display_name": "CMPS", "link": "https://stackoverflow.com/users/3435918/cmps"}, "reply_to_user": {"reputation": 69, "user_id": 4490111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b946b91a38cb6ca147f6a6ce6f7a05e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilles Van Hooff", "link": "https://stackoverflow.com/users/4490111/gilles-van-hooff"}, "edited": false, "score": 1, "creation_date": 1471383900, "post_id": 38984878, "comment_id": 65322664, "body": "When you call a function (B) inside another one (A), you do not interrupt the function (A), you stack it and return to it once the called function (B) finishes"}, {"owner": {"reputation": 69, "user_id": 4490111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b946b91a38cb6ca147f6a6ce6f7a05e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilles Van Hooff", "link": "https://stackoverflow.com/users/4490111/gilles-van-hooff"}, "edited": false, "score": 0, "creation_date": 1471384150, "post_id": 38984878, "comment_id": 65322756, "body": "Wow thanks, I never thought of that. This cleared things up a lot."}, {"owner": {"reputation": 7495, "user_id": 3435918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45448e95e672d9eab19df38e4cc4a6fc?s=128&d=identicon&r=PG&f=1", "display_name": "CMPS", "link": "https://stackoverflow.com/users/3435918/cmps"}, "reply_to_user": {"reputation": 69, "user_id": 4490111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b946b91a38cb6ca147f6a6ce6f7a05e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilles Van Hooff", "link": "https://stackoverflow.com/users/4490111/gilles-van-hooff"}, "edited": false, "score": 0, "creation_date": 1471384281, "post_id": 38984878, "comment_id": 65322814, "body": "I am happy my post helped you :) @GillesVanHooff"}], "tags": [], "owner": {"reputation": 7495, "user_id": 3435918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45448e95e672d9eab19df38e4cc4a6fc?s=128&d=identicon&r=PG&f=1", "display_name": "CMPS", "link": "https://stackoverflow.com/users/3435918/cmps"}, "is_accepted": true, "score": 11, "last_activity_date": 1471383472, "creation_date": 1471383472, "answer_id": 38984878, "question_id": 38984777, "link": "https://stackoverflow.com/questions/38984777/recursion-dont-understand-this-result/38984878#38984878", "title": "Recursion: don&#39;t understand this result", "body": "<p>Here's a stack trace</p>\n\n<pre><code>f(0)\n    print 0\n    f(1)\n        print 1\n        f(2)\n            print 2\n            f(3)  // 3 &lt; 3 == false\n            print 2\n         print 1\n     print 0\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 4490111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b946b91a38cb6ca147f6a6ce6f7a05e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilles Van Hooff", "link": "https://stackoverflow.com/users/4490111/gilles-van-hooff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 1, "accepted_answer_id": 38984878, "answer_count": 1, "score": 4, "last_activity_date": 1471383472, "creation_date": 1471382932, "last_edit_date": 1471383290, "question_id": 38984777, "link": "https://stackoverflow.com/questions/38984777/recursion-dont-understand-this-result", "title": "Recursion: don&#39;t understand this result", "body": "<pre><code>void func(int num){\n    if(num&lt; 3){\n        printf(\"%d \", num);\n        func(num+ 1);\n        printf(\"%d \", num);\n    }\n}\n</code></pre>\n\n<p>Suppose I call this function with func(0).\nWhy is the result 0 1 2 2 1 0 ? \nI don't know why it's decreasing.</p>\n"}, {"tags": ["c", "stream", "stdin"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 3, "creation_date": 1471382263, "post_id": 38984565, "comment_id": 65321977, "body": "we&#39;d have to see some code sample where you call the library."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1471383199, "post_id": 38984565, "comment_id": 65322361, "body": "You can read the while input into a file, and then pass that file into the library."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 2, "creation_date": 1471383332, "post_id": 38984565, "comment_id": 65322430, "body": "Can you be more specific about what you mean by <i>pure C</i>? C doesn&#39;t have a notion of pipeline. Instead, you can write to a temporary file the transformed input, and then provide that temporary file as input to your library. (Ok, what @2501 said...)"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 2, "creation_date": 1471383425, "post_id": 38984565, "comment_id": 65322457, "body": "Otherwise, you can use POSIX or other system specific constructs to allow a separate process perform then transformation while the library reads the transformed output concurrently."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1471388414, "post_id": 38984565, "comment_id": 65324201, "body": "I agree with @jxh: I don&#39;t think you can do it using &#39;pure C&#39; as defined in the C11 standard without using a separate pass over the data \u2014 effectively reading from the original input and writing to a file, and then passing that file to the library function.  If you can use POSIX, then you have options \u2014 your mapping code could be run in a separate process with pipes, for example, or perhaps in a separate thread.  Make sure you know what you&#39;ll do with CRLF line endings.  Taken at face value, you&#39;d add a semicolon before the CR and another before the LF, but that might not be the best choice."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1471388766, "post_id": 38984565, "comment_id": 65324309, "body": "If the library works on a pipe (and it probably does), just create a pipe, use <code>fdopen</code> to create a FILE * and feed the transformed data into the pipe.  This is not &quot;pure C&quot;, but is probably what you&#39;re looking for.  I don&#39;t understand why you say &quot;as some kind of pipeline&quot; is equivalent to &quot;copying the whole file into memory at once&quot;; they are completely different, and using a pipe will certainly not copy the whole file into memory. (Unless the file is small enough to fit into the pipe, but if that&#39;s the case it&#39;s kind of irrelevant.)"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1471392145, "post_id": 38984565, "comment_id": 65325126, "body": "@WilliamPursell: The library is probably making blocking I/O calls, and so the main process will not get a chance to write into the pipe when the library call is blocked. This is why concurrency is likely needed with a pipe solution. C does not define an asynchronous mode of operation for FILE operations."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1471394022, "post_id": 38984565, "comment_id": 65325528, "body": "I should explicitly state that the data should be fed into the pipe by a child, not from the main process.  Yes, concurrency is almost certainly needed."}], "owner": {"reputation": 1672, "user_id": 1115876, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dee3033759b820a3df9f7437d3a9fe31?s=128&d=identicon&r=PG", "display_name": "QuinnFreedman", "link": "https://stackoverflow.com/users/1115876/quinnfreedman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1471391210, "creation_date": 1471381869, "last_edit_date": 1471391210, "question_id": 38984565, "link": "https://stackoverflow.com/questions/38984565/c-filter-file-input-stream", "title": "C filter file input stream", "body": "<p>I'm using a third party library in C that takes <code>FILE *</code> as a data source and does some processing on the text.</p>\n\n<p>Right now, I just pass <code>stdin</code> or <code>fopen</code> a file and pass that.</p>\n\n<p>But, I want to do some filtering before the library sees the text. (Specifically, I want to insert a semicolon <code>;</code> before each new line character <code>\\n</code> or <code>\\r</code>.)</p>\n\n<p>What's the best way to do this in pure C (not C++) without copying the whole file into memory at once (i.e. as some kind of pipeline)?</p>\n\n<p>This is how I call the library</p>\n\n<pre><code>mpc_result_t r;\nFILE *f = NULL;\nif (argc &gt; 1) {\n    f = fopen(argv[1], \"rb\");\n} else {\n    f = stdin;\n}\nif (!f) return;\n\nif (mpc_parse_pipe(\"test\", f, test, &amp;r)) {\n    mpc_ast_print(r.output);\n    mpc_ast_delete(r.output);\n} else {\n    mpc_err_print(r.error);\n    mpc_err_delete(r.error);\n}\nfclose(f);\n</code></pre>\n"}, {"tags": ["c", "gcc", "osdev"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1471388642, "post_id": 38984520, "comment_id": 65324268, "body": "Please provide a reference to the gcc documentation about <code>&amp;&amp;</code> and state what it does in your understanding. It does not warn when using extensions. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and provide all required information."}, {"owner": {"reputation": 83, "user_id": 5767244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3716c10a23157474e32dec4b2e0894f?s=128&d=identicon&r=PG&f=1", "display_name": "Aerath", "link": "https://stackoverflow.com/users/5767244/aerath"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471389642, "post_id": 38984520, "comment_id": 65324550, "body": "Edited, and @Olaf, gcc warns about non-standard code with <code>-Wpedantic</code> option. Thanks for your advices."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471390284, "post_id": 38984520, "comment_id": 65324707, "body": "Aha, I see. Using <code>-Wpedantic</code> with extensions sound like a bad idea. Anyway, your cast is implementation defined and an <code>uint32_t</code> is not rquired to hold a pointer, nor there is a 1:1 assignment. On a 64 bit system you are busted already. Use the correct types at least. Any reason you don&#39;t use a <code>void *</code> as a pointer, but an integer?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1471390408, "post_id": 38984520, "comment_id": 65324732, "body": "As a personal opinion: I don&#39;t see any sense in that code. You probably have an XY-problem."}, {"owner": {"reputation": 83, "user_id": 5767244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3716c10a23157474e32dec4b2e0894f?s=128&d=identicon&r=PG&f=1", "display_name": "Aerath", "link": "https://stackoverflow.com/users/5767244/aerath"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471430914, "post_id": 38984520, "comment_id": 65340771, "body": "@Olaf, I don&#39;t think I have an XY problem and anyway, I&#39;m working on an OS to learn about the insides of OS, compilers, and hardware interaction. My goal is not to make a good OS but getting errors to learn from on the way. I encountered a behavior which I was not expecting to and so I want to understand what&#39;s going on. You can see my real question as <i>why GCC is not giving me what it is supposed to</i> (from my understanding). This post is not about <i>how should I write a fork() implementation</i> but <i>how can I get the address of a label with GCC&#39;s label as values extension</i>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471434322, "post_id": 38984520, "comment_id": 65343039, "body": "A dissection is not a good way to understand what a frog thinks. How about reading a book about compiler construction, etc.? Sometimes the old fashioned way is still the best. There is no use in the code above with modern compilers, even for learning. And trial&amp;error in C is a very bad idea."}, {"owner": {"reputation": 83, "user_id": 5767244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3716c10a23157474e32dec4b2e0894f?s=128&d=identicon&r=PG&f=1", "display_name": "Aerath", "link": "https://stackoverflow.com/users/5767244/aerath"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471473941, "post_id": 38984520, "comment_id": 65366472, "body": "I think I may not have been clear on what precisely I&#39;m looking for. I&#39;m not talking about trial&amp;error but that errors are an unavoidable part of programming from which you need to learn, to fix it and improve your skills. And I&#39;m (at least not currently) looking for learning about how compilers work but understanding how labels as values works. I have implemented my fork() in a few different ways but since I came across this extension from GCC without successfully using it, I want to understand why it doesn&#39;t do what, from the documentation, I thought it would."}, {"owner": {"reputation": 2473, "user_id": 4683460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24dafd813f96fc34b9b3f7c0455f9011?s=128&d=identicon&r=PG", "display_name": "Joel C", "link": "https://stackoverflow.com/users/4683460/joel-c"}, "edited": false, "score": 0, "creation_date": 1471503261, "post_id": 38984520, "comment_id": 65374574, "body": "Try removing the &#39;__ label__&#39; line. Looking over the local label docs, when referencing the label as a value it does not use this construct. Cannot currently test as I&#39;m not at a computer."}, {"owner": {"reputation": 3837, "user_id": 1749713, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/PqPOy.png?s=128&g=1", "display_name": "Micha\u0142 Walenciak", "link": "https://stackoverflow.com/users/1749713/micha%c5%82-walenciak"}, "edited": false, "score": 2, "creation_date": 1471509147, "post_id": 38984520, "comment_id": 65377677, "body": "Just use assembly."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5767244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3716c10a23157474e32dec4b2e0894f?s=128&d=identicon&r=PG&f=1", "display_name": "Aerath", "link": "https://stackoverflow.com/users/5767244/aerath"}, "edited": false, "score": 0, "creation_date": 1471602861, "post_id": 39030900, "comment_id": 65423167, "body": "Since the caller process is not expected to reach this label, I had to use a never-true if to trick GCC and make it seen as reachable even if it is not. Anyway thank you very much @joel-c"}], "tags": [], "owner": {"reputation": 2473, "user_id": 4683460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24dafd813f96fc34b9b3f7c0455f9011?s=128&d=identicon&r=PG", "display_name": "Joel C", "link": "https://stackoverflow.com/users/4683460/joel-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1471579198, "creation_date": 1471579198, "answer_id": 39030900, "question_id": 38984520, "link": "https://stackoverflow.com/questions/38984520/gcc-label-address-return-current-eip-rather-than-real-label-address/39030900#39030900", "title": "GCC - Label address return current EIP rather than real label address", "body": "<p>It appears that the compiler is optimizing out the label entirely as no code path ever leads to it. I have confirmed that moving the label to before the <code>return</code> statement and ensuring that there is actual code in-between the assignment and the label results in what I believe is your desired behaviour. Here is the code I put together to test:</p>\n\n<pre><code>void *fork(void) {\n  __label__ fork_end;\n  void *test = &amp;&amp;fork_end;\n\n  test++;\n\n  fork_end:\n  return test;\n}\n</code></pre>\n\n<p>Based on this, I would expect that you can indeed get what you want by re-working your code path slightly to ensure that the label point is reachable by any code path.</p>\n"}], "owner": {"reputation": 83, "user_id": 5767244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3716c10a23157474e32dec4b2e0894f?s=128&d=identicon&r=PG&f=1", "display_name": "Aerath", "link": "https://stackoverflow.com/users/5767244/aerath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 2, "accepted_answer_id": 39030900, "answer_count": 1, "score": 8, "last_activity_date": 1471579198, "creation_date": 1471381663, "last_edit_date": 1471508521, "question_id": 38984520, "link": "https://stackoverflow.com/questions/38984520/gcc-label-address-return-current-eip-rather-than-real-label-address", "title": "GCC - Label address return current EIP rather than real label address", "body": "<p>In an attempt to write an OS, I need to get the address of the current function's end (right before epilogue) for task switching.<br>\nConcretely my problem is to get an EIP to assign to my newly created task (process) inside the copied stack. I have already managed to save/restore registers for a process, but I need to find what value the child process will have in it's EIP.</p>\n\n<p>I used GCC's extensions to C standard : <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Labels-as-Values.html\" rel=\"nofollow\">Labels as Values</a> and <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Local-Labels.html\" rel=\"nofollow\">Local Labels</a><br>\nFrom the documentation : <em>You can get the address of a label defined in the current function (or a containing function) with the unary operator \u2018&amp;&amp;\u2019. The value has type void *.</em><br>\nand : <em>GCC allows you to declare local labels in any nested block scope. A local label is just like an ordinary label, but you can only reference it (with a goto statement, or by taking its address) within the block in which it is declared.</em></p>\n\n<pre><code>pid_t fork(void)\n{\n    __label__ fork_end;\n    ...\n    task-&gt;regs.eip = (uintptr_t)&amp;&amp;fork_end;\n    ...\n    return task-&gt;pid;\n    fork_end:;\n}\n</code></pre>\n\n<p>GCC does compile it, with just warnings about non-standard code.<br>\nHowever when disassembled, gdb shows :</p>\n\n<pre><code>    task-&gt;regs.eip = (uintptr_t)&amp;&amp;fork_end;\n0x00105008 &lt;+87&gt;:   mov    $0x105008,%edx\n0x0010500d &lt;+92&gt;:   mov    -0xc(%ebp),%eax\n0x00105010 &lt;+95&gt;:   mov    %edx,0x40(%eax)\n...\n    fork_end:;\n    }\n0x00105096 &lt;+229&gt;:  leave  \n0x00105097 &lt;+230&gt;:  ret \n</code></pre>\n\n<p>I expect <code>task-&gt;regs.eip = (uintptr_t)&amp;&amp;fork_endl</code> to save<code>0x00105096</code> rather than <code>0x00105008</code>.<br>\n<code>CFLAGS</code> are <code>-O0 -std=gnu99 -fgnu89-inline -DDEBUG -ggdb3 -ffreestanding -fbuiltin</code> (warnings related options not shown here).</p>\n\n<p>Commenting <code>__label__ fork_end;</code> changes nothing.</p>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 3270, "user_id": 3059385, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dc876278926d67b3da29594601fdc82a?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Schneider", "link": "https://stackoverflow.com/users/3059385/christopher-schneider"}, "edited": false, "score": 2, "creation_date": 1471380753, "post_id": 38984201, "comment_id": 65321256, "body": "You are trying to return a stack variable as a pointer in your initialization code. You should use malloc."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 3270, "user_id": 3059385, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dc876278926d67b3da29594601fdc82a?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Schneider", "link": "https://stackoverflow.com/users/3059385/christopher-schneider"}, "edited": false, "score": 0, "creation_date": 1471380986, "post_id": 38984201, "comment_id": 65321367, "body": "@ChristopherSchneider: There is no stack in the C language. <code>table</code> is an automatic variable. But yes, the variable is out-of-life after return, thus any access is UB. This is not the reason for the compiler error, though."}, {"owner": {"reputation": 3270, "user_id": 3059385, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dc876278926d67b3da29594601fdc82a?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Schneider", "link": "https://stackoverflow.com/users/3059385/christopher-schneider"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471383779, "post_id": 38984201, "comment_id": 65322624, "body": "@Olaf Where can I read about that? This is the first time I&#39;ve heard that."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 3270, "user_id": 3059385, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dc876278926d67b3da29594601fdc82a?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Schneider", "link": "https://stackoverflow.com/users/3059385/christopher-schneider"}, "edited": false, "score": 0, "creation_date": 1471385937, "post_id": 38984201, "comment_id": 65323429, "body": "@ChristopherSchneider: How about the C standard? Which would be ISO9899:2011, nothing else (just pick the final draft n1570, the standard itself is not avail for free, but the draft is identical in all relevant aspects)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471388474, "post_id": 38984201, "comment_id": 65324219, "body": "@Olaf &quot;stack&quot; is common jargon for automatic storage"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1471388771, "post_id": 38984201, "comment_id": 65324312, "body": "@M.M: It is a wrong assumption, though and missleading. <code>auto</code> or &quot;automatic&quot; variable is not really more to type. A modern compiler and ABI has just too much optimisations it is safe to assume even <code>struct</code>s are always stored on the stack. See AAPCS for an example (passing of small <code>struct</code>s)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471389160, "post_id": 38984201, "comment_id": 65324423, "body": "@Olaf it&#39;s not any assumption, it&#39;s just a word. Like how we still use floppy disk icons for &quot;save&quot; buttons"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1471389439, "post_id": 38984201, "comment_id": 65324506, "body": "@M.M: No, it is a problematic missconception. See other questions here which result from this missconception. At least trying to be precise is vital in programming. And if not, a correction should be appreciated and memorised. (And although I fight to the bone for my opinion, I&#39;m very well open to well founded arguments - you should know what I mean)"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1471389913, "last_edit_date": 1471389913, "creation_date": 1471380720, "answer_id": 38984266, "question_id": 38984201, "link": "https://stackoverflow.com/questions/38984201/how-can-i-initialize-an-array-of-a-struct-inside-another-struct/38984266#38984266", "title": "How can I initialize an array of a struct inside another struct?", "body": "<p>This won't work for a number of reasons.</p>\n\n<p>First, an array is not an assignable lvalue.  That means it can't appear on the left side of an assignment as you're attempting to do.</p>\n\n<p>Note that initializing (which occurs at the time a variable is defined) is not the same as assigning.  For example, you can do this:</p>\n\n<pre><code>int a[3] = { 3, 4, 5 };\n</code></pre>\n\n<p>But not this:</p>\n\n<pre><code>int a[3] = { 3, 4, 5 };\nint b[3];\nb = a;\n</code></pre>\n\n<p>You're also returning a <code>fifoTable</code> from your function while it's declared to return a <code>fifoTable *</code>.</p>\n\n<p>What you probably want is to dynamically allocate memory for your struct, zero it out, and return the pointer.  You do that as follows:</p>\n\n<pre><code>fifoTable *initFifo(){\n    fifoTable *retval = calloc(1, sizeof(fifoTable));\n    if (!retval) {\n        perror(\"calloc failed\");\n        exit(1);\n    }\n    return retval;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1471381193, "post_id": 38984277, "comment_id": 65321468, "body": "Why not set member data directly?"}], "tags": [], "owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "is_accepted": false, "score": 1, "last_activity_date": 1471380753, "creation_date": 1471380753, "answer_id": 38984277, "question_id": 38984201, "link": "https://stackoverflow.com/questions/38984201/how-can-i-initialize-an-array-of-a-struct-inside-another-struct/38984277#38984277", "title": "How can I initialize an array of a struct inside another struct?", "body": "<p>You declare \"data\" and \"table\" on stack and return a pointer to it but the scope of those declarations end at function so the pointers are invalid.</p>\n\n<p>If you want to return \"fifoTable\" then use malloc to allocate storage and return a pointer to that e.g.</p>\n\n<pre><code>fifoTable *initFifo(){\n    fifoTable* table = malloc(sizeof(fifoTable));\n    table-&gt;start = 0;\n    table-&gt;start = 0;\n    dataType data[N];\n    /* initialize data somehow */\n    memcpy(table.data, data, sizeof(table.data));\n    return table;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1471388751, "last_edit_date": 1471388751, "creation_date": 1471384445, "answer_id": 38985082, "question_id": 38984201, "link": "https://stackoverflow.com/questions/38984201/how-can-i-initialize-an-array-of-a-struct-inside-another-struct/38985082#38985082", "title": "How can I initialize an array of a struct inside another struct?", "body": "<p><strong>Problem 1</strong></p>\n\n<blockquote>\n  <p>the problem ...  \"assignment to expression with array type\".</p>\n</blockquote>\n\n<pre><code>table.data = data;\n</code></pre>\n\n<blockquote>\n  <p>I figured it is not possible to initialize an array inside a struct like this.</p>\n</blockquote>\n\n<p>Code is not <em>initializing</em> an array.  Code is attempting to do an <em>assignment</em>.</p>\n\n<p>To copy the contents of an array to another array, use <code>memcpy()</code></p>\n\n<pre><code>memcpy(table.data, data, sizeof table.data);`\n</code></pre>\n\n<p><strong>Problem 2</strong></p>\n\n<p>Function return type is a pointer: <code>fifoTable *</code>, yet code attempts to return a structure: <code>fifoTable</code></p>\n\n<pre><code>fifoTable *initFifo(void){\n    fifoTable table;\n    ...\n    return table;\n}\n</code></pre>\n\n<p>To return a structure (to return a pointer is more common), declare the return type to match</p>\n\n<pre><code>fifoTable initFifo(void){\n    fifoTable table;\n    ...\n    return table;\n}\n</code></pre>\n\n<p>To return a pointer, return a pointer to valid memroy, perhaps by allocating it.</p>\n\n<pre><code>fifoTable *initFifo(void) {\n  return calloc(1, sizeof(fifoTable));\n}\n</code></pre>\n\n<p><strong>Problem 3 (title question)</strong></p>\n\n<blockquote>\n  <p>How can I initialize an array of a struct inside another struct?</p>\n</blockquote>\n\n<p>One element at a time.</p>\n\n<pre><code>#define N 4\n\nfifoTable initFifo(void) {\n  dataType data[N];\n  fifoTable table = { 0, 0, {data[0], data[1], data[2], data[3]}  };\n  return table;\n}\n</code></pre>\n"}], "owner": {"reputation": 308, "user_id": 6718468, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/10210189344953073/picture?type=large", "display_name": "Arnaud Rochez", "link": "https://stackoverflow.com/users/6718468/arnaud-rochez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1229, "favorite_count": 0, "closed_date": 1471670719, "accepted_answer_id": 38984266, "answer_count": 3, "score": -2, "last_activity_date": 1471389913, "creation_date": 1471380462, "question_id": 38984201, "link": "https://stackoverflow.com/questions/38984201/how-can-i-initialize-an-array-of-a-struct-inside-another-struct", "closed_reason": "Not suitable for this site", "title": "How can I initialize an array of a struct inside another struct?", "body": "<p>so I got the following structs:</p>\n\n<pre><code>typedef struct typeData{ \n    char name[20]; \n    double weightIn; \n    double weightOut; \n}dataType;\n\ntypedef struct fifoTable{ \n     unsigned short int start; \n     unsigned short int end; \n     dataType data[N]; \n} fifoTable; \n</code></pre>\n\n<p>and the following function that is supposed to initialize the structure: </p>\n\n<pre><code>fifoTable *initFifo(){\n    fifoTable table;\n    table.start = 0;\n    table.start = 0;\n    dataType data[N];\n    table.data = data;\n    return table;\n}\n</code></pre>\n\n<p>The problem I encounter is that I get an error message saying: \"assignment to expression with array type\". I looked it up so I figured it is not possible to initialize an array inside a struct like this. I found some examples with arrays of char, int etc. But since there are other elements inside the dataType struct, I can't find a way to initialize this table :/ How could I do this?</p>\n\n<p>Thanks for your answers.</p>\n"}, {"tags": ["c", "arrays", "function"], "comments": [{"owner": {"reputation": 170, "user_id": 5892926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db427d11035a6cb73ba10186cef6564?s=128&d=identicon&r=PG&f=1", "display_name": "penalosa", "link": "https://stackoverflow.com/users/5892926/penalosa"}, "edited": false, "score": 0, "creation_date": 1471377127, "post_id": 38983300, "comment_id": 65319508, "body": "@chux Thanks, that was a typo. The problem still stands, though."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 1, "creation_date": 1471377178, "post_id": 38983300, "comment_id": 65319533, "body": "what is wrong with what you are doing? global variable is the name of the game."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1471377198, "post_id": 38983300, "comment_id": 65319542, "body": "Code all ready does what you want - what is the <i>unresolved</i> issue?"}, {"owner": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "edited": false, "score": 2, "creation_date": 1471377216, "post_id": 38983300, "comment_id": 65319555, "body": "But make it <code>volatile</code> if you are modifying it from an ISR"}, {"owner": {"reputation": 2133, "user_id": 5447208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f8eb976d91e3b7bb21366a68d1a70f?s=128&d=identicon&r=PG&f=1", "display_name": "Cody", "link": "https://stackoverflow.com/users/5447208/cody"}, "edited": false, "score": 0, "creation_date": 1471377264, "post_id": 38983300, "comment_id": 65319573, "body": "I just ran that example, it does what you want.  What is your question?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "edited": false, "score": 1, "creation_date": 1471377328, "post_id": 38983300, "comment_id": 65319611, "body": "@kdopen is on the right track. OP: Suggest rather than talking about an ISR, add it to the post.  If <code>foo()</code> is the ISR, suggest <code>ISR_foo()</code> for clarity, and show how <i>other</i> code accesses <code>a[]</code>."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1471377603, "post_id": 38983300, "comment_id": 65319744, "body": "Compiling it and running it should make it work."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "edited": false, "score": 0, "creation_date": 1471379816, "post_id": 38983300, "comment_id": 65320790, "body": "@kdopen: `volatile might be insufficient for concurrent systems. Depending on the system, OP has to use atomics."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471379903, "post_id": 38983300, "comment_id": 65320838, "body": "<code>foo()</code> is a strongly deprecasted signature and marked for removal from the standard. Use a correct prototype-style declarator. It is also plain wrong if you don&#39;t intend to return an <code>int</code> result."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1471380253, "post_id": 38983300, "comment_id": 65321006, "body": "&quot;deprecasted&quot; -&gt; &quot;deprecated&quot; (who inserted the <code>s</code>?)"}, {"owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "edited": false, "score": 0, "creation_date": 1471381789, "post_id": 38983300, "comment_id": 65321764, "body": "<code>void main()</code> is not standard"}], "answers": [{"comments": [{"owner": {"reputation": 432, "user_id": 6542561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uEiJr.png?s=128&g=1", "display_name": "Bruce David Wilner", "link": "https://stackoverflow.com/users/6542561/bruce-david-wilner"}, "edited": false, "score": 1, "creation_date": 1471377515, "post_id": 38983379, "comment_id": 65319701, "body": "You tell him, chqrlie.  Top-notch programmers afoot."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471380065, "post_id": 38983379, "comment_id": 65320919, "body": "<code>volatile</code> does not guarantee atomic access. Without further measures this still might produce invalid results. Worse: those possibly occur only once in a while, dependening on internal timing. Use <code>stdatomic</code> or ensure otherwise correct reads &amp; writes."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471381801, "post_id": 38983379, "comment_id": 65321771, "body": "@Olaf: I&#39;m afraid the whole chapter about <code>stdatomic.h</code> is among the most obscure parts of the C Standard, far more abstruse than discussions on <code>restrict</code> or <i>effective type</i>... I doubt the skill level of the OP is compatible with anything more than <code>volatile</code> at this point. Hopefully the microcontroller can access an <code>int</code> atomically, otherwise making this an array of <code>char</code> should solve the problem. We are talking about an ISR on a microcontroller, not multiple treads running on multiple cores with out of order memory accesses."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471382759, "post_id": 38983379, "comment_id": 65322186, "body": "@chqrlie: So just because OP cannot understand atomics, he should use a potentially wrong approach which can result in very subtle and pretty hard to debug - even for an experienced developer - faults? Well, the obvious alternative is to lock interrupts (or the one for the handler) around any access. We don&#39;t know how many cores the target has, but if there is only one, it should work (if the intrinsics imply memory barriers). Otherwise he ist lost."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 3, "last_activity_date": 1471384389, "last_edit_date": 1471384389, "creation_date": 1471377301, "answer_id": 38983379, "question_id": 38983300, "link": "https://stackoverflow.com/questions/38983300/editing-a-c-array-from-within-a-function/38983379#38983379", "title": "Editing a C array from within a function", "body": "<p>If the global array <code>a</code> is modified in an interrupt control routine, you should define it as:</p>\n\n<pre><code>volatile int a[5];\n</code></pre>\n\n<p><code>volatile</code> tells the compiler that the array elements can change asynchronously while the program is executing, for example because they can be modified by an interrupt service routine, or because the memory location is a hardware register whose value can change upon some external event.  Accesses to such variables must always generate code that reads or write the variable as specified in the code, unlike regular variables for which the compiler can often make valid assumptions about their value if have not been modified since last written to.</p>\n\n<p>Furthermore, it is not recommended to use such short meaningless names for global variables.</p>\n\n<p>Also note that your prototypes for <code>foo</code> and <code>main</code> are incorrect.  They should be defined as:</p>\n\n<pre><code>void foo(void) {\n    a[1] = 7;\n}\nint main(void) {\n    foo();\n    // At this point, I want the value in a[1] to be equal to 7\n    // ...more code\n}\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 5892926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db427d11035a6cb73ba10186cef6564?s=128&d=identicon&r=PG&f=1", "display_name": "penalosa", "link": "https://stackoverflow.com/users/5892926/penalosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "closed_date": 1471395289, "answer_count": 1, "score": -3, "last_activity_date": 1471384389, "creation_date": 1471376960, "last_edit_date": 1471377087, "question_id": 38983300, "link": "https://stackoverflow.com/questions/38983300/editing-a-c-array-from-within-a-function", "closed_reason": "Needs details or clarity", "title": "Editing a C array from within a function", "body": "<p>I am trying to do this:</p>\n\n<pre><code>int a[5];\nfoo(){\n    a[1]=7;\n}\nvoid main(){\n    foo();\n    //At this point, I want the value in a[1] to be equal to 7\n}\n</code></pre>\n\n<p>Is there some way of making this work in C without passing <code>a</code> to the function <code>foo</code>, which is not possible in my application (interrupt handler on a microcontroller).</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1471377004, "post_id": 38983284, "comment_id": 65319413, "body": "<code>lvalue</code> is something that can be assigned to. <code>rvalue</code> is something that can be assigned."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1471377042, "post_id": 38983284, "comment_id": 65319438, "body": "Not sure if this is too broad to be a duplicate, but you can probably find the answer here: <a href=\"http://stackoverflow.com/questions/3601602/what-are-rvalues-lvalues-xvalues-glvalues-and-prvalues\" title=\"what are rvalues lvalues xvalues glvalues and prvalues\">stackoverflow.com/questions/3601602/&hellip;</a>"}, {"owner": {"reputation": 10703, "user_id": 3134621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c46cfe9f917da02becc991d76352d77c?s=128&d=identicon&r=PG&f=1", "display_name": "deviantfan", "link": "https://stackoverflow.com/users/3134621/deviantfan"}, "edited": false, "score": 0, "creation_date": 1471377057, "post_id": 38983284, "comment_id": 65319450, "body": "To take <code>int i=5;</code> as example: <code>i</code> is an lvalue, because it can stand left of <code>=</code>. 5 is not an lvalue, so you can&#39;t write <code>5 = i;</code> (and there are prvalue, xvalues, etc.etc.)"}, {"owner": {"reputation": 96886, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 2, "creation_date": 1471377066, "post_id": 38983284, "comment_id": 65319462, "body": "Parentheses <a href=\"https://stackoverflow.com/questions/22817517/do-parentheses-force-order-of-evaluation-and-make-an-undefined-expression-define\">do not add sequence points</a> so your code exhibits <a href=\"https://stackoverflow.com/questions/4176328/undefined-behavior-and-sequence-points\">undefined behavior</a>, so even if it compiled the runtime behavior is indeterminate and your program is ill-formed."}, {"owner": {"reputation": 2445, "user_id": 4390699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4fe7d756a92a20b8b49b05cc0f1bb628?s=128&d=identicon&r=PG", "display_name": "Raman", "link": "https://stackoverflow.com/users/4390699/raman"}, "edited": false, "score": 0, "creation_date": 1471377194, "post_id": 38983284, "comment_id": 65319538, "body": "I&#39;ve already read that link before asking here. But I still don&#39;t understand when one says &quot;pre increment returns rvalue in c&quot;. I also don&#39;t understand how it affects my expression here."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1471377211, "post_id": 38983284, "comment_id": 65319551, "body": "@EugeneSh., To make that more confusing: <a href=\"http://coliru.stacked-crooked.com/a/0c9726f00d2d3ec5\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/0c9726f00d2d3ec5</a> The result of calling the function is an rvalue (a prvalue), yet it can still be assigned to."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1471377316, "post_id": 38983284, "comment_id": 65319604, "body": "@ARBY Well, usually you can&#39;t modify an rvalue."}, {"owner": {"reputation": 18687, "user_id": 3552770, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b0404d5b5bd565aa720c6b3d190716b3?s=128&d=identicon&r=PG", "display_name": "LogicStuff", "link": "https://stackoverflow.com/users/3552770/logicstuff"}, "reply_to_user": {"reputation": 96886, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1471377427, "post_id": 38983284, "comment_id": 65319654, "body": "@CoryKramer I believe <code>(++(++i))</code> is not that case."}, {"owner": {"reputation": 2445, "user_id": 4390699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4fe7d756a92a20b8b49b05cc0f1bb628?s=128&d=identicon&r=PG", "display_name": "Raman", "link": "https://stackoverflow.com/users/4390699/raman"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1471377500, "post_id": 38983284, "comment_id": 65319688, "body": "@juanchopanza Ok. Now what it means when we say &quot;pre increment and post increment both returns rvalue in C&quot;."}, {"owner": {"reputation": 91345, "user_id": 481267, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/DMvoo.png?s=128&g=1", "display_name": "Brian Bi", "link": "https://stackoverflow.com/users/481267/brian-bi"}, "reply_to_user": {"reputation": 96886, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1471377555, "post_id": 38983284, "comment_id": 65319714, "body": "@CoryKramer It&#39;s well-defined in C++11, and it would be in C11 too if ++i were hypothetically an lvalue in C."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1471377588, "post_id": 38983284, "comment_id": 65319736, "body": "@ARBY It means exactly that. Which part don&#39;t you understand? <code>++i</code> is an rvalue in C, so you can&#39;t apply <code>++</code> to it."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 96886, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1471377631, "post_id": 38983284, "comment_id": 65319760, "body": "@CoryKramer What about <code>(++(++i));</code> is UB?"}, {"owner": {"reputation": 2445, "user_id": 4390699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4fe7d756a92a20b8b49b05cc0f1bb628?s=128&d=identicon&r=PG", "display_name": "Raman", "link": "https://stackoverflow.com/users/4390699/raman"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1471377701, "post_id": 38983284, "comment_id": 65319794, "body": "@juanchopanza how can ++i return a rvalue? what is the rvalue here? what is the lvalue here?"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1471377756, "post_id": 38983284, "comment_id": 65319821, "body": "@ARBY &quot;returning&quot; is probably the wrong terminology. The expressions <code>++i</code> and <code>i++</code> are rvalues in C. That is specified by the language so that&#39;s that."}, {"owner": {"reputation": 2445, "user_id": 4390699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4fe7d756a92a20b8b49b05cc0f1bb628?s=128&d=identicon&r=PG", "display_name": "Raman", "link": "https://stackoverflow.com/users/4390699/raman"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1471377917, "post_id": 38983284, "comment_id": 65319894, "body": "@juanchopanza but if rvalue exists, lvalue must also exist and an <code>=</code>  sign must exist in between by definition of rvalue and lvalue. There is no assignment operation here."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 2, "creation_date": 1471377942, "post_id": 38983284, "comment_id": 65319905, "body": "@ARBY <code>5</code> is an rvalue. Where is the lvalue?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1471377975, "post_id": 38983284, "comment_id": 65319928, "body": "@ARBY The = is just a test, there doesn&#39;t have to be one.  A lvalue is something that can be assigned to.  A rvalue is something that cannot."}, {"owner": {"reputation": 2445, "user_id": 4390699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4fe7d756a92a20b8b49b05cc0f1bb628?s=128&d=identicon&r=PG", "display_name": "Raman", "link": "https://stackoverflow.com/users/4390699/raman"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1471378181, "post_id": 38983284, "comment_id": 65320022, "body": "@NathanOliver Oh I get the idea now. Thank you NathanOliver and juanchopanza."}, {"owner": {"reputation": 432, "user_id": 6542561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uEiJr.png?s=128&g=1", "display_name": "Bruce David Wilner", "link": "https://stackoverflow.com/users/6542561/bruce-david-wilner"}, "edited": false, "score": 0, "creation_date": 1471378427, "post_id": 38983284, "comment_id": 65320123, "body": "++(++i) compiled, you claim?"}, {"owner": {"reputation": 2445, "user_id": 4390699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4fe7d756a92a20b8b49b05cc0f1bb628?s=128&d=identicon&r=PG", "display_name": "Raman", "link": "https://stackoverflow.com/users/4390699/raman"}, "reply_to_user": {"reputation": 432, "user_id": 6542561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uEiJr.png?s=128&g=1", "display_name": "Bruce David Wilner", "link": "https://stackoverflow.com/users/6542561/bruce-david-wilner"}, "edited": false, "score": 0, "creation_date": 1471378471, "post_id": 38983284, "comment_id": 65320149, "body": "@BruceDavidWilner yes in c++ and no in c."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1471379560, "post_id": 38983284, "comment_id": 65320672, "body": "&quot;This program compiles fine in c++ but not in c&quot; - Why do you expect <b>different</b> languages behave the same? For instance, there is no &quot;rvalue&quot; in the C standard. It explicitly uses a different term, which should be more clear to you. See footnote 64 in the standard."}], "answers": [{"tags": [], "owner": {"reputation": 526, "user_id": 6655392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60df9610a4f28d142c0669d8b1dafe65?s=128&d=identicon&r=PG&f=1", "display_name": "flu", "link": "https://stackoverflow.com/users/6655392/flu"}, "is_accepted": false, "score": 2, "last_activity_date": 1471380424, "last_edit_date": 1495535247, "creation_date": 1471377581, "answer_id": 38983453, "question_id": 38983284, "link": "https://stackoverflow.com/questions/38983284/please-clarify-the-concept-of-lvalue-and-rvalue-here/38983453#38983453", "title": "Please clarify the concept of lvalue and rvalue here", "body": "<p>Rvalues are essentially raw values or temporary results of an operation, they should not be operated on.  So pre- or post-increment operations on these are not allowed.</p>\n\n<p>Lvalues are traditional values that refer to a stored object, function or primitive, things which can be operated on or called.</p>\n\n<p>In your first line: <code>int i=5; // i is an lvalue, 5 is an rvalue</code></p>\n\n<p>So, <code>++(i++)</code> is translating to <code>++6</code>, which is essentially what the compiler is complaining about.</p>\n\n<p>Btw, this was already answered here:  <a href=\"https://stackoverflow.com/questions/3601602/what-are-rvalues-lvalues-xvalues-glvalues-and-prvalues?rq=1\">What are rvalues, lvalues, xvalues, glvalues, and prvalues?</a></p>\n"}, {"tags": [], "owner": {"reputation": 262, "user_id": 5916457, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/eeae0a149f32d093e9cd77fa6cd4a340?s=128&d=identicon&r=PG&f=1", "display_name": "FreeStyle4", "link": "https://stackoverflow.com/users/5916457/freestyle4"}, "is_accepted": false, "score": 3, "last_activity_date": 1471378815, "last_edit_date": 1592644375, "creation_date": 1471377974, "answer_id": 38983560, "question_id": 38983284, "link": "https://stackoverflow.com/questions/38983284/please-clarify-the-concept-of-lvalue-and-rvalue-here/38983560#38983560", "title": "Please clarify the concept of lvalue and rvalue here", "body": "<blockquote>\n<p>&quot;An lvalue (locator value) represents an object that occupies some identifiable location in memory (i.e. has an address).</p>\n<p>rvalues are defined by exclusion, by saying that every expression is either an lvalue or an rvalue. Therefore, from the above definition of lvalue, an rvalue is an expression that does not represent an object occupying some identifiable location in memory.&quot;</p>\n</blockquote>\n<p>reference: <a href=\"http://eli.thegreenplace.net/2011/12/15/understanding-lvalues-and-rvalues-in-c-and-c\" rel=\"nofollow noreferrer\">http://eli.thegreenplace.net/2011/12/15/understanding-lvalues-and-rvalues-in-c-and-c</a></p>\n<p>Based on that definition,\nthe post-increment <code>i++</code> won't work anymore because the expression returned is not located in <code>i</code> anymore since it's incremented.</p>\n<p>Meanwhile the expression returned by <code>++i</code> returns a reference to the incremented variable <code>i</code></p>\n"}, {"tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": true, "score": 3, "last_activity_date": 1471378464, "last_edit_date": 1471378464, "creation_date": 1471378034, "answer_id": 38983574, "question_id": 38983284, "link": "https://stackoverflow.com/questions/38983284/please-clarify-the-concept-of-lvalue-and-rvalue-here/38983574#38983574", "title": "Please clarify the concept of lvalue and rvalue here", "body": "<p>In c the postfix or prefix <code>++</code> operators require that the operand is a modifiable lvalue. Both operators perform an lvalue conversion, so the object is no longer an lvalue.</p>\n\n<p>C++ also requires that the operand of the prefix <code>++</code> operator is a modifiable lvalue, but the result of the prefix <code>++</code> operator is an lvalue. This is not the case for the postfix <code>++</code> operator.</p>\n\n<p>Therefore <code>(++(++i));</code> compiles as the second operation gets an lvalue, but <code>(++(i++))</code> doesn't.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9146132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ca2b15259c1ec6fe8a7e8153827da61?s=128&d=identicon&r=PG&f=1", "display_name": "user9146132", "link": "https://stackoverflow.com/users/9146132/user9146132"}, "is_accepted": false, "score": 0, "last_activity_date": 1514889764, "creation_date": 1514889764, "answer_id": 48059483, "question_id": 38983284, "link": "https://stackoverflow.com/questions/38983284/please-clarify-the-concept-of-lvalue-and-rvalue-here/48059483#48059483", "title": "Please clarify the concept of lvalue and rvalue here", "body": "<pre><code>\"lvalue\" and \"rvalue\" are so named because of where each \n  of them can appear in an assignment operation.  An \n  lvalue \n can appear on the left side of an assignment operator, \n  whereas an rvalue can appear on the right side.\n\n  As an example:\n\nint a;\na = 3;\n\nIn the second line, \"a\" is the lvalue, and \"3\" is the rvalue.\n\n in this example:\n\n\n\nint a, b;\na = 4;\nb = a;\n\nIn the third line of that example, \"b\" is the lvalue, and \"a\" is \nthe rvalue, whereas it was the lvalue in line 2.  This \nillustrates an important point: An lvalue can also be an \nrvalue, but an rvalue can never be an lvalue.\n\nAnother definition of lvalue is \"a place where a value can \nbe stored.\" \n</code></pre>\n"}], "owner": {"reputation": 2445, "user_id": 4390699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4fe7d756a92a20b8b49b05cc0f1bb628?s=128&d=identicon&r=PG", "display_name": "Raman", "link": "https://stackoverflow.com/users/4390699/raman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 1, "accepted_answer_id": 38983574, "answer_count": 4, "score": 1, "last_activity_date": 1514889764, "creation_date": 1471376891, "last_edit_date": 1471379615, "question_id": 38983284, "link": "https://stackoverflow.com/questions/38983284/please-clarify-the-concept-of-lvalue-and-rvalue-here", "title": "Please clarify the concept of lvalue and rvalue here", "body": "<p>I have the program given below</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n   int i=5;\n   (++(++i));\n}\n</code></pre>\n\n<p>This program compiles fine in c++ but not in c. I couldn't truly understand either. But I've tried reading and searching and found that this is because preincrement operator returns rvalue in c and lvalue in c++.</p>\n\n<p>If I change <code>(++(++i))</code> to <code>(++(i++))</code> then compilation fails in both in c and c++ because post-increment always returns rvalue.</p>\n\n<p>Even after some reading, I don't get a clear picture of what exactly lvalue and rvalue mean here. Can somebody explain me in layman terms what are these?</p>\n"}, {"tags": ["ios", "c", "localhost", "enet"], "comments": [{"owner": {"reputation": 94591, "user_id": 3418066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/De72L.jpg?s=128&g=1", "display_name": "Paulw11", "link": "https://stackoverflow.com/users/3418066/paulw11"}, "edited": false, "score": 0, "creation_date": 1471380993, "post_id": 38982884, "comment_id": 65321371, "body": "What address are you trying to connect to?  Does your computer have a firewall running?"}, {"owner": {"reputation": 26119, "user_id": 63898, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/88464b7b200398866f216092f01747ed?s=128&d=identicon&r=PG", "display_name": "user63898", "link": "https://stackoverflow.com/users/63898/user63898"}, "reply_to_user": {"reputation": 94591, "user_id": 3418066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/De72L.jpg?s=128&g=1", "display_name": "Paulw11", "link": "https://stackoverflow.com/users/3418066/paulw11"}, "edited": false, "score": 0, "creation_date": 1471416341, "post_id": 38982884, "comment_id": 65331649, "body": "don&#39;t think i have firewall running . does MAC have firewall installed ?  by default i mean ?"}, {"owner": {"reputation": 94591, "user_id": 3418066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/De72L.jpg?s=128&g=1", "display_name": "Paulw11", "link": "https://stackoverflow.com/users/3418066/paulw11"}, "edited": false, "score": 0, "creation_date": 1471416590, "post_id": 38982884, "comment_id": 65331799, "body": "Yes, Mac OS X does have a firewall active by default"}, {"owner": {"reputation": 26119, "user_id": 63898, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/88464b7b200398866f216092f01747ed?s=128&d=identicon&r=PG", "display_name": "user63898", "link": "https://stackoverflow.com/users/63898/user63898"}, "reply_to_user": {"reputation": 94591, "user_id": 3418066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/De72L.jpg?s=128&g=1", "display_name": "Paulw11", "link": "https://stackoverflow.com/users/3418066/paulw11"}, "edited": false, "score": 0, "creation_date": 1471416791, "post_id": 38982884, "comment_id": 65331918, "body": "great to know i will check how to disable it"}, {"owner": {"reputation": 94591, "user_id": 3418066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/De72L.jpg?s=128&g=1", "display_name": "Paulw11", "link": "https://stackoverflow.com/users/3418066/paulw11"}, "edited": false, "score": 0, "creation_date": 1471417052, "post_id": 38982884, "comment_id": 65332051, "body": "Also make sure you aren&#39;t trying to connect to 127.0.0.1"}, {"owner": {"reputation": 26119, "user_id": 63898, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/88464b7b200398866f216092f01747ed?s=128&d=identicon&r=PG", "display_name": "user63898", "link": "https://stackoverflow.com/users/63898/user63898"}, "reply_to_user": {"reputation": 94591, "user_id": 3418066, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/De72L.jpg?s=128&g=1", "display_name": "Paulw11", "link": "https://stackoverflow.com/users/3418066/paulw11"}, "edited": false, "score": 0, "creation_date": 1471417145, "post_id": 38982884, "comment_id": 65332095, "body": "im connecting to what ip&#39;s the ifconfig -a gave me  and also $HOSTNAME"}], "owner": {"reputation": 26119, "user_id": 63898, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/88464b7b200398866f216092f01747ed?s=128&d=identicon&r=PG", "display_name": "user63898", "link": "https://stackoverflow.com/users/63898/user63898"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 252, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1471383409, "creation_date": 1471375276, "last_edit_date": 1471383409, "question_id": 38982884, "link": "https://stackoverflow.com/questions/38982884/enet-failed-to-connect-to-local-server-from-ios-real-device-but-do-work-when-u", "title": "ENet : Failed to connect to local server from iOS real device BUT do work when using desktop client", "body": "<p>As i continue to check this great lib with iOS device which is iphone 5 iOS 8.3<br>\nI have strange ( or not ) connection error<br>\nWhen i try to connect the server which is running from my xCode .  and Iphone app is running from xcode also .<br>\nThe line :<br>\n<code>if (enet_host_service(client, &amp;event, 1000) &gt; 0 &amp;&amp;  event.type == ENET_EVENT_TYPE_CONNECT)</code></p>\n\n<p>Dosn't pass and jumps to :<br>\n<code>enet_peer_reset(peer);</code> </p>\n\n<p>BUT when i run this code both from my desktop as simple client/server app , every thing is working just fine .<br>\nhere is the code which i take from some internet site .<br>\nnotice i set the HOST to be my Mac  : <code>echo $HOSTNAME</code>.\nMaybe this is the problem and the iPhone can't connect my Mac .. i dont know<br>\nhow can i check this ?<br>\nThanks<br>\nHere is the code :  </p>\n\n<h2>Client desktop :</h2>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#include &lt;string.h&gt;\n\n#include &lt;stdlib.h&gt;\n\n#include \"enet/enet.h\"\n\n#define BUFFERSIZE 1024\n\n#define PORT 9991\n\n\n\nENetAddress  address;\n\nENetHost   *server;\n\nENetEvent  event;\n\nENetPacket      *packet;\n\n\n\nchar    buffer[BUFFERSIZE];\n\n\n\nint  main(int argc, char ** argv) {\n\n    int  i;\n\n\n\n    if (enet_initialize() != 0) {\n\n        printf(\"Could not initialize enet.\");\n\n        return 0;\n\n    }\n\n\n\n    address.host = ENET_HOST_ANY;\n\n    address.port = PORT;\n\n\n\n    server = enet_host_create(&amp;address, 100, 2, 0, 0);\n\n\n\n    if (server == NULL) {\n\n        printf(\"Could not start server.\\n\");\n\n        return 0;\n\n    }\n\n    else\n\n    {\n\n        printf(\"Server Started host: %d on port:%d.\\n\",address.host, address.port);\n\n\n\n    }\n\n\n\n    while (1) {\n\n        while (enet_host_service(server, &amp;event, 1000) &gt; 0) {\n\n            switch (event.type) {\n\n\n\n                case ENET_EVENT_TYPE_CONNECT:\n\n                    break;\n\n\n\n                case ENET_EVENT_TYPE_RECEIVE:\n\n                    if (event.peer-&gt;data == NULL) {\n\n                        event.peer-&gt;data =\n\n                        malloc(strlen((char*) event.packet-&gt;data)+1);\n\n                        strcpy((char*) event.peer-&gt;data, (char*)\n\n                               event.packet-&gt;data);\n\n\n\n                        sprintf(buffer, \"%s has connected\\n\",\n\n                                (char*) event.packet-&gt;data);\n\n                        packet = enet_packet_create(buffer,\n\n                                                    strlen(buffer)+1, 0);\n\n                        enet_host_broadcast(server, 1, packet);\n\n                        enet_host_flush(server);\n\n                    } else {\n\n                        for (i=0; i&lt;server-&gt;peerCount; i++) {\n\n                            if (&amp;server-&gt;peers[i] != event.peer) {\n\n                                sprintf(buffer, \"%s: %s\",\n\n                                        (char*) event.peer-&gt;data, (char*)\n\n                                        event.packet-&gt;data);\n\n                                packet = enet_packet_create(buffer,\n\n                                                            strlen(buffer)+1, 0);\n\n                                enet_peer_send(&amp;server-&gt;peers[i], 0,\n\n                                               packet);\n\n                                enet_host_flush(server);\n\n                            } else {\n\n\n\n                            }\n\n                        }\n\n                    }\n\n                    break;\n\n\n\n                case ENET_EVENT_TYPE_DISCONNECT:\n\n                    sprintf(buffer, \"%s has disconnected.\", (char*)\n\n                            event.peer-&gt;data);\n\n                    packet = enet_packet_create(buffer, strlen(buffer)+1, 0);\n\n                    enet_host_broadcast(server, 1, packet);\n\n                    free(event.peer-&gt;data);\n\n                    event.peer-&gt;data = NULL;\n\n                    break;\n\n\n\n                default:\n\n                    printf(\"Tick tock.\\n\");\n\n                    break;\n\n            }\n\n\n\n        }\n\n    }\n\n\n\n    enet_host_destroy(server);\n\n    enet_deinitialize();\n\n    return 0;\n\n}\n</code></pre>\n\n<p>Client Iphone device ( part of cpp game engine ) compiles fine .</p>\n\n<hr>\n\n<pre><code>char  buffer[BUFFERSIZE];\n\n\n\n    ENetHost  *client;\n\n    ENetAddress  address;\n\n    ENetEvent  event;\n\n    ENetPeer  *peer;\n\n    ENetPacket  *packet;\n\n    int connected=0;\n\n    if (enet_initialize() != 0) {\n\n        log(\"Could not initialize enet.\\n\");\n\n        return false;\n\n    }\n\n    client = enet_host_create(NULL, 1, 2, 5760/8, 1440/8);\n\n\n\n    if (client == NULL) {\n\n        log(\"Could not create client.\\n\");\n\n        return false;\n\n    }\n\n\n\n    enet_address_set_host(&amp;address, HOST);\n\n    address.port = PORT;\n\n\n\n    peer = enet_host_connect(client, &amp;address, 2, 0);\n\n\n\n    if (peer == NULL) {\n\n        log(\"Could not connect to server\\n\");\n\n        return false;\n\n    }\n\n\n\n    if (enet_host_service(client, &amp;event, 1000) &gt; 0 &amp;&amp;\n\n        event.type == ENET_EVENT_TYPE_CONNECT) {\n\n\n\n        log(\"Connection to %s succeeded.\\n\", HOST);\n\n        connected++;\n\n\n\n        strncpy(buffer, \"Meiry Test\", BUFFERSIZE);\n\n        packet = enet_packet_create(buffer, strlen(buffer)+1,\n\n                                    ENET_PACKET_FLAG_RELIABLE);\n\n        enet_peer_send(peer, 0, packet);\n\n\n\n    } else {\n\n        enet_peer_reset(peer);\n\n        log(\"Could not connect to %s.\\n\", HOST);\n\n        return false;\n\n    }\n</code></pre>\n\n<p>Server </p>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n\n\n#include &lt;string.h&gt;\n\n#include &lt;stdlib.h&gt;\n\n#include \"enet/enet.h\"\n\n#define BUFFERSIZE 1024\n\n#define PORT 9991\n\n\n\nENetAddress  address;\n\nENetHost   *server;\n\nENetEvent  event;\n\nENetPacket      *packet;\n\n\n\nchar    buffer[BUFFERSIZE];\n\n\n\nint  main(int argc, char ** argv) {\n\n    int  i;\n\n\n\n    if (enet_initialize() != 0) {\n\n        printf(\"Could not initialize enet.\");\n\n        return 0;\n\n    }\n\n\n\n    address.host = ENET_HOST_ANY;\n\n    address.port = PORT;\n\n\n\n    server = enet_host_create(&amp;address, 100, 2, 0, 0);\n\n\n\n    if (server == NULL) {\n\n        printf(\"Could not start server.\\n\");\n\n        return 0;\n\n    }\n\n    else\n\n    {\n\n        printf(\"Server Started host: %d on port:%d.\\n\",address.host, address.port);\n\n\n\n    }\n\n\n\n    while (1) {\n\n        while (enet_host_service(server, &amp;event, 1000) &gt; 0) {\n\n            switch (event.type) {\n\n\n\n                case ENET_EVENT_TYPE_CONNECT:\n\n                    break;\n\n\n\n                case ENET_EVENT_TYPE_RECEIVE:\n\n                    if (event.peer-&gt;data == NULL) {\n\n                        event.peer-&gt;data =\n\n                        malloc(strlen((char*) event.packet-&gt;data)+1);\n\n                        strcpy((char*) event.peer-&gt;data, (char*)\n\n                               event.packet-&gt;data);\n\n\n\n                        sprintf(buffer, \"%s has connected\\n\",\n\n                                (char*) event.packet-&gt;data);\n\n                        packet = enet_packet_create(buffer,\n\n                                                    strlen(buffer)+1, 0);\n\n                        enet_host_broadcast(server, 1, packet);\n\n                        enet_host_flush(server);\n\n                    } else {\n\n                        for (i=0; i&lt;server-&gt;peerCount; i++) {\n\n                            if (&amp;server-&gt;peers[i] != event.peer) {\n\n                                sprintf(buffer, \"%s: %s\",\n\n                                        (char*) event.peer-&gt;data, (char*)\n\n                                        event.packet-&gt;data);\n\n                                packet = enet_packet_create(buffer,\n\n                                                            strlen(buffer)+1, 0);\n\n                                enet_peer_send(&amp;server-&gt;peers[i], 0,\n\n                                               packet);\n\n                                enet_host_flush(server);\n\n                            } else {\n\n\n\n                            }\n\n                        }\n\n                    }\n\n                    break;\n\n\n\n                case ENET_EVENT_TYPE_DISCONNECT:\n\n                    sprintf(buffer, \"%s has disconnected.\", (char*)\n\n                            event.peer-&gt;data);\n\n                    packet = enet_packet_create(buffer, strlen(buffer)+1, 0);\n\n                    enet_host_broadcast(server, 1, packet);\n\n                    free(event.peer-&gt;data);\n\n                    event.peer-&gt;data = NULL;\n\n                    break;\n\n\n\n                default:\n\n                    printf(\"Tick tock.\\n\");\n\n                    break;\n\n            }\n\n\n\n        }\n\n    }\n\n\n\n    enet_host_destroy(server);\n\n    enet_deinitialize();\n\n    return 0;\n\n}\n</code></pre>\n"}]