[{"tags": ["c"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1574898822, "post_id": 59079967, "comment_id": 104396930, "body": "<code>s</code> is not declared.  <code>struct s</code> is the name of the type you defined. Also you cannot assign the result of <code>malloc</code> to a struct.  You could do <code>struct s X;</code>, or <code>struct s *pX = malloc( sizeof *pX );</code>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1574898978, "post_id": 59079967, "comment_id": 104396963, "body": "Note that C and C++ have different rules in this area. In C, <code>struct s { ... }</code> defines a type named <code>struct s</code>. In C++, the same definition creates a type called <code>s</code> (which can also be referred to as <code>struct s</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 3, "last_activity_date": 1574899071, "creation_date": 1574899071, "answer_id": 59080013, "question_id": 59079967, "link": "https://stackoverflow.com/questions/59079967/c-undeclared-first-use-in-this-function-when-its-actually-declared/59080013#59080013", "title": "C - undeclared (first use in this function) when it&#39;s actually declared", "body": "<p>Either use a typedef like</p>\n\n<pre><code>    typedef struct s\n    {\n        char n[20];\n        char p[20];\n    } s;\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>struct s *X = malloc(sizeof(s));\n</code></pre>\n\n<p>or</p>\n\n<pre><code>s *X = malloc(sizeof(s));\n</code></pre>\n\n<p>or even like</p>\n\n<pre><code>s *X = malloc(sizeof( *X));\n</code></pre>\n\n<p>Or without the typedef you have to use the keyword <code>struct</code></p>\n\n<pre><code>struct s *X = malloc(sizeof(struct s));\n</code></pre>\n\n<p>or</p>\n\n<pre><code>struct s *X = malloc(sizeof( *X));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "is_accepted": true, "score": 2, "last_activity_date": 1574899104, "creation_date": 1574899104, "answer_id": 59080017, "question_id": 59079967, "link": "https://stackoverflow.com/questions/59079967/c-undeclared-first-use-in-this-function-when-its-actually-declared/59080017#59080017", "title": "C - undeclared (first use in this function) when it&#39;s actually declared", "body": "<p>The issue is the you are defining the type <code>struct s</code> but not declaring the a variable or type named <code>s</code>.</p>\n\n<p>For this reason, when you call <code>sizeof(s)</code> the symbol <code>s</code> is undeclared</p>\n\n<p>As a side note, the variable <code>X</code> is defined as a <code>struct s</code> variable. If you're going to use <code>malloc</code> you probably want to assign the memory to a pointer (<code>struct s *X = ...</code>).</p>\n\n<p>Consider:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main()\n{\n    struct s\n    {\n        char n[20];\n        char p[20];\n    };\n\n    struct s *X = malloc(sizeof(struct s)); /* &lt;= note the struct keyword and pointer */\n\n    return 0;\n}\n</code></pre>\n\n<p>In addition, there is no need to name the <code>struct</code> type if you're not going to reference that type name. It's perfectly legal to use an anonymous struct:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main()\n{\n    struct\n    {\n        char n[20];\n        char p[20];\n    } * x; /* &lt;= note the variable name */\n\n    x = malloc(sizeof(*x));\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8242591, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nYu77.jpg?s=128&g=1", "display_name": "Emi Jerochim", "link": "https://stackoverflow.com/users/8242591/emi-jerochim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 59080017, "answer_count": 2, "score": 0, "last_activity_date": 1574899104, "creation_date": 1574898724, "question_id": 59079967, "link": "https://stackoverflow.com/questions/59079967/c-undeclared-first-use-in-this-function-when-its-actually-declared", "title": "C - undeclared (first use in this function) when it&#39;s actually declared", "body": "<p>I simplified the code and still don't get why it says the struct isn't declared when it's declared right above</p>\n\n<pre><code>    #include &lt;stdlib.h&gt;\n    #include &lt;stdio.h&gt;\n\n    int main()\n    {\n        struct s\n        {\n            char n[20];\n            char p[20];\n        };\n\n        struct s X = malloc(sizeof(s));\n\n        return 0;\n    }\n</code></pre>\n"}, {"tags": ["c", "macos", "linker", "darwin", "mach-o"], "answers": [{"comments": [{"owner": {"reputation": 15041, "user_id": 1455016, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ae8ab91a64f21f0e65b69a0bf1ca4904?s=128&d=identicon&r=PG", "display_name": "tbodt", "link": "https://stackoverflow.com/users/1455016/tbodt"}, "edited": false, "score": 0, "creation_date": 1594079211, "post_id": 59079952, "comment_id": 110994949, "body": "Is this documented anywhere? If not, what part of the linker source code does this?"}, {"owner": {"reputation": 13923, "user_id": 216728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13f27199f9bf9c9f1261dc8a49630a6b?s=128&d=identicon&r=PG", "display_name": "nornagon", "link": "https://stackoverflow.com/users/216728/nornagon"}, "reply_to_user": {"reputation": 15041, "user_id": 1455016, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ae8ab91a64f21f0e65b69a0bf1ca4904?s=128&d=identicon&r=PG", "display_name": "tbodt", "link": "https://stackoverflow.com/users/1455016/tbodt"}, "edited": false, "score": 0, "creation_date": 1594752023, "post_id": 59079952, "comment_id": 111234906, "body": "It is not documented. There&#39;s a unit test for it in the linker code though: <a href=\"https://github.com/apple-opensource-mirror/ld64/blob/9a22e880dba9ffe644cf5479d410d82a70c36b06/unit-tests/test-cases/segment-labels/main.c#L29\" rel=\"nofollow noreferrer\">github.com/apple-opensource-mirror/ld64/blob/&hellip;</a>"}], "tags": [], "owner": {"reputation": 13923, "user_id": 216728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13f27199f9bf9c9f1261dc8a49630a6b?s=128&d=identicon&r=PG", "display_name": "nornagon", "link": "https://stackoverflow.com/users/216728/nornagon"}, "is_accepted": false, "score": 5, "last_activity_date": 1574898630, "creation_date": 1574898630, "answer_id": 59079952, "question_id": 59079951, "link": "https://stackoverflow.com/questions/59079951/getting-the-size-of-the-text-section-at-link-time-on-macos/59079952#59079952", "title": "Getting the size of the __TEXT section at link time on macOS", "body": "<p>You can get the Darwin linker to insert this data with a bit of trickery using <code>__asm</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nextern int start_text __asm(\"section$start$__TEXT$__text\");\nextern int end_text __asm(\"section$end$__TEXT$__text\");\n\nint main() {\n  size_t text_section_size_bytes =\n    (intptr_t)&amp;end_text - (intptr_t)&amp;start_text;\n\n  printf(\"__TEXT.__text section size: 0x%lx\\n\", text_section_size_bytes);\n\n  return 0;\n}\n</code></pre>\n\n<p>On my machine, this prints:</p>\n\n<pre><code>$ clang -o test ./test.c\n$ ./test\n__TEXT.__text section size: 0x43\n</code></pre>\n\n<p>Which matches up with what <code>objdump</code> reports:</p>\n\n<pre><code>$ objdump -h ./test\n./foo2: file format Mach-O 64-bit x86-64\n\nSections:\nIdx Name          Size      Address          Type\n  0 __text        00000043 0000000100000f30 TEXT\n  [...]\n</code></pre>\n\n<p>You can also do the same trick to get the size of whole <em>segments</em> (as opposed to sections) by using the syntax <code>segment$start$__TEXT</code> / <code>segment$end$__TEXT</code>.</p>\n"}], "owner": {"reputation": 13923, "user_id": 216728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13f27199f9bf9c9f1261dc8a49630a6b?s=128&d=identicon&r=PG", "display_name": "nornagon", "link": "https://stackoverflow.com/users/216728/nornagon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1575016557, "creation_date": 1574898630, "last_edit_date": 1575016557, "question_id": 59079951, "link": "https://stackoverflow.com/questions/59079951/getting-the-size-of-the-text-section-at-link-time-on-macos", "title": "Getting the size of the __TEXT section at link time on macOS", "body": "<p>With <code>gold</code> and other linkers, it's possible to have the linker write the start/end of the <code>.text</code> section into the binary as constants using a linker script, e.g.</p>\n\n<pre><code>PROVIDE_HIDDEN(linker_script_start_of_text = ADDR(.text));\nPROVIDE_HIDDEN(linker_script_end_of_text = ADDR(.text) + SIZEOF(.text));\n</code></pre>\n\n<p>linked with <code>ld -Tmy_linker_script.lds ...</code>.</p>\n\n<p>I know it's possible to call <a href=\"https://opensource.apple.com/source/cctools/cctools-751/include/mach-o/getsect.h.auto.html\" rel=\"nofollow noreferrer\">getsectdata</a> or similar to get information about the <code>.text</code> section or parse it from the mach-o header, but is there a way to have the linker insert this data as a constant?</p>\n"}, {"tags": ["c", "arrays", "pointers", "char"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1574897797, "post_id": 59079826, "comment_id": 104396668, "body": "C uses pass-by-value, functions receive copies of the arguments"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1574897799, "post_id": 59079826, "comment_id": 104396669, "body": "Arrays are not pointers. You cannot reassign arrays"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1574897859, "post_id": 59079826, "comment_id": 104396680, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/39715740/update-global-variable-in-c-via-reference-by-parameter\">Update global variable in C via reference by parameter</a>. However, you don&#39;t really want to return a pointer to the local array back to the main function."}, {"owner": {"reputation": 170, "user_id": 12121241, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA_oqrpk6wSIbJMFFm726BudOVajdSn4sakJO3bpg=k-s128", "display_name": "Jakub Balicki", "link": "https://stackoverflow.com/users/12121241/jakub-balicki"}, "edited": false, "score": 0, "creation_date": 1574898404, "post_id": 59079826, "comment_id": 104396835, "body": "Why does it work on int, but doesn&#39;t on this array?"}, {"owner": {"reputation": 170, "user_id": 12121241, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA_oqrpk6wSIbJMFFm726BudOVajdSn4sakJO3bpg=k-s128", "display_name": "Jakub Balicki", "link": "https://stackoverflow.com/users/12121241/jakub-balicki"}, "edited": false, "score": 0, "creation_date": 1574898426, "post_id": 59079826, "comment_id": 104396841, "body": "Is it possible to achieve this in this style?"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1574898874, "post_id": 59079826, "comment_id": 104396942, "body": "@JakubBalicki The int version uses <code>*</code> (in <code>*d</code>) to store through the pointer. <code>char *str = var; str = buffer;</code> just locally stores an argument and then overwrites that local variable with a local address. Playing around with postal addresses without sending your letters won&#39;t have any effect outside of your home."}, {"owner": {"reputation": 170, "user_id": 12121241, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA_oqrpk6wSIbJMFFm726BudOVajdSn4sakJO3bpg=k-s128", "display_name": "Jakub Balicki", "link": "https://stackoverflow.com/users/12121241/jakub-balicki"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1574898975, "post_id": 59079826, "comment_id": 104396962, "body": "Oh, I see, thanks again @PSkocik!"}], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 12121241, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA_oqrpk6wSIbJMFFm726BudOVajdSn4sakJO3bpg=k-s128", "display_name": "Jakub Balicki", "link": "https://stackoverflow.com/users/12121241/jakub-balicki"}, "edited": false, "score": 0, "creation_date": 1574898761, "post_id": 59079942, "comment_id": 104396911, "body": "Thank you, works like a charm :)"}, {"owner": {"reputation": 170, "user_id": 12121241, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA_oqrpk6wSIbJMFFm726BudOVajdSn4sakJO3bpg=k-s128", "display_name": "Jakub Balicki", "link": "https://stackoverflow.com/users/12121241/jakub-balicki"}, "edited": false, "score": 0, "creation_date": 1574898774, "post_id": 59079942, "comment_id": 104396917, "body": "Also thanks for the useful tips"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1574898801, "post_id": 59079942, "comment_id": 104396924, "body": "<code>memcmpy</code> -&gt; <code>memcpy</code> :)"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1574898967, "post_id": 59079942, "comment_id": 104396960, "body": "@Groo Thanks. I&#39;m tired and I did spend quite a bit of the afternoon playing with <code>memcmp</code> and it shows :D."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 1, "last_activity_date": 1574898906, "last_edit_date": 1574898906, "creation_date": 1574898553, "answer_id": 59079942, "question_id": 59079826, "link": "https://stackoverflow.com/questions/59079826/c-assigning-pointer-in-function-doesnt-change-the-original-pointer-void/59079942#59079942", "title": "C assigning pointer in function, doesn&#39;t change the original pointer (void *)", "body": "<p><code>char* str = var;</code> (cast not needed) converts the <code>var</code> void pointer to a locally stored <code>char *</code> pointer and then overwrites that value with the address of <code>&amp;buffer[0]</code> (the first element of the <code>buffer</code> char array, decay implicit).</p>\n\n<p>This has no observable effect (and can be optimized out completely).</p>\n\n<p>What you likely want is to copy characters from your buffer through the <code>var</code>/<code>str</code> pointer and then <code>\\0</code>-terminate:</p>\n\n<pre><code>char* str = var;\nmemcpy(str, buffer, size);\nstr[size]='\\0';\n</code></pre>\n\n<p>Note that <code>read</code> should have requested 127 bytes (or <code>myscanf</code> caller should have provided <code>128+1</code> bytes of space) and that you should have checked the <code>read</code> call for possible failure.</p>\n\n<p>The <code>memset</code> call is unnecessary.</p>\n"}], "owner": {"reputation": 170, "user_id": 12121241, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA_oqrpk6wSIbJMFFm726BudOVajdSn4sakJO3bpg=k-s128", "display_name": "Jakub Balicki", "link": "https://stackoverflow.com/users/12121241/jakub-balicki"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "closed_date": 1574899958, "accepted_answer_id": 59079942, "answer_count": 1, "score": -3, "last_activity_date": 1574898906, "creation_date": 1574897618, "question_id": 59079826, "link": "https://stackoverflow.com/questions/59079826/c-assigning-pointer-in-function-doesnt-change-the-original-pointer-void", "closed_reason": "Duplicate", "title": "C assigning pointer in function, doesn&#39;t change the original pointer (void *)", "body": "<p>I am trying to assign new value for my char s[128] array. But after performing function, the address of the s doesn't change. On the other hand the function works just fine for the ints.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>\nvoid myscanf(const char *type, void *var){\n    char buffer[128];\n    memset(buffer,0,sizeof(buffer));\n    int size = read(0, buffer, 128);\n    if(strcmp(type, \"%d\") == 0){\n        int *d = (int*)var;\n        *d = buffer[0] - '0';   \n    }\n    else if(strcmp(type,\"%s\") == 0){\n        char* str = (char*) var;\n        str = buffer;\n    }\n}\n\nint main(){\n    int d;\n    char s[128];\n    myscanf(\"%s\", s);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "compiler-errors", "wchar-t"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 4, "creation_date": 1574896794, "post_id": 59079700, "comment_id": 104396451, "body": "have you tried <code>#include &lt;wchar.h&gt;</code>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1574898837, "post_id": 59079700, "comment_id": 104396934, "body": "<code>wchar_t</code> is a keyword and a built-in type in C++, but in C it&#39;s a typedef defined in both <code>&lt;stddef.h&gt;</code> and <code>&lt;wchar.h&gt;</code>. Which open source project are you building?"}, {"owner": {"reputation": 3301, "user_id": 2067419, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/OAlqY.jpg?s=128&g=1", "display_name": "Bhupesh Pant", "link": "https://stackoverflow.com/users/2067419/bhupesh-pant"}, "edited": false, "score": 0, "creation_date": 1574899161, "post_id": 59079700, "comment_id": 104397008, "body": "Thanks for your responses. I am trying to build : tpm2-tss"}, {"owner": {"reputation": 3301, "user_id": 2067419, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/OAlqY.jpg?s=128&g=1", "display_name": "Bhupesh Pant", "link": "https://stackoverflow.com/users/2067419/bhupesh-pant"}, "edited": false, "score": 0, "creation_date": 1574899265, "post_id": 59079700, "comment_id": 104397029, "body": "To be clear I am getting all these errors in UCRT files like, stdlib.h, vcruntime_string.h, corecrt.h etc"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1574987335, "post_id": 59079700, "comment_id": 104428105, "body": "click on &quot;Character set&quot; and select &quot;Unicode&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 3301, "user_id": 2067419, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/OAlqY.jpg?s=128&g=1", "display_name": "Bhupesh Pant", "link": "https://stackoverflow.com/users/2067419/bhupesh-pant"}, "is_accepted": false, "score": 0, "last_activity_date": 1575221211, "creation_date": 1575221211, "answer_id": 59128081, "question_id": 59079700, "link": "https://stackoverflow.com/questions/59079700/identifier-wchar-t-is-undefined/59128081#59128081", "title": "Identifier wchar_t is undefined", "body": "<p>I added these two lines and it fixed the issue,</p>\n\n<pre><code>#undef _WCHAR_T_DEFINED\n#include&lt;stddef.h&gt;\n</code></pre>\n\n<p>I am however not sure if this is the optimal change.</p>\n\n<p>So this change is after learning what @keith told me that wchat_t needs to be added for C. Investigated further to understand the compiler level behavior and flags available.\nTo know why I added the undef of macro please read the below link,</p>\n\n<ul>\n<li><p><a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/zc-wchar-t-wchar-t-is-native-type?view=vs-2019\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/cpp/build/reference/zc-wchar-t-wchar-t-is-native-type?view=vs-2019</a></p></li>\n<li><p><a href=\"https://github.com/microsoft/clang-1/blob/master/test/Driver/cl-zc.cpp\" rel=\"nofollow noreferrer\">https://github.com/microsoft/clang-1/blob/master/test/Driver/cl-zc.cpp</a></p></li>\n</ul>\n\n<p>In short,</p>\n\n<pre><code>// RUN: %clang_cl /c -### /Zc:wchar_t -- %s 2&gt;&amp;1 | FileCheck -check-prefix=WCHAR_T-ON %s\n// WCHAR_T-ON-NOT: argument unused during compilation\n// RUN: %clang_cl /c -### /Zc:wchar_t- -- %s 2&gt;&amp;1 | FileCheck -check-prefix=WCHAR_T-OFF %s\n// WCHAR_T-OFF: argument unused during compilation\n</code></pre>\n"}], "owner": {"reputation": 3301, "user_id": 2067419, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/OAlqY.jpg?s=128&g=1", "display_name": "Bhupesh Pant", "link": "https://stackoverflow.com/users/2067419/bhupesh-pant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 461, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1575221211, "creation_date": 1574896700, "question_id": 59079700, "link": "https://stackoverflow.com/questions/59079700/identifier-wchar-t-is-undefined", "title": "Identifier wchar_t is undefined", "body": "<p>I am trying to build an open-source project and I found that multiple of </p>\n\n<pre><code>identifier wchar_t is undefined error\n</code></pre>\n\n<p>I understand the definition for these intrinsic types comes from the compiler and I am getting for other types but not sure why it is falling apart for wchar_t specifically?\nI am suspecting since I am using <strong>Visual Studio 2017 - Clang with Microsoft CodeGen (v141_clang_c2)</strong> as a toolset I am suspecting this could be just as simple as turning the right flag on.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UbghD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UbghD.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "arrays", "string", "concatenation", "case-insensitive"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1574896832, "post_id": 59079659, "comment_id": 104396458, "body": "You&#39;re using scanf to split the strings, which means you need to put a space after each comma (otherwise it will read everything as one word), and the ending comma is part of each string. You need to check for that comma and remove it."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1574897101, "post_id": 59079659, "comment_id": 104396506, "body": "<i>&quot;the gods shall surely punish thee for thy arrogance...&quot;</i> See <a href=\"http://www.seebs.net/c/10com.html\" rel=\"nofollow noreferrer\">Henry Spencer&#39;s 10 Commandments for C Programmers -- No. 6</a> <i>&quot;Ye be warned...&quot;</i>"}], "answers": [{"tags": [], "owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "is_accepted": true, "score": 0, "last_activity_date": 1574897097, "creation_date": 1574897097, "answer_id": 59079767, "question_id": 59079659, "link": "https://stackoverflow.com/questions/59079659/concatenation-of-first-letter-alike-regardless-of-upper-and-lower-case-in-c/59079767#59079767", "title": "Concatenation of first letter alike regardless of upper and lower case in C", "body": "<p>The following code which decides whether to print a comma</p>\n\n<pre><code>if (str1[i][0] != letter)\n</code></pre>\n\n<p>does a case-sensitive comparison.</p>\n\n<p>Change it to something like</p>\n\n<pre><code>if (tolower(str1[i][0]) != tolower(letter))\n</code></pre>\n\n<p>However, the code contains multiple bugs (too many to point them all out), so not sure it will work. You might want to do debugging.</p>\n"}], "owner": {"reputation": 35, "user_id": 12426865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2acbb1f6068c25b246c5145cf5089f43?s=128&d=identicon&r=PG&f=1", "display_name": "iglot", "link": "https://stackoverflow.com/users/12426865/iglot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 59079767, "answer_count": 1, "score": 1, "last_activity_date": 1574897097, "creation_date": 1574896377, "question_id": 59079659, "link": "https://stackoverflow.com/questions/59079659/concatenation-of-first-letter-alike-regardless-of-upper-and-lower-case-in-c", "title": "Concatenation of first letter alike regardless of upper and lower case in C", "body": "<p>i have been figuring out how to combine strings that has first same letter alike regardless of their cases. I have a code that if you input </p>\n\n<blockquote>\n  <p>babe,two,Bird,Tea </p>\n</blockquote>\n\n<p>the output is always like this</p>\n\n<blockquote>\n  <p>babe,Bird,Tea,two</p>\n</blockquote>\n\n<p>But the input that I want to see is like this</p>\n\n<blockquote>\n  <p>babeBird,Teatwo</p>\n</blockquote>\n\n<p>What am i going to add or change in my code in order for me to do that. Here's my code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nint main()\n{\nchar str1[1000][1000], str[1000], temp[1000];\nint n, i, p, j, a;\nchar *ptr, *ptr1, letter;\n\n\nprintf(\"Enter how many arrays: \");\nscanf(\"%d\", &amp;n);\n\nfor(i=0; i&lt;n; i++)\n{\n    printf(\"Enter string %d: \", i+1);\n    scanf(\"%s\", &amp;str1[i]);\n}\n\nfor(i=0; i&lt;n-1; i++)\n{\n    for(j=i+1; j&lt;n; j++)\n    {\n    if (tolower((unsigned char)str1[i][0]) == tolower((unsigned char)str1[j][0])\n   ){\n       strcpy(temp, str1[i]);\n       strcpy(str1[i], str1[j]);\n       strcpy(str1[j], temp);\n    }\n   if(strcasecmp(str1[i], str1[j])&gt;0)\n   {\n       strcpy(temp, str1[i]);\n       strcpy(str1[i], str1[j]);\n       strcpy(str1[j], temp);\n     }\n   }\n}\n\n for(i=0; i&lt;n; i++)\n  {\n  if (i != 0)\n    {\n    else if (str1[i][0] != letter)\n    {\n        printf(\",\");\n    }\n  }\n\n\n    {\nprintf(\"%s\", str1[i]);\nletter = str1[i][0];\n    }\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "printf", "scanf"], "comments": [{"owner": {"reputation": 2445, "user_id": 1707353, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/212f7b84a07bc7aea4f574669fe2465f?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Holt", "link": "https://stackoverflow.com/users/1707353/jeff-holt"}, "edited": false, "score": 0, "creation_date": 1574895006, "post_id": 59079448, "comment_id": 104396034, "body": "Have a look at valgrind."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1574895071, "post_id": 59079448, "comment_id": 104396049, "body": "Also have a look at <code>feof()</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1574897210, "post_id": 59079448, "comment_id": 104396534, "body": "This site uses a Question/Answer format -- please do not edit the question to include answers in it. You can Accept an answer posted below, or post your own answer if none of the existing answers solve your problem"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1574899014, "post_id": 59079448, "comment_id": 104396974, "body": "Not your main problem, but: your use of <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\"><code>feof</code> in your while loop is wrong</a>.  You should be checking the return value of each <code>fscanf</code> call, and exiting the loop if the return value is anything other than 1."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 2197830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3aa8a13569701c3a0cd7557f420b7101?s=128&d=identicon&r=PG", "display_name": "Luke Mathwalker", "link": "https://stackoverflow.com/users/2197830/luke-mathwalker"}, "edited": false, "score": 2, "creation_date": 1574895499, "post_id": 59079511, "comment_id": 104396141, "body": "Oh my god. That worked. Thank you, and I hate myself."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1574895510, "post_id": 59079511, "comment_id": 104396144, "body": "+ Do <code>#include &lt;stdio.h&gt;</code> so you get a warning pointing you in this direction."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1574896377, "post_id": 59079511, "comment_id": 104396361, "body": "You should have gotten a warning with or without <code>#include &lt;stdio.h&gt;</code>. Without it, <code>fopen</code> is undeclared, and as of C99 C doesn&#39;t permit calls to undeclared functions. Before adding the <code>#include</code>, figure out how to invoke your compiler so it warns you about this. @PSkocik"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1574897305, "post_id": 59079511, "comment_id": 104396567, "body": "^ preferably, invoke the compiler so that it gives an <i>error</i> about this. Some people think warnings are unimportant"}, {"owner": {"reputation": 1311, "user_id": 10177569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ReqZ.jpg?s=128&g=1", "display_name": "yxor", "link": "https://stackoverflow.com/users/10177569/yxor"}, "edited": false, "score": 0, "creation_date": 1574897812, "post_id": 59079511, "comment_id": 104396672, "body": "I suggest compiling with the flags <code>-Wall -Werror</code>."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1574898322, "post_id": 59079511, "comment_id": 104396808, "body": "@M.M: I suggest doing one or both of the following: (a) Configure your compiler to treat serious problems like this as fatal errors and/or (b) take warnings seriously."}], "tags": [], "owner": {"reputation": 1311, "user_id": 10177569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ReqZ.jpg?s=128&g=1", "display_name": "yxor", "link": "https://stackoverflow.com/users/10177569/yxor"}, "is_accepted": false, "score": 2, "last_activity_date": 1574895317, "creation_date": 1574895317, "answer_id": 59079511, "question_id": 59079448, "link": "https://stackoverflow.com/questions/59079448/fopen-causes-a-segmentation-fault/59079511#59079511", "title": "fopen causes a segmentation fault", "body": "<p>This is your issue. You're passing a char instead of a string.</p>\n\n<pre><code>out = fopen(\"out.txt\", 'w');\nif (out==NULL){\n    printf(\"Error: No output file\\n\");\n    exit(1);\n}\n</code></pre>\n\n<p>Replace the <code>'w'</code> with <code>\"w\"</code>.\nThis is the correct version.</p>\n\n<pre><code>out = fopen(\"out.txt\", \"w\");\nif (out==NULL){\n    printf(\"Error: No output file\\n\");\n    exit(1);\n}\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 2197830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3aa8a13569701c3a0cd7557f420b7101?s=128&d=identicon&r=PG", "display_name": "Luke Mathwalker", "link": "https://stackoverflow.com/users/2197830/luke-mathwalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574897171, "creation_date": 1574894877, "last_edit_date": 1574897171, "question_id": 59079448, "link": "https://stackoverflow.com/questions/59079448/fopen-causes-a-segmentation-fault", "title": "fopen causes a segmentation fault", "body": "<p>I am experiencing a segfault using fopen(). My code is below. </p>\n\n<pre><code>void encoding(char otext[], char ibin[]){\n    //Some characters for storage:\n    char c, h, a, r;\n    unsigned int x;\n\n    //Check if file is available:\n    FILE *in; \n    FILE *out;\n    in = fopen(\"in.txt\", \"r\");\n    if (in==NULL){\n        printf(\"Error: No input file\\n\");\n        exit(1);\n    }\n    out = fopen(\"out.txt\", 'w');\n    if (out==NULL){\n        printf(\"Error: No output file\\n\");\n        exit(1);\n    }\n    //Scanning the file: \n    while(!feof(in)){//While not at the end of the in file\n        fscanf(in, \"%c\", &amp;c);\n        fscanf(in, \"%c\", &amp;h);\n        fscanf(in, \"%c\", &amp;a);\n        fscanf(in, \"%c\", &amp;r);\n        x = pack(c,h,a,r);\n        fprintf(out, \"%u\", x);\n        //fwrite(&amp;x,sizeof(int),1,out);\n    }\n    //Close file\n    fclose(in);\n    fclose(out);\n}\n\nunsigned int pack(char c1, char c2, char c3, char c4){//Works\n    int bits = 8;\n    unsigned int x = c1;\n    x = (x &lt;&lt; bits) | c2;\n    x = (x &lt;&lt; bits) | c3;\n    x = (x &lt;&lt; bits) | c4;\n    return x;\n}\n\nunsigned int encrypt(unsigned int x){//Works\n    int i = 0;\n    while (i &lt; KEY){\n        unsigned int temp = x;\n        x = (x&lt;&lt;1);\n        if (temp &gt; x){\n            x += 1;\n        }\n        i+=1;\n    }\n    return x;\n}\n</code></pre>\n\n<p>I found this topic: <a href=\"https://stackoverflow.com/questions/22240817/segfault-while-using-fopen\">Segfault while using fopen</a> - which suggests that the issue may be in using fprintf() incorrectly. So I commented out the fprintf() line and simply had it set to open and close out, like so: </p>\n\n<pre><code>//Edit for clarity: I commented out everything BUT the 3 lines of \n//code below, and I still got the segfault.\n/*...*/\nFile *out;\nout = fopen(\"out.txt\", \"w\");\n/*...*/\nfclose(out);\n</code></pre>\n\n<p>Even this causes a segfault, leading me to believe the issue is not in my use of fprintf(). At this point I'm at a loss.</p>\n"}, {"tags": ["c", "events", "sdl", "sdl-2"], "comments": [{"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 1, "creation_date": 1574914662, "post_id": 59079441, "comment_id": 104399921, "body": "There could be any number of reasons, problem is unlikely to be in presented code. Do you have compiler warnings enabled and react to them? Consider making MCCVE."}, {"owner": {"reputation": 1, "user_id": 12164493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e84ac8aaad9dd32024bc0edf6fa0b7d?s=128&d=identicon&r=PG&f=1", "display_name": "vgauther", "link": "https://stackoverflow.com/users/12164493/vgauther"}, "reply_to_user": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1574934439, "post_id": 59079441, "comment_id": 104407409, "body": "I dont have any warning during my compilation. The SDL does but what should I do for that."}, {"owner": {"reputation": 1, "user_id": 12164493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e84ac8aaad9dd32024bc0edf6fa0b7d?s=128&d=identicon&r=PG&f=1", "display_name": "vgauther", "link": "https://stackoverflow.com/users/12164493/vgauther"}, "reply_to_user": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1574936981, "post_id": 59079441, "comment_id": 104408811, "body": "@keltar I just edited my post with the warnings I got"}], "answers": [{"tags": [], "owner": {"reputation": 281, "user_id": 2321532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643c5d61f9e7dcbf38b860c677998c38?s=128&d=identicon&r=PG", "display_name": "vxdcxw", "link": "https://stackoverflow.com/users/2321532/vxdcxw"}, "is_accepted": false, "score": 0, "last_activity_date": 1574900323, "last_edit_date": 1574900323, "creation_date": 1574898017, "answer_id": 59079876, "question_id": 59079441, "link": "https://stackoverflow.com/questions/59079441/why-the-function-sdl-waitevent-sdl2-got-and-error-in-my-code/59079876#59079876", "title": "Why the function SDL_WaitEvent (SDL2) got and error in my code?", "body": "<p>In <code>main</code>, you don't check the result of <code>ft_sdl_init</code> is correct and thus, your program may run even with an invalid window/renderer.</p>\n\n<p>This condition does absolute nothing:</p>\n\n<pre><code>        if (!var-&gt;sdl.window || !var-&gt;sdl.render)\n            return ;\n</code></pre>\n\n<p>If it's true, it leaves the function. If it's false, it also leaves the function. No difference.</p>\n\n<p>On top of that, SDL returns NULL if window/renderer creation failed. From <a href=\"https://wiki.libsdl.org/SDL_CreateWindow\" rel=\"nofollow noreferrer\">SDL wiki on SDL_CreateWindow</a>:</p>\n\n<blockquote>\n  <p>Returns the window that was created or NULL on failure; call SDL_GetError() for more information.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 12164493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e84ac8aaad9dd32024bc0edf6fa0b7d?s=128&d=identicon&r=PG&f=1", "display_name": "vgauther", "link": "https://stackoverflow.com/users/12164493/vgauther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574936945, "creation_date": 1574894837, "last_edit_date": 1574936945, "question_id": 59079441, "link": "https://stackoverflow.com/questions/59079441/why-the-function-sdl-waitevent-sdl2-got-and-error-in-my-code", "title": "Why the function SDL_WaitEvent (SDL2) got and error in my code?", "body": "<p>i'm working on the wolf and I got an error sometimes detected as a segfault sometimes as a sig abort and sometimes we also got this error : 'thread is already initializing this class!'</p>\n\n<p>I used lldb and he show that the fonction WaitEvent go an error. The SDL_Event event; is initialized by this function some I don't understand how can i got an error.</p>\n\n<pre><code>int     main(int ac, char **av)\n{\n\n    int             fd;\n    t_var           var;\n    t_player        player;\n\n    ft_init_sdl(&amp;var);\n    init_key_move(&amp;var); // int attribution\n    if (ac != 2 || (fd = open(av[1], O_RDONLY)) &lt; 0)\n        exit(EXIT_FAILURE);\n    parsing_map(fd, &amp;var); // map parsing \n    var.m = fill_map_struct(var); // map parsing again\n    player_data_set(&amp;player, &amp;var); // int atribution for the player\n    open_wall_texture(&amp;var); //loading texture form bmp with SDL_LoadBPM\n    open_img_opt_button(&amp;var); // same\n    display(&amp;var, &amp;player); // displaying the game\n    return (0);\n}\n\n    void    ft_init_sdl(t_var *var)\n    {\n        var-&gt;sdl.window = NULL;\n        if (SDL_Init(SDL_INIT_VIDEO | SDL_INIT_EVENTS) &lt; 0)\n            return ;\n        var-&gt;sdl.window = SDL_CreateWindow(\"WOLFCRAFT\", SDL_WINDOWPOS_CENTERED, \\\n                SDL_WINDOWPOS_CENTERED, SIZE_X, SIZE_Y, 0);\n        var-&gt;sdl.render = SDL_CreateRenderer(var-&gt;sdl.window, -1, 0);\n        if (!var-&gt;sdl.window || !var-&gt;sdl.render)\n            return ;\n    }\n\nvoid    display_3(t_var *var, t_player *pl)\n{\n    if (var-&gt;sdl.event.type == SDL_QUIT)\n        ft_clean_quit(var-&gt;sdl.render, var-&gt;sdl.window);\n    else if (var-&gt;sdl.event.key.keysym.sym == SDLK_ESCAPE)\n        ft_clean_quit(var-&gt;sdl.render, var-&gt;sdl.window);\n    else if (var-&gt;sdl.event.type == SDL_KEYDOWN &amp;&amp; var-&gt;menu_is_act == 1)\n        ft_move(var-&gt;sdl.event.key.keysym.sym, pl, var-&gt;sdl.render, var);\n    if (var-&gt;sdl.event.type == SDL_MOUSEMOTION &amp;&amp; (var-&gt;menu_is_act == 1))\n    {\n        var-&gt;on = 1;\n        menu_button_in_game(var, pl);\n    }\n    else if (var-&gt;sdl.event.type == SDL_MOUSEBUTTONDOWN \\\n                    &amp;&amp; (var-&gt;menu_is_act == 1))\n    {\n        var-&gt;on = 0;\n        menu_button_in_game(var, pl);\n    }\n}\n\nvoid    display_2(t_var *var, t_player *pl, int *token)\n{\n    init_var_display(var, token);\n    ft_menu(var, pl);\n}\n\nvoid    display(t_var *var, t_player *pl)\n{\n    int token;\n\n    display_2(var, pl, &amp;token);\n    while (SDL_WaitEvent(&amp;var-&gt;sdl.event))\n    {\n        if (var-&gt;sdl.event.type == SDL_MOUSEMOTION \\\n                &amp;&amp; (var-&gt;menu_is_act == 0 || var-&gt;menu_is_act == 2))\n        {\n            var-&gt;on = 1;\n            ft_menu(var, pl);\n        }\n        else if (var-&gt;sdl.event.type == SDL_MOUSEBUTTONDOWN \\\n                        &amp;&amp; (var-&gt;menu_is_act == 0 || var-&gt;menu_is_act == 2))\n        {\n            var-&gt;on = 0;\n            ft_menu(var, pl);\n        }\n        else\n            display_3(var, pl);\n        if (var-&gt;menu_is_act == 2)\n        {\n            change_key(var, pl);\n            choose_key(var, pl);\n        }\n    }\n}\n</code></pre>\n\n<p>It's been a week we are searching for a solution we don't find anything.</p>\n\n<p>Thank you.</p>\n\n<p>Here is what lldb shows me with 'bt'.</p>\n\n<pre><code>Process 53017 launched: '/Users/vgauther/Desktop/work/wolf3d' (x86_64)\nProcess 53017 stopped\n* thread #1, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=EXC_I386_GPFLT)\n    frame #0: 0x00007fff542b22ce libobjc.A.dylib`_class_initialize + 37\nlibobjc.A.dylib`_class_initialize:\n-&gt;  0x7fff542b22ce &lt;+37&gt;: movq   0x20(%r14), %rax\n    0x7fff542b22d2 &lt;+41&gt;: movq   %rax, %rcx\n    0x7fff542b22d5 &lt;+44&gt;: andq   %rbx, %rcx\n    0x7fff542b22d8 &lt;+47&gt;: movq   0x8(%rcx), %rcx\nTarget 0: (wolf3d) stopped.\n(lldb) bt\n* thread #1, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=EXC_I386_GPFLT)\n  * frame #0: 0x00007fff542b22ce libobjc.A.dylib`_class_initialize + 37\n    frame #1: 0x00007fff542b1e8f libobjc.A.dylib`lookUpImpOrForward + 228\n    frame #2: 0x00007fff542b1914 libobjc.A.dylib`_objc_msgSend_uncached + 68\n    frame #3: 0x00007fff2a5696b6 AppKit`-[NSTextFieldCell _allowsVibrancyForControlView:] + 394\n    frame #4: 0x00007fff2a557871 AppKit`-[NSControl allowsVibrancy] + 49\n    frame #5: 0x00007fff2a55782a AppKit`-[NSView(NSInternal) _needsVibrancy] + 83\n    frame #6: 0x00007fff2a55766d AppKit`-[NSView(NSInternal) _updateVibrancy] + 26\n    frame #7: 0x00007fff2a674a25 AppKit`-[NSView viewWillDraw] + 87\n    frame #8: 0x00007fff2adeb6cf AppKit`_NSViewWillDraw + 45\n    frame #9: 0x00007fff2a674e21 AppKit`-[NSView viewWillDraw] + 1107\n    frame #10: 0x00007fff2adeb6cf AppKit`_NSViewWillDraw + 45\n    frame #11: 0x00007fff2a674e21 AppKit`-[NSView viewWillDraw] + 1107\n    frame #12: 0x00007fff2adeb6cf AppKit`_NSViewWillDraw + 45\n    frame #13: 0x00007fff2a674e21 AppKit`-[NSView viewWillDraw] + 1107\n    frame #14: 0x00007fff2adeb6cf AppKit`_NSViewWillDraw + 45\n    frame #15: 0x00007fff2a6746b9 AppKit`-[NSView _sendViewWillDrawInRect:clipRootView:] + 1640\n    frame #16: 0x00007fff2a672efd AppKit`-[NSView displayIfNeeded] + 1142\n    frame #17: 0x00007fff2a672a52 AppKit`-[NSWindow displayIfNeeded] + 321\n    frame #18: 0x00007fff2ae1360d AppKit`___NSWindowGetDisplayCycleObserver_block_invoke.5902 + 308\n    frame #19: 0x00007fff2a67255e AppKit`__37+[NSDisplayCycle currentDisplayCycle]_block_invoke + 695\n    frame #20: 0x00007fff38314877 QuartzCore`CA::Transaction::run_commit_handlers(CATransactionPhase) + 49\n    frame #21: 0x00007fff38313339 QuartzCore`CA::Transaction::commit() + 171\n    frame #22: 0x00007fff2ae2aa72 AppKit`__65+[CATransaction(NSCATransaction) NS_setFlushesWithDisplayRefresh]_block_invoke + 283\n    frame #23: 0x00007fff2cfb8257 CoreFoundation`__CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__ + 23\n    frame #24: 0x00007fff2cfb817f CoreFoundation`__CFRunLoopDoObservers + 527\n    frame #25: 0x00007fff2cf9a6f8 CoreFoundation`__CFRunLoopRun + 1240\n    frame #26: 0x00007fff2cf99f93 CoreFoundation`CFRunLoopRunSpecific + 483\n    frame #27: 0x00007fff2c284d96 HIToolbox`RunCurrentEventLoopInMode + 286\n    frame #28: 0x00007fff2c284a0f HIToolbox`ReceiveNextEventCommon + 366\n    frame #29: 0x00007fff2c284884 HIToolbox`_BlockUntilNextEventMatchingListInModeWithFilter + 64\n    frame #30: 0x00007fff2a533a3b AppKit`_DPSNextEvent + 2085\n    frame #31: 0x00007fff2acc9e34 AppKit`-[NSApplication(NSEvent) _nextEventMatchingEventMask:untilDate:inMode:dequeue:] + 3044\n    frame #32: 0x000000010017843a libSDL2-2.0.0.dylib`Cocoa_PumpEvents(_this=&lt;unavailable&gt;) at SDL_cocoaevents.m:438 [opt]\n    frame #33: 0x00000001000d5ecd libSDL2-2.0.0.dylib`SDL_WaitEventTimeout_REAL [inlined] SDL_PumpEvents_REAL at SDL_events.c:645 [opt]\n    frame #34: 0x00000001000d5eba libSDL2-2.0.0.dylib`SDL_WaitEventTimeout_REAL(event=0x00007ffeefbff1c8, timeout=-1) at SDL_events.c:680 [opt]\n    frame #35: 0x00000001000030e1 wolf3d`display + 49\n    frame #36: 0x00000001000012b9 wolf3d`main + 265\n    frame #37: 0x00007fff54ed8015 libdyld.dylib`start + 1\n</code></pre>\n\n<pre><code>/Users/vgauther/Desktop/check_compil/SDL2-2.0.9/src/video/cocoa/SDL_cocoamodes.m:118:11: warning: 'CGDisplayModeCopyPixelEncoding' is deprecated: first deprecated in macOS 10.11 [-Wdeprecated-declarations]\n    fmt = CGDisplayModeCopyPixelEncoding(vidmode);\n          ^\n/System/Library/Frameworks/CoreGraphics.framework/Headers/CGDirectDisplay.h:176:34: note: 'CGDisplayModeCopyPixelEncoding' has been explicitly marked deprecated here\nCG_EXTERN CFStringRef __nullable CGDisplayModeCopyPixelEncoding(\n                                 ^\n/Users/vgauther/Desktop/check_compil/SDL2-2.0.9/src/video/cocoa/SDL_cocoamodes.m:172:64: warning: 'CGDisplayIOServicePort' is deprecated: first deprecated in macOS 10.9 [-Wdeprecated-declarations]\n    CFDictionaryRef deviceInfo = IODisplayCreateInfoDictionary(CGDisplayIOServicePort(displayID), kIODisplayOnlyPreferredName);\n                                                               ^\n/System/Library/Frameworks/CoreGraphics.framework/Headers/CGDisplayConfiguration.h:372:24: note: 'CGDisplayIOServicePort' has been explicitly marked deprecated here\nCG_EXTERN io_service_t CGDisplayIOServicePort(CGDirectDisplayID display)\n                       ^\n2 warnings generated.\n  CC     build/SDL_cocoamouse.lo\n  CC     build/SDL_cocoamousetap.lo\n  CC     build/SDL_cocoaopengl.lo\n/Users/vgauther/Desktop/check_compil/SDL2-2.0.9/src/video/cocoa/SDL_cocoaopengl.m:219:21: warning: 'NSOpenGLPFAStereo' is deprecated: first deprecated in macOS 10.12 [-Wdeprecated-declarations]\n        attr[i++] = NSOpenGLPFAStereo;\n                    ^\n/System/Library/Frameworks/AppKit.framework/Headers/NSOpenGL.h:78:2: note: 'NSOpenGLPFAStereo' has been explicitly marked deprecated here\n        NSOpenGLPFAStereo NS_ENUM_DEPRECATED_MAC(10_0, 10_12)        =   6,\n        ^\n1 warning generated.\n  CC     build/SDL_cocoaopengles.lo\n  CC     build/SDL_cocoashape.lo\n  CC     build/SDL_cocoavideo.lo\n  CC     build/SDL_cocoavulkan.lo\n  CC     build/SDL_cocoawindow.lo\n/Users/vgauther/Desktop/check_compil/SDL2-2.0.9/src/video/cocoa/SDL_cocoawindow.m:342:11: warning: 'setAcceptsTouchEvents:' is deprecated: first deprecated in macOS 10.12.2 - Use allowedTouchTypes instead [-Wdeprecated-declarations]\n    [view setAcceptsTouchEvents:YES];\n          ^\n/System/Library/Frameworks/AppKit.framework/Headers/NSView.h:274:16: note: property 'acceptsTouchEvents' is declared deprecated here\n@property BOOL acceptsTouchEvents NS_DEPRECATED_MAC(10_6, 10_12_2, \"Use allowedTouchTypes instead\");\n               ^\n/System/Library/Frameworks/AppKit.framework/Headers/NSView.h:274:16: note: 'setAcceptsTouchEvents:' has been explicitly marked deprecated here\n1 warning generated.\n</code></pre>\n"}, {"tags": ["c#", "c", "winforms-interop"], "comments": [{"owner": {"reputation": 6441, "user_id": 690952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9WfV.png?s=128&g=1", "display_name": "Selvin", "link": "https://stackoverflow.com/users/690952/selvin"}, "edited": false, "score": 0, "creation_date": 1574894329, "post_id": 59079363, "comment_id": 104395843, "body": "<i>Use the struct definition from the dll</i> from native dll? there is no struct definition there ..."}, {"owner": {"reputation": 1, "user_id": 12448558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95f089c98d80ac31fc9487dc0dc49cf8?s=128&d=identicon&r=PG&f=1", "display_name": "tenfoldpaper", "link": "https://stackoverflow.com/users/12448558/tenfoldpaper"}, "reply_to_user": {"reputation": 6441, "user_id": 690952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9WfV.png?s=128&g=1", "display_name": "Selvin", "link": "https://stackoverflow.com/users/690952/selvin"}, "edited": false, "score": 0, "creation_date": 1574895482, "post_id": 59079363, "comment_id": 104396136, "body": "I meant the structs that are shown in the .h files, like classifier_Parameter_t"}, {"owner": {"reputation": 6441, "user_id": 690952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9WfV.png?s=128&g=1", "display_name": "Selvin", "link": "https://stackoverflow.com/users/690952/selvin"}, "edited": false, "score": 1, "creation_date": 1574895854, "post_id": 59079363, "comment_id": 104396223, "body": "then 1. translate native structures to C# 2. translate native funtions to delegates 3. use <code>LoadLibrary</code>, <code>GetProcAddress</code>, <code>FreeLibrary</code> from winapi 4. use <code>Marshal.GetDelegateForFunctionPointer&lt;&gt;</code> to get delegate from function pointer"}], "answers": [{"comments": [{"owner": {"reputation": 1129, "user_id": 1073351, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8d1da17c32728856fd0a9aaeab3b48be?s=128&d=identicon&r=PG", "display_name": "Mark McWhirter", "link": "https://stackoverflow.com/users/1073351/mark-mcwhirter"}, "reply_to_user": {"reputation": 6441, "user_id": 690952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9WfV.png?s=128&g=1", "display_name": "Selvin", "link": "https://stackoverflow.com/users/690952/selvin"}, "edited": false, "score": 0, "creation_date": 1574897245, "post_id": 59079665, "comment_id": 104396552, "body": "@Selvin thanks for the tips on LoadLibrary, GetProcAddress, and FreeLibrary"}, {"owner": {"reputation": 6441, "user_id": 690952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9WfV.png?s=128&g=1", "display_name": "Selvin", "link": "https://stackoverflow.com/users/690952/selvin"}, "edited": false, "score": 0, "creation_date": 1574897250, "post_id": 59079665, "comment_id": 104396554, "body": "in fact it should work with <a href=\"https://stackoverflow.com/questions/53198213/calling-c-function-with-lpstr-return-value-from-c-sharp/53201035#53201035\"><code>string passwd</code>, <code>string salt</code> and <code>StringBuilder buf</code></a>"}, {"owner": {"reputation": 1129, "user_id": 1073351, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8d1da17c32728856fd0a9aaeab3b48be?s=128&d=identicon&r=PG", "display_name": "Mark McWhirter", "link": "https://stackoverflow.com/users/1073351/mark-mcwhirter"}, "reply_to_user": {"reputation": 6441, "user_id": 690952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9WfV.png?s=128&g=1", "display_name": "Selvin", "link": "https://stackoverflow.com/users/690952/selvin"}, "edited": false, "score": 0, "creation_date": 1574897465, "post_id": 59079665, "comment_id": 104396604, "body": "@Selvin - Yes there are usually a few ways of representing it - whatever will be the most elegant for you."}, {"owner": {"reputation": 1, "user_id": 12448558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95f089c98d80ac31fc9487dc0dc49cf8?s=128&d=identicon&r=PG&f=1", "display_name": "tenfoldpaper", "link": "https://stackoverflow.com/users/12448558/tenfoldpaper"}, "edited": false, "score": 0, "creation_date": 1574954936, "post_id": 59079665, "comment_id": 104418474, "body": "Thanks for the info about the other libraries. I will have a look into it. But the problem is precisely that I am supposed to assume that I do not know how many DLLs there actually will be, and how they will be structured. It seems to be rather tricky to achieve with C-based DLLs, so I may have to propose a change to this project..."}, {"owner": {"reputation": 1129, "user_id": 1073351, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8d1da17c32728856fd0a9aaeab3b48be?s=128&d=identicon&r=PG", "display_name": "Mark McWhirter", "link": "https://stackoverflow.com/users/1073351/mark-mcwhirter"}, "edited": false, "score": 0, "creation_date": 1575055268, "post_id": 59079665, "comment_id": 104451386, "body": "Please vote  if this was a proper response for your problem :)"}], "tags": [], "owner": {"reputation": 1129, "user_id": 1073351, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8d1da17c32728856fd0a9aaeab3b48be?s=128&d=identicon&r=PG", "display_name": "Mark McWhirter", "link": "https://stackoverflow.com/users/1073351/mark-mcwhirter"}, "is_accepted": false, "score": 0, "last_activity_date": 1574897399, "last_edit_date": 1574897399, "creation_date": 1574896430, "answer_id": 59079665, "question_id": 59079363, "link": "https://stackoverflow.com/questions/59079363/dynamically-calling-different-c-dlls-in-c/59079665#59079665", "title": "Dynamically calling different C DLLs in C#", "body": "<p>In answer to your first question, I am not aware of any way to obtain the struct definition straight off of a dll. (Try LoadLibrary, GetProcAddres)  with the possible exception of one built for debugging.\nIf you know the structure you will use in C then it should be pretty straight forward\nto define the structure for use in C# - there are plenty of examples in sites like pinvoke.net.</p>\n\n<p>For instance this function declaration in C:</p>\n\n<pre><code>__declspec(dllexport) int scrypt(const uint8_t * passwd, size_t passwdlen, \n       const uint8_t * salt, size_t saltlen, uint64_t N, uint32_t r, \n       uint32_t p,uint8_t * buf, size_t buflen);\n</code></pre>\n\n<p>can be transformed into:</p>\n\n<pre><code>[DllImport(\"SCrypt.dll\", CharSet = CharSet.Unicode, \n    CallingConvention = CallingConvention.Cdecl, SetLastError = true)]\npublic static extern int scrypt(byte[] passwd, uint passwdlen, byte[] salt, uint saltlen,\n    ulong N, uint r, uint p, byte[] buf, uint buflen);\n</code></pre>\n\n<p>Secondly, you can try copying in your program a dll to a known location (executing directory for instance) before using it.  Compiling the code with the dlls in place \nwill then work.  This technique is of course assuming you know the dlls you are going\nto reference beforehand.</p>\n"}], "owner": {"reputation": 1, "user_id": 12448558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95f089c98d80ac31fc9487dc0dc49cf8?s=128&d=identicon&r=PG&f=1", "display_name": "tenfoldpaper", "link": "https://stackoverflow.com/users/12448558/tenfoldpaper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1574897399, "creation_date": 1574894217, "question_id": 59079363, "link": "https://stackoverflow.com/questions/59079363/dynamically-calling-different-c-dlls-in-c", "title": "Dynamically calling different C DLLs in C#", "body": "<p>I'm currently creating a Windows Form application in C#, where different .dll files written in C with their own structs and functions need to be called in the application at runtime through a file dialog to obtain their path. To my understanding, this means that I cannot use <code>[DllImport(\"filename\")]</code>, since the path values are not determined at compile time. I'm at least given the .h files, and also a guarantee that the exported functions will have the same name. </p>\n\n<p>I've scoured through a lot of different posts online, and most of the solutions pointed eventually towards PInvoke, Reflection and/or the InteropServices, but with no clear examples on what to do.</p>\n\n<p>Since each such dll defines their own structs, I'd like to be able to:\n1. Use the struct definition from the dll itself to avoid redefining everything in C#,\n2. Use the functions at different points in the application after loading the dll.</p>\n\n<p>Admittedly, I am very new at C#, so what I am trying to do above might not even be possible. But I'm at a loss right now, as I cannot find where to even begin start learning in order to address this problem. Any help would be greatly appreciated.</p>\n\n<p>Here's the code for reference:</p>\n\n<p>One of the dlls' header files classifier.h:</p>\n\n<pre><code>#ifndef SRC_CLASSIFIER_H_\n#define SRC_CLASSIFIER_H_\n\n#include \"vector.h\"\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\n#ifdef BUILD_DYNAMIC_LIB\n#ifdef _WIN32\n#define _EXPORT __declspec(dllexport)\n#else\n#define _EXPORT __attribute__((visibility(\"default\")))\n#endif\n#else\n#define _EXPORT\n#endif\n\n/** Error codes */\n#define CLASSIFIER_OK 0x00\n#define CLASSIFIER_INIT_MISSING 0x01\n#define CLASIFIER_NO_SAMPLES_PROVIDED 0x02\n#define CLASSIFIER_PARAM_OUT_OF_RANGE 0x03\n#define CLASSIFIER_DECISION_BUFFER_LEN 20\n#define CLASSIFIER_MAX_BURST_LEN 32\n\ntypedef struct {\n    uint8_t sensitivity;\n    uint8_t noTruckRecognitionLimit;\n    uint8_t noTruckRecognitionHyst;\n    uint16_t intensityLimit[CLASSIFIER_MAX_BURST_LEN];\n} classifier_Parameter_t;\n\ntypedef enum { UNDEFINED = 0x00, TRUCK = 0x01, NO_TRUCK = 0x02 } class_t;\n\ntypedef struct {\n     class_t classifiedAs;\n} classifier_Result_t;\n\ntypedef struct {\n    uint8_t noOfSamples;\n    vec3d_t accSamples[CLASSIFIER_MAX_BURST_LEN];\n} classifier_Input_t;\n\n_EXPORT uint8_t classifier_api_Init(classifier_Parameter_t *para);\n\n_EXPORT uint8_t classifier_api_Execute(classifier_Input_t *input,\n                                       classifier_Result_t *result);\n\n_EXPORT uint8_t classifier_api_Reset(void);\n\n#ifdef __cplusplus\n}\n#endif\n\n#endif /* SRC_CLASSIFIER_H_ */\n</code></pre>\n\n<p>And the C# file MainForm.cs:</p>\n\n<pre><code>using System;\n...\n\nnamespace ClassifierEval\n{\n\npublic partial class MainForm : Form\n    {\n\n        public MainForm()\n        {\n            InitializeComponent();\n        }\n\n\n        private void btnLoadDll_Click(object sender, EventArgs e)\n        {\n            openFileDialogLoadDll.ShowDialog();\n\n        }\n\n        private void openFileDialogLoadDll_FileOk(object sender, CancelEventArgs e)\n        {\n            lblLoadedDll.Text = openFileDialogLoadDll.FileName;\n            ///Loading the DLL here?\n        }\n...\n}\n</code></pre>\n"}, {"tags": ["c", "loops", "for-loop", "multidimensional-array", "while-loop"], "comments": [{"owner": {"reputation": 1404, "user_id": 10496710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cb3d11da053d8e1e94ef99a27ca6af?s=128&d=identicon&r=PG&f=1", "display_name": "B. Go", "link": "https://stackoverflow.com/users/10496710/b-go"}, "edited": false, "score": 0, "creation_date": 1574893956, "post_id": 59079282, "comment_id": 104395730, "body": "you most likely need to move the horizontal=0 up one loop, else you always overwrite your results!"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574894110, "post_id": 59079282, "comment_id": 104395782, "body": "<a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>"}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1574896006, "last_edit_date": 1574896006, "creation_date": 1574894949, "answer_id": 59079454, "question_id": 59079282, "link": "https://stackoverflow.com/questions/59079282/n-x-n-tic-tac-toe-check-for-win/59079454#59079454", "title": "N x N Tic Tac Toe Check For Win", "body": "<p>For starters it is a bad idea when a function uses global variables though it can be defined without an access to the global variables.</p>\n\n<p>Nevertheless your function can be defined the following way</p>\n\n<pre><code>void HorizontalWin()\n{\n    horizontal = 0;\n\n    for ( int i = 0; !horizontal &amp;&amp; i &lt; size; i++ )\n    {\n        if ( board[i][0] != '_' )\n        {\n            int j = 1;\n            while ( j &lt; size &amp;&amp; board[i][j] == board[i][0] ) j++;\n            horizontal = j == size;\n        }\n    }\n} \n</code></pre>\n\n<p>As for your function implementation then it has undefined behavior because at least in this if statement</p>\n\n<pre><code>if(board[i-1][j-1]==board[i-1][j] &amp;&amp; board[i][j]!='_')\n</code></pre>\n\n<p>there is an attempt to access the memory beyond the array when i or j are equal to 0.  </p>\n"}], "owner": {"reputation": 9, "user_id": 12448586, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--qvWgS7Jt3g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reDhpmUHDfpzg-NRMlYt0oFeM8z5A/photo.jpg?sz=128", "display_name": "Sohel", "link": "https://stackoverflow.com/users/12448586/sohel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574896006, "creation_date": 1574893650, "last_edit_date": 1574895607, "question_id": 59079282, "link": "https://stackoverflow.com/questions/59079282/n-x-n-tic-tac-toe-check-for-win", "title": "N x N Tic Tac Toe Check For Win", "body": "<p>for the last 2 days I've been trying to make an N x N Tic Tac Toe game and i have a problem that i didn't understand why this problem is happening and I'll be so happy if someone can help me solving this issue. the problem is when i check for Horizontal Win my program checks only the first row and don't check other rows. Here is the function i used to check the horizontal win:</p>\n\n<pre><code>void HorizontalWin()\n{\n    for(int i=0; i&lt;size; i++){\n        for(int j=0; j&lt;size; ++j){\n            if(board[i-1][j-1]==board[i-1][j] &amp;&amp; board[i][j]!='_')\n                horizontal=1;\n            else {\n                horizontal=0;\n                break;\n            }\n        }\n        if (horizontal==1)\n            break;\n    }\n}\n\n</code></pre>\n\n<p>size:is the size of the grid and its taken from the user.</p>\n"}, {"tags": ["c", "pointers", "struct", "c-strings"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1574893738, "post_id": 59079269, "comment_id": 104395663, "body": "<code>*txt-&gt;substring</code> isn&#39;t a pointer, it&#39;s a character, so it can&#39;t be assigned a pointer value."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 4, "last_activity_date": 1574894290, "last_edit_date": 1574894290, "creation_date": 1574893777, "answer_id": 59079306, "question_id": 59079269, "link": "https://stackoverflow.com/questions/59079269/pointing-to-char-in-string-inside-a-struct-pointer/59079306#59079306", "title": "Pointing to char in string inside a struct pointer", "body": "<p>It seems you mean</p>\n\n<pre><code>void some_function(struct line *txt)\n{\n    strcpy( txt-&gt;substring, txt-&gt;string + 4 );\n}\n</code></pre>\n\n<p>The data member substring does not have a pointer type. It is an array. So you may not assign a pointer to an array. You can copy elements of one array to another array.</p>\n\n<p>As for this expression statement</p>\n\n<pre><code>*(txt-&gt;substring) = &amp;(txt-&gt;string[4]);\n</code></pre>\n\n<p>then the left operand has the type <code>char</code> while the right operand has the type <code>char *</code>. So this assignment in any case does not make sense.</p>\n\n<p>If the structure would be defined like</p>\n\n<pre><code>struct line\n{\n    char string[10];\n    char *substring;\n};\n</code></pre>\n\n<p>then within the function you could write</p>\n\n<pre><code>void some_function(struct line *txt)\n{\n    txt-&gt;substring = txt-&gt;string + 4;\n}\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 10424452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5f23d33ed0a7b65ad5d59ee9d73f14?s=128&d=identicon&r=PG&f=1", "display_name": "Mick", "link": "https://stackoverflow.com/users/10424452/mick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 59079306, "answer_count": 1, "score": 2, "last_activity_date": 1574894290, "creation_date": 1574893586, "last_edit_date": 1574894185, "question_id": 59079269, "link": "https://stackoverflow.com/questions/59079269/pointing-to-char-in-string-inside-a-struct-pointer", "title": "Pointing to char in string inside a struct pointer", "body": "<p>Normally in C you can point to a specific char of a string to obtain a substring. Example:</p>\n\n<pre><code>char string[10];\nstrcpy(string, \"foo bar\");\nchar *substring = &amp;string[4];\n\n// string = \"foo bar\"\n// substring = \"bar\"\n</code></pre>\n\n<p>But what would be the syntax when you are dealing with struct pointers? I thought it would be something like this but it returns garbage data:</p>\n\n<pre><code>struct line\n{\n    char string[10];\n    char substring[10];\n};\n\nvoid some_function(struct line *txt)\n{\n    *(txt-&gt;substring) = &amp;(txt-&gt;string[4]);\n}\n\nint main()\n{\n    struct line text;\n    strcpy(text.string, \"foo bar\");\n\n    some_function(&amp;text);\n    printf(\"\\n-%s-\\n\", text.string);\n    printf(\"\\n-%s-\", text.substring); // returns garbage data\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 63634, "user_id": 215752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/face3276756bf64319a7d1df0d194d5c?s=128&d=identicon&r=PG", "display_name": "Hogan", "link": "https://stackoverflow.com/users/215752/hogan"}, "edited": false, "score": 5, "creation_date": 1574891063, "post_id": 59078831, "comment_id": 104394777, "body": "this is called recursion.  Your example won&#39;t work.  When n is zero it will keep calling itself and blow up the stack.  You will have a stack overflow.  You came to the right place."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 63634, "user_id": 215752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/face3276756bf64319a7d1df0d194d5c?s=128&d=identicon&r=PG", "display_name": "Hogan", "link": "https://stackoverflow.com/users/215752/hogan"}, "edited": false, "score": 2, "creation_date": 1574891277, "post_id": 59078831, "comment_id": 104394847, "body": "@Hogan It works.:)"}, {"owner": {"reputation": 121, "user_id": 7154730, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Tnyp.png?s=128&g=1", "display_name": "cand", "link": "https://stackoverflow.com/users/7154730/cand"}, "edited": false, "score": 0, "creation_date": 1574891433, "post_id": 59078831, "comment_id": 104394904, "body": "aparent aditing a clause like <code>if(loop == f) printf(&quot;cursed\\n&quot;); else f();</code> makes it works even calling itself."}, {"owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "edited": false, "score": 0, "creation_date": 1574891435, "post_id": 59078831, "comment_id": 104394907, "body": "This code is fine, It&#39;s not what the question is about anyway."}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1574893722, "post_id": 59079019, "comment_id": 104395652, "body": "Conversions between function pointers are defined, at least so that, if you convert back, the result equals the original pointer. So make the argument a function pointer instead of <code>void *</code>, then convert it to the desired function type, and the behavior will be defined by the C standard."}], "tags": [], "owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "is_accepted": true, "score": 3, "last_activity_date": 1574950453, "last_edit_date": 1574950453, "creation_date": 1574891987, "answer_id": 59079019, "question_id": 59078831, "link": "https://stackoverflow.com/questions/59078831/is-it-possible-to-write-a-function-that-receives-itself-as-parameter/59079019#59079019", "title": "Is it possible to write a function that receives itself as parameter?", "body": "<p>Take a look:</p>\n\n<pre><code>int f(void (*p)(void), int n)\n{\n    if (n == 0)\n        return 0;\n\n    int (*g)(void (*)(void), int) = p;\n    return 2 + g(p, n - 1);\n}\n\nint main(void)\n{\n    void (*p)(void) = f;\n    return f(p, 3);\n}\n</code></pre>\n\n<p><sup><em>Note: I wrote it like this for clarity -- if you want to remove warnings about incompatible pointer types, you need to cast explicitly the pointers.</em></sup></p>\n\n<p>The following program's return code is <code>6</code>, i.e. <code>3</code> multiplied by <code>2</code>. As you can see, we are passing <code>f</code> to itself explicitly in <code>main()</code>, i.e. <code>f(f, 3)</code>.</p>\n\n<p>What happens inside <code>f</code> itself is even funnier, because <code>f</code> is calling <code>f</code> with <code>f</code> as the argument (although <code>f</code> does not know that).</p>\n"}], "owner": {"reputation": 121, "user_id": 7154730, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Tnyp.png?s=128&g=1", "display_name": "cand", "link": "https://stackoverflow.com/users/7154730/cand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 59079019, "answer_count": 1, "score": 1, "last_activity_date": 1574950453, "creation_date": 1574890870, "last_edit_date": 1574892642, "question_id": 59078831, "link": "https://stackoverflow.com/questions/59078831/is-it-possible-to-write-a-function-that-receives-itself-as-parameter", "title": "Is it possible to write a function that receives itself as parameter?", "body": "<p>I was thinking, you can pass a function to a function as function pointer like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid loop(void(*f)(), int n){\n    if(f == NULL)\n        printf(\"is this cursed use of recursion?\\n\");\n    else{\n        f();\n        if(n == 0)\n            loop(NULL, n);\n        else\n            loop(f, n - 1);\n        return;\n    }\n}\nvoid f(){\n    printf(\"hello world\\n\");\n}\nint main(){\n    loop(f, 5);\n    return 0;\n}\n</code></pre>\n\n<p>So a thing came to my mind, is it actually possible to do a function that in some way receives itself as parameter in C?</p>\n"}, {"tags": ["c", "input", "return", "scanf", "c99"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1574890774, "post_id": 59078784, "comment_id": 104394683, "body": "because scanf could parse 4 out of your string. It&#39;s enough for scanf to be happy."}, {"owner": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1574890849, "post_id": 59078784, "comment_id": 104394712, "body": "but how could I detect if it&#39;s integer or not in simple fast way without destroying my whole code in c?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1574890852, "post_id": 59078784, "comment_id": 104394713, "body": "Quote from the man page: <i>On  success, these functions return the number of input items successfully matched and assigned; this can be fewer than provided for, or even zero, in the event of an early matching failure.</i>. The input <code>4.5</code> would match the 4 and assign it to <code>&amp;x</code> and leave <code>.5</code> behind in the buffer. Hence it returns 1."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1574890992, "post_id": 59078784, "comment_id": 104394748, "body": "&quot;but how could I detect if it&#39;s integer or not in simple fast way without destroying my whole code in c?&quot; <code>scanf</code> is the wrong function for that. Better read the whole line with <code>fgets</code> and parse it using better functions like <code>strtol</code>, <code>stroul</code>, etc. See  Jean-Fran&#231;ois Fabre&#39;s answer."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1574899292, "post_id": 59078784, "comment_id": 104397036, "body": "<i>but how could I detect if it&#39;s integer or not in simple fast way?</i> By <b>not using <code>scanf</code></b>.  There are a few (a very few) things <code>scanf</code> is good for, but reading integers <i>and</i> accurately complaining if non-integer input is received is simply not one of them.  Be nice to yourself: don&#39;t waste any more time on <code>scanf</code>; <a href=\"https://stackoverflow.com/questions/58403537/what-can-i-use-to-parse-input-instead-of-scanf\">learn about some better alternatives</a>."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "edited": false, "score": 0, "creation_date": 1574891034, "post_id": 59078827, "comment_id": 104394767, "body": "How to check that input is an integer?"}, {"owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "reply_to_user": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "edited": false, "score": 0, "creation_date": 1574891469, "post_id": 59078827, "comment_id": 104394921, "body": "Generally you can&#39;t prevent user from entering a double and scanf interpret it as an int."}], "tags": [], "owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "is_accepted": false, "score": 0, "last_activity_date": 1574891094, "last_edit_date": 1574891094, "creation_date": 1574890858, "answer_id": 59078827, "question_id": 59078784, "link": "https://stackoverflow.com/questions/59078784/scanf-returns-1-instead-of-0-when-an-error-occurres/59078827#59078827", "title": "Scanf returns 1 instead of 0 when an error occurres", "body": "<blockquote>\n  <p>I have using the returned value to detect if the input is an integer or not but if the input was 4.5 scanf returns 1 while if the input was g scanf returns 0.</p>\n</blockquote>\n\n<p>That actually makes sense in this case.</p>\n\n<p>int ReturnedValue=scanf(\"%d\",&amp;x);</p>\n\n<p>Remember <code>scanf</code> return value is the number of items parsed correctly.</p>\n\n<ul>\n<li><p>If you enter 4.5, it only reads the first digit 4 and interprets the <code>int</code> value correctly. It discards all the remaining invalid characters from the input.</p></li>\n<li><p>If you enter <code>d</code>, then scanf fails completely (it cannot parse any int) and so it returns 0.</p></li>\n</ul>\n\n<p>Refer to the scanf manual - to see why 4.5 is parsed as integer 4:</p>\n\n<blockquote>\n  <p>Reading of characters stops either when this maximum\n                is reached or when a nonmatching character is found, whichever\n                happens first.</p>\n</blockquote>\n\n<p><a href=\"http://man7.org/linux/man-pages/man3/scanf.3.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man3/scanf.3.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "is_accepted": false, "score": 5, "last_activity_date": 1574890858, "creation_date": 1574890858, "answer_id": 59078828, "question_id": 59078784, "link": "https://stackoverflow.com/questions/59078784/scanf-returns-1-instead-of-0-when-an-error-occurres/59078828#59078828", "title": "Scanf returns 1 instead of 0 when an error occurres", "body": "<p>The return value is not signaling success or failure. It is the number of successfully converted values.</p>\n\n<p>That's why you got \"1\" on \"4.5\" with <code>\"%d\"</code> as format, the \"4\" was converted.</p>\n\n<p>You would have found this by reading the documentation of <code>scanf()</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "edited": false, "score": 0, "creation_date": 1574891039, "post_id": 59078835, "comment_id": 104394770, "body": "How to check that input is an integer?"}, {"owner": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "edited": false, "score": 0, "creation_date": 1574891055, "post_id": 59078835, "comment_id": 104394773, "body": "I am forced to use scanf in collage"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "edited": false, "score": 0, "creation_date": 1574891089, "post_id": 59078835, "comment_id": 104394787, "body": "maybe by first scanning with %f format to detect extra dot\u2026 edited. But still not the best solution."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "edited": false, "score": 1, "creation_date": 1574891295, "post_id": 59078835, "comment_id": 104394856, "body": "@John sadly a lot of people use the <code>scanf</code> family of function incorrectly and teachers (and books and tutorial) make the mistake of teaching <code>scanf</code> as the way to read from the user. But <code>scanf</code> is not there to read random user data but they &quot;scan[s] input according to [a] format&quot;. User input is random, can have errors, be incomplete and sometimes is very hard to find a good pattern to catch it all. Because these functions scan the input, when they fail, they leave stuff in the buffer behind which can be a big gotcha, when you don&#39;t know what your are doing..."}, {"owner": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "edited": false, "score": 0, "creation_date": 1574891359, "post_id": 59078835, "comment_id": 104394874, "body": "ok but how to detect if the number has dot? to me 2.0 is not an integer"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1574891365, "post_id": 59078835, "comment_id": 104394875, "body": "My advice would be not to use <code>scanf</code> to read from the user but use <code>fgets</code> to get the whole line and the user better functions to parse the input. Bending <code>scanf</code> to accept/deny all kind of inputs will only end in frustration."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "edited": false, "score": 1, "creation_date": 1574891494, "post_id": 59078835, "comment_id": 104394931, "body": "@John use <code>strtol</code>. The second parameter of <code>strtol</code> is a pointer to a <code>char*</code> that is set to the first non-integer character in the stream. If the whole c-string is an integer, then deference to <code>&#39;\\0&#39;</code>, something else otherwise. That&#39;s how you do it."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1574899560, "post_id": 59078835, "comment_id": 104397090, "body": "If you simply <i>have</i> to use <code>scanf</code>, if some ninny has forbidden the use of superior alternatives like <code>fgets</code>, I suppose you could read lines using <code>scanf(&quot;%99[^\\n]\\n&quot;, linebuf);</code>, and then operate on <code>linebuf</code> as you would have done after calling <code>fgets</code>, if you were allowed to."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1574899711, "post_id": 59078835, "comment_id": 104397123, "body": "<i>I am forced to use scanf in college.</i> If it were me, I would just ignore that requirement.  <code>scanf</code> is square training wheels.  No real C programmers use it for anything; its sole purpose is to frustrate beginners as they desperately try to use it to get numbers into their beginning programs to work on.  The sooner you can abandon it and <a href=\"https://stackoverflow.com/questions/58403537/what-can-i-use-to-parse-input-instead-of-scanf\">move on to better alternatives</a>, the better."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 3, "last_activity_date": 1574891414, "last_edit_date": 1574891414, "creation_date": 1574890880, "answer_id": 59078835, "question_id": 59078784, "link": "https://stackoverflow.com/questions/59078784/scanf-returns-1-instead-of-0-when-an-error-occurres/59078835#59078835", "title": "Scanf returns 1 instead of 0 when an error occurres", "body": "<p>Problem is that <code>scanf</code> (or <code>atoi</code>) aren't really reliable to parse integers.</p>\n\n<p>In your case, <code>scanf</code> finds <code>4</code> and is happy with that, which explains the 1 return code.</p>\n\n<p>A safest way is to use the <code>strtol</code>, <code>strtoul</code> .. primitives that make sure that the <em>word</em> is valid as an integer (for more details check <a href=\"https://stackoverflow.com/questions/26583717/how-to-scanf-only-integer\">How to scanf only integer?</a> where the answer is \"don't use <code>scanf</code>\" BTW :))</p>\n\n<p>In your particular case (stuck with <code>scanf</code>), you <em>could</em> make input more robust by scanning as <em>float</em> first (using <code>%f</code> on a float variable). And checking if the floating point value is an <em>integer</em>.</p>\n\n<pre><code>float xf;\nif (scanf(\"%f\",&amp;xf) == 1)\n{\n     // one integer or float was scanned\n     x = (int)xf;\n     if (x==xf)\n     {\n        // scanned value is an integer: valid\n     }\n}\n</code></pre>\n\n<p>But inputs like <code>4XXXX</code> would still be wrongly accepted. If you <em>have</em> to use <code>scanf</code>, then you have to accept a degree of risk.</p>\n"}, {"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1574892833, "creation_date": 1574892833, "answer_id": 59079151, "question_id": 59078784, "link": "https://stackoverflow.com/questions/59078784/scanf-returns-1-instead-of-0-when-an-error-occurres/59079151#59079151", "title": "Scanf returns 1 instead of 0 when an error occurres", "body": "<p>I initially didn't want to write an answer and left comments behind. I'd like\nto expand on <a href=\"https://stackoverflow.com/a/59078835/1480131\">Jean-Fran\u00e7ois Fabre</a>'s answer.</p>\n\n<p>The problem with the <code>scanf</code> family is that they don't do what most people\nbelieve they do and then they are left confused as to why it does something \"strange\". In reality they scan input based on an format and assign values to\nvariables (passed via pointers). When they encounter an error, i.a. something\ndoesn't match to the format, then they stop.</p>\n\n<p>With the format <code>\"%d\"</code> you are just saying read an integer. The format doesn't\nsay \"read an integer and only an integer\". To do that you would need to also\nexclude everything else and if I'm not mistaken it would be something like\nthis <code>\"%d[^0-9]*\"</code> (I haven't tested it to see if I'm right).\nThat's why the user input <code>4.5</code> is accepted by\n<code>scanf</code>. Note that <code>scanf</code> is not doing it incorrectly, you are specifying it\nincorrectly, because you assume, that <code>\"%d\"</code> means \"and integer and integer\nonly\".</p>\n\n<p>As you can see, it is pretty hard to come up with a format that catches\neverything and also tells you when the user made an error. User input aka what\nthe user enters is random and can contain (unintentionally) errors, miss the\nformat, etc. So you end up with very complex formats to just determine if the\nuser added a dot at the end and fail if the user does that.</p>\n\n<p>That's why my advice is to read the while input via <code>fgets</code> and then use something better\nto parse the input like <code>strtol</code> or even <code>sscanf</code> if you have a good format.</p>\n\n<p>Here an example for the usage of <code>strtol</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    const char *entries[] = { \"4.5\", \"4\", \"some random text\" };\n    char *ptr;\n\n    int i;\n    for(i = 0; i &lt; sizeof entries / sizeof *entries; ++i)\n    {\n        long int res = strtol(entries[i], &amp;ptr, 0);\n\n        if(*ptr != '\\0') {\n            printf(\"The input '%s' is not an integer. The non-integer is '%s'\\n\", entries[i], ptr);\n        } else {\n            printf(\"The input '%s' is an integer: %ld\\n\", entries[i], res);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>which returns</p>\n\n<pre><code>The input '4.5' is not an integer. The non-integer is '.5'\nThe input '4' is an integer: 4\nThe input 'some random text' is not an integer. The non-integer is 'some random text'\n</code></pre>\n\n<p>This is a more precise way to check if the whole input is an integer or not.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1574896840, "creation_date": 1574896840, "answer_id": 59079726, "question_id": 59078784, "link": "https://stackoverflow.com/questions/59078784/scanf-returns-1-instead-of-0-when-an-error-occurres/59079726#59079726", "title": "Scanf returns 1 instead of 0 when an error occurres", "body": "<blockquote>\n  <p>Scanf returns 1 instead of 0 when an error occurs</p>\n</blockquote>\n\n<p>An error did not occur in input.  The first character <code>\"4\"</code> converts nicely to a <code>4</code>.  Code needs to examine the rest of the line.</p>\n\n<blockquote>\n  <p>I am forced to use scanf in collage</p>\n</blockquote>\n\n<p>Such coding constraints are unfortunate.  <code>fgets()/strtol()</code> would be better.</p>\n\n<blockquote>\n  <p>how could I detect if it's integer or not in simple fast way without destroying my whole code in c?  </p>\n</blockquote>\n\n<p>Scan for the integer and look for trailing junk.</p>\n\n<pre><code>char endchar;  \nint cnt = scanf(\"%d%c\",&amp;x, &amp;endchar);\nif (cnt == EOF) puts(\"End-of-file occurred\");\nelse if (cnt == 1 || (cnt == 2 &amp;&amp; endchar == '\\n')) printf(\"Success %d\\n\", x);\nelse puts(\"Non-integer input\");\n</code></pre>\n\n<p>When data is <em>non-integer input</em>, some offending characters may remain in <code>stdin</code>.  As this task is only to read one <code>int</code>, that is OK.</p>\n\n<p>Production code would more likely read a <em>line</em> and then parse it.</p>\n"}], "owner": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 5, "score": 2, "last_activity_date": 1574896840, "creation_date": 1574890630, "question_id": 59078784, "link": "https://stackoverflow.com/questions/59078784/scanf-returns-1-instead-of-0-when-an-error-occurres", "title": "Scanf returns 1 instead of 0 when an error occurres", "body": "<p>I have read that the returned value of <code>scanf</code> indicates if it successfully was able to read and convert values.\nI have using the returned value to detect if the input is an integer or not but if the input was <code>4.5</code> <code>scanf</code> returns 1 while if the input was <code>g</code> <code>scanf</code> returns 0.\nHer's my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int x;\n    int ReturnedValue=scanf(\"%d\",&amp;x);\n    printf(\"Scanf Returned:%d\",ReturnedValue);\n    return 0;\n}\n</code></pre>\n\n<p>in Multiple different articles you suggested to use the returned value of <code>scanf</code> to detect for integers but why this didn't work now?</p>\n"}, {"tags": ["c", "iot", "contiki", "contiki-process"], "answers": [{"tags": [], "owner": {"reputation": 648, "user_id": 9044792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zp7h3.png?s=128&g=1", "display_name": "Chris Dueck", "link": "https://stackoverflow.com/users/9044792/chris-dueck"}, "is_accepted": true, "score": 1, "last_activity_date": 1576857245, "last_edit_date": 1576857245, "creation_date": 1574892442, "answer_id": 59079096, "question_id": 59078597, "link": "https://stackoverflow.com/questions/59078597/start-contiki-process-from-a-process/59079096#59079096", "title": "Start Contiki process from a process", "body": "<p>According to the <a href=\"https://github.com/contiki-os/contiki/wiki/Processes#Starting_Processes\" rel=\"nofollow noreferrer\">contiki wiki on processes</a>, the <code>process_start()</code> method is lowercase. Change that and your program should work.</p>\n"}], "owner": {"reputation": 23, "user_id": 11486739, "user_type": "registered", "profile_image": "https://graph.facebook.com/2302072856518396/picture?type=large", "display_name": "Mathew Slingsby", "link": "https://stackoverflow.com/users/11486739/mathew-slingsby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 59079096, "answer_count": 1, "score": 2, "last_activity_date": 1576857245, "creation_date": 1574889610, "question_id": 59078597, "link": "https://stackoverflow.com/questions/59078597/start-contiki-process-from-a-process", "title": "Start Contiki process from a process", "body": "<p>I am using contikiOS and C, I am trying to create code that will wait for 10s then print the temperature. It will then start a different process and record temp every 1s. It will check when temperature exceeds 28c and turn led on.</p>\n\n<p>Currently, it executes as follows:</p>\n\n<p>Waits 10s,\nPrints temp,\nWaits 10s,\nTerminates</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include \"dev/light-sensor.h\"\n#include \"dev/sht11-sensor.h\"\n#include \"dev/leds.h\"\n#include &lt;stdio.h&gt; /* For printf() */\n\n\nunsigned short d1(float f) // Integer part\n{\n  return((unsigned short)f);\n}\nunsigned short d2(float f) // Fractional part\n{\n  return(1000*(f-d1(f)));\n}\n\n\n/*---------------------------------------------------------------------------*/\nPROCESS(alarm, \"alarm\");\n\n/*---------------------------------------------------------------------------*/\n\n/*---------------------------------------------------------------------------*/\nPROCESS(detect, \"detect\");\nAUTOSTART_PROCESSES(&amp;detect);\n/*---------------------------------------------------------------------------*/\n\n\n\n\nPROCESS_THREAD(detect, ev, data)\n{\n\n    static struct etimer timer;\n    PROCESS_BEGIN();\n    etimer_set(&amp;timer, CLOCK_CONF_SECOND * 10);\n    SENSORS_ACTIVATE(sht11_sensor);\n    leds_off(LEDS_ALL);\n\n    while (1) {\n        if (!etimer_pending()) {\n            break;\n        }\n        else {\n\n\n            PROCESS_WAIT_EVENT_UNTIL(ev == PROCESS_EVENT_TIMER);\n\n            float temp = 0.01*sht11_sensor.value(SHT11_SENSOR_TEMP) - 39.6;\n            printf(\"\\n%u.%03u C\", d1(temp), d2(temp));\n\n            if (temp &gt; 28) {\n\n                leds_on(LEDS_ALL);\n                clock_wait(CLOCK_SECOND);\n\n\n                leds_off(LEDS_ALL);\n\n            }\n            if (temp &lt;= 28) {\n\n                leds_off(LEDS_ALL);\n            }\n\n\n        }\n        etimer_stop(&amp;timer);\n\n    }\n    PROCESS_EXIT();\n    PROCESS_START(&amp;alarm, NULL);\n    PROCESS_END();\n}\n\n\n/*---------------------------------------------------------------------------*/\n\n\nPROCESS_THREAD(alarm, ev, data)\n{\n\n    static struct etimer timer1;\n    PROCESS_BEGIN();\n    etimer_set(&amp;timer1, CLOCK_SECOND);\n    SENSORS_ACTIVATE(sht11_sensor);\n    leds_off(LEDS_ALL);\n    while (1) {\n        PROCESS_WAIT_EVENT_UNTIL(ev == PROCESS_EVENT_TIMER);\n        float temp = 0.01*sht11_sensor.value(SHT11_SENSOR_TEMP) - 39.6;\n        printf(\"\\n%u.%03u C\", d1(temp), d2(temp));\n\n        if (temp &gt; 28) {\n\n            leds_on(LEDS_ALL);\n            clock_wait(CLOCK_SECOND);\n\n\n            leds_off(LEDS_ALL);\n\n        }\n        if (temp &lt;= 28) {\n\n            leds_off(LEDS_ALL);\n        }\n        etimer_reset(&amp;timer1);\n\n\n\n\n\n\n    }\n\n    PROCESS_END();\n}\n\n\n\n\n\n</code></pre>\n"}, {"tags": ["c", "linux", "segmentation-fault"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 4, "creation_date": 1574889242, "post_id": 59078513, "comment_id": 104394141, "body": "<code>username</code> doesn&#39;t point anywhere yet."}], "answers": [{"tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": true, "score": 1, "last_activity_date": 1574889303, "creation_date": 1574889303, "answer_id": 59078539, "question_id": 59078513, "link": "https://stackoverflow.com/questions/59078513/segmentation-fault-on-fprintf/59078539#59078539", "title": "Segmentation fault on fprintf", "body": "<p>At this point:</p>\n\n<pre><code>scanf(\"%s\", username);\n</code></pre>\n\n<p>the pointer variable <code>username</code> is not initialised, it points at an unpredictable memory part. You are basically saying \"Please write the input anywhere into memory.\" and should not be surprised that the system complains, actually you should consider yourself lucky that it complains, there are much harder to debug possible reactions.<br>\n(You are also ignoring the return value of scanf, which would be the only way that the system could give you information about other ways of failing to do as you expect.)\nThe pointer especially does not point to any memory area usable for the purpose of storing input.<br>\nYou can change that by using <code>malloc()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 12397774, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GGJy4LYUYDA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reCbXxDHB6anHsZDbb_8WfATdHk8A/photo.jpg?sz=128", "display_name": "fariz", "link": "https://stackoverflow.com/users/12397774/fariz"}, "is_accepted": false, "score": 1, "last_activity_date": 1574944825, "creation_date": 1574944825, "answer_id": 59089152, "question_id": 59078513, "link": "https://stackoverflow.com/questions/59078513/segmentation-fault-on-fprintf/59089152#59089152", "title": "Segmentation fault on fprintf", "body": "<p>You declared a pointer named username which of type char. But you forgot to assign a memory for that pointer.</p>\n\n<pre><code>username = (char*)malloc(any_size_you_want);\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 9603817, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CyCX2.jpg?s=128&g=1", "display_name": "Claudiu Scurtu", "link": "https://stackoverflow.com/users/9603817/claudiu-scurtu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 59078539, "answer_count": 2, "score": 0, "last_activity_date": 1574944825, "creation_date": 1574889161, "question_id": 59078513, "link": "https://stackoverflow.com/questions/59078513/segmentation-fault-on-fprintf", "title": "Segmentation fault on fprintf", "body": "<p>I have this simple piece of code:</p>\n\n<pre><code>void create(){\n    char *username;\n    FILE *fptr;\n    fptr = fopen(\"~/retele/PROIECT/user.txt\", \"w\");\n    printf(\"Type username: \");\n    scanf(\"%s\", username);\n    fprintf(fptr, \"%s\\n\", username);\n    fclose(fptr);   \n\n}\n\n</code></pre>\n\n<p>and I don't get it, why do I get a segmentation fault.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1574889568, "post_id": 59078485, "comment_id": 104394249, "body": "You need to NUL terminate all your character buffers. <code>puts</code> (and all other string operations) requires it."}, {"owner": {"reputation": 25, "user_id": 12448318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547b1a613e8a70a2e4cfde1105a38000?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny", "link": "https://stackoverflow.com/users/12448318/johnny"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574889750, "post_id": 59078485, "comment_id": 104394310, "body": "@kaylum could u please show me what you mean according to my code? I&#39;m kind of new at this.."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574889922, "post_id": 59078485, "comment_id": 104394364, "body": "<code>malloc(21)</code>. There are many magic numbers like that in your code. Makes it hard to understand and maintain. Use symbolic names instead (<code>#define</code> or <code>const</code> variables for example). And you really should do error checking - for example, if <code>minSize</code> or <code>maxSize</code> is large then the code will get buffer overflows."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574890038, "post_id": 59078485, "comment_id": 104394399, "body": "Increase <code>rndSize</code> <code>malloc</code> call by 1. then terminate at end of function with <code>rndSize[i] = &#39;\\0&#39;;</code>. &quot;Strings&quot; in C are NUL terminate character sequences (no native string type)."}, {"owner": {"reputation": 25, "user_id": 12448318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547b1a613e8a70a2e4cfde1105a38000?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny", "link": "https://stackoverflow.com/users/12448318/johnny"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574890196, "post_id": 59078485, "comment_id": 104394454, "body": "@kaylum minsize and maxsize are 5 and 20 and also the reason why i chose &#39;21&#39; is because every sequence must consist of 20 letters plus \\0. So i guess it&#39;s correct. The compiler doesn&#39;t give me any errors or warnings."}, {"owner": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "edited": false, "score": 1, "creation_date": 1574890388, "post_id": 59078485, "comment_id": 104394546, "body": "There are MANY errors. 1) You are not freeing char arrays in the end of main. 2) your string are not null-terminated. You are setting &#39;\\0&#39; only on last ptr element... but that&#39;s a char*, not a char! 3) each string malloced in randomString () should be terminated after the loop of rands. 4) you try to print only first string, but it is not null terminated, so you will go beyond random chars limit. 5) why malloc 21? What if maxSize is bigger? 6) the print before scanf asks for <i>chars to be used</i>. So only one string was the goal?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1574890664, "post_id": 59078485, "comment_id": 104394646, "body": "@Giannis It&#39;s good that there are no warnings. But that doesn&#39;t mean there aren&#39;t any errors (there are many). Allocating extra space is the first step. How about NUL terminate like I said? <code>malloc</code> does not zero memory for you. I see you tried <code>ptr[i] = &#39;\\0&#39;;</code>. But that is very wrong. <code>i</code> is <code>size</code> at that point which means it overflows the buffer and anyway, that only attempts to NUL terminate one of the strings, not all of them."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 12448318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547b1a613e8a70a2e4cfde1105a38000?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny", "link": "https://stackoverflow.com/users/12448318/johnny"}, "edited": false, "score": 0, "creation_date": 1574891424, "post_id": 59078696, "comment_id": 104394900, "body": "@Jona I accepted it but my upvote can&#39;t show cause i am new here. I&#39;d like to ask you for a clarification. Since ptr is a pointer to a pointer,  using puts(ptr[i]) isn&#39;t supposed to print the content stored in the address thats pointed? which in this case in another address."}, {"owner": {"reputation": 1084, "user_id": 2186074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7rMRz.png?s=128&g=1", "display_name": "Jona", "link": "https://stackoverflow.com/users/2186074/jona"}, "edited": false, "score": 0, "creation_date": 1574927915, "post_id": 59078696, "comment_id": 104404110, "body": "The declaration of <code>puts</code> is <code>int puts(const char *str)</code>. <code>puts</code> requires a pointer as parameter (and will write the value pointed to stdout)."}], "tags": [], "owner": {"reputation": 1084, "user_id": 2186074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7rMRz.png?s=128&g=1", "display_name": "Jona", "link": "https://stackoverflow.com/users/2186074/jona"}, "is_accepted": true, "score": 0, "last_activity_date": 1574890868, "last_edit_date": 1574890868, "creation_date": 1574890157, "answer_id": 59078696, "question_id": 59078485, "link": "https://stackoverflow.com/questions/59078485/generating-random-letters-from-a-z/59078696#59078696", "title": "Generating random letters from a-z", "body": "<p>Here is a working example.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nchar *randomString(int minSize, int maxSize);\nvoid printStrings(char **strArray, int strArraySize);\n\nint main()\n{\n    time_t t;\n    srand((unsigned) time(&amp;t));\n    int size, i;\n    char **ptr;\n\n\n    printf(\"Type in the number of characters you would like to be used: \");\n    scanf(\"%d\", &amp;size);\n\n    ptr = malloc(size*sizeof(*ptr));\n    if (ptr==NULL) {\n        printf(\"Cannot allocate memory. The program will now terminate.\");\n        return -1;\n    }\n\n    for (i=0; i&lt;size; i++)\n    {\n        ptr[i] = randomString(5, 20);\n        puts(ptr[i]);\n    }\n\n    return 0;\n\n}\n\n\nchar *randomString(int minSize, int maxSize)\n{\n    char *rndSize, *p;\n    int i;\n    rndSize = (char *)malloc(maxSize+1);\n    p = rndSize;\n    for (i = minSize + rand() % 16; i&lt;=maxSize; i++)\n        *p++ = 97 + rand() % 26;\n    *p = '\\0';\n  return rndSize;\n}\n</code></pre>\n\n<p>It adds the NUL terminate character after each sequence. It also print each sequences one after the other. The random number generator initialization has been placed in the main to avoid getting the same sequence each time. It still looks strange to me that <code>t</code> is not initialized. There are still a lot of fix/improvements.</p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 5998156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3641a583f633c78edcff8d2fb7d2442?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Bauluz del R&#237;o", "link": "https://stackoverflow.com/users/5998156/luis-bauluz-del-r%c3%ado"}, "is_accepted": false, "score": -1, "last_activity_date": 1574890166, "creation_date": 1574890166, "answer_id": 59078698, "question_id": 59078485, "link": "https://stackoverflow.com/questions/59078485/generating-random-letters-from-a-z/59078698#59078698", "title": "Generating random letters from a-z", "body": "<p>Try </p>\n\n<pre><code>char *randomString(int minSize, int maxSize)\n(...)\nrndSize = (char *)malloc(21);\nmemset (rndSize , 0, 21*sizeof(char));\n(...)\n</code></pre>\n\n<p>Regards.</p>\n\n<p>Luis</p>\n"}], "owner": {"reputation": 25, "user_id": 12448318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547b1a613e8a70a2e4cfde1105a38000?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny", "link": "https://stackoverflow.com/users/12448318/johnny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 59078696, "answer_count": 2, "score": -1, "last_activity_date": 1574890868, "creation_date": 1574889077, "question_id": 59078485, "link": "https://stackoverflow.com/questions/59078485/generating-random-letters-from-a-z", "title": "Generating random letters from a-z", "body": "<p>I'm trying to create a program that will make a sequence of random letters from a-z. For some reason though it doesn't work, and it prints other symbols too. i know there is an issue on how i use puts, since there is not only one sequence but \"size\" of them, but i did it just to check that the letter generator actually works so i want to focus on that for now. However, any suggestions for the code in general are welcome :)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nchar *randomString(int minSize, int maxSize);\nvoid printStrings(char **strArray, int strArraySize);\n\nint main()\n{\n    int size, i;\n    char **ptr;\n\n\n    printf(\"Type in the number of characters you would like to be used: \");\n    scanf(\"%d\", &amp;size);\n\n    ptr = malloc(size*sizeof(ptr));\n    if (ptr==NULL) {\n        printf(\"Cannot allocate memory. The program will now terminate.\");\n        return -1;\n    }\n\n    for (i=0; i&lt;size; i++)\n        ptr[i] = randomString(5, 20);\n    ptr[i] = '\\0';\n\n    puts(*ptr);\n\n\n    return 0;\n\n\n\n}\n\n\nchar *randomString(int minSize, int maxSize)\n{\n    time_t t;\n    srand((unsigned) time(&amp;t));\n    char *rndSize, *p;\n    int i;\n    rndSize = (char *)malloc(21);\n    p = rndSize;\n    for (i = minSize + rand() % 16; i&lt;=maxSize &amp;&amp; i&gt;=minSize; i++)\n        *p++ = 97 + rand() % 26;\n  return rndSize;\n}\n\n\n\n\n\n\n</code></pre>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574889096, "post_id": 59078200, "comment_id": 104394080, "body": "Your question is not very clear. &quot;It is working not vinculate selecao and jogador&quot;: That doesn&#39;t make grammatical sense so it is difficult to understand what you mean. Can you please reword and also give the exact input, expected output and actual output?"}, {"owner": {"reputation": 1, "user_id": 12174464, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDX_2rE7zK_qgEWGagvuoKRfe15BKqBQcc20fCD=k-s128", "display_name": "ricardo da rocha", "link": "https://stackoverflow.com/users/12174464/ricardo-da-rocha"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574889945, "post_id": 59078200, "comment_id": 104394373, "body": "Of course, I am reformulating, the questions. Thanks."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1574890140, "post_id": 59078200, "comment_id": 104394431, "body": "You don&#39;t need to declare a new structure <code>struct jogador jog[3];</code> in <code>main()</code>. Use <code>s[j].jog[i].nome</code>"}, {"owner": {"reputation": 1, "user_id": 12174464, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDX_2rE7zK_qgEWGagvuoKRfe15BKqBQcc20fCD=k-s128", "display_name": "ricardo da rocha", "link": "https://stackoverflow.com/users/12174464/ricardo-da-rocha"}, "edited": false, "score": 0, "creation_date": 1574890304, "post_id": 59078200, "comment_id": 104394512, "body": "Barmar, I tried it, but it not working."}, {"owner": {"reputation": 1, "user_id": 12174464, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDX_2rE7zK_qgEWGagvuoKRfe15BKqBQcc20fCD=k-s128", "display_name": "ricardo da rocha", "link": "https://stackoverflow.com/users/12174464/ricardo-da-rocha"}, "edited": false, "score": 0, "creation_date": 1574891396, "post_id": 59078200, "comment_id": 104394888, "body": "Barmar, the erro is -&gt; A syntax error in expression, near `&#39;."}], "owner": {"reputation": 1, "user_id": 12174464, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDX_2rE7zK_qgEWGagvuoKRfe15BKqBQcc20fCD=k-s128", "display_name": "ricardo da rocha", "link": "https://stackoverflow.com/users/12174464/ricardo-da-rocha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574894385, "creation_date": 1574887638, "last_edit_date": 1574894385, "question_id": 59078200, "link": "https://stackoverflow.com/questions/59078200/can-i-put-one-struct-in-one-other", "title": "Can I put one struct in one other?", "body": "<p>I need solve this exercise.<br>\nI can't solve the letter b).\nQuestion:\nUsing structs <strong>jogador</strong>(struct name) e <strong>selecao</strong>(struct name) create a program get the name of 2 selecao (Team) and the name of 3 jogador (players) of each team.   </p>\n\n<p>2 Teams with 3 Players each.</p>\n\n<p>Inputs - Selecao nome (Team name).</p>\n\n<p>Inputs - Jogador nome (Player name)\n       - Jogador idade  (Player age)\n       - Jogador altura (Player height)</p>\n\n<p>Output - </p>\n\n<p>a)Number of players with less than 18 years old.\nb)Average Age of each team\nc)Average Heith all teams</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nstruct jogador {\n    char nome[50];\n    int idade;\n    float altura;\n };\nstruct selecao { //struct aninhada\n    char pais[50];\n    struct jogador jog[3];\n};\n\nint main(){\n    int i=0,j=0,k=0; // indices\n    int count=0,countmedia=0; // countadores\n    int menores18=0; // indice condicao\n    float media=0,alturamedia=0,countaltura=0;// duas medias e um contador\n    struct selecao s[2];\n    for(j=0;j&lt;2;j++) {   // for para coletar dados das sele\u00e7\u00f5es\n        setbuf(stdin,NULL);\n        printf(\"Digite o nome da selecao n.%d :\",j+1);\n        fgets(s[j].pais, 50, stdin);\n        struct jogador jog[3];\n        for(i=0;i&lt;3;i++) { // for para coletar dados jogadores\n            setbuf(stdin,NULL);\n            printf(\"Digite o nome do jogador n.%d :\",i+1);\n            fgets(jog[i].nome, 50, stdin);\n            printf(\"Digite a sua idade (somente n\u00famero):\");\n            scanf(\"%d\",&amp;jog[i].idade);\n            printf(\"Digite a sua altura (Ex. 1.70) :\");\n            scanf(\"%f\",&amp;jog[i].altura);\n        }\n       for (k=0; k&lt;2; k++)  { // for para c\u00e1lculos\n           if(jog[k].idade &lt;18)\n               menores18++;\n               countmedia += jog[k].idade;\n               count++;\n               media = (float)countmedia/count;\n               countaltura += jog[k].altura;\n               alturamedia= (float)countaltura/count;\n        }   \n   }\n   printf(\"a) O numero de jogadores menores de 18 anos eh: %d\\n\",menores18);\n   printf(\"b) A media de idade do jogadores eh: %f\\n\",media);\n   printf(\"c) A altura media dos jogadores eh: %f\\n\",alturamedia);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "parallel-processing", "mpi"], "answers": [{"tags": [], "owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "is_accepted": true, "score": 2, "last_activity_date": 1574899757, "creation_date": 1574899757, "answer_id": 59080088, "question_id": 59078035, "link": "https://stackoverflow.com/questions/59078035/can-mpi-gather-be-used-to-receive-data-from-threads-that-use-mpi-send/59080088#59080088", "title": "Can MPI_Gather be used to receive data from threads that use MPI_Send?", "body": "<p><code>MPI_Gather()</code> is a collective operation and must hence be called by all the ranks of the communicator. They also must provide matching signatures (datatype and count) and all use the same <code>root</code> value.</p>\n\n<p>Note the send buffer of the <code>root</code> rank is also gathered into the receive buffers, so if the send count is <code>1</code>, you really should allocate your receive buffer with</p>\n\n<pre><code>int* receiving_buffer = (int*)malloc(sizeof(int) * process_count)\n</code></pre>\n\n<p>and since all ranks send <code>1 * MPI_INT</code>, a correct receive signature is also be <code>1 * MPI_INT</code>.</p>\n\n<p>Also note that \"threads\" is improper in this context. MPI tasks or MPI processes are the right terminology.</p>\n\n<p>Keep in mind that the standard does not specify how a collective operation should be implemented. In the case of <code>MPI_Gather()</code>, a naive implementation would have all MPI tasks send their buffer to the root rank. But some more sophisticated algorithm can be used such as a tree-based gather, and in that case, not all tasks would send their buffer to the root rank.</p>\n"}], "owner": {"reputation": 51, "user_id": 9392391, "user_type": "registered", "profile_image": "https://graph.facebook.com/1986979591561486/picture?type=large", "display_name": "Gabriel Pop", "link": "https://stackoverflow.com/users/9392391/gabriel-pop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 59080088, "answer_count": 1, "score": -1, "last_activity_date": 1574899757, "creation_date": 1574886820, "question_id": 59078035, "link": "https://stackoverflow.com/questions/59078035/can-mpi-gather-be-used-to-receive-data-from-threads-that-use-mpi-send", "title": "Can MPI_Gather be used to receive data from threads that use MPI_Send?", "body": "<p>I have a master process and more slave processes. I want that every slave process to send back to the master one integer, so I guess I should gather them using MPI_Gather. But somehow it doesn't work and I started to think that MPI_Gather is incompatible with MPI_Send.</p>\n\n<p>The relevant lines of code look like this:</p>\n\n<pre><code>MPI_Init(&amp;argc, &amp;argv);\nMPI_Comm_rank(MPI_COMM_WORLD, &amp;process_id);\nMPI_Comm_size(MPI_COMM_WORLD, &amp;process_count);\n\nint full_word_count = 0;\nint* receiving_buffer = (int*)malloc(sizeof(int) * 100);\n\nif (process_id == 0)\n{\n    // Some Master code here ...\n\n    MPI_Gather(full_word_count, 1, MPI_INT, receiving_buffer, 1, MPI_INT, 0, MPI_COMM_WORLD);\n\n    // ...\n}\nelse\n{\n    // Some Slave code here ...\n\n    MPI_Send(full_word_count, 1, MPI_INT, 0, 0, MPI_COMM_WORLD);\n\n    //...\n}\n\nMPI_Finalize();\n</code></pre>\n\n<p>I also know that I used \"1\" for MPI_Gather because I tried to run only for two processes, so process 1 would send, and process 0 would gather; of course, for more processes I should modify it using ranks. But my main question here is that I can use (and if yes, how) MPI_Gather combined with MPI_Send for a situation like this.</p>\n"}, {"tags": ["c++", "c", "gcc", "arduino", "compilation"], "comments": [{"owner": {"reputation": 1527, "user_id": 3518383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GjBCE.jpg?s=128&g=1", "display_name": "Juraj", "link": "https://stackoverflow.com/users/3518383/juraj"}, "edited": false, "score": 1, "creation_date": 1574923046, "post_id": 59077871, "comment_id": 104402268, "body": "<a href=\"https://groups.google.com/a/arduino.cc/forum/#!topic/developers/Ny82s7t11Vc\" rel=\"nofollow noreferrer\">groups.google.com/a/arduino.cc/forum/#!topic/developers/&hellip;</a>"}, {"owner": {"reputation": 157, "user_id": 11465149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ejUuNxiWoqY/AAAAAAAAAAI/AAAAAAAABKY/y9L_jp184Ng/photo.jpg?sz=128", "display_name": "Giorgos Xou", "link": "https://stackoverflow.com/users/11465149/giorgos-xou"}, "reply_to_user": {"reputation": 1527, "user_id": 3518383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GjBCE.jpg?s=128&g=1", "display_name": "Juraj", "link": "https://stackoverflow.com/users/3518383/juraj"}, "edited": false, "score": 0, "creation_date": 1574943188, "post_id": 59077871, "comment_id": 104412166, "body": "@Juraj thanks (: ! Do you have by any Chance any idea on how I could fix this issue instead of downgrading From 7.3.0 toolchain to an older one? or a way of switching between 7.3.0 and older versions (on arduino ide)?"}], "answers": [{"tags": [], "owner": {"reputation": 1341, "user_id": 1556746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e5304b618f68709a0e74e4dcb8c4c3e?s=128&d=identicon&r=PG", "display_name": "emacs drives me nuts", "link": "https://stackoverflow.com/users/1556746/emacs-drives-me-nuts"}, "is_accepted": false, "score": 2, "last_activity_date": 1576762872, "creation_date": 1576762872, "answer_id": 59410968, "question_id": 59077871, "link": "https://stackoverflow.com/questions/59077871/programming-attiny10-with-arduino-ld-exe-errors/59410968#59410968", "title": "Programming ATtiny10 with Arduino ( &quot;ld.exe&quot; errors)", "body": "<p>The linker is using the wrong multilib.  This can happen because you are supplying the linker with the wrong options, or because the installation is broken (or both).</p>\n\n<p>First step in tracking down such issues is adding -v to the compiler driver's options (avr-gcc or avr-g++ in this case) to see which options are passed to the sub-processes.</p>\n"}], "owner": {"reputation": 157, "user_id": 11465149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ejUuNxiWoqY/AAAAAAAAAAI/AAAAAAAABKY/y9L_jp184Ng/photo.jpg?sz=128", "display_name": "Giorgos Xou", "link": "https://stackoverflow.com/users/11465149/giorgos-xou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1605911783, "creation_date": 1574885941, "last_edit_date": 1605911783, "question_id": 59077871, "link": "https://stackoverflow.com/questions/59077871/programming-attiny10-with-arduino-ld-exe-errors", "title": "Programming ATtiny10 with Arduino ( &quot;ld.exe&quot; errors)", "body": "<h1>\ud83e\udd14 Issue</h1>\n<p>I am trying to compile a sketch in &quot;Arduino IDE 1.8.9&quot; for ATtiny10 and i am always getting these errors:</p>\n<ul>\n<li><strong>When</strong> Using <a href=\"https://github.com/vitasimek/attiny10core\" rel=\"nofollow noreferrer\"><strong>ATTiny10 Core</strong></a></li>\n</ul>\n<pre><code>&quot;C:\\\\Users\\\\gxous\\\\AppData\\\\Local\\\\Arduino15\\\\packages\\\\arduino\\\\tools\\\\avr-gcc\\\\7.3.0-atmel3.6.1-arduino5/bin/avr-gcc&quot; -w -Os -g -flto -fuse-linker-plugin -Wl,--gc-sections -mmcu=attiny10 -o &quot;C:\\\\Users\\\\gxous\\\\AppData\\\\Local\\\\Temp\\\\arduino_build_433979/testat10_nov26a.ino.elf&quot; &quot;C:\\\\Users\\\\gxous\\\\AppData\\\\Local\\\\Temp\\\\arduino_build_433979\\\\sketch\\\\testat10_nov26a.ino.cpp.o&quot; &quot;C:\\\\Users\\\\gxous\\\\AppData\\\\Local\\\\Temp\\\\arduino_build_433979/core\\\\core.a&quot; &quot;-LC:\\\\Users\\\\gxous\\\\AppData\\\\Local\\\\Temp\\\\arduino_build_433979&quot; -lm\nc:/users/gxous/appdata/local/arduino15/packages/arduino/tools/avr-gcc/7.3.0-atmel3.6.1-arduino5/bin/../lib/gcc/avr/7.3.0/../../../../avr/bin/ld.exe: cannot find crtattiny10.o: No such file or directory\n\nc:/users/gxous/appdata/local/arduino15/packages/arduino/tools/avr-gcc/7.3.0-atmel3.6.1-arduino5/bin/../lib/gcc/avr/7.3.0/../../../../avr/bin/ld.exe: skipping incompatible c:/users/gxous/appdata/local/arduino15/packages/arduino/tools/avr-gcc/7.3.0-atmel3.6.1-arduino5/bin/../lib/gcc/avr/7.3.0/../../../../avr/lib\\libm.a when searching for -lm\n\nc:/users/gxous/appdata/local/arduino15/packages/arduino/tools/avr-gcc/7.3.0-atmel3.6.1-arduino5/bin/../lib/gcc/avr/7.3.0/../../../../avr/bin/ld.exe: cannot find -lm\n\nc:/users/gxous/appdata/local/arduino15/packages/arduino/tools/avr-gcc/7.3.0-atmel3.6.1-arduino5/bin/../lib/gcc/avr/7.3.0/../../../../avr/bin/ld.exe: skipping incompatible c:/users/gxous/appdata/local/arduino15/packages/arduino/tools/avr-gcc/7.3.0-atmel3.6.1-arduino5/bin/../lib/gcc/avr/7.3.0\\libgcc.a when searching for -lgcc\n\nc:/users/gxous/appdata/local/arduino15/packages/arduino/tools/avr-gcc/7.3.0-atmel3.6.1-arduino5/bin/../lib/gcc/avr/7.3.0/../../../../avr/bin/ld.exe: cannot find -lgcc\n\nc:/users/gxous/appdata/local/arduino15/packages/arduino/tools/avr-gcc/7.3.0-atmel3.6.1-arduino5/bin/../lib/gcc/avr/7.3.0/../../../../avr/bin/ld.exe: skipping incompatible c:/users/gxous/appdata/local/arduino15/packages/arduino/tools/avr-gcc/7.3.0-atmel3.6.1-arduino5/bin/../lib/gcc/avr/7.3.0/../../../../avr/lib\\libm.a when searching for -lm\n\nc:/users/gxous/appdata/local/arduino15/packages/arduino/tools/avr-gcc/7.3.0-atmel3.6.1-arduino5/bin/../lib/gcc/avr/7.3.0/../../../../avr/bin/ld.exe: cannot find -lm\n\nc:/users/gxous/appdata/local/arduino15/packages/arduino/tools/avr-gcc/7.3.0-atmel3.6.1-arduino5/bin/../lib/gcc/avr/7.3.0/../../../../avr/bin/ld.exe: skipping incompatible c:/users/gxous/appdata/local/arduino15/packages/arduino/tools/avr-gcc/7.3.0-atmel3.6.1-arduino5/bin/../lib/gcc/avr/7.3.0/../../../../avr/lib\\libc.a when searching for -lc\n\nc:/users/gxous/appdata/local/arduino15/packages/arduino/tools/avr-gcc/7.3.0-atmel3.6.1-arduino5/bin/../lib/gcc/avr/7.3.0/../../../../avr/bin/ld.exe: cannot find -lc\n\nc:/users/gxous/appdata/local/arduino15/packages/arduino/tools/avr-gcc/7.3.0-atmel3.6.1-arduino5/bin/../lib/gcc/avr/7.3.0/../../../../avr/bin/ld.exe: cannot find -lattiny10\n\ncollect2.exe: error: ld returned 1 exit status\n\nexit status 1\nError compiling for board ATtiny10/9/5/4.\n</code></pre>\n<ul>\n<li><strong>When</strong> Using <a href=\"https://make.kosakalab.com/make/electronic-work/arduino_tpi_en/\" rel=\"nofollow noreferrer\"><strong>bitduino10</strong></a></li>\n</ul>\n<pre><code>...\nsame errors\n...\nError compiling for board ATtiny10 (bitDuino10-arduinoTPI).\n</code></pre>\n<h1>\ud83d\udccb Infos</h1>\n<ul>\n<li><a href=\"https://make.kosakalab.com/make/electronic-work/arduino_tpi_en/\" rel=\"nofollow noreferrer\">ATtiny10 Dev Environment on Arduino IDE</a></li>\n<li><em><code>&quot;file&gt;preferences&quot;</code></em></li>\n</ul>\n<pre><code>  https://kimio-kosaka.github.io/bitDuino10-arduinoTPI/package_bitDuino10-arduinoTPI_index.json\n  https://raw.githubusercontent.com/vitasimek/attiny10core/master/package_attiny10core_index.json\n</code></pre>\n<h1>\ud83d\udc9b Outro</h1>\n<p>if i wasn't informative enough about the issue, please let me know</p>\n<p>Any idea?</p>\n<p>Thanks in advance,</p>\n<p>George</p>\n<h1>UPDATE</h1>\n<p>What i actually did <em>(although not the solution you might expect)</em> , was just to install permanently an older version of Arduino IDE, as mentioned <a href=\"https://make.kosakalab.com/make/electronic-work/arduino_tpi_en/\" rel=\"nofollow noreferrer\">here</a> and used in <a href=\"https://github.com/GiorgosXou/ATtinyHearring\" rel=\"nofollow noreferrer\">my project</a> too.</p>\n"}, {"tags": ["c++", "c", "windows", "winapi", "windows-10"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1574888277, "post_id": 59077703, "comment_id": 104393754, "body": "I can&#39;t work out what exactly you are doing. We have some fragments of code, talk of close buttons, and some off site videos. A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> would be ideal."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1574907193, "post_id": 59077703, "comment_id": 104398437, "body": "From that video, it looks like Discord is using a custom UI and window management. And its animated as well.  So, when the user &quot;closes&quot; the window to hide it, Discord knows to hide the window and disable it.  When you consequently re-show the window, Discord is likely not taking into account that the window was shown without user interaction, and so does not re-enable the window. Just goes to show why you shouldn&#39;t be messing around with someone else&#39;s window behind their back. What are you trying to accomplish in the first place?"}, {"owner": {"reputation": 11, "user_id": 12350954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1393a0c3d0bc59fa91d2dd9818391053?s=128&d=identicon&r=PG&f=1", "display_name": "stade", "link": "https://stackoverflow.com/users/12350954/stade"}, "edited": false, "score": 0, "creation_date": 1574929038, "post_id": 59077703, "comment_id": 104404599, "body": "Discord is just an example, the problem happens with any program. I&#39;m trying to accomplish site wrapper (using <a href=\"https://github.com/jiahaog/nativefier\" rel=\"nofollow noreferrer\">nativefier</a>) and I need global hotkey to show/hide it."}, {"owner": {"reputation": 4915, "user_id": 11128312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ufn85.jpg?s=128&g=1", "display_name": "Strive Sun", "link": "https://stackoverflow.com/users/11128312/strive-sun"}, "edited": false, "score": 0, "creation_date": 1574932164, "post_id": 59077703, "comment_id": 104406199, "body": "Maybe you can <a href=\"https://stackoverflow.com/questions/21706428/click-system-tray-icon-python-win32\">simulate click system tray icon</a>, but I think it&#39;s going to be not easy."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1574982397, "post_id": 59077703, "comment_id": 104427302, "body": "@stade &quot;<i>the problem happens with any program</i>&quot; - I seriously doubt that. Most apps should be able to handle this kind of code just fine. Unless Microsoft has broken something severely at the API layer in Windows 10"}], "owner": {"reputation": 11, "user_id": 12350954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1393a0c3d0bc59fa91d2dd9818391053?s=128&d=identicon&r=PG&f=1", "display_name": "stade", "link": "https://stackoverflow.com/users/12350954/stade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574884961, "creation_date": 1574884961, "question_id": 59077703, "link": "https://stackoverflow.com/questions/59077703/winapi-how-to-hide-show-a-third-party-program-window", "title": "Winapi how to hide/show a third-party program window?", "body": "<p>I'm trying to hide/show a third-party program (e.g. Discord):</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;windows.h&gt;\n\nvoid show_hide(HWND window)\n{\n    if (IsWindowVisible(window) == TRUE) {\n        ShowWindow(window, SW_HIDE);\n    } else {\n        ShowWindow(window, SW_SHOW);\n    }\n}\n\nBOOL CALLBACK enum_windows_cb(HWND window, const LPARAM lParam)\n{\n    const char* target = \"Discord\";\n\n    char title[255];\n\n    if (GetWindowText(window, title, sizeof(title))) {\n\n        if (strcmpi(title, target) == 0) {\n            show_hide(window);\n            return FALSE;\n        }\n    }\n    return TRUE;    \n}\n\nint main(int argc, char *argv[])\n{\n    EnumWindows(&amp;enum_windows_cb, 0);\n    return 0;\n}\n\n\n</code></pre>\n\n<p>It's work fine, but if I hide a third-party program by click on close button, my program shows frozen window, until I press the tray icon.</p>\n\n<p>Video demonstration:\n<a href=\"https://www.youtube.com/watch?v=P-_Fi-Dew1w\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=P-_Fi-Dew1w</a></p>\n\n<p>I also wrote message log through microsoft spy++ <a href=\"https://pastebin.com/YwGt88yh\" rel=\"nofollow noreferrer\">https://pastebin.com/YwGt88yh</a></p>\n\n<p>It recorded three actions: click on close button hides program, click on tray icon shows program,  and my program tries to show window.</p>\n\n<p>I also tried to add these functions one by one after ShowWindow:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>SetForegroundWindow(window);\nSendMessage(window, WM_SYSCOMMAND, SC_RESTORE, 0);\nUpdateWindow(window);\nRedrawWindow(window, 0, nil, RDW_INVALIDATE or RDW_ALLCHILDREN or RDW_UPDATENOW or RDW_FRAME);\nSendMessage(window, WM_ACTIVATEAPP, TRUE, GetWindowThreadProcessId(window, 0));\n</code></pre>\n\n<p>But it did not help. What did I do wrong?\nI use windows 10.</p>\n"}, {"tags": ["c", "alsa", "epoll", "libalsa"], "comments": [{"owner": {"reputation": 70, "user_id": 6090734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1676693082590391/picture?type=large", "display_name": "Lewis Anesa", "link": "https://stackoverflow.com/users/6090734/lewis-anesa"}, "edited": false, "score": 0, "creation_date": 1574900273, "post_id": 59077702, "comment_id": 104397213, "body": "I was thinking about fork to have a separate process sending data recieved from a pipe but I&#39;m not sure about read completion notification through pipe on parent process side. I mean, being notified that pipe is empty."}], "answers": [{"tags": [], "owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "is_accepted": true, "score": 1, "last_activity_date": 1574930825, "creation_date": 1574930825, "answer_id": 59084804, "question_id": 59077702, "link": "https://stackoverflow.com/questions/59077702/is-there-any-way-to-wait-for-alsa-events-through-epoll-mechanism/59084804#59084804", "title": "Is there any way to wait for alsa events through epoll mechanism?", "body": "<p>When you get an epoll notification about a file descriptor, set the corresponding bit(s) in the <code>revents</code> field of the original <code>struct pollfd</code>. Then you can call <code>snd_pcm_poll_descriptors()</code>.</p>\n"}], "owner": {"reputation": 70, "user_id": 6090734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1676693082590391/picture?type=large", "display_name": "Lewis Anesa", "link": "https://stackoverflow.com/users/6090734/lewis-anesa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 59084804, "answer_count": 1, "score": 0, "last_activity_date": 1574930825, "creation_date": 1574884951, "question_id": 59077702, "link": "https://stackoverflow.com/questions/59077702/is-there-any-way-to-wait-for-alsa-events-through-epoll-mechanism", "title": "Is there any way to wait for alsa events through epoll mechanism?", "body": "<p>I fetch alsa device fd by fd field of struct pollfd structure filled by snd_pcm_poll_descriptors...\nBut when it comes to \"demangle\" event comming from epoll_wait, snd_pcm_poll_descriptors_revents\nwhich is no help since only struct pollfd fits to it's arguments.</p>\n"}, {"tags": ["c", "function", "return", "main", "c99"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1574884799, "post_id": 59077632, "comment_id": 104392406, "body": "Aside: <code>if (scanf(&quot;%d&quot;,&amp;CellValue) == 0)</code> should be <code>if (scanf(&quot;%d&quot;,&amp;CellValue) != 1)</code> as you&#39;ll fail to detect when <code>EOF</code> was returned. But you should please post the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Minimal Reproducible Example</a> that shows the problem as anything could be responsible."}, {"owner": {"reputation": 5673, "user_id": 2376156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2s2R4.jpg?s=128&g=1", "display_name": "edtheprogrammerguy", "link": "https://stackoverflow.com/users/2376156/edtheprogrammerguy"}, "edited": false, "score": 0, "creation_date": 1574885102, "post_id": 59077632, "comment_id": 104392516, "body": "Out of curiosity, what does <code>print_invalid_input</code> do?"}, {"owner": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "reply_to_user": {"reputation": 5673, "user_id": 2376156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2s2R4.jpg?s=128&g=1", "display_name": "edtheprogrammerguy", "link": "https://stackoverflow.com/users/2376156/edtheprogrammerguy"}, "edited": false, "score": 0, "creation_date": 1574886591, "post_id": 59077632, "comment_id": 104393112, "body": "@edtheprogrammerguy I have totally rearranged my code to make it much more clear and minimal. Could you kindly take a look?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1574886808, "post_id": 59077632, "comment_id": 104393177, "body": "Please note that the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Minimal Reproducible Example</a> should be a complete program that can be copy-pasted in a single operation and then compiled (without warnings) and run!"}, {"owner": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1574887008, "post_id": 59077632, "comment_id": 104393244, "body": "@WeatherVane Now it&#39;s fine, I forgot to add #include and combine the sections thanks for noting that"}, {"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 0, "creation_date": 1574887112, "post_id": 59077632, "comment_id": 104393287, "body": "@John I can&#39;t reproduce your problem... have you changed the code?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1574887244, "post_id": 59077632, "comment_id": 104393330, "body": "Thank you, MSVC produces 1 warning, <i>warning C4013: &#39;FillMatrix&#39; undefined; assuming extern returning int</i>. And 1 error, <i>error C2371: &#39;FillMatrix&#39;: redefinition; different basic types</i>. This is because you have not provided a function prototype for <code>FillMatrix</code> and the default asssumptions made by the compiler proved to be incorrect."}, {"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 0, "creation_date": 1574887267, "post_id": 59077632, "comment_id": 104393336, "body": "nag, you need to declare <code>FillMatrix</code> or reorder the functions :P"}, {"owner": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "edited": false, "score": 0, "creation_date": 1574887415, "post_id": 59077632, "comment_id": 104393392, "body": "I changed the order of the functions now you should get no error"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1574887474, "post_id": 59077632, "comment_id": 104393419, "body": "When I re-order the functions, I can&#39;t reproduce. Possbily your compiler was not strict enough to refuse to compile, and the array argument passed was incorrectly used, corrupting something. In the default case it might have been passing a pointer truncated to a 32-bit <code>int</code> instead of a 64-bit pointer"}, {"owner": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "edited": false, "score": 0, "creation_date": 1574887642, "post_id": 59077632, "comment_id": 104393496, "body": "I have created a fresh new program and &quot;Second&quot; got printed on the screen for me. I am using MinGw compiler (Tested on both codeblocks and clion using c99 standard)"}, {"owner": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "edited": false, "score": 0, "creation_date": 1574887898, "post_id": 59077632, "comment_id": 104393593, "body": "My friend have 64 bit version of MinGw installation and it worked fine for him, how could I solve this bug? I want to make sure that my code runs perfect on any computer"}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1574888128, "post_id": 59078274, "comment_id": 104393684, "body": "Good spot. I can reproduce that. 1 is the number of elements to enter, not the first data. The lesson for OP, is to provide prompts, as even a program&#39;s own author can be confused."}, {"owner": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1574888644, "post_id": 59078274, "comment_id": 104393904, "body": "why the function will return true, when I provide 4.5 as an input scanf will return 0 which means &quot;Error&quot; phrase should get printed and false should be returned. @WeatherVane"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1574888861, "post_id": 59078274, "comment_id": 104393990, "body": "I think that has been explained well. The first function did not return error, the second one did. if you want the first function to return an error, enter <code>2 4.5</code>  instead of <code>1 4.5</code>"}, {"owner": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1574889858, "post_id": 59078274, "comment_id": 104394346, "body": "@WeatherVane Sorry, I rechecked that with clean code and it didn&#39;t enter my code it just went to else! but why is that? the user provided 4.5 which is not integer that means that scanf should return 0"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1574889975, "post_id": 59078274, "comment_id": 104394383, "body": "The <code>4</code> is an integer, and it fails on the next read, as explained here."}], "tags": [], "owner": {"reputation": 142, "user_id": 9676301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d39362985ea8094a4f08e88bc140e5?s=128&d=identicon&r=PG&f=1", "display_name": "mradey", "link": "https://stackoverflow.com/users/9676301/mradey"}, "is_accepted": false, "score": 2, "last_activity_date": 1574888013, "creation_date": 1574888013, "answer_id": 59078274, "question_id": 59077632, "link": "https://stackoverflow.com/questions/59077632/return-false-is-neglected-and-not-being-returned/59078274#59078274", "title": "&quot;return false&quot; is neglected and not being returned", "body": "<p>If I am understanding your error correctly it seems that you get an error when you enter 1, which becomes the value for MatrixSize, and then when you enter 4.5. Your code will scan 4 for the value (and only value) in the first matrix since MatrixSize is 1. The function will then return true and FillMatrix will be called with the second matrix since there was no error detected.  .5 is still present in stdin and that is where the error is produced (the first scanf in the call to FillMatrix for secondMatrix).</p>\n\n<p>The problem your mentioning will only occur on the last input for your matrix.  One way to avoid this problem would be to read in input as a string and check if that can be parsed as an integer.  </p>\n"}], "owner": {"reputation": 69, "user_id": 12420727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51307259e7c1c0747ebaa3f93baf4841?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/12420727/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574888013, "creation_date": 1574884589, "last_edit_date": 1574887369, "question_id": 59077632, "link": "https://stackoverflow.com/questions/59077632/return-false-is-neglected-and-not-being-returned", "title": "&quot;return false&quot; is neglected and not being returned", "body": "<p><strong>Note:I have edited my code to provide clear and minimal steps to reproduce the error.</strong>\nI wrote the following code using C99 standrad:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\nbool FillMatrix(int MatrixSize, int Matrix[][10])\n{\n    int CellValue=0;\n    for (int i=0;i&lt;MatrixSize;i++)\n    {\n        for (int j = 0; j &lt; MatrixSize; j++)\n        {\n            if (scanf(\"%d\",&amp;CellValue) == 0)//Check if User provided un-integer value\n            {\n                printf(\"Error\\n\");\n                return false;//Her's the problem\n            }\n            else\n            {\n                Matrix[i][j] = CellValue;\n            }\n        }\n    }\n    return true;\n}\n\nint main()\n{\n    int MatrixSize=0;\n    scanf(\"%d\",&amp;MatrixSize);\n    int FirstMatrix[10][10],SecondMatrix[10][10];\n    printf(\"First:\\n\");\n    if (!FillMatrix(MatrixSize,FirstMatrix)) return 0;\n    printf(\"Second:\\n\");\n    if (!FillMatrix(MatrixSize,SecondMatrix)) return 0;\n    printf(\"Hello\");\n    return 0;\n}\n</code></pre>\n\n<p>When I provide <code>1</code> as the first input and then <code>4.5</code> I can see <code>Error</code> on the screen but also can see <code>Second:</code>\nWhat is wrong with my code?\nBefore printing <code>Second</code> I have asked to verify that <code>FillMatrix(...)</code> didn't return false but still it gets printed anyway!</p>\n"}, {"tags": ["c", "parallel-processing", "mpi"], "answers": [{"comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 1, "creation_date": 1574899980, "post_id": 59077969, "comment_id": 104397169, "body": "I would add that for performance reasons, you should try to allocate your data in contiguous memory whenever possible."}], "tags": [], "owner": {"reputation": 44162, "user_id": 752843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dfab97c10311207545414b6d7d9bde93?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/752843/richard"}, "is_accepted": true, "score": 1, "last_activity_date": 1574901097, "last_edit_date": 1574901097, "creation_date": 1574886452, "answer_id": 59077969, "question_id": 59077556, "link": "https://stackoverflow.com/questions/59077556/can-you-send-an-array-within-an-array-using-mpi-send-and-mpi-recv/59077969#59077969", "title": "Can you send an array within an array using MPI_Send and MPI_Recv?", "body": "<p>This is not a particularly well-worded question.</p>\n\n<p>However, MPI will let you send arrays of arrays if you use a custom type, as below:</p>\n\n<pre><code>#include \"mpi.h\"\n#include &lt;stdio.h&gt;\n\nstruct Partstruct\n{\n    char c;\n    double d[6];\n    char b[7];\n};\n\nint main(int argc, char *argv[])\n{\n    struct Partstruct particle[1000];\n    int i, j, myrank;\n    MPI_Status status;\n    MPI_Datatype Particletype;\n    MPI_Datatype type[3] = { MPI_CHAR, MPI_DOUBLE, MPI_CHAR };\n    int blocklen[3] = { 1, 6, 7 };\n    MPI_Aint disp[3];\n\n    MPI_Init(&amp;argc, &amp;argv);\n\n    disp[0] = &amp;particle[0].c - &amp;particle[0];\n    disp[1] = &amp;particle[0].d - &amp;particle[0];\n    disp[2] = &amp;particle[0].b - &amp;particle[0];\n    MPI_Type_create_struct(3, blocklen, disp, type, &amp;Particletype);\n    MPI_Type_commit(&amp;Particletype);\n\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;myrank);\n\n    if (myrank == 0)\n    {\n        MPI_Send(particle, 1000, Particletype, 1, 123, MPI_COMM_WORLD);\n    }\n    else if (myrank == 1)\n    {\n        MPI_Recv(particle, 1000, Particletype, 0, 123, MPI_COMM_WORLD, &amp;status);\n    }\n    MPI_Finalize();\n    return 0;\n}\n</code></pre>\n\n<p>Alternatively, use a flat array design (this is a good idea for performance reasons as well as easy compatibility with MPI).</p>\n"}], "owner": {"reputation": 27, "user_id": 4526139, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/606478372818450/picture?type=large", "display_name": "Hunter Durnford", "link": "https://stackoverflow.com/users/4526139/hunter-durnford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 59077969, "answer_count": 1, "score": 0, "last_activity_date": 1574901097, "creation_date": 1574884234, "last_edit_date": 1574884579, "question_id": 59077556, "link": "https://stackoverflow.com/questions/59077556/can-you-send-an-array-within-an-array-using-mpi-send-and-mpi-recv", "title": "Can you send an array within an array using MPI_Send and MPI_Recv?", "body": "<p>This is the very basic function of my program, and as such is not necessarily reproducible. However, I was wondering if there is a way to send an array of arrays using MPI? Or is this something that is not possible and I should flatten my array? Any help would be greatly appreciated as I've been struggling with trying to figure this out.</p>\n\n<pre><code>int *individual_topIds;\nint **cell_topIds;\ncell_topIds = (int**) malloc(sizeof(int*)*25*boxes);\nif(rank == 0) {\n    for (int i = 0; i &lt; boxes; i++) {\n        individual_topIds = (int*) malloc(sizeof(int)*25);\n        for(int j = 0; j &lt; cellMatrix[i].numTop; j++){\n            individual_topIds[j] = cellMatrix[i].aTopIds[j];\n        }\n        cell_topIds[i] = individual_topIds;\n     }\n     MPI_Send(cell_topIds, boxes*25, MPI_INT, 1, 10, MPI_COMM_WORLD);\n}\n</code></pre>\n\n<p>Then in my rank == 1 section. I have tried send and receive with just boxes, and not boxes*25 as well.</p>\n\n<pre><code>for 1 -&gt; boxes\n  MPI_Recv(cell_topIds, boxes*25, MPI_INT, 0, 10, MPI_COMM_WORLD, &amp;status);\n  int *ptop;\n  ptop = (int*) malloc(sizeof(int)*25);\n  ptop = cell_topIds[i];\n  printf(\"1\\n\");\n  for(int j = 0; j &lt; sizeof(&amp;ptop)/sizeof(int); j++){\n         printf(\"%d, \", ptop[j]);\n  }\n  printf(\"2\\n\");\nend for i -&gt; boxes\nfree(ptop);\n</code></pre>\n\n<p>Edit: Forgot to mention that the output of the print is a seg fault\nCaught error: Segmentation fault (signal 11)</p>\n"}, {"tags": ["c", "data-structures", "struct", "linked-list"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1574884268, "post_id": 59077462, "comment_id": 104392186, "body": "It <i>looks</i> like <code>List</code> is a typedeffed pointer."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1574884834, "post_id": 59077462, "comment_id": 104392419, "body": "A testimonial to why hiding pointer types in <code>typedef</code> aliases is nearly <i>always</i> a terrible idea. It makes the code harder to read and maintain; not easier. Regarding your problem, <i>&quot;I call the function to print the list in my main function.&quot;</i> - um.. what <code>main</code> function? The one you <i>didn&#39;t</i> include as part of your question ? Make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, including all declarations, definitions, and any/all input sample data required to reproduce your problem. And of course, run your code in a debugger if you really want to know were it pukes."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574915559, "post_id": 59077462, "comment_id": 104400095, "body": "regarding: <code>if (li == NULL || no == NULL) {</code>  The head pointer should be initialized to NULL, so the parameter: <code>li</code> will be NULL on the first call, so nothing will be placed into the linked list.  BTW:  the <code>li</code> should be passed as a pointer to pointer so on the first insertion, the head pointer can be modified to point to the first node"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574915679, "post_id": 59077462, "comment_id": 104400127, "body": "Please post the definition of <code>List</code>.  Please post the declaration of the list head pointer"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574915868, "post_id": 59077462, "comment_id": 104400175, "body": "regarding: <code>scanf(&quot;%s&quot;, info.name);</code>   How many characters are in <code>info.name</code>?  When using the <code>%s</code> input format conversion specifier, always include a MAX CHARACTERS modifier that is 1 less than the length of the buffer because this format specifier always append a NUL byte to the input.  When calling any of the <code>scanf()</code> family of functions, always check the returned value (not the parameter value) to assure the operation was successful"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574916001, "post_id": 59077462, "comment_id": 104400201, "body": "regarding: <code>Elem* no = (Elem*) malloc(sizeof(Elem));</code>  1) what is the definition of <code>Elem</code>?  2) in C, the returned type is <code>void*</code> which can be assigned to any pointer. casting just clutters the code.  3) always check (!=NULL) the returned value to assure the operation was successful,"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574916290, "post_id": 59077462, "comment_id": 104400271, "body": "There are LOTS AND LOTS of examples of how to code for a linked list on Stackoverflow.com  Strongly suggest doing a simple search.  Suggest using: <code>stackoverflow.com linked list</code>  as the search parameter"}], "owner": {"reputation": 11, "user_id": 8108118, "user_type": "registered", "profile_image": "https://graph.facebook.com/1457468444298426/picture?type=large", "display_name": "Lelre Ferreira", "link": "https://stackoverflow.com/users/8108118/lelre-ferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574884030, "creation_date": 1574883831, "last_edit_date": 1574884030, "question_id": 59077462, "link": "https://stackoverflow.com/questions/59077462/how-to-write-print-in-a-linked-list", "title": "How to write/print in a Linked List?", "body": "<p>I have this list right here and I have a doubt. am I storing it correctly in the list? Because I'm receiving the input from the user in my main function and then calling the inserting function, so I pass the struct to the function to store it into the linked list. I'm not sure if I'm doing it correctly because when I try to get the output the program ends instead of printing all data stored in the linked list...</p>\n\n<p>I have declared this in my main function...</p>\n\n<pre><code>struct aluno info;\nLista* li = criar_Lista();\n</code></pre>\n\n<p>calling the function to store the data, passing the created list as li and the struct as info.</p>\n\n<pre><code>                scanf(\"%s\", info.name);\n                scanf(\"%d\", &amp;info.id);\n                insert_List(li, info); // Calling the function to store the data inserted above.\n</code></pre>\n\n<p>Here's my inserting function which is called by the main function to store the struct in the list.</p>\n\n<pre><code>int insert_List(List* li, struct student info){\n    Elem* no = (Elem*) malloc(sizeof(Elem));\n    if (li == NULL || no == NULL) {\n        return 0;\n    }\n    no-&gt;data =  info;\n    no-&gt;next  = (*li);\n    *li       =    no; \n\n    return 1;\n}\n</code></pre>\n\n<p>The problem is, when I try to get the output, again, I call the function to print the list in my main function. Using, print_Students(List *li); Instead of the names and IDs, the program ends. Not errors are shown. am I storing it correctly?</p>\n\n<pre><code>void print_Students(List *li){\n    if (li == NULL) {\n        return;\n    }\n\n    Elem* no = *li;\n    while (no != NULL) {\n        printf(\"ID: %d\\n\", no-&gt;dados.id);\n        printf(\"Nome: %s\\n\", no-&gt;dados.name);        \n        printf(\"----------------------------------\\n\");\n        no = no -&gt; prox;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "file", "game-development"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1574883503, "post_id": 59077335, "comment_id": 104391846, "body": "You could run the program from a script file, which passes setup information as program arguments. For example <code>sokoban level=3</code>"}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 2, "creation_date": 1574883804, "post_id": 59077335, "comment_id": 104391985, "body": "&quot;<i>How Could I execute a c code from an outer txt file</i>&quot; - the content of the outer file shouldn&#39;t be C code, but just a configuration that your C code program will parse and use."}], "owner": {"reputation": 1, "user_id": 11320768, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dFamhVwIoiQ/AAAAAAAAAAI/AAAAAAAAAFc/Wo_sVF9Y5tE/photo.jpg?sz=128", "display_name": "marcell emmer", "link": "https://stackoverflow.com/users/11320768/marcell-emmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574883315, "creation_date": 1574883191, "last_edit_date": 1574883315, "question_id": 59077335, "link": "https://stackoverflow.com/questions/59077335/how-could-i-execute-a-c-code-from-an-outer-txt-file", "title": "How could I execute a c code from an outer .txt file?", "body": "<p>I am making a small sokoban game and I would like to load in the level setup from an outer txt file, but I'm new to file management. How Could I execute a c code from an outer txt file?</p>\n"}, {"tags": ["c", "debugging", "assembly", "exe"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1574882867, "post_id": 59077120, "comment_id": 104391548, "body": "Why don&#39;t you give them an executable without the debugging information? You won&#39;t be able to prevent them reverse-engineering it though. The best you can hope for is obfuscation, perhaps red herrings too."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1574883147, "post_id": 59077120, "comment_id": 104391688, "body": "You might not have access to the debugger&#39;s data space, even if you knew the insides of every debugger they might be using."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1574895589, "post_id": 59077120, "comment_id": 104396164, "body": "@WeatherVane: There are some debugger-detection techniques, so you can write code like <code>if(debugger_present()) exit();</code> forcing someone to find that code and work around / skip over it before they can reach and single-step the actual password-checking code.  I&#39;d google for <code>debugger detection</code>.   Although if it blocks for I/O right before verifying the password, attaching a debugger <i>at that point</i> is the obvious thing.  I guess you could do debugger detection again after that. Or maybe take the password as a command line arg."}, {"owner": {"reputation": 87, "user_id": 11837920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a63446cdf9e7f3ddcadccc5ea1147326?s=128&d=identicon&r=PG&f=1", "display_name": "user338717", "link": "https://stackoverflow.com/users/11837920/user338717"}, "edited": false, "score": 0, "creation_date": 1576275776, "post_id": 59077120, "comment_id": 104860337, "body": "A good way would be to not actually store the password in the software, look into a hashing function like djb2 and calculate the hash of the password then hash any input to the program and compare it to the stored hash. Hashes can&#39;t be easily reversed so it would be quite difficult to recover the password. If you do this then it doesn&#39;t matter if they attach a debugger and follow the code, they will only see something like if (hash(input) == 0xdeadbeef) but they won&#39;t know which input generates that hash without bruteforcing all possibilities."}], "owner": {"reputation": 61, "user_id": 10933389, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Msm94wSeYmM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY-4McnFGJIcQ6jn-NrJQ2U3KlFNw/mo/photo.jpg?sz=128", "display_name": "\u05e2\u05d5\u05de\u05e8 \u05d0\u05e0\u05d2\u05d9", "link": "https://stackoverflow.com/users/10933389/%d7%a2%d7%95%d7%9e%d7%a8-%d7%90%d7%a0%d7%92%d7%99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574882280, "creation_date": 1574882280, "question_id": 59077120, "link": "https://stackoverflow.com/questions/59077120/where-does-a-debugger-saves-the-pointer-to-the-next-command-in-the-code-segment", "title": "where does a debugger saves the pointer to the next command in the code segment?", "body": "<p>I am working on a challenge for my school and teacher. Basically they are given a .exe file that receives a password input and their goal is to break the password. They can use whatever they like to try and do it and I'm already working on some defense mechanisms. One thing I want to do is to prevent them from debugging the decompiled version of the .exe file(they will use Ghidra to reverse engineer it).</p>\n\n<p>I know debuggers work by running the code one command after another, basically like a script. I thought of a possible(I hope) concept and thought about accessing the software's memory in order to be able to edit the value of the pointer to the next command on the debugger. \nMeaning if the debugger is now running a certain command line from the code, it must have stored a pointer to it somewhere, and perhaps I would be able to change the value of the pointer mid-run, to mess with the debugging process. Is there a way to know where a certain debugger stores the pointer value of the next command?</p>\n"}, {"tags": ["c", "struct"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 11403739, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6Oi6SuHh8mA/AAAAAAAAAAI/AAAAAAAAGAo/WgW5Jg4nagM/photo.jpg?sz=128", "display_name": "JoelinRome", "link": "https://stackoverflow.com/users/11403739/joelinrome"}, "edited": false, "score": 0, "creation_date": 1574888523, "post_id": 59077860, "comment_id": 104393849, "body": "This is great thank you! Only issue is that I want to sort them the other way round. Would I just have to change the <code>-</code> to a <code>+</code> in the <code>compare()</code> function?"}, {"owner": {"reputation": 61, "user_id": 11403739, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6Oi6SuHh8mA/AAAAAAAAAAI/AAAAAAAAGAo/WgW5Jg4nagM/photo.jpg?sz=128", "display_name": "JoelinRome", "link": "https://stackoverflow.com/users/11403739/joelinrome"}, "edited": false, "score": 0, "creation_date": 1574889077, "post_id": 59077860, "comment_id": 104394072, "body": "Nevermind! I&#39;ve just changed the <code>&lt;</code> operator around in the <code>compare()</code> and that&#39;s fixed the problem :)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 61, "user_id": 11403739, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6Oi6SuHh8mA/AAAAAAAAAAI/AAAAAAAAGAo/WgW5Jg4nagM/photo.jpg?sz=128", "display_name": "JoelinRome", "link": "https://stackoverflow.com/users/11403739/joelinrome"}, "edited": false, "score": 1, "creation_date": 1574891240, "post_id": 59077860, "comment_id": 104394832, "body": "Yes, sorry for the delay, you can just swap the conditional from <code>&gt;</code> <code>&lt;</code> to <code>&lt;</code> <code>&gt;</code> for a descending sort. Good luck with your coding."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 1, "last_activity_date": 1574885838, "creation_date": 1574885838, "answer_id": 59077860, "question_id": 59076956, "link": "https://stackoverflow.com/questions/59076956/how-to-sort-an-array-of-structs-nested-in-a-array-of-structs-c/59077860#59077860", "title": "How to sort an array of structs nested in a array of structs C", "body": "<p>You are making things much harder and much more error prone by trying to <em>roll-your-own</em> sort routine rather than using <code>qsort</code> provided by the C library. With <code>qsort</code> all you need to do is write a <em>compare</em> function that compares elements of the <code>boat_data[]</code> array member of <code>race_node</code>. The compare function prototype is:</p>\n\n<pre><code> int compare (const void *a, const void *b)\n</code></pre>\n\n<p>Where all <code>a</code> and <code>b</code> are, are pointers to elements of the array <code>boat_data[]</code>. So within <code>compare</code> you simply need to cast <code>a</code> and <code>b</code> to the correct type (e.g. <code>struct boat_node const *pa = a, *pb = b;</code> or if you complete your <code>typedef</code> on your first struct, simply <code>boat_node const *pa = a, *pb = b;</code>). </p>\n\n<p>Then compare <code>pa-&gt;time_to_complete_race</code> and <code>pb-&gt;time_to_complete_race</code> returning <code>-1</code> if <code>pa-&gt;time_to_complete_race</code> sorts <em>before</em> <code>pb-&gt;time_to_complete_race</code> or <code>1</code> if <code>pb-&gt;time_to_complete_race</code>sorts <em>before</em> <code>pa-&gt;time_to_complete_race</code>, or <code>0</code> if they are equal (<strong>note:</strong> exactly the way <code>strcmp()</code> does)</p>\n\n<p>Your <code>compare</code> function is then:</p>\n\n<pre><code>int compare (const void *a, const void *b)\n{\n    boat_node const *pa = a, *pb = b;\n\n    return (pa-&gt;time_to_complete_race &gt; pb-&gt;time_to_complete_race) -\n            (pa-&gt;time_to_complete_race &lt; pb-&gt;time_to_complete_race);\n}\n</code></pre>\n\n<p><strong>note:</strong> after completing your <code>typedef</code>, e.g.</p>\n\n<pre><code>typedef struct boat_data {\n    int ID;\n    int time_to_complete_race;\n    int points;\n} boat_node;\n</code></pre>\n\n<p>Then to sort your <code>boat_data[]</code> array which is a member of <code>race_node race</code> , all you do is call:</p>\n\n<pre><code>    qsort (race.boat_data, race.num_boats_competing, \n            sizeof *race.boat_data, compare);\n</code></pre>\n\n<p>(done!)</p>\n\n<p>New C programmers are often hesitant to use <code>qsort</code> because they don't know how to write the <em>compare</em> function. After you make friends with the fact that <code>a</code> and <code>b</code> are just <em>pointers to</em> elements of whatever you are sorting, you can easily provide a cast to the proper type and then a comparison that tells <code>qsort</code> how you want it sorted. </p>\n\n<p>In this case you simply want the array of <code>boat_data[]</code> sorted by <code>time_to_complete_race</code>. The <code>return (a &gt; b) - (a &lt; b)</code> form is simply a convenient way to avoid potential overflow were you tempted to <code>return a - b;</code> where, e.g., <code>a</code> is a large negative integer and <code>b</code> a large positive integer.</p>\n\n<p><strong>Full Example</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define MAX_BOAT_NUMBER 10\n\ntypedef struct boat_data {\n    int ID;\n    int time_to_complete_race;\n    int points;\n} boat_node;\n\ntypedef struct race_result {\n    char race_date[80];\n    int start_time;\n    int num_boats_competing;\n    boat_node boat_data[MAX_BOAT_NUMBER];\n} race_node;\n\nint compare (const void *a, const void *b)\n{\n    boat_node const *pa = a, *pb = b;\n\n    return (pa-&gt;time_to_complete_race &gt; pb-&gt;time_to_complete_race) -\n            (pa-&gt;time_to_complete_race &lt; pb-&gt;time_to_complete_race);\n}\n\nint main (void) {\n\n    race_node race = { .race_date = \"11/26/19\",\n                       .start_time = 1400,\n                       .num_boats_competing = 3,\n                       .boat_data = {{ 1, 23, 0 },\n                                     { 2, 21, 0 },\n                                     { 3, 22, 0 }} };\n\n    qsort (race.boat_data, race.num_boats_competing, \n            sizeof *race.boat_data, compare);\n\n    for (int i = 0; i &lt; race.num_boats_competing; i++)\n        printf (\"%2d  %4d  %d\\n\", race.boat_data[i].ID,\n                race.boat_data[i].time_to_complete_race,\n                race.boat_data[i].points);\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<p>The <code>points</code> members were left all <code>0</code>:</p>\n\n<pre><code>$ ./bin/boat_race\n 2    21  0\n 3    22  0\n 1    23  0\n</code></pre>\n\n<p>Much easier than trying to write your own sort. Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 61, "user_id": 11403739, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6Oi6SuHh8mA/AAAAAAAAAAI/AAAAAAAAGAo/WgW5Jg4nagM/photo.jpg?sz=128", "display_name": "JoelinRome", "link": "https://stackoverflow.com/users/11403739/joelinrome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 59077860, "answer_count": 1, "score": 0, "last_activity_date": 1574885838, "creation_date": 1574881411, "question_id": 59076956, "link": "https://stackoverflow.com/questions/59076956/how-to-sort-an-array-of-structs-nested-in-a-array-of-structs-c", "title": "How to sort an array of structs nested in a array of structs C", "body": "<p>I know there are similiar posts to this one but I can't get my head around them so I'm making one too so please don't mark this as a duplicate :)</p>\n\n<p>I've got 2 nested arrays of structs where the outer structs are races and the inner structs are the number of boats from those races. I want to sort the inner struct so that the boats are in ascending order of <code>time_to_complete_race</code> and once I've done this I then assign the first boat in the array <code>points = 4</code>, the second <code>points = 2</code> and the third<code>points = 1</code>. I haven't however implemented the points assinging yet so please ignore this part.</p>\n\n<pre><code>struct boat_data {\n    int ID;\n    int time_to_complete_race;\n    int points;\n} boat_node;\ntypedef struct race_result {\n    char race_date[80];\n    int start_time;\n    int num_boats_competing;\n    struct boat_data boat_data[MAX_BOAT_NUMBER];\n} race_node;\n</code></pre>\n\n<p>Here is the code that I am using to sort the inner stucts:</p>\n\n<pre><code>void print_races(int races, race_ptr results[], member_node_ptr member) {\n\n    for(int race = 0; race &lt; races; race++) {\n        printf(\"Race Date: %s\\n\", results[race].race_date);\n        printf(\"Race Start Time: %d\\n\", results[race].start_time);\n        printf(\"Number of Skippers: %d\\n\", results[race].num_boats_competing);\n        for(int boats = 0; boats &lt; results[race].num_boats_competing; boats++) {\n            find_node_by_id(member, results[race].boat_data[boats].ID);\n            printf(\"\\tTime to Complete Race in Seconds: %d\\n\",\n                    results[race].boat_data[boats].time_to_complete_race);\n        }\n        printf(\"\\n\");\n    }\n}\n\nvoid print_sorted_races(int races, race_ptr results[], member_node_ptr member) {\n\n    race_ptr sorted_results[races];\n    struct boat_data temp;\n\n    int race, swap, boat;\n\n    for (race = 0; race &lt; races; race++) {\n        sorted_results[race] = results[race];\n    }\n\n    for (race = 0; race &lt; races; race++) {\n\n        for (boat = 0; boat&lt; (sorted_results[race].num_boats_competing -1); boat++) {\n            for (swap = race + 1; swap &lt; sorted_results[race].num_boats_competing; swap++) {\n                if (sorted_results[race].boat_data[swap].time_to_complete_race &gt;\n                    sorted_results[race].boat_data[boat].time_to_complete_race) {\n                    temp = sorted_results[race].boat_data[boat];\n                    sorted_results[race].boat_data[boat] = sorted_results[race].boat_data[swap];\n                    sorted_results[race].boat_data[swap] = temp;\n                }\n            }\n        }\n    }\n    print_races(races, results, member);\n}\n</code></pre>\n"}, {"tags": ["c", "unit-testing", "embedded"], "comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1574876794, "post_id": 59075556, "comment_id": 104389009, "body": "It seems as if you can use function pointers if I understand correctly."}, {"owner": {"reputation": 266, "user_id": 2350670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/c7zkm.jpg?s=128&g=1", "display_name": "Awais Chishti", "link": "https://stackoverflow.com/users/2350670/awais-chishti"}, "edited": false, "score": 0, "creation_date": 1574878853, "post_id": 59075556, "comment_id": 104389931, "body": "Not sure if I understood your question correctly. Do you want <code>anotherFunction</code> equal to <code>stubFunction</code> in the scope of <code>functionName</code>? I think you can only have that by redeclaring:  <code>void (*anotherFunction)(type, type*) = stubFunction;</code>"}, {"owner": {"reputation": 479, "user_id": 8321975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d934a13d46469176a140ba9b04c929c?s=128&d=identicon&r=PG&f=1", "display_name": "kesselhaus", "link": "https://stackoverflow.com/users/8321975/kesselhaus"}, "edited": false, "score": 1, "creation_date": 1574929167, "post_id": 59075556, "comment_id": 104404654, "body": "Canata can create BEFORE, REPLACE, AFTER wrappers for functions and will instrument your code accordingly, even for functions within the SUT itself."}], "owner": {"reputation": 389, "user_id": 5948396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0GYNK.jpg?s=128&g=1", "display_name": "Walkingbeard", "link": "https://stackoverflow.com/users/5948396/walkingbeard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574875775, "creation_date": 1574875775, "question_id": 59075556, "link": "https://stackoverflow.com/questions/59075556/how-can-i-stub-or-wrap-or-reassign-c-functions-during-testing-of-a-file-in-the", "title": "How can I stub, or wrap, or reassign C functions during testing of a file in the same unit?", "body": "<blockquote>\n  <p>Compiler: GCC 7.4 (C compiler)</p>\n  \n  <p>Unit test framework: Cantata 6.2</p>\n</blockquote>\n\n<p>I have a unit in test in which functions take this general form:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void functionName(type *x, type y, type *result)\n{\n   assert(NULL != result);\n   *result = OK;\n\n   if (NULL == x)\n      *result = NOT_OK;\n\n   if (OK == *result)\n      otherFunction(y, result);\n\n   if (OK == *result)\n      anotherFunction(y, result);\n\n   if (OK == *result)\n      yetAnotherFunction(y, result);\n}\n</code></pre>\n\n<p>All the inputs to all the functions in the unit, and a number of unit-level variables, are tested in various ways as a matter of course. I now have a test coverage problem, because I am unable to stub functions <em>within the same unit</em> which are called by the function under test, and, therefore, I cannot force the <code>result</code> of the called function. This means that some of those <code>(OK == *result)</code> predicates can never be false.</p>\n\n<p>How do you get around this?</p>\n\n<p>I have tried reassigning the inner function in the test script:</p>\n\n<pre><code>anotherFunction = stubFunction;\n</code></pre>\n\n<p>This, not entirely unpredictably, gives me this compilation error:</p>\n\n<pre><code>error: lvalue required as left operand of assignment\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "edited": false, "score": 7, "creation_date": 1574875625, "post_id": 59075499, "comment_id": 104388464, "body": "You never return from an <code>exec*()</code> call, except if it fails."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 4, "creation_date": 1574875647, "post_id": 59075499, "comment_id": 104388473, "body": "It won&#39;t show up unless <code>execl()</code> fails. The <code>exec()</code> family of functions literally completely replace the current process. See <a href=\"https://stackoverflow.com/questions/4204915/please-explain-the-exec-function-and-its-family\" title=\"please explain the exec function and its family\">stackoverflow.com/questions/4204915/&hellip;</a>  (I&#39;ll let others decide if this is a duplicate of that question.)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1574875660, "post_id": 59075499, "comment_id": 104388482, "body": "Do you know what <code>execl()</code> does?  Do you know how very, very different it is from <code>system()</code>?  (You probably want <code>system()</code>.)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1574875865, "post_id": 59075499, "comment_id": 104388585, "body": "If you don&#39;t want to replace the current process, call <code>execl()</code> in a child process created with <code>fork()</code>. Then use <code>wait()</code> in the parent to wait for it to finish."}], "answers": [{"tags": [], "owner": {"reputation": 7495, "user_id": 11527076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xqgpS.png?s=128&g=1", "display_name": "prog-fh", "link": "https://stackoverflow.com/users/11527076/prog-fh"}, "is_accepted": true, "score": 2, "last_activity_date": 1574876515, "last_edit_date": 1574876515, "creation_date": 1574875720, "answer_id": 59075544, "question_id": 59075499, "link": "https://stackoverflow.com/questions/59075499/printf-after-execl-not-showing/59075544#59075544", "title": "printf after execl not showing", "body": "<p>From the man page\n<a href=\"https://linux.die.net/man/3/execl\" rel=\"nofollow noreferrer\">https://linux.die.net/man/3/execl</a></p>\n\n<p><strong>Return Value</strong>\nThe exec() functions only return if an error has occurred. The return value is -1, and errno is set to indicate the error. </p>\n\n<p>If you really want to use <code>execl()</code> instead of <code>system()</code>, then\nyou should change the code like this.</p>\n\n<pre><code>#include&lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void){\n    printf (\"Show content from directory /:\\n\");\n\n    pid_t p=fork(); // create a child process\n    if(p==0) // if we are in the child process\n    {\n      execl( \"/bin/ls\", \"ls\", \"-l\", \"/\", NULL ); // replace it with a new program\n      perror(\"execl\"); // reaching this line is necessarily a failure\n      exit(1); // terminate child process in any case\n    }\n    waitpid(p, NULL, 0); // wait for child process to terminate\n\n    fprintf (stdout,\"End of command: ls -l /\\n\");\n    fflush(stdout);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11574240"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 1, "accepted_answer_id": 59075544, "answer_count": 1, "score": 0, "last_activity_date": 1574879668, "creation_date": 1574875521, "last_edit_date": 1574875549, "question_id": 59075499, "link": "https://stackoverflow.com/questions/59075499/printf-after-execl-not-showing", "title": "printf after execl not showing", "body": "<p>I'm testing the <code>execl()</code> function tho I'm not being able to solve how to make the <code>printf()</code> after the <code>execl()</code> show up when I run the program. I figured out it has something to do with the <code>fflush()</code> function, although I still can't do it. \nHeres the code.</p>\n\n<pre><code>#include&lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid main(){\n    printf (\"Show content from directory /:\\n\");\n    execl( \"/bin/ls\", \"ls\", \"-l\", \"/\", NULL );\n    fprintf (stdout,\"End of command: ls -l /\\n\");\n    fflush(stdout);\n}\n</code></pre>\n"}, {"tags": ["c", "struct", "c99"], "comments": [{"owner": {"reputation": 63634, "user_id": 215752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/face3276756bf64319a7d1df0d194d5c?s=128&d=identicon&r=PG", "display_name": "Hogan", "link": "https://stackoverflow.com/users/215752/hogan"}, "edited": false, "score": 0, "creation_date": 1574875639, "post_id": 59075479, "comment_id": 104388471, "body": "The idea that there is a &quot;right&quot; way to do this assumes there is a quick fix.  this is not the case in C.  In other languages that have been build to have quick init there is a way to do it.  In C there isn&#39;t."}, {"owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 0, "creation_date": 1574875796, "post_id": 59075479, "comment_id": 104388545, "body": "The question asks which is better, not which is &quot;right&quot;. It&#39;s a fair question. If your answer is it doesn&#39;t matter, mind posting that as an answer?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1574876064, "post_id": 59075479, "comment_id": 104388678, "body": "There&#39;s little practical difference between the two methods. Static variables are normally only used if you need to save the value between calls. If you&#39;re initializing the variable every time, and not returning a pointer to it, there&#39;s no reason to make it static."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1574878129, "post_id": 59075479, "comment_id": 104389621, "body": "...unless it is very large and might break the stack."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10530794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-puQtA1JQ7jU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbD4417Kindb5gjX1NTdBtnLZFqCtw/mo/photo.jpg?sz=128", "display_name": "Alex Gh", "link": "https://stackoverflow.com/users/10530794/alex-gh"}, "edited": false, "score": 0, "creation_date": 1574887483, "post_id": 59075961, "comment_id": 104393422, "body": "One question: You are mentioning the fact that the compiler might generate similar code for the two versions and they might have comparable results, but considering a structure big enough (512 bytes might not be considered big, but) isn&#39;t every stack allocation for automatic objects going to take a &quot;huge&quot; amount of time, compared to having the memory already reserved from the static object?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 45, "user_id": 10530794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-puQtA1JQ7jU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbD4417Kindb5gjX1NTdBtnLZFqCtw/mo/photo.jpg?sz=128", "display_name": "Alex Gh", "link": "https://stackoverflow.com/users/10530794/alex-gh"}, "edited": false, "score": 0, "creation_date": 1574888009, "post_id": 59075961, "comment_id": 104393636, "body": "@AlexGh: Stack allocation for a 512-byte object typically requires at most one instruction: Subtract 512 from the stack pointer. Often it requires zero instructions because the compiler merely includes it in the subtraction already performed for the entire stack frame of the function."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 0, "last_activity_date": 1574877346, "creation_date": 1574877346, "answer_id": 59075961, "question_id": 59075479, "link": "https://stackoverflow.com/questions/59075479/is-it-better-to-redeclare-a-struct-inside-function-or-declare-it-static-and-set/59075961#59075961", "title": "Is it better to redeclare a struct inside function or declare it static and set to 0 everytime?", "body": "<p>If the C program specified an actual static object or an object automatically allocated on the stack, the performance of these two pieces of code would be nearly identical. There might be minuscule performance differences based on how one was addressed or some performance differences based on where they happened to be allocated with respect to other data and cache properties. (In particular, the automatic version might have better properties since the memory is not reserved exclusively for the structure. It would be shared with other data while other functions are executing instead of <code>some_function</code>, and therefore it might reside in cache more often and result in fewer memory accesses. Additionally, since it would be shared with other functions, the entire program might use less memory overall, which improves performance.)</p>\n\n<p>However, C programs do not directly specify what a computer must do (although some C implementations may be implemented that way or have switches to do it, or something near it). Per the C standard, a C program specifies an imaginary computation in an abstract machine. The job of a C compiler is to translate that computation into a program for a real machine. It is given great latitude to do so.</p>\n\n<p>One thing this means is that if a compiler and see and sufficiently analyze enough of the source code to see that the two versions of the function behave identically (in terms of <em>observable behavior</em>), it can translate them to identical code. (Observable behavior includes input and output interactions, access to volatile objects, and data written to files.) In that case, there is no performance difference.</p>\n\n<p>If anything, the automatic version is easier for the compiler to analyze. It knows the automatic object will vanish (in the abstract machine) when the function ends. Although, in both cases you clear the object at the start of the function, so the compiler, assuming knowledge about <code>memset</code> has been built into it, knows the object begins anew in this regard each time the function starts, there are other ways the behavior could differ that a compiler writer has to worry about. For example, if the address of the static structure is taken, and especially if it is passed to any other routines, the compiler has to be concerned that the data in it might be used after the function returns, by other code that has retained the address of it. In contrast, for the automatic structure, the compiler may behave as if the automatic object is never used after the function returns because, in the abstract machine, it ceases to exist when the function returns. (Therefore, if any other code did retain its address, the use of that address is not defined by the C standard, and the compiler does not have to do anything for it.)</p>\n\n<p>So, except in esoteric circumstances or mere happenstance of memory and cache behavior, we can generally expect the automatic version to be at least as good as the static version.</p>\n\n<p>In general, write software to express what you need to\u2014and only what you need to. If an object does not need to persist beyond the function\u2019s lifetime, then leave it as an automatic object and do not make it static.</p>\n\n<p>Note that it is often unnecessary to zero all of such a structure anyway, because:</p>\n\n<ul>\n<li>The part of the structure that is used might be indicated with a length or a sentinel (such as a null character marking the end), and so no software will attempt to read any later portion, so there is no need to initialize it.</li>\n<li>Or, if all of the structure will be read, then the software could be designed to fill in the non-zero part and then zero only the remaining part, instead of first zeroing the entire structure.</li>\n</ul>\n"}], "owner": {"reputation": 45, "user_id": 10530794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-puQtA1JQ7jU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbD4417Kindb5gjX1NTdBtnLZFqCtw/mo/photo.jpg?sz=128", "display_name": "Alex Gh", "link": "https://stackoverflow.com/users/10530794/alex-gh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 59075961, "answer_count": 1, "score": 0, "last_activity_date": 1574877346, "creation_date": 1574875431, "question_id": 59075479, "link": "https://stackoverflow.com/questions/59075479/is-it-better-to-redeclare-a-struct-inside-function-or-declare-it-static-and-set", "title": "Is it better to redeclare a struct inside function or declare it static and set to 0 everytime?", "body": "<p>Basically, if I have a struct like:</p>\n\n<pre><code>struct header {\n  char ptr[512];\n};\n</code></pre>\n\n<p>and I have a function like so:</p>\n\n<pre><code>void some_function() {\n  struct header header = { 0 };\n\n  // do something with struct\n}\n</code></pre>\n\n<p>Would it actually benefit performance-wise to do it like this:</p>\n\n<pre><code>void some_function() {\n  static struct header header;\n\n  memset((char *)&amp;header, 0, sizeof(header));\n  // do something with struct\n}\n</code></pre>\n\n<p>I know memset doesn't always work if the struct contains pointers since NULL might not be located at address 0x0000, but for this case when this doesn't matter, what is the better way to do it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1574871663, "post_id": 59074435, "comment_id": 104386445, "body": "What makes you doubt the correctness?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1574871720, "post_id": 59074435, "comment_id": 104386469, "body": "<code>begin =  realloc(1, length+1);</code> why do you think the first argument to realloc is an int?"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1574871733, "post_id": 59074435, "comment_id": 104386476, "body": "<code>realloc(1, length+1)</code> -- Is this a typo? You&#39;re passing <code>1</code> as a pointer?"}, {"owner": {"reputation": 13, "user_id": 8415382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8s0l8C3cO_o/AAAAAAAAAAI/AAAAAAAAACc/HMCCL-pNVnM/photo.jpg?sz=128", "display_name": "Poornima M", "link": "https://stackoverflow.com/users/8415382/poornima-m"}, "edited": false, "score": 0, "creation_date": 1574871774, "post_id": 59074435, "comment_id": 104386498, "body": "yes. corrected it. All I want is to resize the pointer begin to be able to hold the result in it."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1574871841, "post_id": 59074435, "comment_id": 104386536, "body": "<code>begin</code> is  a local variable and the reallocation does not find its way out of the function."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1574872190, "post_id": 59074435, "comment_id": 104386710, "body": "How is <code>get_result</code> any better than <code>gets</code>?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1574872543, "post_id": 59074435, "comment_id": 104386892, "body": "@Barmar I deleted my comments, you can delete you&#39;s too, thanks"}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1574871984, "creation_date": 1574871984, "answer_id": 59074559, "question_id": 59074435, "link": "https://stackoverflow.com/questions/59074435/realloc-function-in-c/59074559#59074559", "title": "Realloc function in C", "body": "<p>No, it won't necessarily change <code>value</code>. <code>realloc()</code> is allowed to extend the length of an existing allocation, or create a new allocation and free the old one. You need to assign the returned pointer back to <code>value</code>.</p>\n\n<p>Change <code>string_copy</code> to return the new pointer.</p>\n\n<pre><code>char * string_copy(char *value)\n{\n     char *begin = value;\n     char result[1000] = {'\\0'};\n\n     //get_result will return the length of result\n     int length = get_result(result);\n\n     if (length &gt;= strlen(begin)) \n     {\n         begin =  realloc(begin, length+1);\n     }\n     strncpy(begin, result, length);\n     begin[length] = '\\0';\n\n     return begin;\n}\n\nvoid test_function()\n{\n    char *value;\n    value = calloc(1,10);\n    value = string_copy(value);\n    printf(\"value = %s\\n\", value);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8415382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8s0l8C3cO_o/AAAAAAAAAAI/AAAAAAAAACc/HMCCL-pNVnM/photo.jpg?sz=128", "display_name": "Poornima M", "link": "https://stackoverflow.com/users/8415382/poornima-m"}, "edited": false, "score": 0, "creation_date": 1574872770, "post_id": 59074663, "comment_id": 104387016, "body": "Thanks!! I will do this. Could you please help me understand if it is okay to free the &#39;temp&#39; anywhere after this?"}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 13, "user_id": 8415382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8s0l8C3cO_o/AAAAAAAAAAI/AAAAAAAAACc/HMCCL-pNVnM/photo.jpg?sz=128", "display_name": "Poornima M", "link": "https://stackoverflow.com/users/8415382/poornima-m"}, "edited": false, "score": 0, "creation_date": 1574872892, "post_id": 59074663, "comment_id": 104387092, "body": "If the <code>realloc</code> call fails, <code>temp</code> (which will be <code>NULL</code>) can be forgotten about. If the call succeeds, then - as you copy its value (the address of the new memory block) into <code>begin</code>, you can also forget about it, as the information you need is now in <code>begin</code> - but you <b><i>must not</i></b> free it locally, or <code>begin</code> will then point to invalid memory! (Hope that&#39;s clear!)"}, {"owner": {"reputation": 13, "user_id": 8415382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8s0l8C3cO_o/AAAAAAAAAAI/AAAAAAAAACc/HMCCL-pNVnM/photo.jpg?sz=128", "display_name": "Poornima M", "link": "https://stackoverflow.com/users/8415382/poornima-m"}, "edited": false, "score": 0, "creation_date": 1574875449, "post_id": 59074663, "comment_id": 104388384, "body": "I am getting memory leak message. And unfortunately I cannot afford them . Any help how I can fix it. I am getting the message from the static analyzer saying (20) Event var_assign: \tAssigning: &quot;begin&quot; = &quot;temp&quot;. Also see events: \t[alloc_fn][var_assign][noescape][leaked_storage][leaked_sto&zwnj;&#8203;rage]. I tried freeing &#39;begin&#39; before assigning it with &#39;temp&#39;. But it was resulting in segmentation fault."}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1574890412, "post_id": 59074663, "comment_id": 104394556, "body": "string_copy is called passing an array whose zeroth element is NUL, so in string_copy,  strlen(begin) will always be zero. The ensuing realloc will likely lead to a memory leak."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 13, "user_id": 8415382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8s0l8C3cO_o/AAAAAAAAAAI/AAAAAAAAACc/HMCCL-pNVnM/photo.jpg?sz=128", "display_name": "Poornima M", "link": "https://stackoverflow.com/users/8415382/poornima-m"}, "edited": false, "score": 0, "creation_date": 1574896036, "post_id": 59074663, "comment_id": 104396269, "body": "@PoornimaM There are, to be honest, several problems in your code. First and foremost, read the answer given by Barmar. Then (and only then) try to understand what I&#39;ve suggested here. Seems to me that you don&#39;t appreciate what a pointer is - I can try (but not here) to explain, but <i>you</i> have to make <i>some</i> effort."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 13, "user_id": 8415382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8s0l8C3cO_o/AAAAAAAAAAI/AAAAAAAAACc/HMCCL-pNVnM/photo.jpg?sz=128", "display_name": "Poornima M", "link": "https://stackoverflow.com/users/8415382/poornima-m"}, "edited": false, "score": 0, "creation_date": 1574896289, "post_id": 59074663, "comment_id": 104396337, "body": "@PoornimaM PS: Your &quot;static analyser&quot; is probably being a wee bit too severe - in the code I posted, <code>temp</code> is checked for <code>NULL</code> before it&#39;s assigned to anything."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1574896662, "post_id": 59074663, "comment_id": 104396419, "body": "@FredK - Calling <code>realloc</code> with a <code>NULL</code> pointer as 1st argument equivalates to calling <code>malloc</code>; so, as long as the return value is checked, no memory leak."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "reply_to_user": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1574896805, "post_id": 59074663, "comment_id": 104396452, "body": "@FredK Aah, OK, calling it with a size argument of zero can cause UB."}], "tags": [], "owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "is_accepted": false, "score": 0, "last_activity_date": 1574872311, "creation_date": 1574872311, "answer_id": 59074663, "question_id": 59074435, "link": "https://stackoverflow.com/questions/59074435/realloc-function-in-c/59074663#59074663", "title": "Realloc function in C", "body": "<p>Something you could/should add is the ability to handle a failure of <code>realloc</code>. However, by assigning the return value to the same pointer given as the first argument (very common practice, BTW), you lose the ability to properly do this - as you will have assigned <code>NULL</code> to your 'old' pointer and the memory it used to point to can not be freed.</p>\n\n<p>Better code is something like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>if (length &gt;= strlen(begin)) \n{\n    char* temp = realloc(begin, length+1);\n    if (temp == NULL) { // Realloc failed, but we still have our old pointer in \"begin\"\n        // Handle the error condition (may require \"free(begin)\")\n    }\n    else {\n        begin = temp; // Now we can replace the old pointer with our new one\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8415382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8s0l8C3cO_o/AAAAAAAAAAI/AAAAAAAAACc/HMCCL-pNVnM/photo.jpg?sz=128", "display_name": "Poornima M", "link": "https://stackoverflow.com/users/8415382/poornima-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "closed_date": 1575113872, "answer_count": 2, "score": -2, "last_activity_date": 1574891416, "creation_date": 1574871570, "last_edit_date": 1574891416, "question_id": 59074435, "link": "https://stackoverflow.com/questions/59074435/realloc-function-in-c", "closed_reason": "Not suitable for this site", "title": "Realloc function in C", "body": "<p>Say I have this piece of code,</p>\n\n<pre><code>void string_copy(char *value)\n{\n    char *begin = value;\n    char *temp = NULL;\n    char result[1000] = {'\\0'};\n\n    //get_result will return the length of result\n    int length = get_result(result);\n\n    if (length &gt;= strlen(begin))\n    {\n        temp =  realloc(begin, length+1);\n        if (temp)\n        {\n            begin = temp;\n            strncpy(begin, result, length);\n            begin[length] = '\\0';\n        }\n        else\n        {\n            printf(\"error!\");\n        }\n    }\n    else\n    {\n      strncpy(begin, result, length);\n      begin[length] = '\\0';\n    }\n    return;\n}\n\n\nvoid test_function()\n{\n    char *value;\n    value = calloc(1, 10);\n    string_copy(value);\n    printf(\"value = %s\\n\", value);\n}\n</code></pre>\n\n<p>Say, if I have such a function, wherein I pass a character pointer to get the data copied from another function, and I do \"begin=realloc(xxx...)\" If I find that the space I allocated in the test function is shorter than the length of result. Will it change the size of the 'value' as well?</p>\n\n<p>I am getting a memory leakage error when I assign \"begin\" with \"temp\".</p>\n\n<p>How can I fix it?</p>\n"}, {"tags": ["c", "linux", "udp", "multicast", "openonload"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1574909292, "post_id": 59074015, "comment_id": 104398820, "body": "What is <code>Onload</code>? I don&#39;t think it is the JavaScript <code>Onload</code> the question is tagged with."}, {"owner": {"reputation": 24928, "user_id": 997112, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/7c52a3944cdd2eac9725e54fc548f368?s=128&d=identicon&r=PG", "display_name": "user997112", "link": "https://stackoverflow.com/users/997112/user997112"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1575049246, "post_id": 59074015, "comment_id": 104449611, "body": "@jww Solarflare Onload"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12517227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18633064d631d42c1fb697f626dcc891?s=128&d=identicon&r=PG&f=1", "display_name": "bunnywarren", "link": "https://stackoverflow.com/users/12517227/bunnywarren"}, "is_accepted": false, "score": 0, "last_activity_date": 1576660481, "creation_date": 1576660481, "answer_id": 59388750, "question_id": 59074015, "link": "https://stackoverflow.com/questions/59074015/receiving-every-multicast-packet-twice-onload/59388750#59388750", "title": "Receiving every multicast packet twice Onload?", "body": "<p>The most likely reason for a packet being seen twice in the application is that it is arriving twice to the host, either twice on the same interface or on different interfaces. Try running a packet capture (<code>tcpdump</code> or <code>onload_tcpdump</code>) to confirm if this is the case.</p>\n\n<p>This behaviour is different from the kernel where packets arriving on the \"wrong\" interface are dropped. Onload will typically install a filter on all accelerated interfaces to capture traffic and not just the one specified by the application.</p>\n"}], "owner": {"reputation": 24928, "user_id": 997112, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/7c52a3944cdd2eac9725e54fc548f368?s=128&d=identicon&r=PG", "display_name": "user997112", "link": "https://stackoverflow.com/users/997112/user997112"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 315, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1576660481, "creation_date": 1574870156, "last_edit_date": 1575330018, "question_id": 59074015, "link": "https://stackoverflow.com/questions/59074015/receiving-every-multicast-packet-twice-onload", "title": "Receiving every multicast packet twice Onload?", "body": "<p>I am listening to multicast data from an external source.</p>\n\n<p>When my application runs <strong>without</strong> <code>Onload</code>, everything is fine. However, when I run under <code>Onload</code> I receive every packet twice.</p>\n\n<p>This is how I join the multicast group:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct ip_mreq mreq;\nbzero(&amp;mreq,sizeof(mreq));\nmreq.imr_multiaddr.s_addr = inet_addr(\"233.1.2.3\");\nmreq.imr_interface.s_addr = inet_addr(\"192.1.2.3\");\n\nif (setsockopt(sock, IPPROTO_IP, IP_ADD_MEMBERSHIP, (char *)&amp;mreq, sizeof(mreq)) &lt; 0)\n    ...\n</code></pre>\n\n<p>How can I run under <code>Onload</code> without receiving every packet twice?</p>\n"}, {"tags": ["c", "filesystems", "buffer", "system-calls"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1574870251, "post_id": 59073982, "comment_id": 104385654, "body": "<code>write(fd, &amp;i, sizeof i);</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1574870572, "post_id": 59073982, "comment_id": 104385850, "body": "This will write the binary value as befits the use of <code>write</code>. If you want the textual representation then use <code>fprintf</code>."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1574872079, "post_id": 59074315, "comment_id": 104386648, "body": "Sadly that will overflow <code>number_s</code>. Don&#39;t forget the string terminator, or that <code>%2d</code> does not guarantee that only 2 digits are written."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1574872245, "post_id": 59074315, "comment_id": 104386739, "body": "@WeatherVane <code>%2s</code> doesn&#39;t limit the output to two characters anyway."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1574872306, "post_id": 59074315, "comment_id": 104386773, "body": "@thangpx1706 It&#39;s not clear the OP wants a string.  (Maybe, maybe not).  Also, <code>[2]</code> is <i>waayy</i> too small."}, {"owner": {"reputation": 122, "user_id": 11020581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406fb5b1b5576572f7859d10c627add6?s=128&d=identicon&r=PG&f=1", "display_name": "thangpx1706", "link": "https://stackoverflow.com/users/11020581/thangpx1706"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1574911838, "post_id": 59074315, "comment_id": 104399340, "body": "@Steve This is just an example because in his problem the <code>i</code> variable is only in a range of <code>0</code> to <code>10</code>, and I think 2 is enough."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1575028154, "post_id": 59074315, "comment_id": 104440426, "body": "<code>char number_s[2];</code> and plain <code>%d</code> would work for single-digit numbers.  <code>%2d</code> guarantees overflow for any numbers.  The OP&#39;s example was just an example; a robust solution would work without complaint for larger inputs.  Sizing arrays like <code>number_s</code> to be just barely as big as one thinks they need to be is false, pointless economy."}], "tags": [], "owner": {"reputation": 122, "user_id": 11020581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406fb5b1b5576572f7859d10c627add6?s=128&d=identicon&r=PG&f=1", "display_name": "thangpx1706", "link": "https://stackoverflow.com/users/11020581/thangpx1706"}, "is_accepted": false, "score": -2, "last_activity_date": 1574871156, "creation_date": 1574871156, "answer_id": 59074315, "question_id": 59073982, "link": "https://stackoverflow.com/questions/59073982/how-to-using-write-system-call-write-an-integer-in-to-file/59074315#59074315", "title": "How to using write() system call write an integer in to file", "body": "<p>you can use <code>sprintf()</code> function to create the string first, and then use it in <code>write()</code> such as:</p>\n\n<pre><code>char number_s[2];\nsprintf(number_s,\"%2d\",i);\nwrite(fd,number_s,strlen(number_s));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 1, "last_activity_date": 1574873246, "last_edit_date": 1574873246, "creation_date": 1574872462, "answer_id": 59074713, "question_id": 59073982, "link": "https://stackoverflow.com/questions/59073982/how-to-using-write-system-call-write-an-integer-in-to-file/59074713#59074713", "title": "How to using write() system call write an integer in to file", "body": "<p>If you want binary output:</p>\n\n<pre><code> write(fd, &amp;i, sizeof(i));\n</code></pre>\n\n<p>If you want text output, one decimal number per line:</p>\n\n<pre><code>char tmpbuf[50];\nint n = sprintf(tmpbuf, \"%d\\n\", i);\nwrite(fd, tmpbuf, n);\n</code></pre>\n\n<p>If you want text output, 8 hexadecimal digits per int:</p>\n\n<pre><code>char tmpbuf[20];\nint n = sprintf(tmpbuf, \"%08X\", i);\nwrite(fd, tmpbuf, n);\n</code></pre>\n\n<p>If you're not sure which you want, try it all three ways, and take a look at the resulting output files.  (The \"binary\" output won't be easily visible without a \"hex dump\" program, or binary editor.)</p>\n"}], "owner": {"reputation": 109, "user_id": 10515711, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CoO_xjEGEp0/AAAAAAAAAAI/AAAAAAAAADs/L8dKcLm1F3g/photo.jpg?sz=128", "display_name": "Chener Zhang", "link": "https://stackoverflow.com/users/10515711/chener-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1574873246, "creation_date": 1574870029, "question_id": 59073982, "link": "https://stackoverflow.com/questions/59073982/how-to-using-write-system-call-write-an-integer-in-to-file", "title": "How to using write() system call write an integer in to file", "body": "<p>How can i write the integer in to the file by using the write() system call</p>\n\n<pre><code> //write(fd,buffer,strlen(buffer));\n //The buffer in the write() system call has to be an char[]; \n //if i want to write integer such as \n\nfor(int i = 0, i &lt; 10; i++){\n\n    write(fd,i.??); // error \n    // How can i write the integer in to the file by using the write() system call\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 5, "creation_date": 1574869840, "post_id": 59073886, "comment_id": 104385430, "body": "Your arrays are too short and will overflow, causing data corruption or worse. Make them <code>[100]</code> until you get the code working, then establish how they can be adjusted. And please note that the first <code>strcat(total, hrs);</code> should be <code>strcpy(total, hrs);</code> since trying to concatenate to an <i>uninitialised variable</i> is undefined behaviour."}, {"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 1, "creation_date": 1574870100, "post_id": 59073886, "comment_id": 104385580, "body": "Just remember: <code>char</code> strings in <code>C</code> need a null-terminator (which is itself a <code>char</code>)."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1574870160, "post_id": 59073886, "comment_id": 104385603, "body": "You&#39;re working with strings, concatenating them, and calling <code>atoi</code>.  Another way (not saying it&#39;s better or worse, just different) would be to scan <code>hrs</code>, <code>min</code>, and <code>secs</code> as ints using <code>%d</code>, and compute <code>10000*hrs + 100*mins + secs</code>.  (Or for a more compact representation, <code>3600*hrs + 60*mins + secs</code>.)"}, {"owner": {"reputation": 61, "user_id": 11403739, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6Oi6SuHh8mA/AAAAAAAAAAI/AAAAAAAAGAo/WgW5Jg4nagM/photo.jpg?sz=128", "display_name": "JoelinRome", "link": "https://stackoverflow.com/users/11403739/joelinrome"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1574870581, "post_id": 59073886, "comment_id": 104385854, "body": "@SteveSummit Thank You for literally saving me hours of work! I&#39;ve spent ages looking at this trying to figure out the solution. What do I do however if I want to add a leading zero because sometimes the input is <code>1 15 23</code> and the output should be <code>011523</code>"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1574871028, "post_id": 59073886, "comment_id": 104386096, "body": "Is your original input guaranteed to have leading 0&#39;s, or not?  (Your question suggests that&#39;s not guaranteed.)  The answer depends in part upon your final output format.  If your final output format is <code>int</code>, there&#39;s no difference between <code>11523</code> and <code>011523</code>; there&#39;s basically no way to have a leading 0.  If your final output format is string, you can add calls to <code>sprintf</code> somewhere, with formats like <code>%02d</code> (for individual hours, minutes, or seconds values), or <code>%06d</code> (for the whole shebang)."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1574871092, "post_id": 59073886, "comment_id": 104386136, "body": "If your original input is not guaranteed to have leading 0&#39;s, the use-strings-and-<code>strcat</code> approach is doomed to failure whenever minutes or seconds are less than 10."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1574873465, "post_id": 59073886, "comment_id": 104387394, "body": "At any rate, to get leading 0&#39;s with MerMonkey&#39;s answer, use <code>printf(&quot;%06d&quot;, wynik)</code> in <code>main()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 428, "user_id": 12246397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LkYoR.jpg?s=128&g=1", "display_name": "MerMonkey", "link": "https://stackoverflow.com/users/12246397/mermonkey"}, "edited": false, "score": 1, "creation_date": 1574870961, "post_id": 59074224, "comment_id": 104386065, "body": "When you are working with strings remember that 14 is really &#39;1&#39; &#39;4&#39; &#39;\\0&#39; so it needs 3 array size"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 3, "creation_date": 1574871156, "post_id": 59074224, "comment_id": 104386176, "body": "Per a comment on the original question, there&#39;s a pretty big problem here if the input is something like <code>1 2 3</code>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 3, "creation_date": 1574871286, "post_id": 59074224, "comment_id": 104386249, "body": "Also, if you&#39;re going to use needlessly tiny arrays like <code>char hrs[3];</code>, you really need to protect them by using <code>%2s</code> in the <code>fscanf</code> call.  (And of course this advice holds almost equally well even when the arrays are not tiny.)"}], "tags": [], "owner": {"reputation": 428, "user_id": 12246397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LkYoR.jpg?s=128&g=1", "display_name": "MerMonkey", "link": "https://stackoverflow.com/users/12246397/mermonkey"}, "is_accepted": true, "score": 1, "last_activity_date": 1574870832, "creation_date": 1574870832, "answer_id": 59074224, "question_id": 59073886, "link": "https://stackoverflow.com/questions/59073886/how-do-i-store-data-in-char-arrays-and-convert-to-int-in-c/59074224#59074224", "title": "How do I store data in char arrays and convert to int in C", "body": "<p>If you want to do it with strings:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\nint time_conversion(FILE* file) {\n    char hrs[3];\n    char mins[3];\n    char secs[3];\n    char total[7];\n    fscanf(file, \"%s %s %s\", hrs, mins, secs);\n    strcpy(total, hrs);\n    strcat(total, mins);\n    strcat(total, secs);\n    return atoi(total);\n}\nint main(void) {\n    FILE* f = fopen(\"file.txt\", \"r\");\n    int wynik = time_conversion(f);\n    printf(\"%d\", wynik);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 11403739, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6Oi6SuHh8mA/AAAAAAAAAAI/AAAAAAAAGAo/WgW5Jg4nagM/photo.jpg?sz=128", "display_name": "JoelinRome", "link": "https://stackoverflow.com/users/11403739/joelinrome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 59074224, "answer_count": 1, "score": 1, "last_activity_date": 1574870832, "creation_date": 1574869703, "question_id": 59073886, "link": "https://stackoverflow.com/questions/59073886/how-do-i-store-data-in-char-arrays-and-convert-to-int-in-c", "title": "How do I store data in char arrays and convert to int in C", "body": "<p>So I currently take a file pointer as a parameter as im reading data in a file stored as <code>14 00 05</code> where <code>14</code> is the hours <code>00</code> is the minutes and <code>05</code> is the seconds. I want to be able to convert these values to into a single int and produce the output <code>int time = 140005</code></p>\n\n<pre><code>int time_conversion(FILE *file) {\n    char hrs[2];\n    char mins[2];\n    char secs[2];\n    char total[6];\n\n    fscanf(file, \" %s %s %s\", hrs, mins, secs);\n    strcat(total, hrs);\n    strcat(total, mins);\n    strcat(total, secs);\n    return atoi(total);\n}\n</code></pre>\n\n<p>The issue I'm currently having is that when I read in the <code>char mins[2]</code> the first char stored in <code>char hrs[2]</code> gets ovverun for some unkown reason.\nExample of output after the <code>fprintf()</code> </p>\n\n<pre><code>char hrs[0] = '\\000'\nchar hrs[1] = '4'\n\nchar mins[0] = '\\000'\nchar mins[1] = '0'\n\nchar secs[0] = '0'\nchar secs[1] = '5'\n</code></pre>\n"}, {"tags": ["c", "regex", "dfa", "nfa"], "answers": [{"tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 3, "last_activity_date": 1575163623, "last_edit_date": 1575163623, "creation_date": 1575005740, "answer_id": 59099244, "question_id": 59073681, "link": "https://stackoverflow.com/questions/59073681/from-a-regular-expression-to-nfa-and-to-dfa/59099244#59099244", "title": "From a regular expression to NFA and to DFA", "body": "<p>Implementing an NFA with \u03b5-moves (NFA-\u03b5)</p>\n\n<hr>\n\n<p>First of all, the 36-character alphabet can be reduced to 4 exclusive classes in this particular case.</p>\n\n<p>Let <code>\\1</code> mean <code>[A\u2212Z]</code><br>\nLet <code>\\2</code> mean <code>[^A\u2212Z01]</code> aka <code>[2-9]</code></p>\n\n<p>This reduces our alphabet to <code>\\1</code>, <code>0</code>, <code>1</code> and <code>\\2</code>.</p>\n\n<p><code>[A\u2212Z]*01*[^A\u2212Z]{3}</code> becomes <code>\\1*01*[01\\2]{3}</code></p>\n\n<hr>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Thompson%27s_construction_algorithm\" rel=\"nofollow noreferrer\">Thompson's construction</a> can be used to convert a regular expression into an NFA-\u03b5.</p>\n\n<p><code>\\1*01*[01\\2]{3}</code> is equivalent to <code>\\1*01*[01\\2][01\\2][01\\2]</code>, so that gives us:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1n6RR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1n6RR.png\" alt=\"NFA-\u03b5\"></a></p>\n\n<hr>\n\n<p>We can use the state diagram depicted above to generated the following transition table for the NFA-\u03b5:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>      \u03b5       \\1      0       1       \\2\n      ------- ------- ------- ------- -------\nS00   S01,S03                                   Starting State\nS01           S02\nS02   S01,S03\nS03                   S04\nS04   S05,S07\nS05                           S06\nS06   S05,S07\nS07                   S08     S08     S08\nS08                   S09     S09     S09\nS09                   S10     S10     S10\nS10                                             Accepting State\n</code></pre>\n\n<hr>\n\n<p>Of course, it's also quite evident that could also use the following NFA:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3dwK8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3dwK8.png\" alt=\"NFA\"></a></p>\n\n<p>That would be far simpler to implement because it's far simpler to implement an NFA engine than an NFA-\u03b5 engine. However, it's trivial to convert an NFA-\u03b5 into an NFA by going through the following steps:</p>\n\n<ol>\n<li><p>Flatten recursive \u03b5-moves.</p>\n\n<p>For example,</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>S00--\u03b5--&gt;{S01}\nS01--\u03b5--&gt;{S02}\nS02--\u03b5--&gt;{S03}\nS02--1--&gt;{S04}\n</code></pre>\n\n<p>becomes</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>S00--\u03b5--&gt;{S01,S02,S03}\nS01--\u03b5--&gt;{S02,S03}\nS02--\u03b5--&gt;{S03}\nS02--1--&gt;{S04}\n</code></pre></li>\n<li><p>Merge state transitions reached through \u03b5-moves.</p>\n\n<p>For example,</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>S00--\u03b5--&gt;{S01,S02,S03}\nS01--\u03b5--&gt;{S02,S03}\nS02--\u03b5--&gt;{S03}\nS03--1--&gt;{S04}\n</code></pre>\n\n<p>becomes</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>S00--\u03b5--&gt;{S01,S02,S03}\nS00--1--&gt;{S04}\nS01--\u03b5--&gt;{S02,S03}\nS01--1--&gt;{S04}\nS02--\u03b5--&gt;{S03}\nS02--1--&gt;{S04}\nS03--1--&gt;{S04}\n</code></pre></li>\n<li><p>Add states that reach an accepting state through \u03b5-moves to the set of accepting states.</p></li>\n<li><p>Drop \u03b5-moves.</p></li>\n</ol>\n\n<p>For our NFA-\u03b5, we get the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DTkml.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DTkml.png\" alt=\"NFA obtained from conversion\"></a></p>\n\n<hr>\n\n<p>We could take it a step further and clean up the NFA.</p>\n\n<ol>\n<li><p>There are unreachable states that can be removed. (S01, S03, S05 and S07 are unreachable.)</p></li>\n<li><p>There are identical states that can be combined. (S00 and S02 have identical transitions, and so do S04 and S06.)</p></li>\n</ol>\n\n<p>After performing those cleanups, we get</p>\n\n<p><a href=\"https://i.stack.imgur.com/TkdOG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TkdOG.png\" alt=\"Cleaned up NFA\"></a></p>\n\n<p>Doesn't that look familiar?</p>\n\n<hr>\n\n<p>Time to implement! The following implements the NFA-\u03b5 above, but automatically converts it to an NFA using the steps above before processing the input. (It doesn't perform any of the cleanup steps.)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\n\n/*\n   \u03b5                 =&gt; 0\n   'A'..'Z' = 41..5A =&gt; 1\n   '0'      = 30     =&gt; 2\n   '1'      = 31     =&gt; 3\n   '2'..'9' = 32..39 =&gt; 4\n*/\n\n#define NUM_INPUTS 5\n\n#define _ -1\n\nstatic int char_to_input[0x80] = {\n    _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _,  // 00..0F\n    _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _,  // 10..1F\n    _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _,  // 20..2F\n    2, 3, 4, 4, 4, 4, 4, 4, 4, 4, _, _, _, _, _, _,  // 30..3F\n    _, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  // 40..4F\n    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _, _, _, _, _,  // 50..5F\n    _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _,  // 60..6F\n    _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _,  // 70..7F\n};\n\n#undef _\n\n\n#define S(x) (1 &lt;&lt; x)\n#define S00 (1 &lt;&lt;  0)\n#define S01 (1 &lt;&lt;  1)\n#define S02 (1 &lt;&lt;  2)\n#define S03 (1 &lt;&lt;  3)\n#define S04 (1 &lt;&lt;  4)\n#define S05 (1 &lt;&lt;  5)\n#define S06 (1 &lt;&lt;  6)\n#define S07 (1 &lt;&lt;  7)\n#define S08 (1 &lt;&lt;  8)\n#define S09 (1 &lt;&lt;  9)\n#define S10 (1 &lt;&lt; 10)\n\n#define _ 0\n\nstatic uint_least16_t transitions[][NUM_INPUTS] = {\n   //       \u03b5  ,   \\1  ,    0  ,    1, ,   \\2\n   // -------  ,  ---  ,  ---  ,  ---  ,  ---\n   {  S01|S03  ,  _    ,  _    ,  _    ,  _    },   // S00   Starting State\n   {  _        ,  S02  ,  _    ,  _    ,  _    },   // S01\n   {  S01|S03  ,  _    ,  _    ,  _    ,  _    },   // S02\n   {  _        ,  _    ,  S04  ,  _    ,  _    },   // S03\n   {  S05|S07  ,  _    ,  _    ,  _    ,  _    },   // S04\n   {  _        ,  _    ,  _    ,  S06  ,  _    },   // S05\n   {  S05|S07  ,  _    ,  _    ,  _    ,  _    },   // S06\n   {  _        ,  _    ,  S08  ,  S08  ,  S08  },   // S07\n   {  _        ,  _    ,  S09  ,  S09  ,  S09  },   // S08\n   {  _        ,  _    ,  S10  ,  S10  ,  S10  },   // S09\n   {  _        ,  _    ,  _    ,  _    ,  _    },   // S10   Accepting State\n};\n\n#undef _\n\nuint_least16_t STATES_START  = S00;\nuint_least16_t STATES_REJECT = 0;\nuint_least16_t STATES_ACCEPT = S10;\n\n#define NUM_STATES (sizeof(transitions)/sizeof(transitions[0]))\n\n\nint main(int argc, char** argv) {\n   if (argc != 2) {\n      fprintf(stderr, \"usage\\n\");\n      return 2;\n   }\n\n   // Flatten recursive \u03b5-moves.\n   for (size_t s1=0; s1&lt;NUM_STATES; ++s1) {\n      uint_least16_t e_states = transitions[s1][0];\n\n      do {\n         for (size_t s2=0; s2&lt;NUM_STATES; ++s2) {\n            if (e_states &amp; S(s2))\n               e_states |= transitions[s2][0];\n         }\n      } while (e_states != transitions[s1][0]);\n\n      transitions[s1][0] = e_states;\n   }\n\n   // Convert NFA-\u03b5 into NFA.\n   {\n      // For each state s1,\n      // for each state s2,\n      // if s1 has an \u03b5-move to s2,\n      // merge s2's transitions into s1's.\n      for (size_t s1=0; s1&lt;NUM_STATES; ++s1) {\n         uint_least16_t e_states = transitions[s1][0];\n         for (size_t s2=0; s2&lt;NUM_STATES; ++s2) {\n            if (e_states &amp; S(s2)) {\n               for (size_t i=1; i&lt;NUM_INPUTS; ++i) {\n                  transitions[s1][i] |= transitions[s2][i];\n               }\n            }\n         }\n      }\n\n      // For each state s1,\n      // for each accepting state s2,\n      // if s1 has an \u03b5-move to s2,\n      // add s1 to the set of accepting states.\n      for (size_t s1=0; s1&lt;NUM_STATES; ++s1) {\n         uint_least16_t e_states = transitions[s1][0];\n         uint_least16_t Ss1 = S(s1);\n         if (!(STATES_ACCEPT &amp; Ss1)) {\n            for (size_t s2=0; s2&lt;NUM_STATES; ++s2) {\n               if (e_states &amp; S(s2) &amp; STATES_ACCEPT) {\n                  STATES_ACCEPT |= Ss1;\n                  break;\n               }\n            }\n         }\n      }\n   }\n\n   // NFA engine\n   {\n      const char *str = argv[1];\n      size_t i = 0;\n      uint_least16_t states = STATES_START;\n      while (1) {\n         unsigned char ch = (unsigned char)str[i];\n         if (!ch) {\n            if (states &amp; STATES_ACCEPT) {\n               fprintf(stdout, \"Match.\\n\");\n               return 0;\n            }\n         }\n\n         if (ch &gt;= 0x80) {\n            states = STATES_REJECT;\n         } else {\n            int input = char_to_input[ch];\n            if (input &lt; 0) {\n               states = STATES_REJECT;\n            } else {\n               uint_least16_t new_states = STATES_REJECT;\n               for (size_t s=0; s&lt;NUM_STATES; ++s,states&gt;&gt;=1) {\n                  if (states &amp; 1)\n                     new_states |= transitions[s][input];\n               }\n\n               states = new_states;\n            }\n         }\n\n         if (states == STATES_REJECT) {\n            fprintf(stderr, \"Not a match. (Failed at offset %zu.)\\n\", i);\n            return 1;\n         }\n\n         ++i;\n      }\n   }\n}\n</code></pre>\n\n<p>(I used <code>_</code> to make non-trivial values stand out.)</p>\n\n<hr>\n\n<p>An NFA can be converted into a DFA using <a href=\"https://en.wikipedia.org/wiki/Powerset_construction\" rel=\"nofollow noreferrer\">powerset contruction</a>, but there's not much point in doing so.</p>\n"}], "owner": {"reputation": 3, "user_id": 12406150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a51824c6a7b3aa59d70e460e3d61337c?s=128&d=identicon&r=PG&f=1", "display_name": "Nedo", "link": "https://stackoverflow.com/users/12406150/nedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 1, "closed_date": 1575046676, "accepted_answer_id": 59099244, "answer_count": 1, "score": -2, "last_activity_date": 1575163623, "creation_date": 1574869032, "last_edit_date": 1574872902, "question_id": 59073681, "link": "https://stackoverflow.com/questions/59073681/from-a-regular-expression-to-nfa-and-to-dfa", "closed_reason": "Needs more focus", "title": "From a regular expression to NFA and to DFA", "body": "<p>I have the following regular expression:</p>\n\n<pre><code>[A\u2212Z]\u221701\u2217[^A\u2212Z]{3}\n</code></pre>\n\n<p>The alphabet is <code>[A-Z][0-9]</code>.</p>\n\n<p>Can someone explain the correct way to convert to a NFA and then to DFA.\nAnd how can I implement the epsilon closure in C.</p>\n"}, {"tags": ["c", "visual-studio", "project"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1574868285, "post_id": 59073388, "comment_id": 104384622, "body": "Do you have more than one <code>main()</code> function? Please post the compiler output message, in the question. There is no reason why each source file can&#39;t <code>#include</code> the same library headers: they have &quot;header guards&quot; to allow it."}, {"owner": {"reputation": 1211, "user_id": 4296075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a7d4f6a4e79ec582c89e67c45dea3e71?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4296075/john-doe"}, "edited": false, "score": 2, "creation_date": 1574868495, "post_id": 59073388, "comment_id": 104384734, "body": "This is very unusual, something is probably wrong with your code but we can&#39;t tell you how you can fix it without seeing your code and the exact error messages that you get"}, {"owner": {"reputation": 67, "user_id": 12446743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBvgVyHFfya2X5YLHTJm30VIdz-vyMujncGwOSWRw=k-s128", "display_name": "Artaxerxes", "link": "https://stackoverflow.com/users/12446743/artaxerxes"}, "edited": false, "score": 0, "creation_date": 1574869673, "post_id": 59073388, "comment_id": 104385314, "body": "I opened the link that points to the error  here. <a href=\"https://docs.microsoft.com/en-us/cpp/error-messages/tool-errors/linker-tools-error-lnk2005?view=vs-2019\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/cpp/error-messages/tool-errors/&hellip;</a>  According to this page, I cannot have sam headers in the same project in multiple files. I tested this by deleting other files or by using // that made those headers into comments. And it compiled with no problems whatsoever."}, {"owner": {"reputation": 67, "user_id": 12446743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBvgVyHFfya2X5YLHTJm30VIdz-vyMujncGwOSWRw=k-s128", "display_name": "Artaxerxes", "link": "https://stackoverflow.com/users/12446743/artaxerxes"}, "edited": false, "score": 0, "creation_date": 1574869813, "post_id": 59073388, "comment_id": 104385412, "body": "Ill add an image just in case"}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1574870522, "post_id": 59073388, "comment_id": 104385814, "body": "You can&#39;t have <code>main</code> in both files."}, {"owner": {"reputation": 67, "user_id": 12446743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBvgVyHFfya2X5YLHTJm30VIdz-vyMujncGwOSWRw=k-s128", "display_name": "Artaxerxes", "link": "https://stackoverflow.com/users/12446743/artaxerxes"}, "edited": false, "score": 0, "creation_date": 1574871119, "post_id": 59073388, "comment_id": 104386154, "body": "Forgive me  but how do i write the code without main. My intention is to have multiple C source files in the same project. And then compile them and learn. It seems like there isnt a way for me to have multiple C source files in the same project. Edit: I just tested it by removing the main function in the first file and tried compiling the second. It didnt work. I then deleted the first file and compiled the second file without issues"}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1574871236, "post_id": 59073388, "comment_id": 104386225, "body": "You can have as many source files as you want, but you can have ony <b>one</b> main function."}, {"owner": {"reputation": 67, "user_id": 12446743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBvgVyHFfya2X5YLHTJm30VIdz-vyMujncGwOSWRw=k-s128", "display_name": "Artaxerxes", "link": "https://stackoverflow.com/users/12446743/artaxerxes"}, "edited": false, "score": 0, "creation_date": 1574871503, "post_id": 59073388, "comment_id": 104386369, "body": "Alright I tested it again. It was the main function. Thanks. So there isnt a way for me to have main functions in every file in the same project. Thats sad. Maybe I&#39;ll give up VS and stick to Linux instead. The text editor there is very easy to use for beginners"}, {"owner": {"reputation": 67, "user_id": 12446743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBvgVyHFfya2X5YLHTJm30VIdz-vyMujncGwOSWRw=k-s128", "display_name": "Artaxerxes", "link": "https://stackoverflow.com/users/12446743/artaxerxes"}, "edited": false, "score": 0, "creation_date": 1574871877, "post_id": 59073388, "comment_id": 104386551, "body": "can you suggest an alternative IDE for me to compile C programs. Visual Studio doesnt look like the one for beginners"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1574872975, "post_id": 59073388, "comment_id": 104387139, "body": "You can have more than one &quot;project&quot; in the same &quot;solution&quot;. So you could add a new project for each of your programs all in the same &quot;solution&quot;."}, {"owner": {"reputation": 1712, "user_id": 3781728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qta2K.png?s=128&g=1", "display_name": "Ed Dore", "link": "https://stackoverflow.com/users/3781728/ed-dore"}, "edited": false, "score": 0, "creation_date": 1574874392, "post_id": 59073388, "comment_id": 104387903, "body": "You will have the same problem when you move to Linux. main() is the entry point function of your application. main() is the first function invoked, so if you have multiple main() functions which one is the operating system supposed to call when you attempt to execute your application?"}, {"owner": {"reputation": 67, "user_id": 12446743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBvgVyHFfya2X5YLHTJm30VIdz-vyMujncGwOSWRw=k-s128", "display_name": "Artaxerxes", "link": "https://stackoverflow.com/users/12446743/artaxerxes"}, "edited": false, "score": 0, "creation_date": 1574877563, "post_id": 59073388, "comment_id": 104389371, "body": "Maybe I misunderstood. Ive already been using Linux(ubuntu) using vmware. And I have no problems saving multiple C source files. Correct me if I&#39;m wrong but the concept of Solution and Project doesnt exist in Linux text editor. The C file gets stored normally in any folder you want and gets compiled with a gcc and ./a.out in the terminal. You can store as many C source files as you please under the same directory and execute effortlessly because Projects and Solutions as far as I know do not exist there. So VS&#39; behavior felt unusual because I dont run into this problem in Linux txt editor"}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1574891791, "post_id": 59073388, "comment_id": 104395038, "body": "So here is the big misunderstanding, introduced by Microsoft&#39;s way in Visual Studio. BTW, you will find the same pattern in many IDEs and on Linux, too. A &quot;solution&quot; is kind of a box to collect one or more &quot;projects&quot; which belong to each other, or even not. And a &quot;project&quot; is meant to hold all files which belong to a single program. That&#39;s why you can have only <i>one</i> <code>main()</code> in a &quot;project.&quot; VS likes to organize these in separate folders."}, {"owner": {"reputation": 67, "user_id": 12446743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBvgVyHFfya2X5YLHTJm30VIdz-vyMujncGwOSWRw=k-s128", "display_name": "Artaxerxes", "link": "https://stackoverflow.com/users/12446743/artaxerxes"}, "edited": false, "score": 0, "creation_date": 1574924750, "post_id": 59073388, "comment_id": 104402879, "body": "&quot;A &quot;solution&quot; is kind of a box to collect one or more &quot;projects&quot; which belong to each other&quot;.  What exactly does that mean ? Is that the reason why im unable to run projects. I have multiple projects under the same solution. But whenever I try to run lets say Project2, Project 1 gets compiled instead. No matter what i do, project1 is the one that gets compiled and displayed in the terminal. I tried closing project1. It just didnt matter, I never got the output of the C file under project2. The output of project1 C file was displayed everytime. Same thing with project3 and 4. quite discouraging"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 12446743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBvgVyHFfya2X5YLHTJm30VIdz-vyMujncGwOSWRw=k-s128", "display_name": "Artaxerxes", "link": "https://stackoverflow.com/users/12446743/artaxerxes"}, "edited": false, "score": 0, "creation_date": 1575039765, "post_id": 59084742, "comment_id": 104445741, "body": "In Ubuntu, I write a C program, save it. Then I type gcc filename.c and then ./a.out to get the desired output. I know Visual Studio is better but the fact that I&#39;m a beginner really shows because Ive found VS tedious compared to the 2 simple lines I have to type to get the output. Another thing, there is this problem where it VS doesnt execute the project I want but instead executes another project everytime. Ive got multiple projects under the same solution and I ultimately gave up cause it just wouldnt compile what i wanted"}, {"owner": {"reputation": 67, "user_id": 12446743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBvgVyHFfya2X5YLHTJm30VIdz-vyMujncGwOSWRw=k-s128", "display_name": "Artaxerxes", "link": "https://stackoverflow.com/users/12446743/artaxerxes"}, "edited": false, "score": 0, "creation_date": 1575040161, "post_id": 59084742, "comment_id": 104445951, "body": "There also seem to be other problems like scanf ignored. I fixed a couple of them using CRT_SECURE_NO_WARNINGS but thats just a fraction of the issues i faced in VS. Thanks for answering though. It helps"}, {"owner": {"reputation": 1211, "user_id": 4296075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a7d4f6a4e79ec582c89e67c45dea3e71?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4296075/john-doe"}, "reply_to_user": {"reputation": 67, "user_id": 12446743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBvgVyHFfya2X5YLHTJm30VIdz-vyMujncGwOSWRw=k-s128", "display_name": "Artaxerxes", "link": "https://stackoverflow.com/users/12446743/artaxerxes"}, "edited": false, "score": 0, "creation_date": 1575276397, "post_id": 59084742, "comment_id": 104497991, "body": "All the &quot;issues&quot; that you are referring to are actually things put in place by VS to make your code more secure or make you develop faster/better code (like not using <code>scanf</code> which is not recommended for a <a href=\"https://stackoverflow.com/questions/2430303/disadvantages-of-scanf\">number of reasons</a> ). As I said, try to find someone IRL that can explain to you what is happening in real time. It will take just a couple of minutes and make your developing experience much better"}, {"owner": {"reputation": 1211, "user_id": 4296075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a7d4f6a4e79ec582c89e67c45dea3e71?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4296075/john-doe"}, "reply_to_user": {"reputation": 67, "user_id": 12446743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBvgVyHFfya2X5YLHTJm30VIdz-vyMujncGwOSWRw=k-s128", "display_name": "Artaxerxes", "link": "https://stackoverflow.com/users/12446743/artaxerxes"}, "edited": false, "score": 0, "creation_date": 1575276585, "post_id": 59084742, "comment_id": 104498082, "body": "I&#39;m not saying that VS is the be-all end-all of IDEs but most of the problem you are facing now are gonna be present in pretty much every other IDE"}, {"owner": {"reputation": 67, "user_id": 12446743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBvgVyHFfya2X5YLHTJm30VIdz-vyMujncGwOSWRw=k-s128", "display_name": "Artaxerxes", "link": "https://stackoverflow.com/users/12446743/artaxerxes"}, "edited": false, "score": 0, "creation_date": 1581844750, "post_id": 59084742, "comment_id": 106566408, "body": "Really sorry to bother you again after 2 months. But you mentioned &quot;That&#39;s also why you can&#39;t (and shouldn&#39;t) include Source files in your code, if you include a source file then you are at a high risk of including the same definition multiple times since they don&#39;t use include guards.&quot;  I didn&#39;t quite catch that."}, {"owner": {"reputation": 1211, "user_id": 4296075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a7d4f6a4e79ec582c89e67c45dea3e71?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4296075/john-doe"}, "reply_to_user": {"reputation": 67, "user_id": 12446743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBvgVyHFfya2X5YLHTJm30VIdz-vyMujncGwOSWRw=k-s128", "display_name": "Artaxerxes", "link": "https://stackoverflow.com/users/12446743/artaxerxes"}, "edited": false, "score": 0, "creation_date": 1581946633, "post_id": 59084742, "comment_id": 106596239, "body": "@Artaxerxes no worries, let&#39;s say you create a function <code>int test(){return 1;}</code> in a file called <code>foo.c</code> and the <code>main</code> in the file <code>main.c</code>. If in <code>main.c</code> you say <code>#include &quot;foo.c&quot;</code> you will most likely get a multiple definitions error. This is because <code>foo.c</code> gets compiled twice, the compiler compiles <code>foo.c</code>, finds the function <code>test()</code> then compiles <code>main.c</code>, sees that <code>foo.c</code> is included, tries to compile it, finds <code>test()</code> again and gets confused. You can avoid this by creating a file <code>foo.h</code> that contains only <code>int test();</code> and then make <code>foo.c</code> and <code>main.c</code> <code>#include</code> the file <code>foo.h</code>"}, {"owner": {"reputation": 1211, "user_id": 4296075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a7d4f6a4e79ec582c89e67c45dea3e71?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4296075/john-doe"}, "reply_to_user": {"reputation": 67, "user_id": 12446743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBvgVyHFfya2X5YLHTJm30VIdz-vyMujncGwOSWRw=k-s128", "display_name": "Artaxerxes", "link": "https://stackoverflow.com/users/12446743/artaxerxes"}, "edited": false, "score": 0, "creation_date": 1581946754, "post_id": 59084742, "comment_id": 106596294, "body": "also, <code>you can&#39;t include ... Source files</code> is not strictly correct, you can technically include them but it&#39;s a very bad thing to do. In the file <code>foo.h</code> you need to use <code>include guards</code> like i specified in the answer, these are pretty much a way to tell the compiler &quot;hey, you already compiled this file, no need to do it again&quot; so that it doesn&#39;t find the same functions twice and doesn&#39;t get confused."}], "tags": [], "owner": {"reputation": 1211, "user_id": 4296075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a7d4f6a4e79ec582c89e67c45dea3e71?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4296075/john-doe"}, "is_accepted": true, "score": 4, "last_activity_date": 1574943847, "last_edit_date": 1574943847, "creation_date": 1574930582, "answer_id": 59084742, "question_id": 59073388, "link": "https://stackoverflow.com/questions/59073388/can-i-have-multiple-c-source-files-in-the-same-project-visual-studio-19/59084742#59084742", "title": "Can i have multiple C source files in the same project (Visual Studio 19)?", "body": "<p>Essentially a <strong>Solution</strong> is a container used to contain multiple <strong>Projects</strong>, you can choose to compile either the whole Solution (so all the projects in the solution), or a single Project in said Solution.</p>\n\n<p>Each Project can have only 1 <code>main()</code> because otherwise your OS won't know where to start executing, of course you can have multiple source files in the same project otherwise for even smaller projects you'd have a single file with a huge number of lines.\nThis structure is quite common in many <strong>IDE</strong>s (maybe with different names than <strong>Project</strong> and <strong>Solution</strong>, this is just a nomenclature that VS uses), it isn't really bound to Windows or Linux in particular.</p>\n\n<p>Try on Linux to have multiple source files with multiple <code>main()</code> and try to compile then together with <code>gcc</code>, you'll see that you get a very similar error. </p>\n\n<p>You also can't have the same function definition in multiple files otherwise you get the <strong>LNK 2005</strong> linker error that you've seen. This is because when the Linker is linking your files if it finds two identical definitions it doesn't know which one to take and goes crazy.</p>\n\n<blockquote>\n  <p>But then how do you include the same header files in different sources?</p>\n</blockquote>\n\n<p>Well that's why <code>.h</code> files have <strong>include guards</strong>, they ensure that the contents of an <code>.h</code> files are included by the linker only once in each Compilation.</p>\n\n<p>Usually in the header file there is one of two possible ways to include these guards, there are very small differences between these two methods but they don't really apply if you're not doing some very specific stuff:</p>\n\n<pre><code> #pragma once\n // Content of the header\n</code></pre>\n\n<p>or</p>\n\n<pre><code>#ifndef GUARD_H\n#define GUARD_H\n\n// Content of header\n\n#endif\n</code></pre>\n\n<p>Where <code>GUARD_H</code> should be different for every <code>.h</code> file, usually it's a combination of your Project and header file names just to make sure it's different to other guards that could exist in other headers.</p>\n\n<p>That's also why you can't (and shouldn't) include Source files in your code, if you include a source file then you are at a high risk of including the same definition multiple times since they don't use include guards.</p>\n\n<blockquote>\n  <p>The C file gets stored normally in any folder you want and gets compiled with a gcc and ./a.out in the terminal</p>\n</blockquote>\n\n<p>That's essentially what VS does, just instead of you choosing which files to add in the compilation VS takes automatically all the files in the same Solution or Project (depending which one you decide to build).</p>\n\n<p>For convenience, if you are just starting to learn, create a new solution for each Project (so for every <code>main()</code>) that you want.</p>\n\n<p>Is this better or worse than using a simple text editor? Well, after the first 10-15 minutes of learning you'll see that it's much faster and useful to use an actual IDE as it provides many features that will make you write code faster and with less errors.</p>\n\n<p>This is a really quick explanation of how things work in general. If you can, try to find someone IRL that can explain these things to you. It's really hard to explain it on the internet but it will take less than 10 minutes being together in front of the same computer.</p>\n"}], "owner": {"reputation": 67, "user_id": 12446743, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBvgVyHFfya2X5YLHTJm30VIdz-vyMujncGwOSWRw=k-s128", "display_name": "Artaxerxes", "link": "https://stackoverflow.com/users/12446743/artaxerxes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3771, "favorite_count": 1, "accepted_answer_id": 59084742, "answer_count": 1, "score": 0, "last_activity_date": 1574943847, "creation_date": 1574868083, "last_edit_date": 1574870237, "question_id": 59073388, "link": "https://stackoverflow.com/questions/59073388/can-i-have-multiple-c-source-files-in-the-same-project-visual-studio-19", "title": "Can i have multiple C source files in the same project (Visual Studio 19)?", "body": "<p>Beginner here. I code in C atm. So Ive just started using VS 2019. A few troubles along the way but I got Build error along with LNK 2005 and LNK 1169. Turns out I cant have multiple files in the same project. Especially if Im using same header in the files. In this case it was stdio.h and math.h. I recreated this multiple times. The code would compile without a hitch only if one file was present in the project. Or atleast just one file with that particular header. Which pretty much prevents me from having multiple C source files under the same project. So is there any way to have multiple files in the same project without these errors.</p>\n\n<p>A little annoying that I can't have multiple files with same header which is impossible cause obviously, I gotta use stdio.h everywhere. <a href=\"https://i.stack.imgur.com/L6kWP.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["c", "memory"], "comments": [{"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 4, "creation_date": 1574868015, "post_id": 59073317, "comment_id": 104384462, "body": "Not really a C question but more of a platform / operating system thing, but I&#39;m guessing there is a 4 MB stack."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1574868075, "post_id": 59073317, "comment_id": 104384492, "body": "You&#39;re probably getting the whole (shared) C library."}, {"owner": {"reputation": 473, "user_id": 6405712, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/66716761277120457b31513170f94749?s=128&d=identicon&r=PG&f=1", "display_name": "user308485", "link": "https://stackoverflow.com/users/6405712/user308485"}, "edited": false, "score": 0, "creation_date": 1574868117, "post_id": 59073317, "comment_id": 104384515, "body": "Good points, I&#39;d like to know exactly how one might verify with certainty whether these suspicions are correct."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 5, "creation_date": 1574868124, "post_id": 59073317, "comment_id": 104384518, "body": "&quot;I am using no libraries.&quot; This is an illusion. Your program still uses the <i>C runtime</i> which contains standard startup code and standard termination code and Bob knows what else. If you really need to use <i>no</i> libraries you probanly want to explore -nostartfiles and -nostdlib flags at least. Note, this requires modification to your source code."}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 3, "creation_date": 1574868240, "post_id": 59073317, "comment_id": 104384601, "body": "<code>Why is VIRT sitting at 4MB?</code> Virtual memory is spent by pages. Say 2mb per page, one code, and one data."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 1, "creation_date": 1574870730, "post_id": 59073317, "comment_id": 104385936, "body": "@Matt You got it totally wrong. 4kB pages are the default, using 2MB huge pages requires extra work and you missed stack in your breakdown. Note that &quot;2mb&quot; reads &quot;2 milli-bits&quot;, use the right prefixes <a href=\"https://en.wikipedia.org/wiki/Metric_prefix\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Metric_prefix</a> and units."}], "answers": [{"tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 3, "last_activity_date": 1574873172, "last_edit_date": 1574873172, "creation_date": 1574870172, "answer_id": 59074021, "question_id": 59073317, "link": "https://stackoverflow.com/questions/59073317/why-does-this-very-small-c-program-use-up-so-much-memory/59074021#59074021", "title": "Why does this very small C program use up so much memory?", "body": "<blockquote>\n  <p>Why is VIRT sitting at 4MB? Why is SHR sitting at 728kB? I am using no libraries. </p>\n</blockquote>\n\n<p>That is not accurate.</p>\n\n<p>Let's compile:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    char buf[100];\n    snprintf(buf, sizeof buf, \"pmap -x %u\", (unsigned)getpid());\n    system(buf);\n}\n</code></pre>\n\n<p>With command <code>gcc -o test -W{all,extra,error} -xc test.cc</code>.</p>\n\n<p>And run it:</p>\n\n<pre><code>$ ./test\n7360:   ./test\nAddress           Kbytes     RSS   Dirty Mode   Mapping\n0000000000400000       4       4       4 r-x--  test\n0000000000600000       4       4       4 rw---  test\n00007f1f4d96a000    1580     788       0 r-x--  libc-2.12.so\n00007f1f4daf5000    2044       0       0 -----  libc-2.12.so\n00007f1f4dcf4000      16      16      16 r----  libc-2.12.so\n00007f1f4dcf8000       8       8       8 rw---  libc-2.12.so\n00007f1f4dcfa000      16       8       8 rw---    [ anon ]\n00007f1f4dcfe000     128     128       0 r-x--  ld-2.12.so\n00007f1f4df0c000      12      12      12 rw---    [ anon ]\n00007f1f4df1d000       4       4       4 rw---    [ anon ]\n00007f1f4df1e000       4       4       4 r----  ld-2.12.so\n00007f1f4df1f000       4       4       4 rw---  ld-2.12.so\n00007f1f4df20000       4       4       4 rw---    [ anon ]\n00007ffd4a872000     132      12      12 rw---    [ stack ]\n00007ffd4a961000      12       0       0 r----    [ anon ]\n00007ffd4a964000       8       4       0 r-x--    [ anon ]\nffffffffff600000       4       0       0 r-x--    [ anon ]\n----------------  ------  ------  ------\ntotal kB            3984    1000      80\n</code></pre>\n\n<p>(If you see duplicate lines in <code>pmap -x</code> output, this was a <a href=\"https://gitlab.com/procps-ng/procps/commit/b899c55dca00eee8dd9c29bbc4b32f3598ad51f6\" rel=\"nofollow noreferrer\">bug</a> in older versions).</p>\n\n<p>So, it uses</p>\n\n<ul>\n<li><code>libc.so</code> - C standard library.</li>\n<li><code>ld.so</code> - the dynamic linker.</li>\n</ul>\n\n<p>The 1000kB of RSS are occupied by:</p>\n\n<ul>\n<li>920kB is executable code of your executable (4kB) and the shared libraries (pages with <code>r-x--</code> mode)</li>\n<li>12kB is stack (marked as <code>[ stack ]</code>).</li>\n<li>Pages marked as <code>[ anon ]</code> with <code>rw---</code> mode are heap and 0-initialized data with static storage duration from <code>.bss</code> sections of the executable and shared libraries.</li>\n<li>The rest is read-only and non-0-initialized data with static storage duration from <code>.data</code> and <code>.rodata</code> (<code>r----</code> mode) sections of the executable and shared libraries.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 3, "last_activity_date": 1574875419, "last_edit_date": 1574875419, "creation_date": 1574871299, "answer_id": 59074360, "question_id": 59073317, "link": "https://stackoverflow.com/questions/59073317/why-does-this-very-small-c-program-use-up-so-much-memory/59074360#59074360", "title": "Why does this very small C program use up so much memory?", "body": "<p>Most of the memory overhead that surprises you comes from the C library and the dynamic linker, which will be fully loaded into memory even though you aren't using them ... much.  (You <em>are</em> using them for a glob of code that runs before <code>main</code>, which many people don't realize exists, but it's there.  It's responsible for things like setting up stdio, running C++ global constructors, and arranging for it to be possible to return from <code>main</code> without crashing.)</p>\n\n<p>For comparison, this is just about the smallest busy-wait program you can have on Linux/x86 without <a href=\"https://www.muppetlabs.com/~breadbox/software/tiny/teensy.html\" rel=\"nofollow noreferrer\">hand-hacking the ELF file format</a>:</p>\n\n<pre><code>$ cat tiny.s\n    .text\n    .globl _start\n    .type _start,@function\n_start:\n    pause\n    jmp _start\n    .size _start, .-_start\n    .section .note.GNU-stack,\"\",@progbits\n</code></pre>\n\n<p>I've written it in assembly language so I can chop out all of the overhead associated with the C library.  In order to exclude the code that runs before <code>main</code>, I have to name my program's \"main function\" <code>_start</code> instead.  Compile thus:</p>\n\n<pre><code>$ gcc -nostdlib -nostartfiles -static -Wl,--build-id=none -o tiny tiny.s\n</code></pre>\n\n<p><code>-nostdlib</code> to turn off most of the C library, <code>-nostartfiles</code> to turn off the code that runs before <code>main</code>, <code>-static</code> so it won't even pull in the dynamic linker, and <code>-Wl,--build-id=none</code> to suppress an annotation that makes the executable significantly bigger on disk. Here's what that gets us:</p>\n\n<pre><code>$ objdump -dr tiny\n\ntiny:     file format elf64-x86-64\n\n\nDisassembly of section .text:\n\n0000000000401000 &lt;_start&gt;:\n  401000:   f3 90                   pause  \n  401002:   eb fc                   jmp    401000 &lt;_start&gt;\n\n$ size tiny\n   text    data     bss     dec     hex filename\n      4       0       0       4       4 a.out\n$ ls -l tiny\n-rwxr-xr-x 1 zack zack 4632 Nov 27 10:53 tiny\n</code></pre>\n\n<p>Four bytes of actual machine instructions.  They get enlarged to slightly more than 4k of complete executable file with more padding and annotations.  You can use the <code>objdump</code> and <code>readelf</code> commands to poke through the file and see what-all is in there.</p>\n\n<p>Here's how it shows up in <code>top</code>:</p>\n\n<pre><code>  PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND  \n12154 zack      20   0     156      4      0 R 100.0   0.0   0:16.51 a.out\n</code></pre>\n\n<p>This still allocates 156kB\u00b9 of address space and 4kB of actual RAM.  To find out in more detail what this space is going to, we can look at <code>/proc/&lt;pid&gt;/maps</code> for the process: (note, the output on your system may differ a little)</p>\n\n<pre><code>$ cat /proc/12514/maps\n000000400000-000000401000 r--p 00000000 fd:01 26477890    /home/zack/tiny\n000000401000-000000402000 r-xp 00001000 fd:01 26477890    /home/zack/tiny\n7fff5c9b3000-7fff5c9d4000 rw-p 00000000 00:00 0           [stack]\n7fff5c9fb000-7fff5c9fe000 r--p 00000000 00:00 0           [vvar]\n7fff5c9fe000-7fff5c9ff000 r-xp 00000000 00:00 0           [vdso]\n</code></pre>\n\n<p>There are five virtual memory allocations, with the first two numbers on each line being their starting and ending addresses, respectively.  The first 0x1000 bytes (4kB) of the executable file have been mapped read-only, and the second 4kB of the executable file have been mapped read-execute.  (Yes, this means the file is shorter than its memory map.  The kernel will fill in the gap with zeroes.)  Then we have \n0x7fff5c9d4000 &minus; 0x7fff5c9b3000 = 132kB allocated to the stack, 12kB allocated to \"vvar\", and 4kB allocated to \"vdso\".  8 + 132 + 12 + 4 = 156kB.</p>\n\n<p>An interesting fact visible here: <code>top</code>'s RES counts only pages that have been committed to the current process.  In this case, that's one page of the <em>stack</em> allocation.  The 8kB of mappings from the executable file are <em>not</em> counted, because they are read-only, shareable, and discardable -- if you had many processes running this same program, they would all share the same copy of the program code in physical RAM, and if the kernel needs to kick those pages out of RAM to make room for something else, it doesn't have to write them to the swap file.  (The <code>top</code> manpage says something different about RES, but as far as I can tell, it's wrong.)</p>\n\n<p>The \"vvar\" and \"vdso\" mappings are small globs of data and code, respectively, provided to all user space processes on Linux by the kernel.  They are for low-level tricks like making it possible to do a <code>gettimeofday</code> without actually switching the CPU into kernel mode.  This cuts out several thousand cycles of overhead, which matters for accurate timekeeping.  As far as I know, there's no way to turn these off.</p>\n\n<hr>\n\n<p>You can reduce the size of the stack allocation with the <code>ulimit</code> command.  For instance, <code>ulimit -s 4</code> cuts it to the absolute minimum, 4kB.  If I run my program like this</p>\n\n<pre><code>$ (unset $(printenv | cut -d= -f1); ulimit -s 4; exec ./tiny)\n</code></pre>\n\n<p>then <code>top</code> reports</p>\n\n<pre><code>    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND\n  14293 zack      20   0      28      4      0 R 100.0   0.0   0:06.02 tiny\n</code></pre>\n\n<p>and the <code>stack</code> line in <code>/proc/14293/maps</code> reads</p>\n\n<pre><code>7ffdf80e5000-7ffdf80e6000 rw-p 00000000 00:00 0              [stack]\n</code></pre>\n\n<p>But without that initial <code>unset</code> command (which clears all the environment variables), the program crashes on startup:</p>\n\n<pre><code>$ (ulimit -s 4; exec ./tiny)\nSegmentation fault\n</code></pre>\n\n<p>This is because the kernel writes a bunch of data into the stack allocation -- the command-line argument vector, all the environment variables, and the <a href=\"https://lwn.net/Articles/519085/\" rel=\"nofollow noreferrer\">ELF auxiliary vector</a> -- before it starts the program running.  If I don't clear the environment variables, that data takes up more than 4kB of space and the program crashes.  I bet you didn't know it was possible to trigger a segfault <em>inside the <code>execve</code> system call</em>.</p>\n\n<hr>\n\n<p>\u00b9 Proper, binary kilobytes, that is: 1kB \u225d 1024 bytes.  Do not listen to anyone who tells you different, not even the International Bureau of Weights and Measures.</p>\n"}], "owner": {"reputation": 473, "user_id": 6405712, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/66716761277120457b31513170f94749?s=128&d=identicon&r=PG&f=1", "display_name": "user308485", "link": "https://stackoverflow.com/users/6405712/user308485"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574875419, "creation_date": 1574867826, "question_id": 59073317, "link": "https://stackoverflow.com/questions/59073317/why-does-this-very-small-c-program-use-up-so-much-memory", "title": "Why does this very small C program use up so much memory?", "body": "<pre><code>int i = 0;\n\nint main(){\n  while (true){\n    i = 1;\n  }\n  return 0;\n}\n</code></pre>\n\n<p>The above program, (compiled with gnu g++, no extra compiler flags) which just loops forever, seems to use up more memory than it should (output of top shown below):</p>\n\n<pre><code>  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                                \n 9392 root      20   0    4376    788    728 R 100.0  0.0   2:32.65 a.out  \n</code></pre>\n\n<p>I get why the CPU usage is 100%, since it is constantly spinning in the while loop. Why is VIRT sitting at 4MB? Why is SHR sitting at 728KB? I am using no libraries. Finally, and most importantly, why the usage of 788KB to store just one variable? And where/how is the remaining (4376-788)KB being stored/used?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1574867974, "post_id": 59073311, "comment_id": 104384440, "body": "<a href=\"https://stackoverflow.com/a/17507772/9072753\">stackoverflow.com/a/17507772/9072753</a>"}, {"owner": {"reputation": 14722, "user_id": 823738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a13a6ed05bdce33d6bf0f01496b9a044?s=128&d=identicon&r=PG", "display_name": "Zaffy", "link": "https://stackoverflow.com/users/823738/zaffy"}, "edited": false, "score": 0, "creation_date": 1574868135, "post_id": 59073311, "comment_id": 104384530, "body": "Turn on all compiler warnings"}, {"owner": {"reputation": 3952, "user_id": 2152957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/7wZ6n.jpg?s=128&g=1", "display_name": "tay10r", "link": "https://stackoverflow.com/users/2152957/tay10r"}, "reply_to_user": {"reputation": 14722, "user_id": 823738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a13a6ed05bdce33d6bf0f01496b9a044?s=128&d=identicon&r=PG", "display_name": "Zaffy", "link": "https://stackoverflow.com/users/823738/zaffy"}, "edited": false, "score": 0, "creation_date": 1574868780, "post_id": 59073311, "comment_id": 104384873, "body": "@Zaffy OP isn&#39;t trying to diagnose something, he&#39;s just trying to understand why one piece of code crashes and the other one doesn&#39;t."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1574868913, "post_id": 59073311, "comment_id": 104384933, "body": "What does &quot;//hence strcpy does not change the reference&quot; mean? <code>strcpy</code> changes the content of the array, nothing more, nothing less."}, {"owner": {"reputation": 14722, "user_id": 823738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a13a6ed05bdce33d6bf0f01496b9a044?s=128&d=identicon&r=PG", "display_name": "Zaffy", "link": "https://stackoverflow.com/users/823738/zaffy"}, "reply_to_user": {"reputation": 3952, "user_id": 2152957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/7wZ6n.jpg?s=128&g=1", "display_name": "tay10r", "link": "https://stackoverflow.com/users/2152957/tay10r"}, "edited": false, "score": 0, "creation_date": 1574869684, "post_id": 59073311, "comment_id": 104385328, "body": "@tay10r I am aware of that and, warnings would definitely help."}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 3936102, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zal9N.jpg?s=128&g=1", "display_name": "MohsenFM", "link": "https://stackoverflow.com/users/3936102/mohsenfm"}, "edited": false, "score": 0, "creation_date": 1574870247, "post_id": 59073488, "comment_id": 104385651, "body": "So what i understand is, in the second case: &quot;hello&quot; is written somewhere in the stack and the first cell of the array word will point to the first cell of array &quot;hello&quot;. is this correct?"}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 1, "last_activity_date": 1574868988, "last_edit_date": 1592644375, "creation_date": 1574868358, "answer_id": 59073488, "question_id": 59073311, "link": "https://stackoverflow.com/questions/59073311/getting-core-dumped-error-when-trying-to-use-strcpy/59073488#59073488", "title": "getting core dumped error when trying to use strcpy", "body": "<blockquote>\n<p>//case 1</p>\n<p>'word' is not initialized properly,or by using malloc or calloc</p>\n</blockquote>\n<p>The <code>word</code> pointer is properly initialized with the address of the first character of a <a href=\"https://en.cppreference.com/w/c/language/string_literal\" rel=\"nofollow noreferrer\">string literal</a> <code>&quot;helllo&quot;</code>.</p>\n<blockquote>\n<p>as a result 'word' content will not change when you i use strcpy to copy over it</p>\n</blockquote>\n<p>As a result, <code>word</code> pointer points to <strong>not modifiable</strong> memory and that memory can't be modified. Modifying the content of the memory where <code>word</code> points to results in <a href=\"https://stackoverflow.com/questions/2397984/undefined-unspecified-and-implementation-defined-behavior\">undefined behavior</a> of your program.</p>\n<blockquote>\n<p>strcpy(word,&quot;world&quot;)</p>\n</blockquote>\n<p>Modifies the memory where the pointer <code>word</code> points to. This results in undefined behavior according to C. <code>strcpy</code> tries to write to a &quot;read-only&quot; memory or to a memory the system is not allowing the program to write to - on most systems this results in a <a href=\"https://en.wikipedia.org/wiki/Segmentation_fault\" rel=\"nofollow noreferrer\">segmentation fault</a>, which is literally a failure condition associated with accessing a restricted memory area.</p>\n<blockquote>\n<p>//case 2</p>\n<p>this case works because I create a static variable word with size 20</p>\n</blockquote>\n<p>The <a href=\"https://en.cppreference.com/w/c/language/storage_duration\" rel=\"nofollow noreferrer\">static</a> keyword is (most commonly) associated in C with creating variables with static storage duration - this is not important here. The definition <code>char word[20]</code> tells the compiler to allocate storage for 20 <code>char</code>s. Such definition creates storage that can be modified. It does not matter if such declaration is used with the keyword <code>static</code> or not, the storage is accessible via <code>word</code> is modifiable.</p>\n<blockquote>\n<p>and everytime I change it, The compiler knows where to find it in the stack.</p>\n</blockquote>\n<p>Hm... The compiler will most probably always know where to find it on the stack - the address of <code>word</code> array - ie. <code>&amp;word</code> - does not change. In <code>strcpy(word,&quot;hello&quot;);</code> you change the content of the array, the memory allocated with <code>word</code> array, not the array location.</p>\n"}, {"tags": [], "owner": {"reputation": 1496, "user_id": 3590673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5278d6e84901ade37bd33e1bdc2ce8?s=128&d=identicon&r=PG&f=1", "display_name": "csknk", "link": "https://stackoverflow.com/users/3590673/csknk"}, "is_accepted": false, "score": 1, "last_activity_date": 1574869281, "creation_date": 1574869281, "answer_id": 59073756, "question_id": 59073311, "link": "https://stackoverflow.com/questions/59073311/getting-core-dumped-error-when-trying-to-use-strcpy/59073756#59073756", "title": "getting core dumped error when trying to use strcpy", "body": "<p>With <code>char * word = \"hello\";</code> you have defined a string as a pointer to a char, initialised by a string literal. String literals are stored in a read only section of memory and are effectively constant.</p>\n\n<p>The value is stored in a read-only section in the binary file and cannot be modified. If you compile to an assembly file (use the -S compiler option in gcc), you can see the string literals in the .rodata section. In this context, rodata means \u201cread-only data\u201d.</p>\n\n<p>Though the string literal is read-only, you can modify your <code>char *</code> by pointing it to a different string literal:</p>\n\n<pre><code>char *word = \"hello\";\n// Redefine the char pointer\nword = \"world\";\n</code></pre>\n\n<p>This re-assignment is OK - you will see both string literals in your assembly file. In this case you can't use <code>strcpy()</code> to copy into <code>word</code> because it is immutable.</p>\n\n<p>In case 2, you declare your string as a character array <code>char word[20]</code>. You are declaring an empty \"string\" (really a char array) with space for 20 characters. Copying <code>word2</code> (a string literal) into <code>word</code> works because in this case <code>word</code> was declared as a character array and is therefore mutable.</p>\n"}], "owner": {"reputation": 119, "user_id": 3936102, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zal9N.jpg?s=128&g=1", "display_name": "MohsenFM", "link": "https://stackoverflow.com/users/3936102/mohsenfm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "closed_date": 1574868929, "accepted_answer_id": 59073488, "answer_count": 2, "score": 0, "last_activity_date": 1574869281, "creation_date": 1574867802, "question_id": 59073311, "link": "https://stackoverflow.com/questions/59073311/getting-core-dumped-error-when-trying-to-use-strcpy", "closed_reason": "Duplicate", "title": "getting core dumped error when trying to use strcpy", "body": "<p>First of all i would like to know why exactly case 1 gives me core dump error.\nsecondly I want to understand if my mindset is correct.</p>\n\n<p>So i created 2 cases, in the first case when i execute, i get a core dumped message and the program exits.</p>\n\n<p>The other case runs and i see the result.</p>\n\n<pre><code>    //case 1\n    //'word' is not initialized properly,or by using malloc or calloc\n    //as a result 'word' content will not change when you i use strcpy to copy over it\n    char * word = \"hello\";\n    printf(\"%s\\n\",word);\n    strcpy(word,\"world\");\n    printf(\"%s\\n\",word);\n\n    //case 2\n    //this case works because I create a static variable word with size 20\n    //and everytime I change it, The compiler knows where to find it in the stack.\n    char  word[20] = \"\";\n    char * word2 = \"yolo\";\n    strcpy(word,\"hello\");\n\n    printf(\"%s\\n\",word); //prints hello as expected\n    strcpy(word,word2); //copies yolo to word\n    printf(\"%s\\n\",word); // prints yolo\n   //hence strcpy does not change the reference\n</code></pre>\n"}, {"tags": ["python", "c", "macos", "dll", "ctypes"], "comments": [{"owner": {"reputation": 7647, "user_id": 987358, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ace6dfd8c4f8c95d5a3fddc020af97f8?s=128&d=identicon&r=PG", "display_name": "Michael Butscher", "link": "https://stackoverflow.com/users/987358/michael-butscher"}, "edited": false, "score": 0, "creation_date": 1574868012, "post_id": 59073296, "comment_id": 104384461, "body": "ctypes also works for Mac OS or Linux although it uses the term &quot;DLL&quot;."}, {"owner": {"reputation": 1, "user_id": 12445814, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA3qkFdJkllbpAFxoU20YiIi2JBx332gI1rb3EQ1g=k-s128", "display_name": "Roeland Osaer", "link": "https://stackoverflow.com/users/12445814/roeland-osaer"}, "reply_to_user": {"reputation": 7647, "user_id": 987358, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ace6dfd8c4f8c95d5a3fddc020af97f8?s=128&d=identicon&r=PG", "display_name": "Michael Butscher", "link": "https://stackoverflow.com/users/987358/michael-butscher"}, "edited": false, "score": 0, "creation_date": 1574869232, "post_id": 59073296, "comment_id": 104385088, "body": "I tried it with ctypes.cdll.LoadLibrary(&quot;path to dll&quot;) but he give an error with unknown file type"}, {"owner": {"reputation": 7647, "user_id": 987358, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ace6dfd8c4f8c95d5a3fddc020af97f8?s=128&d=identicon&r=PG", "display_name": "Michael Butscher", "link": "https://stackoverflow.com/users/987358/michael-butscher"}, "edited": false, "score": 0, "creation_date": 1574881408, "post_id": 59073296, "comment_id": 104390991, "body": "Maybe the library wasn&#39;t compiled correctly for Mac OS."}], "owner": {"reputation": 1, "user_id": 12445814, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA3qkFdJkllbpAFxoU20YiIi2JBx332gI1rb3EQ1g=k-s128", "display_name": "Roeland Osaer", "link": "https://stackoverflow.com/users/12445814/roeland-osaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574867756, "creation_date": 1574867756, "question_id": 59073296, "link": "https://stackoverflow.com/questions/59073296/import-a-c-api-file-in-python", "title": "import a .C api file in Python", "body": "<p>For a project I want to implement a c file in python. It is library for the MCP2210. I found it on <a href=\"http://ww1.microchip.com/downloads/en/DeviceDoc/MCP2210_linux_library.zip\" rel=\"nofollow noreferrer\">http://ww1.microchip.com/downloads/en/DeviceDoc/MCP2210_linux_library.zip</a>.</p>\n\n<p>how do I implement this into a python code so i can access the methods that are written in the library? \nI knew there is something like ctypes.DLL but i use a mac to program. .DLL is for windows.    </p>\n"}, {"tags": ["c++", "c", "assembly", "flags"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1574867028, "post_id": 59073016, "comment_id": 104383916, "body": "Unrelated to your question, but instead of <code>if (condition) return true; else return false</code>; you could just have <code>return condition;</code>"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1574870054, "post_id": 59073016, "comment_id": 104385550, "body": "Did you look at the assembly code?"}], "answers": [{"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 10, "last_activity_date": 1574896694, "last_edit_date": 1574896694, "creation_date": 1574867350, "answer_id": 59073166, "question_id": 59073016, "link": "https://stackoverflow.com/questions/59073016/why-assembly-function-called-from-c-give-different-result-in-flags-if-addition/59073166#59073166", "title": "Why assembly function called from C++ give different result in flags if addition made with two variables or one variable and one numeric literal?", "body": "<p>Any expectation about how the compiler chooses to implement the C <code>+</code> operator in terms of asm is unfounded.  Some tuning options could make it prefer <code>lea</code> instead of <code>add</code> which doesn't set flags.  (For GCC this is in fact the case with <code>-mtune=atom</code>).</p>\n\n<p>With optimization enabled, it might do it in a different order, not right before that non-inline function call.</p>\n\n<p><strong>Or for <code>+1</code> specifically, MSVC might have chosen <a href=\"https://www.felixcloutier.com/x86/inc\" rel=\"nofollow noreferrer\"><code>inc</code></a> which doesn't modify CF.</strong>  That looks like the case here, given that your FLAGS result differs only in the low bit.  (<a href=\"https://en.wikipedia.org/wiki/FLAGS_register\" rel=\"nofollow noreferrer\">CF is the lowest bit</a>).  For that bit, you're reading whatever value happened to be left in CF before the <code>inc</code>.  The other bits are written by <code>inc</code>.</p>\n\n<p>You can check the compiler-generated asm by single-stepping with a debugger, or put it on <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">https://godbolt.org/</a></p>\n\n<hr>\n\n<p>And there's also no reason to assume that that FLAGS are still set from the asm for <code>+</code> by the time execution reaches your function call.  Even inline asm can't reliably do this.  <strong>If you want to read FLAGS from <code>add</code>, the <code>add</code> needs to be in your asm, not compiler-generated.</strong></p>\n\n<p>The optimizer does <em>not</em> consider the FLAG results of previous C statements to be an input to function calls, or an observable side-effect at all (except for compiler-generated code that intentionally reads FLAGS results, e.g. <code>jnz</code> after an add to implement <code>if(foo)</code>)</p>\n"}], "owner": {"reputation": 15, "user_id": 4212129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jufEC.jpg?s=128&g=1", "display_name": "froli78", "link": "https://stackoverflow.com/users/4212129/froli78"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 59073166, "answer_count": 1, "score": 0, "last_activity_date": 1574896694, "creation_date": 1574866820, "last_edit_date": 1574867414, "question_id": 59073016, "link": "https://stackoverflow.com/questions/59073016/why-assembly-function-called-from-c-give-different-result-in-flags-if-addition", "title": "Why assembly function called from C++ give different result in flags if addition made with two variables or one variable and one numeric literal?", "body": "<p>Please help me if someone can!</p>\n\n<p>I've written a 3 row Assembly code to get back the value of RFLAGS:</p>\n\n<pre><code>PUBLIC x64rflags\n.code\n; Caller C++ function prototype: unsigned long long int x64rflags();\nx64rflags PROC     \n    pushfq          ; RFLAGS into stack\n    pop rax         ; RAX = RFLAGS\n    ret    \nx64rflags ENDP\nEnd\n</code></pre>\n\n<p>which I use in a C++ library to check flags from C++ programs:</p>\n\n<pre><code>//The RFLAGS query function. Result in unsigned long long int value.\nextern \"C\"\n{\n    unsigned long long int x64rflags();\n}\n\n//The FLAGS bits decimal values\nenum\n{\n    FLAGS_CF = 1, //Carry\n    FLAGS_PF = 4, //Parity\n    FLAGS_AF = 16, //Adjust (Auxiliary carry)\n    FLAGS_ZF = 64, //Zero\n    FLAGS_SF = 128, //Sign\n    FLAGS_TF = 256, //Trap\n    FLAGS_IF = 512, //Interrupt enable\n    FLAGS_DF = 1024, //Direction\n    FLAGS_OF = 2048, //Overflow\n    FLAGS_IOPL_LOW = 4096, //I/O privilege level low bit\n    FLAGS_IOPL_HIGH = 8192, //I/O privilege level high bit\n    FLAGS_NT = 16384, //Nested task\n    FLAGS_RF = 65536, //Resume\n    FLAGS_VM = 131072, //Virtual 8086 mode\n    FLAGS_AC = 262144, //Alignment Check\n    FLAGS_VIF = 524288, //Virtual interrupt\n    FLAGS_VIP = 1048576, //Virtual interrupt Pending\n    FLAGS_ID = 2097152, //CPUID available\n};\n\n//The compare function of RFLAGS and inpected values\nbool flagschk(unsigned long long int flags, unsigned long long int flagsToChk)\n{\n    if (flagsToChk == (flagsToChk &amp; flags))\n    {\n        return true;\n    }\n    else\n    {\n        return false;\n    }\n}\n</code></pre>\n\n<p>And here my C++ testprogram:</p>\n\n<pre><code>#define _UNICODE\n#define UNICODE\n\n#include &lt;iostream&gt;\n#include &lt;windows.h&gt;\n#include &lt;string&gt;\n#include &lt;x64rflags.h&gt;\n\nusing namespace std;\ntypedef unsigned long long int ulli;\n\nint main()\n{\n    SetConsoleOutputCP(1250); //ANSI Central European; Central European (Windows)\n\n    ulli ullia, ullib, ullir, actrflags;\n    std::string stro1, stro2;\n\n    ullia = 0xffffffffffffffff;\n    ullib = 1;\n    ullir = ullia + ullib; //CF\n    actrflags = x64rflags(); //CALL THE RFLAGS RETURNER ASM FUNCTION\n    printf(\"1 Result: %llu\\n\", ullir);\n    stro1 = \"1 The value of actrflags: \";\n    stro2 = std::to_string(unsigned long long int(actrflags));\n    stro1.append(stro2);\n    stro1.append(\"\\n\");\n    printf(stro1.c_str());\n\n\n    if(flagschk(actrflags, FLAGS_CF))\n    {\n        printf(\"1 condparam = TRUE\\n\\n\");\n    }\n    else\n    {\n        printf(\"1 condparam = FALSE\\n\\n\");\n    }\n//*/\n    ullia = 0xffffffffffffffff;\n    ullir = ullia + 1; //CF\n    actrflags = x64rflags(); //CALL THE RFLAGS RETURNER ASM FUNCTION\n    printf(\"2 Result: %llu\\n\", ullir);\n    stro1 = \"2 The value of actrflags: \";\n    stro2 = std::to_string(unsigned long long int(actrflags));\n    stro1.append(stro2);\n    stro1.append(\"\\n\");\n    printf(stro1.c_str());\n\n\n    if(flagschk(actrflags, FLAGS_CF))\n    {\n        printf(\"2 condparam = TRUE\\n\\n\");\n    }\n    else\n    {\n        printf(\"2 condparam = FALSE\\n\\n\");\n    }\n\n    return 0;\n}\n\n</code></pre>\n\n<p>My problem is that it gives me diffrent result on the two probe.\nThe first which use variables work as expected: Raise the Carry and Give back \"TRUE\"</p>\n\n<p>The second which use one variable and one numeric literal don't raise Carry.</p>\n\n<p><a href=\"https://i.stack.imgur.com/VDSRF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VDSRF.png\" alt=\"enter image description here\"></a></p>\n\n<p>Additional info:\nThe Assembly code compiled by ml64 with option /c\nThe C++ code written in Code::Blocks, compiled with MSVC 2019.\nThe program running on Intel x64Arch (core i7).\nThe programs (in theory) use the default (x64 ABI) calling conventions.\nIf I don't use the \"=\" in the adding expression before the rflags query that not work in both case. (I guess then the MSVC handling the addition as \"NOP\" and give back the last carry independently from the addition...)</p>\n\n<p>Someone can explain what couse this anomaly?</p>\n"}, {"tags": ["c", "arrays", "scanf"], "comments": [{"owner": {"reputation": 259, "user_id": 2710319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62e82d1d25764466572d0aa49b0b2c5?s=128&d=identicon&r=PG", "display_name": "HeLLo", "link": "https://stackoverflow.com/users/2710319/hello"}, "edited": false, "score": 3, "creation_date": 1574866004, "post_id": 59072684, "comment_id": 104383297, "body": "Please copy the code here and post a minimal executable example. Thanks."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1574866010, "post_id": 59072684, "comment_id": 104383299, "body": "Please don&#39;t show pictures of text. Show text instead."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1574866012, "post_id": 59072684, "comment_id": 104383302, "body": "Welcome to StackOverflow! Please post code as text in the question itself. You might benefit by reading the <a href=\"https://stackoverflow.com/tour\">tour</a> and <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1574866071, "post_id": 59072684, "comment_id": 104383329, "body": "At least <code>scanf(&quot;%d&quot;, msquare[i][j])</code> -&gt; <code>scanf(&quot;%d&quot;, &amp;msquare[i][j])</code>. But there may be more problems in the code you didn&#39;t show."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1574866363, "post_id": 59072684, "comment_id": 104383505, "body": "Note that idiomatic <code>for</code> loops in C are of the form <code>for (int i = 0; i &lt; maximum; i++)</code>. (You can omit the <code>int</code> if you need the variable outside the loop and define the variable beforehand.) If you fixed the <code>scanf()</code> problem, your loops using <code>for (i = 0; i &lt;= n; i++)</code> would write outside the bounds of the array, wreaking havoc on your program."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12446492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b72f8fcb800311cdbcff88ef1bc3242?s=128&d=identicon&r=PG&f=1", "display_name": "Thanos", "link": "https://stackoverflow.com/users/12446492/thanos"}, "edited": false, "score": 0, "creation_date": 1574867063, "post_id": 59072977, "comment_id": 104383938, "body": "thanks for relplying, could you please explain to me how my loops are writing outside the bounds of the array? I read your explanation but still can&#39;t figure out whats wrong"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 3, "user_id": 12446492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b72f8fcb800311cdbcff88ef1bc3242?s=128&d=identicon&r=PG&f=1", "display_name": "Thanos", "link": "https://stackoverflow.com/users/12446492/thanos"}, "edited": false, "score": 1, "creation_date": 1574867551, "post_id": 59072977, "comment_id": 104384215, "body": "@Thanos Supoose you have 3 drawers numbered from 0 to 2. What happens if you try to put something into drawer number 3?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1574867576, "post_id": 59072977, "comment_id": 104384233, "body": "Suppose you enter <code>8</code> for <code>n</code>. The array can be indexed from <code>0</code> to <code>7</code>, but your loops index it from <code>0</code> to <code>8</code>. There is <i>no</i> element <code>[8]</code>."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 2, "last_activity_date": 1574877364, "last_edit_date": 1574877364, "creation_date": 1574866701, "answer_id": 59072977, "question_id": 59072684, "link": "https://stackoverflow.com/questions/59072684/cant-use-scanf-in-variable-2d-array/59072977#59072977", "title": "Can&#39;t use scanf in variable 2d array", "body": "<p>Note that idiomatic <code>for</code> loops in C are of the form</p>\n\n<pre><code>for (int i = 0; i &lt; maximum; i++)\n</code></pre>\n\n<p>(You can omit the <code>int</code> if you need the variable outside the loop and define the variable beforehand.)</p>\n\n<p>Some versions of the question had <code>scanf(\"%d\", msquare[i][j]);</code> without an <code>&amp;</code>, and some versions had <code>scanf(\"%d\", &amp;msquare[i][j]);</code>.  The version with the <code>&amp;</code> is correct.</p>\n\n<p>With the <code>scanf()</code> problem fixed, your loops using</p>\n\n<pre><code>for (i = 0; i &lt;= n; i++)\n</code></pre>\n\n<p>lead the code to access outside the bounds of the array, wreaking havoc on your program.  Remember: if you declare an array <code>msquare[5][5]</code>, then you can access elements <code>msquare[0][0]</code> through <code>msquare[4][4]</code> \u2014 any larger indexes than <code>4</code> (or negative indexes) access the array out of bounds.  Since you define <code>msquare[n][n]</code>, you mustn't use anything bigger than <code>msquare[n-1][n-1]</code>, but your loop controls mean you try to access <code>msquare[n][n]</code> (written as <code>msquare[i][j]</code>, but accessing out of bounds when <code>i == n || j == n</code>).</p>\n\n<p>You're invoking undefined behaviour, so anything is possible.  One of the many possibilities is that you overwrite the value of <code>n</code> with one of your inputs, so instead of being <code>2</code> it becomes <code>38</code> or whatever you entered, whereupon your loop takes a lot longer than you expected.  No-one can be certain that's what's happening \u2014 undefined behaviour can do anything.  But it is a semi-plausible explanation.</p>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1574867376, "post_id": 59073062, "comment_id": 104384116, "body": "<code>int m[n][n];</code> is called a <a href=\"https://en.wikipedia.org/wiki/Variable-length_array\" rel=\"nofollow noreferrer\">variable length array</a> and was introduced in C99, however in C11 was made an optional feature. MS Visual C has never supported it, but plainly OP&#39;s compiler allows it."}, {"owner": {"reputation": 3952, "user_id": 2152957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/7wZ6n.jpg?s=128&g=1", "display_name": "tay10r", "link": "https://stackoverflow.com/users/2152957/tay10r"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1574867479, "post_id": 59073062, "comment_id": 104384168, "body": "Ah, I always thought it was a compiler extension and not part of the standard."}, {"owner": {"reputation": 3, "user_id": 12446492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b72f8fcb800311cdbcff88ef1bc3242?s=128&d=identicon&r=PG&f=1", "display_name": "Thanos", "link": "https://stackoverflow.com/users/12446492/thanos"}, "edited": false, "score": 0, "creation_date": 1574867635, "post_id": 59073062, "comment_id": 104384271, "body": "Thanks for the help, I did everything that you mention and for some reason I still have the exact same problem as before"}, {"owner": {"reputation": 3952, "user_id": 2152957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/7wZ6n.jpg?s=128&g=1", "display_name": "tay10r", "link": "https://stackoverflow.com/users/2152957/tay10r"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1574867709, "post_id": 59073062, "comment_id": 104384313, "body": "@WeatherVane fixed."}, {"owner": {"reputation": 3952, "user_id": 2152957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/7wZ6n.jpg?s=128&g=1", "display_name": "tay10r", "link": "https://stackoverflow.com/users/2152957/tay10r"}, "reply_to_user": {"reputation": 3, "user_id": 12446492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b72f8fcb800311cdbcff88ef1bc3242?s=128&d=identicon&r=PG&f=1", "display_name": "Thanos", "link": "https://stackoverflow.com/users/12446492/thanos"}, "edited": false, "score": 0, "creation_date": 1574867758, "post_id": 59073062, "comment_id": 104384342, "body": "@Thanos can you post an update on the code you&#39;re using that&#39;s still causing the issue?"}, {"owner": {"reputation": 3, "user_id": 12446492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b72f8fcb800311cdbcff88ef1bc3242?s=128&d=identicon&r=PG&f=1", "display_name": "Thanos", "link": "https://stackoverflow.com/users/12446492/thanos"}, "edited": false, "score": 1, "creation_date": 1574868229, "post_id": 59073062, "comment_id": 104384594, "body": "@tay10r it seems that it works now, i forgot to change the = at j&lt;=n. Thank you so much for helping me and thank you to everyone else !"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1574877695, "post_id": 59073062, "comment_id": 104389430, "body": "The initialization in <code>int n = 2;     scanf(&quot;%d&quot;, &amp;n);</code> is almost pointless.  To the extent it is not pointless, it means that if the <code>scanf()</code> call fails to read a value (returns either 0 or EOF), then <code>n</code> still has a known value (<code>2</code>).  But that&#39;s very subtle and should be commented upon, and to be sensible you&#39;d also have to deal similarly with the other <code>scanf()</code> \u2014 and you don&#39;t show that.  It would be better to check the return value from <code>scanf()</code> and abandon ship if the value returned is not <code>1</code>."}, {"owner": {"reputation": 3952, "user_id": 2152957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/7wZ6n.jpg?s=128&g=1", "display_name": "tay10r", "link": "https://stackoverflow.com/users/2152957/tay10r"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1574878003, "post_id": 59073062, "comment_id": 104389566, "body": "@JonathanLeffler yeah I think it would be sensible to either initialize n to zero or to just check the return value of scanf. I&#39;ll give that an update."}], "tags": [], "owner": {"reputation": 3952, "user_id": 2152957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/7wZ6n.jpg?s=128&g=1", "display_name": "tay10r", "link": "https://stackoverflow.com/users/2152957/tay10r"}, "is_accepted": true, "score": 4, "last_activity_date": 1574878390, "last_edit_date": 1574878390, "creation_date": 1574867005, "answer_id": 59073062, "question_id": 59072684, "link": "https://stackoverflow.com/questions/59072684/cant-use-scanf-in-variable-2d-array/59073062#59073062", "title": "Can&#39;t use scanf in variable 2d array", "body": "<p>There's three issues that need to be addressed in your code.</p>\n\n<p>The first one is that you can't create arrays based on <em>uninitialized</em> variables!</p>\n\n<p>For example, you can't do this:</p>\n\n<pre><code>int main() {\n    int n;\n    int m[n][n];\n    return 0;\n}\n</code></pre>\n\n<p>Just make sure you initialize the variable before the array declaration, like this:</p>\n\n<pre><code>int main() {\n    int n = 2;\n    int m[n][n];\n    return 0;\n}\n</code></pre>\n\n<p>Since you're getting the value of <code>n</code> from a <code>scanf</code> call, you could simply write this:</p>\n\n<pre><code>int main() {\n    int n;\n    scanf(\"%d\", &amp;n);\n    int m[n][n];\n    return 0;\n}\n</code></pre>\n\n<p>But you might run into trouble if <code>scanf</code> fails for some reason.\nThe proper way to handle this is to check the value of <code>scanf</code>.</p>\n\n<pre><code>int main() {\n\n    int n;\n\n    if (sscanf(\"%d\", &amp;n) != 1) {\n        printf(\"Failed to get a matrix size from stdin\\n\");\n        return 1;\n    }\n\n    int m[n][n];\n\n    return 0;\n}\n</code></pre>\n\n<p>And it's sometimes a good idea to initialize your variables to a sensible value.\nIn this case, 0 would be a good choice.</p>\n\n<pre><code>int main() {\n\n    int n = 0;\n\n    if (scanf(\"%d\", &amp;n) != 1) {\n        printf(\"Failed to get matrix size!\\n\");\n        return 1;\n    }\n\n    int m[n][n];\n\n    return 0;\n}\n</code></pre>\n\n<p>While there's some cases that it's useful to leave variables uninitialized, it's beyond the scope of this answer.</p>\n\n<p>It might be a good idea at this point to add a check to ensure your first input variable does not exceed the value of 8.</p>\n\n<p>The second issue is your for loops.</p>\n\n<p>You're looping one extra iteration that you should be doing.</p>\n\n<p>For example, this code:</p>\n\n<pre><code>int n = 2;\nfor (int i = 0; i &lt;= n; n++) {\n  printf(\"i = %d and n = %d\\n\");\n}\n</code></pre>\n\n<p>Prints:</p>\n\n<pre><code>0 2\n1 2\n2 2\n</code></pre>\n\n<p>See how it goes three times instead of 2? You should be using the <code>&lt;</code> operator instead of the <code>&lt;=</code> operator to fix this issue.</p>\n\n<p>Your loops (both of them) should end up looking something like this:</p>\n\n<pre><code>for (int i = 0; i &lt; n; i++) {\n    for (int j = 0; j &lt; n; j++) {\n    }\n}\n</code></pre>\n\n<p>And the last issue is in your second call to <code>scanf</code>. This function accepts a pointer (as you did in your first call) but you're passing it an integer instead in your second call.</p>\n\n<pre><code>scanf(\"%d\", m[i][j]);\n</code></pre>\n\n<p>You need to add the <code>&amp;</code> to make it a pointer.</p>\n\n<pre><code>scanf(\"%d\", &amp;m[i][j]);\n</code></pre>\n\n<p>Fix those things and your code should run okay.</p>\n"}], "owner": {"reputation": 3, "user_id": 12446492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b72f8fcb800311cdbcff88ef1bc3242?s=128&d=identicon&r=PG&f=1", "display_name": "Thanos", "link": "https://stackoverflow.com/users/12446492/thanos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 59073062, "answer_count": 2, "score": 0, "last_activity_date": 1574878546, "creation_date": 1574865773, "last_edit_date": 1574878546, "question_id": 59072684, "link": "https://stackoverflow.com/questions/59072684/cant-use-scanf-in-variable-2d-array", "title": "Can&#39;t use scanf in variable 2d array", "body": "<p>I have an assignment which requires me to make a N*N array then fill the array with numbers from 1 to N^2. After that I have to check if the array is a magic cube, but this is not my problem. I've tried everything but I can't fill the array; scanf keeps going forever.</p>\n\n<p>As you can see in the screenshot, in the first scanf, let's say I press 2 and enter, the variable n becomes 2, so an array named msquare[2][2] has to be created. But when it comes to the second scanf something doesn't work right and it lets me type forever. I would really appreciate some help. Also, if the problem has to do something with pointers please try to explain as good as you can because I'm still not familiar with them and can't understand them perfectly. </p>\n\n<p>Here's an example : </p>\n\n<pre><code>int n;\nint i;\nint j;\n\nscanf(\"%d\", &amp;n);\n\nint msquare[n][n];   \n\nfor (i=0; i&lt;=n; i++)\n    {\n        for (j=0; j&lt;=n; j++){\n            scanf(\"%d\",msquare[i][j]);\n        }\n    }\n</code></pre>\n"}, {"tags": ["c", "string", "segmentation-fault", "printf", "dynamic-arrays"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574865957, "post_id": 59072635, "comment_id": 104383268, "body": "Please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, the problem as well as the input required to reproduce the problem."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1574869383, "post_id": 59072635, "comment_id": 104385166, "body": "Not related to the problem, but why do you alloc <code>MAX_SIZE+1</code> bytes, if you read <code>start</code> and <code>end</code> afterwards and can derive the correct length?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574916723, "post_id": 59072635, "comment_id": 104400380, "body": "regarding: <code>data = malloc(all_names * sizeof(char*));</code>  1) strongly suggest calling <code>calloc()</code> instead so it will be easy to free() the memory afterward.  (note: the posted code fails to free the allocated memory, resulting in a massive memory leak."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574916864, "post_id": 59072635, "comment_id": 104400408, "body": "regarding: <code>char *filename = argv[2];</code>  What is the expected input from the user?  2) never access beyond <code>argv[0]</code> without first checking <code>argc</code> to assure the user actually entered the expected number of command line parameters"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574916960, "post_id": 59072635, "comment_id": 104400418, "body": "OT: for ease of readability and understanding: 1) please consistently indent the code. Indent after every opening brace &#39;{&#39;.  Unindent before every closing brace &#39;}&#39;.  Suggest each indent level be 4 spaces"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574917274, "post_id": 59072635, "comment_id": 104400489, "body": "OT: regarding: <code>name=(char*)malloc((MAX_SIZE+1)*sizeof(char));</code>  1) in C, the returned type is <code>void*</code> which can be assigned to any pointer.  casting just clutters the code.  2) the expression: <code>sizeof(char)</code> is defined in the C standard as 1.  Multiplying anything by 1 has no effect.  Suggest removing the cast,  Suggest removing the <code>sizeof(char)</code> expression.  3) always check (!=NULL) the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574917491, "post_id": 59072635, "comment_id": 104400550, "body": "regarding: <code>char passpos[5];             sprintf(passpos,&quot;%d&quot;,pcounter); &#47;&#47;int to string</code>  What happens when the <code>pcounter</code> exceeds 9999?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574917687, "post_id": 59072635, "comment_id": 104400594, "body": "regarding: <code>write(fd,passpos,3);</code>  what happens when <code>pcounter</code> is greater than 999?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574918552, "post_id": 59072635, "comment_id": 104400872, "body": "regarding: <code>if(option==1)         {</code>   and <code>}         }while(1); </code>   means the opening brace(s) are not properly linked to the closing braces(s).  This is a major logic error"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11109037"}, "edited": false, "score": 0, "creation_date": 1574867089, "post_id": 59072756, "comment_id": 104383948, "body": "I no longer get a set fault, but for example, if I insert &quot;beta two&quot; and then &quot;alpha one&quot; into the array, what gets printed is &quot;beta twoa&quot;. The problem is that I don&#39;t know if its the sorting&#39;s fault or something wrong with my printing, cause: printing a line never works, even before sorting. But printing it as character by character works before I sort."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11109037"}, "edited": false, "score": 0, "creation_date": 1574867297, "post_id": 59072756, "comment_id": 104384083, "body": "<code>for(int i=0; i&lt;all_names; ++i)     {         printf(&quot;%s\\n&quot;, data[i]);     }</code>"}, {"owner": {"reputation": 3952, "user_id": 2152957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/7wZ6n.jpg?s=128&g=1", "display_name": "tay10r", "link": "https://stackoverflow.com/users/2152957/tay10r"}, "edited": false, "score": 0, "creation_date": 1574867428, "post_id": 59072756, "comment_id": 104384142, "body": "You are passing <code>sizeof(char*)</code> and not <code>sizeof(char)</code> right? If you are, you can ignore the compiler warning in that particular case."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11109037"}, "edited": false, "score": 0, "creation_date": 1574867620, "post_id": 59072756, "comment_id": 104384265, "body": "I am yes. I can&#39;t understand why, leaving the sorting out, I have trouble printing like this <code>for(int i=0; i&lt;all_names; ++i) { printf(&quot;%s\\n&quot;, data[i]); }</code>. I know the array has been created correctly cause the printing char by char works as I say in my question."}, {"owner": {"reputation": 3952, "user_id": 2152957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/7wZ6n.jpg?s=128&g=1", "display_name": "tay10r", "link": "https://stackoverflow.com/users/2152957/tay10r"}, "edited": false, "score": 0, "creation_date": 1574867927, "post_id": 59072756, "comment_id": 104384413, "body": "And you&#39;re definitely using <code>char**</code> as a string array type? It&#39;s hard to say. You&#39;re putting all of the people looking at your code at a disadvantage to help you by not posting the entire code. If the code is too long to post, try reducing it to a smaller section of code that still has the problem."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11109037"}, "edited": false, "score": 0, "creation_date": 1574868102, "post_id": 59072756, "comment_id": 104384505, "body": "I don&#39;t know how to do that cause the process is: store input by user into bin file, then transfer file data into array, sort array, print array. Is it possible that the strings stored to the array from the file are not null-terminated and I should post that part? Its too long and I m not sure what to leave out."}, {"owner": {"reputation": 3952, "user_id": 2152957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/7wZ6n.jpg?s=128&g=1", "display_name": "tay10r", "link": "https://stackoverflow.com/users/2152957/tay10r"}, "edited": false, "score": 0, "creation_date": 1574868232, "post_id": 59072756, "comment_id": 104384595, "body": "Yeah that&#39;s probably what the issue is. Allocate an extra byte for the null terminator and make sure you set it to zero. If you&#39;re still having issues after that, do your best to post the code so we can actually help you without asking so many questions!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11109037"}, "edited": false, "score": 0, "creation_date": 1574868792, "post_id": 59072756, "comment_id": 104384877, "body": "Its a bit complicated. I revised the question completely, is that better?"}, {"owner": {"reputation": 3952, "user_id": 2152957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/7wZ6n.jpg?s=128&g=1", "display_name": "tay10r", "link": "https://stackoverflow.com/users/2152957/tay10r"}, "edited": false, "score": 0, "creation_date": 1574869044, "post_id": 59072756, "comment_id": 104384998, "body": "@NeedHalp that&#39;s a bit better. See the updates on my answer and hopefully it helps."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11109037"}, "edited": false, "score": 0, "creation_date": 1574869186, "post_id": 59072756, "comment_id": 104385062, "body": "Still getting the &quot;beta twoa&quot;"}, {"owner": {"reputation": 3952, "user_id": 2152957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/7wZ6n.jpg?s=128&g=1", "display_name": "tay10r", "link": "https://stackoverflow.com/users/2152957/tay10r"}, "edited": false, "score": 0, "creation_date": 1574869338, "post_id": 59072756, "comment_id": 104385145, "body": "Then you could be calculating the array <code>positions</code> incorrectly. But I&#39;m not really sure. You should really just post the entire code at this point."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11109037"}, "edited": false, "score": 0, "creation_date": 1574869620, "post_id": 59072756, "comment_id": 104385287, "body": "Posted the whole thing then"}, {"owner": {"reputation": 3952, "user_id": 2152957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/7wZ6n.jpg?s=128&g=1", "display_name": "tay10r", "link": "https://stackoverflow.com/users/2152957/tay10r"}, "edited": false, "score": 0, "creation_date": 1574869632, "post_id": 59072756, "comment_id": 104385291, "body": "@NeedHalp and even if your position values are being calculated correctly, it doesn&#39;t look like you&#39;re using them correctly in the for loop."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11109037"}, "edited": false, "score": 0, "creation_date": 1574869706, "post_id": 59072756, "comment_id": 104385342, "body": "The for loop with the positions works fine though, but I can&#39;t use it after sorting cause then the positions are no longer accurate."}, {"owner": {"reputation": 3952, "user_id": 2152957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/7wZ6n.jpg?s=128&g=1", "display_name": "tay10r", "link": "https://stackoverflow.com/users/2152957/tay10r"}, "edited": false, "score": 0, "creation_date": 1574870184, "post_id": 59072756, "comment_id": 104385620, "body": "You don&#39;t really need the positions after reading the file. If you originally needed them when writing the file, when you could just use the string length to determine the positions all over again. If you want to keep the original order of the names in the, then this might be a reason to keep the position values. If this is the case, I would create a <code>struct</code> with the name string and the position value. You&#39;ll have to modify your call to <code>qsort</code>, though."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11109037"}, "reply_to_user": {"reputation": 3952, "user_id": 2152957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/7wZ6n.jpg?s=128&g=1", "display_name": "tay10r", "link": "https://stackoverflow.com/users/2152957/tay10r"}, "edited": false, "score": 0, "creation_date": 1574870344, "post_id": 59072756, "comment_id": 104385709, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/203195/discussion-between-needhalp-and-tay10r\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 3952, "user_id": 2152957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/7wZ6n.jpg?s=128&g=1", "display_name": "tay10r", "link": "https://stackoverflow.com/users/2152957/tay10r"}, "is_accepted": true, "score": 1, "last_activity_date": 1574869215, "last_edit_date": 1574869215, "creation_date": 1574866026, "answer_id": 59072756, "question_id": 59072635, "link": "https://stackoverflow.com/questions/59072635/seg-fault-when-printing-string-array-line-works-fine-when-printed-character-by/59072756#59072756", "title": "Seg fault when printing string array line, works fine when printed character by character", "body": "<p>I'm going to guess that <code>MAX_SIZE</code> is the maximum size of a string.</p>\n\n<p>But it should be <code>sizeof(char*)</code>.</p>\n\n<p>The function <code>qsort</code> expects a parameter that indicates the size of each element.\nThe size of each element in a data type <code>char**</code> is the size of <code>char*</code>.</p>\n\n<p>Here's an example, similar to your program, that's useful for quick testing.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char** argv) {\n\n    int all_names = argc;\n\n    char** data = argv;\n\n    qsort(data, all_names, sizeof(char*), strcmp);\n\n    for(int i=0; i&lt;all_names; ++i)\n    {\n        printf(\"%s\\n\", data[i]);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Regarding your updated code, after this line:</p>\n\n<pre><code>read(fd,data[i],(end-start));\n</code></pre>\n\n<p>You should null-terminate your string.</p>\n\n<pre><code>data[i][end - start] = 0;\n</code></pre>\n\n<p>I say this with the assumption that <code>end - start</code> does not account for a null-terminating character and that you're not storing null-terminated characters in the file you're reading from.</p>\n\n<p>Regarding your additional update, if you don't want to write the null-terminator to the file, then just find the length of the string using <code>strlen</code> before writing it to the file. Your other option would be to write a wrapper for <code>qsort</code> that looks something like this.</p>\n\n<pre><code>int cmp_string_block(const void* a, const void* b) {\n    return memcmp(a, b, MAX_SIZE);\n}\n</code></pre>\n\n<p>And then pass that function to <code>qsort</code> instead of <code>strcmp</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11109037"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 59072756, "answer_count": 1, "score": 0, "last_activity_date": 1574869554, "creation_date": 1574865614, "last_edit_date": 1574869554, "question_id": 59072635, "link": "https://stackoverflow.com/questions/59072635/seg-fault-when-printing-string-array-line-works-fine-when-printed-character-by", "title": "Seg fault when printing string array line, works fine when printed character by character", "body": "<p>I have this code:</p>\n\n<pre><code>char **data;\nint start = 0;\n\ndata = malloc(all_names * sizeof(char*));\n\n        fd=open(argv[1],O_RDWR|O_CREAT,S_IRWXU);\n        for(i=0; i&lt;all_names; i++){\n            data[i] = malloc((MAX_SIZE+1)*sizeof(char));\n\n            int end = atoi(positions[i]);\n            lseek(fd,0,start);\n            read(fd,data[i],(end-start));\n            data[i][end - start] = 0; //line edited in after answer\n            start = end;\n\n        }\n\n        qsort(data, all_names, sizeof(char*), strcmp);\n\n        for(int i=0; i&lt;all_names; ++i)\n        {\n            printf(\"%s\\n\", data[i]);\n        }\n\n        /*//print data array\n        start = 0;\n        for(i=0; i&lt;all_names; i++){\n            int end = atoi(positions[i]);\n            for(j=0;j&lt;(end-start) ;j++){\n                printf(\"%c\",data[i][j]);\n            }\n            printf(\"\\n\");\n        }*/\n</code></pre>\n\n<p>What I get when running it is a seg fault when trying to print. </p>\n\n<p>If I comment out <code>qsort</code> and the printing <code>for</code>, and comment in the <em>print data array</em> part, I get, as expected, all my entries in the order I inserted them in.</p>\n\n<p>If I leave <code>qsort</code> out, but keep the for loop as my printing method, I still get a seg fault.</p>\n\n<p>1.The strings in the data array come from a file so they re probably not null terminated. However, I am hesitant to add a null byte cause it <strong>must not be there</strong> when I write the sorted array back in the file.</p>\n\n<ol start=\"2\">\n<li>**positions array contains the starting point of every entry, apart from the first one. Eg. if I insert \"alpha one\" and then \"beta two\", then positions[0] = 9. </li>\n</ol>\n\n<p>Please tell me to further explain anything I haven't done a good job explaining. Thanks.</p>\n\n<p>Edit: Entire code cause it turns out I can't locate the problem</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n\n#define MAX_SIZE 50\n\nint updateCounter(int pcounter, char *str){\nint m,charcount = 0;\nfor(m=0; str[m]; m++) {\n        charcount ++;\n}\n//charcount--;\nprintf(\"chars: %d \\n\", charcount);\n\npcounter = pcounter + charcount;\nprintf(\"pcounter = %d \\n\", pcounter);\n\nreturn pcounter;\n}\n\nint main(int argc, char *argv[]){\n\nint option,i,j;\nFILE *fptr;\nchar *name;\nint dcounter,pcounter = 0;\nint fd;\nchar **positions,**data;\nint all_names=0; //keeps track of how many names are currently stored\nint start = 0; //first byte of word to read in data.bin\nchar *filename = argv[2];\n\nname=(char*)malloc((MAX_SIZE+1)*sizeof(char));\n\ndo{\n    printf(\"MENU: \\n 1.Insert \\n 2.Delete \\n 3.Search \\n 4.Display \\n\");\n\n\n    printf(\"Please choose 1-4\\n\");\n    scanf(\"%d\", &amp;option);\n    while(getchar() != '\\n');\n\n    //Insert\n    if(option==1){\n\n        printf(\"Insert name: \");\n        fgets(name,MAX_SIZE,stdin);\n        name[strcspn(name,\"\\n\")]=0;\n\n        fd=open(argv[1],O_RDWR|O_CREAT|O_APPEND,S_IRWXU);\n        write(fd,name,strlen(name));\n\n        pcounter = updateCounter(pcounter, name);\n\n        char passpos[5];\n        sprintf(passpos,\"%d\",pcounter); //int to string\n        fd=open(argv[2],O_RDWR|O_CREAT|O_APPEND,S_IRWXU);\n        write(fd,passpos,3);\n        write(fd,\" \",1);\n\n        all_names++;\n        printf(\"all names: %d\\n\",all_names);\n\n        positions = malloc(all_names * sizeof(char*));\n\n        //create pos array\n        fd=open(argv[2],O_RDWR|O_CREAT,S_IRWXU);\n        for(i=0; i&lt;all_names; i++){\n            positions[i] = malloc((MAX_SIZE+1)*sizeof(char));\n            for(j=0; ;j++){\n                read(fd,&amp;positions[i][j],1);\n                if (positions[i][j] == ' ') {\n                    break;\n                }\n            }\n        }\n        //print pos array\n        for(i=0; i&lt;all_names; i++){\n            printf(\"%s\\n\", positions[i]);\n        }\n\n        //create data array\n        data = malloc(all_names * sizeof(char*));\n\n        fd=open(argv[1],O_RDWR|O_CREAT,S_IRWXU);\n        for(i=0; i&lt;all_names; i++){\n            data[i] = malloc((MAX_SIZE+1)*sizeof(char));\n\n            int end = atoi(positions[i]);\n            lseek(fd,0,start);\n            read(fd,data[i],(end-start));\n            data[i][end - start] = 0;\n            start = end;\n\n        }\n\n        qsort(data, all_names, sizeof(char*), strcmp);\n\n        for(int i=0; i&lt;all_names; ++i)\n        {\n            printf(\"%s\\n\", data[i]);\n        }\n\n        /*//print data array\n        start = 0;\n        for(i=0; i&lt;all_names; i++){\n            int end = atoi(positions[i]);\n            for(j=0;j&lt;(end-start) ;j++){\n                printf(\"%c\",data[i][j]);\n            }\n            printf(\"\\n\");\n        }*/\n\n    }\n\n}while(1);\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "logical-operators", "logical-or", "logical-and"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11331736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c0e4f1bb73b0e6a03082ebc3033b57d?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan12", "link": "https://stackoverflow.com/users/11331736/stefan12"}, "edited": false, "score": 0, "creation_date": 1574866265, "post_id": 59072664, "comment_id": 104383451, "body": "Thank you for linking the detailed explanation!"}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 2, "last_activity_date": 1574865696, "creation_date": 1574865696, "answer_id": 59072664, "question_id": 59072618, "link": "https://stackoverflow.com/questions/59072618/why-doesnt-the-variable-increment-itself/59072664#59072664", "title": "Why doesn&#39;t the variable increment itself?", "body": "<p><code>(i == 0)</code> evaluates to <code>1</code>, so the result of the <code>||</code> is <code>1</code>. It doesn't execute the <code>j++</code> in this case. If it was <code>(i == 1) || j++;</code> instead, for instance, then <code>j</code> would be increased.</p>\n\n<p>This is explained <a href=\"https://en.cppreference.com/w/c/language/operator_logical\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<blockquote>\n  <p>There is a sequence point after the evaluation of lhs. If the result\n  of lhs compares unequal to zero, then rhs is not evaluated at all\n  (so-called short-circuit evaluation)</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 492, "user_id": 4786904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f394999ffc3562eb139be42056d69e1c?s=128&d=identicon&r=PG&f=1", "display_name": "Swedgin", "link": "https://stackoverflow.com/users/4786904/swedgin"}, "edited": false, "score": 1, "creation_date": 1574866562, "post_id": 59072672, "comment_id": 104383628, "body": "aka <code>Lazy evaluation</code>"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 10, "last_activity_date": 1574865983, "last_edit_date": 1574865983, "creation_date": 1574865719, "answer_id": 59072672, "question_id": 59072618, "link": "https://stackoverflow.com/questions/59072618/why-doesnt-the-variable-increment-itself/59072672#59072672", "title": "Why doesn&#39;t the variable increment itself?", "body": "<p>The second operand of the logical OR operator is not evaluated if the first operand (sub-expression) yields true.</p>\n\n<p>In this expression</p>\n\n<pre><code>(i == 0) || j++;\n</code></pre>\n\n<p><code>i == 0</code> is true so the second operand <code>j++</code> is not evaluated.</p>\n\n<p>If you will rewrite the expression like</p>\n\n<pre><code>(i == 0) &amp;&amp; j++;\n</code></pre>\n\n<p>then the second operand (sub-expression) will be evaluated.</p>\n\n<p>From the C Standard (6.5.13 Logical AND operator)</p>\n\n<blockquote>\n  <p>4 Unlike the bitwise binary &amp; operator, the &amp;&amp; operator guarantees\n  left-to-right evaluation; if the second operand is evaluated, there is\n  a sequence point between the evaluations of the \ufb01rst and second\n  operands. <strong>If the \ufb01rst operand compares equal to 0, the second operand\n  is not evaluated.</strong></p>\n</blockquote>\n\n<p>and (6.5.14 Logical OR operator)</p>\n\n<blockquote>\n  <p>4 Unlike the bitwise | operator, the || operator guarantees\n  left-to-right evaluation; if the second operand is evaluated, there is\n  a sequence point between the evaluations of the \ufb01rst and second\n  operands. <strong>If the \ufb01rst operand compares unequal to 0, the second\n  operand is not evaluated.</strong></p>\n</blockquote>\n"}], "owner": {"reputation": 21, "user_id": 11331736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c0e4f1bb73b0e6a03082ebc3033b57d?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan12", "link": "https://stackoverflow.com/users/11331736/stefan12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1574866362, "creation_date": 1574865576, "last_edit_date": 1574866362, "question_id": 59072618, "link": "https://stackoverflow.com/questions/59072618/why-doesnt-the-variable-increment-itself", "title": "Why doesn&#39;t the variable increment itself?", "body": "<p>I am having trouble understanding this piece of code here. My question is why doesn't the post-increment work on the variable j? Seems like the line never gets executed and it ends up printing 0 0 instead of 0 1? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int i = 0, j = 0;\n    (i == 0) || j++;\n    printf(\"%d %d\", i, j);\n}\n</code></pre>\n\n<p>I would appreciate if someone explained to me where I'm wrong, thank you!</p>\n"}, {"tags": ["python", "c", "dll", "ctypes"], "comments": [{"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1574866563, "post_id": 59072568, "comment_id": 104383630, "body": "Did you check that the DLL is indeed providing the function <code>root</code>?"}, {"owner": {"reputation": 51, "user_id": 12361032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1818738a71de793df7e8ebd90538706?s=128&d=identicon&r=PG&f=1", "display_name": "rak", "link": "https://stackoverflow.com/users/12361032/rak"}, "reply_to_user": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1574866729, "post_id": 59072568, "comment_id": 104383728, "body": "@GuillaumePetitjean, No. I am new to ctypes and i dont how to check it."}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1574866848, "post_id": 59072568, "comment_id": 104383809, "body": "It&#39;s not linked to ctypes, you can do it with a tool on Windows."}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1574868158, "post_id": 59072568, "comment_id": 104384545, "body": "<a href=\"https://stackoverflow.com/questions/2891493/list-exported-functions-from-dll-with-ctypes\" title=\"list exported functions from dll with ctypes\">stackoverflow.com/questions/2891493/&hellip;</a>"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1574872064, "post_id": 59072568, "comment_id": 104386642, "body": "Your script works on my system. Show the compilation commands you used."}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "edited": false, "score": 1, "creation_date": 1574879739, "post_id": 59072568, "comment_id": 104390339, "body": "What OS?  On Windows you need to explicitly export the function from the DLL, e.g.<code>__declspec(dllexport) double root(double num)</code>."}], "owner": {"reputation": 51, "user_id": 12361032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1818738a71de793df7e8ebd90538706?s=128&d=identicon&r=PG&f=1", "display_name": "rak", "link": "https://stackoverflow.com/users/12361032/rak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574865443, "creation_date": 1574865443, "question_id": 59072568, "link": "https://stackoverflow.com/questions/59072568/ctypes-implementation-in-python", "title": "Ctypes implementation in Python", "body": "<p>I am trying to implement a small example for using ctypes in Python. Below are the source code of the files.</p>\n\n<p>project structure:</p>\n\n<pre><code>parent\n  |____src\n        |___sqrt.c\n        |___sqrt.h\n  |____build\n        |___sum.dll\n  |____bin.py\n</code></pre>\n\n<p>bin.py</p>\n\n<pre><code>from ctypes import *\nfrom ctypes.util import find_library\n\n\ndef main():\n    a = 6;\n    lib_path = os.path.join(os.path.dirname(__file__), 'bbbb', 'Debug','{}.dll'.format(\"sum\"))\n    print(lib_path)\n    try:\n        lib = cdll.LoadLibrary(lib_path)\n    except Exception as e:\n        raise RuntimeError(\"Could not load funnel library with this path: {}. {}\".format(lib_path, e))\n\n    lib.root.argtypes= [c_double]\n    lib.root.restype = c_double\n    try:\n        ret = lib.root(a)\n    except Exception as e:\n        raise RuntimeError(\"Library call raises exception: {}\".format(e)) \n\n    print(ret)\n\nif __name__ == \"__main__\":\n    main()\n\n</code></pre>\n\n<p>sqrt.c</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n#include \"sqrt.h\"\n\ndouble root( double num) {\n    if(num &lt;0){\n        printf(\"Num shoulrnot be less than 0\");\n    return -1;\n    }\n    return sqrt(num);\n    }\n</code></pre>\n\n<p>sqrt.h</p>\n\n<pre><code>#ifndef SUM_H_\n#define SUM_H_\n\n\ndouble root( double num);\n\n#endif\n</code></pre>\n\n<p>But when executed it is showing the following error:</p>\n\n<pre><code>AttributeError: function 'root' not found\n</code></pre>\n\n<p>Can anyone help?</p>\n"}, {"tags": ["c", "function", "pointers"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 4, "creation_date": 1574864121, "post_id": 59072109, "comment_id": 104382139, "body": "What&#39;s <code>RandomReal</code>? What&#39;s <code>low</code> and <code>high</code> ? Where is your <code>main</code> function?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1574864244, "post_id": 59072109, "comment_id": 104382216, "body": "Its better to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  It helps those that would like to help you."}, {"owner": {"reputation": 1, "user_id": 12446291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6381ecf7d9758bde4bee5b4d121b026f?s=128&d=identicon&r=PG&f=1", "display_name": "csnoob", "link": "https://stackoverflow.com/users/12446291/csnoob"}, "edited": false, "score": 0, "creation_date": 1574864246, "post_id": 59072109, "comment_id": 104382219, "body": "RandomReal allocates random float values to the array. low and high are the range between those float values."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1574864251, "post_id": 59072109, "comment_id": 104382227, "body": "Welcome to Stack Overflow. Please read <a href=\"http://stackoverflow.com/help\">the help pages</a>, take <a href=\"http://stackoverflow.com/tour\">the SO tour</a>, read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Lastly please learn how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574864263, "post_id": 59072109, "comment_id": 104382232, "body": "@csnoob don&#39;t describe your code, show it."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1574864385, "post_id": 59072109, "comment_id": 104382305, "body": "Maybe <code>*arr = RandomReal(low, high);</code> -&gt; <code>*(arr + i) = RandomReal(low, high);</code> and <code>printf(&quot;%.1f &quot;, *arr);</code>. -&gt; <code>printf(&quot;%.1f &quot;, *(arr + i));</code> It&#39;s just a guess, there might be more problems elsewhere in some code you didn&#39;t show."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1574864388, "post_id": 59072109, "comment_id": 104382309, "body": "For a pointer or array <code>arr</code>, <code>*arr</code> is equal to <code>arr[0]</code>. The loop assigns your random value to the same element, leaving the others possibly uninitialized and with indeterminate values."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1574864481, "post_id": 59072109, "comment_id": 104382358, "body": "General hint: instead of writing <code>*(arr + i)</code> you should rather write <code>arr[i]</code>, both do exactly the same thing, but latter is more readable for human beings."}, {"owner": {"reputation": 1, "user_id": 12446291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6381ecf7d9758bde4bee5b4d121b026f?s=128&d=identicon&r=PG&f=1", "display_name": "csnoob", "link": "https://stackoverflow.com/users/12446291/csnoob"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1574866874, "post_id": 59072109, "comment_id": 104383828, "body": "Thank you @Someprogrammerdude, this was the fix. the question got answered using the information provided. Wouldn&#39;t that mean it was a decently formulated question?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12446291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6381ecf7d9758bde4bee5b4d121b026f?s=128&d=identicon&r=PG&f=1", "display_name": "csnoob", "link": "https://stackoverflow.com/users/12446291/csnoob"}, "edited": false, "score": 0, "creation_date": 1574865596, "post_id": 59072323, "comment_id": 104383060, "body": "Yes, this fixed it. Changed *arr to arr[i]. Thank you for your help!"}], "tags": [], "owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "is_accepted": false, "score": 0, "last_activity_date": 1574864687, "creation_date": 1574864687, "answer_id": 59072323, "question_id": 59072109, "link": "https://stackoverflow.com/questions/59072109/i-want-to-access-and-sum-the-values-of-a-pointer-array-but-i-get-the-wrong-valu/59072323#59072323", "title": "I want to access and sum the values of a pointer array, but I get the wrong values", "body": "<p>You don't increment pointer <code>arr</code> in the initialisation loop. Only the first <code>float</code> at the addresse pointed by <code>arr</code> is written.</p>\n"}], "owner": {"reputation": 1, "user_id": 12446291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6381ecf7d9758bde4bee5b4d121b026f?s=128&d=identicon&r=PG&f=1", "display_name": "csnoob", "link": "https://stackoverflow.com/users/12446291/csnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1574864687, "creation_date": 1574863981, "question_id": 59072109, "link": "https://stackoverflow.com/questions/59072109/i-want-to-access-and-sum-the-values-of-a-pointer-array-but-i-get-the-wrong-valu", "title": "I want to access and sum the values of a pointer array, but I get the wrong values", "body": "<p>In my program the user allocates a number of random float values to a pointer array.\nAfter that I wish to use the values generated in the array in a function to calculate the mean-value, but I dont get the correct values</p>\n\n<p>This is what I use to allocate random float numbers to the pointer *arr</p>\n\n<pre><code>for (int i = 0; i &lt; antalVarde; i++)\n    {\n        if (i % 10 == 0)\n            printf(\"\\n\");\n\n        *arr = RandomReal(low, high);\n        printf(\"%.1f \", *arr);\n    }\n</code></pre>\n\n<p>And this is my function to calculate the mean-value.</p>\n\n<pre><code>float mean(int antalVarde, float *arr)\n{\n    float medel = 0.0;\n    for (int i = 0; i &lt; antalVarde; i++)\n    {\n        medel = medel + *(arr + i);\n    }\n    medel = medel / antalVarde;\n    return medel;\n}\n</code></pre>\n\n<p>When I debug while stepping-into the code it gets messed up when I get to </p>\n\n<pre><code>medel = medel + *(arr + i);\n</code></pre>\n\n<p>Can this not be used to access the values in a pointer array?</p>\n\n<p>Forgive me if it's a poorly asked question.\ngrateful for answers.</p>\n"}, {"tags": ["c", "imagemagick", "magickwand"], "answers": [{"tags": [], "owner": {"reputation": 20869, "user_id": 438117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dec2e8d45b1a0210065d1a4e3800f151?s=128&d=identicon&r=PG", "display_name": "emcconville", "link": "https://stackoverflow.com/users/438117/emcconville"}, "is_accepted": true, "score": 1, "last_activity_date": 1574873012, "creation_date": 1574873012, "answer_id": 59074865, "question_id": 59071770, "link": "https://stackoverflow.com/questions/59071770/get-binary-data-from-image-using-magick-wand-api/59074865#59074865", "title": "Get binary data from image using Magick Wand API", "body": "<p>The second parameter to <code>base64()</code> should be <code>length</code>, not the return value of <code>strlen()</code>.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>/* Encode base64 */\nencbuffer = base64(buffer, length, &amp;flen); \n</code></pre>\n"}], "owner": {"reputation": 132, "user_id": 11633464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb13d27fb20606ae0f2530aec2f52ee?s=128&d=identicon&r=PG&f=1", "display_name": "hw-135", "link": "https://stackoverflow.com/users/11633464/hw-135"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 59074865, "answer_count": 1, "score": 0, "last_activity_date": 1574873012, "creation_date": 1574862798, "last_edit_date": 1574864270, "question_id": 59071770, "link": "https://stackoverflow.com/questions/59071770/get-binary-data-from-image-using-magick-wand-api", "title": "Get binary data from image using Magick Wand API", "body": "<p>I am trying to get an image in binary data so that I can base64 encode it. I am using the <code>MagickGetImageBlob()</code> of the Magick Wand API but the Blob I am receiving does not contain the entire information.</p>\n\n<p>My code is as follows. <code>opt</code> and <code>enc</code> are two structs containing user provided parameters and encoding information respectively. The library I am using to encode in base64 is <a href=\"https://github.com/superwills/NibbleAndAHalf\" rel=\"nofollow noreferrer\">this</a>. </p>\n\n<pre><code>void WriteImg(UserDefinedOptions *options, MyStruct *enc, char *format){\n\n    MagickWand *wand;\n    char *outputPath;\n    unsigned char *buffer = malloc(sizeof(char)*1000);\n    size_t length;\n    int flen;\n\n    MagickWandGenesis();\n\n    wand = NewMagickWand();\n\n    MagickConstituteImage(wand, enc-&gt;image-&gt;width, enc-&gt;image-&gt;height,\n            \"RGB\", CharPixel, enc-&gt;image-&gt;pxl);\n\n    MagickSetImageResolution(wand, (double) options-&gt;dpi, (double) options-&gt;dpi);\n    MagickSetImageUnits(wand, PixelsPerInchResolution);\n\n    MagickSetImageFormat(wand, format);\n\n    outputPath = (options-&gt;outputPath == NULL) ? \"-\" : options-&gt;outputPath;\n\n    MagickWriteImage(wand, outputPath);  // This works and generates correct image\n\n\n    buffer = MagickGetImageBlob(wand, &amp;length); // Incomplete binary data\n    /* Encode base64 */\n    encbuffer = base64(buffer, strlen((const char *)buffer), &amp;flen);    \n    printf(\"Base64:%s\\n\", encbuffer);  \n\n    CleanupMagick(&amp;wand, DmtxFalse);\n\n    MagickWandTerminus();\n\n}\n</code></pre>\n\n<p>What am I doing wrong? Is there a better way to get the base64 encoded string from the image using Magick Wand?</p>\n"}, {"tags": ["c", "optimization", "gdb", "dwarf"], "comments": [{"owner": {"reputation": 301, "user_id": 4287117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec64f958fb4cc3f79c4b7677670d0811?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/4287117/siddharth"}, "edited": false, "score": 2, "creation_date": 1574862691, "post_id": 59071606, "comment_id": 104381262, "body": "You are optimising it out. You can try compiling with -O0, then gdb will obey."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1574863209, "post_id": 59071606, "comment_id": 104381567, "body": "<i>&quot;...The variable foo must exist somewhere but how do I find its value or where it is stored?...&quot;</i>: you are going to need to use the assembly view of your code and read the docs on your platforms calling conventions."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1574864544, "post_id": 59071606, "comment_id": 104382395, "body": "&quot;The variable foo must exist somewhere&quot; for a <i>very</i> loose definition of &quot;must&quot;. There is no requirement for such a thing anywhere."}, {"owner": {"reputation": 29251, "user_id": 72178, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/M3OuM.png?s=128&g=1", "display_name": "ks1322", "link": "https://stackoverflow.com/users/72178/ks1322"}, "edited": false, "score": 0, "creation_date": 1574867412, "post_id": 59071606, "comment_id": 104384127, "body": "Could not reproduce <code>&lt;optimized out&gt;</code>. What version of gcc did you use?"}], "answers": [{"comments": [{"owner": {"reputation": 8404, "user_id": 204555, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b37ef26e3e3302e1e9629237dfe2f274?s=128&d=identicon&r=PG", "display_name": "Spongman", "link": "https://stackoverflow.com/users/204555/spongman"}, "edited": false, "score": 0, "creation_date": 1616695732, "post_id": 59072475, "comment_id": 118090929, "body": "not all compiler have this deficiency. MSVC, for example emits register-lifting information for symbols in optimized code so the debugger <i>can</i> display values even when they don&#39;t exist in memory. it also emits significantly better code-motion information so it&#39;s much easier to set breakpoints in optimized code. it&#39;s not perfect, but it&#39;s not completely useless like gcc."}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 1, "last_activity_date": 1574865139, "creation_date": 1574865139, "answer_id": 59072475, "question_id": 59071606, "link": "https://stackoverflow.com/questions/59071606/in-gdb-my-variable-shows-as-optimised-out-how-can-i-find-its-value/59072475#59072475", "title": "In gdb my variable shows as &lt;optimised out&gt;, how can I find its value?", "body": "<blockquote>\n  <p>The variable foo must exist somewhere</p>\n</blockquote>\n\n<p>Not necessarily. The compiler may instead store some value <em>derived</em> from the variable (e.g. <code>foo+1</code> or <code>foo-23</code>) if it's convenient.</p>\n\n<p>In this particular case, since <code>foo</code> is being passed to <code>printf</code>, you can discover it in a register or on the stack if you know the calling convention for your particular platform.</p>\n\n<blockquote>\n  <p>but how do I find its value or where it is stored?</p>\n</blockquote>\n\n<p>Debugging optimized code currently requires significant skill, knowledge of the ABI and the assembly instructions used.</p>\n\n<p>The problem is that compilers rarely <em>accurately</em> track values through their in-register and in-memory locations for debugging purposes, because doing so is quite hard.</p>\n\n<p>Debuggers also have to correctly interpret the debugging info which compilers produce, and that isn't an easy or bug-free process either.</p>\n\n<p>GCC recently had a lot of improvement in that area. Using <code>gcc (GCC) 9.2.1 20190827 (Red Hat 9.2.1-1)</code> from Fedora 31 on Linux x86_64, I observe this:</p>\n\n<pre><code>(gdb) start\nTemporary breakpoint 1 at 0x401050: file t.c, line 6.\nStarting program: /tmp/a.out \nMissing separate debuginfos, use: dnf debuginfo-install glibc-2.30-5.fc31.x86_64\n\nTemporary breakpoint 1, main () at t.c:6\n6       int foo = rand();\n(gdb) n\n7       printf(\"foo is %d\\n\", foo++);\n(gdb) p foo\n$1 = 1804289384\n(gdb) p &amp;foo\nCan't take address of \"foo\" which isn't an lvalue.\n(gdb) c\nContinuing.\nfoo is 1804289383\n[Inferior 1 (process 2696) exited with code 0150]\n(gdb) q\n</code></pre>\n\n<p>Here you can see that <code>gcc</code> described the location of <code>foo</code> in a register (or some other location that isn't memory), and GDB was able to print <em>almost</em> the value of <code>foo</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1574865416, "creation_date": 1574865416, "answer_id": 59072557, "question_id": 59071606, "link": "https://stackoverflow.com/questions/59071606/in-gdb-my-variable-shows-as-optimised-out-how-can-i-find-its-value/59072557#59072557", "title": "In gdb my variable shows as &lt;optimised out&gt;, how can I find its value?", "body": "<blockquote>\n  <p>The variable foo must exist somewhere</p>\n</blockquote>\n\n<p>There is no requirement that it should exist. C++ operates on the <a href=\"https://en.m.wikipedia.org/wiki/As-if_rule\" rel=\"nofollow noreferrer\">as-if</a> principle. The program works as if the variable exists. If the compiler can get away with throwing your variable out of the window, while adhering to the as-if principle, expect it to do so eagerly. This is the very essence of optimisation. If you don't like it, don't use optimisation. For extra double strong protection, declare the variable of interest <code>volatile</code>.</p>\n\n<blockquote>\n  <p>how do I find its value or where it is stored</p>\n</blockquote>\n\n<p>It does not have to be <em>stored</em> anywhere. In this case you can find its <em>value</em> by looking at the output of the program and/or examining its exit status. There is no general method to deternine which register an optimised-out variable gets assigned. There may or may not be such a register, depending on the exact details of your program. The value and the computation that leads to it might well be optimised away together with the storage. (Not in this case because the value is visible from the outside).</p>\n"}, {"tags": [], "owner": {"reputation": 4513, "user_id": 1810087, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/T2x51.jpg?s=128&g=1", "display_name": "user1810087", "link": "https://stackoverflow.com/users/1810087/user1810087"}, "is_accepted": false, "score": 0, "last_activity_date": 1574867190, "last_edit_date": 1574867190, "creation_date": 1574866718, "answer_id": 59072983, "question_id": 59071606, "link": "https://stackoverflow.com/questions/59071606/in-gdb-my-variable-shows-as-optimised-out-how-can-i-find-its-value/59072983#59072983", "title": "In gdb my variable shows as &lt;optimised out&gt;, how can I find its value?", "body": "<h2>Not a general answer, but should work with your example.</h2>\n\n<p>Also as Employed Russian mentioned in his answer, debugging optimized code can become very tricky!</p>\n\n<p>However, since foo is initialized with <code>rand()</code> it actually should not be fully optimized away. (Also since you are mentioning gdb I asume you are using some Linux?! - actually should be irrelevant) <code>foo</code> should be optimized into some registers. <code>cdecl</code> specifies returning integers via EAX register on x86 Platforms. Thus, while running your application, inspect the registers.</p>\n\n<ol>\n<li><code>break main</code></li>\n<li>(optional) enable assembler view: <code>layout asm</code></li>\n<li><code>next</code> until rand() has returned and initialized foo. At this point you should see some <em>indications</em> which registers are used in the assembler view.</li>\n<li><code>info registers eax</code> should give you the value of foo.</li>\n</ol>\n\n<p>With your code and compiler options I am getting the following result.\n<a href=\"https://i.stack.imgur.com/sGPOM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sGPOM.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 61, "user_id": 11777056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f28910b78bb19344d351a6eaac01f13?s=128&d=identicon&r=PG&f=1", "display_name": "WorldGeek", "link": "https://stackoverflow.com/users/11777056/worldgeek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 1, "answer_count": 3, "score": 6, "last_activity_date": 1574867190, "creation_date": 1574862255, "last_edit_date": 1574865735, "question_id": 59071606, "link": "https://stackoverflow.com/questions/59071606/in-gdb-my-variable-shows-as-optimised-out-how-can-i-find-its-value", "title": "In gdb my variable shows as &lt;optimised out&gt;, how can I find its value?", "body": "<p>In gdb how can I discover the value of a variable which displays as <em>optimized out</em>?\nPresumably the value is being stored in a register, how can I find out which one?\nGiven this simple program (copied from the website named below).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    int foo = rand();\n    printf(\"foo is %d\\n\", foo++);\n    return foo;\n}\n</code></pre>\n\n<p>Compile with optimization.</p>\n\n<pre><code>gcc -O3 -g optimized.c\ngdb a.out\n</code></pre>\n\n<p>Run GDB</p>\n\n<pre><code>(gdb) print foo\n$1 = &lt;optimized out&gt;\n</code></pre>\n\n<p>What is going on? The variable <code>foo</code> must exist somewhere but how do I find its value or where it is stored?</p>\n\n<p>I found a page which explains in detail how the DWARF debug information works for optimized code <a href=\"https://undo.io/resources/gdb-watchpoint/build-for-debug-in-gdb\" rel=\"nofollow noreferrer\">https://undo.io/resources/gdb-watchpoint/build-for-debug-in-gdb</a>. Using the suggestions there I could eventually find the register assigned to <code>foo</code> but it's rather painful.</p>\n\n<p>How can I get gdb to tell me which register to watch?</p>\n\n<p>I tried compiling with -g3 but that didn't help.</p>\n\n<p>I tried a few commands in gdb which also didn't help.</p>\n\n<pre><code>ptype foo\ninfo locals\nprint &amp;foo\n</code></pre>\n"}, {"tags": ["c", "sockets", "networking", "udp"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 2, "creation_date": 1574862496, "post_id": 59071571, "comment_id": 104381141, "body": "Just refer to the <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/recv.html\" rel=\"nofollow noreferrer\"><code>recv</code></a> reference. Ie. you get the payload. The UDP protocol is handled for you."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1574862519, "post_id": 59071571, "comment_id": 104381157, "body": "If you want to know where the packet came from, there is <code>recvfrom</code> available in addition to <code>recv</code> function."}, {"owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "edited": false, "score": 1, "creation_date": 1574864429, "post_id": 59071571, "comment_id": 104382329, "body": "Socket returns a file descriptor which later on could be used to receive data using system calls , the datagram sockets would use sendto , receivefrom for sending/receiving , the logic for getting specific prtotocol is in implemented there, there you need to pass the socket descriptor"}, {"owner": {"reputation": 10928, "user_id": 1358308, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d9448dee25fd2278def77cb7f0353574?s=128&d=identicon&r=PG", "display_name": "Sam Mason", "link": "https://stackoverflow.com/users/1358308/sam-mason"}, "edited": false, "score": 0, "creation_date": 1574871001, "post_id": 59071571, "comment_id": 104386084, "body": "<a href=\"https://linux.die.net/man/7/ip\" rel=\"nofollow noreferrer\"><code>man 7 ip</code></a> is also a good reference for this sort of stuff if you&#39;re on a Linux/POSIX system"}], "answers": [{"comments": [{"owner": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "edited": false, "score": 0, "creation_date": 1574864630, "post_id": 59072132, "comment_id": 104382448, "body": "so it depends if I use recv or recvfom"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "edited": false, "score": 3, "creation_date": 1574865515, "post_id": 59072132, "comment_id": 104383011, "body": "@Maicake There may be a misunderstanding here.  Neither <code>recv</code> nor <code>recvfrom</code> will return the UDP header in the data.  <code>recvfrom</code> gives you the parsed source address via a separate channel.  If you want to read and parse the UDP header yourself, you have to open the socket in &quot;raw&quot; mode, I think.  (Perhaps <code>SOCK_RAW</code> instead of <code>SOCK_DGRAM</code>.)"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "edited": false, "score": 0, "creation_date": 1574866387, "post_id": 59072132, "comment_id": 104383523, "body": "@Maicake - I believe Steve Summit is correct.  If you are interested in how to use (access) UDP header information, <a href=\"https://www.winsocketdotnetworkprogramming.com/winsock2programming/winsock2advancedrawsocket11c.html\" rel=\"nofollow noreferrer\">here is a tutorial discussing the topic</a>  (and I have removed my previous comment as it was a misleading response to your comment.)"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1574866782, "post_id": 59072132, "comment_id": 104383759, "body": "@SteveSummit - Your comment is correct.  Thank you for pointing that out."}, {"owner": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1574866808, "post_id": 59072132, "comment_id": 104383771, "body": "ok @SteveSummit so we agree that if I use an AF_PACKET socket with SOCK_RAW type I can read link level header information. If I use AF_INET  family socket I can just access the payload of the received UDP/TCP segment. That&#39;s because the packet travels more up through the network protocol stack. Correct me if I&#39;m wrong"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "edited": false, "score": 1, "creation_date": 1574868199, "post_id": 59072132, "comment_id": 104384576, "body": "@Maicake - Your original post was not clear that you wanted to know how to access the header information. It rather implied you just wanted to know <i>what exactly does a udp socket receive?</i>. (Which is what I responded to.) It might help if you would edit your question to clarify that point."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": true, "score": 1, "last_activity_date": 1574868182, "last_edit_date": 1574868182, "creation_date": 1574864068, "answer_id": 59072132, "question_id": 59071571, "link": "https://stackoverflow.com/questions/59071571/what-exactly-does-a-udp-socket-receive/59072132#59072132", "title": "What exactly does a udp socket receive?", "body": "<p>What you can or cannot access depends on how the socket is created.  </p>\n\n<p>Here is a comment in the docs relevant to your question:</p>\n\n<blockquote>\n  <p>The recv() function shall receive a message from a connection-mode or\n  connectionless-mode socket. It is normally used with connected sockets\n  because <strong><em>it does not permit the application to retrieve the source\n  address of received data</em></strong>.    </p>\n</blockquote>\n\n<p>(emphasis mine)  </p>\n\n<p><em><a href=\"https://pubs.opengroup.org/onlinepubs/009695399/functions/recv.html\" rel=\"nofollow noreferrer\">read more here</a></em>...</p>\n\n<p><em>Edit</em>:  If accessing header information is what you want to do, read this and the following link.  </p>\n\n<blockquote>\n  <p>...You cannot create a raw socket with IPPROTO_UDP and manipulate the UDP header; likewise with TCP. To manipulate the IP header as well as\n  either the TCP or UDP header (or any other protocol encapsulated in\n  IP), you must use the IP_HDRINCL socket option with a raw socket. ...</p>\n</blockquote>\n\n<p>Read <a href=\"https://www.winsocketdotnetworkprogramming.com/winsock2programming/winsock2advancedrawsocket11c.html\" rel=\"nofollow noreferrer\">more on the topic</a>...</p>\n"}], "owner": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "accepted_answer_id": 59072132, "answer_count": 1, "score": 0, "last_activity_date": 1574868182, "creation_date": 1574862118, "question_id": 59071571, "link": "https://stackoverflow.com/questions/59071571/what-exactly-does-a-udp-socket-receive", "title": "What exactly does a udp socket receive?", "body": "<pre><code>  #include &lt;sys/socket.h&gt;\n  #include &lt;netinet/in.h&gt;\n  #include &lt;netinet/udp.h&gt;\n\n  udp_socket = socket(AF_INET, SOCK_DGRAM, 0);\n</code></pre>\n\n<p>when I use an UDP socket, do I receive just the payload or also the UDP header? </p>\n"}, {"tags": ["c", "bit-fields"], "comments": [{"owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574860925, "post_id": 59071101, "comment_id": 104380239, "body": "sorry. it was a mistake. Have corrected it now"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1574861017, "post_id": 59071101, "comment_id": 104380295, "body": "There&#39;s really no way besides a loop and setting bits in <code>mybitfield</code>. That&#39;s because individual bits can&#39;t be addressed."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1574861111, "post_id": 59071101, "comment_id": 104380354, "body": "Order of bits is ambigious. Is <code>myArray[0]</code> bit 1 or bit 7? (Assuming LSB is bit 0)"}, {"owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "edited": false, "score": 0, "creation_date": 1574861319, "post_id": 59071101, "comment_id": 104380475, "body": "Had corrected now the order. So myArray[0] is the Most Significant Bit. In the example above it is the &quot;1&quot;"}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574872920, "post_id": 59071101, "comment_id": 104387109, "body": "Ironically C is the preferred language for embedded, while not even having the concept of bit"}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1574861206, "creation_date": 1574861206, "answer_id": 59071294, "question_id": 59071101, "link": "https://stackoverflow.com/questions/59071101/pushing-boolean-values-of-an-array-to-uint8-bitfield/59071294#59071294", "title": "Pushing boolean values of an array to uint8 bitfield", "body": "<p>With <code>myArray</code> being some generic integer type, there's really no other way than to iterate across all items in the array, if TRUE then set bit <code>i</code> with <code>bitfield |= 1u &lt;&lt; i;</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "edited": false, "score": 0, "creation_date": 1575016261, "post_id": 59071496, "comment_id": 104434775, "body": "Thank you for the answer!  I&#39;m interested to know what operation is needed if I want to set the last element of array as the Most Significant bit in this case?"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "reply_to_user": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "edited": false, "score": 0, "creation_date": 1575034443, "post_id": 59071496, "comment_id": 104443278, "body": "@JohnDoe Iterate over the array in reverse order. Or remove the <code>&lt;&lt;= 1</code> shift, and instead shift the bit you set, i.e., <code>bitfield |= (myArray[i] ? 1U : 0U) &lt;&lt; i</code>."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "reply_to_user": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "edited": false, "score": 0, "creation_date": 1575034615, "post_id": 59071496, "comment_id": 104443375, "body": "(You can also remove the ternary operator <code>?:</code> if <code>TRUE</code> is <code>1</code> and <code>FALSE</code> is <code>0</code>.)"}], "tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": true, "score": 1, "last_activity_date": 1574861853, "creation_date": 1574861853, "answer_id": 59071496, "question_id": 59071101, "link": "https://stackoverflow.com/questions/59071101/pushing-boolean-values-of-an-array-to-uint8-bitfield/59071496#59071496", "title": "Pushing boolean values of an array to uint8 bitfield", "body": "<p>As already noted, you have to iterate over the bits individually, for example:</p>\n\n<pre><code>int myArray[7] = {TRUE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE};\n\nuint8_t bitfield = 0;\nfor (int i = 0; i &lt; 7; ++i) {\n    bitfield |= myArray[i] ? 1 : 0;\n    bitfield &lt;&lt;= 1;\n}\n</code></pre>\n\n<p>This results in <code>0b10011000</code>, i.e., the array has the most significant bit first and an implicit zero for the least significant bit.</p>\n"}], "owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 59071496, "answer_count": 2, "score": 1, "last_activity_date": 1574861853, "creation_date": 1574860545, "last_edit_date": 1574861247, "question_id": 59071101, "link": "https://stackoverflow.com/questions/59071101/pushing-boolean-values-of-an-array-to-uint8-bitfield", "title": "Pushing boolean values of an array to uint8 bitfield", "body": "<p>Let's suppose I have:</p>\n\n<pre><code>myArray[7] = {TRUE,FALSE,FALSE,TRUE,TRUE,FALSE,FALSE}\n\nuint8 mybitfield;\n</code></pre>\n\n<p>What is the most efficient way to \"push\" those values to an uint8 bitfield with <code>0=FALSE</code>, <code>1=TRUE</code></p>\n\n<p>So that <em>mybitfield</em> is represented as: </p>\n\n<pre><code>[1,0,0,1,1,0,0,0] \n</code></pre>\n\n<p>(The Least Significant Bit is not considered and will be always 0).</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "fork", "child-process"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1574860295, "post_id": 59070992, "comment_id": 104379895, "body": "And what is the value of errno?"}, {"owner": {"reputation": 4242, "user_id": 2903371, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b51033cda71617323ee74389bd6715a9?s=128&d=identicon&r=PG&f=1", "display_name": "patrik", "link": "https://stackoverflow.com/users/2903371/patrik"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1574860380, "post_id": 59070992, "comment_id": 104379942, "body": "@KamilCuk errno? Do you mean the error code of execv? Would this no be rc? Or better question, using the errno.h, how would this solve things practically?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1574860868, "post_id": 59070992, "comment_id": 104380210, "body": "It&#39;s not safe to call <code>exit()</code> after a failed <code>exec()</code> in a child process.  One of the things <code>exit()</code> does is flush all buffered streams, and since the child process is a copy of the parent process and contains a copy of any data that the parent had buffered when <code>fork()</code> was called, the <b>child</b> process will then flush that data into the <b>parent&#39;s</b> files.  You need to call the POSIX <code>_exit()</code> or standard C <code>_Exit()</code> function instead."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1574861152, "post_id": 59070992, "comment_id": 104380371, "body": "From <a href=\"https://linux.die.net/man/3/execv\" rel=\"nofollow noreferrer\">man execv</a>: <code>The return value is -1, and errno is set to indicate the error.</code> errno is set to indicate the error. Och, I see the edit. But you have to reap the child no matter if you call execv or not, not to create a zombie."}], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 4287117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec64f958fb4cc3f79c4b7677670d0811?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/4287117/siddharth"}, "edited": false, "score": 0, "creation_date": 1574861020, "post_id": 59071225, "comment_id": 104380298, "body": "was the printf in the if(rc == -1) getting executed?"}, {"owner": {"reputation": 4242, "user_id": 2903371, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b51033cda71617323ee74389bd6715a9?s=128&d=identicon&r=PG&f=1", "display_name": "patrik", "link": "https://stackoverflow.com/users/2903371/patrik"}, "edited": false, "score": 0, "creation_date": 1574861515, "post_id": 59071225, "comment_id": 104380596, "body": "Yes, the printout got executed. As I said, the parent process seems to wait for the sigterm signal when execv fails, but not when it worked. It is not a problem for my app if the script dies. These are two separate behaviors managing themselves."}, {"owner": {"reputation": 4242, "user_id": 2903371, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b51033cda71617323ee74389bd6715a9?s=128&d=identicon&r=PG&f=1", "display_name": "patrik", "link": "https://stackoverflow.com/users/2903371/patrik"}, "edited": false, "score": 0, "creation_date": 1574862057, "post_id": 59071225, "comment_id": 104380910, "body": "Also, the zombies occurs when the progam fails to start. Generally I would assume all child processes would create zombies, but for some reason there are none when execv starts."}, {"owner": {"reputation": 301, "user_id": 4287117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec64f958fb4cc3f79c4b7677670d0811?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/4287117/siddharth"}, "reply_to_user": {"reputation": 4242, "user_id": 2903371, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b51033cda71617323ee74389bd6715a9?s=128&d=identicon&r=PG&f=1", "display_name": "patrik", "link": "https://stackoverflow.com/users/2903371/patrik"}, "edited": false, "score": 0, "creation_date": 1574862374, "post_id": 59071225, "comment_id": 104381064, "body": "In that case, I think, _exit(0) should take care of it instead of exit (0); Worth a try?"}, {"owner": {"reputation": 4242, "user_id": 2903371, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b51033cda71617323ee74389bd6715a9?s=128&d=identicon&r=PG&f=1", "display_name": "patrik", "link": "https://stackoverflow.com/users/2903371/patrik"}, "edited": false, "score": 0, "creation_date": 1574863415, "post_id": 59071225, "comment_id": 104381702, "body": "Actually, when a child process dies it will remain in the process table until the parent have collected the exit status (<a href=\"https://www.geeksforgeeks.org/zombie-processes-prevention/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/zombie-processes-prevention</a>). I did not know this at first, but know now. About the execv, it seems as if the process called using execv gets detached somehow (as it keeps running if the parent is killed)."}], "tags": [], "owner": {"reputation": 301, "user_id": 4287117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec64f958fb4cc3f79c4b7677670d0811?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/4287117/siddharth"}, "is_accepted": false, "score": 0, "last_activity_date": 1574862441, "last_edit_date": 1574862441, "creation_date": 1574861002, "answer_id": 59071225, "question_id": 59070992, "link": "https://stackoverflow.com/questions/59070992/why-does-a-process-create-a-zombie-if-execv-fails-but-not-if-execv-is-successfu/59071225#59071225", "title": "Why does a process create a zombie if execv fails, but not if execv is successful and terminates?", "body": "<p>In this scenario, when the execv fails, the child process is killed. The fun part, I think is what happens when you call exec family of functions.</p>\n\n<p>The exec family of functions replaces the current image of the process with the new image of the binary you are about to exec.</p>\n\n<p>So, whatever code <em>was</em> will not <em>remain</em> - and the error in your script would cause its death.</p>\n\n<p>Here, the parent needs to listen on the death of the child process using wait flavour of functions (read: waitpid).</p>\n\n<p>When you say that there's problem in the script, it means that the execv actually succeeded in creating the new image; but the latter failed of its own accord.</p>\n\n<p>This is what I think is happening...</p>\n\n<p><strong>If the printf of if (rc==-1) is being executed, then perhaps changing exit(0) to _exit(0) should take care of it.</strong></p>\n"}, {"comments": [{"owner": {"reputation": 4242, "user_id": 2903371, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b51033cda71617323ee74389bd6715a9?s=128&d=identicon&r=PG&f=1", "display_name": "patrik", "link": "https://stackoverflow.com/users/2903371/patrik"}, "edited": false, "score": 0, "creation_date": 1574861917, "post_id": 59071370, "comment_id": 104380840, "body": "Thanks Kamil. I will try this. However, I expect it will work. This script may be called several times, but it is supposed to handle itself. So basically I do not need to track the pids."}, {"owner": {"reputation": 4242, "user_id": 2903371, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b51033cda71617323ee74389bd6715a9?s=128&d=identicon&r=PG&f=1", "display_name": "patrik", "link": "https://stackoverflow.com/users/2903371/patrik"}, "edited": false, "score": 0, "creation_date": 1574862522, "post_id": 59071370, "comment_id": 104381158, "body": "Like a charm :). Thanks!"}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 2, "last_activity_date": 1574861447, "creation_date": 1574861447, "answer_id": 59071370, "question_id": 59070992, "link": "https://stackoverflow.com/questions/59070992/why-does-a-process-create-a-zombie-if-execv-fails-but-not-if-execv-is-successfu/59071370#59071370", "title": "Why does a process create a zombie if execv fails, but not if execv is successful and terminates?", "body": "<p>If you don't want to create zombies, your program has to reap zombie processes no matter if they call <code>execv</code> or not call it or no matter if the <code>execv</code> call succeeds. To reap zombie processes \"automagically\" handle SIGCHLD signal:</p>\n\n<pre><code>void handle_sigchld(int sig) {\n    int saved_errno = errno;\n    while (waitpid((pid_t)(-1), 0, WNOHANG) &gt; 0) {}\n    errno = saved_errno;\n}\n\nint main() {\n    signal(SIGCHLD, handle_sigchld);\n    // rest of your program....\n}\n</code></pre>\n\n<p>Inspired (no... ripped off) from: <a href=\"http://www.microhowto.info/howto/reap_zombie_processes_using_a_sigchld_handler.html\" rel=\"nofollow noreferrer\">this link</a>.</p>\n\n<p>Or maybe you want only to reap only this specified child, because later you want to call <code>fork()</code> and handle childs return value. Then pass the returned <code>pid</code> from <code>fork()</code> in your parent to the signal handler and <code>wait</code> on this pid in sigchld if needed (with some checking, ex. if the pid already finished then ignore future SIGCHLD etc...).</p>\n"}], "owner": {"reputation": 4242, "user_id": 2903371, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b51033cda71617323ee74389bd6715a9?s=128&d=identicon&r=PG&f=1", "display_name": "patrik", "link": "https://stackoverflow.com/users/2903371/patrik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 59071370, "answer_count": 2, "score": 0, "last_activity_date": 1574862441, "creation_date": 1574860164, "last_edit_date": 1574860889, "question_id": 59070992, "link": "https://stackoverflow.com/questions/59070992/why-does-a-process-create-a-zombie-if-execv-fails-but-not-if-execv-is-successfu", "title": "Why does a process create a zombie if execv fails, but not if execv is successful and terminates?", "body": "<p>So I am confused by the behavior of my C program. I am using the construct,</p>\n\n<pre><code>int pid = fork();\nif (pid == 0) {\n    if(file_upload_script_path) {\n        rc = execv(file_upload_script_path, args);\n        if(rc == -1) {   \n            printf(\"Error has occured when starting file_upload.exp!\\n\");\n            exit(0);\n        }\n    } else {   \n        printf(\"Error with memory allocation!\\n\");\n    }\n}\nelse {\n    printf(\"pid=%d\\n\", pid);\n}\n</code></pre>\n\n<p>To fork the process and run a script for doing file upload. The script will by itself terminate safely, either by finishing the upload or failing.</p>\n\n<p>Now, there was a problem with the script path, causing <code>execv</code> to fail. Here I noted the child process will terminate successfully if execv finishes, but in case it fails (r==-1) and I exit the process, it will become a zombie. Anyone knows why this happens?</p>\n\n<p>Note here, I know why the child-process becomes a zombie. What I am confused about is why the process not becomes a zombie if execv works.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I got a question about errno and the cause of the error. The cause of the error is known. There were a problem with the build process, so the path of the script were another than expected.</p>\n\n<p>However, this may happen again and I want to make sure my program does not start spawning zombies when it does. The behavoir where zombies are created in some situations and not others are very confusing.</p>\n\n<p>BR\nPatrik</p>\n"}, {"tags": ["c", "segmentation-fault", "binaryfiles", "dynamic-arrays"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11109037"}, "edited": false, "score": 0, "creation_date": 1574858929, "post_id": 59070564, "comment_id": 104379150, "body": "That fixed my seg fault and it works fine for one entry but for two entries I get a blank line and below it &quot;entry one&quot;. I ll accept the answer anyway but would you help with that if you can?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11109037"}, "edited": false, "score": 0, "creation_date": 1574859123, "post_id": 59070564, "comment_id": 104379262, "body": "Actually I tried different entries with different length, and it turns out I get a blank line, and as many letters from the first entry as the second entry had."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1574859127, "post_id": 59070564, "comment_id": 104379265, "body": "@NeedHalp What are the values of <code>end</code> and <code>start</code>? Have you tried checking what <code>read</code> returns (to check for errors or end-of-file)?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11109037"}, "edited": false, "score": 0, "creation_date": 1574859232, "post_id": 59070564, "comment_id": 104379325, "body": "start starts off as zero and then gets the value of end before it is changed. end always has the position of the last character of the entry. If you could point out how I should be checking read I d be thankful, I m just learning it and i cant find it in my textbook."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11109037"}, "edited": false, "score": 0, "creation_date": 1574859370, "post_id": 59070564, "comment_id": 104379387, "body": "I realized start should probably become <code>start = end+1</code> but now I get another letter off when I try to print for two entries."}, {"owner": {"reputation": 263, "user_id": 10996407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WFdQQ.png?s=128&g=1", "display_name": "riverwastaken", "link": "https://stackoverflow.com/users/10996407/riverwastaken"}, "edited": false, "score": 0, "creation_date": 1574862798, "post_id": 59070564, "comment_id": 104381333, "body": "You do not need to edit the value of start it works fine as it is"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 3, "last_activity_date": 1574858698, "creation_date": 1574858698, "answer_id": 59070564, "question_id": 59070488, "link": "https://stackoverflow.com/questions/59070488/seg-fault-while-trying-to-print-data-stored-from-binary-file-into-dynamic-array/59070564#59070564", "title": "Seg fault while trying to print data stored from binary file into dynamic array", "body": "<p>The problem is probably the undefined behavior you get from using <code>&amp;data[i]</code> when reading the file. Since <code>data[i]</code> is a pointer to some data, then <code>&amp;data[i]</code> is a pointer to that pointer, and have the type <code>char **</code>.</p>\n\n<p>Drop the address-of operator and use only <code>data[i]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 263, "user_id": 10996407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WFdQQ.png?s=128&g=1", "display_name": "riverwastaken", "link": "https://stackoverflow.com/users/10996407/riverwastaken"}, "is_accepted": true, "score": 0, "last_activity_date": 1574866237, "last_edit_date": 1574866237, "creation_date": 1574862655, "answer_id": 59071723, "question_id": 59070488, "link": "https://stackoverflow.com/questions/59070488/seg-fault-while-trying-to-print-data-stored-from-binary-file-into-dynamic-array/59071723#59071723", "title": "Seg fault while trying to print data stored from binary file into dynamic array", "body": "<p>As stated in \"Some programmer dude\"'s answer, removing the &amp; from <code>&amp;data[i]</code> will eliminate the seg fault. I saw your comment and I think you are simply not combining the correct parts of your code.</p>\n\n<pre><code>        data = malloc(all_names * sizeof(char*));\n\n        fd=open(argv[1],O_RDWR|O_CREAT,S_IRWXU);\n        for(i=0; i&lt;all_names; i++){\n            data[i] = malloc((MAX_SIZE+1)*sizeof(char));\n\n            int end = atoi(positions[i]);\n            lseek(fd,0,start);\n            read(fd,data[i],(end-start));\n            start = end;\n\n        }\n\n        start = 0;\n        for(i=0; i&lt;all_names; i++){\n            int end = atoi(positions[i]);\n            for(j=0;j&lt;(end-start) ;j++){\n                printf(\"%c\",data[i][j]);\n            }\n            printf(\"\\n\");\n        }\n</code></pre>\n\n<p>This should work just fine.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11109037"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 59071723, "answer_count": 2, "score": 0, "last_activity_date": 1574866237, "creation_date": 1574858478, "question_id": 59070488, "link": "https://stackoverflow.com/questions/59070488/seg-fault-while-trying-to-print-data-stored-from-binary-file-into-dynamic-array", "title": "Seg fault while trying to print data stored from binary file into dynamic array", "body": "<p>I have a binary file that I can view as text that has words in it stored in this way: entry oneentry twoentry three (so seperate entries are consecutive but a single entry can contain two words separated by space)</p>\n\n<p>I have this code: </p>\n\n<pre><code>        char **data;\n        int start = 0;\n\n        data = malloc(all_names * sizeof(char*));\n\n        fd=open(argv[1],O_RDWR|O_CREAT,S_IRWXU);\n        for(i=0; i&lt;all_names; i++){\n            data[i] = malloc((MAX_SIZE+1)*sizeof(char));\n\n            int end = atoi(positions[i]);\n            read(fd,&amp;data[i],(end-start));\n            start = end;\n        }\n\n        for(i=0; i&lt;all_names; i++){\n            printf(\"%s\\n\", data[i]);\n        }\n</code></pre>\n\n<p>Positions array contains the location of the start of every string, apart from the first one. </p>\n\n<p>eg. if positions[0] = 9, that means the first entry had 9 characters, and the first character of the second entry is byte number 9.</p>\n\n<p>I get a segmentation fault that seems to happen right after trying to print the array, but I cannot figure out if it is caused by false printing or the words not being stored correctly in the first place.</p>\n\n<p>Now, I had trouble creating my pos array and asked a similar question <a href=\"https://stackoverflow.com/questions/59036963/store-data-from-binary-file-into-dynamic-array-of-strings\">here</a>. After that being solved and this not working, I tried this version that looks more like the answer I got to my other question:</p>\n\n<pre><code>fd=open(argv[1],O_RDWR|O_CREAT,S_IRWXU);\n    for(i=0; i&lt;all_names; i++){\n        positions[i] =malloc((MAX_SIZE+1)*sizeof(char));\n        int end = atoi(positions[i]);\n\n            for(j=0;j&lt;(end-start) ;j++){\n                read(fd,&amp;data[i][j],1);\n            }\n        data[i][j]=0;\n        printf(\"%s\\n\",data[i]);\n     }\n</code></pre>\n\n<p>And the same code when printing, getting the same seg fault at the same point.</p>\n\n<p>I tried printing character by character:</p>\n\n<pre><code>start = 0;\n        for(i=0; i&lt;all_names; i++){\n            int end = atoi(positions[i]);\n            for(j=0;j&lt;(end-start) ;j++){\n                printf(\"%c\",data[i][j]);\n            }\n            printf(\"\\n\");\n        }\n</code></pre>\n\n<p>Still the same problem. Thanks for any help, and if you feel the need to vote negatively please explain why so I can improve it. If more info is needed I will provide it.</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 2, "creation_date": 1574858461, "post_id": 59070281, "comment_id": 104378888, "body": "This cannot be compiled to test it and we don&#39;t have the input file you are using, but I cannot spot any obvious errors. One possibility is that it&#39;s due to the input, e.g., the file is misformatted or the lines are too long, causing undefined behaviour since you are not limiting the length of the strings being read. I would also suggest replacing the &quot;Something went wrong&quot; <code>printf</code> with <code>perror(&quot;fscanf&quot;)</code>. And please see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">stackoverflow.com/help/minimal-reproducible-example</a>"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 2, "creation_date": 1574858598, "post_id": 59070281, "comment_id": 104378966, "body": "The <code>scanf</code> family functions are only a poor man&#39;s parser. I try hard to not use them for complex or serious processing and <b>never</b> for line oriented input. As your input is line oriented, <code>fgets</code> would be a more robust choice"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574858913, "post_id": 59070281, "comment_id": 104379141, "body": "Post definition of <code>member_node</code>,.  A  <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is even better."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1574863409, "post_id": 59070281, "comment_id": 104381697, "body": "<code>scanf</code> is barely okay for &quot;toy&quot; programs, and not at all for real programs.  Rule of thumb: if you find yourself using <code>%[...]</code>, it&#39;s time to abandon <code>scanf</code> and <a href=\"https://stackoverflow.com/questions/58403537/what-can-i-use-to-parse-input-instead-of-scanf\">learn how to use something better</a>.  It&#39;ll be more functional <i>and</i> easier in the long run."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1574866731, "post_id": 59070281, "comment_id": 104383730, "body": "Please make an MRE, the problem can e.g. easily be within genTree."}], "answers": [{"tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": false, "score": 0, "last_activity_date": 1574893614, "creation_date": 1574893614, "answer_id": 59079273, "question_id": 59070281, "link": "https://stackoverflow.com/questions/59070281/why-does-my-fscanf-seem-to-not-read-anything/59079273#59079273", "title": "Why does my fscanf seem to not read anything?", "body": "<p>I see a problem with your scan codes. The <code>s</code> designating string input seems to be missing.</p>\n\n<p>Try changing </p>\n\n<pre><code>isEnd = fscanf(file, \" %[^\\n] %[^\\n] %d %[^\\n] %[^\\n] %[^\\n]\",\n</code></pre>\n\n<p>into</p>\n\n<pre><code>isEnd = fscanf(file, \" %[^\\n]s %[^\\n]s %d %[^\\n]s %[^\\n]s %[^\\n]s\",\n</code></pre>\n\n<p>You have the same bug in the <code>main()</code> function.</p>\n"}], "owner": {"reputation": 1, "user_id": 12445598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99dd438c76bdb730c74a03dd61d01869?s=128&d=identicon&r=PG&f=1", "display_name": "ijustdontunderstand", "link": "https://stackoverflow.com/users/12445598/ijustdontunderstand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574893614, "creation_date": 1574857760, "last_edit_date": 1574857971, "question_id": 59070281, "link": "https://stackoverflow.com/questions/59070281/why-does-my-fscanf-seem-to-not-read-anything", "title": "Why does my fscanf seem to not read anything?", "body": "<p>I'm trying to make a program in C for reading in lines of text from a file, and creating nodes to build a tree. these nodes are structs. To do this, I'm trying to read six lines at a time. whenever my program gets to the fscanf line however, it doesn't seem to read anything, setting my int to EOF and exiting the function. I've tried a great deal of format combinations, removing and adding spaces, \\n and the like. I've even tried making a separate fscanf line to attempt to read in a single string, and even that seems to scan nothing. I have no idea why this is happening. here's the relevant code:</p>\n\n<pre><code>member_ptr readAndCreate(FILE * file){\n    member_node * temp;\n    temp = calloc(1, sizeof(member_node));\n    //char temp_char_array[50] = {0,0,0,0,0};\n    //char *overflow;\n\n    int isEnd;\n    //isEnd = fscanf(file, \" %s\", temp_char_array);\n\n    //isEnd =\n    isEnd = fscanf(file, \" %[^\\n] %[^\\n] %d %[^\\n] %[^\\n] %[^\\n]\",\n            temp -&gt; family,\n            temp -&gt; personal,\n            &amp;temp -&gt;ID,\n            temp -&gt; email,\n            temp -&gt; boatClass,\n            temp -&gt; boatName\n            );\n\n    //temp-&gt;ID =  (int)strtol(temp_char_array, &amp;overflow, 10);\n    if (isEnd == EOF){\n        printf(\"Something went wrong, please try again \\n\");\n        return NULL;\n    } else {\n        return temp;\n    }\n}\n</code></pre>\n\n<p>and this is the main function</p>\n\n<pre><code>int main() {\n    char pathname[100];\n    FILE * file;\n    member_ptr top;\n    member_ptr temp;\n\n    printf(\"input file path\\n\");\n    scanf(\"%[^\\n]\", pathname);\n    file = fopen(pathname, \"r\");\n\n    if (file == NULL){\n        printf(\"file cannot be found, closing program...\");\n        exit(1);\n    }\n\n    top = readAndCreate(file);\n    genTree(top, file);\n    printOutTree(top);\n\n    printf(\"Hello, World!\\n\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "matrix", "cell"], "comments": [{"owner": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "edited": false, "score": 0, "creation_date": 1574859650, "post_id": 59070251, "comment_id": 104379544, "body": "I didn&#39;t read all your code, but I guess you loop over your grid from top to bottom, and left to right? So, when you change the color you should check the cells above and left. If it&#39;s the old color change it, and recursivly check it&#39;s neighbor."}, {"owner": {"reputation": 17, "user_id": 11396925, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-89wBPTSsTfk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdApAfNQDRbessIGxAcKO4u-ffIew/mo/photo.jpg?sz=128", "display_name": "LightninWolf", "link": "https://stackoverflow.com/users/11396925/lightninwolf"}, "reply_to_user": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "edited": false, "score": 0, "creation_date": 1574860099, "post_id": 59070251, "comment_id": 104379779, "body": "in the provided code i&#39;m just doing a loop form top to bottom, i&#39;ve fixed that adding loop left to right and another top to bottom and it works but as I said I&#39;m really skilled when it comes to recursion even more if it&#39;s recursion through loops"}], "owner": {"reputation": 17, "user_id": 11396925, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-89wBPTSsTfk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdApAfNQDRbessIGxAcKO4u-ffIew/mo/photo.jpg?sz=128", "display_name": "LightninWolf", "link": "https://stackoverflow.com/users/11396925/lightninwolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574859018, "creation_date": 1574857672, "last_edit_date": 1574859018, "question_id": 59070251, "link": "https://stackoverflow.com/questions/59070251/c-how-to-check-if-at-least-one-neighbor-of-a-cell-in-a-matrix-respects-a-predi", "title": "C - How to check if at least one neighbor of a cell in a matrix respects a predication?", "body": "<p>I'm on a project where I have to code a little game named \"recolor\", basically it's grid of a certain size, the grid is divided in cells (we have size*size cells), I can play a color (the color have to be in the grid or in the authorized colors) and each time I'm playing a color the grid will change from the top letf corner to color each cells directly connected to the top left corner that has the same color.\nThat's for the global context, now I already have all the functions to play this game but I have some problems with the function I use to play a move:\nThe game is defined using this type :</p>\n\n<pre><code>struct game_s\n{\n    color **grid;\n    color **initial_grid;\n    uint width;\n    uint height;\n    uint nmb_cur_mv;\n    uint nmb_mv_max;\n};\n</code></pre>\n\n<pre><code>/*\n* Def : \n*   - neighbour_of_origin checks if a cell is in the neighborhood of the (0,0) of the game grid, to be in the neighborhood\n*     the cell should have the same color as the (0,0) and the cell and (0,0) have to be connected by a path of cells that have the same\n*     color as (0,0).\n* Param :\n*   - cgame g : the game grid\n*   - int x, y : coordinates of the cell we are currently checking\n*   - bool** to_change_tab : 2D array of boolean that represent the game grid and have the same size as it. It is used to mark all the cells to\n*                            modify. By default the whole grid is set to false except (0,0) which is changed no matter what.\n* Ret :\n*   - void function, nothing to return.\n*/\nvoid neighbour_of_origin(cgame g, int x, int y, bool **to_change_tab)\n{\n    assert(g);\n    assert(g-&gt;grid);\n    assert(to_change_tab);\n    color origin = g-&gt;grid[0][0];\n    int offset[4][2] = {\n        {-1, 0}, /*W*/\n        {0, 1},  /*S*/\n        {1, 0},  /*E*/\n        {0, -1}  /*N*/\n    };\n    int off_x;\n    int off_y;\n    for (int elem = 0; elem &lt; 4; elem++)\n    {\n        off_x = x + offset[elem][0]; /*takes the 'x' coord in the offset matrix and add it to the current x*/\n        off_y = y + offset[elem][1]; /*takes the 'y' coord in the offset matrix and add it to the current y*/\n        if (((off_x &gt;= 0 &amp;&amp; off_x &lt; SIZE) &amp;&amp; (off_y &gt;= 0 &amp;&amp; off_y &lt; SIZE)) &amp;&amp; (to_change_tab[off_x][off_y] == true) &amp;&amp; (g-&gt;grid[x][y] == origin))\n        {        \n            to_change_tab[x][y] = true;\n            break;\n        }\n    }\n}\n\n/*\n* Def : \n*   - game_play_one_move will change all the cells that are neighbors of the (0,0)that have the same color as it. The changing always begin\n      from the (0,0) and then it expands in all directions.\n* Param :\n*   - game g : the game grid that will be modified.\n*   - color c : the color that will be applied to all the cells we have to change.\n* Ret :\n*   - void function, nothing to return.\n*/\nvoid game_play_one_move(game g, color c)\n{\n    assert(g);\n    assert(g-&gt;grid);\n    bool **to_change_tab = (bool **)malloc(sizeof(bool *) * SIZE);\n    assert(to_change_tab);\n    for (int i = 0; i &lt; SIZE; i++)\n    {\n        to_change_tab[i] = (bool *)malloc(sizeof(bool) * SIZE);\n        assert(to_change_tab[i]);\n        for (int j = 0; j &lt; SIZE; j++)\n        {\n            to_change_tab[i][j] = false;\n        }\n    }\n    /*getting all the cells we have to change*/\n    to_change_tab[0][0] = true; /*(0,0) is always modified */\n    printf(\"mark tab : \\n\");\n    for (int x = 0; x &lt; SIZE; x++)\n    {\n        for (int y = 0; y &lt; SIZE; y++)\n        {\n            neighbour_of_origin(g, x, y, to_change_tab);\n            printf(\"%d \", to_change_tab[x][y]); /*debbuging purpose*/\n        }\n        printf(\"\\n\");\n    }\n    /*modification of the game grid */\n    for (int x = 0; x &lt; SIZE; x++)\n    {\n        for (int y = 0; y &lt; SIZE; y++)\n        {\n            if (to_change_tab[x][y] == true)\n            {\n                g-&gt;grid[x][y] = c;\n            }\n        }\n    }\n    g-&gt;nmb_cur_mv += 1;\n    /*free the temporary array of bools*/\n    for (int x = 0; x &lt; SIZE; x++)\n    {\n        free(to_change_tab[x]);\n        to_change_tab[x] = NULL;\n    }\n    free(to_change_tab);\n    to_change_tab = NULL;\n}\n</code></pre>\n\n<p>above we have the two functions I've made to change the color as described in the rules, It actually works pretty well but I have a big issue on it.</p>\n\n<p>This is my grid at the very begining :\neach number corresponds to a color, the grid is 12*12 cells.</p>\n\n<pre><code>000202101030\n033111132010\n101232320332\n231032111220\n212333320100\n033011233213\n112220013112\n131310101333\n030100211130\n131000323100\n133112232002\n202301112301\n</code></pre>\n\n<p>Here is my grid when I play the following colors : 3 1 3 0</p>\n\n<pre><code>000202101030\n000000002010\n000202020332\n230002111220\n212300020100\n033011233213\n112220013112\n131310101333\n030100211130\n131000323100\n133112232002\n202301112301\n</code></pre>\n\n<p>if I play any color (except 0 of course) as my next move I expect every 0 connected to the top left to change but i got this instead: </p>\n\n<pre><code>333202101030\n333333332010\n333232320332\n233332111220\n212333320100\n033011233213\n112220013112\n131310101333\n030100211130\n131000323100\n133112232002\n202301112301\n</code></pre>\n\n<p>the 0 on the first line didn't changed whereas they were connected to the origin, I suspected that the bug is in my condition in <code>neighbour_of_origin(cgame g, int x, int y, bool **to_change_tab)</code> because i'm using a for on x and y so the first line is evaluated first and the 0 on the first line did not have any neighbor that corresponds to the if condition at this state, is there a way to evaluate  in \"the order of propagation\",I wanted to rewrite it recursively but I'm really bad in recursion.\nVery sorry for the long post, I wish someone could help me, have a good day.</p>\n\n<p>edit : I got a ''''fix'''' I duplicate my for loops in the <code>game_play_one_move()</code> function so it will loop again and again to find each cells he couldn't find before, I know it's not a real fix because in the future i don't know how the grid will be displayed exactly, but i guess that a loop that will check again and again until it can't find any neighbor could be a solution too, in terms of colplexity it would be a real problem since i'm looping in the grid again and again and again</p>\n"}, {"tags": ["c", "pointers", "void"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 4, "creation_date": 1574857638, "post_id": 59070186, "comment_id": 104378410, "body": "Why don&#39;t you return a struct?"}, {"owner": {"reputation": 2127, "user_id": 1819452, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ad224b55add66c22f62380dea203e75?s=128&d=identicon&r=PG", "display_name": "Vroomfondel", "link": "https://stackoverflow.com/users/1819452/vroomfondel"}, "edited": false, "score": 2, "creation_date": 1574857706, "post_id": 59070186, "comment_id": 104378451, "body": "You are allowed to return a struct, but I think most C programmers won&#39;t like this, so your first solution is the one with least surprise IMHO."}, {"owner": {"reputation": 1005, "user_id": 10674275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1710877d569a65bda20b7c7c0865b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Julius", "link": "https://stackoverflow.com/users/10674275/julius"}, "reply_to_user": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1574857710, "post_id": 59070186, "comment_id": 104378452, "body": "@Mat Thanks! That&#39;s another option... however, it still somehow breaks consistency with the rest of the interface which always return the status code :-("}, {"owner": {"reputation": 1005, "user_id": 10674275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1710877d569a65bda20b7c7c0865b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Julius", "link": "https://stackoverflow.com/users/10674275/julius"}, "reply_to_user": {"reputation": 2127, "user_id": 1819452, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ad224b55add66c22f62380dea203e75?s=128&d=identicon&r=PG", "display_name": "Vroomfondel", "link": "https://stackoverflow.com/users/1819452/vroomfondel"}, "edited": false, "score": 0, "creation_date": 1574857776, "post_id": 59070186, "comment_id": 104378485, "body": "@Vroomfondel I like the first one most as well, but it seems to be against the standard :-("}, {"owner": {"reputation": 2127, "user_id": 1819452, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ad224b55add66c22f62380dea203e75?s=128&d=identicon&r=PG", "display_name": "Vroomfondel", "link": "https://stackoverflow.com/users/1819452/vroomfondel"}, "edited": false, "score": 0, "creation_date": 1574857863, "post_id": 59070186, "comment_id": 104378539, "body": "Which standard? The C standard absolutely allows this as long as you touch the object which <code>*output</code> points to with the correct stored .type"}, {"owner": {"reputation": 1005, "user_id": 10674275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1710877d569a65bda20b7c7c0865b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Julius", "link": "https://stackoverflow.com/users/10674275/julius"}, "edited": false, "score": 0, "creation_date": 1574857941, "post_id": 59070186, "comment_id": 104378580, "body": "Hm, true. The problem only arises when casting, e.g. <code>int *myval; myfunc((void **)&amp;myval);</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574859289, "post_id": 59070186, "comment_id": 104379353, "body": "If you want to return 2 things, return 2 things in a <code>struct</code> with 2 members.  If you you don&#39;t like returning a <code>struct</code>, don&#39;t return 2 things."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1574859373, "post_id": 59070186, "comment_id": 104379389, "body": "There shouldn&#39;t be any reason to use a <code>void**</code>. Name one. If your function uses dynamic allocation internally, then return the type allocated through <code>type**</code>."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1574859385, "post_id": 59070186, "comment_id": 104379394, "body": "How many different status codes are you returning?  If you&#39;re just returning success/failure, just return the pointer if you succeed or <code>NULL</code> otherwise.  That&#39;s good enough for <code>malloc()</code>, and <code>fopen()</code>, and ...."}, {"owner": {"reputation": 1005, "user_id": 10674275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1710877d569a65bda20b7c7c0865b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Julius", "link": "https://stackoverflow.com/users/10674275/julius"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1574859740, "post_id": 59070186, "comment_id": 104379589, "body": "@AndrewHenle I&#39;m afraid it&#39;s more than just a sucess/fail"}, {"owner": {"reputation": 1005, "user_id": 10674275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1710877d569a65bda20b7c7c0865b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Julius", "link": "https://stackoverflow.com/users/10674275/julius"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574861178, "post_id": 59070186, "comment_id": 104380393, "body": "@Lundin let&#39;s imagine a &quot;generic&quot; function like calloc but with more status codes than just success/failure?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574861550, "post_id": 59070186, "comment_id": 104380616, "body": "@Julius Such a function should use a character type like <code>uint8_t</code>. It is not really possible to implement malloc safely in standard C because of pointer aliasing."}, {"owner": {"reputation": 1005, "user_id": 10674275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1710877d569a65bda20b7c7c0865b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Julius", "link": "https://stackoverflow.com/users/10674275/julius"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574861846, "post_id": 59070186, "comment_id": 104380793, "body": "@Lundin interesting. even if I was allocating structs with it? could you ellaborate your thoughts why uint8_t is a good fit?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574861880, "post_id": 59070186, "comment_id": 104380814, "body": "<a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">What is the strict aliasing rule?</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1574861924, "post_id": 59070186, "comment_id": 104380844, "body": "&quot;Probably I am overthinking a little.&quot;  No. Its the other way around.   Post lacks definition of <code>status</code> other than &quot;it&#39;s more than just a sucess/fail&quot;.  It could be a 3 value <code>int</code>, a string, a struct, ...  An <i>elegant</i> solution needs far more detail as to what you are trying to do.   As is - this is under-defined.  We could spend a lot a comments (15 so far) teasing out that info.  Instead, consider deleting the post  and later presenting a more clear explanation of the coding goal."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574862741, "post_id": 59070186, "comment_id": 104381291, "body": "@chux-ReinstateMonica I agree, these examples are far too artificial to do anything meaningful with."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1574863440, "post_id": 59070186, "comment_id": 104381715, "body": "This is as opinion based as it gets."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574864610, "post_id": 59070186, "comment_id": 104382432, "body": "Julius This a <b>good</b> question, but not for SO as is - too general.  How to handle passing data  and error info gets to the core of a language.  C offers may ways in addition to this post.  It is just that we have no closing criteria, no  way to cross rate answers given its board scope.  Try focusing on a specific case first."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574862636, "post_id": 59071577, "comment_id": 104381215, "body": "Besides passing structs by value being bad practice, <code>void*</code> is not required to have the same representation as an object pointer. As for the obscure pointer tricks, I&#39;d hardly call that &quot;classic&quot;. Classic quality programming is rather to separate data from error codes, and don&#39;t touch the data at all in case of errors.  Your integer to pointer example is also wildly undefined behavior: you can&#39;t do pointer arithmetic on null pointers, nor on pointers pointing at different objects. If you insist on doing icky things like these, at least convert to an integer type before you do the comparisons."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1574862772, "post_id": 59071577, "comment_id": 104381314, "body": "Classic, as in <i>in active use for decades</i>.   Passing, and returning structs stopped being controversial in C in the 1980s."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574863087, "post_id": 59071577, "comment_id": 104381509, "body": "Yeah C programmers have been invoking undefined behavior for decades. What&#39;s your point? As for passing structs, plenty of embedded system ABIs produce very ineffective code for that in the year 2019. Not every computer is a PC."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1574863174, "post_id": 59071577, "comment_id": 104381547, "body": "Not undefined; if you ride a bus, take a train, ride a plane or drive in a car, you will be running in safety certified kernels that use both of the above techniques."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574863712, "post_id": 59071577, "comment_id": 104381887, "body": "Sorry but there&#39;s just no way in h*** that this code will pass a simple MISRA checker, let alone ASIL certification."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1574863734, "post_id": 59071577, "comment_id": 104381903, "body": "Are you saying that this &quot;hack&quot; is MISRA compliant? Sorry, but that&#39;s a bit scary."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1574864175, "post_id": 59071577, "comment_id": 104382169, "body": "1) <code>(void *)1</code> can fail due to &quot;the result is implementation-defined, might not be correctly aligned, might not point to an entity of the referenced type, and might be a trap representation.&quot;  C11 &#167;6.3.2.3 5.   Instead code could use <code>static DialPlan DP_FirstError;</code>  (no <code>*</code>).  ( I now see rectified in later part of answer) 2) Unfortunately <code>(p &gt; DP_FirstError &amp;&amp; p &lt; DP_LastError)</code> is UB when not true."}], "tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": false, "score": 0, "last_activity_date": 1574862133, "creation_date": 1574862133, "answer_id": 59071577, "question_id": 59070186, "link": "https://stackoverflow.com/questions/59070186/elegant-ways-to-return-status-code-and-pointer-from-a-c-function/59071577#59071577", "title": "Elegant ways to return status code and pointer from a C function", "body": "<p>I agree with @Mat use a:</p>\n\n<pre><code>typedef Gret struct generic_ret;\nstruct generic_ret {\n    int Status;\n    union {\n     void *p;\n     DialPlan *d;\n    };\n}\n...\nPhone = GetPhone(...);\nif (Phone.Status == 0) {\n     Dial(Phone.d);\n     ...\n}\n</code></pre>\n\n<p>Keep that up and you will end up programming in Go...\nThe other <em>classic</em> approach to status + pointer is to reserve more pointer values than 0:</p>\n\n<pre><code>extern DialPlan *DP_NoService, *DP_BadNumber, *DP_Broke, ...;\nextern bool IsDialError(DialPlan *p);\n....\nstatic DialPlan *DP_FirstError = 0,\n                *DP_NoService = (void *)1,\n                *DP_BadNumber = (void *)2,\n                *DP_LastError = (void *)10;\nbool IsDialError(DialPlan *p) {\n     return (p &gt; DP_FirstError &amp;&amp; p &lt; DP_LastError);\n}\n</code></pre>\n\n<p>Or, if you prefer the look of safety:</p>\n\n<pre><code>static DialPlan Errors[10];\nstatic DialPlan *DP_NoService = Errors + 0,\n                *DP_BadNumber = Errors + 1,\n                ...\n                *DP_LastError = Errors + 9;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1574867767, "post_id": 59073059, "comment_id": 104384348, "body": "Anything revolving around &quot;errno&quot; or &quot;get last error&quot; crap is to be regarded as obsolete IMO. We&#39;ve had multithreaded applications for some 30 years and regardless of that, polling some global variable isn&#39;t good API design, never was. The canonical form is rather <code>err_t status = function(struct Result *output, input) ;</code> where &quot;err_t&quot; is some custom enum type. Using <code>int</code> or bool is often too blunt."}], "tags": [], "owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "is_accepted": false, "score": 1, "last_activity_date": 1574867934, "last_edit_date": 1574867934, "creation_date": 1574866994, "answer_id": 59073059, "question_id": 59070186, "link": "https://stackoverflow.com/questions/59070186/elegant-ways-to-return-status-code-and-pointer-from-a-c-function/59073059#59073059", "title": "Elegant ways to return status code and pointer from a C function", "body": "<p>With 'C', when functions are limited to returning a single value, there is no one perfect method. There are few patterns that are commonly being used, and are followed by various available API. Consider sticking with one of the proven, less then perfect, methods:</p>\n\n<ul>\n<li><p>int status = function(struct Result *output, input) ;</p>\n\n<ul>\n<li>Work for simple cases, with small number of success/failures.</li>\n<li>Common to use 0 and positive for success, negative for errors.</li>\n</ul></li>\n<li><p>int result = function(*output, input) ; with extended error code.</p>\n\n<ul>\n<li>Used with used for many Linux system calls/APIs, extra error detail in 'errno'.</li>\n<li>Common to use 0 and positive for success, negative for errors.</li>\n<li>Challenge with MT systems, because of single error code. In many cases, error information actually available as functions that wraps thread local result.</li>\n</ul></li>\n<li><p>bool success = function(*output, input) ; with callback error</p>\n\n<ul>\n<li>Making it easy to pass success/failure.</li>\n<li>Error information passed to user defined error callback.</li>\n<li>Implemented in many GUI callbacks (e.g, X11), already using callbacks.</li>\n</ul></li>\n<li><p>struct result *res = function(input, struct errro **error)</p>\n\n<ul>\n<li>Used in Glib or other libraries which handle complex data types (not just arrays)</li>\n<li>Usually, each structure will have corresponding free* functions.</li>\n<li>Error address (if passed) will capture error data.</li>\n<li>Error will result in res = NULL, and error being set.</li>\n<li>Closer in spirit to try/catch.</li>\n</ul></li>\n</ul>\n\n<p>When introducing generic calls, the common theme that I observed is usually to have the output and the error objects at the same location in the argument list (not necessary togethe!). In many cases the output is placed as the first, and the error/exception is placed at the end.</p>\n\n<p>Worth looking into <a href=\"https://stackoverflow.com/questions/385975/error-handling-in-c-code\">Error handling in C code</a></p>\n"}], "owner": {"reputation": 1005, "user_id": 10674275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1710877d569a65bda20b7c7c0865b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Julius", "link": "https://stackoverflow.com/users/10674275/julius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574867934, "creation_date": 1574857469, "question_id": 59070186, "link": "https://stackoverflow.com/questions/59070186/elegant-ways-to-return-status-code-and-pointer-from-a-c-function", "title": "Elegant ways to return status code and pointer from a C function", "body": "<p>I was currently reading <a href=\"https://stackoverflow.com/questions/58809360/why-is-this-claimed-dereferencing-type-punned-pointer-warning-compiler-specific\">this question</a> which shows problems about using <code>void **</code> as a parameter to return a pointer from a function. </p>\n\n<p>My code mostly has status codes as return values, and now I am looking for alternative ways to return these pointers AND a status code. So I currently see a couple of options, but none of them really make me happy. Probably I am overthinking a little.</p>\n\n<pre><code>// Output status through return value and the pointer through parameter \n// - seems to be problematic because it requires casting to void **, which is invalid\nint myfunc(void **output);\n\n// Output status through return value, pointer through struct \n// - seems to add unnecessary complexity to the interface\nstruct some_output { void *value };\nint myfunc(struct some_output *output);\n\n// Output pointer through return value, status through parameter \n// - breaks consistency with other interfaces which always return the status code\nvoid *myfunc(int *status);\n</code></pre>\n\n<p>Now I am wondering whether there are other, alternative, elegant ways to return pointers and status codes from a function which I did not think about that don't have \"drawbacks\"?</p>\n"}, {"tags": ["c", "gcc", "assembly", "osdev", "got"], "comments": [{"owner": {"reputation": 2493, "user_id": 15304, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f814654faae23dc2e0d7da97ead044b8?s=128&d=identicon&r=PG", "display_name": "PypeBros", "link": "https://stackoverflow.com/users/15304/pypebros"}, "edited": false, "score": 0, "creation_date": 1574859170, "post_id": 59070109, "comment_id": 104379284, "body": "There&#39;s a section about Global Offset Table in <a href=\"https://wiki.osdev.org/Dynamic_Linker\" rel=\"nofollow noreferrer\">wiki.osdev.org/Dynamic_Linker</a>, which might help you understanding the underlying what and why."}], "answers": [{"tags": [], "owner": {"reputation": 896, "user_id": 6659361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200d3e89398030d70445b9a3f071c385?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime B.", "link": "https://stackoverflow.com/users/6659361/maxime-b"}, "is_accepted": false, "score": 3, "last_activity_date": 1574857718, "creation_date": 1574857718, "answer_id": 59070266, "question_id": 59070109, "link": "https://stackoverflow.com/questions/59070109/undefined-reference-to-global-offset-table-in-gcc-32-bit-code-for-a-trivial/59070266#59070266", "title": "undefined reference to `_GLOBAL_OFFSET_TABLE_&#39; in gcc 32-bit code for a trivial function, freestanding OS", "body": "<p>By default, your compiler creates a <a href=\"https://en.wikipedia.org/wiki/Position-independent_code\" rel=\"nofollow noreferrer\">position-independant executable</a>.</p>\n\n<p>You can force your compiler to build a non-pie executable by passing the option <code>-fno-pie</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 536, "user_id": 12419816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HYeFw.jpg?s=128&g=1", "display_name": "Suraaj K S", "link": "https://stackoverflow.com/users/12419816/suraaj-k-s"}, "edited": false, "score": 0, "creation_date": 1574858951, "post_id": 59070555, "comment_id": 104379168, "body": "@SuraajKS: you can let everyone know that by clicking the accept checkbox under the vote arrows."}, {"owner": {"reputation": 536, "user_id": 12419816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HYeFw.jpg?s=128&g=1", "display_name": "Suraaj K S", "link": "https://stackoverflow.com/users/12419816/suraaj-k-s"}, "edited": false, "score": 0, "creation_date": 1579449493, "post_id": 59070555, "comment_id": 105762009, "body": "PeterCordes, I was looking back at this answer.... Consider a simple 16 bit assembly snippet like this:  * bits 16 ; call +0; pop ax; jmp $ ; * . I emulate using qemu. The program crashes... Maybe instead of call +0, you meant <code>call nextLabel  ; nextLabel: </code> ?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 536, "user_id": 12419816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HYeFw.jpg?s=128&g=1", "display_name": "Suraaj K S", "link": "https://stackoverflow.com/users/12419816/suraaj-k-s"}, "edited": false, "score": 0, "creation_date": 1579466421, "post_id": 59070555, "comment_id": 105766846, "body": "@SuraajKS: <code>call +0</code> is intended to indicate a <code>rel32</code>=0 in the actual machine-code encoding.  But if you assemble it with NASM <code>+0</code> is absolute address 0.  <code>call $+5</code> would be one way to write it for NASM in 32/64-bit mode, or with labels like you showed.  But that doesn&#39;t highlight the fact that the actual adjustment to EIP/RIP is 0.  So once you understand what <code>call +0</code> means, it&#39;s very nice notation.  Maybe I need to add some explanation to the answer if that wasn&#39;t obvious to everyone else, though."}, {"owner": {"reputation": 536, "user_id": 12419816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HYeFw.jpg?s=128&g=1", "display_name": "Suraaj K S", "link": "https://stackoverflow.com/users/12419816/suraaj-k-s"}, "edited": false, "score": 0, "creation_date": 1579629323, "post_id": 59070555, "comment_id": 105827245, "body": "Aha... Understood @PeterCordes"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 4, "last_activity_date": 1579641878, "last_edit_date": 1579641878, "creation_date": 1574858667, "answer_id": 59070555, "question_id": 59070109, "link": "https://stackoverflow.com/questions/59070109/undefined-reference-to-global-offset-table-in-gcc-32-bit-code-for-a-trivial/59070555#59070555", "title": "undefined reference to `_GLOBAL_OFFSET_TABLE_&#39; in gcc 32-bit code for a trivial function, freestanding OS", "body": "<p><strong>You need <code>-fno-pie</code></strong>; the <a href=\"https://stackoverflow.com/questions/43367427/32-bit-absolute-addresses-no-longer-allowed-in-x86-64-linux\">default (in most modern distros) is <code>-fpie</code>: generate code for a position-independent executable</a>.  This is a code-gen option separate from the <code>-pie</code> linker option (which gcc also passes by default), and is independent of <code>-ffreestanding</code>.  <code>-fpie -ffreestanding</code> implies you want a freestanding PIE that uses a GOT, so that's what GCC targets.</p>\n\n<p><code>-fpie</code> only costs a bit of speed in 64-bit code (where RIP-relative addressing is possible) but is quite bad for 32-bit code; compilers get a pointer to the GOT in one of the integer registers (tying up another one of the 8) and access static data relative to that address with <code>[reg + disp32]</code> addressing modes like <code>[eax + foo@GOTOFF]</code></p>\n\n<hr>\n\n<p><strong>With optimization disabled, <code>gcc -fpie -m32</code> generates the address of the GOT in a register</strong> even though the function doesn't access any static data.  You'd can see this if you look at your compiler output (with <code>gcc -S</code> instead of <code>-c</code> on the machine you're compiling on).</p>\n\n<p><a href=\"https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(fontScale:14,j:1,lang:c%2B%2B,source:&#39;int+function()%0A%7B%0A++++return+0x1234abce%3B%0A%7D&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:45.58724883600972,l:&#39;4&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g92,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,libraryCode:&#39;1&#39;,trim:&#39;1&#39;),fontScale:14,lang:c%2B%2B,libs:!(),options:&#39;-O0+-fpie+-m32&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+9.2+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),header:(),k:54.41275116399028,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">On Godbolt</a> we can use <code>-m32 -fpie</code> to give the same effect as a GCC configured with <code>--enable-default-pie</code>:</p>\n\n<pre><code># gcc9.2 -O0 -m32 -fpie\nfunction():\n        push    ebp\n        mov     ebp, esp                        # frame pointer\n        call    __x86.get_pc_thunk.ax\n        add     eax, OFFSET FLAT:_GLOBAL_OFFSET_TABLE_  # EAX points to the GOT\n        mov     eax, 305441742                  # overwrite with the return value\n        pop     ebp\n        ret\n\n__x86.get_pc_thunk.ax:          # this is the helper function gcc calls\n        mov     eax, DWORD PTR [esp]\n        ret\n</code></pre>\n\n<p>The \"thunk\" returns its return address.  i.e. the address of the instruction after the <code>call</code>.  The <code>.ax</code> name means to return in EAX.  Modern GCC can choose any register; traditionally the 32-bit PIC base register was always EBX but modern GCC chooses a call-clobbered register when that avoids an extra save/restore of EBX.</p>\n\n<p>Fun fact: <code>call +0; pop eax</code> would be more efficient, and only 1 byte larger at each call site.  You might think that would unbalance the return-address predictor stack, but in fact <code>call +0</code> is special-cased on most CPUs to not do that.  <a href=\"http://blog.stuffedcow.net/2018/04/ras-microbenchmarks/#call0\" rel=\"nofollow noreferrer\">http://blog.stuffedcow.net/2018/04/ras-microbenchmarks/#call0</a>.  (<code>call +0</code> means the rel32 = 0, so it calls the next instruction.  That's not how NASM would interpret that syntax, though.)</p>\n\n<p>clang doesn't generate a GOT pointer unless it needs one, even at <code>-O0</code>.  But it does so with <code>call +0</code>;<code>pop %eax</code>: <a href=\"https://godbolt.org/z/GFY9Ht\" rel=\"nofollow noreferrer\">https://godbolt.org/z/GFY9Ht</a></p>\n"}], "owner": {"reputation": 536, "user_id": 12419816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HYeFw.jpg?s=128&g=1", "display_name": "Suraaj K S", "link": "https://stackoverflow.com/users/12419816/suraaj-k-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 723, "favorite_count": 0, "accepted_answer_id": 59070555, "answer_count": 2, "score": 3, "last_activity_date": 1579641878, "creation_date": 1574857218, "last_edit_date": 1574864497, "question_id": 59070109, "link": "https://stackoverflow.com/questions/59070109/undefined-reference-to-global-offset-table-in-gcc-32-bit-code-for-a-trivial", "title": "undefined reference to `_GLOBAL_OFFSET_TABLE_&#39; in gcc 32-bit code for a trivial function, freestanding OS", "body": "<p>I have a small c code file(function.c):</p>\n\n<pre><code>int function()\n{\n    return 0x1234abce;\n}\n</code></pre>\n\n<p>I am using a 64 bit machine. However, I want to write a small 32 bit OS. I want to compile the code into a 'pure' assembly/binary file.</p>\n\n<p>I compile my code with:</p>\n\n<p><code>gcc function.c -c -m32 -o file.o -ffreestanding   # This gives you the object file</code></p>\n\n<p>I link it with:</p>\n\n<p><code>ld -o function.bin -m elf_i386 -Ttext 0x0 --oformat binary function.o</code></p>\n\n<p>I am getting the following error:</p>\n\n<pre><code>function.o: In function `function':\nfunction.c:(.text+0x9): undefined reference to `_GLOBAL_OFFSET_TABLE_'\n</code></pre>\n"}, {"tags": ["java", "c++", "c", "java-native-interface"], "comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 1, "creation_date": 1574859049, "post_id": 59070023, "comment_id": 104379215, "body": "Post the generated header files so that people don&#39;t have to generate them themselves. Note that a static native method will receive a <code>jclass</code> as its second argument, not a <code>jobject</code>."}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1574859175, "post_id": 59070023, "comment_id": 104379288, "body": "Cannot reproduce on MacOS 10.14.6 with Java 1.8.0_66. Did you accidentally make the C++ function in the .cpp file <code>static</code> as well? That will hide it from the linker."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1574859735, "post_id": 59070023, "comment_id": 104379585, "body": "Or did you leave off the <code>extern &quot;C&quot;</code> tag?"}, {"owner": {"reputation": 123, "user_id": 5185128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hFF8j.jpg?s=128&g=1", "display_name": "Yuri Glushenkov", "link": "https://stackoverflow.com/users/5185128/yuri-glushenkov"}, "reply_to_user": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1574861269, "post_id": 59070023, "comment_id": 104380448, "body": "@Michael I&#39;ve updated my repo, I added the header file. <a href=\"https://github.com/Arxemond777/JNI_C_CPP_example/blob/master/src/main/java/MyJNIExample.h\" rel=\"nofollow noreferrer\">github.com/Arxemond777/JNI_C_CPP_example/blob/master/src/mai&zwnj;&#8203;n/&hellip;</a>"}, {"owner": {"reputation": 123, "user_id": 5185128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hFF8j.jpg?s=128&g=1", "display_name": "Yuri Glushenkov", "link": "https://stackoverflow.com/users/5185128/yuri-glushenkov"}, "reply_to_user": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1574861406, "post_id": 59070023, "comment_id": 104380528, "body": "@Botje No, I did. My .cpp file the same, as in my repo.  <a href=\"https://github.com/Arxemond777/JNI_C_CPP_example/blob/master/src/main/java/MyJNIExample.cpp\" rel=\"nofollow noreferrer\">github.com/Arxemond777/JNI_C_CPP_example/blob/master/src/mai&zwnj;&#8203;n/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 5185128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hFF8j.jpg?s=128&g=1", "display_name": "Yuri Glushenkov", "link": "https://stackoverflow.com/users/5185128/yuri-glushenkov"}, "edited": false, "score": 0, "creation_date": 1574865540, "post_id": 59072210, "comment_id": 104383025, "body": "Of course I regenerate my header, when I change my java file. I have jclass in my signature, as u can <a href=\"https://github.com/Arxemond777/JNI_C_CPP_example/blob/master/src/main/java/MyJNIExample.h#L23\" rel=\"nofollow noreferrer\">see</a>. ``` JNIEXPORT void JNICALL Java_MyJNIExample_sayHelloCpp   (JNIEnv *, jclass); ```"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "reply_to_user": {"reputation": 123, "user_id": 5185128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hFF8j.jpg?s=128&g=1", "display_name": "Yuri Glushenkov", "link": "https://stackoverflow.com/users/5185128/yuri-glushenkov"}, "edited": false, "score": 0, "creation_date": 1574865581, "post_id": 59072210, "comment_id": 104383048, "body": "But your CPP file still mentions <code>jobject</code>, so the signatures don&#39;t match."}, {"owner": {"reputation": 123, "user_id": 5185128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hFF8j.jpg?s=128&g=1", "display_name": "Yuri Glushenkov", "link": "https://stackoverflow.com/users/5185128/yuri-glushenkov"}, "edited": false, "score": 0, "creation_date": 1574865834, "post_id": 59072210, "comment_id": 104383197, "body": "Ah, I see! Thanks. But then I wonder why it works for .c and with jclass and with jobject? Why .c with jobject works as static and jclass works as NON static? Is the same difference in the semantic of this between C and C++?"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "reply_to_user": {"reputation": 123, "user_id": 5185128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hFF8j.jpg?s=128&g=1", "display_name": "Yuri Glushenkov", "link": "https://stackoverflow.com/users/5185128/yuri-glushenkov"}, "edited": false, "score": 0, "creation_date": 1574866078, "post_id": 59072210, "comment_id": 104383333, "body": "Name mangling is a C++-only feature, as C does not have function or method overloading."}, {"owner": {"reputation": 123, "user_id": 5185128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hFF8j.jpg?s=128&g=1", "display_name": "Yuri Glushenkov", "link": "https://stackoverflow.com/users/5185128/yuri-glushenkov"}, "edited": false, "score": 0, "creation_date": 1574869962, "post_id": 59072210, "comment_id": 104385510, "body": "I see. Thanks a lot for this explanation!"}], "tags": [], "owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "is_accepted": true, "score": 1, "last_activity_date": 1574865620, "last_edit_date": 1574865620, "creation_date": 1574864356, "answer_id": 59072210, "question_id": 59070023, "link": "https://stackoverflow.com/questions/59070023/a-java-runtime-error-with-a-native-jni-static-method-for-c-implementation/59072210#59072210", "title": "A java runtime error with a native JNI static method for C++ implementation", "body": "<p>The type of the function that <code>javah</code> generates differs according to whether the <code>native</code> method is <code>static</code> or not:</p>\n\n<pre><code>JNIEXPORT void JNICALL Java_MyJNIExample_sayHelloCppstatic\n  (JNIEnv *, jclass);\n\nJNIEXPORT void JNICALL Java_MyJNIExample_sayHelloCppnonstatic\n  (JNIEnv *, jobject);\n</code></pre>\n\n<p>In addition, the generated header contains an <code>extern \"C\"</code> declaration to make sure the compiler keeps the name intact of mangling it like <code>__Z29Java_MyJNIExample_sayHelloCppP7JNIEnv_P8_jobject</code>.</p>\n\n<p>So, what happened here is that you generated a header file with a <code>static native void sayHelloCpp</code>, so there is an <code>extern \"C\"</code> declaration for the function with signature <code>(JNIEnv *, jclass)</code>, but you <strong>provide</strong> a <code>(JNIEnv *, jobject)</code> function. The compiler uses its default mangling scheme as the signature does not match, and the Java runtime fails to find it.</p>\n\n<p>So, long story short: <strong>always</strong> regenerate your header file and check C++ function signatures if you change your Java class. I could not reproduce your issue because I wrote a Makefile that always regenerated the header file after recompiling the Java file.</p>\n"}], "owner": {"reputation": 123, "user_id": 5185128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hFF8j.jpg?s=128&g=1", "display_name": "Yuri Glushenkov", "link": "https://stackoverflow.com/users/5185128/yuri-glushenkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 59072210, "answer_count": 1, "score": 0, "last_activity_date": 1574865620, "creation_date": 1574856901, "last_edit_date": 1574861520, "question_id": 59070023, "link": "https://stackoverflow.com/questions/59070023/a-java-runtime-error-with-a-native-jni-static-method-for-c-implementation", "title": "A java runtime error with a native JNI static method for C++ implementation", "body": "<p>I have a repo with <a href=\"https://github.com/Arxemond777/JNI_C_CPP_example\" rel=\"nofollow noreferrer\">two simple implementations</a> for JNI with C/C++.<br>\nI have the <code>java.lang.UnsatisfiedLinkError</code> error for C++ static JNI method.</p>\n\n<pre><code>(base) GlushenkovYuri:java y.glushenkov$ /Library/Java/JavaVirtualMachines/jdk1.8.0_191.jdk/Contents/Home/bin/java -Djava.library.path=. MyJNIExample\nHello World from C!\nException in thread \"main\" java.lang.UnsatisfiedLinkError: MyJNIExample.sayHelloCpp()V\n        at MyJNIExample.sayHelloCpp(Native Method)\n        at MyJNIExample.main(MyJNIExample.java:51)\n\n</code></pre>\n\n<p>But for C native method the same approach work well.\nFor C++ works without <code>static</code>.</p>\n\n<p>You can reproduce the same behaviour in the following way:<br>\n1) Uncomment lines with <a href=\"https://github.com/Arxemond777/JNI_C_CPP_example/blob/master/src/main/java/MyJNIExample.java#L51\" rel=\"nofollow noreferrer\">the static native method for C++</a> and <a href=\"https://github.com/Arxemond777/JNI_C_CPP_example/blob/master/src/main/java/MyJNIExample.java#L56\" rel=\"nofollow noreferrer\">this one</a>. And comment lines with <a href=\"https://github.com/Arxemond777/JNI_C_CPP_example/blob/master/src/main/java/MyJNIExample.java#L50\" rel=\"nofollow noreferrer\">the NON static native method for C++</a> and <a href=\"https://github.com/Arxemond777/JNI_C_CPP_example/blob/master/src/main/java/MyJNIExample.java#L55\" rel=\"nofollow noreferrer\">this one</a>;<br>\n2) And just perform the next steps described in my <a href=\"https://github.com/Arxemond777/JNI_C_CPP_example\" rel=\"nofollow noreferrer\">README.md</a> file;</p>\n\n<p>Can somebody explain to me why the native method static/non static works for C, but only the native NON static method works for C++?</p>\n\n<p>UPD: my <a href=\"https://github.com/Arxemond777/JNI_C_CPP_example/blob/master/src/main/java/MyJNIExample.h\" rel=\"nofollow noreferrer\">header</a> file</p>\n\n<pre><code>/* DO NOT EDIT THIS FILE - it is machine generated */\n#include &lt;jni.h&gt;\n/* Header for class MyJNIExample */\n\n#ifndef _Included_MyJNIExample\n#define _Included_MyJNIExample\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n/*\n * Class:     MyJNIExample\n * Method:    sayHelloC\n * Signature: ()V\n */\nJNIEXPORT void JNICALL Java_MyJNIExample_sayHelloC\n  (JNIEnv *, jclass);\n\n/*\n * Class:     MyJNIExample\n * Method:    sayHelloCpp\n * Signature: ()V\n */\nJNIEXPORT void JNICALL Java_MyJNIExample_sayHelloCpp\n  (JNIEnv *, jclass);\n\n#ifdef __cplusplus\n}\n#endif\n#endif\n</code></pre>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1574857259, "post_id": 59069744, "comment_id": 104378189, "body": "You can&#39;t program by trial &amp; error. You must actually know what every line you write does. There is no function called <code>strcopy</code>. You didn&#39;t declare a variable called <code>id</code>. You have declared <code>record</code> as an array of unitialized pointers to structs and never set those pointers to point anywhere. And so on. There&#39;s no sorting this code out, you have to study arrays and pointers, then after that strings."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1574856316, "creation_date": 1574856316, "answer_id": 59069846, "question_id": 59069744, "link": "https://stackoverflow.com/questions/59069744/structs-to-check-login-information-in-c/59069846#59069846", "title": "Structs to check login information in C", "body": "<p>You have multiple errors in the code you show.</p>\n\n<p>The first is that <code>record</code> is an array of five <strong><em>pointers</em></strong> to <code>struct nurse</code>.</p>\n\n<p>It should be an array of structure object:</p>\n\n<pre><code>struct nurse { ... } record[5];  // No *, no pointers\n</code></pre>\n\n<p>The second problem is that you don't have a variable named <code>id</code> so</p>\n\n<pre><code>scanf(\"%s\", id);\n</code></pre>\n\n<p>will not work.</p>\n\n<p>The third problem is that you use the unknown function <code>strcopy</code>, when I believe you mean to use the standard <a href=\"https://en.cppreference.com/w/c/string/byte/strcpy\" rel=\"nofollow noreferrer\"><code>strcpy</code></a> function.</p>\n\n<p>The fourth problem is that the structures <code>id</code> member can only contain four-character strings, since the null-terminator needs one element. And you try to copy (in the example shown) a much longer string into that array.</p>\n\n<p>The fifth problem is that you can't use <code>==</code> or <code>!=</code> to compare strings. You should use the <a href=\"https://en.cppreference.com/w/c/string/byte/strcmp\" rel=\"nofollow noreferrer\"><code>strcmp</code></a> function to compare strings.</p>\n\n<p>The sixth problem is that the <code>password</code> member of the structure is an array of <em>arrays</em>, and you try to copy a string to <code>password</code> as it was a single string.</p>\n\n<p>The seventh problem is that you treat the structures <code>id</code> member as both a string and as a single integer value. It can't be both.</p>\n\n<p>There might be more problems, but these should be good enough to start with.</p>\n\n<p>And all in all it seems you're missing some basic C knowledge, and could use a few books to read or classes to attend.</p>\n"}, {"tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": false, "score": 0, "last_activity_date": 1574866740, "last_edit_date": 1574866740, "creation_date": 1574857359, "answer_id": 59070156, "question_id": 59069744, "link": "https://stackoverflow.com/questions/59069744/structs-to-check-login-information-in-c/59070156#59070156", "title": "Structs to check login information in C", "body": "<p>The \"not a structure or union\" error is because the type of <code>record</code> in <code>record.id</code> is not a structure or union. <code>record</code> is an array of 5 pointers to <code>struct</code>, so the correct syntax would be <code>record[0]-&gt;id</code>. But you probably didn't want an array of pointers, so if you change the <code>*record[5]</code> to <code>record[5]</code>, you could access the <code>id</code> of the first record as <code>record[0].id</code> or <code>record-&gt;id</code>.</p>\n\n<p>There are numerous other problems as well, on practically every line of the program, so I can only suggest spending more time learning the basics of C.</p>\n\n<p>In general, C is a fairly concise and small language, so consider the meaning of each symbol carefully (e.g., an extra <code>*</code> makes all the difference) before you type it in. And instead of scattering literal numbers (like <code>5</code> and <code>8</code>) throughout your code, <code>#define</code> constants and use those instead. For example, it is now unclear whether <code>id[5]</code> has the <code>5</code> because you want there to be five ids in total, or because you want each individual id to be five characters long (in which case you are missing room for the NUL, or zero, terminator). For example:</p>\n\n<pre><code>#define NUM_RECORDS 5\n#define ID_LENGTH 5\n#define PASSWORD_LENGTH 8\n\nstruct nurse {\n    char id[ID_LENGTH + 1];\n    char password[PASSWORD_LENGTH + 1];\n} record[NUM_RECORDS];\n</code></pre>\n\n<p>(You may later opt to use a more succinct style than this, but when getting started I believe it is better to be explicit.)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11452330"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1574866740, "creation_date": 1574855954, "last_edit_date": 1574857766, "question_id": 59069744, "link": "https://stackoverflow.com/questions/59069744/structs-to-check-login-information-in-c", "title": "Structs to check login information in C", "body": "<p>I have to create a program that only allows 5 people to login with predetermined user ID's and passwords. I think defining them within a function then saving them in a struct would be the best way to do this. So far I have: </p>\n\n<pre><code>    struct nurse\n{\n    char id[5];\n    char password[5][8];\n}*record[5];\n\nint main(void)\n{\n\n    record.id=1;\n    strcopy(record.id, \"username\");\n    strcopy(record.password, \"password\");\n\n    printf(\"Please Enter your username: \");\n    scanf(\"%s\", id);\n    if (id != username)\n    {\n        printf(\"Error. Record not found.\");\n    }\n</code></pre>\n\n<p>I'm unfortunately coming up with error messages saying \"[Error] request for member 'id' in something not a structure or union\" and the same error for 'password'. </p>\n\n<p>How can I solve this?</p>\n"}, {"tags": ["c", "makefile", "header"], "comments": [{"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 1, "creation_date": 1574854660, "post_id": 59069052, "comment_id": 104376720, "body": "I am not sure I understand your worry, but why use clean? it will recompile every time. Otherwise it will only compile if something in the dependencies changed. It is fine to have multiple rules relying on same header."}, {"owner": {"reputation": 375, "user_id": 9301837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F9tuejj96Fo/AAAAAAAAAAI/AAAAAAAAAB8/ehboOJbOI-0/photo.jpg?sz=128", "display_name": "King Powa", "link": "https://stackoverflow.com/users/9301837/king-powa"}, "reply_to_user": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1574854911, "post_id": 59069052, "comment_id": 104376856, "body": "There is not a proper worry, is just that I want to know if there is a proper way for compiling my file by using macros or others elements that would make it easier to write the makefile. As regards clean, yeah I&#39;ve discovered that makefiles have such behaviour but my professor clearly requests also a clear section, I do not know why."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1574854995, "post_id": 59069052, "comment_id": 104376911, "body": "You goin to get a different answer from every engineer you ask this to. Ex: I would use what you had before (which is what you apparently have <i>last</i> in this post) ,but build three obj sets from three source file lists: one used by client,  one used by server, and the one shared by both. Put the client and shared objs in the client dependency list, the server and shared objs in the server dependency list. your &#39;all&#39; target is dependent on &#39;client&#39; and &#39;server&#39; and that&#39;s it. I&#39;m certain* others will have differing opinions, so best of luck."}, {"owner": {"reputation": 375, "user_id": 9301837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F9tuejj96Fo/AAAAAAAAAAI/AAAAAAAAAB8/ehboOJbOI-0/photo.jpg?sz=128", "display_name": "King Powa", "link": "https://stackoverflow.com/users/9301837/king-powa"}, "edited": false, "score": 0, "creation_date": 1574855413, "post_id": 59069052, "comment_id": 104377140, "body": "The problem is that the last makefile does not create 3 executables, whereas I want it to create those 3 executables"}, {"owner": {"reputation": 2127, "user_id": 1819452, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ad224b55add66c22f62380dea203e75?s=128&d=identicon&r=PG", "display_name": "Vroomfondel", "link": "https://stackoverflow.com/users/1819452/vroomfondel"}, "edited": false, "score": 0, "creation_date": 1574856337, "post_id": 59069052, "comment_id": 104377658, "body": "Did you read <a href=\"http://make.mad-scientist.net/papers/advanced-auto-dependency-generation/\" rel=\"nofollow noreferrer\">make.mad-scientist.net/papers/&hellip;</a> ?"}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1574861426, "post_id": 59069052, "comment_id": 104380544, "body": "<code>make</code> is all about defining dependencies. If you&#39;re not sure draw a tree showing which files depend on which other files. Add the commands to build the latter from the former. Look for common patterns. Put your findings in the Makefile using the correct syntax. Try it. Only then optimize. I&#39;m aware that I simplified, but that&#39;s it."}], "answers": [{"comments": [{"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1574861658, "post_id": 59070593, "comment_id": 104380670, "body": "You were faster than me, and my &quot;solution&quot; looks 98% equal. :-) Good work! @KingPowa You might like to use <code>make</code>&#39;s options <code>-n</code>, <code>-d</code>, or <code>-p</code> to debug your Makefile."}, {"owner": {"reputation": 13458, "user_id": 1773798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4Ljqn.png?s=128&g=1", "display_name": "Renaud Pacalet", "link": "https://stackoverflow.com/users/1773798/renaud-pacalet"}, "reply_to_user": {"reputation": 375, "user_id": 9301837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F9tuejj96Fo/AAAAAAAAAAI/AAAAAAAAAB8/ehboOJbOI-0/photo.jpg?sz=128", "display_name": "King Powa", "link": "https://stackoverflow.com/users/9301837/king-powa"}, "edited": false, "score": 0, "creation_date": 1574943049, "post_id": 59070593, "comment_id": 104412096, "body": "@KingPowa If it does please do not forget to accept the answer such that other visitors know that it solved your problem."}], "tags": [], "owner": {"reputation": 13458, "user_id": 1773798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4Ljqn.png?s=128&g=1", "display_name": "Renaud Pacalet", "link": "https://stackoverflow.com/users/1773798/renaud-pacalet"}, "is_accepted": true, "score": 2, "last_activity_date": 1574860071, "last_edit_date": 1574860071, "creation_date": 1574858807, "answer_id": 59070593, "question_id": 59069052, "link": "https://stackoverflow.com/questions/59069052/how-to-properly-write-a-makefile-for-multiple-executable-with-same-dependecies/59070593#59070593", "title": "How to properly write a makefile for multiple executable with same dependecies - C", "body": "<p>It would probably be easier if you were reworking your specifications and separating object files from executables (compilation and linking phases). Object files depend on header files and source files but executables depend only on object files. Then if you properly use pattern rules, automatic variables and if you separate the dependencies from the recipes, you could use something like:</p>\n\n<pre><code>SRC := $(wildcard *.c)\nOBJ := $(patsubst %.c,%.o,$(SRC))\nEXE := handler server client\n\n.PHONY: all clean\n\nall: $(EXE)\n\n# object files to executables dependencies\nhandler: handler.o header.o procedure.o\nserver: server.o header.o\nclient: client.o header.o\n\n# header files to object files dependencies\nprocedure.o: procedure.h\n$(OBJ): header.h\n\n%.o: %.c\n    $(CC) $(CFLAGS) -c $&lt; -o $@\n\n$(EXE):\n    $(CC) $(LDFLAGS) $^ -o $@ $(LDLIBS)\n\nclean:\n    rm -f $(EXE) $(OBJ)\n</code></pre>\n\n<p>Note: of course, because they cannot be guessed from your question, check the dependencies (which executable depends on which object file and which object file depends on which header file). This example Makefile is just a hint.</p>\n\n<p>Note: as suggested by <a href=\"https://stackoverflow.com/users/1819452/vroomfondel\">Vroomfondel</a>, if your compiler supports it, you could also use it to automatically detect header files to object files dependencies. Read <a href=\"http://make.mad-scientist.net/papers/advanced-auto-dependency-generation/\" rel=\"nofollow noreferrer\">this</a> to know more about this.</p>\n"}], "owner": {"reputation": 375, "user_id": 9301837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F9tuejj96Fo/AAAAAAAAAAI/AAAAAAAAAB8/ehboOJbOI-0/photo.jpg?sz=128", "display_name": "King Powa", "link": "https://stackoverflow.com/users/9301837/king-powa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 59070593, "answer_count": 1, "score": 0, "last_activity_date": 1574860071, "creation_date": 1574853627, "question_id": 59069052, "link": "https://stackoverflow.com/questions/59069052/how-to-properly-write-a-makefile-for-multiple-executable-with-same-dependecies", "title": "How to properly write a makefile for multiple executable with same dependecies - C", "body": "<p>Before formulating my question, I want to point out I've searched for previous answers but could not find anything useful.</p>\n\n<p>I'm working on a project for my exam. Since it should consist in several executables, with various dependencies, I wanted to write a simple makefile and understand properly its behaviour for replicating it in the future if needed.</p>\n\n<p>Suppose source folder consists of these files:</p>\n\n<pre><code>handler.c //this is the main file\nserver.c //another executable\nclient.c //another executable\nheader.h //each executable depends from this\nheader.c\nprocedure.h //not each executable depends from this\nprocedure.c\n</code></pre>\n\n<p>I know that, in order to compile these files, I should do something like that:</p>\n\n<pre><code>all: handler server client\n\nhandler: handler.c header.o procedure.o\n    gcc handler.c -o handler header.o procedure.o\n\n...more...\n\nprocedure.o: header.o\n    gcc procedure.c -o procedure.o header.o\n\n...more...\n</code></pre>\n\n<p>which, I'm not sure is correct at all but it's sure very tedious and long.\nMy question is: </p>\n\n<p>is there a <strong>faster, concise, easy</strong> way of creating these files given my problem?\nIs that possible to have a clear explaination of how it works?</p>\n\n<p>I want to point out that, until now, I used this type of makefile for single executable, without problem:</p>\n\n<pre><code>src = $(wildcard *.c)\nobj = $(src:.c=.o)\nc = gcc\n\nstart: $(obj)\n    $(c) -o $@ $^\n\nclean:\n    rm -f *.o\n    rm -f ./start\n    rm -f *~\n</code></pre>\n\n<p>which, I suppose, takes all file from my main folder, specifies dependencies as the name of file.o and then create each .o needed file.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "ctags", "cscope"], "comments": [{"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1574856420, "post_id": 59068980, "comment_id": 104377694, "body": "What have you tried already? In which context do you use it? What is the command line?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 13043462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3a6febe9826ac448e2cae4b7b80dab6?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/13043462/anonymous"}, "is_accepted": false, "score": 0, "last_activity_date": 1583910210, "creation_date": 1583910210, "answer_id": 60630771, "question_id": 59068980, "link": "https://stackoverflow.com/questions/59068980/how-to-enable-ctags-for-proc-files/60630771#60630771", "title": "How to enable ctags for PRO*C files.?", "body": "<p>ctags --language-force=C++ *.pc</p>\n"}], "owner": {"reputation": 21, "user_id": 4469454, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/clwvj.jpg?s=128&g=1", "display_name": "pavan", "link": "https://stackoverflow.com/users/4469454/pavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583910210, "creation_date": 1574853399, "question_id": 59068980, "link": "https://stackoverflow.com/questions/59068980/how-to-enable-ctags-for-proc-files", "title": "How to enable ctags for PRO*C files.?", "body": "<p>When i generate ctags, tags are generated only for C files.\nIt is not populating tags for proc*c (.pc) files. </p>\n"}, {"tags": ["c", "arrays", "matrix", "scanf"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1574853864, "post_id": 59068945, "comment_id": 104376295, "body": "If you are artificially restricted to no allowance for <code>string.h</code> and/or <code>ctype.h</code>, then you&#39;re in for a bumpy road. Whoever laid that restriction doesn&#39;t engineer in the real world, so remind yourself of that while you&#39;re navigating that highway, taking their name in vain at every pothole. You&#39;re going to have to at least try, though. Bring your attempt as a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> failure case, and <i>specific</i> questions concerning it, and we may be able to help."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 2, "creation_date": 1574854278, "post_id": 59068945, "comment_id": 104376512, "body": "Where&#39;s your code? Try to write your own code and than you might indicate us your issues!"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1574854456, "post_id": 59068945, "comment_id": 104376626, "body": "This is not Homeworkoverflow. Please make an attempt first and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 3, "user_id": 12445195, "user_type": "registered", "profile_image": "https://graph.facebook.com/2259112977509036/picture?type=large", "display_name": "Kende D&#233;t&#225;r", "link": "https://stackoverflow.com/users/12445195/kende-d%c3%a9t%c3%a1r"}, "edited": false, "score": 0, "creation_date": 1574854621, "post_id": 59068945, "comment_id": 104376698, "body": "I added my own attempt, but I can see that it clearly won&#39;t work."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1574854774, "post_id": 59068945, "comment_id": 104376778, "body": "I&#39;d suggest asking your teacher for advice, but I would read each line with <code>fgets</code> and then read the numbers with <code>sscanf</code>."}, {"owner": {"reputation": 3618, "user_id": 3316645, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bootU.png?s=128&g=1", "display_name": "domsson", "link": "https://stackoverflow.com/users/3316645/domsson"}, "edited": false, "score": 0, "creation_date": 1574855013, "post_id": 59068945, "comment_id": 104376921, "body": "Possible approach: (1) read the file char by char (2a) if char is numeric, add it to a buffer (2b) if char is <code>,</code> or <code>\\n</code>, turn the current contents of the buffer into a number and put it in the array (3) also, if char is <code>\\n</code>, increase your matrix row counter (Edit: Paul&#39;s answer is basically detailing this exact approach)"}, {"owner": {"reputation": 3618, "user_id": 3316645, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bootU.png?s=128&g=1", "display_name": "domsson", "link": "https://stackoverflow.com/users/3316645/domsson"}, "edited": false, "score": 0, "creation_date": 1574855198, "post_id": 59068945, "comment_id": 104377037, "body": "PS: &quot;Every line has the same length, but it&#39;s unspecified [...] how long they are.&quot; ;)"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1574858622, "post_id": 59068945, "comment_id": 104378981, "body": "Your example lines do not have same length. They have same number of numbers. That&#39;s not the same."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1574858902, "post_id": 59068945, "comment_id": 104379136, "body": "You cannot use fscanf in that way. <a href=\"http://www.cplusplus.com/reference/cstdio/fscanf/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/cstdio/fscanf</a>"}], "answers": [{"comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1574855142, "post_id": 59069415, "comment_id": 104377002, "body": "Sounds like a very bad and complicated way to perform this task."}, {"owner": {"reputation": 3618, "user_id": 3316645, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bootU.png?s=128&g=1", "display_name": "domsson", "link": "https://stackoverflow.com/users/3316645/domsson"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1574855312, "post_id": 59069415, "comment_id": 104377093, "body": "@klutt seeing how this is a homework task and the possible tool set is restricted, I&#39;d have done it the exact same way. Mind adding some information as to why you think this is <i>very bad and complicated</i>?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1574855659, "post_id": 59069415, "comment_id": 104377278, "body": "Please don&#39;t recommend anyone to use <code>atoi</code>. It is a dangerous and 100% superfluous function. Use <code>strtol</code> instead."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574855887, "post_id": 59069415, "comment_id": 104377407, "body": "@Lundin, what is the danger?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 3618, "user_id": 3316645, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bootU.png?s=128&g=1", "display_name": "domsson", "link": "https://stackoverflow.com/users/3316645/domsson"}, "edited": false, "score": 0, "creation_date": 1574856135, "post_id": 59069415, "comment_id": 104377547, "body": "@domsson Because it would be way easier to solve with a combination of <code>fgets</code> and <code>sscanf</code>. Just read the first line, count commas to find out dimensions and then a simple loop with the functions i mentioned. And recommending atoi is not a good thing."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1574856155, "post_id": 59069415, "comment_id": 104377557, "body": "@PaulOgilvie How do you check if the conversion succeeded?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574856302, "post_id": 59069415, "comment_id": 104377638, "body": "&quot;The functions atof, atoi, atol, and atoll need not affect the value of the integer expression errno on an error. If the value of the result cannot be represented, the behavior is undefined.&quot; Wheras the strto... functions set <code>endptr</code> to point at the beginning of the passed string in case conversion failed."}, {"owner": {"reputation": 3618, "user_id": 3316645, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bootU.png?s=128&g=1", "display_name": "domsson", "link": "https://stackoverflow.com/users/3316645/domsson"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1574856348, "post_id": 59069415, "comment_id": 104377659, "body": "@klutt and @Lundin your recommendations might be valid and important for production code (or anything that is supposed to be used in the real world). However, this is homework and for such, I think it might be good to get down to the nitty-gritty (in other words, use as little help in the form of convenient functions as possible). I also don&#39;t see any dangers in the use of <code>atoi()</code> et al for such a &quot;project&quot;. OP is most likely just (supposed to be) learning about programming fundamentals and the input is well-defined."}, {"owner": {"reputation": 3618, "user_id": 3316645, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bootU.png?s=128&g=1", "display_name": "domsson", "link": "https://stackoverflow.com/users/3316645/domsson"}, "edited": false, "score": 0, "creation_date": 1574856572, "post_id": 59069415, "comment_id": 104377780, "body": "If this was my assignment, I&#39;d probably program (and hand in) two solutions: the one outlined by Paul, then one using <code>fgets</code> and <code>sscanf</code>. The former, I believe, would be more beneficial to the learning process."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 3618, "user_id": 3316645, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bootU.png?s=128&g=1", "display_name": "domsson", "link": "https://stackoverflow.com/users/3316645/domsson"}, "edited": false, "score": 0, "creation_date": 1574857111, "post_id": 59069415, "comment_id": 104378089, "body": "@domsson If an answer is using &quot;wrong&quot; methods for educational purposes, it should at least state that it does precisely that and why. Also, there are a ton of questions here where the root of the problem is using wrong input methods or unsafe methods in general. Much better to get used to using <code>strtol</code> from the start than switching later. If the task was to write a parser of some kind <code>fgetc</code> would be nice, but that&#39;s not the case here."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1574857891, "post_id": 59069415, "comment_id": 104378551, "body": "It&#39;s exactly as Lundin says. It&#39;s best to never learn that function. You could reason the same way with <code>gets</code>. Sure, it will work, but why get used to it?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574861150, "post_id": 59069415, "comment_id": 104380369, "body": "@lundin, I read &quot;If no valid conversion could be performed, a zero value is returned (0L)&quot; so in that respect, the result of <code>atoi</code> and <code>strtol</code> are the same. So how do you determine if a conversion could be performed? (See <a href=\"http://www.cplusplus.com/reference/cstdlib/strtol/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/cstdlib/strtol</a>). For <code>atoi</code> it reads: &quot;If .. no conversion is performed zero is returned.&quot;"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574861458, "post_id": 59069415, "comment_id": 104380564, "body": "My quote was from the standard. Which also says &quot;Except for the behavior on error, they are equivalent to <code>atoi: (int)strtol(nptr, (char **)NULL, 10)</code>&quot;. There is no guarantee that <code>atoi</code> returns 0 upon error."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1574864494, "post_id": 59069415, "comment_id": 104382364, "body": "@PaulOgilvie Which means that if it returns 0 (not a very unusual number) there&#39;s no way of detecting an error. With <code>strtol</code> you just do a <code>if(str == endptr) { &#47;* Handle error *&#47; }</code>. See C standard 7.22.1.4p7"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1574854869, "creation_date": 1574854869, "answer_id": 59069415, "question_id": 59068945, "link": "https://stackoverflow.com/questions/59068945/how-do-i-read-in-a-matrix-of-unknown-length-without-whitespaces/59069415#59069415", "title": "How do I read in a matrix of unknown length, without whitespaces?", "body": "<p>Reading lines of unspecified length can be done using <code>fgetc</code> to read character-by-character. In your case you must check each character for the following conditions:</p>\n\n<ul>\n<li><p>if you see a <code>','</code>, you have seen a number;</p></li>\n<li><p>if you see a <code>'\\n'</code>, you have seen a number <em>and</em> you have seen a line.</p></li>\n<li><p>you skip each non-digit character;</p></li>\n<li><p>you place the digits in a small temporary buffer. once you have seen a number, you can convert it using <code>atoi</code>;</p></li>\n<li><p>if you are not allowed to use <code>atoi</code> you perform <code>number= number*10 + c-'0';</code> with <code>c</code> the digit for each digit you see.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 1, "creation_date": 1574859729, "post_id": 59070415, "comment_id": 104379581, "body": "why not just init with <code>int x[ROWS][MAXEL] = {0};</code> Also see the <code>atoi</code> discussion on the other answer."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "reply_to_user": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1574861399, "post_id": 59070415, "comment_id": 104380521, "body": "I modified the source code. I used strtol instead of atoi. I&#39; m becoming to think that is possible to use only strtol to solve the question ..."}], "tags": [], "owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "is_accepted": false, "score": 1, "last_activity_date": 1574864130, "last_edit_date": 1574864130, "creation_date": 1574858207, "answer_id": 59070415, "question_id": 59068945, "link": "https://stackoverflow.com/questions/59068945/how-do-i-read-in-a-matrix-of-unknown-length-without-whitespaces/59070415#59070415", "title": "How do I read in a matrix of unknown length, without whitespaces?", "body": "<p>I had this idea. The code below reads a line from the file for each loop cycle and scans it, if it's not a void line. The separator <code>SEP</code> is retrieved using the function (implemented into the code) <code>mystrchr</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar * mystrchr(const char * s, char x);\n\nchar * mystrchr(const char * s, char x) \n{\n    while(*s!=0 &amp;&amp; *s!=x) s++;\n\n    return ((!*s)?NULL:(char *)s);\n}\n\nint main(void)\n{\n#define FILENAME \"x.txt\"\n#define ROWS 20\n#define MAXEL 20\n#define BDIM 10240\n#define SEP ','\n\n    int x[ROWS][MAXEL],elr[ROWS], ronum=0,elnum,i,j;\n    FILE * fptr;\n    char buffer[BDIM],* app;\n\n    /* --- Init the array --- */\n    for(i=0;i&lt;ROWS; i++)\n        for(j=0;j&lt;MAXEL; j++)\n            x[i][j]=0;\n\n    /* --- Open the file --- */\n    fptr=fopen(FILENAME,\"r\");\n    if (!fptr)\n        return 1;\n\n    /* --- Gets data from file --- */\n    while(ronum&lt;ROWS &amp;&amp; fgets(buffer,BDIM,fptr)) {\n        app = buffer;\n        /* Takes only non-void lines */\n        if (*app &amp;&amp; *app!='\\n' &amp;&amp; *app!='\\r') {\n            elnum=0;--app;\n            /* Scan the line */\n            do {\n                if (* ++app ) {\n                    x[ronum][elnum++]=strtol(app,NULL,0);\n                }\n\n                app = mystrchr(app,SEP);\n            } while(app &amp;&amp; elnum&lt;MAXEL);\n\n            // -- save the number of element per row\n            if (elnum) {\n                elr[ronum]=elnum;\n                ronum++;\n            }\n        }\n    }\n\n\n    if (fptr)\n        fclose(fptr);\n\n    /* --- Prints data --- */\n    for(i=0;i&lt;ronum;i++) {\n        for(j=0;j&lt;elr[i];j++) {\n            printf(\"%d \",x[i][j]);\n        }\n        puts(\"\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": false, "score": 0, "last_activity_date": 1574873500, "creation_date": 1574873500, "answer_id": 59074989, "question_id": 59068945, "link": "https://stackoverflow.com/questions/59068945/how-do-i-read-in-a-matrix-of-unknown-length-without-whitespaces/59074989#59074989", "title": "How do I read in a matrix of unknown length, without whitespaces?", "body": "<p>It's not clear from the description whether a line may be empty.</p>\n\n<p>Assuming that all lines are non-empty, then this is a quite simple <code>scanf()</code> job, but the important point is <strong>never discard the return value of input functions</strong>.</p>\n\n<p>A couple of possible approaches:</p>\n\n<ul>\n<li>Scan using a pattern of <code>%d</code> for the first number of each line (return value 0 means we've read all lines), followed by <code>,%d</code> for subsequent numbers on that line.  <code>scanf()</code> will return 0 when there's no <code>,</code> in the input stream, and we move to the next line.</li>\n<li>Scan using a pattern of <code>%d%c</code> to capture the character that follows the number into a variable (e.g. <code>char sep</code>).  When the return value is 0, we've read all lines, and break the loop.  When the return value is 2, we can examine <code>sep</code> to see whether it is <code>,</code> or <code>\\n</code> and choose whether to advance to the next row.  (If the return value is 1, then the last number was at end-of-file, with no final newline).</li>\n</ul>\n\n<p>If some or all lines might be empty, you'll want to peek whether the first character of the line is a newline (probably with <code>getc()</code> and <code>ungetc()</code>).  That would indicate an empty line.</p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1574876971, "last_edit_date": 1574876971, "creation_date": 1574876019, "answer_id": 59075613, "question_id": 59068945, "link": "https://stackoverflow.com/questions/59068945/how-do-i-read-in-a-matrix-of-unknown-length-without-whitespaces/59075613#59075613", "title": "How do I read in a matrix of unknown length, without whitespaces?", "body": "<p>Actually you need only <code>&lt;stdio.h&gt;</code>. You can separate the values by reading each line into a buffer with <code>fgets()</code>. You can parse each value from the buffer using <code>sscanf</code> maintaining an offset from the beginning of the buffer utilizing the <code>\"%n\"</code> specifier to determine the number of characters consumed during each conversion to <code>int</code>. You add that number (<code>+1</code> to account for the <code>','</code>) to your offset for each value converted.</p>\n\n<p>(<strong>note:</strong> ideally given <code>stdlib.h</code> you would want to use <code>strtol</code> to handle the conversions as it provides full error handling to allow you to determine why a conversion failed and handle the failure, but without <code>limits.h</code> and <code>errno.h</code> you cannot determine whether under/overflow occurred during conversion (without providing your own <code>LONG_MIN/LONG_MAX</code> values) so you are limited to just checking whether characters were converted -- which you can do with <code>sscanf</code>)</p>\n\n<p>In your case, first <code>#define</code> constants for your number of rows, columns and buffer size, e.g.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define ROWS 20     /* if you need a constant, #define one (or more) */\n#define COLS ROWS\n#define MAXC 1024\n</code></pre>\n\n<p>Now declare your array and buffer and row and column variables, open the filename specified as the first argument to the program and validate it is open for reading (or read from <code>stdin</code> by default if no argument is given):</p>\n\n<pre><code>int main (int argc, char **argv) {\n\n    char buf[MAXC] = \"\";    /* buffer to hold each line read */\n    int arr[ROWS][COLS] = {{0}}, row = 0, col = 0;  /* array &amp; bounds */\n    /* use filename provided as 1st argument (stdin by default) */\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        perror (\"file open failed\");\n        return 1;\n    }\n</code></pre>\n\n<p>Now read each line in the file into <code>buf</code> and declare your variables you will use to track the <code>offset</code> from the beginning of <code>buf</code>, the number of characters <code>n</code> consumed during each conversion, the number of columns in the line <code>ncol</code> and the value <code>val</code> parsed:</p>\n\n<pre><code>    while (row &lt; ROWS &amp;&amp; fgets (buf, MAXC, fp)) {     /* read each line */\n        int offset = 0,     /* offset from beginning of line */\n            n = 0,          /* number of characters consumed in conversion */\n            ncol = 0,       /* number of columns in line */\n            val;            /* value from conversion */\n</code></pre>\n\n<p>Now loop maintaining your offset and convert each value in the line adding it to your array:</p>\n\n<pre><code>        while (ncol &lt; COLS &amp;&amp; sscanf (buf + offset, \"%d%n\", &amp;val, &amp;n) == 1) {\n            arr[row][ncol++] = val; /* assign val, increment ncol */\n            offset += n + 1;        /* update offset + 1 for ',' */\n        }\n</code></pre>\n\n<p>Now some housekeeping. If you need to ensure that each row in the array has the same number of columns, set the number of columns based on the number of values parsed in the first row. Then for all other rows, compare against that value to ensure you have an equal number of values per-row:</p>\n\n<pre><code>        if (!col)           /* if number of columns not set */\n            col = ncol;     /* set to no. columns in 1st row */\n        if (ncol != col) {  /* force all other rows to have same no. cols */\n            fputs (\"error: unequal number of columns.\\n\", stderr);\n            return 1;\n        }\n</code></pre>\n\n<p>With all values parsed, simply increment the row counter and go convert your next row worth of values:</p>\n\n<pre><code>        row++;      /* increment row count */\n    }\n</code></pre>\n\n<p>In essence, that is all you need to do. All that remains is to close the file stream (if not reading from <code>stdin</code>) and use the values in the array however you like. A complete example could be:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define ROWS 20     /* if you need a constant, #define one (or more) */\n#define COLS ROWS\n#define MAXC 1024\n\nint main (int argc, char **argv) {\n\n    char buf[MAXC] = \"\";    /* buffer to hold each line read */\n    int arr[ROWS][COLS] = {{0}}, row = 0, col = 0;  /* array &amp; bounds */\n    /* use filename provided as 1st argument (stdin by default) */\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        perror (\"file open failed\");\n        return 1;\n    }\n\n    while (row &lt; ROWS &amp;&amp; fgets (buf, MAXC, fp)) {     /* read each line */\n        int offset = 0,     /* offset from beginning of line */\n            n = 0,          /* number of characters consumed in conversion */\n            ncol = 0,       /* number of columns in line */\n            val;            /* value from conversion */\n        /* loop over each value in line */\n        while (ncol &lt; COLS &amp;&amp; sscanf (buf + offset, \"%d%n\", &amp;val, &amp;n) == 1) {\n            arr[row][ncol++] = val; /* assign val, increment ncol */\n            offset += n + 1;        /* update offset + 1 for ',' */\n        }\n        if (!col)           /* if number of columns not set */\n            col = ncol;     /* set to no. columns in 1st row */\n        if (ncol != col) {  /* force all other rows to have same no. cols */\n            fputs (\"error: unequal number of columns.\\n\", stderr);\n            return 1;\n        }\n        row++;      /* increment row count */\n    }\n\n    if (fp != stdin)   /* close file if not stdin */\n        fclose (fp);\n\n    for (int i = 0; i &lt; row; i++) {     /* output array */\n        for (int j = 0; j &lt; col; j++)\n            printf (\" %3d\", arr[i][j]);\n        putchar ('\\n');\n    }\n}\n</code></pre>\n\n<p>The example simply outputs the values stored in your array and exits.</p>\n\n<p><strong>Example Input File</strong></p>\n\n<pre><code>$ cat dat/2020max.txt\n1,12,5,14,0\n4,6,2,3,24\n1,2,3,4,5\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/read2020max dat/2020max.txt\n   1  12   5  14   0\n   4   6   2   3  24\n   1   2   3   4   5\n</code></pre>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1574894973, "creation_date": 1574894973, "answer_id": 59079458, "question_id": 59068945, "link": "https://stackoverflow.com/questions/59068945/how-do-i-read-in-a-matrix-of-unknown-length-without-whitespaces/59079458#59079458", "title": "How do I read in a matrix of unknown length, without whitespaces?", "body": "<p><a href=\"https://www.explainxkcd.com/wiki/index.php/1339:_When_You_Assume\" rel=\"nofollow noreferrer\">Assuming</a> well formatted data, read a <em>line</em> with <code>fgets()</code> and then parse it via <code>strtol()</code></p>\n\n<pre><code>#define COL_MAX 20\n#define ROW_MAX 20\n#define CHAR_PER_INTEGER (sizeof(long)*CHAR_BIT/3 + 3)\n#define LINE_MAX (ROW_MAX * (CHAR_PER_INTEGER + 1) + 2)\n\nlong matrix[ROW_MAX][COL_MAX] = {0};  // better to use named constants than magic numbers\n\nint col = 0; \nint row; \n// for (int i=0; i&lt;19; i++){  Not to 19, but 20\nfor (row=0; row&lt;ROW_MAX; row++){\n  char line[LINE_MAX*2]; // Generous buffer, but not insane size\n  if (fgets(line, sizeof line, be) == NULL)) {\n    break; // No more lines\n  }\n  char *s = line;\n  for (int j=0; j&lt;COL_MAX; j++){\n    char *endptr;\n    errno = 0;\n    long value = strtol(s, &amp;endptr, 10);\n    // no conversion, overflow, unexpected next character\n    if (s == endptr || errno || (*endptr != ',' &amp;&amp; *endptr != '\\n')) {\n      fprintf(stderr, \"Invalid input &lt;%s&gt;\\n\", line);\n      exit(EXIT_FAILURE);\n    }\n    matrix[row][j] = value;\n    if (*endptr == '\\n') {  // no more in this line\n      col = j + 1;\n      break;\n    }\n    s = endptr + 1; // advance past the ','\n  }\n}\n\n// Use row*col portion of the matrix.\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12445195, "user_type": "registered", "profile_image": "https://graph.facebook.com/2259112977509036/picture?type=large", "display_name": "Kende D&#233;t&#225;r", "link": "https://stackoverflow.com/users/12445195/kende-d%c3%a9t%c3%a1r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 5, "score": -1, "last_activity_date": 1574894973, "creation_date": 1574853296, "last_edit_date": 1574872980, "question_id": 59068945, "link": "https://stackoverflow.com/questions/59068945/how-do-i-read-in-a-matrix-of-unknown-length-without-whitespaces", "title": "How do I read in a matrix of unknown length, without whitespaces?", "body": "<p>My input file looks like this:</p>\n\n<pre><code>1,12,5,14,0\n4,6,2,3,24\n1,2,3,4,5\n</code></pre>\n\n<p>Every line has the same length, but it's unspecified how many lines there are, and how long they are.\n(Maximum size is 20*20).</p>\n\n<p>I need to read them into a 20*20 array, so that if the line is only 2 numbers long, the rest of the array is empty. </p>\n\n<p>How do I do that, while leaving out the <code>,</code> characters and while starting in the next line of the array when a newline comes in the file?</p>\n\n<p>Here's my attempt:</p>\n\n<pre><code>int matrix[20][20];\n\nfor (int i=0; i&lt;19; i++){\n    for (int j=0; j&lt;19; j++){\n        fscanf(be, \"%d,\", &amp;matrix[i][j]);\n    }\n    fscanf(be, \"\\n\");\n}\n</code></pre>\n\n<p>Ps: I'm only allowed to use <strong><code>&lt;stdio.h&gt;</code></strong> and <strong><code>&lt;stdlib.h&gt;</code></strong>.</p>\n"}, {"tags": ["c", "struct", "malloc", "typedef", "free"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1574853437, "post_id": 59068904, "comment_id": 104376059, "body": "<i>&quot;it does the same job but better.&quot;</i> - did you ask that someone <i>why</i> they claim this? I only ask because it would seem easier for them to justify their conclusion than for us to assume we successfully climbed into their head. Each function has merit. One (<code>calloc</code>) is better suited syntactically for sequence allocation with the added feature of zero-filling the allocated block. Whether that is a <i>beneficial</i> feature for your use was is something only you can decide."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 4, "creation_date": 1574853804, "post_id": 59068904, "comment_id": 104376262, "body": "Please don&#39;t ask 2 totally unrelated questions at once. Please <a href=\"https://stackoverflow.com/posts/59068904/edit\">edit</a> your question and focus only on one thing."}, {"owner": {"reputation": 101, "user_id": 9914548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47916896bfd1434892dd1f6fc3e9c47?s=128&d=identicon&r=PG&f=1", "display_name": "feded", "link": "https://stackoverflow.com/users/9914548/feded"}, "edited": false, "score": 0, "creation_date": 1574854610, "post_id": 59068904, "comment_id": 104376693, "body": "user694733 I would like to know which is the best way to create and define structs considering that I&#39;ll create and free   these structs very often. That&#39;s why I&#39;m asking pros and cons..."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1574854957, "post_id": 59068904, "comment_id": 104376877, "body": "<code>Should I use &quot;typedef struct&quot; or not?</code> a duplicate could be <a href=\"https://stackoverflow.com/questions/252780/why-should-we-typedef-a-struct-so-often-in-c\" title=\"why should we typedef a struct so often in c\">stackoverflow.com/questions/252780/&hellip;</a> but for <code>What do you think, which is the best choice</code> a duplicate could be <a href=\"https://stackoverflow.com/questions/1538420/difference-between-malloc-and-calloc\" title=\"difference between malloc and calloc\">stackoverflow.com/questions/1538420/&hellip;</a> . The <code>which is the best choice</code> is opinion based - the best choice using what measure to compare? Speed of execution? Writing speed? Writer sanity?"}, {"owner": {"reputation": 101, "user_id": 9914548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47916896bfd1434892dd1f6fc3e9c47?s=128&d=identicon&r=PG&f=1", "display_name": "feded", "link": "https://stackoverflow.com/users/9914548/feded"}, "edited": false, "score": 0, "creation_date": 1574855159, "post_id": 59068904, "comment_id": 104377009, "body": "Thank you KamilCuk, I found good stuffs I your links."}], "answers": [{"tags": [], "owner": {"reputation": 1312, "user_id": 3001150, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f547c2a970cd36d5300589c7ff2c4a5f?s=128&d=identicon&r=PG&f=1", "display_name": "Raildex", "link": "https://stackoverflow.com/users/3001150/raildex"}, "is_accepted": false, "score": 3, "last_activity_date": 1574855927, "last_edit_date": 1574855927, "creation_date": 1574854633, "answer_id": 59069345, "question_id": 59068904, "link": "https://stackoverflow.com/questions/59068904/structs-typedef-and-malloc-calloc/59069345#59069345", "title": "Structs, typedef and malloc, calloc", "body": "<p><code>calloc()</code> and <code>malloc()</code> are almost the same.  </p>\n\n<p><code>calloc()</code> initializes the claimed memory with <code>0</code>s.  </p>\n\n<p>when you call <code>malloc()</code> and try to access members of the allocated type, you will see garbage values (for <code>int</code> for example you will see values like <code>347289472</code>) while with <code>calloc()</code> you will see 0s as initial values</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 101, "user_id": 9914548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47916896bfd1434892dd1f6fc3e9c47?s=128&d=identicon&r=PG&f=1", "display_name": "feded", "link": "https://stackoverflow.com/users/9914548/feded"}, "edited": false, "score": 1, "creation_date": 1574859473, "post_id": 59069580, "comment_id": 104379452, "body": "@feded Why would you want to use the very same name for the type and the variable? That&#39;s just confusing - don&#39;t write confusing code."}, {"owner": {"reputation": 101, "user_id": 9914548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47916896bfd1434892dd1f6fc3e9c47?s=128&d=identicon&r=PG&f=1", "display_name": "feded", "link": "https://stackoverflow.com/users/9914548/feded"}, "edited": false, "score": 0, "creation_date": 1574859626, "post_id": 59069580, "comment_id": 104379529, "body": "ok I got it : typedef struct node MyVar is type node name myvar right?"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1574855452, "creation_date": 1574855452, "answer_id": 59069580, "question_id": 59068904, "link": "https://stackoverflow.com/questions/59068904/structs-typedef-and-malloc-calloc/59069580#59069580", "title": "Structs, typedef and malloc, calloc", "body": "<blockquote>\n  <p>Should I use \"typedef struct\" or not? Which are the pros and cons ?</p>\n</blockquote>\n\n<p>It's just subjective coding style. The most common style is to use a typedef. One advantage is that it makes the code behave just like C++. Typing out <code>struct name</code> explicitly is ok too, a style favoured by Linux. Neither style is obviously right or wrong.</p>\n\n<p>However, for self-referencing structs then regardless of style you must always write the pointer member with <code>struct</code> notation.</p>\n\n<pre><code>typedef struct foo\n{\n  struct foo* next;\n} foo_t;\n</code></pre>\n\n<p><code>foo_t* next</code> won't work because the typedef is not complete at that point. <code>foo</code> however is a \"struct tag\", not a type name, so it follows different rules. If you wish to use the typedef name internally, then you have to forward-declare the struct:</p>\n\n<pre><code>typedef struct foo foo_t;  // forward declaration\nstruct foo\n{\n  foo_t* next;\n};\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>When I allocate memory some told me that calloc is better than malloc because it does the same job but better...</p>\n</blockquote>\n\n<p>When someone tells you that, ask them how exactly is <code>calloc</code> any better. When programming, critical thinking is very important.</p>\n\n<ul>\n<li><code>malloc</code> allocates a chunk of memory but does not initialize it to known values. Since there is no initialization, <code>malloc</code> is faster than <code>calloc</code>.</li>\n<li><code>calloc</code> allocates a chunk of memory, or optionally an array of chunks placed in adjacent memory cells. It zero-initializes all memory, meaning that it has known default values. Because of this, it is slower than <code>malloc</code>.</li>\n</ul>\n\n<p>So which is \"better\", faster or pre-initialized? Depends on what you want to do.</p>\n"}], "owner": {"reputation": 101, "user_id": 9914548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47916896bfd1434892dd1f6fc3e9c47?s=128&d=identicon&r=PG&f=1", "display_name": "feded", "link": "https://stackoverflow.com/users/9914548/feded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1574855927, "creation_date": 1574853166, "last_edit_date": 1574854330, "question_id": 59068904, "link": "https://stackoverflow.com/questions/59068904/structs-typedef-and-malloc-calloc", "title": "Structs, typedef and malloc, calloc", "body": "<p>I want to create and use something like : </p>\n\n<pre><code>struct mystruct { \n    mystruct * AnOtherMyStruct; //mystruct must have a pointer to an other mystruct inside\n    ...some stuffs...  \n};\n</code></pre>\n\n<p>Should I use \"typedef struct\" or not? Which are the pros and cons ?</p>\n\n<p>When I allocate memory some told me that calloc is better than malloc because it does the same job but better...</p>\n\n<p>My results will be something like :</p>\n\n<pre><code>struct (or typedef struct) mystruct  {\n    mystruct * AnOtherMyStruct;\n    ...\n};\nint main () {\n\nmalloc or calloc =...\nfree(...);\n</code></pre>\n\n<p>What do you think, which is the best choice to allocate and deallocate structs considering that these operations will be done quite frequently?</p>\n"}, {"tags": ["c", "gcc", "enums", "microblaze"], "comments": [{"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1574853594, "post_id": 59068826, "comment_id": 104376147, "body": "C++11 allows you to declare the enum type, see <a href=\"https://en.cppreference.com/w/cpp/language/enum\" rel=\"nofollow noreferrer\">here</a>. I just noticed it&#39;s <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> (I am listening to c++ and c). But will leave comment as others might find it useful if they reach the quetion."}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 1, "creation_date": 1574855036, "post_id": 59068826, "comment_id": 104376935, "body": "Try <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Code-Gen-Options.html#Code-Gen-Options\" rel=\"nofollow noreferrer\">-fshort-enums</a> as suggested in on of the <a href=\"https://stackoverflow.com/questions/4879286/specifying-size-of-enum-type-in-c\">answers</a>"}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1574855444, "post_id": 59068826, "comment_id": 104377153, "body": "Or used <a href=\"https://gcc.gnu.org/onlinedocs/gcc-3.3/gcc/Type-Attributes.html\" rel=\"nofollow noreferrer\">packed</a> attribute. &quot;This attribute, attached to an enum, struct, or union type definition, specified that the minimum required memory be used to represent the type.&quot;"}, {"owner": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "reply_to_user": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1574856857, "post_id": 59068826, "comment_id": 104377950, "body": "@TonyTannous Thanks, I will try your suggestions (I appear to have missed the <code>packed</code> attribute)."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1574859941, "post_id": 59068826, "comment_id": 104379696, "body": "Enumerated values don&#39;t need to be stored in an enumerated type. You can store the value in a signed or unsigned, single-byte integer type according to your needs. (See <a href=\"https://stackoverflow.com/a/54921765/5264491\">this answer</a>.)"}], "owner": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 935, "favorite_count": 0, "closed_date": 1574855180, "answer_count": 0, "score": 4, "last_activity_date": 1574852956, "creation_date": 1574852956, "question_id": 59068826, "link": "https://stackoverflow.com/questions/59068826/how-to-force-enum-size-with-gcc", "closed_reason": "Duplicate", "title": "How to force enum size with GCC?", "body": "<p>To ensure binary compatibility with the product I'm working on, I need to force some of my enums to be represented by a single byte.</p>\n\n<p>Since C90 allows for the compiler to chose an appropriate type (<a href=\"http://port70.net/~nsz/c/c99/n1256.html#6.7.2.2\" rel=\"nofollow noreferrer\">6.7.2.2 Enumeration specifiers</a>), I would like to force the compiler to chose 8 bits.</p>\n\n<p>I did expect GCC attributes to allow this, but I could not find anything <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Enumerator-Attributes.html\" rel=\"nofollow noreferrer\">here</a>. Is there another way to handle this? (or an attribute I missed)</p>\n\n<p>I'm using GCC 4.6.4 for Microblaze and C90 (I did not see a relevant option <a href=\"https://gcc.gnu.org/onlinedocs/gcc/MicroBlaze-Options.html\" rel=\"nofollow noreferrer\">here</a> either).</p>\n"}, {"tags": ["c", "gio"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 2764392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fef559a6004c1017b200fc31efa4c8?s=128&d=identicon&r=PG&f=1", "display_name": "phearnomore", "link": "https://stackoverflow.com/users/2764392/phearnomore"}, "edited": false, "score": 0, "creation_date": 1574856187, "post_id": 59069681, "comment_id": 104377580, "body": "I don&#39;t write in Python. :) I just saw a couple of examples online. I&#39;ll try your method in a moment."}], "tags": [], "owner": {"reputation": 4022, "user_id": 2931197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31e3379958588750196bc49f6925ab62?s=128&d=identicon&r=PG&f=1", "display_name": "Philip Withnall", "link": "https://stackoverflow.com/users/2931197/philip-withnall"}, "is_accepted": true, "score": 2, "last_activity_date": 1574855732, "creation_date": 1574855732, "answer_id": 59069681, "question_id": 59068590, "link": "https://stackoverflow.com/questions/59068590/how-to-retrieve-real-time-output-with-gsubprocess-in-c/59069681#59069681", "title": "How to retrieve real time output with GSubprocess in C?", "body": "<p>You need to get the stdout pipe from the <code>GSubprocess</code> using <a href=\"https://developer.gnome.org/gio//2.56/GSubprocess.html#g-subprocess-get-stdout-pipe\" rel=\"nofollow noreferrer\"><code>g_subprocess_get_stdout_pipe()</code></a>, and then read from it using <a href=\"https://developer.gnome.org/gio/unstable/GInputStream.html#g-input-stream-read\" rel=\"nofollow noreferrer\"><code>g_input_stream_read()</code></a> (or some other input stream reading function) in a loop until the subprocess exits.</p>\n\n<p>You might want to do the same thing with <code>stderr</code>, but in order to do that you\u2019d need to poll both using a <a href=\"https://developer.gnome.org/glib/stable/glib-The-Main-Event-Loop.html\" rel=\"nofollow noreferrer\"><code>GMainLoop</code></a>, since you can\u2019t block on reading two streams at once.</p>\n\n<p>Seeing your Python code might allow people to help you with the C translation of it.</p>\n"}], "owner": {"reputation": 55, "user_id": 2764392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fef559a6004c1017b200fc31efa4c8?s=128&d=identicon&r=PG&f=1", "display_name": "phearnomore", "link": "https://stackoverflow.com/users/2764392/phearnomore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 59069681, "answer_count": 1, "score": 1, "last_activity_date": 1574869510, "creation_date": 1574852149, "last_edit_date": 1574869510, "question_id": 59068590, "link": "https://stackoverflow.com/questions/59068590/how-to-retrieve-real-time-output-with-gsubprocess-in-c", "title": "How to retrieve real time output with GSubprocess in C?", "body": "<p>I have the following C code:</p>\n\n<pre><code>#include &lt;gio/gio.h&gt;\n\nint main(void) {\n\n    GSubprocess *process;\n    gchar *output;\n    gchar *error;\n\n    process = g_subprocess_new(G_SUBPROCESS_FLAGS_STDOUT_PIPE, NULL, \"./for.sh\", NULL);\n\n    g_subprocess_communicate_utf8(process, NULL, NULL, &amp;output, &amp;error, NULL);\n\n    g_print(\"%s\", output);\n}\n</code></pre>\n\n<p>and the following bash code:</p>\n\n<pre><code>#!/bin/bash\n\nfor i in {1..3}\ndo\n    echo \"$i\"\n    sleep 1\ndone\n</code></pre>\n\n<p>The issue I have with this is that the C code will wait until the bash code (or any other code for that matter) finishes to print its output. And what I'd prefer is to have it printed in real time, line by line.</p>\n\n<p>I have found a solution for this in Python but I don't know how to translate it to C. Any pointers will be appreaciated.</p>\n\n<p>The answer in code is this:</p>\n\n<pre><code>#include &lt;gio/gio.h&gt;\n\nint main(void) {\n\n    GSubprocess *process;\n    GInputStream *stream;\n    char buffer[4];\n\n    process = g_subprocess_new(G_SUBPROCESS_FLAGS_STDOUT_PIPE, NULL, \"./for.sh\", NULL);\n\n    stream = g_subprocess_get_stdout_pipe(process);\n\n    while(g_input_stream_read(stream, buffer, sizeof(buffer), NULL, NULL))\n        g_print(\"%s\", buffer);\n\n    return 0;\n}\n</code></pre>\n\n<p>The funny things is that depending on the value of buffer[], the output is correct or accompanied by junk. If I change buffer[4] to buffer[8] I get junk. If I use buffer[12] then it's correct. Weird.</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1574851511, "post_id": 59068339, "comment_id": 104374973, "body": "Please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to show us <i>in</i> the question itself, as text. And show us the actual as well as the expected output. And perhaps refresh <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1574852457, "post_id": 59068391, "comment_id": 104375500, "body": "Please try to explain <i>why</i> this would solve the problem. What does the spaces do that cause problems? And please refresh <a href=\"https://stackoverflow.com/help/how-to-answer\">how to write good answers</a>."}], "tags": [], "owner": {"reputation": 1063, "user_id": 2836444, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3f050f3bfc552d963493568e70237dda?s=128&d=identicon&r=PG", "display_name": "gkpln3", "link": "https://stackoverflow.com/users/2836444/gkpln3"}, "is_accepted": false, "score": 1, "last_activity_date": 1574851567, "creation_date": 1574851567, "answer_id": 59068391, "question_id": 59068339, "link": "https://stackoverflow.com/questions/59068339/unexpected-output-in-c-programming-using-scanf-function/59068391#59068391", "title": "Unexpected output in C programming using scanf() function", "body": "<p>Remove the space after the \"%d\" in your code:</p>\n\n<pre><code>scanf(\"%d\", &amp;i);\nscanf(\"%d\", &amp;j);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11196, "user_id": 1079907, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a7c69e39fbec2c781db5f27b40f63023?s=128&d=identicon&r=PG", "display_name": "Sunil Bojanapally", "link": "https://stackoverflow.com/users/1079907/sunil-bojanapally"}, "is_accepted": true, "score": 5, "last_activity_date": 1574856447, "last_edit_date": 1592644375, "creation_date": 1574852595, "answer_id": 59068711, "question_id": 59068339, "link": "https://stackoverflow.com/questions/59068339/unexpected-output-in-c-programming-using-scanf-function/59068711#59068711", "title": "Unexpected output in C programming using scanf() function", "body": "<p><a href=\"https://linux.die.net/man/3/scanf\" rel=\"nofollow noreferrer\">scanf</a> says,</p>\n<blockquote>\n<p>The format string consists of a sequence of directives which describe how to\nprocess the sequence of input characters.</p>\n<p>A directive is one of the following:</p>\n<ul>\n<li>A sequence of white-space characters (space, tab, newline, etc.; see\nisspace(3)). <strong>This directive matches any amount of white space,\nincluding none, in the input.</strong></li>\n<li>...</li>\n</ul>\n</blockquote>\n<p>Which means any white space characters with directive as <code>%d&lt;space&gt;</code> will read a number followed by consuming a sequence of white space characters in the input and only returns until you type a non white space character. That how you are able to provide a number in addition.</p>\n"}], "owner": {"reputation": 19, "user_id": 12056181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9113920c7d415bfdf0f25a876fba9368?s=128&d=identicon&r=PG", "display_name": "user12056181", "link": "https://stackoverflow.com/users/12056181/user12056181"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 59068711, "answer_count": 2, "score": -1, "last_activity_date": 1574856447, "creation_date": 1574851388, "last_edit_date": 1574852295, "question_id": 59068339, "link": "https://stackoverflow.com/questions/59068339/unexpected-output-in-c-programming-using-scanf-function", "title": "Unexpected output in C programming using scanf() function", "body": "<p>I got an unexpected output in C programming like this(<a href=\"https://imgur.com/a/4aopLjI\" rel=\"nofollow noreferrer\">https://imgur.com/a/4aopLjI</a>).</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(void) {\n    int i,j;\n    scanf(\"%d \",&amp;i);\n    scanf(\"%d \",&amp;j);\n    printf(\"\\n%d \\n\",i);\n    printf(\"%d\",j);\n}\n</code></pre>\n\n<p>The program seems to take in 3 inputs and displays only the 1st two and i have no clue why. Any ideas ?</p>\n"}, {"tags": ["c", "yacc", "lex"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1574852923, "post_id": 59067742, "comment_id": 104375755, "body": "You don&#39;t. You handle it in the grammar."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1574853243, "post_id": 59067742, "comment_id": 104375953, "body": "@user207421 can you please shed some light on how to do it."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1574903231, "post_id": 59067742, "comment_id": 104397774, "body": "Handle <code>[</code>, <code>]</code>, and the numeric literal inside them as three separate tokens and parse them in the grammar, such that <code>[0-9]+</code> returns <code>NUMERIC</code> in the lexer, similarly to your rule for ALPHANUMERIC, and in the grammar <code>BUS_PORT: &#39;[&#39; NUMERIC &#39;]&#39;</code>."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1574921547, "post_id": 59067742, "comment_id": 104401769, "body": "@user207421 I was able to make it work. Thank you."}, {"owner": {"reputation": 5175, "user_id": 4370109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UcQgO.jpg?s=128&g=1", "display_name": "Brian Tompsett - \u6c64\u83b1\u6069", "link": "https://stackoverflow.com/users/4370109/brian-tompsett-%e6%b1%a4%e8%8e%b1%e6%81%a9"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1574943300, "post_id": 59067742, "comment_id": 104412229, "body": "@user207421 Can you put that as an answer?"}], "answers": [{"tags": [], "owner": {"reputation": 488, "user_id": 12199970, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o1lnLQaFIl4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd-DeKatHNuf7q7OLUjUujB8yO-xQ/photo.jpg?sz=128", "display_name": "Venkatesh Nandigama", "link": "https://stackoverflow.com/users/12199970/venkatesh-nandigama"}, "is_accepted": true, "score": 1, "last_activity_date": 1574951435, "creation_date": 1574951435, "answer_id": 59091120, "question_id": 59067742, "link": "https://stackoverflow.com/questions/59067742/how-to-match-optional-token-in-lex/59091120#59091120", "title": "How to match optional token in lex", "body": "<p>Array element access operation where every opening '[' should have the corresponding closing ']' is handled at parsing level.</p>\n\n<p>In lex specification,replace</p>\n\n<pre><code>[\\[0-9\\]]* {yylval.str =strdup(yytext);return BUS_PORT;}\n</code></pre>\n\n<p>by</p>\n\n<pre><code>  [0-9]+   {}\n   \"[\"     { return *yytext;} \n   \"]\"     { return *yytext;}\n</code></pre>\n\n<p>In parser specification, replace</p>\n\n<pre><code>  port_name  : ALPHANUMERIC\n             | ALPHANUMERIC BUS_PORT { $$ = $1;}\n</code></pre>\n\n<p>by</p>\n\n<pre><code>  port_name  : ALPHANUMERIC\n             | ALPHANUMERIC '[' BUS_PORT ']' { $$ = $1;}\n</code></pre>\n\n<p>One more solution is, change BUS_PORT token rule to</p>\n\n<pre><code>  \\[[0-9]+\\] {yylval.str =strdup(yytext);return BUS_PORT;}\n</code></pre>\n\n<p>It recognizes [ followed by one or digits followed by ], works only for fixed-number of dimensions</p>\n"}], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 59091120, "answer_count": 1, "score": -1, "last_activity_date": 1574951435, "creation_date": 1574849508, "last_edit_date": 1574863914, "question_id": 59067742, "link": "https://stackoverflow.com/questions/59067742/how-to-match-optional-token-in-lex", "title": "How to match optional token in lex", "body": "<p>I have file with strings as below.</p>\n\n<pre><code>PORT = en, PIN = P3; \nPORT = dummy[9], PIN = P41;\nPORT = dummy[8], PIN = P42;\nPORT = dummy[7], PIN = P43;\nPORT = dummy[6], PIN = P44;\nPORT = dummy[5], PIN = P45;\nPORT = dummy[4], PIN = P46;\nPORT = dummy[3], PIN = P47;\nPORT = dummy[2], PIN = P48;\nPORT = dummy[1], PIN = P49;\nPORT = dummy[0], PIN = P50;\nPORT = out1, PIN = P6; \n</code></pre>\n\n<p>I'm trying to extract <code>PORT</code> and <code>PIN</code> using <code>lex</code> as below.</p>\n\n<p>lex grammer.</p>\n\n<pre><code>%%\n\"=\"                    { return EQUALS; }\n\",\"                    { return COMMA; }\n\";\"                    { return SEMICOLON; }\nPORT                   { return PORT; }\nPIN                    { return PIN; }\n[\\[0-9\\]]* {yylval.str =strdup(yytext);return BUS_PORT;}\n[a-zA-Z_][a-zA-Z0-9_]* {yylval.str =strdup(yytext);return ALPHANUMERIC;}\n\"//\".* | [\\t]          {; }\n\"/*\"[.\\n]*\"*/\"         {; }\n\\n                     {; }\n.                      {; }\n%%\n</code></pre>\n\n<p>And respective <code>yacc</code> file.</p>\n\n<pre><code>%token EQUALS\n%token COMMA\n%token SEMICOLON\n%token PIN\n%token PORT\n%token &lt;str&gt; ALPHANUMERIC\n%token &lt;str&gt; BUS_PORT\n%type &lt;str&gt; port_name\n%type &lt;str&gt; pin_name\n\n%%\n\nphysical_command : sub_command\n                 | physical_command sub_command\n                 ;\nsub_command      : port_command\n                 ;\n\nport_command     : PORT EQUALS port_name COMMA PIN EQUALS pin_name SEMICOLON\n                 {\n                   pm-&gt;addPortAndPin(std::string($3),std::string($7));\n                 }\n                 ;\n\nport_name        : ALPHANUMERIC\n                 | ALPHANUMERIC BUS_PORT\n                 {\n                   $$ = $1;\n                 }\n                 ;\npin_name         : ALPHANUMERIC\n                 {\n                   $$ = $1;\n                 }\n                 ;\n%%\n</code></pre>\n\n<hr>\n\n<p>If you see <code>port</code> name can be an array type {<code>dummy[10]</code>, <code>dummy[9]</code>..etc} or normal type.\nTo parse it I have written rule as below.</p>\n\n<pre><code>port_name        : ALPHANUMERIC //for normal type\n                 | ALPHANUMERIC BUS_PORT  //for array type\n                 {\n                   $$ = $1;\n                 }\n</code></pre>\n\n<p>And grammar is </p>\n\n<pre><code>[\\[0-9\\]]* {yylval.str =strdup(yytext);return BUS_PORT;}\n[a-zA-Z_][a-zA-Z0-9_]* {yylval.str =strdup(yytext);return ALPHANUMERIC;}\n</code></pre>\n\n<p><strong>My Question:</strong></p>\n\n<p>I'm not able to parse array type with the above rules, my output looks like below. Please help me with the rules such that I can parse normal and array type.</p>\n\n<pre><code>Port = en       Pin = P3\nPort = dummy    Pin = P41 //should have been dummy[9]\nPort = dummy    Pin = P42 //should have been dummy[8]\nPort = dummy    Pin = P43\nPort = dummy    Pin = P44\nPort = dummy    Pin = P45\nPort = dummy    Pin = P46\nPort = dummy    Pin = P47\nPort = dummy    Pin = P48\nPort = dummy    Pin = P49\nPort = dummy    Pin = P50\nPort = out1     Pin = P6\n</code></pre>\n"}, {"tags": ["c", "function", "function-pointers", "function-composition"], "answers": [{"comments": [{"owner": {"reputation": 679, "user_id": 8803665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KV4Zb.png?s=128&g=1", "display_name": "Theo d&#39;Or", "link": "https://stackoverflow.com/users/8803665/theo-dor"}, "edited": false, "score": 0, "creation_date": 1574848958, "post_id": 59067520, "comment_id": 104373452, "body": "You have changed the function signature, simplifying the problem. I want to implement the Wiki declaration as given."}, {"owner": {"reputation": 679, "user_id": 8803665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KV4Zb.png?s=128&g=1", "display_name": "Theo d&#39;Or", "link": "https://stackoverflow.com/users/8803665/theo-dor"}, "edited": false, "score": 0, "creation_date": 1574861075, "post_id": 59067520, "comment_id": 104380337, "body": "Although I can&#39;t accept this answer due to the changed signature, I like the solution for its simplicity - thank you!"}], "tags": [], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "is_accepted": false, "score": 4, "last_activity_date": 1574853314, "last_edit_date": 1574853314, "creation_date": 1574848776, "answer_id": 59067520, "question_id": 59067423, "link": "https://stackoverflow.com/questions/59067423/defining-and-calling-higher-order-function-composition-functions-with-function-p/59067520#59067520", "title": "Defining and calling higher-order function composition functions with function pointers in C", "body": "<p>There are a few issues to address here.</p>\n\n<ul>\n<li>In C, you can't dynamically compose functions at run-time; only statically, at compile-time. Thus, you cannot achieve, with the signature you've chosen for <code>compose</code>, the run-time composition you're after. If <code>compose</code> is to return a (pointer to a) function - it can only return a pre-existing function. (*)</li>\n<li>In C, when you use the identifier of a function (which you've already defined) - the type is actually a function pointer already, i.e. the \"invocation operator\" (or the \"parentheses operator\") always applies to function pointers.</li>\n<li>Your syntax is a bit off.</li>\n</ul>\n\n<p>Try this modification to your code:</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n\nint a(int x) {\n    return x + 1;\n}\n\nint b(int x) {\n    return x * 2;\n}\n\nint compose(int (*f)(int y), int (*g)(int z), int x) {\n    return f(x) - g(x);\n}\n\nint main(void) {\n    int x = 5;\n    int r = compose(a, b, x);\n    printf(\"Compose result for x = %d: %d\\n\", x, r);\n\n    return 0;\n}\n</code></pre>\n\n<p>This <a href=\"https://godbolt.org/z/kdmpBX\" rel=\"nofollow noreferrer\">compiles</a>.</p>\n\n<p><sub>(*) - You could theoretically perform run-time compilation and return a link to the address of the resulting machine code, but that's not a language facility. In practice that's irrelevant</sub></p>\n"}, {"comments": [{"owner": {"reputation": 679, "user_id": 8803665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KV4Zb.png?s=128&g=1", "display_name": "Theo d&#39;Or", "link": "https://stackoverflow.com/users/8803665/theo-dor"}, "edited": false, "score": 0, "creation_date": 1574849909, "post_id": 59067590, "comment_id": 104374011, "body": "Thanks for pointing out where the errors are, but you haven&#39;t presented a working solution and I have so far not been able to create it. Please consider editing your answer so that my a and b functions are used in the composition."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 679, "user_id": 8803665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KV4Zb.png?s=128&g=1", "display_name": "Theo d&#39;Or", "link": "https://stackoverflow.com/users/8803665/theo-dor"}, "edited": false, "score": 0, "creation_date": 1574851029, "post_id": 59067590, "comment_id": 104374700, "body": "@Theod&#39;Or But <code>a</code> and <code>b</code> <i>are</i> used... They&#39;re stored in the global variables <code>f1</code> and <code>f2</code> which are called by <code>compose_helper</code>."}, {"owner": {"reputation": 679, "user_id": 8803665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KV4Zb.png?s=128&g=1", "display_name": "Theo d&#39;Or", "link": "https://stackoverflow.com/users/8803665/theo-dor"}, "edited": false, "score": 0, "creation_date": 1574861006, "post_id": 59067590, "comment_id": 104380288, "body": "But of course! Answer accepted as it demonstrates how the Wiki declaration may be implemented."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1574849470, "last_edit_date": 1574849470, "creation_date": 1574848982, "answer_id": 59067590, "question_id": 59067423, "link": "https://stackoverflow.com/questions/59067423/defining-and-calling-higher-order-function-composition-functions-with-function-p/59067590#59067590", "title": "Defining and calling higher-order function composition functions with function pointers in C", "body": "<p>Your <code>compose</code> function is declared to return a function pointer, but calculates and returns an <code>int</code> value instead.</p>\n\n<p>Also <code>(*a)(x)</code> calls the <code>a</code> function and you pass the <code>int</code> result to <code>compose</code>, instead of a pointer to the function <code>a</code> itself. Same with <code>b</code>.</p>\n\n<p>To solve your problem you first should call <code>compose</code> with pointers to the functions <code>a</code> and <code>b</code>:</p>\n\n<pre><code>int r = (*compose(&amp;a, &amp;b))(x);\n</code></pre>\n\n<p>Then you need to make <code>compose</code> return a pointer to a function, which includes creating the function to be returned:</p>\n\n<pre><code>int (*f1)(int);\nint (*f2)(int);\n\nint compose_helper(int x)\n{\n    return f1(x) - f2(x);\n}\n\nint (*compose(int (*f1_)(int), int (*f2_)(int)))(int)\n{\n    f1 = f1_;\n    f2 = f2_;\n    return &amp;compose_helper;\n}\n</code></pre>\n\n<p>In C there's really no nice way of doing this, as function composition can't be done at run-time and there needs to be global state.</p>\n\n<hr>\n\n<p>As a side-note I really recommend that you create type-aliases for the function-pointers to make it all easier to read and understand.</p>\n\n<p>As in</p>\n\n<pre><code>typedef int (fp_type)(int);\n\nfp_type *f1;\nfp_type *f2;\n\nfp_type *compose(fp_type *f1_, fp_type *f2_) { ... }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 285, "user_id": 5841956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v9UOv.png?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/5841956/ralph"}, "is_accepted": false, "score": 1, "last_activity_date": 1574852873, "creation_date": 1574852873, "answer_id": 59068801, "question_id": 59067423, "link": "https://stackoverflow.com/questions/59067423/defining-and-calling-higher-order-function-composition-functions-with-function-p/59068801#59068801", "title": "Defining and calling higher-order function composition functions with function pointers in C", "body": "<p>In C you cannot create new functions at runtime; <code>compose</code> can only return a predefined function. Here is a short example for such a function:</p>\n\n<pre><code>int null(int x) { return 0; }\nint f1(int x) { return x*x; }\nint f2(int x) { return 2*x; }\n\nint sub_f2_f1 ( int x ) { return f2(x)-f1(x); }\nint sub_f1_f2 ( int x ) { return f1(x)-f2(x); }\n/*...*/\n\nint (*compose(int (*f)(int), int (*g)(int)))(int)\n{\n  if (f1==f2) return null;\n  if (f2==null) return f1;\n  if (f==f2 &amp;&amp; g==f1) return sub_f2_f1;\n  if (f==f1 &amp;&amp; g==f2) return sub_f1_f2;\n  /*...*/\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 679, "user_id": 8803665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KV4Zb.png?s=128&g=1", "display_name": "Theo d&#39;Or", "link": "https://stackoverflow.com/users/8803665/theo-dor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 59067590, "answer_count": 3, "score": 1, "last_activity_date": 1574855475, "creation_date": 1574848424, "question_id": 59067423, "link": "https://stackoverflow.com/questions/59067423/defining-and-calling-higher-order-function-composition-functions-with-function-p", "title": "Defining and calling higher-order function composition functions with function pointers in C", "body": "<p>The Wikipedia article on <a href=\"https://en.wikipedia.org/wiki/Function_type\" rel=\"nofollow noreferrer\">function types</a> lists an interesting declaration of a \"higher-order function composition function\":</p>\n\n<pre><code>int (*compose(int (*f)(int), int (*g)(int)))(int);\n</code></pre>\n\n<p>As a learning exercise, I wanted to implement this in a test program, but failed, with the compiler throwing a number of warnings and errors. My attempt:</p>\n\n<pre><code>int a(int x) {\n    return x + 1;\n}\n\nint b(int x) {\n    return x * 2;\n}\n\nint (*compose(int (*f)(int y), int (*g)(int z)))(int x) {\n    return (*f)(x) - (*g)(x);\n}\n\nint main(void) {\n    int x = 5;\n    int r = (*compose)((*a)(x), (*b)(x))(x);\n    printf(\"Compose result for x = %d: %d\\n\", x, r);\n\n    return 0;\n}\n</code></pre>\n\n<p>I would be grateful for an explanation of how the declaration from Wikipedia differs from a simple function composition like <code>f(g(h(x)))</code> and how it may be implemented, preferrably with a simple program similar to mine.</p>\n"}, {"tags": ["c", "opengl"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1574850351, "post_id": 59067272, "comment_id": 104374283, "body": "Please add your shaders."}, {"owner": {"reputation": 157, "user_id": 9486670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44bb5f92043e0bbc21b8d5d43526613?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9486670/chris"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1574905890, "post_id": 59067272, "comment_id": 104398206, "body": "I have added the shaders at the end of the question,thanks for help!"}, {"owner": {"reputation": 157, "user_id": 9486670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44bb5f92043e0bbc21b8d5d43526613?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9486670/chris"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1574909203, "post_id": 59067272, "comment_id": 104398804, "body": "I think the problem comes from the function glDrawBuffers(),the fragment shader should write same data into render buffer GL_COLOR_ATTACHMENT0 and GL_COLOR_ATTACHMENT1,but result doesn&#39;t follow this way."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1574933876, "post_id": 59067272, "comment_id": 104407080, "body": "Also what is the vertex data for the last triangle?"}, {"owner": {"reputation": 157, "user_id": 9486670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44bb5f92043e0bbc21b8d5d43526613?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9486670/chris"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1574992147, "post_id": 59067272, "comment_id": 104428918, "body": "The first section is data code"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1575026301, "post_id": 59067272, "comment_id": 104439509, "body": "The first section has two triangles and you are drawing three."}, {"owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "edited": false, "score": 1, "creation_date": 1575071192, "post_id": 59067272, "comment_id": 104455103, "body": "Your shaders write only to one output, which most likely ends up as color index 0, the outher two outputs are just undefined value, as per the spec"}, {"owner": {"reputation": 157, "user_id": 9486670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44bb5f92043e0bbc21b8d5d43526613?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9486670/chris"}, "edited": false, "score": 0, "creation_date": 1575271902, "post_id": 59067272, "comment_id": 104496283, "body": "I tried to write data in three render buffers,data in the first one is correct,position data in the second is correct ,but color data isn&#39;t, and there is no data in third one.So I guess though using glDrawBuffers(3,buffers), there must be some limits."}, {"owner": {"reputation": 157, "user_id": 9486670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44bb5f92043e0bbc21b8d5d43526613?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9486670/chris"}, "edited": false, "score": 0, "creation_date": 1575282461, "post_id": 59067272, "comment_id": 104500991, "body": "I thought the codes are too long,so just casted some parts ,now I pasted all the codes ,sorry for the unclear question."}], "owner": {"reputation": 157, "user_id": 9486670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44bb5f92043e0bbc21b8d5d43526613?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9486670/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1575282110, "creation_date": 1574847964, "last_edit_date": 1575282110, "question_id": 59067272, "link": "https://stackoverflow.com/questions/59067272/why-the-render-buffer-data-is-different-produced-by-the-same-pipe-line-in-opengl", "title": "Why the render buffer data is different produced by the same pipe line in OpenGL?", "body": "<p>The whole codes:</p>\n\n<pre><code>//two triangles color and position data\nVertex Verts[9] = { \n    { { 255,0,0,255 },{ 0.0f, 0.9f, 0.0f } },\n    { { 0,255,0,255 },{ -0.9f, -0.9f, 0.0f } },\n    { { 0,0,255,255 },{ 0.9f, -0.9f, 0.0f } } ,\n    { { 255,255,255,255 },{ 0.0f, 0.8f, -0.2f } } ,\n    { { 255,255,255,255 },{ -0.4f, 0.0f, -0.2f } } ,\n    { { 255,255,255,255 },{ 0.4f, 0.0f, -0.2f } } ,\n};\nGLuint Program = 0;\nGLuint vert;\nGLuint vbo;\nGLuint RendBuf[4], FrameBuf[2];\n</code></pre>\n\n<p>This is buffer set codes:</p>\n\n<pre><code>void Init()\n{\n    glGenVertexArrays(1, &amp;vert);\n    glBindVertexArray(vert);\n    glGenBuffers(1, &amp;vbo);\n    glBindBuffer(GL_ARRAY_BUFFER, vbo);\n    glBufferData(GL_ARRAY_BUFFER, sizeof(Verts), Verts, GL_STATIC_DRAW);\n    glVertexAttribPointer(0, 4, GL_UNSIGNED_BYTE, GL_TRUE, sizeof(Vertex), BUFFER_OFFSET(0));\n    glEnableVertexAttribArray(0);\n    glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, sizeof(Vertex), BUFFER_OFFSET(sizeof(Verts-&gt;color)));\n    glEnableVertexAttribArray(1);\n    glClearColor(0.5f, 0.5f, 0.5f, 1.0f);\n    glUseProgram(Program);\n</code></pre>\n\n<p>I generate 4 render buffer,one depth buffer,three color buffer:</p>\n\n<pre><code>    glGenRenderbuffers(4, RendBuf);\n    glBindRenderbuffer(GL_RENDERBUFFER, RendBuf[0]);\n    glRenderbufferStorage(GL_RENDERBUFFER, GL_RGBA, 200, 200);\n    glBindRenderbuffer(GL_RENDERBUFFER, RendBuf[1]);\n    glRenderbufferStorage(GL_RENDERBUFFER, GL_DEPTH_COMPONENT, 200, 200);\n    glBindRenderbuffer(GL_RENDERBUFFER, RendBuf[2]);\n    glRenderbufferStorage(GL_RENDERBUFFER, GL_RGBA, 200, 200);\n    glBindRenderbuffer(GL_RENDERBUFFER, RendBuf[3]);\n    glRenderbufferStorage(GL_RENDERBUFFER, GL_RGBA, 200, 200);\n    //all buffer objects are bound to framebuffer object:FrameBuf[0]\n    glGenFramebuffers(1, &amp;FrameBuf[0]);\n    glBindFramebuffer(GL_DRAW_FRAMEBUFFER, FrameBuf[0]);\n    glFramebufferRenderbuffer(GL_DRAW_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, RendBuf[0]);  \n    glFramebufferRenderbuffer(GL_DRAW_FRAMEBUFFER, GL_COLOR_ATTACHMENT1, GL_RENDERBUFFER, RendBuf[2]);\n    glFramebufferRenderbuffer(GL_DRAW_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, RendBuf[1]);   \n    glFramebufferRenderbuffer(GL_DRAW_FRAMEBUFFER, GL_COLOR_ATTACHMENT2, GL_RENDERBUFFER, RendBuf[3]);\n}\n</code></pre>\n\n<p>This is render code:</p>\n\n<pre><code>void Display()\n{\n    //draw in framebuffer\n    glBindFramebuffer(GL_DRAW_FRAMEBUFFER, FrameBuf[0]);\n    glViewport(0, 0, 200, 200);\n    GLenum bufs[3] = { GL_COLOR_ATTACHMENT0 , GL_COLOR_ATTACHMENT1 , GL_COLOR_ATTACHMENT2};\n    glDrawBuffers(3,bufs);\n    glClear(GL_COLOR_BUFFER_BIT|GL_DEPTH_BUFFER_BIT);\n</code></pre>\n\n<p>change the background color of three triangles</p>\n\n<pre><code>    float Color[] = { 1.0f, 0.0f, 0.0f, 1.0f };\n    glClearBufferfv(GL_COLOR, 0, Color);\n    float Color1[] = { 1.0f, 1.0f, 0.0f, 1.0f };\n    glClearBufferfv(GL_COLOR, 1, Color1);\n    float Color2[] = { 0.0f, 1.0f, 1.0f, 1.0f };\n    glClearBufferfv(GL_COLOR, 2, Color2);\n    glBindVertexArray(vert);\n    glEnable(GL_DEPTH_TEST);\n    glDrawArrays(GL_TRIANGLES, 0, 6);\n</code></pre>\n\n<p>copy the data from framebuffer to screen buffer</p>\n\n<pre><code>    glBindFramebuffer(GL_READ_FRAMEBUFFER, FrameBuf[0]);\n    glBindFramebuffer(GL_DRAW_FRAMEBUFFER, 0);\n    glViewport(0, 0, 400, 400);\n    glClear(GL_COLOR_BUFFER_BIT|GL_DEPTH_BUFFER_BIT);\n    glReadBuffer(GL_COLOR_ATTACHMENT0);\n    glBlitFramebuffer(0, 0, 200, 200, 0, 0, 200, 200, GL_COLOR_BUFFER_BIT, GL_NEAREST);\n    glReadBuffer(GL_COLOR_ATTACHMENT1);\n    glBlitFramebuffer(0, 0, 200, 200, 200, 0, 400, 200,GL_COLOR_BUFFER_BIT, GL_NEAREST);\n    glReadBuffer(GL_COLOR_ATTACHMENT2);\n    glBlitFramebuffer(0, 0, 200, 200, 0, 200, 200, 400,GL_COLOR_BUFFER_BIT, GL_NEAREST);\n    glutSwapBuffers();\n}\n</code></pre>\n\n<p>the vertex shader and fragment shader:</p>\n\n<pre><code>layout(location = 0) in vec4 vColor;\nlayout(location = 1) in vec4 vPos;\nvoid main()\n{\n    gl_Position = vPos;\n    color = vColor;\n}\n\nlayout(location = 0) out vec4 fColor;\nlayout(location = 1) out vec4 fColor2;\nvoid main()\n{\n    fColor = color;\n    fColor2 = vec4(0.0, 0.0, 1.0, 1.0);\n}\n</code></pre>\n\n<p>The first triangle is correct,the second is a blue triangle on yellow background,the third one is just light blue background.</p>\n"}, {"tags": ["c", "pic", "adc"], "comments": [{"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1574848162, "post_id": 59067179, "comment_id": 104372932, "body": "every <code>case</code>needs a <code>break;</code>"}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1574848528, "post_id": 59067179, "comment_id": 104373177, "body": "you don&#39;t do anything with <code>middleSens</code> and <code>rightSens</code>"}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1574848646, "post_id": 59067179, "comment_id": 104373240, "body": "And please indent your code, it&#39; really hard to read"}, {"owner": {"reputation": 51, "user_id": 9131627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34c38f220cb706fd5e74588fc97f7cb?s=128&d=identicon&r=PG&f=1", "display_name": "MendelumS", "link": "https://stackoverflow.com/users/9131627/mendelums"}, "reply_to_user": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1574849460, "post_id": 59067179, "comment_id": 104373754, "body": "I explained in the question I can&#39;t upload the entire code, but middleSens and rightSens are derived the same way leftSens is, using a different channel"}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1574923152, "post_id": 59067179, "comment_id": 104402306, "body": "Try to use the bits in LATB as output."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9131627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34c38f220cb706fd5e74588fc97f7cb?s=128&d=identicon&r=PG&f=1", "display_name": "MendelumS", "link": "https://stackoverflow.com/users/9131627/mendelums"}, "edited": false, "score": 0, "creation_date": 1574849565, "post_id": 59067351, "comment_id": 104373823, "body": "No thats not by design thats just me overlooking it, I&#39;ll sort that out and test it again, but would that be the reason that all my outputs end up being the same? For example, there are no cases here where all outputs are 1, but I keep getting all outputs at 1 when I test with a multimeter."}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1574850094, "post_id": 59067351, "comment_id": 104374120, "body": "Do you switch your output to digital with <code>ANSEL</code>register?"}, {"owner": {"reputation": 51, "user_id": 9131627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34c38f220cb706fd5e74588fc97f7cb?s=128&d=identicon&r=PG&f=1", "display_name": "MendelumS", "link": "https://stackoverflow.com/users/9131627/mendelums"}, "edited": false, "score": 0, "creation_date": 1574851886, "post_id": 59067351, "comment_id": 104375180, "body": "As far as I can tell Port B is just digital. On the pinout they&#39;re not labelled as analog so I&#39;m not sure if ANSEL is necessary"}, {"owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "reply_to_user": {"reputation": 51, "user_id": 9131627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34c38f220cb706fd5e74588fc97f7cb?s=128&d=identicon&r=PG&f=1", "display_name": "MendelumS", "link": "https://stackoverflow.com/users/9131627/mendelums"}, "edited": false, "score": 1, "creation_date": 1574852787, "post_id": 59067351, "comment_id": 104375679, "body": "@Sam a multimeter is usually pretty slow to measure a signal, so if your outputs toggle quickly (e.g. near or above kHz-frequency), the multimeter may not measure them correctly and you may be misled. I would personally be cautious to trust a signal I haven&#39;t &quot;seen&quot; on an oscilloscope. Can&#39;t say if switch/case fall-through is the problem or not - I can&#39;t read much of the code, because it is written at the register abstraction level, and I don&#39;t know much about PICs and their registers."}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1574852903, "post_id": 59067351, "comment_id": 104375743, "body": "check <code>TRISB</code>register"}, {"owner": {"reputation": 51, "user_id": 9131627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34c38f220cb706fd5e74588fc97f7cb?s=128&d=identicon&r=PG&f=1", "display_name": "MendelumS", "link": "https://stackoverflow.com/users/9131627/mendelums"}, "edited": false, "score": 0, "creation_date": 1574853243, "post_id": 59067351, "comment_id": 104375954, "body": "@MortenJensen I&#39;m going to start using a logic probe instead seeing as these are digital signals, but when i was using the multimeter it was showing around 5V, which is the input signal. It was fluctuating a bit but it wasn&#39;t ever going down near 0V"}, {"owner": {"reputation": 51, "user_id": 9131627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34c38f220cb706fd5e74588fc97f7cb?s=128&d=identicon&r=PG&f=1", "display_name": "MendelumS", "link": "https://stackoverflow.com/users/9131627/mendelums"}, "reply_to_user": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1574853270, "post_id": 59067351, "comment_id": 104375972, "body": "@Mike TRISB is set to 0, configured as outputs"}, {"owner": {"reputation": 51, "user_id": 9131627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34c38f220cb706fd5e74588fc97f7cb?s=128&d=identicon&r=PG&f=1", "display_name": "MendelumS", "link": "https://stackoverflow.com/users/9131627/mendelums"}, "edited": false, "score": 0, "creation_date": 1574865106, "post_id": 59067351, "comment_id": 104382748, "body": "Thats the whole code? The only thing I left out was 2 repeated functions"}], "tags": [], "owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "is_accepted": false, "score": 0, "last_activity_date": 1574848206, "creation_date": 1574848206, "answer_id": 59067351, "question_id": 59067179, "link": "https://stackoverflow.com/questions/59067179/struggling-with-the-output-of-adc-on-a-pic18f252/59067351#59067351", "title": "Struggling with the output of ADC on a PIC18F252", "body": "<p>Quick question: Is it by design that you are falling through your switch-cases? </p>\n\n<pre><code>void Motor_Output(unsigned char x, unsigned char y, unsigned char z){\n // ...\nswitch(output){\n case 0x0:\n  ... &lt;-- no break, will continue to execute next case\n case 0x1:\n  ... &lt;-- no break, will continue to execute next case\n case 0x2:\n  ... &lt;-- no break, will continue to execute next case\n case 0x3:\n  ... &lt;-- no break, will continue to execute next case\n case 0x4:\n  ... &lt;-- no break, will continue to execute next case\n case 0x5:\n  ... &lt;-- no break, will continue to execute next case\n case 0x6:\n  ... &lt;-- no break, will continue to execute next case\n case 0x7:\n  ... &lt;-- no break, will continue to execute next case\n }\nreturn;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 9131627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34c38f220cb706fd5e74588fc97f7cb?s=128&d=identicon&r=PG&f=1", "display_name": "MendelumS", "link": "https://stackoverflow.com/users/9131627/mendelums"}, "edited": false, "score": 0, "creation_date": 1574865249, "post_id": 59070343, "comment_id": 104382848, "body": "I&#39;ve fixed the breaks in the cases now, but I&#39;m confused how the if statements only execute the first two? Can you not chain if/else if like that?"}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "reply_to_user": {"reputation": 51, "user_id": 9131627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34c38f220cb706fd5e74588fc97f7cb?s=128&d=identicon&r=PG&f=1", "display_name": "MendelumS", "link": "https://stackoverflow.com/users/9131627/mendelums"}, "edited": false, "score": 0, "creation_date": 1574867887, "post_id": 59070343, "comment_id": 104384394, "body": "Sure, you can, but most probably it does not implement the logic you want. Just as an exercise: Think about which branches are taken under different conditions. Hints are in my source comments and indentation."}], "tags": [], "owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "is_accepted": false, "score": 1, "last_activity_date": 1574857965, "creation_date": 1574857965, "answer_id": 59070343, "question_id": 59067179, "link": "https://stackoverflow.com/questions/59067179/struggling-with-the-output-of-adc-on-a-pic18f252/59070343#59070343", "title": "Struggling with the output of ADC on a PIC18F252", "body": "<p>Without going any deeper in analysis there are two major problems:</p>\n\n<ol>\n<li><p>The <code>if</code>-<code>else if</code>-chain will do just <em>one</em> assigment to <code>left</code>. To make that obvious I have indented your source this way without any other changes:</p>\n\n<pre><code>if (x &gt;= 173) {     // Either THIS...\n    left = 1;\n} else\n    if (x &lt; 173) {  // Or THAT will be true.\n        left = 0;\n    } else          // None of the following is executed therefore.\n        if (y &gt;= 173) {\n            middle = 1;\n        } else\n            if (y &lt; 173) {\n                middle = 0;\n            } else\n                if (z &gt;= 173) {\n                    right = 1;\n                } else\n                    if (z &lt; 173) {\n                        right = 0;\n                    }\n</code></pre>\n\n<p>So <code>middle</code> and <code>right</code> will have undefined values.</p></li>\n<li><p>All your <code>case</code>s in the <code>switch</code> are missing a <code>break</code>. So only the last case or none at all will be executed. Why \"none\"? Because <code>middle</code> and <code>right</code> have undefined values, resulting in a random value in <code>output</code>.</p>\n\n<p><em>Note: \"Random\" might be always the same value, depending on the bits set or reset at the locations of <code>middle</code> and <code>right</code>, respectively.</em></p></li>\n</ol>\n"}], "owner": {"reputation": 51, "user_id": 9131627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34c38f220cb706fd5e74588fc97f7cb?s=128&d=identicon&r=PG&f=1", "display_name": "MendelumS", "link": "https://stackoverflow.com/users/9131627/mendelums"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574857965, "creation_date": 1574847661, "last_edit_date": 1574852242, "question_id": 59067179, "link": "https://stackoverflow.com/questions/59067179/struggling-with-the-output-of-adc-on-a-pic18f252", "title": "Struggling with the output of ADC on a PIC18F252", "body": "<p>I've recently finished code for a PIC18F252 which uses the built in ADC to convert analogue inputs from 3 sensors into digital outputs that can be sent to motors. The code builds and uploads to the PIC perfectly fine, but unfortunately just doesn't work, and I'm struggling to see where the issue is. \nAfter testing the output ports for the motors, I've found that they are all outputting the same signal, when they shouldn't be, and it doesn't change depending on the sensors. \nMy first thought is that there's something wrong between the output of the ADC (loading the result from ADRESH), and the if statements used to assign a digital value to these outputs. \nI can't upload the entire code as this is coursework, but I've added the relevant parts. I've only included my function for AD conversion using one channel, but the functions for the other two channels are the same, just changing variables.</p>\n\n<p>If anyone is able to spot an issue with this code (presumably around the if statements) I would be grateful!</p>\n\n<pre><code>#include &lt;p18F252.h&gt; // PIC specific definitions\n#include &lt;xc.h&gt; // Xc8 compiler specifics\n#include &lt;stdio.h&gt; // Standard C I/O library\n#include &lt;stdlib.h&gt; // Standard C library\n\n// Function declarations\nvoid Config_ADC(void);\nvoid delay(void);\nvoid Motor_Output(unsigned char x, unsigned char y, unsigned char z);\nvoid channel3(void);\n\nunsigned char leftSens = 0b00000000; //Initialise left sensor variable\n\nvoid Config_ADC(void){\n    // ADC Setup\n    TRISA = 0xFF; // configure port A as inputs\n    ADCON1bits.ADFM =0; // left justified\n    ADCON1bits.PCFG3=0; \n    ADCON1bits.PCFG2=1;\n    ADCON1bits.PCFG1=0; \n    ADCON1bits.PCFG0=0; \n    ADCON1bits.ADCS2=0;\n    ADCON0bits.ADCS1=1;\n    ADCON0bits.ADCS0=0; \n    ADCON0bits.ADON =1; \n}\n\n// Function for a delay of 1ms\nvoid delay(void){ \n    T2CON = 0x49; // start counting from 73\n    PR2 = 0x7C; // stop count at 124\n    T2CONbits.TMR2ON = 1; // activate timer 2\n    while(!PIR1bits.TMR2IF); // wait for timer flag\n    T2CONbits.TMR2ON = 0; // stop timer 2\n    PIR1bits.TMR2IF = 0; // clear flag\n}\n\nvoid channel3(void){\n    ADCON0bits.CHS2 = 0; //Channel selection\n    ADCON0bits.CHS1 = 1;\n    ADCON0bits.CHS0 = 1;\n    delay(); // Acquisition time to charge hold capacitor\n    ADCON0bits.GO_DONE = 1; // Start Conversion\n    while(ADCON0bits.GO_DONE); // Wait for A/D Conversion to complete\n    leftSens = ADRESH; // Return result\n}\n\nvoid main(void){\n    TRISB = 0x00; // configure Port B as output\n    Config_ADC(); // load ADC\n    while(1) { //loop forever/\n        channel3(); // Call channel 3 conversion\n        Motor_Output(leftSens, middleSens, rightSens);\n    }\n}\n\n// Function to send instructions to motors\nvoid Motor_Output(unsigned char x, unsigned char y, unsigned char z){\n    int left, middle, right;\n    if(x &gt;= 173){left = 1;}   //173 chosen as threshold 8 bit value\n    else if(x &lt; 173){left = 0;}\n    else if(y &gt;= 173){middle = 1;}\n    else if(y &lt; 173){middle = 0;}\n    else if(z &gt;= 173){right = 1;}\n    else if(z &lt; 173){right = 0;}\n\n    unsigned char output;\n    output = (left &lt;&lt; 2) | (middle &lt;&lt; 1) | right;  //Bit shifted variables into one value\n    switch(output){\n        case 0x0:\n            PORTBbits.RB7 = 0; //Test for each output and activate motors accordingly\n            PORTBbits.RB6 = 1;\n            PORTBbits.RB5 = 0;\n            PORTBbits.RB4 = 1;\n        case 0x1:\n            PORTBbits.RB7 = 0; \n            PORTBbits.RB6 = 1;\n            PORTBbits.RB5 = 1;\n            PORTBbits.RB4 = 0;\n        case 0x2:\n            PORTBbits.RB7 = 0; \n            PORTBbits.RB6 = 1;\n            PORTBbits.RB5 = 0;\n            PORTBbits.RB4 = 1;\n        case 0x3:\n            PORTBbits.RB7 = 0; \n            PORTBbits.RB6 = 1;\n            PORTBbits.RB5 = 1;\n            PORTBbits.RB4 = 0;\n        case 0x4:\n            PORTBbits.RB7 = 1; \n            PORTBbits.RB6 = 0;\n            PORTBbits.RB5 = 0;\n            PORTBbits.RB4 = 1;\n        case 0x5:\n            PORTBbits.RB7 = 0;\n            PORTBbits.RB6 = 1;\n            PORTBbits.RB5 = 0;\n            PORTBbits.RB4 = 1;\n        case 0x6:\n            PORTBbits.RB7 = 1; \n            PORTBbits.RB6 = 0;\n            PORTBbits.RB5 = 0;\n            PORTBbits.RB4 = 1;\n        case 0x7:\n            PORTBbits.RB7 = 0; \n            PORTBbits.RB6 = 1;\n            PORTBbits.RB5 = 0;\n            PORTBbits.RB4 = 1; \n    }\n    return;\n}\n</code></pre>\n"}, {"tags": ["c", "bash", "echo", "argv", "argc"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1574847542, "post_id": 59067115, "comment_id": 104372585, "body": "This is unrelated to the C language. The shell creates the argument list. In other word, not it&#39;s not possible."}, {"owner": {"reputation": 681, "user_id": 4575505, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10204940618347955/picture?type=large", "display_name": "Thecave3", "link": "https://stackoverflow.com/users/4575505/thecave3"}, "edited": false, "score": 0, "creation_date": 1574847558, "post_id": 59067115, "comment_id": 104372593, "body": "you can use a loop and collect them into just one string using strncat syscall."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1574847653, "post_id": 59067115, "comment_id": 104372647, "body": "Or you can invoke your program like this <code>myecho &quot;hello world&quot;</code>, then <code>&quot;hello world&quot;</code> will be consideres as one argument by the shell and in your C  program <code>argv[1]</code> will point to <code>&quot;hello world&quot;</code>. But again this is a shell thing."}, {"owner": {"reputation": 13, "user_id": 9060893, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OvXlCfnYtlw/AAAAAAAAAAI/AAAAAAAAAR4/JaugNIMY_iU/photo.jpg?sz=128", "display_name": "Shivi Bar lev", "link": "https://stackoverflow.com/users/9060893/shivi-bar-lev"}, "edited": false, "score": 0, "creation_date": 1574847793, "post_id": 59067115, "comment_id": 104372720, "body": "so if the argument is between &quot;...&quot; it is considered a single argument?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574847959, "post_id": 59067115, "comment_id": 104372815, "body": "@ShiviBarlev yes, but this is unrelated to C, the shell is doing this."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1574853186, "post_id": 59067115, "comment_id": 104375924, "body": "In Windows, you can use the <code>GetCommandLineA</code> or <code>GetCommandLineW</code> functions to get the unsplit command line, because unlike Unix processes, it is actually the responsibility of the Windows process to split the command line into arguments. (For hosted C programs, this is done by the C start-up code before <code>main</code> is called.) You would still need to split off the initial argv[0] component."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1574853948, "post_id": 59067115, "comment_id": 104376339, "body": "Note that the real implementation of Unix echo is unlikely to join the arguments into a single string. Rather, it will output each argument individually with a space between each one and a newline at the end (although command line arguments may modify this behaviour to allow the trailing newline to be omitted, and to interpret various escape sequences in the argument strings)."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9060893, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OvXlCfnYtlw/AAAAAAAAAAI/AAAAAAAAAR4/JaugNIMY_iU/photo.jpg?sz=128", "display_name": "Shivi Bar lev", "link": "https://stackoverflow.com/users/9060893/shivi-bar-lev"}, "edited": false, "score": 0, "creation_date": 1574848697, "post_id": 59067290, "comment_id": 104373278, "body": "thanks! i will probably do the second thing you said."}], "tags": [], "owner": {"reputation": 1145, "user_id": 11783812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LFwV3.jpg?s=128&g=1", "display_name": "cocool97", "link": "https://stackoverflow.com/users/11783812/cocool97"}, "is_accepted": false, "score": 0, "last_activity_date": 1574848007, "creation_date": 1574848007, "answer_id": 59067290, "question_id": 59067115, "link": "https://stackoverflow.com/questions/59067115/is-there-a-way-to-limit-the-number-of-command-line-arguments/59067290#59067290", "title": "Is there a way to limit the number of command line arguments?", "body": "<p>You can rather loop over every element of <code>argv</code> by using <code>argc</code> to ensure you you won't read too deep. <br/>\nYou can also you require the launch of your programm to be : <code>./myProgram \"Here is my nice sentence\"</code></p>\n"}, {"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 1, "last_activity_date": 1574848021, "creation_date": 1574848021, "answer_id": 59067294, "question_id": 59067115, "link": "https://stackoverflow.com/questions/59067115/is-there-a-way-to-limit-the-number-of-command-line-arguments/59067294#59067294", "title": "Is there a way to limit the number of command line arguments?", "body": "<p>You can't do this directly, because the shell is splitting the arguments even before your program starts.</p>\n\n<p>Maybe you want something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char *argv[])\n{\n  char sentence[500] = { 0 };\n\n  for (int i = 1; i &lt; argc; i++)\n  {\n    strcat(sentence, argv[i]);\n    if (i &lt; argc - 1)\n      strcat(sentence, \" \");\n  }\n\n  printf(\"sentence = \\\"%s\\\"\", sentence);\n}\n</code></pre>\n\n<p>Disclaimer: no bounds checking is done for brevity.</p>\n\n<p>Example of invoking:</p>\n\n<pre><code>&gt; myecho Hello World 1 2 3\nsentence = \"Hello World 1 2 3\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9060893, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OvXlCfnYtlw/AAAAAAAAAAI/AAAAAAAAAR4/JaugNIMY_iU/photo.jpg?sz=128", "display_name": "Shivi Bar lev", "link": "https://stackoverflow.com/users/9060893/shivi-bar-lev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 59067294, "answer_count": 2, "score": 0, "last_activity_date": 1574848478, "creation_date": 1574847445, "last_edit_date": 1574848478, "question_id": 59067115, "link": "https://stackoverflow.com/questions/59067115/is-there-a-way-to-limit-the-number-of-command-line-arguments", "title": "Is there a way to limit the number of command line arguments?", "body": "<p>I am trying to do an implementation of the command 'echo' in C.</p>\n\n<p>I would like to have the entire sentence after the command 'echo' read into argv[1] in the command line instead of having each word passed as a separate argument.</p>\n\n<p>Is that possible in C?</p>\n"}, {"tags": ["c", "linux", "musl"], "comments": [{"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 2, "creation_date": 1574847465, "post_id": 59067076, "comment_id": 104372540, "body": "I suspect showing some code and telling us how you build this might make it easier to answer"}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1574847597, "post_id": 59067076, "comment_id": 104372618, "body": "You have probably forgotten to link with the right libraries. That is what &quot;undefined reference&quot; usually means."}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1574847612, "post_id": 59067076, "comment_id": 104372625, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/15890007/undefined-reference-to-ruserok-error\">undefined reference to ruserok error</a>"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1574849262, "post_id": 59067076, "comment_id": 104373654, "body": "<code>What can i do now?</code> - provide your own definition of the symbol. Either patch the file or write your own. <code>even though ruserok is defined in pam_rhosts.c</code> - ruserok should be defined in the standard library, not in pam sources. It&#39;s a <a href=\"https://linux.die.net/man/3/ruserok\" rel=\"nofollow noreferrer\">standard function</a>"}, {"owner": {"reputation": 7, "user_id": 11464477, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lwOMO5L97HY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reDEOMbuRgS1CB33sKRJE-SGzurSQ/mo/photo.jpg?sz=128", "display_name": "Sheik", "link": "https://stackoverflow.com/users/11464477/sheik"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1574860749, "post_id": 59067076, "comment_id": 104380136, "body": "@KamilCuk Is there any other way without  disturbing the source like just linking Uclibc."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1574860936, "post_id": 59067076, "comment_id": 104380247, "body": "It&#39;s because <code>Uclibc</code> <i>doesn&#39;t</i> provide ruserok, that pam needed to implement it itself. It looks like <code>musl</code> doesn&#39;t provide it either, so you could just remove the ifndef. Or add something along <code>#if defined(__UCLIBC__) || defined(__SOME_MACRO_THAT_MUSL_PROVIDSE_PROBABLY __MUSL__)</code>"}], "owner": {"reputation": 7, "user_id": 11464477, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lwOMO5L97HY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reDEOMbuRgS1CB33sKRJE-SGzurSQ/mo/photo.jpg?sz=128", "display_name": "Sheik", "link": "https://stackoverflow.com/users/11464477/sheik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574849031, "creation_date": 1574847284, "last_edit_date": 1574849031, "question_id": 59067076, "link": "https://stackoverflow.com/questions/59067076/error-undefined-reference-to-ruserok-while-compiling-pam-1-1-8-for-arm64", "title": "ERROR: undefined reference to `ruserok` - while compiling PAM-1.1.8 for arm64", "body": "<p><code>.libs/pam_rhosts.o: In function pam_sm_authenticate:\npam_rhosts.c:(.text+0x1e4): undefined reference to ruserok'</code></p>\n\n<p>While compiling Linux-PAM-1.1.8 for arm64. I get this error.</p>\n\n<p>ruserok is defined under a Macro check</p>\n\n<pre><code>    #ifdef __UCLIBC__\n    ...\n    ...\n    ...\n    int ruserok(const char *rhost, int superuser, const char *ruser,\n                            const char *luser)\n    {\n      */ruserok defined here*/\n    }\n    ...\n    ...\n    #endif\n</code></pre>\n\n<p>But i am not building with Uclibc but with musl</p>\n\n<p>What can i do now?</p>\n"}, {"tags": ["c++", "c", "coap", "openthread"], "comments": [{"owner": {"reputation": 1648, "user_id": 252525, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/422a06312e3faa6319f5787370438194?s=128&d=identicon&r=PG", "display_name": "jonathanberi", "link": "https://stackoverflow.com/users/252525/jonathanberi"}, "edited": false, "score": 0, "creation_date": 1574900624, "post_id": 59066398, "comment_id": 104397281, "body": "The CoAP client implementation is very minimal and is not intended to be used standalone. Have you considered busing libcoap instead? <a href=\"https://libcoap.net/\" rel=\"nofollow noreferrer\">libcoap.net</a>"}, {"owner": {"reputation": 1, "user_id": 12443588, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB9YvN7hrmlcKfxC2HRoWUpctSOYvNqc3uuXqbBog=k-s128", "display_name": "rptech", "link": "https://stackoverflow.com/users/12443588/rptech"}, "reply_to_user": {"reputation": 1648, "user_id": 252525, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/422a06312e3faa6319f5787370438194?s=128&d=identicon&r=PG", "display_name": "jonathanberi", "link": "https://stackoverflow.com/users/252525/jonathanberi"}, "edited": false, "score": 0, "creation_date": 1574925881, "post_id": 59066398, "comment_id": 104403276, "body": "@jonathanberi Thank you for your response. Regarding using libcoap, yes I am considering this option as well, but only if it is not possible with Openthread. Because CoAP APIs in Openthread are quite user friendly as compared to others, I am willing to go with Openthread. While you say &quot;very minimal&quot;, does it miss any critical feature (I am new to CoAP as well, so your guidance is much appreciated). I am aware that it does not have support of BLOCK TRANSFER at the moment. Is there anything else that I should be needing additionally ?"}, {"owner": {"reputation": 1648, "user_id": 252525, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/422a06312e3faa6319f5787370438194?s=128&d=identicon&r=PG", "display_name": "jonathanberi", "link": "https://stackoverflow.com/users/252525/jonathanberi"}, "edited": false, "score": 0, "creation_date": 1575041940, "post_id": 59066398, "comment_id": 104446766, "body": "<code>&gt; does it miss any critical feature</code> That would depend on your application, CoAP is a rich specification and has several extensions, including blockwise transfer.  Besides features, you&#39;re going to pay overhead for using the OpenThread implementation, even if you disable parts of the Thread stack."}], "owner": {"reputation": 1, "user_id": 12443588, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB9YvN7hrmlcKfxC2HRoWUpctSOYvNqc3uuXqbBog=k-s128", "display_name": "rptech", "link": "https://stackoverflow.com/users/12443588/rptech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574845226, "creation_date": 1574844910, "last_edit_date": 1574845226, "question_id": 59066398, "link": "https://stackoverflow.com/questions/59066398/coap-application-development-using-openthread-without-using-thread-protocol", "title": "CoAP application development using openthread without using thread protocol", "body": "<p>I want to use Openthread CoAP APIs and develop a CoAP client application(and a server as well later on). But I do not want to use the thread part of it. So I have following questions:</p>\n\n<ol>\n<li>Is it possible that I disable the thread part in openthread and only build COAP/S at build time ?</li>\n<li>Or, take the CoAP out of openthread and build it separately ?</li>\n</ol>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "misra"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1574842383, "post_id": 59065730, "comment_id": 104369867, "body": "Probably <code>if (fn1() == 1)</code> will do the job."}, {"owner": {"reputation": 21, "user_id": 3340164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb8db4bbe6085bc4badba917ff61db5?s=128&d=identicon&r=PG&f=1", "display_name": "user3340164", "link": "https://stackoverflow.com/users/3340164/user3340164"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1574842614, "post_id": 59065730, "comment_id": 104369979, "body": "I tried that already. But it says Mismatched essential type categories for binary operator [10.4 required]"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 4, "creation_date": 1574842804, "post_id": 59065730, "comment_id": 104370078, "body": "If you&#39;ve tried that, you should mention it in the question. Also show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. It&#39;s better to <i>show</i> your code rather than to <i>describe</i> it."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1574843953, "post_id": 59065730, "comment_id": 104370702, "body": "Does changing the return type to <code>bool</code> (or <code>_Bool</code>) helps?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1574844312, "post_id": 59065730, "comment_id": 104370888, "body": "If you don&#39;t understand these warnings, I would strongly recommend to stop stumbling around in the dark and actually read the MISRA-C document. There&#39;s two appendix C and D which serve to educate programmers about the various dangers of the language. Also check <a href=\"https://stackoverflow.com/questions/46073295/implicit-type-promotion-rules\">Implicit type promotion rules</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1574846508, "post_id": 59065730, "comment_id": 104372012, "body": "MISRA is overly strict in most cases. Unless you have a hard requirement that your code should pass MISRA then I really wouldn&#39;t care about it."}, {"owner": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "edited": false, "score": 0, "creation_date": 1575037093, "post_id": 59065730, "comment_id": 104444511, "body": "If changing the function return type is not feasible, you could always check <code>if ( fn() != 0 )</code>"}], "answers": [{"comments": [{"owner": {"reputation": 602, "user_id": 12342718, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IvS6W.jpg?s=128&g=1", "display_name": "Bktero", "link": "https://stackoverflow.com/users/12342718/bktero"}, "edited": false, "score": 1, "creation_date": 1574844622, "post_id": 59066184, "comment_id": 104371037, "body": "Changing the return type to <code>bool</code> seems to be a good solution."}, {"owner": {"reputation": 21, "user_id": 3340164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb8db4bbe6085bc4badba917ff61db5?s=128&d=identicon&r=PG&f=1", "display_name": "user3340164", "link": "https://stackoverflow.com/users/3340164/user3340164"}, "edited": false, "score": 0, "creation_date": 1574845049, "post_id": 59066184, "comment_id": 104371272, "body": "Thank you Lundin. 1u worked.     if((uint8_t) fn1() == 1u)   //Line 1"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 21, "user_id": 3340164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb8db4bbe6085bc4badba917ff61db5?s=128&d=identicon&r=PG&f=1", "display_name": "user3340164", "link": "https://stackoverflow.com/users/3340164/user3340164"}, "edited": false, "score": 0, "creation_date": 1574845081, "post_id": 59066184, "comment_id": 104371284, "body": "@user3340164 The cast isn&#39;t necessary."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 6, "last_activity_date": 1574844099, "creation_date": 1574844099, "answer_id": 59066184, "question_id": 59065730, "link": "https://stackoverflow.com/questions/59065730/how-can-i-make-my-code-in-compliance-with-misra-2012-rule10-4/59066184#59066184", "title": "How can I make my code in compliance with MISRA 2012 RULE10.4", "body": "<p>MISRA-C doesn't allow implicit checks against zero - all inputs to conditional statements must be \"essentially boolean\", which is what you get if you explicitly use logical operators like <code>==</code>.</p>\n\n<p>In addition, MISRA-C has various rules blocking you from mixing \"essenitally signed\" and \"essentially unsigned\" in the same expression, and thereby relying on implicit type promotions. So you can't write <code>if (fn1() == 1)</code> for that reason, since <code>1</code> is a signed type and there's also a rule requiring all integer constants to have <code>u</code> suffix.</p>\n\n<p>So one possible fix is <code>if (fn1() == 1u)</code>. However, since the function only returns 0 or 1, you can also cast its result to boolean type and that would be fine too: <code>if ((bool)fn())</code>. The best solution is however to rewrite the function to return <code>bool</code>, after which you can use <code>if(fn1())</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 3340164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb8db4bbe6085bc4badba917ff61db5?s=128&d=identicon&r=PG&f=1", "display_name": "user3340164", "link": "https://stackoverflow.com/users/3340164/user3340164"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1574844099, "creation_date": 1574842222, "question_id": 59065730, "link": "https://stackoverflow.com/questions/59065730/how-can-i-make-my-code-in-compliance-with-misra-2012-rule10-4", "title": "How can I make my code in compliance with MISRA 2012 RULE10.4", "body": "<pre><code>    if(fn1())   //Line 1\n     {\n     a++;\n     }\n</code></pre>\n\n<p>Here the return type of function fn1 is uint8_t. The function returns only values 0 or 1. </p>\n\n<p>PC Lint throws error for line 1 says \"Mismatched essential type categories for binary operator\" [RULE 10.4 required]</p>\n\n<p>Rule 10.4 says \"Both operands of an operator in which the usual arithmetic conversions are performed shall have the same essential type category\"</p>\n"}, {"tags": ["c", "arrays", "dynamic-memory-allocation", "fftw", "dft"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574844770, "post_id": 59065651, "comment_id": 104371114, "body": "Hiding arrays behind typedef is a bad idea. But they probably did it for a reason. Perhaps they meant <code>[0]</code> to be real and <code>[1]</code> to be complex? Also, C has built-in support for complex numbers since forever, so the best solution is to drop the icky custom types in favour for standard C."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574844798, "post_id": 59065651, "comment_id": 104371133, "body": "As for how to use 2D arrays. - Change <code>double *in;</code> to <code>double (*in)[N];</code>. - Change malloc to <code>in = malloc(sizeof(double) * N * N);</code> (remove the cast) - Access array by <code>in[i][j]</code>."}, {"owner": {"reputation": 11, "user_id": 10774507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f54ef91d82741190ce8dea1fae99c1d?s=128&d=identicon&r=PG&f=1", "display_name": "mmrbest", "link": "https://stackoverflow.com/users/10774507/mmrbest"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574845577, "post_id": 59065651, "comment_id": 104371507, "body": "@Lundin Indeed, <code>[0]</code> is meant to be real and <code>[1]</code> is meant to be complex, as mentioned in the documentation and confirmed by me with my experiments with 1D FFTW. Using the above program, I am now almost certain that the output variables must be accessed in the way I have mentioned in my question."}, {"owner": {"reputation": 11, "user_id": 10774507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f54ef91d82741190ce8dea1fae99c1d?s=128&d=identicon&r=PG&f=1", "display_name": "mmrbest", "link": "https://stackoverflow.com/users/10774507/mmrbest"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1574848055, "post_id": 59065651, "comment_id": 104372872, "body": "@Lundin As for the complex numbers, if the header for the complex number is included before the fftw header, FFTW will work with the complex type as defined by C. This has been mentioned in the documentation."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10774507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f54ef91d82741190ce8dea1fae99c1d?s=128&d=identicon&r=PG&f=1", "display_name": "mmrbest", "link": "https://stackoverflow.com/users/10774507/mmrbest"}, "edited": false, "score": 0, "creation_date": 1576025663, "post_id": 59256796, "comment_id": 104761793, "body": "This answer would be great if you modified the example for the 2D situation as asked for in the original question."}], "tags": [], "owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "is_accepted": false, "score": 0, "last_activity_date": 1575926385, "creation_date": 1575926385, "answer_id": 59256796, "question_id": 59065651, "link": "https://stackoverflow.com/questions/59065651/how-do-i-access-the-dynamically-allocated-2d-array-of-type-fftw-complex-in-fftw/59256796#59256796", "title": "How do I access the dynamically allocated 2D array of type fftw_complex in FFTW after a 2D r2c transformation?", "body": "<p>The most beautiful course of action is to <strong>include the standard native complex type <code>#include &lt;complex.h&gt;</code> before <code>&lt;fftw3.h&gt;</code></strong> as signaled in <a href=\"http://www.fftw.org/fftw3_doc/Complex-numbers.html\" rel=\"nofollow noreferrer\">the documentation of FFTW</a>. </p>\n\n<blockquote>\n  <p>In particular, if you #include  before , then fftw_complex is defined to be the native complex type and you can manipulate it with ordinary arithmetic (e.g. x = y * (3+4*I), where x and y are fftw_complex and I is the standard symbol for the imaginary unit); </p>\n</blockquote>\n\n<p>The following example is compiled using <code>gcc main.c -o main -Wall -lfftw3 -lm</code></p>\n\n<pre><code>#include&lt;stdlib.h&gt;\n#include&lt;math.h&gt;\n#include&lt;complex.h&gt;\n#include&lt;fftw3.h&gt;\n\nint main(void){\n\n    fftw_plan p;\n    unsigned long int N = 10;\n    fftw_complex *in=fftw_malloc(N*sizeof(fftw_complex));\n    if(in==NULL){fprintf(stderr,\"malloc failed\\n\");exit(1);}\n    fftw_complex *out=fftw_malloc(N*sizeof(fftw_complex));\n    if(out==NULL){fprintf(stderr,\"malloc failed\\n\");exit(1);}\n\n    printf(\"sizeof fftw complex %ld\\n\",sizeof(fftw_complex));\n    p=fftw_plan_dft_1d(N, in, out, FFTW_FORWARD, FFTW_ESTIMATE);\n    if (p==NULL){fprintf(stderr,\"plan creation failed\\n\");exit(1);}\n\n    unsigned int i;\n    for(i=0;i&lt;N;i++){\n                in[i]=30.+12.*sin(2*3.1415926535*i/((double)N));\n    }\n\n    fftw_execute(p);\n\n    for (i = 0; i &lt; N; i++){\n        printf(\"result: %d || %g %gI |\\n\", i, creal(out[i]), cimag(out[i]));\n    }\n\n\n    fftw_destroy_plan(p);\n    fftw_free(in);\n    fftw_free(out);\n\n    return(0);\n}\n</code></pre>\n\n<p>It shows how to retreive the imaginary and real part of a complex.\nNow any function operating on complex number can be used, as listed in <a href=\"https://en.cppreference.com/w/c/numeric/complex\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/c/numeric/complex</a> .</p>\n"}], "owner": {"reputation": 11, "user_id": 10774507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f54ef91d82741190ce8dea1fae99c1d?s=128&d=identicon&r=PG&f=1", "display_name": "mmrbest", "link": "https://stackoverflow.com/users/10774507/mmrbest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1575926385, "creation_date": 1574841898, "last_edit_date": 1574846830, "question_id": 59065651, "link": "https://stackoverflow.com/questions/59065651/how-do-i-access-the-dynamically-allocated-2d-array-of-type-fftw-complex-in-fftw", "title": "How do I access the dynamically allocated 2D array of type fftw_complex in FFTW after a 2D r2c transformation?", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;fftw3.h&gt;\n#include&lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(){\n    int N=2000;\n    int i,j;\n    FILE *filepointer;\n    filepointer=fopen(\"2DDFT_spacetime.plt\",\"w\");\n    //double in[N][N];\n    double *in;\n    fftw_complex *out;\n    fftw_plan p;\n    double fx=13.0;\n    double fz=9.0;\n    double x[N];\n    double xstart=0.0;\n    double xend=5.0/fx;\n    double z[N];\n    double zstart=0.0;\n    double zend=5.0/fz;\n    double dx=(xend-xstart)/(N-1);\n    double dz=(zend-zstart)/(N-1);\n    x[0]=xstart;\n    z[0]=zstart;\n    in = (double*) malloc(sizeof(double) * N * N); //allocates input array\n    out = fftw_alloc_complex(N*((int)floor(N/2)+1)); //wrapper function ;allocates output array\n    p = fftw_plan_dft_r2c_2d(N,N, in, out, FFTW_MEASURE);\n    for(i=1;i&lt;N;i++) {\n        x[i]=x[i-1]+dx;\n    }\n    for(i=1;i&lt;N;i++) {\n        z[i]=z[i-1]+dz;\n    }\n    for(i=0;i&lt;N;i++) {\n        for(j=0;j&lt;N;j++) {\n            in[i*N+j]=cos(2*M_PI*fx*x[i]+2*M_PI*fz*z[j]);\n        }\n    }\n\n    fftw_execute(p);\n\n    fprintf(filepointer,\"TITLE =\\\"FFTW\\\"\\nVARIABLES=\\\"Wavenumber-x\\\"\\n\\\"Wavenumber-z\\\"\\n\\\"Amplitude\\\"\\nZONE T=\\\"Amplitude\\\"\\n I=%d, J=%d, K=1, ZONETYPE=Ordered\\n DATAPACKING=POINT\\n DT=(SINGLE SINGLE SINGLE)\\n\",N,(int)floor(N/2)+1);\n    for(j=0;j&lt;(int)floor(N/2)+1;j++) { \n        for(i=0;i&lt;N;i++) { \n            fprintf(filepointer,\" %.9E %.9E %.9E\\n\",i/(xend-xstart),j/(zend-zstart),sqrt(pow(out[i*((int)floor(N/2)+1)+j][0],2)+pow(out[i*((int)floor(N/2)+1)+j][1],2)));\n        }\n    }\n    fftw_destroy_plan(p);\n    free(in); \n    fftw_free(out);\n    fclose(filepointer);\n    return(1);\n}\n</code></pre>\n\n<p>I begin by allocating memory for a NxN double array and a NxN fftw_complex array, which is defined as <code>typedef double fftw_complex[2]</code> in the FFTW library. I assign real numbers to the array of doubles, do the real to complex FFT, and get the output in the array of fftw_complex.\nShould I access the real and imaginary parts of the output complex number as <code>out[i*((int)floor(N/2)+1)+j][0]</code> and <code>out[i*((int)floor(N/2)+1)+j][1]</code> respectively?</p>\n"}, {"tags": ["python", "c", "clang", "clang++"], "comments": [{"owner": {"reputation": 1259, "user_id": 11582326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TmrDj.jpg?s=128&g=1", "display_name": "Valeriy Savchenko", "link": "https://stackoverflow.com/users/11582326/valeriy-savchenko"}, "edited": false, "score": 0, "creation_date": 1574841436, "post_id": 59065506, "comment_id": 104369462, "body": "Can you, please, check if clang 6.0 itself crashes on the same file?"}, {"owner": {"reputation": 39, "user_id": 10878373, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8o6dbaXpZPg/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcanLflA6h1cEsPiCSURRVD-SyQekQ/mo/photo.jpg?sz=128", "display_name": "xiaoyao Don", "link": "https://stackoverflow.com/users/10878373/xiaoyao-don"}, "reply_to_user": {"reputation": 1259, "user_id": 11582326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TmrDj.jpg?s=128&g=1", "display_name": "Valeriy Savchenko", "link": "https://stackoverflow.com/users/11582326/valeriy-savchenko"}, "edited": false, "score": 0, "creation_date": 1574842242, "post_id": 59065506, "comment_id": 104369812, "body": "@ValeriySavchenko I added some details about using command clang to parse the file."}, {"owner": {"reputation": 1259, "user_id": 11582326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TmrDj.jpg?s=128&g=1", "display_name": "Valeriy Savchenko", "link": "https://stackoverflow.com/users/11582326/valeriy-savchenko"}, "edited": false, "score": 0, "creation_date": 1574842492, "post_id": 59065506, "comment_id": 104369905, "body": "<code>clang -cc1</code> doesn&#39;t use any of standard include paths. Check out this answer for more details: <a href=\"https://stackoverflow.com/questions/59050018/how-to-get-only-function-declaration-from-clang-ast/59054621#59054621\" title=\"how to get only function declaration from clang ast\">stackoverflow.com/questions/59050018/&hellip;</a> How do you provide clang with include directories and macro definitions (required for proper parsing)?"}, {"owner": {"reputation": 39, "user_id": 10878373, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8o6dbaXpZPg/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcanLflA6h1cEsPiCSURRVD-SyQekQ/mo/photo.jpg?sz=128", "display_name": "xiaoyao Don", "link": "https://stackoverflow.com/users/10878373/xiaoyao-don"}, "reply_to_user": {"reputation": 1259, "user_id": 11582326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TmrDj.jpg?s=128&g=1", "display_name": "Valeriy Savchenko", "link": "https://stackoverflow.com/users/11582326/valeriy-savchenko"}, "edited": false, "score": 0, "creation_date": 1574842884, "post_id": 59065506, "comment_id": 104370127, "body": "@ValeriySavchenko In fact, I need to parse many reposities automatically, and include directories and macro definitions are not promised, so I do not set any parse args in python code <code>index.parse(file_path)</code>. It doesn&#39;t matter if there are some errors. But I do not hope my code breaks off. I use <code>try...except</code> to skip errors but it does not work."}, {"owner": {"reputation": 1259, "user_id": 11582326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TmrDj.jpg?s=128&g=1", "display_name": "Valeriy Savchenko", "link": "https://stackoverflow.com/users/11582326/valeriy-savchenko"}, "edited": false, "score": 0, "creation_date": 1574844257, "post_id": 59065506, "comment_id": 104370860, "body": "OK, at least try running clang 6.0 with the same include directories (the standard ones) as your code. <code>-cc1</code> prevents clang from using them. Let&#39;s simply check whether clang in absolutely the same context as libclang crashes or not."}, {"owner": {"reputation": 39, "user_id": 10878373, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8o6dbaXpZPg/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcanLflA6h1cEsPiCSURRVD-SyQekQ/mo/photo.jpg?sz=128", "display_name": "xiaoyao Don", "link": "https://stackoverflow.com/users/10878373/xiaoyao-don"}, "reply_to_user": {"reputation": 1259, "user_id": 11582326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TmrDj.jpg?s=128&g=1", "display_name": "Valeriy Savchenko", "link": "https://stackoverflow.com/users/11582326/valeriy-savchenko"}, "edited": false, "score": 0, "creation_date": 1574847406, "post_id": 59065506, "comment_id": 104372496, "body": "@ValeriySavchenkoV Thank you for paying attention for this question, finally, I decided to use func_timeout to limit the running time, and skip the dead process."}, {"owner": {"reputation": 1259, "user_id": 11582326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TmrDj.jpg?s=128&g=1", "display_name": "Valeriy Savchenko", "link": "https://stackoverflow.com/users/11582326/valeriy-savchenko"}, "edited": false, "score": 0, "creation_date": 1574847794, "post_id": 59065506, "comment_id": 104372722, "body": "Alright, I would still suggest not to ignore errors and timeouts without a clear understanding of why this is happening, otherwise, you won&#39;t understand the results as well. But, hey, it&#39;s your choice. If you are happy with this solution - go ahead."}], "owner": {"reputation": 39, "user_id": 10878373, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8o6dbaXpZPg/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcanLflA6h1cEsPiCSURRVD-SyQekQ/mo/photo.jpg?sz=128", "display_name": "xiaoyao Don", "link": "https://stackoverflow.com/users/10878373/xiaoyao-don"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574842179, "creation_date": 1574841264, "last_edit_date": 1574842179, "question_id": 59065506, "link": "https://stackoverflow.com/questions/59065506/clang-python-dies-while-parsing-some-files-of-linux", "title": "Clang Python dies while parsing some files of linux", "body": "<p>I am using Clang Python bindings to parse source code automatically, but when it parses some linux files, the process dies with no CPU consumption, no error exception, no response, even I cannot use Ctrl+C to kill the terminal. My code is as follows:</p>\n\n<pre><code>index = Index.create()\ntu = index.parse(file_path)\nnext_func(tu)\n</code></pre>\n\n<p>It works well with many source repositories such as Libpng, OpenCV, etc. How it dies while parsing files under the dir <code>linux-master\\drivers\\gpu\\drm\\nouveau\\nvkm\\subdev\\i2c</code> for example, <code>https://github.com/torvalds/linux/blob/master/drivers/gpu/drm/nouveau/nvkm/subdev/i2c/anx9805.c</code>. I run the code step by step and found that the error occured when running <code>tu = index.parse(file_path)</code>. </p>\n\n<p>The environment: Windows 10, libclang.dll(6.0) python2.7.</p>\n\n<p>I tried the command <code>clang -cc1 -fsyntax-only -ast-dump anx9805.c</code>\nIt reported that some headfiles were not found and construct its ast like follows:</p>\n\n<pre><code>In file included from \\linux\\linux-master\\drivers\\gpu\\drm\\nouveau\\nvkm\\subdev\\i2c\\anx9805.c:28:\nIn file included from \\linux\\linux-master\\drivers\\gpu\\drm\\nouveau\\nvkm\\subdev\\i2c/bus.h:4: \\linux\\linux-master\\drivers\\gpu\\drm\\nouveau\\nvkm\\subdev\\i2c/pad.h:4:10: fatal error: 'subdev/i2c.h' file not found\n#include &lt;subdev/i2c.h&gt;\n         ^~~~~~~~~~~~~~\nTranslationUnitDecl 0x13de7f82728 &lt;&lt;invalid sloc&gt;&gt; &lt;invalid sloc&gt;\n|-TypedefDecl 0x13de7f82ca0 &lt;&lt;invalid sloc&gt;&gt; &lt;invalid sloc&gt; implicit __int128_t '__int128'\n| `-BuiltinType 0x13de7f829c0 '__int128'\n|-TypedefDecl 0x13de7f82d10 &lt;&lt;invalid sloc&gt;&gt; &lt;invalid sloc&gt; implicit __uint128_t 'unsigned __int128'\n| `-BuiltinType 0x13de7f829e0 'unsigned __int128'\n...\n...\n</code></pre>\n\n<p>However, the process is able to end, I don't know if error occurs in python, why the process in terminal does not response, <code>try...except...</code> in my code does not catch the error, and even I cannot kill the process. It is allowed to ignore these error files. Most importantly, I do not want the code running breaks off.</p>\n"}, {"tags": ["c", "zeromq"], "answers": [{"comments": [{"owner": {"reputation": 104, "user_id": 12246590, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UbCUVYdKvhw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcwJIdXH8pLRIim5on1bHdeCbIf8A/photo.jpg?sz=128", "display_name": "Willy Cole", "link": "https://stackoverflow.com/users/12246590/willy-cole"}, "edited": false, "score": 0, "creation_date": 1574850997, "post_id": 59066141, "comment_id": 104374678, "body": "I don&#39;t want to use another api; i.e. I don&#39;t want to diverge through other solutions; I just want a simple solution for that! <code>select()</code> is not that one and is messy"}], "tags": [], "owner": {"reputation": 128, "user_id": 7820013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52551a570d7b8c624e64f3118097babd?s=128&d=identicon&r=PG", "display_name": "AdabH", "link": "https://stackoverflow.com/users/7820013/adabh"}, "is_accepted": false, "score": 0, "last_activity_date": 1574843892, "creation_date": 1574843892, "answer_id": 59066141, "question_id": 59065431, "link": "https://stackoverflow.com/questions/59065431/how-to-set-send-receive-timeout-on-czmq/59066141#59066141", "title": "how to set send/receive timeout on czmq?", "body": "<p>You can use select :</p>\n\n<pre><code>int64_t start; \nstruct timeval tv;\nfd_set fds;\nint fd,rc;\ntv.tv_sec = 1; // timeout in seconds\ntv.tv_usec = 0;\nFD_ZERO(&amp;fds);\nFD_SET(fd, &amp;fds);\n\nstart = zclock_time ();\nzstr_send (client, \"hello\");\nrc = select(fd + 1, &amp;fds, (fd_set *)0, (fd_set *)0, &amp;tv);\nif (rc == 0) {\n// timeoout expired \n}\nif (rc == -1) {\n// erreur select \n}\n// message recieved  before timeout\nprintf (\" message recieved s/second\\n\",  (1000 * 10000) / (int) (zclock_time () - start));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 104, "user_id": 12246590, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UbCUVYdKvhw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcwJIdXH8pLRIim5on1bHdeCbIf8A/photo.jpg?sz=128", "display_name": "Willy Cole", "link": "https://stackoverflow.com/users/12246590/willy-cole"}, "is_accepted": true, "score": 0, "last_activity_date": 1574854252, "creation_date": 1574854252, "answer_id": 59069241, "question_id": 59065431, "link": "https://stackoverflow.com/questions/59065431/how-to-set-send-receive-timeout-on-czmq/59069241#59069241", "title": "how to set send/receive timeout on czmq?", "body": "<p>yep! find it...</p>\n\n<p><code>zsock_set_rcvtimeo()</code> and <code>zsock_set_sndtimeo()</code> are the answers for setting timouts.</p>\n\n<p>czmq does not have good docs for its good APIs! :|</p>\n\n<p>There are lots of APIs in <a href=\"http://czmq.zeromq.org/3-0:zsock-option\" rel=\"nofollow noreferrer\"><code>zsock_option()</code></a> which has no documentation.</p>\n"}], "owner": {"reputation": 104, "user_id": 12246590, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UbCUVYdKvhw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcwJIdXH8pLRIim5on1bHdeCbIf8A/photo.jpg?sz=128", "display_name": "Willy Cole", "link": "https://stackoverflow.com/users/12246590/willy-cole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 59069241, "answer_count": 2, "score": 0, "last_activity_date": 1574854252, "creation_date": 1574841035, "last_edit_date": 1574841575, "question_id": 59065431, "link": "https://stackoverflow.com/questions/59065431/how-to-set-send-receive-timeout-on-czmq", "title": "how to set send/receive timeout on czmq?", "body": "<p>I want to know how can I set timeout on <code>zstr_send()</code> and <code>zstr_recv()</code> in czmq library.</p>\n\n<p>I know that this can be done with <code>zmq_setsockopt (requester, ZMQ_RCVTIMEO, &amp;timeout, sizeof(timeout))</code> in <code>libzmq</code>, but not in <code>czmq</code></p>\n\n<p>What is the syntax for <code>libczmq</code>?!</p>\n"}, {"tags": ["c", "assembly", "x86", "operating-system", "minix"], "comments": [{"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 3, "creation_date": 1574844382, "post_id": 59065429, "comment_id": 104370927, "body": "Are you asking what the code you&#39;ve shown does, or are you asking what the code that actually implements sys_schedule() does?"}, {"owner": {"reputation": 946, "user_id": 2288621, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/h8GFl.jpg?s=128&g=1", "display_name": "Hiroaki Machida", "link": "https://stackoverflow.com/users/2288621/hiroaki-machida"}, "reply_to_user": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1574845510, "post_id": 59065429, "comment_id": 104371473, "body": "Thank you for your comment! I\u2019m asking what the CPU does, such as The CPU runs the thread or CPU put the thread into some queue."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1574846712, "post_id": 59065429, "comment_id": 104372119, "body": "Doesn&#39;t MINIX have docs for its system calls?  Judging from the args, it might be something like POSIX <code>renice</code> on yourself, like maybe making your process realtime max priority for a few scheduling timeslices, or possibly it&#39;s something like a timed sleep or yield.  Those are total guesses based on what you might want an OS to do, and the names of the args.  I don&#39;t know MINIX at all."}, {"owner": {"reputation": 946, "user_id": 2288621, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/h8GFl.jpg?s=128&g=1", "display_name": "Hiroaki Machida", "link": "https://stackoverflow.com/users/2288621/hiroaki-machida"}, "edited": false, "score": 0, "creation_date": 1574847217, "post_id": 59065429, "comment_id": 104372361, "body": "Thank you for your comment! Unfortunately it\u2019s to be documented. <a href=\"https://wiki.minix3.org/doku.php?id=developersguide:kernelapi#sys_schedule\" rel=\"nofollow noreferrer\">wiki.minix3.org/&hellip;</a> Yes, it\u2019s called when nice command is executed. I want to know the exact behavior inside CPU."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1574873996, "post_id": 59065429, "comment_id": 104387677, "body": "@HiroakiMachida The CPU reads an instruction from the address stored in the program counter register, and then it increments the program counter register by the number of bytes in the instruction, and then it executes the instruction as specified in the CPU&#39;s manual. It repeats this until electrical power is removed."}], "answers": [{"tags": [], "owner": {"reputation": 767, "user_id": 656988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1e94ad3a9c30ec3290b9600018e8c73?s=128&d=identicon&r=PG", "display_name": "AntoineL", "link": "https://stackoverflow.com/users/656988/antoinel"}, "is_accepted": false, "score": 2, "last_activity_date": 1581624663, "creation_date": 1581624663, "answer_id": 60215723, "question_id": 59065429, "link": "https://stackoverflow.com/questions/59065429/what-does-sys-schedule-do-in-minix-3-1-8/60215723#60215723", "title": "What does sys_schedule() do in Minix 3.1.8?", "body": "<p>Any system call in MINIX will switch to the SYSTEM task (which is what does the code you showed, at least in part). The <a href=\"https://git.minix3.org/index.cgi?p=minix.git;a=blob;f=kernel/system.c;h=3f18a3187090ca7c4c3ff231e22c38ebb573e9a0;hb=8cf62365457041852a8c084325c8705bfd52967b\" rel=\"nofollow noreferrer\">SYSTEM task</a> has a table which maps the <code>SYS_XXX</code> tags into <code>do_xxx()</code> subroutines. These subroutines are usually contained in small source files in the <code>system/</code> folder.</p>\n\n<p>There we quickly find <a href=\"https://git.minix3.org/index.cgi?p=minix.git;a=blob;f=kernel/system/do_schedule.c;h=d4935c755d9c610c5bf3c047d4ecf69f7812bb36;hb=8cf62365457041852a8c084325c8705bfd52967b\" rel=\"nofollow noreferrer\"><code>do_schedule.c</code></a>. That file in 3.1.8 is pretty straightforward (and this is clearly explained in the book IIRC), but to give you a resume, it checks its arguments and stores the new scheduling parameters in the calling process table; those new values might then change which process will be picked when the SYSTEM task has ended its job and is about to return to user mode.</p>\n"}, {"tags": [], "owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "is_accepted": false, "score": 2, "last_activity_date": 1581648306, "last_edit_date": 1581648306, "creation_date": 1581630850, "answer_id": 60217039, "question_id": 59065429, "link": "https://stackoverflow.com/questions/59065429/what-does-sys-schedule-do-in-minix-3-1-8/60217039#60217039", "title": "What does sys_schedule() do in Minix 3.1.8?", "body": "<p>Minix supports userspace scheduling, which means that a userspace process is responsible for making scheduling decisions for one or more processors. The scheduler processes are invoked by the kernel when there is a need to make such decisions.</p>\n\n<p>The purpose of <code>sys_schedule</code> system call is to enable this userspace scheduling design. A scheduler can invoke <code>sys_schedule</code> to tell the kernel how to schedule a given process. See the <a href=\"https://wiki.minix3.org/doku.php?id=developersguide:userspacescheduling\" rel=\"nofollow noreferrer\">documentation page</a> on userspace scheduling.</p>\n\n<p>I've written a description of the <code>SYS_SCHEDULE</code> system call, which you can refer to until the <a href=\"https://wiki.minix3.org/doku.php?id=developersguide:kernelapi#sys_schedule\" rel=\"nofollow noreferrer\">official documentation</a> gets updated.</p>\n\n<p><strong>Parameters:</strong></p>\n\n<ul>\n<li><code>proc_ep</code>: Process endpoint to be reschedule.  </li>\n<li><code>priority</code>: The priority to assign to the process.  </li>\n<li><code>quantum</code>: The amount to time to run the process. When the process runs out of quantum, the scheduler assocaited with the process will be informed by the kernel, which can invoke <code>sys_schedule</code> to reschedule the process, thereby putting it in a runnable state again. If the process is not associated with userspace scheduler, the Minix process manager (PM) automatically renews its quantum.</li>\n</ul>\n\n<p><strong>Return value:</strong></p>\n\n<ul>\n<li><code>EINVAL</code>: <code>proc_ep</code> contains an incorrect process number.  </li>\n<li><code>EPERM</code>: The process that performed the system call is not the scheduler associated with <code>proc_ep</code>, so it doesn't have permission to reschedule the process specified by <code>proc_ep</code>.  </li>\n<li><code>EINVAL</code>: Invalid priority or quantum.  </li>\n<li><code>OK</code>: Call succeeded. In this case, the process has been added to the queue associated with the specified priority. The kernel scheduler schedules processes in round-robin fashion starting from the those in the highest-priority queue.</li>\n</ul>\n\n<p>Note that <code>_do_kernel_call</code> doesn't implement <code>sys_schedule</code>, rather it executes <code>int $KERVEC</code>, which is an x86 instruction that performs a user-to-kernel transition and invokes the interrupt handler associated with interrupt number <code>$KERVEC</code>. The interrupt handler then invokes the actual implementation of the system call specified by <code>msgptr-&gt;m_type</code>. (See @AntoineL's answer.)</p>\n\n<p>The <code>sys_schedule</code> is used by the PM, which runs in userspace, to balance the priority queues periodically and to automatically renew the quantum of processes that don't have schedulers.</p>\n"}], "owner": {"reputation": 946, "user_id": 2288621, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/h8GFl.jpg?s=128&g=1", "display_name": "Hiroaki Machida", "link": "https://stackoverflow.com/users/2288621/hiroaki-machida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1581648306, "creation_date": 1574841025, "last_edit_date": 1574845742, "question_id": 59065429, "link": "https://stackoverflow.com/questions/59065429/what-does-sys-schedule-do-in-minix-3-1-8", "title": "What does sys_schedule() do in Minix 3.1.8?", "body": "<p>I'm modifying a scheduler in Minix 3.1.8 and wondering what the system call sys_schedule() does in CPU. Could someone explain?</p>\n\n<p>sys_schedule.c</p>\n\n<pre><code>PUBLIC int sys_schedule(endpoint_t proc_ep, unsigned priority, unsigned quantum)\n{\n    message m;\n\n    m.SCHEDULING_ENDPOINT = proc_ep;\n    m.SCHEDULING_PRIORITY = priority;\n    m.SCHEDULING_QUANTUM  = quantum;\n    return(_kernel_call(SYS_SCHEDULE, &amp;m));\n}\n</code></pre>\n\n<p>com.h</p>\n\n<pre><code>#define KERNEL_CALL 0x600   /* base for kernel calls to SYSTEM */ \n#  define SYS_SCHEDULE   (KERNEL_CALL + 3)  /* sys_schedule() */\n</code></pre>\n\n<p>kernel_call.c</p>\n\n<pre><code>PUBLIC int _kernel_call(int syscallnr, message *msgptr)\n{\n  msgptr-&gt;m_type = syscallnr;\n  _do_kernel_call(msgptr);\n  return(msgptr-&gt;m_type);\n}\n</code></pre>\n\n<p>ipc.h</p>\n\n<pre><code>_PROTOTYPE( int _do_kernel_call, (message *m_ptr)           );\n</code></pre>\n\n<p>_ipc.S</p>\n\n<pre><code>ENTRY(_do_kernel_call)\n    /* pass the message pointer to kernel in the %eax register */\n    movl    4(%esp), %eax\n    int $KERVEC\n    ret\n</code></pre>\n"}, {"tags": ["c", "static", "constants"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1574840156, "post_id": 59065111, "comment_id": 104368847, "body": "Compiler extensions"}, {"owner": {"reputation": 357, "user_id": 5512593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hbdmE.jpg?s=128&g=1", "display_name": "iDingDong", "link": "https://stackoverflow.com/users/5512593/idingdong"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1574840333, "post_id": 59065111, "comment_id": 104368920, "body": "@Achel Because the standard does not make it one. If you try using <code>i</code> as the size of an <code>static</code> array, your code would be rejected."}, {"owner": {"reputation": 357, "user_id": 5512593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hbdmE.jpg?s=128&g=1", "display_name": "iDingDong", "link": "https://stackoverflow.com/users/5512593/idingdong"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1574840495, "post_id": 59065111, "comment_id": 104368983, "body": "@klutt I was thinking the same. But these compilers do complains if other scenario that requires constant expression involves <code>i</code>."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1574840612, "post_id": 59065111, "comment_id": 104369031, "body": "Related: <a href=\"https://stackoverflow.com/a/58699604/6699433\">stackoverflow.com/a/58699604/6699433</a>"}], "answers": [{"tags": [], "owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1574840734, "last_edit_date": 1574840734, "creation_date": 1574840432, "answer_id": 59065274, "question_id": 59065111, "link": "https://stackoverflow.com/questions/59065111/why-would-gcc-clang-accept-const-qualified-object-as-initializer-for-object-with/59065274#59065274", "title": "Why would GCC/Clang accept const qualified object as initializer for object with static storage duration?", "body": "<p>You didn't miss anything, it is indeed a non-conforming C program, and a non-conforming behavior on the compiler's part. This is very likely caused by the both GCC and Clang being compiler suites for C++ as well. In C++ <code>i</code> is a valid initializer for <code>j</code>.</p>\n\n<p>It's worth noting however that while compilers are free to translate non-conforming C programs at their discretion, they must still issue a diagnostic about the non-conformance according to C11 5.1.1.3 p1:</p>\n\n<blockquote>\n  <p>A conforming implementation shall produce at least one diagnostic\n  message (identified in an implementation-defined manner) if a\n  preprocessing translation unit or translation unit contains a\n  violation of any syntax rule or constraint, even if the behavior is\n  also explicitly specified as undefined or implementation-defined.\n  Diagnostic messages need not be produced in other circumstances.</p>\n</blockquote>\n\n<p>Even if we accept the behavior as an extension, the fact GCC and Clang don't issue a diagnostic is conformance bug on both their parts.</p>\n"}], "owner": {"reputation": 357, "user_id": 5512593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hbdmE.jpg?s=128&g=1", "display_name": "iDingDong", "link": "https://stackoverflow.com/users/5512593/idingdong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 59065274, "answer_count": 1, "score": 1, "last_activity_date": 1574840779, "creation_date": 1574839710, "last_edit_date": 1574840779, "question_id": 59065111, "link": "https://stackoverflow.com/questions/59065111/why-would-gcc-clang-accept-const-qualified-object-as-initializer-for-object-with", "title": "Why would GCC/Clang accept const qualified object as initializer for object with static storage duration?", "body": "<p>As far as I know, the ISO C standard is strict about initializers for object with static storage duration in C11 6.7.9</p>\n\n<blockquote>\n  <p>All the expressions in an initializers for an object that has static or thread storage duration shall be constant expressions or string literals.</p>\n</blockquote>\n\n<p>But both GCC/Clang accepted the following code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>const int i = 3; // const here should not make i a constant expression\nstatic int j = i;\n</code></pre>\n\n<p>Even with <code>-Wall -Wextra -Werror -pedantic-errors</code>, compilers above are not giving me any complaint.</p>\n\n<p>However, these compilers do realize that <code>i</code> was not a constant expression. For example, Clang gave me:</p>\n\n<blockquote>\n  <p>error: size of static array must be an integer constant expression</p>\n</blockquote>\n\n<p>for the following code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>const size_t sz = 3;\nstatic int a[sz];\n</code></pre>\n\n<p>Am I getting anything wrong here?</p>\n"}, {"tags": ["c", "multithreading", "queue", "pthreads", "semaphore"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1574839682, "post_id": 59065023, "comment_id": 104368607, "body": "10k threads is <i>far</i> beyond the process limits of stock unix os&#39;s. For pthreads the typical limit is 512, at least for x86 impls. If you&#39;re running x64 I&#39;ve seen as high as 32k, but never had the brass to use them myself. I dunno what the problem is, but I can go strong on the advice that 10k threads is <i>not</i> the solution. Dare I ask why 10K ? I mean, because 9999 isn&#39;t enough and 10001 was just too many? What was the gating factor on settling on that number ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7157075"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1574840812, "post_id": 59065023, "comment_id": 104369153, "body": "It is for an assignment and I have the same confusion. Our queue is tested if it is thread safe with 10000 threads and it doesnt make sense to me. I know it is safe for 10 because I updated the num_threads but the original definition is 10000 so I dont know what to do."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1574840869, "post_id": 59065023, "comment_id": 104369176, "body": "Are you sure the thread pool is supposed to be 10k and not the <i>queue size</i> ceiling? That would make a lot more sense. Unless these threads are severely IO bound having such a huge number makes no sense. If they&#39;re CPU bound you really don&#39;t want more than the logical core count on the chip anyway (give or take)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7157075"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1574841171, "post_id": 59065023, "comment_id": 104369334, "body": "Yes it is the num_threads definition. I solved my problem. It seems that there&#39;s some limitation in that system that pthread and openmp can&#39;t be used at the same time in the program. So I erased a line that made use of openmp and it works fine. I still don&#39;t understand how I can run 10000 threads though"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7157075"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1574842886, "post_id": 59065023, "comment_id": 104370128, "body": "I checked it any my system allows 3084716 threads via cat /proc/sys/kernel/threads-max. I thought linux treats the threads and processes in a similar way. I thought they were the same except the stack, register and pc. Apparently the number available for creation is also different"}], "owner": {"user_type": "does_not_exist", "display_name": "user7157075"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574839383, "creation_date": 1574839383, "question_id": 59065023, "link": "https://stackoverflow.com/questions/59065023/multithreading-and-implementing-thread-safety-enqueue-operation", "title": "Multithreading and implementing thread-safety enqueue operation", "body": "<p>I have this queue that I implemented with semaphores to make it thread-safe. It basically does not allow multiple threads to enqueue to the queue at the same time.  Here is the enqueue function:</p>\n\n<pre><code>int queueEnqueue(queue* q, int* value){\n    int value1;\n    sem_getvalue(&amp;(q-&gt;sem1),&amp;value1);\n    //printf(\"Value of semaphore is: %d\\n\", value1); \n    sem_wait(&amp;(q-&gt;sem1));\n    if(!queueIsFull(q)){\n        q-&gt;rear = (q-&gt;rear + 1) % q-&gt;capacity;\n        q-&gt;array[q-&gt;rear] = *value;\n        q-&gt;size = q-&gt;size + 1;\n        sem_post(&amp;(q-&gt;sem1));\n        return(1);\n    }\n    sem_post(&amp;(q-&gt;sem1));\n    return(0);\n}\n</code></pre>\n\n<p>I have this piece of code in my main but for some reason I always get error 11 back which means \"not enough resources for the thread.\" num_threads is 10000 and my ulimit -u is 128. Is this the problem? I was told my program should still work.</p>\n\n<pre><code>    for(j = 0; j &lt; 10; j++){ // run the test 10 times\n        printf(\"\\n-------Run %d-------\\n\", j);\n        printf(\"====Enqueuing...\");\n        for(i = 0; i &lt; num_pthreads; i++) {\n            //printf(\"%d\\n\", i);\n            if ((rc = pthread_create(&amp;threads[i], NULL, enqueueThread, (void*) q))) {\n                fprintf(stderr, \"error: pthread_create, rc1: %d\\n\", rc);\n                return EXIT_FAILURE;\n            } \n        } \n</code></pre>\n\n<p>I just tested with num_threads 10 and it works fine but anything around 100 makes it throw error.</p>\n"}, {"tags": ["c", "c11", "restrict-qualifier"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1574837390, "post_id": 59064468, "comment_id": 104367618, "body": "The accepted answer on that post has <i>&quot;Since restrict may or may not make code run faster, but it can never make it slower (assuming the compiler is sane), it should be used always&quot;</i>"}, {"owner": {"reputation": 357, "user_id": 5512593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hbdmE.jpg?s=128&g=1", "display_name": "iDingDong", "link": "https://stackoverflow.com/users/5512593/idingdong"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1574838006, "post_id": 59064468, "comment_id": 104367876, "body": "That answer also pointed out the exception &quot;(unless) it makes no significant performance improvement in this specific case&quot;, as in this case, I cannot see any possibility even for insignificant performance improvement."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1574838351, "post_id": 59064468, "comment_id": 104368031, "body": "Those bullets are for weighing risk against benefit. Both must should to <i>not</i> use it, i.e. if there is substantial risk of UB and no real benefit, don&#39;t use it. But what you detailed is the lack of possibility for undefined behavior. Which means we are left with a potential improvement that carries no risk. So following the original advice, use it."}, {"owner": {"reputation": 357, "user_id": 5512593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hbdmE.jpg?s=128&g=1", "display_name": "iDingDong", "link": "https://stackoverflow.com/users/5512593/idingdong"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1574838988, "post_id": 59064468, "comment_id": 104368304, "body": "That was convincing, however other standard library functions like <code>strlen</code> did not think the same. I still wonder why would <code>printf_s</code> be any different."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1574839092, "post_id": 59064468, "comment_id": 104368349, "body": "You have to bear in mind that different people at different time periods work on the standardization of specific features. Sometimes they miss things that could be improved."}, {"owner": {"reputation": 357, "user_id": 5512593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hbdmE.jpg?s=128&g=1", "display_name": "iDingDong", "link": "https://stackoverflow.com/users/5512593/idingdong"}, "reply_to_user": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1574840124, "post_id": 59064468, "comment_id": 104368833, "body": "<code>strlen_s</code> was also from Annex K, entering the standard accompanied by <code>printf_s</code>. &quot;Different time periods&quot; does not explain this."}, {"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1574840528, "post_id": 59064468, "comment_id": 104368999, "body": "But people missing things <i>does</i> explain it. Wait on an answer if you wish, but I&#39;ll be pleasantly surprised if it goes deeper than this."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1574843660, "post_id": 59064468, "comment_id": 104370558, "body": "It&#39;s probably been simply copied from the similar <code>printf()</code> signature without change (that would explain why <code>strlen_s()</code> has no `restrict)."}], "answers": [{"comments": [{"owner": {"reputation": 357, "user_id": 5512593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hbdmE.jpg?s=128&g=1", "display_name": "iDingDong", "link": "https://stackoverflow.com/users/5512593/idingdong"}, "edited": false, "score": 0, "creation_date": 1575016257, "post_id": 59066700, "comment_id": 104434773, "body": "Do you mean stdout could be redirected to format? How could that be done?"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 357, "user_id": 5512593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hbdmE.jpg?s=128&g=1", "display_name": "iDingDong", "link": "https://stackoverflow.com/users/5512593/idingdong"}, "edited": false, "score": 0, "creation_date": 1575029977, "post_id": 59066700, "comment_id": 104441194, "body": "Not redirected, used. <code>printf((char*)stdout)</code>, would otherwise be a valid call, provided that you know that the bytes in the <code>FILE</code> structure contain a null character and no <code>%</code> characters."}, {"owner": {"reputation": 357, "user_id": 5512593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hbdmE.jpg?s=128&g=1", "display_name": "iDingDong", "link": "https://stackoverflow.com/users/5512593/idingdong"}, "edited": false, "score": 0, "creation_date": 1575077277, "post_id": 59066700, "comment_id": 104455900, "body": "Then how about <code>wprintf_s</code>? Aliasing <code>FILE</code> as <code>wchar_t</code> causes UB regardless of <code>restrict</code> for breaking strict aliasing rule. That makes <code>wprintf_s((wchar_t*)stdout)</code> unnecessary to compromise to."}], "tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": false, "score": 0, "last_activity_date": 1574846083, "creation_date": 1574846083, "answer_id": 59066700, "question_id": 59064468, "link": "https://stackoverflow.com/questions/59064468/why-is-the-format-in-printf-s-annex-k-marked-as-restrict/59066700#59066700", "title": "Why is the format in printf_s (Annex K) marked as restrict?", "body": "<p>A function parameter of pointer to character type can not only alias other function parameters but also global objects. In particular, since <code>printf</code> and <code>printf_s</code> modify <code>stdout</code>, any pointer to character type could, in principle, point to the same <code>FILE</code> object or other objects that an implementation might use for IO under the hood.</p>\n\n<p>This is a bit far fetched, but basically this <code>restrict</code> here and in many other places says, don't try to be funny and use a separate character array for your format.</p>\n"}], "owner": {"reputation": 357, "user_id": 5512593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hbdmE.jpg?s=128&g=1", "display_name": "iDingDong", "link": "https://stackoverflow.com/users/5512593/idingdong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574846083, "creation_date": 1574837076, "question_id": 59064468, "link": "https://stackoverflow.com/questions/59064468/why-is-the-format-in-printf-s-annex-k-marked-as-restrict", "title": "Why is the format in printf_s (Annex K) marked as restrict?", "body": "<p>I am fully aware of the existence of <a href=\"https://stackoverflow.com/questions/50841881/why-is-the-format-in-printf-marked-as-restrict\">this question</a>.</p>\n\n<p>However, <code>printf_s</code> considers presence of specifier <code>%n</code> as an error, thus no write operation to format would ever be expected from <code>printf_s</code>. What sense does <code>restrict</code> make here?</p>\n"}, {"tags": ["c++", "c", "memory", "memory-management", "operating-system"], "comments": [{"owner": {"reputation": 3268, "user_id": 182634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d5b602ab0bc363e3e990f2e904b671d?s=128&d=identicon&r=PG", "display_name": "eyalm", "link": "https://stackoverflow.com/users/182634/eyalm"}, "edited": false, "score": 0, "creation_date": 1574837153, "post_id": 59064432, "comment_id": 104367536, "body": "are you sure it is random? can you share your prints? if you run on pc, you probably have MMU and virtual addresses."}, {"owner": {"reputation": 822, "user_id": 11333755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIwIM.jpg?s=128&g=1", "display_name": "Gopika BG", "link": "https://stackoverflow.com/users/11333755/gopika-bg"}, "edited": false, "score": 4, "creation_date": 1574837356, "post_id": 59064432, "comment_id": 104367605, "body": "Please refer this link:<a href=\"https://en.wikipedia.org/wiki/Address_space_layout_randomization\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Address_space_layout_randomizatio&zwnj;&#8203;n</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7, "user_id": 12386285, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dn1amkOJRJ0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdt_eHzpTkXtM5pUT4ZyMRhV14Gzg/photo.jpg?sz=128", "display_name": "apm11", "link": "https://stackoverflow.com/users/12386285/apm11"}, "is_accepted": false, "score": -2, "last_activity_date": 1574837579, "creation_date": 1574837579, "answer_id": 59064576, "question_id": 59064432, "link": "https://stackoverflow.com/questions/59064432/why-does-printing-address-of-a-variable-print-random-values-on-every-execution-e/59064576#59064576", "title": "why does printing address of a variable print random values on every execution even if its a logical address in C?", "body": "<p>Well the address should be the same each time you compile( 0x28fefc , as an example). No it should not start from 0 since the MMU does the translation.</p>\n\n<p>Try again with this code, and see if it works : </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include&lt;iostream&gt;\nusing namespace std;\n\nint main(){\n\n   int n;\n   cout &lt;&lt; &amp;n'\n}\n</code></pre>\n\n<p>To see the value stored in an address try this, which is called dereferencing : </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include&lt;iostream&gt;\nusing namespace std;\n\nint main(){\n      int n = 10;\n      cout &lt;&lt; *(&amp;n);\n}\n</code></pre>\n\n<p>If the problem persists, i think is the new OS.. </p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 4, "last_activity_date": 1574839965, "creation_date": 1574839965, "answer_id": 59065165, "question_id": 59064432, "link": "https://stackoverflow.com/questions/59064432/why-does-printing-address-of-a-variable-print-random-values-on-every-execution-e/59065165#59065165", "title": "why does printing address of a variable print random values on every execution even if its a logical address in C?", "body": "<p>No, virtual address do not need to start at zero and generally do not do so. Each operating system, program loader, and/or linker has some default memory layout. Typically nothing is mapped at address zero so that zero can act as a null pointer and cause faults if it is dereferenced. Commonly the stack is put somewhat  high in memory but adjusted by a random offset to foil attacks that rely on fixed or known addresses. That is what is causing the variation you see.</p>\n"}], "owner": {"reputation": 7550, "user_id": 6665568, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5dac06cb071c09718d413ff3623953ce?s=128&d=identicon&r=PG&f=1", "display_name": "Natesh bhat", "link": "https://stackoverflow.com/users/6665568/natesh-bhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1574839965, "creation_date": 1574836874, "last_edit_date": 1574837364, "question_id": 59064432, "link": "https://stackoverflow.com/questions/59064432/why-does-printing-address-of-a-variable-print-random-values-on-every-execution-e", "title": "why does printing address of a variable print random values on every execution even if its a logical address in C?", "body": "<p>From this question : <a href=\"https://stackoverflow.com/questions/1323946/function-pointer-physical-or-virtual-address\">function pointer :physical or virtual address</a></p>\n\n<p>I understood that when I print the address of any variable , it prints the virtual address . But I had read in books that implied that for each process , the virtual address starts from 0 and the MMU will actually take care of the address translation.</p>\n\n<p>So when I execute the program many times , i see some random addresses ? Why does this happen ? Why doesn't it start from 0 ? Is the address denoting some offset from the base address of the actual process ? If so , doesn't it mean that its the physical address ?</p>\n\n<p>I am running my pc on POP os and my system is also new.\nHere are the values when i print the address of my variable in each execution : </p>\n\n<pre><code>0x7ffc62f83904\n0x7ffd78dee214\n0x7fff2b69f6c4\n0x7ffcc89680a4\n0x7ffdc5cbf514\n0x7ffd00540714\n0x7ffd743ac3d4\n0x7ffe7c5a9914\n0x7ffd1ea1d214\n0x7ffe21c30d64\n0x7ffe885d9de4\n0x7ffc5d8432e4\n0x7ffe87ebff04\n0x7ffc726e88d4\n0x7ffef650e684\n0x7fff0a62a2f4\n0x7ffe89e3aed4\n0x7ffd77e596f4\n0x7ffcfcf76c54\n0x7fff9a2cf654\n0x7ffe3a8cbf84\n0x7ffc4e127704\n0x7ffce1a9f894\n0x7ffd908828a4\n0x7ffc88b0c6b4\n0x7ffc2dd04804\n0x7ffda3991c24\n0x7fffad288da4\n0x7ffd34da2994\n0x7ffc3e3dcf54\n0x7ffc6780b224\n0x7ffee8f41554\n0x7ffd369d9c54\n0x7ffe5bdfca14\n0x7ffc9a772454\n0x7ffe03665d04\n0x7ffce0eeb234\n0x7ffc4fad04a4\n0x7ffea8c715e4\n0x7ffc6c3eb7f4\n0x7ffea32a5e24\n0x7ffea7729394\n0x7ffdfbd2eab4\n0x7fff36934134\n0x7ffe9e15b1e4\n0x7ffe12a07194\n0x7ffc1b2fce34\n0x7ffc3a82b684\n0x7ffe56aad1d4\n0x7ffd00d59c54\n0x7fff58636474\n0x7ffdc8940964\n0x7ffed8146aa4\n0x7ffd81794c94\n0x7ffdce6ac874\n0x7fff761a79c4\n0x7ffe8fc95a24\n0x7ffd3fb95464\n0x7ffdbceeeb84\n0x7ffc1582c2d4\n0x7ffd47f0e8b4\n0x7ffdd55b12f4\n0x7ffc802a3db4\n0x7ffebe9634a4\n0x7ffec809acf4\n0x7ffd0dfe0354\n0x7ffc80eeb8d4\n0x7fff1914b3b4\n0x7fff3fee60d4\n0x7ffccf1febf4\n0x7ffdfe68c264\n0x7ffd631c8184\n0x7ffd814bc3c4\n0x7ffc53a2d3d4\n0x7fff49d96e14\n0x7ffc16144e14\n0x7ffecfe11904\n0x7ffeaa3dc584\n0x7ffcfb3a2894\n0x7fff8a6a04b4\n0x7ffcf0e035f4\n0x7ffe060a7654\n0x7ffce2a00954\n0x7ffcc81980f4\n0x7ffc0c706034\n0x7fff172e4f34\n0x7ffd62c963e4\n0x7ffcf00501a4\n0x7ffeec50b044\n0x7ffd0bbb2be4\n0x7ffff8fbebf4\n0x7ffd6e127ac4\n0x7fff0f2b9714\n0x7ffe8b6da014\n0x7ffc58f83344\n0x7ffc3aa463e4\n0x7fff8b28c9d4\n0x7ffe1799f8a4\n0x7fffe398f734\n0x7fffb3056f74\n</code></pre>\n\n<p>Should it not contain duplicates ?\nNow would it contain duplicates if i run the same program multiple times in parallel which would confirm that its a virtual address and not a physical address ?</p>\n"}, {"tags": ["c", "linux", "video", "ffmpeg", "timestamp"], "comments": [{"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1574839869, "post_id": 59064384, "comment_id": 104368702, "body": "I hope it is not a stupid suggestion (I&#39;m not too much into Linux programming) but couldn&#39;t you copy your image directly to the frame buffer as soon as you receive it ?"}, {"owner": {"reputation": 1658, "user_id": 10813146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502c57cd3ed11359acecbd8124d9ae17?s=128&d=identicon&r=PG&f=1", "display_name": "milad", "link": "https://stackoverflow.com/users/10813146/milad"}, "reply_to_user": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1574840771, "post_id": 59064384, "comment_id": 104369121, "body": "@Gulaume Petitjean not at all, any suggestion is useful. I can copy image to a buffer immediately but then what should i do? how to convert these buffers to video?"}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1574841064, "post_id": 59064384, "comment_id": 104369279, "body": "if you write directly to the frame buffer, you basically create a video. HOWEVER i&#39;m not sure it is the best solution under Linux. Also there are probably issues of antialising or similar video specific issues. But basically when you decode a compressed format video (like H264) you reconstitute a set of pictures that you write to the frame buffer at the correct rate."}, {"owner": {"reputation": 1658, "user_id": 10813146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502c57cd3ed11359acecbd8124d9ae17?s=128&d=identicon&r=PG&f=1", "display_name": "milad", "link": "https://stackoverflow.com/users/10813146/milad"}, "reply_to_user": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1574841370, "post_id": 59064384, "comment_id": 104369428, "body": "I think I can&#39;t create video by copying images to a buffer directly because I read somewhere that frame buffers has additional headers and need a codec to compress and encode them. by the way, thank you for your attention. I give it a try."}], "answers": [{"tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": false, "score": 0, "last_activity_date": 1574890511, "creation_date": 1574890511, "answer_id": 59078754, "question_id": 59064384, "link": "https://stackoverflow.com/questions/59064384/create-movie-from-one-image-updates-in-linux/59078754#59078754", "title": "create movie from one image updates in linux", "body": "<p>You can try to use <code>inotify</code> watch modification on the file and <code>ffmpeg</code> to append file to the movie:</p>\n\n<pre><code>#!/bin/bash\nFRAMERATE=1\nFILE=\"/path/to/image.jgp\"\nwhile true \ndo  inotifywait -e modify \"$FILE\"\n    echo \"file changed\"\n    # create temp file name\n    TMP=$(mktemp)\n\n    # copy file\n    cp \"$FILE\" \"$TMP$\n\n    # append copy file to movie\n    # from https://video.stackexchange.com/q/17228\n\n    # if movie already exist\n    if [ -f movie.mp4 ]\n    then\n        # append image to a new movie\n        ffmpeg -y -i movie.avi -loop 1 -f image2 -t $FRAMERATE -i \"$TMP\".jpg   -f lavfi -t 3 -i anullsrc -filter_complex \"[0:v] [1:v] concat=n=2:v=1 [v] \"  -map \"[v]\" newmovie.avi\n        # replace old by new movie\n        mv newmovie.mp4 movie.mp4\n    else   \n        #create a movie from one image\n        ffmpeg -framerate 1 -t $FRAMERATE -i \"$TMP\" movie.mp4\n    fi\n    rm \"$TMP\" \n\ndone\n</code></pre>\n\n<p>This script must certainly be adapted, (in particular if your framerate is high) but I think you can try to play with it.</p>\n\n<p>One bad thing also that the movie creation will become slower and slower because the movie becomes bigger.</p>\n\n<p>You should to store images of a certain time duration in a directory and convert all at once (like once an hour/day)</p>\n\n<hr>\n\n<p>If you want to serve a stream instead of creating a video file, you can look at <a href=\"https://stackoverflow.com/a/31705978/1212012\">https://stackoverflow.com/a/31705978/1212012</a></p>\n"}], "owner": {"reputation": 1658, "user_id": 10813146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502c57cd3ed11359acecbd8124d9ae17?s=128&d=identicon&r=PG&f=1", "display_name": "milad", "link": "https://stackoverflow.com/users/10813146/milad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1574890511, "creation_date": 1574836660, "question_id": 59064384, "link": "https://stackoverflow.com/questions/59064384/create-movie-from-one-image-updates-in-linux", "title": "create movie from one image updates in linux", "body": "<p>I'm a C programmer on linux.</p>\n\n<p>I write a program that saves an image in /srv/ftp/preview.png which is updating frequently and i want to create a movie from this updates.</p>\n\n<p>It's timestamp is important for me, e.g if image updates after 3.654 seconds i want movie show this update(frame) after 3.654 seconds too.</p>\n\n<p>I searched in Internet for several hours but i can't find any solution.</p>\n\n<p>I know about ffmpeg but it will convert images(and not one image) to movie without millisecond timestamp.</p>\n\n<p>I found this <a href=\"https://stackoverflow.com/questions/28781131/ffmpeg-create-movie-from-timestamped-images\">Question</a> but it seems is not useful in this case.</p>\n\n<p>Is there any tool to do that? if not, please introduce an API in c to write a program myself</p>\n"}, {"tags": ["c", "sockets", "network-programming"], "answers": [{"tags": [], "owner": {"reputation": 1669, "user_id": 12396017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8xz.png?s=128&g=1", "display_name": "Maxim Sagaydachny", "link": "https://stackoverflow.com/users/12396017/maxim-sagaydachny"}, "is_accepted": false, "score": 0, "last_activity_date": 1574840312, "creation_date": 1574840312, "answer_id": 59065253, "question_id": 59064329, "link": "https://stackoverflow.com/questions/59064329/is-there-any-c-api-to-check-if-the-source-ip-address-is-from-same-network/59065253#59065253", "title": "Is there any C API to check if the source IP address is from same network?", "body": "<p>I assume you are talking about linux platform.\nI do not think there is an API for that.</p>\n\n<p>I see 3 methods to check what you need:</p>\n\n<p><strong>1)</strong> You can use ttl of ping to see whether client is too many hops away thus most likely being not a member of your network. \nJust try this as a proof of concept </p>\n\n<pre><code>ping -t 1 8.8.8.8\n</code></pre>\n\n<p><strong>2)</strong> Also you can get mac address of client's IP from arp table and compare it with mac of your gateway. if they match then <em>there is a chance</em> that your client does not belong to your network.</p>\n\n<p><strong>3)</strong> Also you can enumerate all ip addresses you bind to and apply theirs masks to your ip and client ip and check for the match. If they match then client certainly belong to your network.</p>\n"}], "owner": {"reputation": 1175, "user_id": 1197140, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/715c764b2ceec73c662bbc989da28a19?s=128&d=identicon&r=PG", "display_name": "Chandu", "link": "https://stackoverflow.com/users/1197140/chandu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1574840312, "creation_date": 1574836386, "question_id": 59064329, "link": "https://stackoverflow.com/questions/59064329/is-there-any-c-api-to-check-if-the-source-ip-address-is-from-same-network", "title": "Is there any C API to check if the source IP address is from same network?", "body": "<p>I have a server written in C. Is there any API or way to check if the incoming request is from same network as the server is running in ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "arrays", "loops", "char", "operating-system"], "comments": [{"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1574835048, "post_id": 59064041, "comment_id": 104366715, "body": "Read up on strings in C. when creating the string, you need to add <code>\\0</code> at the end."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1574835191, "post_id": 59064041, "comment_id": 104366777, "body": "Please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Your code should work."}, {"owner": {"reputation": 6053, "user_id": 11336762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGPr6.jpg?s=128&g=1", "display_name": "Roberto Caboni", "link": "https://stackoverflow.com/users/11336762/roberto-caboni"}, "edited": false, "score": 0, "creation_date": 1574835360, "post_id": 59064041, "comment_id": 104366832, "body": "1) a string or a char array? 2) Would you guys define <i>sizeof</i> a library function?"}, {"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 0, "creation_date": 1574835618, "post_id": 59064041, "comment_id": 104366944, "body": "You cannot <code>sizeof</code>? This is part of the language, how could this possibly be the case???"}, {"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 0, "creation_date": 1574835780, "post_id": 59064041, "comment_id": 104367017, "body": "In any case, assuming that <code>name</code> could be storing more than one <code>\\0</code> (or possibly <code>name</code> is not even a statically allocated array), your method is fine. If you know for a fact that <code>name</code> is a statically allocated array which ends with exactly one <code>\\0</code>, then you can improve your method to a simple <code>sizeof(name) - 1</code>."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1574836352, "post_id": 59064041, "comment_id": 104367231, "body": "<code>sizeof</code> isn&#39;t a library function; it&#39;s an operator. And regardless it wouldn&#39;t be of any help anyway since your looking or length of content; not size of object. The simple code you have should work if the <code>char</code> sequence starting at <code>name</code> is indeed terminated. If it isn&#39;t you&#39;re basically out of luck. As you have not elaborated on what `didn&#39;t work&quot; actually means, vtc."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1574843970, "post_id": 59064041, "comment_id": 104370712, "body": "Generally, with OS calls, char arrays are passed by start address and length.  This allows arrays with embedded zeros to be passed and accommodates languages that do not use NUL terminated arrays to represent strings."}], "answers": [{"comments": [{"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 1, "creation_date": 1574835549, "post_id": 59064156, "comment_id": 104366909, "body": "That&#39;s a question, not an answer. You can post it as a comment."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1574835726, "post_id": 59064156, "comment_id": 104366996, "body": "Please don&#39;t abuse the answer function. Answer questions you can answer until you have gotten the privilege to comment."}, {"owner": {"reputation": 45, "user_id": 10410559, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b7xl_ZrThWw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWQwqfb65MQcU03_7ksUuJnu5OPFw/mo/photo.jpg?sz=128", "display_name": "John Kerry", "link": "https://stackoverflow.com/users/10410559/john-kerry"}, "edited": false, "score": 2, "creation_date": 1574836535, "post_id": 59064156, "comment_id": 104367302, "body": "You are right. The filename is taken from the command line and I thought that it would automatically add \\0 onto the end of it but it needed to be done manually."}], "tags": [], "owner": {"reputation": 1692, "user_id": 12433504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/667a21f48cc9b08d6adf0005669d9955?s=128&d=identicon&r=PG", "display_name": "VillageTech", "link": "https://stackoverflow.com/users/12433504/villagetech"}, "is_accepted": true, "score": 0, "last_activity_date": 1574836378, "last_edit_date": 1574836378, "creation_date": 1574835472, "answer_id": 59064156, "question_id": 59064041, "link": "https://stackoverflow.com/questions/59064041/how-to-determine-how-many-chars-in-a-character-array-in-c/59064156#59064156", "title": "How to determine how many chars in a character array in C?", "body": "<p>Probably the array doesn't contain the zero char ('\\0') immediately after the last char of your string.\nYou can solve this directly by adding the '\\0' while you are filling-up an array, or by initializing the whole array by '\\0' before filling-up.</p>\n"}], "owner": {"reputation": 45, "user_id": 10410559, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b7xl_ZrThWw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWQwqfb65MQcU03_7ksUuJnu5OPFw/mo/photo.jpg?sz=128", "display_name": "John Kerry", "link": "https://stackoverflow.com/users/10410559/john-kerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 59064156, "answer_count": 1, "score": -1, "last_activity_date": 1574836378, "creation_date": 1574834919, "question_id": 59064041, "link": "https://stackoverflow.com/questions/59064041/how-to-determine-how-many-chars-in-a-character-array-in-c", "title": "How to determine how many chars in a character array in C?", "body": "<p>I'm using C with no access to libraries or anything like that since this is kernel code for an operating system. So I can not use sizeOf or any built in function like that. name[] is a character array that holds the name of a file, but the file name can be up to 6 characters long, and I want to determine how long the file name actually is.</p>\n\n<p>Right now, my code looks like this:</p>\n\n<pre><code>int length = 0;\n\nwhile(name[length] != 0x0)\n{\n     length++;\n}\n\n\n</code></pre>\n\n<p>I also tried it with the 0x0 replaced with '\\0' but it still didn't work.</p>\n\n<p>Ideally, it would iterate through the char array and stop once it reaches the end of the file name, but I'm pretty sure that it keeps going past it.</p>\n"}, {"tags": ["c", "gcc", "segmentation-fault"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1574833068, "post_id": 59063656, "comment_id": 104366041, "body": "<code>ans</code> isn&#39;t the problem. It&#39;s more likely <code>i</code>. What is the value of <code>arSize</code>? Please tell us the exact inputs."}, {"owner": {"reputation": 128, "user_id": 10451587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aOGVAFq6aOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV4N5B5qvNSIQGa_XgHhbVjMsKowQ/mo/photo.jpg?sz=128", "display_name": "harish Dubakula", "link": "https://stackoverflow.com/users/10451587/harish-dubakula"}, "edited": false, "score": 0, "creation_date": 1574833217, "post_id": 59063656, "comment_id": 104366087, "body": "this should be  last=&amp;arr[arSize-1]  ...."}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1574833302, "post_id": 59063656, "comment_id": 104366114, "body": "What if <code>arSize</code> is <code>10</code> or more than that ? If true then <code>last=&amp;arr[arSize];</code> cause undefined behavior as you&#39;re going access array element out of bounds. B/w that <code>scanf(&quot;&amp;d&quot;,&amp;target);</code> --&gt; <code>scanf(&quot;%d&quot;,&amp;target);</code>"}, {"owner": {"reputation": 6031, "user_id": 10871900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-noQwojQppnY/AAAAAAAAAAI/AAAAAAAAACs/59RU8UyHFSk/photo.jpg?sz=128", "display_name": "dan1st", "link": "https://stackoverflow.com/users/10871900/dan1st"}, "edited": false, "score": 0, "creation_date": 1574833763, "post_id": 59063656, "comment_id": 104366276, "body": "Why do you use <code>*ans</code> and not <code>ans</code>? You declare an array with this. If you also set it <code>NULL</code>. It seems that you do this multiple times."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1574834502, "post_id": 59063656, "comment_id": 104366529, "body": "Typo.  <code>scanf()</code> calls using <code>&amp;</code> in format string, not <code>%</code>.  So the variables are not being read.  Since they are uninitialised when their values are being used, the code has undefined behaviour."}], "answers": [{"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1574844322, "post_id": 59063761, "comment_id": 104370895, "body": "Also, never use <code>scanf()</code> (or other input functions) without confirming that it succeeded.  In this case a simple <code>if (scanf(...) != 1)</code> would have identified the error."}], "tags": [], "owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "is_accepted": true, "score": 4, "last_activity_date": 1574834734, "last_edit_date": 1574834734, "creation_date": 1574833540, "answer_id": 59063761, "question_id": 59063656, "link": "https://stackoverflow.com/questions/59063656/segmentation-fault-in-a-function/59063761#59063761", "title": "Segmentation fault in a function", "body": "<p>The <code>scanf()</code> format have typo: they use <code>'&amp;'</code> instead of <code>'%</code>. As a result, the program (as posted) does not read any input.</p>\n\n<p><strong>Suggestion</strong>: make sure you get CLEAN compile (no warning, no errors) before trying to run (or debug). GCC flagged the format errors with the default 'cc'.</p>\n\n<blockquote>\n  <p>ff.c:22:11: warning: too many arguments for format\n  [-Wformat-extra-args]</p>\n\n<pre><code> scanf(\"&amp;d\",&amp;target);\n       ^~~~\n</code></pre>\n</blockquote>\n\n<p>3 fixes are needed. </p>\n\n<ul>\n<li><code>scanf(\"&amp;d\",&amp;target);</code></li>\n<li><code>scanf(\"&amp;d\",&amp;arSize);</code></li>\n<li><code>scanf(\"&amp;d\",&amp;arr[i]);</code></li>\n</ul>\n\n<p>For example: </p>\n\n<pre><code>    printf(\"Array size: \");\n// BAD:    scanf(\"&amp;d\",&amp;arSize);\n    scanf(\"%d\",&amp;arSize);\n</code></pre>\n\n<p>Code seems to run fine on simple cases with this fix.</p>\n"}, {"tags": [], "owner": {"reputation": 1692, "user_id": 12433504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/667a21f48cc9b08d6adf0005669d9955?s=128&d=identicon&r=PG", "display_name": "VillageTech", "link": "https://stackoverflow.com/users/12433504/villagetech"}, "is_accepted": false, "score": 0, "last_activity_date": 1574834813, "creation_date": 1574834813, "answer_id": 59064018, "question_id": 59063656, "link": "https://stackoverflow.com/questions/59063656/segmentation-fault-in-a-function/59064018#59064018", "title": "Segmentation fault in a function", "body": "<p>Probably it fails on the last iteration inside finder() in case the arSize is equal 10.</p>\n\n<p>You declared an array 'arr[10]', so it means that the index of the last element is equal 9, not 10 :)</p>\n\n<p>So, you should change one line in main():</p>\n\n<pre><code>last=&amp;arr[arSize];\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>last=&amp;arr[arSize-1];\n</code></pre>\n\n<p>Of course, you should always check that arSize is &lt;= 10.</p>\n"}], "owner": {"reputation": 51, "user_id": 12442950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbdbc973ec4fec704477d6ed05887391?s=128&d=identicon&r=PG&f=1", "display_name": "skeytrek", "link": "https://stackoverflow.com/users/12442950/skeytrek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 59063761, "answer_count": 2, "score": 2, "last_activity_date": 1574834813, "creation_date": 1574832930, "question_id": 59063656, "link": "https://stackoverflow.com/questions/59063656/segmentation-fault-in-a-function", "title": "Segmentation fault in a function", "body": "<p>I want to find the address of an integer in an array. Debugger revealed that line 8 is at fault.\n<code>if (*i==item) {ans=i;};</code></p>\n\n<p>Variable <code>ans</code> is local and not null, yet segmentation fault occurs.\nWhy is that and how can I fix it?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint* finder(int *begin, int *end, int item)\n{\n    int *ans=0; int *i=begin;\n\n    while (i&lt;end) {\n        if (*i==item) {ans=i;};\n        i++;\n    }\n\n    return ans;\n}\n\nint main()\n{\n    int arSize, target, i=0;\n    int arr[10]={};\n    int *first=&amp;arr[0]; int *last; int *result;\n\n    printf(\"Find element: \");\n    scanf(\"&amp;d\",&amp;target);\n    printf(\"Array size: \");\n    scanf(\"&amp;d\",&amp;arSize);\n    printf(\"Enter array: \");\n    while (i&lt;arSize){\n        scanf(\"&amp;d\",&amp;arr[i]);\n        i++;\n    }\n\n    last=&amp;arr[arSize];\n    result=finder(first,last,target);\n\n    printf(\"%s %p\",\"Target's address is \",result);\n\n\n    return 0;\n}\n\n</code></pre>\n"}, {"tags": ["c++", "c", "visual-c++", "makefile"], "comments": [{"owner": {"reputation": 3008, "user_id": 1863938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96ec4e16681460302ea67bfc201b76f3?s=128&d=identicon&r=PG", "display_name": "parktomatomi", "link": "https://stackoverflow.com/users/1863938/parktomatomi"}, "edited": false, "score": 0, "creation_date": 1574833614, "post_id": 59063543, "comment_id": 104366215, "body": "Are you building <a href=\"https://github.com/OSGeo/PROJ\" rel=\"nofollow noreferrer\">PROJ</a>? It can be built with CMake, even later versions of v4. CMake supports MSVC as a first-class citizen"}, {"owner": {"reputation": 1460, "user_id": 4228398, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qLCBK.jpg?s=128&g=1", "display_name": "Majid Hojati", "link": "https://stackoverflow.com/users/4228398/majid-hojati"}, "reply_to_user": {"reputation": 3008, "user_id": 1863938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96ec4e16681460302ea67bfc201b76f3?s=128&d=identicon&r=PG", "display_name": "parktomatomi", "link": "https://stackoverflow.com/users/1863938/parktomatomi"}, "edited": false, "score": 0, "creation_date": 1574880506, "post_id": 59063543, "comment_id": 104390648, "body": "@parktomatomi yes but I want to be able to compile it manually since there are a few other make files that I need to learn how to compile them"}], "owner": {"reputation": 1460, "user_id": 4228398, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qLCBK.jpg?s=128&g=1", "display_name": "Majid Hojati", "link": "https://stackoverflow.com/users/4228398/majid-hojati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574832305, "creation_date": 1574832305, "question_id": 59063543, "link": "https://stackoverflow.com/questions/59063543/compile-a-makefile-library-using-msvc-command-line", "title": "compile a makefile library using MSVC command line", "body": "<p>I am new with makefile and was trying to compile a library using <code>MSVC</code> command line. This library comes with a makefile as following</p>\n\n<pre><code>LIB = proj4lib.a \nSRCS = $(wildcard *.cpp) \nOBJS = $(SRCS:.cpp=.o)\nDEPS = $(SRCS:.cpp=.depends)\ninclude ../../../MakeIncludes\nINCDIRS = -I../include $(ADD_INC_DIRS) \nCCFLAGS = ${INCDIRS} ${ADD_CPP_FLAGS} \n\n.PHONY: clean all\n\nall: $(LIB)\n\n$(LIB): $(SRC) $(OBJS) $(DEPS)\n    ar ruv $(LIB) $(OBJS)\n    ranlib $(LIB)\n\n%.o: %.cpp \n    $(CPPCOMP) -c $&lt; $(CCFLAGS)\n\n%.depends: %.cpp\n    $(CPPCOMP) -M $(CCFLAGS) $&lt; &gt; $@\n\nclean:\n    rm -rf $(OBJS) $(LIB) $(DEPS) ii_files ti_files make.out\n\n-include $(DEPS)\n\n\n\n</code></pre>\n\n<p>I tried to convert it into <code>cl.exe</code> command to compile it as a library. I ended up with this command</p>\n\n<p><code>\ncl.exe /LD *.cpp /I../include  /EHsc /D_USE_MATH_DEFINES\n</code>\nIt compiles library with no error but I am not sure that I am doing right or not. since I have not defined any entry point or such things. here is my output</p>\n\n<pre><code>Microsoft (R) C/C++ Optimizing Compiler Version 19.00.24245 for x86\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\nadjlon.cpp\nemess.cpp\npj_auth.cpp\npj_mlfn.cpp\npj_msfn.cpp\npj_phi2.cpp\npj_qsfn.cpp\npj_tsfn.cpp\nGenerating Code...\nMicrosoft (R) Incremental Linker Version 14.00.24245.0\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\n/out:adjlon.dll\n/dll\n/implib:adjlon.lib\nadjlon.obj\nemess.obj\npj_auth.obj\npj_mlfn.obj\npj_msfn.obj\npj_phi2.obj\npj_qsfn.obj\npj_tsfn.obj\n\n</code></pre>\n\n<p>I don't know why it picks <code>adjlon.lib</code> as entry point and makes a dll with this name and if the output dll is a correctly compiled file or not. I want to know how I can convert a project with a makefile to the commands to be able to compile using msvc</p>\n"}, {"tags": ["c", "pointers", "global-variables"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574914128, "post_id": 59063435, "comment_id": 104399809, "body": "regarding: <code>int* count;</code>  this declares a pointer to <code>int</code>   However, that pointer is never actually pointer to memory that the application owns,  Given where it is declared, it will contain NULL.   Any effort to modify a value at address 0 (NULL) will result in a seg fault event"}], "answers": [{"comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574832222, "post_id": 59063479, "comment_id": 104365754, "body": "Not strictly necessary to explicitly init as globals are always automatically initialised to 0."}, {"owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574832321, "post_id": 59063479, "comment_id": 104365794, "body": "@kaylum - that&#39;s true. Anyway explicit initialisation is still better, as not all types have implicit initialisation."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574832709, "post_id": 59063479, "comment_id": 104365929, "body": "Are you thinking of C++? AFAIK, in C all globals without an initialiser are implicitly initialised to 0. That&#39;s because they are part of the BSS which is always loaded into zeroed memory. It&#39;s not a big point but just wanted to clarify that in case it causes any misunderstanding for future readers."}, {"owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1574833287, "post_id": 59063479, "comment_id": 104366109, "body": "@kaylum - you&#39;re right: <a href=\"https://stackoverflow.com/questions/2091499/why-are-global-and-static-variables-initialized-to-their-default-values\" title=\"why are global and static variables initialized to their default values\">stackoverflow.com/questions/2091499/&hellip;</a>  Anyway I think explicit initialisation won&#39;t harm, and perhaps a good habit too."}], "tags": [], "owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "is_accepted": false, "score": 1, "last_activity_date": 1574832032, "creation_date": 1574832032, "answer_id": 59063479, "question_id": 59063435, "link": "https://stackoverflow.com/questions/59063435/how-to-have-a-global-variable-in-c-that-increments-when-used-by-any-function/59063479#59063479", "title": "How to have a global variable in C that increments when used by any function", "body": "<blockquote>\n  <p>I am attempting to have a gobal counter the can can used by any function in the program. Is this possible?</p>\n</blockquote>\n\n<p>Yes, even though it's not a good thing to use global variable.</p>\n\n<p>All you need to do is to declare the function in global scope. You should also initialise it in <code>main</code> before any function call.</p>\n\n<pre><code>int count;\n\nint main()\n{\n    count = 0;\n    incrementCount();\n    ...\n}\n</code></pre>\n\n<p>There is no need to use pointer in your case. And it's wrong as well, because you have not allocate any memory for that pointer.</p>\n"}, {"tags": [], "owner": {"reputation": 951, "user_id": 6339395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93045a766ed5527e61c165a271cb4622?s=128&d=identicon&r=PG&f=1", "display_name": "The Philomath", "link": "https://stackoverflow.com/users/6339395/the-philomath"}, "is_accepted": false, "score": 2, "last_activity_date": 1574832058, "creation_date": 1574832058, "answer_id": 59063483, "question_id": 59063435, "link": "https://stackoverflow.com/questions/59063435/how-to-have-a-global-variable-in-c-that-increments-when-used-by-any-function/59063483#59063483", "title": "How to have a global variable in C that increments when used by any function", "body": "<p>No need to take a pointer. Take a Variable like</p>\n\n<p><code>int count;</code></p>\n\n<p>If you are going to use it in a single file better to declare it <code>static</code>.</p>\n\n<p>A much better approach would be using the getter and setter functions instead of updating global variable everywhere</p>\n"}, {"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 0, "last_activity_date": 1574832546, "last_edit_date": 1574832546, "creation_date": 1574832226, "answer_id": 59063521, "question_id": 59063435, "link": "https://stackoverflow.com/questions/59063435/how-to-have-a-global-variable-in-c-that-increments-when-used-by-any-function/59063521#59063521", "title": "How to have a global variable in C that increments when used by any function", "body": "<p>Firstly there are few issues in the shared code sample. Here</p>\n\n<pre><code>int* count; /* count is pointer i.e you need to make count to hold or point to some valid memory location */\n</code></pre>\n\n<p><code>count</code> is of <em>int pointer</em> type. And here</p>\n\n<pre><code> *count = 0; /* de-referencing uninitiated pointer */\n</code></pre>\n\n<p>you are trying to de-reference <code>count</code> which has not valid memory. It causes segmentation fault. Before de-referencing you need to allocate memory. for e.g</p>\n\n<pre><code> count = malloc(sizeof(*count));\n /* error handling of malloc return value */\n *count = 0;\n</code></pre>\n\n<blockquote>\n  <p>I am attempting to have a gobal counter the can can used by any\n  function in the program ?</p>\n</blockquote>\n\n<p>You can do the same task without using pointer, try using <code>static</code> if use having file scope. If possible avoid using global variable.</p>\n"}, {"tags": [], "owner": {"reputation": 181, "user_id": 4376959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7b129c8d5a88f972e9a6748771848764?s=128&d=identicon&r=PG&f=1", "display_name": "apb_developer", "link": "https://stackoverflow.com/users/4376959/apb-developer"}, "is_accepted": false, "score": 0, "last_activity_date": 1574832856, "creation_date": 1574832856, "answer_id": 59063646, "question_id": 59063435, "link": "https://stackoverflow.com/questions/59063435/how-to-have-a-global-variable-in-c-that-increments-when-used-by-any-function/59063646#59063646", "title": "How to have a global variable in C that increments when used by any function", "body": "<p>You can just declare the variable as <em>integer</em> (not pointer).<br>\nYou can have a global <code>getter</code> and <code>setter</code> function. Also initialize the global variable before any function call, best will be in <code>Main()</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574914298, "post_id": 59067764, "comment_id": 104399839, "body": "the OPs posted code is tagged as C, not C++  So the statement: <code>cout</code> will cause a failure of the code to compile as the function: <code>cout</code> is not part of the c language"}], "tags": [], "owner": {"reputation": 144, "user_id": 2982586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56dea6792e3195dcbaff4e46505f4dae?s=128&d=identicon&r=PG&f=1", "display_name": "Math Lover", "link": "https://stackoverflow.com/users/2982586/math-lover"}, "is_accepted": false, "score": 0, "last_activity_date": 1574935961, "last_edit_date": 1574935961, "creation_date": 1574849587, "answer_id": 59067764, "question_id": 59063435, "link": "https://stackoverflow.com/questions/59063435/how-to-have-a-global-variable-in-c-that-increments-when-used-by-any-function/59067764#59067764", "title": "How to have a global variable in C that increments when used by any function", "body": "<blockquote>\n  <p>first, you can't do</p>\n</blockquote>\n\n<pre><code>*count = 0;\n</code></pre>\n\n<blockquote>\n  <p>if you don't have initialised your pointer, it means refrenced to a\n  variable like:</p>\n</blockquote>\n\n<pre><code>count = &amp;x;\n</code></pre>\n\n<blockquote>\n  <p>Then, if you want that variable is shared and the value is always\n  updated between methods you can simply declare the variable as\n  \"static\",</p>\n</blockquote>\n\n<pre><code>#include &lt;stdio.h&gt;\nstatic int count;\n\n    main(){\n       printf(\"%d\",count);\n    }\n\n    void incrementCount(){\n       ++count;\n    }\n\n    int getCount(){\n       return count;\n    }\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10180319, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tVAX4Aote9U/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pThnMIXh6-CezGTeV0-FhzkMBFVg/mo/photo.jpg?sz=128", "display_name": "richard bent", "link": "https://stackoverflow.com/users/10180319/richard-bent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 720, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1574935961, "creation_date": 1574831778, "question_id": 59063435, "link": "https://stackoverflow.com/questions/59063435/how-to-have-a-global-variable-in-c-that-increments-when-used-by-any-function", "title": "How to have a global variable in C that increments when used by any function", "body": "<p>I am attempting to have a gobal counter the can can used by any function in the program. Is this possible?</p>\n\n<pre><code>int* count;\n\nmain(){\n   *count = 0;\n}\n\nvoid incrementCount(){\n   ++*count;\n}\n\nint getCount(){\n   return *count;\n}\n</code></pre>\n\n<p>If not possible how can I do something similar?</p>\n"}, {"tags": ["c", "arm", "encryption-symmetric", "mbedtls"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12335840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894f7f4a96587e24308f3d2e8e835b41?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/12335840/jim"}, "is_accepted": false, "score": 0, "last_activity_date": 1574834232, "creation_date": 1574834232, "answer_id": 59063895, "question_id": 59063383, "link": "https://stackoverflow.com/questions/59063383/mbed-tls-symetric-key-wrap/59063895#59063895", "title": "MBED TLS Symetric Key Wrap", "body": "<p>I found a solution, using the nist_kw interface</p>\n\n<pre><code>  //Initialise key-wrap context\n  mbedtls_nist_kw_init(&amp;kw_ctx);\n  //Set up the context\n  mbedtls_nist_kw_setkey(&amp;kw_ctx, MBEDTLS_CIPHER_ID_AES, AES_key, 128, 0);\n\n  //Process the encrypted data\n  mbedtls_nist_kw_unwrap(&amp;kw_ctx, MBEDTLS_KW_MODE_KW, \n                         pEncryptedData, encrypted_length,\n                         pPlainValue, &amp;decrypted_length,\n                         encryptedDataLength);\n\n  //Free the context\n  mbedtls_nist_kw_free(&amp;kw_ctx);\n</code></pre>\n\n<p>This decrypts the data correctly for me. Thanks for being my rubber ducky!</p>\n"}], "owner": {"reputation": 11, "user_id": 12335840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894f7f4a96587e24308f3d2e8e835b41?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/12335840/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574834232, "creation_date": 1574831465, "question_id": 59063383, "link": "https://stackoverflow.com/questions/59063383/mbed-tls-symetric-key-wrap", "title": "MBED TLS Symetric Key Wrap", "body": "<p>I'm trying to use MBED TLS cryptography functions to unwrap a key which has been encrypted using AES-128 key wrapping using a symmetric key, which I have. </p>\n\n<p>I'm new to encryption and my understanding is that key wrapping/unwrapping is different to encrypting/decrypting. Is this correct?</p>\n\n<p>There are examples listed on <a href=\"https://tls.mbed.org/kb/development/sample_applications\" rel=\"nofollow noreferrer\">this page </a> but the aes examples are doing decryption rather than key unwrapping, and the wrap examples are using public keys rather than symmetrical keys.</p>\n\n<p>Is there some reference or example for using MBED TLS to do key-unwrapping using AES-128 encryption?</p>\n\n<p>I have tried simply using the decryption function and I do not get the correct data as a result. See below.</p>\n\n<pre><code>  //Initialise AES context\n  mbedtls_aes_init( &amp;aes_ctx );\n  //Set-up the context\n  mbedtls_aes_setkey_dec( &amp;aes_ctx, AES_key, 128 );\n  //Process the encrypted data in blocks of 16 bytes\n  for(i = 0; i&lt; encryptedDataLength; i+= 16)\n  {\n    mbedtls_aes_crypt_ecb( &amp;aes_ctx, MBEDTLS_AES_DECRYPT, pEncryptedData + i, pPlainValue + i); \n  }\n  //Free the context\n  mbedtls_aes_free( &amp;aes_ctx );\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 933, "user_id": 3124390, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100004084560517/picture?type=large", "display_name": "cmutex", "link": "https://stackoverflow.com/users/3124390/cmutex"}, "edited": false, "score": 0, "creation_date": 1574835906, "post_id": 59063445, "comment_id": 104367068, "body": "I know bit fields are not individually addressable. But I don&#39;t understand why the standard says &quot;no matter what the size&quot;. If the sizes of bit-fields b and c above are, let&#39;s say 64 and 64 (making stuff up here), the standard says its not safe to concurrently update a and d (which are separated by more than 16 bytes). So, it doesn&#39;t specifically answer the question."}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 1, "creation_date": 1574839814, "post_id": 59063445, "comment_id": 104368668, "body": "Well, there might be or come a time when processors are using words with more than 128 bits. Just because our common CPUs have 64 bit width and most people think it&#39;s more than enough this doesn&#39;t have to be carved in stone. I think the standard didn&#39;t want to set a limit."}, {"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "reply_to_user": {"reputation": 933, "user_id": 3124390, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100004084560517/picture?type=large", "display_name": "cmutex", "link": "https://stackoverflow.com/users/3124390/cmutex"}, "edited": false, "score": 0, "creation_date": 1574860877, "post_id": 59063445, "comment_id": 104380213, "body": "@user3124390  It says &quot;no matter what size&quot;, because the alternative is to provide guarantees of separation with certain patterns of sizes.  That would be complicated and would imply implementation choices that the standard didn&#39;t want to make. Instead they gave you explicit mechanism for separating them -- the 0-size bit field."}, {"owner": {"reputation": 933, "user_id": 3124390, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100004084560517/picture?type=large", "display_name": "cmutex", "link": "https://stackoverflow.com/users/3124390/cmutex"}, "edited": false, "score": 0, "creation_date": 1574895207, "post_id": 59063445, "comment_id": 104396079, "body": "that makes sense."}], "tags": [], "owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "is_accepted": true, "score": 6, "last_activity_date": 1574831846, "creation_date": 1574831846, "answer_id": 59063445, "question_id": 59063315, "link": "https://stackoverflow.com/questions/59063315/concurrent-update-of-bit-fields-in-c/59063445#59063445", "title": "Concurrent update of bit-fields in C", "body": "<p>Bit fields aren't individually addressable, so to set a bit field, the compiler makes machine code to:</p>\n\n<ol>\n<li>Read the byte that includes the bits to set</li>\n<li>Set the required bits in that byte</li>\n<li>Write the whole byte back.</li>\n</ol>\n\n<p>Sometimes this is done in a single instruction, but then the processor does the same job.</p>\n\n<p>Either way, if another thread is simultaneously doing he same sort of thing on other bits in the same byte, then the operations of the two threads can interfere with each other.</p>\n\n<p>Note also:  you can't rely on the unit of access being a byte, it could be a whole <code>int</code> or <code>unsigned</code>, for example.</p>\n"}], "owner": {"reputation": 933, "user_id": 3124390, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100004084560517/picture?type=large", "display_name": "cmutex", "link": "https://stackoverflow.com/users/3124390/cmutex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 59063445, "answer_count": 1, "score": 4, "last_activity_date": 1574831846, "creation_date": 1574831067, "question_id": 59063315, "link": "https://stackoverflow.com/questions/59063315/concurrent-update-of-bit-fields-in-c", "title": "Concurrent update of bit-fields in C", "body": "<p>Section 3.15.3 of the C standard states:</p>\n\n<blockquote>\n  <p>\"it is not safe to concurrently update two non-atomic bit-fields in\n  the same structure if all members declared between them are also\n  non-zero-length bit-fields, no matter what the size of those\n  intervening bit-fields happen to be.\"</p>\n</blockquote>\n\n<p>Consider the below example:</p>\n\n<pre><code>struct S {\n  unsigned a: 8;\n  unsigned b: 4;\n  unsigned c: 4;\n  unsigned d: 8;\n};\n</code></pre>\n\n<p>Based on the standard, it's not safe to update bit-fields <code>a</code> and <code>d</code> concurrently. </p>\n\n<p>Why not?</p>\n"}, {"tags": ["c", "arrays", "for-loop", "while-loop"], "comments": [{"owner": {"reputation": 1619, "user_id": 4661875, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/KeUsL.png?s=128&g=1", "display_name": "Bussller", "link": "https://stackoverflow.com/users/4661875/bussller"}, "edited": false, "score": 2, "creation_date": 1574829091, "post_id": 59062980, "comment_id": 104364995, "body": "Can you pls post your current outputs/error messages?"}, {"owner": {"reputation": 2462, "user_id": 5293112, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JGyvU.png?s=128&g=1", "display_name": "kuro", "link": "https://stackoverflow.com/users/5293112/kuro"}, "edited": false, "score": 2, "creation_date": 1574829154, "post_id": 59062980, "comment_id": 104365011, "body": "What are you trying to do by  <code>j = -5</code>? Also isn&#39;t it better to set <code>playerGuessArray[j]</code> to something like -1 as 0 is a valid digit for your usecase."}], "answers": [{"tags": [], "owner": {"reputation": 378, "user_id": 9019442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b011a3cdd33bd3aaa5d09c127307257d?s=128&d=identicon&r=PG&f=1", "display_name": "Devanshi Mishra", "link": "https://stackoverflow.com/users/9019442/devanshi-mishra"}, "is_accepted": true, "score": 4, "last_activity_date": 1574829845, "last_edit_date": 1574829845, "creation_date": 1574829505, "answer_id": 59063096, "question_id": 59062980, "link": "https://stackoverflow.com/questions/59062980/c-function-that-compares-two-four-digit-number-arrays/59063096#59063096", "title": "C- Function that compares two four digit number arrays", "body": "<p>You are assigning <code>i = 0</code> inside the while loop while generating the playerGuessArray and generatedNumArray. Due to which the playerGuess and generatedNumArray array will have elements as <code>first digit of your number 0 0 0</code> . \nMove the initialization out of the loop.</p>\n"}, {"tags": [], "owner": {"reputation": 1619, "user_id": 4661875, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/KeUsL.png?s=128&g=1", "display_name": "Bussller", "link": "https://stackoverflow.com/users/4661875/bussller"}, "is_accepted": false, "score": 1, "last_activity_date": 1574830910, "creation_date": 1574830910, "answer_id": 59063288, "question_id": 59062980, "link": "https://stackoverflow.com/questions/59062980/c-function-that-compares-two-four-digit-number-arrays/59063288#59063288", "title": "C- Function that compares two four digit number arrays", "body": "<pre><code>int getSameDigitScore(int playerGuess, int generatedNum) {\n\n    int score = 0;\n    int i, j, k, n;\n    int generatedNumArray[4];\n    int playerGuessArray[4];\n\n// turns playerGuess into an array  \n    i = 0; // This has been out of while loop\n    while (playerGuess &gt; 0 ) {\n        playerGuessArray[i] = playerGuess % 10;\n        i++;\n        playerGuess /= 10;\n    }\n// turns generatedNum into an array\n    int n = 0; // This has been out of the while loop\n    while (generatedNum &gt; 0) {\n        generatedNumArray[n] = generatedNum % 10;   \n        n++;\n        generatedNum /= 10;\n    }\n// compares the two arrays  \n    for (k = 3; k &gt;= 0; k--) {\n\n        for (j = 3; j &gt;= 0; j--) {\n\n            if (generatedNumArray[k] == playerGuessArray[j]) {\n                score++;\n                playerGuessArray[j] = 0;\n                j = -5;\n        }\n    }\n}\n\nreturn score;\n}\n\nint main() {\n    int m;\n\n    n = getSameDigitScore(1231, 2342);\n    printf(\"Score is: %d\\n\", m);\n}\n</code></pre>\n\n<p>You're re-initializing increment variable <code>i</code> on every iteration which should be moved out of the while loop. With that moved out the above code works fine.</p>\n"}, {"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 1, "last_activity_date": 1574831006, "creation_date": 1574831006, "answer_id": 59063303, "question_id": 59062980, "link": "https://stackoverflow.com/questions/59062980/c-function-that-compares-two-four-digit-number-arrays/59063303#59063303", "title": "C- Function that compares two four digit number arrays", "body": "<p>There are the following issues with the code.</p>\n\n<ul>\n<li><p>You are initializing the integer <code>i</code> inside the while loop. This needs to be done before the loop for each loop.</p></li>\n<li><p>You need a separate array to get the output of equal digits. See <code>AnswerArray</code> in code below. Also it is a good design practice to pass this array to the function and clear this array inside the function.</p></li>\n<li><p>In the last for loop, you should break from the inner loop after getting a match. This is to take care of cases where <code>playerGuess == 1222</code> and <code>generatedNum = 1111</code> In the code shown this will result in a <code>score</code> of 1. </p></li>\n</ul>\n\n<p>See the final code below with some test cases.</p>\n\n<pre><code>int getSameDigitScore(int playerGuess, int generatedNum, int *AnswerArray) {\n\n    int score = 0;\n    int i;\n    int j;\n    int k;\n    int generatedNumArray[4] = {0};\n    int playerGuessArray[4] = {0};\n\n    memset(AnswerArray,0,4*sizeof(int));\n    // turns playerGuess into an array  \n    i = 0;\n    while (playerGuess &gt; 0 ) {\n        playerGuessArray[i] = playerGuess % 10;\n        i++;\n        playerGuess /= 10;\n    }\n    // turns generatedNum into an array\n    i = 0;\n    while (generatedNum &gt; 0) {\n        generatedNumArray[i] = generatedNum % 10;   \n        i++;\n        generatedNum /= 10;\n    }\n    // compares the two arrays\n    score=0;\n    for (k = 3; k &gt;= 0; k--) {\n        for (j = 3; j &gt;= 0; j--) {\n            if (generatedNumArray[k] == playerGuessArray[j]) {\n                AnswerArray[score++] = generatedNumArray[k];\n                playerGuessArray[j] = -1;\n                break;\n            }\n        }\n    }\n\n    return score;\n}\n\nint main(void)\n{\n    int AnswerArray[4],score;\n\n    score = getSameDigitScore(4311,1488,AnswerArray);\n    printf (\"\\nScore = %d \\n Answer Array =  \",score);\n    for (int i=0; i&lt;score; i++)\n    {\n        printf (\"%d \",AnswerArray[i]);\n    }\n\n    score = getSameDigitScore(4311,1147,AnswerArray);\n    printf (\"\\nScore = %d \\n Answer Array =  \",score);\n    for (int i=0; i&lt;score; i++)\n    {\n        printf (\"%d \",AnswerArray[i]);\n    }\n\n    score = getSameDigitScore(1222,1111,AnswerArray);\n    printf (\"\\nScore = %d \\n Answer Array =  \",score);\n    for (int i=0; i&lt;score; i++)\n    {\n        printf (\"%d \",AnswerArray[i]);\n    }\n\n    score = getSameDigitScore(1111,1222,AnswerArray);\n    printf (\"\\nScore = %d \\n Answer Array =  \",score);\n    for (int i=0; i&lt;score; i++)\n    {\n        printf (\"%d \",AnswerArray[i]);\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 319, "user_id": 9829169, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sameer Khan", "link": "https://stackoverflow.com/users/9829169/sameer-khan"}, "is_accepted": false, "score": 1, "last_activity_date": 1574996994, "last_edit_date": 1574996994, "creation_date": 1574831255, "answer_id": 59063346, "question_id": 59062980, "link": "https://stackoverflow.com/questions/59062980/c-function-that-compares-two-four-digit-number-arrays/59063346#59063346", "title": "C- Function that compares two four digit number arrays", "body": "<p>The initializing <code>i=0</code> which you made inside the loop should be outside the loop.</p>\n\n<pre><code>    while (playerGuess &gt; 0 ) {\n        i = 0;\n        playerGuessArray[i] = playerGuess % 10;\n        i++;\n        playerGuess /= 10;\n    }\n</code></pre>\n\n<p>If the initialization is inside the looop then,</p>\n\n<p>Everytime <code>playerGuessArray[0]</code> value will be updated.</p>\n\n<p>FYI:</p>\n\n<p>If playerGuess can contain <code>0</code> aat the begin of four digit like <code>0123</code></p>\n\n<p>For example, playerGuessValue is 0123, Then by using</p>\n\n<pre><code>while (playerGuess &gt; 0 ) {\n        i = 0;\n        playerGuessArray[i] = playerGuess % 10;\n        i++;\n        playerGuess /= 10;\n}\n\n</code></pre>\n\n<p>playerGuessArray will contain only <code>[1,2,3]</code> instead of <code>[0,1,2,3]</code>.</p>\n\n<p>So, the better solution would be taking two temporary variables and checking last digit one by one.\nLike this:</p>\n\n<pre><code>int temp1=playerGuess, temp2=GeneratedNum;\nint i=0;\nbool flag = true;\nwhile(flag &amp;&amp; i &lt; 4){\n  if(temp1%10 != temp2%10){\n     flag = false;\n  }\n temp1 /= 10;\n temp2 /= 10;\n i++;\n}\n\nif(flag){\n  score++;\n}\n\n</code></pre>\n\n<p>FYI:\nDebugging will help you in finding out these little mistakes.So, try to debug your code with multiple inputs and verify your answer.</p>\n\n<p>Here are few reference on how to debug:</p>\n\n<p><a href=\"https://blog.hartleybrody.com/debugging-code-beginner/\" rel=\"nofollow noreferrer\">https://blog.hartleybrody.com/debugging-code-beginner/</a></p>\n\n<p><a href=\"https://www.codementor.io/mattgoldspink/how-to-debug-code-efficiently-and-effectively-du107u9jh%60\" rel=\"nofollow noreferrer\">https://www.codementor.io/mattgoldspink/how-to-debug-code-efficiently-and-effectively-du107u9jh%60</a></p>\n\n<p>Thanks.</p>\n"}], "owner": {"reputation": 57, "user_id": 12164497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb541a619a974a084c2d4f62f518efbb?s=128&d=identicon&r=PG&f=1", "display_name": "jason96", "link": "https://stackoverflow.com/users/12164497/jason96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 59063096, "answer_count": 4, "score": 2, "last_activity_date": 1574996994, "creation_date": 1574828584, "last_edit_date": 1574830767, "question_id": 59062980, "link": "https://stackoverflow.com/questions/59062980/c-function-that-compares-two-four-digit-number-arrays", "title": "C- Function that compares two four digit number arrays", "body": "<p>I'm trying to create a function that compares two four digit numbers and\nreturns the number of similar digits between the two. For example, with a generated number of 4311 and the user entered 1488, \nthe score should return 2 (4 and 1). </p>\n\n<p>If it was 4311 and the other is 1147, \nthe score should return three (1, 1 and 4). I don't know why it isn't giving me the right outputs, hope you can help.</p>\n\n<pre><code>int getSameDigitScore(int playerGuess, int generatedNum) {\n\n    int score = 0;\n    int i;\n    int j;\n    int k;\n    int generatedNumArray[4];\n    int playerGuessArray[4];\n\n    // turns playerGuess into an array  \n    while (playerGuess &gt; 0 ) {\n        i = 0;\n        playerGuessArray[i] = playerGuess % 10;\n        i++;\n        playerGuess /= 10;\n    }\n    // turns generatedNum into an array\n    while (generatedNum &gt; 0) {\n        i = 0;\n        generatedNumArray[i] = generatedNum % 10;   \n        i++;\n        generatedNum /= 10;\n    }\n    // compares the two arrays  \n    for (k = 3; k &gt;= 0; k--) {\n\n        for (j = 3; j &gt;= 0; j--) {\n\n            if (generatedNumArray[k] == playerGuessArray[j]) {\n                score++;\n                playerGuessArray[j] = 0;\n                j = -5;\n            }\n        }\n    }\n\n    return score;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "sorting"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574827211, "post_id": 59062781, "comment_id": 104364567, "body": "Please add warnings output as text and not a link to an image. And please ask a specific question - what is it you don&#39;t understand or need help with?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574827322, "post_id": 59062781, "comment_id": 104364587, "body": "Review <code>temp == info[i];</code>.  Tip: enable all compiler warnings."}, {"owner": {"reputation": 11, "user_id": 12437187, "user_type": "registered", "profile_image": "https://graph.facebook.com/2664745223586224/picture?type=large", "display_name": "Bimsara Monnekulama", "link": "https://stackoverflow.com/users/12437187/bimsara-monnekulama"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574828659, "post_id": 59062781, "comment_id": 104364898, "body": "@kaylum Thank you for responding. I added a screenshot of warnings and also as a text that display while compiling the program. I need to get rid of those warnings. Thank You"}, {"owner": {"reputation": 11, "user_id": 12437187, "user_type": "registered", "profile_image": "https://graph.facebook.com/2664745223586224/picture?type=large", "display_name": "Bimsara Monnekulama", "link": "https://stackoverflow.com/users/12437187/bimsara-monnekulama"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574828873, "post_id": 59062781, "comment_id": 104364950, "body": "@chux-ReinstateMonica Thank you. Noted and done."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574829075, "post_id": 59062781, "comment_id": 104364992, "body": "&quot;I need to get rid of those warnings&quot; is not a question. What do you not understand about <code>expected &#39;int *&#39; but argument is of type &#39;struct Student *&#39;</code>? If you tell us we can explain more but that seems fairly self explanatory."}, {"owner": {"reputation": 11, "user_id": 12437187, "user_type": "registered", "profile_image": "https://graph.facebook.com/2664745223586224/picture?type=large", "display_name": "Bimsara Monnekulama", "link": "https://stackoverflow.com/users/12437187/bimsara-monnekulama"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1574829613, "post_id": 59062781, "comment_id": 104365125, "body": "@kaylum When the code compiles, name of the highest rank student doesn&#39;t print. Sorting works fine. I need to know what are the reason for those warnings and how to remove them."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1574829781, "post_id": 59062781, "comment_id": 104365171, "body": "Yes, but I&#39;m asking you: What is stopping you from fixing the warnings? What is it about this that is unclear to you: <code>expected &#39;int *&#39; but argument is of type &#39;struct Student *&#39;</code>? The function&#39;s first arg is declared to be <code>int info[5]</code> which is of type <code>int *</code>. But you pass it <code>info</code> which is of type <code>struct Student *</code>. So either the function definition needs to change or the caller needs to pas in something different."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1574830871, "post_id": 59062781, "comment_id": 104365423, "body": "To be clear: <code>temp == info[i];</code> is a comparison, not an assignment.  Enable more warnings."}], "owner": {"reputation": 11, "user_id": 12437187, "user_type": "registered", "profile_image": "https://graph.facebook.com/2664745223586224/picture?type=large", "display_name": "Bimsara Monnekulama", "link": "https://stackoverflow.com/users/12437187/bimsara-monnekulama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574828969, "creation_date": 1574827036, "last_edit_date": 1574828969, "question_id": 59062781, "link": "https://stackoverflow.com/questions/59062781/this-c-program-to-sort-the-students-array-size-5-based-on-the-students-rank-tho", "title": "This C program to sort the students array size 5 based on the students rank. Those ranking need to be sorted by selection and insertion sorting method", "body": "<p><strong>These Warning Pops When Program Compiles</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/C5zNp.png\" rel=\"nofollow noreferrer\">Warnings List</a></p>\n\n<pre><code>C:\\MinGW\\Bimsara\\Third Semester\\DTS\\Week7&gt;gcc -o test test.c\ntest.c: In function 'main':\n\ntest.c:31:27: warning: passing argument 1 of 'selectionSortStudents' from incompatible pointer type [-Wincompatible-pointer-types]\n     selectionSortStudents(info, 5);\n                       ^~~~\ntest.c:14:6: note: expected 'int *' but argument is of type 'struct Student *'\n void selectionSortStudents(int info[5], int count);\n\ntest.c:35:27: warning: passing argument 1 of 'insertionSortStudents' from incompatible pointer type [-Wincompatible-pointer-types]\n     insertionSortStudents(info, 5);\n                       ^~~~\ntest.c:15:6: note: expected 'int *' but argument is of type 'struct Student *'\n\n\nvoid insertionSortStudents(int info[5], int count);\n</code></pre>\n\n<p><strong>Program</strong>\nStructure </p>\n\n<pre><code>struct Student\n{\n    char Name[100];\n    int Rank;\n};\n</code></pre>\n\n<p>struct Student info[5];\nMain Function</p>\n\n<p>This is how I passed parameters in main function</p>\n\n<pre><code>    selectionSortStudents(info, 5);\n\n    insertionSortStudents(info, 5);\n</code></pre>\n\n<p>Function used to selection sort</p>\n\n<pre><code>void selectionSortStudents(int info[5], int count)\n{\n    int i;\n    for (i = 0; i &lt; count - 1; i++)\n    {\n        int j, min, temp;\n        min = i;\n        for (j = i + 1; j &lt; count; j++)\n        {\n            if (info[j] &lt; info[min])\n                min = j;\n        }\n        temp == info[i];\n        info[i] = info[min];\n        info[min] == temp;\n    }\n}\n</code></pre>\n\n<p>Function used to insertion sort</p>\n\n<pre><code>void insertionSortStudents(int info[5], int count)\n{\n    int i, j, index;\n    for (i = 1; i &lt; count; i++)\n    {\n        index = info[i];\n        for (j = i; j &gt; 0 &amp;&amp; info[j - 1] &gt; index; j--)\n            info[j] = info[j - 1];\n        info[j] = index;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "unix"], "comments": [{"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 3, "creation_date": 1574825497, "post_id": 59062566, "comment_id": 104364199, "body": "Please update the title to describe the problem in a way that captures the issue. As written, the title does nothing to give a clue as to what the question is about, which will reduce the number of people willing to click through to look at it."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1574825657, "post_id": 59062566, "comment_id": 104364242, "body": "<code>ch</code> should be an <code>int</code>. <code>getchar()</code> returns an <code>int</code>."}, {"owner": {"reputation": 822, "user_id": 11333755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIwIM.jpg?s=128&g=1", "display_name": "Gopika BG", "link": "https://stackoverflow.com/users/11333755/gopika-bg"}, "edited": false, "score": 0, "creation_date": 1574838980, "post_id": 59062566, "comment_id": 104368302, "body": "for the server to send an acknowledgment message to the client once it recieves the message from client, open it in O_WRONLY mode after receiving a non-empty string from client."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574912942, "post_id": 59062566, "comment_id": 104399591, "body": "1) please include the <code>#include</code> statements for each of the posted code sequences so we can reproduce the problem.  2) please indicate exactly what the problem is.  3) for ease of readability and understanding, consistently indent the code,  Indent after every opening brace.  Unindent before every closing brace.  Strongly suggest each indent level is 4 spaces,"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574913086, "post_id": 59062566, "comment_id": 104399613, "body": "OT: regarding: <code>int main(int argc, char *argv[]){</code>  Since neither of the parameters are used, this will cause the compiler to output two warning messages about unused parameters.  Suggest using the signature: <code>int main( void )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574913343, "post_id": 59062566, "comment_id": 104399661, "body": "there is no code in the client to receive any message from the server!"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574913561, "post_id": 59062566, "comment_id": 104399701, "body": "when calling C library functions, like <code>open()</code>, <code>read()</code>, <code>write()</code> and <code>close()</code>  always check the returned value to assure the operation was successful"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574913813, "post_id": 59062566, "comment_id": 104399751, "body": "regarding statements like: <code>fprintf(stderr, &quot;trying to connect\\n&quot;);</code>  strongly suggest calling <code>perror()</code> as that function will output both your error message AND the text reason the system thinks the function failed to <code>stderr</code>"}], "owner": {"reputation": 23, "user_id": 11730854, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-b8jRv49oZ7M/AAAAAAAAAAI/AAAAAAAAEVg/ISA37Esa5BU/photo.jpg?sz=128", "display_name": "Prachi Rajesh Jansari", "link": "https://stackoverflow.com/users/11730854/prachi-rajesh-jansari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574825662, "creation_date": 1574825397, "last_edit_date": 1574825662, "question_id": 59062566, "link": "https://stackoverflow.com/questions/59062566/client-server-communication-with-basic-fifo-send-acknowledgment-to-client-from", "title": "client- server communication with basic fifo, send acknowledgment to client from server after message received", "body": "<p>I want the server to send an acknowledgment message to the client once it recieves the message from client. \nI am trying to get the message be printed on client side </p>\n\n<p>server.c</p>\n\n<pre><code>  // This is the server\n  int main(int argc, char *argv[]){  \n   int fd;\n  char ch;\n\nunlink(\"../myserver\"); // delete it if it exists  \n\n      if(mkfifo(\"../myserver\", 0777)!=0)\n    exit(1);\n\n      while(1){\n    fprintf(stderr, \"Waiting for a client\\n\");  \n\n    fd = open(\"../myserver\", O_RDONLY);  \n    fprintf(stderr, \"Got a client: \");  \n\n\n        if(read(fd, &amp;ch, 1) == 1){\n        fprintf(stderr, \"%c \", ch);\n        close(fd);\n    }\n  }\n}\n</code></pre>\n\n<p>client.c</p>\n\n<pre><code> int main(int argc, char *argv[]){  \n  int fd;\nchar ch;\nchar reply[100];\n\nwhile((fd=open(\"../myserver\", O_WRONLY))==-1){  \n    fprintf(stderr, \"trying to connect\\n\");  \n    sleep(1);\n}\n\nprintf(\"Connected: type in data to be sent\\n\");  \n\nwhile((ch=getchar()) != -1) // -1 is CTRL-D\n    write(fd, &amp;ch, 1);  \n\nclose(fd);\n\nwhile(fd = open(\"../myserver\", O_RDONLY));  \n    fprintf(stderr, \"received message\\n\");\n }\n</code></pre>\n"}, {"tags": ["c", "file", "sorting", "multidimensional-array"], "comments": [{"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 2, "creation_date": 1574825123, "post_id": 59062455, "comment_id": 104364118, "body": "<code>int k = sizeof(line)&#47;sizeof(line[0]);</code> is the same as <code>int k = TOT;</code>"}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 2, "creation_date": 1574825168, "post_id": 59062455, "comment_id": 104364124, "body": "You pass k to selectionSort_str but that is wrong - you don&#39;t want to sort the ENTIRE array - you only want to sort the number of items you read from the file."}, {"owner": {"reputation": 1, "user_id": 12442441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa67a5de837467331814ed37cc339f33?s=128&d=identicon&r=PG&f=1", "display_name": "Aquase", "link": "https://stackoverflow.com/users/12442441/aquase"}, "reply_to_user": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1574826425, "post_id": 59062455, "comment_id": 104364391, "body": "Oh it was my understanding that I do want to sort the entire array as it contains the string of characters, or the names, and nothing else."}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 1, "creation_date": 1574886944, "post_id": 59062455, "comment_id": 104393220, "body": "The array is 10 strings long.  The first five entries have names read from the file.  But you don&#39;t initialise the other ones so they contain random data.  If you sort all 10 elements you will mix in the uninitialised items.  You only want to sort the elements read from the file."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574964287, "post_id": 59062455, "comment_id": 104422521, "body": "OT: regarding: <code>plist = fopen(&quot;plist1.txt&quot;, &quot;r&quot;);</code>  When calling <code>fopen()</code>, always check (!=NULL) the returned value to assure the operation was successful."}], "answers": [{"comments": [{"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 1, "creation_date": 1574826872, "post_id": 59062742, "comment_id": 104364495, "body": "The other problem is that if the last line in the file doesn&#39;t end with a linefeed then the code to delete it deletes the last character of the name instead.  To deal with both of them possibly appearing or not you can <code>line[i][strcspn(line[i],&quot;\\r\\n&quot;)] = &#39;\\0&#39;;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574964617, "post_id": 59062742, "comment_id": 104422628, "body": "The problem with the OPs posted code is the sorting of unused entries in the array of strings, NOT the elimination of the (possible) trailing newline character(s)  So this answer is wrong"}], "tags": [], "owner": {"reputation": 3310, "user_id": 1853605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ab8d886abc51e874c1ed067b912ddd?s=128&d=identicon&r=PG", "display_name": "Potato", "link": "https://stackoverflow.com/users/1853605/potato"}, "is_accepted": false, "score": 0, "last_activity_date": 1574826672, "creation_date": 1574826672, "answer_id": 59062742, "question_id": 59062455, "link": "https://stackoverflow.com/questions/59062455/how-do-i-read-a-list-of-strings-from-file-into-a-dynamic-two-dimensional-array-a/59062742#59062742", "title": "How do I read a list of strings from file into a dynamic two-dimensional array and then sort it in C", "body": "<p>you are possibly a victim of stale <code>\\r\\n</code> , this hack below should help</p>\n\n<pre><code>while(fgets(line[i], sizeof(line[i]), plist)) {\n        line[i][strlen(line[i]) - 1] = '\\0';\n\n        // these stale '/r' s when used in strcmp will give unwanted results\n        // so strip those aswell..\n        if( line[i][strlen(line[i]) - 1] == '\\r' )\n            line[i][strlen(line[i]) - 1] = '\\0';\n\n        i++;\n    }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12442441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa67a5de837467331814ed37cc339f33?s=128&d=identicon&r=PG&f=1", "display_name": "Aquase", "link": "https://stackoverflow.com/users/12442441/aquase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574826672, "creation_date": 1574824367, "question_id": 59062455, "link": "https://stackoverflow.com/questions/59062455/how-do-i-read-a-list-of-strings-from-file-into-a-dynamic-two-dimensional-array-a", "title": "How do I read a list of strings from file into a dynamic two-dimensional array and then sort it in C", "body": "<p>I'm new to C and am having difficulty with reading a file of names into a two-dimensional array to then sort. I figure I should be using malloc, but I'm not quite sure if I have to. The following is the code I have right now which reads the file and prints it out but when I go to sort it only sorts one name with some extra characters added to it. If I could get a hand I would appreciate it.</p>\n\n<p>The file just contains a list of names such as:<br>\nJohn<br>\nAlex<br>\nGeorge<br>\nBeasley</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_LEN 128 \n#define TOT 10 \n\nvoid selectionSort_str(char arr[][MAX_LEN], int n)\n{\n    int i, j, min_idx;\n\n    // One by one move boundary of unsorted subarray \n    char minStr[MAX_LEN];\n    for (i = 0; i &lt; n-1; i++)\n    {\n        // Find the minimum element in unsorted array \n        int min_idx = i;\n        strcpy(minStr, arr[i]);\n        for (j = i+1; j &lt; n; j++)\n        {\n            // If min is greater than arr[j] \n            if (strcmp(minStr, arr[j]) &gt; 0)\n            {\n                // Make arr[j] as minStr and update min_idx \n                strcpy(minStr, arr[j]);\n                min_idx = j;\n            }\n        }\n\n        // Swap the found minimum element with the first element \n        if (min_idx != i)\n        {\n            char temp[MAX_LEN];\n            strcpy(temp, arr[i]); //swap item[pos] and item[i] \n            strcpy(arr[i], arr[min_idx]);\n            strcpy(arr[min_idx], temp);\n        }\n    }\n}\n\n\nint main(void) {\n    char line[TOT][MAX_LEN];\n    FILE *plist = NULL; \n    int i = 0;\n    int total = 0;\n    int k = sizeof(line)/sizeof(line[0]);\n\n    plist = fopen(\"plist1.txt\", \"r\");\n    while(fgets(line[i], MAX_LEN, plist)) {\n        line[i][strlen(line[i]) - 1] = '\\0';\n        i++;\n    }\n\n    total = i;\n\n    for(i = 0; i &lt; total; ++i){\n        printf(\"%s\\n\", line[i]);\n    }\n\n    //sort strings\n    selectionSort_str(line, k);\n    printf(\"*****Sorted array is: \\n\"); \n    for(i = 0; i &lt; k; i++)\n    {\n        printf(\"%s \", line[i]);\n    }    \n\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574967433, "post_id": 59061774, "comment_id": 104423490, "body": "OT: regarding: <code>int sock = socket(PF_INET, SOCK_STREAM, IPPROTO_TCP);</code>  1) the correct type for <code>sock</code> is <code>sock_t</code>, not <code>int</code>.   2) always check the returned value to assure the operation was successful.  Suggest: <code>sock_t sock;  if( (sock = socket(PF_INET, SOCK_STREAM, IPPROTO_TCP) &lt; 0 ) { perror( &quot;socket failed&quot; );  exit( EXIT_FAILURE ); }</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574967527, "post_id": 59061774, "comment_id": 104423531, "body": "how is <code>PORT</code> declared and to what value?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574967690, "post_id": 59061774, "comment_id": 104423585, "body": "OT: regarding: <code>listen(sock, MAXIMUM_CONNECTION )</code>  That parameter: <code>MAXIMUM_CONNECTION</code> is not about how many clients can be connected, but rather how many clients can be waiting in a queue, waiting for their turn to be connected"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574967826, "post_id": 59061774, "comment_id": 104423622, "body": "When including home grown header files, post their contents as part of the question/code.  Otherwise, we can only guess as to their contents.  BTW: unless trying to &#39;inline&#39; the function: <code>exitMessage()</code> it should not be in a header file"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1574968318, "post_id": 59061774, "comment_id": 104423767, "body": "regarding: <i>since then i have been seeing errors.</i>  what errors? Compile errors or communication errors or ???"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1574818507, "creation_date": 1574818507, "answer_id": 59061797, "question_id": 59061774, "link": "https://stackoverflow.com/questions/59061774/my-tcp-socket-server-not-sending-and-receiving/59061797#59061797", "title": "My TCP socket server not sending and receiving", "body": "<p>The socket you listen on is only for accepting new connections, not reading/writing data.  The <code>accept</code> function returns a file descriptor for the accepted socket.  That is the one you should be calling <code>recv</code> and <code>send</code> on.</p>\n\n<pre><code>int newsock;\nif((newsock = accept(sock, (struct sockaddr *) &amp;clientAddr, &amp;clientAddrSize)) &lt; 0) {\n    exitMessage(\"Could not accept new connections\");\n}\n\nif(recv(newsock, buffer, DATA_SIZE - 1, 0) &lt; 0) {\n    exitMessage(\"Failed to receive data from client\");      \n}\n\nprintf(\"\\nReceived: \\'%s\\' to client\\n\", buffer);\nprintf(\"input data for client: \");\n\nint index = 0;\nwhile((data[index++] = getchar()) != '\\n');\n\nif(send(newsock, data, strlen(data), 0) &lt; 0) {\n    exitMessage(\"Failed sending to client\");\n}\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 12366566, "user_type": "registered", "profile_image": "https://graph.facebook.com/669028826633556/picture?type=large", "display_name": "Oyeniyi Abiola Peace", "link": "https://stackoverflow.com/users/12366566/oyeniyi-abiola-peace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 59061797, "answer_count": 1, "score": 1, "last_activity_date": 1574818603, "creation_date": 1574818299, "last_edit_date": 1574818603, "question_id": 59061774, "link": "https://stackoverflow.com/questions/59061774/my-tcp-socket-server-not-sending-and-receiving", "title": "My TCP socket server not sending and receiving", "body": "<p>I am trying to write a TCP socket server for a client then i ran into some problems. The server is not sending/receiving data. However, it can listen to and accept new clients.</p>\n\n<p>I have tried \"nc 127.0.0.1 -l 10001\" to test the client and it works well. The server at one time could send and receive but encoded characters. I made some modifications and since then i have been seeing errors.</p>\n\n<p>The exit Message can be commented or remove as it was declared in custom.h.</p>\n\n<p>Any idea will be appreciated.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n\n#include &lt;arpa/inet.h&gt;\n#include &lt;netinet/in.h&gt;\n\n#include \"custom.h\"\n\n#define PORT 10001\n#define MAXIMUM_CONNECTION 20\n#define DATA_SIZE 100\n\nint main() \n{\n    int sock = socket(PF_INET, SOCK_STREAM, IPPROTO_TCP);\n\n    struct sockaddr_in serverAddr, clientAddr;\n    memset(&amp;serverAddr, '\\0', sizeof(serverAddr));\n    serverAddr.sin_family = AF_INET;\n    serverAddr.sin_port = htons(PORT);\n    serverAddr.sin_addr.s_addr = htonl(INADDR_ANY);\n\n    if(bind(sock, (struct sockaddr *) &amp;serverAddr, sizeof(serverAddr)) &lt; 0) {\n        exitMessage(\"Failed to address to port\");\n    }\n\n    if(listen(sock, MAXIMUM_CONNECTION) &lt; 0) {\n        exitMessage(\"Server is deaf could not listen to incoming messages\");    \n    }\n\n    char buffer[DATA_SIZE], data[DATA_SIZE];\n\n    while(1) {\n        memset(buffer, '\\0', DATA_SIZE);\n        memset(data, '\\0', DATA_SIZE);\n\n        socklen_t clientAddrSize = sizeof(clientAddr);\n\n        if(accept(sock, (struct sockaddr *) &amp;clientAddr, &amp;clientAddrSize) &lt; 0) {\n            exitMessage(\"Could not accept new connections\");\n        }\n\n        if(recv(sock, buffer, DATA_SIZE - 1, 0) &lt; 0) {\n            exitMessage(\"Failed to receive data from client\");      \n        }\n\n        printf(\"\\nReceived: \\'%s\\' to client\\n\", buffer);\n        printf(\"input data for client: \");\n\n        int index = 0;\n        while((data[index++] = getchar()) != '\\n');\n\n        if(send(sock, data, strlen(data), 0) &lt; 0) {\n            exitMessage(\"Failed sending to client\");\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "tcp"], "answers": [{"comments": [{"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 0, "creation_date": 1574829676, "post_id": 59061706, "comment_id": 104365142, "body": "Thank you for the answer. I tried hard sending the string and got the same result without reading from file."}], "tags": [], "owner": {"reputation": 21554, "user_id": 1329296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1026699dbf4140d3fc7262842428e808?s=128&d=identicon&r=PG", "display_name": "lenik", "link": "https://stackoverflow.com/users/1329296/lenik"}, "is_accepted": true, "score": 3, "last_activity_date": 1574818109, "last_edit_date": 1574818109, "creation_date": 1574817630, "answer_id": 59061706, "question_id": 59061652, "link": "https://stackoverflow.com/questions/59061652/3-way-handshake-file-transfer/59061706#59061706", "title": "3-way-handshake file transfer", "body": "<p>You should rewrite your client.</p>\n\n<ol>\n<li><p><code>write(sockfd, buffer, 255);</code> sends garbage, because not all strings are 255 character long, and you're reading string from the file using <code>fscanf()</code>. This is probably where all your \"VS\" comes from.</p></li>\n<li><p><code>getc(fd)</code> makes your client to skip a character once in a while.</p></li>\n<li><p>your word counting routine is clearly interfering with your file sending code, make it a different loop or separate in some other way.</p></li>\n</ol>\n\n<p>All in all, I'd start with a simple client that does:</p>\n\n<pre><code>write(sockfd, \"ABCDEFGH\\n\", 9);\n</code></pre>\n\n<p>and see if you can receive this on the server side. Then do more complicated stuff.</p>\n"}], "owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 59061706, "answer_count": 1, "score": 0, "last_activity_date": 1574818109, "creation_date": 1574817178, "question_id": 59061652, "link": "https://stackoverflow.com/questions/59061652/3-way-handshake-file-transfer", "title": "3-way-handshake file transfer", "body": "<p>I'm trying to transfer file contents between server and client. For some reasons, everything sent appears as VS? on the server side. I included the functions that send the file content</p>\n\n<p>Client.c:</p>\n\n<pre><code>void send_file_to_server(struct tcp_hdr tcp_seg, int sockfd){\n\n  char buffer[255];\n   char c;\n  bzero(buffer, 255);\n  int words = 0;\n  FILE *fd;\n  fd = fopen(\"file.txt\", \"r\");\n  while((c = getc(fd)) != EOF){\n    fscanf(fd, \"%s\", buffer);\n    if(isspace(c) || c=='\\t'){\n      words++;\n    }\n  }\n\n  write(sockfd, buffer, 255);\n\n\n}\n</code></pre>\n\n<p>Server.c </p>\n\n<pre><code>void get_file_from_client(struct tcp_hdr tcp_seg, int sockfd){\n\n\n  FILE *fp;\n  char buffer[255];\n  bzero(buffer,255);\n  int ch = 0;\n  fp = fopen(\"file_two.txt\", \"a\");\n  int words;\n\n  read(sockfd, buffer, 255);\n  printf(\"%s\\n\\n\\n\\n\", buffer);\n  // while(ch != words){\n  //   read(sockfd, buffer, 255);\n  //   fprintf(fp, \"%s\", buffer);\n  // }\n\n\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "ubuntu", "gcc", "ansi-c"], "comments": [{"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 0, "creation_date": 1574814453, "post_id": 59061288, "comment_id": 104361947, "body": "Hmmm, this doesn&#39;t look like the way to get the executable&#39;s directory, the <i>current</i> directory certainly can&#39;t be counted on.  You should be able to open <code>&#47;proc&#47;&lt;pid&gt;&#47;exe</code> and get a symlink to the full path, then strip off the trailing name part. Where are you getting the <code>pth</code> parameter from?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1574814477, "post_id": 59061288, "comment_id": 104361952, "body": "<code>sizeof(exe_dir)</code> print that out."}, {"owner": {"reputation": 130, "user_id": 11691249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mcica.jpg?s=128&g=1", "display_name": "skratpa", "link": "https://stackoverflow.com/users/11691249/skratpa"}, "edited": false, "score": 0, "creation_date": 1574814510, "post_id": 59061288, "comment_id": 104361962, "body": "It&#39;s the first argument in the argv-array passed to main."}, {"owner": {"reputation": 130, "user_id": 11691249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mcica.jpg?s=128&g=1", "display_name": "skratpa", "link": "https://stackoverflow.com/users/11691249/skratpa"}, "edited": false, "score": 0, "creation_date": 1574814681, "post_id": 59061288, "comment_id": 104362006, "body": "sizeof(exe_dir) returns 8 bytes. Yep...found the problem."}, {"owner": {"reputation": 130, "user_id": 11691249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mcica.jpg?s=128&g=1", "display_name": "skratpa", "link": "https://stackoverflow.com/users/11691249/skratpa"}, "edited": false, "score": 0, "creation_date": 1574814805, "post_id": 59061288, "comment_id": 104362041, "body": "Yep, I tried it by creating exe_dir as a local variable and copied it into a second dynamic buffer, which is then returned. That worked. Damn a pointer is obviously most likely going to be 8 bytes on a 64x system."}, {"owner": {"reputation": 3470, "user_id": 531679, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYlCV.gif?s=128&g=1", "display_name": "Steve Friedl", "link": "https://stackoverflow.com/users/531679/steve-friedl"}, "edited": false, "score": 2, "creation_date": 1574814939, "post_id": 59061288, "comment_id": 104362070, "body": "Any caller of <code>execvp</code> can put anything it likes in <code>argv[0]</code>; please make sure you&#39;re not relying on something unreliable."}], "owner": {"reputation": 130, "user_id": 11691249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mcica.jpg?s=128&g=1", "display_name": "skratpa", "link": "https://stackoverflow.com/users/11691249/skratpa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "closed_date": 1574814895, "answer_count": 0, "score": 0, "last_activity_date": 1574820189, "creation_date": 1574813946, "last_edit_date": 1574820189, "question_id": 59061288, "link": "https://stackoverflow.com/questions/59061288/getting-directory-of-executable-failed", "closed_reason": "Duplicate", "title": "Getting directory of executable failed", "body": "<p>So I've used the following code a couple of times and always put it directly into the main function, which always worked flawlessly. But today I tried to pack it into a separate function. This is the function I wrote:</p>\n\n<pre><code>char *getexedir(char *pth)\n{\n    char path_save[512];\n    char *p;\n    char *exe_dir = malloc(512);\n    if(exe_dir == NULL) {\n        printf(\"Failed to allocate memory.\\n\");\n        return(NULL);\n    }\n\n    if(!(p = strrchr(pth, '/'))) {\n        if(getcwd(exe_dir, sizeof(exe_dir)) == NULL) {\n            perror(\"Failed to get current cwd\");\n            return(NULL);\n        }\n    }\n    else {\n        *p = '\\0';\n\n        if(getcwd(path_save, sizeof(path_save)) == NULL) {\n            perror(\"Failed to get current cwd\");\n            return(NULL);\n        }\n\n        if(chdir(pth) &lt; 0) {\n            perror(\"Failed to change directory\");\n            return(NULL);\n        }\n\n        if(getcwd(exe_dir, sizeof(exe_dir)) == NULL) {\n            perror(\"Failed to get changed cwd\");\n            return(NULL);\n        }\n\n        if(chdir(path_save) &lt; 0) {\n            perror(\"Failed to change to previous directory\");\n            return(NULL);\n        }\n    }\n\n    return(exe_dir);\n}\n</code></pre>\n\n<p>Executing this code always failes at the second getcwd() with the error message \"Numerical result out of range\". Can somebody please explain the reason for that?</p>\n\n<p>I am using Ubuntu 18.04, gcc (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0</p>\n"}, {"tags": ["c", "assembly", "visual-c++", "x86", "inline-assembly"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1574813940, "post_id": 59061257, "comment_id": 104361814, "body": "That&#39;s quite straight-forward program, you are unlikely to write better code than the compiler. Any reason why you want assembly, and inline assembly in particular? As for the crash, use a debugger to pinpoint the location and also single step the code. Note that depending on compiler and settings you might not even have <code>ebp</code> set up so you can&#39;t access arguments relative to that. You should really write a standalone assembly module if you insist on assembly at all. Oh, and you should not push 16 bit registers in 32 bit code."}, {"owner": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "edited": false, "score": 0, "creation_date": 1574814145, "post_id": 59061257, "comment_id": 104361863, "body": "Visual C++  allows you to access C++ variables by name within the inline assembly."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1574814150, "post_id": 59061257, "comment_id": 104361865, "body": "(<b>note:</b> when formatting code with <code>```</code>, you need to add the language at the end, e.g. <code>```c</code> of <code>```asm</code>, to preserve syntax highlighting)"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1574814227, "post_id": 59061257, "comment_id": 104361891, "body": "All that said, I think one of your problems is that you are missing a dereference of <code>data-&gt;content</code>, that is replace <code>add edi, 4</code> with <code>mov edi, [edi + 4]</code>."}, {"owner": {"reputation": 133, "user_id": 12173362, "user_type": "registered", "profile_image": "https://graph.facebook.com/215411549445440/picture?type=large", "display_name": "Catalina Cuellar", "link": "https://stackoverflow.com/users/12173362/catalina-cuellar"}, "edited": false, "score": 1, "creation_date": 1574814229, "post_id": 59061257, "comment_id": 104361892, "body": "I need to use assembly and inline assembly because it is an assignment for uni. As for <code>epb</code>, VC++ x86 compiler automatically pushes it and does <code>mov ebp, esp</code>. As for the debugging, I&#39;m not sure how to debug it. Could you recommend a tool or program for debugging inline assembler?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 4, "creation_date": 1574814254, "post_id": 59061257, "comment_id": 104361898, "body": "Visual studio has built in debugger which can show assembly."}, {"owner": {"reputation": 133, "user_id": 12173362, "user_type": "registered", "profile_image": "https://graph.facebook.com/215411549445440/picture?type=large", "display_name": "Catalina Cuellar", "link": "https://stackoverflow.com/users/12173362/catalina-cuellar"}, "edited": false, "score": 0, "creation_date": 1574822614, "post_id": 59061257, "comment_id": 104363621, "body": "After lots of trials and error, I managed to get the debugger going, but is there any way to visualize the stack while debugging?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1574844224, "post_id": 59061257, "comment_id": 104370844, "body": "The,VS debugger has a stack frame pane, IIRC."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 12173362, "user_type": "registered", "profile_image": "https://graph.facebook.com/215411549445440/picture?type=large", "display_name": "Catalina Cuellar", "link": "https://stackoverflow.com/users/12173362/catalina-cuellar"}, "edited": false, "score": 0, "creation_date": 1574826394, "post_id": 59062590, "comment_id": 104364388, "body": "Thank you for all the feedback! As soon as I manage to get it running, I will post it."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 3, "last_activity_date": 1574826683, "last_edit_date": 1574826683, "creation_date": 1574825584, "answer_id": 59062590, "question_id": 59061257, "link": "https://stackoverflow.com/questions/59061257/in-line-assembler-method-crashing-the-entire-program/59062590#59062590", "title": "In line assembler method crashing the entire program", "body": "<p>(turning comments into an answer; the Godbolt links are a bit random and scattered.)</p>\n\n<p><em>If</em> you wantd to write a whole function yourself in asm including a <code>ret</code>, <a href=\"https://docs.microsoft.com/en-us/cpp/cpp/naked-cpp?view=vs-2019\" rel=\"nofollow noreferrer\">use <code>__declspec(naked)</code></a> to stop the compiler from emitting any prologue/epilogue so the entire function body is really just your <code>asm</code> block.  Then you need to set up <code>ebp</code> as a frame pointer yourself, if you want to use it that way.</p>\n\n<p>(Or not; this function needs a lot of registers so you could omit the frame pointer like optimizing compilers do.  But you can save regs by optimizing away the <code>carry</code> into a simple 16-bit shift, with your vars in AH, AL, CH, CL, and so on, and take advantage of 16-bit or 32-bit operand-size to do 2 8-bit operations at once..)</p>\n\n<p><strong>Using your own <code>ret</code> is a bug because ESP is pointing at some regs the compiler saved, unless you're writing a naked function</strong>.</p>\n\n<p>Use Visual Studio's debugger to see what's really going on, preferably with an asm / disassembly view so you can see your code from inline asm in the context of the surrounding compiler-generated code.  (You'll see your <code>ret</code> then the compiler-generated <code>pop</code>s and compiler-generated <code>ret</code> that it was expecting would run after your asm block finished with ESP unmodified)</p>\n\n<p><strong>I'd recommend not using your own push/pop or your own ret</strong> (so <em>not</em> a naked function), and use the C++ variable names inside your asm statement so you can watch them with the debugger by their C++ names, instead of looking at raw stack memory at all.  (But using the debugger's asm / disassembly view, you <em>can</em> see how something like <code>mov ebx, data</code> compiles to probably still the <code>mov ebx, [ebp + 8]</code> like you wrote.)</p>\n\n<p>As Jester points out, <strong><code>add edi, 4</code> is also a bug</strong>: that would make sense if you had <code>struct Info { int len; uint8_t content[1020]; };</code> so the content address is just a small offset from the base of the struct.  But you said you have <code>uint8_t *content;</code> so you need another load from the struct, like <code>mov edi, [edi+4]</code>.  Look at what compilers do for the pure C++ version: <a href=\"https://godbolt.org/z/aVdsED\" rel=\"nofollow noreferrer\">https://godbolt.org/z/aVdsED</a> (or use a lower optimization level like <code>-O1</code>).</p>\n\n<p>You don't need to keep reloading this pointer inside the loop; that doesn't make sense.  Keep the current position in <code>content</code> in a register, and keep an end-pointer in another register (or memory if you run out of registers).  i.e. spill something that's read-only and can be used as a memory operand inside the loop.  So at worst your outer loop becomes <code>cmp edi, [endp]</code> / <code>jb top_of_loop</code> instead of a compare between two registers.</p>\n\n<hr>\n\n<p>Not a real bug (just overcomplication), <strong>but you don't need to manually push/pop registers at the start/end of your asm block</strong> (unless you write a naked function). MSVC will generate code around the function containing the asm block to save/restore any register that need saving, which means they're also free for compiler-generated use.</p>\n\n<p>In fact it will do that anyway because pop edi writes EDI, and it doesn't try to prove that the inline asm matches up push and pop and doesn't modify the saved copy in memory. See <a href=\"https://godbolt.org/z/j5b4W-\" rel=\"nofollow noreferrer\">https://godbolt.org/z/j5b4W-</a> note the compiler-generated part of the compiler output.</p>\n\n<hr>\n\n<p>It looks like you can simplify that manual-carry stuff into <code>shr ax, 1</code>, with <code>a:b</code> in <code>AH:AL</code> = AX.  A lot of your other instructions are doing 16-bit stuff 8 bits at a time, like loading AL and AH from 2 contiguous bytes in memory which could be <code>mov ax, mem</code>.</p>\n\n<p>But for the actual memory access to <code>content[]</code>, compilers don't do it that way. Instead they notice that <code>content[i+1]</code> in one iteration is <code>content[i]</code> in the next iteration, and <code>mov reg,reg</code> instead of storing and reloading. <a href=\"https://godbolt.org/z/aVdsED\" rel=\"nofollow noreferrer\">https://godbolt.org/z/aVdsED</a>.</p>\n\n<p>This is much better; overlapping store/reload is inefficient. But anyway, using ax as <code>a:b</code> would be efficient, shifting 1 bit at a time until <code>test ah,ah</code> finds you've shifted all the bits out.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1574895739, "post_id": 59076254, "comment_id": 104396194, "body": "You&#39;re still using <code>mov ah, [ebp + 16]</code> instead of <code>mov ah, divisor</code>.  It&#39;s usually a bad idea to use EBP directly.  What if this function inlines into another function that has its locals in different places on the stack?"}], "tags": [], "owner": {"reputation": 133, "user_id": 12173362, "user_type": "registered", "profile_image": "https://graph.facebook.com/215411549445440/picture?type=large", "display_name": "Catalina Cuellar", "link": "https://stackoverflow.com/users/12173362/catalina-cuellar"}, "is_accepted": false, "score": 2, "last_activity_date": 1574878447, "creation_date": 1574878447, "answer_id": 59076254, "question_id": 59061257, "link": "https://stackoverflow.com/questions/59061257/in-line-assembler-method-crashing-the-entire-program/59076254#59076254", "title": "In line assembler method crashing the entire program", "body": "<p>After reading and the kind help of the community, I finally managed to get it running as I intended. The fixed code is as follows:</p>\n\n<pre><code>void calculateCRC(Info *data, int lonDiv, unsigned char divisor)\n{   \n    __asm {\n        mov eax, 0\n        mov ah, [ebp + 16] //a = divisor\n        mov al, 0 // b = 0\n        mov esi, 0 //int i = 0\n\n        forLoop: // for\n            mov ebx, [ebp + 8]\n            cmp esi, [ebx] // i &lt; data-&gt;dataLength\n\n            jz end\n            mov ch, 128 // c = 128\n            whileLoop:\n                cmp ah, 0 // while (a != 0)\n                je cutWhile\n            mov edi, [ebp + 8] // Info* data\n            mov edi, [edi + 4] // data-&gt;content\n            mov dh, [edi + esi] // content[i]\n            mov dl, [edi + esi + 1] // content[i+1]\n            test dh, ch // if (content[i] &amp; c)\n            jz next\n                xor dh, ah // data-&gt;content[i] ^ a;\n                xor dl, al // data-&gt;content[i + 1] ^ b;\n                mov [edi + esi], dh // data-&gt;content[i] = data-&gt;content[i] ^ a;\n                mov [edi + esi + 1], dl // data-&gt;content[i + 1] = data-&gt;content[i + 1] ^ b;\n                next:\n                    mov cl, ah // char carry = a\n                    shl cl, 7 // carry = carry &lt;&lt; 7\n                    shr al, 1 // b = b &gt;&gt; 1\n                    or al, cl // b = b | carry\n                    shr ah, 1 // a = a &gt;&gt; 1\n                    shr ch, 1 // c = c &gt;&gt; 1\n                    jmp whileLoop\n            cutWhile:\n                shl ax, 8 // a = b and b = 0\n                inc esi //i++\n                jmp forLoop\n        end:\n    }\n}\n</code></pre>\n\n<p>Changes:</p>\n\n<ul>\n<li><p>Removed <code>pop/push</code> operations and let the compiler do that job.</p></li>\n<li><p>Removed <code>ret</code> operation.</p></li>\n<li><p>Changed <code>add edi, 4</code> to <code>mov edi, [edi + 4]</code>.</p></li>\n</ul>\n\n<p>There is still room for improvement, such as the manual carry operation pointed by Peter on his comments and answer afterward. Yet I will leave it as is for the time being. Thanks a lot to Jester and Peter Cordes for their time and comments.</p>\n"}], "owner": {"reputation": 133, "user_id": 12173362, "user_type": "registered", "profile_image": "https://graph.facebook.com/215411549445440/picture?type=large", "display_name": "Catalina Cuellar", "link": "https://stackoverflow.com/users/12173362/catalina-cuellar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1574899475, "creation_date": 1574813718, "last_edit_date": 1574899475, "question_id": 59061257, "link": "https://stackoverflow.com/questions/59061257/in-line-assembler-method-crashing-the-entire-program", "title": "In line assembler method crashing the entire program", "body": "<p>I\u00b4m having problems with assembly. Currently using VC++ 2015 x86 compiler and inline assembler to translate a method from C. The C method is running perfectly and as intended:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void calculateCRC(Info *data, int lonDiv, unsigned char divisor)\n{\n    unsigned char a = divisor;\n    unsigned char b = 0;\n\n    for (int i = 0; i &lt; data-&gt;dataLength; i++)\n    {\n        unsigned char c = 128;\n        while (a != 0)\n        {\n            if (data-&gt;content[i] &amp; c)\n            {\n                data-&gt;content[i] = data-&gt;content[i] ^ a;\n                data-&gt;content[i + 1] = data-&gt;content[i + 1] ^ b;\n            }\n            char carry = a &lt;&lt; 7;\n            b = b &gt;&gt; 1;\n            b = b | carry;\n            a = a &gt;&gt; 1;\n            c = c &gt;&gt; 1;\n        }\n        a = b;\n        b = 0;\n    }\n}\n</code></pre>\n\n<p>Some side notes:</p>\n\n<ul>\n<li><p>The Info struct only has an int declared dataLength and a pointer to a char array declared as *content.</p></li>\n<li><p>I know that the lonDiv parameter is not being used, yet I can't change the function declarations.</p></li>\n</ul>\n\n<p>With that in mind, I tried to translate as best as I could yet it does not function. The method ends up failing and the whole program crashes, not even returning an error code, it simply crashes. The code is as follows.</p>\n\n<pre><code>void calculateCRC(Info *data, int lonDiv, unsigned char divisor)\n{\n    __asm {\n        push ax // a and b\n        push dx // content[i] and content[i+1]\n        push cx // c and carry\n        push esi // Index var\n        push edi // Pointer to content\n        push ebx // Pointer to dataLength\n\n        mov ah, [ebp + 16] //a = divisor\n        mov al, 0 // b = 0\n        mov esi, 0 //int i = 0\n\n        forLoop: // for\n            mov ebx, [ebp + 8]\n            cmp esi, [ebx] // i &lt; data-&gt;dataLength\n\n            jz end\n            whileLoop:\n                mov ch, 128 // c = 128\n                cmp ah, 0 // while (a != 0)\n                je cutWhile\n            mov edi, [ebp + 8] // Info *data\n            add edi, 4 // data-&gt;content\n            mov dh, [edi + esi] // content[i]\n            mov dl, [edi + esi + 1] // content[i+1]\n            test dh, ch // if (content[i] &amp; c)\n            jz next\n                xor dh, ah // data-&gt;content[i] ^ a;\n                xor dl, al // data-&gt;content[i + 1] ^ b;\n                mov [edi + esi], dh // data-&gt;content[i] = data-&gt;content[i] ^ a;\n                mov [edi + esi + 1], dl // data-&gt;content[i + 1] = data-&gt;content[i + 1] ^ b;\n                next:\n                    mov cl, ah // char carry = a\n                    shl cl, 7 // carry = carry &lt;&lt; 7\n                    shr al, 1 // b = b &gt;&gt; 1\n                    or al, cl // b = b | carry\n                    shr ah, 1 // a = a &gt;&gt; 1\n                    shr ch, 1 // c = c &gt;&gt; 1\n                    jmp whileLoop\n            cutWhile:\n                shl ax, 8 // a = b and b = 0\n                inc esi //i++\n                jmp forLoop\n        end:\n            pop ebx\n            pop edi\n            pop esi\n            pop cx\n            pop dx\n            pop ax\n            ret\n    }\n}\n</code></pre>\n\n<p>I am no assembler expert, but I have tried to translate and comment out everything to no avail. Any help would be very appreciated!</p>\n"}, {"tags": ["c", "pointers", "linked-list", "nodes"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1574813383, "post_id": 59061186, "comment_id": 104361694, "body": "Let me suggest something before anything else. Don&#39;t intermix your linked list management functions with user-provided input operations. The two should be kept separate. A user wants to provide some data to perform some operation on the list, the acquisition of that data and the operation performed should be <i>separate</i>.  Get that data, <i>then</i> provide it to your linked list function to perform the desired operation. It de-clutters your linked list function code significantly, and dramatically increases the chance of isolating problems as you develop."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1574813684, "post_id": 59061186, "comment_id": 104361748, "body": "That said, this function modifies existing items only. The <i>caller</i> of this function, and what they do with the result, is going to be important. I will bet it is something like <code>head = modifyItem(head);</code> , which would be wrong, but that&#39;s just a wag (wild-arse-guess) because we don&#39;t have the required <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1574813793, "post_id": 59061186, "comment_id": 104361772, "body": "My crystal ball is cloudy tonight, but suggests that the list is initially filled without proper allocation of each node, or by assignment of the same pointer to each node. I keep shaking the ball, but without a  <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a> it remains cloudy."}], "answers": [{"tags": [], "owner": {"reputation": 2040, "user_id": 7449706, "user_type": "registered", "profile_image": "https://graph.facebook.com/1302265936460934/picture?type=large", "display_name": "Kevin Ng", "link": "https://stackoverflow.com/users/7449706/kevin-ng"}, "is_accepted": false, "score": 1, "last_activity_date": 1574840314, "last_edit_date": 1574840314, "creation_date": 1574821012, "answer_id": 59062075, "question_id": 59061186, "link": "https://stackoverflow.com/questions/59061186/modifying-data-in-a-linked-list-in-c/59062075#59062075", "title": "Modifying data in a Linked List in C?", "body": "<p>I tested your code everything worked as expected. Without seeing your code, I can't comment much. But I think, for your code, the only time everything would get delete is if you assign the return value incorrectly. So this below is probably something close to your code. For the test code below, unless you modify it, the IDs are 0, 1, and 2. Oh and the reason why I commented only work for 0 to 9 is because I don't want to make up the entire char string so I used i ^ 48. Of which, 0 - 9 ^ 48 would turn into the correspondent ASCII code of 0 - 9. If you go beyond that, you may get weird result for that two string that all.</p>\n\n<p>I just noticed that you use NULL in your search. Thus, I updated the code so the \"next\" of last index will be NULL otherwise if your code found nothing, it will run forever.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct ItemNode {\n  int ID;\n  int uPrice;\n  int onHand;\n  char name[30];\n  char desc[30];\n  struct ItemNode * next;\n} ItemNode ;\n\nstruct ItemNode * modify1Item(struct ItemNode * phead){  \n\n  int modID;\n  int lfound=0;\n  int lID;\n  char lDesc[30];\n  char lName[30];\n  double lUPrice;\n  int lOnHand;\n  struct ItemNode *i = phead;\n\n  printf(\"Enter the ID of the item that you want to modify\\n\");\n\n  scanf(\"%d\", &amp;modID);\n\n  while(i != NULL){\n\n    if(i-&gt;ID == modID){\n      break;\n    }\n\n    i = i-&gt;next;\n  }\n\n  if(i==NULL){\n\n    printf(\"An item with that ID wasn't found.\\n\"); \n    return 0;\n\n  } else { \n\n    printf(\"Enter new Name\\n\");\n\n    scanf(\"%s\", lName);\n\n    strcpy(i-&gt;name, lName); \n\n    printf(\"Enter new Description\\n\");\n\n    scanf(\"%s\", lDesc);\n\n    strcpy(i-&gt;desc, lDesc); \n\n    printf(\"Enter new Unit Price $\\n\");\n\n    scanf(\"%lf\", &amp;lUPrice);\n\n    i-&gt;uPrice = lUPrice;\n\n    printf(\"Enter new Number of Items On Hand\\n\");\n\n    scanf(\"%d\", &amp;lOnHand);\n\n    i-&gt;onHand = lOnHand;\n\n  }\n\n  phead=i;\n\n  return phead;\n}\n\nint main(){\n  // only work for 0  - 9.\n  int index = 3;\n  ItemNode iArr[index];\n\n  for ( int i = 0; i &lt; index; i++ ){\n    iArr[i].ID = i;\n    iArr[i].uPrice = i + i;\n    iArr[i].onHand = i * i;\n    iArr[i].name[0] = i ^ 48;\n    iArr[i].desc[0] = i ^ 48;\n\n    // If last index link back to first index.\n    // Updated: but for you usage case \n    // because of your search function\n    // last index should be NULL otherwise your \n    // search will run forever\n    if ( i &lt; index - 1 ) iArr[i].next = &amp;iArr[i + 1];\n    else iArr[i].next = NULL; // if change search method with unique ID then you can use -&gt; &amp;iArr[0];\n  }\n\n  // Mod 0\n  ItemNode * test = modify1Item(iArr);\n  printf(\"0 name: %s\\n\\n\",iArr[0].name );\n\n  // Mod 1\n  ItemNode * test1 = modify1Item(iArr);\n  printf(\"1 name: %s\\n\\n\",iArr[1].name );\n\n  // Mod 2\n  ItemNode * test2 = modify1Item(iArr);\n  printf(\"2 name: %s\\n\\n\",iArr[2].name );\n\n  // Check if 0 is still there.\n  printf(\"0 name: %s\\n\\n\",iArr[0].name );\n\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8760774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9e2aa8087ab3aa13ac05538ef4e096?s=128&d=identicon&r=PG&f=1", "display_name": "ABC", "link": "https://stackoverflow.com/users/8760774/abc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574840314, "creation_date": 1574813248, "last_edit_date": 1574827104, "question_id": 59061186, "link": "https://stackoverflow.com/questions/59061186/modifying-data-in-a-linked-list-in-c", "title": "Modifying data in a Linked List in C?", "body": "<p>When I modify the linked list (based on the ID), it modifies the node successfully but deletes the rest of the list. The whole list stays only if I modify the most recent node that I've added to the list. </p>\n\n<p>I know that the problem is at the end where it says:</p>\n\n<pre><code>     phead=i;\n\n     return phead;\n</code></pre>\n\n<p>But I don't know how to fix it as I haven't found anything to help me, even though I'm sure it is simple to know why it is wrong.</p>\n\n<pre><code>struct ItemNode *modify1Item(struct ItemNode *phead){  \n\nint modID;\nint lfound=0;\nint lID;\nchar lDesc[30];\nchar lName[30];\ndouble lUPrice;\nint lOnHand;\nstruct ItemNode *i=phead;\n\nprintf(\"Enter the ID of the item that you want to modify\\n\");\n\nscanf(\"%d\", &amp;modID);\n\nwhile(i != NULL){\n\n    if(i-&gt;ID == modID){\n        break;\n    }\n\n    i= i-&gt;next;\n}\n\n\nif(i==NULL){\n\n    printf(\"An item with that ID wasn't found.\\n\"); \n    return 0;\n\n }\n\nelse{ \n\n\n    printf(\"Enter new Name\\n\");\n\n    scanf(\"%s\", lName);\n\n    strcpy(i-&gt;name, lName); \n\n    printf(\"Enter new Description\\n\");\n\n    scanf(\"%s\", lDesc);\n\n    strcpy(i-&gt;desc, lDesc); \n\n    printf(\"Enter new Unit Price $\\n\");\n\n    scanf(\"%lf\", &amp;lUPrice);\n\n    i-&gt;uPrice = lUPrice;\n\n    printf(\"Enter new Number of Items On Hand\\n\");\n\n    scanf(\"%d\", &amp;lOnHand);\n\n    i-&gt;onHand = lOnHand;\n\n   }\n\nphead=i;\n\nreturn phead;\n\n}\n</code></pre>\n\n<p>When I return it, i say head=modify1Item(phead);</p>\n"}, {"tags": ["c", "arrays", "linux", "for-loop", "pointers"], "answers": [{"tags": [], "owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "is_accepted": false, "score": 2, "last_activity_date": 1574810913, "creation_date": 1574810913, "answer_id": 59060897, "question_id": 59060813, "link": "https://stackoverflow.com/questions/59060813/array-in-for-cycle-not-getting-proper-values/59060897#59060897", "title": "Array in for cycle not getting proper values", "body": "<pre><code>for (int i = 2; i &lt; nItems + 2; i+=2) {\n    items[i].value = values[i];\n    items[i].weight = values[i+1];\n}\n</code></pre>\n\n<p>The loop initializes <code>item[2]</code> through <code>item[5]</code>. It should initialize <code>item[0]</code> through <code>item[3]</code>.</p>\n\n<pre><code>for (int i = 0; i &lt; 4; i++){\n    printf(\"%d - %d\\n\", items[i].value, items[i+1].weight);\n}\n</code></pre>\n\n<p>Why <code>i</code> and <code>i+1</code>? Those indices should be the same so the value and weight are from the same item.</p>\n"}, {"comments": [{"owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 1, "creation_date": 1574812182, "post_id": 59061012, "comment_id": 104361382, "body": "See if you can calculate <code>j</code> based on <code>i</code>. Then you don&#39;t need <code>j</code>."}], "tags": [], "owner": {"reputation": 338, "user_id": 6535588, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/QyeBM.png?s=128&g=1", "display_name": "walkman", "link": "https://stackoverflow.com/users/6535588/walkman"}, "is_accepted": true, "score": 0, "last_activity_date": 1574811888, "creation_date": 1574811888, "answer_id": 59061012, "question_id": 59060813, "link": "https://stackoverflow.com/questions/59060813/array-in-for-cycle-not-getting-proper-values/59061012#59061012", "title": "Array in for cycle not getting proper values", "body": "<pre><code>void item_InitUsableItems(int *values, int nItems, Item *items) {\nint j = 2;\nfor (int i = 0; i &lt; nItems; i++) {\n    items[i].value = values[j];\n    j++;\n    items[i].weight = values[j];\n    j++;\n}\n</code></pre>\n\n<p>}</p>\n\n<p>This solved my problem. Probably not the prettiest solution but it works!</p>\n"}], "owner": {"reputation": 338, "user_id": 6535588, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/QyeBM.png?s=128&g=1", "display_name": "walkman", "link": "https://stackoverflow.com/users/6535588/walkman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 59061012, "answer_count": 2, "score": 2, "last_activity_date": 1574812054, "creation_date": 1574810353, "last_edit_date": 1574812054, "question_id": 59060813, "link": "https://stackoverflow.com/questions/59060813/array-in-for-cycle-not-getting-proper-values", "title": "Array in for cycle not getting proper values", "body": "<p>My problem:</p>\n\n<p>I have a struct of an item and a bag;</p>\n\n<pre><code>struct Item {\n    int value;\n    int weight;\n};\n\nstruct Bag {\n    int maxWeight;\n    Item *items;\n    int maxItems;\n    int itemsHolding;\n};\n</code></pre>\n\n<p>In my main I've got this array: </p>\n\n<pre><code> int testValues[] = { 4, 11, 6, 2, 10, 4, 12, 6, 13, 7, 23 };\n</code></pre>\n\n<ul>\n<li>index 0: total number of items</li>\n<li>index 1: total weight of the bag</li>\n<li>last index: ignore it for this problem</li>\n<li>all other indexes are a \"pair\"</li>\n</ul>\n\n<p>For example:</p>\n\n<ul>\n<li>6 will represent the first item value</li>\n<li>2 will represent the first item weight</li>\n<li>and so on</li>\n</ul>\n\n<p>Then I have this array of Items</p>\n\n<pre><code>Item items[testValues[0]];\n</code></pre>\n\n<p>And this function that should organize all values into the correspondent item:</p>\n\n<pre><code>void item_InitUsableItems(int *values, int nItems, Item *items) {\n    for (int i = 2; i &lt; nItems + 2; i+=2) {\n        items[i-2].value = values[i];\n        items[i-2].weight = values[i+1];\n    }\n}\n</code></pre>\n\n<p>Call to function:</p>\n\n<pre><code>item_InitUsableItems(testValues, testValues[0], items);\n</code></pre>\n\n<p>I'm then printing all items to the console just for testing purposes:</p>\n\n<pre><code>for (int i = 0; i &lt; 4; i++){\n    printf(\"%d - %d\\n\", items[i].value, items[i].weight);\n}\n</code></pre>\n\n<p>This is giving me results like:</p>\n\n<pre><code>6 - 2\n-1231927808 - -1282274509\n10 - 4\n1666274963 - 22033\n</code></pre>\n\n<p>Expected result would be this:</p>\n\n<pre><code>6 - 2\n10 - 4\n12 - 6\n13 - 7\n</code></pre>\n\n<p>I'm new to C, about a week into learning it! If you spot anything else that's incorrect please let me know!</p>\n"}, {"tags": ["c", "math", "embedded", "nxp-microcontroller"], "comments": [{"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 1, "creation_date": 1574811861, "post_id": 59060759, "comment_id": 104361304, "body": "You are using integer math, For any value of distance_remaining less than 180, <code>distance_remaining&#47;180</code> will be zero."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1574812508, "post_id": 59060759, "comment_id": 104361470, "body": "I think Fredk is right. To find out, try <code>(dist_remaining*100)&#47;180</code> and report the result."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 4, "creation_date": 1574813417, "post_id": 59060759, "comment_id": 104361700, "body": "Your format string doesn&#39;t include a format specifier.  Try <code>printf(&quot;\\r\\nPercent remaining: %f&quot;, dist_percent);</code> or something along those lines."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1574859577, "post_id": 59060759, "comment_id": 104379507, "body": "Voting to close this as simple typo."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 12441552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/895d379d889d2d051f4b7422f4583f9c?s=128&d=identicon&r=PG&f=1", "display_name": "Jakob.1992", "link": "https://stackoverflow.com/users/12441552/jakob-1992"}, "is_accepted": true, "score": 2, "last_activity_date": 1574814081, "creation_date": 1574814081, "answer_id": 59061312, "question_id": 59060759, "link": "https://stackoverflow.com/questions/59060759/calculating-percentage-remaining-in-c-program/59061312#59061312", "title": "Calculating Percentage Remaining in C Program", "body": "<p>Thanks to Dmitri, changing the following <code>printf</code> line worked:</p>\n\n<pre><code>printf(\"\\n\\rPercent remaining: %f\\n\", dist_percent);\n</code></pre>\n\n<p>Thanks to FredK and Yunnosch as well. Appreciate your guy's help.</p>\n"}], "owner": {"reputation": 31, "user_id": 12441552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/895d379d889d2d051f4b7422f4583f9c?s=128&d=identicon&r=PG&f=1", "display_name": "Jakob.1992", "link": "https://stackoverflow.com/users/12441552/jakob-1992"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "closed_date": 1574872135, "accepted_answer_id": 59061312, "answer_count": 1, "score": 1, "last_activity_date": 1574814081, "creation_date": 1574810032, "last_edit_date": 1574813440, "question_id": 59060759, "link": "https://stackoverflow.com/questions/59060759/calculating-percentage-remaining-in-c-program", "closed_reason": "Not suitable for this site", "title": "Calculating Percentage Remaining in C Program", "body": "<p>I am developing code for an NXP MCU board. I have to use the C programming language.</p>\n\n<p><strong>My Goal:</strong>\nTo measure distance using an ultrasonic sensor. Pre-defined distance = 180cm. The output should be the distance remaining in percentage. For example: if the distance measured by the sensor is 100cm, then the output after calculation should be: 44.44% If the distance measured is 180+, then the output after calculation should be a negative percentage.</p>\n\n<p><strong>Problem:</strong> I developed the following code. Before doing math (number manipulation) in the code, the sensor gave output in <em>cm</em> as intended, which was observed on TeraTerm. But when I added few math-related lines to the code, the output is now blank. The sensor is working fine but after adding formulas to the code, I am not getting the calculated output. Following is my code:</p>\n\n<pre><code>#include \"mbed.h\"\n#include \"hcsr04.h\"\n\nHCSR04  usensor1(A4,A5);\nunsigned int distance;\nfloat dist_remaining;\nfloat dist_percent;\n\nint main()\n{\n    int a = 180;\n    while(1)\n    {\n        usensor1.start();\n        wait_ms(500); \n        distance = usensor1.get_dist_cm();\n        dist_remaining = a-distance;\n        dist_percent = (dist_remaining/180)*100;\n        printf(\"\\n\\rPercent remaining: \", dist_percent );\n    }\n}\n</code></pre>\n\n<p><strong>Output:</strong> <a href=\"https://i.stack.imgur.com/Vcxic.png\" rel=\"nofollow noreferrer\">Output Screenshot</a></p>\n\n<p>Can you please check and let me know if there is anything wrong with calculating the <code>int distance</code> obtained from the sensor here? I am not very familiar with the C programming language. Hence, I will appreciate any help that you will provide. Thank you for your time and assistance.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1519, "user_id": 5447136, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/bpy5K.jpg?s=128&g=1", "display_name": "bool3max", "link": "https://stackoverflow.com/users/5447136/bool3max"}, "edited": false, "score": 0, "creation_date": 1574810213, "post_id": 59060672, "comment_id": 104360866, "body": "For starters, you&#39;re using <code>boat_contenders</code> inside your nested for loop but I believe you should instead be using <code>results_array[races].num_boats_competing</code> instead. <code>boat_contenders</code> stores the return value of the <code>fscanf</code> function which returns an integer indicating how many values were successfully read from the file, which is in your example always going to be either <code>1</code> or <code>0</code>."}, {"owner": {"reputation": 61, "user_id": 11403739, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6Oi6SuHh8mA/AAAAAAAAAAI/AAAAAAAAGAo/WgW5Jg4nagM/photo.jpg?sz=128", "display_name": "JoelinRome", "link": "https://stackoverflow.com/users/11403739/joelinrome"}, "reply_to_user": {"reputation": 1519, "user_id": 5447136, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/bpy5K.jpg?s=128&g=1", "display_name": "bool3max", "link": "https://stackoverflow.com/users/5447136/bool3max"}, "edited": false, "score": 0, "creation_date": 1574810867, "post_id": 59060672, "comment_id": 104361047, "body": "Great thanks for spotting that error!"}, {"owner": {"reputation": 1519, "user_id": 5447136, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/bpy5K.jpg?s=128&g=1", "display_name": "bool3max", "link": "https://stackoverflow.com/users/5447136/bool3max"}, "edited": false, "score": 0, "creation_date": 1574811499, "post_id": 59060672, "comment_id": 104361219, "body": "Regarding your edit: where is <code>race_root</code> declared?"}, {"owner": {"reputation": 61, "user_id": 11403739, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6Oi6SuHh8mA/AAAAAAAAAAI/AAAAAAAAGAo/WgW5Jg4nagM/photo.jpg?sz=128", "display_name": "JoelinRome", "link": "https://stackoverflow.com/users/11403739/joelinrome"}, "reply_to_user": {"reputation": 1519, "user_id": 5447136, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/bpy5K.jpg?s=128&g=1", "display_name": "bool3max", "link": "https://stackoverflow.com/users/5447136/bool3max"}, "edited": false, "score": 0, "creation_date": 1574811599, "post_id": 59060672, "comment_id": 104361241, "body": "Sorry the <code>race_root</code> is declared in main.c"}], "answers": [{"tags": [], "owner": {"reputation": 64, "user_id": 12435862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37505484ab215524e8e3a958988681e?s=128&d=identicon&r=PG", "display_name": "user12435862", "link": "https://stackoverflow.com/users/12435862/user12435862"}, "is_accepted": true, "score": 4, "last_activity_date": 1574810562, "creation_date": 1574810562, "answer_id": 59060838, "question_id": 59060672, "link": "https://stackoverflow.com/questions/59060672/how-do-i-define-an-array-of-nested-structs-in-c/59060838#59060838", "title": "How do I define an array of nested structs in C?", "body": "<p>The main issue (the one you are referring to in the question) is here:</p>\n\n<pre><code>boat_contenders = fscanf(file, \"%d\", &amp;results_array[races].num_boats_competing);\n</code></pre>\n\n<p>The return value of <code>fscanf</code> is not the value that is read in, but instead the number of values that were successfully read. In this case because your format string specifies only one parameter, assuming a successful read occurs, this value will always be 1. You later use this as the bound for your for loop, which means that it will only run once.</p>\n\n<p>As the bound for your loop you should instead use <code>results_array[races].num_boats_competing</code></p>\n\n<p>This line here is also problematic:</p>\n\n<pre><code>struct boat_data boat_data[];\n</code></pre>\n\n<p>Firstly, don't give the variable the same name as the type, even if it compiles it is a bad idea. You also need to specify the size of this array. Think of some sensible upper bound for the number of boats that can be competing in the race. As you also store the actual value of boats competing, it doesn't really matter if this value is larger than the actual number of boats you read in.</p>\n"}], "owner": {"reputation": 61, "user_id": 11403739, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6Oi6SuHh8mA/AAAAAAAAAAI/AAAAAAAAGAo/WgW5Jg4nagM/photo.jpg?sz=128", "display_name": "JoelinRome", "link": "https://stackoverflow.com/users/11403739/joelinrome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 59060838, "answer_count": 1, "score": 2, "last_activity_date": 1574811119, "creation_date": 1574809425, "last_edit_date": 1574811119, "question_id": 59060672, "link": "https://stackoverflow.com/questions/59060672/how-do-i-define-an-array-of-nested-structs-in-c", "title": "How do I define an array of nested structs in C?", "body": "<p>So I currently have 2 structs as seen below where the race_results contains an array of boats participating in the competition. Each race can have one or many boats associated with it.</p>\n\n<pre><code>struct boat_data {\n    int ID;\n    int time_to_complete_hours;\n    int time_to_complete_mins;\n    int time_to_complete_secs;\n} boat_node;\n\ntypedef struct race_result {\n    char race_date[80];\n    int start_time_hours;\n    int start_time_mins;\n    int start_time_secs;\n    int num_boats_competing;\n    struct boat_data boat_data[];\n} race_node;\n</code></pre>\n\n<p>The issue is that when I later define how many boats there will be in the race (as at this point I'm not sure of how many boats will be in each race) it will not work as it only seems to take one boat and then after that point it exits the nested for loop. <strong>results_array is an array of race_result</strong></p>\n\n<pre><code>fscanf(file, \"%d\", &amp;total_races);\n        for (int races = 0; races &lt; total_races; races++) {\n            fscanf(file, \" %[^\\n]\", results_array[races].race_date);\n            fscanf(file, \" %d\", &amp;results_array[races].start_time_hours);\n            fscanf(file, \" %d\", &amp;results_array[races].start_time_mins);\n            fscanf(file, \" %d\", &amp;results_array[races].start_time_secs);\n            boat_contenders = fscanf(file, \"%d\", &amp;results_array[races].num_boats_competing);\n            for (int num_boats = 0; num_boats &lt; boat_contenders; num_boats++) {\n                scan_status = fscanf(file, \"%d\\n%d %d %d\\n\", &amp;results_array[races].boat_data[num_boats].ID,\n                                     &amp;results_array[races].boat_data[num_boats].time_to_complete_hours,\n                                     &amp;results_array[races].boat_data[num_boats].time_to_complete_mins,\n                                     &amp;results_array[races].boat_data[num_boats].time_to_complete_secs);\n            }\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>Created an upper bound for the number of boats [10] and also change my nested for loop to use <code>for (int num_boats = 0; num_boats &lt; results_array[races].num_boats_competing; num_boats++)</code></p>\n\n<p>I'm now getting an issue that says that the <code>results_array</code> hasn't been initialized ERROR: <code>-var-create: unable to create variable object</code></p>\n\n<p>It is initialized using <code>struct race_result race_root[total_races];</code> where <code>total_races = 6</code></p>\n"}, {"tags": ["c", "string", "assembly", "mips"], "comments": [{"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 3, "creation_date": 1574808625, "post_id": 59060494, "comment_id": 104360395, "body": "Post the code, not an image.   Are there not enough FAQs?"}, {"owner": {"reputation": 142, "user_id": 10170110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a205889a5cdd3d7d13252a3bc42b67dc?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Lee", "link": "https://stackoverflow.com/users/10170110/peter-lee"}, "edited": false, "score": 0, "creation_date": 1574808795, "post_id": 59060494, "comment_id": 104360439, "body": "I think you are asking about MIPS asm .. not about C.. isn&#39;t it?? change tag.. so, others can know it.."}, {"owner": {"reputation": 142, "user_id": 10170110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a205889a5cdd3d7d13252a3bc42b67dc?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Lee", "link": "https://stackoverflow.com/users/10170110/peter-lee"}, "edited": false, "score": 0, "creation_date": 1574808909, "post_id": 59060494, "comment_id": 104360469, "body": "for C, You can use input function in C standard libray... for ASM, you should link others input library and call it.."}, {"owner": {"reputation": 59, "user_id": 12370983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ceb14501751b6791b24688998225e95?s=128&d=identicon&r=PG&f=1", "display_name": "fastmen111", "link": "https://stackoverflow.com/users/12370983/fastmen111"}, "edited": false, "score": 0, "creation_date": 1574809144, "post_id": 59060494, "comment_id": 104360552, "body": "alright my bad, here is a C code <a href=\"https://notepad.pw/02sb5cg3\" rel=\"nofollow noreferrer\">notepad.pw/02sb5cg3</a>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 142, "user_id": 10170110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a205889a5cdd3d7d13252a3bc42b67dc?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Lee", "link": "https://stackoverflow.com/users/10170110/peter-lee"}, "edited": false, "score": 1, "creation_date": 1574811015, "post_id": 59060494, "comment_id": 104361098, "body": "@PeterLee: Most SO questions about MIPS are using MARS or SPIM which simulate a system with toy system calls that can do integer and string input and output with the <code>syscall</code> instruction; no library needed.  The OP&#39;s MIPS code is already using <code>syscall</code>."}], "answers": [{"comments": [{"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 1, "creation_date": 1574812561, "post_id": 59061052, "comment_id": 104361484, "body": "Not a timing bug but a design artifact called a branch <a href=\"https://en.wikipedia.org/wiki/Delay_slot\" rel=\"nofollow noreferrer\">delay slot</a>."}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 1, "creation_date": 1574812869, "post_id": 59061052, "comment_id": 104361581, "body": "To someone like the OP who appears to be fairly new to low-level programming, it may well not be recognizable as humor ..."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "reply_to_user": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 0, "creation_date": 1574817731, "post_id": 59061052, "comment_id": 104362678, "body": "He should also know that these design flaws should continue to be considered anachronisms."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1574840782, "post_id": 59061052, "comment_id": 104369129, "body": "Jokes have to be funny.  Branch-delay slots have a real purpose: fully hide branch latency without needing branch prediction.  <a href=\"//stackoverflow.com/q/58422262\">Why does MIPS use one delay slot instead of two?</a>.  Anyway, most MIPS code on SO is written for MARS/SPIM with their default setting of simulating a MIPS without a branch-delay slot.  (If you don&#39;t look at disassembly / machine code, you can pretend it&#39;s like an old-school MIPS assembler that reorders your code to fill delay slots, or fills with <code>nop</code> if it can&#39;t find anything.)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1574841039, "post_id": 59061052, "comment_id": 104369262, "body": "Of course exposing this classic-MIPS pipeline / microarchitecture detail in the ISA was a burden for later superscalar MIPS implementations that had to preserve the behaviour.  That still doesn&#39;t make it a &quot;timing bug&quot;, it makes it arguably a premature optimization of the ISA for the first-gen microarchitecture.  Also why MIPS only has simple branch conditions: single reg <code>bltz</code> for example (just the sign bit), or for 2 regs only <code>beq</code> and <code>bne</code>, not <code>bgt</code> or <code>blt</code> between 2 regs, <a href=\"https://stackoverflow.com/questions/56586551\">so it only takes 1/2 a cycle</a>"}], "tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": false, "score": 0, "last_activity_date": 1574812196, "creation_date": 1574812196, "answer_id": 59061052, "question_id": 59060494, "link": "https://stackoverflow.com/questions/59060494/mips-program-that-implements-the-same-algorithm-in-c/59061052#59061052", "title": "MIPS program that implements the same algorithm in C", "body": "<p>(thanks for posting it). You appear to be using this definition of system calls (<a href=\"https://www.assemblylanguagetuts.com/mips-syscall-services-table/\" rel=\"nofollow noreferrer\">https://www.assemblylanguagetuts.com/mips-syscall-services-table/</a>)</p>\n\n<p>Just after the beq instruction in the while: loop, you increment $s1.   I recall that MIPS cpus had a timing bug where it always executed the instruction following a branch.  Here, that would mean that $s1 would be one more than you thought it would.   The same applies to <em>j while</em>, but that is innocuous since it will be re-executed on loop exit.</p>\n\n<p>The <em>j outsidewhile</em> seems a bit more sinister to me, because the opcode in the delay slot is a branch itself.   Not sure how this resolves, but I wouldn't tempt the gods here.</p>\n\n<p>You need to add the code to print the strings, address and character, and probably an exit.\nBeyond that, it looks ok; but you will have some debugging to do.</p>\n"}, {"tags": [], "owner": {"reputation": 11225, "user_id": 471129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec5a6cce700294c7c564becb11fa3c1?s=128&d=identicon&r=PG", "display_name": "Erik Eidt", "link": "https://stackoverflow.com/users/471129/erik-eidt"}, "is_accepted": false, "score": 0, "last_activity_date": 1574818958, "last_edit_date": 1574818958, "creation_date": 1574817831, "answer_id": 59061726, "question_id": 59060494, "link": "https://stackoverflow.com/questions/59060494/mips-program-that-implements-the-same-algorithm-in-c/59061726#59061726", "title": "MIPS program that implements the same algorithm in C", "body": "<p>On line 19 of your provided code, you are using <code>addi</code> with 3 register operands.&nbsp; <code>addi</code> requires two register operands and an immediate, so this won't compile/assemble with MARS (I didn't try SPIM).</p>\n\n<p>Your loop fails to (re)load the next byte, so move <code>while:</code> back two instructions:&nbsp; Since you're incrementing <code>$s1</code>, you need to reperform the both <code>add $t9 $s0 $s1</code> and the <code>lb $t8 ($t9)</code> &#8212; otherwise, <code>$t9</code> doesn't change addresses and <code>$t8</code> doesn't change byte values either.</p>\n"}], "owner": {"reputation": 59, "user_id": 12370983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ceb14501751b6791b24688998225e95?s=128&d=identicon&r=PG&f=1", "display_name": "fastmen111", "link": "https://stackoverflow.com/users/12370983/fastmen111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 2, "score": -5, "last_activity_date": 1574818958, "creation_date": 1574808357, "last_edit_date": 1574809302, "question_id": 59060494, "link": "https://stackoverflow.com/questions/59060494/mips-program-that-implements-the-same-algorithm-in-c", "title": "MIPS program that implements the same algorithm in C", "body": "<p>Write a complete MIPS program that implements the same algorithm shown below (in C). To verify the output of the MIPS program, copy this C code and execute it.</p>\n\n<p>So I need to convert this C code to MIP code</p>\n\n<p>This is the C code, </p>\n\n<pre><code>int main()\n{\n  char string[256];\n  int i=0;\n  char *result = NULL;  // NULL pointer is binary zero\n\n  // Obtain string from user, e.g. \"Constantinople\"\n  scanf(\"%255s\", string); \n\n  // Search string for letter 'e'.\n  // Result is pointer to first e (if it exists)\n  // or NULL pointer if it does not exist\n  while(string[i] != '\\0') {\n    if(string[i] == 'e') {\n      result = &amp;string[i]; \n      break; // exit from while loop early\n    }\n    i++;\n  }\n\n  if(result != NULL) {\n    printf(\"First match at address %d\\n\", result);\n    printf(\"The matching character is %c\\n\", *result);\n  }\n  else\n    printf(\"No match found\\n\");\n}\n\n</code></pre>\n\n<p>And this is my Mips code, I am not sure how to get the input, compare and print the result</p>\n\n<pre><code>\n.globl main \n.text   \nmain:\n    #$s0 : base address string\n    #$s1 : i\n    #$s2 : *result\n\n    la $s0, string\n    addi $s1, $zero, 0 \n    addi $s2, $zero, 0 #*result = null  \n\n\n    #get input from user\n    li $v0 ,8 # take input\n    la $a0, string # load byte space into address\n    li $a1, 256 #allot the byte space for string\n    move $t0, $a0\n    syscall\n    addi $t9, $s0, $s1 # &amp;string[i]\n    lb $t8,0($t9) #t8 = string [i]\nwhile: beq $t8 , 0, outsidewhile # if string[i] == '\\0'\n    beq $t8, 101, body # if string i == 'e'\n    add $s1, $s1,1 #i++\n    j while\nbody: \n    add $t2, $t9, $zero #result = &amp;string[i];   \n    j outsidewhile\n\noutsidewhile :\n    beq $s2, 0, printaddress # if(result != NULL)\n    # printf(\"No match found\\n\");\n        li $v0,4\n        la $a0, msg2        \n        li $v0,4\n        la $a0, newline \nprintaddress:\n    #printf(\"First match at address %d\\n\", result);\n    #printf(\"The matching character is %c\\n\", *result);\n    li $v0,4\n    la $a0, msg     \n\nli $v0, 10 \nsyscall\n\n.data\nstring: .space 256\nmsg: .asciiz \"First match at address \"\nmsg1: .asciiz \"The matching character is \"\nmsg2: .asciiz \"No match found\"\nendstring: .asciiz \"\\0\"\nnewline: .asciiz \"\\n\"\n</code></pre>\n"}]