[{"tags": ["c", "winapi", "gdi"], "answers": [{"tags": [], "owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "is_accepted": true, "score": 1, "last_activity_date": 1435190500, "creation_date": 1435190500, "answer_id": 31039137, "question_id": 31039083, "link": "https://stackoverflow.com/questions/31039083/can-i-use-hbitmap-in-another-thread/31039137#31039137", "title": "Can I use HBITMAP in another thread?", "body": "<p>Yes you can, but remember a bitmap can only be selected into one DC at once. If you have two threads both drawing the same bitmap you'll need to coordinate access to it.</p>\n"}], "owner": {"reputation": 1254, "user_id": 4566312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f792d4cf0473ff830ff5a857ec41bf83?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/4566312/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 31039137, "answer_count": 1, "score": 0, "last_activity_date": 1435190500, "creation_date": 1435190102, "question_id": 31039083, "link": "https://stackoverflow.com/questions/31039083/can-i-use-hbitmap-in-another-thread", "title": "Can I use HBITMAP in another thread?", "body": "<p>If for example I used <code>LoadImage()</code> to load a bitmap from file in Thread A, can I use the returned <code>HBITMAP</code> in Thread B?</p>\n"}, {"tags": ["c", "windows", "linux", "porting"], "comments": [{"owner": {"reputation": 5866, "user_id": 377657, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/46520d686bf3a8d42e2e43cc5d0f44e1?s=128&d=identicon&r=PG", "display_name": "rwong", "link": "https://stackoverflow.com/users/377657/rwong"}, "edited": false, "score": 1, "creation_date": 1435190186, "post_id": 31055857, "comment_id": 50132990, "body": "See: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa383751(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Windows headers - Windows Data Types</a>. <a href=\"https://en.wikipedia.org/wiki/Wide_character\" rel=\"nofollow noreferrer\">wchar_t</a> is compiler-specific, and on Win32 (which Visual C++ compiles to), it is assumed to be 16-bit."}, {"owner": {"reputation": 5866, "user_id": 377657, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/46520d686bf3a8d42e2e43cc5d0f44e1?s=128&d=identicon&r=PG", "display_name": "rwong", "link": "https://stackoverflow.com/users/377657/rwong"}, "edited": false, "score": 0, "creation_date": 1435190262, "post_id": 31055857, "comment_id": 50132991, "body": "The UTF8 and UTF16 is going to complicate your porting effort, because the two operating systems have different conventions. Good luck."}, {"owner": {"reputation": 3210, "user_id": 156671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2e236942ba8d664b677cbde3ee69986c?s=128&d=identicon&r=PG", "display_name": "GrandmasterB", "link": "https://stackoverflow.com/users/156671/grandmasterb"}, "edited": false, "score": 0, "creation_date": 1435201310, "post_id": 31055857, "comment_id": 50132992, "body": "Since that code is from the ReactOS source, I would start looking there or at WINE&#39;s source for the headers."}, {"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 0, "creation_date": 1435746717, "post_id": 31055857, "comment_id": 50326236, "body": "see header in <a href=\"http://svn.reactos.org/svn/reactos/trunk/reactos/include/psdk/windef.h?view=markup\" rel=\"nofollow noreferrer\">svn.reactos.org/svn/reactos/trunk/reactos/include/psdk/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "is_accepted": false, "score": 0, "last_activity_date": 1435257268, "creation_date": 1435257268, "answer_id": 31058154, "question_id": 31055857, "link": "https://stackoverflow.com/questions/31055857/linux-header-files-for-win32-typedefs-like-bool-long-and-wchar/31058154#31058154", "title": "Linux header files for Win32 typedefs like BOOL, LONG, and WCHAR", "body": "<p>You might try compiling it with libwine as a step towards dropping the dependency entirely.</p>\n\n<p>On Debian-based systems,</p>\n\n<pre><code>apt-get install libwine-dev\n</code></pre>\n"}], "migrated_from": {"other_site": {"aliases": ["http://programmer.stackexchange.com", "http://programmers.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1292524346, "open_beta_date": 1283972400, "closed_beta_date": 1283367600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/apple-touch-icon@2.png", "twitter_account": "StackSoftEng", "favicon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/apple-touch-icon.png", "audience": "professionals, academics, and students working within the systems development life cycle", "site_url": "https://softwareengineering.stackexchange.com", "api_site_parameter": "softwareengineering", "logo_url": "https://cdn.sstatic.net/Sites/softwareengineering/Img/logo.png", "name": "Software Engineering", "site_type": "main_site"}, "on_date": 1435249776, "question_id": 287779}, "owner": {"reputation": 12673, "user_id": 95195, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/735a05084346db68dff750870654da3d?s=128&d=identicon&r=PG", "display_name": "Justin Dearing", "link": "https://stackoverflow.com/users/95195/justin-dearing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1435257268, "creation_date": 1435189382, "question_id": 31055857, "link": "https://stackoverflow.com/questions/31055857/linux-header-files-for-win32-typedefs-like-bool-long-and-wchar", "title": "Linux header files for Win32 typedefs like BOOL, LONG, and WCHAR", "body": "<p>I'd like to compile <a href=\"http://svn.reactos.org/svn/reactos/trunk/reactos/base/applications/cmdutils/xcopy/\" rel=\"nofollow\">this clone of xcopy</a> as a linux binary. I commented out all the win32 include files, and now it complains about things like WCHAR, and LONG. These are simple typedefs. Is there a header for linux that deals with these things? I know as soon as I solve this issue I'll discover that the win32 headers actually get used for things. Then I'll have to actually get down to the hard work of porting things. For now I'd like to get past this hurdle.</p>\n"}, {"tags": ["c", "linux", "parent-child"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 1550539, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/F1PiE.jpg?s=128&g=1", "display_name": "Nawar Youssef", "link": "https://stackoverflow.com/users/1550539/nawar-youssef"}, "edited": false, "score": 0, "creation_date": 1435188568, "post_id": 31038779, "comment_id": 50101479, "body": "I tired using sizeof() but it gave me only the first message, so the output was: In log: msg from A: A sent to B: C 0  and then the program terminated"}, {"owner": {"reputation": 83, "user_id": 1550539, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/F1PiE.jpg?s=128&g=1", "display_name": "Nawar Youssef", "link": "https://stackoverflow.com/users/1550539/nawar-youssef"}, "edited": false, "score": 0, "creation_date": 1435211156, "post_id": 31038779, "comment_id": 50107126, "body": "Now I understand the problem and how it happens, but still confused about the solution. This is my first time working on something serious in C. I also played a little bit with the code and I am still stock with getting one char at a time, or only first line displayed. Any suggestion?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 83, "user_id": 1550539, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/F1PiE.jpg?s=128&g=1", "display_name": "Nawar Youssef", "link": "https://stackoverflow.com/users/1550539/nawar-youssef"}, "edited": false, "score": 0, "creation_date": 1435211562, "post_id": 31038779, "comment_id": 50107266, "body": "What&#39;s the problem?  In my code, you know how much data was read by <code>read()</code>, and you know that each string is terminated with a null byte, so you can step through the byte array, printing out strings until you&#39;ve reached the end of the data read off the pipe; then you go back for more."}, {"owner": {"reputation": 83, "user_id": 1550539, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/F1PiE.jpg?s=128&g=1", "display_name": "Nawar Youssef", "link": "https://stackoverflow.com/users/1550539/nawar-youssef"}, "edited": false, "score": 0, "creation_date": 1435296713, "post_id": 31038779, "comment_id": 50150971, "body": "Ok, I got it. Last night I was so sleepy so my brain couldn&#39;t function well. Thanks for the help."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 6, "last_activity_date": 1435189604, "last_edit_date": 1592644375, "creation_date": 1435188190, "answer_id": 31038779, "question_id": 31038710, "link": "https://stackoverflow.com/questions/31038710/why-messages-from-a-pipe-are-being-displayed-as-a-char-at-at-time-in-c-language/31038779#31038779", "title": "Why messages from a pipe are being displayed as a char at at time? In C language", "body": "<p>The read code uses:</p>\n<pre><code>read(fd_log[READ], message_from_A, strlen(msg_to_log)+1)\n</code></pre>\n<p>and in the parent, you've not initialized <code>msg_to_log</code> so you probably get 0 as the string length (mostly by accident; certainly not by design), and read one character at a time.  Don't use <code>strlen()</code> in the receiving code; use <code>sizeof()</code> \u2014 without the <code>+1</code>!</p>\n<hr>\n<blockquote>\n<p>I tried using <code>sizeof()</code> but it gave me only the first message, so the output was:</p>\n<pre><code>In log: msg from A: A sent to B: C 0\n</code></pre>\n<p>and then the program terminated</p>\n</blockquote>\n<p>Like this?</p>\n<pre><code>$ ./piperead\nInside process A\nwritten to log pipe--&gt; A sent to B: C 0\n\nwritten to log pipe--&gt; A sent to B: D 1\n\nwritten to log pipe--&gt; A sent to B: C 2\n\nwritten to log pipe--&gt; A sent to B: C 3\n\nwritten to log pipe--&gt; A sent to B: C 4\n\nwritten to log pipe--&gt; A sent to B: C 5\n\nwritten to log pipe--&gt; A sent to B: D 6\n\nwritten to log pipe--&gt; A sent to B: D 7\n\nwritten to log pipe--&gt; A sent to B: C 8\n\nwritten to log pipe--&gt; A sent to B: C 9\n\nIn log: msg from A: [[A sent to B: C 0\n]]\nIn log: msg from A: [[A sent to B: C 8\n]]\n$\n</code></pre>\n<p>Except this has two reads, one for entries 0..7 and one for entries 8..9.</p>\n<p>This is from a mildly modified version of your code.  The trouble is that you're writing the null bytes on the pipe, and the <code>read()</code> is reading multiple messages in a single operation, but the <code>printf()</code> stops at the first null byte.</p>\n<p>Here's the output from an adapted version of your code:</p>\n<pre><code>$ ./piperead\nInside process A\n0: written to log pipe--&gt; [[A sent to B: C 0]]\n1: written to log pipe--&gt; [[A sent to B: D 1]]\n2: written to log pipe--&gt; [[A sent to B: C 2]]\n3: written to log pipe--&gt; [[A sent to B: C 3]]\n4: written to log pipe--&gt; [[A sent to B: C 4]]\n5: written to log pipe--&gt; [[A sent to B: C 5]]\n6: written to log pipe--&gt; [[A sent to B: D 6]]\n7: written to log pipe--&gt; [[A sent to B: D 7]]\n8: written to log pipe--&gt; [[A sent to B: C 8]]\n9: written to log pipe--&gt; [[A sent to B: C 9]]\nIn log: msg from A: 85: 16: [[A sent to B: C 0]]\nIn log: msg from A: 85: 16: [[A sent to B: C 5]]\n$\n</code></pre>\n<p>Note that the read operations both got 85 bytes of data, but only the first 16 (17) were visible as the string printed by <code>printf()</code>.  The division of the data in the pipe depends on lots of factors.  This was run on a machine with 6 CPUs.  I ran it other times and got all 170 bytes read in a single operation; I also got a 119:51 split, and 136:34 (which is what was shown in the first example), and any other n*17:(10-n)*17 ratio is possible too.</p>\n<p>This is the revised source:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\nenum { READ = 0, WRITE = 1 };\n\nint main(void)\n{\n    int i;\n    int x;\n    int fd_log[2];\n    int pipe_size = 500;\n    char ch;\n    char message_from_A[pipe_size];\n    char msg_to_log[pipe_size];\n\n    pipe(fd_log);\n\n    if (fork() == 0) // child\n    {\n        printf(&quot;Inside process A\\n&quot;);\n        for (i = 0; i &lt; 10; i++)\n        {\n            // creat new a record (C or D 0 to/or 9)\n            x = (rand() % 2);\n            if (x == 1)\n                ch = 'C';\n            else\n                ch = 'D';\n\n            // write msg to log pipe\n            sprintf(msg_to_log, &quot;A sent to B: %c %d&quot;, ch, i);\n            printf(&quot;%d: written to log pipe--&gt; [[%s]]\\n&quot;, i, msg_to_log);\n            write(fd_log[WRITE], msg_to_log, strlen(msg_to_log) + 1);\n        } // end for()\n        close(fd_log[READ]);\n        close(fd_log[WRITE]);\n        _exit(1); // process A\n    }\n    else // parent\n    {\n        int nbytes;\n        close(fd_log[WRITE]);\n        while ((nbytes = read(fd_log[READ], message_from_A, sizeof(message_from_A))) &gt; 0)\n        {\n            printf(&quot;In log: msg from A: %d: %zu: [[%s]]\\n&quot;, nbytes, strlen(message_from_A),\n                   message_from_A);\n            sleep(1);\n        }\n        close(fd_log[READ]); // this line won't affect output\n    }\n    return 0;\n}\n</code></pre>\n<p>It would not be hard to revise the printing code to print all the strings in the buffer \u2014 a tad fiddly, but something that would be good for you to deal with.</p>\n"}], "owner": {"reputation": 83, "user_id": 1550539, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/F1PiE.jpg?s=128&g=1", "display_name": "Nawar Youssef", "link": "https://stackoverflow.com/users/1550539/nawar-youssef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 31038779, "answer_count": 1, "score": 0, "last_activity_date": 1435189604, "creation_date": 1435187746, "last_edit_date": 1435188641, "question_id": 31038710, "link": "https://stackoverflow.com/questions/31038710/why-messages-from-a-pipe-are-being-displayed-as-a-char-at-at-time-in-c-language", "title": "Why messages from a pipe are being displayed as a char at at time? In C language", "body": "<p>I am trying to read messages sent from a child process to a parent using pipes. I asked question here and got some help and I was able to get the messages. But the problem is the messages are displayed one char at a time. I don't have any idea why. This my code: </p>\n\n<pre><code>int main(int argc, char *argv[]){\n\n    printf(\"\\nWritten by Nawar Youssef\\n\");\n\n    int i, x, fd_log[2], fd_A_B[2], pipe_size=500;\n    char ch, message_from_A[pipe_size], message_from_B[pipe_size],\n                        msg_to_log[pipe_size], msg_to_B[pipe_size];\n\n    pipe(fd_log);\n    pipe(fd_A_B);\n\n    //fork process A\n    if (fork()==0) { //child\n        printf(\"Inside process A\\n\");\n        for (i=0; i &lt; 10; i++) {\n            //creat new a record (C or D 0 to/or 9)\n            x = (rand() % 2);\n            if (x == 1)\n                ch='C';\n            else\n                ch='D';\n\n            //write msg to log pipe\n            sprintf(msg_to_log, \"A sent to B: %c %d\\n\", ch, i);\n            printf(\"wirtten to log pipe--&gt; %s\\n\", msg_to_log);\n            close(fd_log[READ]);\n            write(fd_log[WRITE], msg_to_log, strlen(msg_to_log)+1);\n        }//end for()\n        close(fd_log[WRITE]);\n        _exit(1); //process A\n\n    }\n    else { //parent\n        close(fd_log[WRITE]);\n        while (read(fd_log[READ], message_from_A, strlen(msg_to_log)+1) &gt; 0 ) {\n            sleep(1);\n            printf(\"\\nIn log: msg from A: %s\", message_from_A);\n        }\n        close(fd_log[READ]); //this line won't affect output \n    }\n}\n</code></pre>\n\n<p>And the output like the following, if you notice, the characters are the forming the sentence: A sent to B: C 0, which is the wanted output but each char displayed on it own line!</p>\n\n<p>In log: msg from A: A\u044c|?</p>\n\n<p>In log: msg from A:  \u044c|?</p>\n\n<p>In log: msg from A: s\u044c|?</p>\n\n<p>In log: msg from A: e\u044c|?</p>\n\n<p>In log: msg from A: n\u044c|?</p>\n\n<p>In log: msg from A: t\u044c|?</p>\n\n<p>In log: msg from A:  \u044c|?</p>\n\n<p>In log: msg from A: t\u044c|?</p>\n\n<p>In log: msg from A: o\u044c|?</p>\n\n<p>In log: msg from A:  \u044c|?</p>\n\n<p>In log: msg from A: B\u044c|?</p>\n\n<p>In log: msg from A: :\u044c|?</p>\n\n<p>In log: msg from A:  \u044c|?</p>\n\n<p>In log: msg from A: C\u044c|?</p>\n\n<p>In log: msg from A:  \u044c|?</p>\n\n<p>In log: msg from A: 0\u044c|?</p>\n"}, {"tags": ["c", "winapi"], "answers": [{"tags": [], "owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "is_accepted": true, "score": 1, "last_activity_date": 1435187031, "creation_date": 1435187031, "answer_id": 31038593, "question_id": 31038543, "link": "https://stackoverflow.com/questions/31038543/will-updatewindow-send-a-wm-paint-message-even-if-the-hwnd-is-validated/31038593#31038593", "title": "Will UpdateWindow() send a WM_PAINT message even if the HWND is validated?", "body": "<p>If there are no update regions marked as invalid then <code>UpdateWindow</code> does nothing, as the documentation says. If you call <code>InvalidateRect</code> first then the update region would not be empty and <code>UpdateWindow</code> would trigger a <code>WM_PAINT</code> as expected.</p>\n\n<p>If you want to force a redraw to complete immediately, the easiest way is with the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd162911%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\"><code>RedrawWindow</code></a> function. This lets you simultaneously mark a region as invalid, and force the redraw to take place before the command returns. For example, this will forcibly redraw the entire client area:</p>\n\n<pre><code>RedrawWindow(hWnd, 0, 0, RDW_INVALIDATE | RDW_UPDATENOW);\n</code></pre>\n"}], "owner": {"reputation": 573, "user_id": 5031477, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5191880a917c1cd3e15048d9d953e89a?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/5031477/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1152, "favorite_count": 0, "accepted_answer_id": 31038593, "answer_count": 1, "score": 0, "last_activity_date": 1435187031, "creation_date": 1435186703, "question_id": 31038543, "link": "https://stackoverflow.com/questions/31038543/will-updatewindow-send-a-wm-paint-message-even-if-the-hwnd-is-validated", "title": "Will UpdateWindow() send a WM_PAINT message even if the HWND is validated?", "body": "<p>I want to draw an image on an <code>HWND</code> immediately (by the time the function returns, the image would have been drawn). So I am thinking of using <code>UpdateWindow()</code> to do that, as I have read, <code>UpdateWindow()</code> will send a WM_PAINT message by calling the Window Procedure directly, and not by placing a WM_PAINT message in the message queue.</p>\n\n<p>But there is one think that I am not sure of, <code>UpdateWindow()</code> documentation says the following:</p>\n\n<blockquote>\n  <p>If the update region is empty, no message is sent.</p>\n</blockquote>\n\n<p>What does \"empty\" means? Does it mean validated? If so, should I call <code>InvalidateRect()</code> before calling <code>UpdateWindow()</code>?</p>\n"}, {"tags": ["c", "windows", "device-driver", "bsod"], "comments": [{"owner": {"reputation": 598, "user_id": 1692500, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6adc7f8116739bf3ba98ace33e30667c?s=128&d=identicon&r=PG", "display_name": "azizulhakim", "link": "https://stackoverflow.com/users/1692500/azizulhakim"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1435264549, "post_id": 31038464, "comment_id": 50141122, "body": "updated the question with some WinDbg log information."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1435268046, "post_id": 31038464, "comment_id": 50142858, "body": "So according to the memory dump, 0x8054baee is the address of your mov instruction?  I&#39;m puzzled as to why the IRQL is 13, since the notification routine should be run at PASSIVE_LEVEL.  My best guess is that the failure is actually occurring inside the call to ExAllocatePoolWithTag, and that the cause is indeed that the system pool has become corrupted - unfortunately that could be happening anywhere in your driver, or someone else&#39;s, for that matter."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1435268492, "post_id": 31038464, "comment_id": 50143057, "body": "Is this 32-bit or 64-bit Windows?  Perhaps you could try a call to KeGetCurrentIrql before calling ExAllocatePoolWithTag to verify the IRQL?"}, {"owner": {"reputation": 598, "user_id": 1692500, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6adc7f8116739bf3ba98ace33e30667c?s=128&d=identicon&r=PG", "display_name": "azizulhakim", "link": "https://stackoverflow.com/users/1692500/azizulhakim"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1435269427, "post_id": 31038464, "comment_id": 50143452, "body": "@HarryJohnston It is a 32-bit system. I can check the IRQL before calling it. Will update on that. Also you are right. The failure occurs inside ExAllocatePoolWithTag. I checked the address which referenced the memory and found out its inside ExAllocatePoolWithTag. So how can I corrupt the system pool? I mean what type of operation can corrupt the system pool?"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 1, "creation_date": 1435269875, "post_id": 31038464, "comment_id": 50143651, "body": "The system pool can only become corrupted if a device driver (probably but not necessarily yours) writes to a memory location it shouldn&#39;t.  For example, by writing past the end of a buffer you&#39;ve allocated.  On a 32-bit system, <a href=\"http://blogs.msdn.com/b/doronh/archive/2010/02/02/what-is-irql.aspx\" rel=\"nofollow noreferrer\">according to this</a>, IRQL 13 is used by device interrupts.  Perhaps a device interrupt is occurring during the call to ExAllocatePoolWithTag?  That might mean that the real problem is in the device interrupt routine, but I&#39;m not familiar enough with the kernel to be sure whether that idea makes sense."}, {"owner": {"reputation": 598, "user_id": 1692500, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6adc7f8116739bf3ba98ace33e30667c?s=128&d=identicon&r=PG", "display_name": "azizulhakim", "link": "https://stackoverflow.com/users/1692500/azizulhakim"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1435270714, "post_id": 31038464, "comment_id": 50144000, "body": "Thanks. Lets just assume everything in my driver is okay, no buffer overflow, nothing. Still if I make a call to ExAllocatePoolWithTag and in the meantime a device interrupt raises the IRQL level, is it going to cause a problem with the memory allocation?"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1435271514, "post_id": 31038464, "comment_id": 50144306, "body": "No, unless there is a bug in one of the device drivers (or elsewhere in the kernel) there shouldn&#39;t be a problem."}], "owner": {"reputation": 598, "user_id": 1692500, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6adc7f8116739bf3ba98ace33e30667c?s=128&d=identicon&r=PG", "display_name": "azizulhakim", "link": "https://stackoverflow.com/users/1692500/azizulhakim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 840, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1435264525, "creation_date": 1435186181, "last_edit_date": 1435264525, "question_id": 31038464, "link": "https://stackoverflow.com/questions/31038464/a-device-driver-has-pool-error", "title": "A Device Driver Has Pool Error", "body": "<p>I'm writing a windows device driver. The driver is very simple. It does nothing fancy. I'm just trying to get familiar with the windows driver development. </p>\n\n<p>In my driver I'm allocating some memory from <code>NonPagedPool</code>, but have a very strange error.</p>\n\n<p>Here goes my code segment:</p>\n\n<pre><code>pMyNode = (PMY_NODE)ExAllocatePoolWithTag(NonPagedPool, sizeof(MY_NODE), 'TEST');\nif (pMyNode == NULL){\n    DbgPrint(\"Not Enough Memory\\n\");\n}\nelse{\n    // Do Some Stuffs and free memory\n}\n</code></pre>\n\n<p>The corresponding assembly code(from IDA Pro Disassembler) is: </p>\n\n<pre><code>call ds:__imp__ExAllocatePoolWithTag\nmov [ebp+pMyNode], eax\ncmp [ebp+pMyNode], 0\njnz  SOME_OFFSET\ncall _DbgPrint\n\nSOME_OFFSET:\n.........\n.........\n</code></pre>\n\n<p>This code segment goes into the handler function of <code>PsSetCreateProcessNotifyRoutine</code>. So every time a new process is created, this code segment gets executed. Now if I run the driver for a long time, I get <code>BSoD</code> error suddenly. And <code>WinDbg</code> triggers the instruction <code>mov [ebp+pMyNode], eax</code> as the faulting instruction. This line actually assigns the return value of <code>ExAllocatePoolWithTag</code> to <code>pMyNode</code> pointer. I don't understand howcome this might be a faulty instruction. </p>\n\n<p>The error message in <code>BSoD</code> screen is <code>A Device Driver Has Pool</code>. Check the <code>WinDbg</code> log below:</p>\n\n<pre><code>DRIVER_CORRUPTED_EXPOOL (c5)\nAn attempt was made to access a pageable (or completely invalid) address at an\ninterrupt request level (IRQL) that is too high.  This is\ncaused by drivers that have corrupted the system pool.  Run the driver\nverifier against any new (or suspect) drivers, and if that doesn't turn up\nthe culprit, then use gflags to enable special pool.\nArguments:\nArg1: e252a000, memory referenced\nArg2: 0000000d, IRQL\nArg3: 00000001, value 0 = read operation, 1 = write operation\nArg4: 8054baee, address which referenced memory\n</code></pre>\n\n<p>Any help is appreciable. </p>\n"}, {"tags": ["c", "lapack", "blas", "atlas"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435186649, "post_id": 31038366, "comment_id": 50100928, "body": "That error is not from compiler, but the linker. There is apparently a libray missing or on a different path. (disclaimer: I do not know about Atlas, so I cannot be more specific)."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1435199843, "post_id": 31038366, "comment_id": 50104022, "body": "I suspect that you have built your executable and you have moved it somewhere other than where it was when you compiled it (or maybe not) and now it cannot find the library. You either need to set an <code>rpath</code> during link or need to set and export <code>LD_LIBRARY_PATH</code> pointing to the directory containing it. <a href=\"http://www.yolinux.com/TUTORIALS/LibraryArchives-StaticAndDynamic.html\" rel=\"nofollow noreferrer\"><b>Static, Shared Dynamic and Loadable Linux Libraries</b></a> is a decent tutorial. See <a href=\"http://stackoverflow.com/questions/2801297/linking-lapack-blas-libraries?rq=1\"><b>Linking LAPACK/BLAS libraries</b></a> first."}, {"owner": {"reputation": 169, "user_id": 2840019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8a4e0b20029b720fc2967e482c4f97a2?s=128&d=identicon&r=PG&f=1", "display_name": "avak", "link": "https://stackoverflow.com/users/2840019/avak"}, "edited": false, "score": 0, "creation_date": 1435213780, "post_id": 31038366, "comment_id": 50108219, "body": "I did export <code>LD_LIBRARY_PATH</code>. The link you sent does not help. All of the functions won&#39;t link, not just some."}, {"owner": {"reputation": 3112, "user_id": 2707697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f9da9a865b63faae8438d2d57c1c71b9?s=128&d=identicon&r=PG&f=1", "display_name": "ztik", "link": "https://stackoverflow.com/users/2707697/ztik"}, "edited": false, "score": 0, "creation_date": 1435218491, "post_id": 31038366, "comment_id": 50111014, "body": "you have to link against fortran blas <code>-lblas</code>"}, {"owner": {"reputation": 169, "user_id": 2840019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8a4e0b20029b720fc2967e482c4f97a2?s=128&d=identicon&r=PG&f=1", "display_name": "avak", "link": "https://stackoverflow.com/users/2840019/avak"}, "edited": false, "score": 0, "creation_date": 1435248674, "post_id": 31038366, "comment_id": 50132298, "body": "^Hi, how do I do that? I don&#39;t seem to have -lblas. I tried to link against <code>-lf77blas</code> and it did not work for me."}], "answers": [{"tags": [], "owner": {"reputation": 169, "user_id": 2840019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8a4e0b20029b720fc2967e482c4f97a2?s=128&d=identicon&r=PG&f=1", "display_name": "avak", "link": "https://stackoverflow.com/users/2840019/avak"}, "is_accepted": true, "score": 1, "last_activity_date": 1440117551, "creation_date": 1440117551, "answer_id": 32130637, "question_id": 31038366, "link": "https://stackoverflow.com/questions/31038366/atlas-lapack-not-linking-to-blas/32130637#32130637", "title": "ATLAS-LAPACK not linking to BLAS", "body": "<p>Resolved this. Need to link against lgfortran.</p>\n"}], "owner": {"reputation": 169, "user_id": 2840019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8a4e0b20029b720fc2967e482c4f97a2?s=128&d=identicon&r=PG&f=1", "display_name": "avak", "link": "https://stackoverflow.com/users/2840019/avak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1259, "favorite_count": 0, "accepted_answer_id": 32130637, "answer_count": 1, "score": 1, "last_activity_date": 1440117551, "creation_date": 1435185657, "question_id": 31038366, "link": "https://stackoverflow.com/questions/31038366/atlas-lapack-not-linking-to-blas", "title": "ATLAS-LAPACK not linking to BLAS", "body": "<p>I went to a standard ATLAS compile. All the tests pass, but when I am trying to compile with the following command:</p>\n\n<pre><code>gcc prog.c -o prog -I/home/atlas_build/include -L/home/atlas_build/lib -llapack -lcblas -lm\n</code></pre>\n\n<p>It gives a spew of errors:</p>\n\n<pre><code>dsyevr.f:(.text+0xbb): undefined reference to `lsame_'\ndsyevr.f:(.text+0xe3): undefined reference to `lsame_'\ndsyevr.f:(.text+0x102): undefined reference to `lsame_'\ndsyevr.f:(.text+0x125): undefined reference to `lsame_'\ndsyevr.f:(.text+0x148): undefined reference to `lsame_'\n/home/atlas_build/lib/liblapack.a(dsyevr.o):dsyevr.f:(.text+0x1ac): more undefined references to `lsame_' follow\n/home/atlas_build/lib/liblapack.a(dsyevr.o): In function `dsyevr_':\ndsyevr.f:(.text+0x39e): undefined reference to `xerbla_'\ndsyevr.f:(.text+0x742): undefined reference to `dscal_'\ndsyevr.f:(.text+0x7cb): undefined reference to `dscal_'\ndsyevr.f:(.text+0x9cb): undefined reference to `dcopy_'\ndsyevr.f:(.text+0xa15): undefined reference to `dcopy_'\ndsyevr.f:(.text+0xa84): undefined reference to `dcopy_'\ndsyevr.f:(.text+0xac2): undefined reference to `dcopy_'\ndsyevr.f:(.text+0x1146): undefined reference to `dscal_'\ndsyevr.f:(.text+0x124b): undefined reference to `dswap_'\n</code></pre>\n\n<p>It goes on and on, complaining about BLAS functions missing like dscal_, dcopy_, etc. I have truncated the output. Why is this happening?</p>\n"}, {"tags": ["c", "linked-list", "strtok"], "comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1435185347, "post_id": 31038258, "comment_id": 50100539, "body": "Btw, <code>strtok_r</code> or <code>strsep</code> would be better than <code>strtok</code>."}, {"owner": {"reputation": 25, "user_id": 5046509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf692095cc615ea1705601ae97ac7a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dustin Schmidt", "link": "https://stackoverflow.com/users/5046509/dustin-schmidt"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1435185520, "post_id": 31038258, "comment_id": 50100592, "body": "Thank you, I will look up the documentation for it now."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1435186141, "post_id": 31038258, "comment_id": 50100785, "body": "Actually, for this specific problem, since newlines and spaces are treated identically, <code>scanf(&quot;%ms&quot;)</code> might be the way to go."}, {"owner": {"reputation": 25, "user_id": 5046509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf692095cc615ea1705601ae97ac7a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dustin Schmidt", "link": "https://stackoverflow.com/users/5046509/dustin-schmidt"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1435186684, "post_id": 31038258, "comment_id": 50100941, "body": "I&#39;m sorry I&#39;m still having trouble implementing your suggestion properly."}], "answers": [{"tags": [], "owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "is_accepted": true, "score": 1, "last_activity_date": 1435186625, "last_edit_date": 1435186625, "creation_date": 1435185724, "answer_id": 31038382, "question_id": 31038258, "link": "https://stackoverflow.com/questions/31038258/how-to-populate-a-linked-list-from-a-file/31038382#31038382", "title": "How to populate a linked list from a file", "body": "<p>You are absolutely correct that you need a nested loop.</p>\n\n<p><code>strtok</code> needs to be called like this:</p>\n\n<pre><code>for (char *tok = strtok(\"input\", \" \"); tok; tok = strtok(NULL, \" \"))\n{\n    /* use tok */;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 5046509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf692095cc615ea1705601ae97ac7a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dustin Schmidt", "link": "https://stackoverflow.com/users/5046509/dustin-schmidt"}, "edited": false, "score": 0, "creation_date": 1435248127, "post_id": 31047649, "comment_id": 50131894, "body": "There is a Qu in the data file, the Qu plus the null character requires the array char data[3] if I&#39;m not mistaken. I appreciate the input though."}, {"owner": {"reputation": 3854, "user_id": 2235885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d0d6a08639ef79ef960a52bd013e02?s=128&d=identicon&r=PG", "display_name": "joop", "link": "https://stackoverflow.com/users/2235885/joop"}, "reply_to_user": {"reputation": 25, "user_id": 5046509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf692095cc615ea1705601ae97ac7a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dustin Schmidt", "link": "https://stackoverflow.com/users/5046509/dustin-schmidt"}, "edited": false, "score": 0, "creation_date": 1435249189, "post_id": 31047649, "comment_id": 50132601, "body": "I purposely ignored the <code>u</code>. Question is: is there a <code>Q</code> possible without the <code>u</code> ?"}, {"owner": {"reputation": 25, "user_id": 5046509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf692095cc615ea1705601ae97ac7a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dustin Schmidt", "link": "https://stackoverflow.com/users/5046509/dustin-schmidt"}, "edited": false, "score": 0, "creation_date": 1435252970, "post_id": 31047649, "comment_id": 50134819, "body": "Haha, unfortunately the &quot;u&quot; was thrown in there on purpose. And all joking aside, no."}, {"owner": {"reputation": 3854, "user_id": 2235885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d0d6a08639ef79ef960a52bd013e02?s=128&d=identicon&r=PG", "display_name": "joop", "link": "https://stackoverflow.com/users/2235885/joop"}, "reply_to_user": {"reputation": 25, "user_id": 5046509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf692095cc615ea1705601ae97ac7a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dustin Schmidt", "link": "https://stackoverflow.com/users/5046509/dustin-schmidt"}, "edited": false, "score": 0, "creation_date": 1435306707, "post_id": 31047649, "comment_id": 50155949, "body": "If there <b>always</b> is a <code>u</code> after a <code>Q</code>, then there still are only 26 <i>tokens</i>. So you could choose to always append a <code>u</code> after a <code>Q</code> when outputting."}], "tags": [], "owner": {"reputation": 3854, "user_id": 2235885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d0d6a08639ef79ef960a52bd013e02?s=128&d=identicon&r=PG", "display_name": "joop", "link": "https://stackoverflow.com/users/2235885/joop"}, "is_accepted": false, "score": 0, "last_activity_date": 1435227797, "creation_date": 1435227797, "answer_id": 31047649, "question_id": 31038258, "link": "https://stackoverflow.com/questions/31038258/how-to-populate-a-linked-list-from-a-file/31047649#31047649", "title": "How to populate a linked list from a file", "body": "<ul>\n<li>if you are only interested in single characters there is no need to read complete lines (and cut them into single characters)</li>\n<li>since you are only interested in single characters, the <code>.data</code> element in the structure does not need to be <code>char data[3]</code></li>\n<li>a function that reads a file could take the filename as an argument</li>\n<li>and the function could return the list it has read, instead of returning void and passing the result back to the caller via a pointer-to-pointer.</li>\n</ul>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct boggleNode {\n    struct boggleNode *next;\n    char data;\n    };\n\nstruct boggleNode * readboggle(char *name);\n\nint main (int argc, char **argv)\n{\nstruct boggleNode *bp;\n\nif (!argv[1]) return 0;\n\nbp = readboggle( argv[1] );\n\nfor ( ; bp; bp = bp-&gt; next) {\n        printf(\" %c\", bp-&gt;data);\n        }\n\nprintf(\"\\n\" );\nreturn 0;\n}\n\nstruct boggleNode * readboggle(char *name)\n{\nstruct boggleNode *ret=NULL, **bpp;\nFILE *fp;\nint ch;\n\nfp = fopen (name, \"r\" );\nif (!fp) return NULL;\n\nret= NULL;\nbpp = &amp;ret;\nwhile(1)        {\n        ch = getc(fp);\n        if (ch == EOF) break;\n        if (ch &lt; 'A' || ch &gt; 'Z') continue;\n        *bpp = malloc (sizeof **bpp);\n        (*bpp)-&gt;data = ch;\n        (*bpp)-&gt;next = NULL;\n        bpp = &amp;(*bpp)-&gt;next;\n        }\nfclose (fp);\nreturn ret;\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5046509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf692095cc615ea1705601ae97ac7a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Dustin Schmidt", "link": "https://stackoverflow.com/users/5046509/dustin-schmidt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1397, "favorite_count": 0, "accepted_answer_id": 31038382, "answer_count": 2, "score": 1, "last_activity_date": 1435227797, "creation_date": 1435185061, "last_edit_date": 1435186543, "question_id": 31038258, "link": "https://stackoverflow.com/questions/31038258/how-to-populate-a-linked-list-from-a-file", "title": "How to populate a linked list from a file", "body": "<p>I am trying to populate a linked list reading in from a file. I have been attempting to use <code>strtok()</code> to break apart a string using <code>\" \"</code> as a delimiter. When I call my <code>addEntry()</code> function it is only adding the first letter of each string to a new node. I realize this is probably a simple oversight, so please excuse my ignorance as I am still quite new to coding.</p>\n\n<p>The specific section of code I am having trouble with is:</p>\n\n<pre><code>void readData(struct boggleDataNode **headRef){\n    //initializing variables including\n    //opening the input file\n    int counter = 96;\n    int i = 0;\n    char dataLine[LENGTH];\n    char *data;\n    char *fileName = \"BoggleData.txt\";\n    FILE *filePointer;\n\n    printf(\"Trying to open file %s\\n\", fileName);\n    filePointer = fopen(fileName, \"r\"); //read mode\n    printf(\"Successfully opened file %s\\n\", fileName);\n\n    if (filePointer == NULL){\n        perror(\"Error while opening file. \\n\");\n        exit(0);\n    }\n\n    //loop until find end of file\n    while ( fgets(dataLine, LENGTH, filePointer) != NULL){\n        //I feel like i should be using a nested loop here but I can't figure out how to do it \n        printf(\"dataLine = %s\\n\", dataLine);\n        data = strtok(dataLine, \" \");\n        printf(\"data = %s\\n\", data);\n        //fgets(data, 3, filePointer);\n        addEntry(headRef, data);\n        //nested loop should end here\n    }\n}\n</code></pre>\n\n<p>My output is only 16 nodes, the first letter from each line, when it should be 96 nodes long.\nThe file which I am reading from is:</p>\n\n<pre><code>D R L X E I\nC P O H S A\nN H N L Z R\nW T O O T A\nI O S S E T\nN W E G H E\nB O O J A B\nU I E N E S\nP S A F K F\nI U N H M Qu\nY R D V E L\nV E H W H R\nI O T M U C\nT Y E L T R\nS T I T Y D\nA G A E E N\n</code></pre>\n\n<hr>\n\n<p>In case the full code is needed:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define LENGTH 80\n\nstruct boggleDataNode {\n    char data[3];\n    struct boggleDataNode *nextData;\n};\n\nstruct boggleDieSideNode {\n    char dieSideData[3];\n    struct boggleDieSideNode *nextSide;\n};\n\nvoid readData(struct boggleDataNode **);\nvoid addEntry(struct boggleDataNode **, char *);\nvoid display(struct boggleDataNode *);\n\nint main() {\n\n    int counter = 0;\n\n    struct boggleDataNode * head = NULL;\n    struct boggleDieSideNode *head1 = NULL;\n    readData(&amp;head);\n    display(head);\n\n    system(\"pause\");\n    return 0;\n}\n\nvoid readData(struct boggleDataNode **headRef){\n    //initializing variables including\n    //opening the input file\n    int counter = 96;\n    int i = 0;\n    char dataLine[LENGTH];\n    char *data;\n    char *fileName = \"BoggleData.txt\";\n    FILE *filePointer;\n\n    printf(\"Trying to open file %s\\n\", fileName);\n    filePointer = fopen(fileName, \"r\"); //read mode\n    printf(\"Successfully opened file %s\\n\", fileName);\n\n    if (filePointer == NULL){\n        perror(\"Error while opening file. \\n\");\n        exit(0);\n    }\n\n    //loop until find end of file\n    while ( fgets(dataLine, LENGTH, filePointer) != NULL){\n        printf(\"dataLine = %s\\n\", dataLine);\n        data = strtok(dataLine, \" \");\n        printf(\"data = %s\\n\", data);\n        //fgets(data, 3, filePointer);\n        addEntry(headRef, data);\n    }\n\n    fclose(filePointer);\n\n}//cose readData\n\nvoid addEntry(struct boggleDataNode **headRef, char *data){\n\n    //allocate node\n    struct boggleDataNode* temp = (struct boggleDataNode*) malloc(sizeof(struct boggleDataNode));\n\n    //put in data\n    strcpy(temp-&gt;data, data);\n\n    // link the old list off the new node\n    temp-&gt;nextData = (*headRef);\n\n    // move the head to point to the new node\n    (*headRef) = temp;\n}\n\nvoid display(struct boggleDataNode *headRef){\n\n    struct boggleDataNode *helper = headRef;\n\n    if (helper == NULL){\n        return;\n    }\n    else{\n        printf(\"============================================\\n\");\n        printf(\"Node #        Data\\n\");\n        printf(\"============================================\\n\");\n\n        int counter = 1;\n\n        while (helper != NULL){\n            printf(\"%5d \\t %2s\\n\", counter++, helper-&gt;data);\n            helper = helper-&gt;nextData;\n        }\n    }\n    printf(\"\\n\");\n    system(\"pause\");\n}\n</code></pre>\n"}, {"tags": ["c", "macos", "memory"], "answers": [{"tags": [], "owner": {"reputation": 859, "user_id": 1887702, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/48fe7a39acd359545b7b92107192f51b?s=128&d=identicon&r=PG", "display_name": "jndok", "link": "https://stackoverflow.com/users/1887702/jndok"}, "is_accepted": true, "score": 1, "last_activity_date": 1435229663, "creation_date": 1435229663, "answer_id": 31048338, "question_id": 31038216, "link": "https://stackoverflow.com/questions/31038216/osx-write-and-exec-on-allocated-memory-page/31048338#31048338", "title": "osx - write and exec on allocated memory page", "body": "<p>So after a few hours of code reading, I solved it. Answer was in <code>mach_override</code> code, as I expected. It uses this piece of code:</p>\n\n<pre><code>jumpRelativeInstruction |= 0xE900000000000000LL;\njumpRelativeInstruction |= ((uint64_t)offset &amp; 0xffffffff) &lt;&lt; 24;\njumpRelativeInstruction = OSSwapInt64(jumpRelativeInstruction);\n</code></pre>\n\n<p>to manually craft a <code>JMP</code> instruction, ready to be placed in memory, with the correct endianness and everything. It completely avoids memory writing functions, such as <code>memset</code> or <code>memcpy</code> which probably perform checks. Then, it finally writes it in memory using a pointer dereference:</p>\n\n<pre><code>*originalFunctionPtr = jumpRelativeInstruction;\n</code></pre>\n\n<p>This overflows into the next function opcodes, overwriting them.</p>\n\n<p>So, by tweaking the code I was able to fit it into mine and finally <code>JMP</code> into the allocated area!</p>\n\n<pre><code>(lldb) r\nProcess 869 launched: './mempool' (x86_64)\nalloc: 0x100035000\nfunc: 0x100000bf0\nhooked!\nProcess 869 exited with status = 0 (0x00000000) \n</code></pre>\n"}], "owner": {"reputation": 859, "user_id": 1887702, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/48fe7a39acd359545b7b92107192f51b?s=128&d=identicon&r=PG", "display_name": "jndok", "link": "https://stackoverflow.com/users/1887702/jndok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "accepted_answer_id": 31048338, "answer_count": 1, "score": 1, "last_activity_date": 1435229663, "creation_date": 1435184871, "question_id": 31038216, "link": "https://stackoverflow.com/questions/31038216/osx-write-and-exec-on-allocated-memory-page", "title": "osx - write and exec on allocated memory page", "body": "<p>I am stuck with a problem regarding memory mapping on OS X.</p>\n\n<p>I am using the <code>mmap</code> call to map a memory region near a specific function. The idea is to later <code>jmp</code> to this allocated memory region using a relative jump. Code:</p>\n\n<pre><code>void *alloc;\nif((alloc = mmap((void*)func, 12, PROT_EXEC|PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANON, -1, 0)) == MAP_FAILED)\n        printf(\"failed\\n\");\n</code></pre>\n\n<p>No problems for now. Memory gets mapped near <code>func</code>, by avoiding the use of <code>MAP_FIXED</code> flag, the kernel places it in a nearby location.</p>\n\n<p>Then I simply craft a shellcode with the <code>E9</code> opcode (<code>jmp</code>) + the relative offset, calculated by subtracting the function (<code>func</code>) address and the allocated area (<code>alloc</code>) address.</p>\n\n<pre><code>char jmp32[] = {\n     '\\xE9', '\\x00', '\\x00', '\\x00', '\\x00'\n};\n\nint *offset = malloc(4);\n*offset = (int)(alloc-func);\n\nmemcpy(jmp32+1, offset, 4);\n</code></pre>\n\n<p>The shellcode is crafted fine, and its ready to be placed in memory.</p>\n\n<pre><code>vm_protect(mach_task_self(), (vm_address_t)func, 16, 0, VM_PROT_ALL); //make function area writable\n\nmemcpy(func, jmp32, sizeof(jmp32)); // place the jmp\n</code></pre>\n\n<p>Now, everything seems fine, but when I execute the program (and obviously call <code>func</code>):</p>\n\n<pre><code>(lldb) r\nProcess 3563 launched: './mempool' (x86_64) // don't mind the name, was using an old Xcode project\nffffffe9 //\n60       //\n43       // output there, as you can see, the shellcode is crafted fine!\n03       //\n00       //\nProcess 3563 stopped\n* thread #1: tid = 0x15f3e, 0x0000000100035fff, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=1, address=0x100036000)\n    frame #0: 0x0000000100035fff\n</code></pre>\n\n<p>So, investigating further:</p>\n\n<pre><code>(lldb) d -F intel -n test\nmempool`test at main.c:97:\n   0x100000ca0:  or     dword ptr [rax + 0x43], esp  //OR?!?\n   0x100000ca3:  add    eax, dword ptr [rax]\n   0x100000ca5:  sub    esp, 0x10\n   0x100000ca8:  lea    rdi, qword ptr [rip + 0x2c3] ; \"culo here: %p\\n\"\n   0x100000caf:  lea    rax, qword ptr [rip - 0x16] ; test at main.c:97\n   0x100000cb6:  mov    rsi, rax\n   0x100000cb9:  mov    al, 0x0\n   0x100000cbb:  call   0x100000ee4               ; symbol stub for: printf\n   0x100000cc0:  mov    dword ptr [rbp - 0x4], eax\n   0x100000cc3:  add    rsp, 0x10\n   0x100000cc7:  pop    rbp\n   0x100000cc8:  ret  \n</code></pre>\n\n<p>The instruction is there, at the start of the function, but it's an <code>OR</code>. Not a <code>JMP</code>. Going deeper:</p>\n\n<pre><code>(lldb) mem read 0x100000ca0\n0x100000ca0: 09 60 43 03 00 83 ec 10 48 8d 3d c3 02 00 00 48  .`C...?.H.=?...H\n0x100000cb0: 8d 05 ea ff ff ff 48 89 c6 b0 00 e8 24 02 00 00  ..????H.\u01b0.?$...\n</code></pre>\n\n<p>We can actually see that the <code>E9</code>, aka the <code>JMP</code> opcode got corrupted into a <code>09</code> opcode, which stands for the <code>OR</code> instruction. </p>\n\n<p>I got various results, but the <code>E9</code> opcode always gets modified. I must assume this is the <em>W^X</em> memory protection mechanism I read about some time ago, right? Also, guess what, removing the <code>PROT_EXEC</code> flag in the <code>mmap</code> call leaves the opcode intact.</p>\n\n<p>I really don't know if there is any way to go around this, but I assume there is, since <a href=\"https://github.com/rentzsch/mach_override\" rel=\"nofollow\">mach_override</a> does exactly what I want, and from the little I have seen in the code, it uses memory allocation to jump around in memory. I will read the code further, and try to understand how to do it, but I would love to hear a good explanation from someone here! Specifically:</p>\n\n<ol>\n<li>Is this the <em>W^X</em> feature?</li>\n<li>Are there any workarounds? </li>\n<li>If no, how does <code>mach_override</code> do?</li>\n</ol>\n\n<p>Sorry for the long post, but I wanted to clear everything out. And thanks to anybody who can help me out!</p>\n"}, {"tags": ["c", "memory", "location", "store"], "comments": [{"owner": {"reputation": 1809, "user_id": 951784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9858b1ffedc039e48a0ed219198d538c?s=128&d=identicon&r=PG", "display_name": "rost0031", "link": "https://stackoverflow.com/users/951784/rost0031"}, "edited": false, "score": 2, "creation_date": 1435184104, "post_id": 31038049, "comment_id": 50100068, "body": "Post the rest of your code.  This isn&#39;t quite enough to work with.  It&#39;s impossible to tell where functions start and end."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 5, "creation_date": 1435184126, "post_id": 31038049, "comment_id": 50100080, "body": "Pleas provide a <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a> with proper formating. That code does not even compile."}], "answers": [{"tags": [], "owner": {"reputation": 10110, "user_id": 1715829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c0yet.jpg?s=128&g=1", "display_name": "Buddy", "link": "https://stackoverflow.com/users/1715829/buddy"}, "is_accepted": false, "score": 2, "last_activity_date": 1435184269, "creation_date": 1435184269, "answer_id": 31038113, "question_id": 31038049, "link": "https://stackoverflow.com/questions/31038049/preserved-value-of-a-variable-in-c/31038113#31038113", "title": "preserved value of a variable in C", "body": "<p>You're not initializing <code>k</code> either... so it's probably just re-using the same memory location each time you call the function and it just happens to still be 4 from the first call...</p>\n\n<p>Try this <code>int k = 0;</code></p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 5039786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3zVi7.jpg?s=128&g=1", "display_name": "Miguel Hernando", "link": "https://stackoverflow.com/users/5039786/miguel-hernando"}, "is_accepted": false, "score": 1, "last_activity_date": 1435184777, "creation_date": 1435184777, "answer_id": 31038197, "question_id": 31038049, "link": "https://stackoverflow.com/questions/31038049/preserved-value-of-a-variable-in-c/31038197#31038197", "title": "preserved value of a variable in C", "body": "<p>If you want to preserve the value of K but into the local scope of the function you could use the static type modificator. </p>\n\n<pre><code>static int k=0;\n</code></pre>\n\n<p>thus, your variable is global from the point of view of duration, but its scope is local to the function or block where it is initialized.</p>\n\n<p>And yes,.. probably the function reuses the same location of k, because you do not initialize its value as Buddy points out. </p>\n"}, {"tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": false, "score": 1, "last_activity_date": 1435185496, "last_edit_date": 1435185496, "creation_date": 1435185071, "answer_id": 31038263, "question_id": 31038049, "link": "https://stackoverflow.com/questions/31038049/preserved-value-of-a-variable-in-c/31038263#31038263", "title": "preserved value of a variable in C", "body": "<p>Your current code exhibits <em>undefined bahaviour</em> (<a href=\"http://www.catb.org/jargon/html/N/nasal-demons.html\" rel=\"nofollow\">there might be demons flying out of your nose</a>), as <code>k</code> is not initialized. Any value you actually read is <strong>invalid</strong> (technically:  whatever is at its current memory location). Rason is that local variables are <em>not</em> initialized by default for performance reasons.</p>\n\n<p>So, if you do not want that, you have to explictily initialize it by an initial assignment. This may be included in the definition as for any other variable, but with a non-constant expression.</p>\n\n<p>If you want to keep the last value of <code>k</code>, you have to <em>define</em> it <code>static</code>. Note that any initialization is done when the program loads and it does preserve its value between calls. Thus, the initialization has to be a <em>constant expression</em> If you do not explicitly initialize it, it defaults to <code>0</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 5045527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/499f33b5c146c76c96d728bda9102fa6?s=128&d=identicon&r=PG&f=1", "display_name": "yigggit", "link": "https://stackoverflow.com/users/5045527/yigggit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1435187625, "creation_date": 1435184000, "last_edit_date": 1435187625, "question_id": 31038049, "link": "https://stackoverflow.com/questions/31038049/preserved-value-of-a-variable-in-c", "title": "preserved value of a variable in C", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid func(int i);\n\nint main() {\n\n\nint i;\nfor(i=0;i&lt;3;i++){\n    func(i);\n}\nreturn 0;\n}\n\nvoid func(int i){\n\nint k;\n\n\nif(i==0){\n\n    k=4;\n}\n\nprintf(\"%d\\n\",k);\n</code></pre>\n\n<p>Sample Run:</p>\n\n<pre><code>4\n4\n4\n</code></pre>\n\n<p>Can someone please explain how come k is always equal to 4. Everytime I call the function I am redefining k and how can the value of k be preserved everytime I call the function</p>\n"}, {"tags": ["c", "linux", "memory-management", "memory-leaks"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1435186736, "post_id": 31037871, "comment_id": 50100955, "body": "Opening a file does not automatically load the whole file content into  the process address space. That is, there is no virtual memory allocated for the contents of the file simply by opening a file (there is some book keeping memory needed of course)."}], "answers": [{"tags": [], "owner": {"reputation": 1176, "user_id": 1371191, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-7bV-CLvBrNE/AAAAAAAAAAI/AAAAAAAAAE8/i44ypczz624/photo.jpg?sz=128", "display_name": "Mike Lui", "link": "https://stackoverflow.com/users/1371191/mike-lui"}, "is_accepted": true, "score": 0, "last_activity_date": 1435193894, "last_edit_date": 1492085627, "creation_date": 1435193894, "answer_id": 31039535, "question_id": 31037871, "link": "https://stackoverflow.com/questions/31037871/how-to-check-memory-allocated-to-open-files-in-a-process/31039535#31039535", "title": "How to check memory allocated to open files in a process", "body": "<p>A small experiment shows that yes, because tmpfile is created in /tmp, it is held purely in memory, and because I was running out of memory, my program got killed.  Because the program had the last open file descriptor, the file is deleted(freed out of my tmpfs) after the program was killed.  Because /<strong>tmp</strong> exists only in memory as a tmpfs, it can't be 'paged out' to disk because the filesystem itself exists only in memory, and swap was also full, hence the OOM error.  </p>\n\n<p>By performing the same experiment with a file in <strong>/var/tmp</strong>, which is instead on disk, no extra memory was being taken up so I didn't get this error.</p>\n\n<p>While I couldn't view this behavior with <strong>top</strong>, <strong>free -h</strong> showed the memory being taken up under <em>shared</em> and <em>buff/cache</em>.\nTo narrow down the exact culprit, I used:</p>\n\n<pre><code>lsof | awk '$5 == \"REG\"' | sort -n -r -k 7,7 | head -n 5\n</code></pre>\n\n<p>from <a href=\"https://serverfault.com/questions/207100/how-can-i-find-phantom-storage-usage\">https://serverfault.com/questions/207100/how-can-i-find-phantom-storage-usage</a></p>\n\n<p>Note that the above will not work if /tmp is already full. \nSo <em>the open file was not the problem</em>, i.e. buffering was not the problem. The problem was that the file existed in a tmpfs.</p>\n\n<p>To answer my <strong>#2</strong>, the file doesn't show up because it was 'deleted' when it was unlinked with tmpfile(): </p>\n\n<pre><code>$ lsof | awk '$5 == \"REG\"' | sort -n -r -k 7,7 | head -n 5\ntoy       13624       me    3u      REG               0,33 4294963200   12505948 /tmp/tmpf0W4HOM (deleted)\n</code></pre>\n"}], "owner": {"reputation": 1176, "user_id": 1371191, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-7bV-CLvBrNE/AAAAAAAAAAI/AAAAAAAAAE8/i44ypczz624/photo.jpg?sz=128", "display_name": "Mike Lui", "link": "https://stackoverflow.com/users/1371191/mike-lui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1588, "favorite_count": 0, "accepted_answer_id": 31039535, "answer_count": 1, "score": 1, "last_activity_date": 1435193894, "creation_date": 1435183182, "last_edit_date": 1435186785, "question_id": 31037871, "link": "https://stackoverflow.com/questions/31037871/how-to-check-memory-allocated-to-open-files-in-a-process", "title": "How to check memory allocated to open files in a process", "body": "<p>The scenario is that I'm running a test program which grows to 8GB in size, and then a series of asserts are done via <a href=\"http://check.sourceforge.net\" rel=\"nofollow\">Check</a>.  </p>\n\n<p>I can see my process grow to 8GB in size in '<em>top</em>' and I see my system memory grow accordingly. However, when a large number of asserts are done afterwards, I see <strong>VIRT stop growing</strong> as expected, and I see my <strong>total used</strong> memory continue to increase as Check is going through the asserts. So according to top there's no more memory being given to any processes, but I something is still chewing through memory.</p>\n\n<p>I sort top by memory usage and see nothing else is reserving memory. Eventually I hit 100% swap and physical memory usage and the process gets killed.</p>\n\n<p>Note that Check will fork each 'test' into its own process. When I break the test program (w/ ctrl+c), I still see the process in top, and its VIRT still reads 8GB.</p>\n\n<p>I believe memory is being eaten by Check, because this behavior doesn't happen when I take out all the asserts.  I saw in Check that a tmpfile() is created and used to track the last assert that happened and I see /tmp growing as the assert phase begins.  If I modify Check code to write to a file in /tmp (instead of using tmpfile()), I see that file grows to be GBs big. </p>\n\n<p>1) Why doesn't the virtual address space being taken up by the <strong>open file</strong> show up as part of the <strong>process' used memory</strong>? Note that Check forks off each 'test'.  Also, even though swap is full, shouldn't unused parts of the file just get paged back out to memory? (writes are done via fwrite, not mmap)</p>\n\n<p>2) A secondary question, I haven't used tmpfile() before, but <strong>why doesn't any file show up in /tmp when tmpfile()</strong> is invoked? If it is because the file is unlinked immediately, does that mean any unlinked file won't show up in the filesystem? (My understanding of what unlink does is also rudimentary). </p>\n\n<p>edit: I'm using Arch Linux w/ kernel 4.0.5-1 and procps-ng version 3.3.10</p>\n"}, {"tags": ["c", "if-statement", "character", "logical-operators"], "comments": [{"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "edited": false, "score": 1, "creation_date": 1435182126, "post_id": 31037573, "comment_id": 50099242, "body": "if <i>i</i> is variable please remove those &#39;&#39;. Also what is c1?"}, {"owner": {"reputation": 2151, "user_id": 2130104, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0JKjv.jpg?s=128&g=1", "display_name": "Mr. Perfectionist", "link": "https://stackoverflow.com/users/2130104/mr-perfectionist"}, "edited": false, "score": 0, "creation_date": 1435182187, "post_id": 31037573, "comment_id": 50099262, "body": "You can store c1,c2,,,,,,,cn variables in an array. Then compare by a loop."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1435182331, "post_id": 31037573, "comment_id": 50099340, "body": "Use <code>switch</code> statement."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5042178"}, "reply_to_user": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "edited": false, "score": 0, "creation_date": 1435182413, "post_id": 31037573, "comment_id": 50099371, "body": "all variables are characters @giorgi"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5042178"}, "reply_to_user": {"reputation": 2151, "user_id": 2130104, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0JKjv.jpg?s=128&g=1", "display_name": "Mr. Perfectionist", "link": "https://stackoverflow.com/users/2130104/mr-perfectionist"}, "edited": false, "score": 0, "creation_date": 1435182444, "post_id": 31037573, "comment_id": 50099388, "body": "@NafeeurRahman thanks! i&#39;ll try it out"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5042178"}, "edited": false, "score": 0, "creation_date": 1435182730, "post_id": 31037714, "comment_id": 50099540, "body": "Can I use something like {c1, c2, c3, &#39;\\0&#39;} in place of &quot;12345&quot;?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1435182807, "post_id": 31037714, "comment_id": 50099564, "body": "You can use any string constant. Check for <i>compound literals</i>. or enter the values as octal or hex-codes: <code>\\x20</code>. Ehm... are the values variables actually? Your question did state different."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5042178"}, "edited": false, "score": 0, "creation_date": 1435182997, "post_id": 31037714, "comment_id": 50099637, "body": "Yes all values are variables, that&#39;s why it&#39;s hard to do it without avoiding having a mess of a code. Also their names are bigger not just &#39;c1&#39; or &#39;i&#39;."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435183195, "post_id": 31037714, "comment_id": 50099715, "body": "@AnnoyingQuestions: Please edit your question <code>&#39;c1&#39;</code> is a character literal actually (assumint <code>c1</code> is a single character). However, I updated my answer"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1435183276, "post_id": 31037714, "comment_id": 50099748, "body": "You can also introduce him to <code>if (strchr (&quot;12345&quot;, ch))</code> itself and prompt a bit of thought and learning <code>:p</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1435183674, "post_id": 31037714, "comment_id": 50099890, "body": "@DavidC.Rankin: What do you mean?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1435190427, "post_id": 31037714, "comment_id": 50101935, "body": "Just without the <code>!= NULL</code> to have them focus for a moment on the <code>strchr</code> return and various ways of integrating it with the test."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1435190954, "post_id": 31037714, "comment_id": 50102074, "body": "@DavidC.Rankin: That is the way I actually write it myself (I only use bool/adjective functions without explicit compare actually), so it was kind of &quot;automatic&quot;. However, I do not see much sense in changing this right now. The OP seems to have understood the point."}], "tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": true, "score": 3, "last_activity_date": 1435183563, "last_edit_date": 1435183563, "creation_date": 1435182566, "answer_id": 31037714, "question_id": 31037573, "link": "https://stackoverflow.com/questions/31037573/compare-character-with-multiple-characters-in-c/31037714#31037714", "title": "Compare character with multiple characters in C", "body": "<p>Assuming your <code>'c1'</code>, ... are just a single <code>char</code> constants, you can use:</p>\n\n<pre><code>if ( strchr(\"12345\", ch) != NULL )\n    ...\n</code></pre>\n\n<p>(\"12345\" are <code>c1</code>, <code>c2</code>, ...)</p>\n\n<p><code>strchr()</code> will, however, also match the implcit trailing NUL terminator (<code>'\\0'</code>). If that is a problem, you can compare this value explicitly. As the input string is searched from start, you might want to have the more propable values at the beginning.</p>\n\n<p>Note that <code>strchr</code> does return a pointer to the matching char; just if you need that.</p>\n\n<p>If you can group the values, e.g. \"letters\", \"digits\", etc., have a look at <a href=\"http://www.cplusplus.com/reference/cctype/\" rel=\"nofollow\">ctype.h</a>.</p>\n\n<p>If the values are variables, you can either copy them into an array of <code>char</code> before the compare (<strong>do not forget about the  trminator!</strong>) or hold them in the array anyway: <code>array[0]</code> is <code>c1</code>, ... .</p>\n\n<p>If all this is not possible, you are likely busted with <code>strcpy</code>. You could use this:</p>\n\n<pre><code>// assuming there are always the same variables used.\nstatic const char * const ca[] = { &amp;c1, &amp;c2, ... };\n\nchar val;\n\nfor ( size_t i = 0 ; i &lt; sizeof(ca) / sizeof(ca[0]) ; i++ ) {\n    if ( *ca[i] == val ) {\n        // match!\n    }\n}\n</code></pre>\n\n<p>You could pack that into a function with some decoration here and there.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5042178"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3119, "favorite_count": 0, "accepted_answer_id": 31037714, "answer_count": 1, "score": 0, "last_activity_date": 1435183563, "creation_date": 1435182011, "last_edit_date": 1435183457, "question_id": 31037573, "link": "https://stackoverflow.com/questions/31037573/compare-character-with-multiple-characters-in-c", "title": "Compare character with multiple characters in C", "body": "<p>How can i compare a character in C with other characters without using an 'if'\nwith tons of '||'?\nFor example let's say I have a character named 'i' that I want to compare with 8 other characters that have no connection between them whatsoever, and if 'i' equals to at least one of those 8 characters then the expression is true.\nSomething like this:</p>\n\n<pre><code>if(i == c1 || i == c2 || i == c2 ........){ /* do stuff */}\n</code></pre>\n\n<p>But on a big application these comparisons are a lot, not just 3 or 8.\nIs there a smart and fast way to achieve something like this and not end up with ugly looking code? Thank you in advance.</p>\n"}, {"tags": ["c", "arm", "fft", "cortex-m"], "comments": [{"owner": {"reputation": 41, "user_id": 4804846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e5f089c0c5ff99135ae6c6b3d07621f?s=128&d=identicon&r=PG&f=1", "display_name": "jmfm", "link": "https://stackoverflow.com/users/4804846/jmfm"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1435225046, "post_id": 31037395, "comment_id": 50115091, "body": "Sorry, I forgot to put the code here. I have already edited the post."}, {"owner": {"reputation": 7207, "user_id": 410847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a354e99dd64adf823aa72c4ee22a1fc?s=128&d=identicon&r=PG", "display_name": "Turbo J", "link": "https://stackoverflow.com/users/410847/turbo-j"}, "edited": false, "score": 0, "creation_date": 1435225384, "post_id": 31037395, "comment_id": 50115291, "body": "Do you use the 16 or the 32 KB RAM version of the chip?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1435225386, "post_id": 31037395, "comment_id": 50115294, "body": "OK - that code looks like it was mostly lifted straight from Numerical Recipes - why not try using the original code first, in case you&#39;ve introduced bugs? Also note that this is not a particularly good (or efficient) FFT - you&#39;d be much better off with something like KissFFT."}, {"owner": {"reputation": 41, "user_id": 4804846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e5f089c0c5ff99135ae6c6b3d07621f?s=128&d=identicon&r=PG&f=1", "display_name": "jmfm", "link": "https://stackoverflow.com/users/4804846/jmfm"}, "edited": false, "score": 0, "creation_date": 1435226179, "post_id": 31037395, "comment_id": 50115790, "body": "Turbo J, I use the 16KB RAM version, and for me this can be a reason for this issue.  Paul R, this code is from Numerical Recipes, and I didn&#180;t make any big alteration. I also tried to use de DSP library, but I had the same issue. However, I will try KissFFT. Thanks, Paul."}, {"owner": {"reputation": 41, "user_id": 4804846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e5f089c0c5ff99135ae6c6b3d07621f?s=128&d=identicon&r=PG&f=1", "display_name": "jmfm", "link": "https://stackoverflow.com/users/4804846/jmfm"}, "edited": false, "score": 0, "creation_date": 1435256436, "post_id": 31037395, "comment_id": 50136849, "body": "Turbo J, do you confirm the problem here is the limited RAM I have?"}, {"owner": {"reputation": 7207, "user_id": 410847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a354e99dd64adf823aa72c4ee22a1fc?s=128&d=identicon&r=PG", "display_name": "Turbo J", "link": "https://stackoverflow.com/users/410847/turbo-j"}, "edited": false, "score": 0, "creation_date": 1435256923, "post_id": 31037395, "comment_id": 50137121, "body": "An array of 512 double values is 4KB alone. There is not much RAM left if softdevice was active."}, {"owner": {"reputation": 8600, "user_id": 450758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2ccb382a98f56c846d0e064f44920dc?s=128&d=identicon&r=PG", "display_name": "marko", "link": "https://stackoverflow.com/users/450758/marko"}, "edited": false, "score": 0, "creation_date": 1435272600, "post_id": 31037395, "comment_id": 50144684, "body": "ARM Cortex-M0 doesn&#39;t appear to have an FPU either, so I imagine this will be using either FP emulation or a FP implementation provided by the compiler."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1435311564, "post_id": 31037395, "comment_id": 50158798, "body": "@jmfm: consider using single precision (<code>float</code>) rather than <code>double</code> - this will halve the memory requirement and will probably be a lot faster, especially if you&#39;re using floating point emulation."}, {"owner": {"reputation": 41, "user_id": 4804846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e5f089c0c5ff99135ae6c6b3d07621f?s=128&d=identicon&r=PG&f=1", "display_name": "jmfm", "link": "https://stackoverflow.com/users/4804846/jmfm"}, "edited": false, "score": 0, "creation_date": 1435603653, "post_id": 31037395, "comment_id": 50258936, "body": "Yes, Paul, I tried single precision, but I had the same problem. The only solution I have is using my teensy board."}], "owner": {"reputation": 41, "user_id": 4804846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e5f089c0c5ff99135ae6c6b3d07621f?s=128&d=identicon&r=PG&f=1", "display_name": "jmfm", "link": "https://stackoverflow.com/users/4804846/jmfm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 556, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1435225090, "creation_date": 1435181347, "last_edit_date": 1435225090, "question_id": 31037395, "link": "https://stackoverflow.com/questions/31037395/fft-in-arm-cortex-m0-returns-nan-or-infinite", "title": "FFT in ARM Cortex-M0 returns NaN or infinite", "body": "<p>I'm working with a 32-bit ARM Cortex-M0 RedBearLab nRF51822 and I am trying to develop a function to calculate the FFTs of a signal.</p>\n\n<p>I can get a 256 points FFT of a signal with this function, but when I try the 512 points FFT (or more), it returns infinite values and NaN. However, when I use my function in a 32 bit ARM Cortex-M4 Teensy 3.1, it works perfectly.</p>\n\n<p>Here I show my code:</p>\n\n<pre><code>void fourier_transform(double samples[], const int n, const int isign) {\n    int nn,mmax,m,j,istep,i;\n    float wtemp,wr,wpr,wpi,wi,theta,tempr,tempi;\n    //if (n&lt;2 || n&amp;(n-1)) throw(\"n must be power of 2 in four1\");\n    nn = n &lt;&lt; 1;\n    j = 1;\n\n    for (i=1;i&lt;nn;i+=2) {\n        if (j &gt; i) {\n\n            double a = samples[j-1];\n            samples[j-1] = samples[i-1];\n            samples[i-1] = a;\n            double b = samples[j];\n            samples[j] = samples[i];\n            samples[i] = b;\n            //SWAP(data[j-1],data[i-1]); //ver o que faz\n            //SWAP(data[j],data[i]);\n        }\n        m=n;\n        while (m &gt;= 2 &amp;&amp; j &gt; m) {\n            j -= m;\n            m &gt;&gt;= 1;\n        }\n        j += m;\n    }\n    mmax=2;\n    while (nn &gt; mmax) {\n        istep=mmax &lt;&lt; 1;\n        theta=isign*(6.28318530717959/mmax);\n        wtemp=sin(0.5*theta);\n        wpr = -2.0*wtemp*wtemp;\n        wpi=sin(theta);\n        wr=1.0;\n        wi=0.0;\n        for (m=1;m&lt;mmax;m+=2) {\n            for (i=m;i&lt;=nn;i+=istep) {\n                j=i+mmax;\n                tempr=wr*samples[j-1]-wi*samples[j];\n                tempi=wr*samples[j]+wi*samples[j-1];\n                samples[j-1]=samples[i-1]-tempr;\n                samples[j]=samples[i]-tempi;\n                samples[i-1] += tempr;\n                samples[i] += tempi;\n            }\n            wr=(wtemp=wr)*wpr-wi*wpi+wr;\n            wi=wi*wpr+wtemp*wpi+wi;\n        }\n        mmax=istep;\n    }\n}\n</code></pre>\n\n<p><code>samples[]</code> is the array with my signal and, in the end of FFT, the result is put here. <code>n</code> is the number of points I use to get my FFT.</p>\n"}, {"tags": ["c++", "c", "pointers", "memory", "memcpy"], "comments": [{"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1435180585, "post_id": 31037161, "comment_id": 50098514, "body": "Assuming the types check out, I believe that is valid. Just remember that the first statement won&#39;t typecheck like the second one will, so type errors will slip through if the first statement is used."}, {"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1435180640, "post_id": 31037161, "comment_id": 50098544, "body": "No that&#39;s not the same. <code>memcpy</code> copies the data pointed to by the source pointer to the address pointed to by the destination pointer. <code>ptr</code> will still point to the same address afterwards."}, {"owner": {"reputation": 361, "user_id": 3633538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3f6f9fe20d09b664472ea54a2411047?s=128&d=identicon&r=PG&f=1", "display_name": "Makenbaccon", "link": "https://stackoverflow.com/users/3633538/makenbaccon"}, "reply_to_user": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1435180654, "post_id": 31037161, "comment_id": 50098552, "body": "@SilvioMayolo Maybe that is why it written that way.  I think someone was trying to dodge the type checker."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435181833, "post_id": 31037161, "comment_id": 50099091, "body": "@Makenbaccon: That&#39;s what casts are for. At worst, use pointer casts; they are still much more readable than this crap"}, {"owner": {"reputation": 165655, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1435181927, "post_id": 31037161, "comment_id": 50099125, "body": "They can&#39;t be the same. The first one copies into what <code>ptr</code> points to, the other changes the value of <code>ptr</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 165655, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1435182175, "post_id": 31037161, "comment_id": 50099260, "body": "@DavidSchwartz: It&#39;s actually <code>*(char *)ptr = (char *)&amp;value</code> No idea how <code>double</code> fits into this."}, {"owner": {"reputation": 361, "user_id": 3633538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3f6f9fe20d09b664472ea54a2411047?s=128&d=identicon&r=PG&f=1", "display_name": "Makenbaccon", "link": "https://stackoverflow.com/users/3633538/makenbaccon"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435182266, "post_id": 31037161, "comment_id": 50099301, "body": "@Olaf kind of odd, isn&#39;t it?"}, {"owner": {"reputation": 361, "user_id": 3633538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3f6f9fe20d09b664472ea54a2411047?s=128&d=identicon&r=PG&f=1", "display_name": "Makenbaccon", "link": "https://stackoverflow.com/users/3633538/makenbaccon"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435182403, "post_id": 31037161, "comment_id": 50099363, "body": "@Olaf I guess I need to figure out if he was trying to copy the value of the <code>double</code> into where <code>ptr</code> is pointing, or if he wanted the address of the <code>double</code> copied into <code>ptr</code>.  Whichever he intended, he seemed to do neither."}, {"owner": {"reputation": 61429, "user_id": 572743, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9941673f566f229bc536c1c2b558884e?s=128&d=identicon&r=PG&f=1", "display_name": "Damon", "link": "https://stackoverflow.com/users/572743/damon"}, "edited": false, "score": 0, "creation_date": 1435184639, "post_id": 31037161, "comment_id": 50100271, "body": "sizeof(double) is not guaranteed to be the same as sizeof(char*), insofar saying &quot;Well, you&#39;re not wrong&quot; is wrong. It may work (&quot;work&quot;) but it&#39;s initializing a pointer with a non-safely derived pointer by overwriting the raw bit pattern. In other words, undefined behavior."}], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 3633538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3f6f9fe20d09b664472ea54a2411047?s=128&d=identicon&r=PG&f=1", "display_name": "Makenbaccon", "link": "https://stackoverflow.com/users/3633538/makenbaccon"}, "edited": false, "score": 0, "creation_date": 1435181196, "post_id": 31037216, "comment_id": 50098789, "body": "I&#39;m a little confused by your example.  I&#39;ve made an edit, would you be able to readdress your answer?"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 361, "user_id": 3633538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3f6f9fe20d09b664472ea54a2411047?s=128&d=identicon&r=PG&f=1", "display_name": "Makenbaccon", "link": "https://stackoverflow.com/users/3633538/makenbaccon"}, "edited": false, "score": 0, "creation_date": 1435181258, "post_id": 31037216, "comment_id": 50098816, "body": "@Makenbaccon: I&#39;ve already updated this answer in response to your edit."}, {"owner": {"reputation": 361, "user_id": 3633538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3f6f9fe20d09b664472ea54a2411047?s=128&d=identicon&r=PG&f=1", "display_name": "Makenbaccon", "link": "https://stackoverflow.com/users/3633538/makenbaccon"}, "edited": false, "score": 0, "creation_date": 1435181393, "post_id": 31037216, "comment_id": 50098882, "body": "=) thanks. I&#39;ll respond to your edit: if <code>value</code> is a double, <code>&amp;value</code> is a <code>double *</code>, correct? To be most acurate, it should be <code>sizeof(double *)</code>, correct?"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 361, "user_id": 3633538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3f6f9fe20d09b664472ea54a2411047?s=128&d=identicon&r=PG&f=1", "display_name": "Makenbaccon", "link": "https://stackoverflow.com/users/3633538/makenbaccon"}, "edited": false, "score": 0, "creation_date": 1435182286, "post_id": 31037216, "comment_id": 50099312, "body": "No, that&#39;s incorrect.  If <code>value</code> is <code>double</code>, then <code>&amp;value</code> is <code>double *</code>, and you should <code>memcpy(..., sizeof(double))</code>."}, {"owner": {"reputation": 361, "user_id": 3633538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3f6f9fe20d09b664472ea54a2411047?s=128&d=identicon&r=PG&f=1", "display_name": "Makenbaccon", "link": "https://stackoverflow.com/users/3633538/makenbaccon"}, "edited": false, "score": 0, "creation_date": 1435245362, "post_id": 31037216, "comment_id": 50129888, "body": "It is definitely something more esoteric.  I think whatever value that <code>double</code> is holding isn&#39;t really a <code>double</code>, I think the previous developer just needed a <code>double</code> sized word."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": false, "score": 2, "last_activity_date": 1435181091, "last_edit_date": 1435181091, "creation_date": 1435180633, "answer_id": 31037216, "question_id": 31037161, "link": "https://stackoverflow.com/questions/31037161/using-memcpy-to-assign-a-pointer-an-address/31037216#31037216", "title": "Using `memcpy()` to assign a pointer an address", "body": "<p>No, it is absolutely different.  Let's add some types:</p>\n\n<pre><code>char *addr;\nchar **ptr = &amp;addr;\nchar *value = \"Hello\";\n\nmemcpy(ptr, &amp;value, sizeof(char *));\n// Equivalent to...\n*ptr = value;\n</code></pre>\n\n<p>Better to avoid <code>memcpy()</code> if it is possible to use <code>=</code> instead.</p>\n\n<p>Among other things, if the types are incorrect, then <code>=</code> will generate the proper diagnostics, while <code>memcpy()</code> will happily crash your program or worse.</p>\n\n<p>Given the types,</p>\n\n<pre><code>double value, value2;\nvoid *ptr = &amp;value2;\n\n// This copies `value` into `value2`.\nmemcpy(ptr, &amp;value, sizeof(double));\n</code></pre>\n\n<p>Using <code>sizeof(char *)</code> is wrong, because it should be <code>sizeof(double)</code> if you are copying a <code>double</code>.</p>\n\n<p>Theoretically, you could be doing something more esoteric, but I'll ignore that possibility.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1435181100, "post_id": 31037235, "comment_id": 50098747, "body": "@DietrichEpp: You are right, thanks. I just read <code>&amp;ptr</code>. Updated my answer. (Who writes such crap?)"}, {"owner": {"reputation": 361, "user_id": 3633538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3f6f9fe20d09b664472ea54a2411047?s=128&d=identicon&r=PG&f=1", "display_name": "Makenbaccon", "link": "https://stackoverflow.com/users/3633538/makenbaccon"}, "edited": false, "score": 0, "creation_date": 1435181802, "post_id": 31037235, "comment_id": 50099077, "body": "Ya, I&#39;ve been hired to fix this code.  The problem is that I&#39;ve been told its already working.  I need to determine what he was doing here so I don&#39;t screw it up"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435182062, "post_id": 31037235, "comment_id": 50099201, "body": "Oh, my! I know that. Had such a job myself: &quot;The code is almost complete, just some additions required&quot;. It ended up 1 year work for code which I had rewritten in half the time more clearly and with much less collywobbles. Pro-side: I&#39;m a freelancer - longer safe income :-)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1435187958, "post_id": 31037235, "comment_id": 50101313, "body": "no, it&#39;s like <code>*ptr = value;</code>  . <code>memcpy</code> takes the address of both source and destination. <code>value</code> must have type <code>char *</code> and <code>ptr</code> have type <code>char **</code> (although you could argue that <code>void *</code> would work). There&#39;s no aliasing problem if those were the types (although they aren&#39;t as OP&#39;s edit shows)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1435188413, "post_id": 31037235, "comment_id": 50101425, "body": "@MattMcNabb: You&#39;re right. Just edited. That is apparently more confusing that I thought. Even more reason not to use this. Regarding aliasing: I just remember about some question some days ago :-)"}], "tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": false, "score": 1, "last_activity_date": 1435188744, "last_edit_date": 1435188744, "creation_date": 1435180699, "answer_id": 31037235, "question_id": 31037161, "link": "https://stackoverflow.com/questions/31037161/using-memcpy-to-assign-a-pointer-an-address/31037235#31037235", "title": "Using `memcpy()` to assign a pointer an address", "body": "<p>That <code>memcpy</code> is like</p>\n\n<pre><code>*ptr = value;\n</code></pre>\n\n<p>So <code>ptr</code> has to point to a <code>char *</code> (assuming <code>value</code> is, according to the <code>sizeof</code>). </p>\n\n<p>Assuming <code>ptr</code> is <code>char **</code> (or you change that to take the address of <code>ptr</code>: <code>&amp;ptr</code>) and properly initialized, I see no actual problem <strong>here</strong>. However, this code inhibits type checking by the compiler and is likely slower than a simple assignment.</p>\n\n<p>It also might exhibit problems with aliasing if source and destination have different typs (as the edit implies). It also will likely prohibit optimizations.</p>\n\n<p>Oh, and: that code is more difficult to read/manually verify/understand, IOW: to maintain (as the comments and my own edits show). Maybe the developer was after job safety by obfuscation?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>After your edit adding type information: That code is even worse. It does not even use the same types. My advise: kick the author where it really hurts and then rewrite the code <em>very</em> carefully. Note: whoever write such code, very likely writes more crap elsewhere.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 4966735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ee0c3c455559ffb59bf60516132f7c?s=128&d=identicon&r=PG&f=1", "display_name": "Brockr22", "link": "https://stackoverflow.com/users/4966735/brockr22"}, "is_accepted": false, "score": 0, "last_activity_date": 1435181045, "creation_date": 1435181045, "answer_id": 31037320, "question_id": 31037161, "link": "https://stackoverflow.com/questions/31037161/using-memcpy-to-assign-a-pointer-an-address/31037320#31037320", "title": "Using `memcpy()` to assign a pointer an address", "body": "<p>The assignment notation is much more concise and readable then using memcpy and allows compiler optimization.  The <code>=</code> means an assignment, while memcpy just copies memory.<br>\n<em>You should stick with the <code>=</code> assignment</em></p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1435181436, "post_id": 31037365, "comment_id": 50098902, "body": "&quot;This changes the address of the pointer&quot;? Ehm.. it changes its value."}, {"owner": {"reputation": 361, "user_id": 3633538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3f6f9fe20d09b664472ea54a2411047?s=128&d=identicon&r=PG&f=1", "display_name": "Makenbaccon", "link": "https://stackoverflow.com/users/3633538/makenbaccon"}, "edited": false, "score": 0, "creation_date": 1435181645, "post_id": 31037365, "comment_id": 50099001, "body": "This has been closest to helping me understand; just so that I make sure i get it...<code>memcpy()</code> goes to the address pointed to by <code>ptr</code>, then writes <code>sizeof(char *)</code> bytes from the address pointed to by <code>&amp;value</code> to the address pointed to by <code>ptr</code>, correct?"}, {"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435182404, "post_id": 31037365, "comment_id": 50099364, "body": "@Olaf You&#39;re right, badly phrased - lack of coffee is my excuse."}, {"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "reply_to_user": {"reputation": 361, "user_id": 3633538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3f6f9fe20d09b664472ea54a2411047?s=128&d=identicon&r=PG&f=1", "display_name": "Makenbaccon", "link": "https://stackoverflow.com/users/3633538/makenbaccon"}, "edited": false, "score": 0, "creation_date": 1435182436, "post_id": 31037365, "comment_id": 50099383, "body": "@Makenbaccon Correct. <code>memcpy</code> effectively dereferences both of the pointers you provide - it doesn&#39;t change the pointers themselves."}, {"owner": {"reputation": 361, "user_id": 3633538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3f6f9fe20d09b664472ea54a2411047?s=128&d=identicon&r=PG&f=1", "display_name": "Makenbaccon", "link": "https://stackoverflow.com/users/3633538/makenbaccon"}, "edited": false, "score": 0, "creation_date": 1435182556, "post_id": 31037365, "comment_id": 50099449, "body": "I guess now I need to figure out what the previous developer actually wanted to do...hmmm. Thanks!"}], "tags": [], "owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "is_accepted": true, "score": 2, "last_activity_date": 1435182388, "last_edit_date": 1435182388, "creation_date": 1435181192, "answer_id": 31037365, "question_id": 31037161, "link": "https://stackoverflow.com/questions/31037161/using-memcpy-to-assign-a-pointer-an-address/31037365#31037365", "title": "Using `memcpy()` to assign a pointer an address", "body": "<p>This changes the <strong>address</strong> that the pointer <code>ptr</code> points to:</p>\n\n<pre><code>ptr = &amp;value;\n</code></pre>\n\n<p>This changes the <strong>data</strong> at the address that the pointer <code>ptr</code> points to:</p>\n\n<pre><code>memcpy(ptr, &amp;value, sizeof(char*));\n</code></pre>\n\n<p>In the second case, <code>ptr</code> still points to the same address as before the call. So in no way are they the same.</p>\n"}], "owner": {"reputation": 361, "user_id": 3633538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3f6f9fe20d09b664472ea54a2411047?s=128&d=identicon&r=PG&f=1", "display_name": "Makenbaccon", "link": "https://stackoverflow.com/users/3633538/makenbaccon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6324, "favorite_count": 0, "accepted_answer_id": 31037365, "answer_count": 4, "score": 1, "last_activity_date": 1435188744, "creation_date": 1435180415, "last_edit_date": 1435185047, "question_id": 31037161, "link": "https://stackoverflow.com/questions/31037161/using-memcpy-to-assign-a-pointer-an-address", "title": "Using `memcpy()` to assign a pointer an address", "body": "<p>Is</p>\n\n<pre><code>memcpy( ptr, &amp;value, sizeof(char *) );\n</code></pre>\n\n<p>the same as</p>\n\n<pre><code>ptr = &amp;value;\n</code></pre>\n\n<p>.....</p>\n\n<p>I've never seen <code>memcpy()</code> used to do this before.\nIt seems like I should respond to the developer of this code with the phrase \"Well, you're not wrong.\" It seems like a bit wordier than it needs to be.</p>\n\n<p>Edit: It seems important to note that <code>ptr</code> is <code>void * ptr</code>. <code>value</code> is <code>double value</code>.</p>\n\n<hr>\n\n<p>Edit2: For those who are interested in following this problem down its rabbit hole with me read along.  This bit of code was flagged by static analysis as a potential buffer overflow.  The static analysis was worried that the destination buffer <code>ptr</code> might not have enough space to hold a <code>sizeof(char *)</code> worth of information.<br>\nRather than deal with the problem it gave me I tried to understand exactly what this <code>memcpy()</code> did (thank you for helping me with that).  Once I understood what was happening, I had to understand why the size of memory given to <code>memcpy()</code> was <code>sizeof(char *)</code>; the function this <code>memcpy()</code> is in is called one time, and that one time it looks like this:</p>\n\n<pre><code>SdmJniGetPointer(blah, blah, &amp;ptr)\n</code></pre>\n\n<p>Meaning that the actual value of <code>ptr</code> within this function, and in the <code>memcpy()</code> call, is the address of another pointer!</p>\n\n<p>It was bizzare to me that the previous developer would <code>memcpy()</code> a <code>sizeof(char *)</code> amount of data because this system is compiled on 32 and 64 bit machines.  However, because he passes in the address to a pointer (<code>&amp;ptr</code>) into the function as <code>ptr</code>, he not only circumvents this shifting from 4-byte pointers to 8-byte pointers depending on the system architecture but wields it exactly as he meant too (I think).  In the end, on a 64-bit system, all of the <code>double value</code> is copied into the address pointed to by <code>ptr</code> which is really an address to a different pointer (<code>&amp;ptr</code>), and on 32-bit machines, half of it is copied to the location <code>ptr</code> which is really <code>&amp;ptr</code>.  Now I just need to figure out what that <code>double value</code> really represents, and why he would be ok bisecting it.</p>\n\n<p>If that didn't make sense, I'll try again, but it feels a like he was Inception-ing the pointer. =)</p>\n"}, {"tags": ["mysql", "c"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435186803, "post_id": 31037157, "comment_id": 50100981, "body": "It&#39;s the 5th line in the code you posted."}], "answers": [{"tags": [], "owner": {"reputation": 685, "user_id": 537959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/949c4705ccb19fbf41c98d649b411e66?s=128&d=identicon&r=PG", "display_name": "Oldest Software Guy", "link": "https://stackoverflow.com/users/537959/oldest-software-guy"}, "is_accepted": false, "score": 0, "last_activity_date": 1435241287, "creation_date": 1435241287, "answer_id": 31052760, "question_id": 31037157, "link": "https://stackoverflow.com/questions/31037157/error-message-undefined-symbol-mysql-get-client-info-in-c/31052760#31052760", "title": "Error message &quot;undefined symbol: mysql_get_client_info&quot; in C", "body": "<p>When do you get this message?  Are you linking with the MySQL library?</p>\n"}], "owner": {"reputation": 493, "user_id": 4859805, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/51b284145d41e1cd6943610ae840f6e6?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/4859805/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 383, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435241287, "creation_date": 1435180397, "question_id": 31037157, "link": "https://stackoverflow.com/questions/31037157/error-message-undefined-symbol-mysql-get-client-info-in-c", "title": "Error message &quot;undefined symbol: mysql_get_client_info&quot; in C", "body": "<p>I am attempting to learn C!</p>\n\n<p>I have looked at numerous documentation and tutorials online and I am attempting to get some simple output of the MySQL client version as per <a href=\"http://zetcode.com/db/mysqlc/\" rel=\"nofollow\">this website</a>.</p>\n\n<p>I do not understand however what is causing the below error message that I am receiving:</p>\n\n<blockquote>\n  <p>undefined symbol: mysql_get_client_info</p>\n</blockquote>\n\n<pre><code>#include &lt;mysql/mysql.h&gt;\n\nDLLFUNC int MOD_LOAD(m_sql)(int module_load)\n{\n        sendto_ops(\"MySQL client version: %s\", mysql_get_client_info());\n        return MOD_SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "warnings", "implicit-conversion", "complex-numbers"], "answers": [{"comments": [{"owner": {"reputation": 8973, "user_id": 713961, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/30e8520a25cb0fa4a91acca77059244d?s=128&d=identicon&r=PG", "display_name": "Matt Kline", "link": "https://stackoverflow.com/users/713961/matt-kline"}, "edited": false, "score": 0, "creation_date": 1435181486, "post_id": 31037430, "comment_id": 50098929, "body": "Good to know. Any idea of how to get GCC to warn you that you&#39;re dropping the imaginary component?"}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "reply_to_user": {"reputation": 8973, "user_id": 713961, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/30e8520a25cb0fa4a91acca77059244d?s=128&d=identicon&r=PG", "display_name": "Matt Kline", "link": "https://stackoverflow.com/users/713961/matt-kline"}, "edited": false, "score": 0, "creation_date": 1435182031, "post_id": 31037430, "comment_id": 50099185, "body": "@MattKline: Sadly no, but you could try requesting it: <a href=\"https://gcc.gnu.org/bugzilla/\" rel=\"nofollow noreferrer\">gcc.gnu.org/bugzilla</a>"}, {"owner": {"reputation": 1436, "user_id": 3066972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55ee784dcb5e3afadd6b5cae7949a5f5?s=128&d=identicon&r=PG&f=1", "display_name": "ssnobody", "link": "https://stackoverflow.com/users/3066972/ssnobody"}, "edited": false, "score": 3, "creation_date": 1435182303, "post_id": 31037430, "comment_id": 50099320, "body": "It&#39;s actually already in GCC 6 as per <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=48956\" rel=\"nofollow noreferrer\">gcc.gnu.org/bugzilla/show_bug.cgi?id=48956</a> . Backporting doesn&#39;t look horrible from looking at <a href=\"https://gcc.gnu.org/viewcvs/gcc/trunk/gcc/c-family/c-common.c?r1=223193&amp;r2=223223&amp;pathrev=223223\" rel=\"nofollow noreferrer\">gcc.gnu.org/viewcvs/gcc/trunk/gcc/c-family/&hellip;</a> and <a href=\"https://gcc.gnu.org/viewcvs/gcc/trunk/gcc/c-family/c-common.h?r1=223098&amp;r2=223223&amp;pathrev=223223\" rel=\"nofollow noreferrer\">gcc.gnu.org/viewcvs/gcc/trunk/gcc/c-family/&hellip;</a>"}, {"owner": {"reputation": 274, "user_id": 916967, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f8ed1b2ce4fc4c398413326dfdf6333f?s=128&d=identicon&r=PG", "display_name": "xyzzyz", "link": "https://stackoverflow.com/users/916967/xyzzyz"}, "edited": false, "score": 0, "creation_date": 1436875721, "post_id": 31037430, "comment_id": 50785872, "body": "&quot;In mathematics, when a complex is converted to real, the imaginary part is discarded. C99 follows the same convention.&quot;  This is not true. When such conversion in mathematics is needed, one almost always takes the modulus (sqrt(re^2 + im^2)) instead of real part."}, {"owner": {"reputation": 3478, "user_id": 163349, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e99306628617f8c0aedd3c864d238ee8?s=128&d=identicon&r=PG", "display_name": "David X", "link": "https://stackoverflow.com/users/163349/david-x"}, "reply_to_user": {"reputation": 274, "user_id": 916967, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f8ed1b2ce4fc4c398413326dfdf6333f?s=128&d=identicon&r=PG", "display_name": "xyzzyz", "link": "https://stackoverflow.com/users/916967/xyzzyz"}, "edited": false, "score": 0, "creation_date": 1436915192, "post_id": 31037430, "comment_id": 50810252, "body": "@xyzzyz, well, really, when such conversion is needed, it is done <i>explicitly</i>, such as <code>|z|</code> (the modulus of <code>z</code>); implicit conversions are simply incorrect unless you can prove the &#39;complex&#39; number is <i>already</i> a real."}, {"owner": {"reputation": 274, "user_id": 916967, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f8ed1b2ce4fc4c398413326dfdf6333f?s=128&d=identicon&r=PG", "display_name": "xyzzyz", "link": "https://stackoverflow.com/users/916967/xyzzyz"}, "reply_to_user": {"reputation": 3478, "user_id": 163349, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e99306628617f8c0aedd3c864d238ee8?s=128&d=identicon&r=PG", "display_name": "David X", "link": "https://stackoverflow.com/users/163349/david-x"}, "edited": false, "score": 0, "creation_date": 1437037849, "post_id": 31037430, "comment_id": 50867698, "body": "@DavidX: that&#39;s true. My point is, taking real part of a complex number and discarding imaginary part is pretty unusual, much more often one takes modulus and discards argument."}], "tags": [], "owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "is_accepted": true, "score": 3, "last_activity_date": 1435184535, "last_edit_date": 1435184535, "creation_date": 1435181430, "answer_id": 31037430, "question_id": 31037149, "link": "https://stackoverflow.com/questions/31037149/type-safety-for-complex-arithmetic-in-c99/31037430#31037430", "title": "Type safety for complex arithmetic in C99", "body": "<p>C11 final draft (N1570), 6.3.1.7 paragraph 2:</p>\n\n<blockquote>\n  <p>When a value of complex type is converted to a real type, the imaginary part of the complex value is discarded and the value of the real part is converted according to the conversion rules for the corresponding real type.</p>\n</blockquote>\n\n<p>Real types are integer and real floating types.</p>\n\n<p>The C99 rationale explains the motivation behind this:</p>\n\n<blockquote>\n  <p>In mathematics, when a complex is converted to real, the imaginary part is discarded.  C99 follows the same convention.</p>\n</blockquote>\n\n<p>And (numbering is identical to C11):</p>\n\n<blockquote>\n  <p>The specification in \u00a76.3.1.6 and \u00a76.3.1.7 match Fortran's.</p>\n</blockquote>\n"}], "owner": {"reputation": 8973, "user_id": 713961, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/30e8520a25cb0fa4a91acca77059244d?s=128&d=identicon&r=PG", "display_name": "Matt Kline", "link": "https://stackoverflow.com/users/713961/matt-kline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 1, "accepted_answer_id": 31037430, "answer_count": 1, "score": 1, "last_activity_date": 1435184535, "creation_date": 1435180352, "question_id": 31037149, "link": "https://stackoverflow.com/questions/31037149/type-safety-for-complex-arithmetic-in-c99", "title": "Type safety for complex arithmetic in C99", "body": "<p>I'm using C's complex arithmetic support and ran into some surprising and undesirable behavior. Complex values seem to be implicitly convertible to real ones, discarding the imaginary part.</p>\n\n<p>Consider the following:</p>\n\n<pre><code>#include &lt;complex.h&gt;\n#include &lt;stdio.h&gt;\n\nfloat complex getComplex(float real, float imag)\n{\n    return real + imag * I;\n}\n\nint main()\n{\n    const float /* missing complex! */ c = getComplex(25, 6) / getComplex(2, 4);\n    printf(\"%f + %f J\\n\", crealf(c), cimag(c));\n    return 0;\n}\n</code></pre>\n\n<p>I would expect to receive some warning that I am assigning a <code>float complex</code> to a <code>float</code> or perhaps calling <code>crealf</code> and <code>cimagf</code> on a non-complex value, but this builds cleanly on GCC 5.1, even with <code>-Wall -Wextra -Wconversion</code> switches. Clang 3.6.1 at least emits such a warning:</p>\n\n<pre><code>wut.c:11:62: warning: implicit conversion discards imaginary component: '_Complex float' to 'float'\n      [-Wconversion]\n    const float /* missing complex! */ c = getComplex(25, 6) / getComplex(2, 4);\n                                       ~   ~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>Why can complex values \"collapse\" to real ones? Is there some verbiage about this in the standard? And is there some additional switch for GCC that can provide warnings about this behavior? It has already bitten us, and switching toolchains (to clang) for this project isn't feasible at present time.</p>\n"}, {"tags": ["c", "random", "primes", "modular-arithmetic"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1435186274, "post_id": 31037094, "comment_id": 50100815, "body": "Look at the assembler output of the sgined operations.  You will generally see Logical Shifts to the Left, but Arithmetic Shifts to the Right with signed values.  Other bitwise operators should behave the same.  The ASL operator will preserve the sign bits when shifting downwards."}, {"owner": {"reputation": 267, "user_id": 421121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f5cae45131f9e2adb2a6a19462e9b7?s=128&d=identicon&r=PG", "display_name": "Sue", "link": "https://stackoverflow.com/users/421121/sue"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1435189845, "post_id": 31037094, "comment_id": 50101793, "body": "Thanks. The first attempt was signed and therefore added to the confusion. The second solution used unsigned and revealed the real problem."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1435203611, "post_id": 31037094, "comment_id": 50104901, "body": "<code>uint64_t x1 = (uint64_t ) ((hi + lo) );</code>  Hmmm  maybe <code>uint64_t x1 = (uint64_t ) hi + lo;</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1435203785, "post_id": 31037094, "comment_id": 50104956, "body": "Minor: <code>r |= 1 &lt;&lt; i;</code> --&gt; <code>r |= (uint32_t)1 &lt;&lt; i;</code>  (Cope with 16-bit <code>int</code>. and signed overflow.)"}, {"owner": {"reputation": 267, "user_id": 421121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f5cae45131f9e2adb2a6a19462e9b7?s=128&d=identicon&r=PG", "display_name": "Sue", "link": "https://stackoverflow.com/users/421121/sue"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1435204939, "post_id": 31037094, "comment_id": 50105231, "body": "@chux. Thanks for catching these errors!"}, {"owner": {"reputation": 267, "user_id": 421121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f5cae45131f9e2adb2a6a19462e9b7?s=128&d=identicon&r=PG", "display_name": "Sue", "link": "https://stackoverflow.com/users/421121/sue"}, "edited": false, "score": 0, "creation_date": 1435205137, "post_id": 31037094, "comment_id": 50105279, "body": "<code>r |=1</code> part just creates the modulus <code>r = m = 2147483647</code>. Hard coding this eliminates the issue."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 1, "creation_date": 1435210812, "post_id": 31037094, "comment_id": 50107005, "body": "It would be nicer to remove the solution from the question, post it as an answer (what it is !) and accept it. Currently, the question appears as a not answered one."}], "answers": [{"tags": [], "owner": {"reputation": 28567, "user_id": 815724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a514cd424088a3ba3012f5d77f2e334?s=128&d=identicon&r=PG", "display_name": "Peter O.", "link": "https://stackoverflow.com/users/815724/peter-o"}, "is_accepted": false, "score": 1, "last_activity_date": 1435227956, "creation_date": 1435227956, "answer_id": 31047691, "question_id": 31037094, "link": "https://stackoverflow.com/questions/31037094/fast-modular-multiplication-modulo-prime-for-linear-congruential-generator-in-c/31047691#31047691", "title": "Fast modular multiplication modulo prime for linear congruential generator in C", "body": "<p>Sue provided this as a solution:</p>\n\n<blockquote>\n  <p>With some experimentation (new code at the bottom), I was able to use\n  <code>uint32_t</code>, which further suggests that I do not understand how the\n  signed integers work with bit operations. </p>\n  \n  <p>The following code uses <code>uint32_t</code> for input as well as <code>hi</code> and <code>lo</code>.</p>\n\n<pre><code> #include &lt;inttypes.h&gt;\n  // x1 = a*x0 (mod 2^31-1)\n uint32_t lgc_m(uint32_t a, uint32_t x)\n  {\n    printf(\"x %\"PRId32\"\\n\", x);\n    if (x == 2147483647){\n    printf(\"x1 %\"PRId64\"\\n\", 0); \n        return (0);\n    }\n    uint64_t  c, r = 1;\n    c = (uint64_t)a * (uint64_t)x;\n    if (c &lt; 2147483647){\n        printf(\"x1 %\"PRId64\"\\n\", c); \n        return (c);\n    }\n    uint32_t hi=0, lo=0;\n    int i, p = 31;//2^31-1\n    for (i = 1; i &lt; p; ++i){\n       r |= 1 &lt;&lt; i;\n    }\n   hi = c &gt;&gt; p;\n   lo = (c &amp; r) ;\n   uint64_t x1 = (uint64_t ) ((hi + lo) );\n   // NOT SURE ABOUT THE NEXT STATEMENT\n   if (x1 &gt; r){\n       printf(\"x1 - r = %\"PRId64\"\\n\", x1- r);\n           x1 -= r; \n   }\n   printf(\"c %\"PRId64\"\\n\", c);\n   printf(\"r %\"PRId64\"\\n\", r);\n   printf(\"\\tlo %\"PRId32\"\\n\", lo);\n   printf(\"\\thi %\"PRId32\"\\n\", hi);\n   printf(\"x1 %\"PRId64\"\\n\", x1); \n   printf(\"\\n\" );\n   return((uint32_t) x1);\n  }\n\n  int main(void)\n {\n    uint32_t r;\n    r = lgc_m(1583458089, 1583458089);\n    r = lgc_m(1583458089, 2147483645);\n    return(0);\n  }\n</code></pre>\n  \n  <p>The issue was that my assumption that the reduction will be complete\n  after one pass. If (x > 2<sup>31</sup>-1), then by definition the\n  reduction has not occurred and a second pass is necessary. Subtracting\n  2<sup>31</sup>-1, in that case does the trick. In the second attempt\n  above, <code>r = 2^31-1</code> and is therefore the modulus. <code>x -= r</code> achieves\n  the final reduction. </p>\n  \n  <p>Perhaps someone with expertise in random numbers or modular reduction\n  could explain it better.</p>\n  \n  <p>Cleaned function without <code>printf()</code>s.</p>\n\n<pre><code>uint32_t lgc_m(uint32_t a, uint32_t x){\n    uint64_t c, x1, m = 2147483647; //modulus: m = 2^31-1\n    if (x == m)\n        return (0);\n    c = (uint64_t)a * (uint64_t)x;\n    if (c &lt; m)//no reduction necessary\n        return (c);\n    uint32_t hi, lo, p = 31;//2^p-1, p = 31 \n    hi = c &gt;&gt; p;\n    lo = c &amp; m;\n    x1 = (uint64_t)(hi + lo);\n    if (x1 &gt; m){//one more pass needed \n       //this block can be replaced by x1 -= m;\n        hi = x1 &gt;&gt; p;\n        lo = (x1 &amp; m);\n        x1 = (uint64_t)(hi + lo);\n    }\n   return((uint32_t) x1);\n}\n</code></pre>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 267, "user_id": 421121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f5cae45131f9e2adb2a6a19462e9b7?s=128&d=identicon&r=PG", "display_name": "Sue", "link": "https://stackoverflow.com/users/421121/sue"}, "edited": false, "score": 0, "creation_date": 1435241679, "post_id": 31048634, "comment_id": 50126814, "body": "Thanks. Even though, the code &#39;worked&#39; I did not really understand what was going on.  Your answer addresses all points of confusion."}], "tags": [], "owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "is_accepted": true, "score": 2, "last_activity_date": 1435231744, "last_edit_date": 1435231744, "creation_date": 1435230452, "answer_id": 31048634, "question_id": 31037094, "link": "https://stackoverflow.com/questions/31037094/fast-modular-multiplication-modulo-prime-for-linear-congruential-generator-in-c/31048634#31048634", "title": "Fast modular multiplication modulo prime for linear congruential generator in C", "body": "<p>The following if statement</p>\n\n<pre><code>if (x1 &gt; r)\n    x1 += r + 2;\n</code></pre>\n\n<p>should be written as</p>\n\n<pre><code>if (x1 &gt; r)\n    x1 -= r;\n</code></pre>\n\n<p>Both results are the same modulo 2^31:</p>\n\n<pre><code>x1 + r + 2 = x1 + 2^31 - 1 + 2 = x1 + 2^31 + 1\nx1 - r = x1 - (2^31 - 1) = x1 - 2^31 + 1\n</code></pre>\n\n<p>The first solution overflows an <code>int32_t</code> and assumes that conversion from <code>uint64_t</code> to <code>int32_t</code> is modulo 2^31. While many C compilers handle the conversion this way, this is not mandated by the C standard. The actual result is implementation-defined.</p>\n\n<p>The second solution avoids the overflow and works with both <code>int32_t</code> and <code>uint32_t</code>.</p>\n\n<p>You can also use an integer constant for <code>r</code>:</p>\n\n<pre><code>uint64_t r = 0x7FFFFFFF; // 2^31 - 1\n</code></pre>\n\n<p>Or simply</p>\n\n<pre><code>uint64_t r = INT32_MAX;\n</code></pre>\n\n<p><strong>EDIT:</strong> For primes of the form 2^p-k, you have to use masks with p bits and calculate the result with</p>\n\n<pre><code>uint32_t x1 = (k * hi + lo) % ((1 &lt;&lt; p) - k)\n</code></pre>\n\n<p>If <code>k * hi + lo</code> can overflow a <code>uint32_t</code> (that is <code>(k + 1) * (2^p - 1) &gt;= 2^32</code>), you have to use 64-bit arithmetic:</p>\n\n<pre><code>uint32_t x1 = ((uint64_t)a * x) % ((1 &lt;&lt; p) - k)\n</code></pre>\n\n<p>Depending on the platform, the latter might be faster anyway.</p>\n"}], "owner": {"reputation": 267, "user_id": 421121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f5cae45131f9e2adb2a6a19462e9b7?s=128&d=identicon&r=PG", "display_name": "Sue", "link": "https://stackoverflow.com/users/421121/sue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 2, "accepted_answer_id": 31048634, "answer_count": 2, "score": 6, "last_activity_date": 1435231744, "creation_date": 1435180204, "last_edit_date": 1435227814, "question_id": 31037094, "link": "https://stackoverflow.com/questions/31037094/fast-modular-multiplication-modulo-prime-for-linear-congruential-generator-in-c", "title": "Fast modular multiplication modulo prime for linear congruential generator in C", "body": "<p>I am trying to implement a random-number generator with Mersenne prime (2<sup>31</sup>-1) as the modulus. The following working code was based on several related posts:</p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/8011700/how-do-I-extract-specific-n-bits-of-a-32-bit-unsigned-integer-in-c\">How do I extract specific &#39;n&#39; bits of a 32-bit unsigned integer in C?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/7914637/fast-multiplication-and-subtraction-modulo-a-prime\">Fast multiplication and subtraction modulo a prime</a></li>\n<li><a href=\"https://stackoverflow.com/questions/28939351/fast-multiplication-modulo-216-1\">Fast multiplication modulo 2^16 + 1</a></li>\n</ol>\n\n<p>However, </p>\n\n<p>It does not work with <code>uint32_t hi, lo;</code>, which means I do not understand signed vs. unsigned aspect of the problem. </p>\n\n<p>Based on #2 above, I was expecting the answer to be (hi+lo). Which means, I do not understand why the following statement is needed.</p>\n\n<pre><code>   if (x1 &gt; r)\n        x1 += r + 2; \n</code></pre>\n\n<ul>\n<li><p>Can someone please clarify the source of my confusion? </p></li>\n<li><p>Can the code itself be improved? </p></li>\n<li><p>Should the generator avoid 0 or 2<sup>31</sup>-1 as a seed? </p></li>\n<li><p>How would the code change for a prime (2<sup>p</sup>-k)? </p></li>\n</ul>\n\n<h3>Original code</h3>\n\n<pre><code>#include &lt;inttypes.h&gt;\n// x1 = a*x0 (mod 2^31-1)\nint32_t lgc_m(int32_t a, int32_t x)\n{\n    printf(\"x %\"PRId32\"\\n\", x);\n    if (x == 2147483647){\n    printf(\"x1 %\"PRId64\"\\n\", 0); \n        return (0);\n    }\n    uint64_t  c, r = 1;\n    c = (uint64_t)a * (uint64_t)x;\n    if (c &lt; 2147483647){\n        printf(\"x1 %\"PRId64\"\\n\", c); \n        return (c);\n    }\n    int32_t hi=0, lo=0;\n    int i, p = 31;//2^31-1\n    for (i = 1; i &lt; p; ++i){\n       r |= 1 &lt;&lt; i;\n    }\n   lo = (c &amp; r) ;\n   hi = (c &amp; ~r) &gt;&gt; p;\n   uint64_t x1 = (uint64_t ) (hi + lo);\n   // NOT SURE ABOUT THE NEXT STATEMENT\n   if (x1 &gt; r)\n        x1 += r + 2; \n   printf(\"c %\"PRId64\"\\n\", c);\n   printf(\"r %\"PRId64\"\\n\", r);\n   printf(\"\\tlo %\"PRId32\"\\n\", lo);\n   printf(\"\\thi %\"PRId32\"\\n\", hi);\n   printf(\"x1 %\"PRId64\"\\n\", x1); \n   printf(\"\\n\" );\n   return((int32_t) x1);\n}\n\nint main(void)\n{\n    int32_t r;\n    r = lgc_m(1583458089, 1);\n    r = lgc_m(1583458089, 2000000000);\n    r = lgc_m(1583458089, 2147483646);\n    r = lgc_m(1583458089, 2147483647);\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "stack", "heap"], "comments": [{"owner": {"reputation": 1342, "user_id": 4780877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lg9ru.jpg?s=128&g=1", "display_name": "Emacs User", "link": "https://stackoverflow.com/users/4780877/emacs-user"}, "edited": false, "score": 0, "creation_date": 1435179262, "post_id": 31036787, "comment_id": 50097818, "body": "The very best practice is to implement both options with flexibility to switch between implementations based on memory, computation speeds, and other load conditions."}, {"owner": {"reputation": 314, "user_id": 5029813, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/5c89a34e553b0a7544b09b68124d67de?s=128&d=identicon&r=PG&f=1", "display_name": "99ProblemsAndTheyreAllCode", "link": "https://stackoverflow.com/users/5029813/99problemsandtheyreallcode"}, "reply_to_user": {"reputation": 1342, "user_id": 4780877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lg9ru.jpg?s=128&g=1", "display_name": "Emacs User", "link": "https://stackoverflow.com/users/4780877/emacs-user"}, "edited": false, "score": 0, "creation_date": 1435179348, "post_id": 31036787, "comment_id": 50097856, "body": "@EmacsUser the application will be run server-side with generous allocation for memory/cpus."}, {"owner": {"reputation": 314, "user_id": 5029813, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/5c89a34e553b0a7544b09b68124d67de?s=128&d=identicon&r=PG&f=1", "display_name": "99ProblemsAndTheyreAllCode", "link": "https://stackoverflow.com/users/5029813/99problemsandtheyreallcode"}, "reply_to_user": {"reputation": 1342, "user_id": 4780877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lg9ru.jpg?s=128&g=1", "display_name": "Emacs User", "link": "https://stackoverflow.com/users/4780877/emacs-user"}, "edited": false, "score": 0, "creation_date": 1435179653, "post_id": 31036787, "comment_id": 50098021, "body": "@EmacsUser it feels wrong due to obfuscation of the end goal, it feels messy to include all the data globally. I know the global implementation will most likely be faster, but there is no separation of concerns"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435180085, "post_id": 31036787, "comment_id": 50098243, "body": "Would that not be &quot;C wrapped in <code>extern &quot;C&quot;</code>&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 2929, "user_id": 5031373, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8eb5ce3a29a47c2fde92470b1f1c714c?s=128&d=identicon&r=PG&f=1", "display_name": "jpyams", "link": "https://stackoverflow.com/users/5031373/jpyams"}, "is_accepted": false, "score": 0, "last_activity_date": 1435179698, "creation_date": 1435179698, "answer_id": 31036957, "question_id": 31036787, "link": "https://stackoverflow.com/questions/31036787/deciding-between-datastore-and-global-variables/31036957#31036957", "title": "Deciding between datastore and global variables", "body": "<p>For speed reasons and code clarity staticly define these variables.  Lay out your definitions nicely and comment generously to help future viewers of your code.  In a file, you can't comment to inform future editors what everything is.  It's just slower.</p>\n"}, {"tags": [], "owner": {"reputation": 1342, "user_id": 4780877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lg9ru.jpg?s=128&g=1", "display_name": "Emacs User", "link": "https://stackoverflow.com/users/4780877/emacs-user"}, "is_accepted": false, "score": 0, "last_activity_date": 1435179947, "creation_date": 1435179947, "answer_id": 31037029, "question_id": 31036787, "link": "https://stackoverflow.com/questions/31036787/deciding-between-datastore-and-global-variables/31037029#31037029", "title": "Deciding between datastore and global variables", "body": "<p>The very best practice is to implement both options with flexibility to switch between implementations based on memory, computation speeds, and other load conditions.</p>\n\n<p>If the application will be run server-side with generous allocation for memory/cpu, then design to those conditions. Why \"feel wrong\" as you put it?</p>\n\n<p>Your end goal is not clearly defined. So obfuscation is not an issue yet. Obfuscation comes when you willfully redirect your coding to hide your tracks. But making a complete solution, if that is what is needed, is not obfuscation. </p>\n"}, {"comments": [{"owner": {"reputation": 314, "user_id": 5029813, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/5c89a34e553b0a7544b09b68124d67de?s=128&d=identicon&r=PG&f=1", "display_name": "99ProblemsAndTheyreAllCode", "link": "https://stackoverflow.com/users/5029813/99problemsandtheyreallcode"}, "edited": false, "score": 0, "creation_date": 1435180615, "post_id": 31037137, "comment_id": 50098533, "body": "Good solution, easy to update with the ability to remove the overhead of reading a datastore everytime. Thank you"}], "tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": true, "score": 2, "last_activity_date": 1435180323, "creation_date": 1435180323, "answer_id": 31037137, "question_id": 31036787, "link": "https://stackoverflow.com/questions/31036787/deciding-between-datastore-and-global-variables/31037137#31037137", "title": "Deciding between datastore and global variables", "body": "<p>It might be appropriate to generate a seperate C file from the CSV using a high level language, e.g. Python. Then either <code>#include</code> the generated file (only if used in a single module using <code>static</code>), or as a seperate compilation unit.</p>\n\n<p>That way you can easily change the values in the CSV/spreadsheet program of your choice, while still having all data available. The code generating program can be called by the build system, so no manual fiddling.</p>\n"}], "owner": {"reputation": 314, "user_id": 5029813, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/5c89a34e553b0a7544b09b68124d67de?s=128&d=identicon&r=PG&f=1", "display_name": "99ProblemsAndTheyreAllCode", "link": "https://stackoverflow.com/users/5029813/99problemsandtheyreallcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 31037137, "answer_count": 3, "score": 0, "last_activity_date": 1447613063, "creation_date": 1435179034, "last_edit_date": 1447613063, "question_id": 31036787, "link": "https://stackoverflow.com/questions/31036787/deciding-between-datastore-and-global-variables", "title": "Deciding between datastore and global variables", "body": "<p><strong>Description</strong></p>\n\n<p>For a hybrid C/C++ (C++ wrapped in extern \"C\") application I'm writing I am trying to decide if it is better for me to include some static definitions my program needs to run as global variables or in an external datastore that needs to be read in every time it is run (i.e. a .csv file or sql database).</p>\n\n<p>My static definitions, when laid out in a csv file, take appx 15 columns each with a maximum of 40 definitions (less than that to begin, but up to 40 due to feature scaling).</p>\n\n<p><strong>Problem</strong></p>\n\n<p>I'm torn because it feels wrong to me to include so much data as global variables that get loaded with the program at compile time. However, the overhead of reading from a datastore every time I run the program after compiling seems unnecessary. </p>\n\n<p><strong>Question</strong></p>\n\n<p>What are the best practices here? My code needs to be portable enough for someone else to understand and I do not want to obfuscate it.</p>\n"}, {"tags": ["c", "linux", "linux-device-driver", "embedded-linux"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1435179612, "post_id": 31036661, "comment_id": 50097994, "body": "Your embedded device runs without a host OS? (in that case there will be no /dev/ttySx, and certainly not a device driver supporting that device node)"}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 1, "creation_date": 1435191306, "post_id": 31036661, "comment_id": 50102155, "body": "You probably should not be writing any kernel <i>&quot;drivers&quot;</i> for this serial device.  The kernel executes in a privileged CPU mode, and should not be compromised with unnecessary functionality that belongs in userspace.  You (should) want your code to be portable, and that means keep it userspace, where APIs are stable.  Also you seem confused as to what a &quot;RS232 device driver&quot; does.  The driver should only transfer data; it works at the physical layer. It should not examine or process the data in any way (that&#39;s for the data-link or line-discipline layer)."}, {"owner": {"reputation": 3076, "user_id": 2112731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c0cd41c5afcd4701fbb21ca081bcb0c?s=128&d=identicon&r=PG", "display_name": "DoxyLover", "link": "https://stackoverflow.com/users/2112731/doxylover"}, "edited": false, "score": 0, "creation_date": 1435358172, "post_id": 31036661, "comment_id": 50184383, "body": "If you have /dev/ttyS*, then you <b>already</b> have a device driver for the UART."}, {"owner": {"reputation": 31, "user_id": 5046164, "user_type": "registered", "profile_image": "https://graph.facebook.com/1102128279801895/picture?type=large", "display_name": "Aaron Redepenning", "link": "https://stackoverflow.com/users/5046164/aaron-redepenning"}, "edited": false, "score": 0, "creation_date": 1435598690, "post_id": 31036661, "comment_id": 50256283, "body": "I understand that there is already a UART driver however this does not solve my problem. I want to write a kernel module for a specific device that communicates thru RS232. I want know if there is a way to use the existing serial driver, serial.h (not the tty driver which is what /dev/ttyS* refers to), and &quot;layer&quot; my driver above it so that I can use its functionality rather that rewriting a serial driver myself. Is this possible to do, if so, how?"}], "answers": [{"tags": [], "owner": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "is_accepted": false, "score": 2, "last_activity_date": 1435182345, "creation_date": 1435182345, "answer_id": 31037654, "question_id": 31036661, "link": "https://stackoverflow.com/questions/31036661/linux-device-driver-for-a-rs232-device-in-embedded-system/31037654#31037654", "title": "Linux device driver for a RS232 device in embedded system", "body": "<p>There are a few times when a module that communicates over a serial port may be in the kernel.  The pppd (point to point protocol daemon) is one example as Linux has some kernel code devoted to that since it is a high traffic use of serial and it also needs to turn around and put the IP packets into kernel space.</p>\n\n<p>Most other uses would work better from user space since you have a good API that already takes care of a lot of the errors that can happen.  This also lessens the chance that your errors will result in massive system failure.</p>\n\n<p>Doing things like this from user space does result in some latency.  Reads and writes are buffered, and it's often difficult to tell where in the write operations the hardware actually is, and canceling an already succeeded write call isn't really doable from user space, even if the hardware hasn't yet received the bytes.</p>\n\n<p>I would suggest attempting to do it from user space first and then move to OS driver if necessary.  Even if it is necessary to move this into an OS level driver, you'll likely be able to get some progress made from user space.</p>\n"}], "owner": {"reputation": 31, "user_id": 5046164, "user_type": "registered", "profile_image": "https://graph.facebook.com/1102128279801895/picture?type=large", "display_name": "Aaron Redepenning", "link": "https://stackoverflow.com/users/5046164/aaron-redepenning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1516, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1435182345, "creation_date": 1435178694, "last_edit_date": 1435179037, "question_id": 31036661, "link": "https://stackoverflow.com/questions/31036661/linux-device-driver-for-a-rs232-device-in-embedded-system", "title": "Linux device driver for a RS232 device in embedded system", "body": "<p>I have recently started learning to write Linux device drivers for a specific project that I am working on. Previously most of the work I have done has been with devices running no OS so Linux drivers and development is somewhat new to me.\nFor the project I am working on I have an embedded system running a Linux based operating system. I have an external device with is controlled via RS232 that I need to write a driver for. </p>\n\n<p>Questions:</p>\n\n<p>1) Is there a way to access serial ports from withing kernel space (and possibly use serial.h, serial_core.h, etc.), how is this usually done, any good examples?</p>\n\n<p>2) From what I found it seems like it would be much easier to access the serial ports in user space by just opening dev/ttyS* and writing to it. When writing a driver for a device like this (RS232 device) is it preferred to do it in user space or is there a way to write a kernel module? How does one decide to write a driver as a kernel module over user space or vise versa?</p>\n\n<p>Are drivers only for generic devices such as UART/serial and then above that is userspace or should this driver be written as a kernel module? I appreciate the help, I have been unable to find much information to answer my questions.</p>\n"}, {"tags": ["c", "linked-list"], "answers": [{"tags": [], "owner": {"reputation": 1079, "user_id": 4472848, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bc7b33199a0a5e067e1a33265cf88d1?s=128&d=identicon&r=PG", "display_name": "Wouter Verhelst", "link": "https://stackoverflow.com/users/4472848/wouter-verhelst"}, "is_accepted": false, "score": 4, "last_activity_date": 1435177805, "creation_date": 1435177805, "answer_id": 31036416, "question_id": 31036325, "link": "https://stackoverflow.com/questions/31036325/adding-items-to-linked-list-and-allocing-space/31036416#31036416", "title": "adding items to Linked List and allocing space", "body": "<p>Because you don't modify <code>*DataHead</code> in your <code>addDataNode</code> function; you only read from it. You have two options: either drop the <code>current</code> variable and use <code>*DataHead</code> instead (throughout), or call <code>*DataHead = current</code> before returning.</p>\n\n<p>Also, the <code>strcpy</code> is wrong. You want <code>strdup</code> instead, otherwise you into undefined memory.</p>\n"}, {"tags": [], "owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": false, "score": 1, "last_activity_date": 1435177813, "creation_date": 1435177813, "answer_id": 31036419, "question_id": 31036325, "link": "https://stackoverflow.com/questions/31036325/adding-items-to-linked-list-and-allocing-space/31036419#31036419", "title": "adding items to Linked List and allocing space", "body": "<p>You never do anything with <code>DataHead</code> in your function, except copy what is in it into <code>current</code>, so what it <em>points to</em> (if it pointed to anything) might change, the pointer in <code>DataHead</code> itself will not.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 2, "last_activity_date": 1435179244, "last_edit_date": 1435179244, "creation_date": 1435178796, "answer_id": 31036710, "question_id": 31036325, "link": "https://stackoverflow.com/questions/31036325/adding-items-to-linked-list-and-allocing-space/31036710#31036710", "title": "adding items to Linked List and allocing space", "body": "<p>The reason of the problem is that the function <code>addDataNode</code> is too complicated and as result it is difficult to see whether it sets DataHead in all its paths.:)</p>\n\n<p>And indeed this was forgotten to be done in this code snippet of the function</p>\n\n<pre><code>if(current == NULL){\n    current = temp;\n    current-&gt;nextData = NULL;\n    strcpy(current-&gt;data, data);\n}else{\n</code></pre>\n\n<p>I suggest to rewrite the function the following way</p>\n\n<pre><code>void addDataNode( struct DataNode **DataHead, const char *data )\n{\n    struct DataNode *temp = malloc( sizeof( struct DataNode ) );\n\n    if ( temp )\n    {\n        const size_t n = sizeof( temp-&gt;data );\n\n        temo-&gt;nextData = NULL;\n        strncpy( temp-&gt;data, data, n );\n        temp-&gt;data[n-1] = '\\0'; \n\n        if ( *DataHead == NULL )\n        { \n            *DataHead = temp;\n        }\n        else\n        {\n            struct DataNode *current = *DataHead;\n\n            while ( current-&gt;nextData ) current = current-&gt;nextData;\n\n            current-&gt;nextData = temp;\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 897931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a442a58794e25ec25122916b2b16f61e?s=128&d=identicon&r=PG", "display_name": "MarkM", "link": "https://stackoverflow.com/users/897931/markm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 31036710, "answer_count": 3, "score": 0, "last_activity_date": 1435179244, "creation_date": 1435177532, "last_edit_date": 1435177758, "question_id": 31036325, "link": "https://stackoverflow.com/questions/31036325/adding-items-to-linked-list-and-allocing-space", "title": "adding items to Linked List and allocing space", "body": "<p>Here is a node for use in a linked list.</p>\n\n<pre><code>struct DataNode\n{\n    char data[3];\n    struct DataNode *nextData;\n};\n</code></pre>\n\n<p>and I have a function here:</p>\n\n<pre><code>void addDataNode(struct DataNode **DataHead, char *data)\n{\n    struct DataNode *temp = (struct DataNode*)(malloc(sizeof(struct DataNode)));\n    struct DataNode *current = *DataHead;\n    if(current == NULL){\n        current = temp;\n        current-&gt;nextData = NULL;\n        strcpy(current-&gt;data, data);\n    }else{\n        while(current-&gt;nextData != NULL){\n            current = current-&gt;nextData;\n        }\n        current-&gt;nextData = temp;\n        strcpy(current-&gt;nextData-&gt;data, data);\n    }\n}\n</code></pre>\n\n<p>In my main, I have </p>\n\n<pre><code>struct DataNode *DataHead = NULL;\n</code></pre>\n\n<p>So I call the function with </p>\n\n<pre><code>char test[] = \"Qu\";\naddDataNode(&amp;DataHead, test);\n</code></pre>\n\n<p>However, outside of the function, DataHead stays NULL. Why is this?</p>\n"}, {"tags": ["c", "linux", "file", "format"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435177760, "post_id": 31036177, "comment_id": 50097020, "body": "I&#39;m voting to close, as too broad for SO - sorry, try a different site!"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1435178238, "post_id": 31036177, "comment_id": 50097292, "body": "@Olaf: I would vote to keep: this is a very practical real-world sort of question that comes up all the time.  Just because it doesn&#39;t have a single cut-and-dried answer doesn&#39;t mean it doesn&#39;t deserve consideration.  (With that said, though, I am not a SO regular, so if the consensus is that there are certain swaths of practical, real-world programming questions that this site is <i>not</i> for, I&#39;m in no position to argue.)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1435178404, "post_id": 31036177, "comment_id": 50097394, "body": "@SteveSummit: I do agree actually in that the question is in fact interesting (mind my &quot;sorry&quot;). However, it is off-topic for SO. I really hope the OP finds another site (not sure, if there is one on stack exchange). For the vote: well, that is clearly <i>my</i> opinion. If others think different, it <i>will</i> stay open. I can live with that."}, {"owner": {"reputation": 52445, "user_id": 1253222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3a62746fb04e19c1656cd1df560911f?s=128&d=identicon&r=PG", "display_name": "twalberg", "link": "https://stackoverflow.com/users/1253222/twalberg"}, "edited": false, "score": 1, "creation_date": 1435180589, "post_id": 31036177, "comment_id": 50098516, "body": "&quot;without terminating null to save space&quot;... Really? A terminating NULL byte is a single byte per string. Your alternative is to store a length, which could be a single byte, but that would limit strings to 256 bytes or less. More usefully, the length would be multiple bytes, which actually uses more space than a terminating NULL..."}, {"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "edited": false, "score": 1, "creation_date": 1435181679, "post_id": 31036177, "comment_id": 50099015, "body": "FYI, <a href=\"http://stackoverflow.com/questions/1577161/passing-a-structure-through-sockets-in-c\" title=\"passing a structure through sockets in c\">stackoverflow.com/questions/1577161/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 324, "user_id": 1450181, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9728f30af2a464351625916c5ea0b89f?s=128&d=identicon&r=PG", "display_name": "clockley1", "link": "https://stackoverflow.com/users/1450181/clockley1"}, "edited": false, "score": 0, "creation_date": 1435177949, "post_id": 31036380, "comment_id": 50097128, "body": "Would implement get16() with pointer arithmetic on a mmap ed buffer?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 324, "user_id": 1450181, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9728f30af2a464351625916c5ea0b89f?s=128&d=identicon&r=PG", "display_name": "clockley1", "link": "https://stackoverflow.com/users/1450181/clockley1"}, "edited": false, "score": 0, "creation_date": 1435179005, "post_id": 31036380, "comment_id": 50097680, "body": "See? You actually <i>did</i> vote;-) Note @user1450181: you definitively should add error-handling, catching <code>EOF</code>/error for buth directions! Also both note: <code>getc()</code> returns <code>int</code>. casting to <code>unsigned</code> is implementation defined_ for negative values."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435238152, "post_id": 31036380, "comment_id": 50123890, "body": "@Olaf: yes, there are definitely plenty of subtleties here when it comes to signed vs. unsigned variables.  (Thanks, too, for the reminder about EOF and error handling.)  But although <code>getc</code> is indeed declared as returning signed ints, the only negative value it will ever return is <code>EOF</code>; all of its normal character returns are guaranteed to be positive."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435240001, "post_id": 31036380, "comment_id": 50125363, "body": "@SteveSummit: That&#39;s why I would fir st use <code>int</code>, check for <code>EOF</code>, then cast to <code>unsigned char</code> and upcast to another unsigned as required. Not very elegant, but that should be safe then. (It will like not create more program code, however). (I&#39;m glad not to be bound to the stdlib functions)."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435241608, "post_id": 31036380, "comment_id": 50126769, "body": "@Olaf: Actually, this is one of the few places where I will sometimes choose <i>not</i> to do exhaustive, call-by-call error checking.  Just call <code>getc</code> 2 or 4 or 8 or however many times, then check <code>feof</code> and <code>ferror</code> at the very end."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435241893, "post_id": 31036380, "comment_id": 50126990, "body": "Ok, agree. I was not sure if <code>getc()</code> is allowed to be called after EOF was already reached (it is, according to the standard)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435242194, "post_id": 31036380, "comment_id": 50127254, "body": "It is important to note, that <code>feof</code> does not check the stream, but only the <code>EOF</code> flag of the stream. That&#39;s why it actually works here; otherwise you could not be sure if the last read value is valid or not."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1435251264, "post_id": 31036380, "comment_id": 50133826, "body": "The <code>putc()&#47;getc()</code> has many advantages concerning portability.  +1 for showing that.  Note that <code>EOF</code> may be returned on an error - a rare event - I deal with serial communication a lot - where it is not so rare.  The next <code>getc()</code>  might not be an <code>EOF</code>. <code>ferror()&#47;feof()</code> helps there.  certainly this is beyond OP&#39;s needs."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 7, "last_activity_date": 1435242285, "last_edit_date": 1435242285, "creation_date": 1435177695, "answer_id": 31036380, "question_id": 31036177, "link": "https://stackoverflow.com/questions/31036177/how-to-handle-portability-issues-in-a-binary-file-format/31036380#31036380", "title": "How to handle portability issues in a binary file format", "body": "<p>i. Defining the file to be in one order and converting to and from \"internal\" order, if necessary, when reading/writing (perhaps with ntohl and the like) is, in my opinion, the best approach.</p>\n\n<p>ii. I do not trust packed structures.  They might work for this approach for those platforms, but there are no guarantees.</p>\n\n<p>iii. Reading and writing binary files using fread and fwrite on whole structs is (again in my opinion) an inherently weak approach.  You maximize the likelihood that you will be bitten by word size problems, padding and alignment problems, and byte order problems.</p>\n\n<p>What I like to do is write little functions like get16() and put32() that read and write a byte at a time and so are inherently insensitive to word size and byte order difficulties.  Then I write straightforward putHeader and getRecord functions (and the like) in terms of these.</p>\n\n<pre><code>unsigned int get16(FILE *fp)\n{\n    unsigned int r;\n    r = getc(fp);\n    r = (r &lt;&lt; 8) | getc(fp);\n    return r;\n}\n\nvoid put32(unsigned long int x, FILE *fp)\n{\n    putc((int)((x &gt;&gt; 24) &amp; 0xff), fp);\n    putc((int)((x &gt;&gt; 16) &amp; 0xff), fp);\n    putc((int)((x &gt;&gt; 8) &amp; 0xff), fp);\n    putc((int)(x &amp; 0xff), fp);\n}\n</code></pre>\n\n<p>[P.S. As @Olaf correctly points out in one of the comments, in production code you'd need handling for EOF and error in these functions.  I've left those out for simplicity of presentation.]</p>\n"}], "owner": {"reputation": 324, "user_id": 1450181, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9728f30af2a464351625916c5ea0b89f?s=128&d=identicon&r=PG", "display_name": "clockley1", "link": "https://stackoverflow.com/users/1450181/clockley1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 1, "accepted_answer_id": 31036380, "answer_count": 1, "score": 5, "last_activity_date": 1435242285, "creation_date": 1435177111, "question_id": 31036177, "link": "https://stackoverflow.com/questions/31036177/how-to-handle-portability-issues-in-a-binary-file-format", "title": "How to handle portability issues in a binary file format", "body": "<p>I'm designing a binary file format to store strings[without terminating null to save space] and binary data.</p>\n\n<p>i. What is the best way to deal with little/big endian systems?\ni.a Would converting everything to network byte order and back with ntohl()/htonl() work?</p>\n\n<p>ii. Will the packed structures be the same size on x86, x64 and arm?</p>\n\n<p>iii. Are their any inherent weakness with this approach?</p>\n\n<pre><code>struct __attribute__((packed)) Header {\n    uint8_t magic;\n    uint8_t flags;\n};\n\nstruct __attribute__((packed)) Record {\n    uint64_t length;\n    uint32_t crc;\n    uint16_t year;\n    uint8_t day;\n    uint8_t month;\n    uint8_t hour;\n    uint8_t minute;\n    uint8_t second;\n    uint8_t type;\n};\n</code></pre>\n\n<p>Tester code I'm using the develop the format:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;strings.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;string.h&gt;\n\nstruct __attribute__((packed)) Header {\n    uint8_t magic;\n    uint8_t flags;\n};\n\nstruct __attribute__((packed)) Record {\n    uint64_t length;\n    uint32_t crc;\n    uint16_t year;\n    uint8_t day;\n    uint8_t month;\n    uint8_t hour;\n    uint8_t minute;\n    uint8_t second;\n    uint8_t type;\n};\n\n    int main(void)\n    {\n\n        int fd = open(\"test.dat\", O_RDWR|O_APPEND|O_CREAT, 444);\n        struct Header header = {1, 0};\n        write(fd, &amp;header, sizeof(header));\n        char msg[] = {\"BINARY\"};\n        struct Record record = {strlen(msg), 0, 0, 0, 0, 0, 0, 0};\n        write(fd, &amp;record, sizeof(record));\n        write(fd, msg, record.length);\n        close(fd);\n        fd = open(\"test.dat\", O_RDWR|O_APPEND|O_CREAT, 444);\n\n\n        read(fd, &amp;header, sizeof(struct Header));\n        read(fd, &amp;record, sizeof(struct Record));\n        int len = record.length;\n        char c;\n        while (len != 0) {\n            read(fd, &amp;c, 1);\n            len--;\n            printf(\"%c\", c);\n        }\n        close(fd);\n    }\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "edited": false, "score": 0, "creation_date": 1435230719, "post_id": 31043392, "comment_id": 50118675, "body": "then why there is no need of parenthesis around j?"}], "tags": [], "owner": {"reputation": 1318, "user_id": 2949875, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/d815e7f286bb5e485b3602e09595d1f5?s=128&d=identicon&r=PG&f=1", "display_name": "kamil.rak", "link": "https://stackoverflow.com/users/2949875/kamil-rak"}, "is_accepted": false, "score": 0, "last_activity_date": 1435215756, "creation_date": 1435215756, "answer_id": 31043392, "question_id": 31036124, "link": "https://stackoverflow.com/questions/31036124/why-does-parenthesis-needed-for-assignment-in-second-part-of-conditional-operato/31043392#31043392", "title": "why does parenthesis needed for assignment in second part of conditional operator in c", "body": "<p>Imho: basically your problem is that is C the termary operator has higher priority than \"=\" (in c++ the prioriy is equal, so it works as expected) and that is the reason you need the parenthesis.</p>\n"}], "owner": {"reputation": 643, "user_id": 5046220, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6703018e7d190e03c461a2ea5c162b6?s=128&d=identicon&r=PG&f=1", "display_name": "supriya", "link": "https://stackoverflow.com/users/5046220/supriya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "closed_date": 1485725029, "answer_count": 1, "score": -2, "last_activity_date": 1474474511, "creation_date": 1435176923, "last_edit_date": 1474474511, "question_id": 31036124, "link": "https://stackoverflow.com/questions/31036124/why-does-parenthesis-needed-for-assignment-in-second-part-of-conditional-operato", "closed_reason": "Duplicate", "title": "why does parenthesis needed for assignment in second part of conditional operator in c", "body": "<p>The code below</p>\n\n<pre><code>i&gt;0?j=9:i=7;\n</code></pre>\n\n<p>Is giving an error:</p>\n\n<blockquote>\n  <p>lvalue required as left operand of assignment</p>\n</blockquote>\n\n<p>Can you explain this why I am getting this error?\nwhen, <code>i&gt;0?j=9:(i=7);</code> is working correctly</p>\n"}, {"tags": ["c", "string", "pointers"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1435176735, "post_id": 31036058, "comment_id": 50096462, "body": "This <code>ptr=&amp;str[0];</code> is the same as <code>ptr = str;</code>. Also, <b>DO NOT USE <code>gets()</code></b>."}, {"owner": {"reputation": 722, "user_id": 4753084, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/0Jp83.jpg?s=128&g=1", "display_name": "Prince Vijay Pratap", "link": "https://stackoverflow.com/users/4753084/prince-vijay-pratap"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1435176869, "post_id": 31036058, "comment_id": 50096528, "body": "I know that, it just keep things simple"}, {"owner": {"reputation": 5413, "user_id": 1743849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5cwvZ.jpg?s=128&g=1", "display_name": "rakeb.mazharul", "link": "https://stackoverflow.com/users/1743849/rakeb-mazharul"}, "edited": false, "score": 0, "creation_date": 1435176945, "post_id": 31036058, "comment_id": 50096575, "body": "do not use <code>gets()</code>, can buffer overflow."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1435177133, "post_id": 31036058, "comment_id": 50096689, "body": "<code>fgets(str, sizeof(str), stdin)</code> looks very simple to me., and <code>ptr = str;</code> is certainly simpler."}], "answers": [{"comments": [{"owner": {"reputation": 722, "user_id": 4753084, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/0Jp83.jpg?s=128&g=1", "display_name": "Prince Vijay Pratap", "link": "https://stackoverflow.com/users/4753084/prince-vijay-pratap"}, "edited": false, "score": 0, "creation_date": 1435177707, "post_id": 31036305, "comment_id": 50096994, "body": "yeah u r right about first condtion in for loop.  thanks!"}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 1, "last_activity_date": 1435177479, "creation_date": 1435177479, "answer_id": 31036305, "question_id": 31036058, "link": "https://stackoverflow.com/questions/31036058/removing-spaces-from-string-using-pointers/31036305#31036305", "title": "Removing spaces from string using pointers", "body": "<p>There are two problems</p>\n\n<ol>\n<li><p>In this line</p>\n\n<pre><code>for(ptr1 = ++ptr ; *ptr1 != '\\0' ; ptr1++)\n</code></pre>\n\n<p>because you increment <code>ptr</code> and hence both <code>ptr1</code> and <code>ptr</code> point to the same place after that, so you are effectively copying the characters to the same place, instead <code>ptr1</code> should point to <code>ptr + 1</code> while <code>ptr</code> should not be modified.</p></li>\n<li><p>You also start at the beggining of the string after \"<em>moving</em>\" all the charaters from the right one place to the left, here</p>\n\n<pre><code>ptr = &amp;str[0];\n</code></pre>\n\n<p>right after the loop that moves the characters, you should save the previous position and point to it instead, that would be more efficient.</p></li>\n</ol>\n\n<p>I've fixed your code and the following code works</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main()\n{\n    char  str[100];\n    char *ptr;    \n\n    printf(\"Enter the string = \");\n    fgets(str, sizeof(str), stdin);\n\n    ptr = str;\n    while (*ptr != '\\0')\n    {\n        char *save;         \n        save = ptr;\n        if (*ptr == ' ')\n        {\n            char *next;\n            for (next = ptr + 1 ; *next != '\\0' ; next++, ptr++)\n                *ptr = *next;\n            ptr = save;\n        }\n        ptr++;\n    }    \n    printf(\"Modified string = %s\\n\", str);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1435181779, "post_id": 31037134, "comment_id": 50099067, "body": "Nice - I was hoping to see  an O(n) rather than O(n*n) solution..  Minor: code could use <code>do { while ( isspace( *rd ) ) rd++;  } while ((*wr++ = *rd++) != &#39;\\0&#39;);</code>, yet your code looks easier to understand."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1435182313, "post_id": 31037134, "comment_id": 50099326, "body": "@chux - yeah, that&#39;s definitely slicker and more in the spirit of C than my version.  I could pretend I was writing for clarity, but in truth I just didn&#39;t spend too much time thinking about it."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1435189999, "post_id": 31037134, "comment_id": 50101841, "body": "Your original version will continue past the null terminator if the initial string ends with a space, because <code>rd</code> will advance up to the null terminator while skipping spaces in the inner <code>while</code> loop, then past it on the following line."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 4, "last_activity_date": 1435182725, "last_edit_date": 1435182725, "creation_date": 1435180318, "answer_id": 31037134, "question_id": 31036058, "link": "https://stackoverflow.com/questions/31036058/removing-spaces-from-string-using-pointers/31037134#31037134", "title": "Removing spaces from string using pointers", "body": "<p>iharob identified your problem and gave a good solution, but I'd like to show you a slightly different approach.  </p>\n\n<pre><code>char *rd; // \"read\" pointer\nchar *wr; // \"write\" pointer\n\nrd = wr = string; // initially, both read and write pointers point to\n                  // beginning of the string\n\nwhile ( *rd != 0 ) // while not at end of string\n{\n  while ( isspace( *rd ) ) // while rd points to a whitespace character\n    rd++;                  // advance rd\n  *wr++ = *rd++;           // copy *rd to *wr, advance both pointers\n}\n*wr = 0;                   // terminate the result\n\nprintf( \"squished: %s\\n\", string );\n</code></pre>\n\n<p>Walking through this with the test string <code>\"This    is a   test\"</code>, we start out as follows (<code>\\0</code> represents the string terminator):<pre><code>+----------------------- rd\n|\nV\nThis    is a   test\\0\n^\n|\n+----------------------- wr\n</code></pre></p>\n\n<p>The first four characters aren't whitespace, so we just overwrite those characters with the same values and advance the two pointers, giving us</p>\n\n<pre><code>    +------------------- rd\n    |\n    V\nThis    is a   test\\0\n    ^\n    |\n    +------------------- wr\n</code></pre>\n\n<p>Since <code>rd</code> is pointing to whitespace, we continue to advance it until we find a non-whitespace character:</p>\n\n<pre><code>        +--------------- rd\n        |\n        V\nThis    is a   test\\0\n    ^\n    |\n    +------------------- wr\n</code></pre>\n\n<p>We then write that non-whitespace character to the location pointed to by <code>wr</code>:</p>\n\n<pre><code>        +--------------- rd\n        |\n        V\nThisi   is a   test\\0\n    ^\n    |\n    +------------------- wr\n</code></pre>\n\n<p>Keep this up until we find the next whitespace character:</p>\n\n<pre><code>          +------------- rd\n          |\n          V\nThisis  is a   test\\0\n      ^\n      |\n      +----------------- wr\n</code></pre>\n\n<p>Continue to advance <code>rd</code> to the next non-whitespace character:</p>\n\n<pre><code>           +------------ rd\n           |\n           V\nThisis  is a   test\\0\n      ^\n      |\n      +----------------- wr\n</code></pre>\n\n<p>Write it to <code>wr</code>:</p>\n\n<pre><code>           +------------ rd\n           |\n           V\nThisisa is a   test\\0\n      ^\n      |\n      +----------------- wr\n</code></pre>\n\n<p>Lather, rinse, repeat:</p>\n\n<pre><code>                   +---- rd\n                   |\n                   V\nThisisatesta   test\\0\n           ^\n           |\n           +------------ wr\n</code></pre>\n\n<p><code>rd</code> now points to the end of the string.  We exit the main loop and write a <code>0</code> to <code>wr</code> to terminate the string:</p>\n\n<pre><code>                   +---- rd\n                   |\n                   V\nThisisatest\\0  test\\0\n           ^\n           |\n           +------------ wr\n</code></pre>\n\n<p>I prefer this solution since each character only gets shifted once to its final location.  You wind up overwriting characters that you don't need to at the beginning of the string, but I think that's a reasonable tradeoff.  </p>\n\n<p><strong>Edit</strong></p>\n\n<p>Chux's version is a bit slicker, and definitely more in the spirit of C:</p>\n\n<pre><code>do\n{\n  while ( isspace( *rd ) )  // while rd points to whitespace\n    rd++;                   // advance rd\n}\nwhile ( (*wr++ = *rd++) );  // copy rd to wr, advance pointers until\n                            // we see the string terminator\n</code></pre>\n\n<p>Again, each character only gets shifted once to its final location.  </p>\n"}], "owner": {"reputation": 722, "user_id": 4753084, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/0Jp83.jpg?s=128&g=1", "display_name": "Prince Vijay Pratap", "link": "https://stackoverflow.com/users/4753084/prince-vijay-pratap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1559, "favorite_count": 0, "accepted_answer_id": 31036305, "answer_count": 2, "score": 2, "last_activity_date": 1547464283, "creation_date": 1435176658, "question_id": 31036058, "link": "https://stackoverflow.com/questions/31036058/removing-spaces-from-string-using-pointers", "title": "Removing spaces from string using pointers", "body": "<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n    unsigned int n=0;\n    char str[100];\n    char *ptr,*ptr1;    \n    printf(\"Enter the string = \");\n    gets(str);\n    ptr = &amp;str[0];\n    while(*ptr!='\\0')\n    {\n        n++;ptr++;\n    }\n    ptr=&amp;str[0];\n    while(*ptr!='\\0')\n    {\n        if(*ptr==' ')\n        {\n            n--;\n            for(ptr1=++ptr;*ptr1!='\\0';ptr1++)\n            {\n                *ptr=*ptr1;\n                 ptr++;\n            }   \n            ptr=&amp;str[0];    \n        }\n        ptr++;\n    }\n    printf(\"Modified string = \");\n    for(int i=0;i&lt;n;i++)\n    {\n        printf(\"%c\",str[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I know the other way of removing spaces from string but i want to do this using pointers but i cant get what is wrong with this code?</p>\n\n<p>I really appreciate some little help.</p>\n"}, {"tags": ["c", "node.js", "arduino", "hardware", "interactive"], "comments": [{"owner": {"reputation": 1809, "user_id": 951784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9858b1ffedc039e48a0ed219198d538c?s=128&d=identicon&r=PG", "display_name": "rost0031", "link": "https://stackoverflow.com/users/951784/rost0031"}, "edited": false, "score": 0, "creation_date": 1435175574, "post_id": 31035707, "comment_id": 50095784, "body": "You should probably start by playing around with simple hardware prototypes and try and make them do simple things.  Just &quot;hello world&quot; type programs just to get familiar with how to do simple stuff.  Then break the project down into smaller testable pieces.  Implement the pieces and the tests.  Repeat until complete."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1435175843, "post_id": 31035707, "comment_id": 50095968, "body": "When you are done, don&#39;t forget to clear the buffer where the passcode was entered. My colleague made one, and was crest-fallen when I opened the safe just by pressing &quot;Enter&quot;."}, {"owner": {"reputation": 1, "user_id": 5000611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e39382c3189f37321165debb7ad503?s=128&d=identicon&r=PG&f=1", "display_name": "smur232", "link": "https://stackoverflow.com/users/5000611/smur232"}, "reply_to_user": {"reputation": 1809, "user_id": 951784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9858b1ffedc039e48a0ed219198d538c?s=128&d=identicon&r=PG", "display_name": "rost0031", "link": "https://stackoverflow.com/users/951784/rost0031"}, "edited": false, "score": 0, "creation_date": 1435256713, "post_id": 31035707, "comment_id": 50137004, "body": "I agree, thank you for the suggestion @rost0031 :)"}, {"owner": {"reputation": 1, "user_id": 5000611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e39382c3189f37321165debb7ad503?s=128&d=identicon&r=PG&f=1", "display_name": "smur232", "link": "https://stackoverflow.com/users/5000611/smur232"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1435256756, "post_id": 31035707, "comment_id": 50137023, "body": "Thank you for the tip! I am sure that&#39;ll be really helpful :) @WeatherVane"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5000611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e39382c3189f37321165debb7ad503?s=128&d=identicon&r=PG&f=1", "display_name": "smur232", "link": "https://stackoverflow.com/users/5000611/smur232"}, "edited": false, "score": 0, "creation_date": 1435256815, "post_id": 31050828, "comment_id": 50137059, "body": "I see! Thank you, these are some great questions to get me started :) @frarugi87"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 1, "user_id": 5000611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e39382c3189f37321165debb7ad503?s=128&d=identicon&r=PG&f=1", "display_name": "smur232", "link": "https://stackoverflow.com/users/5000611/smur232"}, "edited": false, "score": 1, "creation_date": 1435257701, "post_id": 31050828, "comment_id": 50137611, "body": "@Sarah, frarugi87 makes the software sound easy, but there is a big difference between &quot;code that works&quot; and &quot;robust industrial code&quot;. For one example, suppose the owner types in 3 of the 4 digits but the phone rings, and then forgets about the safe? That would need a timeout to reset the passcode entry, otherwise it would leave the safe very unsafe, having a 1 in 10 chance of a single digit opening it."}, {"owner": {"reputation": 1, "user_id": 5000611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e39382c3189f37321165debb7ad503?s=128&d=identicon&r=PG&f=1", "display_name": "smur232", "link": "https://stackoverflow.com/users/5000611/smur232"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1435353991, "post_id": 31050828, "comment_id": 50183113, "body": "@WeatherVane Yup, I see what you mean, there are quite a lot of cases that I would need to consider. Would you say that a good place to begin would be to do some work with Arduino and a keypad in Java? Thanks!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 1, "user_id": 5000611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e39382c3189f37321165debb7ad503?s=128&d=identicon&r=PG&f=1", "display_name": "smur232", "link": "https://stackoverflow.com/users/5000611/smur232"}, "edited": false, "score": 0, "creation_date": 1435359369, "post_id": 31050828, "comment_id": 50184688, "body": "@Sarah I only have enough experience of java to know it suits high-level applications whereas C is good for low level engineering. If you plan to use Arduino (I haven&#39;t) I can only recommend following the path of least resistance, that is to begin with the simplest and most accessible tools on offer."}], "tags": [], "owner": {"reputation": 2636, "user_id": 3368201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c46939557e63148d8c8cfa3b14d9e2f?s=128&d=identicon&r=PG&f=1", "display_name": "frarugi87", "link": "https://stackoverflow.com/users/3368201/frarugi87"}, "is_accepted": false, "score": 0, "last_activity_date": 1435236389, "creation_date": 1435236389, "answer_id": 31050828, "question_id": 31035707, "link": "https://stackoverflow.com/questions/31035707/how-to-get-started-on-creating-a-safe-that-will-open-and-close-upon-entering-a-p/31050828#31050828", "title": "How to get started on creating a safe that will open and close upon entering a passcode into it?", "body": "<p>I made one with a keypad (not connected to other devices, but it's similar). And, according to my experience, the mechanical part is the worst: designing and building the safe (I used plexiglass) was the worst thing.</p>\n\n<p>As for your questions, I think that yes, you should start with the hardware design. Or at least choose</p>\n\n<ol>\n<li>how are ou closing/opening the door? I used a stepper motor, but there are tons of choices - door locks, servomotors, dc motors.....</li>\n<li>how are you detecting if it is open or closed?</li>\n<li>what will be the interface? You spoke about iPad, so I suppose you want some bluetooth apple-enabled devices.</li>\n</ol>\n\n<p>Then you will be able to start coding. But the code will be really simple once you got what the hardware will look like (in the end, it's just \"wait for the correct passcode, then open the safe, then close it again\").</p>\n"}], "owner": {"reputation": 1, "user_id": 5000611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e39382c3189f37321165debb7ad503?s=128&d=identicon&r=PG&f=1", "display_name": "smur232", "link": "https://stackoverflow.com/users/5000611/smur232"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435236389, "creation_date": 1435175404, "question_id": 31035707, "link": "https://stackoverflow.com/questions/31035707/how-to-get-started-on-creating-a-safe-that-will-open-and-close-upon-entering-a-p", "title": "How to get started on creating a safe that will open and close upon entering a passcode into it?", "body": "<p>I want to work on a project dealing with some hardware things but I have no knowledge in this area and I would really appreciate some help with getting started.</p>\n\n<p>I am programming in Node.js so I have had a look at NodeBots and Arduino; however, I am not sure if this is the right place to even start. </p>\n\n<p>The main thing I want to be able to do is:</p>\n\n<ul>\n<li>create a safe where it will open when I enter the correct passcode into an iPad or some touch screen</li>\n<li>be able to set the passcode</li>\n</ul>\n\n<p>When working on such a project, do I need the hardware first? (If so, what are some things I should get?)\nSecondly, where can I start coding and what are good languages for this? (I am unsure as to which aspect of this project I should focus on first)</p>\n"}, {"tags": ["c", "data-structures", "linked-list"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 3, "creation_date": 1435175084, "post_id": 31035570, "comment_id": 50095488, "body": "Yes you can use same function (if written correctly) to create any number of list."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1435175603, "post_id": 31035570, "comment_id": 50095805, "body": "<code>ll</code> is a very bad name for anything. It can read as <code>11</code> (eleven) or <code>II</code> (eye-eye). Or any combination of these."}], "answers": [{"tags": [], "owner": {"reputation": 2929, "user_id": 5031373, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8eb5ce3a29a47c2fde92470b1f1c714c?s=128&d=identicon&r=PG&f=1", "display_name": "jpyams", "link": "https://stackoverflow.com/users/5031373/jpyams"}, "is_accepted": true, "score": 1, "last_activity_date": 1435177003, "last_edit_date": 1435177003, "creation_date": 1435175297, "answer_id": 31035678, "question_id": 31035570, "link": "https://stackoverflow.com/questions/31035570/create-two-linked-lists-using-one-function/31035678#31035678", "title": "Create two linked lists using one function", "body": "<p>Instead of passing an int you could also just pass the linked list.</p>\n\n<pre><code>Node head1;\nNode head2;\nNode previous1;\nNode previous2;\n\nint main(){\n    ll(&amp;head1, &amp;previous1);\n    ll(&amp;head2, &amp;previous2);\n}\n\nint ll(Node* head, Node* previous)\n{\n    int data = 0;\n    scanf(\"%d\",&amp;data);\n    *head = {data, null};\n    previous = head;\n\n    while(1)\n    {\n        printf(\"Enter data, -1 to stop : \");\n        scanf(\"%d\",&amp;data);\n\n        if(data == -1)\n            break;\n\n        addtoll(data, previous);\n    }\n}\n\nint addtoll(int data, Node* previous)\n{\n    struct student newNode = {data, null}\n    previous-&gt;link = &amp;newNode;\n    previous = &amp;newNode;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28036, "user_id": 4826457, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXT0U.jpg?s=128&g=1", "display_name": "Suraj Rao", "link": "https://stackoverflow.com/users/4826457/suraj-rao"}, "edited": false, "score": 3, "creation_date": 1527919196, "post_id": 50653959, "comment_id": 88318314, "body": "<a href=\"//meta.stackoverflow.com/q/285551\">Please don&#39;t post your code as an image.</a>"}], "tags": [], "owner": {"reputation": 1, "user_id": 9829780, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z1cHWhQp8-w/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmEg_T-djuZCDsEiy4iMyftTMyWnw/s96-c/photo.jpg?sz=128", "display_name": "Umar", "link": "https://stackoverflow.com/users/9829780/umar"}, "is_accepted": false, "score": -1, "last_activity_date": 1527918895, "creation_date": 1527918895, "answer_id": 50653959, "question_id": 31035570, "link": "https://stackoverflow.com/questions/31035570/create-two-linked-lists-using-one-function/50653959#50653959", "title": "Create two linked lists using one function", "body": "<p><a href=\"https://i.stack.imgur.com/O0tCX.png\" rel=\"nofollow noreferrer\">Exceutable Code to implement more than 1 Linked List by appending new node one by one.</a></p>\n"}], "owner": {"reputation": 1457, "user_id": 3969791, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d262f941bed054849bb2f7182dbf9685?s=128&d=identicon&r=PG&f=1", "display_name": "IAMTubby", "link": "https://stackoverflow.com/users/3969791/iamtubby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3922, "favorite_count": 0, "accepted_answer_id": 31035678, "answer_count": 2, "score": 0, "last_activity_date": 1527919558, "creation_date": 1435174898, "last_edit_date": 1527919558, "question_id": 31035570, "link": "https://stackoverflow.com/questions/31035570/create-two-linked-lists-using-one-function", "title": "Create two linked lists using one function", "body": "<p>I have a function called ll() for creating a linked list as follows. My program requires two linked lists. Is it possible to reuse this function so I can have two linked lists, say head1 and head2?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;malloc.h&gt;\n\ntypedef struct node\n{\n    int data;\n    struct node* link;\n} Node;\n\nNode* head = NULL;\nNode* previous = NULL;\n\nint main(void)\n{\n    ll();\n\n    print();\n\n    return 0;\n}\n\nint ll()\n{\n    int data = 0;\n    while(1)\n    {\n        printf(\"Enter data, -1 to stop: \");\n        scanf(\"%d\", &amp;data);\n\n        if(data == -1)\n            break;\n\n        addtoll(data);\n    }\n}\n\nint addtoll(int data)\n{\n    Node* ptr = NULL;\n\n    ptr = (Node*)malloc(sizeof(Node));\n    ptr-&gt;data = data;\n    ptr-&gt;link = NULL;\n\n    if(head == NULL)\n        head = ptr;\n    else\n        previous-&gt;link = ptr;\n\n    previous = ptr;\n}\n\nint print()\n{\n    printf(\"Printing linked list contents: \");\n    Node* ptr = head;\n\n    while(ptr)\n    {\n        printf(\"%d \", ptr-&gt;data);\n        ptr = ptr-&gt;link;\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>Is there a better way than doing something like</p>\n\n<pre><code>main()\n{\n    ll(1);\n    ll(2);\n}\n\nint ll(int serial)\n{\n    if (serial == 1)\n        Use head1 everywhere in this function\n    else if(serial == 2)\n        Use head2 everywhere in this function\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "debugging", "gdb"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4764841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c27f91dc84a22df5c6e90a145ce4631?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Lavoie", "link": "https://stackoverflow.com/users/4764841/bruce-lavoie"}, "edited": false, "score": 1, "creation_date": 1435244955, "post_id": 31035158, "comment_id": 50129534, "body": "As it turns out, when debugger the remote target after issuing a &quot;target remote localhost:3333&quot;  I needed to issue a &quot;load&quot; to load the image to the target because I&#39;m not running gdbserver on the target.  After the load, it worked fine."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 3, "last_activity_date": 1435173560, "creation_date": 1435173560, "answer_id": 31035158, "question_id": 31035124, "link": "https://stackoverflow.com/questions/31035124/gdb-can-not-locate-source-files/31035158#31035158", "title": "GDB can not locate source files", "body": "<p>Read section about <a href=\"https://sourceware.org/gdb/onlinedocs/gdb/Source-Path.html\" rel=\"nofollow\">source path in GDB</a>. You need to use the <code>dir</code>  command inside <code>(gdb)</code>  command. prompt.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4764841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c27f91dc84a22df5c6e90a145ce4631?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Lavoie", "link": "https://stackoverflow.com/users/4764841/bruce-lavoie"}, "is_accepted": false, "score": 1, "last_activity_date": 1435245001, "creation_date": 1435245001, "answer_id": 31054184, "question_id": 31035124, "link": "https://stackoverflow.com/questions/31035124/gdb-can-not-locate-source-files/31054184#31054184", "title": "GDB can not locate source files", "body": "<p>As it turns out, when debugger the remote target after issuing a \"target remote localhost:3333\" I needed to issue a \"load\" to load the image to the target because I'm not running gdbserver on the target. After the load, it worked fine. \u2013  Bruce Lavoie just now</p>\n"}], "owner": {"reputation": 11, "user_id": 4764841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c27f91dc84a22df5c6e90a145ce4631?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Lavoie", "link": "https://stackoverflow.com/users/4764841/bruce-lavoie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3455, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1582975749, "creation_date": 1435173438, "last_edit_date": 1582975749, "question_id": 31035124, "link": "https://stackoverflow.com/questions/31035124/gdb-can-not-locate-source-files", "title": "GDB can not locate source files", "body": "<p>I'm using GDB with the \"Open On-Chip Debugger\" project to debug a cross compiled project for remote MIPs target and for some reason GDB can't locate the source files.</p>\n\n<p>Here I invoke GDB on the target elf file.</p>\n\n<pre><code>development@ubuntu:~/vitessesdk/CEServices/build$ mipsel-vtss-elf-gdb obj/CEServices.elf\nGNU gdb (crosstool-NG 1.20.0 - vtss-eCos-toolchain-v2) 7.8\nCopyright (C) 2014 Free Software Foundation, Inc.\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"--host=x86_64-build_unknown-linux-gnu --target=mipsel-vtss-elf\".\nType \"show configuration\" for configuration details.\nFor bug reporting instructions, please see:\nFind the GDB manual and other documentation resources online at:\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\"...\n****Reading symbols from obj/CEServices.elf...done.****\n(gdb)\n</code></pre>\n\n<p>At this point I type in the target remote command to connect</p>\n\n<pre><code>(gdb) target remote localhost:3333\nRemote debugging using localhost:3333\n0xa0000000 in ?? ()\n(gdb) step\n</code></pre>\n\n<p>Cannot find bounds of current function</p>\n\n<pre><code>(gdb) list\n78  /home/development/vitesseSDK/CEServices/build/../third_party/eCos/packages/language/c/libc/startup/current/src/main.cxx: No such file or directory.\n(gdb) \n</code></pre>\n\n<p>I'll a listing of the directory and the file is there.</p>\n\n<pre><code>development@ubuntu:~/vitessesdk/CEServices/build$ ls ../third_party/eCos/packages/language/c/libc/startup/current/src/main.cxx\n../third_party/eCos/packages/language/c/libc/startup/current/src/main.cxx\ndevelopment@ubuntu:~/vitessesdk/CEServices/build$\n</code></pre>\n\n<p>Any ideas as to why this is happening?</p>\n"}, {"tags": ["c", "linux", "libc"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1435173234, "post_id": 31034993, "comment_id": 50094479, "body": "Then what would be the point of <b>environment variables</b>???????"}, {"owner": {"reputation": 1171, "user_id": 3015723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Qki0h.jpg?s=128&g=1", "display_name": "Snappawapa", "link": "https://stackoverflow.com/users/3015723/snappawapa"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1435173236, "post_id": 31034993, "comment_id": 50094480, "body": "this looks correct to me. you define <code>FOO</code> before you run the program, so therefore it is accessible. @iharob there are many uses, just kind of specific to the program running."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1435173443, "post_id": 31034993, "comment_id": 50094582, "body": "These variables have the purpose of being present in any program that runs on a given environment, you can however create a process with clean environment, but the point of using environment variables is that they are accessible from within a child process by any child process, so the shell of course creates the new process with a copy of it&#39;s own <b>environment</b>."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1435174718, "post_id": 31034993, "comment_id": 50095278, "body": "Exactly which C library implementation are you quoting here?"}, {"owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1435174811, "post_id": 31034993, "comment_id": 50095326, "body": "@zwol <a href=\"http://www.gnu.org/software/libc/download.html\" rel=\"nofollow noreferrer\">glibc</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "is_accepted": false, "score": 1, "last_activity_date": 1435173239, "creation_date": 1435173239, "answer_id": 31035062, "question_id": 31034993, "link": "https://stackoverflow.com/questions/31034993/how-does-a-program-inherit-environment-variables/31035062#31035062", "title": "How does a program inherit environment variables?", "body": "<p>The father process that calls your program (your shell) defines FOO. The newly created process receives a copy from the parent.</p>\n"}, {"comments": [{"owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "edited": false, "score": 0, "creation_date": 1435173943, "post_id": 31035182, "comment_id": 50094838, "body": "I did not know about <code>strace</code> this is pretty useful."}, {"owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "edited": false, "score": 0, "creation_date": 1435175621, "post_id": 31035182, "comment_id": 50095816, "body": "Can you detail your sentence: <code>When you execute a dynamically linked binary, the very first userspace code doing anything comes from the loader.</code>. Is the loader part of the executable?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1435176957, "post_id": 31035182, "comment_id": 50096589, "body": "The interesting fact here is that when the loader is called (at the entry point you indicate in your link), the stack in the newly-created memory image already has argc, argv and env pushed onto it. These must have been previously copied from the memory space in which exec() was invoked to the memory space created for the new executable, and that must have been done by the OS since only it has access to both memory spaces at the same time."}, {"owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "edited": false, "score": 0, "creation_date": 1435192014, "post_id": 31035182, "comment_id": 50102330, "body": "Clearly, the setup code is quite common for all dynamically linked librariers, thus the loader is also shared. Binaries contain a path to the loader, which typically is /lib64/ld-linux-x86-64.so.2 (depends on your system of course and binaries you got). While linux will try to execute whatever loader you got here, e.g. FreeBSD will try to match it against the list of known loaders and will error out."}], "tags": [], "owner": {"reputation": 3598, "user_id": 4822941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06bJl.jpg?s=128&g=1", "display_name": "employee of the month", "link": "https://stackoverflow.com/users/4822941/employee-of-the-month"}, "is_accepted": true, "score": 10, "last_activity_date": 1527637262, "last_edit_date": 1527637262, "creation_date": 1435173643, "answer_id": 31035182, "question_id": 31034993, "link": "https://stackoverflow.com/questions/31034993/how-does-a-program-inherit-environment-variables/31035182#31035182", "title": "How does a program inherit environment variables?", "body": "<p>There is no mystery here.</p>\n\n<p>First, the shell forks. Forked process obviously has the same environment. Then a new program is executed in the child. The syscall in question is <code>execve</code>, which amongst other things accepts a pointer to an environment.</p>\n\n<p>So there, what environment is set after execing a binary depends entirely on the code which was doing the exec.</p>\n\n<p>All this is can be easily seen by running strace.</p>\n\n<p><strong>EDIT:</strong> since the question was edited to ask about <code>environ</code>:</p>\n\n<p>When you execute a dynamically linked binary, the very first userspace code doing anything comes from the loader. The loader amongst other things sets up variables like <code>argc</code>, <code>argv</code> or <code>environ</code> and only then calls <code>main()</code> from the binary.</p>\n\n<p>Once more, sources for all this are freely available. While glibc's sources are rather hard to read due to atrocious formatting, BSD ones are easy and conceptually equivalent enough.</p>\n\n<p><a href=\"http://code.metager.de/source/xref/freebsd/libexec/rtld-elf/rtld.c#389\" rel=\"nofollow noreferrer\">http://code.metager.de/source/xref/freebsd/libexec/rtld-elf/rtld.c#389</a></p>\n"}, {"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 2, "last_activity_date": 1435173792, "creation_date": 1435173792, "answer_id": 31035236, "question_id": 31034993, "link": "https://stackoverflow.com/questions/31034993/how-does-a-program-inherit-environment-variables/31035236#31035236", "title": "How does a program inherit environment variables?", "body": "<p>The question is really, How does the shell run commands?</p>\n\n<p>The answer is by creating a new process probably using <code>fork()</code> and <a href=\"http://man7.org/linux/man-pages/man3/execl.3.html\" rel=\"nofollow\"><code>execl()</code></a>, which creates a process with the same environment as the current process.</p>\n\n<p>You can however create a new process with a custom environment using <a href=\"http://man7.org/linux/man-pages/man2/execve.2.html\" rel=\"nofollow\"><code>execvpe()</code>/<code>execle()</code></a>.</p>\n\n<p>But in any normal situation that wouldn't be necessary, and specially since many programs expect some environment variables to be defined like <code>PATH</code> for example, normally a child process inherits the environment variables from the environment where it is invoked.</p>\n"}, {"comments": [{"owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "edited": false, "score": 1, "creation_date": 1435174236, "post_id": 31035280, "comment_id": 50095015, "body": "So <code>gcc</code> is tricking me and <code>main</code> is not the real main function? I thought only the operating system can branch before main, not a library. If I build a program with no lib inclusion I will not expect to use the libc."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1435174424, "post_id": 31035280, "comment_id": 50095114, "body": "I like this answer: new knowledge! I just printed out the environment strings passed to <code>main</code> the way you say they are (MSVC)."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1435184201, "post_id": 31035280, "comment_id": 50100111, "body": "@WeatherVane MSVC supports three-argument main??! I would never have guessed."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "edited": false, "score": 1, "creation_date": 1435184460, "post_id": 31035280, "comment_id": 50100211, "body": "@nowox Indeed, the &quot;entry point&quot; where the kernel starts program execution is <i>not</i> <code>main</code>, it is somewhere in the C library -- the usual name for <i>that</i> function is <code>_start</code>, and in the glibc source you will find it in the <code>csu</code> directory. (And with shared libraries there is a &quot;program interpreter&quot; that gets invoked even before that!) You have to use special arguments to the compiler (GCC: <code>-nostdlib -nostartfiles</code>) if you don&#39;t want the C library. You almost surely <i>do</i> want the C library, even if you think you don&#39;t."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1435184613, "post_id": 31035280, "comment_id": 50100261, "body": "@WeatherVane BTW, environment variables work differently on Windows.  I am not familiar with the details, I just know it&#39;s not the same."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1435185785, "post_id": 31035280, "comment_id": 50100680, "body": "I expect they would, since they are a function of the OS."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 11, "last_activity_date": 1527637554, "last_edit_date": 1527637554, "creation_date": 1435173913, "answer_id": 31035280, "question_id": 31034993, "link": "https://stackoverflow.com/questions/31034993/how-does-a-program-inherit-environment-variables/31035280#31035280", "title": "How does a program inherit environment variables?", "body": "<p>The environment variables are passed down from the parent process as a <strong>third argument to <code>main</code></strong>.  The easiest way to discover this is to read the documentation for the system call <a href=\"http://linux.die.net/man/2/execve\" rel=\"nofollow noreferrer\"><code>execve</code></a>, particularly this bit:</p>\n\n<blockquote>\n<pre><code>int execve(const char *filename, char *const argv[], char *const envp[]);\n</code></pre>\n  \n  <p><strong>Description</strong></p>\n  \n  <p><code>execve()</code> executes the program pointed to by <code>filename</code>. [...]\n  <code>argv</code> is an array of argument strings passed to the new program. By convention, the first of these strings should contain the filename associated with the file being executed. <code>envp</code> is an array of strings, conventionally of the form <code>key=value</code>, which are passed as environment to the new program. Both <code>argv</code> and <code>envp</code> must be terminated by a NULL pointer. The argument vector and environment can be accessed by the called program's main function, when it is defined as:</p>\n\n<pre><code>int main(int argc, char *argv[], char *envp[])\n</code></pre>\n</blockquote>\n\n<p>The C library copies the <code>envp</code> argument into the <code>environ</code> global variable somewhere in its startup code, before it calls <code>main</code>: for instance, GNU libc does this in <a href=\"https://sourceware.org/git/?p=glibc.git;a=blob;f=csu/init-first.c#l69\" rel=\"nofollow noreferrer\"><code>_init</code></a> and musl libc does it in <a href=\"http://git.musl-libc.org/cgit/musl/tree/src/env/__libc_start_main.c#n26\" rel=\"nofollow noreferrer\"><code>__init_libc</code></a>.  (You may find musl libc's code easier to trace through than GNU libc's.)  Conversely, if you start a program using one of the <a href=\"http://linux.die.net/man/3/execl\" rel=\"nofollow noreferrer\"><code>exec</code></a> wrapper functions that <em>don't</em> take an explicit environment vector, the C library supplies <code>environ</code> as the third argument to <code>execve</code>.  Inheritance of environment variables is thus strictly a user-space convention.  As far as the kernel is concerned, each program receives two argument vectors, and it doesn't care what's in them.</p>\n\n<p>(Note that three-argument <code>main</code> is an extension to the C language.  The C standard only specifies <code>int main(void)</code> and <code>int main(int argc, char **argv)</code> but it permits implementations to define additional forms (<a href=\"http://port70.net/~nsz/c/c11/n1570.html#J.5.1\" rel=\"nofollow noreferrer\">C11 Annex J.5.1 Environment Arguments</a>).  The three-argument <code>main</code> has been how environment variables work since Unix V7 if not longer, and is documented by Microsoft too \u2014 see <a href=\"https://stackoverflow.com/a/18721336/15168\">What should <code>main()</code> return in C and C++?</a>.)</p>\n"}, {"comments": [{"owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "edited": false, "score": 0, "creation_date": 1435174347, "post_id": 31035343, "comment_id": 50095068, "body": "So each time I <code>exec</code> a program I will push on the stack the entire set of environment variables? This is a considerable amount of wasted memory (relatively speaking)."}, {"owner": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "reply_to_user": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "edited": false, "score": 0, "creation_date": 1435175682, "post_id": 31035343, "comment_id": 50095857, "body": "No.  Each process has it&#39;s own stack.  When you <code>exec</code> the kernel starts a new stack memory map for the new program that is taking over the process, copies the arguments and environmental variables from the old memory map onto the new stack, and then frees the old memory."}], "tags": [], "owner": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "is_accepted": false, "score": 3, "last_activity_date": 1435175936, "last_edit_date": 1435175936, "creation_date": 1435174154, "answer_id": 31035343, "question_id": 31034993, "link": "https://stackoverflow.com/questions/31034993/how-does-a-program-inherit-environment-variables/31035343#31035343", "title": "How does a program inherit environment variables?", "body": "<p>Under Linux when a program starts it has its arguments and environmental variables stored on the stack.  For C programs the code that executes before <code>main</code> looks at this, makes the <code>argv</code> and <code>envp</code> arrays of pointers, and then calls <code>main</code> with these values (and <code>argc</code>).</p>\n\n<p>When a program calls <code>execvpe</code> to turn into a new program (often after calling <code>fork</code>) then an <code>envp</code> is passed in, along with an <code>argv</code>.  The kernel will copy the data at these into the new program's stack.</p>\n\n<p>When any of the other <code>exec</code> functions are called then the glibc will pass in the current program's <code>environ</code> as the new program's <code>envp</code> to <code>execvpe</code> (or directly to sys_exec).</p>\n"}], "owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8769, "favorite_count": 2, "accepted_answer_id": 31035182, "answer_count": 5, "score": 4, "last_activity_date": 1527637554, "creation_date": 1435173046, "last_edit_date": 1496435582, "question_id": 31034993, "link": "https://stackoverflow.com/questions/31034993/how-does-a-program-inherit-environment-variables", "title": "How does a program inherit environment variables?", "body": "<p>When I use the function <code>getenv()</code> from the Standard C Library, my program  inherit the environment variables from its parent.</p>\n\n<p>Example:</p>\n\n<pre><code>$ export FOO=42\n$ &lt;&lt;&lt; 'int main() {printf(\"%s\\n\", getenv(\"FOO\"));}' gcc -w -xc - &amp;&amp; ./a.exe\n42\n</code></pre>\n\n<p>In libc, the <code>environ</code> variable is declared into <code>environ.c</code>. I am expecting it to be empty at the execution, but I get <code>42</code>.</p>\n\n<p>Going a bit further <code>getenv</code> can be simplified as follow:</p>\n\n<pre><code>char * getenv (const char *name)\n{\n    size_t len = strlen (name);\n    char **ep;\n    uint16_t name_start;\n\n    name_start = *(const uint16_t *) name;\n    len -= 2;\n    name += 2;\n\n    for (ep = __environ; *ep != NULL; ++ep)\n    {\n        uint16_t ep_start = *(uint16_t *) *ep;\n\n        if (name_start == ep_start &amp;&amp; !strncmp (*ep + 2, name, len)\n                &amp;&amp; (*ep)[len + 2] == '=')\n            return &amp;(*ep)[len + 3];\n    }\n    return NULL;\n}\nlibc_hidden_def (getenv)\n</code></pre>\n\n<p>Here I will just get the content of the <code>__environ</code> variable. However I never initialized it.</p>\n\n<p>So I get confused because <code>environ</code> is supposed to be <code>NULL</code> unless my main function is not the real entry point of my program. Perhaps <code>gcc</code> is ticking me by adding an <code>_init</code> function that is part of the standard C library.</p>\n\n<p>Where is <code>environ</code> initialized?</p>\n"}, {"tags": ["c", "encryption", "rsa", "libtomcrypt"], "answers": [{"comments": [{"owner": {"reputation": 603, "user_id": 614949, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07a546ad67797414bf1fc8928f7219c0?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/614949/alex"}, "edited": false, "score": 0, "creation_date": 1486037316, "post_id": 31037810, "comment_id": 71179925, "body": "Did you kept the 4 steps that appear in the question?"}], "tags": [], "owner": {"reputation": 537, "user_id": 591604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d5af8cde3d4456b4851c387a457c9058?s=128&d=identicon&r=PG", "display_name": "HD_Mouse", "link": "https://stackoverflow.com/users/591604/hd-mouse"}, "is_accepted": true, "score": 2, "last_activity_date": 1435182896, "creation_date": 1435182896, "answer_id": 31037810, "question_id": 31034781, "link": "https://stackoverflow.com/questions/31034781/how-do-i-use-libtomcrypt-to-import-an-rsa-public-key/31037810#31037810", "title": "How do I use libtomcrypt to import an RSA public key?", "body": "<p>So, upon digging into the source of rsa_import(), I figured out pretty quickly that it was expecting the key to be in DER format. Since I had access to the private key, I just made a DER file using this openssl command: </p>\n\n<pre><code>openssl rsa -in private.pem -outform DER -pubout -out public.der\n</code></pre>\n\n<p>Notably the argument for -outform is now DER rather than PEM. After this, I just read the file contents into a char buffer, then passed that in as the main argument for rsa_import. After that rsa_import made the key no problem and I was able to encrypt/decrypt from there. </p>\n"}], "owner": {"reputation": 537, "user_id": 591604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d5af8cde3d4456b4851c387a457c9058?s=128&d=identicon&r=PG", "display_name": "HD_Mouse", "link": "https://stackoverflow.com/users/591604/hd-mouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2106, "favorite_count": 1, "accepted_answer_id": 31037810, "answer_count": 1, "score": 2, "last_activity_date": 1435182896, "creation_date": 1435172313, "question_id": 31034781, "link": "https://stackoverflow.com/questions/31034781/how-do-i-use-libtomcrypt-to-import-an-rsa-public-key", "title": "How do I use libtomcrypt to import an RSA public key?", "body": "<p>I am experimenting with using libtomcrypt to do RSA-2048 bit encryption. My current objective is to import a public key from a file. This file was generated using OpenSSL with the command:</p>\n\n<pre><code>$ openssl rsa -in private.pem -outform PEM -pubout -out public.pem\n</code></pre>\n\n<p>So I believe my public key is in PKCS#1 padding and in OpenSSL's PEM format.</p>\n\n<p>I believe the function I need to use is rsa_import(), but that takes an in buffer, a length, and outputs an rsa_key pointer. Just to be clear, I believe what I need to do is as follows:</p>\n\n<ol>\n<li>Read in the contents of public.pem to a buffer</li>\n<li>Toss out the Header and Footers containing \"Begin Public Key\" etc.</li>\n<li>Decode data from base64.</li>\n<li>Pass in resulting data to rsa_import.</li>\n</ol>\n\n<p>Is this correct? Can anyone who has used libtomcrypt for this purpose comment on this? Thanks. </p>\n"}, {"tags": ["c", "zero", "pow"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 3, "creation_date": 1435171447, "post_id": 31034476, "comment_id": 50093419, "body": "How do you know that the first line is outputting a 0?"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1435171531, "post_id": 31034476, "comment_id": 50093460, "body": "Also, in what case could the first line output a 1?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1435171859, "post_id": 31034476, "comment_id": 50093683, "body": "Can you please post how do you know the output is <code>1</code> when the first value is <code>0</code>, and how do you know that the first  value is <code>0</code>?"}, {"owner": {"reputation": 3, "user_id": 5045867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7cd3b888105c811245f7fdda9a889b?s=128&d=identicon&r=PG&f=1", "display_name": "bpucka", "link": "https://stackoverflow.com/users/5045867/bpucka"}, "edited": false, "score": 0, "creation_date": 1435171935, "post_id": 31034476, "comment_id": 50093727, "body": "decPlace_volume is tied to the precision modifier for the print statement i.e. <code>printf(&quot;The volume is %.*f&quot;, decPlace_volume, volume</code>);`"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 2, "creation_date": 1435171950, "post_id": 31034476, "comment_id": 50093734, "body": "First, what is the type  of <code>decPlace_volume</code>?  Secondly, under what circumstances can the volume be negative (which is the only way you&#39;ll get a -1).  Third, how are you determining the value of <code>decPlace_volume</code> at either point?  Are you printing it to the terminal, viewing it in a debugger, what?"}, {"owner": {"reputation": 3, "user_id": 5045867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7cd3b888105c811245f7fdda9a889b?s=128&d=identicon&r=PG&f=1", "display_name": "bpucka", "link": "https://stackoverflow.com/users/5045867/bpucka"}, "edited": false, "score": 0, "creation_date": 1435172017, "post_id": 31034476, "comment_id": 50093776, "body": "The first line should output a 1 whenever the decimal value of volume is less than .94, otherwise it should print a 0."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1435172089, "post_id": 31034476, "comment_id": 50093813, "body": "Oh, and by the way ... It&#39;s not a very good idea to do <code>pow(x, 2)</code>, because it&#39;s simply <code>x * x</code>, which works regardless of the type of <code>x</code>."}, {"owner": {"reputation": 4721, "user_id": 773226, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/789e556956dd28cb9e476b82bf69f9ae?s=128&d=identicon&r=PG", "display_name": "Anoop K. Prabhu", "link": "https://stackoverflow.com/users/773226/anoop-k-prabhu"}, "edited": false, "score": 0, "creation_date": 1435172154, "post_id": 31034476, "comment_id": 50093854, "body": "if decimal value is 0.94, how will the first line output 1, it will output -1. (floor(0.99)-ceil(0.94)"}, {"owner": {"reputation": 3, "user_id": 5045867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7cd3b888105c811245f7fdda9a889b?s=128&d=identicon&r=PG&f=1", "display_name": "bpucka", "link": "https://stackoverflow.com/users/5045867/bpucka"}, "edited": false, "score": 0, "creation_date": 1435172213, "post_id": 31034476, "comment_id": 50093887, "body": "decPlace_volume is an integer. The first line would output -1 when the decimal volume is less than .94."}, {"owner": {"reputation": 3, "user_id": 5045867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7cd3b888105c811245f7fdda9a889b?s=128&d=identicon&r=PG&f=1", "display_name": "bpucka", "link": "https://stackoverflow.com/users/5045867/bpucka"}, "edited": false, "score": 0, "creation_date": 1435172512, "post_id": 31034476, "comment_id": 50094053, "body": "Alright fellas thanks for the help, I figured it out. For some reason I thought that my first line could output a 1, but it won&#39;t. Instead of <code>decPlace_volume = pow(decPlace_volume,2);</code> to convert, I just made a line for <code>decPlace_volume *= -1;</code>. Thanks again!"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1435175177, "post_id": 31034476, "comment_id": 50095542, "body": "Question - do you want the output value rounded to the nearest tenth, or just truncated?  IOW, if the value is <code>1.567</code>, do you want the output to be <code>1.5</code> or <code>1.6</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 0, "last_activity_date": 1435172236, "creation_date": 1435172236, "answer_id": 31034759, "question_id": 31034476, "link": "https://stackoverflow.com/questions/31034476/c-squaring-a-integer-with-value-0-is-outputting-1/31034759#31034759", "title": "C - Squaring a integer with value 0 is outputting 1?", "body": "<p>Your question asks to suppress the decimal if it would be <code>0</code>, here is one way to do that</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nint main()\n{\n    char buffer[25];\n    double volume;\n\n    volume = 1.234;\n    sprintf (buffer, \"%.1f\", volume);       // convert to string with 1 place\n    if (strstr(buffer, \".0\") != NULL)       // examine string\n        sprintf (buffer, \"%.0f\", volume);   // redo the string with 0 places\n    printf (\"Volume = %s\\n\", buffer);\n\n    volume = 1.01;\n    sprintf (buffer, \"%.1f\", volume);\n    if (strstr(buffer, \".0\") != NULL)\n        sprintf (buffer, \"%.0f\", volume);\n    printf (\"Volume = %s\\n\", buffer);\n\n    return 0;\n}\n</code></pre>\n\n<p>Program output:</p>\n\n<pre><code>Volume = 1.2\nVolume = 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1435172393, "creation_date": 1435172393, "answer_id": 31034807, "question_id": 31034476, "link": "https://stackoverflow.com/questions/31034476/c-squaring-a-integer-with-value-0-is-outputting-1/31034807#31034807", "title": "C - Squaring a integer with value 0 is outputting 1?", "body": "<blockquote>\n  <p>the precision of the output should be 1 unless the output decimal would be 0, in which case the decimal shouldn't be printed.</p>\n</blockquote>\n\n<p>OP's approach is subject to problems near multiples of 0.01 due to the typical binary implementation of floating point.  Instead post-processes the output of the unaltered <code>volume</code>.</p>\n\n<p>Use <code>snprintf()</code></p>\n\n<pre><code>double volume = foo();\nchar buffer[100];\nbuffer[0] = 0;\nint len = snprintf(buffer, sizeof buffer, \"%.1f\", volume);\nif (len &gt; 0 &amp;&amp; buffer[len-1] == '0') buffer[--len] = '\\0';\nputs(buffer);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 5045867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7cd3b888105c811245f7fdda9a889b?s=128&d=identicon&r=PG&f=1", "display_name": "bpucka", "link": "https://stackoverflow.com/users/5045867/bpucka"}, "is_accepted": false, "score": 0, "last_activity_date": 1435172574, "creation_date": 1435172574, "answer_id": 31034865, "question_id": 31034476, "link": "https://stackoverflow.com/questions/31034476/c-squaring-a-integer-with-value-0-is-outputting-1/31034865#31034865", "title": "C - Squaring a integer with value 0 is outputting 1?", "body": "<p>Alright fellas thanks for the help, I figured it out. For some reason I thought that my first line could output a 1, but it won't. Instead of </p>\n\n<p><code>decPlace_volume = pow(decPlace_volume,2);</code></p>\n\n<p>to convert, I just made a line for <code>decPlace_volume *= -1;</code>.</p>\n\n<p>Thanks again!</p>\n"}], "owner": {"reputation": 3, "user_id": 5045867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7cd3b888105c811245f7fdda9a889b?s=128&d=identicon&r=PG&f=1", "display_name": "bpucka", "link": "https://stackoverflow.com/users/5045867/bpucka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1539332366, "creation_date": 1435171334, "last_edit_date": 1539332366, "question_id": 31034476, "link": "https://stackoverflow.com/questions/31034476/c-squaring-a-integer-with-value-0-is-outputting-1", "title": "C - Squaring a integer with value 0 is outputting 1?", "body": "<pre><code>decPlace_volume = floor(volume+.05) - ceil(volume); //should output -1, 0, or 1\ndecPlace_volume = pow(decPlace_volume,2); //should the above == -1, this should turn it into 1 while making 0 remain 0\n</code></pre>\n\n<p>The only allowed libraries for my assignment are stdio.h and math.h.</p>\n\n<p>My assignment is pretty simple - find the surface area and volume of a cylinder, and the precision of the output should be 1 unless the output decimal would be 0, in which case the decimal shouldn't be printed. </p>\n\n<p>The above is what I came up with (same thing for surface area just different variables). If the output of the first line is -1, the second line should make it positive, and 0 should stay zero (integer so shouldn't need to worry about funky stuff). </p>\n\n<p>For some reason, when the first line outputs a 0, the second line is outputting 1. Is there something I'm missing here?</p>\n"}, {"tags": ["c", "cuda"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1435171346, "post_id": 31034373, "comment_id": 50093360, "body": "Have you considered <code>calloc</code> (which zero initializes) instead of <code>malloc</code> and then just the first 2 elements to 1 (like you do) ?"}, {"owner": {"reputation": 1339, "user_id": 2419822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DWBfd.png?s=128&g=1", "display_name": "Bakus123", "link": "https://stackoverflow.com/users/2419822/bakus123"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 1, "creation_date": 1435171686, "post_id": 31034373, "comment_id": 50093565, "body": "@Blue Moon, thx for idea, but calloc operation is not available for CUDA programs."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 2, "creation_date": 1435173105, "post_id": 31034373, "comment_id": 50094416, "body": "Better to use <code>cudaMemset</code> instead of loop."}, {"owner": {"reputation": 1339, "user_id": 2419822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DWBfd.png?s=128&g=1", "display_name": "Bakus123", "link": "https://stackoverflow.com/users/2419822/bakus123"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1435177577, "post_id": 31034373, "comment_id": 50096926, "body": "@haccks, ok but what about the first two elements? Initialize it in single thread?"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 1, "creation_date": 1435182629, "post_id": 31034373, "comment_id": 50099487, "body": "For first two elements: <code>array[0] = array[1] = 0;</code>. and then <code>cudaMemset(&amp;array[2], 0, array_size * sizeof(int));</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1339, "user_id": 2419822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DWBfd.png?s=128&g=1", "display_name": "Bakus123", "link": "https://stackoverflow.com/users/2419822/bakus123"}, "edited": false, "score": 0, "creation_date": 1435172281, "post_id": 31034611, "comment_id": 50093916, "body": "thx nice idea, but I hasn&#39;t constant size. I&#39;m sorry that i didn&#39;t write this before."}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "reply_to_user": {"reputation": 1339, "user_id": 2419822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DWBfd.png?s=128&g=1", "display_name": "Bakus123", "link": "https://stackoverflow.com/users/2419822/bakus123"}, "edited": false, "score": 0, "creation_date": 1435180757, "post_id": 31034611, "comment_id": 50098594, "body": "@Bakus123: Edited again with some note."}], "tags": [], "owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "is_accepted": true, "score": 5, "last_activity_date": 1435182613, "last_edit_date": 1435182613, "creation_date": 1435171778, "answer_id": 31034611, "question_id": 31034373, "link": "https://stackoverflow.com/questions/31034373/cuda-big-array-initialization/31034611#31034611", "title": "Cuda - Big array initialization", "body": "<p>One possibility is to directly initialize <code>__device__</code> array on GPU if it has constant size by adding following declaration at file scope (that is, outside of any function):</p>\n\n<pre><code>__device__ int dev_array[SIZE] = {1, 1};\n</code></pre>\n\n<p>The remaining elements will be initiliazed with zeros (you can check PTX assembly to be sure of that).</p>\n\n<p>then, it can be used in kernel like:</p>\n\n<pre><code>__global__ void kernel(void)\n{\n    int tid = ...;\n    int elem = dev_array[tid];\n    ...\n}\n</code></pre>\n\n<p>In case of variable size, you can combine <code>cudaMalloc()</code> with <code>cudaMemset()</code>:</p>\n\n<pre><code>int array_size = ...;\nint *dev_array;\n\ncudaMalloc((void **) &amp;dev_array, array_size * sizeof(int));\ncudaMemset(dev_array, 0, array_size * sizeof(int));\n</code></pre>\n\n<p>then set first two elements as ones:</p>\n\n<pre><code>int helper_array[2] = {1, 1};\ncudaMemcpy(dev_array, helper_array, 2 * sizeof(int), cudaMemcpyHostToDevice);\n</code></pre>\n\n<p>Beginning with compute capability 2.0 you can also allocate whole array directly within kernel by the <code>malloc()</code> device function:</p>\n\n<pre><code>__global__ void kernel(int array_size)\n{\n    int *dev_array;\n    int tid = ...;\n\n    if (tid == 0) {\n        dev_array = (int *) malloc(array_size * sizeof(int));\n        if (dev_array == NULL) {\n            ...\n        }\n        memset(dev_array, 0, array_size * sizeof(int));\n        dev_array[0] = dev_array[1] = 1;  \n    }\n    __syncthreads();\n\n    ...\n}\n</code></pre>\n\n<p>Note that threads from different blocks are unaware of barrier synchronization.</p>\n\n<p>From the <a href=\"http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#dynamic-global-memory-allocation-and-operations\" rel=\"nofollow\">CUDA C Programming Guide</a>:</p>\n\n<blockquote>\n  <p>The CUDA in-kernel <code>malloc()</code> function allocates at least <code>size</code> bytes\n  from the device heap and returns a pointer to the allocated memory or\n  <code>NULL</code> if insufficient memory exists to fulfill the request. The\n  returned pointer is guaranteed to be aligned to a 16-byte boundary.</p>\n</blockquote>\n\n<p>Unfortunatelly, the <code>calloc()</code> function is not implemented, hence you need to memset it anyway. Allocated memory has lifetime of CUDA context, but you can explicitely call <code>free()</code> from this or subsequent kernel at any time:</p>\n\n<blockquote>\n  <p>The memory allocated by a given CUDA thread via <code>malloc()</code> remains\n  allocated for the lifetime of the CUDA context, or until it is\n  explicitly released by a call to <code>free()</code>. It can be used by any other\n  CUDA threads even from subsequent kernel launches.</p>\n</blockquote>\n\n<p>With all that said, I wouldn't mind that much about supplementary <code>cudaMemcpy()</code>, since it's just two elements to copy and it would <em>likely</em> take less than 0.01% of the total execution time (it's easy to profile). Choose whatever way that makes you code clear. Otherwise it's a <a href=\"https://en.wikipedia.org/wiki/Program_optimization#When_to_optimize\" rel=\"nofollow\">premature optimization</a>.</p>\n"}], "owner": {"reputation": 1339, "user_id": 2419822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/DWBfd.png?s=128&g=1", "display_name": "Bakus123", "link": "https://stackoverflow.com/users/2419822/bakus123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3412, "favorite_count": 0, "accepted_answer_id": 31034611, "answer_count": 1, "score": 2, "last_activity_date": 1435182613, "creation_date": 1435170989, "last_edit_date": 1435172388, "question_id": 31034373, "link": "https://stackoverflow.com/questions/31034373/cuda-big-array-initialization", "title": "Cuda - Big array initialization", "body": "<p>What is the best approach (efficiently) to initialize a large array of integers for the gpu? I need to assign 1 for first two elements and 0 for other (for Sieve of Eratosthenes).</p>\n\n<ol>\n<li>cudaMemcpy</li>\n<li>cudaMemset + set value of 2 first elements in kernel</li>\n<li>initialization direct in kernel</li>\n<li>sth else</li>\n</ol>\n\n<p><strong>Note:</strong> Array size is dynamic (n is passed as an argument).</p>\n\n<p>My current version:</p>\n\n<pre><code>int array = (int*) malloc(array_size);\narray[0] = 1;\narray[1] = 1;\nfor (int i = 2; i &lt; n; i++) {\n    array[i] = 0;\n}\nHANDLE_ERROR(cudaMemcpy(dev_array, array, array_size, cudaMemcpyHostToDevice));\nkernel&lt;&lt;&lt;10, 10&gt;&gt;&gt;(dev_array);\n</code></pre>\n\n<p>I would be grateful for an example.</p>\n"}, {"tags": ["c++", "c", "ubuntu", "stream", "pipe"], "comments": [{"owner": {"reputation": 465, "user_id": 1140106, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0909a8b4bb65fc36f018e5f707ba857a?s=128&d=identicon&r=PG", "display_name": "GManika", "link": "https://stackoverflow.com/users/1140106/gmanika"}, "edited": false, "score": 0, "creation_date": 1435169739, "post_id": 31033705, "comment_id": 50092472, "body": "Hi did you try/refer the below posting ?  [Here][1]        [1]: <a href=\"http://stackoverflow.com/questions/1367373/python-subprocess-popen-oserror-errno-12-cannot-allocate-memory\" title=\"python subprocess popen oserror errno 12 cannot allocate memory\">stackoverflow.com/questions/1367373/&hellip;</a>"}, {"owner": {"reputation": 165655, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1435170009, "post_id": 31033705, "comment_id": 50092612, "body": "Do you call <code>pclose</code> for each call to <code>popen</code>? Maybe you call <code>fclose</code> by mistake."}, {"owner": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "edited": false, "score": 0, "creation_date": 1435173410, "post_id": 31033705, "comment_id": 50094564, "body": "@user2062604 Just to be clear, is your call to <code>popen</code> failing and leaving <code>errno</code> set to <code>ENOMEM</code>, or could this be happening in one of the programs created by your call to <code>popen</code>? Note that <code>popen(&quot;lsof -p pid | wc -l&quot;, &quot;r&quot;)</code> should fork a shell which will then fork for <code>lsof</code> and again for <code>wc</code>."}, {"owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "reply_to_user": {"reputation": 165655, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1435178242, "post_id": 31033705, "comment_id": 50097293, "body": "@DavidSchwartz Thanks for checking, but yes I am calling pclose"}, {"owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1435178256, "post_id": 31033705, "comment_id": 50097304, "body": "@AndrewHenle I&#39;ve edited my question to include the complete code."}, {"owner": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "edited": false, "score": 0, "creation_date": 1435178610, "post_id": 31033705, "comment_id": 50097498, "body": "So the full message printed by your program is &quot;popen failed with error 12 &#39;Cannot allocate memory&#39;&quot;?"}, {"owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "reply_to_user": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "edited": false, "score": 0, "creation_date": 1435179185, "post_id": 31033705, "comment_id": 50097777, "body": "@nategoose I think it really is popen that is setting errno because I set errno to zero before calling popen and I doubt that lsof or wc are causing ENOMEM. Could I be wrong here?"}, {"owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "reply_to_user": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "edited": false, "score": 0, "creation_date": 1435179236, "post_id": 31033705, "comment_id": 50097802, "body": "@nategoose The full message is:  Error: File ShellCommand.cpp line 137: popen failed with error 12 &#39;Cannot allocate memory&#39;"}, {"owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "edited": false, "score": 0, "creation_date": 1435179510, "post_id": 31033705, "comment_id": 50097937, "body": "I&#39;m particularly interested in the STREAM_MAX limit, how can I tell if I&#39;m at or close to this limit? Am I barking up the wrong tree?"}, {"owner": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "edited": false, "score": 0, "creation_date": 1435179510, "post_id": 31033705, "comment_id": 50097938, "body": "@user2062604  I was just wanting to verify that the error message wasn&#39;t coming from one of the programs that your program spawned."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "edited": false, "score": 0, "creation_date": 1435179715, "post_id": 31033705, "comment_id": 50098058, "body": "Sounds like a fork failure because your process is so big there isn&#39;t room for a copy of it. Related: <a href=\"http://stackoverflow.com/q/8368067/2404501\">this question</a>"}, {"owner": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "edited": false, "score": 0, "creation_date": 1435180602, "post_id": 31033705, "comment_id": 50098522, "body": "@WumpusQ.Wumbley <code>fork</code> isn&#39;t that memory hungry, though <code>exec</code> can be based on the size of the executable.  <code>pipe</code> can be as well, and there are 2 pipes involved here."}, {"owner": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "edited": false, "score": 0, "creation_date": 1435180847, "post_id": 31033705, "comment_id": 50098636, "body": "@user2062604 Temporarily replace your <code>popen</code> code with <code>system(&quot;szCommand&quot;)</code> and see what happens.  You&#39;ll have to handle return code checking differently.  If that works then try putting <code>system(&quot;cat &#47;proc&#47;meminfo&quot;);</code> just before your call to <code>popen</code> and see what the output is."}, {"owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "reply_to_user": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "edited": false, "score": 0, "creation_date": 1435181902, "post_id": 31033705, "comment_id": 50099118, "body": "@nategoose I&#39;ve tried that as well, but when system(szCommand) fails, it just returns -1. Also, I&#39;m capturing data from /proc/meminfo every second and logging the memory used, as well as watching the Ubuntu graphical system monitor, and the system memory used never goes over 60%."}, {"owner": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "edited": false, "score": 0, "creation_date": 1435200226, "post_id": 31033705, "comment_id": 50104111, "body": "@user2062604 This is a rather simple program to &quot;need for this to work with swap disabled&quot;.  Can you elaborate on what the requirement is?  If you&#39;re hitting the memory limit when running this then you&#39;ve got some problems.  You should be able to run it in console mode (with no GUI) with swap disabled though.  You could also call the system calls directly and avoid <code>popen</code> opening a shell and decreasing buffer sizes, which would save you a little memory, but not that much."}, {"owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "reply_to_user": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "edited": false, "score": 0, "creation_date": 1435203640, "post_id": 31033705, "comment_id": 50104911, "body": "@nategoose  This is a small part of a much larger program. The issue here is that I&#39;m not, as far as I can tell, hitting the memory limit. Both /proc/meminfo and the graphical System Monitor both indicate that I&#39;m nowhere close to the memory limit. I must be hitting some other resource limit, but I don&#39;t know what it is. I have a hunch that it might be STREAM_MAX but I don&#39;t know how to check for this. If by &quot;run the system calls&quot; you mean call system() then I have already tried that and it fails, returning -1, just as frequently. What could be going wrong here? Thanks for everyone&#39;s help btw!"}, {"owner": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "edited": false, "score": 0, "creation_date": 1435238380, "post_id": 31033705, "comment_id": 50124076, "body": "@user2062604  When I said &quot;system calls&quot; I meant <code>fork()</code>, <code>pipe()</code>, <code>execve()</code>, <code>dup()</code>, <code>dup2()</code>, and <code>sigprocmask()</code>.  Those are called by <code>popen()</code>, but in <code>popen</code> your shell is run first and it runs the command string, which is useful since it looks up the locations of the commands with the PATH environmental variable and can also do built in commands that aren&#39;t separate programs, but calling them directly has less overhead or tell you more about what exactly is failing."}, {"owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "reply_to_user": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "edited": false, "score": 0, "creation_date": 1435338211, "post_id": 31033705, "comment_id": 50175636, "body": "I re-implemented popen() as @nategoose suggested and turns out fork() is failing with ENOMEM. I still believe this is because I have some resource leak - this is backed up by the fact that my system got to a point where I could hardly run my application without fork() failing, even after restarting the application, but after rebooting, fork() stopped failing entirely (at least for the time being). The problem is I have no idea what resource limit I&#39;m hitting - it doesn&#39;t seem to be memory (which is only at 60% capacity). Does anyone know what other limits I could be hitting and how to test?"}, {"owner": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "edited": false, "score": 0, "creation_date": 1435549276, "post_id": 31033705, "comment_id": 50229450, "body": "@user2062604  Have you looked in the logs?  There may be some messages in there relevant to the failing call to <code>fork</code>.  <a href=\"http://www.cyberciti.biz/faq/linux-log-files-location-and-how-do-i-view-logs-files/\" rel=\"nofollow noreferrer\">cyberciti.biz/faq/&hellip;</a>"}, {"owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "reply_to_user": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "edited": false, "score": 0, "creation_date": 1435603157, "post_id": 31033705, "comment_id": 50258674, "body": "Thanks for the good idea @nategoose but I did a text search through the entire /var/log directory for &quot;fork&quot; as well as &quot;13:28:19&quot; which was the system time when I could last get the error to occur, and nothing useful came up."}], "owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3332, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1435179451, "creation_date": 1435168738, "last_edit_date": 1435179451, "question_id": 31033705, "link": "https://stackoverflow.com/questions/31033705/why-is-popen-failing-with-cannot-allocate-memory", "title": "Why is popen failing with &#39;Cannot Allocate Memory&#39;", "body": "<p>I have an Ubuntu C++ application that executes shell commands by calling popen(). The popen() call works great usually but sometimes it will fail and will indicate error 12 'Cannot allocate memory'.</p>\n\n<p>I know that the system is not even close to being out of memory, so that's not the problem. I know that the process has roughly 250 files open, which is far less than the OPEN_MAX value of 1024.</p>\n\n<p>What else could be the problem?</p>\n\n<p>I've read elsewhere that I could be at the STREAM_MAX limit (which is 16), but I don't know how to check whether or not this is actually the case. Any help would be very much appreciated!</p>\n\n<p>Here is the complete code:</p>\n\n<pre><code>// Format the command to get the number of files open in this process\nchar szCommand[1024];\nmemset(&amp;(szCommand[0]), 0, sizeof(szCommand));\nsnprintf(szCommand, sizeof(szCommand) - 1, \"lsof -p %i | wc -l\", static_cast&lt;int&gt;(getpid()));\n\n// A string to capture the output\nstd::string szTotalOutput(\"\");\n\n// Execute the command\nFILE *pFile = popen(szCommand, \"r\");\n\n// If the open was successful\nif (pFile)\n{\n    // A text buffer to capture output\n    char szOutput[2048];\n    memset(&amp;(szOutput[0]), 0, sizeof(szOutput));\n\n    // Get the output\n    while (fgets(szOutput, static_cast&lt;int&gt;(sizeof(szOutput) - 1), pFile))\n    {\n        // Add to the total output\n        szTotalOutput += std::string(szOutput);\n    }\n\n    // Close the file\n    pclose(pFile);\n}\n\n// Or, if the open failed\nelse\n{\n    // An error string\n    char szError[2048];\n    memset(&amp;(szError[0]), 0, sizeof(szError));\n\n    // If we have a good error\n    if (errno != 0)\n    {\n        // Format the error string\n        snprintf(szError, sizeof(szError) - 1, \"popen failed with error %i '%s'\", errno, strerror(errno));\n    }\n\n    // Or, if we don't have a good error\n    else\n    {\n        // Format the error string\n        snprintf(szError, sizeof(szError) - 1, \"popen failed but errno was not set\");\n    }\n\n    // Print this error message to the console window\n    printf(\"Error: File %s line %i: %s\\n\", __FILE__, __LINE__, szError);\n}\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I've found that if I re-enable swap (which was previously disabled) then the issue doesn't happen. But ultimately I need for this to work with swap disabled.</p>\n"}, {"tags": ["c++", "c", "cuda", "thrust", "multiple-gpu"], "answers": [{"tags": [], "owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "is_accepted": true, "score": 5, "last_activity_date": 1435209384, "last_edit_date": 1435209384, "creation_date": 1435169933, "answer_id": 31034070, "question_id": 31033661, "link": "https://stackoverflow.com/questions/31033661/initialize-struct-on-different-gpus/31034070#31034070", "title": "Initialize struct on different GPUs", "body": "<p>The problem is you are instantiating all the vectors in the same CUDA GPU context, then trying to use them in a different context. This happens because the default constructor for each <code>device_vector</code> gets called when you define the array of structures. To annotate your code:</p>\n\n<pre><code>struct LstmLayer lstmLayers[MAX_NUM_LSTM_LAYERS]; // default constructor for each device vector called here in one GPU context.\n\nfor (int i = 0; i &lt; numLstmLayers; ++i) {\n    CUDA_SAFE_CALL(cudaSetDevice(i));\n    lstmLayers[i].setDevice(i);\n    lstmLayers[i].init(true); // Error here, you changed to a different device and called resize\n}\n</code></pre>\n\n<p>The solution is probably to redefine the device vectors as pointers, and explicitly call their constructors in your <code>init</code> method. There are a lot of different ways this could be done, for example:</p>\n\n<pre><code> struct LstmLayer {\n  int deviceId;\n  thrust::device_vector &lt;real_t&gt;  * W;\n  thrust::device_vector &lt;real_t&gt; * gradW;\n\n  LstmLayer() : deviceId(0) {}\n\n  LstmLayer(int __deviceId__) : deviceId(__deviceId__) {}\n\n  void setDevice(int __deviceId__) { deviceId = __deviceId__; }\n\n  void init(bool initParams) {\n    W = new thrust::device_vector&lt;real_t&gt;(4*lstmSize * 2*lstmSize);\n    gradW = new thrust::device_vector&lt;real_t&gt;(4*lstmSize * 2*lstmSize);\n\n    if (initParams) GPU_Random_Vector(W);\n  }\n}\n</code></pre>\n\n<p>[disclaimer: written in browser, never compiled, use at own risk]</p>\n\n<p>obviously you would need to defined a destructor to prevent memory leaks. There are other possibilities, I'll leave that as an exercise to the reader. </p>\n"}], "owner": {"reputation": 57, "user_id": 5030115, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e39fceba214e65c825d7e955eb6d03c9?s=128&d=identicon&r=PG", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/5030115/hieu-pham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 31034070, "answer_count": 1, "score": 0, "last_activity_date": 1435209384, "creation_date": 1435168568, "question_id": 31033661, "link": "https://stackoverflow.com/questions/31033661/initialize-struct-on-different-gpus", "title": "Initialize struct on different GPUs", "body": "<p>I have a struct that looks like this</p>\n\n<pre><code>struct LstmLayer {\n  int deviceId;\n  thrust::device_vector &lt;real_t&gt; W;\n  thrust::device_vector &lt;real_t&gt; gradW;\n\n  LstmLayer() : deviceId(0) {}\n\n  LstmLayer(int __deviceId__) : deviceId(__deviceId__) {}\n\n  void setDevice(int __deviceId__) { deviceId = __deviceId__; }\n\n  void init(bool initParams) {\n    W.resize(4*lstmSize * 2*lstmSize);\n    gradW.resize(4*lstmSize * 2*lstmSize);\n\n    if (initParams) GPU_Random_Vector(W);\n  }\n}\n</code></pre>\n\n<p>Now I want to initialize an array of <code>LstmLayer</code>, with each element on a different GPU device. I do it as follows</p>\n\n<pre><code>  struct LstmLayer lstmLayers[MAX_NUM_LSTM_LAYERS];\n\n  for (int i = 0; i &lt; numLstmLayers; ++i) {\n    CUDA_SAFE_CALL(cudaSetDevice(i));\n    lstmLayers[i].setDevice(i);\n    lstmLayers[i].init(true);\n  }\n</code></pre>\n\n<p>Running this program gives the following error</p>\n\n<pre><code>terminate called after throwing an instance of 'thrust::system::system_error'\n  what():  driver shutting down\n</code></pre>\n\n<p>Please tell me what's wrong with my code and how to do it right? Thank you in advanced.</p>\n"}, {"tags": ["c", "string", "algorithm"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1435169017, "post_id": 31033451, "comment_id": 50092112, "body": "Among many other things, <code>atoi</code> doesn&#39;t do what you think it does. To be successful as a C programmer, you need to know how to find the documentation for the functions you&#39;re using. On unix systems, open a terminal and type &quot;man atoi&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 753, "user_id": 4882392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tAwlZ.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/4882392/gabriel"}, "is_accepted": false, "score": 1, "last_activity_date": 1435168697, "creation_date": 1435168697, "answer_id": 31033690, "question_id": 31033451, "link": "https://stackoverflow.com/questions/31033451/how-to-search-for-specific-lines-that-starts-with-a-string-in-a-file/31033690#31033690", "title": "How to search for specific lines that starts with a string in a file", "body": "<p>You could use a simple logic, just like using a 'for' to search for the word and right after you find the specific word that you want, continue with the 'for' until find a blank space (use ' ' to determinete the end and the beginning of a word) then print out all the letters until find the next blank ' '. This should work just fine.</p>\n"}, {"comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1435169993, "post_id": 31033776, "comment_id": 50092601, "body": "What you wanted is to match the first &quot;word&quot; (as opposed to starting with) then you could use the approach mentioned in the other answer with <code>strtok()</code>. The general structure of the code is same and problems need to be corrected."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 0, "last_activity_date": 1435169458, "last_edit_date": 1435169458, "creation_date": 1435168943, "answer_id": 31033776, "question_id": 31033451, "link": "https://stackoverflow.com/questions/31033451/how-to-search-for-specific-lines-that-starts-with-a-string-in-a-file/31033776#31033776", "title": "How to search for specific lines that starts with a string in a file", "body": "<ol>\n<li><p><code>char word;</code> is a single char which can't store <em>lines</em>; should be an array in order to read a line.</p></li>\n<li><p><code>atoi(buffer) != word</code> you are comparing an <code>int</code> (returned by <code>atoi()</code>) with a pointer(array name gets converted into a pointer here). I really don't see the purpose of this.</p></li>\n<li><p>You don't need to check if end of file has been reached. You just loop through the file line-by-line and check for your string.</p></li>\n<li><p>Calling <code>printf</code> without format specifier is not safe and you are also passing <code>char (*)[256]</code> whereas <code>printf</code> expects a <code>const char*</code>.</p></li>\n<li><p>You should also error checking on <code>fopen()</code>.</p></li>\n<li><p>Use a standard prototype for main() such as: <code>int main(void)</code></p></li>\n</ol>\n\n<p>After correcting all these, the code would be simplified to:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nint main(void)\n{\n    char word[256] = {0};\n    char buffer[256] = {0};\n    FILE *fp;\n\n    printf(\"Enter your word: \");\n    scanf(\"%s\", word);\n\n    fp = fopen(\"data.txt\", \"r+\");\n    if (!fp) { /* error */}\n\n    while ( fgets(buffer, sizeof buffer, fp) )\n    { \n       if( strstr(buffer, word) == buffer )\n       printf(\"Found: %s\\n\", buffer); \n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>There's no library function to find if a string \"starts with\" in C. I am using <code>strstr</code> to achieve that. If there's a match <em>and</em> it's equal to the starting address of the <code>buffer</code>, then it starts with <code>word</code>. Because <code>strstr</code> returns to a pointer to the first match.</p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 5033351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ce7a7b50bbffded8f35b349b162cdc?s=128&d=identicon&r=PG&f=1", "display_name": "koper", "link": "https://stackoverflow.com/users/5033351/koper"}, "edited": false, "score": 0, "creation_date": 1435170513, "post_id": 31033932, "comment_id": 50092865, "body": "Thank you very much! That&#39;s exactly what I wanted to do"}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 2, "last_activity_date": 1435169444, "creation_date": 1435169444, "answer_id": 31033932, "question_id": 31033451, "link": "https://stackoverflow.com/questions/31033451/how-to-search-for-specific-lines-that-starts-with-a-string-in-a-file/31033932#31033932", "title": "How to search for specific lines that starts with a string in a file", "body": "<p>There were several mistakes in the code as pointed out elsewhere. This answer will find whole words so for example \"suo\" but not \"su\".</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nint main()\n{\n    char word[256];                 // adequate string space (not single char)\n    char buffer[256];\n    char *sptr;\n    FILE *fp;\n    int found = 0;\n\n    printf(\"Enter your word: \");\n    scanf(\"%s\", word);              // requires a string pointer (note no &amp;)\n\n    fp = fopen(\"data.txt\", \"r\");    // removed \"+\"\n    if (fp) {\n        while (fgets(buffer, sizeof buffer, fp) != NULL) {\n            sptr = strtok(buffer, \" \\t\\r\\n\");\n            if (sptr &amp;&amp; strcmp(sptr, word) == 0) {\n                sptr = strtok(NULL, \" \\t\\r\\n\");\n                if (sptr) {\n                    printf(\"%s\\n\", sptr);\n                    found = 1;\n                    break;\n                }\n            }\n        }\n        fclose(fp);\n    }\n    if (!found)\n        printf (\"%s not found\\n\", word);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 0, "last_activity_date": 1435170902, "creation_date": 1435170902, "answer_id": 31034335, "question_id": 31033451, "link": "https://stackoverflow.com/questions/31033451/how-to-search-for-specific-lines-that-starts-with-a-string-in-a-file/31034335#31034335", "title": "How to search for specific lines that starts with a string in a file", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(void){\n    char buffer[256];\n    char word[256], second_word[256];\n    char format[256];\n    FILE *fp;\n\n    printf(\"Enter your word: \");\n    scanf(\"%255[A-Za-z]\", word);\n    sprintf(format, \"%s %%255s\", word);\n    fp = fopen(\"data.txt\", \"r\");\n    while (fgets(buffer, sizeof buffer, fp) != NULL) {\n        if (sscanf(buffer, format, second_word) == 1) {\n            printf(\"%s\\n\", second_word);\n            break;//continue;?\n        }\n    }\n    fclose(fp);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 5033351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ce7a7b50bbffded8f35b349b162cdc?s=128&d=identicon&r=PG&f=1", "display_name": "koper", "link": "https://stackoverflow.com/users/5033351/koper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 31033776, "answer_count": 4, "score": 0, "last_activity_date": 1435170902, "creation_date": 1435167903, "last_edit_date": 1435169327, "question_id": 31033451, "link": "https://stackoverflow.com/questions/31033451/how-to-search-for-specific-lines-that-starts-with-a-string-in-a-file", "title": "How to search for specific lines that starts with a string in a file", "body": "<p>I need help with this little program I am trying to make. </p>\n\n<p>There is .txt file:</p>\n\n<pre><code>namas house\nkatinas cat\nsuo dog\nskaicius number\n</code></pre>\n\n<p>I want to find a line which begins with specific word and then prints second word of that line.\nFor example, user enters word <code>katinas</code>. Program looks through file, finds line that begins with <code>katinas</code> and finally prints.</p>\n\n<p>What I have so far:</p>\n\n<pre><code>int main()\n{\n    char word;\n\n    printf(\"Enter your word: \");\n    scanf(\"%s\", &amp;word);\n\n    FILE *fp;\n    fp = fopen(\"data.txt\", \"r+\");\n    char buffer[256];\n    while (fgets(buffer, sizeof buffer, fp) != NULL &amp;&amp; atoi(buffer) != word)\n    ;\n    if (feof(fp))\n    {\n        printf(&amp;buffer);\n    }\n    fclose(fp);\n\n    return 0;\n}\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "optimization", "bit-manipulation", "inline"], "comments": [{"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1435167330, "post_id": 31033223, "comment_id": 50091052, "body": "<a href=\"https://www.google.com/search?client=ubuntu&amp;channel=fs&amp;q=cmov&amp;ie=utf-8&amp;oe=utf-8\" rel=\"nofollow noreferrer\">google.com/&hellip;</a>"}, {"owner": {"reputation": 3233, "user_id": 214914, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ce51504becca273ac9dbfd060a709fa3?s=128&d=identicon&r=PG", "display_name": "NumberFour", "link": "https://stackoverflow.com/users/214914/numberfour"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1435167445, "post_id": 31033223, "comment_id": 50091122, "body": "Unfortunately, I&#39;m not targeting a processor which has this instruction."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1435167540, "post_id": 31033223, "comment_id": 50091179, "body": "Then what are you targeting? Basically, any ISA born after C language has at least one way to do <code>x=cond?y:z</code> fast, really fast."}, {"owner": {"reputation": 3233, "user_id": 214914, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ce51504becca273ac9dbfd060a709fa3?s=128&d=identicon&r=PG", "display_name": "NumberFour", "link": "https://stackoverflow.com/users/214914/numberfour"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1435167675, "post_id": 31033223, "comment_id": 50091260, "body": "I&#39;m targeting an MCU - MSP430, its instruction set is very limited. The point is not to be fast, just to be constant-time, regardless what the <code>input</code> is."}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 2, "creation_date": 1435168174, "post_id": 31033223, "comment_id": 50091575, "body": "Conditional one&#39;s complement by XORing with a mask of all 0s or all 1s: <code>N = N ^ (0 - ((input&amp;2) &gt;&gt; 1))</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1435168994, "post_id": 31033223, "comment_id": 50092097, "body": "You might get a much better answer, if you state the actual problem you are facing. I suspect an <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY-problem</a> here."}, {"owner": {"reputation": 3233, "user_id": 214914, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ce51504becca273ac9dbfd060a709fa3?s=128&d=identicon&r=PG", "display_name": "NumberFour", "link": "https://stackoverflow.com/users/214914/numberfour"}, "edited": false, "score": 0, "creation_date": 1435169656, "post_id": 31033223, "comment_id": 50092431, "body": "Actually, I would say the problem is stated quite clearly by the first code. There&#39;s no more science behind this function I want to use - just transforming two bits of information into either <code>0</code>,<code>38</code> or <code>~38</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435169892, "post_id": 31033223, "comment_id": 50092546, "body": "Read the link I provided. You just state what you think is <i>the</i> solution. However, there might be a much easier/better one you currently are not even thinking about. (That is actually the definition of an XY-problem). As you want a fixed run-time here, there apparently <i>is</i> more behind that! One idea might be an encryption algorithm. But even then, this would only be a small part and I do not know any such algorithm where that code might make sense. But then, there is no gain in disabling interrupts."}], "answers": [{"comments": [{"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1435168270, "post_id": 31033503, "comment_id": 50091643, "body": "Excellent solution - but I suggest you get rid of <code>int index = input &amp; 0x3</code> and change the return statement to <code>return table[input &amp; 0x3];</code>."}, {"owner": {"reputation": 3233, "user_id": 214914, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ce51504becca273ac9dbfd060a709fa3?s=128&d=identicon&r=PG", "display_name": "NumberFour", "link": "https://stackoverflow.com/users/214914/numberfour"}, "edited": false, "score": 0, "creation_date": 1435168791, "post_id": 31033503, "comment_id": 50091982, "body": "This is also nice, thinking a little bit more low-level, I could put those values in the stack and then address them by the <code>index</code>."}, {"owner": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "reply_to_user": {"reputation": 3233, "user_id": 214914, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ce51504becca273ac9dbfd060a709fa3?s=128&d=identicon&r=PG", "display_name": "NumberFour", "link": "https://stackoverflow.com/users/214914/numberfour"}, "edited": false, "score": 1, "creation_date": 1435171995, "post_id": 31033503, "comment_id": 50093759, "body": "@NumberFour Putting those numbers on the stack will slow down the code because doing so will require copying each number to the stack before accessing them (at least once per the function that this resides in) and will not avoid having to copy them from somewhere (including numbers encoded into op-codes)."}, {"owner": {"reputation": 11342, "user_id": 299301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9d84c403343c5d7cb9d6abdb26a9a81?s=128&d=identicon&r=PG", "display_name": "nategoose", "link": "https://stackoverflow.com/users/299301/nategoose"}, "reply_to_user": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1435172081, "post_id": 31033503, "comment_id": 50093809, "body": "@BobJarvis Your suggestion should produce identical assembly code to the above for any compiler unless optimizations are turned off."}], "tags": [], "owner": {"reputation": 61, "user_id": 5045760, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/50813c18e0af24d4f2c8d8bafaba7ad0?s=128&d=identicon&r=PG", "display_name": "cwallach", "link": "https://stackoverflow.com/users/5045760/cwallach"}, "is_accepted": false, "score": 5, "last_activity_date": 1435168078, "creation_date": 1435168078, "answer_id": 31033503, "question_id": 31033223, "link": "https://stackoverflow.com/questions/31033223/rewrite-the-code-without-branches/31033503#31033503", "title": "Rewrite the code without branches", "body": "<p>Use a table lookup.</p>\n\n<pre><code>uint16_t foo(uint8_t input) {\n    int index= input &amp; 0x3;\n    const uint16 table[4]= {0,~38,0,38};\n    return table[index];\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3233, "user_id": 214914, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ce51504becca273ac9dbfd060a709fa3?s=128&d=identicon&r=PG", "display_name": "NumberFour", "link": "https://stackoverflow.com/users/214914/numberfour"}, "edited": false, "score": 0, "creation_date": 1435168575, "post_id": 31033565, "comment_id": 50091828, "body": "Hm, looks good, the only problem would be those multiplications, which I presume could be be taken care of using <code>AND</code>s and some 0 minus 1 trick."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 3233, "user_id": 214914, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ce51504becca273ac9dbfd060a709fa3?s=128&d=identicon&r=PG", "display_name": "NumberFour", "link": "https://stackoverflow.com/users/214914/numberfour"}, "edited": false, "score": 0, "creation_date": 1435168789, "post_id": 31033565, "comment_id": 50091978, "body": "Yes. Or by signed shifting."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 3233, "user_id": 214914, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ce51504becca273ac9dbfd060a709fa3?s=128&d=identicon&r=PG", "display_name": "NumberFour", "link": "https://stackoverflow.com/users/214914/numberfour"}, "edited": false, "score": 1, "creation_date": 1435169287, "post_id": 31033565, "comment_id": 50092258, "body": "Actually, if you manage getting <code>bit1</code> as all-zeros or all-ones word, you can replace <code>bit1 * ~N + nbit1 * N</code> by just <code>N^bit1</code>"}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 2, "last_activity_date": 1435168241, "creation_date": 1435168241, "answer_id": 31033565, "question_id": 31033223, "link": "https://stackoverflow.com/questions/31033223/rewrite-the-code-without-branches/31033565#31033565", "title": "Rewrite the code without branches", "body": "<p>If I read your code in the right way, it says the following:</p>\n\n<pre><code>uint16_t foo1(uint8_t input)\n{\n     uint16_t N = 38;\n\n     uint16_t bit0 = input &amp; 1;\n     uint16_t nbit0 = bit0 ^ 1;\n     uint16_t bit1 = (input &amp; 2) &gt;&gt; 1;\n     uint16_t nbit1 = bit1 ^ 1;\n\n     N = nbit0 * ( bit1 * ~N + nbit1 * N);\n\n     return N;\n}\n</code></pre>\n\n<p>Feel free to get rid of variables. They are just for readability.</p>\n"}, {"comments": [{"owner": {"reputation": 3233, "user_id": 214914, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ce51504becca273ac9dbfd060a709fa3?s=128&d=identicon&r=PG", "display_name": "NumberFour", "link": "https://stackoverflow.com/users/214914/numberfour"}, "edited": false, "score": 0, "creation_date": 1435169067, "post_id": 31033677, "comment_id": 50092136, "body": "Thanks! I appreciate your note about the interrupts. I actually realized I forgot to turn them off :)"}], "tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": false, "score": 3, "last_activity_date": 1435168966, "last_edit_date": 1435168966, "creation_date": 1435168640, "answer_id": 31033677, "question_id": 31033223, "link": "https://stackoverflow.com/questions/31033223/rewrite-the-code-without-branches/31033677#31033677", "title": "Rewrite the code without branches", "body": "<p>To have guaranteed run-time and balanced code, will have to go assembler. As the MSP430 assembler is not that complicated, that will not be much of a problem. Note that things like multiplication are likely performed by a function which has <em>not</em> constant run-time.</p>\n\n<p>There is little sense to avoid branches. Instead, you should balance the execution paths, e.g.using NOP (no operation). The MSP430 user's guide includes instruction timing. Note that the timing is fixed, which is different with larger CPUs like ARM where it depends on pipeline and memory timing.</p>\n\n<p>General note: Doing timing through CPU cycles is most times a bad idea. Modern MCUs like MSP430 provide internal timers and connections to other peripherals like ADC to trigger e.g. conversions with a highly accurate timing. They can generate an interrupt so the CPU can prepare the next value or read the sample without caring about run-time of the code (unless it takes too long).</p>\n\n<p>Using the CPU for such forbids for instance interrupt, as these will blow any timing. That makes maintenance of such a system a nightmare.</p>\n"}, {"comments": [{"owner": {"reputation": 3233, "user_id": 214914, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ce51504becca273ac9dbfd060a709fa3?s=128&d=identicon&r=PG", "display_name": "NumberFour", "link": "https://stackoverflow.com/users/214914/numberfour"}, "edited": false, "score": 0, "creation_date": 1435169439, "post_id": 31033811, "comment_id": 50092321, "body": "Thanks for your answer. Problem here is that multiplication by <code>32729</code>. I need to keep using bit-wise ops only."}], "tags": [], "owner": {"reputation": 68, "user_id": 5041615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/723f0982a4285a7f3324d9c230c9876c?s=128&d=identicon&r=PG&f=1", "display_name": "bindingofisaac", "link": "https://stackoverflow.com/users/5041615/bindingofisaac"}, "is_accepted": false, "score": 2, "last_activity_date": 1435169027, "creation_date": 1435169027, "answer_id": 31033811, "question_id": 31033223, "link": "https://stackoverflow.com/questions/31033223/rewrite-the-code-without-branches/31033811#31033811", "title": "Rewrite the code without branches", "body": "<p>This should work.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(){\n    int input;\n    scanf(\"%d\", &amp;input);\n    int N = (input&amp;1)*(((input&amp;2)*32729)+(38+((input&amp;2)&gt;&gt;1)));\n    printf(\"%d\\n\", N);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3233, "user_id": 214914, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ce51504becca273ac9dbfd060a709fa3?s=128&d=identicon&r=PG", "display_name": "NumberFour", "link": "https://stackoverflow.com/users/214914/numberfour"}, "edited": false, "score": 0, "creation_date": 1435217098, "post_id": 31040610, "comment_id": 50110130, "body": "Thanks for your answer. All the answers were really great, but I am accepting yours, because it is almost the same code I used in the end."}], "tags": [], "owner": {"reputation": 22202, "user_id": 696391, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/VrUwT.jpg?s=128&g=1", "display_name": "samgak", "link": "https://stackoverflow.com/users/696391/samgak"}, "is_accepted": true, "score": 2, "last_activity_date": 1435202168, "creation_date": 1435202168, "answer_id": 31040610, "question_id": 31033223, "link": "https://stackoverflow.com/questions/31033223/rewrite-the-code-without-branches/31040610#31040610", "title": "Rewrite the code without branches", "body": "<p>7 operations and no multiplies, builds on njuffa's comment:</p>\n\n<pre><code>uint16_t bar(uint8_t input)\n{\n    return (0-(input&amp;1)) &amp; (38^(0-((input&gt;&gt;1)&amp;1)));\n}\n</code></pre>\n\n<p><a href=\"http://ideone.com/AOrwGC\" rel=\"nofollow\">Demo</a></p>\n"}], "owner": {"reputation": 3233, "user_id": 214914, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ce51504becca273ac9dbfd060a709fa3?s=128&d=identicon&r=PG", "display_name": "NumberFour", "link": "https://stackoverflow.com/users/214914/numberfour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 1, "accepted_answer_id": 31040610, "answer_count": 5, "score": 3, "last_activity_date": 1435202168, "creation_date": 1435167105, "last_edit_date": 1435167860, "question_id": 31033223, "link": "https://stackoverflow.com/questions/31033223/rewrite-the-code-without-branches", "title": "Rewrite the code without branches", "body": "<p>I have the following function:</p>\n\n<pre><code>uint16_t foo(uint8_t input)\n{\n     uint16_t N = 38;\n     if (!(input&amp;1))\n     {\n       N = 0;\n     }\n     else \n     {\n        if ((input&amp;2) &gt;&gt; 1)\n        {\n           N = ~N;\n        }\n     }\n     return N;\n}\n</code></pre>\n\n<p>And I would like to have it rewritten without <code>ifs</code>, just as an inline function which transforms <code>38</code> into either <code>0,38</code> or <code>65497</code> given <code>input</code> and using only standard C bit-twiddling operations.</p>\n\n<p>The point is not that compiler could inline the function, or the function to be fast, but just to get rid of the branches and be constant-time regardless what the <code>input</code> is.</p>\n\n<p>The first <code>if</code> is easy:</p>\n\n<pre><code>uint16_t c = ((input&amp;1)^1)-1;\nN &amp;= c;\n</code></pre>\n\n<p>but I'm having troubles finding some simple way to do that conditional negation.</p>\n"}, {"tags": ["c", "malloc", "valgrind", "free"], "comments": [{"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 1, "creation_date": 1435167489, "post_id": 31033122, "comment_id": 50091152, "body": "Post an <a href=\"http://sscce.org\" rel=\"nofollow noreferrer\">SSCCE</a> if you expect people to help you debug this.  Its likely that you have an off-by-one error in your routines that calculate how much memory to allocate."}, {"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "edited": false, "score": 0, "creation_date": 1435167729, "post_id": 31033122, "comment_id": 50091298, "body": "Particularly, what do <code>ct_wd</code> and <code>ct_c</code> do? If you could provide something with a dummy implementation of them and a <code>main()</code> function, this would be far easier to debug."}, {"owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "edited": false, "score": 0, "creation_date": 1435167808, "post_id": 31033122, "comment_id": 50091337, "body": "Is it possible you have redefined <code>malloc()</code> somehow?"}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 0, "creation_date": 1435168050, "post_id": 31033122, "comment_id": 50091494, "body": "It seems <code>ft_mal()</code> is an implementation of <code>malloc() + memset()</code>."}, {"owner": {"reputation": 387, "user_id": 3653346, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f30d4291cc5f5533dd6a7017cc7ea472?s=128&d=identicon&r=PG&f=1", "display_name": "valvince", "link": "https://stackoverflow.com/users/3653346/valvince"}, "edited": false, "score": 0, "creation_date": 1435178891, "post_id": 31033122, "comment_id": 50097619, "body": "Yes, this is is exactly what it is. My code is part of a school project where the use of the named functions above is forbidden."}], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 3653346, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f30d4291cc5f5533dd6a7017cc7ea472?s=128&d=identicon&r=PG&f=1", "display_name": "valvince", "link": "https://stackoverflow.com/users/3653346/valvince"}, "edited": false, "score": 0, "creation_date": 1435179681, "post_id": 31033339, "comment_id": 50098036, "body": "I thanks for the help. I corrected the &quot;i + 1&quot;  to an obvious &quot;(i + 1)&quot; once said... I malloc a size equivalent of the number of characters in the sentence + the number of words x size of char (\\0). I then copy the words in the big malloc minus the splitting character and add a \\0 at the end of each word.   The line &quot;ret[i++] = (*s ? str : &#39;\\0&#39;);&quot; makes each cell of the ret array point to the beginning of a sentence."}], "tags": [], "owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "is_accepted": true, "score": 4, "last_activity_date": 1435167461, "creation_date": 1435167461, "answer_id": 31033339, "question_id": 31033122, "link": "https://stackoverflow.com/questions/31033122/valgrind-error-invalid-read-write-when-malloc/31033339#31033339", "title": "Valgrind error: invalid read/write when malloc", "body": "<p>Working backwards:</p>\n\n<p>The final error is easy. I think you intend <code>ret</code> to be an array of <code>char *</code> that is zero terminated. But you allocate it like this:</p>\n\n<pre><code>ret = (char **)ft_mal(sizeof(*ret) * i + 1);\n</code></pre>\n\n<p>If you want one more entry for the terminating <code>null</code> you need <code>i + 1</code> entries of size <code>*ret</code>, i.e.</p>\n\n<pre><code>ret = (char **)ft_mal(sizeof(*ret) * (i + 1));\n</code></pre>\n\n<p>The preceding error is harder. This line:</p>\n\n<pre><code>ret[i++] = (*s ? str : '\\0'); /*LINE WITH ERROR*/\n</code></pre>\n\n<p>is confusing. <code>ret[i++]</code> appears to be a <code>char *</code>. But you appear to be copying in a <code>char</code>. What did you mean to do here? What happens when you compile with <code>-Wall</code>? I bet you see a warning.    </p>\n\n<p>This line:</p>\n\n<pre><code>ret = malloc(size); /*LINE WITH ERROR*/\n</code></pre>\n\n<p>looks very unlikely to produce the valgrind error you suggest. I suggest compiling with <code>-O0 -g -Wall</code> and trying again once you've fixed the other bits up, and carefully checking the line numbers.</p>\n\n<p>It's producing <code>free()</code> errors as you never <code>free()</code> anything.</p>\n"}], "owner": {"reputation": 387, "user_id": 3653346, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f30d4291cc5f5533dd6a7017cc7ea472?s=128&d=identicon&r=PG&f=1", "display_name": "valvince", "link": "https://stackoverflow.com/users/3653346/valvince"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1764, "favorite_count": 0, "accepted_answer_id": 31033339, "answer_count": 1, "score": 4, "last_activity_date": 1435180837, "creation_date": 1435166701, "last_edit_date": 1435180837, "question_id": 31033122, "link": "https://stackoverflow.com/questions/31033122/valgrind-error-invalid-read-write-when-malloc", "title": "Valgrind error: invalid read/write when malloc", "body": "<p>Valgrind gives me the following error in the below code:\n<strong>Invalid write of size 8 : Address XX is 32 bytes inside a block of size 33 alloc'd</strong></p>\n\n<pre><code>/*The function allocate memory and clean it for further use.*/\nstatic void *ft_mal(size_t size)\n{\n    void    *ret;\n    char    *tmp;\n\n    ret = malloc(size); /*LINE WITH ERROR*/\n    if (!ret)\n        return (NULL);\n    tmp = ret;\n    while (size) {\n       *tmp = 0;\n        tmp++;\n        size--;\n    }\n    return (ret);\n}\n</code></pre>\n\n<p>I use this function in the below code where I also have two <strong>Invalid write of size 8</strong> error on commented lines:</p>\n\n<pre><code>/*Splits a string into an array of strings*/\nchar            **ft_splt(const char *s, char c)\n{\n    char    **ret;\n    char    *str;\n    int     i;\n\n    i = ct_wd(s, c);\n    ret = (char **)ft_mal(sizeof(*ret) * i + 1);\n    str = (char *)ft_mal(sizeof(*str) * ct_c(s, c) + i);\n    i = 0;\n    while (*s) {\n        while (*s &amp;&amp; *s == c)\n            s++;\n        ret[i++] = (*s ? str : '\\0'); /*LINE WITH ERROR*/\n        while (*s &amp;&amp; *s != c)\n            *str++ = *s++;\n        if (*s)\n            *str++ = '\\0';\n    }\n    ret[i] = 0; /*LINE WITH ERROR*/\n    return (ret);\n}\n</code></pre>\n\n<p>I don't get why it produces the errors and therefore don't know how to solve them either. Consequently I have an error when I free the mallocs.</p>\n\n<p>How do I have to do to solve these invalid read / write errors ?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>As required I give a little more code.\nct_wd and ct_c respectively count the number of words and the number of characters in the string arguments in order to create the right sized malloc.</p>\n\n<pre><code>static int      ct_wd(const char *s, char c)\n{\n    int     nb;\n\n    nb = 0;\n    while (*s) {\n        while (*s &amp;&amp; *s == c)\n            s++;\n        while (*s &amp;&amp; *s != c)\n            s++;\n        nb = (*(s - 1) != c ? nb + 1 : nb);\n    }\n    return (nb);\n}\n\nstatic int      ct_c(const char *s, char c)\n{\n    int     nb;\n\n    nb = 0;\n    while (*s) {\n        if (*s != c)\n            nb++;\n        s++;\n    }\n    return (nb);\n}\n</code></pre>\n\n<p>Here is a main.c example:</p>\n\n<pre><code>int                 main()\n{\n    char    s[] = \"lut:les:enf:?  \";\n    char    **ret;\n    int     i = 0;\n\n    ret = ft_splt(s, ':');\n    while (ret[i]) {\n        printf(\"[Resultat :]\\n\");\n        i++;\n    }\n    /* free all malloced pointer */\n    return (0);\n}\n</code></pre>\n\n<p><strong>Edit: SOLUTION</strong></p>\n\n<p>As mentionned below there was a mistake:</p>\n\n<pre><code>ret = (char **)ft_mal(sizeof(*ret) * i + 1);\n</code></pre>\n\n<p>should instead be:</p>\n\n<pre><code>ret = (char **)ft_mal(sizeof(*ret) * (i + 1));\n</code></pre>\n\n<p>I still had a seg fault on execution. Seems  like removing this line :</p>\n\n<pre><code>ret[i] = 0;\n</code></pre>\n\n<p>removed both the valgrind error and the segfault.\nI understand this line was not really necessary as ft_mal already cleaned the memory, still I don't really get why this both produced a write error in valgrind and made me seg fault.</p>\n"}, {"tags": ["c", "algorithm", "rectangles", "coordinate-systems"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1435166580, "post_id": 31033049, "comment_id": 50090605, "body": "If you are posting here some online programming challenges, at leas bother to fully describe the problem in the question body."}, {"owner": {"reputation": 111, "user_id": 4083662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cf42a6c7e933f7579ec4d4758f95a6?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/4083662/amit"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1435167059, "post_id": 31033049, "comment_id": 50090883, "body": "@Eugene Given the coordinates of the lower left corner (x,y), the length (l) and width(w) of 2 rectangles, write a program to find the smallest possible rectangle enclosing the 2 given rectangles.   Input and Output Format:   The 1st line of the input consists of 4 integers separated by a space that correspond to x, y, l and w of the first rectangle. The 2nd line of the input consists of 4 integers separated by a space that correspond to x, y, l and w of the second rectangle.   Output consists of 4 integers that correspond to x, y, l and w of the Union rectangle."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1435167108, "post_id": 31033049, "comment_id": 50090914, "body": "<i>In the question body</i>"}, {"owner": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1435167226, "post_id": 31033049, "comment_id": 50090982, "body": "@EugeneSh. The problem was described in the question body, right at the top."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "edited": false, "score": 0, "creation_date": 1435167305, "post_id": 31033049, "comment_id": 50091030, "body": "@Jashaszun One can <i>deduce</i> the problem from that info. But the real description is in the comment."}, {"owner": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1435167475, "post_id": 31033049, "comment_id": 50091140, "body": "@EugeneSh. I&#39;m not sure what you mean. Everything the asker wrote in the comment is also right at the top of his/her question. Nothing new of consequence was added in the comment. The problem was pretty clear to me just from the question."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1435169256, "post_id": 31033049, "comment_id": 50092244, "body": "&quot;The 1st line of the input consists of 4 integers&quot; --&gt; Hmmm, <code>Sample Input : 3 8 1515</code> looks like 3 numbers, not 4."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1435169548, "post_id": 31033049, "comment_id": 50092376, "body": "Using <code>fabs()</code> in <code>l3=l2+fabs(x1-x2);</code> is questionable.  Why use a FP absolute value here?"}, {"owner": {"reputation": 111, "user_id": 4083662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cf42a6c7e933f7579ec4d4758f95a6?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/4083662/amit"}, "edited": false, "score": 0, "creation_date": 1435171156, "post_id": 31033049, "comment_id": 50093244, "body": "@clux if co ordinates are in 2nd,3rd or 4th quadrant then in order to calculate length width we have to take absolute value."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1437059847, "post_id": 31033049, "comment_id": 50883282, "body": "Rather than use <code>fabs()</code>, for floating point, use <code>abs()</code> for integers."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1435168033, "post_id": 31033181, "comment_id": 50091481, "body": "Replace the second two tests <code>&lt;</code> with <code>&gt;</code> such that <code>(x1+w1) &gt; (x2+w2)</code> etc."}, {"owner": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1435168070, "post_id": 31033181, "comment_id": 50091505, "body": "@WeatherVane Ah yes, of course. Thank you for the correction!"}, {"owner": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1435168222, "post_id": 31033181, "comment_id": 50091610, "body": "@WeatherVane Yes, well not all of us have access to a C runtime when answering questions. There&#39;s no need to be sardonic, especially when I was nice enough to thank you."}, {"owner": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1435168290, "post_id": 31033181, "comment_id": 50091662, "body": "@WeatherVane Hahaha yeah that&#39;s what I meant. Sorry, getting questions confused."}, {"owner": {"reputation": 111, "user_id": 4083662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cf42a6c7e933f7579ec4d4758f95a6?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/4083662/amit"}, "edited": false, "score": 0, "creation_date": 1435170956, "post_id": 31033181, "comment_id": 50093125, "body": "@Jashaszun,Weather Vane i tried this code but for above mentioned input I&#39;m getting 2 6 17 16 so I replaced max_l with max_w and vice versa so i got correct answer. for that case it&#39;s not getting in other cases like 2 1 1 2 and 2 4 1 1 output should be  2 1 1 4 but its giving 2 1 2 4"}], "tags": [], "owner": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "is_accepted": false, "score": 1, "last_activity_date": 1435168079, "last_edit_date": 1435168079, "creation_date": 1435166917, "answer_id": 31033181, "question_id": 31033049, "link": "https://stackoverflow.com/questions/31033049/calculate-co-ordinates-of-lower-left-corner-of-minimum-enclosing-rectangle-and-l/31033181#31033181", "title": "calculate co-ordinates of lower left corner of minimum enclosing rectangle and length and width provided 2 rectangle", "body": "<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    int x1, y1, x2, y2, l1, w1, l2, w2;\n    scanf(\"%d %d %d %d\",&amp;x1,&amp;y1,&amp;l1,&amp;w1);\n    scanf(\"\\n%d %d %d %d\",&amp;x2,&amp;y2,&amp;l2,&amp;w2);\n\n    int min_x = x1 &lt; x2 ? x1 : x2;\n    int min_y = y1 &lt; y2 ? y1 : y2;\n    int max_x = (x1+w1) &gt; (x2+w2) ? (x1+w1) : (x2+w2);\n    int max_y = (y1+l1) &gt; (y2+l2) ? (y1+l1) : (y2+l2);\n\n    int max_w = max_x - min_x;\n    int max_l = max_y - min_y;\n\n    printf(\"%d %d %d %d\", min_x, min_y, max_l, max_w);\n    return 0;\n}\n</code></pre>\n\n<p>This is assuming that your widths are in the x direction and your lengths are in the y direction. If it is the other way, it should not be too hard to change.</p>\n"}, {"tags": [], "owner": {"reputation": 7, "user_id": 5116010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294a808399f005a97dad8b7f315f1352?s=128&d=identicon&r=PG&f=1", "display_name": "620d", "link": "https://stackoverflow.com/users/5116010/620d"}, "is_accepted": false, "score": 0, "last_activity_date": 1437059210, "last_edit_date": 1495540696, "creation_date": 1437059210, "answer_id": 31457992, "question_id": 31033049, "link": "https://stackoverflow.com/questions/31033049/calculate-co-ordinates-of-lower-left-corner-of-minimum-enclosing-rectangle-and-l/31457992#31457992", "title": "calculate co-ordinates of lower left corner of minimum enclosing rectangle and length and width provided 2 rectangle", "body": "<p>I have faced the same problem in the online course...\nhere is my link to the question.\n<a href=\"https://stackoverflow.com/questions/31434628/union-of-two-rectangles-write-a-program-to-find-the-smallest-possible-rectangle\">union of two rectangles.write a program to find the smallest possible rectangle enclosing the 2 given rectangles</a>\nand my program which is working and is accepted without any error or \"wrong answer\"..</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main() {\n  int x1, x2, y1, y2, l1, l2, w1, w2, xmax, xmin, ymax, ymin;\n  scanf(\u201c%d %d %d %d\\n\u201d,&amp;x1,&amp;y1,&amp;l1,&amp;w1);\n  scanf(\u201c%d %d %d %d\\n\u201d,&amp;x2,&amp;y2,&amp;l2,&amp;w2);\n  xmin = x1 &lt; x2 ? x1 : x2;\n  ymin = y1 &lt; y2 ? y1 : y2;\n  int b = x1 + l1;\n  int c = x2 + l2;\n  xmax = b &gt; c ? b : c;\n  int d = y1 + w1;\n  int e = y2 + w2;\n  ymax = d &gt; e ? d : e;\n  int l = xmax - xmin;\n  int w = ymax - ymin;\n  printf(\u201c%d %d %d %d\u201d,xmin,ymin,l,w);\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 4083662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cf42a6c7e933f7579ec4d4758f95a6?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/4083662/amit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3351, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1437059210, "creation_date": 1435166474, "last_edit_date": 1435166714, "question_id": 31033049, "link": "https://stackoverflow.com/questions/31033049/calculate-co-ordinates-of-lower-left-corner-of-minimum-enclosing-rectangle-and-l", "title": "calculate co-ordinates of lower left corner of minimum enclosing rectangle and length and width provided 2 rectangle", "body": "<p>Input and Output Format:</p>\n\n<p>The 1st line of the input consists of 4 integers separated by a space that correspond to x, y, l and w of the first rectangle.\nThe 2nd line of the input consists of 4 integers separated by a space that correspond to x, y, l and w of the second rectangle.</p>\n\n<p>Output consists of 4 integers that correspond to x, y, l and w of the Union rectangle.</p>\n\n<pre><code>Sample Input :\n3 8 1515\n2 6 10 10\nSample Output:\n2 6 16 17\n</code></pre>\n\n<p>here is my code\nit gets validated for some test cases and it is not accepted when I submit it.\nI'm trying this on an online coding website. \nhere is my code.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\nint main()\n{\n    int x1,y1,x2,y2,l1,w1,l2,w2,x3,y3,l3,w3;\n    scanf(\"%d %d %d %d\",&amp;x1,&amp;y1,&amp;l1,&amp;w1);\n    scanf(\"\\n%d %d %d %d\",&amp;x2,&amp;y2,&amp;l2,&amp;w2);\n    if(x1&lt;x2)\n        x3=x1;\n    else\n        x3=x2;\n    if(y1&lt;y2)\n        y3=y1;\n    else\n        y3=y2;\n    if(x1==x2)\n    {\n        if(l1&lt;l2)\n            w3=l2;\n        else\n            w3=l1;\n    }\n    if(y1==y2)\n    { \n        // printf(\"inp\");\n        if(w1&lt;w2) \n        {\n            w3=w2;\n            //printf(\"%d\",w3);\n        }\n        else\n        {\n            w3=w1;\n        }\n    }\n    if(x1&lt;x2)\n        l3=l2+fabs(x1-x2);\n    else if(x2&lt;x1)\n        l3=l1+fabs(x1-x2);\n    if(y1&lt;y2)\n        w3=w2+fabs(y1-y2);\n    else if(y2&lt;y1)\n        w3=w1+fabs(y1-y2);\n    printf(\"%d \",x3);\n    printf(\"%d \",y3);\n    printf(\"%d \",l3);\n    printf(\"%d\",w3);\n    return 0;\n}\n</code></pre>\n\n<p>if anyone have alternative logic then tell me.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 3, "creation_date": 1435166493, "post_id": 31032971, "comment_id": 50090561, "body": "For one thing, you are using the wrong format specifier - <a href=\"http://stackoverflow.com/questions/9053658/correct-format-specifier-to-print-pointer-address\">Correct format specifier to print pointer (address)?</a>"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1435166686, "post_id": 31032971, "comment_id": 50090670, "body": "You have not enabled strict enough warnings on your compiler, or you are ignoring them."}, {"owner": {"reputation": 9157, "user_id": 1794803, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f3b30f8ee9338ee3d87152343ceb0665?s=128&d=identicon&r=PG", "display_name": "Peregring-lk", "link": "https://stackoverflow.com/users/1794803/peregring-lk"}, "edited": false, "score": 0, "creation_date": 1435167989, "post_id": 31032971, "comment_id": 50091456, "body": "@DieterL&#252;cking Is not a specific fault of <code>msvc</code>. C11 and forerunners are backward compatible with very old versions of C. But ok, warnings will be welcome (and AFAIK gcc warns you by default)."}], "answers": [{"comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 5413, "user_id": 1743849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5cwvZ.jpg?s=128&g=1", "display_name": "rakeb.mazharul", "link": "https://stackoverflow.com/users/1743849/rakeb-mazharul"}, "edited": false, "score": 0, "creation_date": 1435166820, "post_id": 31033065, "comment_id": 50090749, "body": "@rakeb.void not at all, sorry !"}, {"owner": {"reputation": 9157, "user_id": 1794803, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f3b30f8ee9338ee3d87152343ceb0665?s=128&d=identicon&r=PG", "display_name": "Peregring-lk", "link": "https://stackoverflow.com/users/1794803/peregring-lk"}, "edited": false, "score": 0, "creation_date": 1435166917, "post_id": 31033065, "comment_id": 50090811, "body": "Again, <code>disk_test.c</code>, not <code>disk_test.h</code> xD"}, {"owner": {"reputation": 801, "user_id": 2707197, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b9639bc11c8cd31c5dcbd3d20db4d347?s=128&d=identicon&r=PG&f=1", "display_name": "RebeccaK375", "link": "https://stackoverflow.com/users/2707197/rebeccak375"}, "edited": false, "score": 0, "creation_date": 1435166997, "post_id": 31033065, "comment_id": 50090849, "body": "Thank you for your answers. I tried this declaration in both: disk.h and disk.c and both worked. Is including it in disk.c a convention? or is there another reason for this choice?"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 9157, "user_id": 1794803, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f3b30f8ee9338ee3d87152343ceb0665?s=128&d=identicon&r=PG", "display_name": "Peregring-lk", "link": "https://stackoverflow.com/users/1794803/peregring-lk"}, "edited": false, "score": 0, "creation_date": 1435167018, "post_id": 31033065, "comment_id": 50090862, "body": "@Peregring-lk wait, what ? Now you confused me. The definition is in <code>disk.c</code>, so the prototype should be in <code>disk.h</code>. This answer is a trainwreck x)"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 801, "user_id": 2707197, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b9639bc11c8cd31c5dcbd3d20db4d347?s=128&d=identicon&r=PG&f=1", "display_name": "RebeccaK375", "link": "https://stackoverflow.com/users/2707197/rebeccak375"}, "edited": false, "score": 0, "creation_date": 1435167336, "post_id": 31033065, "comment_id": 50091056, "body": "@user2707197 you probably mean <code>disk.h</code> and <code>disk_test.c</code> (<code>disk.c</code> already has the function signature where you defined it). As this function is to be used with your <code>generic_attribute</code> struct, it makes more sense to declare it along with the struct. On a technical level, there&#39;s no difference as long as the compiler encounters the signature before the function call."}, {"owner": {"reputation": 9157, "user_id": 1794803, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f3b30f8ee9338ee3d87152343ceb0665?s=128&d=identicon&r=PG", "display_name": "Peregring-lk", "link": "https://stackoverflow.com/users/1794803/peregring-lk"}, "edited": false, "score": 0, "creation_date": 1435167675, "post_id": 31033065, "comment_id": 50091261, "body": "Ah ok hahahaha. I&#39;m sorry. Both alternatives are possible: adding the function declaration again in <code>disk_test.c</code>, or directly in <code>disk.h</code> which is already included (the best alternative, portable and so on). And I thought initially you meant the first option, and so, there is the confusion."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 9157, "user_id": 1794803, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f3b30f8ee9338ee3d87152343ceb0665?s=128&d=identicon&r=PG", "display_name": "Peregring-lk", "link": "https://stackoverflow.com/users/1794803/peregring-lk"}, "edited": false, "score": 0, "creation_date": 1435168148, "post_id": 31033065, "comment_id": 50091562, "body": "@Peregring-lk this, and my lack of coffee (which is now fixed !) :p"}, {"owner": {"reputation": 801, "user_id": 2707197, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b9639bc11c8cd31c5dcbd3d20db4d347?s=128&d=identicon&r=PG&f=1", "display_name": "RebeccaK375", "link": "https://stackoverflow.com/users/2707197/rebeccak375"}, "edited": false, "score": 0, "creation_date": 1435168264, "post_id": 31033065, "comment_id": 50091638, "body": "Ahhh, I see now! All cleared up thanks to your lively discussion."}], "tags": [], "owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "is_accepted": true, "score": 4, "last_activity_date": 1435167024, "last_edit_date": 1435167024, "creation_date": 1435166509, "answer_id": 31033065, "question_id": 31032971, "link": "https://stackoverflow.com/questions/31032971/casting-a-pointer-in-c/31033065#31033065", "title": "Casting a pointer in C", "body": "<p>You did not declare <code>construct_generic_attribute()</code> in <code>disk.h</code>, so upon seeing the function call the compiler assumes it has the default signature -- that is, <code>int construct_generic_attribute();</code>.</p>\n\n<p>Thanks for questioning this instead of blindly adding the cast (which could have seemed to work !)</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1435166901, "post_id": 31033075, "comment_id": 50090804, "body": "@Quentin That is fine if the disk_test.c is in the same library (program). Not exposing internals, but getting maintainability issues."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1435167115, "post_id": 31033075, "comment_id": 50090918, "body": "@DieterL&#252;cking I completely failed here. Sorry for the mess !"}], "tags": [], "owner": {"reputation": 128, "user_id": 4036145, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emGDL.jpg?s=128&g=1", "display_name": "NightWatcher", "link": "https://stackoverflow.com/users/4036145/nightwatcher"}, "is_accepted": false, "score": 1, "last_activity_date": 1435167126, "last_edit_date": 1435167126, "creation_date": 1435166546, "answer_id": 31033075, "question_id": 31032971, "link": "https://stackoverflow.com/questions/31032971/casting-a-pointer-in-c/31033075#31033075", "title": "Casting a pointer in C", "body": "<p>add following line in <code>disk_test.c</code> :</p>\n\n<p><code>struct generic_attribute* construct_generic_attribute(char* ,int);</code></p>\n"}, {"tags": [], "owner": {"reputation": 356, "user_id": 3799721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bafefe5ab3af6279c0340382b6f7a5ca?s=128&d=identicon&r=PG", "display_name": "Caleb An", "link": "https://stackoverflow.com/users/3799721/caleb-an"}, "is_accepted": false, "score": 2, "last_activity_date": 1435166728, "creation_date": 1435166728, "answer_id": 31033131, "question_id": 31032971, "link": "https://stackoverflow.com/questions/31032971/casting-a-pointer-in-c/31033131#31033131", "title": "Casting a pointer in C", "body": "<p>You are missing the function declaration in your header file, disk.h.</p>\n\n<p>add the declaration: \n    <code>struct generic_attribute* construct_generic_attribute(char* ,int);</code></p>\n\n<p>and the compiler will know the return type of your function is a pointer. </p>\n"}], "owner": {"reputation": 801, "user_id": 2707197, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b9639bc11c8cd31c5dcbd3d20db4d347?s=128&d=identicon&r=PG&f=1", "display_name": "RebeccaK375", "link": "https://stackoverflow.com/users/2707197/rebeccak375"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 31033065, "answer_count": 3, "score": 0, "last_activity_date": 1435167126, "creation_date": 1435166203, "last_edit_date": 1435166367, "question_id": 31032971, "link": "https://stackoverflow.com/questions/31032971/casting-a-pointer-in-c", "title": "Casting a pointer in C", "body": "<p>I created a function which returns a pointer to an object of a self-made structure. Then, I declared another pointer which I set equal to a pointer returned by the the aforementioned function. I get the error \"Assignment makes pointer from integer without a cast\" - but I do not understand why I should be casting... because all of these pointers were declared to be of the same type.</p>\n\n<p>In disk.h I defined the following:</p>\n\n<pre><code>struct generic_attribute{\n    char *name;\n    int current_value;\n    int previous_value;\n    //int time_series[500];\n};\n</code></pre>\n\n<p>In disk.c, I made a constructor for generic_attribute like so:</p>\n\n<pre><code>#include \"disk.h\"\n#include &lt;stdlib.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nstruct generic_attribute* construct_generic_attribute(char* name, int current_value){\n    struct generic_attribute *ga_ptr;\n    //ga_ptr = (struct generic_attribute*) malloc (sizeof(struct generic_attribute));\n    ga_ptr = malloc (sizeof (struct generic_attribute));\n    ga_ptr -&gt; name = name;\n    ga_ptr -&gt; current_value = current_value;\n    ga_ptr -&gt; previous_value = 0;\n    return ga_ptr;\n}\n</code></pre>\n\n<p>In disk_test.c I want to test this constructor:</p>\n\n<pre><code>#include \"disk.h\"\n#include &lt;stdlib.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid test_generic_attribute_constructor(char* name, int current_value){\n    struct generic_attribute* ga_ptr;\n    ga_ptr = construct_generic_attribute(name, current_value);\n    printf(\"%i\\n\", construct_generic_attribute(name, current_value));\n}\n\nint main() {\n    test_generic_attribute_constructor(\"test\", 2000);\n}\n</code></pre>\n\n<p>I get the error on this line:</p>\n\n<pre><code>ga_ptr = construct_generic_attribute(name, current_value);\n</code></pre>\n\n<p>I do not understand why. <code>ga_pointer</code> was declared as a pointer to type <code>struct generic_attribute</code>. So was the return of function <code>construct_generic_attribute</code>. I am new to C, so I might be misunderstanding how all of this works. </p>\n"}, {"tags": ["c", "singly-linked-list"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1435166155, "post_id": 31032787, "comment_id": 50090340, "body": "<code>int x,y;</code> --&gt; <code>float x,y;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 2, "last_activity_date": 1435165924, "creation_date": 1435165924, "answer_id": 31032881, "question_id": 31032787, "link": "https://stackoverflow.com/questions/31032787/storing-more-than-one-data-item-in-single-linked-list/31032881#31032881", "title": "Storing more than one data item in single linked list", "body": "<p>You have a mistake in the <code>print()</code> function</p>\n\n<pre><code>while (head!=NULL)\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>while (temp!=NULL)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 356, "user_id": 3799721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bafefe5ab3af6279c0340382b6f7a5ca?s=128&d=identicon&r=PG", "display_name": "Caleb An", "link": "https://stackoverflow.com/users/3799721/caleb-an"}, "is_accepted": false, "score": 2, "last_activity_date": 1435165924, "creation_date": 1435165924, "answer_id": 31032882, "question_id": 31032787, "link": "https://stackoverflow.com/questions/31032787/storing-more-than-one-data-item-in-single-linked-list/31032882#31032882", "title": "Storing more than one data item in single linked list", "body": "<p>It's because instead of checking if temp is null in your while loop, you check for head. Change that to temp and it will not be stuck in a loop. </p>\n\n<pre><code>while(head!=NULL) \n</code></pre>\n\n<p>should be</p>\n\n<pre><code>while(temp!=NULL)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "is_accepted": false, "score": 0, "last_activity_date": 1435166491, "last_edit_date": 1435166491, "creation_date": 1435166062, "answer_id": 31032928, "question_id": 31032787, "link": "https://stackoverflow.com/questions/31032787/storing-more-than-one-data-item-in-single-linked-list/31032928#31032928", "title": "Storing more than one data item in single linked list", "body": "<p>In your print function, in the while loop you need to check for <code>temp != NULL</code> because that's the pointer you use to traverse the list.</p>\n\n<p>Apart from that I'd advice against using a global variable for your list. Make the head pointer a parameter of your functions.</p>\n\n<p>For clarity I'd also rename <code>temp</code> to something more meaningful, like iterator, at least in your print function.</p>\n\n<p>And as BLUEPIXY pointed out you need to change the type of some variables inside main to reflect what you want <code>scanf</code> to read.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1435166267, "creation_date": 1435166267, "answer_id": 31032990, "question_id": 31032787, "link": "https://stackoverflow.com/questions/31032787/storing-more-than-one-data-item-in-single-linked-list/31032990#31032990", "title": "Storing more than one data item in single linked list", "body": "<p>Two issues:</p>\n\n<ol>\n<li>You're reading in <code>x</code> and <code>y</code> as <code>float</code>, but the variables are of type <code>int</code>.  Since a <code>float</code> is larger than an <code>int</code>, memory gets written to that shouldn't, resulting in undefined behavior.</li>\n<li>When printing the results, you're checking for <code>head!=NULL</code> instead of <code>temp!=NULL</code>.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 137, "user_id": 5030012, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IRr7hw7oqTw/AAAAAAAAAAI/AAAAAAAAAAA/4Jdj9Ku7Hrg/photo.jpg?sz=128", "display_name": "gaurav gupta", "link": "https://stackoverflow.com/users/5030012/gaurav-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1435170552, "creation_date": 1435170552, "answer_id": 31034243, "question_id": 31032787, "link": "https://stackoverflow.com/questions/31032787/storing-more-than-one-data-item-in-single-linked-list/31034243#31034243", "title": "Storing more than one data item in single linked list", "body": "<p>Adding to the above answers, you could also look to fix 2 others lines in your code:-</p>\n\n<ol>\n<li><p>Initialize pointer head to null. You should initialize the all pointers before using them otherwise the behavior will be unexpected. </p>\n\n<p>struct node *head = NULL;</p></li>\n<li><p>You should check the return value of amlloc in the function insert(). malloc() could return NULL, in case the memory allocation fails. In event when malloc() returns NULL, dereferencing a NULL pointer will cause the program to crash. You could change insert() like following.</p>\n\n<p>void insert(float x,float y) {</p>\n\n<pre><code>struct node *temp;\ntemp = (struct node*)malloc(sizeof(struct node));\n\nif (!temp) {\n    return;\n}\n\ntemp-&gt;a = x;\ntemp-&gt;b = y;\ntemp-&gt;next = head;\nhead= temp;\n</code></pre>\n\n<p>}</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 5012, "user_id": 2416647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f471b80868ae9c93d0903127ed27e2f9?s=128&d=identicon&r=PG", "display_name": "schorsch312", "link": "https://stackoverflow.com/users/2416647/schorsch312"}, "edited": false, "score": 0, "creation_date": 1511940800, "post_id": 47546894, "comment_id": 82051099, "body": "Please give a bit more of context. I did not get your answer."}], "tags": [], "owner": {"reputation": 1, "user_id": 9024163, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b12a1c39606ff7db3f1bab77eb857a08?s=128&d=identicon&r=PG", "display_name": "user9024163", "link": "https://stackoverflow.com/users/9024163/user9024163"}, "is_accepted": false, "score": -1, "last_activity_date": 1511939096, "creation_date": 1511939096, "answer_id": 47546894, "question_id": 31032787, "link": "https://stackoverflow.com/questions/31032787/storing-more-than-one-data-item-in-single-linked-list/47546894#47546894", "title": "Storing more than one data item in single linked list", "body": "<p>Above program one minor mistake is there, inside the void print function ,we should write while expression is while(temp!=NULL).</p>\n\n<p>Balaji Kumar\n29/11</p>\n"}], "owner": {"reputation": 1, "user_id": 4259414, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fAjF1vpjq-s/AAAAAAAAAAI/AAAAAAAAACo/yLkSBzWlmq4/photo.jpg?sz=128", "display_name": "kamal chhetri", "link": "https://stackoverflow.com/users/4259414/kamal-chhetri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7865, "favorite_count": 1, "answer_count": 6, "score": 0, "last_activity_date": 1511939096, "creation_date": 1435165610, "last_edit_date": 1435165811, "question_id": 31032787, "link": "https://stackoverflow.com/questions/31032787/storing-more-than-one-data-item-in-single-linked-list", "title": "Storing more than one data item in single linked list", "body": "<p>I am trying to store more than one data item in single linked list. I had tried with 2 data item , program complies with no error as, inserting data also work fine but program stop while printing output. I can't figure out whats wrong with code.\nAny help will be greatly appreciated. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct node{\n    float a;\n    float b;\n    struct node *next;\n};\n\nstruct node *head;\n\nvoid insert(float x,float y){\n    struct node *temp;\n    temp = (struct node*)malloc(sizeof(struct node));\n    temp-&gt;a = x;\n    temp-&gt;b = y;\n    temp-&gt;next = head;\n    head= temp;\n}\nvoid print(){\n    struct node *temp;\n    temp= head;\n    printf(\"\\n the linked list is :\");\n    while(head!=NULL){\n        printf(\"data is : %f %f\",temp-&gt;a,temp-&gt;b);\n        temp=temp-&gt;next;\n    }\n}\n\nint main()\n{\n    int n,i,x,y;\n    head = NULL;\n    struct node *temp;\n    printf(\"\\n enter the  number of data to enter:\");\n    scanf(\"%d\",&amp;n);\n    for(i=0;i&lt;n;i++){\n        printf(\"\\n enter x-cordinate: \\n\");\n        scanf(\"%f\",&amp;x);\n        printf(\"\\n eter y-cordinate: \\n\");\n        scanf(\"%f\",&amp;y);\n        insert(x,y);\n    }\n    print();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "embedded", "uart", "msp430"], "comments": [{"owner": {"reputation": 1809, "user_id": 951784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9858b1ffedc039e48a0ed219198d538c?s=128&d=identicon&r=PG", "display_name": "rost0031", "link": "https://stackoverflow.com/users/951784/rost0031"}, "edited": false, "score": 1, "creation_date": 1435164847, "post_id": 31032431, "comment_id": 50089491, "body": "Ok, so what&#39;s your question?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1435165352, "post_id": 31032431, "comment_id": 50089800, "body": "You&#39;ll need to write the UART input routines too, with a timeout. Make it <code>int USART0_ReadByte(void)</code> so that it can return <code>-1</code> on timeout."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435170562, "post_id": 31032431, "comment_id": 50092890, "body": "Note: do not use the built-in type names, but use <code>stdint.h</code> types. <code>uint8_t</code>, etc. Note also, there is littel gain in using <code>char</code> or 8 bit types where not needed (e.g. counters), as the MSP430 is a 16 bit CPU and all operations are done as 16 bits anyway (except for load/store which also allow for 8 bits)."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1435166456, "post_id": 31032806, "comment_id": 50090532, "body": "I would not recommend implementing an <code>ISR</code> until the polled version is working. Step by step."}, {"owner": {"reputation": 1400, "user_id": 4970622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t8sl2.jpg?s=128&g=1", "display_name": "Samurai Jack", "link": "https://stackoverflow.com/users/4970622/samurai-jack"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1435166627, "post_id": 31032806, "comment_id": 50090632, "body": "@WeatherVane: I agree if there is no other functionality except receiving data"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1435166740, "post_id": 31032806, "comment_id": 50090692, "body": "Step 1: establish the handshake. So much easier to debug inline code than an <code>ISR</code>."}], "tags": [], "owner": {"reputation": 1400, "user_id": 4970622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t8sl2.jpg?s=128&g=1", "display_name": "Samurai Jack", "link": "https://stackoverflow.com/users/4970622/samurai-jack"}, "is_accepted": false, "score": 1, "last_activity_date": 1435165675, "creation_date": 1435165675, "answer_id": 31032806, "question_id": 31032431, "link": "https://stackoverflow.com/questions/31032431/uart-for-msp430fr5969/31032806#31032806", "title": "UART for MSP430FR5969", "body": "<p>you need to write <code>UART</code> receive <code>ISR</code> routine and store data coming from <code>PAN1026</code>. Then after coming out of <code>ISR</code> you can check for data from Bluetooth and take respective decision. </p>\n"}], "owner": {"reputation": 31, "user_id": 4744362, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DGO_gJz7IuY/AAAAAAAAAAI/AAAAAAAAAC4/K0OjXW69le0/photo.jpg?sz=128", "display_name": "titouni salem", "link": "https://stackoverflow.com/users/4744362/titouni-salem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1144, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1435166281, "creation_date": 1435164462, "last_edit_date": 1435166281, "question_id": 31032431, "link": "https://stackoverflow.com/questions/31032431/uart-for-msp430fr5969", "title": "UART for MSP430FR5969", "body": "<p>I'm new for using <strong>MSP430FR5969</strong>. </p>\n\n<p>I want to program my uart1 to connect the bluetooth <strong>PAN1026</strong> with my <strong>MSP430</strong>.</p>\n\n<p>at the begining I send a rest mode <code>{ 0x01, 0x03,0x0c,0x00 }</code> and the bluetooth must answer me<br>\n<code>{ 0x04,0x0e,0x04,0x04,0x03,0x0c,0x00 }</code></p>\n\n<p>So I want to put a condition on <code>UCA1RXBUF</code> it must be equal to <code>{ 0x04,0x0e,0x04,0x04,0x03,0x0c,0x00 }</code> until I pass to the second step</p>\n\n<p>else I redo the first step.</p>\n\n<p>Here is my code.</p>\n\n<pre><code>    #include \"usart.h\"\n    void USART0_Init (void) {   // Controller -&gt; PC\n    P2SEL1 |= BIT0| BIT1;                    // Configure UART pins\n      P2SEL0 &amp;= ~(BIT0| BIT1);\n\n      // Disable the GPIO power-on default high-impedance mode to activate\n      // previously configured port settings\n      PM5CTL0 &amp;= ~LOCKLPM5;\n\n      // Startup clock system with max DCO setting ~8MHz\n      CSCTL0_H = CSKEY &gt;&gt; 8;                    // Unlock clock registers\n      CSCTL1 = DCOFSEL_3 | DCORSEL;             // Set DCO to 8MHz\n      CSCTL2 = SELA__VLOCLK | SELS__DCOCLK | SELM__DCOCLK;\n      CSCTL3 = DIVA__1 | DIVS__1 | DIVM__1;     // Set all dividers\n      CSCTL0_H = 0  ;                           // Lock CS registers\n\n      // Configure USCI_A1 for UART mode\n      UCA0CTLW0 = UCSWRST;                      // Put eUSCI in reset\n      UCA0CTLW0 |= UCSSEL__SMCLK;               // CLK = SMCLK\n      UCA0BR0 = 4;     //4;                             // 8000000/16/115200\n      UCA0BR1 = 0x00;\n      UCA0MCTLW |= 0x55;                         //UCOS16 | UCBRF_1;\n      UCA0CTLW0 &amp;= ~UCSWRST;                    // Initialize eUSCI\n     // UCA0IE |= UCRXIE;                         // Enable USCI_A0 RX interrupt\n\n}\nvoid USART1_Init (void) {   // Controller &lt;-&gt; PAN1026\n\n    P2SEL1 |= BIT5| BIT6;                    // Configure UART pins\n      P2SEL0 &amp;= ~(BIT5| BIT6);\n\n      // Configure USCI_A1 for UART mode\n      UCA1CTLW0 = UCSWRST;                      // Put eUSCI in reset\n      UCA1CTLW0 |= UCSSEL__SMCLK;               // CLK = SMCLK\n      UCA1BR0 = 4;                             // 8000000/16/115200\n      UCA1BR1 = 0x00;\n      UCA1MCTLW |=0x55; //UCOS16 | UCBRF_1;\n      UCA1CTLW0 &amp;= ~UCSWRST;                    // Initialize eUSCI\n     // UCA1IE |= UCRXIE;                         // Enable USCI_A0 RX interrupt\n}\nvoid USART0_SendByte (unsigned char data) {\n    while(!(UCA0IFG &amp; UCTXIFG));\n    UCA0TXBUF = data;\n}\nvoid USART1_SendByte (unsigned char data) {\n    while(!(UCA1IFG &amp; UCTXIFG));\n    UCA1TXBUF = data;\n}\nvoid USART0_SendData (unsigned char data[], unsigned char length) {\n    unsigned char i;\n\n    for(i=0; i&lt;length; i++) {\n        USART0_SendByte(data[i]);\n    }\n}\nvoid USART1_SendData (unsigned char data[], unsigned char length) {\n\n    unsigned char i;\n\n    for(i=0; i&lt;length; i++) {\n        USART1_SendByte(data[i]);\n    }\n}\n----------------------------------------------------------------------------------------------------------------------\n#include &lt;msp430.h&gt;\n// Header files\n#include \"usart.h\"\n\nunsigned char TCU_HCI_RESET_REQ[4] = {0x01, 0x03, 0x0c, 0x00};\n\nvoid main(void) {\n\n        WDT_A_hold(WDT_A_BASE);\n\n    USART0_Init();\n    USART1_Init();\nwhile(1){\n    USART0_SendData(TCU_HCI_RESET_REQ,4);\n    USART1_SendData(TCU_HCI_RESET_REQ,4);\n    __delay_cycles(150000);\n}\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2667, "user_id": 4958370, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J6Dhp.png?s=128&g=1", "display_name": "Sourav Kanta", "link": "https://stackoverflow.com/users/4958370/sourav-kanta"}, "edited": false, "score": 6, "creation_date": 1435163141, "post_id": 31031926, "comment_id": 50088431, "body": "Try using Ctrl+d or Ctrl+Z"}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 1, "creation_date": 1435163258, "post_id": 31031926, "comment_id": 50088495, "body": "If you mean you&#39;re typing the two characters <code>-1</code> then it won&#39;t stop (the characters will just be echoed.  EOF is signalled by the end of the file: either <code>Ctrl-Z</code> (Windows) or <code>Ctrl-D</code> (Unix)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1435164634, "post_id": 31031926, "comment_id": 50089360, "body": "Note that in a Windows console, the <code>Ctrl-Z</code> will only be recognised as <code>EOF</code> when it immediately follows a <code>newline</code>, otherwise it is treated as value <code>26</code>."}], "answers": [{"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 2, "last_activity_date": 1435163247, "creation_date": 1435163247, "answer_id": 31032005, "question_id": 31031926, "link": "https://stackoverflow.com/questions/31031926/while-loop-keeps-repeating-itself/31032005#31032005", "title": "while loop keeps repeating itself", "body": "<p><code>-1</code> is actually two separate characters <code>-</code> and <code>1</code> which is not equivalent to EOF. Use <kbd>Ctrl</kbd> + <kbd>d</kbd> on Linux or <kbd>Ctrl</kbd> + <kbd>z</kbd> on Windows.</p>\n"}, {"tags": [], "owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": false, "score": 2, "last_activity_date": 1435163256, "creation_date": 1435163256, "answer_id": 31032013, "question_id": 31031926, "link": "https://stackoverflow.com/questions/31031926/while-loop-keeps-repeating-itself/31032013#31032013", "title": "while loop keeps repeating itself", "body": "<p>As @SouravKanta alludes to: your loop is reading individual characters one at a time, so if you enter -1, it reads the <code>-</code> and then the <code>1</code>, neither of which indicates EOF.  I believe <em>Cntl-d</em> is what you want, at least in *nix (you don't specify the platform).</p>\n"}], "owner": {"reputation": 53, "user_id": 1545999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47d069e99e07f76718425ce1ef0f0854?s=128&d=identicon&r=PG", "display_name": "Higgs", "link": "https://stackoverflow.com/users/1545999/higgs"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "closed_date": 1435163322, "answer_count": 2, "score": -1, "last_activity_date": 1435163256, "creation_date": 1435163028, "question_id": 31031926, "link": "https://stackoverflow.com/questions/31031926/while-loop-keeps-repeating-itself", "closed_reason": "Duplicate", "title": "while loop keeps repeating itself", "body": "<p>I've code:</p>\n\n<pre><code>int c;\nwhile((c = getchar()) != EOF)\n    putchar(c);\n</code></pre>\n\n<p>As I know EOF is equal to -1\nI read -1 from keyboard(input stream) and it must stop itself,but loop keeps repeating.\nwhy?</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 3, "creation_date": 1435162810, "post_id": 31031768, "comment_id": 50088212, "body": "Why don&#39;t you think this code works?  What indication do you have of this?  <i>Describe the problem.</i>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1435163115, "post_id": 31031768, "comment_id": 50088416, "body": "<code>int a;</code> --&gt; <code>int a=1;</code>, <code>s-&gt;last=0;</code> --&gt; <code>s-&gt;last=-1;</code>, <code>init(s);</code> --&gt; <code>init(&amp;s);</code>, <code>insert(s);</code> --&gt; <code>insert(&amp;s);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 5413, "user_id": 1743849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5cwvZ.jpg?s=128&g=1", "display_name": "rakeb.mazharul", "link": "https://stackoverflow.com/users/1743849/rakeb-mazharul"}, "is_accepted": true, "score": 2, "last_activity_date": 1436756488, "last_edit_date": 1436756488, "creation_date": 1435162790, "answer_id": 31031852, "question_id": 31031768, "link": "https://stackoverflow.com/questions/31031768/new-programmer-here-whats-wrong-with-this-stack-program/31031852#31031852", "title": "new programmer here,whats wrong with this stack program?", "body": "<p>In function <code>insert()</code>, you declared </p>\n\n<pre><code>int a;\n</code></pre>\n\n<p>and then without initializing <code>a</code> you are doing the following,</p>\n\n<pre><code>while(a!=0)\n</code></pre>\n\n<p>will give <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">Undefined Behaviour</a>.</p>\n\n<p>The following lines can leads buffer overflow,</p>\n\n<pre><code>s-&gt;last++; \ns-&gt;x[s-&gt;last]=i; // no restriction applied on last\n</code></pre>\n\n<p><code>last</code> can be more than <code>9</code> which can cause buffer overflow as <code>x[10]</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 5045463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aed33df15cf2b94c5d942a0d4793531?s=128&d=identicon&r=PG&f=1", "display_name": "harilocked", "link": "https://stackoverflow.com/users/5045463/harilocked"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1435165131, "accepted_answer_id": 31031852, "answer_count": 1, "score": -4, "last_activity_date": 1436756488, "creation_date": 1435162566, "last_edit_date": 1435163008, "question_id": 31031768, "link": "https://stackoverflow.com/questions/31031768/new-programmer-here-whats-wrong-with-this-stack-program", "closed_reason": "Not suitable for this site", "title": "new programmer here,whats wrong with this stack program?", "body": "<p>when i execute it the function do not work why?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nstruct stack{\n\nint x[10];\n\nint last;\n};\n\nvoid init(struct stack *s)\n{\n\n    s-&gt;last=0;\n}\n\n void insert(struct stack *s)\n    {\n        int a;\n\n        while(a!=0)\n        {\n        int i;\n        printf(\"Enter the value\\n\");\n\n        scanf(\"%d\",&amp;i);\n\n        s-&gt;last++;\n\n        s-&gt;x[s-&gt;last]=i;\n        printf(\"%d\",s-&gt;x[s-&gt;last]);\n        printf(\"enter 1 to continue 0 to exit\\n\");\n        scanf(\"%d\",&amp;a);\n\n    }\n    }\n\nint main()\n{\n\n    struct stack s;\n\n    int y,z;\n\n    printf(\"Trying out stacks\\n\");\n\n    printf(\"\\n______________\\n\");\n\n    init(s);\n\n    insert(s);\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "memory", "malloc", "heap"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 6, "creation_date": 1435162871, "post_id": 31031742, "comment_id": 50088254, "body": "Yes, malloc has overhead. That&#39;s completely implementation-specific. But in general your program will be more memory-efficient if it uses fewer large allocations rather than many small allocations."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 1, "creation_date": 1435162996, "post_id": 31031742, "comment_id": 50088336, "body": "It&#39;s implementation defined. However, in any case there is some overhead to manage the allocated memory. You may start reading at: <a href=\"https://en.wikipedia.org/?title=Memory_management\" rel=\"nofollow noreferrer\">en.wikipedia.org/?title=Memory_management</a>"}, {"owner": {"reputation": 15322, "user_id": 291737, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/432bda8139dee981e1411f40cab0a13e?s=128&d=identicon&r=PG", "display_name": "StilesCrisis", "link": "https://stackoverflow.com/users/291737/stilescrisis"}, "edited": false, "score": 0, "creation_date": 1435170296, "post_id": 31031742, "comment_id": 50092752, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/1119134/how-do-malloc-and-free-work\">How do malloc() and free() work?</a>"}, {"owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "edited": false, "score": 0, "creation_date": 1435172526, "post_id": 31031742, "comment_id": 50094065, "body": "While the question is basically the same, the answers have less exposition over there than here."}], "answers": [{"tags": [], "owner": {"reputation": 26917, "user_id": 1892179, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/umfON.jpg?s=128&g=1", "display_name": "Theodoros Chatzigiannakis", "link": "https://stackoverflow.com/users/1892179/theodoros-chatzigiannakis"}, "is_accepted": false, "score": 1, "last_activity_date": 1435162695, "creation_date": 1435162695, "answer_id": 31031821, "question_id": 31031742, "link": "https://stackoverflow.com/questions/31031742/malloc-and-heap-extra-memory-for-storing-the-size-and-linked-list-information/31031821#31031821", "title": "malloc and heap: extra memory for storing the size and linked list information?", "body": "<p>Yes, it is possible for an implementation of <code>malloc</code> to actually allocate a little more memory than what you requested, store the size of the allocated memory at the start of the allocated memory, then give you a pointer to the immediate next memory address. When you call <code>free</code> on that pointer, the allocator will go back a little, read the size of the buffer, and figure out how much it needs to actually release.</p>\n\n<p>But of course, another possible implementation could keep a list, or a dictionary, or do something entirely different under the hood, as long as it gives you the same specified behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "is_accepted": false, "score": 2, "last_activity_date": 1435162778, "creation_date": 1435162778, "answer_id": 31031846, "question_id": 31031742, "link": "https://stackoverflow.com/questions/31031742/malloc-and-heap-extra-memory-for-storing-the-size-and-linked-list-information/31031846#31031846", "title": "malloc and heap: extra memory for storing the size and linked list information?", "body": "<p>Memory allocation is dependent on the compiler libraries and the operating system.  </p>\n\n<p>Both languages don't state a maximum amount of memory that can be allocated.  All you are guaranteed is the requested size.  </p>\n\n<p>So if there is any additional memory allocated, it would be platform dependent.  </p>\n\n<p>Also, there may be less overhead when allocating larger spaces.  </p>\n\n<p>Try writing your own memory allocator and see what is needed, especially when desposing the memory.</p>\n"}, {"comments": [{"owner": {"reputation": 12070, "user_id": 5044950, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/9yN0x.jpg?s=128&g=1", "display_name": "Sam Estep", "link": "https://stackoverflow.com/users/5044950/sam-estep"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1435164894, "post_id": 31031883, "comment_id": 50089524, "body": "Of course. I was simplifying the situation because thinking about the case in which <code>malloc</code> fails doesn&#39;t really apply to the question."}], "tags": [], "owner": {"reputation": 12070, "user_id": 5044950, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/9yN0x.jpg?s=128&g=1", "display_name": "Sam Estep", "link": "https://stackoverflow.com/users/5044950/sam-estep"}, "is_accepted": false, "score": 1, "last_activity_date": 1435162888, "creation_date": 1435162888, "answer_id": 31031883, "question_id": 31031742, "link": "https://stackoverflow.com/questions/31031742/malloc-and-heap-extra-memory-for-storing-the-size-and-linked-list-information/31031883#31031883", "title": "malloc and heap: extra memory for storing the size and linked list information?", "body": "<p>When you allocate memory using <code>malloc</code>, all you get is a pointer to the first address in that memory and a guarantee that so many bytes have been allocated for your use. The details of <em>how</em> that memory is allocated and tracked are platform-dependent, and there is no way for you to access that information from within the program. So while extra memory may be allocated for overhead purposes, you can't use that knowledge in a cross-platform way.</p>\n"}, {"comments": [{"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 2, "creation_date": 1435164167, "post_id": 31032079, "comment_id": 50089074, "body": "it&#39;s worth noting that there are many other tricks which might cost extra space, like padding with special bitpatterns to detect out-of-bounds write or information about the allocation (which part of the code did the allocation) for debugging purposes."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1435164724, "post_id": 31032079, "comment_id": 50089419, "body": "Maybe add something about <a href=\"http://linux.die.net/man/3/malloc\" rel=\"nofollow noreferrer\">optimistic allocation</a>.  (BTW: A very good answer! )"}, {"owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1435165389, "post_id": 31032079, "comment_id": 50089828, "body": "@chux:  The man page mention of optimistic allocation is interesting, but I don&#39;t see how it fits.  I think it means <code>sbrk()</code> is optimistic and could lead to <code>malloc()</code> optimism, right?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1435168015, "post_id": 31032079, "comment_id": 50091468, "body": "OP says &quot;The actual memory space used is really 10 words?&quot; so is thinking <code>malloc()</code> and others truly <i>use</i> memory when all that really may happen was memory was marked for use, but not used yet and the &quot;extra memory&quot; may change when true use occurs. <a href=\"http://stackoverflow.com/q/19991623/2410359\">See here</a>.  If that does not help, don&#39;t bother messing your fine answer.   Note: Optimistic allocation is a separate idea from <code>sbrk()</code>."}], "tags": [], "owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "is_accepted": true, "score": 7, "last_activity_date": 1435165441, "last_edit_date": 1435165441, "creation_date": 1435163420, "answer_id": 31032079, "question_id": 31031742, "link": "https://stackoverflow.com/questions/31031742/malloc-and-heap-extra-memory-for-storing-the-size-and-linked-list-information/31032079#31032079", "title": "malloc and heap: extra memory for storing the size and linked list information?", "body": "<p>It is completely implementation dependent.</p>\n\n<p>a) It could have a few bytes before each allocated node which contains the size of the node, pointer to the next node, and maybe a previous node pointer and the type of node.</p>\n\n<p>b) The returned item may have nothing else around it except other allocations.  A structure elsewhere keeps track of what is allocated and what is free, perhaps by a bitmap or a miniature parallel list.</p>\n\n<p>c) Another variation provides several arrays of fixed sized chunks.  One array may provide 32-byte blocks; another 128-byte blocks, etc.  A bitmap for each array manages allocations.</p>\n\n<p>d) The most minimal implementation I have seen ignores <code>free()</code> completely (that is, <code>free()</code> is a no op) and allocates the next piece of the pool at each <code>malloc()</code>.</p>\n\n<hr>\n\n<p>By far, the most commonly used modern technique is <em>a</em>.   Variant <em>b</em> is used in many filesystems like NTFS and FAT.  Option <em>c</em> was/is favored in many DEC operating systems, especially for kernel use.  Option <em>d</em> is used by a few minimalist embedded environments with a suitable caveat.</p>\n\n<p>In most implementations, the requested allocation is rounded up to some natural multiple (usually of 2, 8, 16, etc.) convenient for the algorithm.  So a series of allocations of 5, 3, 8, 7, 4, 1, and 15 might each be regarded as a 16 byte request.</p>\n"}], "owner": {"reputation": 2309, "user_id": 4802797, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-qOpr0OlDCkA/AAAAAAAAAAI/AAAAAAAAALE/8bNsDCgdbuk/photo.jpg?sz=128", "display_name": "fluency03", "link": "https://stackoverflow.com/users/4802797/fluency03"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 862, "favorite_count": 0, "accepted_answer_id": 31032079, "answer_count": 4, "score": 4, "last_activity_date": 1435170111, "creation_date": 1435162473, "question_id": 31031742, "link": "https://stackoverflow.com/questions/31031742/malloc-and-heap-extra-memory-for-storing-the-size-and-linked-list-information", "title": "malloc and heap: extra memory for storing the size and linked list information?", "body": "<p>I have a simple question about the <code>heap</code> and <code>malloc</code>: </p>\n\n<p>When we allocate some memory space using <code>malloc</code> as following:</p>\n\n<pre><code>int *p;\np = (int*) malloc (10*sizeof(int));\n</code></pre>\n\n<p>It actually allocates 10 words in the heap. However, my question is: </p>\n\n<p>The actual memory space used is really 10 words? </p>\n\n<p>Or there are other extra space needed for storing the value of memory size?  </p>\n\n<p>Or, even, because the heap is structured as <em>Linked list</em>, is there other memory space being used for storing the address which points to the next node of the list in the heap? </p>\n"}, {"tags": ["c", "macos", "keychain"], "answers": [{"comments": [{"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 0, "creation_date": 1436274768, "post_id": 31264960, "comment_id": 50533590, "body": "The second example is wrong because you try to print <code>dataLen</code> before it&#39;s initialized. I don&#39;t see how zero-ing <code>attrs</code> before passing it in will make a difference, since <code>SecKeychainItemCopyContent</code> should only be writing to it and has no reason to dereference the <code>attr</code> pointer."}], "tags": [], "owner": {"reputation": 1878, "user_id": 5021778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2abb60781f429ba36bbb2e9946c9d7e?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Tsui", "link": "https://stackoverflow.com/users/5021778/eric-tsui"}, "is_accepted": true, "score": 1, "last_activity_date": 1436370086, "last_edit_date": 1436370086, "creation_date": 1436261808, "answer_id": 31264960, "question_id": 31031476, "link": "https://stackoverflow.com/questions/31031476/seckeychainitemcopycontents-is-segfaulting-on-private-keys/31264960#31264960", "title": "SecKeychainItemCopyContents is segfaulting on private keys", "body": "<p>To copy the data and/or attributes stored in the given keychain item, \nthe 3rd parameter of function <code>SecKeychainItemCopyContent()</code> is <code>SecKeychainAttributeList *attrList</code> with type like,</p>\n\n<pre><code>  struct SecKeychainAttributeList\n  {\n    UInt32 count;\n    SecKeychainAttribute *attr;\n  };\n</code></pre>\n\n<p>For this IN/OUT param <code>attrList</code>: On input, it's the list of attributes that you request to retrieve. On output, the attributes are filled in. Pass <code>NULL</code> if there is no need to retrieve any attributes, or pass an attribute list that you need to get. It should be either of these two mentioned pass in arguments. Leave it uninitialized could cause problem, like segfaulting.</p>\n\n<p>So, please try like this, it should work well. </p>\n\n<pre><code>SecKeychainAttributeList attrs = {0, NULL};\n//...  \ncheck(SecKeychainItemCopyContent(item, &amp;cls, &amp;attrs, &amp;dataLen, &amp;data));\n</code></pre>\n\n<p>or  </p>\n\n<pre><code>//SecKeychainAttributeList attrs ;\n//... \ncheck(SecKeychainItemCopyContent(item, &amp;cls, NULL, &amp;dataLen, &amp;data));\nprintf(\"Key: %d\\n\", (int)dataLen);\ncheck(SecKeychainItemFreeContent(NULL, data));\n</code></pre>\n\n<p>In case there was a need to get attributes list, the sample code could be as follows,</p>\n\n<pre><code> SecKeychainAttributeList xlist;\n SecKeychainAttribute outList[] = \n {\n    {kSecAddressItemAttr,},\n    {kSecAccountItemAttr,},\n    {kSecVolumeItemAttr,},\n    {kSecProtocolItemAttr}\n };\n\n xlist.count = sizeof(outList)/sizeof(outList[0]);\n xlist.attr = outList;\n\n //...\n err = SecKeychainItemCopyContent (itemRef, nil, &amp;xlist, &amp;len, &amp;outData);\n //...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "is_accepted": false, "score": 1, "last_activity_date": 1436277883, "creation_date": 1436277883, "answer_id": 31270826, "question_id": 31031476, "link": "https://stackoverflow.com/questions/31031476/seckeychainitemcopycontents-is-segfaulting-on-private-keys/31270826#31270826", "title": "SecKeychainItemCopyContents is segfaulting on private keys", "body": "<p>Apparently, the <code>SecKeychainAttributeList</code> parameter is not just an output. It's also an input containing the attributes to get.</p>\n\n<p><code>SecKeychainAttributeList</code> dereferenced the uninitialized <code>attrs-&gt;attr</code> pointer and crashed. Initializing the pointer to <code>NULL</code> fixes the issue.</p>\n"}], "owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 31264960, "answer_count": 2, "score": 5, "last_activity_date": 1436370086, "creation_date": 1435161771, "last_edit_date": 1435674563, "question_id": 31031476, "link": "https://stackoverflow.com/questions/31031476/seckeychainitemcopycontents-is-segfaulting-on-private-keys", "title": "SecKeychainItemCopyContents is segfaulting on private keys", "body": "<p>I'm using this code to list all private keys and get some info about them, using Apple's security framework API:</p>\n\n<pre><code>int main(int argc, const char * argv[]) {\n    const void *keys[]   = { kSecClass,    kSecReturnRef,   kSecMatchLimit,    kSecAttrKeyClass};\n    const void *values[] = { kSecClassKey, kCFBooleanTrue,  kSecMatchLimitAll, kSecAttrKeyClassPrivate};\n\n    CFDictionaryRef searchDict = CFDictionaryCreate(\n        NULL,\n        keys, values, sizeof(keys) / sizeof(keys[0]),\n        NULL, NULL\n    );\n    checkAlloc(searchDict);\n\n    CFArrayRef items;\n    check(SecItemCopyMatching(searchDict, (CFTypeRef *)&amp;items));\n\n    for(int i=0; i&lt;CFArrayGetCount(items); i++) {\n        SecKeychainItemRef item = (SecKeychainItemRef) CFArrayGetValueAtIndex(items, i);\n\n        CFShow((CFTypeRef)item);\n\n        SecItemClass cls;\n        SecKeychainAttributeList attrs;\n        UInt32 dataLen;\n        void* data;\n\n        check(SecKeychainItemCopyContent(item, &amp;cls, &amp;attrs, &amp;dataLen, &amp;data));\n\n        printf(\"Key: %d\\n\", (int)dataLen);\n\n        check(SecKeychainItemFreeContent(&amp;attrs, data));\n    }\n\n    CFRelease(items);\n    CFRelease(searchDict);\n\n    return 0;\n}\n</code></pre>\n\n<p>The call to <code>SecKeychainItemCopyContent</code> segfaults, even though none of the pointers I've been passing in are invalid.</p>\n\n<p>The <code>CFShow</code> prints lines similar to <code>&lt;SecKey 0x7fb4d9d01420 [0x7fff74790ed0]&gt;</code>, so <code>item</code> should be a <code>SecKeyRef</code>, but the <a href=\"https://developer.apple.com/library/mac/documentation/Security/Reference/certifkeytrustservices/index.html#//apple_ref/c/tdef/SecKeyRef\">documentation for it</a> says that it's OK to use a <code>SecKeyRef</code> as a <code>SecKeychainItemRef</code> if the key is in a keychain. However, I don't see any functions to find if the key is in a keychain, so I can't validate that the returned keys can be used as such.</p>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["c", "windows", "winapi", "process"], "answers": [{"tags": [], "owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "is_accepted": true, "score": 3, "last_activity_date": 1435161242, "last_edit_date": 1435161242, "creation_date": 1435160888, "answer_id": 31031165, "question_id": 31031140, "link": "https://stackoverflow.com/questions/31031140/createprocess-and-lpcommandline-lifetime/31031165#31031165", "title": "CreateProcess and lpCommandLine lifetime", "body": "<p>The buffer referred to by <code>lpCommandLine</code> needs be valid only for the duration of the call to <code>CreateProcess</code>. Once <code>CreateProcess</code> returns, it will not refer to that buffer again. </p>\n\n<p>Imagine if you did have to keep that buffer alive. Were that the case, then all parent processes would have to outlive all of their children. That's clearly a ridiculous proposition and I'm sure you will know from experience that there is not such requirement.</p>\n\n<p>There is a general principle here. By and large, API functions will not refer to their arguments after the function returns. If they do need to do so, then it will be explicitly called out in the documentation, or it will be blatantly obvious from the intent of the function. As an example of the latter I am thinking of passing a window procedure to <code>RegisterClass</code>. It is quite clear that the window procedure must remain valid for as long as there exists a window of that class.</p>\n"}], "owner": {"reputation": 5077, "user_id": 2327831, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/acb1ec5c15fa33042fa79847c55da18d?s=128&d=identicon&r=PG", "display_name": "this", "link": "https://stackoverflow.com/users/2327831/this"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 1, "accepted_answer_id": 31031165, "answer_count": 1, "score": 2, "last_activity_date": 1435161242, "creation_date": 1435160811, "question_id": 31031140, "link": "https://stackoverflow.com/questions/31031140/createprocess-and-lpcommandline-lifetime", "title": "CreateProcess and lpCommandLine lifetime", "body": "<p>I allocate memory for the parameter <code>lpCommandLine</code> in <code>CreateProcess</code> function, either with malloc or on the stack.</p>\n\n<p>Can I free/release that memory immediately after the call, or do I have to wait until the process finishes?</p>\n"}, {"tags": ["c++", "c", "pointers", "memory-management", "free"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1435159729, "post_id": 31030722, "comment_id": 50086011, "body": "Yes,  the issue if from line 237 of <code>dec.c</code> file. [Hint: How we can tell without seeing the code?]"}, {"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 1, "creation_date": 1435159772, "post_id": 31030722, "comment_id": 50086041, "body": "You&#39;re probably calling other functions which internally use free. But we can&#39;t tell if you don&#39;t provide any code."}, {"owner": {"reputation": 2017, "user_id": 4999494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e49247723efb14f33ad19a5ecdf1a4?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Balabin", "link": "https://stackoverflow.com/users/4999494/alexander-balabin"}, "edited": false, "score": 0, "creation_date": 1435159995, "post_id": 31030722, "comment_id": 50086210, "body": "freeing a rubbish pointer might be another cause"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4843530"}, "edited": false, "score": 0, "creation_date": 1435160041, "post_id": 31030722, "comment_id": 50086238, "body": "The type of app he is talking about probably has thousands of lines of code, any of which could be the problem.  It is understandable that he is not able to post any particular segment."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4843530"}, "edited": false, "score": 0, "creation_date": 1435160312, "post_id": 31030722, "comment_id": 50086427, "body": "I am suspecting a sync problem between your threads.  Perhaps one of the library calls, on the processing side, tries to use one of the pointers, before it is allocated, is unable to use it, but still tries to free it.  Since you are not using free or malloc, this is the only thing I can guess at."}, {"owner": {"reputation": 9, "user_id": 3889260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b301dab226f1e8861aaec424d39e94d?s=128&d=identicon&r=PG&f=1", "display_name": "qazmonk", "link": "https://stackoverflow.com/users/3889260/qazmonk"}, "edited": false, "score": 0, "creation_date": 1435160486, "post_id": 31030722, "comment_id": 50086561, "body": "@Gilchrist You&#39;re right it&#39;s much too long to share all of it and I don&#39;t know where it is coming from to narrow it down."}, {"owner": {"reputation": 9, "user_id": 3889260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b301dab226f1e8861aaec424d39e94d?s=128&d=identicon&r=PG&f=1", "display_name": "qazmonk", "link": "https://stackoverflow.com/users/3889260/qazmonk"}, "edited": false, "score": 0, "creation_date": 1435160528, "post_id": 31030722, "comment_id": 50086593, "body": "I suspect that it is a sync problem. Could just accessing memory that hasn&#39;t been allocated be the problem? The application also uses opencv extensively if that helps"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1435160713, "post_id": 31030722, "comment_id": 50086744, "body": "A debugger could help."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 3889260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b301dab226f1e8861aaec424d39e94d?s=128&d=identicon&r=PG&f=1", "display_name": "qazmonk", "link": "https://stackoverflow.com/users/3889260/qazmonk"}, "edited": false, "score": 0, "creation_date": 1435160641, "post_id": 31030867, "comment_id": 50086676, "body": "Thank you Volodya. I understand that my question wasn&#39;t very specific, sorry about that but I didn&#39;t know how to narrow it down more."}, {"owner": {"reputation": 9, "user_id": 3889260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b301dab226f1e8861aaec424d39e94d?s=128&d=identicon&r=PG&f=1", "display_name": "qazmonk", "link": "https://stackoverflow.com/users/3889260/qazmonk"}, "edited": false, "score": 0, "creation_date": 1435160666, "post_id": 31030867, "comment_id": 50086702, "body": "I&#39;ll check out the library but I don&#39;t explicitly do any memory management."}], "tags": [], "owner": {"reputation": 4261, "user_id": 2893496, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/WMdEs.png?s=128&g=1", "display_name": "v010dya", "link": "https://stackoverflow.com/users/2893496/v010dya"}, "is_accepted": true, "score": 1, "last_activity_date": 1435160043, "creation_date": 1435160043, "answer_id": 31030867, "question_id": 31030722, "link": "https://stackoverflow.com/questions/31030722/c-pointer-being-freed-was-not-allocated-not-calling-free/31030867#31030867", "title": "C++ Pointer being freed was not allocated. Not calling free", "body": "<p>You may want to look into using safe pointers provided in C++11. They do many good things, but for you the best use would be to take care of memory deallocation for you.</p>\n\n<p><a href=\"http://www.cplusplus.com/reference/memory/\" rel=\"nofollow\">This</a> is the library that you will need to use.</p>\n\n<p>From the little information that you have shared makes me believe that <a href=\"http://www.cplusplus.com/reference/memory/shared_ptr/\" rel=\"nofollow\">Shared Pointer</a> is what you are looking for (but do look at other classes as well, Weak Shared Pointer and Unique Pointer might be needed in some parts of your application).</p>\n\n<p>If you have any other questions, please ask a specific question.</p>\n"}], "owner": {"reputation": 9, "user_id": 3889260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b301dab226f1e8861aaec424d39e94d?s=128&d=identicon&r=PG&f=1", "display_name": "qazmonk", "link": "https://stackoverflow.com/users/3889260/qazmonk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "closed_date": 1435160464, "accepted_answer_id": 31030867, "answer_count": 1, "score": -3, "last_activity_date": 1435160043, "creation_date": 1435159651, "question_id": 31030722, "link": "https://stackoverflow.com/questions/31030722/c-pointer-being-freed-was-not-allocated-not-calling-free", "closed_reason": "Not suitable for this site", "title": "C++ Pointer being freed was not allocated. Not calling free", "body": "<p>I am writing a program that processes video input and after it runs for a while it sometimes exits with \"pointer being freed was not allocated\". However at no point in my program do I call free or malloc. I am passing objects of a class I defined around in vectors and the program uses pthreads to separate the input from the processing. Other than calling free twice on the same pointer without reallocating it in between what else could be causing this problem?</p>\n\n<p>Unfortunately since it takes so long for the error to happen and because of the multithreading I don't know where this error is occurring so I can't include a sample of my code.</p>\n"}, {"tags": ["c++", "c", "visual-studio", "visual-studio-2015"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1551509388, "post_id": 31030556, "comment_id": 96674071, "body": "Possible duplicate of  <a href=\"https://stackoverflow.com/q/4445418/608639\">How to add additional libraries to Visual Studio project?</a>"}, {"owner": {"reputation": 6685, "user_id": 5045227, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/33d94e8bd370131f074aeb3e26622e8f?s=128&d=identicon&r=PG&f=1", "display_name": "BugHunterUK", "link": "https://stackoverflow.com/users/5045227/bughunteruk"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1551547903, "post_id": 31030556, "comment_id": 96683420, "body": "Filed as duplicate 3 years later. Damn! That&#39;s some nice moderation."}], "answers": [{"comments": [{"owner": {"reputation": 692, "user_id": 3557842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fgChf.png?s=128&g=1", "display_name": "Proxytype", "link": "https://stackoverflow.com/users/3557842/proxytype"}, "reply_to_user": {"reputation": 6685, "user_id": 5045227, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/33d94e8bd370131f074aeb3e26622e8f?s=128&d=identicon&r=PG&f=1", "display_name": "BugHunterUK", "link": "https://stackoverflow.com/users/5045227/bughunteruk"}, "edited": false, "score": 0, "creation_date": 1435163795, "post_id": 31030733, "comment_id": 50088826, "body": "don&#39;t forget to vote"}, {"owner": {"reputation": 6685, "user_id": 5045227, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/33d94e8bd370131f074aeb3e26622e8f?s=128&d=identicon&r=PG&f=1", "display_name": "BugHunterUK", "link": "https://stackoverflow.com/users/5045227/bughunteruk"}, "edited": false, "score": 0, "creation_date": 1435178836, "post_id": 31030733, "comment_id": 50097590, "body": "Need 15 rep. Will answer some questions and come back to vote :)"}, {"owner": {"reputation": 692, "user_id": 3557842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fgChf.png?s=128&g=1", "display_name": "Proxytype", "link": "https://stackoverflow.com/users/3557842/proxytype"}, "reply_to_user": {"reputation": 6685, "user_id": 5045227, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/33d94e8bd370131f074aeb3e26622e8f?s=128&d=identicon&r=PG&f=1", "display_name": "BugHunterUK", "link": "https://stackoverflow.com/users/5045227/bughunteruk"}, "edited": false, "score": 0, "creation_date": 1435612999, "post_id": 31030733, "comment_id": 50264039, "body": "thanks, you remember to vote!"}, {"owner": {"reputation": 1315, "user_id": 3331879, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Rto4V.jpg?s=128&g=1", "display_name": "davidhood2", "link": "https://stackoverflow.com/users/3331879/davidhood2"}, "edited": false, "score": 0, "creation_date": 1475524503, "post_id": 31030733, "comment_id": 66968524, "body": "Solved it for me as well - just wanted to also add that the folders (for me anyway) weren&#39;t searched recursively so its important to link the source folder exactly"}, {"owner": {"reputation": 554, "user_id": 4476501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oTMdb.jpg?s=128&g=1", "display_name": "Summer Sun", "link": "https://stackoverflow.com/users/4476501/summer-sun"}, "edited": false, "score": 0, "creation_date": 1505786612, "post_id": 31030733, "comment_id": 79544247, "body": "Hi, I generate a vs project with <code>qmake -tp vc</code> from QT with some additional dependencies, but I find no libs names in <code>Additional Dependencies</code> of the vs project, but the vs project do run well.  Does that mean there is some other methods to add <code>Additional Dependencies</code> in vs project?"}], "tags": [], "owner": {"reputation": 692, "user_id": 3557842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fgChf.png?s=128&g=1", "display_name": "Proxytype", "link": "https://stackoverflow.com/users/3557842/proxytype"}, "is_accepted": true, "score": 16, "last_activity_date": 1435159670, "creation_date": 1435159670, "answer_id": 31030733, "question_id": 31030556, "link": "https://stackoverflow.com/questions/31030556/compiling-and-linking-third-party-libraries-in-vs-2015/31030733#31030733", "title": "Compiling and linking third party libraries in VS 2015", "body": "<p>adding to the linker is not enough you need also to add the include library:\nproperties -> C/C++ ->general -> additional include directories </p>\n"}], "owner": {"reputation": 6685, "user_id": 5045227, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/33d94e8bd370131f074aeb3e26622e8f?s=128&d=identicon&r=PG&f=1", "display_name": "BugHunterUK", "link": "https://stackoverflow.com/users/5045227/bughunteruk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20907, "favorite_count": 4, "closed_date": 1551535436, "accepted_answer_id": 31030733, "answer_count": 1, "score": 6, "last_activity_date": 1551509258, "creation_date": 1435159253, "last_edit_date": 1551509258, "question_id": 31030556, "link": "https://stackoverflow.com/questions/31030556/compiling-and-linking-third-party-libraries-in-vs-2015", "closed_reason": "Duplicate", "title": "Compiling and linking third party libraries in VS 2015", "body": "<p>I'm working on a C++ project using Visual Studio 2015 I'm trying to link an external library (in this instance <code>libtins</code>). The library currently resides on my desktop.</p>\n\n<p>I've tried editing the project settings, under Linker settings, but it doesn't give me any option to include any custom libraries.</p>\n\n<p>How do I do this in VS 2015?</p>\n"}, {"tags": ["c", "string", "tokenize"], "answers": [{"comments": [{"owner": {"reputation": 557, "user_id": 4889239, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af588460cb95678d7d332cd7f53e4a07?s=128&d=identicon&r=PG&f=1", "display_name": "David Tamrazov", "link": "https://stackoverflow.com/users/4889239/david-tamrazov"}, "edited": false, "score": 0, "creation_date": 1435158966, "post_id": 31030374, "comment_id": 50085412, "body": "I&#39;d originally allocated 4 variables to aCode because like you said, it needs to be null terminated, yet I had the same issue as I do now, so I&#39;d figured allocating that extra variable is what forced printf to display the garbage values."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 557, "user_id": 4889239, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af588460cb95678d7d332cd7f53e4a07?s=128&d=identicon&r=PG&f=1", "display_name": "David Tamrazov", "link": "https://stackoverflow.com/users/4889239/david-tamrazov"}, "edited": false, "score": 0, "creation_date": 1435159316, "post_id": 31030374, "comment_id": 50085679, "body": "@DavidTamrazov and, 8 for <code>aNum</code>? NULL check?"}, {"owner": {"reputation": 557, "user_id": 4889239, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af588460cb95678d7d332cd7f53e4a07?s=128&d=identicon&r=PG&f=1", "display_name": "David Tamrazov", "link": "https://stackoverflow.com/users/4889239/david-tamrazov"}, "edited": false, "score": 0, "creation_date": 1435159496, "post_id": 31030374, "comment_id": 50085820, "body": "Mhm, and 8 for aNum. Which is why I find it so peculiar that its printing the full number and the extra space when it only has room for 7 characters."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1435159632, "post_id": 31030374, "comment_id": 50085936, "body": "When undefined behavior occurs, the behavior is any behavior, it&#39;s certainly deterministic, but it cannot be determined by the code in your program, instead there are other factors which determine the behavior, some of which completely external to your program&#39;s code."}, {"owner": {"reputation": 557, "user_id": 4889239, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af588460cb95678d7d332cd7f53e4a07?s=128&d=identicon&r=PG&f=1", "display_name": "David Tamrazov", "link": "https://stackoverflow.com/users/4889239/david-tamrazov"}, "edited": false, "score": 0, "creation_date": 1435159905, "post_id": 31030374, "comment_id": 50086141, "body": "Gotcha. So all of my issues could be stemming from undefined behaviour caused by the fact that my arrays have improper sizes, and my lack of a NULL check?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 557, "user_id": 4889239, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af588460cb95678d7d332cd7f53e4a07?s=128&d=identicon&r=PG&f=1", "display_name": "David Tamrazov", "link": "https://stackoverflow.com/users/4889239/david-tamrazov"}, "edited": false, "score": 0, "creation_date": 1435159932, "post_id": 31030374, "comment_id": 50086162, "body": "@DavidTamrazov That&#39;s it. :-)"}, {"owner": {"reputation": 557, "user_id": 4889239, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af588460cb95678d7d332cd7f53e4a07?s=128&d=identicon&r=PG&f=1", "display_name": "David Tamrazov", "link": "https://stackoverflow.com/users/4889239/david-tamrazov"}, "edited": false, "score": 0, "creation_date": 1435160089, "post_id": 31030374, "comment_id": 50086280, "body": "Brilliant, I&#39;ll get on that then :) Thanks guys!"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 557, "user_id": 4889239, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af588460cb95678d7d332cd7f53e4a07?s=128&d=identicon&r=PG&f=1", "display_name": "David Tamrazov", "link": "https://stackoverflow.com/users/4889239/david-tamrazov"}, "edited": false, "score": 0, "creation_date": 1435161914, "post_id": 31030374, "comment_id": 50087573, "body": "@DavidTamrazov You&#39;re welcome . :-) BTW, you can consider <a href=\"http://meta.stackexchange.com/q/5234\">accepting</a> an answer that helped you."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 4, "last_activity_date": 1435159914, "last_edit_date": 1435159914, "creation_date": 1435158839, "answer_id": 31030374, "question_id": 31030338, "link": "https://stackoverflow.com/questions/31030338/tokenizing-a-phone-number-in-c/31030374#31030374", "title": "Tokenizing a phone number in C", "body": "<p>I can primarily see two errors, </p>\n\n<ol>\n<li><p>Being an array of <code>3</code> <code>char</code>s, <code>aCode</code> is not null-terminated here. Using it as an argument to <code>%s</code> format specifier in <code>printf()</code> invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behaviour</a>. Same thing in a differrent way for <code>aNum</code>, too.</p></li>\n<li><p><a href=\"http://linux.die.net/man/3/strcat\" rel=\"nofollow\"><code>strcat()</code></a> expects a null-terminated array for both the arguments. <code>aNum</code> is not null-terminated, when used for the first time, will result in UB, too. Always initialize your local variables.</p></li>\n</ol>\n\n<p><sup>Also, see other answers for a complete bug-free code.</sup></p>\n"}, {"comments": [{"owner": {"reputation": 557, "user_id": 4889239, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af588460cb95678d7d332cd7f53e4a07?s=128&d=identicon&r=PG&f=1", "display_name": "David Tamrazov", "link": "https://stackoverflow.com/users/4889239/david-tamrazov"}, "edited": false, "score": 0, "creation_date": 1435159131, "post_id": 31030395, "comment_id": 50085543, "body": "@iharob I don&#39;t check for NULL in my first strtok because I only need the one token- the (515). When I create several tokens of the last 7 digits, then I check for it. As for the aNum and aCode, I&#39;d allocated the extra room for the null terminator previously but it was still printing garbage values. I&#39;d figured it was caused by my explicit allocation of extra space, so I adjusted it to what you see now. But the same behaviour is shown."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 557, "user_id": 4889239, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af588460cb95678d7d332cd7f53e4a07?s=128&d=identicon&r=PG&f=1", "display_name": "David Tamrazov", "link": "https://stackoverflow.com/users/4889239/david-tamrazov"}, "edited": false, "score": 0, "creation_date": 1435159204, "post_id": 31030395, "comment_id": 50085603, "body": "@DavidTamrazov If you don&#39;t check for <code>NULL</code> the next line is likely to invoke undefined behavior, also, <b>YOU MUST ALWAYS CHECK FOR ANY POSSIBLE ERROR</b> or you will write buggy code all the time. <a href=\"http://spinroot.com/p10/\" rel=\"nofollow noreferrer\">This is something I found yesterday</a>, the 7th rule applies to this situation."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1435159290, "post_id": 31030395, "comment_id": 50085666, "body": "@iharob is really number 4 an issue? Programatically it looks fine, as he is working with fixed pattern data."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1435159386, "post_id": 31030395, "comment_id": 50085734, "body": "@SouravGhosh I am not <b>really</b> sure, but I think that using the same pointer will cause undefined behavior, remember that <code>strtok()</code> is not reentrant because it uses an internal pointer to store current token position, using <code>strtok()</code> is almost always a bad idea."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1435159496, "post_id": 31030395, "comment_id": 50085822, "body": "@SouravGhosh #4 is not an issue for now iff the phone number has been pre-validated somehow to conform to the exact format specified (then it simply starts a new <code>strtok</code> run instead of continuing the old one), but if the specification changes or the number is not in the exact format given (e.g., area code has only two digits) then it fails. Never-the-less, it is an ugly hard-coded magic number (6)."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 2, "last_activity_date": 1435164622, "last_edit_date": 1435164622, "creation_date": 1435158882, "answer_id": 31030395, "question_id": 31030338, "link": "https://stackoverflow.com/questions/31030338/tokenizing-a-phone-number-in-c/31030395#31030395", "title": "Tokenizing a phone number in C", "body": "<p>Your code has multiple issues</p>\n\n<ol>\n<li><p>You allocate the wrong size for <code>aCode</code>, you should add 1 for the <code>nul</code> terminator byte and initialize the whole array to '\\0' to ensure end of lines.</p>\n\n<pre><code>char aCode[4] = {'\\0'};\n</code></pre></li>\n<li><p>You don't check if <code>strtok()</code> returns <code>NULL</code>.</p>\n\n<pre><code>numPtr = strtok(phoneNum, \" \");\nstrncpy(aCode, &amp;numPtr[1], 3);\n</code></pre></li>\n<li><p>Point 1, applies to <code>aNum</code> in <code>strcat(aNum, numPtr)</code> which will also fail because <code>aNum</code> is not yet initialized at the first call.</p></li>\n<li><p>Subsequent calls to <code>strtok()</code> must have <code>NULL</code> as the first parameter, hence</p>\n\n<pre><code>numPtr = strtok(&amp;phoneNum[6], \"-\");\n</code></pre>\n\n<p>is wrong, it should be</p>\n\n<pre><code>numPtr = strtok(NULL, \"-\");\n</code></pre></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 557, "user_id": 4889239, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af588460cb95678d7d332cd7f53e4a07?s=128&d=identicon&r=PG&f=1", "display_name": "David Tamrazov", "link": "https://stackoverflow.com/users/4889239/david-tamrazov"}, "edited": false, "score": 0, "creation_date": 1435159650, "post_id": 31030606, "comment_id": 50085956, "body": "that&#39;s a really interesting solution- I&#39;ve never seen sscanf used this way before (beginner at C)! But unfortunately the exercise explicitly asks me to work with tokens."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 4, "last_activity_date": 1435159362, "creation_date": 1435159362, "answer_id": 31030606, "question_id": 31030338, "link": "https://stackoverflow.com/questions/31030338/tokenizing-a-phone-number-in-c/31030606#31030606", "title": "Tokenizing a phone number in C", "body": "<p>The biggest problem in your code is undefined behavior: since you are reading a three-character constant into a three-character array, you have left no space for null terminator.</p>\n\n<p>Since you are tokenizing a value in a very specific format of fixed length, you could get away with a very concise implementation that employs <code>sscanf</code>:</p>\n\n<pre><code>char *phoneNum = \"(515) 555-5555\";\nchar aCode[3+1];\nchar aNum[7+1];\nsscanf(phoneNum, \"(%3[0-9]) %3[0-9]-%4[0-9]\", aCode, aNum, &amp;aNum[3]);\nprintf(\"%s %s\", aCode, aNum);\n</code></pre>\n\n<p>This solution passes the format <code>(###) ###-####</code> directly to <code>sscanf</code>, and tells the function where each value needs to be placed. The only \"trick\" used above is passing <code>&amp;aNum[3]</code> for the last argument, instructing <code>sscanf</code> to place data for the third segment into the same storage as the second segment, but starting at position 3.</p>\n\n<p><a href=\"http://ideone.com/w4BppX\" rel=\"nofollow\">Demo.</a></p>\n"}, {"tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": false, "score": 0, "last_activity_date": 1435162739, "creation_date": 1435162739, "answer_id": 31031832, "question_id": 31030338, "link": "https://stackoverflow.com/questions/31030338/tokenizing-a-phone-number-in-c/31031832#31031832", "title": "Tokenizing a phone number in C", "body": "<p>Other answers have already mentioned the major issue, which is insufficient space in <code>aCode</code> and <code>aNum</code> for the terminating NUL character. The <code>sscanf</code> answer is also the cleanest for solving the problem, but given the restriction of using <code>strtok</code>, here's one possible solution to consider:</p>\n\n<pre><code>char phone_number[]= \"(515) 555-1234\";\nchar area[3+1] = \"\";\nchar digits[7+1] = \"\";\nconst char *separators = \" (-)\";\nchar *p = strtok(phone_number, separators);\nif (p) {\n    int len = 0;\n    (void) snprintf(area, sizeof(area), \"%s\", p);\n    while (len &lt; sizeof(digits) &amp;&amp; (p = strtok(NULL, separators))) {\n        len += snprintf(digits + len, sizeof(digits) - len, \"%s\", p);\n    }\n}\n(void) printf(\"(%s) %s\\n\", area, digits);\n</code></pre>\n"}], "owner": {"reputation": 557, "user_id": 4889239, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/af588460cb95678d7d332cd7f53e4a07?s=128&d=identicon&r=PG&f=1", "display_name": "David Tamrazov", "link": "https://stackoverflow.com/users/4889239/david-tamrazov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1204, "favorite_count": 0, "accepted_answer_id": 31030374, "answer_count": 4, "score": 1, "last_activity_date": 1437908647, "creation_date": 1435158753, "last_edit_date": 1437908647, "question_id": 31030338, "link": "https://stackoverflow.com/questions/31030338/tokenizing-a-phone-number-in-c", "title": "Tokenizing a phone number in C", "body": "<p>I'm trying to tokenize a phone number and split it into two arrays. It starts out in a string in the form of \"(515) 555-5555\". I'm looking to tokenize the area code, the first 3 digits, and the last 4 digits. The area code I would store in one array, and the other 7 digits in another one. Both arrays are to hold just the numbers themselves. </p>\n\n<p>My code seems to work... sort of. The issue is when I print the two storage arrays, I find some quirks; </p>\n\n<ol>\n<li><p>My array <code>aCode;</code> it stores the first 3 digits as I ask it to, but then it also prints some garbage values notched at the end. I walked through it in the debugger, and the array only stores what I'm asking it to store- the 515. So how come it's printing those garbage values? What gives?</p></li>\n<li><p>My array <code>aNum</code>; I can append the tokens I need to the end of it, the only problem is I end up with an extra space at the front (which makes sense; I'm adding on to an empty array, ie adding on to empty space). I modify the code to only hold 7 variables just to mess around, I step into the debugger, and it tells me that the array holds and empty space and 6 of the digits I need- there's no room for the last one. Yet when I print it, the space AND all 7 digits are printed. How does that happen? </p></li>\n</ol>\n\n<p>And how could I set up my <code>strtok</code> function so that it first copies the 3 digits before the \"-\", then appends to that the last 4 I need? All examples of tokenization I've seen utilize a while loop, which would mean I'd have to choose either <code>strcat</code> or <code>strcpy</code> to complete my task. I can set up an \"if\" statement to check for the size of the current token each time, but that seems too crude to me and I feel like there's a simpler method to this. Thanks all! </p>\n\n<pre><code>int main() {\n\n    char phoneNum[]= \"(515) 555-5555\";\n    char aCode[3];\n    char aNum[7];\n\n    char *numPtr;\n\n    numPtr = strtok(phoneNum, \" \");\n\n    strncpy(aCode, &amp;numPtr[1], 3);\n    printf(\"%s\\n\", aCode);  \n\n    numPtr = strtok(&amp;phoneNum[6], \"-\");\n\n    while (numPtr != NULL) {\n        strcat(aNum, numPtr);\n        numPtr = strtok(NULL, \"-\");\n    }\n    printf(\"%s\", aNum);  \n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1435158072, "post_id": 31029888, "comment_id": 50084716, "body": "<code>while(!feof(fp)){</code> is an antipattern, <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">don&#39;t use it</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1435158138, "post_id": 31029888, "comment_id": 50084764, "body": "you are probably causing buffer overflows; change <code>%s</code> to <code>%10s</code> and try again. Also, <code>fflush(stdin)</code> causes undefined behaviour, and you didn&#39;t show how <code>el.parola</code> was initialized"}], "answers": [{"comments": [{"owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "reply_to_user": {"reputation": 1, "user_id": 5045128, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/648455f4bb98860334521d2eff58585c?s=128&d=identicon&r=PG&f=1", "display_name": "Riccardo Pirani", "link": "https://stackoverflow.com/users/5045128/riccardo-pirani"}, "edited": false, "score": 0, "creation_date": 1435497763, "post_id": 31030391, "comment_id": 50215846, "body": "@RiccardoPirani If the answer solves your problem, please accept it by clicking the tick mark next to the answer. If you still have any problem, please leave a comment and edit your question if required."}], "tags": [], "owner": {"reputation": 356, "user_id": 3799721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bafefe5ab3af6279c0340382b6f7a5ca?s=128&d=identicon&r=PG", "display_name": "Caleb An", "link": "https://stackoverflow.com/users/3799721/caleb-an"}, "is_accepted": false, "score": 1, "last_activity_date": 1435158868, "creation_date": 1435158868, "answer_id": 31030391, "question_id": 31029888, "link": "https://stackoverflow.com/questions/31029888/error-stack-around-the-variable-ptemp-was-corrupted/31030391#31030391", "title": "Error: Stack around the variable &#39;ptemp&#39; was corrupted", "body": "<p>You initialized ptemp with memory for 11 characters. If the string you copy from fp is larger than 11 characters, fscanf will write past ptemp into other memory. T fix, either copy only 11 characters or increase the size of ptemp to the maximum size of the strings you are reading (if this is known). </p>\n"}], "owner": {"reputation": 1, "user_id": 5045128, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/648455f4bb98860334521d2eff58585c?s=128&d=identicon&r=PG&f=1", "display_name": "Riccardo Pirani", "link": "https://stackoverflow.com/users/5045128/riccardo-pirani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1435160345, "creation_date": 1435157525, "last_edit_date": 1435160345, "question_id": 31029888, "link": "https://stackoverflow.com/questions/31029888/error-stack-around-the-variable-ptemp-was-corrupted", "title": "Error: Stack around the variable &#39;ptemp&#39; was corrupted", "body": "<p>I'm getting this error:</p>\n\n<blockquote>\n  <p>( Stack around the variable 'ptemp' was corrupted. )</p>\n</blockquote>\n\n<p>My code</p>\n\n<pre><code>list crea_lista(list l, FILE *fp, FILE *fp2){\n\n    char ptemp[11];\n    char ptemp2[11];\n    element el;\n    el.numero_volte=1;\n\n    while(!feof(fp)){\n\n        fscanf(fp,\"%s\",ptemp);\n\n        while(!feof(fp2)){\n\n            fscanf(fp2,\"%s\",ptemp2);\n\n            if(strcmp(ptemp,ptemp2)==0){\n\n\n                el.numero_volte=el.numero_volte+1;\n\n\n            }\n\n        }\n\n        strcpy(el.parola,ptemp);\n        l=insord(l,el);\n        el.numero_volte=1;\n        fflush(stdin);\n\n        rewind(fp2);\n\n    }\n\n    return l;\n\n}\n</code></pre>\n\n<p>How can I solve this problem?</p>\n"}, {"tags": ["c++", "c", "apache", "pointers", "apache2"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1435156589, "post_id": 31029516, "comment_id": 50083658, "body": "who stole your <code>.c</code> file? :-)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1435157464, "post_id": 31029516, "comment_id": 50084281, "body": "Is it <code>C</code> code or <code>C++</code>? if <code>C++</code>, try adding cast to <code>const char *</code>, if <code>C</code>, use a <code>C</code> compiler."}, {"owner": {"reputation": 9209, "user_id": 455322, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a08eee5080a1750369fc20fe332bcea0?s=128&d=identicon&r=PG", "display_name": "Les", "link": "https://stackoverflow.com/users/455322/les"}, "edited": false, "score": 1, "creation_date": 1435157771, "post_id": 31029516, "comment_id": 50084497, "body": "do you include http_config.h?"}, {"owner": {"reputation": 9209, "user_id": 455322, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a08eee5080a1750369fc20fe332bcea0?s=128&d=identicon&r=PG", "display_name": "Les", "link": "https://stackoverflow.com/users/455322/les"}, "edited": false, "score": 1, "creation_date": 1435158089, "post_id": 31029516, "comment_id": 50084730, "body": "change char *arg to const char *arg in tyour example_set_path declaration"}, {"owner": {"reputation": 707, "user_id": 3906969, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/EOsOS.jpg?s=128&g=1", "display_name": "ap6491", "link": "https://stackoverflow.com/users/3906969/ap6491"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1435158298, "post_id": 31029516, "comment_id": 50084865, "body": "@SouravGhosh  ...it is a .c file."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1435158325, "post_id": 31029516, "comment_id": 50084893, "body": "and your compiler is?"}, {"owner": {"reputation": 707, "user_id": 3906969, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/EOsOS.jpg?s=128&g=1", "display_name": "ap6491", "link": "https://stackoverflow.com/users/3906969/ap6491"}, "reply_to_user": {"reputation": 9209, "user_id": 455322, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a08eee5080a1750369fc20fe332bcea0?s=128&d=identicon&r=PG", "display_name": "Les", "link": "https://stackoverflow.com/users/455322/les"}, "edited": false, "score": 0, "creation_date": 1435158373, "post_id": 31029516, "comment_id": 50084939, "body": "@Les ...Yes, I did include http_config.h"}, {"owner": {"reputation": 707, "user_id": 3906969, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/EOsOS.jpg?s=128&g=1", "display_name": "ap6491", "link": "https://stackoverflow.com/users/3906969/ap6491"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1435158959, "post_id": 31029516, "comment_id": 50085406, "body": "@SouravGhosh ..GCC Compiler"}, {"owner": {"reputation": 707, "user_id": 3906969, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/EOsOS.jpg?s=128&g=1", "display_name": "ap6491", "link": "https://stackoverflow.com/users/3906969/ap6491"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1435159419, "post_id": 31029516, "comment_id": 50085760, "body": "@SouravGhosh .I get the following error when I change to const char *arg: In function &#39;example_set_path&#39; error: assignment discards &#39;const&#39; qualifier from pointer target type [-Werror] config.path = arg;"}], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1435158598, "post_id": 31030263, "comment_id": 50085147, "body": "<code>const char *example_set_enabled(cmd_parms *cmd, void *cfg, const char *arg)</code>...what it is now?"}, {"owner": {"reputation": 707, "user_id": 3906969, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/EOsOS.jpg?s=128&g=1", "display_name": "ap6491", "link": "https://stackoverflow.com/users/3906969/ap6491"}, "edited": false, "score": 0, "creation_date": 1435159330, "post_id": 31030263, "comment_id": 50085692, "body": "@Les...I get the following error when I change to const char *arg:  In function &#39;example_set_path&#39;       error: assignment discards &#39;const&#39; qualifier from pointer target type [-Werror]      config.path = arg;"}, {"owner": {"reputation": 9209, "user_id": 455322, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a08eee5080a1750369fc20fe332bcea0?s=128&d=identicon&r=PG", "display_name": "Les", "link": "https://stackoverflow.com/users/455322/les"}, "reply_to_user": {"reputation": 707, "user_id": 3906969, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/EOsOS.jpg?s=128&g=1", "display_name": "ap6491", "link": "https://stackoverflow.com/users/3906969/ap6491"}, "edited": false, "score": 1, "creation_date": 1435159759, "post_id": 31030263, "comment_id": 50086029, "body": "@ap6491 config.path probably takes a char *, so cast (char *)arg"}, {"owner": {"reputation": 707, "user_id": 3906969, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/EOsOS.jpg?s=128&g=1", "display_name": "ap6491", "link": "https://stackoverflow.com/users/3906969/ap6491"}, "edited": false, "score": 0, "creation_date": 1435159946, "post_id": 31030263, "comment_id": 50086175, "body": "Thank you @Les...config.path did take a char *. Casting (char *) arg fixed the error. Thank you."}], "tags": [], "owner": {"reputation": 9209, "user_id": 455322, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/a08eee5080a1750369fc20fe332bcea0?s=128&d=identicon&r=PG", "display_name": "Les", "link": "https://stackoverflow.com/users/455322/les"}, "is_accepted": true, "score": 1, "last_activity_date": 1435159664, "last_edit_date": 1435159664, "creation_date": 1435158553, "answer_id": 31030263, "question_id": 31029516, "link": "https://stackoverflow.com/questions/31029516/incompatible-pointer-type-error-while-setting-directives-in-apache-server/31030263#31030263", "title": "Incompatible pointer type error while setting directives in Apache server", "body": "<p>Third parameter of example_set_path should be <code>const char *arg</code></p>\n\n<pre><code>#define AP_INIT_TAKE1 ( directive,  \n  func,  \n  mconfig,  \n  where,  \n  help    )     { directive, { .take1=func }, mconfig, where, TAKE1, help } \n</code></pre>\n\n<p>func is defined as...</p>\n\n<pre><code>const char *(*  take1 )(cmd_parms *parms, void *mconfig, const char *w)  \n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 3906969, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/EOsOS.jpg?s=128&g=1", "display_name": "ap6491", "link": "https://stackoverflow.com/users/3906969/ap6491"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 1, "accepted_answer_id": 31030263, "answer_count": 1, "score": 0, "last_activity_date": 1435159664, "creation_date": 1435156527, "last_edit_date": 1435156617, "question_id": 31029516, "link": "https://stackoverflow.com/questions/31029516/incompatible-pointer-type-error-while-setting-directives-in-apache-server", "title": "Incompatible pointer type error while setting directives in Apache server", "body": "<p>I am trying to set a directive in Apache server using the example code in the section 'The directive handler function' at \n<a href=\"http://httpd.apache.org/docs/2.4/developer/modguide.html\" rel=\"nofollow\">http://httpd.apache.org/docs/2.4/developer/modguide.html</a>.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>static const command_rec example_directives[] =\n{\n    AP_INIT_TAKE1(\"exampleEnabled\", example_set_enabled, NULL, ACCESS_CONF, \"Enable or disable mod_privet\"),\n    AP_INIT_TAKE1(\"examplePath\", example_set_path, NULL, ACCESS_CONF, \"The path to whatever\"),\n    AP_INIT_TAKE2(\"exampleAction\", example_set_action, NULL, ACCESS_CONF, \"Special action value!\"),\n    { NULL }\n};\n\nHandler for directives:\n\n\n/* Handler for the \"exampleEnabled\" directive */\nconst char *example_set_enabled(cmd_parms *cmd, void *cfg, const char *arg)\n{\n    if(!strcasecmp(arg, \"on\")) config.enabled = 1;\n    else config.enabled = 0;\n    return NULL;\n}\n\n/* Handler for the \"examplePath\" directive */\nconst char *example_set_path(cmd_parms *cmd, void *cfg, char *arg)\n{\n    config.path = arg;\n    return NULL;\n}\n\n/* Handler for the \"exampleAction\" directive */\n/* Let's pretend this one takes one argument (file or db), and a second (deny or allow), */\n/* and we store it in a bit-wise manner. */\nconst char *example_set_action(cmd_parms *cmd, void *cfg, const char *arg1, const char *arg2)\n{\n    if(!strcasecmp(arg1, \"file\")) config.typeOfAction = 0x01;\n    else config.typeOfAction = 0x02;\n\n    if(!strcasecmp(arg2, \"deny\")) config.typeOfAction += 0x10;\n    else config.typeOfAction += 0x20;\n    return NULL;\n}\n</code></pre>\n\n<p>However, when I try to build, I get the following error:</p>\n\n<p>error: initialization from incompatible pointer type [-Werror]\n     AP_INIT_TAKE1(\"examplePath\", example_set_path, NULL, ACCESS_CONF, \"The path to whatever\")</p>\n\n<p>Am I missing out on something?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "compiler-warnings"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 5, "creation_date": 1435154670, "post_id": 31028700, "comment_id": 50082066, "body": "<code>struct</code> is a reserved keyword in C. I wouldn&#39;t recommend using it as the name of a variable."}, {"owner": {"reputation": 35, "user_id": 4574639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5053c299d202cc822cb4e6148ae5a351?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/4574639/sven"}, "reply_to_user": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1435155255, "post_id": 31028700, "comment_id": 50082521, "body": "That&#39;s only for illustration purpose"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1435155638, "post_id": 31028700, "comment_id": 50082837, "body": "and this is a C code, right?"}, {"owner": {"reputation": 35, "user_id": 4574639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5053c299d202cc822cb4e6148ae5a351?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/4574639/sven"}, "edited": false, "score": 0, "creation_date": 1435156119, "post_id": 31028700, "comment_id": 50083271, "body": "Yes, it happens to be"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435156432, "post_id": 31028700, "comment_id": 50083531, "body": "<a href=\"http://en.cppreference.com/w/cpp/language/implicit_cast\" rel=\"nofollow noreferrer\">&quot;If the source type is bool, the value false is converted to zero and the value true is converted to the value one of the destination type&quot;</a>, &quot;Numeric conversions&quot;. I presume that would result in destination type <code>uint64_t</code>, making the question C-only. Why add the C++-tag then?"}], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1435154799, "post_id": 31028762, "comment_id": 50082171, "body": "@JensGustedt Was just adding that, though as a note. Thanks. :-)"}, {"owner": {"reputation": 35, "user_id": 4574639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5053c299d202cc822cb4e6148ae5a351?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/4574639/sven"}, "edited": false, "score": 0, "creation_date": 1435154853, "post_id": 31028762, "comment_id": 50082205, "body": "Works like a charm, thank you. As for the intent of the operation, <code>struct.s == !struct2.s</code> was exactly what I was going for, but thanks for caring :)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1435155254, "post_id": 31028762, "comment_id": 50082520, "body": "Does negation also yield <code>int</code> for C++? Or would that be <code>bool</code> there?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 35, "user_id": 4574639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5053c299d202cc822cb4e6148ae5a351?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/4574639/sven"}, "edited": false, "score": 0, "creation_date": 1435158013, "post_id": 31028762, "comment_id": 50084672, "body": "@Sven You&#39;re welcome . :-) BTW, you can consider <a href=\"http://meta.stackexchange.com/q/5234\">accepting</a> an answer that helped you."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 12, "last_activity_date": 1435157658, "last_edit_date": 1435157658, "creation_date": 1435154596, "answer_id": 31028762, "question_id": 31028700, "link": "https://stackoverflow.com/questions/31028700/signed-unsigned-mismatch/31028762#31028762", "title": "Signed/unsigned mismatch", "body": "<p>Directly quoting the <code>C11</code> standard, chapter \u00a76.5.3.3, (<em>emphasis mine</em>)</p>\n\n<blockquote>\n  <p>The result of the logical negation operator <code>!</code> is <code>0</code> if the value of its operand compares\n  unequal to <code>0</code>, <code>1</code> if the value of its operand compares equal to <code>0</code>. <strong>The result has type <code>int</code></strong>....</p>\n</blockquote>\n\n<p>So, the result of the logical <code>!</code> operator is <code>int</code>, so <code>!struct2.s</code> produces <code>int</code> value, and the expression</p>\n\n<pre><code>....(struct.s == !struct2.s)\n</code></pre>\n\n<p>creates the issue.</p>\n\n<hr>\n\n<p>NOTE 1: </p>\n\n<p>I guess you use <code>struct</code> as a structure name just for illustration purpose, otherwise, <code>struct</code> being a reserved keyword in <code>C</code> you cannot use that as a variable name.</p>\n\n<hr>\n\n<p>NOTE 2:</p>\n\n<p>Maybe what you actually meant is <code>(struct.s != struct2.s)</code>, but that's also just a (<em>probable</em>)guess.</p>\n\n<hr>\n\n<p><sup>FOOTNOTE :: Earlier question tagged C++ also, Moving it as footnote but keeping the info just for reference.</sup><br>\n<sup>Regarding <code>C++</code>, the return type of <code>!</code> is <code>bool</code>. Ref: <code>C++11</code>, chapter \u00a7 5.3.3 (again, emphasis mine)</sup></p>\n\n<blockquote>\n  <p><sup> The operand of the logical negation operator <code>!</code> is contextually converted to  bool<code>(Clause 4); its value is</code>true<code>if the converted operand is</code>false<code>and  false</code> otherwise. <strong>The type of the result is <code>bool</code>.</strong></sup></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 1, "last_activity_date": 1435168547, "creation_date": 1435168547, "answer_id": 31033651, "question_id": 31028700, "link": "https://stackoverflow.com/questions/31028700/signed-unsigned-mismatch/31033651#31033651", "title": "Signed/unsigned mismatch", "body": "<p>[too long for a comment]</p>\n\n<p>To get the most out of compiler warnings, always try to put only one statement/expression on one line (at least temporarily when trying to determine the error's/warning's source).</p>\n\n<p>So if you'd have set the code this way:</p>\n\n<pre><code>if (\n    (struct.c == 0x02) \n    &amp;&amp; (struct2.c == 0x02) \n    &amp;&amp; (struct.s == !struct2.s)\n  )\n</code></pre>\n\n<p>You'd been pointed by the compiler to exactly the (relativly) 4th line.</p>\n"}], "owner": {"reputation": 35, "user_id": 4574639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5053c299d202cc822cb4e6148ae5a351?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/4574639/sven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 31028762, "answer_count": 2, "score": 2, "last_activity_date": 1437660694, "creation_date": 1435154435, "last_edit_date": 1437660694, "question_id": 31028700, "link": "https://stackoverflow.com/questions/31028700/signed-unsigned-mismatch", "title": "Signed/unsigned mismatch", "body": "<p>I'm having hard time understanding nature of issue I encountered in my code.\nLine </p>\n\n<pre><code>if ((struct.c == 0x02) &amp;&amp; (struct2.c == 0x02) &amp;&amp; (struct.s == !struct2.s))\n    {/**/}\n</code></pre>\n\n<p>where <code>c</code> is <code>int</code> and <code>s</code> is <code>uint64_t</code> produces </p>\n\n<blockquote>\n  <p>C4388:'==' signed/unsigned mismatch</p>\n</blockquote>\n\n<p>warning. I understand what that warning is, I can't see what is triggering it here. What am I missing?</p>\n"}, {"tags": ["c", "linux", "x11"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1435162621, "post_id": 31028546, "comment_id": 50088083, "body": "You can&#39;t see anything because the code draws on the root window which is normally obscured by the desktop. Try running it as a part of xscreensaver as intended. Alternatively, run another X11 server without any desktop environment and preferably with no window manager, and try running your program there."}, {"owner": {"reputation": 221, "user_id": 3992979, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0b9fec11c9371560b717b817cea24ef5?s=128&d=identicon&r=PG&f=1", "display_name": "user3992979", "link": "https://stackoverflow.com/users/3992979/user3992979"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1435172931, "post_id": 31028546, "comment_id": 50094300, "body": "You are right, please convert it to an answer :) Here <a href=\"http://www.jwz.org/xscreensaver/man1.html\" rel=\"nofollow noreferrer\">jwz.org/xscreensaver/man1.html</a> under &quot;programs (class Programs)&quot; is shown how to add your binary to xscreensavers list."}], "owner": {"reputation": 221, "user_id": 3992979, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0b9fec11c9371560b717b817cea24ef5?s=128&d=identicon&r=PG&f=1", "display_name": "user3992979", "link": "https://stackoverflow.com/users/3992979/user3992979"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1435154022, "creation_date": 1435154022, "last_edit_date": 1495542139, "question_id": 31028546, "link": "https://stackoverflow.com/questions/31028546/xscreensaver-renders-nothing", "title": "Xscreensaver renders nothing", "body": "<p>I try to make a screensaver for Linux based on \"simplesquares\" from: <a href=\"http://www.dis.uniroma1.it/~liberato/screensaver/simplesquares.html\" rel=\"nofollow noreferrer\">http://www.dis.uniroma1.it/~liberato/screensaver/simplesquares.html</a></p>\n\n<p>I overcome the compile errors (<a href=\"https://stackoverflow.com/questions/22522228/gcc-errors-compiling-example-xscreensaver\">gcc - errors compiling example xscreensaver</a>), but after running the compiled file, nothing is shown at all. No matter if run inside Eclipse or the command line. Currently, my code is exaclty the one from the first link.\nMy environement: Ubuntu 15.04 x86, Mate 1.8.2, gcc 4.9.2, libx11-dev 2:1.6.2.</p>\n\n<p>What changes do i have to make to the code of <code>simplesquares.c</code> (and maybe <code>vroot.h</code>) in order make it show something?</p>\n\n<p>The user here <a href=\"https://stackoverflow.com/questions/11686699/hints-and-tips-for-writing-a-screensaver-using-xscreensaver\">Hints and tips for writing a screensaver using xscreensaver?</a> has the same problem with the missing output, but there is no answer and the question was closed because of other reasons.</p>\n"}, {"tags": ["java", "c", "macos", "java-native-interface", "osx-mavericks"], "comments": [{"owner": {"reputation": 1908, "user_id": 2543253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a87e0065d4c5036eb7adabe2edfd187?s=128&d=identicon&r=PG", "display_name": "user2543253", "link": "https://stackoverflow.com/users/2543253/user2543253"}, "edited": false, "score": 0, "creation_date": 1435237890, "post_id": 31028467, "comment_id": 50123691, "body": "I&#39;d rather suspect a bug in the C code. Something that causes memory corruption. Do you have access to the application&#39;s source?"}, {"owner": {"reputation": 720, "user_id": 478765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d44423fad79530b59a084b2d15ee19a?s=128&d=identicon&r=PG", "display_name": "ed22", "link": "https://stackoverflow.com/users/478765/ed22"}, "reply_to_user": {"reputation": 1908, "user_id": 2543253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a87e0065d4c5036eb7adabe2edfd187?s=128&d=identicon&r=PG", "display_name": "user2543253", "link": "https://stackoverflow.com/users/2543253/user2543253"}, "edited": false, "score": 0, "creation_date": 1435241208, "post_id": 31028467, "comment_id": 50126421, "body": "Yes I have the code for the app, but it is a simple standard C JNI code, nothing special. Also, the Java method is called and works. After some time (2-3 sec) I get one of the above mentioned signals. Moreover, the app is still running after I get the signal (or the signal only occurs while debugging)"}, {"owner": {"reputation": 1908, "user_id": 2543253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a87e0065d4c5036eb7adabe2edfd187?s=128&d=identicon&r=PG", "display_name": "user2543253", "link": "https://stackoverflow.com/users/2543253/user2543253"}, "edited": false, "score": 0, "creation_date": 1435246565, "post_id": 31028467, "comment_id": 50130789, "body": "I was just asking because I&#39;ve seen similar behavior often when memory was freed too early. As long as no one overwrites it everything runs fine..."}, {"owner": {"reputation": 720, "user_id": 478765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d44423fad79530b59a084b2d15ee19a?s=128&d=identicon&r=PG", "display_name": "ed22", "link": "https://stackoverflow.com/users/478765/ed22"}, "reply_to_user": {"reputation": 1908, "user_id": 2543253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a87e0065d4c5036eb7adabe2edfd187?s=128&d=identicon&r=PG", "display_name": "user2543253", "link": "https://stackoverflow.com/users/2543253/user2543253"}, "edited": false, "score": 0, "creation_date": 1435251853, "post_id": 31028467, "comment_id": 50134159, "body": "I have added the C JNI code I am using to the post. This function (runJava) runs in a separate thread (I tried using POSIX thread as well as NSThread class - wich is probably using POSIX anyway - I was just trying everything that comes to my mind)"}, {"owner": {"reputation": 720, "user_id": 478765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d44423fad79530b59a084b2d15ee19a?s=128&d=identicon&r=PG", "display_name": "ed22", "link": "https://stackoverflow.com/users/478765/ed22"}, "reply_to_user": {"reputation": 1908, "user_id": 2543253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a87e0065d4c5036eb7adabe2edfd187?s=128&d=identicon&r=PG", "display_name": "user2543253", "link": "https://stackoverflow.com/users/2543253/user2543253"}, "edited": false, "score": 0, "creation_date": 1435417669, "post_id": 31028467, "comment_id": 50196911, "body": "I have created a dummy Java 8 app that used AWT, run it using the original C JNI code and there is no SIGSEGV. I have no idea what&#39;s wrong."}, {"owner": {"reputation": 1908, "user_id": 2543253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a87e0065d4c5036eb7adabe2edfd187?s=128&d=identicon&r=PG", "display_name": "user2543253", "link": "https://stackoverflow.com/users/2543253/user2543253"}, "edited": false, "score": 0, "creation_date": 1435572080, "post_id": 31028467, "comment_id": 50239204, "body": "When does your &quot;main&quot; method return?"}, {"owner": {"reputation": 720, "user_id": 478765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d44423fad79530b59a084b2d15ee19a?s=128&d=identicon&r=PG", "display_name": "ed22", "link": "https://stackoverflow.com/users/478765/ed22"}, "reply_to_user": {"reputation": 1908, "user_id": 2543253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a87e0065d4c5036eb7adabe2edfd187?s=128&d=identicon&r=PG", "display_name": "user2543253", "link": "https://stackoverflow.com/users/2543253/user2543253"}, "edited": false, "score": 0, "creation_date": 1435593924, "post_id": 31028467, "comment_id": 50253668, "body": "The &quot;main&quot; method does not get to return anything as the app gets SIGSEGV..."}], "answers": [{"tags": [], "owner": {"reputation": 720, "user_id": 478765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d44423fad79530b59a084b2d15ee19a?s=128&d=identicon&r=PG", "display_name": "ed22", "link": "https://stackoverflow.com/users/478765/ed22"}, "is_accepted": false, "score": 0, "last_activity_date": 1438087193, "creation_date": 1438087193, "answer_id": 31676605, "question_id": 31028467, "link": "https://stackoverflow.com/questions/31028467/os-x-mavericks-jni-callstaticvoidmethod-results-in-sigsegv-sigbus-java-8/31676605#31676605", "title": "OS X Mavericks JNI CallStaticVoidMethod results in SIGSEGV/SIGBUS (Java 8)", "body": "<p>Apparently JVM uses SIGBUS/SIGSEGV internally to control the app (?). I made mu debugger pass those signals to the app and everything is fine now.</p>\n"}], "owner": {"reputation": 720, "user_id": 478765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d44423fad79530b59a084b2d15ee19a?s=128&d=identicon&r=PG", "display_name": "ed22", "link": "https://stackoverflow.com/users/478765/ed22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 502, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542104252, "creation_date": 1435153812, "last_edit_date": 1435251661, "question_id": 31028467, "link": "https://stackoverflow.com/questions/31028467/os-x-mavericks-jni-callstaticvoidmethod-results-in-sigsegv-sigbus-java-8", "title": "OS X Mavericks JNI CallStaticVoidMethod results in SIGSEGV/SIGBUS (Java 8)", "body": "<p>I have an C application that runs Java through JNI. The Java application starts, does some stuff and after a second or two I get either SIGSEGV or SIGBUS . There is no java crash dump file.</p>\n\n<p>Here is where it crashes:</p>\n\n<pre><code>libjvm.dylib`jni_CallStaticVoidMethod:\n0x104ad1653 &lt;+0&gt;:   pushq  %rbp\n0x104ad1654 &lt;+1&gt;:   movq   %rsp, %rbp\n0x104ad1657 &lt;+4&gt;:   pushq  %r15\n0x104ad1659 &lt;+6&gt;:   pushq  %r14\n0x104ad165b &lt;+8&gt;:   pushq  %r12\n0x104ad165d &lt;+10&gt;:  pushq  %rbx\n0x104ad165e &lt;+11&gt;:  subq   $0x150, %rsp\n0x104ad1665 &lt;+18&gt;:  movq   %rdx, %rbx\n0x104ad1668 &lt;+21&gt;:  movq   %rsi, %r14\n0x104ad166b &lt;+24&gt;:  movq   %rdi, %r15\n0x104ad166e &lt;+27&gt;:  testb  %al, %al\n0x104ad1670 &lt;+29&gt;:  je     0x104ad16aa               ; &lt;+87&gt;\n0x104ad1672 &lt;+31&gt;:  movaps %xmm0, -0x140(%rbp)\n0x104ad1679 &lt;+38&gt;:  movaps %xmm1, -0x130(%rbp)\n0x104ad1680 &lt;+45&gt;:  movaps %xmm2, -0x120(%rbp)\n0x104ad1687 &lt;+52&gt;:  movaps %xmm3, -0x110(%rbp)\n0x104ad168e &lt;+59&gt;:  movaps %xmm4, -0x100(%rbp)\n0x104ad1695 &lt;+66&gt;:  movaps %xmm5, -0xf0(%rbp)\n0x104ad169c &lt;+73&gt;:  movaps %xmm6, -0xe0(%rbp)\n0x104ad16a3 &lt;+80&gt;:  movaps %xmm7, -0xd0(%rbp)\n0x104ad16aa &lt;+87&gt;:  movq   %r9, -0x148(%rbp)\n0x104ad16b1 &lt;+94&gt;:  movq   %r8, -0x150(%rbp)\n0x104ad16b8 &lt;+101&gt;: movq   %rcx, -0x158(%rbp)\n0x104ad16bf &lt;+108&gt;: movq   %r15, %rdi\n0x104ad16c2 &lt;+111&gt;: callq  0x104c8c550               ; JavaThread::thread_from_jni_environment(JNIEnv_*)\n0x104ad16c7 &lt;+116&gt;: movq   %rax, %r12\n0x104ad16ca &lt;+119&gt;: movq   %r12, -0x28(%rbp)\n0x104ad16ce &lt;+123&gt;: leaq   -0x28(%rbp), %rdi\n0x104ad16d2 &lt;+127&gt;: movl   $0x6, %esi\n0x104ad16d7 &lt;+132&gt;: callq  0x104926aac               ; ThreadStateTransition::trans_from_native(JavaThreadState)\n0x104ad16dc &lt;+137&gt;: movq   %r12, -0x30(%rbp)\n0x104ad16e0 &lt;+141&gt;: movq   %r12, -0x50(%rbp)\n0x104ad16e4 &lt;+145&gt;: movq   $0x0, -0x48(%rbp)\n0x104ad16ec &lt;+153&gt;: cmpq   $0x0, 0x8(%r12)\n0x104ad16f2 &lt;+159&gt;: je     0x104ad16fd               ; &lt;+170&gt;\n0x104ad16f4 &lt;+161&gt;: leaq   -0x50(%rbp), %rdi\n0x104ad16f8 &lt;+165&gt;: callq  0x104c5cf7c               ; WeakPreserveExceptionMark::preserve()\n0x104ad16fd &lt;+170&gt;: movq   %r14, %rsi\n0x104ad1700 &lt;+173&gt;: movq   %r15, %rdi\n0x104ad1703 &lt;+176&gt;: movq   %rbx, %rdx\n0x104ad1706 &lt;+179&gt;: nop    \n0x104ad1707 &lt;+180&gt;: nopl   (%rax)\n0x104ad170b &lt;+184&gt;: leaq   -0x170(%rbp), %rax\n0x104ad1712 &lt;+191&gt;: movq   %rax, -0x58(%rbp)\n0x104ad1716 &lt;+195&gt;: leaq   0x10(%rbp), %rax\n0x104ad171a &lt;+199&gt;: movq   %rax, -0x60(%rbp)\n0x104ad171e &lt;+203&gt;: movl   $0x30, -0x64(%rbp)\n0x104ad1725 &lt;+210&gt;: movl   $0x18, -0x68(%rbp)\n0x104ad172c &lt;+217&gt;: movl   $0xe, -0x78(%rbp)\n0x104ad1733 &lt;+224&gt;: movq   (%rbx), %rax\n0x104ad1736 &lt;+227&gt;: movq   0x8(%rax), %rax\n0x104ad173a &lt;+231&gt;: movzwl 0x22(%rax), %ecx\n0x104ad173e &lt;+235&gt;: movq   0x8(%rax), %rax\n0x104ad1742 &lt;+239&gt;: movq   0x50(%rax,%rcx,8), %rsi\n0x104ad1747 &lt;+244&gt;: leaq   -0xb8(%rbp), %r14\n0x104ad174e &lt;+251&gt;: movq   %r14, %rdi\n0x104ad1751 &lt;+254&gt;: callq  0x104ca2c14               ; SignatureIterator::SignatureIterator(Symbol*)\n0x104ad1756 &lt;+259&gt;: movl   $0x63, -0xa0(%rbp)\n0x104ad1760 &lt;+269&gt;: movq   $0x0, -0x98(%rbp)\n0x104ad176b &lt;+280&gt;: leaq   0x4f827e(%rip), %rax      ; vtable for JNI_ArgumentPusherVaArg\n0x104ad1772 &lt;+287&gt;: addq   $0x10, %rax\n0x104ad1776 &lt;+291&gt;: movq   %rax, -0xb8(%rbp)\n0x104ad177d &lt;+298&gt;: movq   -0x58(%rbp), %rax\n0x104ad1781 &lt;+302&gt;: movq   %rax, -0x80(%rbp)\n0x104ad1785 &lt;+306&gt;: movq   -0x68(%rbp), %rax\n0x104ad1789 &lt;+310&gt;: movq   -0x60(%rbp), %rcx\n0x104ad178d &lt;+314&gt;: movq   %rcx, -0x88(%rbp)\n0x104ad1794 &lt;+321&gt;: movq   %rax, -0x90(%rbp)\n0x104ad179b &lt;+328&gt;: leaq   -0x78(%rbp), %rsi\n0x104ad179f &lt;+332&gt;: movq   %r15, %rdi\n0x104ad17a2 &lt;+335&gt;: movq   %rbx, %rdx\n0x104ad17a5 &lt;+338&gt;: movq   %r14, %rcx\n0x104ad17a8 &lt;+341&gt;: movq   %r12, %r8\n0x104ad17ab &lt;+344&gt;: callq  0x104ad8877               ; jni_invoke_static(JNIEnv_*, JavaValue*, _jobject*, JNICallType, _jmethodID*, JNI_ArgumentPusher*, Thread*)\n0x104ad17b0 &lt;+349&gt;: cmpq   $0x0, 0x8(%r12)\n0x104ad17b6 &lt;+355&gt;: jne    0x104ad17bf               ; &lt;+364&gt;\n0x104ad17b8 &lt;+357&gt;: nop    \n0x104ad17b9 &lt;+358&gt;: nopl   (%rax)\n0x104ad17bd &lt;+362&gt;: jmp    0x104ad17c4               ; &lt;+369&gt;\n0x104ad17bf &lt;+364&gt;: nop    \n0x104ad17c0 &lt;+365&gt;: nopl   (%rax)\n0x104ad17c4 &lt;+369&gt;: cmpq   $0x0, -0x48(%rbp)\n0x104ad17c9 &lt;+374&gt;: je     0x104ad17d4               ; &lt;+385&gt;\n0x104ad17cb &lt;+376&gt;: leaq   -0x50(%rbp), %rdi\n0x104ad17cf &lt;+380&gt;: callq  0x104c5cefa               ; WeakPreserveExceptionMark::restore()\n0x104ad17d4 &lt;+385&gt;: leaq   -0x30(%rbp), %rdi\n0x104ad17d8 &lt;+389&gt;: callq  0x1048ffc80               ; HandleMarkCleaner::~HandleMarkCleaner()\n0x104ad17dd &lt;+394&gt;: leaq   -0x28(%rbp), %rdi\n0x104ad17e1 &lt;+398&gt;: movl   $0x6, %esi\n0x104ad17e6 &lt;+403&gt;: movl   $0x4, %edx\n0x104ad17eb &lt;+408&gt;: callq  0x104931e04               ; ThreadStateTransition::trans_and_fence(JavaThreadState, JavaThreadState)\n0x104ad17f0 &lt;+413&gt;: addq   $0x150, %rsp\n0x104ad17f7 &lt;+420&gt;: popq   %rbx\n0x104ad17f8 &lt;+421&gt;: popq   %r12\n0x104ad17fa &lt;+423&gt;: popq   %r14\n0x104ad17fc &lt;+425&gt;: popq   %r15\n0x104ad17fe &lt;+427&gt;: popq   %rbp\n0x104ad17ff &lt;+428&gt;: retq   \n</code></pre>\n\n<p>The debuger points to the line (in the code above):</p>\n\n<pre><code> 0x104ad17b0 &lt;+349&gt;: cmpq   $0x0, 0x8(%r12)\n</code></pre>\n\n<p>and next points to the first line of this code as the cause (it does not say where is this code from):</p>\n\n<pre><code>-&gt;  0x1058e5535: movl   0xc(%rdx), %r10d\n    0x1058e5539: movl   0xc(%r12,%r10,8), %ebx\n    0x1058e553e: movl   0x10(%rsi), %r8d\n    0x1058e5542: movl   0xc(%r12,%r8,8), %r9d\n    0x1058e5547: movl   %r9d, 0x14(%rsp)\n    0x1058e554c: movl   0xc(%rsi), %r11d\n    0x1058e5550: movl   %ebx, %ebp\n    0x1058e5552: addl   %r11d, %ebp\n</code></pre>\n\n<p>As I say, this does not happen immediately - the Java application manages to do a couple things. The crash apparently occurs when I tries to use AWT gui classes. Also, the log shows this line (not sure if this is related):</p>\n\n<pre><code>WARNING: GL pipe is running in software mode (Renderer ID=0x1020400)\n</code></pre>\n\n<p>Is this a JVM bug? How should I proceed?</p>\n\n<p>EDIT:</p>\n\n<p>The relevant source code:</p>\n\n<pre><code>void* runJava(void* arg) {\n\n        JNIEnv *env;\n        JavaVM * jvm;\n        int nOptions = 1;\n\n        char jvmLibPath[PATH_MAX];\n\n        if (! jreSearch(jvmLibPath)) {\n            return NULL;\n        }\n\n        void* handle = dlopen(jvmLibPath, RTLD_LAZY);\n\n        NSLog(@\"loaded jvm library %s\\n\", jvmLibPath);\n        if (handle == NULL) {\n            NSLog(@\"error: %s\\n\", dlerror());\n            exit(EXIT_FAILURE);\n        }\n        PtrCreateJavaVM ptrCreateJavaVM = (PtrCreateJavaVM) dlsym(handle, \"JNI_CreateJavaVM\");\n        if (ptrCreateJavaVM == NULL) {\n            fprintf(stderr, \"%s\\n\", dlerror());\n            exit(EXIT_FAILURE);\n        }\n\n        JavaVMOption* options = (JavaVMOption*) malloc(sizeof(JavaVMOption) * (nOptions));\n\n        options[0].optionString = \"-Djava.class.path=../MyJavaApp.jar\";\n\n        JavaVMInitArgs vm_args;\n        vm_args.version = JNI_VERSION_1_8;\n        vm_args.nOptions = nOptions;\n        vm_args.options = options;\n        vm_args.ignoreUnrecognized = 0;\n\n        int ret = ptrCreateJavaVM(&amp;jvm, (void**) &amp;env, &amp;vm_args);\n        if (ret &lt; 0)\n            NSLog(@\"\\nUnable to Launch JVM\\n\");\n\n        if (env == NULL) {\n            exit(EXIT_FAILURE);\n        }\n\n        jclass mainClass = (*env)-&gt;FindClass(env, \"mainpackage.MyMainClass\");\n\n        if (mainClass == 0) {\n            NSLog(@\"Failed to find class (or it's dependencies)\");\n        }\n\n        jmethodID mainMethod = (*env)-&gt;GetStaticMethodID(env, mainClass, \"main\", \"([Ljava/lang/String;)V\");\n        if (mainMethod == 0) {\n            NSLog(@\"Failed to acquire main() method of main class\\n\");\n            exit(EXIT_FAILURE);\n        }\n\n        NSArray *args = [[NSProcessInfo processInfo] arguments];\n        int argc_ =(int)[args count];\n        char** argv_ = getArray(args);\n\n        //application name is not passed to java app, hence (argc - 1)\n        jobjectArray appArgs = (*env)-&gt;NewObjectArray(env, argc_ - 1,(*env)-&gt;FindClass(env, \"java/lang/String\"), NULL);\n        int i;\n        for (i = 0; i &lt; argc_ - 1; i = i + 1) {\n            //argv[i + 1] skipps application name\n            jstring arg = (*env)-&gt;NewStringUTF(env, argv_[i + 1]);\n            (*env)-&gt;SetObjectArrayElement(env, appArgs, i, arg);\n        }\n\n        NSLog(@\"calling main method\\n\");\n        (*env)-&gt;CallStaticVoidMethod(env, mainClass, mainMethod, appArgs);\n        NSLog(@\"after main method\\n\");\n\n\n        (*jvm)-&gt;DestroyJavaVM(jvm);\n        if (options != NULL) {\n            int i;\n            for (i = 0; i &lt; nOptions; i++) {\n                free(options[i].optionString);\n            }\n        }\n\n        NSLog(@\"JVM destroyed\\n\");\n        freeArray(argv_);\n\n        pthread_mutex_lock(&amp;javaFinishedMutex);\n        pthread_cond_signal(&amp;javaFinishedCond);\n        pthread_mutex_unlock(&amp;javaFinishedMutex);\n\n        return NULL;\n}\n</code></pre>\n"}, {"tags": ["c", "exception", "error-handling", "error-code", "return-code"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1435153790, "post_id": 31027834, "comment_id": 50081359, "body": "If all you want to do is print the error message and quit, then <code>main</code> doesn&#39;t look like the right place to do that. Write an error handling function and call it whenever a fatal error occurs, from the place you detect it. OTOH if you want to clean up and continue, you may need something more involved."}, {"owner": {"reputation": 9968, "user_id": 312725, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9GV9q.jpg?s=128&g=1", "display_name": "Max Yankov", "link": "https://stackoverflow.com/users/312725/max-yankov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1435156496, "post_id": 31027834, "comment_id": 50083594, "body": "Whoever flagged this question as &quot;too broad&quot;, I would love to hear your thoughts about why is it too broad and how this question could be improved in that regard."}], "answers": [{"comments": [{"owner": {"reputation": 9968, "user_id": 312725, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9GV9q.jpg?s=128&g=1", "display_name": "Max Yankov", "link": "https://stackoverflow.com/users/312725/max-yankov"}, "edited": false, "score": 1, "creation_date": 1435152460, "post_id": 31027917, "comment_id": 50080292, "body": "I know that I can; but the question is, is it normally used for this purpose? How do experienced C developers make decisions about whether to use or not to use errno for it?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 9968, "user_id": 312725, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9GV9q.jpg?s=128&g=1", "display_name": "Max Yankov", "link": "https://stackoverflow.com/users/312725/max-yankov"}, "edited": false, "score": 0, "creation_date": 1435153518, "post_id": 31027917, "comment_id": 50081155, "body": "OK, reason behind the disagreement? Any counter-logics? Comment for downvote?"}, {"owner": {"reputation": 9968, "user_id": 312725, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9GV9q.jpg?s=128&g=1", "display_name": "Max Yankov", "link": "https://stackoverflow.com/users/312725/max-yankov"}, "edited": false, "score": 0, "creation_date": 1435156064, "post_id": 31027917, "comment_id": 50083230, "body": "&quot;how many if-else or switch statements you&#39;ll need for checking the success of the called function?&quot; One, <code>if (dostuff() == 0)</code>."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1435153353, "last_edit_date": 1435153353, "creation_date": 1435152404, "answer_id": 31027917, "question_id": 31027834, "link": "https://stackoverflow.com/questions/31027834/what-is-the-correct-way-to-implement-error-propagation-in-c/31027917#31027917", "title": "What is the correct way to implement error propagation in C?", "body": "<p>It seems, you can make use of <a href=\"http://man7.org/linux/man-pages/man3/errno.3.html\" rel=\"nofollow\"><code>errno</code></a> variable and <a href=\"http://linux.die.net/man/3/perror\" rel=\"nofollow\"><code>perror()</code></a> functions. They help to provide the reason for failure for <em>most</em> of the time.</p>\n\n<p>Most of the library functions, to indicate the failure, will <em>usually</em> return a prefixed negative value (mostly <code>-1</code>) and set the <code>errno</code> variable to a particular value, depending on the type of the error.</p>\n\n<blockquote>\n  <p><em>is it normally used for this purpose?</em></p>\n</blockquote>\n\n<p>Yes, that is the purpose for having <code>errno</code> and <code>perror()</code>, IMHO.</p>\n\n<p>Now, in case of user-defined functions, you can create own error codes for the errors returned by the library functions (with some time of mapping) and you can return your own value from your function.</p>\n\n<hr>\n\n<p>EDIT:</p>\n\n<blockquote>\n  <p><em>What's the benefit in using both?</em></p>\n</blockquote>\n\n<p>To differentiate the reason for failure, in case of a failure event, in an easy way.</p>\n\n<p>Think it like this, instead of having a fixed reurn value for error and setting errno, if a function returns different values for each type of error,  then how many <code>if-else</code> or <code>switch</code> statements you'll need for checking the success of the called function, each time it's called?  It's huge.</p>\n\n<p>Rather, use a fixed return value to indicate error and if error, then check the errno for the reason behind the error.</p>\n\n<p><sup>[Hope I'm clear. English is not my native language, sorry]</sup></p>\n"}, {"comments": [{"owner": {"reputation": 9968, "user_id": 312725, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9GV9q.jpg?s=128&g=1", "display_name": "Max Yankov", "link": "https://stackoverflow.com/users/312725/max-yankov"}, "edited": false, "score": 0, "creation_date": 1435156280, "post_id": 31028675, "comment_id": 50083403, "body": "&quot;Positive values for success conditions&quot; \u2014 doesn&#39;t it contradict the C convention of returning 0 on success? Having many ways to fail and only one way to succeed seems like a very reasonable convention to me."}, {"owner": {"reputation": 9968, "user_id": 312725, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9GV9q.jpg?s=128&g=1", "display_name": "Max Yankov", "link": "https://stackoverflow.com/users/312725/max-yankov"}, "edited": false, "score": 0, "creation_date": 1435156412, "post_id": 31028675, "comment_id": 50083516, "body": "&quot;comment addressing previous question also addresses this.&quot; I don&#39;t think that we&#39;re talking about the same thing here. You seem to be talking to a general error description string that looks like &quot;File read error&quot;, and I&#39;m talking about a string with specific information, like &quot;Error reading mystuff.txt from open_file() function at 15:24:34&quot;. The error code <code>FILE_OPEN_ERROR</code> is the same, but I want to capture the specifics too."}, {"owner": {"reputation": 9968, "user_id": 312725, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9GV9q.jpg?s=128&g=1", "display_name": "Max Yankov", "link": "https://stackoverflow.com/users/312725/max-yankov"}, "edited": false, "score": 0, "creation_date": 1435156430, "post_id": 31028675, "comment_id": 50083528, "body": "But thanks for the answer \u2014 that&#39;s exactly the <b>type</b> of answer I was looking for."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 9968, "user_id": 312725, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9GV9q.jpg?s=128&g=1", "display_name": "Max Yankov", "link": "https://stackoverflow.com/users/312725/max-yankov"}, "edited": false, "score": 0, "creation_date": 1435157198, "post_id": 31028675, "comment_id": 50084091, "body": "@MaxYankov -  First comment - Yes, for this particular API, I choose a convention, and published it via the header file.  APIs other than the standard C libraries have not settled on a hard convention for positive/negative.  Each established their own.  It depends completely on the developer.  This is why I combine error conditions for all libraries into one exception handling table, to present to the user of the API a consistent set of error conditions <b><i>specific only</i></b> to the API."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 9968, "user_id": 312725, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9GV9q.jpg?s=128&g=1", "display_name": "Max Yankov", "link": "https://stackoverflow.com/users/312725/max-yankov"}, "edited": false, "score": 0, "creation_date": 1435157368, "post_id": 31028675, "comment_id": 50084207, "body": "@MaxYankov -  Second comment - When I want more detailed information about an exception, such as time-stamping, I use the string representation , say from the GetErrorDescription() function, and pass it to a logging routine, in which I can package a log entry to contain the API error description, a time-stamp, and any other information that is relevant, such as what calling function did this error occur in."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 3, "last_activity_date": 1435157717, "last_edit_date": 1435157717, "creation_date": 1435154375, "answer_id": 31028675, "question_id": 31027834, "link": "https://stackoverflow.com/questions/31027834/what-is-the-correct-way-to-implement-error-propagation-in-c/31028675#31028675", "title": "What is the correct way to implement error propagation in C?", "body": "<p>Regarding: <em>I want, in the small body of my main, to get an error code from the functions that I call, to identify what happened, and to print error message to stderr and quit with the same error code as I got</em></p>\n\n<blockquote>\n  <p>First question \u2014 do people do that in C, and is it a good objective,\n  in terms of architecture, at all?</p>\n</blockquote>\n\n<p><strong><em>Some</em></strong> people do this, but <strong><em>All</em></strong> people should.  It is considered good form</p>\n\n<blockquote>\n  <p>Seconds question is about error return codes and errno. What should I\n  use in my code by default? It seems that these two conventions are\n  used interchangeably in C standard library, and it's pretty confusing.</p>\n</blockquote>\n\n<p>See first answer.  It covers this well. (+1 to @Sourav)</p>\n\n<blockquote>\n  <p>Third question is about error codes themselves. In C# and Java, there\n  are standard exception types that cover almost everything you would\n  typically throw, apart from specific comments. Should I use errno\n  error code table for this purpose, or should I create a separate error\n  code table for my application to include all stuff that it specific to\n  it? Or may be every function should maintain it's own specific table\n  of error codes?</p>\n</blockquote>\n\n<p><strong><em>This is completely up to the developer</em></strong>.  When creating an application, I will use specific error codes/messages native to the library call that generated the condition.  When I create an API (usually .dll) I will often create a single enum containing all possible return conditions specific to the application, and will integrate C native library errors into this enum as well. Zero/Positive values for success conditions, and negative for error conditions.  Along with that I create an array of string descriptions corresponding to each return condition.  These are callable by the application via a function, eg. <code>int GetErrorDescription(int error, char *str);</code>.  However, this can be approached several different ways, this is just my approach.  </p>\n\n<p><strong><em>Example:</em></strong>  </p>\n\n<pre><code>/*------------------------------------------\n//List of published error codes\n/*-----------------------------------------*/\nenum    {\n    SUCCESS                        =  0,\n    COPYFILE_ERR_1                 = -1,   //\"CopyFile() error. File not found or directory in path not found.\",\n    COPYFILE_ERR_3                 = -2,   //\"CopyFile() error. General I/O error occurred.\",\n    COPYFILE_ERR_4                 = -3,   //\"CopyFile() error. Insufficient memory to complete operation.\",\n    COPYFILE_ERR_5                 = -4,   //\"CopyFile() error. Invalid path or target and source are same.\",\n    COPYFILE_ERR_6                 = -5,   //\"CopyFile() error. Access denied.\",\n    ...\n    FOPEN_ERR_EIO                  = -11,  //\"fopen() error. I/O error.\",\n    FOPEN_ERR_EBADF                = -12,  //\"fopen() error. Bad file handle.\",\n    FOPEN_ERR_ENOMEM               = -13,  //\"fopen() error. Insufficient memory.\",\n    ...\n    GETFILESIZE_ERR_3              = -24,  //\"GetFileSize() error - Insufficient memory to complete operation.\",\n    GETFILESIZE_ERR_4              = -25,  //\"GetFileSize() error - Invalid path or target and source are same.\",\n    GETFILESIZE_ERR_5              = -26,  //\"GetFileSize() error - Access denied.\",\n    ...\n    PATH_MUST_BE_C_DRIVE           = -38,  //\"SaveFile path variable must contain \\\"c:\\\\\\\".\",\n    HEADER_FIELD_EMPTY             = -39,  //\"one or more of the header fields are incorrect or empty.\",\n    HEADER_FIELD_ILLEGAL_COMMA     = -40,  //\"one or more of the header fields contains a comma.\",\n    ...\n    MAX_ERR                        =  46   // defines the size of the static char ErrMsg\n};\n</code></pre>\n\n<p><strong><em>And</em></strong> then a function to get the description:</p>\n\n<pre><code>int API GetErrorMessage (int err, char * retStr)\n{\n    //verify arguments are not NULL\n    if(retStr == NULL)\n    {\n        return UNINIT_POINTER_ARGUMENT;\n    }\n    switch(err) {\n        case  COPYFILE_ERR_1               : strcpy(retStr, \"CopyFile() error. File not found or directory in path not found.\"     ); break;\n        case  COPYFILE_ERR_3               : strcpy(retStr, \"CopyFile() error. General I/O error occurred.\"                        ); break;\n        case  COPYFILE_ERR_4               : strcpy(retStr, \"CopyFile() error. Insufficient memory to complete operation.\"         ); break;\n        case  COPYFILE_ERR_5               : strcpy(retStr, \"CopyFile() error. Invalid path or target and source are same.\"        ); break;\n        case  COPYFILE_ERR_6               : strcpy(retStr, \"CopyFile() error. Access denied.\"                                     ); break;\n        ...\n        case  FOPEN_ERR_EIO                : strcpy(retStr, \"fopen() error. I/O error.\"                                            ); break;\n        case  FOPEN_ERR_EBADF              : strcpy(retStr, \"fopen() error. Bad file handle.\"                                      ); break;\n        case  FOPEN_ERR_ENOMEM             : strcpy(retStr, \"fopen() error. Insufficient memory.\"                                  ); break;\n        ...\n        case  GETFILESIZE_ERR_3            : strcpy(retStr, \"GetFileSize() error - Insufficient memory to complete operation.\"     ); break;\n        case  GETFILESIZE_ERR_4            : strcpy(retStr, \"GetFileSize() error - Invalid path or target and source are same.\"    ); break;\n        case  GETFILESIZE_ERR_5            : strcpy(retStr, \"GetFileSize() error - Access denied.\"                                 ); break;\n        ...\n        case  HEADER_FIELD_EMPTY           : strcpy(retStr, \" one or more of the header fields are incorrect or empty.\"        ); break;\n        case  HEADER_FIELD_ILLEGAL_COMMA   : strcpy(retStr, \" one or more of the header fields contains a comma.\"              ); break;\n        case  EVENT_FIELD_EMPTY            : strcpy(retStr, \" one or more of the event fields is incorrect or empty.\"          ); break;\n        case  EVENT_FIELD_ILLEGAL_COMMA    : strcpy(retStr, \" one or more of the event fields contains a comma.\"               ); break;\n        ...\n        default:   strcpy(retStr, \"\"); break;\n    }\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>And finally, additional information about errors: I found that in C#,\n  at least, it's very useful to be able to throw an exception of\n  predefined type with a specific comment that provides additional\n  information. Is something like this used in C error management? How\n  should I implement it?</p>\n</blockquote>\n\n<p><strong><em>comment addressing previous question</em></strong> also addresses this.</p>\n\n<blockquote>\n  <p>Why do library functions use return codes and errno at the same time\n  instead of sticking to one or the other? What's the benefit in using\n  both?</p>\n</blockquote>\n\n<p><strong><em>again</em></strong>, covered by Sourav.</p>\n"}, {"comments": [{"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 2, "creation_date": 1435154921, "post_id": 31028677, "comment_id": 50082252, "body": "<code>setjmp&#47;longjmp</code> are plain C, so there is no need to restrict that to POSIX systems."}, {"owner": {"reputation": 9968, "user_id": 312725, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9GV9q.jpg?s=128&g=1", "display_name": "Max Yankov", "link": "https://stackoverflow.com/users/312725/max-yankov"}, "edited": false, "score": 0, "creation_date": 1435156152, "post_id": 31028677, "comment_id": 50083299, "body": "I don&#39;t think you read the question carefully. I didn&#39;t propose to implement exceptions in C; I was only asking about error propagation."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1435157350, "post_id": 31028677, "comment_id": 50084188, "body": "@JensGustedt Thanks, I removed the restriction from my answer."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 9968, "user_id": 312725, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9GV9q.jpg?s=128&g=1", "display_name": "Max Yankov", "link": "https://stackoverflow.com/users/312725/max-yankov"}, "edited": false, "score": 0, "creation_date": 1435158816, "post_id": 31028677, "comment_id": 50085304, "body": "@MaxYankov If you want to propagate errors back to main for handling, anytime you call a function you&#39;ll need to check the return value and return that value up to its caller.  So each function would need to keep track of its own normal return values in addition to error values returned by calling functions.  With <code>setjmp()</code> and <code>longjmp()</code>, you don&#39;t need to worry about any of that."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1435159311, "last_edit_date": 1495539850, "creation_date": 1435154380, "answer_id": 31028677, "question_id": 31027834, "link": "https://stackoverflow.com/questions/31027834/what-is-the-correct-way-to-implement-error-propagation-in-c/31028677#31028677", "title": "What is the correct way to implement error propagation in C?", "body": "<p>Generally speaking, exception-type behavior isn't done in C.  The convention is that the return value of each function is expected to be checked and handled by the immediate caller, along with any ancillary variable (such as errno) that the function may set.  </p>\n\n<p>That being said, you could do something similar to exceptions by using <code>setjmp()</code> and <code>longjmp()</code>.  You use <code>setjmp()</code> to set a jump point, passing in a <code>jmp_buf</code> structure to save the jump point.  Later on in the code, no matter how far down the call stack, you can pass that <code>jmpbuf</code> to <code>longjmp()</code> which will result in control going back up to where <code>setjmp()</code> was called.  You also pass a value to <code>longjmp()</code> which will be the return value of <code>setjmp()</code>.  You can then use this value as a lookup into an error table to print a more detailed message.</p>\n\n<p>There are <a href=\"https://stackoverflow.com/questions/tagged/longjmp\">several</a> other questions related to <code>longjmp()</code> that you can read up on.</p>\n\n<p>EDIT:</p>\n\n<p>An example:</p>\n\n<pre><code>jmp_buf jbuf;\n\nvoid some_function()\n{\n   ...\n   if (some_error()) {\n     longjmp(jbuf, 2);\n     /* control never gets here */\n   }\n   ...\n}\n\nvoid run_program()\n{\n  ...\n  some_function();\n  ...\n}\n\nint main()\n{\n  int rval;\n  if ((rval=setjmp(jbuf)) == 0) {\n    run_program();\n  } else {\n    /* rval will be 2 if the error in some_function() is triggered */\n    printf(\"error %d: %s\\n\", rval, get_err_string(rval));\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 9968, "user_id": 312725, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9GV9q.jpg?s=128&g=1", "display_name": "Max Yankov", "link": "https://stackoverflow.com/users/312725/max-yankov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2341, "favorite_count": 2, "answer_count": 3, "score": 3, "last_activity_date": 1435159311, "creation_date": 1435152231, "last_edit_date": 1435152538, "question_id": 31027834, "link": "https://stackoverflow.com/questions/31027834/what-is-the-correct-way-to-implement-error-propagation-in-c", "title": "What is the correct way to implement error propagation in C?", "body": "<p>I come from high-level languages with exceptions (C#, in particular), and I usually only catch exceptions that my logic knows how to handle \u2014 otherwise, they propagate and program crashes, but at least it provides a clear information about what happened, and where. I want to implement similar behavior in C. I want, in the small body of my <code>main</code>, to get an error code from the functions that I call, to identify what happened, and to print error message to <code>stderr</code> and quit with the same error code as I got.</p>\n\n<ol>\n<li><p>First question \u2014 do people do that in C, and is it a good objective, in terms of architecture, at all?</p></li>\n<li><p>Seconds question is about error return codes and errno. What should I use in my code by default? It seems that these two conventions are used interchangeably in C standard library, and it's pretty confusing.</p></li>\n<li><p>Third question is about error codes themselves. In C# and Java, there are standard exception types that cover almost everything you would typically throw, apart from specific comments. Should I use errno error code table for this purpose, or should I create a separate error code table for my application to include all stuff that it specific to it? Or may be every function should maintain it's own specific table of error codes?</p></li>\n<li><p>And finally, additional information about errors: I found that in C#, at least, it's very useful to be able to throw an exception of predefined type with a specific comment that provides additional information. Is something like this used in C error management? How should I implement it?</p></li>\n<li><p>Why do library functions use return codes <strong>and</strong> errno at the same time instead of sticking to one or the other? What's the benefit in using both?</p></li>\n</ol>\n"}, {"tags": ["c", "race-condition", "exploit"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1435152130, "post_id": 31027320, "comment_id": 50080078, "body": "The errors result from script, not C program, correct?  Post should be tagged Linux, Script.  Not C"}, {"owner": {"reputation": 2337, "user_id": 930169, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/be36a036900e8c4a2d810db772e43280?s=128&d=identicon&r=PG", "display_name": "JACK M", "link": "https://stackoverflow.com/users/930169/jack-m"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1435152221, "post_id": 31027320, "comment_id": 50080146, "body": "yes ,the errors are from the script"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1435152430, "post_id": 31027320, "comment_id": 50080266, "body": "The C code is completely irrelevant to the post.  It is also curious that you are openly asking for help in creating an exploit."}, {"owner": {"reputation": 2337, "user_id": 930169, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/be36a036900e8c4a2d810db772e43280?s=128&d=identicon&r=PG", "display_name": "JACK M", "link": "https://stackoverflow.com/users/930169/jack-m"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1435152753, "post_id": 31027320, "comment_id": 50080521, "body": "It&#39;s just an exercise. I am not trying to exploit something... Sorry, I should point that out."}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 1, "last_activity_date": 1435229471, "last_edit_date": 1435229471, "creation_date": 1435152665, "answer_id": 31028028, "question_id": 31027320, "link": "https://stackoverflow.com/questions/31027320/ln-fails-when-trying-to-manully-trigger-race-conditoin/31028028#31028028", "title": "ln fails when trying to manully trigger race conditoin", "body": "<p>The problem is with the way you call <code>ln</code>-- multiple instances at the same time. The way <code>ln</code> \"forces\" symbolic links is that it <em>unlinks</em> (removes) the destination and recreates it again. But you are calling multiple <code>ln</code> instances at the same time which results in a race condition with other calls to <code>ln</code>. Because one or more instances do unlink of <code>tmp/exploitme</code> but some other instance has already created the new <code>/tmp/exploitme</code>; so the \"file exists\". If you don't spawn multiple <code>ln</code> instances in the background, you won't observe this problem.</p>\n\n<p>Let's me show an example with 2 instances: A and B</p>\n\n<pre><code>Instance A                           Instance B \n\nCalls ln                             Calls ln \n\nDeletes /tmp/expolitme if exists     Deletes /tmp/expolitme if exists\n\nCreates /tmp/expolitme\n\n                                     Creates /tmp/expolitme \n                                     (File exists - because A created it already)\n</code></pre>\n"}], "owner": {"reputation": 2337, "user_id": 930169, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/be36a036900e8c4a2d810db772e43280?s=128&d=identicon&r=PG", "display_name": "JACK M", "link": "https://stackoverflow.com/users/930169/jack-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 31028028, "answer_count": 1, "score": 2, "last_activity_date": 1435229471, "creation_date": 1435150883, "last_edit_date": 1435152773, "question_id": 31027320, "link": "https://stackoverflow.com/questions/31027320/ln-fails-when-trying-to-manully-trigger-race-conditoin", "title": "ln fails when trying to manully trigger race conditoin", "body": "<p><strong>It's just an exercise. I am not trying to exploit something...</strong> </p>\n\n<p>I have a setuid toy program to exploit(decompiled version):</p>\n\n<pre><code>int main(int argc, const char **argv)\n{\n  int v3, v4, v5;\n  int result;\n  int v7;\n  int v8;\n  int v9;\n  int v10;\n\n  memset(&amp;v9, 0, 0x14u);\n  if ( !access(\"/tmp/exploitme\", 4) )\n  {\n    v3 = geteuid();\n    v4 = geteuid();\n    v5 = geteuid();\n    setresuid(v5, v4, v3, argv);\n    v8 = open(\"/tmp/exploitme\", 0);\n    if ( v8 &lt; 0 )\n      exit(-1);\n    read(v8, &amp;v9, 0x13u);\n    write(1, &amp;v9, 0x13u);\n  }\n  result = 0;\n  return result;\n}\n</code></pre>\n\n<p>There exists race condition between the <code>access</code> and <code>open</code>.\nSo here is the script, I use the classical trick: alter nice value to reduce scheduling priority.</p>\n\n<pre><code>#!/bin/sh\n        touch /tmp/myfile\n        while true; do\n                ln -sf /tmp/myfile /tmp/exploitme &amp;\n                nice -15 /workspace/toy &amp;\n                ln -sf /etc/secretfile /tmp/exploitme &amp;\n        done\n</code></pre>\n\n<p>But I get these errors from the script:</p>\n\n<pre><code>ln: failed to create symbolic link '/tmp/expolitme': File exists\nln: cannot remove '/tmp/expolit': No such file or directory\n</code></pre>\n\n<p>I already use -f option of <code>ln</code> to force create symlink. Why I have these errors?</p>\n"}, {"tags": ["c", "sizeof", "side-effects", "variable-length-array"], "answers": [{"comments": [{"owner": {"reputation": 5077, "user_id": 2327831, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/acb1ec5c15fa33042fa79847c55da18d?s=128&d=identicon&r=PG", "display_name": "this", "link": "https://stackoverflow.com/users/2327831/this"}, "edited": false, "score": 2, "creation_date": 1435153051, "post_id": 31027429, "comment_id": 50080806, "body": "You might want to add this somewhere: <i>6.5.3.4 The sizeof and _Alignof operators If the type of the operand is a variable length array type, the operand is evaluated; otherwise, the operand is not evaluated and the result is an integer constant.</i> so fever readers will be confused."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1435271151, "post_id": 31027429, "comment_id": 50144171, "body": "Perhaps I&#39;m missing something, however; sizeof() is a compile time operator, not a run time function.  so (void)sizeof() is nonsence as sizeof() returns a size_t (effectively a long int) value, not a pointer and sizeof() only expects one parameter."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1435304220, "post_id": 31027429, "comment_id": 50154599, "body": "@user3629249 <code>sizeof</code> is a strictly compile-time operator and doesn&#39;t evaluate its operant, <i>except</i> when its operand is a VLA, then it does evaluate it, at runtime. The <code>(void)</code> cast has nothing to do with pointers : it explicitly discards the value <code>sizeof</code> just calculated. It doesn&#39;t actually affect the behaviour of the program, but is better style than just having an expression that is computed, and then dropped on the floor (for which GCC produces a warning). [cont.]"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1435304404, "post_id": 31027429, "comment_id": 50154706, "body": "@user3629249 Finally, don&#39;t let the syntax trick you : <code>sizeof</code> is an operator, not a function, and it doesn&#39;t take parentheses when its operand is an expression (it does for a type). The parentheses here are to give precedence to the comma operator (which is not the comma of an argumet list). <code>sizeof</code> still takes a single operand, that is the result of what&#39;s in the parentheses."}], "tags": [], "owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "is_accepted": true, "score": 19, "last_activity_date": 1435153439, "last_edit_date": 1495542827, "creation_date": 1435151170, "answer_id": 31027429, "question_id": 31027237, "link": "https://stackoverflow.com/questions/31027237/vlas-and-side-effect-in-sizeofs-operand/31027429#31027429", "title": "VLAs and side-effect in sizeof&#39;s operand", "body": "<p>It seems that I should think twice before posting, because it struck me right after I did.</p>\n\n<p>My understanding of how <code>sizeof</code> interacts with VLAs is actually correct, as the following quote confirms (thanks @this !) :</p>\n\n<blockquote>\n  <p>6.5.3.4 The <code>sizeof</code> and <code>_Alignof</code> operators<br>\n  If the type of the operand is a variable length array type, the operand is evaluated; otherwise, the operand is not evaluated and the result is an integer constant</p>\n</blockquote>\n\n<p>That's not what is causing this surprising (to me) behaviour.</p>\n\n<pre><code>(void)sizeof (g(2), arr);\n</code></pre>\n\n<p>In the <code>(g(2), arr)</code> subexpression, the comma operator triggers <code>arr</code>'s array-to-pointer decay. Thus, <code>sizeof</code>'s operand is no longer a VLA, but a plain <code>char*</code>, and it falls back to not evaluating its operand.</p>\n\n<p><a href=\"https://stackoverflow.com/a/6331639/3233393\">Apparently</a> this behaviour has been altered in C++, where the comma operator won't decay arrays anymore.</p>\n"}], "owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 4, "accepted_answer_id": 31027429, "answer_count": 1, "score": 21, "last_activity_date": 1435844384, "creation_date": 1435150655, "last_edit_date": 1435844384, "question_id": 31027237, "link": "https://stackoverflow.com/questions/31027237/vlas-and-side-effect-in-sizeofs-operand", "title": "VLAs and side-effect in sizeof&#39;s operand", "body": "<p>I know that <code>sizeof</code> never evaluates its operand, except in the specific case where said operand is a VLA. Or, I <em>thought</em> I knew.</p>\n\n<pre><code>void g(int n) {\n    printf(\"g(%d)\\n\", n);\n}\n\nint main(void) {\n    int i = 12;\n\n    char arr[i]; // VLA\n\n    (void)sizeof *(g(1), &amp;arr); // Prints \"g(1)\"\n    (void)sizeof (g(2), arr);   // Prints nothing\n\n    return 0;\n}\n</code></pre>\n\n<p>What is going on?</p>\n\n<p>Just in case, this is compiled with GCC 5.1 on <a href=\"http://coliru.stacked-crooked.com/a/e5df9b8378c56c18\" rel=\"noreferrer\">Coliru</a>.</p>\n"}, {"tags": ["c", "visual-c++", "enums", "switch-statement"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 2, "creation_date": 1435151532, "post_id": 31027195, "comment_id": 50079609, "body": "<code>switch</code> statement takes an expression, not a type."}, {"owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 0, "creation_date": 1435158793, "post_id": 31027195, "comment_id": 50085286, "body": "also, you might want to use C++11 <code>enum class</code> instead of regular C-enums"}, {"owner": {"reputation": 3431, "user_id": 2482998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afd7c230e485da1a1ecfa351bd3744d9?s=128&d=identicon&r=PG", "display_name": "antron", "link": "https://stackoverflow.com/users/2482998/antron"}, "edited": false, "score": 0, "creation_date": 1435166032, "post_id": 31027195, "comment_id": 50090254, "body": "Do you mean <code>switch (rose)</code>? If you have <code>enum class Flower</code>, then <code>switch (Flower::rose)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 1, "last_activity_date": 1435154249, "creation_date": 1435154249, "answer_id": 31028628, "question_id": 31027195, "link": "https://stackoverflow.com/questions/31027195/how-to-pass-enum-name-to-switch-directly-vc-mfc/31028628#31028628", "title": "How to pass enum name to switch directly, vc++ mfc", "body": "<p>You probably want this:</p>\n\n<pre><code>Flower f = rose;\n...\nswitch (f)\n{\n  case rose : //Code for rose\n  case jasmine: //Code for jasmine\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 5044637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230b3ebeacbd16c4a633b00954155f2c?s=128&d=identicon&r=PG&f=1", "display_name": "Anu Jacob", "link": "https://stackoverflow.com/users/5044637/anu-jacob"}, "edited": false, "score": 0, "creation_date": 1435224864, "post_id": 31030082, "comment_id": 50114986, "body": "Thank u so much..this was wat i was looking for. Got my program correct :-)"}], "tags": [], "owner": {"reputation": 139, "user_id": 1509945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/spIRU.jpg?s=128&g=1", "display_name": "hankym", "link": "https://stackoverflow.com/users/1509945/hankym"}, "is_accepted": true, "score": 0, "last_activity_date": 1435158639, "last_edit_date": 1435158639, "creation_date": 1435158080, "answer_id": 31030082, "question_id": 31027195, "link": "https://stackoverflow.com/questions/31027195/how-to-pass-enum-name-to-switch-directly-vc-mfc/31030082#31030082", "title": "How to pass enum name to switch directly, vc++ mfc", "body": "<p>In C and C++ Programmer,<strong>switch(Expression)</strong>,the Expression's result must be a integer value. enum Flower{rose,jasmine}; <strong>Flower</strong> is just a Type,not a value,\nlike int rose = 0,int jasmine=1,you can't use it in switch expression.\nYou can just define like <strong>enum Flower fname</strong>;</p>\n\n<pre><code>switch(fname)\n{\n   case rose:\n    ...\n   break;\n   case jasmine:\n    ...\n   break;\n   default:\n   break;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5044637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230b3ebeacbd16c4a633b00954155f2c?s=128&d=identicon&r=PG&f=1", "display_name": "Anu Jacob", "link": "https://stackoverflow.com/users/5044637/anu-jacob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 31030082, "answer_count": 2, "score": 0, "last_activity_date": 1435158639, "creation_date": 1435150524, "last_edit_date": 1435154294, "question_id": 31027195, "link": "https://stackoverflow.com/questions/31027195/how-to-pass-enum-name-to-switch-directly-vc-mfc", "title": "How to pass enum name to switch directly, vc++ mfc", "body": "<p>I am searching to know how to pass the enum name directly to switch case.\nEg:</p>\n\n<pre><code>enum Flower { rose, jasmine };\n\nswitch (Flower)\n{\ncase rose : //Code for rose\ncase jasmine: //Code for jasmine\n}\n</code></pre>\n\n<p>Someone please help me how to do this way? I found this code portions from C. But I need the same code portions in C++. Is it possible in c++? Please help me. Thanks all</p>\n"}, {"tags": ["c", "memory"], "comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 2, "creation_date": 1435155158, "post_id": 31026703, "comment_id": 50082439, "body": "the <code>(s)brk</code> functions are legacy functions, and <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/xrat/V4_xsh_chap03.html\" rel=\"nofollow noreferrer\">have been removed from the POSIX standard</a>. AFAIK, they were never part of the C standard either"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1502027843, "post_id": 31026703, "comment_id": 78025412, "body": "Not only that, it&#39;s not safe to call <code>sbrk</code> with a nonzero argument, or <code>brk</code> <i>at all</i>, unless you are the implementation of <code>malloc</code>. Moving the break around behind <code>malloc</code>&#39;s back will corrupt internal data structures and cause the program to crash the next time <code>malloc</code>, <code>realloc</code> or <code>free</code> is used \u2014 and nearly all C library functions are allowed to use <code>malloc</code> internally!"}], "answers": [{"comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1435160299, "post_id": 31026883, "comment_id": 50086419, "body": "Actually, most good implementations of <code>malloc</code>  use <a href=\"http://man7.org/linux/man-pages/man2/mmap.2.html\" rel=\"nofollow noreferrer\">mmap(2)</a> these days. <code>sbrk</code>  &amp; <code>brk</code>  tend to become obsolete (and thread unfriendly)"}], "tags": [], "owner": {"reputation": 8576, "user_id": 1885392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fa9976e536ff5ce475f728ce97f8227?s=128&d=identicon&r=PG", "display_name": "stefan.schwetschke", "link": "https://stackoverflow.com/users/1885392/stefan-schwetschke"}, "is_accepted": false, "score": 7, "last_activity_date": 1435163018, "last_edit_date": 1495541395, "creation_date": 1435149660, "answer_id": 31026883, "question_id": 31026703, "link": "https://stackoverflow.com/questions/31026703/difference-between-brk-sbrk-and-realloc-functions/31026883#31026883", "title": "Difference between brk() , sbrk() and realloc() functions", "body": "<p><code>brk</code> and <code>sbrk</code> are system calls (implemented in the kernel) while <code>malloc</code>, <code>free</code>, <code>realloc</code> are library functions in user space. So the <code>malloc</code> etc functions use <code>brk</code> and <code>sbrk</code> internally but provide additional functionality (see <a href=\"http://man7.org/linux/man-pages/man2/sbrk.2.html\" rel=\"nofollow noreferrer\">man(2)</a> for more details about <code>brk</code> and <a href=\"http://unixhelp.ed.ac.uk/CGI/man-cgi?realloc%203\" rel=\"nofollow noreferrer\">man(3)</a> for more details about <code>malloc</code>.).</p>\n\n<p><code>brk</code> only tells the kernel how much memory your program wants to use, by giving the the kernel a pointer to the largest virtual memory location that your program may use. But you only have exactly <em>one</em> big chunk of memory.</p>\n\n<p><code>malloc</code> helps you to subdivide this huge block of memory into smaller parts.</p>\n\n<p>Example code doesn't make much sense here, because <code>brk</code> and <code>malloc</code> work on different levels. But you could think how you would implement a very simple (and non-thread-safe) version of <code>malloc</code> and <code>free</code> and where you would use <code>brk</code> there:</p>\n\n<ol>\n<li>The basic data structure for our primitive malloc is a linked list.</li>\n<li>Each list element in the list contains of:\n\n<ol>\n<li>The size of the block</li>\n<li>A pointer to the next element</li>\n<li>A flag if the block is in use</li>\n<li>A flag if it is the last element</li>\n<li>An array of bytes with the given size</li>\n</ol></li>\n<li>In each call, malloc goes through the list and checks for each block\n\n<ol>\n<li>If the block is flagged as \"not in use\"</li>\n<li>If the size field of the list element is at most as big as the size needed</li>\n</ol></li>\n<li>If malloc finds such a block, it will:\n\n<ol>\n<li>Mark the list element as used</li>\n<li>Adjust the size field in the list element</li>\n<li>If there is enough space then add a list element after the element, pointing to the next element in the list (if applicable)</li>\n<li>Return a pointer to the byte array of the list element it found</li>\n</ol></li>\n<li>If malloc doesn't find such a list element, it will\n\n<ol>\n<li>Call <code>brk</code> to increase the usable memory we got from the kernel</li>\n<li>Add a new element to the end of the list, set the size to the desired size</li>\n<li>Mark this element as in use AND as the last element </li>\n<li>Return a pointer to the byte array of the newly created list entry</li>\n</ol></li>\n</ol>\n\n<p>And as <a href=\"https://stackoverflow.com/users/841108/basile-starynkevitch\">@BasileStarynkevitch</a> remarked in his comment, as an alternative to <code>brk</code> you could also use <code>mmap</code> (with <code>fd=-1</code> and  <code>flags=MAP_PRIVATE|MAP_ANONYMOUS</code>) to reserve a single block of memory backed by the swap file. For details about mmap see <a href=\"http://man7.org/linux/man-pages/man2/mmap.2.html\" rel=\"nofollow noreferrer\">man(2)</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 5, "last_activity_date": 1435150221, "creation_date": 1435150221, "answer_id": 31027080, "question_id": 31026703, "link": "https://stackoverflow.com/questions/31026703/difference-between-brk-sbrk-and-realloc-functions/31027080#31027080", "title": "Difference between brk() , sbrk() and realloc() functions", "body": "<p>At the OS level (in the Unix model, at least), your program has one big region of memory for program text, initialized and uninitialized data, and the \"heap\", for dynamically-allocated data.  (The stack is separate.)  You can adjust the size of that region using <code>brk</code> and <code>sbrk</code>, but you can't rearrange it, and it's always contiguous.  The vast majority of programs that do dynamic memory allocation require something more flexible.</p>\n\n<p><code>malloc</code>, <code>free</code>, and <code>realloc</code> are C library functions that give you something more flexible.  Underneath, they get memory from the OS by calling <code>brk</code> and/or <code>sbrk</code>, but then they do extra processing to let you allocate (a) any number of chunks of (b) different sizes and which you can (c) individually return to the pool when you're done with them and incidentally (d) resize.</p>\n\n<p>But when you return memory to the pool with <code>free</code>, it generally just goes back into the pool that future calls to <code>malloc</code> by your program will draw from; memory is generally <em>not</em> given back to the OS.</p>\n\n<p>(Sorry for not providing any example code; I don't have time for that just now.)</p>\n"}], "owner": {"reputation": 99, "user_id": 4449489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40a1bc21275f1b6e0e174698e33b00f4?s=128&d=identicon&r=PG&f=1", "display_name": "Vishwanath Gulabal", "link": "https://stackoverflow.com/users/4449489/vishwanath-gulabal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2611, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1553487213, "creation_date": 1435149224, "last_edit_date": 1553487213, "question_id": 31026703, "link": "https://stackoverflow.com/questions/31026703/difference-between-brk-sbrk-and-realloc-functions", "title": "Difference between brk() , sbrk() and realloc() functions", "body": "<p>As i know the functions brk() , sbrk() are used for reallocating the memory.But how they are different from realloc() function ?.Give me the coding examples.</p>\n"}, {"tags": ["c", "dll", "makefile", "dllexport", "umfpack"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1435150161, "post_id": 31026614, "comment_id": 50078586, "body": "Std warning: do not cast malloc return."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1435151764, "post_id": 31026614, "comment_id": 50079795, "body": "every call to malloc needs to have the returned value checked (!=NULL) to assure the operation was successful.    On those conditions where some malloc has been called and the function create() eventually returns NULL, there is a memory leak unless all malloc&#39;d memory is (before returning NULL) passed to free()   Note: if all memory pointers are initially set to NULL, then calling free() for each pointer be easy as passing NULL to free() is ok."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1435151855, "post_id": 31026614, "comment_id": 50079871, "body": "there are a lot of macro definitions being referenced in the posted makefile, but I do not see where those macros are being defined."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1435152004, "post_id": 31026614, "comment_id": 50079971, "body": "there are some targets in the posted makefile that are not actual files.  Those targets need to be part of a &#39;.PHONY: statement, like &#39;.PHONY: libs all"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1435152113, "post_id": 31026614, "comment_id": 50080066, "body": "@LPs, OP is returning with out free&#39;ing the non-failing call(s) to malloc"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1435153467, "post_id": 31026614, "comment_id": 50081121, "body": "@user3629249 You&#39;re right. I cancelled."}, {"owner": {"reputation": 43, "user_id": 4990036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/531b3643870df59e41bbafc209d9e7ed?s=128&d=identicon&r=PG&f=1", "display_name": "TKireev", "link": "https://stackoverflow.com/users/4990036/tkireev"}, "edited": false, "score": 0, "creation_date": 1435215266, "post_id": 31026614, "comment_id": 50109065, "body": "Also I&#39;ve added shell output when I type command make."}, {"owner": {"reputation": 43, "user_id": 4990036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/531b3643870df59e41bbafc209d9e7ed?s=128&d=identicon&r=PG&f=1", "display_name": "TKireev", "link": "https://stackoverflow.com/users/4990036/tkireev"}, "edited": false, "score": 0, "creation_date": 1435215837, "post_id": 31026614, "comment_id": 50109367, "body": "It is very strange. When I just call printf(&quot;a&quot;) the program dies - stops respond."}], "owner": {"reputation": 43, "user_id": 4990036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/531b3643870df59e41bbafc209d9e7ed?s=128&d=identicon&r=PG&f=1", "display_name": "TKireev", "link": "https://stackoverflow.com/users/4990036/tkireev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1435215686, "creation_date": 1435149000, "last_edit_date": 1435215686, "question_id": 31026614, "link": "https://stackoverflow.com/questions/31026614/build-dll-for-large-c-project-with-makefile", "title": "Build dll for large C project with makefile", "body": "<p>I'm trying to build simple dll which uses library UMFPACK. </p>\n\n<p>Here is my file \"umfsolver.c\":</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"umfpack.h\"\n#include \"amd.h\"\n\n#define MAX(a,b) (((a) &gt; (b)) ? (a) : (b))\n\n#ifdef BUILD_DLL\n#define EXPORT __declspec(dllexport)\n#else\n#define EXPORT __declspec(dllimport)\n#endif\n\ntypedef struct problem_struct\n{\n    double Control [UMFPACK_CONTROL];\n    double Info [UMFPACK_INFO];\n    int *Ti;\n    int *Tj;\n    double *Tx;\n    int nrow;\n    int ncol;\n    int nz;\n} problem;\n\n\nEXPORT problem* __stdcall create(int nrows, int ncols, int nnonzero) \n{\n\n    problem *prob;\n    prob = (problem*) malloc(sizeof (problem)) ;\n    if (!prob) return (NULL);\n    prob-&gt;nrow = nrows;\n    prob-&gt;ncol = ncols;\n    prob-&gt;nz = nnonzero;\n    printf(\"Creating...\\n\");\n    umfpack_di_defaults (prob-&gt;Control) ;\n    prob-&gt;Control [UMFPACK_PRL] = 3 ;\n    prob-&gt;Control [UMFPACK_BLOCK_SIZE] = 32 ;\n    prob-&gt;Ti = (int *) malloc (nnonzero * sizeof (int)) ;\n    prob-&gt;Tj = (int *) malloc (nnonzero * sizeof (int)) ;\n    prob-&gt;Tx = (double *) malloc (nnonzero * sizeof (double)) ;\n    if (!prob-&gt;Ti || !prob-&gt;Tj || !prob-&gt;Tx ) return (NULL);\n    return prob;\n}\n</code></pre>\n\n<p>And here is my makefile:</p>\n\n<pre><code>all: libs umfsolver\n\ninclude ../../SuiteSparse_config/SuiteSparse_config.mk\n\n#-------------------------------------------------------------------------------\n# the optional Partition module requires METIS, CAMD, and CCOLAMD\nI_WITH_PARTITION = \nLIB_WITH_PARTITION =\nCONFIG1 = -DNCHOLMOD\nCONFIG2 = -DNPARTITION\nifeq (,$(findstring -DNCHOLMOD, $(UMFPACK_CONFIG)))\n    # CHOLMOD is requested.  See if it is available\n    ifeq (../../CHOLMOD, $(wildcard ../../CHOLMOD))\n        ifeq (../../COLAMD, $(wildcard ../../COLAMD))\n            # CHOLMOD and COLAMD are available\n            CONFIG1 =\n            LIB_WITH_CHOLMOD = ../../CHOLMOD/Lib/libcholmod.a \\\n                ../../COLAMD/Lib/libcolamd.a\n            # check if METIS is requested and available\n            ifeq (,$(findstring -DNPARTITION, $(CHOLMOD_CONFIG)))\n                # METIS is requested.  See if it is available\n                ifeq ($(METIS_PATH), $(wildcard $(METIS_PATH)))\n                    ifeq (../../CAMD, $(wildcard ../../CAMD))\n                        ifeq (../../CCOLAMD, $(wildcard ../../CCOLAMD))\n                            # METIS, CAMD, and CCOLAMD are available\n                            LIB_WITH_PARTITION = $(METIS) \\\n                                ../../CCOLAMD/Lib/libccolamd.a \\\n                                ../../CAMD/Lib/libcamd.a\n                            I_WITH_PARTITION = -I$(METIS_PATH)/Lib \\\n                                -I../../CCOLAMD/Include -I../../CAMD/Include\n                            CONFIG2 =\n                        endif\n                    endif\n                endif\n            endif\n        endif\n    endif\nendif\n#-------------------------------------------------------------------------------\n\nC = $(CC) $(CF) $(UMFPACK_CONFIG) $(CONFIG1) $(CONFIG2) \\\n    -I../Include -I../../AMD/Include -I../../SuiteSparse_config\n\nINC = ../Include/umfpack.h ../../AMD/Include/amd.h ../../SuiteSparse_config/SuiteSparse_config.h\n\nLIBS = $(LAPACK) $(BLAS) $(XERBLA) $(LIB) $(LIB_WITH_CHOLMOD) $(LIB_WITH_PARTITION) $(CUBLAS_LIB) $(CUDART_LIB)\n\n../Lib/libumfpack.a:\n    ( cd ../Lib ; $(MAKE) )\n\n../../AMD/Lib/libamd.a:\n    ( cd ../../AMD ; $(MAKE) library )\n\n../../SuiteSparse_config/libsuitesparseconfig.a:\n    ( cd ../../SuiteSparse_config ; $(MAKE) library )\n\n../../CHOLMOD/Lib/libcholmod.a:\n    - ( cd ../../CHOLMOD &amp;&amp; $(MAKE) library )\n\n../../COLAMD/Lib/libcolamd.a:\n    - ( cd ../../COLAMD &amp;&amp; $(MAKE) library )\n\n\n../../CCOLAMD/Lib/libccolamd.a:\n    - ( cd ../../CCOLAMD &amp;&amp; $(MAKE) library )\n\n../../CAMD/Lib/libcamd.a:\n    - ( cd ../../CAMD &amp;&amp; $(MAKE) library )\n\n$(METIS):\n    ( cd $(METIS_PATH) &amp;&amp; $(MAKE) )\n\nUMFPACK = ../Lib/libumfpack.a ../../AMD/Lib/libamd.a \\\n    ../../SuiteSparse_config/libsuitesparseconfig.a \\\n    $(LIB_WITH_CHOLMOD) $(LIB_WITH_PARTITION) \n\nlibs: $(UMFPACK)\n\n\numfsolver: umfsolver.c $(UMFPACK)\n    $(C) -c -DBUILD_DLL umfsolver.c \n    $(C) -shared -o umfsolver.dll umfsolver.o -Wl,--add-stdcall-alias $(UMFPACK) $(LIBS) -lm\n</code></pre>\n\n<p>I used variables:</p>\n\n<pre><code>CF = -O3 -fexceptions -fPIC\nCC = cc\nLIB = -lm -lrt\nUMFPACK_CONFIG = -DNBLAS -LD:/SuiteSparseBuild/UMFPACK/Lib -lsuitesparseconfig -lrt\nMAKE = make\nCUBLAS_LIB = \nCUDART_LIB = \nXERBLA = \nBLAS = \nLAPACK = \nMETIS_PATH = ../../metis-4.0\nMETIS = ../../metis-4.0/libmetis.a\n</code></pre>\n\n<p>It builds with no errors. When I'm calling function <code>create</code> from another program (using static dllimport), it works until some library function need to be called inside <code>create</code>.</p>\n\n<p>It seems like the program goes to infinite loop when either it calls <code>printf(\"Creating...\\n\")</code> or <code>umfpack_di_defaults (prob-&gt;Control)</code>.</p>\n\n<p>When I type make, I get this: </p>\n\n<pre><code>cc    -O3 -fexceptions -fPIC -DNBLAS -LD:/SuiteSparseBuild/UMFPACK/Lib -lsuitesparseconfig -lrt   -I../Include -I../../AMD/Include -I../../SuiteSparse_config -c -DBUILD_DLL umfsolver.c\ncc1: warning: fPIC ignored for target (all code is position independent)\ncc    -O3 -fexceptions -fPIC -DNBLAS -LD:/SuiteSparseBuild/UMFPACK/Lib -lsuitesparseconfig -lrt   -I../Include -I../../AMD/Include -I../../SuiteSparse_config -shared -o umfsolver.dll umfsolver.o ../Lib/libumfpack.a ../../AMD/Lib/libamd.a ../../SuiteSparse_config/libsuitesparseconfig.a ../../CHOLMOD/Lib/libcholmod.a ../../COLAMD/Lib/libcolamd.a ../../metis-4.0/libmetis.a ../../CCOLAMD/Lib/libccolamd.a ../../CAMD/Lib/libcamd.a     -lm -lrt ../../CHOLMOD/Lib/libcholmod.a ../../COLAMD/Lib/libcolamd.a ../../metis-4.0/libmetis.a ../../CCOLAMD/Lib/libccolamd.a ../../CAMD/Lib/libcamd.a    -Wl,--add-stdcall-alias\n</code></pre>\n\n<p>I guess that I should somehow change the makefile to put all library files together? \nHow can I do this? Can anyone explain me this?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "int", "hex", "bit-fields", "negative-number"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1435148716, "post_id": 31026471, "comment_id": 50077534, "body": "Both the snippets are same.....(edited) not any more. :-)"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1435148781, "post_id": 31026471, "comment_id": 50077587, "body": "What do you think is the representation of -1?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1435148901, "post_id": 31026471, "comment_id": 50077683, "body": "The bit fields are irrelevant - you will get the same result if you pass <code>-1</code> to <code>printf</code> in place of <code>t.x</code>."}, {"owner": {"reputation": 5413, "user_id": 1743849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5cwvZ.jpg?s=128&g=1", "display_name": "rakeb.mazharul", "link": "https://stackoverflow.com/users/1743849/rakeb-mazharul"}, "edited": false, "score": 0, "creation_date": 1435150308, "post_id": 31026471, "comment_id": 50078698, "body": "I don&#39;t understand why down vote?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 5413, "user_id": 1743849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5cwvZ.jpg?s=128&g=1", "display_name": "rakeb.mazharul", "link": "https://stackoverflow.com/users/1743849/rakeb-mazharul"}, "edited": false, "score": 0, "creation_date": 1435150561, "post_id": 31026471, "comment_id": 50078887, "body": "@rakeb.void Somebody having an &quot;angry day&quot;. I wrote the only answer that explains <i>why</i> the bit field turns into an int and got down voted too, no reason given..."}], "answers": [{"tags": [], "owner": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "is_accepted": false, "score": 1, "last_activity_date": 1435148797, "creation_date": 1435148797, "answer_id": 31026546, "question_id": 31026471, "link": "https://stackoverflow.com/questions/31026471/bit-fields-in-c/31026546#31026546", "title": "Bit Fields in C", "body": "<p>Your system (and almost all) systems stores negative numbers in 2's complement form. <code>-1</code> is represented as <code>FFH</code> in 8-bit 2's complement form. </p>\n\n<p>What you are observing is sign extended 2's complement of '-1'.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 1, "last_activity_date": 1435149193, "last_edit_date": 1435149193, "creation_date": 1435148801, "answer_id": 31026550, "question_id": 31026471, "link": "https://stackoverflow.com/questions/31026471/bit-fields-in-c/31026550#31026550", "title": "Bit Fields in C", "body": "<p><code>%x</code> prints the hex representation of the value of the given argument. The two's complement representation of <code>-1</code>, in hex, gives you that <code>ffffffff</code>. </p>\n\n<p><sup>FWIW: This outcome is not particularly related to use of bit-filed variable here, as <code>printf()</code> is a <a href=\"https://en.wikipedia.org/wiki/Variadic_function\" rel=\"nofollow\">variadic function</a>.</sup></p>\n"}, {"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 3, "last_activity_date": 1435149110, "creation_date": 1435149110, "answer_id": 31026658, "question_id": 31026471, "link": "https://stackoverflow.com/questions/31026471/bit-fields-in-c/31026658#31026658", "title": "Bit Fields in C", "body": "<p>When you pass your bit field to <code>printf</code>, a function with variable number of arguments, the value undergoes a conversion to <code>int</code>. Even though the value has only two bits, its binary value of <code>11</code> means <code>-1</code> in two's complement representation, so the value gets sign-extended into an integer <code>-1</code> when it is sent to <code>printf</code>. This is <code>0xffffffff</code> in hex representation on 32-bit systems.</p>\n\n<p>If you would like to see only two bits printed as hex, make your bit field unsigned. This will ensure that no sign extension would be performed before printing:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nstruct test \n{\n   unsigned int x: 2;\n   unsigned int y: 2;\n};\nint main()\n{\n   struct test t;\n   t.x = -1;\n   printf(\"%x\", t.x);\n   return 0;\n}\n</code></pre>\n\n<p>This prints 3 (<a href=\"http://ideone.com/9MNAfb\" rel=\"nofollow\">demo</a>).</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1435150594, "last_edit_date": 1495542141, "creation_date": 1435150244, "answer_id": 31027088, "question_id": 31026471, "link": "https://stackoverflow.com/questions/31026471/bit-fields-in-c/31027088#31027088", "title": "Bit Fields in C", "body": "<p>This has nothing to do with bit fields as such. It happens because of an obscure rule in C called <em>the default argument promotions</em>:</p>\n\n<blockquote>\n  <p>If the expression that denotes the called function has a type that\n  does not include a prototype, <strong>the integer promotions are performed on\n  each argument</strong>, and arguments that have type float are promoted to\n  double. These are called the default argument promotions.</p>\n</blockquote>\n\n<p>(Emphasis mine) And this rule also applies to variadic functions like printf:</p>\n\n<blockquote>\n  <p>The ellipsis notation in a function prototype declarator causes\n  argument type conversion to stop after the last declared parameter.\n  The default argument promotions are performed on trailing arguments.</p>\n</blockquote>\n\n<p>So your bit field is integer promoted to type <code>int</code> before printf even starts interpreting it. The sign is preserved, so what you are seeing is the hex representation of a two's complement <code>int</code> containing the value -1.</p>\n\n<p>As a side note, I would not recommend you to use bit fields at all, as their behavior is poorly specified and they are completely non-portable. <a href=\"https://stackoverflow.com/questions/6043483/why-bit-endianness-is-an-issue-in-bitfields/6044223#6044223\">See this</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 5413, "user_id": 1743849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5cwvZ.jpg?s=128&g=1", "display_name": "rakeb.mazharul", "link": "https://stackoverflow.com/users/1743849/rakeb-mazharul"}, "is_accepted": false, "score": 1, "last_activity_date": 1435150246, "creation_date": 1435150246, "answer_id": 31027089, "question_id": 31026471, "link": "https://stackoverflow.com/questions/31026471/bit-fields-in-c/31027089#31027089", "title": "Bit Fields in C", "body": "<p><code>%x</code> means that <code>printf</code> will output its value in hexadecimal format. Now, the question is why the output of <code>-1</code> is looks like <code>ffffffff</code> (<code>0xffffffff</code>). </p>\n\n<p><code>1 byte</code> means <code>8 bits</code>, and in hexadecimal, you can fit up to <code>f</code> in <code>4 bits</code>. So <code>1 byte</code> can hold maximum value of <code>ff</code> in hexadecimal.</p>\n\n<p>So, </p>\n\n<pre><code>Bytes       Hex            Bin\n1 byte      ff             11111111\n4 byte      ff ff ff ff    11111111 11111111 11111111 11111111\n</code></pre>\n\n<p>Now, <code>-1</code> is representative as <a href=\"https://en.wikipedia.org/wiki/Two&#39;s_complement\" rel=\"nofollow\">Two's complement</a>, means it is a negative number of <code>1</code>. </p>\n\n<pre><code>toggle:   00000000 00000000 00000000 00000001 (to fit in 4 byte)\ntoggle:   11111111 11111111 11111111 11111110\n+1    :                                    +1\n----------------------------------------------\nvalue :   11111111 11111111 11111111 11111111\nhex   :   ff       ff       ff       ff\n</code></pre>\n\n<p>So, <code>0xffffffff</code> is tows complements representation of <code>-1</code>. No magic.</p>\n"}], "owner": {"reputation": 69, "user_id": 4944265, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-grcUuFl9UDA/AAAAAAAAAAI/AAAAAAAAAC4/R2Z7cDuhHoA/photo.jpg?sz=128", "display_name": "govind kumar Gupta", "link": "https://stackoverflow.com/users/4944265/govind-kumar-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1838, "favorite_count": 1, "accepted_answer_id": 31026550, "answer_count": 5, "score": 1, "last_activity_date": 1435150594, "creation_date": 1435148579, "last_edit_date": 1435149242, "question_id": 31026471, "link": "https://stackoverflow.com/questions/31026471/bit-fields-in-c", "title": "Bit Fields in C", "body": "<p>I have the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nstruct test \n{\n   int x: 2;\n   int y: 2;\n};\nint main()\n{\n   test t;\n   t.x = -1;\n   printf(\"%d\", t.x);\n   return 0;\n}\n</code></pre>\n\n<p>This snippet prints <code>-1</code> which I can understand, </p>\n\n<p>If the same code, <code>%d</code>is replaced with <code>%x</code> format specifier like below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nstruct test \n{\n   int x: 2;\n   int y: 2;\n};\nint main()\n{\n   test t;\n   t.x = -1;\n   printf(\"%x\", t.x);\n   return 0;\n}\n</code></pre>\n\n<p>The output becomes <code>ffffffff</code>.</p>\n\n<p>Please explain why this is the case.</p>\n"}, {"tags": ["c", "lua", "pthreads"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1435149819, "post_id": 31025946, "comment_id": 50078336, "body": "AFAIK Lua is not thread-safe - that is, each lua_State can only be used from one thread at a time."}], "answers": [{"comments": [{"owner": {"reputation": 25584, "user_id": 501459, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/29b9e5f5d700524e3a6eaef99de7d069?s=128&d=identicon&r=PG", "display_name": "Mud", "link": "https://stackoverflow.com/users/501459/mud"}, "edited": false, "score": 0, "creation_date": 1435180164, "post_id": 31026045, "comment_id": 50098284, "body": "That should be &quot;create a <code>should_exit</code> global function&quot;. He already has a global variable."}, {"owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "reply_to_user": {"reputation": 25584, "user_id": 501459, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/29b9e5f5d700524e3a6eaef99de7d069?s=128&d=identicon&r=PG", "display_name": "Mud", "link": "https://stackoverflow.com/users/501459/mud"}, "edited": false, "score": 0, "creation_date": 1435181038, "post_id": 31026045, "comment_id": 50098726, "body": "@Mud True, I had a for loop control variable in mind and not a global variable."}], "tags": [], "owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "is_accepted": false, "score": 5, "last_activity_date": 1435181204, "last_edit_date": 1435181204, "creation_date": 1435147484, "answer_id": 31026045, "question_id": 31025946, "link": "https://stackoverflow.com/questions/31025946/change-lua-variable-from-c/31026045#31026045", "title": "Change lua variable from C", "body": "<p>Interacting with a running lua state from a different thread is not necessarily safe so modifying the script's global variable may or may not be a useful idea depending on where you are planning to be making that change from the C side.</p>\n\n<p>If you wanted to do this you would simply need to use the lua C api to set the global variable of the appropriate name in the appropriate lua state.</p>\n\n<p>An alternate idea would be to create a <code>should_exit</code> global function which is called at the start or end of every loop and when it returns true causes the lua code to <code>break</code> or <code>return</code>. This function can then check anything it wants to on the C side in whatever thread-appropriate manner is desired.</p>\n"}, {"tags": [], "owner": {"reputation": 2792, "user_id": 3125367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/650027e104822e3cd1be56bb90fa5271?s=128&d=identicon&r=PG&f=1", "display_name": "user3125367", "link": "https://stackoverflow.com/users/3125367/user3125367"}, "is_accepted": false, "score": 1, "last_activity_date": 1435167268, "creation_date": 1435167268, "answer_id": 31033281, "question_id": 31025946, "link": "https://stackoverflow.com/questions/31025946/change-lua-variable-from-c/31033281#31033281", "title": "Change lua variable from C", "body": "<p>Why to have this loop in Lua? You may loop in c-thread instead, <code>lua_pcall</code>ing some entry-point function (e.g. <code>onEvent()</code>) on each iteration. </p>\n\n<p>If loop <em>has</em> to be in Lua script, for example in case of setup-loop-cleanup scheme, you may run script in coroutine and use <code>coroutine.yield()</code> as loop condition. Thread should <code>lua_resume()</code> with <code>true</code> value or exit depending on your c-side condition. (Or resume with <code>false</code> if Lua-side cleanup after the loop is preferred.)</p>\n\n<p>Anyway, Lua is not thread-safe and cannot be called simultaneously from more than one thread. </p>\n"}, {"comments": [{"owner": {"reputation": 3821, "user_id": 3677376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345ca06e9690f13ec2cde085a7ef6e57?s=128&d=identicon&r=PG&f=1", "display_name": "siffiejoe", "link": "https://stackoverflow.com/users/3677376/siffiejoe"}, "edited": false, "score": 0, "creation_date": 1435327390, "post_id": 31071705, "comment_id": 50168936, "body": "You don&#39;t need to use semaphores for that -- a global variable (in C) protected by a mutex will do as well."}, {"owner": {"reputation": 2792, "user_id": 3125367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/650027e104822e3cd1be56bb90fa5271?s=128&d=identicon&r=PG&f=1", "display_name": "user3125367", "link": "https://stackoverflow.com/users/3125367/user3125367"}, "reply_to_user": {"reputation": 3821, "user_id": 3677376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345ca06e9690f13ec2cde085a7ef6e57?s=128&d=identicon&r=PG&f=1", "display_name": "siffiejoe", "link": "https://stackoverflow.com/users/3677376/siffiejoe"}, "edited": false, "score": 0, "creation_date": 1435331758, "post_id": 31071705, "comment_id": 50171898, "body": "@siffiejoe As this is one-shot pollable boolean condition, it has not even to be protected by mutex. Declaring it volatile should be enough."}], "tags": [], "owner": {"reputation": 193, "user_id": 4374077, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/db72ffcf740c18a0137a775b314512f1?s=128&d=identicon&r=PG&f=1", "display_name": "bislinux", "link": "https://stackoverflow.com/users/4374077/bislinux"}, "is_accepted": false, "score": 0, "last_activity_date": 1435317034, "creation_date": 1435317034, "answer_id": 31071705, "question_id": 31025946, "link": "https://stackoverflow.com/questions/31025946/change-lua-variable-from-c/31071705#31071705", "title": "Change lua variable from C", "body": "<p>It took me two days to come up with this. Hopefully,it will help someone to save sometime.</p>\n\n<p>main.c</p>\n\n<pre><code>#include &lt;lua.h&gt;\n#include &lt;lauxlib.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;semaphore.h&gt;\n\nvoid *lua_thread(void *arg)\n {   \n    int status, result, i;\n    double sum;\n    lua_State *L=(lua_State *)arg;\n\n    int a=0;\n    status = luaL_dofile(L, \"lua_script.lua\");\n    if (status) {\n        fprintf(stderr, \"Couldn't load file: %s\\n\", lua_tostring(L, -1));\n        exit(1);\n    }\n\n    printf(\"Lua thread exiting\\n\");   \n    return 0;\n}\n\nint main(void)\n{\n    lua_State *L;\n    L = luaL_newstate();\n    luaL_openlibs(L);\n\n    //Open semaphore which will signal Lua loop to exit\n    sem_t *lex=sem_open(\"luaexitsem\", O_CREAT, 0600, 0);\n\n    //Make sure value of the semaphore is 0 before we start running\n    //so that sem_post sets it to 1 later\n      int retval;\n      for(retval=0;retval==0;) {\n          retval=sem_trywait(lex);\n          printf(\"Dec sem val: %d\\n\", retval);\n      }\n\n    //Start Lua thread\n    pthread_t p1;\n    pthread_create(&amp;p1,NULL,lua_thread,L);\n\n    sleep(5);\n\n    //Signal Lua script to exit\n    sem_post(lex);\n\n    //Wait for Lua thread to exit\n    pthread_join(p1,NULL);\n\n    //Cleanup\n    printf(\"Main exiting\\n\");\n    lua_close(L);\n    sem_close(lex);\n    return 0;\n}\n</code></pre>\n\n<p>To compile </p>\n\n<p>gcc -o main main.c -I/usr/include/lua5.1 -llua5.1 -lm -ldl -pthread</p>\n\n<p>lua_script.lua</p>\n\n<pre><code>    require \"lualinuxthread\"\n    a=1\n    while(not linuxthread.signaltoexit())\n    do\n      print(\"value of a:\", a)\n      a=a+1\n    end\n</code></pre>\n\n<p>lualinuxthread.c</p>\n\n<pre><code>#define LUA_LIB\n#include \"lua.h\"\n#include \"lauxlib.h\"\n#include &lt;semaphore.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;fcntl.h&gt;\n\nstatic int signaltoexit(lua_State *L) {\n\n  sem_t *lex=sem_open(\"luaexitsem\", O_CREAT, 0600, 0);\n\n  int exitvalue=0, retval;\n\n  if (lex!=SEM_FAILED)\n    retval=sem_trywait(lex);\n\n  if (retval==-1) exitvalue=0; else exitvalue=1;\n\n  printf(\"signaltoexit - exitvalue: %d, retval: %d,  %x\\n\", exitvalue, retval, lex);\n\n  lua_pushboolean(L, exitvalue);\n\n  sem_close(lex);\n  return 1;\n}\n\nstatic const luaL_Reg libfuncs[] = {\n{\"signaltoexit\",   signaltoexit},\n{NULL, NULL}\n};\n\nLUALIB_API int luaopen_lualinuxthread (lua_State *L) {\n\n  luaL_register(L, \"linuxthread\", libfuncs);\n  return 1;\n}\n</code></pre>\n\n<p>to compile:</p>\n\n<p>gcc -O -O2 -fpic -shared lualinuxthread.c -o lualinuxthread.so -lpthread -llua5.1</p>\n\n<p>Thank you </p>\n"}, {"tags": [], "owner": {"reputation": 2792, "user_id": 3125367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/650027e104822e3cd1be56bb90fa5271?s=128&d=identicon&r=PG&f=1", "display_name": "user3125367", "link": "https://stackoverflow.com/users/3125367/user3125367"}, "is_accepted": false, "score": 1, "last_activity_date": 1435337082, "creation_date": 1435337082, "answer_id": 31078236, "question_id": 31025946, "link": "https://stackoverflow.com/questions/31025946/change-lua-variable-from-c/31078236#31078236", "title": "Change lua variable from C", "body": "<p>Oh, you went hard way in your answer (sure that was a great exercise though). Things could be much simpler:</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\n#include &lt;lua.h&gt;\n#include &lt;lauxlib.h&gt;\n#include &lt;lualib.h&gt;\n\nstatic volatile int shouldRun = 1; // 1.\n\nstatic int\nfn_sleep(lua_State *L)\n{\n    lua_Integer n = luaL_checkinteger(L, 1);\n    sleep(n &lt; 0 ? 0 : n);\n    return 0;\n}\n\nstatic int\nfn_shouldRun(lua_State *L)\n{\n    lua_pushboolean(L, shouldRun);\n    return 1;\n}\n\nstatic void *\nthread_main(void *dummy)\n{\n    lua_State *L = luaL_newstate();\n    luaL_openlibs(L);\n\n    lua_register(L, \"sleep\", fn_sleep); // 2.\n    lua_register(L, \"shouldRun\", fn_shouldRun);\n\n    if (luaL_dofile(L, \"script.lua\")) {\n        fprintf(stderr, \"%s\\n\", lua_tostring(L, -1));\n        lua_pop(L, 1);\n    }\n\n    lua_close(L); // 3.\n    return 0;\n}\n\nint\nmain(int argc, char *argv[])\n{\n    pthread_t thread;\n    pthread_create(&amp;thread, NULL, thread_main, NULL);\n\n    sleep(5);\n    shouldRun = 0; // 1.\n\n    pthread_join(thread, NULL);\n    return 0;\n}\n</code></pre>\n\n<p>script.lua:</p>\n\n<pre><code>print(\"Hi!\")\n\nwhile shouldRun() do\n    print(\"Running!\")\n    sleep(1)\nend\n\nprint(\"Bye!\")\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Hi!\nRunning!\nRunning!\nRunning!\nRunning!\nRunning!\nBye!\n</code></pre>\n\n<p>Few things to note:</p>\n\n<ol>\n<li>Polled exit conditions usually do not need any protection. If shouldRun() was called simultaneously with variable update and missed it, then nothing to worry about \u2013 it will return false next time. Anyway, you can't even guess where the script is executing, just [re]set the value and wait for completion.</li>\n<li>For a pair of specific functions there is no need to write a require/preload-compatible module. Export them into global namespace instead.</li>\n<li>For graceful close on error do not just <code>exit()</code>. <code>lua_close()</code> will garbage-collect all userdata used by script, and their __gc metamethod may do something useful like flushing buffers to disk, etc. You lose all chances with hard exit.</li>\n</ol>\n"}], "owner": {"reputation": 193, "user_id": 4374077, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/db72ffcf740c18a0137a775b314512f1?s=128&d=identicon&r=PG&f=1", "display_name": "bislinux", "link": "https://stackoverflow.com/users/4374077/bislinux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 815, "favorite_count": 0, "answer_count": 4, "score": 5, "last_activity_date": 1438349074, "creation_date": 1435147202, "question_id": 31025946, "link": "https://stackoverflow.com/questions/31025946/change-lua-variable-from-c", "title": "Change lua variable from C", "body": "<p>I have a main program (in C) which needs to branch out into lua_thread(the main continues to run).This lua_thread calls a lua_script.lua. this lua_script contains a while loop. a lua variable controls this while loop.Currently this loop runs forever.</p>\n\n<p>lua_script.lua</p>\n\n<pre><code>  --this loop runs forever, as the exit value is not set yet\n  a=0\n    while(a&lt;=0)\n    do\n       print(\"value of a:\", a)\n    end\n</code></pre>\n\n<p>My goal is to change this lua variable(a) from main program such that it exits this infinite loop. Once this loop ends, it exits the thread and returns to the main program. </p>\n\n<p>main.c</p>\n\n<pre><code>#include &lt;lua.h&gt;\n#include &lt;lauxlib.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\nvoid *lua_thread()\n {\n    int status, result;\n    double sum;\n    lua_State *L;\n\n    L = luaL_newstate();\n    luaL_openlibs(L); \n\n    status = luaL_loadfile(L, \"lua_script.lua\");\n    if (status)\n    {\n        fprintf(stderr, \"Couldn't load file: %s\\n\", lua_tostring(L, -1));\n        exit(1);\n    }\n\nresult = lua_pcall(L, 0, 0, 0);\n    if (result) {\n        fprintf(stderr, \"Failed to run script: %s\\n\", lua_tostring(L, -1));\n        exit(1);\n    }\n\n    lua_close(L);   \n    return 0;\n}\n\nint main(void)\n{    \n    pthread_t p1;\n    pthread_create(&amp;p1,NULL,lua_thread,NULL);\n    pthread_join(p1,NULL);    \n    return 0;\n}\n</code></pre>\n\n<p>If you run the above code</p>\n\n<pre><code>cc -o xcute main.c  -I/usr/include/lua5.2 -llua -lm -ldl -pthread\n</code></pre>\n\n<p>it will go into an infinite loop. I want to somehow control the lua variable and change it to a=1,from the main program so that it comes out of the infinite loop. \nthe reason for doing such a test is that it will make sure that before the main program exits, this thread exits first by controlling the lua variable.\nPlease suggest how to change this lua variable so that it exits the while loop. </p>\n"}, {"tags": ["c", "string", "pointers", "struct", "char"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1435147200, "post_id": 31025883, "comment_id": 50076513, "body": "Just <code>real.at.str = &quot;Hello&quot;;</code> if it is C."}], "answers": [{"comments": [{"owner": {"reputation": 96886, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1435147117, "post_id": 31025899, "comment_id": 50076445, "body": "This is <a href=\"https://stackoverflow.com/questions/6492410/assigning-string-literals-to-char\">not valid in C++</a> because the literal is a <code>const char*</code>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 96886, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 1, "creation_date": 1435147167, "post_id": 31025899, "comment_id": 50076487, "body": "@CoryKramer It is valid In <code>C</code>. and I thought <code>typedef</code> is invalid (usage) <code>C++</code> style. I see this code as more of <code>C</code>."}, {"owner": {"reputation": 96886, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 0, "creation_date": 1435147252, "post_id": 31025899, "comment_id": 50076558, "body": "Fair enough, I have redacted my -1, I just wanted to be clear about that since the OP tagged C++. I removed their C++ tag to avoid confusion in the future if anyone else sees this post."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 96886, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "edited": false, "score": 1, "creation_date": 1435147537, "post_id": 31025899, "comment_id": 50076752, "body": "@CoryKramer You are very true, Most of the people believe <code>C</code> and <code>C++</code> are interchangeable and by changing <code>printf()</code> to <code>cout&lt;&lt;</code>, a <code>C</code> code becomes <code>C++</code> (don&#39;t laugh, I personally know such peoples.)"}, {"owner": {"reputation": 740, "user_id": 2873468, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/de9bfd11447c2d43928792389ec506ed?s=128&d=identicon&r=PG&f=1", "display_name": "adnaan.zohran", "link": "https://stackoverflow.com/users/2873468/adnaan-zohran"}, "edited": false, "score": 0, "creation_date": 1435148583, "post_id": 31025899, "comment_id": 50077417, "body": "I am just playing and learning!! can you please tell me if I want to create an array of strings in up structure. How could I allocate memory for rows?"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 2, "last_activity_date": 1435147947, "last_edit_date": 1435147947, "creation_date": 1435147051, "answer_id": 31025899, "question_id": 31025883, "link": "https://stackoverflow.com/questions/31025883/how-to-access-pointer-within-a-nested-structure/31025899#31025899", "title": "How to access pointer within a nested structure", "body": "<p>Assuming your <code>typedef</code> goes like below</p>\n\n<pre><code>typedef struct up_cont{\n    up at;\n}up_cont;\n</code></pre>\n\n<p>(more of a typo for above snippet I believe)</p>\n\n<hr>\n\n<p>The answer to your problem is, <code>str</code> is a pointer itself. Just use</p>\n\n<pre><code> real.at.str = \"Hello\";\n</code></pre>\n\n<hr>\n\n<p>EDIT:</p>\n\n<blockquote>\n  <p><em>And please also suggest how to print it!!</em></p>\n</blockquote>\n\n<p>Just the normal way you print any other <em>string</em>. Use</p>\n\n<pre><code> printf(\"str contains %s\\n\", real.at.str);\n</code></pre>\n\n<p>You can read more about <code>printf()</code> <a href=\"http://linux.die.net/man/3/printf\" rel=\"nofollow\">here</a></p>\n\n<hr>\n\n<p>FOOTNOTE:</p>\n\n<p><sup>FWIW, if you use assign a string literal to a pointer, it will be read-only, you cannot alter the contents. If you want a modifiable <em>string</em>, you need to</sup><br>\n<sup>1. Allocate memory dynamically using <a href=\"http://linux.die.net/man/3/malloc\" rel=\"nofollow\"><code>malloc()</code></a> or family</sup><br>\n<sup>2. Copy the <em>string literal</em> using  <a href=\"http://linux.die.net/man/3/strcpy\" rel=\"nofollow\"><code>strcpy()</code></a> to the allocated memory</sup></p>\n"}, {"comments": [{"owner": {"reputation": 740, "user_id": 2873468, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/de9bfd11447c2d43928792389ec506ed?s=128&d=identicon&r=PG&f=1", "display_name": "adnaan.zohran", "link": "https://stackoverflow.com/users/2873468/adnaan-zohran"}, "edited": false, "score": 0, "creation_date": 1435147318, "post_id": 31025950, "comment_id": 50076603, "body": "yeah thnx my mistake!!"}], "tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": false, "score": 0, "last_activity_date": 1435147332, "last_edit_date": 1435147332, "creation_date": 1435147223, "answer_id": 31025950, "question_id": 31025883, "link": "https://stackoverflow.com/questions/31025883/how-to-access-pointer-within-a-nested-structure/31025950#31025950", "title": "How to access pointer within a nested structure", "body": "<pre><code>typedef struct up_cont{\n    up at;\n};\n</code></pre>\n\n<p>In C you are not typedefing anything here.\nYou meant:</p>\n\n<pre><code>typedef struct up_cont{\n    up at;\n} up_cont;\n</code></pre>\n\n<p>Then access it like:</p>\n\n<pre><code>up_cont *p = /* ... */;\np-&gt;at.str = \"hello\";\n</code></pre>\n\n<p>As some other mentioned, in C++, you need a <code>const char *</code> member in your structure to have a pointer to a string literal (<code>char *</code> is OK in C).</p>\n"}, {"tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1435147654, "creation_date": 1435147654, "answer_id": 31026105, "question_id": 31025883, "link": "https://stackoverflow.com/questions/31025883/how-to-access-pointer-within-a-nested-structure/31026105#31026105", "title": "How to access pointer within a nested structure", "body": "<p>The syntax to access the nested struct members is as you have it:  <code>real.at.str</code>.</p>\n\n<p>What is invalid is that you are dereferencing <code>real.at.str</code>.  The assignment</p>\n\n<pre><code>  real.at.str = \"Hello\";\n</code></pre>\n\n<p>will work, by assigning the left hand side to be the address of the first character in the string literal.</p>\n\n<p>Bear in mind that modifying the string gives undefined behaviour</p>\n\n<pre><code>  real.at.str[0] = 'B';\n</code></pre>\n\n<p>since it attempts to overwrite the first character of the string literal <code>\"Hello\"</code> (which is actually a compile time constant) with the character <code>'B'</code>.</p>\n"}], "owner": {"reputation": 740, "user_id": 2873468, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/de9bfd11447c2d43928792389ec506ed?s=128&d=identicon&r=PG&f=1", "display_name": "adnaan.zohran", "link": "https://stackoverflow.com/users/2873468/adnaan-zohran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 31025899, "answer_count": 3, "score": -1, "last_activity_date": 1435147947, "creation_date": 1435146992, "last_edit_date": 1435147739, "question_id": 31025883, "link": "https://stackoverflow.com/questions/31025883/how-to-access-pointer-within-a-nested-structure", "title": "How to access pointer within a nested structure", "body": "<p>suppose I have a code like this in C programming language</p>\n\n<pre><code>typedef struct up {\n    char *str;\n} up;\n\ntypedef struct up_cont{\n    up at;\n}up_cont;\n</code></pre>\n\n<p>I have defined <code>up_cont real;</code>. I have done all allocation and all!</p>\n\n<p>Now I want to store <code>\"Hello\"</code> in string. I am trying</p>\n\n<pre><code> up_cont real;\n*(real.at.str) = \"Hello\";\n</code></pre>\n\n<p>and its not working!!</p>\n\n<p>And please also suggest how to print it!!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1435145722, "post_id": 31025400, "comment_id": 50075509, "body": "If you fail to open the file, should you really continue with the program?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1435146154, "post_id": 31025400, "comment_id": 50075791, "body": "@BLUEPIXY A link is there, at the end of the Q, though I did not click it :-)"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1435147165, "post_id": 31025400, "comment_id": 50076482, "body": "number of data  is less than 6000. So must check return value of <code>fgetc</code>  with <code>EOF</code>."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1435147299, "post_id": 31025400, "comment_id": 50076595, "body": "When you try to strip the quotation marks, you skip the comma after the closing quotation mark. You must rework your loop logic to check for a comma after a quotation mark."}, {"owner": {"reputation": 3, "user_id": 5044334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb81887931cbcc3479511b3768778121?s=128&d=identicon&r=PG&f=1", "display_name": "theBon3096", "link": "https://stackoverflow.com/users/5044334/thebon3096"}, "edited": false, "score": 0, "creation_date": 1435147357, "post_id": 31025400, "comment_id": 50076628, "body": "Thanx everyone, i figured out the problem..."}, {"owner": {"reputation": 3, "user_id": 5044334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb81887931cbcc3479511b3768778121?s=128&d=identicon&r=PG&f=1", "display_name": "theBon3096", "link": "https://stackoverflow.com/users/5044334/thebon3096"}, "edited": false, "score": 0, "creation_date": 1435147597, "post_id": 31025400, "comment_id": 50076781, "body": "@M Oehm.. You were correct. That was the problem.. And everything is fine now.."}], "answers": [{"tags": [], "owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "is_accepted": false, "score": 5, "last_activity_date": 1435145968, "last_edit_date": 1495541162, "creation_date": 1435145594, "answer_id": 31025435, "question_id": 31025400, "link": "https://stackoverflow.com/questions/31025400/why-does-the-program-crashes-after-printing-all-the-names-from-the-txt-file/31025435#31025435", "title": "Why does the program crashes after printing all the names from the txt file?", "body": "<p>You have a typo. This:</p>\n\n<pre><code>for(i=0;c&lt;6000;i++)\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>for(i = 0;i &lt; 6000; i++)\n</code></pre>\n\n<p>and <code>c</code> should be an <code>int</code> as <code>fgetc</code> returns an <code>int</code>, not a <code>char</code>.</p>\n\n<p>Another problem is that there is no comma after the last name. So</p>\n\n<pre><code>for(j=0;c!=',';j++)\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>for(j = 0; c != ',' &amp;&amp; c != EOF; j++)\n</code></pre>\n\n<p>Three other problems are explained in <a href=\"https://stackoverflow.com/users/2173917/sourav-ghosh\">@SouravGhosh</a>'s <a href=\"https://stackoverflow.com/a/31025458/3049655\">answer</a></p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5044334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb81887931cbcc3479511b3768778121?s=128&d=identicon&r=PG&f=1", "display_name": "theBon3096", "link": "https://stackoverflow.com/users/5044334/thebon3096"}, "edited": false, "score": 0, "creation_date": 1435145823, "post_id": 31025458, "comment_id": 50075582, "body": "It was my mistake while coping the code here.. Its i&lt;6000 in here.. But yet it crashes"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 3, "user_id": 5044334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb81887931cbcc3479511b3768778121?s=128&d=identicon&r=PG&f=1", "display_name": "theBon3096", "link": "https://stackoverflow.com/users/5044334/thebon3096"}, "edited": false, "score": 0, "creation_date": 1435146116, "post_id": 31025458, "comment_id": 50075762, "body": "@BoneyHaveliwala Check updated answer. :-)"}, {"owner": {"reputation": 3, "user_id": 5044334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb81887931cbcc3479511b3768778121?s=128&d=identicon&r=PG&f=1", "display_name": "theBon3096", "link": "https://stackoverflow.com/users/5044334/thebon3096"}, "edited": false, "score": 0, "creation_date": 1435146289, "post_id": 31025458, "comment_id": 50075874, "body": "After changing data type of c from char  to int, the code is working fine but when i enable that portion commented portion then program crashes again.."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 3, "user_id": 5044334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb81887931cbcc3479511b3768778121?s=128&d=identicon&r=PG&f=1", "display_name": "theBon3096", "link": "https://stackoverflow.com/users/5044334/thebon3096"}, "edited": false, "score": 0, "creation_date": 1435146387, "post_id": 31025458, "comment_id": 50075941, "body": "@BoneyHaveliwala do you really have <code>if(c==&#39; &quot; &#39;)</code> or it&#39;s a typo? That should be <code>if(c==&#39;&quot;&#39;)</code>, is at all."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1435146282, "last_edit_date": 1495542597, "creation_date": 1435145678, "answer_id": 31025458, "question_id": 31025400, "link": "https://stackoverflow.com/questions/31025400/why-does-the-program-crashes-after-printing-all-the-names-from-the-txt-file/31025458#31025458", "title": "Why does the program crashes after printing all the names from the txt file?", "body": "<p>Apart from the points mentioned in Mr. <a href=\"https://stackoverflow.com/users/3049655/cool-guy\">CoolGuy's</a> above <a href=\"https://stackoverflow.com/a/31025435/2173917\">answer</a>,  I would like to point out some more cases, like</p>\n\n<ol>\n<li><p>In your second <code>for</code> loop, <code>c&lt;6000</code> should read <code>i &lt; 6000</code>, otherwise, it's a potential infinite loop.</p></li>\n<li><p>In case <code>fopen()</code> fails, you should discontinue your program (atleast, avoid using the returned file pointer), otherwise, if you continue normally, there is essentially no meaning of the NULL check.</p></li>\n<li><p>Always check for the success of <code>malloc()</code> before using the returned pointer. Also, <code>sizeof(char)</code> is guranteed to produce <code>1</code> in C, no need to multiply the size with <code>sizeof(char)</code>, it's redundant.</p></li>\n<li><p>In your inner loop, <code>for(j=0;c!=',';j++)</code> you should limit the maximum value of <code>j</code> to 19, as you're allocating memory for a fixed size of <code>20</code>.</p></li>\n</ol>\n"}], "owner": {"reputation": 3, "user_id": 5044334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb81887931cbcc3479511b3768778121?s=128&d=identicon&r=PG&f=1", "display_name": "theBon3096", "link": "https://stackoverflow.com/users/5044334/thebon3096"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1435146293, "answer_count": 2, "score": -1, "last_activity_date": 1435146282, "creation_date": 1435145493, "last_edit_date": 1435145866, "question_id": 31025400, "link": "https://stackoverflow.com/questions/31025400/why-does-the-program-crashes-after-printing-all-the-names-from-the-txt-file", "closed_reason": "Not suitable for this site", "title": "Why does the program crashes after printing all the names from the txt file?", "body": "<p>Here is the code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nint main()\n{\n    FILE *fptr;\n    if((fptr=fopen(\"names.txt\",\"r\"))==NULL)\n    {\n        printf(\"Error\");\n    }\n\n    int i,j;\n    char *nptr[6000],c;\n\n        for(i=0;i&lt;6000;i++)\n    {\n        nptr[i]=malloc(sizeof(char)*20);\n        }\n\n    for(i=0;i&lt;6000;i++)\n    {\n        c=fgetc(fptr);\n        for(j=0;c!=',';j++)\n        {\n            /*if(c==' \" ')\n            {\n                c=fgetc(fptr);\n            }*/\n            nptr[i][j]=c;\n            c=fgetc(fptr);  \n        }\n        nptr[i][j]='\\0';\n        puts(nptr[i]);\n    }\n\n        for(i=0;i&lt;6000;i++)\n        {\n            free(nptr[i]);\n        }\n\n    fclose(fptr);\n    return 0;\n\n}\n</code></pre>\n\n<p>And if i want to print the names without quotation marks, i wrote the code which u can see i have commented it for a while because it doesnot let the name to be printed.. If its disabled then program crashes after printing the names, else it crashes in begining..</p>\n\n<p><a href=\"https://projecteuler.net/project/resources/p022_names.txt\" rel=\"nofollow\">Link to the txt file</a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 8, "creation_date": 1435144581, "post_id": 31025065, "comment_id": 50074762, "body": "Welcome to Stack Overflow! Please take the <a href=\"http://stackoverflow.com/tour\">tour</a> and read <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a> to learn what we expect from questions here. Please be aware that we do not provide <i>from-scratch</i> coding service here. Please show us what you&#39;ve tried already, how it failed and we might be able to help.:-)"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1435144733, "post_id": 31025065, "comment_id": 50074850, "body": "<code>int n;scanf(&quot;%d&quot;, &amp;n);printf(&quot;%*s&quot;, n, &quot;&quot;);</code>"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1435144747, "post_id": 31025065, "comment_id": 50074861, "body": "1) Get input 2) Use a loop to print spaces There isn&#39;t any need for conversions here."}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1435144722, "creation_date": 1435144722, "answer_id": 31025126, "question_id": 31025065, "link": "https://stackoverflow.com/questions/31025065/converting-an-int-to-blank-spaces-in-c/31025126#31025126", "title": "converting an int to blank spaces in C", "body": "<p>You had to read about the <a href=\"http://man7.org/linux/man-pages/man3/printf.3.html\" rel=\"nofollow\"><code>printf()</code></a> function</p>\n\n<pre><code>int x;\nif (scanf(\"%d\", &amp;x) == 1)\n    printf(\"%*s/ &lt;--- there are %d white spaces behind\\n\", x, \"\", x);\nelse\n    printf(\"wrong input, an integer expected\\n\");\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5044297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c2dccb2c8732adab5a5ed3295780e5?s=128&d=identicon&r=PG&f=1", "display_name": "grant", "link": "https://stackoverflow.com/users/5044297/grant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1435144722, "creation_date": 1435144556, "question_id": 31025065, "link": "https://stackoverflow.com/questions/31025065/converting-an-int-to-blank-spaces-in-c", "title": "converting an int to blank spaces in C", "body": "<p>I'm trying to convert a user input integer into blank spaces. For example, when int = 3, there will be 3 blank spaces as the output. I will need to convert the numbers 0-15 to 0-15 blank spaces. I am new to programming so any help is greatly appreciated!</p>\n"}, {"tags": ["c", "linux", "gtk", "xlib"], "comments": [{"owner": {"reputation": 2556, "user_id": 3488231, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/da4ac79b71c44d696f3567d4b53f6239?s=128&d=identicon&r=PG&f=1", "display_name": "user12205", "link": "https://stackoverflow.com/users/3488231/user12205"}, "edited": false, "score": 0, "creation_date": 1435143641, "post_id": 31024663, "comment_id": 50074122, "body": "<code>temp[1]=&#39;\\0&#39;</code> is undefined behaviour. <code>temp</code> has only one cell, <code>temp[0]</code>. You have out-of-bounds access."}, {"owner": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "reply_to_user": {"reputation": 2556, "user_id": 3488231, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/da4ac79b71c44d696f3567d4b53f6239?s=128&d=identicon&r=PG&f=1", "display_name": "user12205", "link": "https://stackoverflow.com/users/3488231/user12205"}, "edited": false, "score": 0, "creation_date": 1435144869, "post_id": 31024663, "comment_id": 50074950, "body": "I&#39;ve increased the array size to 2, still getting the same result :("}], "answers": [{"comments": [{"owner": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "reply_to_user": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "edited": false, "score": 0, "creation_date": 1435149007, "post_id": 31024819, "comment_id": 50077770, "body": "Okay, 2 points - 1. why are you calling XTestFakeKeyEvent three times? It should send the keycode right after XFlush. 2. Can you print the modcode generated by XKeysymToKeycode for the white spaces?"}, {"owner": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "edited": false, "score": 0, "creation_date": 1435160384, "post_id": 31024819, "comment_id": 50086491, "body": "You are right I definitely did not need all those flushes, and I was able to remove one Xtestfake..., I need 2 however, one for  a key press and the other for the key release  otherwise, strings are not printed correctly  How can i print the modecode?"}, {"owner": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "reply_to_user": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "edited": false, "score": 1, "creation_date": 1435161527, "post_id": 31024819, "comment_id": 50087316, "body": "Well, a keycode is just a number between 8-255 as far as I can recall. Try using straight printf. If that doesn&#39;t work, look into the definition of KeyCode and comment here with the fields"}, {"owner": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "edited": false, "score": 0, "creation_date": 1435162338, "post_id": 31024819, "comment_id": 50087876, "body": "ok here&#39;s what I got: 43 26 46 46 32 204 25 32 27 46 40 204 h   e   l     l    o    &#39; &#39;    w  o   r    l    d  the terminator and whitespace have the same value, is that normal?"}, {"owner": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "edited": false, "score": 0, "creation_date": 1435167998, "post_id": 31024819, "comment_id": 50091459, "body": "I also tried some special chars like ! and % and I get 204 where these characters should be"}, {"owner": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "reply_to_user": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "edited": false, "score": 0, "creation_date": 1435184048, "post_id": 31024819, "comment_id": 50100039, "body": "That&#39;s odd, and probably the reason you don&#39;t see space. Try using tab instead and postthe keycodes again"}, {"owner": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "edited": false, "score": 0, "creation_date": 1435191788, "post_id": 31024819, "comment_id": 50102275, "body": "tried tab as part of the string and \\t, both yied 204"}, {"owner": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "reply_to_user": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "edited": false, "score": 0, "creation_date": 1435217257, "post_id": 31024819, "comment_id": 50110224, "body": "Okay, I looked up the 204 keycode (<a href=\"http://www.cl.cam.ac.uk/~mgk25/ucs/keysymdef.h\" rel=\"nofollow noreferrer\">cl.cam.ac.uk/~mgk25/ucs/keysymdef.h</a>) and it seems it isn&#39;t a terminator after all, but IGrave. It&#39;s very odd that XStringToKeysym returns this value for space, but you can fix it - test for a space, and if found, use XK_KP_Space as the keycode. I will update my answer accordingly"}, {"owner": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "edited": false, "score": 0, "creation_date": 1435226729, "post_id": 31024819, "comment_id": 50116089, "body": "that sounds reasonable, but what about the other special characters? :("}, {"owner": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "reply_to_user": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "edited": false, "score": 0, "creation_date": 1435231617, "post_id": 31024819, "comment_id": 50119229, "body": "I don&#39;t have the X11 code, but if you do and you want a general solution, you can check the translation function XKeysymToKeycode to understand why you get these strange translations. One last thing - are you using an English keyboard and locale?"}, {"owner": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "edited": false, "score": 0, "creation_date": 1435234368, "post_id": 31024819, "comment_id": 50120970, "body": "english keyboard yes, locale: adel@b5400 ~ $ locale -a C en_US.utf8 POSIX  I&#39;ll check out the function try to figure things out"}, {"owner": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "edited": false, "score": 0, "creation_date": 1435262500, "post_id": 31024819, "comment_id": 50140152, "body": "tried creating my own converting function: KeyCode keysymtokeycode(char key) { switch(key) { case &#39;a&#39;: return 0x0061; break; default:  return 0xff80; break; } } not yielding the results I was looking for, I got the values from keysymdef.h"}], "tags": [], "owner": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "is_accepted": false, "score": 0, "last_activity_date": 1435217350, "last_edit_date": 1435217350, "creation_date": 1435143747, "answer_id": 31024819, "question_id": 31024663, "link": "https://stackoverflow.com/questions/31024663/al-sending-fake-keyboard-events-whitespace-issues/31024819#31024819", "title": "al sending fake keyboard events, whitespace issues", "body": "<pre><code>Display *dis;\n        dis = XOpenDisplay(NULL);\n        KeyCode modcode = 0; //init value\n        int i;\n        char hello[]=\"hello world\";\n        char temp[2]; //Size is 2!!!\n        int size=sizeof(hello);\n        sleep(2);\n        for (i=0;i&lt;size;i++)\n        {\n                temp[0]=hello[i];\n                temp[1]='\\0';     //string terminator\n                g_print(\"%s\\n\",temp);  //works fine, whitespace is printed\n                if (temp[0] == ' ')\n                    modcode = XK_KP_Space\n                else\n                    modcode = XKeysymToKeycode(dis, XStringToKeysym(temp));\n                XTestFakeKeyEvent(dis, modcode, False, 0);\n                XFlush(dis);\n        //      sleep(1);\n                XTestFakeKeyEvent(dis, modcode, True, 0);\n                XFlush(dis);\n                XTestFakeKeyEvent(dis, modcode, False, 0);\n                XFlush(dis);\n}\n</code></pre>\n\n<p>You're storing 2 values into a single value array. Change temp[1] to temp[2] (as in the example).</p>\n"}, {"tags": [], "owner": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "is_accepted": true, "score": 0, "last_activity_date": 1435403413, "creation_date": 1435403413, "answer_id": 31088081, "question_id": 31024663, "link": "https://stackoverflow.com/questions/31024663/al-sending-fake-keyboard-events-whitespace-issues/31088081#31088081", "title": "al sending fake keyboard events, whitespace issues", "body": "<p>I just created my own translation function as you had suggested:</p>\n\n<pre><code>switch (hello[i])\n{\ncase ' ':\nXTestFakeKeyEvent(dis, 65, True, 0);\nXTestFakeKeyEvent(dis, 65, False, 0);\n</code></pre>\n\n<p>as for capital letters, I used a shift key with the regular key:</p>\n\n<pre><code>case 'T':\nXTestFakeKeyEvent(dis, 50, True, 0);\nXTestFakeKeyEvent(dis, 28, True, 0);\nXTestFakeKeyEvent(dis, 28, False, 0);\nXTestFakeKeyEvent(dis, 50, False, 0);\nbreak;\n</code></pre>\n\n<p>and special characters:</p>\n\n<pre><code>case '\\n':\nXTestFakeKeyEvent(dis, 36, True, 0);\nXTestFakeKeyEvent(dis, 36, False, 0);\nbreak;\n</code></pre>\n\n<p>things are working fine now, thanks Ishay</p>\n"}], "owner": {"reputation": 518, "user_id": 1218232, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d509b66be4756399ec2b91fbeff65248?s=128&d=identicon&r=PG", "display_name": "Adel Ahmed", "link": "https://stackoverflow.com/users/1218232/adel-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 31088081, "answer_count": 2, "score": 0, "last_activity_date": 1435403413, "creation_date": 1435143260, "last_edit_date": 1435148210, "question_id": 31024663, "link": "https://stackoverflow.com/questions/31024663/al-sending-fake-keyboard-events-whitespace-issues", "title": "al sending fake keyboard events, whitespace issues", "body": "<p>I'm creating a program using gtk and xlib(xtst) to send fake keypresses to an application, I have created this loop to send the keypresses to the active window:</p>\n\n<pre><code>Display *dis;\n        dis = XOpenDisplay(NULL);\n        KeyCode modcode = 0; //init value\n        int i;\n        char hello[]=\"hello world\";\n        char temp[1];\n        int size=sizeof(hello);\n        sleep(2);\n        for (i=0;i&lt;size;i++)\n        {\n                temp[0]=hello[i];\n                temp[1]='\\0';     //string terminator\n                g_print(\"%s\\n\",temp);  //works fine, whitespace is printed\n                modcode = XKeysymToKeycode(dis, XStringToKeysym(temp));\n                XTestFakeKeyEvent(dis, modcode, False, 0);\n                XFlush(dis);\n        //      sleep(1);\n                XTestFakeKeyEvent(dis, modcode, True, 0);\n                XFlush(dis);\n                XTestFakeKeyEvent(dis, modcode, False, 0);\n                XFlush(dis);\n}\n</code></pre>\n\n<p>problem is it prints 'helloworld' instead, it is incapable of dealing with whitespace or any special characters</p>\n\n<p>thanks</p>\n"}, {"tags": ["python", "c", "avr", "pyserial", "atmel"], "comments": [{"owner": {"reputation": 173, "user_id": 4999000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d53b0dc431083e8643890b5c6c9b0230?s=128&d=identicon&r=PG&f=1", "display_name": "lkamp", "link": "https://stackoverflow.com/users/4999000/lkamp"}, "edited": false, "score": 1, "creation_date": 1435140382, "post_id": 31023449, "comment_id": 50071984, "body": "Are you sure the microcontroller uses the same baudrate as your computer?"}, {"owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "reply_to_user": {"reputation": 173, "user_id": 4999000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d53b0dc431083e8643890b5c6c9b0230?s=128&d=identicon&r=PG&f=1", "display_name": "lkamp", "link": "https://stackoverflow.com/users/4999000/lkamp"}, "edited": false, "score": 0, "creation_date": 1435144157, "post_id": 31023449, "comment_id": 50074465, "body": "Yes, and if i receive data from miccroocontroller it works"}, {"owner": {"reputation": 2013, "user_id": 1432925, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/01292bdb40a38e200af106fec93b1e20?s=128&d=identicon&r=PG&f=1", "display_name": "vlk", "link": "https://stackoverflow.com/users/1432925/vlk"}, "edited": false, "score": 0, "creation_date": 1435592206, "post_id": 31023449, "comment_id": 50252624, "body": "First be sure that python script is working. disconnect AVR and reconnect TX and RX on output from PC. then try transmit from this script and listen what you transmitting."}, {"owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "edited": false, "score": 0, "creation_date": 1435680700, "post_id": 31023449, "comment_id": 50297170, "body": "Ahh sorry i already solved it"}], "owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1435150413, "creation_date": 1435139809, "last_edit_date": 1435150413, "question_id": 31023449, "link": "https://stackoverflow.com/questions/31023449/pyserial-datasend-doesnt-receive-data", "title": "PySerial dataSend doesn&#39;t receive data", "body": "<p>I want to make a connection between python script and atxmega128a3u avr microcontroller.</p>\n\n<p>Python script:</p>\n\n<pre><code>#!/usr/bin/python3\n\nfrom termcolor import colored\nimport sys\nimport serial\nimport struct\n\nclass usbComm:\n    'USB Communication Class'\n    def __init__(self, Port):\n        'Try to open the port and initialize the object'\n        try:\n            self.PortObj = serial.Serial(Port, 9600, timeout=1)\n        except OSError as e:\n            print(colored(\"ERROR: Failed to open {0}\\nERROR: {1}\".format(Port, str(e)), \"red\"))\n            exit(1)\n        print(colored(\"Connected to \" + self.PortObj.name, \"green\"))\n\n    def SendData(self, Data):\n        'Send raw data to 3D Printer'\n        'Returns total number of bytes written'\n        return self.PortObj.write(Data)\n\n    def ReadData(self, count):\n        return self.PortObj.read(count)\n\n    def __del__(self):\n        try:\n            self.PortObj.close()\n            print(colored(\"Closed\", \"green\"))\n        except AttributeError as e:\n            print(colored(\"ERROR: \" + str(e), \"red\"))\n\ndef main():\n    print(colored(\"+-----------------------------------+\", \"blue\"))\n    print(colored(\"| 3D Printer USB Communication Tool |\", \"blue\"))\n    print(colored(\"+-----------------------------------+\", \"blue\"))\n\n    if len(sys.argv) != 3:\n        print(colored(\"ERROR: Invalid number of arguments.\", \"red\"))\n        print(\"Usage: main.py &lt;PORT&gt; &lt;DATA&gt;\")\n        exit(1)\n\n    usbCommObj = usbComm(sys.argv[1])\n    print(usbCommObj.SendData(b\"\\x7e\"))\n    print(usbCommObj.ReadData(1))\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>\n\n<p>So i should receive \"~\" But the output is:</p>\n\n<p>Connected to /dev/ttyACM10\n1\nb'\\xff'\nClosed</p>\n\n<p>At my microcontroller i have the code:</p>\n\n<pre><code>    while(1){\n        // char s[7] = \"\";\n        // for(int i = 0; i&lt; 7; i++){\n        //    s[i] = fgetc(USBtty0);\n        // }\n        // for(int i = 0; i&lt; 7; i++){\n        //    fputc(s[i], USBtty0);\n        // }\n        int c = fgetc(USBtty0);\n        //c=0x7e;\n        if (c==0x7e)PORTB.OUT |= PIN1_bm;\n        fputc(c, USBtty0);\n        // switch(c) {\n        //     case 0:{\n        //         fputc(c, USBtty0);\n        //         break;\n        //     }\n        //     case 1:{\n        //         //if(motor(10000,0,0)==1)\n        //         fputc(c, USBtty0);\n        //         break;\n        //     }\n        // }\n        if(!(PORTB.IN &amp; PIN6_bm))\n            PORTB.OUT |= PIN1_bm;\n        else\n            PORTB.OUT &amp;= ~PIN1_bm;\n        USBPoll();\n    }\n</code></pre>\n\n<p>Some time ago i could get an working connection, what did I wrong?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "edited": false, "score": 1, "creation_date": 1435140533, "post_id": 31023392, "comment_id": 50072085, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/3813138/void-or-char-for-generic-buffer-representation\">void* or char* for generic buffer representation?</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1435152322, "post_id": 31023392, "comment_id": 50080197, "body": "Clarification: <code>leveldb_put()</code> does not take &quot;arbitrary data&quot;, but a pointer to &quot;arbitrary data&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "is_accepted": true, "score": 4, "last_activity_date": 1435141444, "last_edit_date": 1435141444, "creation_date": 1435140252, "answer_id": 31023633, "question_id": 31023392, "link": "https://stackoverflow.com/questions/31023392/function-that-takes-arbitrary-data-use-void-or-char/31023633#31023633", "title": "Function that takes arbitrary data: Use void* or char*?", "body": "<blockquote>\n  <p>Is there a reason not to use void* to pass arbitrary data to a\n  function?</p>\n</blockquote>\n\n<p>No. In fact, <code>void *</code> <em>exists</em> to facilitate passing arbitrary data <em>without the need for ugly casting</em>. That's why ptr-to-void was standardized. In C at least. C++ is a different beast.</p>\n\n<p>At LevelDB they have to deal with historical code born with <code>char *</code> , or pre C89 compilers, or any other veiled reason causing refactoring-inertia. Their code would work with ptrs-to-void just as well.</p>\n\n<p>Note that in your version of <code>db_put</code> the casts should be removed as they are redundant.</p>\n"}, {"comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1435143929, "post_id": 31023698, "comment_id": 50074305, "body": "you can cast <i>any</i> pointer type to any other pointer type: 6.3.2.3 Pointers: <i>&quot;A pointer to void may be converted to or from a pointer to any object type. A pointer to any object type may be converted to a pointer to void and back again; the result shall compare equal to the original pointer.&quot;</i> meaning you can cast any pointer to <code>void *</code>, and because <code>void *</code>, which can be cast again to any ptr type. Pointer arithmetic is indeed not legal, and so is dereferencing a <code>void *</code>. IMO, the latter is why <code>void *</code> and <code>char *</code> are not funcitonally equivalent at all"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1435144190, "post_id": 31023698, "comment_id": 50074487, "body": "@EliasVanOotegem There&#39;s something wrong with what you&#39;re saying: A <i>function pointer</i> isn&#39;t a <i>pointer to any object type</i>. Hence, your suggestion that <i>any</i> pointer type can be cast to <i>any other</i> pointer type doesn&#39;t necessarily work when either the <i>source</i> or <i>target</i> type of the conversion is a function pointer."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1435144423, "post_id": 31023698, "comment_id": 50074642, "body": "@EliasVanOotegem What is the title of the section &quot;J.5&quot;?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 2, "creation_date": 1435144784, "post_id": 31023698, "comment_id": 50074886, "body": "@undefinedbehaviour: <i>&quot;J.5 Common extensions&quot;</i> aw snap... that&#39;s what you get for wanting to be too clever. You&#39;re right, I&#39;ll remove the comment, perhaps add the same info a second time, this time specifying casting <code>void *</code> to function pointers is not portable"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1435144969, "post_id": 31023698, "comment_id": 50075012, "body": "<i>errata</i>: object pointers can be cast from and to <code>void *</code> safely. However, this is not guaranteed to be the case for function pointers, being able to cast object pointers to function pointers is listed in the standard as a common extension, but relying on it may cause portability issues (reference J.5.7 Function pointer casts, under J.5 Common extensions)"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1435145358, "post_id": 31023698, "comment_id": 50075247, "body": "@EliasVanOotegem You might be interested in 6.3.2.3p5: &quot;An integer may be converted to any pointer type. Except as previously specified, the result is implementation-defined, might not be correctly aligned, might not point to an entity of the referenced type, and might be a trap representation&quot; and its corresponding p6: &quot;Any pointer type may be converted to an integer type. Except as previously specified, the result is implementation-defined. If the result cannot be represented in the integer type, the behavior is undefined. The result need not be in the range of values of any integer type.&quot;"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1435201264, "post_id": 31023698, "comment_id": 50104356, "body": "@EliasVanOotegem Perhaps the best guarantee is <a href=\"http://www.iso-9899.info/n1570.html#6.3.2.3p8\" rel=\"nofollow noreferrer\">#6.3.2.3p8</a>, however: &quot;A pointer to a function of one type may be converted to a pointer to a function of another type and back again; the result shall compare equal to the original pointer. If a converted pointer is used to call a function whose type is not compatible with the referenced type, the behavior is undefined.&quot;"}], "tags": [], "owner": {"reputation": 497, "user_id": 5028654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae3adc67920fa134f2e30c2825136179?s=128&d=identicon&r=PG&f=1", "display_name": "A B", "link": "https://stackoverflow.com/users/5028654/a-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1435146097, "last_edit_date": 1435146097, "creation_date": 1435140419, "answer_id": 31023698, "question_id": 31023392, "link": "https://stackoverflow.com/questions/31023392/function-that-takes-arbitrary-data-use-void-or-char/31023698#31023698", "title": "Function that takes arbitrary data: Use void* or char*?", "body": "<p>A void* can be considered a black box that holds a pointer. By holding it\nin a void* you are effectively saying that you don't care or it contains at that point, so this will allow you to make any assumption about it.\nVoid* is a \"true\" generic pointer, and can be directly assign to any particular data type without using cast. </p>\n\n<p>Meanwhile, a char* explicitly specify the type of the respective object. Initially there was no char* and char* was also used to represent generic pointers. When char* is used an explicit cast is required, however the usage of char* as a generic pointer is not recommanded, because it may create confusion, like it did back there when it was hard to tell if a char* contains a string or some generic data.</p>\n\n<p>Also, is legal to perform arithmeticon a char*, but not on a void*.</p>\n\n<p>The downside of using void*, is given by their main usage, they can hide  the actual type of the data you're storing, which prevents the compiler and other stuff to detect type errors.</p>\n\n<p>In your specific situation there is no problem in using void* instead of char*, so you can use void* without worries.</p>\n\n<p>Edit: Updated and reformuled the answer to correct some wrong info</p>\n"}, {"comments": [{"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "edited": false, "score": 0, "creation_date": 1435148150, "post_id": 31025161, "comment_id": 50077144, "body": "My bad; the question you asked seems <i>very different</i> to that (<i>Is there a reason not to use <code>void*</code> to pass arbitrary data to a function?</i>)... It&#39;s not a constraint violation, and (the <code>int</code> idea, <i>not</i> the <code>struct</code> idea) will probably work most of the time. The scary thing about it (which is the gist of my answer) is that when it fails to work, it will do so <i>silently</i>... Ye be warned; <code>int</code> may also have padding."}], "tags": [], "owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "is_accepted": false, "score": 0, "last_activity_date": 1435145721, "last_edit_date": 1435145721, "creation_date": 1435144832, "answer_id": 31025161, "question_id": 31023392, "link": "https://stackoverflow.com/questions/31023392/function-that-takes-arbitrary-data-use-void-or-char/31025161#31025161", "title": "Function that takes arbitrary data: Use void* or char*?", "body": "<p>The current accepted answer exists only to flatter the OP; It's actually slightly invalid.</p>\n\n<p>Consider that your arbitrary <code>struct</code> may (most likely) have padding bytes <em>somewhere</em>. The value of those padding bytes is indeterminate and may or may not be insignificant.</p>\n\n<p>Consider what might happen if you <code>put</code> a <code>struct</code> as <code>key</code> that has padding bytes, and you then attempt to <code>get</code> the <code>value</code> for that <code>key</code> which is otherwise equal except for the padding bytes.</p>\n\n<p>Consider also how you might handle pointer members, if you choose to do so in the future.</p>\n\n<p>If you intend to use a <code>struct</code> as <code>key</code>, it would be a good idea to serialise it, so you can guarantee retrieval of the corresponding <code>value</code> without worrying about those padding bits.</p>\n\n<p>Perhaps you could pass a function pointer telling your wrapper how to serialise the <code>key</code> into a string...</p>\n"}, {"tags": [], "owner": {"reputation": 415, "user_id": 2826084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/906ecdd15b33ee95ccd531f1fe67cf0d?s=128&d=identicon&r=PG&f=1", "display_name": "user2826084", "link": "https://stackoverflow.com/users/2826084/user2826084"}, "is_accepted": false, "score": 0, "last_activity_date": 1435151185, "creation_date": 1435151185, "answer_id": 31027433, "question_id": 31023392, "link": "https://stackoverflow.com/questions/31023392/function-that-takes-arbitrary-data-use-void-or-char/31027433#31027433", "title": "Function that takes arbitrary data: Use void* or char*?", "body": "<p>You should be serializing to some standard format like json instead of dealing with raw data like that. It looks very error prone unless you always assume that the arbitrary data is just a byte buffer. In which case I would use uint8_t pointer (which is an unsigned char*) and cast all data structures to it so that the routine just thinks that it is dealing with a byte buffer. </p>\n\n<p>A note on void*: i almost never ever use them. Think carefully when you introduce void pointers because in most cases you can do away with the right way of doing things which takes advantage of the standard types to avoid future bugs. The only places where you should use void* is in places like malloc() where there is not really a better way. </p>\n"}], "owner": {"reputation": 173, "user_id": 4999000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d53b0dc431083e8643890b5c6c9b0230?s=128&d=identicon&r=PG&f=1", "display_name": "lkamp", "link": "https://stackoverflow.com/users/4999000/lkamp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 844, "favorite_count": 0, "accepted_answer_id": 31023633, "answer_count": 4, "score": 1, "last_activity_date": 1435151185, "creation_date": 1435139656, "last_edit_date": 1435141341, "question_id": 31023392, "link": "https://stackoverflow.com/questions/31023392/function-that-takes-arbitrary-data-use-void-or-char", "title": "Function that takes arbitrary data: Use void* or char*?", "body": "<p>I recently wrote a wrapper for LevelDB in C and stumbled about the following problem. The LevelDB function to store data in a database looks like this:</p>\n\n<pre><code>leveldb_put(leveldb_t* db, const leveldb_writeoptions_t* options, const char* key, size_t keylen, const char* val, size_t vallen, char** errptr);\n</code></pre>\n\n<p>For the key and value, they use a <code>char*</code>. That means I would have to cast arguments that aren't <code>char</code> pointers. This happens often because I often store structs in the database.</p>\n\n<p>After thinking about this I decided to use a <code>void*</code> for key and data in my wrapper function. It then looks something like this:</p>\n\n<pre><code>int db_put(db_t db, void *key, size_t keylen, void *value, size_t valuelen)\n{\n    char *k = (char*)key;\n    char *v = (char*)value;\n\n    /* Call leveldb_put() here with k and v as parameters. */\n\n    return 0;\n}\n</code></pre>\n\n<p>This way I don't have to cast the arguments I pass to my <code>db_put()</code> function. I think this solution is more elegant, but I guess  LevelDB  knew what they were doing when they choose the <code>char</code> pointers.</p>\n\n<p>Is there a reason not to use <code>void*</code> to pass arbitrary data to a function?</p>\n"}, {"tags": ["c++", "c", "caching"], "comments": [{"owner": {"reputation": 9386, "user_id": 997813, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e917968317abb617b39d12613b1975a9?s=128&d=identicon&r=PG", "display_name": "Arjun Sreedharan", "link": "https://stackoverflow.com/users/997813/arjun-sreedharan"}, "edited": false, "score": 0, "creation_date": 1435140030, "post_id": 31023260, "comment_id": 50071731, "body": "I would say this is not something the language has control over. To the language, all of this is abstracted as &#39;memory&#39;. See <a href=\"http://www.programcreek.com/2012/10/how-is-an-array-stored-in-memory-and-brought-to-cache/\" rel=\"nofollow noreferrer\">this</a> though."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 9386, "user_id": 997813, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e917968317abb617b39d12613b1975a9?s=128&d=identicon&r=PG", "display_name": "Arjun Sreedharan", "link": "https://stackoverflow.com/users/997813/arjun-sreedharan"}, "edited": false, "score": 0, "creation_date": 1435151278, "post_id": 31023260, "comment_id": 50079414, "body": "@ArjunSreedharan: The compiler does know the OS and CPU. It might add cache control instructions."}], "answers": [{"comments": [{"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1435151437, "post_id": 31024131, "comment_id": 50079542, "body": "Actually the OS very much has control over the cache, and necessarily so. It would be quite bad if the CPU cache contained leftover data from the previously running process. And since the CPU doesn&#39;t know about processes, this must be OS-enforced."}], "tags": [], "owner": {"reputation": 4944, "user_id": 4877767, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RO6mn.png?s=128&g=1", "display_name": "marom", "link": "https://stackoverflow.com/users/4877767/marom"}, "is_accepted": false, "score": 2, "last_activity_date": 1435146753, "last_edit_date": 1435146753, "creation_date": 1435141549, "answer_id": 31024131, "question_id": 31023260, "link": "https://stackoverflow.com/questions/31023260/does-new-malloc-or-delete-free-occupy-or-invalidate-cache-lines/31024131#31024131", "title": "Does new/malloc or delete/free occupy or invalidate cache lines?", "body": "<p>This is an interesting article where you will find more info (probably too much) about what you are asking about:</p>\n\n<p><a href=\"https://people.freebsd.org/~lstewart/articles/cpumemory.pdf\" rel=\"nofollow\">What every programmer should know about memory</a></p>\n\n<p>Regarding your question every operation you do on memory will be cached. As a programmer you have no control whatsoever about it (and eves the OS has not). Keep in mind that if you need to implement a space(memory) consuming algorithm then try to increase memory locality.</p>\n\n<p>So assuming you have to deal with 1GB of data try to split up computation into clusters (sections of data) and try to do all operations one section at a time. This way you will actually use data from cache and not need to get to outer memory every time. This may give you a performance boost.</p>\n"}, {"comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1435156939, "post_id": 31025201, "comment_id": 50083914, "body": "Just in addition to 3): In theory, free/delete could explicitly issue cache invalidation instructions/requests - I&#39;ve never seen any implementation do that though."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user184968"}, "is_accepted": true, "score": 3, "last_activity_date": 1435156705, "last_edit_date": 1435156705, "creation_date": 1435144957, "answer_id": 31025201, "question_id": 31023260, "link": "https://stackoverflow.com/questions/31023260/does-new-malloc-or-delete-free-occupy-or-invalidate-cache-lines/31025201#31025201", "title": "Does new/malloc or delete/free occupy or invalidate cache lines?", "body": "<p>From here <a href=\"https://people.freebsd.org/~lstewart/articles/cpumemory.pdf\" rel=\"nofollow\">https://people.freebsd.org/~lstewart/articles/cpumemory.pdf</a></p>\n\n<p>--</p>\n\n<blockquote>\n  <ol>\n  <li>Does write operation bring the data into the cache? </li>\n  </ol>\n</blockquote>\n\n<p>From the article:</p>\n\n<blockquote>\n  <p>By default all data read or written by the CPU cores is stored in the\n  cache. There are memory regions which cannot be cached but this is\n  something only the OS implementers have to be concerned about; it is\n  not visible to the application programmer. There are also instructions\n  which allow the programmer to deliberately bypass certain caches. This\n  will be discussed in section 6.</p>\n</blockquote>\n\n<p>--</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>When allocating large memory, the memory may come from the OS. will this mechanism occupy the cache?</li>\n  </ol>\n</blockquote>\n\n<p>Possibly not. It will occupy the cache only after reading or writing data. From the article:</p>\n\n<blockquote>\n  <p>On operating systems like Linux with demand-paging support, an mmap\n  call only modifies the page tables ... No actual memory is allocated\n  at the time of the mmap call.</p>\n  \n  <p>The allocation part happens when a memory page is first accessed,\n  either by reading or writing data, or by executing code. In response\n  to the ensuing page fault, the kernel takes control and determines,\n  using the page table tree, the data which has to be present on the\n  page. This resolution of the page fault is not cheap, but it happens\n  for every single page which is used by a process.</p>\n</blockquote>\n\n<p>--</p>\n\n<blockquote>\n  <p>3 .Assume that there is an allocated array B, and the entire B is now in the cache. Will the cache lines occupied by B become invalid(available) right after I free array B?</p>\n</blockquote>\n\n<p>from the article invalidation of a cache line happens only when there has been a write operation on another CPU</p>\n\n<blockquote>\n  <p>What developed over the years is the MESI cache coherency protocol\n  (Modified, Exclusive, Shared, Invalid). The protocol is named after\n  the four states a cache line can be in when using the MESI protocol.\n  ... If the second processor wants to write to the cache line the first\n  processor sends the cache line content and marks the cache line\n  locally as Invalid.</p>\n</blockquote>\n\n<p>And also cache line can be evicted:</p>\n\n<blockquote>\n  <p>Another detail of the caches which is rather uninteresting to\n  programmers is the cache replacement strategy. Most caches evict the\n  Least Recently Used (LRU) element first.</p>\n</blockquote>\n\n<p>And from my experience with TCMalloc <code>free()</code> is not a compelling reason to evict the memory from a cache. On the contrary it might be harmful to performance. On <code>free()</code> TCMalloc just puts a freed block of memory in its cache. And this block of memory will be returned by <code>malloc()</code> when an application asks for a block of memory next time. That is the essence of a caching alliocator like TCMalloc. And if this block of memory is still in cachethen it is even better for performance!</p>\n"}, {"tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 1, "last_activity_date": 1435152050, "creation_date": 1435152050, "answer_id": 31027774, "question_id": 31023260, "link": "https://stackoverflow.com/questions/31023260/does-new-malloc-or-delete-free-occupy-or-invalidate-cache-lines/31027774#31027774", "title": "Does new/malloc or delete/free occupy or invalidate cache lines?", "body": "<p>To answer the title question, no. These operations do not invalidate caches, and quite intentionally so. What happens to freed memory? There are two important cases. One, the memory is immediately recycled for your programs next allocation. Having the address still in cache is efficient in this case, as this reduces the number of writes to main memory.</p>\n\n<p>But even if the memory isn't directly reused, the memory allocator may merge free blocks behind the scenes or perform other operations. This often involves writing to the space formerly allocated by your data. After all, freeing memory doesn't physically destroy the memory. It merely sets the owner. After <code>delete</code>, ownership is transferred from your program to the runtime or the OS. </p>\n"}], "owner": {"reputation": 63, "user_id": 5043744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6026cb1c33d9dbed30fe924a946d15a0?s=128&d=identicon&r=PG&f=1", "display_name": "nineee", "link": "https://stackoverflow.com/users/5043744/nineee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "accepted_answer_id": 31025201, "answer_count": 3, "score": 6, "last_activity_date": 1435156705, "creation_date": 1435139333, "last_edit_date": 1495540280, "question_id": 31023260, "link": "https://stackoverflow.com/questions/31023260/does-new-malloc-or-delete-free-occupy-or-invalidate-cache-lines", "title": "Does new/malloc or delete/free occupy or invalidate cache lines?", "body": "<p>I am curious about the cache behavior. Here are some questions related to the cache below :</p>\n\n<ol>\n<li><p>Does write operation bring the data into the cache?\nConsidering an assignment like A[i] = B[i], will A[i] be loaded into the cache?Since I just write something into A[i] instead of reading its value.</p></li>\n<li><p>When allocating large memory, the memory may come from the OS. And the OS will initialize the data to zero for safety reason (<a href=\"https://stackoverflow.com/questions/8029584/why-does-malloc-initialize-the-values-to-0-in-gcc\">Reference</a> ). If assignments  will bring data into cache(question 1) , will this mechanism occupy the cache ?</p></li>\n<li><p>Assume that there is an allocated array B, and the entire B is now in the cache. Will the cache lines occupied by B become invalid(available) right after I free array B?</p></li>\n</ol>\n\n<p>Could somebody  gives me a hint?</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1435138939, "post_id": 31022977, "comment_id": 50070943, "body": "You should read <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">a good <code>scanf</code> (and family) reference</a>."}, {"owner": {"reputation": 310, "user_id": 5041993, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/0jAKz.jpg?s=128&g=1", "display_name": "linofex", "link": "https://stackoverflow.com/users/5041993/linofex"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1435139100, "post_id": 31022977, "comment_id": 50071054, "body": "sorry, maybe I have wrote a bad example:  the difference between scanf(&quot;%c %c&quot;, &amp;x,  &amp;y); and scanf(&quot;%c%c&quot;, &amp;x, &amp;y);"}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 310, "user_id": 5041993, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/0jAKz.jpg?s=128&g=1", "display_name": "linofex", "link": "https://stackoverflow.com/users/5041993/linofex"}, "edited": false, "score": 2, "creation_date": 1435138960, "post_id": 31023048, "comment_id": 50070957, "body": "@linofex No, the <code>&quot;%c&quot;</code> format doesn&#39;t skip leading white-space."}, {"owner": {"reputation": 310, "user_id": 5041993, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/0jAKz.jpg?s=128&g=1", "display_name": "linofex", "link": "https://stackoverflow.com/users/5041993/linofex"}, "edited": false, "score": 0, "creation_date": 1435139231, "post_id": 31023048, "comment_id": 50071153, "body": "sorry, maybe I have wrote a bad example: the difference between scanf(&quot;%c %c&quot;, &amp;x, &amp;y); and scanf(&quot;%c%c&quot;, &amp;x, &amp;y);"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 310, "user_id": 5041993, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/0jAKz.jpg?s=128&g=1", "display_name": "linofex", "link": "https://stackoverflow.com/users/5041993/linofex"}, "edited": false, "score": 2, "creation_date": 1435139381, "post_id": 31023048, "comment_id": 50071277, "body": "@linofex: Adding the space makes sure your program can handle input like this: <code>x&lt;enter&gt;y&lt;enter&gt;</code>. spaces in format strings tell <code>scanf</code> to ignore any whitespace chars in between the chars (including new lines)"}, {"owner": {"reputation": 310, "user_id": 5041993, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/0jAKz.jpg?s=128&g=1", "display_name": "linofex", "link": "https://stackoverflow.com/users/5041993/linofex"}, "edited": false, "score": 0, "creation_date": 1435139769, "post_id": 31023048, "comment_id": 50071538, "body": "tried in my pc. and in the case with %c there is the difference: with a space in scanf parameters even if I enter spaces the two variables don&#39;t eat space! Instead with scanf(&quot;%c%c&quot;.....) the second %c eat a space or a newline. right?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1435141292, "post_id": 31023048, "comment_id": 50072540, "body": "You didn&#39;t answer the first question (what is the difference between <code>&quot;%d %d&quot;</code> and <code>&quot;%d%d&quot;</code>). The answer is &quot;nothing&quot;."}], "tags": [], "owner": {"reputation": 9606, "user_id": 3677097, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8c49e598194e53b9aba3a195da387a5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas DM", "link": "https://stackoverflow.com/users/3677097/andreas-dm"}, "is_accepted": true, "score": 2, "last_activity_date": 1435141712, "last_edit_date": 1592644375, "creation_date": 1435138814, "answer_id": 31023048, "question_id": 31022977, "link": "https://stackoverflow.com/questions/31022977/difference-in-scanf-parameters/31023048#31023048", "title": "difference in scanf parameters", "body": "<p>In your case they both result in the same whether you put a space between or not :)</p>\n<p>From <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">cppreference</a>:</p>\n<blockquote>\n<p>All conversion specifiers other than [, c, and n consume and discard all leading whitespace characters (determined as if by calling isspace) before attempting to parse the input. These consumed characters do not count towards the specified maximum field width.</p>\n<p>The conversion specifiers that do not consume leading whitespace, such as %c, can be made to do so by using a whitespace character in the format string:</p>\n</blockquote>\n<pre><code>scanf(&quot;%d&quot;, &amp;a);\nscanf(&quot; %c&quot;, &amp;c); // ignore the endline after %d, then read a char\n</code></pre>\n<p>So your example: <code>scanf(&quot;%c%c&quot;, &amp;x, &amp;y);</code> will not skip whitespace.<br>\nIf you input <code>a b</code> followed by enter it will read <code>a</code> and a whitespace.<br>\nOn the other hand if you input <code>ab</code> it will read a and b as you wanted.</p>\n<p>In the example: <code>scanf(&quot;%c %c&quot;, &amp;x, &amp;y);</code>, if you input <code>a</code> and hit enter, it will ignore the newline, and let you enter the other character.</p>\n"}, {"comments": [{"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1435141898, "post_id": 31023077, "comment_id": 50072928, "body": "Your answer is confusing. You explain the first two <code>scanf</code>s in a somewhat different way as if there was any difference between them."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1435142945, "post_id": 31023077, "comment_id": 50073663, "body": "<code>scanf</code> <i>needs</i> to <i>eat</i>!"}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1435150734, "post_id": 31023077, "comment_id": 50079001, "body": "@undefinedbehaviour <a href=\"http://tvtropes.org/pmwiki/pmwiki.php/Main/WizardNeedsFoodBadly\" rel=\"nofollow noreferrer\">Badly</a>!"}], "tags": [], "owner": {"reputation": 10297, "user_id": 2425366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5z1Nm.jpg?s=128&g=1", "display_name": "Shreevardhan", "link": "https://stackoverflow.com/users/2425366/shreevardhan"}, "is_accepted": false, "score": 1, "last_activity_date": 1435141585, "last_edit_date": 1435141585, "creation_date": 1435138894, "answer_id": 31023077, "question_id": 31022977, "link": "https://stackoverflow.com/questions/31022977/difference-in-scanf-parameters/31023077#31023077", "title": "difference in scanf parameters", "body": "<p><code>scanf(\"%d %d\", &amp;x, &amp;y)</code> will eat the space (if any) after first integer is read and then read the second integer, while <code>scanf(\"%d%d\", &amp;x, &amp;y)</code> will ignore whitespace while reading two integers. However both produce same results when run.</p>\n"}, {"comments": [{"owner": {"reputation": 310, "user_id": 5041993, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/0jAKz.jpg?s=128&g=1", "display_name": "linofex", "link": "https://stackoverflow.com/users/5041993/linofex"}, "edited": false, "score": 0, "creation_date": 1435326105, "post_id": 31073517, "comment_id": 50168021, "body": "thank you for your answer, it is clean and useful!I edited my question changing the same problem with %c instead that %d. In this case there is difference."}], "tags": [], "owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "is_accepted": false, "score": 1, "last_activity_date": 1435322682, "creation_date": 1435322682, "answer_id": 31073517, "question_id": 31022977, "link": "https://stackoverflow.com/questions/31022977/difference-in-scanf-parameters/31073517#31073517", "title": "difference in scanf parameters", "body": "<p>A format directive that matches whitespace (e.g. anything for which <code>isspace</code> returns true) causes as much whitespace as possible to be read and discarded from the stream (<code>stdin</code>, in this case).</p>\n\n<p>This process is required prior to the <code>%d</code> format directive translating digits, anyway; that is, the <code>%d</code> directive will read and discard as much whitespace as possible, and then read and translate a sign and/or sequence of decimal digits to an <code>int</code>.</p>\n\n<p>In summary, with or without the whitespace directive, the functionality of these two statements is identical; the whitespace directive is superfluous in this case.</p>\n"}], "owner": {"reputation": 310, "user_id": 5041993, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/0jAKz.jpg?s=128&g=1", "display_name": "linofex", "link": "https://stackoverflow.com/users/5041993/linofex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 31023048, "answer_count": 3, "score": 2, "last_activity_date": 1435322682, "creation_date": 1435138605, "last_edit_date": 1435139658, "question_id": 31022977, "link": "https://stackoverflow.com/questions/31022977/difference-in-scanf-parameters", "title": "difference in scanf parameters", "body": "<p>When I write a program, I don't give attention about parameters of <code>scanf</code>.\nWhat is the difference between:</p>\n\n<pre><code>scanf(\"%d %d\", &amp;x,&amp;y);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>scanf(\"%d%d\", &amp;x,&amp;y);\n</code></pre>\n\n<p>note the space between <code>%d</code>s.\nI tried on my pc, but I can't see the difference.</p>\n\n<p>Also, what about <code>%c</code> instead of <code>%d</code> - what is the difference between</p>\n\n<pre><code>scanf(\"%c %c\", &amp;x,&amp;y);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>scanf(\"%c%c\", &amp;x,&amp;y);\n</code></pre>\n\n<p>Can you give me useful examples to understand this stupid thing?</p>\n"}, {"tags": ["c", "enums", "compilation"], "comments": [{"owner": {"reputation": 8876, "user_id": 1545171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TiAiM.jpg?s=128&g=1", "display_name": "DrKoch", "link": "https://stackoverflow.com/users/1545171/drkoch"}, "edited": false, "score": 0, "creation_date": 1435139353, "post_id": 31022633, "comment_id": 50071251, "body": "You could write a unit-test that checks the uniqueness of all <i>integer values</i> in a given enumeration."}, {"owner": {"reputation": 497, "user_id": 5028654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae3adc67920fa134f2e30c2825136179?s=128&d=identicon&r=PG&f=1", "display_name": "A B", "link": "https://stackoverflow.com/users/5028654/a-b"}, "edited": false, "score": 1, "creation_date": 1435139717, "post_id": 31022633, "comment_id": 50071509, "body": "The best thing you can probably do is to not specify explicitly the values, except for the first."}], "answers": [{"comments": [{"owner": {"reputation": 1535, "user_id": 3896330, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91bfbe26ae69ceea219c9d728639435b?s=128&d=identicon&r=PG&f=1", "display_name": "DainDwarf", "link": "https://stackoverflow.com/users/3896330/daindwarf"}, "edited": false, "score": 0, "creation_date": 1435142540, "post_id": 31023546, "comment_id": 50073379, "body": "That&#39;s nice, I didn&#39;t knew about duplicate case warning on switch. I guess I could do a unittest that do a switch on all values, but that would make me duplicate code, and I will need a really nice comment to be sure no one adds a default: Thanks for that answer anyway!"}, {"owner": {"reputation": 1304, "user_id": 1073171, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zrsir.jpg?s=128&g=1", "display_name": "Brian Sidebotham", "link": "https://stackoverflow.com/users/1073171/brian-sidebotham"}, "reply_to_user": {"reputation": 1535, "user_id": 3896330, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91bfbe26ae69ceea219c9d728639435b?s=128&d=identicon&r=PG&f=1", "display_name": "DainDwarf", "link": "https://stackoverflow.com/users/3896330/daindwarf"}, "edited": false, "score": 0, "creation_date": 1435142618, "post_id": 31023546, "comment_id": 50073432, "body": "Just put it in your code. You&#39;ll get the warning - even if the code is thrown away by the linker because it&#39;s not used."}, {"owner": {"reputation": 1304, "user_id": 1073171, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zrsir.jpg?s=128&g=1", "display_name": "Brian Sidebotham", "link": "https://stackoverflow.com/users/1073171/brian-sidebotham"}, "reply_to_user": {"reputation": 1535, "user_id": 3896330, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91bfbe26ae69ceea219c9d728639435b?s=128&d=identicon&r=PG&f=1", "display_name": "DainDwarf", "link": "https://stackoverflow.com/users/3896330/daindwarf"}, "edited": false, "score": 0, "creation_date": 1435143169, "post_id": 31023546, "comment_id": 50073800, "body": "@DainDwarf warning should read error in your comment. Code compilation will fail if there is a duplicate case in the switch and warn if an entry in the ENUM and not present in the switch"}, {"owner": {"reputation": 3431, "user_id": 2482998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afd7c230e485da1a1ecfa351bd3744d9?s=128&d=identicon&r=PG", "display_name": "antron", "link": "https://stackoverflow.com/users/2482998/antron"}, "edited": false, "score": 0, "creation_date": 1435165881, "post_id": 31023546, "comment_id": 50090152, "body": "You can use a macro to generate both the enum and a function with the switch, however, in C, the macro&#39;s syntax will not be very nice. I think you will ultimately have to do something like <code>ENUM(Type, (Name0, Value0), (Name1, Value1))</code>, etc. If it is at all possible for you to use C++, you can get nicer syntax like <code>ENUM(Type, Name0 = Value0, Name1 = Value1)</code>. If you are interested, search SO for &quot;enum to string&quot; to get some ideas on how to get started. I might also be able to throw together a little example if this kind of approach is acceptable for your project."}], "tags": [], "owner": {"reputation": 1304, "user_id": 1073171, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zrsir.jpg?s=128&g=1", "display_name": "Brian Sidebotham", "link": "https://stackoverflow.com/users/1073171/brian-sidebotham"}, "is_accepted": false, "score": 2, "last_activity_date": 1435140047, "creation_date": 1435140047, "answer_id": 31023546, "question_id": 31022633, "link": "https://stackoverflow.com/questions/31022633/verify-that-all-set-values-of-an-enum-are-distinct/31023546#31023546", "title": "Verify that all set values of an enum are distinct", "body": "<p>A <code>switch</code> statement cannot have two cases with the same value. So you can have a switch somewhere. Make it with no <code>default:</code> case and gcc will warn you that a member of the enum is not handled in the switch statement if you add a new value. If two values of the enum are the same, compilation will fail.</p>\n\n<p>Some examples:</p>\n\n<pre><code>typedef enum {\n    ERR_NONE = 0,\n    ERR_SAME = 0\n} err_t;\n\nvolatile err_t e = ERR_NONE;\n\nint main( int argc, char* argv[] )\n{\n    switch( e )\n    {\n        case ERR_NONE:\n        break;\n\n        case ERR_SAME:\n        break;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>with <code>gcc -Wall switch.c</code> gives:</p>\n\n<pre><code>switch.c: In function 'main':\nswitch.c:16:9: error: duplicate case value\n     case ERR_SAME:\n     ^\nswitch.c:13:9: error: previously used here\n     case ERR_NONE:\n     ^\n</code></pre>\n\n<p>and...</p>\n\n<pre><code>typedef enum {\n    ERR_NONE = 0,\n    ERR_NEXT,\n    ERR_MISSING,\n} err_t;\n\nvolatile err_t e = ERR_NONE;\n\nint main( int argc, char* argv[] )\n{\n    switch( e )\n    {\n        case ERR_NONE:\n        break;\n\n        case ERR_NEXT:\n        break;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>with <code>gcc -Wall switch-missing.c</code> gives:</p>\n\n<pre><code>switch-missing.c: In function 'main':\nswitch-missing.c:12:5: warning: enumeration value 'ERR_MISSING' not handled in switch [-Wswitch]\n switch( e )\n ^\n</code></pre>\n"}], "owner": {"reputation": 1535, "user_id": 3896330, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/91bfbe26ae69ceea219c9d728639435b?s=128&d=identicon&r=PG&f=1", "display_name": "DainDwarf", "link": "https://stackoverflow.com/users/3896330/daindwarf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1550375096, "creation_date": 1435137668, "question_id": 31022633, "link": "https://stackoverflow.com/questions/31022633/verify-that-all-set-values-of-an-enum-are-distinct", "title": "Verify that all set values of an enum are distinct", "body": "<p>I just recently found out that when setting values of variables of an enum, several variables can have the same value. For example, the following code is perfectly correct:</p>\n\n<pre><code>enum my_enum\n{\n    A = 3,\n    B = 4,\n    C = 3,\n    D = 5\n};\n</code></pre>\n\n<p>However, in my framework, I <strong>have</strong> to set manualy each variable, since it is used to communicate error codes to other systems. I cannot change the value of an error code without asking for the other teams to modify it as well.</p>\n\n<p>I regrouped all error codes into an enumeration to be sure we do not reuse the same error code for different reasons (which was the case before). But now, nothing stops anyone to reuse the same value for different errors.</p>\n\n<p>Is there a way I can make the compiler return an error if I assign the same value to different names in my enum?</p>\n\n<p>I can compile with either gcc or clang.</p>\n"}, {"tags": ["c", "assembly", "stack", "microcontroller", "interrupt"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1435138654, "post_id": 31022570, "comment_id": 50070748, "body": "Are you running a multithreading kernel?"}, {"owner": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1435138907, "post_id": 31022570, "comment_id": 50070922, "body": "I&#39;d like to do it without multi-threading e.g. on a bare-metal machine or no threading support"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1435139698, "post_id": 31022570, "comment_id": 50071502, "body": "Can the &#39;long-running function&#39; &#39;register itself&#39; for cancellation as it starts to run and &#39;unregister&#39; itself just before returning?  Such actions whould allow the entry stack frame to be marked and made available to the ISR, (maybe:).  I don&#39;t like this plan, and I foresee lots of unforeseen problems:)"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1435139862, "post_id": 31022570, "comment_id": 50071601, "body": "Note that this is a really good question.  I can&#39;t remember when I last upvoted a question on the C tag, usually it&#39;s a sea of downvotes:("}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1435149388, "post_id": 31022570, "comment_id": 50078044, "body": "It will be useful to find which part of the function takes a long time. If it&#39;s a loop, then you can check a global variable as <code>break</code> condition. Then all your ISR needs to do is to set that global variable."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1435154199, "post_id": 31022570, "comment_id": 50081681, "body": "Don&#39;t do that. Understand that you want a multi-task scheduler. Then use a real multitasked kernel. Read also about <a href=\"https://en.wikipedia.org/wiki/Continuation\" rel=\"nofollow noreferrer\">continuations</a>"}], "answers": [{"comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1435140429, "post_id": 31023583, "comment_id": 50072017, "body": "Hmm.. a calling convention where the caller cleans up the stack might be useful?  This question is giving me a headache:("}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1435140725, "post_id": 31023583, "comment_id": 50072212, "body": "Doesn&#39;t ARM use a separate stack for interrupts? In that case, <code>__builtin_frame_address</code> might not get the right stack."}, {"owner": {"reputation": 4991, "user_id": 4340578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75589faf097f9308a448ffe021defd1?s=128&d=identicon&r=PG&f=1", "display_name": "ElderBug", "link": "https://stackoverflow.com/users/4340578/elderbug"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1435140942, "post_id": 31023583, "comment_id": 50072344, "body": "@MartinJames Maybe a little, but it doesn&#39;t help the problem that callee-saved registers must be restored, and I don&#39;t know any convention that have no callee-saved registers. Also, the compiler doesn&#39;t expect this behavior, and often doesn&#39;t include stack cleaning even for caller cleaned conventions (because it thought, with reason, that it didn&#39;t have to)."}, {"owner": {"reputation": 4991, "user_id": 4340578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75589faf097f9308a448ffe021defd1?s=128&d=identicon&r=PG&f=1", "display_name": "ElderBug", "link": "https://stackoverflow.com/users/4340578/elderbug"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1435141294, "post_id": 31023583, "comment_id": 50072542, "body": "@EOF Maybe, I didn&#39;t try, but <code>__builtin_frame_address</code> is said to support multiple call levels. Maybe ARM GCC take this into account on devices that have this behavior."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1435144884, "post_id": 31023583, "comment_id": 50074960, "body": "If it was me, I would probably use a tasker just to avoid having to attempt this.  The long-runner could be threaded off and the thread and both it and ISR would set a semaphore/event.  First there wins:)"}, {"owner": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "edited": false, "score": 0, "creation_date": 1435148589, "post_id": 31023583, "comment_id": 50077428, "body": "@ElderBug cant i force the user to do a function &quot;prelude&quot; like if(1==0){return;}; and eventually only void functions. Giving it a &quot;fixed&quot; place in relation to the function&#39;s head?"}, {"owner": {"reputation": 4991, "user_id": 4340578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75589faf097f9308a448ffe021defd1?s=128&d=identicon&r=PG&f=1", "display_name": "ElderBug", "link": "https://stackoverflow.com/users/4340578/elderbug"}, "reply_to_user": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "edited": false, "score": 0, "creation_date": 1435149468, "post_id": 31023583, "comment_id": 50078116, "body": "@Stasik That would be an idea, but that won&#39;t work because it&#39;s not that simple. First, a <code>if(false) return;</code> will be optimized out by the compiler (even with -O0 in most cases), so the return code won&#39;t be here. Even if you get the compiler to not optimize this, you can&#39;t know in advance where this code will be in the function, because there may be a register saving at the beginning of the function, and maybe the return code will be merged with the end of the function, with a jump to the end instead of a return."}], "tags": [], "owner": {"reputation": 4991, "user_id": 4340578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75589faf097f9308a448ffe021defd1?s=128&d=identicon&r=PG&f=1", "display_name": "ElderBug", "link": "https://stackoverflow.com/users/4340578/elderbug"}, "is_accepted": false, "score": 0, "last_activity_date": 1435140141, "creation_date": 1435140141, "answer_id": 31023583, "question_id": 31022570, "link": "https://stackoverflow.com/questions/31022570/canceling-a-long-running-function-using-an-isr/31023583#31023583", "title": "Canceling a long-running function using an ISR", "body": "<p>That's possible in theory, but probably impossible to do reliably.</p>\n\n<p>You could use GCC builtins <code>__builtin_frame_address</code> and <code>__builtin_return_address</code> to correctly restore the stack and return from the previous function, but it will corrupt the program behavior. The function you forcibly return probably saved some registers on the stack, and needed to restore them before returning. The problem is, there is no way I know of to locate or mimic the restore code. It is certainly located just before the function returns (and you can't even know where this is), but it could be 1, 2, or even 0 instructions. And even if you locate it or mimic it, you can't really hardcode it, because it is likely to change when you change the function.</p>\n\n<p>In conclusion, you may be able if you use some builtins and 2-3 inline assembly instructions, but you need to tailor-hardcode it for the function you want to return, and you have to change it whenever you change the function.</p>\n"}, {"tags": [], "owner": {"reputation": 415, "user_id": 2826084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/906ecdd15b33ee95ccd531f1fe67cf0d?s=128&d=identicon&r=PG&f=1", "display_name": "user2826084", "link": "https://stackoverflow.com/users/2826084/user2826084"}, "is_accepted": false, "score": 0, "last_activity_date": 1435151511, "creation_date": 1435151511, "answer_id": 31027554, "question_id": 31022570, "link": "https://stackoverflow.com/questions/31022570/canceling-a-long-running-function-using-an-isr/31027554#31027554", "title": "Canceling a long-running function using an ISR", "body": "<p>Why cant you just set a flag in your isr that your function will periodically check to see if it needs to exit? The reason I disapprove of the way you are trying to do it is because it is extremely dangerous to \"kill\" a function when it is in the middle of some operation. Unless you have a way to clean up absolutely everything after it (like when killing a process) there is no other way you can do it safely. It is always better to signal the function through a flag or semaphore of some kind from isr and then let that function cleanup after itself and exit normally. </p>\n"}, {"comments": [{"owner": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "edited": false, "score": 0, "creation_date": 1435155830, "post_id": 31028576, "comment_id": 50082998, "body": "is there some example or other sources?"}, {"owner": {"reputation": 2573, "user_id": 1101537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1087a838de98ff53402c4a0e9ab9b990?s=128&d=identicon&r=PG", "display_name": "alexander", "link": "https://stackoverflow.com/users/1101537/alexander"}, "reply_to_user": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "edited": false, "score": 0, "creation_date": 1435156727, "post_id": 31028576, "comment_id": 50083763, "body": "@Stasik, There is a good setjmp/longjmp example <a href=\"http://web.eecs.utk.edu/~huangj/cs360/360/notes/Setjmp/lecture.html\" rel=\"nofollow noreferrer\">here</a>. ISR return address (PC, I think) should be modified in the stack frame using assembly. <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.ddi0337e/Babedgea.html\" rel=\"nofollow noreferrer\">Here</a> ARM M3 stack frame layout."}, {"owner": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "edited": false, "score": 0, "creation_date": 1435404644, "post_id": 31028576, "comment_id": 50193418, "body": "I am not too experienced in assembly, have you got some &quot;entry points&quot; like articles or other stuff?"}, {"owner": {"reputation": 2573, "user_id": 1101537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1087a838de98ff53402c4a0e9ab9b990?s=128&d=identicon&r=PG", "display_name": "alexander", "link": "https://stackoverflow.com/users/1101537/alexander"}, "reply_to_user": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "edited": false, "score": 0, "creation_date": 1435571505, "post_id": 31028576, "comment_id": 50238848, "body": "@Stasik, here is <a href=\"https://singpolyma.net/category/singpolyma-kernel/\" rel=\"nofollow noreferrer\">the articles</a> I&#39;ve found about writing simple OS kernel for ARM. There is a source for context switch routine (routine for switching stack, registers and another task-related stuff) on <a href=\"https://github.com/singpolyma/singpolyma-kernel/blob/master/context_switch.s\" rel=\"nofollow noreferrer\">github</a>. If I found spare time, I can expand my answer more specifically."}], "tags": [], "owner": {"reputation": 2573, "user_id": 1101537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1087a838de98ff53402c4a0e9ab9b990?s=128&d=identicon&r=PG", "display_name": "alexander", "link": "https://stackoverflow.com/users/1101537/alexander"}, "is_accepted": true, "score": 1, "last_activity_date": 1435157341, "last_edit_date": 1435157341, "creation_date": 1435154099, "answer_id": 31028576, "question_id": 31022570, "link": "https://stackoverflow.com/questions/31022570/canceling-a-long-running-function-using-an-isr/31028576#31028576", "title": "Canceling a long-running function using an ISR", "body": "<p>Looks like you want something like <a href=\"http://man7.org/linux/man-pages/man3/setjmp.3.html\" rel=\"nofollow\">setjmp/longjmp</a> with longjmp called after ISR termination.</p>\n\n<p>It is possible alter ISR return address such a way, that instead of returning to <code>long-running function</code> longjmp will be called with right parameters and <code>long-running function</code> will be aborted to the place where setjmp was called.</p>\n\n<p>Just another solution came in mind. May be it would be easier to restore all the registers (Stack pointer, PC, LR and others) to values they have before <code>long-running functions</code> was called in the ISR stack frame (using assembly). In order to do that you need to save all required values (using assembly) before <code>long-running functions</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 224, "user_id": 5076376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xjtpH.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5076376/daniel"}, "is_accepted": false, "score": 1, "last_activity_date": 1435911737, "creation_date": 1435911737, "answer_id": 31201981, "question_id": 31022570, "link": "https://stackoverflow.com/questions/31022570/canceling-a-long-running-function-using-an-isr/31201981#31201981", "title": "Canceling a long-running function using an ISR", "body": "<p>I would recommend avoiding a long-running function. While it may work in the short term, as your code grows it could become problematic.</p>\n\n<p>Instead, consider using a state machine, or system of state machines in your master loop, and using your ISR for a flag.  This will reduce timing issues and allow you to manage more tasks at once.</p>\n"}], "owner": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 31028576, "answer_count": 4, "score": 1, "last_activity_date": 1435911737, "creation_date": 1435137506, "question_id": 31022570, "link": "https://stackoverflow.com/questions/31022570/canceling-a-long-running-function-using-an-isr", "title": "Canceling a long-running function using an ISR", "body": "<p>is there a way of manipulating the stack from a timer ISR? So i can just throw away the highest frame of the stack by forcing a long-running function to exit? (I am aware of loosing the heap-allocated memory in this case)</p>\n\n<p>The target would probably be an ARM CPU.</p>\n\n<p>Best Regards</p>\n"}, {"tags": ["c", "opengl", "glut", "archlinux"], "answers": [{"tags": [], "owner": {"reputation": 14421, "user_id": 1888983, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/Y6tnm.png?s=128&g=1", "display_name": "jozxyqk", "link": "https://stackoverflow.com/users/1888983/jozxyqk"}, "is_accepted": true, "score": 2, "last_activity_date": 1435137752, "last_edit_date": 1495540711, "creation_date": 1435137752, "answer_id": 31022664, "question_id": 31022444, "link": "https://stackoverflow.com/questions/31022444/gluttimerfunc-not-limiting-framerate/31022664#31022664", "title": "glutTimerFunc() not limiting framerate", "body": "<p>Your <code>mainloop</code> should be called <code>init</code>. All it does is set glut callbacks. Rather than call <code>glutPostRedisplay</code> in the idle function, you should call it in a <code>timer</code> function. In other words, don't call <code>glutIdleFunc(timer);</code>. Instead, call <code>timer()</code> once yourself and have it add a timer to itself <code>glutTimerFunc (30 , timer, 0);</code>.</p>\n\n<p>However, I would recommend doing the timing for a frame limiter yourself as it will be much more accurate. I wrote <a href=\"https://stackoverflow.com/a/19677856/1888983\">this answer</a> for exactly that.</p>\n"}], "owner": {"reputation": 93, "user_id": 3832385, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d9bc532fa63bbbef4466877856cf3881?s=128&d=identicon&r=PG&f=1", "display_name": "nik123", "link": "https://stackoverflow.com/users/3832385/nik123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 0, "accepted_answer_id": 31022664, "answer_count": 1, "score": 0, "last_activity_date": 1435137752, "creation_date": 1435137158, "question_id": 31022444, "link": "https://stackoverflow.com/questions/31022444/gluttimerfunc-not-limiting-framerate", "title": "glutTimerFunc() not limiting framerate", "body": "<p>glutTimerFunc isnt making a delay it just loops forever. Like fxp. while(1).\nDid I something wrong? Or is it a compatibility issue?\nI am using arch linux x64 with gcc. And I've been kinda mixing 32 bit programs with 64 bit ones.<br>\nI am trying to make a program that checks for input whilst updating frames constantly under a delay<br>\nMy includes are:</p>\n\n<pre><code>#include &lt;GL/glut.h&gt;\n#include &lt;GL/glu.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n</code></pre>\n\n<p>And my main functions are:</p>\n\n<pre><code>void timer(void)\n{\n    glutPostRedisplay();\n    glutTimerFunc ( 30 , mainloop , 0 );\n}\n\nint main() {\n    loadconfiguration();\n    char *myargv [1];\n    int myargc=1;\n    myargv [0]=strdup (\"./file\");\n    glutInit(&amp;myargc, myargv);\n    glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGBA | GLUT_DEPTH);\n        glutInitWindowPosition(100, 100);\n        glutInitWindowSize(displayx, displayy);\n    printf(\"Making a window\\n\");\n    winIDMain = glutCreateWindow(\"GL Game\");\n    mainloop();\n}\nvoid mainloop(void){\n\n    Initilize();\n    glutSetWindow (winIDMain);\n    glutDisplayFunc (render);\n    glutReshapeFunc (reshape);\n    glutKeyboardFunc (keyboard);\n    glutMouseFunc (mouse);\n    glutIdleFunc (timer);\n    glutMainLoop();\n}\n</code></pre>\n\n<p>Don't worry other functions are clean :) <br>\nThe code worked earlier I don't know why it doesn't work now.</p>\n"}, {"tags": ["c", "arrays", "string", "msp430"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1435138775, "post_id": 31022419, "comment_id": 50070830, "body": "Since the &#39;string&#39; may be spread over several interrupts, I would probably use a char-by-char state-machine to look for the response."}], "answers": [{"comments": [{"owner": {"reputation": 814, "user_id": 1779362, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/76569c89b50cfaf143270cd7c0f9538a?s=128&d=identicon&r=PG", "display_name": "user1779362", "link": "https://stackoverflow.com/users/1779362/user1779362"}, "edited": false, "score": 0, "creation_date": 1435184264, "post_id": 31024013, "comment_id": 50100133, "body": "With the ATE0 command, it makes life much easier.  I also removed \\r and \\n hex (0x0A) and (0x0D) for getting in the buffer array, so now I can verify the response and reset my buffer each time.  Thanks for the help!"}], "tags": [], "owner": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "is_accepted": false, "score": 1, "last_activity_date": 1435141267, "creation_date": 1435141267, "answer_id": 31024013, "question_id": 31022419, "link": "https://stackoverflow.com/questions/31022419/uart-receive-string/31024013#31024013", "title": "UART receive string", "body": "<p>You can turn OFF echo by sending <code>ATE0</code> command.</p>\n\n<p>Also to find the intended string response please follow below steps:</p>\n\n<ol>\n<li><p>Enable UART Transmit and Receive Interrupt.</p></li>\n<li><p>After completing your command transmission you will start receiving data in UART ISR.</p></li>\n<li><p>In the receive interrupt start a timer of say 1 second(You need to consider baud-rate for exact calculation).</p></li>\n<li><p>Make track of number of received bytes in UART ISR.</p></li>\n<li><p>Now after timer expires add <code>null</code> to end of last received byte in buffer.</p></li>\n</ol>\n\n<p>Now,You can use string manipulation functions of C to find the intended response.</p>\n"}], "owner": {"reputation": 814, "user_id": 1779362, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/76569c89b50cfaf143270cd7c0f9538a?s=128&d=identicon&r=PG", "display_name": "user1779362", "link": "https://stackoverflow.com/users/1779362/user1779362"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2071, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435141549, "creation_date": 1435137097, "last_edit_date": 1435141549, "question_id": 31022419, "link": "https://stackoverflow.com/questions/31022419/uart-receive-string", "title": "UART receive string", "body": "<p>I am using an MSP430 and writing code in C.  I am receiving characters (working) via UART and placing them into an array rxDataArray.  Since I am using an MSP430G2211, I have limited memory.  The maximum array size is 50 and any more it won't build/load and says out of space.  </p>\n\n<p>My MSP430 is communicating to a ESP8266 module (wifi) where I am using \"AT\" commands.  I am receive an echo of my AT command, followed by a response (ex. AT+RST responds with AT+RST...ok).  I am confused using C, how I can make a string with just the \"ok\" response and check if it worked correctly.  I have the data in the array, just not sure how to pick certain elements of the array, make a string, and compare that to \"ok\" response. I am used to using CString in C++ and am confused how to do this in C. </p>\n\n<pre><code>/--------------------------------------------------------------------\n// Timer_A UART - Receive Interrupt Handler\n//-------------------------------------------------------------------\n#if defined(__TI_COMPILER_VERSION__) || defined(__IAR_SYSTEMS_ICC__)\n#pragma vector = TIMERA1_VECTOR\n__interrupt void Timer_A1_ISR(void)\n#elif defined(__GNUC__)\nvoid __attribute__ ((interrupt(TIMERA1_VECTOR))) Timer_A1_ISR (void)\n#else\n#error Compiler not supported!\n#endif\n{  \nstatic unsigned char rxBitCnt = 8;\nstatic unsigned char rxData = 0;\n\nswitch (__even_in_range(TAIV, TAIV_TAIFG)) { // Use calculated branching\n    case TAIV_TACCR1:                        // TACCR1 CCIFG - UART RX\n        TACCR1 += UART_TBIT;                 // Add Offset to CCRx\n        if (TACCTL1 &amp; CAP) {                 // Capture mode = start bit edge\n            TACCTL1 &amp;= ~CAP;                 // Switch capture to compare mode\n            TACCR1 += UART_TBIT_DIV_2;       // Point CCRx to middle of D0\n        }\n        else {\n            rxData &gt;&gt;= 1;\n            if (TACCTL1 &amp; SCCI) {            // Get bit waiting in receive latch\n                rxData |= 0x80;\n            }\n            rxBitCnt--;\n            if (rxBitCnt == 0) {             // All bits RXed?\n                rxBuffer = rxData;           // Store in global variable\n\n                if (rxDataCnt &lt; 50)\n                {\n                    rxDataArray[rxDataCnt] = rxBuffer;\n                    rxDataCnt++;\n                }\n                else\n                {\n                    int i = 0;\n                    for (i; i&lt;50-1; i++)\n                    {\n                        rxDataArray[i] = rxDataArray[i+1];\n                    }\n\n                    rxDataArray[50-1] = rxBuffer;\n                }\n\n                rxBitCnt = 8;                // Re-load bit counter\n                TACCTL1 |= CAP;              // Switch compare to capture mode\n                __bic_SR_register_on_exit(LPM0_bits);  // Clear LPM0 bits from 0(SR)\n            }\n        }\n        break;\n    }\n}\n//-----------------------------------------------------------------------\n</code></pre>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "edited": false, "score": 0, "creation_date": 1435137424, "post_id": 31022348, "comment_id": 50069879, "body": "Do you have some code to clarify what you mean?"}, {"owner": {"reputation": 1304, "user_id": 1073171, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zrsir.jpg?s=128&g=1", "display_name": "Brian Sidebotham", "link": "https://stackoverflow.com/users/1073171/brian-sidebotham"}, "edited": false, "score": 0, "creation_date": 1435141547, "post_id": 31022348, "comment_id": 50072699, "body": "Totally depends on the compiler, so you need to let us know what compiler you&#39;re using - or read it&#39;s manual."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1435213708, "post_id": 31022348, "comment_id": 50108180, "body": "<code>#pragma</code> means &quot;do something in a compiler-specific way, or otherwise if you don&#39;t recognize the pragma, do nothing&quot;. So it doesn&#39;t make any sense at all to speak of pragmas without a specific compiler in mind."}, {"owner": {"reputation": 13, "user_id": 2535635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7db0af1d7c161f13ced1fdc7d17723?s=128&d=identicon&r=PG&f=1", "display_name": "dottruce", "link": "https://stackoverflow.com/users/2535635/dottruce"}, "edited": false, "score": 0, "creation_date": 1542910889, "post_id": 31022348, "comment_id": 93746632, "body": "I use diab compiler"}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1435213883, "post_id": 31025124, "comment_id": 50108263, "body": "Good advice about the dangers of enum, only use it where the size and signedness doesn&#39;t matter, like for example when defining an error result type to be returned from your functions. Note however that <i>enumeration constants</i> (as opposed to enum variables) are guaranteed to have type <code>int</code>. So enums already have inconsistent behavior per definition of the C standard."}], "tags": [], "owner": {"reputation": 6316, "user_id": 3323096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1227f90127f0f7b8678a8c13261f48b4?s=128&d=identicon&r=PG", "display_name": "Vality", "link": "https://stackoverflow.com/users/3323096/vality"}, "is_accepted": true, "score": 2, "last_activity_date": 1435191561, "last_edit_date": 1435191561, "creation_date": 1435144717, "answer_id": 31025124, "question_id": 31022348, "link": "https://stackoverflow.com/questions/31022348/is-it-possible-to-override-enum-base-type-in-c-using-pragmas/31025124#31025124", "title": "Is it possible to override enum base type in C using pragmas?", "body": "<p>The C language standard does not define what the various #pragma extensions do. Therefore there is no way to do this in conforming C.</p>\n\n<p>If you have a specific compiler for which you need to do this, some specialised, embedded system targeting compilers do offer such functionality. You would be best off reading the documentation for that compiler for guidance on this.</p>\n\n<p>However I would not reccomend instantiating an enum in embedded code at all, this offers little control as to the underlying type as you noticed and therefore is unpredictable for embedded code for which you presumably want to target some specific platform.</p>\n\n<p>Instead, by all means define enumerated types, but instead of instanciating them just create variables of your chosen integral type and assign and compare them against the enum value literals. </p>\n"}], "owner": {"reputation": 13, "user_id": 2535635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7db0af1d7c161f13ced1fdc7d17723?s=128&d=identicon&r=PG&f=1", "display_name": "dottruce", "link": "https://stackoverflow.com/users/2535635/dottruce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 31025124, "answer_count": 1, "score": 1, "last_activity_date": 1435191561, "creation_date": 1435136893, "question_id": 31022348, "link": "https://stackoverflow.com/questions/31022348/is-it-possible-to-override-enum-base-type-in-c-using-pragmas", "title": "Is it possible to override enum base type in C using pragmas?", "body": "<p>Is it possible to override enum base type in C using pragmas? What I know is that we can set compiler directives to set the enum base type as char, int, long. But is there any other method for setting an enum base type in the code for C language? For C++, I found pragmas like typedef enum : unsigned char can be used..but what is case for C? </p>\n"}, {"tags": ["c", "bluetooth", "null", "termination", "can-bus"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1435138805, "post_id": 31022122, "comment_id": 50070849, "body": "Not using C would be best, but using a library with a sane API would be good.  A lib that usues null-terminated arrays for a binary stream is just sucky:("}, {"owner": {"reputation": 3, "user_id": 5040313, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--R6I7gpeYEA/AAAAAAAAAAI/AAAAAAAABAA/JeJm6XqI0J0/photo.jpg?sz=128", "display_name": "Kristian Krajewski", "link": "https://stackoverflow.com/users/5040313/kristian-krajewski"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1435138985, "post_id": 31022122, "comment_id": 50070974, "body": "Unfortunately this is not an option. But I can see your point, I guess the original author of the BT library had something else in mind."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5040313, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--R6I7gpeYEA/AAAAAAAAAAI/AAAAAAAABAA/JeJm6XqI0J0/photo.jpg?sz=128", "display_name": "Kristian Krajewski", "link": "https://stackoverflow.com/users/5040313/kristian-krajewski"}, "edited": false, "score": 0, "creation_date": 1435138024, "post_id": 31022319, "comment_id": 50070325, "body": "Yeah, I guess my wording was a bit off there, but thanks anyway for clarifying. I&#39;m aware that the binary data is there but it&#39;s being misinterpreted. When you say offsets, do you mean as in fixed positioning within the array? So I guess I have to dig deeper into the library and replace the data handling part?"}, {"owner": {"reputation": 1079, "user_id": 4472848, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bc7b33199a0a5e067e1a33265cf88d1?s=128&d=identicon&r=PG", "display_name": "Wouter Verhelst", "link": "https://stackoverflow.com/users/4472848/wouter-verhelst"}, "reply_to_user": {"reputation": 3, "user_id": 5040313, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--R6I7gpeYEA/AAAAAAAAAAI/AAAAAAAABAA/JeJm6XqI0J0/photo.jpg?sz=128", "display_name": "Kristian Krajewski", "link": "https://stackoverflow.com/users/5040313/kristian-krajewski"}, "edited": false, "score": 0, "creation_date": 1435140101, "post_id": 31022319, "comment_id": 50071785, "body": "Hmm. I&#39;m not entirely sure I understand what your problem is. You talk about bluetooth and CAN, but you don&#39;t explain how there&#39;s a problem. Surely your bluetooth library and your CAN library both understand binary arrays? i.e., you can hand them both a pointer and a length, and they will head off with the data? If not, you need to talk to whoever wrote the library and get them to fix it."}, {"owner": {"reputation": 3, "user_id": 5040313, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--R6I7gpeYEA/AAAAAAAAAAI/AAAAAAAABAA/JeJm6XqI0J0/photo.jpg?sz=128", "display_name": "Kristian Krajewski", "link": "https://stackoverflow.com/users/5040313/kristian-krajewski"}, "edited": false, "score": 0, "creation_date": 1435143809, "post_id": 31022319, "comment_id": 50074231, "body": "That&#39;s the point, the BT lib obviously can&#39;t handle null bytes within the stream. I&#39;ll give the author a call and see what he has to say about this. The problem, put simply, is that any null char will cut off the end of the message. Thanks anyway for the feedback! I&#39;d upvote, but apparently I can&#39;t until I reach a certain rep."}], "tags": [], "owner": {"reputation": 1079, "user_id": 4472848, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bc7b33199a0a5e067e1a33265cf88d1?s=128&d=identicon&r=PG", "display_name": "Wouter Verhelst", "link": "https://stackoverflow.com/users/4472848/wouter-verhelst"}, "is_accepted": true, "score": 1, "last_activity_date": 1435136830, "creation_date": 1435136830, "answer_id": 31022319, "question_id": 31022122, "link": "https://stackoverflow.com/questions/31022122/whats-the-easiest-way-to-prevent-null-chars-from-terminating-my-string/31022319#31022319", "title": "What&#39;s the easiest way to prevent null chars from terminating my string?", "body": "<p>There is no \"string\" type in C; what you call a string in C really is just a <code>char *</code>, which is just a series of bytes, too. Whenever you pass such a series of bytes to a string handling function (whether part of the standard C library or not), those functions will consider any embedded NULL as a string termination, and end processing there. That doesn't mean your binary data ends at that location, however.</p>\n\n<p>Your problem isn't that your library gets you strings, it's that you're confusing binary data with strings. You're not dealing with strings, you're dealing with binary data. If it helps, you can cast the <code>char *</code> variables to <code>void *</code> variables; this isn't strictly necessary, but it may help you remember that it's binary data. Then, use a packed <code>struct</code> (if the data has fixed offsets) or write a custom parser function (if not) to deal with the data going in or out of your CAN bus.</p>\n"}], "owner": {"reputation": 3, "user_id": 5040313, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--R6I7gpeYEA/AAAAAAAAAAI/AAAAAAAABAA/JeJm6XqI0J0/photo.jpg?sz=128", "display_name": "Kristian Krajewski", "link": "https://stackoverflow.com/users/5040313/kristian-krajewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 31022319, "answer_count": 1, "score": 0, "last_activity_date": 1435136830, "creation_date": 1435136326, "question_id": 31022122, "link": "https://stackoverflow.com/questions/31022122/whats-the-easiest-way-to-prevent-null-chars-from-terminating-my-string", "title": "What&#39;s the easiest way to prevent null chars from terminating my string?", "body": "<p>I'm currently working on some C code to forward CAN messages via bluetooth and vice versa (\u00b5C stuff). The problem is that my paired bluetooth device uses '00' as a command and my bluetooth library is using a char[] to buffer the string when receiving from BT. This inevitably terminates the string, because it interprets the command as a NULL character. Also, any empty data byte in a CAN frame would cause the same problem.</p>\n\n<p>I was able to solve the problem when going from CAN to BT by storing the CAN message in a byte array and sending a series of bytes followed by a CR to the BT module, but the other way round isn't that easy, as the BT library is using all sorts of string based commands.</p>\n\n<p>Is there an easy way to prevent the NULL to cause an unwanted termination or do I have to rewrite the whole library to a suitable data type, and which one would work best in this case? Any ideas appreciated!</p>\n"}, {"tags": ["c++", "c", "simulation", "omnet++", "inet"], "answers": [{"tags": [], "owner": {"reputation": 4650, "user_id": 709234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Buqkn.jpg?s=128&g=1", "display_name": "Rudi", "link": "https://stackoverflow.com/users/709234/rudi"}, "is_accepted": false, "score": 0, "last_activity_date": 1435151943, "creation_date": 1435151943, "answer_id": 31027729, "question_id": 31022081, "link": "https://stackoverflow.com/questions/31022081/omnet-inet-error-while-using-3rd-party-tool/31027729#31027729", "title": "OMNeT++ &amp; INET: Error while using 3rd Party-Tool", "body": "<p>I suspect that the build fails and the library is not built at all. Check the output of the build console for errors, but before building make sure that you run 'make makefiles' from the command line (or use the IDE to build  INET) otherwise the .cc files will not be included in the build and the final linking will fail.</p>\n"}], "owner": {"reputation": 35, "user_id": 2460487, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/65eebf11061a8770fbe02f57513f3bf8?s=128&d=identicon&r=PG", "display_name": "Phil", "link": "https://stackoverflow.com/users/2460487/phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1435339964, "creation_date": 1435136208, "last_edit_date": 1435339964, "question_id": 31022081, "link": "https://stackoverflow.com/questions/31022081/omnet-inet-error-while-using-3rd-party-tool", "title": "OMNeT++ &amp; INET: Error while using 3rd Party-Tool", "body": "<p>I'm using OMNet++ &amp; INET in order to simulate an UDP-Network. \nI changed the <code>UDPBurst</code> example a little bit:</p>\n\n<ul>\n<li>Changed <code>Router</code> to an <code>etherSwitch</code></li>\n<li>Using <code>ThruputMeteringChannel</code> as connection</li>\n</ul>\n\n<p>Now I change the <code>ThruputMeteringChannel.cc</code>, so I can draw charts:</p>\n\n<ul>\n<li>copping files (<code>.c</code> &amp; <code>.h</code>) from (<a href=\"http://kuepper.userweb.mwn.de/software.htm\" rel=\"nofollow\">http://kuepper.userweb.mwn.de/software.htm</a>)</li>\n<li>Adding import of <code>chart.h</code> to <code>ThruputMeteringChannel.cc</code> </li>\n<li>adding the Example 1 from the Chart program to the <code>initialize()</code> method</li>\n</ul>\n\n<p>When starting the <code>.ini</code> file I get an error in the graphical runtime environment:</p>\n\n<blockquote>\n  <p>Error in module (cModule) UDPBurst.host[0] (id=2) during network\n  setup: Error evaluating parameter 'tcpType': None of the following NED\n  types are available TCP, TCP_IwIP,TCP_NSC,TCP_Node.</p>\n</blockquote>\n\n<p>In my console is no creating \"shared libraries\" while building.\nBut only when I use the <code>chart.h</code></p>\n\n<p>PS: I'm working with Linux (Ubuntu 12.04) on a VM.</p>\n"}, {"tags": ["c", "visual-studio-2010", "floating-point", "language-lawyer"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1435136691, "post_id": 31022076, "comment_id": 50069396, "body": "Try <code>angle = (acosf)(...);</code>. The extra parenthesis around the function name disable macro expansion.  ... even better: get rid of <code>float</code> and do everything in <code>double</code>."}, {"owner": {"reputation": 6300, "user_id": 2331592, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/befb1bd6b66c01fed1d2384a405e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "vlad_tepesch", "link": "https://stackoverflow.com/users/2331592/vlad-tepesch"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1435139231, "post_id": 31022076, "comment_id": 50071155, "body": "getting rid of floats is not an option since we use them on purpose. our target architecture only supports 32bit floats"}, {"owner": {"reputation": 6300, "user_id": 2331592, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/befb1bd6b66c01fed1d2384a405e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "vlad_tepesch", "link": "https://stackoverflow.com/users/2331592/vlad-tepesch"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1435139873, "post_id": 31022076, "comment_id": 50071609, "body": "@pmg putting the <code>acosf</code> in parentheses of course does not help, since it is the way the stdlib implements the <code>acosf</code>. putting it in parentheses results in compiler errors."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1435140394, "post_id": 31022076, "comment_id": 50071992, "body": "See <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.1.4\" rel=\"nofollow noreferrer\">C11 7.1.4</a>: &quot;... Any macro definition of a function can be suppressed locally ...&quot;. Your compiler is not Standards compliant :("}, {"owner": {"reputation": 6300, "user_id": 2331592, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/befb1bd6b66c01fed1d2384a405e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "vlad_tepesch", "link": "https://stackoverflow.com/users/2331592/vlad-tepesch"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1435149254, "post_id": 31022076, "comment_id": 50077952, "body": "@pmg i did not get your point. The stdlib has to implement a set of defined functions. if it implements them as macro aliases to other functions or not should not matter as long they behave like specified. Sure if they <code>#define</code> it and you force the suppression of the macro-substitution of that call - why should this be a compiler issue.  The issue in my opinion is, that the macro does not enforce the truncation of the parameter into a float. Like <code>#define acosf(x)    ((float)acos((float)(x)))</code>"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1435152970, "post_id": 31022076, "comment_id": 50080723, "body": "My point is that a standard compliant compiler has to have <code>acosf()</code> properly defined (so that you can use its address). The macro does not do any argument conversion; the function call converts arguments to the proper type. <code>acosf(1.00000000000000000001)</code> when called as a function converts the <code>double</code> argument to <code>float</code> type."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1435153107, "post_id": 31022076, "comment_id": 50080843, "body": "Maybe you could ask your compiler implementors (file a Microsoft bug report) to redefine the macro as <code>#define acosf(x) ((float)acos((double)((float)(x))))</code>."}, {"owner": {"reputation": 97003, "user_id": 142434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGcat.jpg?s=128&g=1", "display_name": "Stephen Canon", "link": "https://stackoverflow.com/users/142434/stephen-canon"}, "edited": false, "score": 0, "creation_date": 1435177349, "post_id": 31022076, "comment_id": 50096793, "body": "&quot;C floating point expressions are always promoted to double&quot; -- No, they are not.  This rules for evaluating float expressions depend on the value of FLT_EVAL_METHOD, and vary between compilers.  Broadly speaking, I agree with you that <code>acosf(x)</code> should be defined as <code>(float)acos((double)(float)x)</code> if they aren&#39;t going to have an actual function, but Visual Studio has historically not shown the slightest hint of being concerned with C standard conformance."}], "owner": {"reputation": 6300, "user_id": 2331592, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/befb1bd6b66c01fed1d2384a405e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "vlad_tepesch", "link": "https://stackoverflow.com/users/2331592/vlad-tepesch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1435136190, "creation_date": 1435136190, "question_id": 31022076, "link": "https://stackoverflow.com/questions/31022076/strange-implementation-of-acosf", "title": "strange implementation of acosf", "body": "<p>I stumbled about some strange problem:</p>\n\n<p>I got floating point exceptions (we enabled them explicitly and used /fp:strict)in acosf:</p>\n\n<p>we have 2 32bit floating point vectors and want to calculate the angle.</p>\n\n<pre><code>float32 len1 = Vec_Len(vec1);\nfloat32 len2 = Vec_Len(vec2);\nfloat32 angle = acosf( (vec1.x * vec2.x + vec1.y * vec2.y)/(len1*len2) );\n</code></pre>\n\n<p>Quite straight forward.\nThe Problem that occurred was an invalid Op exception.\nChecking the Values of the calulation revealed that the expression in the <code>acosf</code> call evaluates to a <code>double</code> (remember: in C floating point expressions are always promoted to double) value slightly greater than <code>1.0</code> (welcome to the world of floating point math).\nSo far so good - <em>BUT</em> the expression rounded to float32 precision is exactly <code>1.0f</code> (i also checked the binary representation).</p>\n\n<p>So why the hell would trigger <code>acosf</code> this exception? Should not the expression be truncated/rounded/what ever to float32 on parameter passing?</p>\n\n<p>After short thinking: i found this in the \"Microsoft Visual Studio 10.0\\VC\\include\\math.h\":</p>\n\n<pre><code>#define acosf(x)    ((float)acos((double)(x)))\n</code></pre>\n\n<p>this is one of the definitions in the file but it is the one that seems to be active since i can see this in the preprocessed file.</p>\n\n<p>Is this 'legal'?\nIt seems to me that this violates the \"as-if\" rule.</p>\n\n<p>This definition (that is also in the file) seems more appropriate to me</p>\n\n<pre><code>inline float acosf(_In_ float _X)\n        {return ((float)acos((double)_X)); }\n</code></pre>\n"}, {"tags": ["c", "select", "client", "server"], "comments": [{"owner": {"reputation": 3970, "user_id": 1151654, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc251d76cd38dae9e0d62360facbf790?s=128&d=identicon&r=PG", "display_name": "Eregrith", "link": "https://stackoverflow.com/users/1151654/eregrith"}, "edited": false, "score": 1, "creation_date": 1435135815, "post_id": 31021888, "comment_id": 50068845, "body": "Sharing your research helps everyone. Tell us what you&#39;ve tried and why it didn\u2019t meet your needs. This demonstrates that you\u2019ve taken the time to try to help yourself, it saves us from reiterating obvious answers, and most of all it helps you get a more specific and relevant answer! Also see <a href=\"http://stackoverflow.com/questions/how-to-ask\">how to ask</a>"}, {"owner": {"reputation": 795, "user_id": 2894160, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/s4NXY.jpg?s=128&g=1", "display_name": "Jimmy James", "link": "https://stackoverflow.com/users/2894160/jimmy-james"}, "reply_to_user": {"reputation": 3970, "user_id": 1151654, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc251d76cd38dae9e0d62360facbf790?s=128&d=identicon&r=PG", "display_name": "Eregrith", "link": "https://stackoverflow.com/users/1151654/eregrith"}, "edited": false, "score": 0, "creation_date": 1435136872, "post_id": 31021888, "comment_id": 50069521, "body": "Yes of course, sorry i&#39;m new .. So i&#39;ve put a little code to explain more"}, {"owner": {"reputation": 3970, "user_id": 1151654, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc251d76cd38dae9e0d62360facbf790?s=128&d=identicon&r=PG", "display_name": "Eregrith", "link": "https://stackoverflow.com/users/1151654/eregrith"}, "edited": false, "score": 0, "creation_date": 1435136946, "post_id": 31021888, "comment_id": 50069568, "body": "It&#39;s ok to be new ;)"}, {"owner": {"reputation": 3970, "user_id": 1151654, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc251d76cd38dae9e0d62360facbf790?s=128&d=identicon&r=PG", "display_name": "Eregrith", "link": "https://stackoverflow.com/users/1151654/eregrith"}, "edited": false, "score": 0, "creation_date": 1435137026, "post_id": 31021888, "comment_id": 50069626, "body": "I would swear I know what school project you&#39;re currently working on just by looking at your code XD. This smells like epitech and the zappy project"}, {"owner": {"reputation": 795, "user_id": 2894160, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/s4NXY.jpg?s=128&g=1", "display_name": "Jimmy James", "link": "https://stackoverflow.com/users/2894160/jimmy-james"}, "reply_to_user": {"reputation": 3970, "user_id": 1151654, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc251d76cd38dae9e0d62360facbf790?s=128&d=identicon&r=PG", "display_name": "Eregrith", "link": "https://stackoverflow.com/users/1151654/eregrith"}, "edited": false, "score": 0, "creation_date": 1435137374, "post_id": 31021888, "comment_id": 50069846, "body": "didn&#39;t have 20 reputations .."}], "answers": [{"tags": [], "owner": {"reputation": 3970, "user_id": 1151654, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc251d76cd38dae9e0d62360facbf790?s=128&d=identicon&r=PG", "display_name": "Eregrith", "link": "https://stackoverflow.com/users/1151654/eregrith"}, "is_accepted": true, "score": 0, "last_activity_date": 1435137625, "creation_date": 1435137625, "answer_id": 31022612, "question_id": 31021888, "link": "https://stackoverflow.com/questions/31021888/block-a-client-without-blocking-others-in-select/31022612#31022612", "title": "Block a client without blocking others in Select", "body": "<p>You could manage client-states in your list of clients. If the client state is 'wait', do not answer it (or better : answer \"you must wait for x\" or some useful feedback). All the clients will be able to send requests and only the one in the correct states will be processed.</p>\n\n<p>Do not forget to reset the client's state when your work is done on its request.</p>\n"}], "owner": {"reputation": 795, "user_id": 2894160, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/s4NXY.jpg?s=128&g=1", "display_name": "Jimmy James", "link": "https://stackoverflow.com/users/2894160/jimmy-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 31022612, "answer_count": 1, "score": 1, "last_activity_date": 1435137625, "creation_date": 1435135641, "last_edit_date": 1435136829, "question_id": 31021888, "link": "https://stackoverflow.com/questions/31021888/block-a-client-without-blocking-others-in-select", "title": "Block a client without blocking others in Select", "body": "<p>I have to create a program with two parts : Client / Server.</p>\n\n<p>I receive commands from different clients and I want to put the client waiting during the command is executed, but, the other clients must be able to send command to the server</p>\n\n<p>e.g :\nC1 (for client 1) and C2 (for client 2)</p>\n\n<p>C1 send command -> server receive it and execute it and he can't accept command from C1 for x seconds but he can accept command from the C2.</p>\n\n<p>How can I do it with select function withous threads.</p>\n\n<p>This is my current code from the server :</p>\n\n<pre><code>void            client_ask(t_listplayer *list, t_network *net) {\n  char          *buffer = xmalloc(sizeof(char) * 200);\n  int           rd = 0;\n\n  memset(buffer, 0, 200);\n  while (list != NULL) {\n      if (FD_ISSET(list-&gt;player-&gt;fd, &amp;net-&gt;readfds)) {\n          if ((rd = xread(list-&gt;player-&gt;fd, buffer, 200)) &gt; 0) {\n              buffer[rd - 1] = '\\0';\n              printf(\"Client n\u00b0: %d asking : [%s]\\n\", list-&gt;player-&gt;fd, buffer);\n              sleep(3); // This one put all the server in waiting\n              memset(buffer, 0, 200);\n            } else {\n              close(list-&gt;player-&gt;fd);\n              printf(\"Client n\u00b0: %d has just disconnected\", list-&gt;player-&gt;fd);\n            }\n        }\n      list = list-&gt;next;\n    }\n}\n</code></pre>\n\n<p>So, I've make many research .. I've heard things about timeout but i don't know how to do this.\nThanks</p>\n"}, {"tags": ["c", "compound-literals"], "comments": [{"owner": {"reputation": 5504, "user_id": 2734224, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/3icKz.jpg?s=128&g=1", "display_name": "lord.garbage", "link": "https://stackoverflow.com/users/2734224/lord-garbage"}, "edited": false, "score": 0, "creation_date": 1435135668, "post_id": 31021874, "comment_id": 50068755, "body": "<a href=\"https://gcc.gnu.org/onlinedocs/gcc/Compound-Literals.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/Compound-Literals.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5504, "user_id": 2734224, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/3icKz.jpg?s=128&g=1", "display_name": "lord.garbage", "link": "https://stackoverflow.com/users/2734224/lord-garbage"}, "edited": false, "score": 1, "creation_date": 1435140733, "post_id": 31023740, "comment_id": 50072219, "body": "&quot;The fundamental difference between compound literal and cast operator is that the latter is a lvalue [...]&quot;. Shouldn&#39;t this be &quot;the former&quot;?"}, {"owner": {"reputation": 5504, "user_id": 2734224, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/3icKz.jpg?s=128&g=1", "display_name": "lord.garbage", "link": "https://stackoverflow.com/users/2734224/lord-garbage"}, "edited": false, "score": 0, "creation_date": 1435142341, "post_id": 31023740, "comment_id": 50073244, "body": "Ok, so there is nothing special about using compound literals to initialize scalar pointers?"}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "reply_to_user": {"reputation": 5504, "user_id": 2734224, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/3icKz.jpg?s=128&g=1", "display_name": "lord.garbage", "link": "https://stackoverflow.com/users/2734224/lord-garbage"}, "edited": false, "score": 0, "creation_date": 1435143840, "post_id": 31023740, "comment_id": 50074250, "body": "@brauner: No, It&#39;s analogous to as you initialize anonymous array with it."}], "tags": [], "owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "is_accepted": true, "score": 3, "last_activity_date": 1435140821, "last_edit_date": 1435140821, "creation_date": 1435140536, "answer_id": 31023740, "question_id": 31021874, "link": "https://stackoverflow.com/questions/31021874/compound-literals-for-scalar-types/31023740#31023740", "title": "Compound literals for scalar types", "body": "<p>By definition a compound literal does not consist of <code>&amp;</code> address-of operator. From N1570 <code>6.5.2.5/p3</code> <em>Compound literals</em>:</p>\n\n<blockquote>\n  <p>A postfix expression that consists of a parenthesized type name\n  followed by a brace-enclosed list of initializers is a <em>compound\n  literal</em>.</p>\n</blockquote>\n\n<p>Now, their statement:</p>\n\n<blockquote>\n  <p>Compound literals for scalar types and union types are also allowed,\n  but then the compound literal is equivalent to a cast.</p>\n</blockquote>\n\n<p>is rather wrong if I am reading it correctly. The fundamental difference between compound literal and cast operator is that the former is a <em>lvalue</em>, as by N1570 <code>6.5.2.5/p4</code> (emphasis mine):</p>\n\n<blockquote>\n  <p>Otherwise (when the type name specifies an object type), the type of\n  the compound literal is that specified by the type name. In either\n  case, the <strong>result is an lvalue</strong>.</p>\n</blockquote>\n\n<p>while the latter is not, <code>6.5.4/p5</code> <em>Cast operators</em> (emphasis mine):</p>\n\n<blockquote>\n  <p>Preceding an expression by a parenthesized type name converts the\n  value of the expression to the named type. This construction is called\n  a cast<sup>.104)</sup></p>\n  \n  <p>104) A cast <strong>does not yield an lvalue</strong>. Thus, a cast to a qualified type\n  has the same effect as a cast to theunqualified version of the type.</p>\n</blockquote>\n"}], "owner": {"reputation": 5504, "user_id": 2734224, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/3icKz.jpg?s=128&g=1", "display_name": "lord.garbage", "link": "https://stackoverflow.com/users/2734224/lord-garbage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 31023740, "answer_count": 1, "score": 3, "last_activity_date": 1435140821, "creation_date": 1435135593, "question_id": 31021874, "link": "https://stackoverflow.com/questions/31021874/compound-literals-for-scalar-types", "title": "Compound literals for scalar types", "body": "<p>Since <code>c99</code> compound literals can be used to e.g. initialize pointers:</p>\n\n<pre><code>int *p = (int []) {1, 2, 3, 4};\n</code></pre>\n\n<p>while this is usually used for <code>struct</code>s it can be used to initialize anonymous arrays as well (see example). But if I understood this correctly initializing a scalar pointer like this:</p>\n\n<pre><code>int *p = &amp;(int) {4};\n</code></pre>\n\n<p>is also valid. What I find confusing is the statement on the <code>gcc</code> site that \u201cCompound literals for scalar types and union types are also allowed, but then the compound literal is equivalent to a cast.\u201d Do they simply mean that using the address-of operator <code>&amp;</code> in front of an anonymous scalar is a form of casting?</p>\n"}, {"tags": ["c++", "c", "computer-science"], "comments": [{"owner": {"reputation": 39446, "user_id": 4301306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a1461d0104809c90e2a252a2d4b0ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Wintermute", "link": "https://stackoverflow.com/users/4301306/wintermute"}, "edited": false, "score": 4, "creation_date": 1435136241, "post_id": 31021801, "comment_id": 50069096, "body": "It looks like it&#39;ll take ages to complete (so many prime number tests...). You should probably try a different approach. Hint: If a number x can be factorised as y * z, then the largest prime factor of x is the larger of the largest prime factors of y and z."}, {"owner": {"reputation": 3694, "user_id": 3374591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24276eb856ed7cbcb5f02d6bacf29ca1?s=128&d=identicon&r=PG", "display_name": "Arnon Zilca", "link": "https://stackoverflow.com/users/3374591/arnon-zilca"}, "reply_to_user": {"reputation": 39446, "user_id": 4301306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a1461d0104809c90e2a252a2d4b0ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Wintermute", "link": "https://stackoverflow.com/users/4301306/wintermute"}, "edited": false, "score": 0, "creation_date": 1435136912, "post_id": 31021801, "comment_id": 50069548, "body": "@Wintermute is correct. I ran your code 10 minutes ago (still running), clogging a core. btw, you can also start from sqrt(num) down instead of from 1 up - since you&#39;re looking for <b>largest</b> prime factor - and break the non prime factors as Wintermute suggests."}, {"owner": {"reputation": 39446, "user_id": 4301306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a1461d0104809c90e2a252a2d4b0ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Wintermute", "link": "https://stackoverflow.com/users/4301306/wintermute"}, "edited": false, "score": 0, "creation_date": 1435137418, "post_id": 31021801, "comment_id": 50069875, "body": "I&#39;d still run up from 1 (well, from 2). The point is: When you find a factor x that divides num, you don&#39;t have to run up to num anymore but only to num / x. The largest prime factor is going to be either the largest prime factor of x or the largest prime factor of num / x. More hints: This can be done in a way that ensures that x is prime. The smallest factor &gt; 1 of any natural number is prime (if it exists)."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1435137774, "post_id": 31021801, "comment_id": 50070150, "body": "You&#39;ve done a very literal implementation of &quot;a prime number is a number with only two divisors, 1 and itself&quot;. You don&#39;t need to find <i>all</i> the divisors to determine whether there are any more than those - you only need to find one of them."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1435143780, "post_id": 31021801, "comment_id": 50074214, "body": "&quot;Won&#39;t work&quot; - what do you get and what did you expect?"}], "answers": [{"comments": [{"owner": {"reputation": 39446, "user_id": 4301306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a1461d0104809c90e2a252a2d4b0ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Wintermute", "link": "https://stackoverflow.com/users/4301306/wintermute"}, "edited": false, "score": 2, "creation_date": 1435136554, "post_id": 31021979, "comment_id": 50069299, "body": "That&#39;s not true in C++ (see [lex.icon]/2; a decimal integer literal without a suffix has the smallest signed integer type into which its value fits)."}], "tags": [], "owner": {"reputation": 1434, "user_id": 4991093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8bda2dd45616408b698ae852a24c4f1d?s=128&d=identicon&r=PG&f=1", "display_name": "Furhan S.", "link": "https://stackoverflow.com/users/4991093/furhan-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1435136152, "last_edit_date": 1435136152, "creation_date": 1435135886, "answer_id": 31021979, "question_id": 31021801, "link": "https://stackoverflow.com/questions/31021801/why-is-it-that-some-user-defined-c-functions-wont-work-with-big-numbers/31021979#31021979", "title": "Why is it that some user defined C++ functions won&#39;t work with big numbers?", "body": "<p>Try invoking the function with the following code:</p>\n\n<pre><code>cout&lt;&lt;largest_prime_factor(600851475143LL)&lt;&lt;endl; \n</code></pre>\n\n<p>If you simply mention the literal 600851475143, it wont be recognized as long long. you have to explicitly tell the compiler that treat the literal as long long by appending 'LL' at the end.</p>\n"}], "owner": {"reputation": 11, "user_id": 4985676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/882a8e9f4777eabe20a2ab91f01f6431?s=128&d=identicon&r=PG&f=1", "display_name": "Lee Ivan", "link": "https://stackoverflow.com/users/4985676/lee-ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1435136152, "creation_date": 1435135411, "last_edit_date": 1435135984, "question_id": 31021801, "link": "https://stackoverflow.com/questions/31021801/why-is-it-that-some-user-defined-c-functions-wont-work-with-big-numbers", "title": "Why is it that some user defined C++ functions won&#39;t work with big numbers?", "body": "<p>Here's an example:</p>\n\n<p>This function won't work with big numbers such as 900000000 but will work with smaller numbers like 800</p>\n\n<p>code:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt; using namespace std;\n\n\nlong long int largest_prime_factor(long long int num){\n    vector&lt;long long int &gt;factors;\n    vector&lt;long long int&gt;primes;\n    for(long long int i=1;i&lt;=num;i++){\n        if(num%i==0){\n            for(long long int a =1;a&lt;=i;a++){\n                if(i%a==0){\n                    factors.push_back(a);\n                }\n\n            }\n            if( (factors.size() == 2) &amp;&amp; (factors[0] ==1)){\n                primes.push_back(i);\n            }\n            factors.clear();\n        }\n    }\n    reverse(primes.begin(),primes.end());\n    return primes[0]; }\n\nint main(){\n    cout&lt;&lt;largest_prime_factor(600851475143)&lt;&lt;endl;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "c-preprocessor"], "comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 1, "creation_date": 1435135539, "post_id": 31021711, "comment_id": 50068671, "body": "It&#39;s worth noting: the C standard says nothing about tools that stop halfway through the compilation process."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 2, "creation_date": 1435135690, "post_id": 31021711, "comment_id": 50068769, "body": "Related (possible dup): <a href=\"http://stackoverflow.com/questions/30813619/cpp-expansion-of-macro-with-no-token-string/30813841#30813841\">cpp expansion of macro with no token-string</a>"}, {"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 0, "creation_date": 1435140264, "post_id": 31021711, "comment_id": 50071905, "body": "Note that very often spacing does not matter in C or C++."}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 4, "creation_date": 1435136103, "post_id": 31021893, "comment_id": 50069011, "body": "@BlueMoon there does not need to be a separate preprocessor at all, so it doesn&#39;t have to do anything.   The preprocessing stages of translation are just specified as producing a list of tokens, not producing a file. The &quot;preprocessor output&quot; is an intermediate stage between the source file and the executable."}, {"owner": {"reputation": 6240, "user_id": 488700, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/620a68b8a42a5af384929133de068c63?s=128&d=identicon&r=PG", "display_name": "Artur", "link": "https://stackoverflow.com/users/488700/artur"}, "edited": false, "score": 0, "creation_date": 1435141759, "post_id": 31021893, "comment_id": 50072837, "body": "@Matt: I would rephrase your answer to sth like (imho better): &quot;The goal of preprocessing is to transform the source file into a list of tokens which then become compiler&#39;s input. In your case (after tokenization) the list of tokens would look like this&quot; and would not say &#39;booboo()&#39; is one token but 3 tokens. The rest is clear and nice."}, {"owner": {"reputation": 6240, "user_id": 488700, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/620a68b8a42a5af384929133de068c63?s=128&d=identicon&r=PG", "display_name": "Artur", "link": "https://stackoverflow.com/users/488700/artur"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 1, "creation_date": 1435142166, "post_id": 31021893, "comment_id": 50073136, "body": "@Blue Moon: &quot;there does not need to be a separate preprocessor at all&quot; is sth different than &quot;It&#39;s true there doesn&#39;t &#39;need&#39; to be a processor&quot;. What Matt says is that compiler does not need to see preprocessor&#39;s output the way it should be presented to us (humans). Compiler needs tokens only, no spaces. Preprocessor&#39;s feature that allows it to output results of its work is solely for humans so that we could debug ... and have less head scratching ;-)"}, {"owner": {"reputation": 6240, "user_id": 488700, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/620a68b8a42a5af384929133de068c63?s=128&d=identicon&r=PG", "display_name": "Artur", "link": "https://stackoverflow.com/users/488700/artur"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1435143920, "post_id": 31021893, "comment_id": 50074299, "body": "@Blue Moon: &quot;why do you even bother looking at &#39;some preprocessed&#39; output anyway?&quot; - to become wiser than yesterday"}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 6, "last_activity_date": 1435136033, "last_edit_date": 1435136033, "creation_date": 1435135669, "answer_id": 31021893, "question_id": 31021711, "link": "https://stackoverflow.com/questions/31021711/why-is-c-c-preprocessor-adding-a-space-here/31021893#31021893", "title": "Why is C/C++ preprocessor adding a space here?", "body": "<p>The result of preprocessing is to transform the source file into a list of tokens. In your case the list of tokens would look like, after tokenization:</p>\n\n<pre><code>....\nbooboo()\nbbb\n....\n</code></pre>\n\n<p>and then after macro replacement:</p>\n\n<pre><code>....\naaa\nbbb\n....\n</code></pre>\n\n<p>Then the compiler translates the list of tokens into an executable. </p>\n\n<p>The whitespace you are seeing is just an implementation detail that your compiler etc. has chosen to lay out the preprocessing tokens when displaying an intermediate result to you.   The standards say nothing about any intermediate processing files. It is not required that there be a separate program to do preprocessing either.</p>\n"}, {"comments": [{"owner": {"reputation": 25326, "user_id": 356292, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/eba34d6d8a4fde0b97505cad1ab37316?s=128&d=identicon&r=PG", "display_name": "Eiko", "link": "https://stackoverflow.com/users/356292/eiko"}, "edited": false, "score": 3, "creation_date": 1435139874, "post_id": 31022796, "comment_id": 50071611, "body": "This would concatenate different tokens, which does not happen."}, {"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 2, "creation_date": 1435140301, "post_id": 31022796, "comment_id": 50071935, "body": "There is a separate directive <code>##</code> for concatenating tokens."}], "tags": [], "owner": {"reputation": 9, "user_id": 5043919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e91088c364599c531f49f375609656?s=128&d=identicon&r=PG", "display_name": "Syamala Tadigadapa", "link": "https://stackoverflow.com/users/5043919/syamala-tadigadapa"}, "is_accepted": false, "score": -1, "last_activity_date": 1435138134, "last_edit_date": 1592644375, "creation_date": 1435138134, "answer_id": 31022796, "question_id": 31021711, "link": "https://stackoverflow.com/questions/31021711/why-is-c-c-preprocessor-adding-a-space-here/31022796#31022796", "title": "Why is C/C++ preprocessor adding a space here?", "body": "<p>I wrote an ANSI C compiler myself in early 90's. As far as I remember, a comment token /<em>......</em>/ should be replaced by a single white-space. Macros do text replacement, in place. Not necessary that the tokens which result from text replacement of such macro expansion(s) be legal C language tokens. When a macro is defined as text 'aaa' it is just that text 'aaa' that makes its way into the input stream. C's parser may or may not see valid tokens as a result of that!</p>\n<p>Hence, given:</p>\n<h1>define booboo() aaa</h1>\n<p>Expanding booboo()bbb should result in text aaabbb</p>\n<p>What does that aaabbb mean is up to the user. But that aaabbb will not be preprocessed even if happens to be the name of a macro. That is for sure. But aaabbb could be a user identifier - no issues there.</p>\n"}], "owner": {"reputation": 6240, "user_id": 488700, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/620a68b8a42a5af384929133de068c63?s=128&d=identicon&r=PG", "display_name": "Artur", "link": "https://stackoverflow.com/users/488700/artur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 979, "favorite_count": 0, "accepted_answer_id": 31021893, "answer_count": 2, "score": 8, "last_activity_date": 1435138134, "creation_date": 1435135144, "last_edit_date": 1435135321, "question_id": 31021711, "link": "https://stackoverflow.com/questions/31021711/why-is-c-c-preprocessor-adding-a-space-here", "title": "Why is C/C++ preprocessor adding a space here?", "body": "<p>I have a tiny problem with a preprocessor that puzzles me and I cannot find any explanation to it in the documentation/preprocessor/language spec.</p>\n\n<pre><code>#define booboo() aaa\nbooboo()bbb\nbooboo().bbb\n</code></pre>\n\n<p>is preprocessed into:</p>\n\n<pre><code>aaa bbb   &lt;--- why is space added here\naaa.bbb\n</code></pre>\n\n<p>After handling trigraphs, continued lines and comments, preprocessor works on preprocessor directives and divides input into preprocessing tokens and whitespace. booboo's replacement list comprises one pp-token which is identifier 'aaa'. booboo()bbb is divided into pp-tokens: 'booboo', '(', ')', 'bbb'. Sequence of 'booboo', '(', ')' is recognised as functional macro invocation and it should be expanded to 'aaa' and imho in output should look like 'aaabbb'. I said look like since - to human - it would look like one token whereas compiler would get 2 tokens 'aaa' and 'bbb' since no '##' operator was used that allows pp-token concatenation. Why/what rule makes cpp (c preprocessor) place additional space between 'aaa' and 'bbb' when 'booboo().bbb' results in 'aaa.bbb' without space?</p>\n\n<p>Is this because cpp tries to make output (which is for humans mostly) unambinuous? Human is not able to tell that 'aaabbb' is composed from 2 tokens as it sees token's spelling only. Am I right? I've read C99 documentation about preprocessor and gcc's documentation for cpp. I see nothing about it.</p>\n\n<p>If I am right we have similar situation here:</p>\n\n<pre><code>#define baba() +\nbaba()+\nbaba()-\n</code></pre>\n\n<p>results in:</p>\n\n<pre><code>+ +\n+-\n</code></pre>\n\n<p>Otherwise (if '++' is the output) it would look to a human like '++' token but there would be 2 tokens '+' and '+'. Is it like with '##' operator that cpp checks if concatenation produces valid token but in shown cases wants to prevent human that concatenation was performed? '+-' is not ambiguous hence no space added</p>\n"}, {"tags": ["c", "unit-testing", "code-coverage", "white-box", "white-box-testing"], "comments": [{"owner": {"reputation": 10223, "user_id": 592182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fu0me.jpg?s=128&g=1", "display_name": "forsvarir", "link": "https://stackoverflow.com/users/592182/forsvarir"}, "edited": false, "score": 0, "creation_date": 1435134184, "post_id": 31021153, "comment_id": 50067873, "body": "I can&#39;t help but feel like it would be easier to understand what you&#39;re testing if your tests had meaningful names.  1,2,3,4,5 aren&#39;t exactly descriptive.."}, {"owner": {"reputation": 91, "user_id": 4665936, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5KO2neFwy80/AAAAAAAAAAI/AAAAAAAACYY/1OBQ6-z5vkc/photo.jpg?sz=128", "display_name": "venkatesh kambakana", "link": "https://stackoverflow.com/users/4665936/venkatesh-kambakana"}, "reply_to_user": {"reputation": 10223, "user_id": 592182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fu0me.jpg?s=128&g=1", "display_name": "forsvarir", "link": "https://stackoverflow.com/users/592182/forsvarir"}, "edited": false, "score": 0, "creation_date": 1435134320, "post_id": 31021153, "comment_id": 50067947, "body": "ok sorry  I will edit"}, {"owner": {"reputation": 91, "user_id": 4665936, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5KO2neFwy80/AAAAAAAAAAI/AAAAAAAACYY/1OBQ6-z5vkc/photo.jpg?sz=128", "display_name": "venkatesh kambakana", "link": "https://stackoverflow.com/users/4665936/venkatesh-kambakana"}, "reply_to_user": {"reputation": 10223, "user_id": 592182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fu0me.jpg?s=128&g=1", "display_name": "forsvarir", "link": "https://stackoverflow.com/users/592182/forsvarir"}, "edited": false, "score": 0, "creation_date": 1435134715, "post_id": 31021153, "comment_id": 50068197, "body": "I have edited description"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 4665936, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5KO2neFwy80/AAAAAAAAAAI/AAAAAAAACYY/1OBQ6-z5vkc/photo.jpg?sz=128", "display_name": "venkatesh kambakana", "link": "https://stackoverflow.com/users/4665936/venkatesh-kambakana"}, "edited": false, "score": 0, "creation_date": 1435143751, "post_id": 31024337, "comment_id": 50074194, "body": "i have replaced with my condition with if (b&lt;10 &amp;&amp; b&gt;0 &amp;&amp; a!=1 &amp;&amp; a!=4) condition then its showing complete green color. and i also replace my condition with if((b&gt;0)&amp;&amp;(b&lt;10)&amp;&amp;(!((a == 1) || (a == 4)))) condition in this scenario (a==1) is showing as a red color."}], "tags": [], "owner": {"reputation": 10223, "user_id": 592182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fu0me.jpg?s=128&g=1", "display_name": "forsvarir", "link": "https://stackoverflow.com/users/592182/forsvarir"}, "is_accepted": false, "score": 0, "last_activity_date": 1435142207, "creation_date": 1435142207, "answer_id": 31024337, "question_id": 31021153, "link": "https://stackoverflow.com/questions/31021153/unit-testing-coverage-issue/31024337#31024337", "title": "unit testing Coverage Issue", "body": "<p>This is an example of why code coverage is a bit of a grey measure.  It's useful as an indicator, but it's not transparent.</p>\n\n<p>If I cut and paste the code into C# and run the same tests, I get 100% code coverage, so what's the difference?</p>\n\n<p>Depending on your compiler settings (you should be testing for coverage with all compiler optimisations turned off), the C compiler may actually be creating extra code in order to optimize certain flows, so even though in your logic the <code>(b&lt;10)</code> is only one check, it might result in two separate code instructions used by different flows through the rest of the logic.  How this is reported will depend on how your code coverage tool evaluates the coverage.</p>\n\n<p>If you <em>really</em> want to figure out what is causing the coverage level to drop, then you could try removing the different elements of the check in order to see what impact it has.  You could also try rearranging your formula.  All things being equal, you're better off having simple failures first in your logic because it reduces the number of flows through the code.  So in the following version, although the outcome should be the same, the code may be built differently due to the <code>&amp;&amp;</code>s being before the <code>||</code>.</p>\n\n<pre><code>if((b&gt;0)&amp;&amp;(b&lt;10)&amp;&amp;(!((a == 1) || (a == 4))))\n</code></pre>\n\n<p>You could also go as far as to remove the parenthesis to see if that improves the coverage.  The following returns the same results, whilst making it more explicit what you're testing.</p>\n\n<pre><code>if (b&lt;10 &amp;&amp; b&gt;0 &amp;&amp; a!=1 &amp;&amp; a!=4)\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 4665936, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5KO2neFwy80/AAAAAAAAAAI/AAAAAAAACYY/1OBQ6-z5vkc/photo.jpg?sz=128", "display_name": "venkatesh kambakana", "link": "https://stackoverflow.com/users/4665936/venkatesh-kambakana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 448, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1435737403, "creation_date": 1435133478, "last_edit_date": 1435737403, "question_id": 31021153, "link": "https://stackoverflow.com/questions/31021153/unit-testing-coverage-issue", "title": "unit testing Coverage Issue", "body": "<p>my ultimate goal is to cover the below code (making complete code green). I am using cantata tool. </p>\n\n<pre><code>#define CHECK1 ((a == 1) || (a == 4))\n\n\nvoid check_fun(int a, int b)\n{\n                if((!CHECK1)&amp;&amp;(b&gt;0)&amp;&amp;(b&lt;10))\n                {\n                }\n}\n</code></pre>\n\n<p>I have written 5 test cases as below </p>\n\n<pre><code>    void test_check_fun(int doIt){\nif (doIt) {\n    /* Test case data declarations */\n    int a;\n    int b;\n\n\n    START_TEST(\"test_check_fun_001\",\n               \"&lt;Entry condition: True check for if((!((a == 1) || (a == 4)))&amp;&amp;(b&gt;0)&amp;&amp;(b&lt;10)) ((!(F||F))&amp;&amp;(T)&amp;&amp;(T)) equalent to (T&amp;&amp;T&amp;&amp;T)&gt;\");\n\n        /* Expected Call Sequence  */\n        EXPECTED_CALLS(\"\");\n\n                /* Set global data */\n                initialise_global_data();\n                a = 3;\n                b = 5;\n\n                /* Set expected values for global data checks */\n                initialise_expected_global_data();\n\n            /* Call SUT */\n            check_fun(a, b);\n\n            /* Test case checks */\n            /* Checks on global data */\n            check_global_data();\n        END_CALLS();\n    END_TEST();\n\n        START_TEST(\"test_check_fun_002\",\n               \"&lt;Entry condition: False check for if((!((a == 1) || (a == 4)))&amp;&amp;(b&gt;0)&amp;&amp;(b&lt;10)) ((!(T||F))&amp;&amp;(T)&amp;&amp;(T)) equalent to (F&amp;&amp;T&amp;&amp;T)&gt;\");\n\n        /* Expected Call Sequence  */\n        EXPECTED_CALLS(\"\");\n\n                /* Set global data */\n                initialise_global_data();\n                a = 1;\n                b = 5;\n\n                /* Set expected values for global data checks */\n                initialise_expected_global_data();\n\n            /* Call SUT */\n            check_fun(a, b);\n\n            /* Test case checks */\n            /* Checks on global data */\n            check_global_data();\n        END_CALLS();\n    END_TEST();\n\n        START_TEST(\"test_check_fun_003\",\n               \"&lt;Entry condition: False check for if((!((a == 1) || (a == 4)))&amp;&amp;(b&gt;0)&amp;&amp;(b&lt;10)) ((!(F||T))&amp;&amp;(T)&amp;&amp;(T)) equalent to (F&amp;&amp;T&amp;&amp;T)&gt;\");\n\n        /* Expected Call Sequence  */\n        EXPECTED_CALLS(\"\");\n\n                /* Set global data */\n                initialise_global_data();\n                a = 4;\n                b = 5;\n\n                /* Set expected values for global data checks */\n                initialise_expected_global_data();\n\n            /* Call SUT */\n            check_fun(a, b);\n\n            /* Test case checks */\n            /* Checks on global data */\n            check_global_data();\n        END_CALLS();\n    END_TEST();\n\n        START_TEST(\"test_check_fun_004\",\n               \"&lt;Entry condition: False check for if((!((a == 1) || (a == 4)))&amp;&amp;(b&gt;0)&amp;&amp;(b&lt;10)) ((!(F||F))&amp;&amp;(F)&amp;&amp;(T)) equalent to (T&amp;&amp;F&amp;&amp;T)&gt;\");\n\n        /* Expected Call Sequence  */\n        EXPECTED_CALLS(\"\");\n\n                /* Set global data */\n                initialise_global_data();\n                a = 3;\n                b = -1;\n\n                /* Set expected values for global data checks */\n                initialise_expected_global_data();\n\n            /* Call SUT */\n            check_fun(a, b);\n\n            /* Test case checks */\n            /* Checks on global data */\n            check_global_data();\n        END_CALLS();\n    END_TEST();\n\n        START_TEST(\"test_check_fun_005\",\n               \"&lt;Entry condition: False check for if((!((a == 1) || (a == 4)))&amp;&amp;(b&gt;0)&amp;&amp;(b&lt;10)) ((!(F||F))&amp;&amp;(T)&amp;&amp;(F)) equalent to (T&amp;&amp;T&amp;&amp;F)&gt;\");\n\n        /* Expected Call Sequence  */\n        EXPECTED_CALLS(\"\");\n\n                /* Set global data */\n                initialise_global_data();\n                a = 3;\n                b = 11;\n\n                /* Set expected values for global data checks */\n                initialise_expected_global_data();\n\n            /* Call SUT */\n            check_fun(a, b);\n\n            /* Test case checks */\n            /* Checks on global data */\n            check_global_data();\n        END_CALLS();\n    END_TEST();\n}}\n</code></pre>\n\n<p>and result is showing as </p>\n\n<pre><code>===========================================================================\n= Cantata Test Harness v6.2                                               =\n= (c) 2012 QA Systems GmbH                                                =\n=-------------------------------------------------------------------------=\n= Test Description: check                                                 =\n=         Log File: test_check.ctr                                        =\n=     Test Started: Wed Jun 24 12:10:56 2015                              =\n===========================================================================\n===========================================================================\n= Test Finished: Wed Jun 24 12:10:56 2015                                 =\n=-------------------------------------------------------------------------=\n= Test                 Script  Checks  Checks  Checks  Call Seq     TEST  =\n= Case                 Errors  Failed  Passed  Warned  Failures    RESULT =\n=-------------------------------------------------------------------------=\n= test_check_fun_001        0       0       0       3         0      PASS =\n= test_check_fun_002        0       0       0       3         0      PASS =\n= test_check_fun_003        0       0       0       3         0      PASS =\n= test_check_fun_004        0       0       0       3         0      PASS =\n= test_check_fun_005        0       0       0       3         0      PASS =\n= Other                     0       0       4       0         0      PASS =\n=-------------------------------------------------------------------------=\n= TOTALS                    0       0       4      15         0      PASS =\n===========================================================================\n</code></pre>\n\n<p>my problem is some of the code is not showing in green. so please tell me what test cases I have missed to cover below condition</p>\n\n<pre><code>if((!((a == 1) || (a == 4)))&amp;&amp;(b&gt;0)&amp;&amp;(b&lt;10))\n</code></pre>\n\n<p>please help me in this. thanks in advance.</p>\n"}, {"tags": ["c", "pointers", "char", "compiler-warnings", "command-line-arguments"], "comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1435134327, "post_id": 31020424, "comment_id": 50067951, "body": "Provided <code>argv[i]</code> is valid, <code>(int) *argv[i]</code> should work just fine (<code>argv</code> is an array of <code>char *</code>, so <code>*argv[i]</code> dereferences the pointer at <code>argv[i]</code>, effectively casting the first char to an int (which is legal in C). a <code>char</code> is always smaller than an int, so it can be promoted to <code>int</code>"}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1435131949, "last_edit_date": 1435131949, "creation_date": 1435131294, "answer_id": 31020463, "question_id": 31020424, "link": "https://stackoverflow.com/questions/31020424/c-programming-print-ascii-value-of-char/31020463#31020463", "title": "c programming print ascii value of char*", "body": "<pre><code>    printf(\"i is %d argv[i] %d\\n\", i, argv[i]);\n</code></pre>\n\n<p>is the problem causing line. Using incorrect format specifier is <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\"><em>undefined behaviour</em></a> in C.</p>\n\n<p><code>argv</code> is of type <code>char**</code> but <code>%d</code> format specifier expects an <code>int</code>. So to print the ascii values of arguments, you'll need a nested loop over <code>argv</code>.</p>\n\n<pre><code>    for(j=1;j&lt;argc; j++) {\n       for(i=0;argv[j][i];i++) {\n          printf(\"i is %d argv[i] %d\\n\", j, argv[j][i]);\n       }\n    }\n</code></pre>\n\n<p>Note that your loop condition is not correct. You only have <code>strlen(argv[j])</code> characters for each argument. So you can't arbitrarily print for <code>100</code> chars.</p>\n\n<p>Move these printf statements </p>\n\n<pre><code>printf(\"argv[0] is %s! \\n\",argv[0]);\nprintf(\"argv[1] is %s! \\n\",argv[1]);\nprintf(\"argv[2] is %s! \\n\",argv[2]);\nprintf(\"argv[3] is %s! \\n\",argv[3]);\n</code></pre>\n\n<p>below the arguments checking so that you would only print them <em>after</em> arguments checking. Otherwise, you might end up accessing arguments that are not there if fewer arguments are passed.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1435131600, "creation_date": 1435131600, "answer_id": 31020566, "question_id": 31020424, "link": "https://stackoverflow.com/questions/31020424/c-programming-print-ascii-value-of-char/31020566#31020566", "title": "c programming print ascii value of char*", "body": "<ul>\n<li><p><strong>Point 1:</strong> Don't use <code>argv[n]</code> directly until you have checked for <code>argc &gt; n</code>. This also includes unchecked loops like</p>\n\n<pre><code>for(i = 1; i &lt; 100; i++)\n</code></pre>\n\n<p>you'll end up accessing invalid memory after <code>i</code> gets equal to <code>argc</code>.</p></li>\n<li><p><strong>Point 2:</strong> <code>argv[n]</code> is a null-terminated array or <em>string</em> (for valid cases), by default. You need <code>%s</code> format specifier to print that.</p>\n\n<p>That is, a command line <code>A</code> as the first argument to <code>a.out</code> is represented as <code>\"A\"</code> as <code>argv[1]</code> inside the program. It is not a <code>char</code> anymore, it is a <em>string</em>.</p></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 5043417, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b365a8680d2f43f6cc0660877eccdcef?s=128&d=identicon&r=PG&f=1", "display_name": "rocker", "link": "https://stackoverflow.com/users/5043417/rocker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1979, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1435132922, "creation_date": 1435131146, "last_edit_date": 1435132922, "question_id": 31020424, "link": "https://stackoverflow.com/questions/31020424/c-programming-print-ascii-value-of-char", "title": "c programming print ascii value of char*", "body": "<p>I'm trying to print the ascii value (ascii int numbers) of a <code>char*</code> for example <code>A</code> as 65  as on the <a href=\"http://www.ascii-code.com/\" rel=\"nofollow\">ascii table</a>.</p>\n\n<p>Here is the code I have. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc, char *argv[])\n{\n    int i = 0;\n\n    printf(\" Hello World \\n\");\n    printf(\"argv[0] is %s! \\n\",argv[0]);\n    printf(\"argv[1] is %s! \\n\",argv[1]);\n    printf(\"argv[2] is %s! \\n\",argv[2]);\n    printf(\"argv[3] is %s! \\n\",argv[3]);\n\n    if( argc == 4 )\n    {\n        printf(\"The first argument supplied is %s\\n\", argv[1]);\n        printf(\"The second argument supplied is %s\\n\", argv[2]);\n        printf(\"The third argument supplied is %s\\n\", argv[3]);\n    }\n    else if( argc &gt; 4 )\n    {\n        printf(\"Too many arguments supplied.\\n\");\n        exit( 1 );\n    }\n    else\n    {\n        printf(\"Not enough arguments supplied. \\n\");\n        exit( 1 );\n    }\n\n    for(i = 1; i &lt; 100; i++)\n    {\n        printf(\"i is %d argv[i] %d\\n\", i, argv[i]);\n    }\n\n    return(0);\n}\n</code></pre>\n\n<p>I want these values to be entered from the command so this is what I put in. </p>\n\n<pre><code>./a.out A B C\n</code></pre>\n\n<p>When I compile it I get this warning. </p>\n\n<blockquote>\n  <p>warning: format \u2018%d\u2019 expects type \u2018int\u2019, but argument 3 has type \u2018char *\u2019</p>\n</blockquote>\n\n<p>If I cast the <code>argv[i]</code> to <code>(int)</code> I get this message. </p>\n\n<blockquote>\n  <p>warning: cast from pointer to integer of different size</p>\n</blockquote>\n\n<p>If I cast the <code>argv[i]</code> to <code>(int *)</code> I get this message. </p>\n\n<blockquote>\n  <p>warning: format \u2018%d\u2019 expects type \u2018int\u2019, but argument 3 has type \u2018int *\u2019</p>\n</blockquote>\n"}, {"tags": ["c", "visual-studio-2010", "winapi"], "comments": [{"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1435132770, "post_id": 31020298, "comment_id": 50067100, "body": "Add some error checking and try again."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1435132845, "post_id": 31020298, "comment_id": 50067138, "body": "Program does not compile."}, {"owner": {"reputation": 35, "user_id": 4947312, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3fb76def210f1dccaf55f9c1e8582a70?s=128&d=identicon&r=PG&f=1", "display_name": "tran tuan", "link": "https://stackoverflow.com/users/4947312/tran-tuan"}, "edited": false, "score": 0, "creation_date": 1435138344, "post_id": 31020298, "comment_id": 50070535, "body": "I still compile success! and not error, just tooltip not appear!"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1435139446, "post_id": 31020298, "comment_id": 50071324, "body": "We&#39;ve no idea what &quot;not worked&quot; means. Please make more effort to describe what you hope will happen, and what actually happens. Please add error checking. Please learn to debug your code."}, {"owner": {"reputation": 35, "user_id": 4947312, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3fb76def210f1dccaf55f9c1e8582a70?s=128&d=identicon&r=PG&f=1", "display_name": "tran tuan", "link": "https://stackoverflow.com/users/4947312/tran-tuan"}, "edited": false, "score": 0, "creation_date": 1435142539, "post_id": 31020298, "comment_id": 50073378, "body": "Yes, my happen is i don&#39;t send an addtool message to the tooltip control window:  SendMessage(hwndTT, TTM_ADDTOOL, 0, (LPARAM) (LPTOOLINFO) &amp;ti);"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1435143269, "post_id": 31020298, "comment_id": 50073861, "body": "Line 29 <code>hinst - hInstance;</code> does not compile."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4947312, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3fb76def210f1dccaf55f9c1e8582a70?s=128&d=identicon&r=PG&f=1", "display_name": "tran tuan", "link": "https://stackoverflow.com/users/4947312/tran-tuan"}, "edited": false, "score": 0, "creation_date": 1435199533, "post_id": 31039047, "comment_id": 50103942, "body": "Hi Shemirani, i have a question: Can i control appearing and possiton of tooltip?"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "reply_to_user": {"reputation": 35, "user_id": 4947312, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3fb76def210f1dccaf55f9c1e8582a70?s=128&d=identicon&r=PG&f=1", "display_name": "tran tuan", "link": "https://stackoverflow.com/users/4947312/tran-tuan"}, "edited": false, "score": 0, "creation_date": 1435203640, "post_id": 31039047, "comment_id": 50104910, "body": "@trantuan I updated my answer. Please try to fix your manifest. And then try again with just <code>ti.cbSize = sizeof(TTTOOLINFO);</code> That&#39;s the correct way. Forget about the earlier answer I gave, it&#39;s impossible to keep track of those things manually. If it fixes your problem please accept the answer, click the check mark, to close bring this to a close. Then you can ask a new question."}], "tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": false, "score": 1, "last_activity_date": 1435206130, "last_edit_date": 1435206130, "creation_date": 1435189918, "answer_id": 31039047, "question_id": 31020298, "link": "https://stackoverflow.com/questions/31020298/how-to-use-tooltip-in-winapi/31039047#31039047", "title": "How to use tooltip in winapi?", "body": "<p><strong>Update:</strong></p>\n\n<p>There seems to be an error with the manifest. If you are using Visual Studio, go to project properties:</p>\n\n<p>Project -> Properties -> Linker -> Manifest -> Generate Manifest file: Yes</p>\n\n<p>Once you have the correct manifest, you can call the function normally:</p>\n\n<pre><code>void CreateMyTooltip(HWND hparent)\n{\n    HWND hwndTT = CreateWindowEx(WS_EX_TOPMOST, TOOLTIPS_CLASS, NULL,\n        WS_POPUP | TTS_NOPREFIX | TTS_ALWAYSTIP, 0, 0, 0, 0, hparent, NULL, 0, NULL);\n\n    TTTOOLINFO ti = { 0 };\n    ti.cbSize = sizeof(TTTOOLINFO);\n    ti.uFlags = TTF_SUBCLASS;\n    ti.hwnd = hparent;\n    ti.lpszText = TEXT(\"Tooltip string\");\n    GetClientRect(hparent, &amp;ti.rect);\n\n    if (!SendMessage(hwndTT, TTM_ADDTOOL, 0, (LPARAM)&amp;ti))\n        MessageBox(0,TEXT(\"Failed: TTM_ADDTOOL\"),0,0);\n}\n</code></pre>\n\n<p>You should make sure the manifest is correct. If it's wrong then you can run in to trouble here, and in lots of other places.</p>\n\n<hr>\n\n<p>This is the old answer: <strong>(not recommended!)</strong></p>\n\n<p>If manifest is wrong, you have to give set the right value for <code>TTOOLINFO::sbSize</code> which in my case happens to be <code>TTTOOLINFOW_V2_SIZE</code></p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;commctrl.h&gt;\n\n#pragma comment(linker,\"\\\"/manifestdependency:type='win32' name='Microsoft.Windows.Common-Controls' version='6.0.0.0' processorArchitecture='*' publicKeyToken='6595b64144ccf1df' language='*'\\\"\")\n#pragma comment(lib, \"comctl32.lib\")\n\nHINSTANCE g_hinst;\n\nvoid CreateMyTooltip(HWND hparent)\n{\n    HWND hwndTT = CreateWindowEx(WS_EX_TOPMOST, TOOLTIPS_CLASS, NULL,\n        WS_POPUP | TTS_NOPREFIX | TTS_ALWAYSTIP, 0, 0, 0, 0, hparent, NULL, g_hinst, NULL);\n\n    TTTOOLINFO ti = { 0 };\n\n    //ti.cbSize = sizeof(TTTOOLINFO);\n    //*********************************************************\n    // Specific settings for specific compiler options (Unicode/VC2013)\n    //*********************************************************\n    ti.cbSize = TTTOOLINFOW_V2_SIZE; \n\n    ti.uFlags = TTF_SUBCLASS;\n    ti.hwnd = hparent;\n    ti.lpszText = TEXT(\"Tooltip string\");\n    GetClientRect(hparent, &amp;ti.rect);\n\n    if (!SendMessage(hwndTT, TTM_ADDTOOL, 0, (LPARAM)&amp;ti))\n        MessageBox(0,TEXT(\"Failed: TTM_ADDTOOL\"),0,0);\n}\n\nLRESULT CALLBACK WndProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)\n{\n    switch (msg)\n    {\n    case WM_CREATE:\n        CreateMyTooltip(hwnd);\n        break;\n\n    case WM_DESTROY:\n        PostQuitMessage(0);\n        break;\n\n    default:\n        return DefWindowProc(hwnd, msg, wParam, lParam);\n    }\n    return 0;\n}\n\nint WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)\n{\n    g_hinst = hInstance;\n\n    WNDCLASS wc = { 0 };\n    wc.lpszClassName = TEXT(\"TooltipTest\");\n    wc.hInstance = hInstance;\n    wc.hbrBackground = GetSysColorBrush(COLOR_3DFACE);\n    wc.lpfnWndProc = WndProc;\n    wc.hCursor = LoadCursor(0, IDC_ARROW);\n    RegisterClass(&amp;wc);\n\n    CreateWindow(wc.lpszClassName, TEXT(\"Tooltip\"), WS_OVERLAPPEDWINDOW|WS_VISIBLE,\n        100, 100, 200, 150, 0, 0, g_hinst, 0);\n\n    MSG  msg;\n    while (GetMessage(&amp;msg, NULL, 0, 0))\n    {\n        TranslateMessage(&amp;msg);\n        DispatchMessage(&amp;msg);\n    }\n\n    return (int)msg.wParam;\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4947312, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3fb76def210f1dccaf55f9c1e8582a70?s=128&d=identicon&r=PG&f=1", "display_name": "tran tuan", "link": "https://stackoverflow.com/users/4947312/tran-tuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1555, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1591248050, "creation_date": 1435130709, "last_edit_date": 1435131780, "question_id": 31020298, "link": "https://stackoverflow.com/questions/31020298/how-to-use-tooltip-in-winapi", "title": "How to use tooltip in winapi?", "body": "<p>I have tried use tooltip in winapi but it not worked! This is my code, my tooltip doen't show! Can you tell me why it not work? I'm using visual studio 2010. </p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;commctrl.h&gt;\n\n#pragma comment(linker,\"\\\"/manifestdependency:type='win32' \\\nname='Microsoft.Windows.Common-Controls' version='6.0.0.0' \\\nprocessorArchitecture='*' publicKeyToken='6595b64144ccf1df' language='*'\\\"\")\n\nLRESULT CALLBACK WndProc2(HWND, UINT, WPARAM, LPARAM);\nvoid CreateMyTooltip(HWND);\nHWND CreateToolTip(HWND hDlg, int tooID);\nvoid AddToolTip(int toolID,  PTSTR pszText, HWND hDlg);\nHINSTANCE hinst;\n\nint WINAPI WinMain( HINSTANCE hInstance, HINSTANCE hPrevInstance,\n    LPSTR lpCmdLine, int nCmdShow )\n{\n    MSG  msg ;    \n    WNDCLASS wc = {0};\n    wc.lpszClassName = L\"Tooltip\" ;\n    wc.hInstance     = hInstance ;\n    wc.hbrBackground = GetSysColorBrush(COLOR_3DFACE);\n    wc.lpfnWndProc   = WndProc2 ;\n    wc.hCursor       = LoadCursor(0, IDC_ARROW);\n\n    RegisterClass(&amp;wc);\n    CreateWindow( wc.lpszClassName, L\"Tooltip\",\n        WS_OVERLAPPEDWINDOW | WS_VISIBLE,\n        100, 100, 200, 150, 0, 0, hInstance, 0);  \n    hinst - hInstance;\n    while( GetMessage(&amp;msg, NULL, 0, 0)) {\n        TranslateMessage(&amp;msg);\n        DispatchMessage(&amp;msg);\n    }\n    return (int) msg.wParam;\n}\n\nLRESULT CALLBACK WndProc2( HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam )\n{\n    switch(msg)  \n    {\n    case WM_CREATE:\n        CreateMyTooltip(hwnd);\n        break;\n\n    case WM_DESTROY:\n        PostQuitMessage(0);\n        break;\n    }\n    return DefWindowProc(hwnd, msg, wParam, lParam);\n}\n\nvoid CreateMyTooltip (HWND hwnd)\n{\n\n    INITCOMMONCONTROLSEX iccex; \n    HWND hwndTT;                \n\n    TOOLINFO ti;\n    wchar_t tooltip[30] = L\"A main window\";\n    RECT rect;                 \n\n    iccex.dwICC = ICC_WIN95_CLASSES;\n    iccex.dwSize = sizeof(INITCOMMONCONTROLSEX);\n    InitCommonControlsEx(&amp;iccex);\n\n    hwndTT = CreateWindowEx(WS_EX_TOPMOST, TOOLTIPS_CLASS, NULL,\n        WS_POPUP | TTS_NOPREFIX | TTS_ALWAYSTIP,        \n        0, 0, 0, 0, hwnd, NULL, hinst, NULL );\n\n    SetWindowPos(hwndTT, HWND_TOPMOST, 0, 0, 0, 0,\n        SWP_NOMOVE | SWP_NOSIZE | SWP_NOACTIVATE);\n\n    GetClientRect (hwnd, &amp;rect);\n\n    ti.cbSize = sizeof(TOOLINFO);\n    ti.uFlags = TTF_SUBCLASS | TTF_IDISHWND;\n    ti.hwnd = hwnd;\n    ti.hinst = NULL;\n    ti.uId = 0;\n    ti.lpszText = tooltip;\n    ti.rect.left = rect.left;    \n    ti.rect.top = rect.top;\n    ti.rect.right = rect.right;\n    ti.rect.bottom = rect.bottom;\n\n    SendMessage(hwndTT, TTM_ADDTOOL, 0, (LPARAM) (LPTOOLINFO) &amp;ti); \n    SendMessage(hwndTT, TTM_ACTIVATE, true, NULL);\n    SendMessage(hwndTT, TTM_POPUP, 0, 0);\n}       \n</code></pre>\n"}, {"tags": ["c", "function", "assembly"], "comments": [{"owner": {"reputation": 27069, "user_id": 2307070, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l8ha6.jpg?s=128&g=1", "display_name": "Thomas Ayoub", "link": "https://stackoverflow.com/users/2307070/thomas-ayoub"}, "edited": false, "score": 3, "creation_date": 1435130785, "post_id": 31020288, "comment_id": 50065855, "body": "Why don&#39;t you measure it yourself...? The answer on my computer will not be true for yours..."}, {"owner": {"reputation": 4687, "user_id": 3819850, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rwYcz.png?s=128&g=1", "display_name": "CinchBlue", "link": "https://stackoverflow.com/users/3819850/cinchblue"}, "edited": false, "score": 1, "creation_date": 1435130786, "post_id": 31020288, "comment_id": 50065857, "body": "Benchmarking? There are so many architectures and configurations and situations, there can&#39;t be a definite answer for this."}, {"owner": {"reputation": 35623, "user_id": 1003575, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cceded39fb12d936211b56afc86dcb04?s=128&d=identicon&r=PG&f=1", "display_name": "MOHAMED", "link": "https://stackoverflow.com/users/1003575/mohamed"}, "reply_to_user": {"reputation": 27069, "user_id": 2307070, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l8ha6.jpg?s=128&g=1", "display_name": "Thomas Ayoub", "link": "https://stackoverflow.com/users/2307070/thomas-ayoub"}, "edited": false, "score": 0, "creation_date": 1435130948, "post_id": 31020288, "comment_id": 50065972, "body": "@Thomas could you provide a c program to measure the difference"}, {"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 4, "creation_date": 1435130967, "post_id": 31020288, "comment_id": 50065983, "body": "@MOHAMED No; this isn&#39;t a code writing service. Do it yourself or hire somebody."}, {"owner": {"reputation": 35623, "user_id": 1003575, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cceded39fb12d936211b56afc86dcb04?s=128&d=identicon&r=PG&f=1", "display_name": "MOHAMED", "link": "https://stackoverflow.com/users/1003575/mohamed"}, "reply_to_user": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1435131345, "post_id": 31020288, "comment_id": 50066218, "body": "@rightfold. I mean are there some links which contains a such programs or explanation to develop a uch program"}, {"owner": {"reputation": 27069, "user_id": 2307070, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l8ha6.jpg?s=128&g=1", "display_name": "Thomas Ayoub", "link": "https://stackoverflow.com/users/2307070/thomas-ayoub"}, "edited": false, "score": 3, "creation_date": 1435131934, "post_id": 31020288, "comment_id": 50066549, "body": "You&#39;ve got <a href=\"http://stackoverflow.com/help/badges/52/c?userid=1003575\">a silver badge in C</a>, maybe you could write it, don&#39;t you think...? :)"}], "answers": [{"tags": [], "owner": {"reputation": 5277, "user_id": 4745527, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mVYxV.png?s=128&g=1", "display_name": "Aracthor", "link": "https://stackoverflow.com/users/4745527/aracthor"}, "is_accepted": false, "score": 3, "last_activity_date": 1435130919, "creation_date": 1435130919, "answer_id": 31020357, "question_id": 31020288, "link": "https://stackoverflow.com/questions/31020288/if-jump-vs-function-jump/31020357#31020357", "title": "if jump vs function jump", "body": "<p>What you are looking for is the number of <a href=\"https://en.wikipedia.org/wiki/Cycles_per_instruction\" rel=\"nofollow\">cycles per instruction</a> for each case.</p>\n\n<p>As it is more complicated that you seem think, I suggest you to read the link that I gave, it takes your CPU as first example.</p>\n"}], "owner": {"reputation": 35623, "user_id": 1003575, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cceded39fb12d936211b56afc86dcb04?s=128&d=identicon&r=PG&f=1", "display_name": "MOHAMED", "link": "https://stackoverflow.com/users/1003575/mohamed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "closed_date": 1435134615, "answer_count": 1, "score": -10, "last_activity_date": 1435131166, "creation_date": 1435130681, "last_edit_date": 1435131166, "question_id": 31020288, "link": "https://stackoverflow.com/questions/31020288/if-jump-vs-function-jump", "closed_reason": "Needs more focus", "title": "if jump vs function jump", "body": "<p>I know the jump in the memory of <code>if</code> statment is more faster than a jump of a function call.</p>\n\n<p>I want to know how much <code>if</code> statement jump is faster than the function jump?</p>\n\n<p>I  m looking for approximative value like:</p>\n\n<p>The <code>if</code> jump is faster 10 times x function jump</p>\n\n<p>Note: my cpu has a mips architecture.</p>\n"}, {"tags": ["c", "pointers", "char", "segmentation-fault"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1435131348, "post_id": 31020252, "comment_id": 50066221, "body": "If you are implementing a <code>strcpy</code>, use <code>strlen</code> is not a good idea. To prevent an undefined behaviour check the lenght with a max threshold or until you find a <code>&#39;\\0&#39;</code>. Also beacuse each recursion re-call <code>strlen</code>..."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1435137939, "post_id": 31020252, "comment_id": 50070269, "body": "a <i>double pointer</i> is <code>double *</code>; you are using <i>pointer to char pointer</i>"}], "answers": [{"comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 3970, "user_id": 1151654, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc251d76cd38dae9e0d62360facbf790?s=128&d=identicon&r=PG", "display_name": "Eregrith", "link": "https://stackoverflow.com/users/1151654/eregrith"}, "edited": false, "score": 0, "creation_date": 1435130909, "post_id": 31020316, "comment_id": 50065943, "body": "@Eregrith no, because the result of a cast is a temporary."}, {"owner": {"reputation": 3970, "user_id": 1151654, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc251d76cd38dae9e0d62360facbf790?s=128&d=identicon&r=PG", "display_name": "Eregrith", "link": "https://stackoverflow.com/users/1151654/eregrith"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1435130950, "post_id": 31020316, "comment_id": 50065974, "body": "@Quentin Yeah I thought so. What should be done by OP then? (Apart from the obvious removal of 1 star on each param)"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 1, "creation_date": 1435131050, "post_id": 31020316, "comment_id": 50066031, "body": "<i>So you&#39;re not really passing a pointer to a pointer to char to the function, but just a plain pointer to char</i> - this is incorrect."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 3970, "user_id": 1151654, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc251d76cd38dae9e0d62360facbf790?s=128&d=identicon&r=PG", "display_name": "Eregrith", "link": "https://stackoverflow.com/users/1151654/eregrith"}, "edited": false, "score": 0, "creation_date": 1435131053, "post_id": 31020316, "comment_id": 50066032, "body": "@Eregrith Well, to pass a pointer to a pointer to the <code>char</code>s, you need that second pointer to be an lvalue. So, first define it and point it at the array, then take its address."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1435133061, "post_id": 31020316, "comment_id": 50067262, "body": "@MaximEgorushkin Care to elaborate? Because using the address-of operator on an array gives you a pointer to the first element of the array."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1435134532, "post_id": 31020316, "comment_id": 50068073, "body": "@JoachimPileborg An array decays to a pointer to its first element. A pointer to an array does not."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 5, "last_activity_date": 1435135173, "last_edit_date": 1435135173, "creation_date": 1435130765, "answer_id": 31020316, "question_id": 31020252, "link": "https://stackoverflow.com/questions/31020252/segmentation-fault-while-using-pointer-to-pointer-to-a-char/31020316#31020316", "title": "Segmentation fault while using pointer to pointer to a char", "body": "<p>The problem is that <code>output</code> is not a pointer, it's an array, and using the address-of operator on an array gives you a (single) pointer to the array (in your case of type <code>char (*)[8]</code>). For clarification: <code>(void *) output == (void *) &amp;output</code>, both the decayed pointer of the array, and the pointer to the array, are equal.</p>\n\n<p>So you're not really passing a pointer to a pointer to <code>char</code> to the function.</p>\n\n<hr>\n\n<p>Besides the above, I see no reason that the function should take a pointer to a pointer, a plain single pointer should be enough. Otherwise you will get wrong result when using <code>output</code> in the <code>printf</code> call as then <code>output</code> would point beyond the end of the string.</p>\n\n<p>Also, you don't terminate the <code>output</code> string.</p>\n"}, {"comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 2, "creation_date": 1435131346, "post_id": 31020403, "comment_id": 50066219, "body": "Are you positive that a <code>char(*)[8]</code> decays to a <code>char*</code> ? Being a pointer and not an array itself, I don&#39;t think it does."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1435132202, "post_id": 31020403, "comment_id": 50066727, "body": "@Quentin well, in case of a function call , I think it does, isn&#39;t it?"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1435141921, "post_id": 31020403, "comment_id": 50072956, "body": "<a href=\"http://coliru.stacked-crooked.com/a/bc0ddcfc8466cd66\" rel=\"nofollow noreferrer\">Nope</a>, it doesn&#39;t. Only array names decay to pointers."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1435142139, "post_id": 31020403, "comment_id": 50073114, "body": "@Quentin Why use a C++ compiler for compiling C code? check <a href=\"http://rextester.com/XQNUSX24688\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1435143172, "post_id": 31020403, "comment_id": 50073805, "body": "My bad ! I wan&#39;t paying attention there. However, turning on warnings gives, again, <code>warning: passing argument 1 of \u2018func\u2019 from incompatible pointer type</code>."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": -1, "last_activity_date": 1435131363, "last_edit_date": 1495542236, "creation_date": 1435131074, "answer_id": 31020403, "question_id": 31020252, "link": "https://stackoverflow.com/questions/31020252/segmentation-fault-while-using-pointer-to-pointer-to-a-char/31020403#31020403", "title": "Segmentation fault while using pointer to pointer to a char", "body": "<p>The issue, as aleardy pointed out by <a href=\"https://stackoverflow.com/users/440558/joachim-pileborg\">Mr. JP</a> in <a href=\"https://stackoverflow.com/a/31020316/2173917\">his answer</a>, is <code>&amp;output</code> does not give you a <code>char **</code>, it gives a <code>char (*)[8]</code> in this case, which will decay into a <code>char *</code> when used as function argument.</p>\n\n<p>In your case, you don't need a pointer-to-pointer to alter the contents of the memory area pointed by that pointer. A simple pointer will do. You can change</p>\n\n<pre><code>void convertString(char *input, char **output)\n</code></pre>\n\n<p>to  </p>\n\n<pre><code>void convertString(char *input, char *output)  //output is of type char*\n</code></pre>\n\n<p>and other occurrences of <code>output</code> similarly and call it like</p>\n\n<pre><code>convertString(input, output);\n</code></pre>\n\n<p>that should work.</p>\n\n<p>That said, you should null-terminate <code>output</code> to make it use as a <em>string</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "is_accepted": false, "score": -1, "last_activity_date": 1435131179, "creation_date": 1435131179, "answer_id": 31020435, "question_id": 31020252, "link": "https://stackoverflow.com/questions/31020252/segmentation-fault-while-using-pointer-to-pointer-to-a-char/31020435#31020435", "title": "Segmentation fault while using pointer to pointer to a char", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nvoid convertString(char *input, char *output)\n{\n    if(strlen(input)== 0)\n    {\n        return;\n    }\n    *output = *input;\n    output++;\n    convertString(input+1,output);\n}\nint main()\n{\n    char input[] = \"abcdefg\";\n    char output[sizeof(input)];\n    convertString(input, output);\n    printf(\"%s\\n\", output);\n    return 0;\n}\n</code></pre>\n\n<p>Probably this is what you wanted to do? </p>\n"}, {"tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 3, "last_activity_date": 1435131262, "creation_date": 1435131262, "answer_id": 31020453, "question_id": 31020252, "link": "https://stackoverflow.com/questions/31020252/segmentation-fault-while-using-pointer-to-pointer-to-a-char/31020453#31020453", "title": "Segmentation fault while using pointer to pointer to a char", "body": "<p>You do not really need a double pointer to the output buffer here, a plain <code>char*</code> suffices:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nvoid convertString(char *input, char *output)\n{\n    if(!(*output = *input)) // Copy the zero terminator as well.\n        return;\n    convertString(input + 1, output + 1);\n}\n\nint main()\n{\n    char input[] = \"abcdefg\";\n    char output[sizeof(input)];\n    convertString(input, output);\n    printf(\"%s\", output);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 3, "last_activity_date": 1435132308, "last_edit_date": 1435132308, "creation_date": 1435131923, "answer_id": 31020663, "question_id": 31020252, "link": "https://stackoverflow.com/questions/31020252/segmentation-fault-while-using-pointer-to-pointer-to-a-char/31020663#31020663", "title": "Segmentation fault while using pointer to pointer to a char", "body": "<p>Character array <code>output</code> has type <code>char [sizeof( \"abcdefg\" ) ]</code> that is equivalent to <code>char[8]</code>. So expression <code>&amp;output</code> in function call</p>\n\n<pre><code>convertString(input, &amp;output);\n</code></pre>\n\n<p>has type <code>char ( * )[8]</code> while the corresponding parameter of the function has type <code>char **</code>. They are incompatible types and the compiler points to this mistake.</p>\n\n<p>There is no sense to declare this parameter as having type <code>char **</code>. It has to be declared like <code>char *</code>.</p>\n\n<pre><code>void convertString(char *input, char *output);\n</code></pre>\n\n<p>Also within the function the terminating zero is not copied from the input string to the output string. The function simply exits.</p>\n\n<pre><code>if(strlen(input)== 0)\n{\n    return;\n}\n</code></pre>\n\n<p>And it is inefficient to calculate the length of the string in each recursion. You could substitute this condition at least for</p>\n\n<pre><code>if ( input[0] == '\\0' )\n</code></pre>\n\n<p>or</p>\n\n<pre><code>if ( *input == '\\0' )\n</code></pre>\n\n<p>or</p>\n\n<pre><code>if ( !*input )\n</code></pre>\n\n<p>Also it is unclear why the function is named <code>convertString</code> instead of for example <code>copyString</code>.</p>\n\n<p>Take into account that there is a common convention that string functions return pointers to strings they process.\nThe function can be defined simpler.</p>\n\n<p>Here is a demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar * copyString( char *output, const char *input )\n{\n    if ( ( *output = *input ) ) copyString( output + 1, input + 1 );\n    return output;\n}\n\nint main(void) \n{\n    char input[] = \"abcdefg\";\n    char output[sizeof(input)];\n\n    puts( copyString( output, input ) );    \n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>abcdefg\n</code></pre>\n"}], "owner": {"reputation": 904, "user_id": 2711402, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f60d62777fda717173de19b2de003018?s=128&d=identicon&r=PG&f=1", "display_name": "Rndp13", "link": "https://stackoverflow.com/users/2711402/rndp13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 31020316, "answer_count": 5, "score": 0, "last_activity_date": 1435138550, "creation_date": 1435130572, "last_edit_date": 1435138550, "question_id": 31020252, "link": "https://stackoverflow.com/questions/31020252/segmentation-fault-while-using-pointer-to-pointer-to-a-char", "title": "Segmentation fault while using pointer to pointer to a char", "body": "<p>While compiling and executing the below program i am getting a warning during compilation and seg fault during execution. </p>\n\n<p>Warning  </p>\n\n<pre><code>program.c: In function main:\nprogram.c:17: warning: passing argument 2 of convertString from incompatible pointer type\n</code></pre>\n\n<p>line 17 is the call to <code>convertString(input, &amp;output);</code></p>\n\n<p>attaching the debugger is can see the segfault is occuring at the below line </p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n0x0000000000400521 in convertString (input=0x7fffffffd100 \"abcdefg\", output=0x7fffffffd0f0) at program.c:9\n9           **output = *input;\n(gdb) s\n\n#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nvoid convertString(char *input, char **output)\n{\n    if(strlen(input)== 0)\n    {\n        return;\n    }\n    **output = *input;\n    (*output)++;\n    convertString(input+1,output);\n}\nint main()\n{\n    char input[] = \"abcdefg\";\n    char output[sizeof(input)];\n    convertString(input, &amp;output);\n    printf(\"%s\", output);\n    return 0;\n}\n</code></pre>\n\n<p>Please help me where i am doing wrong.</p>\n"}, {"tags": ["c", "function", "recursion", "return-value"], "comments": [{"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 1, "creation_date": 1435129621, "post_id": 31019870, "comment_id": 50065151, "body": "Your code invokes Undefined Behavior as you don&#39;t return an <code>int</code> when <code>exp</code> is 1. The function will return a &quot;random&quot; , &quot;garbage&quot; value from memory. So anything can be the result."}, {"owner": {"reputation": 2571, "user_id": 2149974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb21c41d027acd90bb86547189a7da7?s=128&d=identicon&r=PG", "display_name": "marcadian", "link": "https://stackoverflow.com/users/2149974/marcadian"}, "edited": false, "score": 0, "creation_date": 1435129631, "post_id": 31019870, "comment_id": 50065157, "body": "It does not return when exp = 1, but if you catch the return value when call the function, it will be junk value from memory"}, {"owner": {"reputation": 39, "user_id": 5043280, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-xJ7g2Odj9Uo/AAAAAAAAAAI/AAAAAAAABRc/K07qW5hGIrY/photo.jpg?sz=128", "display_name": "Ayo", "link": "https://stackoverflow.com/users/5043280/ayo"}, "edited": false, "score": 0, "creation_date": 1435130462, "post_id": 31019870, "comment_id": 50065648, "body": "I know about C  returning garbage values when the return value is not specified but in this case, it returns the right answer and I tested it several times. For example, when I call it in the main function with base = 7 and exp =1, it returns 7 as my answer and even with other &quot;base&quot; values, it always returns the base which is the right answer. And that exactly is my source of confusion - How is C managing to return the right answer to me when the IF clause of the function body evaluates to false..."}], "answers": [{"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 3, "last_activity_date": 1435129703, "creation_date": 1435129703, "answer_id": 31019951, "question_id": 31019870, "link": "https://stackoverflow.com/questions/31019870/c-recursion-code/31019951#31019951", "title": "C recursion code", "body": "<p>Actually your function is <a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html\" rel=\"nofollow\">Undefined Behaviour</a>, because of is not returning nothing in case of <code>exp == 1</code></p>\n\n<p>The value you have in return to your main function is something random.</p>\n"}, {"tags": [], "owner": {"reputation": 5413, "user_id": 1743849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5cwvZ.jpg?s=128&g=1", "display_name": "rakeb.mazharul", "link": "https://stackoverflow.com/users/1743849/rakeb-mazharul"}, "is_accepted": false, "score": 1, "last_activity_date": 1435130103, "last_edit_date": 1435130103, "creation_date": 1435129727, "answer_id": 31019963, "question_id": 31019870, "link": "https://stackoverflow.com/questions/31019870/c-recursion-code/31019963#31019963", "title": "C recursion code", "body": "<p>You may warned by the compiler in the declaration <code>int power(int base,int exp)</code></p>\n\n<blockquote>\n  <p>No return, in function returning non-void</p>\n</blockquote>\n\n<p>Hence, you will get <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>, when you call <code>power()</code> with <code>exp = 1</code>.</p>\n\n<p><strong>Note that:</strong> Your <code>power()</code> will fall into <em>recursion trap</em> if <code>exp</code> is negative.</p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 5043280, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-xJ7g2Odj9Uo/AAAAAAAAAAI/AAAAAAAABRc/K07qW5hGIrY/photo.jpg?sz=128", "display_name": "Ayo", "link": "https://stackoverflow.com/users/5043280/ayo"}, "edited": false, "score": 0, "creation_date": 1435132551, "post_id": 31019990, "comment_id": 50066959, "body": "I know about C returning garbage values when the return value is not specified but in this case, it returns the right answer and I tested it several times. For example, when I call it in the main function with base = 7 and exp =1, it returns 7 as my answer and even with other &quot;base&quot; values, it always returns the base which is the right answer. And that exactly is my source of confusion - How is C managing to return the right answer to me when the IF clause of the function body evaluates to false..."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 39, "user_id": 5043280, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-xJ7g2Odj9Uo/AAAAAAAAAAI/AAAAAAAABRc/K07qW5hGIrY/photo.jpg?sz=128", "display_name": "Ayo", "link": "https://stackoverflow.com/users/5043280/ayo"}, "edited": false, "score": 0, "creation_date": 1435132653, "post_id": 31019990, "comment_id": 50067019, "body": "@AyorindeKomolafe well, undefined behaviour is undefined. It includes working &quot;as expected&quot; case also."}, {"owner": {"reputation": 39, "user_id": 5043280, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-xJ7g2Odj9Uo/AAAAAAAAAAI/AAAAAAAABRc/K07qW5hGIrY/photo.jpg?sz=128", "display_name": "Ayo", "link": "https://stackoverflow.com/users/5043280/ayo"}, "edited": false, "score": 0, "creation_date": 1435136106, "post_id": 31019990, "comment_id": 50069013, "body": "really? I didn&#39;t know that. I thought if it was undefined, it might throw different answers to me each time I run it, but it was giving me consistently right answers."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1435130138, "last_edit_date": 1435130138, "creation_date": 1435129813, "answer_id": 31019990, "question_id": 31019870, "link": "https://stackoverflow.com/questions/31019870/c-recursion-code/31019990#31019990", "title": "C recursion code", "body": "<p>In your case, for <code>exp</code> having value  <code>1</code>, there is no <code>return</code> statement. If the return value of that call is used in the caller function, program shows UB.<sup>See note below</sup></p>\n\n<p>That said, the issue will also hold true in case you're calling <code>power()</code> with <code>exp</code> value something other than <code>1</code>, as <code>power()</code> will end up calling itself with <code>exp</code> as <code>1</code> at some point of time.</p>\n\n<p>Finally, <code>exp</code>  being an <code>int</code>, it can accept a negative value and go into infinite loop, only to create stack overflow by infinite recursion.</p>\n\n<hr>\n\n<p>Note: As per the <code>C11</code> standard, if the function is terminated by reaching the closing <code>}</code> and the returned value is used, it invokes invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behaviour</a>.</p>\n\n<p>Ref: Chapter <code>\u00a76.9.1</code>, paragraph 12, </p>\n\n<blockquote>\n  <p>If the <code>}</code> that terminates a function is reached, and the value of the function call is used by the caller, the behavior is undefined.</p>\n</blockquote>\n"}], "owner": {"reputation": 39, "user_id": 5043280, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-xJ7g2Odj9Uo/AAAAAAAAAAI/AAAAAAAABRc/K07qW5hGIrY/photo.jpg?sz=128", "display_name": "Ayo", "link": "https://stackoverflow.com/users/5043280/ayo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "closed_date": 1435130415, "answer_count": 3, "score": 1, "last_activity_date": 1435140154, "creation_date": 1435129494, "last_edit_date": 1435140154, "question_id": 31019870, "link": "https://stackoverflow.com/questions/31019870/c-recursion-code", "closed_reason": "Duplicate", "title": "C recursion code", "body": "<p>I need help with understanding this code using recursion.</p>\n\n<pre><code>    int power(int n1,int n2);\n    int main()\n    {\n        int base, exp;\n        printf(\"Enter base number: \");\n        scanf(\"%d\",&amp;base);\n        printf(\"Enter power number(positive integer): \");\n        scanf(\"%d\",&amp;exp);\n        printf(\"%d^%d = %d\", base, exp, power(base, exp));\n        return 0;\n   }\n   int power(int base,int exp)\n   {\n       if ( exp!=1 )\n       return (base*power(base,exp-1));\n   }\n</code></pre>\n\n<p>The code works fine but I don't understand why it still manages to return a value when <code>exp</code> is 1 even when the condition in the function body evaluates to false, so I think it shouldn't return anything then.</p>\n\n<p>For example, if the function is called in the <code>main()</code> function and I assign the values of <code>5</code> and <code>1</code> to <code>base</code> and <code>exp</code> respectively, I expect that I shouldn't get a return value because <code>exp</code> is <code>1</code> and my function returns something only if <code>exp !=1</code> and also, there is no <code>else</code> part in the function body to cover the case when <code>exp</code> is <code>1</code>. \nI know about C returning garbage values when the return value is not specified but in this case, it returns the right answer and I tested it several times. For example, when I call it in the main function with <code>base=7</code> and <code>exp=1</code>, it returns <code>7</code> as my answer and even with other \"base\" values, it always returns the base which is the right answer. And that exactly is my source of confusion - How is C managing to return the right answer to me when the IF clause of the function body evaluates to false...\nI guess I'm missing something here.</p>\n"}, {"tags": ["c", "swift", "pointers", "memory-management"], "answers": [{"tags": [], "owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "is_accepted": true, "score": 6, "last_activity_date": 1435132530, "last_edit_date": 1495539970, "creation_date": 1435129953, "answer_id": 31020039, "question_id": 31019798, "link": "https://stackoverflow.com/questions/31019798/free-c-mallocd-memory-in-swift/31020039#31020039", "title": "Free C-malloc()&#39;d memory in Swift?", "body": "<p>Swift does not manage memory that is allocated with <code>malloc()</code>, you have to free the memory eventually:</p>\n\n<pre><code>let ret = the_function(\"something\") // returns pointer to malloc'ed memory\nlet str = String.fromCString(ret)!  // creates Swift String by *copying* the data\nfree(ret) // releases the memory\n\nprintln(str) // `str` is still valid (managed by Swift)\n</code></pre>\n\n<hr>\n\n<p>Note that a Swift <code>String</code> is automatically converted to a UTF-8\nstring when passed to a C function taking a <code>const char *</code> parameter\nas described in <a href=\"https://stackoverflow.com/questions/27063569/string-value-to-unsafepointeruint8-function-parameter-behavior\">String value to UnsafePointer&lt;UInt8&gt; function parameter behavior</a>.\nThat's why </p>\n\n<pre><code>let ret = the_function((\"something\" as NSString).UTF8String)\n</code></pre>\n\n<p>can be simplified to</p>\n\n<pre><code>let ret = the_function(\"something\")\n</code></pre>\n"}], "owner": {"reputation": 1515, "user_id": 98647, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/3fd7fc79836f346dddf00ecba451b940?s=128&d=identicon&r=PG", "display_name": "Christopher", "link": "https://stackoverflow.com/users/98647/christopher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2216, "favorite_count": 1, "accepted_answer_id": 31020039, "answer_count": 1, "score": 5, "last_activity_date": 1435132530, "creation_date": 1435129279, "last_edit_date": 1435129505, "question_id": 31019798, "link": "https://stackoverflow.com/questions/31019798/free-c-mallocd-memory-in-swift", "title": "Free C-malloc()&#39;d memory in Swift?", "body": "<p>I'm using the Swift compiler's Bridging Header feature to call a C function that allocates memory using <code>malloc()</code>. It then returns a pointer to that memory. The function prototype is something like:</p>\n\n<pre><code>char *the_function(const char *);\n</code></pre>\n\n<p>In Swift, I use it like this:</p>\n\n<pre><code>var ret = the_function((\"something\" as NSString).UTF8String)\n\nlet val = String.fromCString(ret)!\n</code></pre>\n\n<p>Forgive my ignorance concerning Swift but normally in C, if the_function() is malloc'ing memory and returning it, somebody else needs to free() it at some point.</p>\n\n<p>Is this being handled by Swift somehow or am I leaking memory in this example?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "linux", "cuda", "parallel-processing", "opencl"], "comments": [{"owner": {"reputation": 9332, "user_id": 3100482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w3Q8i.jpg?s=128&g=1", "display_name": "jprice", "link": "https://stackoverflow.com/users/3100482/jprice"}, "edited": false, "score": 3, "creation_date": 1435131870, "post_id": 31019603, "comment_id": 50066502, "body": "No, you do <i>not</i> need the SDK. You need to install their driver, which will come with the OpenCL libraries and provide ICD support. The same is true for AMD GPUs - you will need their driver (<code>fglrx</code>). Installing both drivers simultaneously might be tricky though."}, {"owner": {"reputation": 103, "user_id": 5043237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6572aa359534e116fc5b5bdbe6ce45ed?s=128&d=identicon&r=PG&f=1", "display_name": "ikk", "link": "https://stackoverflow.com/users/5043237/ikk"}, "edited": false, "score": 0, "creation_date": 1435131979, "post_id": 31019603, "comment_id": 50066586, "body": "clinfo gives this:  Number of platforms: 1   Platform Version: OpenCL 2.0 AMD-APP (1642.5)   Platform Name: AMD Accelerated Parallel Processing   Platform Extensions: cl_khr_icd cl_amd_event_callback cl_amd_offline_devices      Platform Name: AMD Accelerated Parallel Processing Number of devices:\t 1   Device Type: CL_DEVICE_TYPE_CPU   Platform ID: 0x7fc6343ad830   Name:Intel(R) Xeon(R) CPU           X5660  @ 2.80GHz   Vendor: GenuineIntel   Device OpenCL C version:OpenCL C 1.2    Driver version: 1642.5 (sse2)   Profile: FULL_PROFILE   Version:\tOpenCL 1.2 AMD-APP (1642.5)"}, {"owner": {"reputation": 7948, "user_id": 4899330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/857a19fa016a8fc6c0a3250f03f108a9?s=128&d=identicon&r=PG&f=1", "display_name": "doqtor", "link": "https://stackoverflow.com/users/4899330/doqtor"}, "edited": false, "score": 0, "creation_date": 1435132018, "post_id": 31019603, "comment_id": 50066600, "body": "Run <code>dmesg | grep fglrx | grep module</code> to see if something comes up. If not then you didn&#39;t installed AMD graphics driver. Also for the first time you may need to run your opencl program with <code>sudo</code> so that everything initializes in the system. Also you may need to stop your desktop GUI too."}, {"owner": {"reputation": 103, "user_id": 5043237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6572aa359534e116fc5b5bdbe6ce45ed?s=128&d=identicon&r=PG&f=1", "display_name": "ikk", "link": "https://stackoverflow.com/users/5043237/ikk"}, "edited": false, "score": 0, "creation_date": 1435135907, "post_id": 31019603, "comment_id": 50068898, "body": "Its an Nvidia Tesla graphics card. Please suggest a specific driver that I should install to fix the issue. OS is RHEL"}, {"owner": {"reputation": 7948, "user_id": 4899330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/857a19fa016a8fc6c0a3250f03f108a9?s=128&d=identicon&r=PG&f=1", "display_name": "doqtor", "link": "https://stackoverflow.com/users/4899330/doqtor"}, "edited": false, "score": 1, "creation_date": 1435140263, "post_id": 31019603, "comment_id": 50071904, "body": "Install latest <a href=\"https://developer.nvidia.com/cuda-downloads\" rel=\"nofollow noreferrer\">CUDA</a>, there is driver too."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 5043237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6572aa359534e116fc5b5bdbe6ce45ed?s=128&d=identicon&r=PG&f=1", "display_name": "ikk", "link": "https://stackoverflow.com/users/5043237/ikk"}, "edited": false, "score": 0, "creation_date": 1435219601, "post_id": 31028426, "comment_id": 50111756, "body": "Already installed the drivers. But the thing is when I run the code in root domain, it lists the GPUs while for any other user (with limited privilages) it shows only the CPU."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "reply_to_user": {"reputation": 103, "user_id": 5043237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6572aa359534e116fc5b5bdbe6ce45ed?s=128&d=identicon&r=PG&f=1", "display_name": "ikk", "link": "https://stackoverflow.com/users/5043237/ikk"}, "edited": false, "score": 0, "creation_date": 1435235006, "post_id": 31028426, "comment_id": 50121419, "body": "We can at least agree now that the driver is sufficient (at least for root). The root vs. non-root problem is a different one than what you describe in your question.  The NVIDIA GPU needs to have certain device files created before they can be usable (for any purpose).  These files must be created by a privileged user (root, or X via the kernel.)  Once created, the GPU should be usable by any user (assuming those files have permissions set correctly.)"}], "tags": [], "owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "is_accepted": true, "score": 3, "last_activity_date": 1435153713, "creation_date": 1435153713, "answer_id": 31028426, "question_id": 31019603, "link": "https://stackoverflow.com/questions/31019603/do-i-need-to-install-nvidias-sdkcuda-for-opencl-to-detect-nvidia-gpu/31028426#31028426", "title": "Do i need to install Nvidia&#39;s SDK(CUDA) for OpenCL to detect Nvidia GPU?", "body": "<p>The only thing that should be required for an NVIDIA GPU to support OpenCL is the GPU driver.  The CUDA toolkit should not be necessary.</p>\n\n<p>An appropriate NVIDIA GPU driver for your GPU and OS can be found using the wizard <a href=\"http://www.nvidia.com/Download/index.aspx?lang=en-us\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 103, "user_id": 5043237, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6572aa359534e116fc5b5bdbe6ce45ed?s=128&d=identicon&r=PG&f=1", "display_name": "ikk", "link": "https://stackoverflow.com/users/5043237/ikk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3734, "favorite_count": 0, "accepted_answer_id": 31028426, "answer_count": 1, "score": 1, "last_activity_date": 1435153713, "creation_date": 1435128688, "last_edit_date": 1435130427, "question_id": 31019603, "link": "https://stackoverflow.com/questions/31019603/do-i-need-to-install-nvidias-sdkcuda-for-opencl-to-detect-nvidia-gpu", "title": "Do i need to install Nvidia&#39;s SDK(CUDA) for OpenCL to detect Nvidia GPU?", "body": "<p>I have a code written in C (using opencl specs) to list all the available devices. My PC has an AMD FirePro as well as Nvidia's Tesla graphics card installed. I first installed <a href=\"http://developer.amd.com/tools-and-sdks/opencl-zone/amd-accelerated-parallel-processing-app-sdk/#\" rel=\"nofollow\" title=\"MD-APP-SDK-v3.0-0.113.50-Beta-linux64.tar.bz2\">AMD-APP-SDK-v3.0-0.113.50-Beta-linux64.tar.bz2</a> but it didn't seem to work so thereafter I installed OpenCL\u2122 Runtime 15.1 for Intel\u00ae Core\u2122 and Intel\u00ae Xeon\u00ae Processors for Red Hat* and SLES* Linux* OS (64-bit) &amp; then <a href=\"https://software.intel.com/en-us/articles/opencl-drivers#sdk\" rel=\"nofollow\" title=\"OpenCL\u2122 Code Builder\">OpenCL\u2122 Code Builder</a> .\nBut the following code lists only the CPU and does not detect the 2 graphics card. \n</p>\n\n<pre><code>int main() {\nint i, j;\nchar* value;\nsize_t valueSize;\ncl_uint platformCount;\ncl_platform_id* platforms;\ncl_uint deviceCount;\ncl_device_id* devices;\ncl_uint maxComputeUnits;\ncl_device_type* dev_type;\n\n// get all platforms\nclGetPlatformIDs(2, NULL, &amp;platformCount);\nplatforms = (cl_platform_id*) malloc(sizeof(cl_platform_id) * platformCount);\nclGetPlatformIDs(platformCount, platforms, NULL);\n\nfor (i = 0; i &lt; platformCount; i++) {\n\n    // get all devices\n    clGetDeviceIDs(platforms[i], CL_DEVICE_TYPE_ALL, 0, NULL, &amp;deviceCount);\n    devices = (cl_device_id*) malloc(sizeof(cl_device_id) * deviceCount);\n    clGetDeviceIDs(platforms[i], CL_DEVICE_TYPE_ALL, deviceCount, devices, NULL);\n\n\n\nclGetPlatformInfo(platforms[i], CL_PLATFORM_NAME, 0, NULL, &amp;valueSize);\n        value = (char*) malloc(valueSize);\n        clGetPlatformInfo(platforms[i], CL_PLATFORM_NAME, valueSize, value, NULL);\n        printf(\"\\n%d. Platform: %sn\", j+1, value);\n        free(value);\n\n    // for each device print critical attributes\n    for (j = 0; j &lt; deviceCount; j++) {\n\n        // print device name\n        clGetDeviceInfo(devices[j], CL_DEVICE_NAME, 0, NULL, &amp;valueSize);\n        value = (char*) malloc(valueSize);\n        clGetDeviceInfo(devices[j], CL_DEVICE_NAME, valueSize, value, NULL);\n        printf(\"\\n%d.%d Device: %sn\", j+1,1, value);\n        free(value);\n\n        // print hardware device version\n        clGetDeviceInfo(devices[j], CL_DEVICE_TYPE, 0, NULL, &amp;valueSize);\n        dev_type = (cl_device_type*) malloc(valueSize);\n        clGetDeviceInfo(devices[j], CL_DEVICE_TYPE, valueSize, dev_type, NULL);\n        if(*dev_type==CL_DEVICE_TYPE_CPU)\n        printf(\"\\nIts a CPU.\");\n        if(*dev_type==CL_DEVICE_TYPE_GPU)\n        printf(\"\\nIts a GPU.\");\n        if(*dev_type==CL_DEVICE_TYPE_ACCELERATOR)\n        printf(\"\\nIts a ACCELERATOR.\");\n\n        free(dev_type);\n\n        // print software driver version\n        clGetDeviceInfo(devices[j], CL_DRIVER_VERSION, 0, NULL, &amp;valueSize);\n        value = (char*) malloc(valueSize);\n        clGetDeviceInfo(devices[j], CL_DRIVER_VERSION, valueSize, value, NULL);\n        printf(\" \\n%d.%d Software version: %sn\", j+1, 2, value);\n        free(value);\n\n\n        // print parallel compute units\n        clGetDeviceInfo(devices[j], CL_DEVICE_MAX_COMPUTE_UNITS,\n                sizeof(maxComputeUnits), &amp;maxComputeUnits, NULL);\n        printf(\" \\n%d.%d Parallel compute units: %dn\\n\", j+1, 4, maxComputeUnits);\n\n    }\n\n    free(devices);\n\n}\n\nfree(platforms);\nreturn 0;}\n</code></pre>\n\n<p>This is what it returns:</p>\n\n<pre><code>gcc -lOpenCL 1.c -o 1 &amp;&amp; ./1\n1. Platform: AMD Accelerated Parallel Processingn\n1.1 Device: Intel(R) Xeon(R) CPU           X5660  @ 2.80GHzn\nIts a CPU. \n1.2 Software version: 1642.5 (sse2)n \n1.4 Parallel compute units: 24n\n</code></pre>\n\n<p>Do I need to install any other driver or is there anything wrong with the code?</p>\n"}, {"tags": ["c", "storage-class-specifier"], "comments": [{"owner": {"reputation": 823, "user_id": 4812238, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qFdQT.jpg?s=128&g=1", "display_name": "Ediac", "link": "https://stackoverflow.com/users/4812238/ediac"}, "edited": false, "score": 0, "creation_date": 1435127623, "post_id": 31019176, "comment_id": 50064017, "body": "<a href=\"http://stackoverflow.com/questions/21774492/what-is-a-concept-behind-using-extern-in-c-c\" title=\"what is a concept behind using extern in c c\">stackoverflow.com/questions/21774492/&hellip;</a> this might be a good read"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1435128019, "post_id": 31019176, "comment_id": 50064223, "body": "&quot;<i>I get very confused with the static and extern storage classes.</i>&quot; -- Indeed. Use <code>static</code> instead of <code>extern</code> to get the expected output."}], "answers": [{"tags": [], "owner": {"reputation": 110733, "user_id": 1009479, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wlrC5.jpg?s=128&g=1", "display_name": "Yu Hao", "link": "https://stackoverflow.com/users/1009479/yu-hao"}, "is_accepted": false, "score": 1, "last_activity_date": 1435127582, "creation_date": 1435127582, "answer_id": 31019236, "question_id": 31019176, "link": "https://stackoverflow.com/questions/31019176/extern-storage-class-variable-inside-main-function/31019236#31019236", "title": "extern storage class variable inside main function", "body": "<p>In the function <code>main</code></p>\n\n<pre><code>extern int i;\n</code></pre>\n\n<p>is a <strong>declaration</strong> of <code>i</code>, not <strong>definition</strong>. It must be defined somewhere.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint i;               //definition\nint main()\n{\n    extern int i;    //declaration\n    printf(\"%d\", i);\n}\n</code></pre>\n\n<p>In this example, the declaration is valid, but can be omitted.</p>\n"}, {"comments": [{"owner": {"reputation": 2039, "user_id": 837515, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/58b4d4cbe8c9ae5011ad3ded31bcfdd8?s=128&d=identicon&r=PG", "display_name": "cbinder", "link": "https://stackoverflow.com/users/837515/cbinder"}, "edited": false, "score": 1, "creation_date": 1442039510, "post_id": 31019254, "comment_id": 52929749, "body": "Not necessarily in some other translation unit. It can be defined in same translation unit also."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1435127631, "creation_date": 1435127631, "answer_id": 31019254, "question_id": 31019176, "link": "https://stackoverflow.com/questions/31019176/extern-storage-class-variable-inside-main-function/31019254#31019254", "title": "extern storage class variable inside main function", "body": "<p>When you declare a variable as <code>extern</code> inside a function, the compiler thinks that the variable is defined in some other <a href=\"http://en.wikipedia.org/wiki/Translation_unit_%28programming%29\" rel=\"nofollow\">translation unit</a>. If it's not defined anywhere else, then you will get a linker error saying that the linker can't find the variable.</p>\n"}, {"tags": [], "owner": {"reputation": 114, "user_id": 3721279, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001407486503/picture?type=large", "display_name": "Mukul", "link": "https://stackoverflow.com/users/3721279/mukul"}, "is_accepted": false, "score": -3, "last_activity_date": 1435129618, "creation_date": 1435129618, "answer_id": 31019920, "question_id": 31019176, "link": "https://stackoverflow.com/questions/31019176/extern-storage-class-variable-inside-main-function/31019920#31019920", "title": "extern storage class variable inside main function", "body": "<p>see when you are using extern storage class in the main then our compiler use to search the declaration of the variable in the perticular location ,here extern stands for compiler that this variable is declared at any location in the program it can be local or outside the scope , if it dont found any declaration then it gives this linking error becoz it is unable to found the variable declaration.</p>\n"}], "owner": {"reputation": 393, "user_id": 4575630, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-UYbbXKrF9fQ/AAAAAAAAAAI/AAAAAAAAA4g/oogrwXBkRek/photo.jpg?sz=128", "display_name": "Divya", "link": "https://stackoverflow.com/users/4575630/divya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "closed_date": 1435139504, "answer_count": 3, "score": 0, "last_activity_date": 1435137052, "creation_date": 1435127395, "last_edit_date": 1435137052, "question_id": 31019176, "link": "https://stackoverflow.com/questions/31019176/extern-storage-class-variable-inside-main-function", "closed_reason": "Duplicate", "title": "extern storage class variable inside main function", "body": "<p>I get very confused with the static and extern storage classes. I do not understand what is wrong with the below code snippet. I expect the printf to print the value Zero. The build is failing with the error \"Undefined reference to 'i' \". I expect the statement \"extern int i\" to be a valid <strong>C</strong> statement. Is it not?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nvoid main()\n{\n extern int i;\n printf(\"%d\", i);\n }\n</code></pre>\n"}, {"tags": ["c", "string", "function", "pointers", "string-literals"], "answers": [{"tags": [], "owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "is_accepted": true, "score": 4, "last_activity_date": 1435127480, "creation_date": 1435127480, "answer_id": 31019198, "question_id": 31019154, "link": "https://stackoverflow.com/questions/31019154/c-function-and-char/31019198#31019198", "title": "C function and char *", "body": "<p><code>\"poll1\"</code> is a string literal with type length-6 array of char, <code>char[6]</code>. The data itself is stored in read-only memory. Your function parameter <code>pol</code> may look like an array, but it is adjusted to <code>char*</code>, giving you this:</p>\n\n<pre><code>void print_pol(char* pol){ ...\n</code></pre>\n\n<p>When you pass it the literal to the function, it decays into a pointer to its first element. No allocation is required on your side.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1435128773, "last_edit_date": 1435128773, "creation_date": 1435127731, "answer_id": 31019283, "question_id": 31019154, "link": "https://stackoverflow.com/questions/31019154/c-function-and-char/31019283#31019283", "title": "C function and char *", "body": "<p>In your code <code>\"pol1\"</code> is called a <a href=\"https://en.wikipedia.org/wiki/String_literal\" rel=\"nofollow\"><em>string literal</em></a>. During compilation time, this data is stored into some memory area (<em>usually read-only memory, which cannot be altered, or atleast any attempt to alter the contents will result in  <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">UB</a></em>) which is allocated by the compiler itself. </p>\n\n<p>When you use it, you essentially pass the base address of the string literal and collect it into a <code>char *</code> ( same as <code>char []</code> in case of usage in function parameter). There is no need for any allocation from your side.</p>\n"}, {"tags": [], "owner": {"reputation": 904, "user_id": 2711402, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f60d62777fda717173de19b2de003018?s=128&d=identicon&r=PG&f=1", "display_name": "Rndp13", "link": "https://stackoverflow.com/users/2711402/rndp13"}, "is_accepted": false, "score": 0, "last_activity_date": 1435127936, "creation_date": 1435127936, "answer_id": 31019347, "question_id": 31019154, "link": "https://stackoverflow.com/questions/31019154/c-function-and-char/31019347#31019347", "title": "C function and char *", "body": "<pre><code>void print_pol(char pol[])\n{        \n  printf(\"%s\", pol);\n}\n\n\nint main()\n{\n  print_pol(\"pol1\");\n  return 0;\n}\n</code></pre>\n\n<p>Once you call the function <code>print_pol(\"pol1\")</code>, in the function definition it is converted to a pointer and <code>print_pol(char* pol);</code> <code>char *pol</code> points exactly to the first location of the character array.</p>\n\n<p>Hence no memory is needed or allocated for the same.</p>\n"}, {"tags": [], "owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "is_accepted": false, "score": 0, "last_activity_date": 1435129660, "creation_date": 1435129660, "answer_id": 31019937, "question_id": 31019154, "link": "https://stackoverflow.com/questions/31019154/c-function-and-char/31019937#31019937", "title": "C function and char *", "body": "<p>The compiler compiles <code>print_pol(\"pol1\")</code> as follows:</p>\n\n<ul>\n<li><p>Allocate a block of 5 consecutive characters in a read-only memory segment of the executable image, containing the characters <code>'p'</code>, <code>'o'</code>, <code>'l'</code>, <code>'1'</code> followed by the null character (<code>'\\0'</code>).</p></li>\n<li><p>Pass the memory address of that block to function <code>print_pol</code>.</p></li>\n</ul>\n\n<p>So to answer your question, the compiler allocates this memory.</p>\n"}], "owner": {"reputation": 310, "user_id": 5041993, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/0jAKz.jpg?s=128&g=1", "display_name": "linofex", "link": "https://stackoverflow.com/users/5041993/linofex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 31019198, "answer_count": 4, "score": 2, "last_activity_date": 1435129660, "creation_date": 1435127325, "last_edit_date": 1435128609, "question_id": 31019154, "link": "https://stackoverflow.com/questions/31019154/c-function-and-char", "title": "C function and char *", "body": "<p>I have this function:</p>\n\n<pre><code>void print_pol(char* pol); //or char[]\n    printf(\"%s\", pol);\n}\n</code></pre>\n\n<p>In <code>main()</code>, I call this function as below</p>\n\n<pre><code>print_pol(\"pol1\");\n</code></pre>\n\n<p>But I didn't allocate memory for <code>char* pol</code> in the program. So how is this possible? I know that a pointer must point to something.</p>\n"}, {"tags": ["c", "macos"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1435128637, "post_id": 31019140, "comment_id": 50064546, "body": "You need to study how integers and floating point variables work. <code>5&#47;9</code> doesn&#39;t make any sense in C, for example."}, {"owner": {"reputation": 5, "user_id": 5032369, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5a77f48d310140ac336711ff76a11365?s=128&d=identicon&r=PG&f=1", "display_name": "user5032369", "link": "https://stackoverflow.com/users/5032369/user5032369"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1435130176, "post_id": 31019140, "comment_id": 50065473, "body": "Thank you for reminding me, hhehehe"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5032369, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5a77f48d310140ac336711ff76a11365?s=128&d=identicon&r=PG&f=1", "display_name": "user5032369", "link": "https://stackoverflow.com/users/5032369/user5032369"}, "edited": false, "score": 0, "creation_date": 1435130343, "post_id": 31019173, "comment_id": 50065571, "body": "And can you please explain why should i not use &amp;str in my code ?"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 5, "user_id": 5032369, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5a77f48d310140ac336711ff76a11365?s=128&d=identicon&r=PG&f=1", "display_name": "user5032369", "link": "https://stackoverflow.com/users/5032369/user5032369"}, "edited": false, "score": 0, "creation_date": 1435130761, "post_id": 31019173, "comment_id": 50065835, "body": "@user5032369 , It might have worked for your friend. But undefined behavior is undefined. It might work, might not, or do something weird. It might stop working on adding a simple <code>printf</code> somewhere etc etc. Read the third paragraph of my answer to know why you need to use <code>str</code> instead of <code>&amp;str</code>. Alternatively, browse through similar questions on StackOverflow like <a href=\"http://stackoverflow.com/questions/8921617/c-why-no-for-strings-in-scanf-function\">this</a>"}], "tags": [], "owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "is_accepted": false, "score": 1, "last_activity_date": 1435127811, "last_edit_date": 1435127811, "creation_date": 1435127372, "answer_id": 31019173, "question_id": 31019140, "link": "https://stackoverflow.com/questions/31019140/why-does-it-keep-on-giving-me-this-error-in-c/31019173#31019173", "title": "Why does it keep on giving me this error in c", "body": "<p><code>%*s</code> instructs <code>scanf</code> to scan and discard the sting scanned. The compiler is complaining because the second argument of that <code>scanf</code>(<code>&amp;s</code>) is not used.</p>\n\n<p>You probably wanted to use <code>%s</code> or <code>%19s</code>(tells <code>scanf</code> to scan a maximum of 19 characters + 1 for the NUL-terminator) which prevent buffer overflows.</p>\n\n<p>Also change the second argument of <code>scanf</code> to <code>s</code>. This is done because <code>%s</code> expects a <code>char*</code> while <code>&amp;s</code> is of type <code>char(*)[20]</code>. <code>s</code> gets converted into <code>&amp;s[0]</code>, a <code>char*</code>, exactly what <code>%s</code> expects.</p>\n\n<p>So the <code>scanf</code></p>\n\n<pre><code>scanf(\"%*s\", &amp;str);\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>scanf(\"%s\", str);\n</code></pre>\n\n<p>for the reasons explained above.</p>\n\n<hr>\n\n<p>BTW, Your code exhibits Undefined Behavior because when you use</p>\n\n<pre><code>float formulaf = (fahrenheit - 32.0) * 5/9;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>float formulac = celsius * 9/5 + 32.0;\n</code></pre>\n\n<p><code>farenheit</code> and <code>celsius</code> are uninitialized. Move it after they get initialized,i.e, move it after</p>\n\n<pre><code>scanf(\"%f\", &amp;fahrenheit);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>scanf(\"%f\", &amp;celsius);\n</code></pre>\n\n<p>respectively. </p>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1435127438, "creation_date": 1435127438, "answer_id": 31019190, "question_id": 31019140, "link": "https://stackoverflow.com/questions/31019140/why-does-it-keep-on-giving-me-this-error-in-c/31019190#31019190", "title": "Why does it keep on giving me this error in c", "body": "<p>If you read e.g. <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow\">this <code>scanf</code> reference</a> you will see that the <code>\"*\"</code> modifier in the format string means the scanned string will not be used.</p>\n\n<p>Also, when scanning for strings, you should not use the address-of operator, as strings already are pointers.</p>\n"}], "owner": {"reputation": 5, "user_id": 5032369, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5a77f48d310140ac336711ff76a11365?s=128&d=identicon&r=PG&f=1", "display_name": "user5032369", "link": "https://stackoverflow.com/users/5032369/user5032369"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1435127872, "creation_date": 1435127259, "last_edit_date": 1435127872, "question_id": 31019140, "link": "https://stackoverflow.com/questions/31019140/why-does-it-keep-on-giving-me-this-error-in-c", "title": "Why does it keep on giving me this error in c", "body": "<pre><code>float fahrenheit;\nfloat celsius;\nfloat formulaf = (fahrenheit - 32.0) * 5/9;\nchar str[20];\nfloat formulac = celsius * 9/5 + 32.0;\nprintf(\"Choose either fahrenheit or celsius; \");\nscanf(\"%*s\", &amp;str);\nif (strcmp(str, \"fahrenheit\") ==0)\n{\n    printf(\"Enter the temperature in fahrenheit: \");\n    scanf(\"%f\", &amp;fahrenheit);\n    printf(\"%.2f fahrenheit is %.2f celsius\", fahrenheit, formulaf);\n}\nelse\n{\n    printf(\"Enter the temperature in celsius: \");\n    scanf(\"%f\", &amp;celsius);\n    printf(\"%.2f celsius is %.2f fahrenheit\", celsius, formulac);\n}\n</code></pre>\n\n<p>I'm coding this in xcode, I have created the headers and everything, this is the main part where I am stuck, it gives an error in the following code and it gives breakpoints in some other lines, please help me solve this</p>\n\n<p><code>scanf(\"%*s\", &amp;s);</code> -------> data argument not used by format string </p>\n\n<p>what does this mean?</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 2, "creation_date": 1435126348, "post_id": 31018891, "comment_id": 50063353, "body": "Use <code>scanf(&quot; %c&quot;,&amp;additionalbuilding);</code>."}, {"owner": {"reputation": 31, "user_id": 4973069, "user_type": "registered", "profile_image": "https://graph.facebook.com/843471552400614/picture?type=large", "display_name": "Brandyn Fisher", "link": "https://stackoverflow.com/users/4973069/brandyn-fisher"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1435126527, "post_id": 31018891, "comment_id": 50063440, "body": "haha thankyou that works"}], "answers": [{"tags": [], "owner": {"reputation": 2667, "user_id": 4958370, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J6Dhp.png?s=128&g=1", "display_name": "Sourav Kanta", "link": "https://stackoverflow.com/users/4958370/sourav-kanta"}, "is_accepted": false, "score": 0, "last_activity_date": 1435126554, "creation_date": 1435126554, "answer_id": 31018962, "question_id": 31018891, "link": "https://stackoverflow.com/questions/31018891/second-scanf-wont-run-program-just-terminates-c/31018962#31018962", "title": "Second scanf wont run, program just terminates. C", "body": "<p>This is because the previous \\n from the integer input stays in buffer.Use a getchar before the scanf to get rid of it</p>\n\n<pre><code>printf(\"Specify a HQ level. (1-20): \");\nscanf(\"%d\",&amp;HQ);\ngetchar();\nprintf(\"Would you like another building? (y/n): \");\nscanf(\"%c\",&amp;additionalbuilding);\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4973069, "user_type": "registered", "profile_image": "https://graph.facebook.com/843471552400614/picture?type=large", "display_name": "Brandyn Fisher", "link": "https://stackoverflow.com/users/4973069/brandyn-fisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "closed_date": 1435126582, "answer_count": 1, "score": -1, "last_activity_date": 1435126554, "creation_date": 1435126318, "last_edit_date": 1435126401, "question_id": 31018891, "link": "https://stackoverflow.com/questions/31018891/second-scanf-wont-run-program-just-terminates-c", "closed_reason": "Duplicate", "title": "Second scanf wont run, program just terminates. C", "body": "<p>This program works properly with only 1 printf scanf pair. when i add the second pair and run the program, it lets me input the first variable. but skips over and the second and terminates the program. whats wrong?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n//Version A-1.0\n\nmain\n{\n    //Variables\n    int HQ;\n    char additionalbuilding;\n\n    //Prompt user to specify a HQ level\n    printf(\"Specify a HQ level. (1-20): \");\n    scanf(\"%d\",&amp;HQ);\n    printf(\"Would you like another building? (y/n): \");\n    scanf(\"%c\",&amp;additionalbuilding);\n}\n</code></pre>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 94195, "user_id": 410767, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c1dd4727d07c7dbb6ff8c3a83e400b5?s=128&d=identicon&r=PG", "display_name": "Tony Delroy", "link": "https://stackoverflow.com/users/410767/tony-delroy"}, "edited": false, "score": 0, "creation_date": 1435125602, "post_id": 31018624, "comment_id": 50063008, "body": "Your <code>static char str[9]; &#47;&#47;permuting string</code> is implicitly initialised to NULs (a side-effect of being <code>static</code>), then you overwrite character <code>[7]</code>, but the initial terminating NUL is still there at <code>[0]</code> such that <code>strlen()</code> in <code>print</code> considers it an empty string, <code>ln</code> is therefore <code>-1</code> and your <code>i &lt;= ln</code> loop condition is never satisfied ==&gt; nothing printed."}, {"owner": {"reputation": 341, "user_id": 5043121, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fMgxZ.jpg?s=128&g=1", "display_name": "Saad", "link": "https://stackoverflow.com/users/5043121/saad"}, "reply_to_user": {"reputation": 94195, "user_id": 410767, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c1dd4727d07c7dbb6ff8c3a83e400b5?s=128&d=identicon&r=PG", "display_name": "Tony Delroy", "link": "https://stackoverflow.com/users/410767/tony-delroy"}, "edited": false, "score": 0, "creation_date": 1435126173, "post_id": 31018624, "comment_id": 50063270, "body": "but in &#39;ini()&#39; I set the str[0] to be &#39;A&#39; instead of null."}, {"owner": {"reputation": 94195, "user_id": 410767, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c1dd4727d07c7dbb6ff8c3a83e400b5?s=128&d=identicon&r=PG", "display_name": "Tony Delroy", "link": "https://stackoverflow.com/users/410767/tony-delroy"}, "edited": false, "score": 0, "creation_date": 1435126307, "post_id": 31018624, "comment_id": 50063336, "body": "then try calling <code>ini()</code> from <code>main()</code>: that&#39;s where the Operating System starts your program running."}, {"owner": {"reputation": 341, "user_id": 5043121, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fMgxZ.jpg?s=128&g=1", "display_name": "Saad", "link": "https://stackoverflow.com/users/5043121/saad"}, "reply_to_user": {"reputation": 94195, "user_id": 410767, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c1dd4727d07c7dbb6ff8c3a83e400b5?s=128&d=identicon&r=PG", "display_name": "Tony Delroy", "link": "https://stackoverflow.com/users/410767/tony-delroy"}, "edited": false, "score": 0, "creation_date": 1435126564, "post_id": 31018624, "comment_id": 50063464, "body": "how stupid of me!!!!!! Thanks a lot. Now the program runs just fine."}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1435127661, "post_id": 31018624, "comment_id": 50064046, "body": "When using Visual Studio, start your program in Debug by pressing <code>F11</code> to &quot;Step Into&quot; the program. After that you can press <code>F11</code> to &quot;step into&quot; any function call or <code>F10</code> to continue to the next instruction."}, {"owner": {"reputation": 94195, "user_id": 410767, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2c1dd4727d07c7dbb6ff8c3a83e400b5?s=128&d=identicon&r=PG", "display_name": "Tony Delroy", "link": "https://stackoverflow.com/users/410767/tony-delroy"}, "reply_to_user": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1435127769, "post_id": 31018624, "comment_id": 50064109, "body": "@kfsone: the IDE in the image posted with the question isn&#39;t VS."}], "answers": [{"comments": [{"owner": {"reputation": 5413, "user_id": 1743849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5cwvZ.jpg?s=128&g=1", "display_name": "rakeb.mazharul", "link": "https://stackoverflow.com/users/1743849/rakeb-mazharul"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1435127848, "post_id": 31018930, "comment_id": 50064147, "body": "The OP&#39;s code does not changing the 9th character from <code>A</code> to <code>z</code> so <code>strcmp(str, test)</code> is not going to return 0. I modified my answer. Ty."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1435128463, "post_id": 31018930, "comment_id": 50064436, "body": "Yes, you&#39;re right, I did not check the complete logic. Good point. Would you mind adding this info in the answer itself instead of leaving it as a comment? it&#39;s a rather important one."}], "tags": [], "owner": {"reputation": 5413, "user_id": 1743849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5cwvZ.jpg?s=128&g=1", "display_name": "rakeb.mazharul", "link": "https://stackoverflow.com/users/1743849/rakeb-mazharul"}, "is_accepted": true, "score": 0, "last_activity_date": 1435128695, "last_edit_date": 1435128695, "creation_date": 1435126438, "answer_id": 31018930, "question_id": 31018624, "link": "https://stackoverflow.com/questions/31018624/printf-function-not-working/31018930#31018930", "title": "printf() function not working", "body": "<p>You decleared, </p>\n\n<pre><code>static char str[9]; \n</code></pre>\n\n<p>So, all elements in <code>str</code> is <code>NULL</code> (<code>\\0</code>) now. Then,</p>\n\n<pre><code>ln = (int)(strlen(str)-1);\n</code></pre>\n\n<p>Here, <code>strlen</code> counts characters until a <code>\\0</code> found. So, as the first character in <code>str</code> is <code>\\0</code>, <code>ln</code> will be <code>-1</code>. In the <code>for loop</code>,</p>\n\n<pre><code>for(i = 0; i &lt;= ln; i++)\n</code></pre>\n\n<p><code>i &lt;= ln</code> condition will fail.</p>\n\n<p>You may try, in the <code>main</code> function,</p>\n\n<pre><code>str[0] = (char) i; \n</code></pre>\n\n<p>or, call <code>ini()</code> before calling <code>print(str);</code></p>\n\n<p>But careful, your <code>while loop</code> will never break! As <code>c</code>'s never gonna be <code>0</code>.<br>\nBecause your code does not changing the 9th character from <code>A</code> to <code>z</code> so strcmp(str, test) is not going to <code>return 0</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1435126972, "last_edit_date": 1435126972, "creation_date": 1435126590, "answer_id": 31018970, "question_id": 31018624, "link": "https://stackoverflow.com/questions/31018624/printf-function-not-working/31018970#31018970", "title": "printf() function not working", "body": "<p>In your case, <code>str</code> is a global static array, all elements are initialized to 0.</p>\n\n<p>Next, in your code, you're only setting the index 7 and trying to pass the array to <code>print()</code> function. But the fact is, the very first element is a <code>null</code> (NOte: not a <code>NULL</code>, it's <code>null</code> which is <code>0</code> or <code>'\\0'</code>). So, the call to <code>strlen()</code> inside <code>print()</code> will return a <code>0</code>. So, the immediate <code>printf()</code> will print nothing.</p>\n\n<p>That said, I think, the next  <code>printf()</code> you meant to write as <code>printf(\"\\n\");</code></p>\n\n<p><strong>TL;DR Solution:</strong> You're missing a call to <code>ini()</code> in your <code>main()</code> at the start, please add that.</p>\n"}, {"tags": [], "owner": {"reputation": 341, "user_id": 5043121, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fMgxZ.jpg?s=128&g=1", "display_name": "Saad", "link": "https://stackoverflow.com/users/5043121/saad"}, "is_accepted": false, "score": 0, "last_activity_date": 1435126657, "creation_date": 1435126657, "answer_id": 31018989, "question_id": 31018624, "link": "https://stackoverflow.com/questions/31018624/printf-function-not-working/31018989#31018989", "title": "printf() function not working", "body": "<p>It looks like I did not call the ini() function from the main(). Calling it will initialize the strings so that the null byte is moved to the end. After that the program works just fine. So question closed.</p>\n"}], "owner": {"reputation": 341, "user_id": 5043121, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fMgxZ.jpg?s=128&g=1", "display_name": "Saad", "link": "https://stackoverflow.com/users/5043121/saad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 731, "favorite_count": 0, "accepted_answer_id": 31018930, "answer_count": 3, "score": -5, "last_activity_date": 1435128695, "creation_date": 1435125215, "last_edit_date": 1435125558, "question_id": 31018624, "link": "https://stackoverflow.com/questions/31018624/printf-function-not-working", "title": "printf() function not working", "body": "<p>i have created a c program to print all possible strings of 8 characters. But the printf() function inside the program does not work at all. Here's the program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;conio.h&gt;\nvoid ini(void);\nvoid check(void);\nvoid add(void);\nstatic char str[9]; //permuting string\nstatic char test[9]; //test string\nstatic short int c = 1;\nvoid print(char*);\nvoid print(char a[]) {\n    short int i,ln = (int)(strlen(str)-1);\n    for(i = 0; i &lt;= ln; i++)\n    printf(\"%c\",a[i]);\n    printf(\"n\");\n}\nvoid ini() {\n    //initialzing the strings.\n    short int i = 0;\n    for(i = 0; i &lt; 9; i++){\n        str[i] = 'A';\n        test[i]= 'z';\n    }\n    puts(\"ini.....\");\n    //initializing done\n}\nvoid check() {\n    //check if the strings 'str' and 'test' are equal\n    c = strcmp(str, test);\n    puts(\"checking..........\");\n}\nvoid add() {\n    //this is the heart of the program\n    short int i = 0;\n    for( i = 7; i &gt; 0; i--)\n    {\n        if((int)str[i] &gt;= (int)'z') {\n            str[i] = 'A';\n            str[i-1]++;\n        }\n        else if(str[i] &lt; 'z'){\n            str[i]++;\n            break;\n        }\n    }\n    puts(\"adding.......\");\n}\nint main() {\n    //now we execute the functions above\n    puts(\"in main.....\");\n    int i = 0;\n    while( c != 0 ) //execute the loop while the permuting string 'str' is not equal to the final string 'test'\n    {\n        puts(\"inside while.......\");\n        for(i = 65; i &lt;= 122; i++) { //loop to make the last character of 'str' permute from 'a' to'Z'\n            str[7] = (char)i;\n            puts(\"inside for\");\n            print(str); //print the whole string to the screen\n        }\n        add(); //change the next char\n        check(); //check to see if 'str' has reached it's final point.\n    }\n    return 1;\n    getch();\n}\n</code></pre>\n\n<p>and here's the result.............</p>\n\n<p><img src=\"https://i.stack.imgur.com/3UZmM.png\" alt=\"enter image description here\"></p>\n\n<p>The program enters the for loop in main() but it does not execute the print() function. I have tried printf() but that shows the same result. What am I doing wrong?</p>\n"}, {"tags": ["c", "file", "fopen", "ulimit"], "comments": [{"owner": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "edited": false, "score": 1, "creation_date": 1435125587, "post_id": 31018593, "comment_id": 50063002, "body": "Read <code>fopen</code> and use it."}, {"owner": {"reputation": 2304, "user_id": 1851302, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/IwbKa.jpg?s=128&g=1", "display_name": "KNU", "link": "https://stackoverflow.com/users/1851302/knu"}, "edited": false, "score": 1, "creation_date": 1435125834, "post_id": 31018593, "comment_id": 50063119, "body": "IF you know how to create one file using C, you can then combine the concept of <code>for-loop</code> to create n files having file names with changing suffix e.g. file01, file02, fileN ...."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1435127091, "post_id": 31018593, "comment_id": 50063750, "body": "<code>Need to know</code>...Good. <code>(implicit) Did not try anything myself</code>...Bad."}], "answers": [{"tags": [], "owner": {"reputation": 1100, "user_id": 4108078, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ce4abd04c86b9c50e967e4222b69574d?s=128&d=identicon&r=PG&f=1", "display_name": "Rupsingh", "link": "https://stackoverflow.com/users/4108078/rupsingh"}, "is_accepted": false, "score": 0, "last_activity_date": 1435129259, "last_edit_date": 1435129259, "creation_date": 1435126862, "answer_id": 31019033, "question_id": 31018593, "link": "https://stackoverflow.com/questions/31018593/how-to-create-and-open-many-files-using-c-program-say-n-files/31019033#31019033", "title": "How to create and open many files using c program ? (say n files)", "body": "<pre><code>FILE *fp[n];\nfor(i=0;i&lt;n;i++)\n{\n  fp=fopen(\"filename\",\"mode\");\n\n  /*Do What you want with these files....*/\n\n  fclose(fp);\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 3478189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tV3eD.jpg?s=128&g=1", "display_name": "Dilshad PT", "link": "https://stackoverflow.com/users/3478189/dilshad-pt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 445, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1435129259, "creation_date": 1435125137, "question_id": 31018593, "link": "https://stackoverflow.com/questions/31018593/how-to-create-and-open-many-files-using-c-program-say-n-files", "title": "How to create and open many files using c program ? (say n files)", "body": "<p>I need to know how to create many empty files and open them simultaneously using a c program. </p>\n"}, {"tags": ["c", "operators"], "answers": [{"comments": [{"owner": {"reputation": 1242, "user_id": 4845608, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/8k6sK.png?s=128&g=1", "display_name": "walkerlala", "link": "https://stackoverflow.com/users/4845608/walkerlala"}, "edited": false, "score": 0, "creation_date": 1435125124, "post_id": 31018381, "comment_id": 50062807, "body": "So I can only use it to compare between valid latin character? Is there any other way to break this limit?"}, {"owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "reply_to_user": {"reputation": 1242, "user_id": 4845608, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/8k6sK.png?s=128&g=1", "display_name": "walkerlala", "link": "https://stackoverflow.com/users/4845608/walkerlala"}, "edited": false, "score": 0, "creation_date": 1435125233, "post_id": 31018381, "comment_id": 50062853, "body": "You can write <code>if( isalpha(c1) &amp;&amp; ((c1^c2) &amp; ~32)==0 )</code> or <code>if(tolower(c1) == tolower(c1)</code>"}, {"owner": {"reputation": 1242, "user_id": 4845608, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/8k6sK.png?s=128&g=1", "display_name": "walkerlala", "link": "https://stackoverflow.com/users/4845608/walkerlala"}, "edited": false, "score": 0, "creation_date": 1435125532, "post_id": 31018381, "comment_id": 50062986, "body": "sure it would work to use function in standard lib . But can i do it in the &quot;logic&quot; way as the code above?"}, {"owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "reply_to_user": {"reputation": 1242, "user_id": 4845608, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/8k6sK.png?s=128&g=1", "display_name": "walkerlala", "link": "https://stackoverflow.com/users/4845608/walkerlala"}, "edited": false, "score": 0, "creation_date": 1435125656, "post_id": 31018381, "comment_id": 50063033, "body": "<code>if( ( (&#39;a&#39; &lt;= ch1 &amp;&amp; ch1 &lt;= &#39;z&#39;) || (&#39;A&#39; &lt;= ch1 &amp;&amp; ch1 &lt;= &#39;Z&#39;) ) &amp;&amp; (c1^c2) &amp; ~32)==0)</code> I would use this one if my company pays me to clutter the code."}, {"owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "reply_to_user": {"reputation": 1242, "user_id": 4845608, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/8k6sK.png?s=128&g=1", "display_name": "walkerlala", "link": "https://stackoverflow.com/users/4845608/walkerlala"}, "edited": false, "score": 0, "creation_date": 1435130074, "post_id": 31018381, "comment_id": 50065419, "body": "@walkerlala I can suggest another approach. <code>char isAlpha[256] = {0};</code> Initialize this once as: <code>for(char ch1 = &#39;a&#39;, ch2 = &#39;A&#39;; ch1 &lt;= &#39;z&#39;; ++ch1, ++ch2) isAlpha[ch1] = isAlpha[ch2] = 1;</code>, later your code looks as: <code>if( isAlpha[ch1] &amp;&amp; (c1^c2) &amp; ~32)==0)</code>. This is more readable, less prone to error but requires extra memory."}], "tags": [], "owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "is_accepted": true, "score": 4, "last_activity_date": 1435129494, "last_edit_date": 1435129494, "creation_date": 1435124195, "answer_id": 31018381, "question_id": 31018335, "link": "https://stackoverflow.com/questions/31018335/use-c1c2-32-to-test-if-c1-and-c2-are-the-same-character-in-different-cas/31018381#31018381", "title": "use ((c1^c2) &amp; ~32) to test if c1 and c2 are the same character in different case", "body": "<p><code>(c1^c2) &amp; ~32)</code> xors <code>c1</code> and <code>c2</code>, the result contains the bits that are in both characters and <code>&amp;</code> with <code>~32</code> clears (ignores) the bit 5. (It is zeroed whether it was same in both or not). Comparing this with zero, checks if all the bits other than <code>bit 5</code> are same.</p>\n\n<p>This can be used to check if 2 letters are equal ignoring their case in ascii representation if you are sure that atleast <code>c1</code> or <code>c2</code> is a valid latin character(a-z, A-Z).</p>\n\n<p>To understand this, let's pick 2 characters with different case and compare them:</p>\n\n<pre><code>       +---+---+---+---+---+---+---+---+\na      | 0 | 1 | 1 | 0 | 0 | 0 | 0 | 1 |\n       +---+---+---+---+---+---+---+---+\n         |   x   |   |   |   |   |   |\n       +---+---+---+---+---+---+---+---+\nA      | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 |\n       +---+---+---+---+---+---+---+---+\n\n       +---+---+---+---+---+---+---+---+\na ^ A  | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 |\n       +---+---+---+---+---+---+---+---+\n\n       +---+---+---+---+---+---+---+---+\n32     | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 |\n       +---+---+---+---+---+---+---+---+\n\n       +---+---+---+---+---+---+---+---+\n~32    | 1 | 1 | 0 | 1 | 1 | 1 | 1 | 1 |\n       +---+---+---+---+---+---+---+---+\n\n       +---+---+---+---+---+---+---+---+\n&amp;      | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |\n       +---+---+---+---+---+---+---+---+\n</code></pre>\n\n<p>You can try the same with <code>j</code> v/s <code>J</code> or <code>t</code> v/s <code>z</code>.\nSo there is no magic involved, only this logic.</p>\n\n<p>Sometimes this condition is also written as:</p>\n\n<pre><code>if (ch1 == ch2 || (ch1 ^ 32) == ch2)\n{\n  ...\n}\n</code></pre>\n"}], "owner": {"reputation": 1242, "user_id": 4845608, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/8k6sK.png?s=128&g=1", "display_name": "walkerlala", "link": "https://stackoverflow.com/users/4845608/walkerlala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 2, "accepted_answer_id": 31018381, "answer_count": 1, "score": 3, "last_activity_date": 1435129494, "creation_date": 1435124018, "last_edit_date": 1435124635, "question_id": 31018335, "link": "https://stackoverflow.com/questions/31018335/use-c1c2-32-to-test-if-c1-and-c2-are-the-same-character-in-different-cas", "title": "use ((c1^c2) &amp; ~32) to test if c1 and c2 are the same character in different case", "body": "<p>I saw some code like this </p>\n\n<pre><code>if( ((c1^c2) &amp; ~32)==0 )\n{\n  ...\n}\n</code></pre>\n\n<p>In this snippet the code likely mean that if the <code>if</code> statement is true, then <code>c1</code> and <code>c2</code> are the same character <strong>in different case</strong>, meaning that one of those is +32 or -32 away from the other. Why is that?</p>\n\n<p>I did test myself and discover that in some case it is true while in others not:</p>\n\n<pre><code>printf(\"%d\", (65^97)&amp; ~32);   //output is 0. right\nprintf(\"%d\", (97^65)&amp; ~32);   //output is 0. right\n\nprintf(\"%d\", (50^82)&amp; ~32);   //output is 64!! not the same though 82-50=32\n</code></pre>\n\n<p>Why is that? what is the magic in it?</p>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 2, "creation_date": 1435123882, "post_id": 31018251, "comment_id": 50062321, "body": "Change <code>*start</code> with <code>(*start)</code>. The <code>-&gt;</code> probably has precedence over the <code>*</code>."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 1, "creation_date": 1435124414, "post_id": 31018251, "comment_id": 50062501, "body": "A more elaborated comment (since an answer has already been given since the previous comment): The type of <code>start</code> is <code>struct node **</code>. The type of <code>temp</code> is <code>struct node *</code>. So your question &quot;why <code>*start</code> yields an error while <code>temp</code> doesn&#39;t&quot; is for a good reason. At this point, you don&#39;t even need to know anything about the rules of operator-precedence. Simply try to replace <code>*start</code> with <code>(*start)</code> and see if it solves the problem..."}], "answers": [{"tags": [], "owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "is_accepted": true, "score": 2, "last_activity_date": 1435124318, "last_edit_date": 1592644375, "creation_date": 1435123932, "answer_id": 31018317, "question_id": 31018251, "link": "https://stackoverflow.com/questions/31018251/request-for-member-in-something-not-in-structure/31018317#31018317", "title": "request for member in something not in structure", "body": "<p>Replace <code>*start-&gt;prev</code> with <code>(*start)-&gt;prev</code> because <code>-&gt;</code> operator binds tighter than <code>*</code> operator in <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">C precedance table</a>.</p>\n<p>When you write: <code>*start-&gt;prev</code><BR>\nYou expect it to be: <code>(*start)-&gt;prev</code><BR>\nBut actually it is: <code>*(start-&gt;prev)</code></p>\n<hr />\n<p><sup>p.s. Operator are not ordered from left to right (reading direction of english) as one might expect. For example result of <code>2 + 3 * 5</code> is <code>17</code> and <strong>not</strong> <code>25</code>. This is because <code>*</code> will be performed before performing <code>+</code>, because <code>*</code> operator has more precedance than <code>+</code> operator.</sup></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4418808"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 1, "accepted_answer_id": 31018317, "answer_count": 1, "score": 0, "last_activity_date": 1435125201, "creation_date": 1435123537, "last_edit_date": 1435124647, "question_id": 31018251, "link": "https://stackoverflow.com/questions/31018251/request-for-member-in-something-not-in-structure", "title": "request for member in something not in structure", "body": "<p>Hi I have the below function which is giving me the error as </p>\n\n<p><strong>error: request for member \u2018prev\u2019 in something not a structure or union</strong></p>\n\n<pre><code>void insert(struct node **start){\n        struct node *temp=*start,*next_node,obj;\n        int pos=0;\n        if(temp==NULL)\n        {\n                printf(\"The linked list is empty creating the linked list !!!!!!\\n\");\n                next_node=malloc(sizeof(struct node));\n                if(next_node==NULL)\n                {\n                        printf(\"\\n Sorry out of Memory !!!!!!! \");\n                }\n                else\n                {\n                        printf(\"\\n Adding the first element in the list !!!!!!\");\n                        enterData(&amp;obj);\n                        next_node-&gt;data1=obj.data1;\n                        next_node-&gt;data2=obj.data2;\n                        next_node-&gt;prev=NULL;\n                        next_node-&gt;next=NULL;\n                        *start=next_node;\n                        printf(\"\\n The linked list created sucessfully !!!!!!!!! \");\n                }\n        }\n        else{\n                printf(\"Enter the position where you want to Enter the element \\n\");\n                scanf(\"%d\",&amp;pos);\n                if(pos==1)\n                {\n                        printf(\"\\n Adding the element at the begining of the list !!!!! \");\n                        next_node=malloc(sizeof(struct node));\n                        enterData(&amp;obj);\n                        next_node-&gt;data1=obj.data1;\n                        next_node-&gt;data2=obj.data2;\n                        next_node-&gt;prev=NULL;\n                        next_node-&gt;next=*start;\n                        *start-&gt;prev=next_node; //The error is at this line of code\n                        *start=next_node;\n                }\n        }\n}\n</code></pre>\n\n<p>But if instead of using <code>*start</code> in the Line of code above mentioned along with the comment if i use <code>temp</code> which is also the pointer to the structure. Then code works fine ..? Why is that so ?</p>\n"}, {"tags": ["c", "networking", "udp", "wireshark", "broadcast"], "comments": [{"owner": {"reputation": 101058, "user_id": 318758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9870a37447a4ae811096e8e7d10ed3f9?s=128&d=identicon&r=PG", "display_name": "Joni", "link": "https://stackoverflow.com/users/318758/joni"}, "edited": false, "score": 0, "creation_date": 1435130194, "post_id": 31018099, "comment_id": 50065483, "body": "What does the device use as the broadcast address in each case? You can see it in wireshark"}, {"owner": {"reputation": 16405, "user_id": 770023, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa614f9017b6dfd4fa9b4f3b39dc61c7?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/770023/paul"}, "reply_to_user": {"reputation": 101058, "user_id": 318758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9870a37447a4ae811096e8e7d10ed3f9?s=128&d=identicon&r=PG", "display_name": "Joni", "link": "https://stackoverflow.com/users/318758/joni"}, "edited": false, "score": 0, "creation_date": 1435147409, "post_id": 31018099, "comment_id": 50076662, "body": "<b>device A</b> uses <code>10.0.254.255</code> and <b>device B</b> uses <code>10.0.255.255</code>"}], "answers": [{"comments": [{"owner": {"reputation": 16405, "user_id": 770023, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa614f9017b6dfd4fa9b4f3b39dc61c7?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/770023/paul"}, "edited": false, "score": 0, "creation_date": 1435127626, "post_id": 31018916, "comment_id": 50064019, "body": "I did try to disable &quot;Capture packets in promiscuous mode&quot;, the result is the same, I can see the packets from the <b>device A</b> in wireshark"}], "tags": [], "owner": {"reputation": 101058, "user_id": 318758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9870a37447a4ae811096e8e7d10ed3f9?s=128&d=identicon&r=PG", "display_name": "Joni", "link": "https://stackoverflow.com/users/318758/joni"}, "is_accepted": false, "score": 0, "last_activity_date": 1435127279, "last_edit_date": 1435127279, "creation_date": 1435126386, "answer_id": 31018916, "question_id": 31018099, "link": "https://stackoverflow.com/questions/31018099/receive-udp-broadcast-packets-across-subnetworks-the-way-wireshark-can-do-it/31018916#31018916", "title": "Receive UDP broadcast packets across subnetworks the way wireshark can do it", "body": "<p>Wireshark puts the network adapter into \"promiscuous mode\" where it reports all  packets it sees on the network. Normally it reports only the packets destined to the host. It sounds like in your case the difference in network mask means the device will use a different broadcast address, and the packets are dropped.</p>\n\n<p>Wireshark installs a special network driver on Windows to get access to all traffic <a href=\"https://wiki.wireshark.org/WinPcap\" rel=\"nofollow\">https://wiki.wireshark.org/WinPcap</a></p>\n"}, {"tags": [], "owner": {"reputation": 457, "user_id": 4894450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6c686c2db1cfc42c18eb5640f7aeb8d?s=128&d=identicon&r=PG&f=1", "display_name": "SHASHI BHUSAN", "link": "https://stackoverflow.com/users/4894450/shashi-bhusan"}, "is_accepted": false, "score": 0, "last_activity_date": 1435140251, "creation_date": 1435140251, "answer_id": 31023632, "question_id": 31018099, "link": "https://stackoverflow.com/questions/31018099/receive-udp-broadcast-packets-across-subnetworks-the-way-wireshark-can-do-it/31023632#31023632", "title": "Receive UDP broadcast packets across subnetworks the way wireshark can do it", "body": "<p>Whenever you run wireshark .it automatically put your device (interface) in \n\"promiscuous mode\" .so it will capture all the packets which is in the air ,\nwithout bothering the subnet mask.</p>\n\n<p>whereas your PC will capture the UDP frame which is multicasted on the \nsame subnet . </p>\n"}, {"tags": [], "owner": {"reputation": 2653, "user_id": 2845044, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/781bc6fdfce6bd15a04ac3e41f1c692d?s=128&d=identicon&r=PG&f=1", "display_name": "gabhijit", "link": "https://stackoverflow.com/users/2845044/gabhijit"}, "is_accepted": true, "score": 1, "last_activity_date": 1435198492, "last_edit_date": 1435198492, "creation_date": 1435150287, "answer_id": 31027110, "question_id": 31018099, "link": "https://stackoverflow.com/questions/31018099/receive-udp-broadcast-packets-across-subnetworks-the-way-wireshark-can-do-it/31027110#31027110", "title": "Receive UDP broadcast packets across subnetworks the way wireshark can do it", "body": "<p>One thing is - Wireshark uses promiscuous mode - so it can read anything that comes on the switch port. This might include your own broadcasts, some other broadcasts and even some uni/multicasts which are not meant for you - provided the packet comes to that switch port. This is not the case with your program. Your program is trying to receive datagrams for the <em>network broadast address</em> only. Now the explanation below would help. </p>\n\n<p>I think you are confusing network Addresses and broadcast domains. Here is what is happening in your case </p>\n\n<p>Scenario 1. </p>\n\n<p>PC - <code>10.0.100.100</code> netmask <code>255.255.0.0</code> so the broadcast address is <code>10.0.255.255</code>, (In general anything that is <code>0</code> in netmask - if that is set to all <code>1</code>s becomes a broadcast address. )</p>\n\n<p>So anything sent to this broadcast address will be received by your App. </p>\n\n<p>Device A <code>10.0.254.83</code> netmask <code>255.255.255.0</code>. So the broadcast address is <code>10.0.254.255</code>. Note it is different from the broadcast address of PC and hence - you cannot receive them. </p>\n\n<p>So don't get confused by <em>outwardly looking identical</em> network addresses. </p>\n\n<p>Scenario 2 </p>\n\n<p>Device B - <code>10.0.255.222</code> netmask <code>255.255.0.0</code>. So The broadcast address is <code>10.0.255.255</code>. This is same as your PC's address in scenario 1 above and hence can receive the datagrams (without being in promiscuous mode). (The <code>255.222</code> part might look like a different network, but it is not because the netmask is 16 byte <code>255.255.0.0</code>. </p>\n\n<p>Scenario 3 </p>\n\n<p>PC : 10.0.254.100 netmask 255.255.255.0 so the broadcast address for the network is 10.0.254.255 - which is same as Device A's broadcast address (<code>10.0.254.255</code>) in Scenario 1, but not same as broadcast address of Device B (<code>10.0.255.255</code>) in Scenario 2 and hence the expected outcome. </p>\n\n<p>In your scenario - the Device A's network is a subnet of Device B and PC's network and broadcasts are restricted to subnets only. When you move PC into the subnet you receive the broadcast of the Subnet (Senario 3). </p>\n\n<p>Edit:</p>\n\n<p>Explanation - why you can see subnetwork broadcasts in wireshark and why not in your application is - What you see in wireshark is whatever is 'received by your network card'. Since all broadcasts do have a destination mac of <code>ff:ff:ff:ff:ff</code> your card is going to receive it, but your OS stack is going to drop them as the network level address is not the network level broadcast. And Layer 2 broadcasts will be received even without promiscuous mode. \nHope that helps.</p>\n"}], "owner": {"reputation": 16405, "user_id": 770023, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa614f9017b6dfd4fa9b4f3b39dc61c7?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/770023/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1295, "favorite_count": 1, "accepted_answer_id": 31027110, "answer_count": 3, "score": 1, "last_activity_date": 1435198492, "creation_date": 1435122728, "last_edit_date": 1435147514, "question_id": 31018099, "link": "https://stackoverflow.com/questions/31018099/receive-udp-broadcast-packets-across-subnetworks-the-way-wireshark-can-do-it", "title": "Receive UDP broadcast packets across subnetworks the way wireshark can do it", "body": "<p>I have an application on the PC that should get some UDP broadcast messages from a device on the local network.</p>\n\n<p>The device periodically sends UDP broadcast messages to its subnetwork and the application should be able to receive these broadcasts. When the PC and the device are in the same subnetwork there is no problem receiving those messages.</p>\n\n<p>However, when I place the device and the PC in different subnetworks then I can no longer receive the device's broadcasts in the PC application, but I can see them in wireshark.</p>\n\n<h2>Scenario 1</h2>\n\n<p>So if I have:</p>\n\n<ul>\n<li>the PC at IP <code>10.0.100.100</code> with a subnet mask of <code>255.255.0.0</code></li>\n<li>the <strong>device A</strong> at IP <code>10.0.254.83</code> with a subnet mask of <code>255.255.255.0</code></li>\n<li><p>this proof-of-concept PC application:</p>\n\n<pre><code>#ifndef WIN32_LEAN_AND_MEAN\n#define WIN32_LEAN_AND_MEAN\n#endif\n\n#include &lt;windows.h&gt;\n#include &lt;winsock2.h&gt;\n#include &lt;ws2tcpip.h&gt;\n#include &lt;iphlpapi.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;assert.h&gt;\n\n#pragma comment(lib, \"Ws2_32.lib\")\nint main()\n{\n    WSADATA wsaData;\n\n    int iResult;\n\n    iResult = WSAStartup(MAKEWORD(2, 2), &amp;wsaData);\n    if (iResult != 0) {\n        printf(\"WSAStartup failed: %d\\n\", iResult);\n        return 1;\n    }\n    sockaddr_in si_me, si_other;\n    int s;\n    assert((s = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP)) != -1);\n    int port = 32002;\n    BOOL broadcast = TRUE;\n\n    setsockopt(s, SOL_SOCKET, SO_BROADCAST,\n        (char*)&amp;broadcast, sizeof(broadcast));\n\n    memset(&amp;si_me, 0, sizeof(si_me));\n    si_me.sin_family = AF_INET;\n    si_me.sin_port = htons(port);\n    si_me.sin_addr.s_addr = INADDR_ANY;\n\n    assert(bind(s, (sockaddr *)&amp;si_me, sizeof(sockaddr)) != -1);\n\n    while (1)\n    {\n        char buf[10000];\n        memset(buf, 0, 10000);\n        int slen = sizeof(sockaddr);\n        recvfrom(s, buf, sizeof(buf)-1, 0, (sockaddr *)&amp;si_other, &amp;slen);\n\n        char *ip = inet_ntoa(si_other.sin_addr);\n\n        printf(\"%s: %s\\n\", ip, buf);\n    }\n}\n</code></pre></li>\n</ul>\n\n<p>Then I don't receive the broadcast messages from the device.</p>\n\n<h2>Scenario 2</h2>\n\n<p>However if I have a <strong>device B</strong> at IP <code>10.0.255.222</code> with subnet mask of <code>255.255.0.0</code> I can receive the messages, even though the PC is still in another subnetwork.</p>\n\n<h2>Scenario 3</h2>\n\n<p>If I move the PC at <code>10.0.254.100</code> with subnet mask <code>255.255.255.0</code> then I can communicate with the <strong>device A</strong>, but then I cannot see the messages from the <strong>device B</strong> at <code>10.0.255.222</code>.</p>\n\n<p>The thing that confuses me more is that in both cases Wireshark can capture the packets.</p>\n\n<ol>\n<li>Why can't my application see the packets from <strong>device A</strong> and why wireshark can (in the first scenario)? What can I do similar to wireshark so I can see those packets?</li>\n<li>What's the explanation behind scenario <strong>2</strong> and <strong>3</strong>?\nSince in <strong>scenario 2</strong> the <strong>device B</strong> is clearly in another subnetwork, but the loss of communication happens only in <strong>scenario 3</strong></li>\n<li>What should I read to get a better understanding of these issues?</li>\n</ol>\n\n<p>PS: I don't think the problem comes from the UDP's unreliability.\nPPS: I did try to disable \"Capture packets in promiscuous mode\", the result is the same, I can see the packets from the <strong>device A</strong> in Wireshark</p>\n"}, {"tags": ["c", "algorithm", "geometry"], "answers": [{"tags": [], "owner": {"reputation": 1577, "user_id": 2194951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7affb96030639bbed2355ced4a80879?s=128&d=identicon&r=PG", "display_name": "Luke", "link": "https://stackoverflow.com/users/2194951/luke"}, "is_accepted": false, "score": 0, "last_activity_date": 1435124112, "last_edit_date": 1435124112, "creation_date": 1435123001, "answer_id": 31018154, "question_id": 31018071, "link": "https://stackoverflow.com/questions/31018071/efficient-algorithm-to-determine-the-shape-from-the-inputted-four-points/31018154#31018154", "title": "Efficient algorithm to determine the shape from the inputted four points", "body": "<p>My first thought was the following:</p>\n\n<ol>\n<li>Determine the lengths of each side. Use the formula <code>sqrt((a - x)^2 + (b - y)^2)</code>.</li>\n<li>Determine each of the angles.</li>\n<li>Determine which shape:\n\n<ul>\n<li>If all angles 90\n\n<ul>\n<li>If all sides equal, return SQUARE</li>\n<li>Else, return RECTANGLE</li>\n</ul></li>\n<li>Else if angle 1 = 3 and angle 2 = 4 equal\n\n<ul>\n<li>If all sides equal, return RHOMBUS</li>\n<li>Else, return Parallelogram</li>\n</ul></li>\n<li>Else if angle 1 + 2 == 180, or angle 3 + 4 == 180, return TRAPEZIUM</li>\n<li>Else, return ORDINARY QUADRILATERAL</li>\n</ul></li>\n</ol>\n\n<p>But consider the logic followed <a href=\"https://github.com/frcepeda/Contest-Archive/blob/master/UVa/11800%20-%20Determine%20the%20Shape.cpp\" rel=\"nofollow\">here</a>; they've used vector math, and simply calculate whether something is a right angle or whether two lines are parallel, rather than calculating all angles.</p>\n\n<ol>\n<li>Prepare some functions to calculate whether two lines are parallel, and whether an angle is a right angle (using vector mathematics).</li>\n<li>Sort the points so they're in the correct rotational order (the actual order is ambiguous for concave shapes, but it shouldn't matter, should still return ORDINARY QUAD).</li>\n<li>Determine the lengths of each line.</li>\n<li>Determine the shape, given the lengths and whether lines are parallel or angles right.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 105, "user_id": 3000600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51d15cc7ff169622ef22cfa44a78c9f2?s=128&d=identicon&r=PG", "display_name": "lordofire", "link": "https://stackoverflow.com/users/3000600/lordofire"}, "is_accepted": false, "score": 0, "last_activity_date": 1435129892, "last_edit_date": 1435129892, "creation_date": 1435128831, "answer_id": 31019648, "question_id": 31018071, "link": "https://stackoverflow.com/questions/31018071/efficient-algorithm-to-determine-the-shape-from-the-inputted-four-points/31019648#31019648", "title": "Efficient algorithm to determine the shape from the inputted four points", "body": "<p>Firstly, different shapes have the following relationship:</p>\n\n<pre><code>Ordinary Quadrilateral --(with one pair of parallel sides)--&gt; Trapezium \n\nTrapezium --(with additional pair of parallel sides)--&gt; Parallelogram\n\nParallelogram     \n--(with four equal straight lines)--&gt; Rhombus--(with four 90 degree angles)--&gt;square    \n|--(with four 90 degree angles)--&gt; Rectangle --(with four equal lines)--&gt; square\n</code></pre>\n\n<p>Given four points, A, B, C, D, take random one(say A), and we need to calculate statistics(angle and length) of following four pairs of points(not all), including</p>\n\n<pre><code>(1) AB and CD, A1, L1\n(2) AC and BD, A2, L2 \n(3) AB and AC, A3, L3\n(4) AB and AD, A4, L4\n</code></pre>\n\n<p>And then I think the trick comes to how to organize the branches so that we could have minimal computation and code path. My proposal is listed as follows:</p>\n\n<pre><code>A3 = getAngle(AB, AC)\nA4 = getAngle(AB, AD)\nif A3 &gt; A4\n    we know AD is the diagonal line, then use A, B, C to calculate\nelse\n    we know AC is the diagonal line, then use A, B, D to calculate\n# following suppose we use A, B, C to do the calculation, we could easily do the A, B, D thing if define new variables\nL3 = LengthEqual(AB, AC)\nA1 = getAngle(AB, AD)\nif A3 == 90 &amp;&amp; A1 == 0\n      if L3 == True\n           Square\n      else \n           Rectangle\nelse\n      A2 = getAngle(AC, BD)\n      L2 = LengthEqual(AC, BD)\n      if A2 == 0 &amp;&amp; A1 == 0\n           if L2 == True\n               Rhombus\n           else\n               Parallelogram\n      else if A2 == 0 || A1 == 0\n           Trapezium\n      else \n           Ordinary Quadrilateral\n</code></pre>\n\n<p>In this means, we could achieve relatively less computation to wisely branch to the results we want. Hope this helps.</p>\n"}], "owner": {"reputation": 413, "user_id": 4414341, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/2fa7cc3bd9ac53bdb8bc424b82ce3f45?s=128&d=identicon&r=PG&f=1", "display_name": "Alpa8", "link": "https://stackoverflow.com/users/4414341/alpa8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 579, "favorite_count": 2, "answer_count": 2, "score": -1, "last_activity_date": 1435129892, "creation_date": 1435122585, "question_id": 31018071, "link": "https://stackoverflow.com/questions/31018071/efficient-algorithm-to-determine-the-shape-from-the-inputted-four-points", "title": "Efficient algorithm to determine the shape from the inputted four points", "body": "<p>I am trying to solve <a href=\"https://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=2900\" rel=\"nofollow\">Determine the shape</a> problem on Uva. From what I can get after reading the question it that it is an Ad Hoc geometry problem in which we have to use some geometry theorem to determine what shape the four points we take as input form on a 2D plane. After spending many hours I still cannot think of any efficient algorithm which can solve the problem efficiently in the given time limit.I tried using distance formula and slopes but was not of much help.Please suggest some good algorithm or theorem I can use to solve this problem.</p>\n"}, {"tags": ["c", "python-2.7", "boost", "python-c-api"], "answers": [{"comments": [{"owner": {"reputation": 7430, "user_id": 3474956, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/RWbuy.jpg?s=128&g=1", "display_name": "kilojoules", "link": "https://stackoverflow.com/users/3474956/kilojoules"}, "edited": false, "score": 0, "creation_date": 1435172498, "post_id": 31026146, "comment_id": 50094043, "body": "Is there a simple way to parse an MPI_Comm object? <code>PyArg_ParseTuple(args, &quot;s_ssO&quot;, &amp;file1, &amp;_mpi, &amp;file2, &amp;file3, &amp;tmpp))</code>"}, {"owner": {"reputation": 33367, "user_id": 3385212, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PmQYG.png?s=128&g=1", "display_name": "tynn", "link": "https://stackoverflow.com/users/3385212/tynn"}, "reply_to_user": {"reputation": 7430, "user_id": 3474956, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/RWbuy.jpg?s=128&g=1", "display_name": "kilojoules", "link": "https://stackoverflow.com/users/3474956/kilojoules"}, "edited": false, "score": 0, "creation_date": 1435176445, "post_id": 31026146, "comment_id": 50096307, "body": "I don&#39;t know anything about MPI_Comm but maybe <code>O!</code> or <code>O&amp;</code> could be used for that."}, {"owner": {"reputation": 7430, "user_id": 3474956, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/RWbuy.jpg?s=128&g=1", "display_name": "kilojoules", "link": "https://stackoverflow.com/users/3474956/kilojoules"}, "edited": false, "score": 0, "creation_date": 1435338521, "post_id": 31026146, "comment_id": 50175810, "body": "Thanks for the great answer! I followed your advise and am now stuck on a  <code>bad_alloc</code> error which I have started a new question for <a href=\"http://stackoverflow.com/questions/31077040/stdbad-alloc-error-without-cout-works-when-i-print-variables\">here</a>"}], "tags": [], "owner": {"reputation": 33367, "user_id": 3385212, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PmQYG.png?s=128&g=1", "display_name": "tynn", "link": "https://stackoverflow.com/users/3385212/tynn"}, "is_accepted": true, "score": 2, "last_activity_date": 1435147745, "creation_date": 1435147745, "answer_id": 31026146, "question_id": 31018038, "link": "https://stackoverflow.com/questions/31018038/python-c-api-passing-two-functions-of-many-parameters-with-special-types-as-mod/31026146#31026146", "title": "Python C API: Passing two functions of many parameters with special types as module", "body": "<p>The PyCFunction type is defined as</p>\n\n<pre><code>typedef PyObject *(*PyCFunction)(PyObject *, PyObject *);\n</code></pre>\n\n<p>So you need wrap your functions with a real PyCFunction first. You could use the following as simple template of how to start with it:</p>\n\n<pre><code>static PyObject * wrap_run_mymodule(PyObject *, PyObject *args) {\n    char *file1, *file2, *file3;\n    PyObject *tmpp;\n    if(!PyArg_ParseTuple(args, \"sssO\", &amp;file1, &amp;file2, &amp;file3, &amp;tmpp))\n        return NULL;\n    return Py_BuildValue(\"i\", run_mymodule(file1, file2, file3, tmpp));\n}\n\nstatic PyMethodDef myModule_methods[] = {\n    {\"run_mymodule\", (PyCFunction) wrap_run_mymodule, METH_VARARGS},\n    {NULL, NULL}\n};\n</code></pre>\n\n<p>Also see <a href=\"https://docs.python.org/2/c-api/arg.html#c.PyArg_ParseTuple\" rel=\"nofollow\">PyArg_ParseTuple</a> to find better formats for your arguments. Especially the <code>file[123]</code> variables should be of <code>const char *</code> here.</p>\n"}], "owner": {"reputation": 7430, "user_id": 3474956, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/RWbuy.jpg?s=128&g=1", "display_name": "kilojoules", "link": "https://stackoverflow.com/users/3474956/kilojoules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "accepted_answer_id": 31026146, "answer_count": 1, "score": 1, "last_activity_date": 1435350604, "creation_date": 1435122356, "last_edit_date": 1435350604, "question_id": 31018038, "link": "https://stackoverflow.com/questions/31018038/python-c-api-passing-two-functions-of-many-parameters-with-special-types-as-mod", "title": "Python C API: Passing two functions of many parameters with special types as module", "body": "<p>I am attempting to create a Python module using C. This module has two callable functions - one with mpi support and one without. </p>\n\n<pre><code>int run_mymodule(char *file1, char *file2, char *file3, PyObject *tmpp)\n{\n  &lt;internal actions, returns int indicating return status&gt;\n}\n\nint run_mymodule_with_mpi(char *file1, int &amp;_mpi, char *file2, char *file3, PyObject *tmpp)\n{\n  &lt;internals, returns int&gt;\n}\n</code></pre>\n\n<p>Using boost, this was trivial to connect to a module (using <code>BOOST_PYTHON_MODULE</code>). However, this is proving to be more challenging using purely the python-c api. I have tried my best to create a propper interface for python, however it is not working. Here is my attempt at interfacing the C functions to python as a module. How is my approach incorrect? Where do I go from here?</p>\n\n<pre><code>static PyMethodDef myModule_methods[] = {\n    {\"run_mymodule\", run_mymodule, METH_VARARGS},\n    {\"run_mymodule_with_mpi\", run_mymodule_with_mpi, METH_VARARGS},\n    {NULL, NULL}\n    };\n\nvoid initmyModule(void)\n{\n    (void) Py_InitModule(\"myModule\", myModule_methods);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "ocaml", "ffi"], "comments": [{"owner": {"reputation": 1599, "user_id": 3748622, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4499122363977cf6a85d7fc4dec39f35?s=128&d=identicon&r=PG&f=1", "display_name": "meneldal", "link": "https://stackoverflow.com/users/3748622/meneldal"}, "edited": false, "score": 0, "creation_date": 1435123150, "post_id": 31017992, "comment_id": 50062054, "body": "Why do you have a <code>main</code> in your library? <code>main</code> should be used only for the entry point."}, {"owner": {"reputation": 57265, "user_id": 821679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f564c4721ee3125fa835f6c3a5283c?s=128&d=identicon&r=PG", "display_name": "Jeffrey Scofield", "link": "https://stackoverflow.com/users/821679/jeffrey-scofield"}, "edited": false, "score": 0, "creation_date": 1435123187, "post_id": 31017992, "comment_id": 50062062, "body": "Your C code can have a <code>main</code> as long as it calls <code>caml_main</code>."}, {"owner": {"reputation": 2425, "user_id": 2392147, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/09f00344014ef1858c322172cc0a1be3?s=128&d=identicon&r=PG&f=1", "display_name": "orm", "link": "https://stackoverflow.com/users/2392147/orm"}, "reply_to_user": {"reputation": 1599, "user_id": 3748622, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4499122363977cf6a85d7fc4dec39f35?s=128&d=identicon&r=PG&f=1", "display_name": "meneldal", "link": "https://stackoverflow.com/users/3748622/meneldal"}, "edited": false, "score": 0, "creation_date": 1435124044, "post_id": 31017992, "comment_id": 50062375, "body": "@meneldal: There is a main in <code>hello.c</code> and one in the static library. This needs to be this way because it is a c program calling ocaml code.  Ocaml doesn&#39;t know about this c program. The library has its own main for some reason, the library is a standard ocaml library."}], "answers": [{"comments": [{"owner": {"reputation": 2425, "user_id": 2392147, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/09f00344014ef1858c322172cc0a1be3?s=128&d=identicon&r=PG&f=1", "display_name": "orm", "link": "https://stackoverflow.com/users/2392147/orm"}, "edited": false, "score": 0, "creation_date": 1435160667, "post_id": 31018151, "comment_id": 50086704, "body": "Quick question. the symbols is indeed defined twice, so why is it legal given one flag ordering but illegal given a different ordering?"}, {"owner": {"reputation": 57265, "user_id": 821679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f564c4721ee3125fa835f6c3a5283c?s=128&d=identicon&r=PG", "display_name": "Jeffrey Scofield", "link": "https://stackoverflow.com/users/821679/jeffrey-scofield"}, "reply_to_user": {"reputation": 2425, "user_id": 2392147, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/09f00344014ef1858c322172cc0a1be3?s=128&d=identicon&r=PG&f=1", "display_name": "orm", "link": "https://stackoverflow.com/users/2392147/orm"}, "edited": false, "score": 0, "creation_date": 1435161885, "post_id": 31018151, "comment_id": 50087552, "body": "I&#39;m not an expert. But I think it works like this. The linker takes the first symbol it finds in a library to satisfy an external reference. If it finds the <code>main</code> in asmrun first, it takes it. But the symbol in hello.o doesn&#39;t have library semantics, it is always included. If the linker sees asmrun before hello.o there is a problem. If it sees hello.o first, it no longer has an unsatisfied reference so it doesn&#39;t care about the <code>main</code> in asmrun."}], "tags": [], "owner": {"reputation": 57265, "user_id": 821679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f564c4721ee3125fa835f6c3a5283c?s=128&d=identicon&r=PG", "display_name": "Jeffrey Scofield", "link": "https://stackoverflow.com/users/821679/jeffrey-scofield"}, "is_accepted": true, "score": 2, "last_activity_date": 1435122988, "creation_date": 1435122988, "answer_id": 31018151, "question_id": 31017992, "link": "https://stackoverflow.com/questions/31017992/main-function-already-defined-in-ocaml-asmrun-library/31018151#31018151", "title": "main function already defined in ocaml asmrun library", "body": "<p>Your command line is a little strange, as <code>-lasmrun</code> shows up twice.</p>\n\n<p>Here's something that has worked for me:</p>\n\n<pre><code>$ W=`ocamlopt -where`\n$ gcc -I $W -L $W -o hello hello.c callme.o -lasmrun -lm -ldl\n</code></pre>\n\n<p>You can see a working example in my pseudo-blog: <a href=\"http://psellos.com/2015/01/2015.01.gc-disharmony-bis.html\" rel=\"nofollow\">Further OCaml GC Disharmony</a>.</p>\n\n<p>(As I learned the hard way, make sure you follow the rules of GC harmony :-)</p>\n"}], "owner": {"reputation": 2425, "user_id": 2392147, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/09f00344014ef1858c322172cc0a1be3?s=128&d=identicon&r=PG&f=1", "display_name": "orm", "link": "https://stackoverflow.com/users/2392147/orm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 31018151, "answer_count": 1, "score": 2, "last_activity_date": 1435155117, "creation_date": 1435122087, "last_edit_date": 1435155117, "question_id": 31017992, "link": "https://stackoverflow.com/questions/31017992/main-function-already-defined-in-ocaml-asmrun-library", "title": "main function already defined in ocaml asmrun library", "body": "<p>I'm trying to call some ocaml code from a C program. I've been following some of the documentation <a href=\"http://caml.inria.fr/pub/docs/manual-ocaml/intfc.html#s%3Aembedded-code\" rel=\"nofollow\">here</a>. The c program is called <code>hello.c</code>, and it is attempting to use Ocaml functions defined in <code>callme.ml</code>. </p>\n\n<p>As in the link, I'm doing this in two steps: first compile the ml file to an object file:</p>\n\n<pre><code>ocamlopt -output-obj -o callme2.o callme.ml\n</code></pre>\n\n<p>And then attempt to link it to my 'main' binary with this code:</p>\n\n<pre><code>gcc  -Wall -I`ocamlopt -where` -L`ocamlopt -where` -lasmrun -lm -ldl  -o hello hello.c callme2.o -lasmrun\n</code></pre>\n\n<p>But I run into the following problem: <code>main</code> is already defined in libasmrun.a, and so it conflicts with the <code>main</code> in my own <code>hello.c</code>:</p>\n\n<pre><code>/tmp/ccANhYNH.o: In function `main':\nhello.c:(.text+0x58): multiple definition of `main'\n/home/orm/.opam/4.02.0/lib/ocaml/libasmrun.a(main.o):main.c:(.text+0x0): first defined here\n</code></pre>\n\n<p>How can I work around this?\n(As the library path suggests, I'm using ocaml version 4.02)</p>\n\n<p><strong>update:</strong> this problem has more to do with proper usage of C linker flags, rather than ocaml. Using the flags in the following order fixes the problem:</p>\n\n<pre><code>gcc  -Wall -I`ocamlopt -where` -L`ocamlopt -where` -o hello hello.c -lasmrun callme2.o -lm -ldl -lasmrun\n</code></pre>\n\n<p>This is interesting, because I thought it was illegal to have the same function name defined twice in the <a href=\"http://en.cppreference.com/w/cpp/language/definition\" rel=\"nofollow\">same program</a>.  Maybe this is one of the exceptions in that document. </p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 2, "last_activity_date": 1435122517, "last_edit_date": 1435122517, "creation_date": 1435121742, "answer_id": 31017921, "question_id": 31017880, "link": "https://stackoverflow.com/questions/31017880/why-updated-structure-variable-not-printing/31017921#31017921", "title": "Why updated structure variable not printing", "body": "<p><code>status</code> is a single char but you are storing a string into it, effectively doing out of bounds access (<a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\"><em>undefined behaviour</em></a>). Change it to an <em>array</em> and then you'll be able to copy.</p>\n\n<pre><code>struct scholor\n{\n    char name[25];\n    int  sem;\n    int marks;\n    char status[128];    \n};\n</code></pre>\n\n<p>and adjust the calls and passing (since <code>status</code> is an array now -- its name gets converted into a pointer t its first element when passed to functions):</p>\n\n<pre><code>  scanf(\"%s%d%d%s\",s1.name,&amp;s1.sem,&amp;s1.marks,s1.status);\n  sanction(s1.marks,s1.status);\n  printf(\"%s\",s1.status);\n</code></pre>\n\n<p>Other suggestions:<br>\n1. Use a standard prototype for <code>main</code> such as: <code>int main(void)</code><br>\n2. You could usr <code>strcpy</code> to copy the string as opposed to doing it yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 2667, "user_id": 4958370, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J6Dhp.png?s=128&g=1", "display_name": "Sourav Kanta", "link": "https://stackoverflow.com/users/4958370/sourav-kanta"}, "is_accepted": false, "score": 1, "last_activity_date": 1435122360, "last_edit_date": 1435122360, "creation_date": 1435122224, "answer_id": 31018015, "question_id": 31017880, "link": "https://stackoverflow.com/questions/31017880/why-updated-structure-variable-not-printing/31018015#31018015", "title": "Why updated structure variable not printing", "body": "<p>Your struct should have status as a character array not a character .Moreover when you scanf an array dont write &amp; before because the name itself points to the assdress of the first element.Your corrected program is :</p>\n\n<pre><code>struct scholor\n{\n  char name[25];\n  int  sem;\n  int marks;\n  char status[16];\n};\nvoid sanction(int m, char *s)\n {\n   if(m&gt;85)\n   {\n     char p[15]=\"sanctioned\";\n     char *r;\n     r=p;\n    while(*r!='\\0')\n    {\n      *s=*r;\n      s++;\n      r++;\n    }\n    *s='\\0';      \n  }\n}\nint main()\n{\n  struct scholor s1;\n  scanf(\"%s%d%d%s\",s1.name,&amp;s1.sem,&amp;s1.marks,s1.status);\n  sanction(s1.marks,s1.status);\n  printf(\"%s\",s1.status);\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4609759, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Bt2FY.jpg?s=128&g=1", "display_name": "Guru", "link": "https://stackoverflow.com/users/4609759/guru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 31017921, "answer_count": 2, "score": -2, "last_activity_date": 1435122586, "creation_date": 1435121518, "last_edit_date": 1435122586, "question_id": 31017880, "link": "https://stackoverflow.com/questions/31017880/why-updated-structure-variable-not-printing", "title": "Why updated structure variable not printing", "body": "<p>This is my code in which if student marks is greater than 85,scholarship status will be changed to <code>sanctioned</code>, but after updating it is not printing</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nstruct scholor\n{\n    char name[25];\n    int  sem;\n    int marks;\n    char status;    \n\n};\nvoid sanction(int m, char *s)\n{\n\n    if(m&gt;85)\n    {\n        char p[15]=\"sanctioned\";\n        char *r;\n        r=p;\n       while(*r!='\\0')\n       {\n        *s=*r;     \n        s++;\n        r++;\n\n       }\n       *s='\\0';\n    }\n}\nint main()\n{\n    struct scholor s1;\n    scanf(\"%s%d%d%s\",&amp;s1.name,&amp;s1.sem,&amp;s1.marks,&amp;s1.status);\n    sanction(s1.marks,&amp;s1.status);\n    printf(\"%s\",s1.status);\n}\n</code></pre>\n"}]