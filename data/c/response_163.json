[{"tags": ["mysql", "c"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519256988, "post_id": 48917362, "comment_id": 84841299, "body": "What does it mean &quot;it doesn&#39;t work&quot;?"}, {"owner": {"reputation": 145, "user_id": 3525621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bf4725b22ebadcf7c94204d9e8abcec7?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/3525621/vlad"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519257043, "post_id": 48917362, "comment_id": 84841316, "body": "The results seem to come up empty, as you can see I am using printf to output the results, and they are blank"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519257232, "post_id": 48917362, "comment_id": 84841372, "body": "How many rows do you expect? The <code>if((row = mysql_fetch_row(...)</code> line should only have the effect that the first row is not printed. And when you say <i>come up empty</i>, you mean the output is <code>&quot;Miner Protocol is: &quot;</code> or that there is no output at all?"}, {"owner": {"reputation": 15207, "user_id": 4104224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1UvuxsNkn9w/AAAAAAAAAAI/AAAAAAAAA10/vjzWlg3BR-U/photo.jpg?sz=128", "display_name": "Uueerdo", "link": "https://stackoverflow.com/users/4104224/uueerdo"}, "edited": false, "score": 0, "creation_date": 1519257235, "post_id": 48917362, "comment_id": 84841373, "body": "Since <code>mysql_fetch_row</code> does not have an argument for <i>which</i> row; I can only assume that it comsumes the current row and/or advances to the next row. If you call it in the <code>if</code> and the <code>where</code> with only one row in the result, one of the two conditions will not get a row. (or to put it more succinctly like Pablo, you are always throwing away your first row)."}, {"owner": {"reputation": 145, "user_id": 3525621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bf4725b22ebadcf7c94204d9e8abcec7?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/3525621/vlad"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519257311, "post_id": 48917362, "comment_id": 84841401, "body": "@Pablo, for now I am expecting 1 row, and yes the result is :    &quot;Miner Protocol is: &quot;."}, {"owner": {"reputation": 15207, "user_id": 4104224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1UvuxsNkn9w/AAAAAAAAAAI/AAAAAAAAA10/vjzWlg3BR-U/photo.jpg?sz=128", "display_name": "Uueerdo", "link": "https://stackoverflow.com/users/4104224/uueerdo"}, "edited": false, "score": 0, "creation_date": 1519257393, "post_id": 48917362, "comment_id": 84841424, "body": "@Vlad since you need the if for it&#39;s else, try changing your <code>while</code> to a <code>do...while</code>."}, {"owner": {"reputation": 145, "user_id": 3525621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bf4725b22ebadcf7c94204d9e8abcec7?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/3525621/vlad"}, "reply_to_user": {"reputation": 15207, "user_id": 4104224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1UvuxsNkn9w/AAAAAAAAAAI/AAAAAAAAA10/vjzWlg3BR-U/photo.jpg?sz=128", "display_name": "Uueerdo", "link": "https://stackoverflow.com/users/4104224/uueerdo"}, "edited": false, "score": 0, "creation_date": 1519257488, "post_id": 48917362, "comment_id": 84841452, "body": "@Uueerdo will a do..while be able to catch if there is no results returned? I want to be able to let me know if the results come up empty. Hence, why I out the if in front of it."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519258257, "post_id": 48917362, "comment_id": 84841652, "body": "If you are expecting one row, then it is consumed in the <code>if(...)</code> line. The next time you call <code>mysql_fetch_row</code> you should get an error value. Check the API documentation and see which value <code>mysql_fetch_row</code> returns when you call it after all rows have been fetched."}, {"owner": {"reputation": 145, "user_id": 3525621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bf4725b22ebadcf7c94204d9e8abcec7?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/3525621/vlad"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519258405, "post_id": 48917362, "comment_id": 84841691, "body": "@Pablo is there a way to have an if statement as well as a while loop for the results?"}, {"owner": {"reputation": 15207, "user_id": 4104224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1UvuxsNkn9w/AAAAAAAAAAI/AAAAAAAAA10/vjzWlg3BR-U/photo.jpg?sz=128", "display_name": "Uueerdo", "link": "https://stackoverflow.com/users/4104224/uueerdo"}, "edited": false, "score": 0, "creation_date": 1519260333, "post_id": 48917362, "comment_id": 84842200, "body": "I was suggesting use <code>if (x) { do { } while(x);}</code> so the first iteration uses the row from the <code>if</code>."}, {"owner": {"reputation": 145, "user_id": 3525621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bf4725b22ebadcf7c94204d9e8abcec7?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/3525621/vlad"}, "edited": false, "score": 0, "creation_date": 1519260508, "post_id": 48917362, "comment_id": 84842240, "body": "Can you please provide me with some example code please?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 15207, "user_id": 4104224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1UvuxsNkn9w/AAAAAAAAAAI/AAAAAAAAA10/vjzWlg3BR-U/photo.jpg?sz=128", "display_name": "Uueerdo", "link": "https://stackoverflow.com/users/4104224/uueerdo"}, "edited": false, "score": 0, "creation_date": 1519261178, "post_id": 48917362, "comment_id": 84842398, "body": "@Uueerdo I see no point in doing that, <code>while(mysql_fetch_row(...))</code> does that anyway. It&#39;s also how the documentation says you should do. The problem here seems to be that the OP doesn&#39;t realize that he/she is throwing away the first row with the <code>if</code>."}, {"owner": {"reputation": 15207, "user_id": 4104224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1UvuxsNkn9w/AAAAAAAAAAI/AAAAAAAAA10/vjzWlg3BR-U/photo.jpg?sz=128", "display_name": "Uueerdo", "link": "https://stackoverflow.com/users/4104224/uueerdo"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519261318, "post_id": 48917362, "comment_id": 84842446, "body": "@Pablo he has an <code>else</code> case; that won&#39;t work with a <code>while</code> without adding a variable to track &quot;rowsProcessed&quot;, and changing the <code>else</code> to an <code>if (rowsProcessed)</code>. <i>Your &quot;num_rows&quot; answer is probably the best, I was just pointing toward the &quot;least changes&quot; to existing code.</i>"}, {"owner": {"reputation": 145, "user_id": 3525621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bf4725b22ebadcf7c94204d9e8abcec7?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/3525621/vlad"}, "edited": false, "score": 0, "creation_date": 1519261406, "post_id": 48917362, "comment_id": 84842464, "body": "I removed the else, and put <code>if else</code> , based on the number that it returns it will either run or do something."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 15207, "user_id": 4104224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1UvuxsNkn9w/AAAAAAAAAAI/AAAAAAAAA10/vjzWlg3BR-U/photo.jpg?sz=128", "display_name": "Uueerdo", "link": "https://stackoverflow.com/users/4104224/uueerdo"}, "edited": false, "score": 0, "creation_date": 1519261433, "post_id": 48917362, "comment_id": 84842468, "body": "@Uueerdo oh yes, I didn&#39;t scroll down enough to notice that. The proper way to look if there are any results, is to use <code>mysql_num_rows</code> like I wrote in the answer."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 3525621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bf4725b22ebadcf7c94204d9e8abcec7?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/3525621/vlad"}, "edited": false, "score": 0, "creation_date": 1519259573, "post_id": 48917763, "comment_id": 84841978, "body": "Thank you, can you give me an example with the num_rows please? Never used that function, I am using mysql_store_result()."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 145, "user_id": 3525621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bf4725b22ebadcf7c94204d9e8abcec7?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/3525621/vlad"}, "edited": false, "score": 0, "creation_date": 1519260074, "post_id": 48917763, "comment_id": 84842124, "body": "I&#39;ve made an update of my answer. You have to read the documentation, I&#39;ve never used the C interface of MySQL, but I find the documentation pretty clear and easy to follow."}, {"owner": {"reputation": 145, "user_id": 3525621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bf4725b22ebadcf7c94204d9e8abcec7?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/3525621/vlad"}, "edited": false, "score": 0, "creation_date": 1519261187, "post_id": 48917763, "comment_id": 84842401, "body": "Thank you I think I got it, I can now use the num_rows functions to compare the output and go from there"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 145, "user_id": 3525621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bf4725b22ebadcf7c94204d9e8abcec7?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/3525621/vlad"}, "edited": false, "score": 0, "creation_date": 1519261244, "post_id": 48917763, "comment_id": 84842418, "body": "Yes, you should do that, I suspect that your query returns more than one row."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 2, "last_activity_date": 1519260015, "last_edit_date": 1519260015, "creation_date": 1519259389, "answer_id": 48917763, "question_id": 48917362, "link": "https://stackoverflow.com/questions/48917362/having-issues-with-if-and-while-row-mysql-fetch-rowquery-results-0/48917763#48917763", "title": "Having issues with if and while ((row = mysql_fetch_row(query_results)) !=0)", "body": "<p>Based on the <a href=\"https://dev.mysql.com/doc/refman/5.7/en/mysql-fetch-row.html\" rel=\"nofollow noreferrer\">reference page of <code>mysql_fetch_row</code></a>, you would have to do\nthis:</p>\n\n<pre><code>while((row = mysql_fetch_row(query_results)))\n{\n    printf(\"So far soo good 2\\n\");\n\n    char *result_miner =  row[0] ? row[0] : \"NULL\";\n    char *result_algorithm =  row[1] ? row[1] : \"NULL\";\n    char *result_url =  row[2] ? row[2] : \"NULL\";\n    int result_port = row[3] ? atof(row[3]) : 1;    \n    char *result_username =  row[4] ? row[4] : \"NULL\";\n    char *result_password =  row[5] ? row[5] : \"NULL\";\n    ....\n}\n</code></pre>\n\n<p>There is no need to add to put the <code>while</code> inside the <code>if((row = mysql_fetch_row(query_results)) !=0)</code>, as it will consume one\nrow and if you say you expect one row only, then this explains why you are\nseeing no values.</p>\n\n<p>The documentation says that if no more row can be fetch, <code>mysql_fetch_row</code> will\nreturn <code>NULL</code>. You say you expect 1 row, but it could be that you get 2 rows\nwhere one has empty values. Before the <code>while</code> loop you can use\n<a href=\"https://dev.mysql.com/doc/refman/5.7/en/mysql-num-rows.html\" rel=\"nofollow noreferrer\"><code>mysql_num_rows()</code></a> to see the actual number of rows in the result set. I\nsuspect that your query results in 2 rows.</p>\n\n<blockquote>\n  <p><em><a href=\"https://dev.mysql.com/doc/refman/5.7/en/mysql-num-rows.html\" rel=\"nofollow noreferrer\"><code>mysql_num_rows()</code></a></em></p>\n\n<pre><code> my_ulonglong mysql_num_rows(MYSQL_RES *result)\n</code></pre>\n  \n  <p><strong>Description</strong></p>\n  \n  <p>Returns the number of rows in the result set.</p>\n  \n  <p>The use of <code>mysql_num_rows()</code> depends on whether you use <code>mysql_store_result()</code> or <code>mysql_use_result()</code> to return the result set.\n  <strong>If you use <code>mysql_store_result()</code>, <code>mysql_num_rows()</code> may be called immediately.</strong> If you use <code>mysql_use_result()</code>, <code>mysql_num_rows()</code> does not return the correct value until all the rows in the result set have been retrieved.</p>\n</blockquote>\n\n<hr>\n\n<p><strong>edit</strong></p>\n\n<p>How to use <code>mysql_num_rows</code>.</p>\n\n<pre><code>MYSQL_RES *query_results = mysql_store_result(conn);\n\nif(query_results)\n{\n    printf (\"Number of rows: %lu\\n\",\n            (unsigned long) mysql_num_rows(query_results));\n\n    while((row = mysql_fetch_row(query_results)))\n        ...\n}\n</code></pre>\n\n<p>See also <a href=\"https://dev.mysql.com/doc/refman/5.7/en/c-api-data-structures.html#idm140136384379424\" rel=\"nofollow noreferrer\"><code>my_ulonglong</code> 27.8.5 C API Data Structures</a>.</p>\n"}], "owner": {"reputation": 145, "user_id": 3525621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/bf4725b22ebadcf7c94204d9e8abcec7?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/3525621/vlad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 48917763, "answer_count": 1, "score": 0, "last_activity_date": 1519260015, "creation_date": 1519256566, "question_id": 48917362, "link": "https://stackoverflow.com/questions/48917362/having-issues-with-if-and-while-row-mysql-fetch-rowquery-results-0", "title": "Having issues with if and while ((row = mysql_fetch_row(query_results)) !=0)", "body": "<p>For some reason my C code does not work. The SQL code is correct, when I run it into phpmyadmin I get the results I need, but if I run this code it seems to come up empty. Now interesting part is if I remove the </p>\n\n<pre><code>if((row = mysql_fetch_row(query_results)) !=0)\n</code></pre>\n\n<p>Then the while loops works, or if I remove the</p>\n\n<pre><code>        while((row = mysql_fetch_row(query_results)) !=0)\n</code></pre>\n\n<p>Then I am able to get results. Not sure why those two cannot work together, yet separately  they both work fine.</p>\n\n<pre><code>    MYSQL_RES *query_results = mysql_store_result(conn);\n\n    if (query_results) \n    { // make sure there *are* results..\n        MYSQL_ROW row;\n\n        if((row = mysql_fetch_row(query_results)) !=0)\n        {\n\n            while((row = mysql_fetch_row(query_results)) !=0)\n            {\n\n                printf(\"So far soo good 2\\n\");\n\n                /* Set a float 'f' to the value in 'row[0]', or\n                * 0.0f if it's NULL */  \n                char *result_miner =  row[0] ? row[0] : \"NULL\";\n                char *result_algorithm =  row[1] ? row[1] : \"NULL\";\n                char *result_url =  row[2] ? row[2] : \"NULL\";\n                int result_port = row[3] ? atof(row[3]) : 1;    \n                char *result_username =  row[4] ? row[4] : \"NULL\";\n                char *result_password =  row[5] ? row[5] : \"NULL\";\n\n                strcpy(miner, result_miner);\n                strcpy(algorithm, result_algorithm);\n                strcpy(url, result_url);\n                strcpy(username, result_username);\n                strcpy(password, result_password);\n                port=result_port;\n\n\n                    printf (\"Miner Protocol is: %s\\n\", miner);\n                    printf (\"Algorithm is: %s\\n\", algorithm);\n                    printf (\"Mining URL  is: %s\\n\", url);\n                    printf (\"Mining Port is: %d \\n\", port);\n                    printf (\"Username is: %s \\n\", username);\n                    printf (\"Password is: %s \\n\", password);\n\n\n            }\n\n\n        }else{\n\n            printf(\"Unable to locate active coin for hostname: %s\", hostname);\n            exit (-1);\n\n            }\n\n    /* Free results when done */\n    mysql_free_result(query_results);\n</code></pre>\n"}, {"tags": ["c", "sqlite"], "answers": [{"comments": [{"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 1, "creation_date": 1519257755, "post_id": 48917522, "comment_id": 84841526, "body": "FWIW, here is the code in question: <a href=\"https://www.sqlite.org/cgi/src/artifact/d9eb0a6c4aae1b00\" rel=\"nofollow noreferrer\">sqlite.org/cgi/src/artifact/d9eb0a6c4aae1b00</a>"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1519265522, "post_id": 48917522, "comment_id": 84843431, "body": "I think you missed the root cause: OP has some wacky CFLAGS in their environment."}, {"owner": {"reputation": 3, "user_id": 7058928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f3b98a77a807bc6a01d0619581e275d?s=128&d=identicon&r=PG&f=1", "display_name": "anoop", "link": "https://stackoverflow.com/users/7058928/anoop"}, "edited": false, "score": 1, "creation_date": 1519328022, "post_id": 48917522, "comment_id": 84878168, "body": "This fixed my problem, I was working on a project where I could change the CFLAGS. So this was the correct solution for me. Thank you!"}], "tags": [], "owner": {"reputation": 76876, "user_id": 287586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tB5AG.png?s=128&g=1", "display_name": "dan04", "link": "https://stackoverflow.com/users/287586/dan04"}, "is_accepted": true, "score": 1, "last_activity_date": 1519257624, "creation_date": 1519257624, "answer_id": 48917522, "question_id": 48917320, "link": "https://stackoverflow.com/questions/48917320/getting-gcc-error-when-using-sqlite-and-fast-math-sqlite-will-not-work-correct/48917522#48917522", "title": "Getting GCC error when using SQLite and Fast Math: &quot;SQLite will not work correctly with the -ffast-math option of GCC&quot;", "body": "<p>If you look at the SQLite source code, you'll see that this error comes from SQLite's fallback implementation of <code>sqlite3IsNaN</code>, which relies on IEEE's quirky definition of the <code>!=</code> operator when used with NaN operands.</p>\n\n<p>If you have a working <code>isnan</code> function in your C library, you can <code>#define SQLITE_HAVE_ISNAN</code>, which will make SQLite use the existing <code>isnan</code> instead of rolling its own.</p>\n\n<p>Or, you could just compile SQLite without <code>-ffast-math</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 0, "last_activity_date": 1519265660, "creation_date": 1519265660, "answer_id": 48918571, "question_id": 48917320, "link": "https://stackoverflow.com/questions/48917320/getting-gcc-error-when-using-sqlite-and-fast-math-sqlite-will-not-work-correct/48918571#48918571", "title": "Getting GCC error when using SQLite and Fast Math: &quot;SQLite will not work correctly with the -ffast-math option of GCC&quot;", "body": "<p>This error is occurring because you configured the build with the gcc option <code>-ffast-math</code> in your CFLAGS. Probably what's going on is that you have exported default CFLAGS in your environment, perhaps from your <code>.bashrc</code>/<code>.bash_profile</code>/<code>.profile</code>. If so, you really should remove that, because <code>-ffast-math</code> is harmful and will break code not designed to be used with it.</p>\n\n<p>To fix this, first clean the build tree entirely and start from scratch. Then either remove the CFLAGS from wherever they're getting set, log out, and log back in, or <code>unset CFLAGS</code> at the shell before running the build system's configure script or similar.</p>\n"}], "owner": {"reputation": 3, "user_id": 7058928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f3b98a77a807bc6a01d0619581e275d?s=128&d=identicon&r=PG&f=1", "display_name": "anoop", "link": "https://stackoverflow.com/users/7058928/anoop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 48917522, "answer_count": 2, "score": 0, "last_activity_date": 1519265660, "creation_date": 1519256347, "question_id": 48917320, "link": "https://stackoverflow.com/questions/48917320/getting-gcc-error-when-using-sqlite-and-fast-math-sqlite-will-not-work-correct", "title": "Getting GCC error when using SQLite and Fast Math: &quot;SQLite will not work correctly with the -ffast-math option of GCC&quot;", "body": "<p>I'm trying to compile a C project and I'm getting the error \"SQLite will not work correctly with the -ffast-math option of GCC\". I was wondering how to either bypass this error(though I am unsure of the implications of doing so) or any other solution that might be more appropriate. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1519256421, "post_id": 48917280, "comment_id": 84841141, "body": "(1) They aren&#39;t arrays to begin with. Change them to <code>double*</code> (2) Dynamically sizing arrays at runtime is done with malloc/realloc. (3) You need to declare add() before its first use."}, {"owner": {"reputation": 641, "user_id": 9148849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/023a4371461ee3649aadee1609399bed?s=128&d=identicon&r=PG&f=1", "display_name": "nabil.douss", "link": "https://stackoverflow.com/users/9148849/nabil-douss"}, "edited": false, "score": 1, "creation_date": 1519256469, "post_id": 48917280, "comment_id": 84841153, "body": "What do you mean by changing the size of test1? distance is a struct containing 2 doubles test1 and test2. the size of test1, test2 are fixed. If you want to dynamically change their size, use a pointer <code>double*</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1519256489, "post_id": 48917280, "comment_id": 84841159, "body": "It is not possible to change the size of anything in C. A <code>struct distance</code> always has the same size (probably 2 times the size of a <code>double</code>)"}, {"owner": {"reputation": 37, "user_id": 8168824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-EM5AdWJcglw/AAAAAAAAAAI/AAAAAAAAAjQ/5ITrauKeJxk/photo.jpg?sz=128", "display_name": "Afshin Ahmadi", "link": "https://stackoverflow.com/users/8168824/afshin-ahmadi"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1519256557, "post_id": 48917280, "comment_id": 84841173, "body": "@LeeDanielCrocker sorry I forgot to write it as double* . Can I change the size of test1 with malloc inside my function?"}, {"owner": {"reputation": 37, "user_id": 8168824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-EM5AdWJcglw/AAAAAAAAAAI/AAAAAAAAAjQ/5ITrauKeJxk/photo.jpg?sz=128", "display_name": "Afshin Ahmadi", "link": "https://stackoverflow.com/users/8168824/afshin-ahmadi"}, "reply_to_user": {"reputation": 641, "user_id": 9148849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/023a4371461ee3649aadee1609399bed?s=128&d=identicon&r=PG&f=1", "display_name": "nabil.douss", "link": "https://stackoverflow.com/users/9148849/nabil-douss"}, "edited": false, "score": 0, "creation_date": 1519256712, "post_id": 48917280, "comment_id": 84841210, "body": "@nabil.douss sorry I forgot to write them as double*"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1519256925, "post_id": 48917280, "comment_id": 84841280, "body": "Use malloc() the first time, then realloc() to change."}, {"owner": {"reputation": 37, "user_id": 8168824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-EM5AdWJcglw/AAAAAAAAAAI/AAAAAAAAAjQ/5ITrauKeJxk/photo.jpg?sz=128", "display_name": "Afshin Ahmadi", "link": "https://stackoverflow.com/users/8168824/afshin-ahmadi"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1519257080, "post_id": 48917280, "comment_id": 84841329, "body": "@LeeDanielCrocker I have tried it inside the main() and it actually works. But I am struggling to do this inside the function."}, {"owner": {"reputation": 122, "user_id": 3412226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdca9ab393836a6fb9bc0d05cfe4889f?s=128&d=identicon&r=PG&f=1", "display_name": "cmtm", "link": "https://stackoverflow.com/users/3412226/cmtm"}, "edited": false, "score": 0, "creation_date": 1519257154, "post_id": 48917280, "comment_id": 84841352, "body": "Put what you tried in the question and then we can point out what&#39;s wrong."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1519257461, "post_id": 48917280, "comment_id": 84841444, "body": "What&#39;s the difference? Malloc is malloc. Doesn&#39;t matter where you call it from."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519267309, "post_id": 48917280, "comment_id": 84843886, "body": "In C, once an <i>array</i> is defined, its size cannot change.  Code can allocated various amounts of memory for a <i>pointer</i>, yet a <i>pointer</i> is not an <i>array</i> and an <i>array</i> is not a <i>pointer</i>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519270701, "post_id": 48917280, "comment_id": 84844758, "body": "@AfshinAhmadi In C, what you call <a href=\"https://stackoverflow.com/questions/48917280/dynamically-changing-the-array-size-of-an-element-of-data-structure-in-c/48917326?noredirect=1#comment84844374_48917326\">&quot;static array&quot;</a> is an <i>array</i>.  What you call &quot;array with dynamic size&quot; is a <i>pointer</i> that has been assigned a value form <code>malloc()</code>.  Since an <i>array</i> cannot change size once defined, what you need for &quot;Dynamically changing the array size of an element of data structure&quot; is a <i>pointer</i> that gets re-assigned to various results of <code>malloc()</code>, <code>realloc()</code>, etc."}, {"owner": {"reputation": 37, "user_id": 8168824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-EM5AdWJcglw/AAAAAAAAAAI/AAAAAAAAAjQ/5ITrauKeJxk/photo.jpg?sz=128", "display_name": "Afshin Ahmadi", "link": "https://stackoverflow.com/users/8168824/afshin-ahmadi"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519271081, "post_id": 48917280, "comment_id": 84844844, "body": "@chux Got your point. However, what is the advantage of your method compare to what I used above?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519271656, "post_id": 48917280, "comment_id": 84844983, "body": "@AfshinAhmadi  An advantage to an <i>array</i> is that <code>sizeof</code> reflects the amount of data.  An <i>array</i> like <code>char a[7]</code>, the <code>sizeof a</code> is 7.  With <code>char *p = malloc(some_value);</code> the <code>sizeof p</code> is 4, 8 or whatever the <i>pointer</i> size.  If code needs fixed amount of data, use an <i>array</i>.   If code needs a variant amount of data, use a pointer to memory and allocate memory with <code>*alloc()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 8168824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-EM5AdWJcglw/AAAAAAAAAAI/AAAAAAAAAjQ/5ITrauKeJxk/photo.jpg?sz=128", "display_name": "Afshin Ahmadi", "link": "https://stackoverflow.com/users/8168824/afshin-ahmadi"}, "edited": false, "score": 0, "creation_date": 1519256784, "post_id": 48917326, "comment_id": 84841234, "body": "sorry there was a typo in the code. test and test 2 are arrays."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 37, "user_id": 8168824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-EM5AdWJcglw/AAAAAAAAAAI/AAAAAAAAAjQ/5ITrauKeJxk/photo.jpg?sz=128", "display_name": "Afshin Ahmadi", "link": "https://stackoverflow.com/users/8168824/afshin-ahmadi"}, "edited": false, "score": 0, "creation_date": 1519267113, "post_id": 48917326, "comment_id": 84843828, "body": "@AfshinAhmadi <code>double *test2;</code> is a <a href=\"https://cdecl.org/?q=double+%2Atest2\" rel=\"nofollow noreferrer\">pointer to double</a>, not an <i>array</i>."}, {"owner": {"reputation": 37, "user_id": 8168824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-EM5AdWJcglw/AAAAAAAAAAI/AAAAAAAAAjQ/5ITrauKeJxk/photo.jpg?sz=128", "display_name": "Afshin Ahmadi", "link": "https://stackoverflow.com/users/8168824/afshin-ahmadi"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519268444, "post_id": 48917326, "comment_id": 84844212, "body": "@chux malloc has been used later in the code for memory allocation."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 37, "user_id": 8168824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-EM5AdWJcglw/AAAAAAAAAAI/AAAAAAAAAjQ/5ITrauKeJxk/photo.jpg?sz=128", "display_name": "Afshin Ahmadi", "link": "https://stackoverflow.com/users/8168824/afshin-ahmadi"}, "edited": false, "score": 0, "creation_date": 1519268568, "post_id": 48917326, "comment_id": 84844247, "body": "@AfshinAhmadi <code>malloc()</code> or not, <code>double *test2</code> is still not an array.  It is a pointer."}, {"owner": {"reputation": 37, "user_id": 8168824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-EM5AdWJcglw/AAAAAAAAAAI/AAAAAAAAAjQ/5ITrauKeJxk/photo.jpg?sz=128", "display_name": "Afshin Ahmadi", "link": "https://stackoverflow.com/users/8168824/afshin-ahmadi"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519269141, "post_id": 48917326, "comment_id": 84844374, "body": "@chux I am new to C programming and what I want to say may sound stupid. But isn&#39;t it that if you want an array with dynamic size you need to use malloc and calloc with a pointer? I know I can define a static array like double array[20] but in my code, how will you define an array instead of a pointer? Or better to ask, how will you change my code by declaring an array instead of a pointer?"}, {"owner": {"reputation": 122, "user_id": 3412226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdca9ab393836a6fb9bc0d05cfe4889f?s=128&d=identicon&r=PG&f=1", "display_name": "cmtm", "link": "https://stackoverflow.com/users/3412226/cmtm"}, "edited": false, "score": 0, "creation_date": 1519273154, "post_id": 48917326, "comment_id": 84845470, "body": "This is just a question of semantics, but it&#39;s worth clarifying anyways. The definition <code>double *test2</code> defines a variable who&#39;s type is <code>pointer to double</code>. You can say that this pointer is pointing to an array of doubles, but that doesn&#39;t mean the type of test2 is an array. The meaning of what it&#39;s pointing to is up to interpretation in a way."}, {"owner": {"reputation": 122, "user_id": 3412226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdca9ab393836a6fb9bc0d05cfe4889f?s=128&d=identicon&r=PG&f=1", "display_name": "cmtm", "link": "https://stackoverflow.com/users/3412226/cmtm"}, "edited": false, "score": 0, "creation_date": 1519273160, "post_id": 48917326, "comment_id": 84845472, "body": "You can say it&#39;s pointing to an array of doubles, you can say it&#39;s pointing a single double, you can say it&#39;s pointing to a series of numbers, or you could say it&#39;s pointing to data representing your test data. All of these would be correct. But the <i>type</i> of the variable test2 isn&#39;t up to interpretation, it&#39;s a <code>pointer to double</code>. You can&#39;t define a variable with a type of a dynamically sized array. You need to define it as a pointer and point it to an array."}], "tags": [], "owner": {"reputation": 122, "user_id": 3412226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdca9ab393836a6fb9bc0d05cfe4889f?s=128&d=identicon&r=PG&f=1", "display_name": "cmtm", "link": "https://stackoverflow.com/users/3412226/cmtm"}, "is_accepted": false, "score": 1, "last_activity_date": 1519256363, "creation_date": 1519256363, "answer_id": 48917326, "question_id": 48917280, "link": "https://stackoverflow.com/questions/48917280/dynamically-changing-the-array-size-of-an-element-of-data-structure-in-c/48917326#48917326", "title": "Dynamically changing the array size of an element of data structure in C", "body": "<p>This isn't possible in any meaningful way. You can always have <code>struct distance</code> container pointers to double instead of doubles, and then change the size of the pointed to memory, but your goal here isn't clear so I'm not sure what use that would be.</p>\n"}, {"comments": [{"owner": {"reputation": 122, "user_id": 3412226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdca9ab393836a6fb9bc0d05cfe4889f?s=128&d=identicon&r=PG&f=1", "display_name": "cmtm", "link": "https://stackoverflow.com/users/3412226/cmtm"}, "edited": false, "score": 0, "creation_date": 1519262879, "post_id": 48917762, "comment_id": 84842829, "body": "You can use <code>dist1-&gt;test1</code> instead of <code>(*dist1).test1</code>.  Also, you have a memory leak here. The original malloc in main was never freed. This is a perfect place to use realloc though, it&#39;s more efficient and will solve the memory leak as a bonus.  Replace the malloc line in your add function with: <code>dist1-&gt;test2 = (double*)realloc(dist1-&gt;test2, 10*sizeof(double))</code>"}, {"owner": {"reputation": 37, "user_id": 8168824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-EM5AdWJcglw/AAAAAAAAAAI/AAAAAAAAAjQ/5ITrauKeJxk/photo.jpg?sz=128", "display_name": "Afshin Ahmadi", "link": "https://stackoverflow.com/users/8168824/afshin-ahmadi"}, "reply_to_user": {"reputation": 122, "user_id": 3412226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdca9ab393836a6fb9bc0d05cfe4889f?s=128&d=identicon&r=PG&f=1", "display_name": "cmtm", "link": "https://stackoverflow.com/users/3412226/cmtm"}, "edited": false, "score": 0, "creation_date": 1519266346, "post_id": 48917762, "comment_id": 84843622, "body": "@cmtm I used malloc in main() for test1. The malloc in add() is for test2. That is why I did not use realloc. I am also aware of dist1-&gt;test1 but is there any reason why I shouldn&#39;t use (*dist1).test1 ?"}, {"owner": {"reputation": 122, "user_id": 3412226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdca9ab393836a6fb9bc0d05cfe4889f?s=128&d=identicon&r=PG&f=1", "display_name": "cmtm", "link": "https://stackoverflow.com/users/3412226/cmtm"}, "edited": false, "score": 1, "creation_date": 1519266889, "post_id": 48917762, "comment_id": 84843787, "body": "Ah, I didn&#39;t notice that one was for test1 and the other for test2. The arrow operator is generally considered to be more readable than dereferencing between parentheses. These cases are fairly simple, so you won&#39;t see a big difference, but consider this: <code>my_func((*st).p1, (int) (*st).p2)</code> vs. <code>my_func(st-&gt;p1, (int) st-&gt;p2)</code>. Most would consider the latter much better."}], "tags": [], "owner": {"reputation": 37, "user_id": 8168824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-EM5AdWJcglw/AAAAAAAAAAI/AAAAAAAAAjQ/5ITrauKeJxk/photo.jpg?sz=128", "display_name": "Afshin Ahmadi", "link": "https://stackoverflow.com/users/8168824/afshin-ahmadi"}, "is_accepted": false, "score": 0, "last_activity_date": 1519259885, "last_edit_date": 1519259885, "creation_date": 1519259380, "answer_id": 48917762, "question_id": 48917280, "link": "https://stackoverflow.com/questions/48917280/dynamically-changing-the-array-size-of-an-element-of-data-structure-in-c/48917762#48917762", "title": "Dynamically changing the array size of an element of data structure in C", "body": "<p>I was able to finally get this run. I really appreciate everybody's help and time. You guys are amazing!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct distance\n{\n    double *test1;\n    double *test2;\n};\n\n\nvoid add(struct distance *dist1) ;\n\n\nint main()\n{\n    struct distance dist1;\n\n    dist1.test1 = (double *) malloc(5*sizeof(double));\n    dist1.test1[4] = 14.22;\n    printf(\"dist1.test1[4] from main() = %f\\n\", dist1.test1[4]);\n\n    add(&amp;dist1); \n\n    printf(\"dist1.test2[3] from main() = %f\\n\", dist1.test2[3]);\n\n    return 0;\n}\n\nvoid add(struct distance *dist1) \n{\n     printf(\"dist1.test1[4] from add() = %f\\n\", (*dist1).test1[4]);\n\n     (*dist1).test2 = (double *) malloc(10*sizeof(double));\n     (*dist1).test2[3] = 14.67;\n     printf(\"dist1.test2[3] from add() = %f\\n\", (*dist1).test2[3]);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1519273914, "creation_date": 1519273914, "answer_id": 48919720, "question_id": 48917280, "link": "https://stackoverflow.com/questions/48917280/dynamically-changing-the-array-size-of-an-element-of-data-structure-in-c/48919720#48919720", "title": "Dynamically changing the array size of an element of data structure in C", "body": "<p>The members of <code>struct distance</code> are best first initialized. </p>\n\n<pre><code>struct distance dist1 = { NULL, NULL };\n</code></pre>\n\n<p>To change the the number of elements allocated, use <code>realloc()</code>.  Pass to it <code>d3-&gt;test1</code> and the number of bytes needed.  If the value returned is not <code>NULL</code>, the re-allocation succeeded and code should use that.  Research <code>realloc()</code> for more details.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\nvoid add(struct distance *d3) {\n  // I want to dynamically change the size of \"test1\" to let's say test1(50)\n  size_t new_element_count = 50;\n  void *tmp = realloc(d3-&gt;test1, sizeof *(d3-&gt;test1) * new_element_count);\n  if (tmp == NULL &amp;&amp; new_element_count &gt; 0) {\n    Handle_OutOfMemory();\n  } else {\n    d3-&gt;test1 = tmp;\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 8168824, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-EM5AdWJcglw/AAAAAAAAAAI/AAAAAAAAAjQ/5ITrauKeJxk/photo.jpg?sz=128", "display_name": "Afshin Ahmadi", "link": "https://stackoverflow.com/users/8168824/afshin-ahmadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1519273914, "creation_date": 1519256068, "last_edit_date": 1519256516, "question_id": 48917280, "link": "https://stackoverflow.com/questions/48917280/dynamically-changing-the-array-size-of-an-element-of-data-structure-in-c", "title": "Dynamically changing the array size of an element of data structure in C", "body": "<p>I am new to C programming. Please excuse if this question is not appropriate. I have been struggling to dynamically change the size of a variable inside the structure (not the struct itself). Let's say I have a struct called dist1 like the code below. I want to pass this structure into a function and dynamically change the size of test1. Is this even possible?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nstruct distance\n{\n    double *test1;\n    double *test2;\n};\n\n\nint main()\n{\n    struct distance dist1;\n    add(&amp;dist1); \n\n    return 0;\n}\n\nvoid add(struct distance *d3) \n{\n     // I want to dynamically change the size of \"test1\" to let's say test1(50)\n     // Is this possible?\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "multidimensional-array"], "comments": [{"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 0, "creation_date": 1519256098, "post_id": 48917242, "comment_id": 84841053, "body": "Which line is line 5?"}, {"owner": {"reputation": 85, "user_id": 1699147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fad6c3d69941413a0c52869d1d7f6a3?s=128&d=identicon&r=PG", "display_name": "H&#233;lder Lima", "link": "https://stackoverflow.com/users/1699147/h%c3%a9lder-lima"}, "reply_to_user": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 0, "creation_date": 1519256426, "post_id": 48917242, "comment_id": 84841143, "body": "<code>*cartao2[0] = 5;</code> @KenY-N"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1519256898, "post_id": 48917242, "comment_id": 84841273, "body": "what are your compiler warnings telling you??"}, {"owner": {"reputation": 85, "user_id": 1699147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fad6c3d69941413a0c52869d1d7f6a3?s=128&d=identicon&r=PG", "display_name": "H&#233;lder Lima", "link": "https://stackoverflow.com/users/1699147/h%c3%a9lder-lima"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1519257757, "post_id": 48917242, "comment_id": 84841527, "body": "@MFisherKDX nothing. The program compiles. When executed through cmd it gives error, without explaining nothing more. Just the program testes7.c has stopped working (in my case it is said in portuguese).  But now, with the multi-dimensional array it does not compile..."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1519258323, "post_id": 48917242, "comment_id": 84841672, "body": "if you have other questions ask a new one, nobody will read through question1 to find that is answered and that there is a question2 buried at the end"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519259635, "post_id": 48917242, "comment_id": 84841994, "body": "I agree with pm100. If you have a new question, ask a new question on a separate thread. And as for your next code: you have to pass the correct types. <code>cartao</code> is a 2-dim array, your function expects a pointer. You are passing the wrong types."}, {"owner": {"reputation": 85, "user_id": 1699147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fad6c3d69941413a0c52869d1d7f6a3?s=128&d=identicon&r=PG", "display_name": "H&#233;lder Lima", "link": "https://stackoverflow.com/users/1699147/h%c3%a9lder-lima"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1519259892, "post_id": 48917242, "comment_id": 84842062, "body": "@pm100 I agree. I can&#39;t do it now because I have no access to the computer until tomorrow. Will post it tomorrow!"}, {"owner": {"reputation": 85, "user_id": 1699147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fad6c3d69941413a0c52869d1d7f6a3?s=128&d=identicon&r=PG", "display_name": "H&#233;lder Lima", "link": "https://stackoverflow.com/users/1699147/h%c3%a9lder-lima"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519259966, "post_id": 48917242, "comment_id": 84842086, "body": "@Pablo the previous one was also an array but is automatically passed as a pointer. Doesn&#39;t it work the same way to dual-dimension arrays?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519260354, "post_id": 48917242, "comment_id": 84842206, "body": "Yes, the new <code>cartao</code> would decay in a <code>(int*)[5]</code>, but you the new <code>Mudar</code> expects now an <code>int*</code>, you changed the types and they don&#39;t match again. If <code>Mudar</code> were the version I posted in the answer, then <code>Mudar(cartao)</code> would work."}, {"owner": {"reputation": 85, "user_id": 1699147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fad6c3d69941413a0c52869d1d7f6a3?s=128&d=identicon&r=PG", "display_name": "H&#233;lder Lima", "link": "https://stackoverflow.com/users/1699147/h%c3%a9lder-lima"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519260854, "post_id": 48917242, "comment_id": 84842334, "body": "@Pablo I see. I will test it tomorrow. Any tips of where to read more about pointers?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519261012, "post_id": 48917242, "comment_id": 84842369, "body": "The C book you are reading? I don&#39;t know, I haven&#39;t read a C book for a long time, so I&#39;m not up to date with which book is good.  See <a href=\"https://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\" title=\"the definitive c book guide and list\">stackoverflow.com/questions/562303/&hellip;</a>"}, {"owner": {"reputation": 85, "user_id": 1699147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fad6c3d69941413a0c52869d1d7f6a3?s=128&d=identicon&r=PG", "display_name": "H&#233;lder Lima", "link": "https://stackoverflow.com/users/1699147/h%c3%a9lder-lima"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519261196, "post_id": 48917242, "comment_id": 84842405, "body": "@Pablo A notebook from the teacher of my course."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 1699147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fad6c3d69941413a0c52869d1d7f6a3?s=128&d=identicon&r=PG", "display_name": "H&#233;lder Lima", "link": "https://stackoverflow.com/users/1699147/h%c3%a9lder-lima"}, "edited": false, "score": 0, "creation_date": 1519256331, "post_id": 48917266, "comment_id": 84841118, "body": "It worked @Stephen Docy... What if <code>cartao</code> was <code>cartao[5,5]</code>, how would I be able to change <code>cartao[3,3]</code> value?"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1519256617, "post_id": 48917266, "comment_id": 84841186, "body": "Ok, but it would be helpful if you explained why the OP&#39;s method does not work.  It&#39;s not necessarily obvious."}, {"owner": {"reputation": 85, "user_id": 1699147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fad6c3d69941413a0c52869d1d7f6a3?s=128&d=identicon&r=PG", "display_name": "H&#233;lder Lima", "link": "https://stackoverflow.com/users/1699147/h%c3%a9lder-lima"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1519257632, "post_id": 48917266, "comment_id": 84841489, "body": "No, it&#39;s not @MFisherKDX. Pointers has not been easy to learn for me."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "reply_to_user": {"reputation": 85, "user_id": 1699147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fad6c3d69941413a0c52869d1d7f6a3?s=128&d=identicon&r=PG", "display_name": "H&#233;lder Lima", "link": "https://stackoverflow.com/users/1699147/h%c3%a9lder-lima"}, "edited": false, "score": 0, "creation_date": 1519257841, "post_id": 48917266, "comment_id": 84841543, "body": "@H&#233;lderLima -- ok.  I&#39;ll try to post an answer shortly explaining."}], "tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": false, "score": 2, "last_activity_date": 1519256340, "last_edit_date": 1519256340, "creation_date": 1519255989, "answer_id": 48917266, "question_id": 48917242, "link": "https://stackoverflow.com/questions/48917242/changing-a-value-in-an-int-array-in-c/48917266#48917266", "title": "Changing a value in an int array in c", "body": "<p>Unlike simple, scalar variables like <code>int</code>, arrays get passed as pointers, so you don't need to pass in the address of <code>cartao</code> in order to update its contents.  Now if you wanted to change what memory block <code>cartao</code> was pointing to, then you would need to pass in its address.</p>\n\n<pre><code>void Mudar(int *cartao2)\n{\n    cartao2[0] = 5;\n    cartao2[1] = 4;\n    cartao2[2] = 3;\n    cartao2[3] = 2;\n    cartao2[4] = 1;\n}\n\nMudar(cartao);\n</code></pre>\n\n<p>output :</p>\n\n<pre><code>int cartao[] = {1,2,3,4,5};\nint cartao[] = {5,4,3,2,1};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 1699147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fad6c3d69941413a0c52869d1d7f6a3?s=128&d=identicon&r=PG", "display_name": "H&#233;lder Lima", "link": "https://stackoverflow.com/users/1699147/h%c3%a9lder-lima"}, "edited": false, "score": 0, "creation_date": 1519258544, "post_id": 48917590, "comment_id": 84841725, "body": "Thank you very much @Pablo for this answer! What program do you use to get that errors pointed? Would you be able to help with the multidimensional arrays?"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1519258746, "post_id": 48917590, "comment_id": 84841770, "body": "+1, You beat me by a couple minutes.  I&#39;ll delete my answer shortly as there is no additional information there."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519258763, "post_id": 48917590, "comment_id": 84841775, "body": "I use valgrind to detect leaks and improper access to arrays and memory and gdb to debug when I want to step through the code."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 3, "last_activity_date": 1519258424, "last_edit_date": 1519258424, "creation_date": 1519258102, "answer_id": 48917590, "question_id": 48917242, "link": "https://stackoverflow.com/questions/48917242/changing-a-value-in-an-int-array-in-c/48917590#48917590", "title": "Changing a value in an int array in c", "body": "<p>Stephen Docy gave you a solution as to how to pass an array to a function. I'd\nlike to comment on the way you did and why it fails.</p>\n\n<pre><code>int cartao[] = {1,2,3,4,5};\n</code></pre>\n\n<p>This creates an <code>int[5]</code> array. <code>&amp;array</code> has the type <code>int (*)[5]</code>, which is a\npointer to an <code>int[5]</code> array.</p>\n\n<p>Your function a double pointer <code>int **cartao2</code>. This type is not the same as\n<code>int (*)[5]</code>, your compiler should have warned you about this with</p>\n\n<pre><code>a.c:21:11: warning: passing argument 1 of \u2018Mudar\u2019 from incompatible pointer type [-Wincompatible-pointer-types]\n     Mudar(&amp;cartao);\n           ^\na.c:3:6: note: expected \u2018int **\u2019 but argument is of type \u2018int (*)[5]\u2019\n void Mudar (int **cartao2)\n      ^~~~~\n</code></pre>\n\n<p><code>Mudar</code> sees a double pointer and when you do</p>\n\n<pre><code>*cartao2[2] = 3;\n</code></pre>\n\n<p>you are doing <code>cartao2[2][0] = 3</code>, but because you didn't pass the correct type,\nyou are dereferencing at the incorrect position in memory and writing where you shouldn't. You would have to write your\nfunction like this:</p>\n\n<pre><code>void Mudar (int (*cartao2)[5])\n{\n    cartao2[0][0] = 5; // or (*cartao2)[0] = 5;\n    cartao2[0][1] = 4; // or (*cartao2)[1] = 4;\n    cartao2[0][2] = 3; // or (*cartao2)[2] = 3;\n    cartao2[0][3] = 2; // or (*cartao2)[3] = 2;\n    cartao2[0][4] = 1; // or (*cartao2)[4] = 1;\n}\n</code></pre>\n\n<p>In this case the function expects a pointer to <code>int[5]</code>. Note that if you\ndeclare it to accept a pointer to an array of any size, you would have to\ndeclare it as</p>\n\n<pre><code>void Mudar(int (*cartao2)[], size_t len)\n{\n    for(size_t i = 0; i &lt; len; ++i)\n        (*cartao2)[i] = 10*i;\n}\n</code></pre>\n\n<p>In this case you cannot use the notation <code>cartao2[0][i]</code>, because the compiler\ndoesn't know the real size of the array, however <code>(*cartao2)[i]</code> works.</p>\n"}, {"tags": [], "owner": {"reputation": 95, "user_id": 9363962, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dddd9ef59289ab9038f38ad1e3c3ee74?s=128&d=identicon&r=PG&f=1", "display_name": "bbcbbc1", "link": "https://stackoverflow.com/users/9363962/bbcbbc1"}, "is_accepted": false, "score": 0, "last_activity_date": 1519495936, "creation_date": 1519495936, "answer_id": 48966061, "question_id": 48917242, "link": "https://stackoverflow.com/questions/48917242/changing-a-value-in-an-int-array-in-c/48966061#48966061", "title": "Changing a value in an int array in c", "body": "<p>For 2D array ,try this . M is rows ,n is columns.\nIn mudar function .</p>\n\n<pre><code> for (i = 0; i &lt; m; i++)\n  for (j = 0; j &lt; n; j++)\n    *((arr+i*n) + j) =aux;\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 1699147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fad6c3d69941413a0c52869d1d7f6a3?s=128&d=identicon&r=PG", "display_name": "H&#233;lder Lima", "link": "https://stackoverflow.com/users/1699147/h%c3%a9lder-lima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 48917590, "answer_count": 3, "score": 1, "last_activity_date": 1519495936, "creation_date": 1519255779, "last_edit_date": 1519257575, "question_id": 48917242, "link": "https://stackoverflow.com/questions/48917242/changing-a-value-in-an-int-array-in-c", "title": "Changing a value in an int array in c", "body": "<p>I am trying to understand the values/pointers management in arrays.</p>\n\n<p>Imagine an array of 5 elements and altering them from a function outside main. I have to use pointers. I have made this simple program to try to execute it:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid Mudar (int **cartao2)\n{\n    *cartao2[0] = 5;\n    *cartao2[1] = 4;\n    *cartao2[2] = 3;\n    *cartao2[3] = 2;\n    *cartao2[4] = 1;\n}\n\nint main()\n{\n    int cartao[] = {1,2,3,4,5};\n\n    printf(\"int cartao[] = {\");\n    for (int i = 0; i &lt; 4; i++)\n        printf(\"%d,\", cartao[i]);\n    printf(\"%d};\\n\",cartao[4]);\n\n    Mudar(&amp;cartao);\n\n    printf(\"int cartao[] = {\");\n    for (int i = 0; i &lt; 4; i++)\n        printf(\"%d,\", cartao[i]);\n    printf(\"%d};\\n\",cartao[4]);\n\n}\n</code></pre>\n\n<p>This program gives error while executing but only when trying to execute line 5. It even prints</p>\n\n<pre><code>int cartao[] = {1,2,3,4,5};\n</code></pre>\n\n<p>What is wrong here.</p>\n\n<p>The next step is trying to change a value inside an array of arrays. Any tips to achieve that?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>As @Stephen Docy point this code now works</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid Mudar (int *cartao2)\n{\n    cartao2[0] = 5;\n    cartao2[1] = 4;\n    cartao2[2] = 3;\n    cartao2[3] = 2;\n    cartao2[4] = 1;\n}\n\nint main()\n{\n    int cartao[] = {1,2,3,4,5};\n\n    printf(\"int cartao[] = {\");\n    for (int i = 0; i &lt; 4; i++)\n        printf(\"%d,\", cartao[i]);\n    printf(\"%d};\\n\",cartao[4]);\n\n    Mudar(cartao);\n\n    printf(\"int cartao[] = {\");\n    for (int i = 0; i &lt; 4; i++)\n        printf(\"%d,\", cartao[i]);\n    printf(\"%d};\\n\",cartao[4]);\n\n}\n</code></pre>\n\n<p>And the output is</p>\n\n<pre><code>int cartao[] = {1,2,3,4,5}; int cartao[] = {5,4,3,2,1};\n</code></pre>\n\n<p>But now I'm curious should't this work the same way?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid Mudar (int *cartao2)\n{\n    int aux = 25;\n    for (int i = 0; i &lt; 5; i++)\n    {\n        for (int j = 0; j &lt; 5; j++)\n        {\n            cartao2[i][j] = aux;\n            aux--;\n        }\n    }\n}\n\nint main()\n{\n    int cartao[5][5];\n    int aux = 1;\n\n    //populates cartao from 1 to 25\n    for (int i = 0; i &lt; 5; i++)\n    {\n        for (int j = 0; j &lt; 5; j++)\n        {\n            cartao[i][j] = aux;\n            aux++;\n        }\n    }\n\n    //prints before changing\n    for (int i = 0; i &lt; 5; i++)\n    {\n        for (int j = 0; j &lt; 5; j++)\n        {\n            printf(\"%2d \", cartao[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n    Mudar(cartao);\n\n    //prints after changing\n    for (int i = 0; i &lt; 5; i++)\n    {\n        for (int j = 0; j &lt; 5; j++)\n        {\n            printf(\"%2d \", cartao[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n}\n</code></pre>\n\n<p>Because the program doesn't even compile:</p>\n\n<pre><code>testes7.c:10: error: pointer expected\n</code></pre>\n\n<p>But it is used the same way as the code that now works well.</p>\n"}, {"tags": ["c", "byte"], "comments": [{"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 2, "creation_date": 1519256264, "post_id": 48917232, "comment_id": 84841102, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8441257/why-does-c-print-my-hex-values-incorrectly\">Why does C print my hex values incorrectly?</a>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1519256827, "post_id": 48917232, "comment_id": 84841251, "body": "This happens because of integer promotion. You <code>char</code> is a 8-bit signed value, <code>0xa1</code> is <code>b1010 0001</code>, the most significant bit is set to 1, so when it gets promoted to integer (with the short assignment and later in the <code>printf</code>, sign extension is applied, that fills all other 3 bytes with ones. You end up with <code>b1111 1111 1111 1111 1111 1111 1010 0001</code> which is <code>ffffffa1</code>."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1519257036, "post_id": 48917232, "comment_id": 84841315, "body": "Looks correct to me. <code>char</code> is one byte, printed as two hex digits. <code>short</code> is 4 bytes, printed as 8 hex digits."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519257500, "post_id": 48917232, "comment_id": 84841457, "body": "@Pablo is right.  Try this: What happens when <code>x5=0x7f</code>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1519266409, "post_id": 48917232, "comment_id": 84843639, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/31090616/printf-adds-extra-ffffff-to-hex-print-from-a-char-array\">printf adds extra `FFFFFF` to hex print from a char array</a>"}], "answers": [{"comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1519261762, "post_id": 48917865, "comment_id": 84842557, "body": "Good answer, UP from me, only a minor complain: Use <code>%zu</code> when printing <code>size_t</code>."}, {"owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519262327, "post_id": 48917865, "comment_id": 84842682, "body": "@Pablo Thank you Pablo! I will remember about <code>%z</code> now."}], "tags": [], "owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "is_accepted": false, "score": 2, "last_activity_date": 1519667365, "last_edit_date": 1519667365, "creation_date": 1519260205, "answer_id": 48917865, "question_id": 48917232, "link": "https://stackoverflow.com/questions/48917232/showing-bytes-in-c/48917865#48917865", "title": "Showing Bytes in C", "body": "<p>This is due to silent integer type-promotion. Since <code>0xa1</code> is negative value (-95 dec) \n<code>char</code>, <code>short</code> will be promoted to 4 bytes <code>int</code> and printed negative by <code>printf</code> function.</p>\n\n<p>To prevent promotion you can use <code>unsigned</code> types.</p>\n\n<p>Program below illustrates the behaviour for signed and unsigned types:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint main() {\n\n    char x5 = 0xa1;\n    short z5 = x5;\n    int i5 = x5;\n\n    unsigned char ux5 = 0xa1;\n    unsigned short uz5 = 0xa1;\n    unsigned int ui5 = 0xa1;\n\n    size_t sx5 = sizeof(x5);\n    size_t sz5 = sizeof(z5);\n    size_t si5 = sizeof(i5);\n\n\n    printf(\"%zu %zu %zu\\n\", sx5, sz5, si5);  \n\n    printf(\"%x %x %x\\n\", x5, z5, i5);     // silent promotion to 32 bit negative integers\n\n    printf(\"%x %x %x\\n\", ux5, uz5, ui5);  // no promotion\n\n    ux5 = x5;   \n    uz5 = z5; // remember that z5 is negative number\n    ui5 = i5; // same for i5\n\n    printf(\"%x %x %x\\n\", ux5, uz5, ui5); // no promotion but numbers are negative ones\n\n   return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1 2 4\nffffffa1 ffffffa1 ffffffa1\na1 a1 a1\na1 ffa1 ffffffa1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 9392455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RsE68.png?s=128&g=1", "display_name": "RyanArr", "link": "https://stackoverflow.com/users/9392455/ryanarr"}, "is_accepted": false, "score": 0, "last_activity_date": 1519266009, "last_edit_date": 1519266009, "creation_date": 1519265318, "answer_id": 48918521, "question_id": 48917232, "link": "https://stackoverflow.com/questions/48917232/showing-bytes-in-c/48918521#48918521", "title": "Showing Bytes in C", "body": "<p>Since <code>x5</code> large enough (anything over <code>127</code> or <code>0x7F</code> in a single-byte data type) to have the highest bit set (<strong>1</strong>010 0001), it's interpreted as a negative when using the default signed type.  As the other answer mentioned, using an <code>unsigned char</code> fixes the issue.  However typecasting <code>x5</code> will work as well, since short uses two bytes to store the value and will not see it as negative even if it is signed (<strong>0</strong>000 0000 1010 0001).</p>\n\n<p>typecasting will work:</p>\n\n<pre><code>char x5 = 0xa1;\nshort z5 = (unsigned char) x5;\n</code></pre>\n\n<p>and so will using an unsigned char:</p>\n\n<pre><code>unsigned char x5 = 0xa1;\nshort z5 = x5;\n</code></pre>\n\n<p>but you should really specify unsigned for everything if you're using it this way to avoid such scenarios.</p>\n\n<pre><code>unsigned char x5 = 0xa1;\nunsigned short z5 = x5;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9393639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b150b712fa92fa5f476c658999ac05b5?s=128&d=identicon&r=PG&f=1", "display_name": "Mornet", "link": "https://stackoverflow.com/users/9393639/mornet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519667365, "creation_date": 1519255726, "question_id": 48917232, "link": "https://stackoverflow.com/questions/48917232/showing-bytes-in-c", "title": "Showing Bytes in C", "body": "<p>I am writing a C program that has to show each operation in a hexadecimal answer but you have to show all the bytes corresponding to the data type.</p>\n\n<p>for example if its an int it should show 8 bytes, if its a short 4 bytes.</p>\n\n<p>It works for every other data type including char where it only shows two bytes. But short is always showing 8 bytes when I print it</p>\n\n<pre><code>char x5 = 0xa1;\nshort z5 = x5;\n\nprintf(\"\\nProblem 1f: %x\\n\", z5);\n</code></pre>\n\n<p>and it prints \"Problem 1f: ffffffa1\"</p>\n\n<p>a classmate found a solution where %hx prints the correct amount of bytes but I dont understand why this %x prints extra bytes, where are these bytes coming from?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c", "sorting", "matrix", "row"], "comments": [{"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 1, "creation_date": 1519255919, "post_id": 48917224, "comment_id": 84841004, "body": "For starters, your indexing e.g. <code>first_element[i + j]</code> is incorrect. It should be smth like <code>first_element[i * columns + j]</code>."}, {"owner": {"reputation": 1, "user_id": 9393471, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YdQY45MZfcE/AAAAAAAAAAI/AAAAAAAAA9I/jCDdmVr_82U/photo.jpg?sz=128", "display_name": "Joseph Cutlip", "link": "https://stackoverflow.com/users/9393471/joseph-cutlip"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1519256209, "post_id": 48917224, "comment_id": 84841087, "body": "Thank you so much! That was the issue!"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519256259, "post_id": 48917224, "comment_id": 84841100, "body": "You are only accessing the first row which goes from <code>first_element[0]</code> to <code>first_element[columns - 1]</code>. The second row goes from <code>first_element[columns]</code> to <code>first_element[2*columns - 1]</code>, the third row goes from <code>first_element[2*columns]</code> to <code>first_element[3*columns - 1]</code>, do you start to see the pattern here? The <code>n</code>th (counting from 0) row goes from <code>first_element[n*columns]</code> to <code>first_element[(n+1)*columns -1]</code>. With this info you should be able to fix your indices."}], "owner": {"reputation": 1, "user_id": 9393471, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YdQY45MZfcE/AAAAAAAAAAI/AAAAAAAAA9I/jCDdmVr_82U/photo.jpg?sz=128", "display_name": "Joseph Cutlip", "link": "https://stackoverflow.com/users/9393471/joseph-cutlip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 377, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519255745, "creation_date": 1519255683, "last_edit_date": 1519255745, "question_id": 48917224, "link": "https://stackoverflow.com/questions/48917224/sorting-a-matrix-by-row-in-c", "title": "Sorting a Matrix by Row in C", "body": "<p>I have been asked to sort each row of a matrix given the number of rows, number of columns, and a pointer to the first element of the matrix (top left element). Here is the full question: <a href=\"https://i.stack.imgur.com/7j6L3.png\" rel=\"nofollow noreferrer\">Homework Question</a></p>\n\n<p>So far I've been able to come up with this code: </p>\n\n<pre><code>void SortRowsOfMatrix(int rows, int columns, float* first_element) {\n   for (int i = 0; i &lt; rows; ++i) {\n      for (int j = 0; j &lt; columns; ++j) {\n         for (int k = j + 1; k &lt; columns; ++k) {\n           if (first_element[i + j] &gt; first_element[i + k]) {\n             float temp = first_element[i + j];\n             first_element[i + j] = first_element[i + k];\n             first_element[i + k] = temp;\n           }\n         }\n      }\n   }\n}\n</code></pre>\n\n<p>After tracing through the code by hand, I am noticing that the function will sort the first row of a matrix, but only the first row. I've tried modifying the code to sort the remaining rows, but so far I have had no luck.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 717, "user_id": 8033983, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TiXi8.png?s=128&g=1", "display_name": "xSkrappy", "link": "https://stackoverflow.com/users/8033983/xskrappy"}, "edited": false, "score": 1, "creation_date": 1519254979, "post_id": 48917111, "comment_id": 84840676, "body": "I gusss you input a name that is not a character, character only accepts a single value. try using string as a type."}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 2, "creation_date": 1519254979, "post_id": 48917111, "comment_id": 84840677, "body": "There is an inconsistency in <code>scanf(&quot;%d&quot;,&amp;choice)</code>: you scan an integer number, but provide storage only for one character. Same with <code>scanf (&quot;%s&quot;,Fname)</code>."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1519255072, "post_id": 48917111, "comment_id": 84840713, "body": "<code>char Fname, Sname;</code>... <code>char</code> is just that. One character. You need a whole array of characters to form a string. Do a google search on <code>&quot;strings in C&quot;</code> or read your C manual. And <code>scanf(&quot;%s&quot;, Fname)</code> attempts to interpret the contents of <code>Fname</code> as a pointer to a string. That&#39;s bad. You need to study the manual page for <code>scanf</code>."}, {"owner": {"reputation": 1, "user_id": 9393508, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "zzzzzzzz", "link": "https://stackoverflow.com/users/9393508/zzzzzzzz"}, "edited": false, "score": 0, "creation_date": 1519255113, "post_id": 48917111, "comment_id": 84840733, "body": "yh i changed the second part thanks, and ive tried to input strings,numbers,characters but am still getting the same error"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1519255196, "post_id": 48917111, "comment_id": 84840763, "body": "You get the same error probably because you have the same fundamental problem: you&#39;re treating something as a pointer (a memory address in C) that should not be so. This is not a good question for Stackoverflow because it indicates you need to go back and learn C fundamentals. This is not a basic language tutorial site."}, {"owner": {"reputation": 1, "user_id": 9393508, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "zzzzzzzz", "link": "https://stackoverflow.com/users/9393508/zzzzzzzz"}, "edited": false, "score": 0, "creation_date": 1519255226, "post_id": 48917111, "comment_id": 84840773, "body": "oh ok thanks for the help"}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1519255541, "post_id": 48917111, "comment_id": 84840886, "body": "Whatever compiler you&#39;re using, <i>turn up the warnings</i>. For MSVC, compile with <code>&#47;Wall</code>, for gcc/clang/pgcc/icc/suncc/xlc, <code>-Wall</code>. Pretty much any compiler should be able to catch this sort of problem and warn you about it at compile time."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519287306, "post_id": 48917111, "comment_id": 84851312, "body": "You claim the posted code is C, however, it contains the statement: <code>#include &lt;iostream&gt;</code>  which is a C++ header file.  Strongly suggest removing that statement,.&#39;"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519287363, "post_id": 48917111, "comment_id": 84851340, "body": "when writing a prototype for a function that has not parameters, place <code>void</code> between the parens  I.E. <code>void create();</code> should be: <code>void create( void );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519287563, "post_id": 48917111, "comment_id": 84851432, "body": "regarding: <code>scanf(&quot;%d&quot;,&amp;choice);</code>  The variable <code>choice</code> is declared as <code>char</code>, but the input/format specifier <code>%d</code> is expecting a <code>int*</code>  Suggest using <code>%c</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519287873, "post_id": 48917111, "comment_id": 84851587, "body": "this: <code>if (choice == 1){</code> would be better written as: <code>switch( choice ) { case 1:  create();  break;  case 2: ; break;  case 3: ; break;  default: puts( &quot;invalid menu selection, try again&quot; ); break; }</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519288074, "post_id": 48917111, "comment_id": 84851692, "body": "when calling any of the scanf() family of functions, 1) always check the returned value to assure the operation was successful. I.E. use something similar to <code>if( 1 != scanf(&quot;%c&quot;,&amp;choice) ) { fprintf( stderr, &quot;scanf for &#39;choice&#39; failed&quot; ); exit( EXIT_FAILURE ); }</code>  2) when using the &#39;%s&#39; or &#39;%[...]&#39; format specifiers, always include a MAX CHARACTERS modifier that is 1 less than the length of the input buffer, because those format specifiers always append a NUL byte to the input.  This also avoids any possibility of buffer overflow, which is undefined behavior and can lead to a seg fault event"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519288346, "post_id": 48917111, "comment_id": 84851819, "body": "this declaration: <code>char Fname,Sname;</code>  declares two variables, each of which is 1 char long.  Given the call: <code>scanf (&quot;%s&quot;,Fname);</code>  they should each be (at least) 3 bytes long, and preferably longer than the longest expected name I.E. <code>char Fname[30];  char Sname[30];  Then the call to scanf would be: </code>if( 1 != scanf( &quot;%29s&quot;, Fname ) ) {  // handle error and exit }`"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519289031, "post_id": 48917111, "comment_id": 84852182, "body": "when compiling, always enable the warnings, then fix those warnings.  ( for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnu11</code> )"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1519316297, "post_id": 48917111, "comment_id": 84871237, "body": "Welcome to Stack Overflow! Please <a href=\"https://stackoverflow.com/posts/48917111/edit\">edit</a> your question to show us what kind of debugging you&#39;ve done.  I expect you to have run your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> within Valgrind or a similar checker, and to have investigated with a debugger such as GDB, for example.  Ensure you&#39;ve enabled a full set of compiler warnings, too.  What did the tools tell you, and what information are they missing?  And read Eric Lippert&#39;s <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}], "answers": [{"tags": [], "owner": {"reputation": 351, "user_id": 5327169, "user_type": "registered", "profile_image": "https://graph.facebook.com/1187474291269110/picture?type=large", "display_name": "Rigoberto Ramirez Cruz", "link": "https://stackoverflow.com/users/5327169/rigoberto-ramirez-cruz"}, "is_accepted": false, "score": -1, "last_activity_date": 1519255250, "creation_date": 1519255250, "answer_id": 48917168, "question_id": 48917111, "link": "https://stackoverflow.com/questions/48917111/exe-has-stopped-working-cprogramming/48917168#48917168", "title": ".exe has stopped working (Cprogramming)", "body": "<p>As char just store one character and your name is longer than that, try using <strong><em>char Fname[]</em></strong>, for storing your entire name.</p>\n"}, {"tags": [], "owner": {"reputation": 557, "user_id": 6322723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M73Th9G-Iyw/AAAAAAAAAAI/AAAAAAAABVY/nL_lhOalfME/photo.jpg?sz=128", "display_name": "Abiud Orina", "link": "https://stackoverflow.com/users/6322723/abiud-orina"}, "is_accepted": false, "score": 0, "last_activity_date": 1519255997, "creation_date": 1519255997, "answer_id": 48917268, "question_id": 48917111, "link": "https://stackoverflow.com/questions/48917111/exe-has-stopped-working-cprogramming/48917268#48917268", "title": ".exe has stopped working (Cprogramming)", "body": "<p>char is used to read one character. Use string instead.\n%d is used for reading integers but you defined . Either use </p>\n\n<pre><code>int choice;\n</code></pre>\n\n<p>or use</p>\n\n<pre><code>scanf(\"%s\", &amp;choice);\n</code></pre>\n\n<p>try to use a switch for your selection too</p>\n\n<pre><code>switch(choice){\ncase 1:\ncreate();\nbreak;\n\ncase default:\n//default statement(s)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "is_accepted": false, "score": 0, "last_activity_date": 1519262874, "creation_date": 1519262874, "answer_id": 48918190, "question_id": 48917111, "link": "https://stackoverflow.com/questions/48917111/exe-has-stopped-working-cprogramming/48918190#48918190", "title": ".exe has stopped working (Cprogramming)", "body": "<p>Please pay attention to the compiler warnings. It will discover problems for you. Suggestion for improvements in the program comments:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n//#include &lt;iostream&gt; // C++ include, not needed!\n\nvoid create();\n\nint main()\n{\n    int choice; // changed to int to match scanf(\"%d\", char is to small to hold an `int`\n\n    printf(\"\\n\\t\\t **********************\\n\\n\");\n    printf(\"\\n\\t\\t Train Booking Application\\n\");\n    printf(\"\\n\\t\\t **********************\\n\\n\");\n    printf(\"Select 1 to create a booking,\\tSelect 2 to Edit booking,\\tSelect 3 to Delete a booking\\n\");\n\n    scanf(\"%d\", &amp;choice);\n\n     switch (choice){        // switch is a better choice than nested ifs\n         case 1:\n             create();\n         break;\n\n         default:\n         printf(\"not implemented yet...\\n\");\n         break;\n     }\n\n    return 0;   \n}\n\nvoid create(){\n    char Fname[256],Sname[256];  // changed to arrays to match scanf (\"%s\"\n    // char Fname, Sname with %s would destroy memory \n    printf(\"Please enter your First name:\\n\");\n    scanf (\"%s\",Fname);\n    printf(\"Please enter your Second name:\\n\");\n    scanf (\"%s\",Sname);\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9393508, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "zzzzzzzz", "link": "https://stackoverflow.com/users/9393508/zzzzzzzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1519262874, "creation_date": 1519254832, "last_edit_date": 1519254956, "question_id": 48917111, "link": "https://stackoverflow.com/questions/48917111/exe-has-stopped-working-cprogramming", "title": ".exe has stopped working (Cprogramming)", "body": "<p>I am running this program and keep getting an error after I input my name </p>\n\n<p>\"program1.exe has stopped working\"</p>\n\n<p>have no idea why any help?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;iostream&gt;\n\nvoid create();\n//void edit();\n//void delete();\nint main()\n{\n    char choice;\n    printf(\"\\n\\t\\t **********************\\n\\n\");\n    printf(\"\\n\\t\\t Train Booking Application\\n\");\n    printf(\"\\n\\t\\t **********************\\n\\n\");\n    printf(\"Select 1 to create a booking,\\tSelect 2 to Edit booking,\\tSelect 3 to Delete a booking\\n\");\n    scanf(\"%d\",&amp;choice);\n    if (choice == 1){\n        create();\n    }\n\n    return 0;   \n}\n\nvoid create(){\n    char Fname,Sname;\n    printf(\"Please enter your First name:\\n\");\n    scanf (\"%s\",Fname);\n    printf(\"Please enter your Second name:\\n\");\n\n\n}\n</code></pre>\n"}, {"tags": ["c", "floating-point", "comparison", "portability"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1519255623, "post_id": 48917087, "comment_id": 84840905, "body": "Portable? Maybe (if you only care about implementations that use IEEE-754). Good practice? Absolutely not. The other option is to return the error indication separately, i.e. <code>float myFunction(int *error)</code> or <code>int myFunction(float *result)</code>"}, {"owner": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1519255924, "post_id": 48917087, "comment_id": 84841005, "body": "@user3386109 Could you elaborate on the bad practice aspect in an answer? (Note that the CPython source does something <a href=\"https://github.com/python/cpython/blob/ba518804bf4c1ea01df5e622b333d3116cbaa3bd/Objects/longobject.c#L2883-L2887\" rel=\"nofollow noreferrer\">very similar</a>.)"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 24610, "user_id": 270986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49652c88a43a35bbf0095abfdae3515?s=128&d=identicon&r=PG", "display_name": "Mark Dickinson", "link": "https://stackoverflow.com/users/270986/mark-dickinson"}, "edited": false, "score": 0, "creation_date": 1519256067, "post_id": 48917087, "comment_id": 84841045, "body": "@MarkDickinson Then perhaps you should be the one posting an answer stating that CPython is an example of good practice."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1519256474, "post_id": 48917087, "comment_id": 84841155, "body": "@user3386109: Yes, it is terrible practice, just like using <code>int</code> return codes from functions to sometimes return a value (number of bytes transferred, stream number, number of arguments converted) and sometimes to return an error indication (resource not available, EOF) or using a pointer to represent either an address or the lack of an address (<code>NULL</code>)."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1519257965, "post_id": 48917087, "comment_id": 84841577, "body": "All I have to do is wait, because maintenance happens. Someone who doesn&#39;t understand all of the nuances of floating point numbers touches that code, and the whole thing blows up. That&#39;s what makes it bad practice. Unlike say returning <code>NULL</code>. With <code>NULL</code>, you don&#39;t need a wall of text to explain why you&#39;re absolutely certain that you might be fairly safe."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1519259601, "post_id": 48917087, "comment_id": 84841988, "body": "@user3386109: Yes, no bugs ever happened with null pointers. Everybody understands arithmetic with pointers, including the finer details of which additions and subtractions are allowed, and which conversions have defined results."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519268359, "post_id": 48917087, "comment_id": 84844178, "body": "Where NaN support exists, a typical error return is <code>if(error) return NAN;</code>"}, {"owner": {"reputation": 23, "user_id": 9393488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/925382b51b561a88c48a7c2a2a843cc2?s=128&d=identicon&r=PG&f=1", "display_name": "Patopato", "link": "https://stackoverflow.com/users/9393488/patopato"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1519290946, "post_id": 48917087, "comment_id": 84853321, "body": "@user3386109 According to the accepted answer I understand that using floats as error code is as safe as using int, but I would consider it as a bad practice because it mixes two concepts, two meanings, (error code and return values) in a single variables, rather than just because they are floats"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519268208, "post_id": 48917284, "comment_id": 84844135, "body": "&quot;....guarantee that the base...&quot; Here I thought <code>FLT_RADIX</code> must 10 or a power of 2.  Yet cannot find this supported in C, just <code>FLT_RADIX &gt; 1</code>.  LSNED."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519270775, "post_id": 48917284, "comment_id": 84844779, "body": "@chux: 16 is another possibility. I think the Xerox Sigma 9 used 16, but that is a vague memory, so it could be wrong."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519271194, "post_id": 48917284, "comment_id": 84844879, "body": "Some old systems I&#39;ve studied use  16, <a href=\"https://stackoverflow.com/questions/48917087/is-using-floats-and-comparison-as-error-code-portable/48917284?noredirect=1#comment84844135_48917284\">a power of 2</a>, like IBM/370 or 10: GP L3055.  Uncommon these days."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 1, "last_activity_date": 1519256100, "creation_date": 1519256100, "answer_id": 48917284, "question_id": 48917087, "link": "https://stackoverflow.com/questions/48917087/is-using-floats-and-comparison-as-error-code-portable/48917284#48917284", "title": "Is using floats and comparison as error code portable?", "body": "<p>The C standard does not guarantee much about floating-point behavior. It does say:</p>\n\n<blockquote>\n  <p>All floating constants of the same source form shall convert to the same internal format with the same value.</p>\n</blockquote>\n\n<p>This means that <code>99.75f</code> will produce the same value, whatever that may be, wherever it appears in your program. It does not guarantee that <code>99.750f</code> will convert to the same value, so you would have to be sure to use exactly the same source text each time it appears. Neither does it guarantee that other source text, such as <code>99.76f</code>, will not convert to the same value. So you will want to ensure that the special value you use is well separated from any values that will arise in calculation.</p>\n\n<p>The C standard does not guarantee that the base of the floating-point system is either 2 or 10. So, relying on the standard alone, you cannot be sure that 99.75 is representable. Of course, you are unlikely to encounter an implementation that uses base 3.</p>\n\n<p>The C standard allows implementations to evaluate expressions with extra range and precision. However, once <code>99.75f</code> is converted to floating-point, merely giving it extra range and precision would not alter it. Operations such as <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, and library routines could produce approximate results, but, presumably, you are not operating on this value.</p>\n\n<p>The C standard seems to imply that only one base will be used for the floating-point types, at least for the normal ones, as it defines only <code>FLT_RADIX</code> to report the base used for the floating-point system but defines <code>FLT_MANT_DIG</code> and <code>DBL_MANT_DIG</code> to report the number of digits used in the significands of <code>float</code> and <code>double</code>. So you do not have to worry that 99.75 would change when converted from <code>float</code> to <code>double</code> or extended precisions. It should only be represented with more digits in the same base, not converted to a new base, and hence the extra digits would be zero. (Of course, narrowing conversions could change it, so you would want to define the special value in terms of <code>float</code>, so that it can only get wider.)</p>\n\n<p>Overall, I expect you are fairly safe in this. However, it is not necessarily good design. Certainly the special value ought to be specified only once in the source text, by using a preprocessor macro or an identifier defined to be a constant value.</p>\n"}], "owner": {"reputation": 23, "user_id": 9393488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/925382b51b561a88c48a7c2a2a843cc2?s=128&d=identicon&r=PG&f=1", "display_name": "Patopato", "link": "https://stackoverflow.com/users/9393488/patopato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "accepted_answer_id": 48917284, "answer_count": 1, "score": 2, "last_activity_date": 1519256100, "creation_date": 1519254735, "question_id": 48917087, "link": "https://stackoverflow.com/questions/48917087/is-using-floats-and-comparison-as-error-code-portable", "title": "Is using floats and comparison as error code portable?", "body": "<p>I plan to use special floats values to retrun error codes from a function, such as <code>99.75f</code> wich is representable in IEEE-754:</p>\n\n<pre><code>float myFunction(void)\n{\n    /* Do some stuff */\n    if(error) return 99.75f;\n}\n</code></pre>\n\n<p>and later to check the value like this:</p>\n\n<pre><code>float result = myFunction();\nif(result == 99.75f) printf(\"Error !\");\n</code></pre>\n\n<p>Assuming my compilers conform to C90 or C99 standards, is this solution portable ? Will it works on any plateform ?\nOr is the compiler allowed to do some magic or some optimizations that would cast the float in a double, change its representation, etc, what which could break the equality check ?</p>\n\n<p>The famous <a href=\"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow noreferrer\" title=\"What Every Computer Scientist Should Know About Floating-Point Arithmetic\">What Every Computer Scientist Should Know About Floating-Point Arithmetic</a> does not seem to cover this case (C-specific).\nDoing a comparison with FLT_EPSILON or ULPs would be irrelevant as I definitively want to check the representation of the float...</p>\n"}, {"tags": ["c", "loops", "if-statement", "while-loop", "getchar"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9393548"}, "edited": false, "score": 0, "creation_date": 1519254724, "post_id": 48917072, "comment_id": 84840586, "body": "The above function prototype that needed to be used for the method was: void count(int* num_, int* num_exclamation);"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1519254830, "post_id": 48917072, "comment_id": 84840627, "body": "<code>char s[1000]; </code> is not initialized. The first time in your loop <code>for(i = 0; s[i] != &#39;\\0&#39;; i++)</code> , s[0] will contain a random value. 2) and probably you want a single <code>=</code> here: <code>if((s[i] == getchar())</code> ."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9393548"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1519255441, "post_id": 48917072, "comment_id": 84840851, "body": "I tried your advice wildplasser and neither did any benefit. I believe in my if statements, I have an extra condition that is unnecessary I just can&#39;t tell which one or if that is even the issue.."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1519256142, "post_id": 48917072, "comment_id": 84841064, "body": "@wildplasser Global  <code>char s[1000];</code> is initialized to zeros."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1519256166, "post_id": 48917072, "comment_id": 84841075, "body": "Note that <code>s[]</code> is nowhere  assigned in the entire program. And your loop <code>do     {         ch = getchar();     }while(ch != &#39;\\n&#39;);</code> essentially waits for a CR to be input, ignoring everything typed in."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519256281, "post_id": 48917072, "comment_id": 84841108, "body": "@chux You are correct. I&#39;d never expected a one letter identifier for a global/static variable. ;-["}], "answers": [{"comments": [{"owner": {"reputation": 641, "user_id": 9148849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/023a4371461ee3649aadee1609399bed?s=128&d=identicon&r=PG&f=1", "display_name": "nabil.douss", "link": "https://stackoverflow.com/users/9148849/nabil-douss"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519288194, "post_id": 48917222, "comment_id": 84851737, "body": "You&#39;re right for <code>s[1000]</code> but I meant the other variables in main. I will make the necessary changes."}], "tags": [], "owner": {"reputation": 641, "user_id": 9148849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/023a4371461ee3649aadee1609399bed?s=128&d=identicon&r=PG&f=1", "display_name": "nabil.douss", "link": "https://stackoverflow.com/users/9148849/nabil-douss"}, "is_accepted": false, "score": 1, "last_activity_date": 1519288220, "last_edit_date": 1519288220, "creation_date": 1519255676, "answer_id": 48917222, "question_id": 48917072, "link": "https://stackoverflow.com/questions/48917072/how-do-i-edit-my-code-so-that-i-may-output-the-frequency-of-two-specific-charact/48917222#48917222", "title": "How do I edit my code so that I may output the frequency of TWO specific characters input by a user? (C Language)", "body": "<p>your program is getting a \"sentence\" as user input then ignore it completely.</p>\n\n<p>you are not intializing this variables. </p>\n\n<pre><code>int num_user;\nint num_exclamation_user;\n</code></pre>\n\n<p>I'd suggest that you store the string input somewhere(e.g in <code>s</code>) like this : </p>\n\n<pre><code>fgets (s, 1000, stdin);\n</code></pre>\n\n<p>instead of your while do loop. \nThen in your <code>count</code> function just compare <code>s[i]</code> with <code>'_'</code> and <code>'!'</code>\nlike this  :</p>\n\n<pre><code>if(s[i] == '_'){\n\n        ++num_count;\n        *num_ = num_count;  \n    }\nelse if (s[i] == '!')\n    {\n        ++num_exclamation_count;\n        *num_exclamation = num_exclamation_count; \n    }\n    else\n    {\n        continue;\n    }\n</code></pre>\n\n<p>because with <code>s[i] == getchar()</code>  you are asking the user to re-type a character. </p>\n"}, {"comments": [{"owner": {"reputation": 88, "user_id": 2688066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bfe9bc3fac52ade114973a0967fd60?s=128&d=identicon&r=PG", "display_name": "Aravind Battaje", "link": "https://stackoverflow.com/users/2688066/aravind-battaje"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519264232, "post_id": 48917251, "comment_id": 84843152, "body": "Ah, indeed. I overlooked the <code>&#39;\\0&#39;</code> part in the for loop. I assumed <code>&#39;\\n&#39;</code> was used in both <code>main()</code> and <code>count()</code> function."}], "tags": [], "owner": {"reputation": 88, "user_id": 2688066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05bfe9bc3fac52ade114973a0967fd60?s=128&d=identicon&r=PG", "display_name": "Aravind Battaje", "link": "https://stackoverflow.com/users/2688066/aravind-battaje"}, "is_accepted": false, "score": 0, "last_activity_date": 1519255842, "creation_date": 1519255842, "answer_id": 48917251, "question_id": 48917072, "link": "https://stackoverflow.com/questions/48917072/how-do-i-edit-my-code-so-that-i-may-output-the-frequency-of-two-specific-charact/48917251#48917251", "title": "How do I edit my code so that I may output the frequency of TWO specific characters input by a user? (C Language)", "body": "<p>How does the string <code>s</code> get a reference to what the user has input?</p>\n\n<p>You might want to insert <code>ch</code> into the string in the main loop.</p>\n\n<pre><code>int count = 0;\ndo\n{\n    ch = getchar();\n    s[count] = ch;\n    count = count + 1;\n}while(ch != '\\n');\n</code></pre>\n\n<p>Of course, the user shouldn't type more than 1000 characters, in which case this would fail. But, you can just add a condition in the while loop to check for <code>count</code> to fix that. In general though, you should look at using <a href=\"https://stackoverflow.com/questions/9278226/which-is-the-best-way-to-get-input-from-user-in-c\">secure</a> input methods, which is probably outside the scope of your problem and constraints, but it is good to know.</p>\n\n<p>Why have you placed <code>getchar()</code> inside the <code>count()</code> function? Do you intend to accept more characters from stdin (console)? If not, you would simply remove <code>getchar()</code> parts from that function</p>\n\n<pre><code>void count(int* num_, int* num_exclamation)\n{       \n    int i;\n    for(i = 0; s[i] != '\\0'; i++)\n    {\n        if(s[i] == '_')\n        {\n            ++num_count;\n            *num_ = num_count;  \n        }\n        else if(s[i] == '!')\n        {\n            ++num_exclamation_count;\n            *num_exclamation = num_exclamation_count;\n        }\n        // This is not really required\n        //else\n        //{\n        //    continue;\n        //}\n    }\n\n}\n</code></pre>\n\n<p>Also, initialize <code>num_user</code> and <code>num_exclamation_user</code> in the <code>main()</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 774, "user_id": 1545026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/801a95d7d2898dab685f8d268c9e8e3f?s=128&d=identicon&r=PG", "display_name": "Jeff", "link": "https://stackoverflow.com/users/1545026/jeff"}, "is_accepted": false, "score": 0, "last_activity_date": 1519255944, "creation_date": 1519255944, "answer_id": 48917261, "question_id": 48917072, "link": "https://stackoverflow.com/questions/48917072/how-do-i-edit-my-code-so-that-i-may-output-the-frequency-of-two-specific-charact/48917261#48917261", "title": "How do I edit my code so that I may output the frequency of TWO specific characters input by a user? (C Language)", "body": "<p><code>getchar()</code> is a function that pulls the next character from the input and returns it. <em>Every</em> time you call it the next letter is retrieved.</p>\n\n<p>In your code, the loop in <code>main()</code> gets the entire input and ... doesn't put it anywhere, so it is lost forever.</p>\n\n<p>It seems like you are supposed to save it to <code>s[]</code>. Then, in <code>count()</code>, you can refer to the current character as <code>s[I]</code> instead of calling <code>getchar()</code>, which has no more input to return.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519393397, "post_id": 48917346, "comment_id": 84904580, "body": "@MannyDeJesus Review <a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1519261205, "last_edit_date": 1519261205, "creation_date": 1519256480, "answer_id": 48917346, "question_id": 48917072, "link": "https://stackoverflow.com/questions/48917072/how-do-i-edit-my-code-so-that-i-may-output-the-frequency-of-two-specific-charact/48917346#48917346", "title": "How do I edit my code so that I may output the frequency of TWO specific characters input by a user? (C Language)", "body": "<p>OP's code has these errors:</p>\n\n<ol>\n<li><p>Not initializing <code>num_user, num_exclamation_user</code> in <code>main()</code>.  Set them to 0</p></li>\n<li><p>Unneeded code of <code>do { ch = getchar(); while (ch != '\\n');</code> in <code>main()</code>. Delete</p></li>\n<li><p>Looking for a <em>null character</em> from input with <code>for(i = 0; s[i] != '\\0'; i++)</code> prevented loop iteration as <code>s[0]</code> is initialized to 0<sup>1</sup>.  User input is <em>lines</em>, not a <em>string</em>.  Look for a <code>'\\n</code>'.  Also <em>assign</em> <code>s[i] = getchar()</code>, not compare <code>s[i] == getchar()</code>  <a href=\"https://stackoverflow.com/questions/48917072/how-do-i-edit-my-code-so-that-i-may-output-the-frequency-of-two-specific-charact/48917346#comment84840627_48917072\">@wildplasser</a></p>\n\n<pre><code>//for (i = 0; s[i] != '\\0'; i++) {\nfor (i = 0; i &lt; 1000 &amp;&amp; (s[i] = getchar()) != '\\n'; i++) {\n</code></pre></li>\n<li><p>Code calls <code>getchar()</code> more than once per loop.</p>\n\n<pre><code>// if ((s[i] == getchar()) &amp;&amp; (s[i] == '_')) {\nif (s[i] == '_') {\n  ...\n// } else if ((s[i] == getchar()) &amp;&amp; (s[i] == '!')) {\n} else if (s[i] == '!') {\n</code></pre></li>\n</ol>\n\n<p>Although there are other learner issues (e.g. better to use <code>int ch</code> for input than a <code>char s[i]</code>), fixing the above will solve OP's problem.</p>\n\n<p><sup>1</sup>  <em>Global</em> integer types like the array <code>s[1000]</code> elements are initialized to 0.</p>\n\n<p>Short <code>count()</code> below.  Think it out before mousing over.</p>\n\n<blockquote class=\"spoiler\">\n  <p> void count(int* num_, int* num_exclamation) {<br>\n   int ch;\n   while ((ch = getchar()) != '\\n' &amp;&amp; ch != EOF) {<br>\n     if (ch == '<em>') {<br>\n       (*num</em>)++;<br>\n     } else if (ch == '!') {<br>\n       (*num_)++;<br>\n     }<br>\n   }<br>\n }</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519260492, "post_id": 48917458, "comment_id": 84842236, "body": "<code>void count(int* num_, int* num_exclamation, char *ps)</code> looks like what a good programmer might do, but does not meet &quot;This function prototype must remain unmodified:&quot;"}, {"owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519261330, "post_id": 48917458, "comment_id": 84842448, "body": "@chux: Thanks, I missed it. Made the appropriate changes."}], "tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1519261245, "last_edit_date": 1519261245, "creation_date": 1519257217, "answer_id": 48917458, "question_id": 48917072, "link": "https://stackoverflow.com/questions/48917072/how-do-i-edit-my-code-so-that-i-may-output-the-frequency-of-two-specific-charact/48917458#48917458", "title": "How do I edit my code so that I may output the frequency of TWO specific characters input by a user? (C Language)", "body": "<p><code>getchar()</code> return type is <code>int</code>, so change the <code>ch</code> type to <code>int</code> and add a check for <code>EOF</code>. Also, you don't want the <code>\\n</code> character to be part of input stored in <code>s</code> array so, replace <code>do while</code> loop with <code>while</code> loop.<br>\nYou don't need the globals - <code>num_count</code>, <code>num_exclamation_count</code> and <code>ch</code>. Try not to use globals as much as possible. Even you don't need the buffer <code>s</code> to be declared as a global variable. You can declare it in <code>main()</code> and pass it to function <code>count()</code> as an argument but for this, you need to modify the <code>count()</code> prototype and seems that this is something that you don't want to do.<br>\nThe other answers have already pointed out the errors in your code. You can do:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define BUF_SZ 1000\n\nchar s[BUF_SZ];\n\nvoid count(int* num_, int* num_exclamation)\n{\n    int i;\n    for(i = 0; s[i] != '\\0'; i++)\n    {\n        if(s[i] == '_')\n        {\n            ++(*num_);\n        }\n        else if(s[i] == '!')\n        {\n            ++(*num_exclamation);\n        }\n    }\n}\n\nint main (void)\n{\n    int num_user = 0, num_exclamation_user = 0, i = 0, ch;\n\n    printf(\"Enter a sentence: \");\n\n    while ((ch = getchar()) != '\\n' &amp;&amp; ch != EOF)\n    {\n        if (i &lt; (sizeof(s) - 1)) { // sizeof(s) - 1, to keep the space for terminating null character\n            s[i++] = ch;\n        } else {\n            break; //discard the input beyond the size of buffer s\n        }\n    }\n\n    s[i] = '\\0';\n    count(&amp;num_user, &amp;num_exclamation_user);\n\n    printf(\"There are %d underscores and %d exclamation points in the sentence.\\n\", num_user, num_exclamation_user);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9393548"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 48917346, "answer_count": 5, "score": 1, "last_activity_date": 1519288220, "creation_date": 1519254635, "question_id": 48917072, "link": "https://stackoverflow.com/questions/48917072/how-do-i-edit-my-code-so-that-i-may-output-the-frequency-of-two-specific-charact", "title": "How do I edit my code so that I may output the frequency of TWO specific characters input by a user? (C Language)", "body": "<p>I have tried for hours to edit this code to work the way I want it to. I am meant to code a program to track the frequency of how often an underscore '_' and an exclamation point '!' appear in a sentence input by a user:\n_Hi_there!!!</p>\n\n<p><strong>Specifications that must be used and/or not deleted</strong>\n-This function prototype must remain unmodified:\n-The getchar() method must be used to hold the value of the sentence input by the user.</p>\n\n<p>Now I have this code after hours of struggling to get a proper output:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint num_count;\nint num_exclamation_count;\nchar ch;\nchar s[1000]; \nvoid count(int* num_, int* num_exclamation)\n{       \n    int i;\n    for(i = 0; s[i] != '\\0'; i++)\n    {\n        if((s[i] == getchar()) &amp;&amp; (s[i] == '_'))\n        {\n            ++num_count;\n            *num_ = num_count;  \n        }\n        else if((s[i] == getchar()) &amp;&amp; (s[i] == '!'))\n        {\n            ++num_exclamation_count;\n            *num_exclamation = num_exclamation_count;\n        }\n        else\n        {\n            continue;\n        }\n    }\n\n}\n\nint main (void)\n{\n    int num_user, num_exclamation_user;\n    printf(\"Enter a sentence: \");\n    do\n    {\n        ch = getchar();\n    }while(ch != '\\n');\n    count(&amp;num_user, &amp;num_exclamation_user);\n\n    printf(\"There are %d underscores and %d exclamation points in the \n    sentence.\\n\", num_user, num_exclamation_user);\n\n    return 0;\n}\n</code></pre>\n\n<p>The output I get is as follows:</p>\n\n<pre><code>There are 0 underscores and 0 exclamation points in the sentence.\n</code></pre>\n\n<p>I tried every variation of while or if or do-while statements I could conjure in my mind or find available online and I get nowhere but further away. If someone could thoroughly explain how I arrange which conditional statement/loop with the getchar() method and necessary variables, that would be awesome. Open to criticism as well if I blatantly screwed something up or passed over an obvious issue, do not be scared to hurt my feelings. I only want to learn and will be my only mindset as I am assisted with this problem.</p>\n\n<p>Thank you. </p>\n"}, {"tags": ["c", "scandir"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1519253331, "post_id": 48916733, "comment_id": 84840099, "body": "The answer to 2 is that <code>scandir</code> creates an array of pointers, and then sorts the array of pointers. So the <code>compare</code> function gets a pointer that points to an entry in the array (which happens to be a pointer)."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 6855706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/218bc3dceef2d46f7d86a5d9c8a4b0b1?s=128&d=identicon&r=PG&f=1", "display_name": "S. Forman", "link": "https://stackoverflow.com/users/6855706/s-forman"}, "edited": false, "score": 0, "creation_date": 1519262450, "post_id": 48916929, "comment_id": 84842714, "body": "Thanks. So I think you are suggesting that I 1) pass NULL as the compare function to scandir(), which would then return the number of filtered struct dirent entries; and then 2) follow your 4 steps above. Is that correct?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 59, "user_id": 6855706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/218bc3dceef2d46f7d86a5d9c8a4b0b1?s=128&d=identicon&r=PG&f=1", "display_name": "S. Forman", "link": "https://stackoverflow.com/users/6855706/s-forman"}, "edited": false, "score": 0, "creation_date": 1519289267, "post_id": 48916929, "comment_id": 84852314, "body": "Yes. that is my suggestion. Note however that it will only improve speed on very large directories. Benchmarking will tell you if it is worth the trouble."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1519253768, "creation_date": 1519253768, "answer_id": 48916929, "question_id": 48916733, "link": "https://stackoverflow.com/questions/48916733/how-to-retrieve-files-in-creation-oder-using-scandir/48916929#48916929", "title": "How to retrieve files in creation oder using scandir", "body": "<p>There is no portable way to retrieve the creation time from the inode directly.</p>\n\n<p>In order to minimize the number of <code>stat()</code> system calls follow these steps:</p>\n\n<ul>\n<li>allocate an array of structures with the creation time and the pointer to the file name.</li>\n<li>initialize this array by calling <code>stat()</code> iteratively for each entry, composing the full filename from the entry and the relative path from the current directory, and store the creation time and the pointer to the entry name.</li>\n<li>sort this array with an ad-hoc sorting function.</li>\n<li>list the entries from this table.</li>\n</ul>\n"}], "owner": {"reputation": 59, "user_id": 6855706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/218bc3dceef2d46f7d86a5d9c8a4b0b1?s=128&d=identicon&r=PG&f=1", "display_name": "S. Forman", "link": "https://stackoverflow.com/users/6855706/s-forman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1519253768, "creation_date": 1519252747, "last_edit_date": 1519253655, "question_id": 48916733, "link": "https://stackoverflow.com/questions/48916733/how-to-retrieve-files-in-creation-oder-using-scandir", "title": "How to retrieve files in creation oder using scandir", "body": "<p>I would like to use a C API to read files in a directory in creation order, but I know that <code>readdir()</code> does not specify a read order.  So I can use <code>scandir()</code> to do this, by passing a compare function that would do a <code>stat()</code> on the 2 <code>d_name</code> fields of the <code>struct dirent</code> and return <code>-1</code>, <code>0</code> or <code>1</code> to determine which entry was created first.  </p>\n\n<p>But I have 2 questions:</p>\n\n<ol>\n<li><p><code>struct dirent</code> has a <code>d_ino</code> field. Can I get the creation time using the <code>d_ino</code> field more efficiently than calling <code>stat()</code>?</p></li>\n<li><p>The function signature for the compare function is <code>int compare(const struct dirent **, const struct dirent **);</code>  It seems like passing the structs by a <code>const</code> pointer instead of a <code>const</code> double pointer would be sufficient.  Does anyone know why the structs are passed by a double pointer instead of just by a pointer?</p></li>\n</ol>\n"}, {"tags": ["c", "while-loop"], "comments": [{"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1519251541, "post_id": 48916447, "comment_id": 84839373, "body": "Add an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> please"}, {"owner": {"reputation": 783, "user_id": 8890692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d73b1bb439acfca597990e5eea101a?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Kerian", "link": "https://stackoverflow.com/users/8890692/matthew-kerian"}, "edited": false, "score": 0, "creation_date": 1519251687, "post_id": 48916447, "comment_id": 84839441, "body": "Could it be that there&#39;s a newline character that&#39;s still being read?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 3, "creation_date": 1519251688, "post_id": 48916447, "comment_id": 84839442, "body": "Don&#39;t use <code>gets</code>, this is dangerous function because it can overflow the buffer of the input is too large. Use <code>fgets</code> instead."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1519290991, "post_id": 48916447, "comment_id": 84853353, "body": "<code>case</code> is not a function, don&#39;t use it with parentheses like that"}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1519254181, "post_id": 48916520, "comment_id": 84840400, "body": "While this is certainly a good idea, it doesn&#39;t seem like it would be the solution to the problem unless he&#39;s typing at least 20 characters in response to the prompt."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1519289383, "post_id": 48916520, "comment_id": 84852376, "body": "@Barmar: indeed, I wrote <i>potential buffer overflows</i> and <i>a possible explanation</i>... MCVE is needed for an accurate diagnostic, but my suggestion seem to have helped the OP. As such, I don&#39;t think I deserve a downvote."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1519331139, "post_id": 48916520, "comment_id": 84879909, "body": "I didn&#39;t downvote, that was someone else (but I didn&#39;t upvote, either). I&#39;m not sure why the OP accepted this answer."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": -2, "last_activity_date": 1519289500, "last_edit_date": 1519289500, "creation_date": 1519251762, "answer_id": 48916520, "question_id": 48916447, "link": "https://stackoverflow.com/questions/48916447/c-while-loop-partially-performs-one-extra-iteration/48916520#48916520", "title": "C while loop partially performs one extra iteration", "body": "<p>The code posted does not contain enough information to diagnose your problem. Please post an <a href=\"https://stackoverflow.com/help/mcve\">MCVE (Minimal, Complete, and Verifiable Example)</a> for a precise answer.</p>\n\n<p>Note however that using <code>gets()</code> is a cause for potential buffer overflows, which has undefined behavior, a possible explanation for any unexpected results.</p>\n\n<p>Use <code>fgets()</code> instead and pass the size of the destination array.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9393410, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9393410", "link": "https://stackoverflow.com/users/9393410/user9393410"}, "edited": false, "score": 0, "creation_date": 1519286276, "post_id": 48917825, "comment_id": 84850772, "body": "thx! See I&#39;ve got that IF right before Switch supposed to validate input so I should be good with odds :) Besides getchar and stuff will be getting first chars of a string input and in this way making some strings valid for proceeding to char-Switch regardless of there length which is not always good."}], "tags": [], "owner": {"reputation": 185, "user_id": 9357607, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/sv495.jpg?s=128&g=1", "display_name": "Shrey", "link": "https://stackoverflow.com/users/9357607/shrey"}, "is_accepted": false, "score": 0, "last_activity_date": 1519259857, "creation_date": 1519259857, "answer_id": 48917825, "question_id": 48916447, "link": "https://stackoverflow.com/questions/48916447/c-while-loop-partially-performs-one-extra-iteration/48917825#48917825", "title": "C while loop partially performs one extra iteration", "body": "<p>Even though this question is already answered, i realized there are quite a few things not professional with your code.</p>\n\n<p>Starting with <code>char menu[] = \"1 - run first task\\n2 - run se...\";</code></p>\n\n<p>Even though not giving size and initializing right away works in C, it is not a good practice, you should always either define a strict size, or dynamically allocate it (using malloc or calloc). </p>\n\n<p>Secondly, you're using <code>gets()</code> to read from the console, which is a dangerous thing, and make your application vulnerable. <code>gets()</code> is considered dangerous due to its inability to deal with strings that are larger than size of buffer. And since you're taking user input, it's even worse, cause you should always consider the possibility that user might enter what they're not supposed to enter. <strong>Never count on mercy of users.</strong> Use <code>fgets</code> to read from either file or console, as you get to define how many maximum bytes you want to read at a time.</p>\n\n<p>Thirdly, while using switch statement, along with the cases that you want to handle, always make a default case as well. Same thing, don't count on user. They may suppose to enter <code>'1'</code> but what if they enter <code>'9'</code>, if you have not handled that case, you might have some unexpected behavior from application. </p>\n\n<p>Fourth, i see here your main objective is to let user decide menu option, instead of using a string, you can use a char, and instead of <code>gets()</code> or <code>fgets()</code>, you can use <code>getch()</code> or <code>getchar()</code>.</p>\n\n<p>Below is little modified version of your code</p>\n\n<pre><code>int main(void)\n{    \n    char menu[200] = \"1 - run first task\\n2 - run se...\";\n    char x = 0;\n\n    while (1)\n    {\n        puts(menu);\n        x = getch();\n\n        switch (x)\n        {\n        case ('1'):\n            task1();\n            break;\n\n        case('2'):\n            task2();\n            break;\n\n        case('c'):\n            system(\"cls\");\n            break;\n\n        case('x'):\n            break;\n\n        default:\n            printf(\"Please choose a valid option!!\");\n            break;\n       }\n    }   \n}\n</code></pre>\n\n<p>`</p>\n"}], "owner": {"reputation": 1, "user_id": 9393410, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9393410", "link": "https://stackoverflow.com/users/9393410/user9393410"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 1, "accepted_answer_id": 48916520, "answer_count": 2, "score": -1, "last_activity_date": 1519289500, "creation_date": 1519251427, "last_edit_date": 1519251847, "question_id": 48916447, "link": "https://stackoverflow.com/questions/48916447/c-while-loop-partially-performs-one-extra-iteration", "title": "C while loop partially performs one extra iteration", "body": "<p>So after running the following code, on first iteration it prints out the menu variable and waits for a couple of inputs. But when it gets to the second iteration it just skips gets() and switch() only printing menu and blank \"input\" var. But then on the third iteration it performs appropriate. \nSo why does it skip every second iteration in such way?</p>\n\n<pre><code>int main(void) {\n    char menu[] = \"1 - run first task\\n2 - run se...\";\n    while (1) {\n        char input[20];\n        printf(menu);\n        gets(input);\n        puts(input);\n        if (checker1(input))\n            switch(input[0]) {\n            case ('1'):\n                task1();\n                break;\n            case('2'):\n                task2();\n                break;\n            case('c'):\n                system(\"cls\");\n                break;\n            case('x'):\n                return 0;\n            }\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 5, "creation_date": 1519251009, "post_id": 48916334, "comment_id": 84839121, "body": "use your debugger"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1519251010, "post_id": 48916334, "comment_id": 84839122, "body": "Note that <code>x = (x-index)&#47;10;</code> can be safely replaced by <code>x = x &#47; 10;</code>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1519251591, "post_id": 48916334, "comment_id": 84839394, "body": "Using the debugger is a good idea. The other option is to use <code>printf</code> to display the values of <code>x</code>, <code>y</code>, and <code>index</code> at various points in the program."}, {"owner": {"reputation": 754, "user_id": 666066, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/fI4uL.jpg?s=128&g=1", "display_name": "KeithSmith", "link": "https://stackoverflow.com/users/666066/keithsmith"}, "edited": false, "score": 3, "creation_date": 1519251666, "post_id": 48916334, "comment_id": 84839428, "body": "My running of the code is 10 -&gt; 0, 202 -&gt; 4, and 875 -&gt; -2147483616. Learning how to use a debugger, as mentioned above, is part of learning to program."}], "answers": [{"comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1519252140, "post_id": 48916577, "comment_id": 84839639, "body": "ie - add y = 0 after x = y"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1519252393, "post_id": 48916577, "comment_id": 84839759, "body": "Need also to add <code>index = x % 10</code> in that section. So both <code>y</code> and <code>index</code> need to be properly re-initialized. I think the commenters generally know this, but trying to avoid giving away the answer to an OP that should learn some debugging. But alas..."}, {"owner": {"reputation": 11, "user_id": 6630700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f932d57d5ab6efd10d561afaa7abbbe?s=128&d=identicon&r=PG&f=1", "display_name": "Ratata4", "link": "https://stackoverflow.com/users/6630700/ratata4"}, "edited": false, "score": 0, "creation_date": 1519253385, "post_id": 48916577, "comment_id": 84840119, "body": "I got that ! Thanks a lot !"}], "tags": [], "owner": {"reputation": 641, "user_id": 9148849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/023a4371461ee3649aadee1609399bed?s=128&d=identicon&r=PG&f=1", "display_name": "nabil.douss", "link": "https://stackoverflow.com/users/9148849/nabil-douss"}, "is_accepted": false, "score": 0, "last_activity_date": 1519252396, "last_edit_date": 1519252396, "creation_date": 1519251988, "answer_id": 48916577, "question_id": 48916334, "link": "https://stackoverflow.com/questions/48916334/write-c-program-to-compute-the-numeric-root/48916577#48916577", "title": "write C program to compute the numeric root", "body": "<p>I think that your problem is here : </p>\n\n<pre><code>if(y &lt; 10){\n    printf(\"%d\\n\",y);\n    found = 1;\n  }\n  else{\n    x = y;\n  }\n</code></pre>\n\n<p>in your else statement you assign the value of <code>x</code> to <code>y</code>, but you don't change the value of <code>y</code>. </p>\n\n<p>Maybe you should do something like this : </p>\n\n<pre><code>if(y &lt; 10){\n    printf(\"%d\\n\",y);\n    found = 1;\n  }\n  else{\n    x = y;\n    y = 0;\n    index = x % 10;\n  }\n</code></pre>\n\n<p>In your entire program you don't seem to decrease or reset the value of <code>y</code>, that's why once the else block entered, there is no way to enter the if block, because <code>y</code> will increase and always be greater than 10 until an overflow happens, that's why <code>y</code> is negative at the end. </p>\n\n<p>PS: Always use a debugger or <code>printf</code> statements it will help you detect such problems. </p>\n"}, {"tags": [], "owner": {"reputation": 3266, "user_id": 6854407, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205840043960722/picture?type=large", "display_name": "Jim Rogers", "link": "https://stackoverflow.com/users/6854407/jim-rogers"}, "is_accepted": false, "score": 1, "last_activity_date": 1519272998, "last_edit_date": 1519272998, "creation_date": 1519252561, "answer_id": 48916698, "question_id": 48916334, "link": "https://stackoverflow.com/questions/48916334/write-c-program-to-compute-the-numeric-root/48916698#48916698", "title": "write C program to compute the numeric root", "body": "<p>Your solution can be greatly simplified with the use of a simple function. \nSee the following solution using the Ada language:</p>\n\n<pre><code>with Ada.Integer_Text_IO; use Ada.Integer_Text_Io;\nwith Ada.Text_IO; use Ada.Text_IO;\n\nprocedure Main is\n   Inpt_Value : Natural;\n   Root       : Natural := 0;\n   function Find_Root(X : Natural) return Natural is\n      Value : Natural := X;\n      Root  : Natural := 0;\n   begin\n      while Value &gt; 0 loop\n         Root  := Root + (Value mod 10);\n         Value := Value / 10;\n      end loop;\n      return Root;\n   end Find_Root;\n\nbegin\n   Put(\"Enter a non-negative integer: \");\n   Get(Item =&gt; Inpt_Value);\n   Root := Find_Root(Inpt_Value);\n   while Root &gt; 10 loop\n      Root := Find_Root(Root);\n   end loop;\n   Put_Line(Root'Image);\nend Main;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6630700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f932d57d5ab6efd10d561afaa7abbbe?s=128&d=identicon&r=PG&f=1", "display_name": "Ratata4", "link": "https://stackoverflow.com/users/6630700/ratata4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1519272998, "creation_date": 1519250926, "last_edit_date": 1519251731, "question_id": 48916334, "link": "https://stackoverflow.com/questions/48916334/write-c-program-to-compute-the-numeric-root", "title": "write C program to compute the numeric root", "body": "<p>The numeric root of x is computed as follows:\na) Compute the sum, y, of all of x\u2019s (decimal) digits;\nb) If y is greater than 10, then set x to y and go to step a). Otherwise, y is x\u2019s numerical root.\nThus, the numeric root of 10, 202 and 875 are 1, 4 and 2, respectively.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n\n    int x, y, index, found;\n\n    found = 0;\n    scanf(\"%d\", &amp;x);\n\n    if (x &lt; 0)\n    {\n        printf(\"The input number must be nonnegative.\\n\");\n    }\n    else\n    {\n        y = 0;\n        index = x % 10;\n\n        while (found != 1)\n        {\n            while (x &gt; 10)\n            {\n                y = y + index;\n                x = (x - index) / 10;\n                index = x % 10;\n            }\n\n            y = y + index;\n\n            if (y &lt; 10)\n            {\n                printf(\"%d\\n\", y);\n                found = 1;\n            }\n            else\n            {\n                x = y;\n            }\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>My output are always numbers like \"-2147483623\" etc.\nAny help will be appreciated.</p>\n"}, {"tags": ["c", "arrays", "function"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1519250824, "post_id": 48916233, "comment_id": 84839040, "body": "<code>printf(&quot;%.2f\\n&quot;,&amp;cArray[i]);</code> Remove the <code>&amp;</code>. With it you are passing the address of the variable, when you want to pass the value."}, {"owner": {"reputation": 33, "user_id": 3268349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b90a5633858d89887a4c5fc95726fc6e?s=128&d=identicon&r=PG&f=1", "display_name": "Amanda6276", "link": "https://stackoverflow.com/users/3268349/amanda6276"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1519250992, "post_id": 48916233, "comment_id": 84839113, "body": "Thank you, that did let me view the right print so at least now I know that the array is being passed. However, I&#39;m still getting multiple &quot;0.00 in C is 0.00 in F&quot;, do you have any advice for that?"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1519251046, "post_id": 48916233, "comment_id": 84839134, "body": "Same issue there, too."}, {"owner": {"reputation": 33, "user_id": 3268349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b90a5633858d89887a4c5fc95726fc6e?s=128&d=identicon&r=PG&f=1", "display_name": "Amanda6276", "link": "https://stackoverflow.com/users/3268349/amanda6276"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1519251200, "post_id": 48916233, "comment_id": 84839211, "body": "Thank you so much, that&#39;s fixed it. Sorry for the seemingly simple question. I&#39;m only starting C after using Java and I&#39;m having some issues with the print functions. I&#39;m used to printing anything in some ++. And all this %d/%f/%c and &amp; etc is just confusing still."}], "answers": [{"tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": true, "score": 2, "last_activity_date": 1519251387, "last_edit_date": 1519251387, "creation_date": 1519251074, "answer_id": 48916374, "question_id": 48916233, "link": "https://stackoverflow.com/questions/48916233/cant-bring-array-values-to-function/48916374#48916374", "title": "Can&#39;t bring array values to function", "body": "<pre><code>&amp;cArray[i]\n</code></pre>\n\n<p>you don't need to address of the ith element in order to print it, you just need the ith element</p>\n\n<p>Change</p>\n\n<pre><code>printf(\"%.2f\\n\",&amp;cArray[i]);\n\nprintf(\"\\n %.2f in Celsius is %.2f in Fahrenheit\\n\", &amp;temp, &amp;con);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>printf(\"%.2f\\n\",cArray[i]);\n\nprintf(\"\\n %.2f in Celsius is %.2f in Fahrenheit\\n\", temp, con);\n</code></pre>\n\n<p>The same with <code>con</code>, <code>printf()</code> doesn't need the address of a scalar variable in order to print it.</p>\n"}, {"comments": [{"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "edited": false, "score": 1, "creation_date": 1519251759, "post_id": 48916382, "comment_id": 84839476, "body": "In C, arrays are always passed as pointers, they are not copied."}], "tags": [], "owner": {"reputation": 73, "user_id": 9392455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RsE68.png?s=128&g=1", "display_name": "RyanArr", "link": "https://stackoverflow.com/users/9392455/ryanarr"}, "is_accepted": false, "score": 0, "last_activity_date": 1519252641, "last_edit_date": 1519252641, "creation_date": 1519251112, "answer_id": 48916382, "question_id": 48916233, "link": "https://stackoverflow.com/questions/48916233/cant-bring-array-values-to-function/48916382#48916382", "title": "Can&#39;t bring array values to function", "body": "<p>Like Johnny Mopp said you have an extraneous <code>&amp;</code>,</p>\n\n<p>But depending on the size of the array you're dealing with you may just want to pass a pointer to the function instead.</p>\n"}], "owner": {"reputation": 33, "user_id": 3268349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b90a5633858d89887a4c5fc95726fc6e?s=128&d=identicon&r=PG&f=1", "display_name": "Amanda6276", "link": "https://stackoverflow.com/users/3268349/amanda6276"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 48916374, "answer_count": 2, "score": 2, "last_activity_date": 1519252641, "creation_date": 1519250492, "last_edit_date": 1519252481, "question_id": 48916233, "link": "https://stackoverflow.com/questions/48916233/cant-bring-array-values-to-function", "title": "Can&#39;t bring array values to function", "body": "<p>I have prompted the user for 5 inputs in the main and saved them into an array called array. I've checked the array in main and it prints out the values as they were entered. However, when I pass it to a function which I've included below, I get the output that the array contains all 0 values.\nWhat am I doing wrong?</p>\n\n<pre><code>conversion(float array[], int size)\n{\nfloat add = 0.0;\nfloat change, num;\n\nprintf(\"\\nThe array is: \\n\");\nfor (i=0;i &lt; size;i++)\n{\n    printf(\"%.2f\\n\",&amp;array[i]);\n}\n\n\n/*calculate and store the conversion values in a new array*/\nfor(i=0; i&lt;s; i++)\n{\n    num = array[i];\n    change = (num*100.50);\n    for(j=0; j&lt;1; j++)\n    {\n        printf(\"\\n %.2f your number is %.2f in float percent\\n\", &amp;num, &amp;change);\n    }\n}\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 783, "user_id": 8890692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d73b1bb439acfca597990e5eea101a?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Kerian", "link": "https://stackoverflow.com/users/8890692/matthew-kerian"}, "edited": false, "score": 0, "creation_date": 1519250173, "post_id": 48916133, "comment_id": 84838746, "body": "Do you know if there&#39;s a memory leak? Have you looked at your system&#39;s memory when you run the program?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1519250314, "post_id": 48916133, "comment_id": 84838802, "body": "Nothing in that message says <i>memory leak</i>. It says <b>heap corruption</b>. <b>Corruption</b> is not <b>leak</b>. Something you&#39;re doing before calling free() is making the memory invalid. Use the debugger to figure out what your code is doing wrong."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1519250449, "post_id": 48916133, "comment_id": 84838855, "body": "<code>int *newarr = realloc(arr, (num + 1) * sizeof(int));</code> This looks bad."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1519250709, "post_id": 48916133, "comment_id": 84838977, "body": "Once you do the <code>realloc(arr, ...</code>, the pointer <code>arr</code> is no longer valid, so you can&#39;t free it. The usual way one uses realloc() is to reuse the same pointer, i.e., <code>arr = realloc(arr, ...</code>."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1519251126, "post_id": 48916133, "comment_id": 84839175, "body": "Its also worth mentioning you usually don&#39;t want to be constantly reallocating an array every time you add another element.  It&#39;s typical to grow an array to twice it&#39;s previous size when the number of elements grow beyond the length of the array, thus minimizing the frequency of costly memory operations."}, {"owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1519252759, "post_id": 48916133, "comment_id": 84839887, "body": "Do you have some better way to add an element than this @ChristianGibbons? Would like to hear it!"}, {"owner": {"reputation": 8555, "user_id": 1402846, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/z5AzI.png?s=128&g=1", "display_name": "Pang", "link": "https://stackoverflow.com/users/1402846/pang"}, "edited": false, "score": 0, "creation_date": 1519265287, "post_id": 48916133, "comment_id": 84843385, "body": "Did it say <i>&quot;<b>heat</b> corruption detected&quot;</i> or <i>&quot;<b>heap</b> corruption detected&quot;</i>?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1519326477, "post_id": 48916133, "comment_id": 84877348, "body": "@michael Here&#39;s a link to an existing example on StackOverflow: <a href=\"https://stackoverflow.com/a/3536261/8513665\">stackoverflow.com/a/3536261/8513665</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "is_accepted": true, "score": 3, "last_activity_date": 1519250619, "creation_date": 1519250619, "answer_id": 48916266, "question_id": 48916133, "link": "https://stackoverflow.com/questions/48916133/heap-corruption-detected-memory-leak-in-c/48916266#48916266", "title": "HEAP CORRUPTION DETECTED memory leak in C", "body": "<p>You are double freeing your memory.  Check the documentation for <a href=\"http://en.cppreference.com/w/c/memory/realloc\" rel=\"nofollow noreferrer\">realloc</a>.  Realloc will either 1) expand the passed buffer or 2) will allocate a new buffer, copy the data, and free the original buffer.  When you do:</p>\n\n<pre><code>free(arr);\nfree(c);\n</code></pre>\n\n<p>You are double freeing a value that was either once already freed by realloc or already freed by the first <code>free(arr)</code></p>\n\n<p>Additionally, you should check if <code>realloc</code> fails (returns NULL) and if so, handle the case appropriately.</p>\n"}, {"tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 1, "last_activity_date": 1519250658, "creation_date": 1519250658, "answer_id": 48916272, "question_id": 48916133, "link": "https://stackoverflow.com/questions/48916133/heap-corruption-detected-memory-leak-in-c/48916272#48916272", "title": "HEAP CORRUPTION DETECTED memory leak in C", "body": "<p>First you <code>malloc</code> an array, which you return to your main function as <code>arr</code>.  Then in another function, you <code>realloc</code> where <code>arr</code> is an argument to the realloc, but some other pointer stores the results.  Depending on what happened in realloc, you've either got <code>arr</code> and <code>newarr</code> pointing to the same location, or <code>newarr</code> pointing to a valid location and <code>arr</code> pointing to an invalid location that has been freed.  Either way, freeing both of them at the end is a problem.</p>\n"}, {"tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": false, "score": 1, "last_activity_date": 1519250688, "creation_date": 1519250688, "answer_id": 48916280, "question_id": 48916133, "link": "https://stackoverflow.com/questions/48916133/heap-corruption-detected-memory-leak-in-c/48916280#48916280", "title": "HEAP CORRUPTION DETECTED memory leak in C", "body": "<p>No need to <code>free(arr)</code>, that is taken care of when you <code>realloc()</code> it.  The pointer returned by <code>realloc()</code> will either point to memory which includes the original memory, or free the old memory after copying its content to a new, larger chunk of memory.</p>\n"}], "owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 48916266, "answer_count": 3, "score": 0, "last_activity_date": 1519265213, "creation_date": 1519250064, "last_edit_date": 1519265213, "question_id": 48916133, "link": "https://stackoverflow.com/questions/48916133/heap-corruption-detected-memory-leak-in-c", "title": "HEAP CORRUPTION DETECTED memory leak in C", "body": "<p>I got and error which says</p>\n\n<blockquote>\n  <p>Debug assertation failed and heat corruption detected</p>\n</blockquote>\n\n<p>like everything is working good in my program but I get that error. Where is the memory leak here? I have to free that memory in the main because my functions need to return pointers.</p>\n\n<p>My code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint *dynamic_reader(unsigned int n) {\n\n    /*making new array and checking if allocation succeeded*/\n    int *mem;\n    mem = malloc(n * sizeof(int));\n    if (!mem) {\n        printf(\"Memory allocation failed\\n\");\n        exit(-1);\n    }\n\n    /*letting the user to input the values for the array*/\n    int i = 0;\n    while (i &lt; n) {\n        scanf(\"\\n%d\", &amp;mem[i]);\n        i++;\n    }\n\n    /*printing the array just to make sure everything is good*/\n    for (int j = 0; j &lt; n; j++) {\n        printf(\"%d  \", mem[j]);\n    }\n\n    return mem;\n}\nint *insert_into_array(int *arr, unsigned int num, int newval) {\n\n    /*making new bigger array*/\n    int *newarr = realloc(arr, (num + 1) * sizeof(int));\n\n    /*adding the integer to this new array */\n    newarr[num] = newval;\n    printf(\"\\n\");\n\n    /*printing to make sure everything is correct*/\n    for (int j = 0; j &lt; num + 1; j++) {\n        printf(\"%d  \", newarr[j]);\n    }\n    return newarr;\n}\nint main(void) {\n    /*In dynamic_reader function I need to make an array which size is given as a parameter*/\n    /*In this case I choosed 3*/\n    int *arr = dynamic_reader(3);\n    int num = 3;\n    /*In insert_into_array function I need to add one integer to this array I made in dynamic_reader*/\n    /*The parameters are the array, the number of elements in the array already done and the integer I want to add*/\n    int *c = insert_into_array(arr, num, 9);\n\n    /*I free the memory here because I need to return the pointers of these arrays in the function so it cant be done there*/\n    free(arr);\n    free(c);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "system-calls"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1519248560, "post_id": 48915759, "comment_id": 84837988, "body": "compile with debug and run under gdb. at least you will see where its failing. And try running under valgrind"}, {"owner": {"reputation": 51, "user_id": 6147010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4eebfd4cf5332a37808ce5679a7efd3e?s=128&d=identicon&r=PG&f=1", "display_name": "frost", "link": "https://stackoverflow.com/users/6147010/frost"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1519248672, "post_id": 48915759, "comment_id": 84838041, "body": "I&#39;ve ran gdb a few times, can&#39;t seem to get it to crash.  I&#39;ve ran valgrind and it gives me an error, It tells me that the if on the second for -&gt;  Conditional jump or move depends on uninitialised value(s)  Address 0xfff001000 is not stack&#39;d, malloc&#39;d or (recently) free&#39;d"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1519250043, "post_id": 48915759, "comment_id": 84838693, "body": "Code that &quot;sometimes SegFaults&quot; is like being &quot;1/2 pregnant&quot;, your code is either valid or its not. So anytime &quot;sometimes&quot; comes into play, that means there is something wrong &quot;all the time&quot; that only shows up occasionally."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1519248716, "post_id": 48915813, "comment_id": 84838069, "body": "I think he means <code>half = ARRAY_SIZE &#47; 2;</code>"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519248733, "post_id": 48915813, "comment_id": 84838082, "body": "Good call! I was focusing in the loops but they looked perfect. And they were, except that they were going out of bound because of this."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1519248822, "post_id": 48915813, "comment_id": 84838124, "body": "I figured <code>half</code> was mixed up in this somewhere, but I hadn&#39;t yet figured out how."}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": true, "score": 5, "last_activity_date": 1519249636, "last_edit_date": 1519249636, "creation_date": 1519248658, "answer_id": 48915813, "question_id": 48915759, "link": "https://stackoverflow.com/questions/48915759/intermittent-segmentation-faults-in-main-after-fork/48915813#48915813", "title": "Intermittent segmentation faults in main after fork", "body": "<p>The segmentation fault is caused by n being out of bounds sometimes:</p>\n\n<pre><code>   n = rand() % 10000;\n\n\n    //answer starts here\n    int half = n / 2;\n</code></pre>\n\n<p>Half can be 5000, but numbers is only 1000 elements. </p>\n\n<p>Maybe you meant:</p>\n\n<pre><code> n = rand() % 1000;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 6147010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4eebfd4cf5332a37808ce5679a7efd3e?s=128&d=identicon&r=PG&f=1", "display_name": "frost", "link": "https://stackoverflow.com/users/6147010/frost"}, "edited": false, "score": 0, "creation_date": 1519249338, "post_id": 48915942, "comment_id": 84838379, "body": "Thanks, the person above spotted the bug."}], "tags": [], "owner": {"reputation": 3030, "user_id": 4255272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fd25e6d5a2cdbddbaa85a63970a6746f?s=128&d=identicon&r=PG", "display_name": "tehp", "link": "https://stackoverflow.com/users/4255272/tehp"}, "is_accepted": false, "score": 1, "last_activity_date": 1519249210, "creation_date": 1519249210, "answer_id": 48915942, "question_id": 48915759, "link": "https://stackoverflow.com/questions/48915759/intermittent-segmentation-faults-in-main-after-fork/48915942#48915942", "title": "Intermittent segmentation faults in main after fork", "body": "<p>Here is a fixed version of your code. Initialize half to half of ARRAY_SIZE, instead of n.</p>\n\n<p>As you said in your code: <code>int n; /* the number to find */</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n\n#define ARRAY_SIZE 1000\n\nint main() {\n\n    int numbers[ARRAY_SIZE]; /* array to lookup */\n    int n;                   /* the number to find */\n    time_t t;                /* needed to initialize random number generator (RNG) */\n    int i;\n\n    srand((unsigned)time(&amp;t));\n\n    for (i = 0; i &lt; ARRAY_SIZE; i++) {\n        numbers[i] = rand() % 10000;\n    }\n\n    /* initialize n */\n    n = rand() % 10000;\n\n    int half = ARRAY_SIZE / 2;\n    int count = 0;\n    int pid_status = 0;\n    pid_t pid_f = fork();\n\n    if (pid_f == -1) {\n        return EXIT_FAILURE;\n    } else {\n        if (pid_f == 0) {\n            for (i = half; i &lt; ARRAY_SIZE; ++i) {\n                if (numbers[i] == n) {\n                    count++;\n                }\n            }\n            printf(\"Sons counter:%d\\n\", count);\n            exit(count);\n        } else {\n            for (i = 0; i &lt; half; ++i) {\n                if (numbers[i] == n) {\n                    count++;\n                }\n            }\n            waitpid(pid_f, &amp;pid_status, 0);\n            printf(\"Father counter:%d\\n\", count);\n            if (WIFEXITED(pid_status)) {\n                count += WEXITSTATUS(pid_status);\n            }\n            printf(\"Sum is=%d\\n\", count);\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6147010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4eebfd4cf5332a37808ce5679a7efd3e?s=128&d=identicon&r=PG&f=1", "display_name": "frost", "link": "https://stackoverflow.com/users/6147010/frost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 48915813, "answer_count": 2, "score": 3, "last_activity_date": 1519259841, "creation_date": 1519248395, "last_edit_date": 1519259841, "question_id": 48915759, "link": "https://stackoverflow.com/questions/48915759/intermittent-segmentation-faults-in-main-after-fork", "title": "Intermittent segmentation faults in main after fork", "body": "<p>I'm taking a class on how to learn programming multi process programs on linux on university.\nI'm still very green and trying my best to learn, so any thing you might see that is wrong would be welcome.</p>\n\n<p>I have a problem that asks me to iterate an array, one half on main process,\nthe other half on the child process.\nI wrote code that does that, but the problem is, i've noticed if i run a few times the binary, the main(father) process from times to times segmentations faults.</p>\n\n<p>Please have a look at the code, and tell me what's wrong with it or if i am missing a key aspect of this type of programming.\nMy answer starts after the comment //answer starts here.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n\n#define ARRAY_SIZE 1000\nint main()\n{\n    int numbers[ARRAY_SIZE]; /* array to lookup */\n    int n;                   /* the number to find */\n    time_t t;                /* needed to initialize random number generator (RNG) */\n    int i;\n\n    /* intializes RNG (srand():stdlib.h; time(): time.h) */\n    srand((unsigned)time(&amp;t));\n\n    /* initialize array with random numbers (rand(): stdlib.h) */\n    for (i = 0; i &lt; ARRAY_SIZE; i++)\n        numbers[i] = rand() % 10000;\n\n    /* initialize n */\n    n = rand() % 10000;\n\n\n    //answer starts here\n    int half = n / 2;\n    int count = 0;\n    int pid_status = 0;\n    pid_t pid_f = fork();\n    if (pid_f == -1)\n    {\n        return EXIT_FAILURE;\n    }\n    else\n    {\n        if (pid_f == 0) // child process iterates half end of the array\n        {\n            for (i = half; i &lt; ARRAY_SIZE; ++i)\n            {\n                if (numbers[i] == n)\n                {\n                    count++;\n                }\n            }\n            printf(\"Sons counter:%d\\n\", count);\n            exit(count);\n        } //else it's the father process\n        else\n        {\n            for (i = 0; i &lt; half; ++i)\n            {\n                if (numbers[i] == n)\n                {\n                    count++;\n                }\n            }\n            waitpid(pid_f, &amp;pid_status, 0);\n            printf(\"Father counter:%d\\n\", count);\n            if (WIFEXITED(pid_status))\n            {\n                count += WEXITSTATUS(pid_status);\n            }\n            printf(\"Sum is=%d\\n\", count);\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["android", "c++", "c", "tensorflow-lite", "nnapi"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1519252457, "post_id": 48915426, "comment_id": 84839787, "body": "ANeuralNetworksMemory_createFromFd doesn&#39;t care what format your file is."}, {"owner": {"reputation": 2903, "user_id": 2999490, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b7f26ca67a6c76bc65e02045892c6a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/2999490/alex"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1519261474, "post_id": 48915426, "comment_id": 84842480, "body": "So, how this function fill the tensors parameters?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1519264801, "post_id": 48915426, "comment_id": 84843274, "body": "It doesn&#39;t. It creates a memory object from a file descriptor."}], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 1377619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71fa72a90d102f3a4bf6f73de7ac5e1e?s=128&d=identicon&r=PG", "display_name": "CaveMike", "link": "https://stackoverflow.com/users/1377619/cavemike"}, "is_accepted": false, "score": 1, "last_activity_date": 1523058977, "creation_date": 1523058977, "answer_id": 49702441, "question_id": 48915426, "link": "https://stackoverflow.com/questions/48915426/how-works-aneuralnetworksmemory-createfromfd/49702441#49702441", "title": "How works ANeuralNetworksMemory_createFromFd?", "body": "<p>The loading of the model file and the parsing of it are done separately. This makes it easier to mix-and-match between different memory models and different file formats. It also makes it possible to use these building blocks for other functions, like loading inputs from a file.</p>\n\n<p>ANeuralNetworksMemory_createFromFd() is just used to load the model file into memory.</p>\n\n<p>FlatBufferModel::BuildFromFile() gets an allocation (memory block) that represents the model. This is where ANeuralNetworksMemory_createFromFd() gets called. Then it news up a FlatBufferModel object. This calls tflite::GetModel() which is in the schema subdirectory. The schema subdirectory deserializes the flat-buffer-model from the .tflite model loaded into memory.</p>\n\n<p>When NNAPIDelegate::Invoke() is called, the schema Model object is used to build the model in the Android-NN layer using calls like ANeuralNetworksModel_addOperand().</p>\n"}, {"tags": [], "owner": {"reputation": 103, "user_id": 6847400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a7e4be1b041dbf7ba07763167c920c?s=128&d=identicon&r=PG&f=1", "display_name": "ShreeVidhya", "link": "https://stackoverflow.com/users/6847400/shreevidhya"}, "is_accepted": true, "score": 1, "last_activity_date": 1578480983, "creation_date": 1578480983, "answer_id": 59644316, "question_id": 48915426, "link": "https://stackoverflow.com/questions/48915426/how-works-aneuralnetworksmemory-createfromfd/59644316#59644316", "title": "How works ANeuralNetworksMemory_createFromFd?", "body": "<p>ANeuralNetworksMemory_createFromFd(file_size, PROT_READ, <strong>fd</strong>, 0, &amp;<strong>mem1</strong>) - This API maps the model file in to ANeuralNetworksMemory. </p>\n\n<p>The mapped address is stored in <strong>mem1</strong> (pass by reference!) </p>\n\n<p>Further, trained values that are stored in <strong>mem1</strong> (ANeuralNetworksMemory object) is read by pointing to the appropriate offset value and copied in to the tensors of NeuralNetwork model. </p>\n\n<pre><code> ANeuralNetworksModel_setOperandValueFromMemory(model_, tensor0, mem1, offset, size);\n ANeuralNetworksModel_setOperandValueFromMemory(model_, tensor1, mem1, offset+size, size);\n</code></pre>\n\n<ul>\n<li>tensor0 -  pointing at <strong>offset</strong></li>\n<li>tensor1 -  pointing at <strong>offset+size</strong></li>\n</ul>\n"}], "owner": {"reputation": 2903, "user_id": 2999490, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b7f26ca67a6c76bc65e02045892c6a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/2999490/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 59644316, "answer_count": 2, "score": 0, "last_activity_date": 1578480983, "creation_date": 1519246982, "last_edit_date": 1519307306, "question_id": 48915426, "link": "https://stackoverflow.com/questions/48915426/how-works-aneuralnetworksmemory-createfromfd", "title": "How works ANeuralNetworksMemory_createFromFd?", "body": "<p>In Android Neural Network API docs says: Creates a shared memory object from a file descriptor.</p>\n\n<p>But I can't find any place that specifies how is the format of this file, on TFL source code:</p>\n\n<p>allocation.cc:</p>\n\n<pre><code>MMAPAllocation::MMAPAllocation(const char* filename,\n                               ErrorReporter* error_reporter)\n    : Allocation(error_reporter), mmapped_buffer_(MAP_FAILED) {\n  mmap_fd_ = open(filename, O_RDONLY);\n  if (mmap_fd_ == -1) {\n    error_reporter_-&gt;Report(\"Could not open '%s'.\", filename);\n    return;\n  }\n  struct stat sb;\n  fstat(mmap_fd_, &amp;sb);\n  buffer_size_bytes_ = sb.st_size;\n  mmapped_buffer_ =\n      mmap(nullptr, buffer_size_bytes_, PROT_READ, MAP_SHARED, mmap_fd_, 0);\n  if (mmapped_buffer_ == MAP_FAILED) {\n    error_reporter_-&gt;Report(\"Mmap of '%s' failed.\", filename);\n    return;\n  }\n}\n</code></pre>\n\n<p>nnapi_delegate.cc</p>\n\n<pre><code>NNAPIAllocation::NNAPIAllocation(const char* filename,\n                                 ErrorReporter* error_reporter)\n    : MMAPAllocation(filename, error_reporter) {\n  if (mmapped_buffer_ != MAP_FAILED)\n    CHECK_NN(ANeuralNetworksMemory_createFromFd(buffer_size_bytes_, PROT_READ,\n                                                mmap_fd_, 0, &amp;handle_));\n}\n</code></pre>\n\n<p>It means, TFL opens the file, and give this file to NNAPI. What I need is what is the format of this file that store the tensors, is it a flatbuffers file like TFL format?</p>\n\n<p>Edit:\nThis is a sample from NNAPI doc:</p>\n\n<pre><code>ANeuralNetworksMemory* mem1 = NULL;\nint fd = open(\"training_data\", O_RDONLY);\nANeuralNetworksMemory_createFromFd(file_size, PROT_READ, fd, 0, &amp;mem1);\n</code></pre>\n\n<p>This file <code>training_data</code>, how must its content be structured to NNAPI understand?</p>\n"}, {"tags": ["c", "file-io", "system-paths"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1519247330, "post_id": 48915419, "comment_id": 84837383, "body": "Your code looks correct from a very quick inspection. But you could try using a tool like <a href=\"http://valgrind.org\" rel=\"nofollow noreferrer\">valgrind</a> to check if you used some uninitialized value or made an attempt to mess with memory that doesn&#39;t belong to your program&#39;s heap. BTW, this is a fun homework. Also, why don&#39;t you test everything in the same place. HINT: write a function that given a file does what it has to do instead of embedding/inlining the code in the while loop."}, {"owner": {"reputation": 75, "user_id": 5012418, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8e254ea55274dbc62c956f72452c70e1?s=128&d=identicon&r=PG&f=1", "display_name": "M Dey", "link": "https://stackoverflow.com/users/5012418/m-dey"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519247586, "post_id": 48915419, "comment_id": 84837501, "body": "Iharob, I will look into running this with Valgrind. Not sure what you meant about testing it in another function instead of the while loop. Are you saying just test one file and not the entire directory? Those print statements are required by the assignment description for logging. If you meant what I was suggesting you did, good idea. I will take that into account and test that way as well."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519247735, "post_id": 48915419, "comment_id": 84837573, "body": "No, I mean isolate the code that performs the work on a single file. So that you can make it more readable and understandable and easily spot any bugs, somethin like <code>handle_file(const char *const dirname, const char *const filepath) { if (is_in_other_dir(dirname, filepath) == true) ... }</code>"}, {"owner": {"reputation": 75, "user_id": 5012418, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8e254ea55274dbc62c956f72452c70e1?s=128&d=identicon&r=PG&f=1", "display_name": "M Dey", "link": "https://stackoverflow.com/users/5012418/m-dey"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519247986, "post_id": 48915419, "comment_id": 84837701, "body": "Ah, understood. I will do that. Thanks!"}], "owner": {"reputation": 75, "user_id": 5012418, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8e254ea55274dbc62c956f72452c70e1?s=128&d=identicon&r=PG&f=1", "display_name": "M Dey", "link": "https://stackoverflow.com/users/5012418/m-dey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519473671, "creation_date": 1519246970, "question_id": 48915419, "link": "https://stackoverflow.com/questions/48915419/unable-to-copy-file-from-directory-a-to-directory-b-fopen", "title": "Unable to copy file from Directory A to Directory B fopen()", "body": "<p>I'm currently working on a problem that is a C program to allow me to keep directories in sync. The jist of it is:</p>\n\n<ol>\n<li>If a file is in Directory A and not in Directory B, copy the file to Directory B.</li>\n<li>If the file is in both Directory A and Directory B, copy the newest version of the file to the Directory with the oldest.</li>\n<li>If a file is in Directory B but not Directory A, delete the file. </li>\n</ol>\n\n<p>I was having issues getting the full path of the files I need to open and delete. So I decided to use the C function chdir(path). </p>\n\n<p>I am able to create a new file and remove the files, but for some reason, the data in the file is not copied even after opening two file streams to do so and I'm not sure why. The code is definitely messy, but I can't figure out where I'm going wrong. Insight would be appreciated. I am new to C and dealing with buffers and memory management is something I'm not quite good at just yet. Any ideas?</p>\n\n<pre><code>#include \"csapp.h\"\n#include &lt;stdio.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n\n// prototypes\nbool inOtherDir(char*, char*);\nvoid copyFile(char*, char*, char*, char*);\nint isNewer(char*, char*, char*, char*);\n\nint main(int argc, char **argv ) {\n\n    // variables\n    struct dirent *dirone;\n    struct dirent *dirtwo;\n    char* dirAPath = argv[1]; // this will be used for absolute paths\n    char* dirBPath = argv[2];\n    char cwd[256];\n    char* cwdptr = cwd;\n\n    // get the CWD for use later\n    if(getcwd(cwd, sizeof(cwd)) == NULL) {\n        perror(\"getcwd() error()\");\n        return 1;\n    }\n\n    // Testing\n    // printf(\"CWD is: %s\\n\", cwd);\n\n    if (argc &lt; 3) {\n        printf(\"Not enough arguments provided, please provide two directories.\\n\");\n        return 1;\n    }\n\n    // open directory a\n    DIR *ptrone = opendir(argv[1]);\n    // open directory b\n    DIR *ptrtwo = opendir(argv[2]);\n\n    if (ptrone == NULL || ptrtwo == NULL) {\n        printf(\"Could not open directory\\n\");\n        return 1;\n    }\n\n    printf(\"Checking Sync Status: \\n\");\n    // Open the directory and check to see if the file is a regular file\n    // if it is regular, then do work on it based on if its in the other\n    // directory or not.\n    while ((dirone = readdir(ptrone)) != NULL) {\n        if (dirone-&gt;d_type == DT_REG) {\n            if(inOtherDir(dirone-&gt;d_name, argv[2])) {\n                printf(\"File %s is in both directories.\\n\", dirone-&gt;d_name);\n            } else {\n                printf(\"File %s is in Directory A but not Directory B.\\n\", dirone-&gt;d_name);\n                printf(\"Copying %s in Directory A to Directory B.\\n\",dirone-&gt;d_name);\n                copyFile(dirone-&gt;d_name,dirAPath, dirBPath,cwdptr);\n            }\n        }\n    }\n\n    // check for files only in directory B, then delete them\n    while ((dirtwo = readdir(ptrtwo)) != NULL) {\n        if (dirtwo-&gt;d_type == DT_REG) {\n            if(inOtherDir(dirtwo-&gt;d_name, argv[1])) {\n                printf(\"File %s is in both directories.\\n\", dirtwo-&gt;d_name);\n            } else {\n                printf(\"File %s will be removed from the directory.\\n\",dirtwo-&gt;d_name);\n                chdir(dirBPath);    \n                remove(dirtwo-&gt;d_name);\n                chdir(cwd);\n            }\n        }\n    }\n    closedir(ptrone);\n    closedir(ptrtwo);\n    return 0;\n}\n\n// Look through the directory to see if the same file is in there returns\n// true if the file is in that directory and returns false if not.\nbool inOtherDir(char* filename, char* direct)  {\n\n    struct dirent *buf;\n    DIR *directory = opendir(direct);\n\n    if(directory == NULL) {\n        printf(\"Could not open directory.\");\n        exit(1);\n    }\n\n    while((buf = readdir(directory)) != NULL) {\n        if ((strcmp(filename, buf-&gt;d_name)) == 0) {\n            return true;\n        }\n    }\n    closedir(directory);\n    return false;\n\n}\n\n// Copies the file from one directory to the other\nvoid copyFile(char* filename, char* directory_from,char* directory_to, char* cwd) {\n\n    FILE *file, *copyfile;\n    char c;\n\n    chdir(directory_from);\n    file = fopen(filename,\"r\");\n    if(file == NULL) {\n        printf(\"Cannot open the file %s in copyFile.\\n\", filename);\n    }\n    chdir(cwd);\n    chdir(directory_to);\n    copyfile = fopen(filename, \"w+\");\n    if(copyfile == NULL) {\n        printf(\"Cannot open copy of the file %s in copyFile.\\n\", filename);\n    }\n\n    c = fgetc(file);\n    while(c != EOF){\n        fputc(c, copyfile);\n        c = fgetc(file);\n    }\n\n    printf(\"Contents copied successfully.\\n\");\n\n    fclose(file);\n    fclose(copyfile);\n    chdir(cwd);\n    return;\n\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "loops", "struct", "c-strings"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519247506, "post_id": 48915414, "comment_id": 84837463, "body": "Don&#39;t use global variables when they are not needed. Modify your functions so that you can pass the length of array instead of using a global variable for the length."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 3925475, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a9e87660093c9580376164e12ec2be70?s=128&d=identicon&r=PG&f=1", "display_name": "Hunt3R", "link": "https://stackoverflow.com/users/3925475/hunt3r"}, "edited": false, "score": 0, "creation_date": 1519247784, "post_id": 48915442, "comment_id": 84837603, "body": "Thanks for your analysis, edited all of the things you said yet my code still doesn&#39;t execute the  if(Word_Found==0) statement and the output is still the same. What am I doing wrong there? I"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 97, "user_id": 3925475, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a9e87660093c9580376164e12ec2be70?s=128&d=identicon&r=PG&f=1", "display_name": "Hunt3R", "link": "https://stackoverflow.com/users/3925475/hunt3r"}, "edited": false, "score": 0, "creation_date": 1519247905, "post_id": 48915442, "comment_id": 84837666, "body": "@Hunt3R.: Well that means there is something more that can&#39;t be decided from the code you have shown. Use a debugger if you know how to, a suggestion - write small parts first and don&#39;t use that many global variables. I am curious whether you have added all the modifications mentioned. If you did - it will show you atleast the errors."}, {"owner": {"reputation": 97, "user_id": 3925475, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a9e87660093c9580376164e12ec2be70?s=128&d=identicon&r=PG&f=1", "display_name": "Hunt3R", "link": "https://stackoverflow.com/users/3925475/hunt3r"}, "edited": false, "score": 0, "creation_date": 1519248805, "post_id": 48915442, "comment_id": 84838119, "body": "I checked my code again and when allocating the memory, it allocates enough for all the words, including the duplicates, so I created another variable that only increments if a new word is being added. I used said variable for the printing loop and now it prints the words fine (one extra is added for some reason, a mix of 2 words) but the count is still not printing properly. ALSO, when i run the program for the 2nd time (or more) I get the error &#39;A heap has been corrupted&#39;, am i not freeing the memory properly?"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 97, "user_id": 3925475, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a9e87660093c9580376164e12ec2be70?s=128&d=identicon&r=PG&f=1", "display_name": "Hunt3R", "link": "https://stackoverflow.com/users/3925475/hunt3r"}, "edited": false, "score": 0, "creation_date": 1519268601, "post_id": 48915442, "comment_id": 84844254, "body": "@Hunt3R.: It is some problem with allocation and freeing them. Can you use valgrind? It will help you detect the problem. If you can&#39;t - then ask a question with modified code and the error you got. Also explain what you tried to solve the problem reading the error message. Somebody or me will answer the question."}, {"owner": {"reputation": 97, "user_id": 3925475, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a9e87660093c9580376164e12ec2be70?s=128&d=identicon&r=PG&f=1", "display_name": "Hunt3R", "link": "https://stackoverflow.com/users/3925475/hunt3r"}, "edited": false, "score": 0, "creation_date": 1519291482, "post_id": 48915442, "comment_id": 84853649, "body": "fixed it by changing malloc to : StructPointer = malloc((Size * sizeof(StructPointer)+1));   and the ints weren&#39;t printing properly as i was trying to increment the counter without initializing it. Fixed that by setting the count to 1 when a new word was added."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 3, "last_activity_date": 1519247786, "last_edit_date": 1519247786, "creation_date": 1519247050, "answer_id": 48915442, "question_id": 48915414, "link": "https://stackoverflow.com/questions/48915414/c-struct-array-storing-string-and-its-occurrence-and-writing-it-to-a-file/48915442#48915442", "title": "c Struct Array, Storing string and its occurrence and writing it to a file", "body": "<pre><code>StructPointer =  malloc(Size * sizeof(*StructPointer));\n</code></pre>\n\n<p>This will be the correct allocation. Otherwise you will have erroneous behavior in your code. Also check the return value of <code>malloc</code>.</p>\n\n<pre><code>StructPointer =  malloc(Size * sizeof(*StructPointer));\nif(NULL == StructPointer){\n   perror(\"malloc failure\");\n   exit(EXIT_FAILURE);\n}\n</code></pre>\n\n<p>You are allocating for <code>struct WordElement</code> not a for a pointer to it. You already have a pointer to <code>struct WordElement</code> all that you needed was memory for a <code>struct WordElement</code>.</p>\n\n<p>Also in the loop you are accessing array index out of bound </p>\n\n<pre><code>for(int i=0; i &lt;= Array_Size &amp;&amp; Word_Found!=1; i++)\n               ^^^\n</code></pre>\n\n<p>It will be <code>i &lt; Array_Size</code>.</p>\n\n<p>In case match occurs you want to set the variable <code>Word_found</code> to <code>1</code>.</p>\n\n<pre><code>if(strcmp(StructPointer[i].Word, Word) == 0){\n     /* it macthed */\n}\n</code></pre>\n\n<p>Also <code>Writer = fopen(File_Name, \"w\");</code> you should check the return value of <code>fopen</code>.</p>\n\n<pre><code>  if(Writer == NULL){\n     fprintf(stderr,\"Error in file opening\");\n     exit(EXIT_FAILURE);\n  }\n</code></pre>\n\n<p>Also when you are increasing the <code>Array_index</code> place a check whether it might access the array index out of bound. </p>\n\n<p>The more global variable you use for achieving a small task would make it more difficult to track down a bug. It is always problematic because the places from which data might change is scattered - making it difficult to manage.</p>\n"}], "owner": {"reputation": 97, "user_id": 3925475, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a9e87660093c9580376164e12ec2be70?s=128&d=identicon&r=PG&f=1", "display_name": "Hunt3R", "link": "https://stackoverflow.com/users/3925475/hunt3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 48915442, "answer_count": 1, "score": 0, "last_activity_date": 1519249176, "creation_date": 1519246956, "last_edit_date": 1519249176, "question_id": 48915414, "link": "https://stackoverflow.com/questions/48915414/c-struct-array-storing-string-and-its-occurrence-and-writing-it-to-a-file", "title": "c Struct Array, Storing string and its occurrence and writing it to a file", "body": "<p>so I'm having a little problem with my struct array not doing what its supposed to. I get no compiler warnings or errors when building the program.</p>\n\n<pre><code>int Array_Size=0;;\nint Array_Index=0;\nFILE *Writer;\nstruct WordElement\n{\n    int Count;\n    char Word[50];\n};\n\nstruct WordElement *StructPointer; //just a pointer to a structure\n\nint Create_Array(int Size){\nStructPointer = (struct WordElement *) malloc(Size * sizeof(StructPointer));\nArray_Size = Size;\nreturn 0;\n}\n\nint Add_To_Array(char Word[50]){\n    int Word_Found=0;\n    for(int i=0; i &lt;= Array_Size &amp;&amp; Word_Found!=1; i++)\n    {\n        if(strcmp(StructPointer[i].Word, Word)) // This should only run if the word exists in struct array \n        {\n            StructPointer[i].Count++;\n            Word_Found=1;\n\n        }\n\n    }\n    if(Word_Found==0) // if the above if statement doesnt evualate, this should run \n    {\n        strcpy(StructPointer[Array_Index].Word, Word); //copying the word passed by the main function to the struct array at a specific index\n        printf(\"WORD: %s\\n\", StructPointer[Array_Index].Word); // printing it just to make sure it got copied correctly\n        Array_Index++;\n    }\n\n    return 0;\n}\n\nint Print_All(char File_Name[50])\n{\n    Writer = fopen(File_Name, \"w\");\n    printf(\"Printing starts now: \\n\");\n     for(int i=0; i &lt; Array_Size; i++)\n    {\n        fprintf(Writer, \"%s\\t\\t%d\\n\",StructPointer[i].Word, StructPointer[i].Count);\n\n    } \n    free(StructPointer);\n    return 0;\n}\n</code></pre>\n\n<p>These functions get called from a different file, The Add_To_Array is called when the program reads a new word form the text file. That function is supposed to check if the word already exists in the struct array and if it does, it should just increment the counter. If it doesn't, then it adds it. </p>\n\n<p>The Print_All function is called after all the words have been stored in the struct array. Its supposed to loop through them and print each word and their occurrence. In the text file, there are 2 of every words but my program outputs:</p>\n\n<pre><code>    this        13762753\ndocument        -1772785369\ncontains        1129268256\ntwo     6619253\nof      5701679\nevery       5570645\nword        3342389\ndoccontains     5374021\n</code></pre>\n\n<p>I don't know what to make of this as im really new to C programming... It's probably worth mentioning the if(Word_Foun==0) doesn't execute </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 5, "creation_date": 1519246454, "post_id": 48915253, "comment_id": 84836947, "body": "<code>Year == Month * 12;</code> No. You meant <code>Year = Month * 12;</code>"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1519246713, "post_id": 48915253, "comment_id": 84837073, "body": "<code>for (CurrentLoan = LoanAmount; CurrentLoan == 0; ++CurrentLoan); </code> --&gt;<code>for (CurrentLoan = LoanAmount; CurrentLoan == 0; ++CurrentLoan)</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519246723, "post_id": 48915253, "comment_id": 84837077, "body": "Aside: the received wisdom about money is in <a href=\"https://stackoverflow.com/questions/3730019/why-not-use-double-or-float-to-represent-currency\">Why not use Double or Float to represent currency?</a>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1519246737, "post_id": 48915253, "comment_id": 84837082, "body": "Don&#39;t use <code>float</code> for currency value, use integers instead."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1519246769, "post_id": 48915253, "comment_id": 84837099, "body": "<code>for (CurrentLoan = LoanAmount; CurrentLoan &gt; 0; CurrentLoan -= Monthly) { printf(&quot;%.2f \\n\\r&quot;, CurrentLoan); }</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519246904, "post_id": 48915253, "comment_id": 84837173, "body": "Morever <code>Month = Day * 30;</code> is crude."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1519246925, "post_id": 48915253, "comment_id": 84837184, "body": "Also, at the end of the <code>for</code> loop, you want <code>};</code>. The <code>;</code> is just an empty statement that does nothing."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1519246984, "post_id": 48915253, "comment_id": 84837208, "body": "@DavidSchwartz good spot but <b><i>don&#39;t</i></b> want the <code>;</code>?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1519247050, "post_id": 48915253, "comment_id": 84837242, "body": "Using floats for currency is bad, but ending a loop by testing a float for equality is even worse. &#39;CurrentLoan == 0&#39; might never be true."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8827856, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-PfYYbqYgrow/AAAAAAAAAAI/AAAAAAAAALY/rPriRT1GTz8/photo.jpg?sz=128", "display_name": "Morph", "link": "https://stackoverflow.com/users/8827856/morph"}, "edited": false, "score": 0, "creation_date": 1519248932, "post_id": 48915428, "comment_id": 84838182, "body": "Cheers man - this solved the issue with single line of code but now only outputs 0.00.. but outputs the lines it takes to get down to 0.. I just don&#39;t know what else it could be."}], "tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 1, "last_activity_date": 1519246986, "creation_date": 1519246986, "answer_id": 48915428, "question_id": 48915253, "link": "https://stackoverflow.com/questions/48915253/c-for-loop-not-initializing-any-ideas/48915428#48915428", "title": "C: For Loop not initializing, any ideas", "body": "<p>To answer your specific question as to why it only prints once, it is because your print statement is not in a loop.  </p>\n\n<pre><code>for (CurrentLoan = LoanAmount; CurrentLoan == 0; ++CurrentLoan); // &lt;-- this semicolon is the problem\n</code></pre>\n\n<p>The semicolon there is separating your scoping brackets from the loop, so basically you loop through and do nothing, and then when done with the loop, you do your arithmetic and printing.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 8827856, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-PfYYbqYgrow/AAAAAAAAAAI/AAAAAAAAALY/rPriRT1GTz8/photo.jpg?sz=128", "display_name": "Morph", "link": "https://stackoverflow.com/users/8827856/morph"}, "edited": false, "score": 0, "creation_date": 1519252943, "post_id": 48915811, "comment_id": 84839957, "body": "The &#39;++CurrentLoan&#39; i believed would of counted the amount of loops it took for it to hit &#39;0&#39; - although i am trying to incorporate a months counter (See how many months it takes to pay)  Well i originally required the system to reduce the LoanAmount by whatever the MonthlyPayment is on a Monthly basis (I.e a monthly counter) - so i was a bit unsure on certain parts of my code.   Thank you very much your help is greatly appreciated - i am not confident on Loops so i am taking the feedback to use for future references."}], "tags": [], "owner": {"reputation": 49, "user_id": 5999243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33f6fc842d4d94b94e0bad28230709e9?s=128&d=identicon&r=PG&f=1", "display_name": "Steffen Schumacher", "link": "https://stackoverflow.com/users/5999243/steffen-schumacher"}, "is_accepted": false, "score": 0, "last_activity_date": 1519248657, "creation_date": 1519248657, "answer_id": 48915811, "question_id": 48915253, "link": "https://stackoverflow.com/questions/48915253/c-for-loop-not-initializing-any-ideas/48915811#48915811", "title": "C: For Loop not initializing, any ideas", "body": "<p>Several issues - beyond the year == day..:</p>\n\n<ul>\n<li>The for loop initialises CurrentLoan to eg. 5000, and runs as long as CurrentLoan == 0, which is false in all cases, except when the user typed '0' to the Loan Amount question.</li>\n<li>You're incrementing CurrentLoan with one (++CurrentLoan) in each iteration - why? </li>\n<li>you have ';' before '{' in the for loop - causing the content of '{ .. }' after it to be considered a scope inside a function, rather than the actions of the loop. This means it will only execute once the for-loop has completed, and not with each iteration of the for loop.</li>\n<li>Unless the user types in a negative Monthly value, the loan is increased and not reduced?</li>\n<li>you're returning 0, but your main function is specified as void..</li>\n</ul>\n\n<p>A working example (of the loop - I've not done the APR part, as it doesn't seem that this is your question):</p>\n\n<pre><code>int main(int argc, char** argv) {\n    float LoanAmount;\n    float Monthly; /*Prompts Number to a Float character type*/\n\n    printf(\"Please enter in the Loan Amount : \\n\\r\"); /*prompts user to enter float*/\n    scanf(\"%f\", &amp;LoanAmount);\n\n    printf(\"Please enter in the Monthly payment plan : \\n\\r\");\n    scanf(\"%f\", &amp;Monthly);\n\n    printf(\"\\nPerforming calculation using a loan of Loan Amount: %.2f \\n\\r\", LoanAmount);\n    printf(\"with a monthly payment of : %.0f \\n\\r\", Monthly);\n\n    for (; LoanAmount &gt;= 0; LoanAmount -= Monthly) {\n        printf(\"%.2f \\n\\r\", LoanAmount);\n    }\n    return (0);\n}\n</code></pre>\n\n<p>Changes:</p>\n\n<ul>\n<li>Removed excess variables not needed</li>\n<li>Decrease LoanAmount with Monthly in each iteration</li>\n<li>print (remaining) LoanAmount in each iteration</li>\n<li>for loop stops once at/below zero</li>\n</ul>\n\n<p>Output:</p>\n\n<pre><code>Please enter in the Loan Amount : \n11111\nPlease enter in the Monthly payment plan : \n1949\n\nPerforming calculation using a loan of Loan Amount: 11111.00 \nwith a monthly payment of : 1949 \n11111.00 \n9162.00 \n7213.00 \n5264.00 \n3315.00 \n1366.00 \n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8827856, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-PfYYbqYgrow/AAAAAAAAAAI/AAAAAAAAALY/rPriRT1GTz8/photo.jpg?sz=128", "display_name": "Morph", "link": "https://stackoverflow.com/users/8827856/morph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1519248657, "creation_date": 1519246408, "last_edit_date": 1519246690, "question_id": 48915253, "link": "https://stackoverflow.com/questions/48915253/c-for-loop-not-initializing-any-ideas", "title": "C: For Loop not initializing, any ideas", "body": "<ul>\n<li>Hi, I am trying to create a Loan payback program which allows the user to input the Loan Amount, APR%, Monthly payments and then a 'For Loop' to run the program until the Loan Amount has hit 0 (each Loop will minus the Monthly Payment) and then update the Current Loan.</li>\n<li>The <code>CurrentLoan</code> will start off the same as the <code>LoanAmount</code>, then change by the amount of the monthly payment(s).\nIt only prints out 1 line of the <code>CurrentLoan</code> code and stops, does anyone know why? </li>\n</ul>\n\n<p><sup></sup></p>\n\n<pre><code>void main()\n{\n    float LoanAmount;\n    float APR;\n    float Monthly; /*Prompts Number to a Float characrter type*/\n    float DailyInt;\n    float OutstandingLoan;\n    float CurrentLoan;\n    int i, Day, Month, Year;\n\n    i = 0;\n    Day = 0; /* Day = 1 Day */\n    Month = Day * 30; /* 30 days per month = Month * 30 days*/\n    Year == Month * 12; /* 12 months per yar * 30 days per month */\n\n    printf(\" Please enter in the Loan Amount : \\n\\r\"); /*prompts user to enter float*/\n    scanf(\"%f\", &amp;LoanAmount);\n\n    printf(\"Please enter in the interest rate as a precentage per year (APR) : \\n\\r\");\n    scanf(\"%f\", &amp;APR);\n\n    printf(\"Please enter in the Monthly payment plan : \\n\\r\");\n    scanf(\"%f\", &amp;Monthly);\n\n    printf(\"\\nPerforming calculation using a loan of Loan Amount: %.2f \\n\\r\", LoanAmount);\n    printf(\"with a monthly payment of : %.0f \\n\\r\", Monthly);\n    printf(\"and an APR rate of : %.2f \\n\\r\", APR);\n\n    printf(\"\\n Month \\ | Year \\ | Current Loan \\ | Daily Interest \\| total Interest\\n\\r\");\n\n    for (CurrentLoan = LoanAmount; CurrentLoan == 0; ++CurrentLoan); \n    {\n        CurrentLoan += Monthly;\n        printf(\"%.2f \\n\\r\", CurrentLoan);               \n    };\n    return(0);  \n}\n</code></pre>\n"}, {"tags": ["c", "header", "refactoring", "structure"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1519244461, "post_id": 48914756, "comment_id": 84835894, "body": "You cannot put static functions into a different .c file"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1519244724, "post_id": 48914756, "comment_id": 84836046, "body": "maybe you could put your static functions in a separate file like <code>static_functions.c</code> file, then <code>#include &quot;static_functions.c&quot;</code> in <code>scenario.c</code>,, but I don&#39;t know I&#39;ve never tried anything like that."}, {"owner": {"reputation": 169, "user_id": 4960856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/805862e7b973bcafed2b679209d54cfd?s=128&d=identicon&r=PG&f=1", "display_name": "hafeez", "link": "https://stackoverflow.com/users/4960856/hafeez"}, "edited": false, "score": 1, "creation_date": 1519244751, "post_id": 48914756, "comment_id": 84836059, "body": "If the helper static functions and static constants are meant to be used only in the file &#39;scenerio.c&#39; file, then what is the need to  put them into a different file?"}, {"owner": {"reputation": 45, "user_id": 5973121, "user_type": "registered", "profile_image": "https://graph.facebook.com/1222070204474648/picture?type=large", "display_name": "Arjun Augustine", "link": "https://stackoverflow.com/users/5973121/arjun-augustine"}, "edited": false, "score": 0, "creation_date": 1519245285, "post_id": 48914756, "comment_id": 84836342, "body": "Okay, I was planning on making the functions and constants non static if I move them to a different file.  The main intention of doing this was to reduce clutter as the helper functions grew a lot and made it difficult to just go through the basic static functions. I would like some tips on whether this is a good idea, or a terribly bad one. It makes the code easier to read, but is another layer of abstraction."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1519245867, "post_id": 48914756, "comment_id": 84836628, "body": "Are you confusing &quot;file&quot; with &quot;compilation unit&quot;? You can <code>#include</code> another C file, it is part of the same unit. It need not appear in the makefile."}], "answers": [{"tags": [], "owner": {"reputation": 3030, "user_id": 4255272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fd25e6d5a2cdbddbaa85a63970a6746f?s=128&d=identicon&r=PG", "display_name": "tehp", "link": "https://stackoverflow.com/users/4255272/tehp"}, "is_accepted": false, "score": 0, "last_activity_date": 1519244810, "creation_date": 1519244810, "answer_id": 48914865, "question_id": 48914756, "link": "https://stackoverflow.com/questions/48914756/decluttering-code-hiding-helper-functions-in-a-different-file/48914865#48914865", "title": "Decluttering code - Hiding helper functions in a different file", "body": "<p>As mentioned by Michael in the comments, you can't move the static functions into another file.</p>\n\n<p>Also see: <a href=\"https://stackoverflow.com/questions/35425790/how-to-call-the-static-function-from-another-c-file\">How to call the static function from another c file?</a></p>\n"}], "owner": {"reputation": 45, "user_id": 5973121, "user_type": "registered", "profile_image": "https://graph.facebook.com/1222070204474648/picture?type=large", "display_name": "Arjun Augustine", "link": "https://stackoverflow.com/users/5973121/arjun-augustine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519246409, "creation_date": 1519244347, "last_edit_date": 1519246409, "question_id": 48914756, "link": "https://stackoverflow.com/questions/48914756/decluttering-code-hiding-helper-functions-in-a-different-file", "title": "Decluttering code - Hiding helper functions in a different file", "body": "<p>I have a scenario.c file that defines the some functions like below:</p>\n\n<p>Static Functions:</p>\n\n<p><code>scenario_config()</code>, <code>scenario_start()</code>, <code>scenario_stop()</code>, <code>scenario_close()</code></p>\n\n<p>Structure (only thing) Visible to Parent Src/Header files:</p>\n\n<pre><code>struct scenario_struct = {.config = scenario_config, .start = scenario_start, .stop = scenario_stop, .close = scenario_close}\n</code></pre>\n\n<p>Also, there is a <code>scenario.h</code> header file that declares a ton of <code>#define</code>s and such that is included in the parent header file too.</p>\n\n<p>Now coming to my question: There is a set of static helper functions and static constants and <code>#define</code>s in this <code>scenario.c</code> file that I want to put in a different file, to reduce clutter. I would be making them non-static to do so. But, they are only used in this file, so putting them in <code>scenario.h</code> makes it visible to its parent as well. I thought of a second header, but dont think I can put the static constants in there. What is the best way to do this?</p>\n"}, {"tags": ["c", "arrays", "memory-management"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "edited": false, "score": 0, "creation_date": 1519244610, "post_id": 48914694, "comment_id": 84835974, "body": "This worked thanks, but my function have to return a pointer to that new array mem1 so do I have to free the memory still?"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "edited": false, "score": 0, "creation_date": 1519244669, "post_id": 48914694, "comment_id": 84836014, "body": "@michael.: Will add this to answer..wait."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "edited": false, "score": 0, "creation_date": 1519244831, "post_id": 48914694, "comment_id": 84836100, "body": "@michael.: Edited."}, {"owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "edited": false, "score": 0, "creation_date": 1519244870, "post_id": 48914694, "comment_id": 84836118, "body": "Okay yea that&#39;s what I thought!"}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 3, "last_activity_date": 1519247531, "last_edit_date": 1519247531, "creation_date": 1519244158, "answer_id": 48914694, "question_id": 48914619, "link": "https://stackoverflow.com/questions/48914619/copying-array-to-a-new-one-with-memcpy/48914694#48914694", "title": "copying array to a new one with memcpy", "body": "<p>Instead of allocating the memory and assigning it to <code>char*</code> take a <code>int*</code> and work with it.</p>\n\n<pre><code>int *mem1;\nmem1 = malloc(n1*sizeof(int)); // malloc(n1 * sizeof *mem1);\n..\nmemcpy(mem1,a1,n1*sizeof(a1[0]));\n</code></pre>\n\n<p>Also check whether malloc failed or not - but add a proper error message:-</p>\n\n<pre><code>if (!mem1) {\n   perror(\"Memory allocation failed\\n\");\n   exit(EXIT_FAILURE);\n}\n</code></pre>\n\n<p>Don't forget to free the dynamically allocated memory, in your case </p>\n\n<pre><code>free(mem1);\n</code></pre>\n\n<p>As you have said, that you need to return it from the function then you would do something like this</p>\n\n<pre><code>int *join_arrays(..){\n\n  return mem1;\n}\nint main(void){\n\n  int *p = join_arrays(..);\n  /* work with it */\n\n  free(p);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 641, "user_id": 9148849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/023a4371461ee3649aadee1609399bed?s=128&d=identicon&r=PG&f=1", "display_name": "nabil.douss", "link": "https://stackoverflow.com/users/9148849/nabil-douss"}, "is_accepted": false, "score": 1, "last_activity_date": 1519244568, "creation_date": 1519244568, "answer_id": 48914811, "question_id": 48914619, "link": "https://stackoverflow.com/questions/48914619/copying-array-to-a-new-one-with-memcpy/48914811#48914811", "title": "copying array to a new one with memcpy", "body": "<p><code>mem1</code> here is a char pointer not an int pointer. </p>\n\n<p>Therefore when you try to print <code>mem1[i]</code> it will actually print the byte that is stored at address <code>mem1+i</code> instead of 4 bytes. Apparently the integer <code>1</code> is stored like this on your machine :</p>\n\n<pre><code> 00000001 00000000 00000000 00000000\n</code></pre>\n\n<p>that is why you get 3 zeros. </p>\n\n<p>Try changing your variable type to <code>int*</code> like this : </p>\n\n<pre><code>int *mem1;\nmem1 = malloc(n1*sizeof(int));\nmemcpy(mem1,a1,n1*sizeof(int));\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 48914694, "answer_count": 2, "score": 0, "last_activity_date": 1519260973, "creation_date": 1519243875, "last_edit_date": 1519260973, "question_id": 48914619, "link": "https://stackoverflow.com/questions/48914619/copying-array-to-a-new-one-with-memcpy", "title": "copying array to a new one with memcpy", "body": "<p>I have an issue where i'm using <code>memcpy()</code> to copy an array to a new array with dynamic memory. And my question is why there is 3 zeros between the numbers? like my original array is <code>a1[] ={1, 2, 3, 4, 5}</code> and when I use <code>memcpy(mem1,a1,n1)</code> then my mem1 will be <code>1 0 0 0 2</code> ?\nHere's my code:</p>\n\n<pre><code>int join_arrays(unsigned int n1, int *a1, unsigned int n2, int *a2, unsigned \nint n3, int *a3)\n{\n    /*Here I just print the original a1 just to make sure it's correct*/\n    for (int j = 0; j &lt; 5; j++) {\n        printf(\"%d  \", a1[j]);\n    }\n    /*I allocate the memory for the new array*/\n    char *mem1;\n    mem1 = malloc(n1*sizeof(int));\n\n    /*checking if the allocation succeeded*/\n    if (!mem1) {\n    printf(\"Memory allocation failed\\n\");\n    exit(-1);\n    }\n\n    /*Using memcpy() to copy the original array to the new one*/\n    memcpy(mem1, a1, n1);\n\n    /*Printing the new array and this print gives me \"1 0 0 0 2\"\n      and it should give me \"1 2 3 4 5\"*/\n    printf(\"\\n\");\n    for (int i = 0; i &lt; 5; i++) {\n        printf(\"%d  \", mem1[i]);\n    }\n    return 0;\n}\nint main(void)\n{\n    /* these are the original arrays which I need to put together to a single array */\n    int a1[] = { 1, 2, 3, 4, 5 };\n    int a2[] = { 10, 11, 12, 13, 14, 15, 16, 17 };\n    int a3[] = { 20, 21, 22 };\n\n    /*The number of elements are before the array itself*/\n    join_arrays(5, a1, 8, a2, 3, a3);\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault", "command-line-arguments"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1519243492, "post_id": 48914467, "comment_id": 84835349, "body": "1) what do you expect  <code>sizeof(argv);</code> to be ? 2) what does <code>strncpy()</code> do if <code>(strlen(2nd_argument) &gt;= 3d_argument)</code> ?"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 3, "creation_date": 1519243916, "post_id": 48914467, "comment_id": 84835596, "body": "<code>int main(char *argv[])</code> is not a valid prototype for <code>main</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1519244039, "post_id": 48914467, "comment_id": 84835672, "body": "<code>int main(char *argv[])</code> is probably wrong, you should use <code>int main(int argc, char *argv[])</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1519245837, "post_id": 48914467, "comment_id": 84836612, "body": "See <a href=\"https://stackoverflow.com/questions/204476/\">What should <code>main()</code> return in C and C++</a> for a discussion of the correct signatures for <code>main()</code>. Hint: <code>int main(char *argv[])</code> is not a correct signature for <code>main()</code> on any normal platform \u2014 it should be <code>int main(int argv, char *argv[])</code> or equivalent (I use <code>int main(int argc, char **argv)</code> which is equivalent)."}, {"owner": {"reputation": 7, "user_id": 7601798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/433955b65b15792335f941158e45bb8e?s=128&d=identicon&r=PG&f=1", "display_name": "Kyrie Gu", "link": "https://stackoverflow.com/users/7601798/kyrie-gu"}, "edited": false, "score": 0, "creation_date": 1519269018, "post_id": 48914467, "comment_id": 84844345, "body": "Great. I changed the arguments of main and it works. And also I found the comments about the length problem are also very helpful. Thx you guys!"}], "answers": [{"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 2, "last_activity_date": 1519247267, "last_edit_date": 1519247267, "creation_date": 1519243735, "answer_id": 48914579, "question_id": 48914467, "link": "https://stackoverflow.com/questions/48914467/segmentation-fault-caused-from-terminal-argument/48914579#48914579", "title": "segmentation fault caused from terminal argument", "body": "<p>Your statement:</p>\n\n<pre><code>strncpy(somefile,argv[0],sizeof(argv)); \n</code></pre>\n\n<p>is handing the length of a pointer (i.e likely 4 or 8) to the 3rd argument instead of the actual size of the string.  Change it to: </p>\n\n<pre><code>char somefile[strlen(argv[0])+1]; // note extra space for NULL terminator...\nstrncpy(somefile,argv[0],strlen(argv[0])+1); // ...here as well\n</code></pre>\n\n<p>Note, <code>strncpy(dest, src, n)</code> (for example) copies at most <code>n</code> characters of the character array pointed to by src.  If <code>n</code> is reached before the entire array <code>src</code> was copied, the resulting character array, <code>dest</code> is not null-terminated.  To mitigate this potential, you may consider doing the following:  </p>\n\n<pre><code>char src[] = \"this string is too long\";\nchar dest[10];\nint n = 10;\nstrncpy (dest, src, n);\n</code></pre>\n\n<p>results in <code>dest</code> containing: </p>\n\n<pre><code>|t|h|i|s| |s|t|r|i|n|?|?|?|...// may, or may not have a null terminator somewhere.  \n\ndest[n-1] = 0;\n</code></pre>\n\n<p>results in <code>dest</code> containing: </p>\n\n<pre><code>|t|h|i|s| |s|t|r|i|\\0|?|?|?|...// guaranteed NULL termination.\n</code></pre>\n\n<p>And since <code>somefile</code> was created so specifically based on <code>argv[0]</code>  </p>\n\n<pre><code>strcpy(somefile,argv[0]);   \n</code></pre>\n\n<p>would do just as well in this situation.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519246518, "post_id": 48914599, "comment_id": 84836972, "body": "&quot;strncpy should be using the length of the string,&quot;  --&gt; I would not use the length of the string as that guarantees the target is not a string.  Better to code base on the  size of the target array."}], "tags": [], "owner": {"reputation": 783, "user_id": 8890692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d73b1bb439acfca597990e5eea101a?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Kerian", "link": "https://stackoverflow.com/users/8890692/matthew-kerian"}, "is_accepted": false, "score": 2, "last_activity_date": 1519244350, "last_edit_date": 1519244350, "creation_date": 1519243808, "answer_id": 48914599, "question_id": 48914467, "link": "https://stackoverflow.com/questions/48914467/segmentation-fault-caused-from-terminal-argument/48914599#48914599", "title": "segmentation fault caused from terminal argument", "body": "<p>To get the length of argv you can just do <code>strlen(argv[0])</code> instead.</p>\n\n<p>Everything is kinda compounding off of that major issue. <code>strncpy</code> should be using the length of the string, other than that it seems like it should work.</p>\n"}], "owner": {"reputation": 7, "user_id": 7601798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/433955b65b15792335f941158e45bb8e?s=128&d=identicon&r=PG&f=1", "display_name": "Kyrie Gu", "link": "https://stackoverflow.com/users/7601798/kyrie-gu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1519257205, "creation_date": 1519243301, "last_edit_date": 1519257205, "question_id": 48914467, "link": "https://stackoverflow.com/questions/48914467/segmentation-fault-caused-from-terminal-argument", "title": "segmentation fault caused from terminal argument", "body": "<p>I try to get strings which may be a filename from terminal argument. I wonder why it would come to segmentation fault.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(char *argv[]){\n\n    char somefile[sizeof(argv)];\n    strncpy(somefile,argv[0],sizeof(argv));\n\n    printf(\"The file name is: %s\", somefile);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1519243297, "post_id": 48914413, "comment_id": 84835229, "body": "You don&#39;t need an array (unless you want to print the results later). As with the usual Fibonacci sequence, you need three variables which you shuffle in each loop. The only difference is the two starting values."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519243347, "post_id": 48914413, "comment_id": 84835257, "body": "Not even a warning?"}, {"owner": {"reputation": 29, "user_id": 9383416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd7502cb89430faa7c041e1d321f547f?s=128&d=identicon&r=PG&f=1", "display_name": "zohan6934", "link": "https://stackoverflow.com/users/9383416/zohan6934"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519243465, "post_id": 48914413, "comment_id": 84835335, "body": "@WeatherVane Nothing, compiles with no issues, and when I run it it goes as far as I have it written with no issues.  Also, the results do need to be printed on the screen for the user to see, I figured I&#39;d need an array for that but I&#39;m not entirely sure how it&#39;d be implimented"}, {"owner": {"reputation": 783, "user_id": 8890692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d73b1bb439acfca597990e5eea101a?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Kerian", "link": "https://stackoverflow.com/users/8890692/matthew-kerian"}, "edited": false, "score": 1, "creation_date": 1519243509, "post_id": 48914413, "comment_id": 84835359, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17229707/how-to-generate-fibonacci-series-in-c\">How to generate Fibonacci series in C</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1519243556, "post_id": 48914413, "comment_id": 84835386, "body": "MSVC gives 2 warnings about <code>scanf (&quot;%i&quot;, &amp;num1, &amp;num2);</code> \u2014 <i>warning C4474: &#39;scanf&#39; : too many arguments passed for format string</i>, and <i>note: placeholders and their parameters expect 1 variadic arguments</i>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1519243700, "post_id": 48914413, "comment_id": 84835468, "body": "Aside: it is unclear whether the limit asked for is the number of terms, or the value reached. The question is more about entering values, than generation the Fibonacci sequence, which you don&#39;t show."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 1, "creation_date": 1519244366, "post_id": 48914413, "comment_id": 84835834, "body": "@coderredoc: it&#39;s not undefined; the extra argument is evaluated but otherwise ignored (7.21.6.2/2)."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1519244440, "post_id": 48914413, "comment_id": 84835869, "body": "@JohnBode.: <i>If the format is exhausted while arguments remain, the excess arguments are evaluated (as always) but are otherwise ignored.</i>. How can I miss?"}, {"owner": {"reputation": 29, "user_id": 9383416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd7502cb89430faa7c041e1d321f547f?s=128&d=identicon&r=PG&f=1", "display_name": "zohan6934", "link": "https://stackoverflow.com/users/9383416/zohan6934"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519244455, "post_id": 48914413, "comment_id": 84835885, "body": "@WeatherVane changed that to be more clear to the user, thanks"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 1, "creation_date": 1519244497, "post_id": 48914413, "comment_id": 84835909, "body": "@zohan6934.: Hey check <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.2p2\" rel=\"nofollow noreferrer\"><b>this</b></a> standard ref. I was missing it somehow. It is not undefined behavior. <i>If the format is exhausted while arguments remain, the excess arguments are evaluated (as always) but are otherwise ignored.</i>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1519244624, "post_id": 48914413, "comment_id": 84835986, "body": "@zohan6934 that makes the fixed array of 10 elements awkward, I earlier suggested that no array is needed unless the sequence needs to be stored."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 1, "creation_date": 1519244749, "post_id": 48914413, "comment_id": 84836056, "body": "@user3386109.: Did you see that part <code>scanf (&quot;%i&quot;, &amp;num1, &amp;num2);</code>?"}, {"owner": {"reputation": 29, "user_id": 9383416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd7502cb89430faa7c041e1d321f547f?s=128&d=identicon&r=PG&f=1", "display_name": "zohan6934", "link": "https://stackoverflow.com/users/9383416/zohan6934"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519244851, "post_id": 48914413, "comment_id": 84836108, "body": "@WeatherVane ok so removing the array is an option, how could I go about having the values calculated then?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 2, "creation_date": 1519244886, "post_id": 48914413, "comment_id": 84836123, "body": "@coderredoc My bad, I&#39;ve already deleted the comment. There still is undefined behavior, because <code>num2</code> is never initialized."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1519244938, "post_id": 48914413, "comment_id": 84836150, "body": "@user3386109.: It may lead to UB."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1519244995, "post_id": 48914413, "comment_id": 84836181, "body": "It does lead to UB because the <code>if</code> statement uses the uninitialized <code>num2</code>."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1519245102, "post_id": 48914413, "comment_id": 84836244, "body": "@user3386109.: The value is indeterminate but it will be UB if the value happens to be a trap representation for the type."}, {"owner": {"reputation": 29, "user_id": 9383416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd7502cb89430faa7c041e1d321f547f?s=128&d=identicon&r=PG&f=1", "display_name": "zohan6934", "link": "https://stackoverflow.com/users/9383416/zohan6934"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1519245132, "post_id": 48914413, "comment_id": 84836259, "body": "@user3386109 how is &#39;num2&#39; not initaialized? on line 18 &#39;if (num1&gt;num2||num1&lt;0) num2&#39; is used"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519245176, "post_id": 48914413, "comment_id": 84836283, "body": "I suggest you implement the standard Fibonacci first, in two ways. First for a fixed number of terms, second for a fixed value of the term. When you have played around with that, move on to entering those limits."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1519245388, "post_id": 48914413, "comment_id": 84836391, "body": "@user3386109.: If the lvalue designates an object of automatic storage duration <b><i>that could have been declared with the register storage class</i></b>  (never had its address taken), and that object is uninitialized (not declared with an initializer and no assignment to it has been performed prior to use), the behavior is undefined."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1519245514, "post_id": 48914413, "comment_id": 84836459, "body": "@coderredoc Yup, that is an odd quirk in the standard."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1519245571, "post_id": 48914413, "comment_id": 84836481, "body": "@user3386109.: Suppose this <code>unsigned char x;</code> and <code>unsigned char y</code>; <code>y=x</code> This is not UB. No trap rep for <code>unsigned char</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1519245931, "post_id": 48914413, "comment_id": 84836671, "body": "@coderredoc Interesting, what section of the specification says that <code>unsigned char</code> can&#39;t have a trap representation?"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1519246339, "post_id": 48914413, "comment_id": 84836894, "body": "@user3386109.: Check <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.6.2p1\" rel=\"nofollow noreferrer\">this</a>. The <a href=\"http://port70.net/~nsz/c/c11/n1570.html#note53\" rel=\"nofollow noreferrer\">footnote</a> of it is more explicit."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1519246773, "post_id": 48914413, "comment_id": 84837104, "body": "@coderredoc Ok, thanks. All of this seems to imply that an unsigned character variable can never be a register variable. That&#39;s a rather odd restriction."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1519247536, "post_id": 48914413, "comment_id": 84837476, "body": "@zohan6934 Not initialized means that you never assigned a value to <code>num2</code>. You declared <code>num2</code> with <code>int num1, num2</code>, but that doesn&#39;t give it a value. You passed the address of <code>num2</code> to <code>scanf</code>, but <code>scanf</code> won&#39;t assign a value to <code>num2</code> because the format string doesn&#39;t have a conversion for <code>num2</code>. So when you use <code>num2</code> in the <code>if</code> statement, it doesn&#39;t have an assigned value."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519248387, "post_id": 48914413, "comment_id": 84837896, "body": "are those &quot;2 numbers&quot; expected to be valid entries in the fibonacci sequence or are they to be the upper and lower limits so only a selected portion of the sequence is output?  Please clarify"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519248783, "post_id": 48914413, "comment_id": 84838105, "body": "when compiling, always enable the warnings.  (for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnu11</code> )  (note the parameters are different for <code>visual studio</code>, etc"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519248996, "post_id": 48914413, "comment_id": 84838214, "body": "when calling any of the <code>scanf()</code> family of functions, always check the returned value (not the parameter values) to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519249598, "post_id": 48914413, "comment_id": 84838492, "body": "when the code wants the user to enter/reenter some value, Strongly suggest implementing a loop that exits when the user has entered a valid value. I.E. replace: ` printf(&quot;... for brevity&quot;); scanf (&quot;%i&quot;, &amp;limit); if (limit &gt; 10) { printf(&quot;... for brevity&quot;); }` with something similar to: `do { printf(&quot;... dots for brevity&quot;); if( 1 != scanf (&quot;%i&quot;, &amp;limit) ) { fprintf( stderr, &quot;scanf for limit failed\\n&quot;; exit( EXIT_FAILURE ); } } while( 0&lt;limit &amp;&amp; limit&lt;=10 );"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519249749, "post_id": 48914413, "comment_id": 84838569, "body": "if would be better if the variables: <code>limit</code>, <code>num1</code> and <code>num2</code> were declared as <code>size_t</code> rather than <code>int</code>,  Then the call(s) to <code>scanf()</code> would use input/format specifier(s) of <code>%lu</code> rather than <code>%i</code>"}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1519250191, "creation_date": 1519250191, "answer_id": 48916169, "question_id": 48914413, "link": "https://stackoverflow.com/questions/48914413/creating-fibonacci-sequence-in-c/48916169#48916169", "title": "Creating Fibonacci sequence in C", "body": "<p>regarding: </p>\n\n<pre><code>scanf (\"%i\", &amp;num1, &amp;num2); \n</code></pre>\n\n<p>This will cause the compiler to output a warning message AND the variable num2 will never be set. Suggest: </p>\n\n<pre><code>size_t num1;\nsize_t num2;\n\n....\n\nif( 2 != scanf( \"%lu %lu\", &amp;num1, &amp;num2 ) ) \n{ \n    fprintf( stderr, \"scanf for num1, num2 failed\\n\" );\n    exit( EXIT_FAILURE ); \n} \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1519252121, "creation_date": 1519252121, "answer_id": 48916611, "question_id": 48914413, "link": "https://stackoverflow.com/questions/48914413/creating-fibonacci-sequence-in-c/48916611#48916611", "title": "Creating Fibonacci sequence in C", "body": "<p>To print the sequence, implement the following steps:</p>\n\n<ul>\n<li>output <code>a</code>, the first number in the pair with <code>printf</code></li>\n<li>compute the next number <code>c</code> as the sum of <code>a</code> and <code>b</code></li>\n<li>update the pair: <code>a = b</code>, <code>b = c</code>.</li>\n<li>iterate <code>limit</code> times.</li>\n</ul>\n\n<p>Regarding your code, here is an improved version with stricter input checking:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    int num1, num2, num3, limit;\n\n    //Ask the user for a limit to the number of values displayed, checks to see if value is greater\n    // than 10 or less than 0, if so displays an error message  \n    printf(\"Please enter limit of values generated, the limit must be 10 or less, but greater than 0:\\n\");\n    if (scanf(\"%i\", &amp;limit) != 1 || limit &lt;= 0 || limit &gt; 10) {\n        printf(\"Please enter a valid integer greater than 0, and less than or equal to 10\\n\");\n        return 1;\n    }\n    printf(\"Please enter 2 numbers separated by a space, the second number must be larger than the first:\\n\");\n    if (scanf(\"%i%i\", &amp;num1, &amp;num2) != 2 || num1 &gt; num2) {\n        puts(\"Please re enter your numbers, make sure they are in ascending order\\n\");\n        return 2; \n    }\n    // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9383416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd7502cb89430faa7c041e1d321f547f?s=128&d=identicon&r=PG&f=1", "display_name": "zohan6934", "link": "https://stackoverflow.com/users/9383416/zohan6934"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1519252121, "creation_date": 1519243065, "last_edit_date": 1519245107, "question_id": 48914413, "link": "https://stackoverflow.com/questions/48914413/creating-fibonacci-sequence-in-c", "title": "Creating Fibonacci sequence in C", "body": "<p>I'm in the process of creating a Fibonacci sequence generator in C for a school lab, but it can't be the regular way of 0 1 1 2 3 5 etc... the program is supposed to ask the user for a limit, and 2 numbers and generate the sequence from there.</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main(void) \n{\n    int num1, num2, num3, limit;\n    int Fibarray[10];\n    //Ask the user for a limit to the number of values displayed, checks to see if value is greater\n    // than 10 or less than 0, if so displays an error message  \n    printf(\"Please enter limit of values generated, the limit must be 10 or less, but greater than 0\\n\");\n    scanf (\"%i\", &amp;limit);\n    if (limit &gt; 10)\n    {\n        printf(\"Please enter a valid integer greater than 0, and less than or equal to 10\");\n    }\n    else    \n        printf(\"Please enter 2 numbers separated by a space, the second number must be larger than the first\"); \n    scanf (\"%i\", &amp;num1, &amp;num2);\n    if (num1&gt;num2||num1&lt;0)\n    {\n        puts(\"Please re enter your numbers, make sure they are in ascending order &amp; the second number is greater than 0\");\n        return(15); \n    }\n    else\n    {\n        // ...\n    }\n}\n</code></pre>\n\n<p>What I'm trying to figure out is, how would I have the two values added together, stored in the array, and added again etc. to the limit.</p>\n\n<p>I believe this problem is different from <a href=\"https://stackoverflow.com/questions/17229707/how-to-generate-fibonacci-series-in-c\">How to generate Fibonacci series in C</a> because in this program I need to have it accept values from the user, not preset values.</p>\n\n<p>I've been looking through my book on this but it's not very helpful.</p>\n"}, {"tags": ["c", "string", "pointers"], "comments": [{"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 1, "creation_date": 1519241793, "post_id": 48914070, "comment_id": 84834394, "body": "Post your code."}, {"owner": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 0, "creation_date": 1519241824, "post_id": 48914070, "comment_id": 84834406, "body": "Without code, we are as clueless as you are. You need to post an MCVE. If you don&#39;t know what an MCVE is, go search."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1519241824, "post_id": 48914070, "comment_id": 84834407, "body": "Please post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem. Show the input, the expected output, and the actual output as text <i>in the question</i>."}, {"owner": {"reputation": 11, "user_id": 9039003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52f3a9ce4f7fa2879049241c122494fd?s=128&d=identicon&r=PG&f=1", "display_name": "peter1997546", "link": "https://stackoverflow.com/users/9039003/peter1997546"}, "edited": false, "score": 0, "creation_date": 1519242673, "post_id": 48914070, "comment_id": 84834886, "body": "Sorry guys i just posted my code"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1519242867, "post_id": 48914070, "comment_id": 84834990, "body": "<code>path[size]=cwd;</code>... maybe you mean <code>strcpy(path, cwd);</code> ?  But then, after all that, you are simply changing directory to the parameter <code>input</code>, without ever having any of your work that occurs previously in the function do anything."}, {"owner": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 0, "creation_date": 1519243210, "post_id": 48914070, "comment_id": 84835174, "body": "I can&#39;t paste it into a file, compile and run it. That ain&#39;t no MCVE!"}, {"owner": {"reputation": 11, "user_id": 9039003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52f3a9ce4f7fa2879049241c122494fd?s=128&d=identicon&r=PG&f=1", "display_name": "peter1997546", "link": "https://stackoverflow.com/users/9039003/peter1997546"}, "edited": false, "score": 0, "creation_date": 1519243358, "post_id": 48914070, "comment_id": 84835264, "body": "i forgot to use strcpy here"}, {"owner": {"reputation": 11, "user_id": 9039003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52f3a9ce4f7fa2879049241c122494fd?s=128&d=identicon&r=PG&f=1", "display_name": "peter1997546", "link": "https://stackoverflow.com/users/9039003/peter1997546"}, "edited": false, "score": 0, "creation_date": 1519243415, "post_id": 48914070, "comment_id": 84835291, "body": "Nevermind guys. Sorry for asking my question in a bad way"}], "answers": [{"comments": [{"owner": {"reputation": 244, "user_id": 9177735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90311d812036b4debfcf7aa866dec22?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9177735/ben"}, "edited": false, "score": 1, "creation_date": 1519245674, "post_id": 48914499, "comment_id": 84836532, "body": "path is an array of pointers to char arrays, but you are suggesting that he strcpy to some point in it..."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 244, "user_id": 9177735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90311d812036b4debfcf7aa866dec22?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9177735/ben"}, "edited": false, "score": 0, "creation_date": 1519246384, "post_id": 48914499, "comment_id": 84836921, "body": "@Ben - Nice catch!  I did not see that, and have edited my post.  Thanks."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 0, "last_activity_date": 1519246353, "last_edit_date": 1519246353, "creation_date": 1519243433, "answer_id": 48914499, "question_id": 48914070, "link": "https://stackoverflow.com/questions/48914070/about-c-pointer/48914499#48914499", "title": "About C pointer", "body": "<p>A fundamental understanding of how strings are manipulated would be useful to you at this point.  You can find one <em><a href=\"http://www.learn-c.org/en/Strings\" rel=\"nofollow noreferrer\">here</a></em> or <em><a href=\"https://www.programiz.com/c-programming/c-strings\" rel=\"nofollow noreferrer\">here</a></em> and many more <em><a href=\"https://www.google.com/search?ei=DtONWrn7BsygwASq16yAAw&amp;q=strncpy&amp;oq=strncpy&amp;gs_l=psy-ab.3..0i131k1j0i20i263i264k1j0l8.1950.3914.0.4490.7.7.0.0.0.0.330.969.3-3.3.0....0...1.1.64.psy-ab..4.3.968...0i131i67k1j0i131i20i263i264k1j0i10k1.0.4aj6_XMjPMI\" rel=\"nofollow noreferrer\">here</a></em>.  </p>\n\n<p>The point being, although it is not clear what you are attempting to do, string functions should be used rather than assignment operators in this section:</p>\n\n<pre><code>int size=0;\n//char* path[255];// pointer to char array is not needed\nchar path[PATH_MAX];// char array is sufficient for this purpose.\n...\n    char cwd[PATH_MAX];\n    if(getcwd(cwd,PATH_MAX+1))// use results only if getcwd was successful.\n    {\n        //path[size]=cwd;// does not work\n        strcpy( path, cwd );// this should work\n    }\n    else\n    {\n        // handle error\n...\n</code></pre>\n\n<p>Also, as noted, you should become familiar with the prototype of the function you are using, and if it does not return <code>void</code>, it is usually a good idea to use the value it returns to determine if the results are usable.  If not, handle the error condition, and/or bypass using its results altogether.</p>\n"}, {"tags": [], "owner": {"reputation": 244, "user_id": 9177735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90311d812036b4debfcf7aa866dec22?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9177735/ben"}, "is_accepted": false, "score": 0, "last_activity_date": 1519303588, "last_edit_date": 1519303588, "creation_date": 1519244848, "answer_id": 48914879, "question_id": 48914070, "link": "https://stackoverflow.com/questions/48914070/about-c-pointer/48914879#48914879", "title": "About C pointer", "body": "<p>It seems you are trying to save off the string, but it will be lost when you are out of scope.</p>\n\n<pre><code>int size=0;\nchar* path[255];\n\nvoid push(char *input)\n{\n    char* cwd = malloc(PATH_MAX * sizeof(char)); // Need a free when popping\n    getcwd(cwd,PATH_MAX+1);\n    //Save the pointer to the string in an array\n    path[size]=cwd; //This doesn't do bounds checking\n    size++;\n    chdir(input);\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9039003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52f3a9ce4f7fa2879049241c122494fd?s=128&d=identicon&r=PG&f=1", "display_name": "peter1997546", "link": "https://stackoverflow.com/users/9039003/peter1997546"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1519303588, "creation_date": 1519241700, "last_edit_date": 1519242511, "question_id": 48914070, "link": "https://stackoverflow.com/questions/48914070/about-c-pointer", "title": "About C pointer", "body": "<p>I am trying to code something like a stack and develop a function.\nIt should print out all the elements in the stack in the end.\nBut all the printed elements are the same, even though the input should be different.\nBasically, I used getcwd to store it to a char array.\nAnd then I updated my element by using  element=the char array.</p>\n\n<p>But all the elements are always same as my current path, even if i didn't invoke this function, i just check the s.path using printf.\nI also check the address of the elements and found out they always point the same address.</p>\n\n<pre><code>int size=0;\nchar* path[255];\n\nvoid push(char *input)\n{\n    char cwd[PATH_MAX];\n    getcwd(cwd,PATH_MAX+1);\n    path[size]=cwd;\n    size++;\n    chdir(input);\n}\n</code></pre>\n"}, {"tags": ["c", "extern"], "comments": [{"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 3, "creation_date": 1519241604, "post_id": 48913966, "comment_id": 84834281, "body": "Two things:  1) Think of headers of just being literally pasted into your C files before compiling, because that&#39;s exactly what happens  2) think of <code>extern &lt;var decl&gt;</code>  as being analogous to a forward decl of a function - you declare it but do not define it."}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 2, "creation_date": 1519241717, "post_id": 48913966, "comment_id": 84834349, "body": "To literally answer your question, the only difference is that by /convention/ (hey, you can #include any file whatsoever) headers are written so as to be OK to include in multiple <code>.c</code> without causing problems.   So if you&#39;re going to need the extern var decl in lots of places, prefer to put it in a header."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1519241799, "post_id": 48913966, "comment_id": 84834400, "body": "The difference is that if you don&#39;t <code>extern</code> the variable in <code>h</code> file, each <code>c</code> file requiring it will need to do it by itself. It is error-prone (wrong type?) and tedious. Moreover, the writers of these files should <i>know</i> they should <code>extern</code> it. If you do it in your <code>h</code> file, the only thing to be done to the user is to include it."}], "owner": {"reputation": 85, "user_id": 9311078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QwoWr.png?s=128&g=1", "display_name": "J. Arrillaga", "link": "https://stackoverflow.com/users/9311078/j-arrillaga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1519241281, "creation_date": 1519241281, "question_id": 48913966, "link": "https://stackoverflow.com/questions/48913966/declaring-extern-var-in-h-file-vs-only-defining-it-in-c-file", "title": "Declaring extern var in H file vs *only* defining it in C file", "body": "<p>So I've been messing around with the <code>extern</code> keyword a bit to get a better sense of what it does.</p>\n\n<p>I have for example the following files:</p>\n\n<p>one.h</p>\n\n<pre><code>#ifndef ONE_H\n#define ONE_H\n\nextern unsigned global_var;\n\n#endif\n</code></pre>\n\n<p>one.c</p>\n\n<pre><code>#include \"one.h\"\n\nunsigned global_var = 10;\n</code></pre>\n\n<p>two.h</p>\n\n<pre><code>#ifndef TWO_H\n#define TWO_H\n\nvoid print();\n\n#endif\n</code></pre>\n\n<p>two.c</p>\n\n<pre><code>#include \"one.h\"\n#include \"two.h\"\n#include &lt;stdio.h&gt;\n\nvoid print() {\n  frprintf(stdout, \"%u\\n\", global_var);\n}\n</code></pre>\n\n<p>main.c</p>\n\n<pre><code>#include \"two.h\"\n\nint main() {\n  print();\n  return 0;\n}\n</code></pre>\n\n<p>This compiles fine and outputs: 10. As expected.</p>\n\n<p>Now, if I change</p>\n\n<p>one.h</p>\n\n<pre><code>#ifndef ONE_H\n#define ONE_H\n\n// extern unsigned global_var;\n\n#endif\n</code></pre>\n\n<p>to be essentially empty, and</p>\n\n<p>two.c</p>\n\n<pre><code>#include \"one.h\"\n#include \"two.h\"\n#include &lt;stdio.h&gt;\n\nvoid print() {\n  extern unsigned global_var;\n  frprintf(stdout, \"%u\\n\", global_var);\n}\n</code></pre>\n\n<p>the behavior is exactly the same. That is, my program still compiles without warnings and outputs: 10.</p>\n\n<p>So, my question is: what exactly is the difference in doing setting up a global variable one way or the other? Is one way correct and the other not?</p>\n\n<p>Thanks,</p>\n\n<p>PS. This was compiled using <code>gcc -Wall</code>, in case that's relevant.</p>\n"}, {"tags": ["c", "c-strings"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1519241163, "post_id": 48913898, "comment_id": 84834058, "body": "Check out the <a href=\"https://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm\" rel=\"nofollow noreferrer\">KMP string matching algorithm</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7937595, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Rr8NKSNdFO0/AAAAAAAAAAI/AAAAAAAAAzk/6LTbkwb41Xg/photo.jpg?sz=128", "display_name": "Emin", "link": "https://stackoverflow.com/users/7937595/emin"}, "edited": false, "score": 0, "creation_date": 1519242363, "post_id": 48914014, "comment_id": 84834705, "body": "Thank you very much. It works but I need to look at it to understand how it does. Also, I&#39;ve seen many people suggesting to use fgets instead of gets but for some reason it doesn&#39;t work on my code when I just replace them. Since I&#39;m a newbie on coding, I didn&#39;t want to push my chance. Thank you once again."}, {"owner": {"reputation": 3, "user_id": 7937595, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Rr8NKSNdFO0/AAAAAAAAAAI/AAAAAAAAAzk/6LTbkwb41Xg/photo.jpg?sz=128", "display_name": "Emin", "link": "https://stackoverflow.com/users/7937595/emin"}, "edited": false, "score": 0, "creation_date": 1519242843, "post_id": 48914014, "comment_id": 84834983, "body": "So basically while works until ptr==NULL, right? I added a printf inside &quot;do while&quot; to see how it works and I think I get it. Thank you very much."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 3, "user_id": 7937595, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Rr8NKSNdFO0/AAAAAAAAAAI/AAAAAAAAAzk/6LTbkwb41Xg/photo.jpg?sz=128", "display_name": "Emin", "link": "https://stackoverflow.com/users/7937595/emin"}, "edited": false, "score": 0, "creation_date": 1519242907, "post_id": 48914014, "comment_id": 84835006, "body": "@Emin Glad I could help.  Feel free to <a href=\"https://stackoverflow.com/help/accepted-answer\">accept this answer</a> if you found it useful."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 0, "last_activity_date": 1519241480, "creation_date": 1519241480, "answer_id": 48914014, "question_id": 48913898, "link": "https://stackoverflow.com/questions/48913898/searching-a-substring-in-a-string-and-its-position/48914014#48914014", "title": "Searching a substring in a string and its position", "body": "<p>Once you find an instance of the substring and print its location, increment <code>ptr</code> so it points to the next character, then call <code>strstr</code> again with <code>ptr</code> as the string to search.  Loop until it returns NULL:</p>\n\n<pre><code>ptr=strstr(sntnc,word);\nif (strstr(sntnc, word)==NULL) {\n   printf(\"\\nThe string doesn't contains the substring.\");\n} else {\n    do {\n       printf(\"\\nPositin of the substring in the string: %d.\", ptr - sntnc + 1);\n       ptr=strstr(ptr+1,word);\n    while (ptr);\n}\n</code></pre>\n\n<p>Also, the <code>gets</code> function is unsafe.  Since it performs no bounds checking on the input, it potentially allows writing past the end of the destination buffer which invokes undefined behavior.  Use <code>fgets</code> instead.</p>\n"}], "owner": {"reputation": 3, "user_id": 7937595, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Rr8NKSNdFO0/AAAAAAAAAAI/AAAAAAAAAzk/6LTbkwb41Xg/photo.jpg?sz=128", "display_name": "Emin", "link": "https://stackoverflow.com/users/7937595/emin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 48914014, "answer_count": 1, "score": 0, "last_activity_date": 1519242385, "creation_date": 1519241080, "last_edit_date": 1519242385, "question_id": 48913898, "link": "https://stackoverflow.com/questions/48913898/searching-a-substring-in-a-string-and-its-position", "title": "Searching a substring in a string and its position", "body": "<p>I'm trying to write a code that checks if entered substring is in entered string. With some googling I was managed to do it. But I'm supposed to write a code that tells if the substring repeats several times. </p>\n\n<p>For example, if string is <code>\"ABBABBABAAABBBABABAA\"</code> and substring is <code>\"BABA\"</code>, output should be between 5-8, 13-16, 15-18. </p>\n\n<p>How can I improve my code? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n\n  char sntnc[400], word[400], *ptr; \n  puts(\"Please enter a string: \");\n  gets(sntnc);\n  puts(\"\\nEnter a substring to be searched: \");\n  gets(word);\n  ptr=strstr(sntnc,word);\n  if (strstr(sntnc, word)==NULL)\n    printf(\"\\nThe string doesn't contains the substring.\");\n  else \n    printf(\"\\nPositin of the substring in the string: %d.\", ptr - sntnc + 1);\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "for-loop", "struct"], "answers": [{"comments": [{"owner": {"reputation": 1102, "user_id": 5660197, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/97df5665e51bcf688208167c32a7bb4e?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/5660197/tony"}, "edited": false, "score": 0, "creation_date": 1519240154, "post_id": 48913180, "comment_id": 84833531, "body": "I had to reread that a few times, and then it hit me.  Thank you very much, can&#39;t believe I missed the increment range.  It&#39;s surprising how much I&#39;ve never thought of these little things with Python."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 1, "last_activity_date": 1519238702, "last_edit_date": 1519238702, "creation_date": 1519238339, "answer_id": 48913180, "question_id": 48913115, "link": "https://stackoverflow.com/questions/48913115/loop-not-triggering-on-structure-array-testing/48913180#48913180", "title": "Loop not triggering on structure array testing", "body": "<ul>\n<li><p>Inside a for loop where the condition is <code>i&lt;dict_size</code> how do you expect it to be equal to <code>dict_size</code> if the only place where it is not incrememented in the body of the for loop.</p></li>\n<li><p>What you might want is that after the loop is over - check whether <code>i == dict_size</code> then you will be sure that it is not found. Here inside the for loop you are checking for <code>i ==  dict_size</code> which will be outside of it.</p></li>\n<li><p>Also <code>loop-&gt;word == pch</code> is comparing two pointers - but you want to compare two strings - which will be done using <code>strcmp</code>. So the structure of the code will be</p>\n\n<pre><code>for(i = ..; i &lt; dict_size ; ... ){\n   if(strcmp(loop-&gt;word, pch) == 0){\n      /*  found */\n   }\n   ...\n}\nif( i == dict_size){\n   /* not found */\n}\n</code></pre></li>\n<li><p><code>fgets</code> return value should be checked to check the failure or success of the function call. This level error checking is important.</p></li>\n</ul>\n"}], "owner": {"reputation": 1102, "user_id": 5660197, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/97df5665e51bcf688208167c32a7bb4e?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/5660197/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 48913180, "answer_count": 1, "score": 0, "last_activity_date": 1519238702, "creation_date": 1519238138, "question_id": 48913115, "link": "https://stackoverflow.com/questions/48913115/loop-not-triggering-on-structure-array-testing", "title": "Loop not triggering on structure array testing", "body": "<p>I'm just starting to explore C, so i'll appreciate any code style advice.  However my specific problem is in understanding why my <code>else if</code> conditional is not getting triggered.  As you can see in the comments, I realize my <code>loop-&gt;word</code> seems like it never got initialized, but the second time through the <code>for loop</code> i'm thinking that atleast one word should be added?</p>\n\n<p>Code:</p>\n\n<pre><code> typedef struct node{\n     char word[15];\n     int count;\n } node;\n\n\n int main(int argc, char *argv[]){\n     int word_size = 500, dict_size=10;\n     char words[word_size];\n\n     // main prompt\n     printf(\"Enter some words: \");\n     fgets(words, word_size, stdin);\n\n     // create a list of nodes, and iterator through array\n     struct node dict[dict_size];\n     struct node *head = dict;\n     struct node *loop = dict;\n\n     // pointer for tokenization, starts at [0] until delimiter\n     char *pch;\n     pch = strtok(words, \" \");\n     // TODO: dict[0] so that last is equal to 1, and can use that as max loop?\n\n     // keep track of how many nodes have been updated\n     int i, j, last = 0;\n\n     while(pch != NULL){\n         printf(\"pch == %s\\n\", pch); // this works\n\n         for(i=0; i&lt;dict_size; i++, loop++) {\n             printf(\"inner = %d\\n\", i); // this works\n             printf(\"loop-&gt;word == %s\\n\", loop-&gt;word); // realize i'm testing against nonsense?\n\n             if(loop-&gt;word == pch){\n             // loop through each dict element, looking for matching word\n             // increment the value pointed to by loop-&gt;count\n                 printf(\"%s was found in dict[%d], incrementing counter\", loop-&gt;word, loop-&gt;count);\n                 loop-&gt;count = loop-&gt;count + 1;\n                 break;\n\n             } else if(i == dict_size){\n             // key doesn't exist so update the next struct\n                 printf(\"adding %s, with count 1.\\n\", pch);\n                 strcpy(dict[last].word, pch);\n                 dict[last].count = 1;\n                 last++;\n             }\n         }\n         // lastly move token, and reset pointer @ head of the dictionary\n         pch = strtok(NULL, \" \");\n         loop = head;\n     }\n\n     // set pointers to null?\n     loop = NULL;\n     head = NULL;\n     printf(\"done\");\n</code></pre>\n\n<p>Edit: sorry for the wall of code, not sure what's the minimal code needed for a c problem.</p>\n"}, {"tags": ["c", "gcc", "shared-libraries", "elf", "crosstool-ng"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5745227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01dcf7bbe4cdab7880279846fa147e9?s=128&d=identicon&r=PG", "display_name": "Douglas Coup", "link": "https://stackoverflow.com/users/5745227/douglas-coup"}, "edited": false, "score": 0, "creation_date": 1519311737, "post_id": 48915415, "comment_id": 84867821, "body": "Our build system doesn&#39;t have the eu-readelf command.  I added --secure-plt to the link options and -msecure-plt to the compile options.  The options didn&#39;t produce any command errors, but the .so files created still have the RWE header."}], "tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": false, "score": 1, "last_activity_date": 1519412192, "last_edit_date": 1519412192, "creation_date": 1519246959, "answer_id": 48915415, "question_id": 48913049, "link": "https://stackoverflow.com/questions/48913049/program-header-marked-rwe-in-shared-object-file/48915415#48915415", "title": "Program header marked RWE in shared object file", "body": "<p>Can you check the section-to-program-header mapping (<code>eu-readelf -l</code>)?  I'm pretty sure this happens because your target configuration doesn't enable by default the secure GOT feature that was implemented for GNU/Linux some time ago:</p>\n\n<ul>\n<li><a href=\"http://www.sourceware.org/ml/binutils/2005-05/msg00391.html\" rel=\"nofollow noreferrer\">powerpc new PLT and GOT</a></li>\n</ul>\n\n<p>See <code>--bss-plt</code> and <code>--secure-plt</code> in <a href=\"https://sourceware.org/binutils/docs-2.30/ld/PowerPC-ELF32.html\" rel=\"nofollow noreferrer\"><code>ld</code> and PowerPC 32-bit ELF Support</a> for flags to control this behavior.  If you use a custom program loader, you may have to tweak it for secure PLT support.  The glibc dynamic linker supports it.</p>\n\n<p>(And your customer is very astute, congratulations.)</p>\n\n<p><strong>EDIT</strong> If <code>--secure-plt</code> does not work, your PowerPC sub-target is either incompatible with it, you built the toolchain incorrectly, or there's a linker script which overrides its effect.</p>\n"}], "owner": {"reputation": 37, "user_id": 5745227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01dcf7bbe4cdab7880279846fa147e9?s=128&d=identicon&r=PG", "display_name": "Douglas Coup", "link": "https://stackoverflow.com/users/5745227/douglas-coup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519412192, "creation_date": 1519237870, "question_id": 48913049, "link": "https://stackoverflow.com/questions/48913049/program-header-marked-rwe-in-shared-object-file", "title": "Program header marked RWE in shared object file", "body": "<p>I'm using a cross compiler on a 64-bit Intel-based Linux system to build some of our software so it can run on a 32-bit PowerPC chip.  The cross compiler was produced by Crosstools.</p>\n\n<p>When I run \"readelf -a\" against the shared object files (.so files) produced by the cross compiler, part of the output shows this:</p>\n\n<pre><code>Program Headers:\n  Type           Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align\n  LOAD           0x000000 0x00000000 0x00000000 0x9a87c 0x9a87c R E 0x10000\n  LOAD           0x09a87c 0x000aa87c 0x000aa87c 0x01344 0x03230 RWE 0x10000\n  DYNAMIC        0x09ba84 0x000aba84 0x000aba84 0x000d0 0x000d0 RW  0x4\n  GNU_EH_FRAME   0x09a7bc 0x0009a7bc 0x0009a7bc 0x0002c 0x0002c R   0x4\n  GNU_STACK      0x000000 0x00000000 0x00000000 0x00000 0x00000 RW  0x4\n</code></pre>\n\n<p>The problem is that header marked RWE.  A potential customer evaluating our software has issues with that and wants it to be just RW.</p>\n\n<p>A second cross compiler, produced by the same version of Crosstools and targeting the same version of gcc, produces code for 64-bit PowerPC chips.  The shared object files produced by this cross compiler do not produce any RWE headers (the second LOAD header is marked just RW).</p>\n\n<p>The qualifiers for gcc for both the compiles and the links are the same in both cases.</p>\n\n<p>I'm kind of new to the world of cross compilers and ELF headers.  Is there a way to get the 32-bit cross compiler to create shared object files without a header marked RWE?</p>\n\n<p>Failing that, is there a way to (safely) patch an already created .so file to change a header marked RWE so it's marked RW?</p>\n"}, {"tags": ["c", "string", "pointers"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 3, "creation_date": 1519236751, "post_id": 48912734, "comment_id": 84831803, "body": "<code>str</code> pointing to literal? :)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1519236767, "post_id": 48912734, "comment_id": 84831810, "body": "Post the full code, please. I suspect <code>str</code> is string literal...."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 1, "creation_date": 1519236923, "post_id": 48912734, "comment_id": 84831891, "body": "Told ya... ...it&#39;s UB."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519236936, "post_id": 48912734, "comment_id": 84831897, "body": "Well, our suspicions are true. String literals are not modifiable. Attempting to write them will lead to undefined behavior."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519237502, "post_id": 48912734, "comment_id": 84832169, "body": "@EugeneSh.:Just a small question - does the standard say so? (<i>String literals are not modifiable</i>)? I guess no. (I didn&#39;t find it when I checked last time - but the behavior of attempting to modify it is undefined). :)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1519237626, "post_id": 48912734, "comment_id": 84832238, "body": "@coderredoc They are not modifiable in a sense that modifying them is illegal (undefined). It&#39;s like your private property is your private, until it is stolen :)"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1519237693, "post_id": 48912734, "comment_id": 84832272, "body": "@EugeneSh.Yes. Right you are."}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 1, "last_activity_date": 1519237036, "creation_date": 1519237036, "answer_id": 48912842, "question_id": 48912734, "link": "https://stackoverflow.com/questions/48912734/trying-to-change-the-pointer-stops-the-program-from-execution/48912842#48912842", "title": "Trying to change the pointer stops the program from execution", "body": "<p><em>Attempting to modify the string literal has <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><strong>undefined behavior</strong></a></em>. In your case the program stopped because you tried to modify the non-modifiable. (Generally it is placed in <code>.rodata</code> section - read only).However, modifying a mutable array of <code>char</code> directly, or through a pointer is  not undefined behavior, even\nthough its initializer is a literal string. The following is fine:</p>\n\n<pre><code>char str[] = \"ABC 123!\";\n</code></pre>\n\n<p>This is all you need to get the correct behavior out of your code. Also one of the reasons we don't write code in binary is make things human readable. Here instead of using <code>47</code>,<code>58</code> use <code>'0'</code> or <code>'9'</code> etc. It's more readable.</p>\n"}], "owner": {"reputation": 86, "user_id": 6900729, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/755eee432d697c0739674f93a9f49d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex F", "link": "https://stackoverflow.com/users/6900729/alex-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "closed_date": 1519237327, "accepted_answer_id": 48912842, "answer_count": 1, "score": 1, "last_activity_date": 1519237036, "creation_date": 1519236646, "last_edit_date": 1519236899, "question_id": 48912734, "link": "https://stackoverflow.com/questions/48912734/trying-to-change-the-pointer-stops-the-program-from-execution", "closed_reason": "Duplicate", "title": "Trying to change the pointer stops the program from execution", "body": "<p>I'm practicing on Code Wars and I've encountered a strange problem. Omitting some details: the task is to replace each digit by its complement to 9, and shift each letter by a given number. To do so I've made this loop, which I believe should change each character based on its ANSI code representation:</p>\n\n<pre><code>char *str = \"ABC 123!\"; // example\nint n = 1; // example\n\nfor (char *c = str; *c; c++) {\n    printf(\"Before: *c = %d\\n\", *c);\n    if (*c &gt; 47 &amp;&amp; *c &lt; 58) {\n        *c = 105 - *c;\n        // replace digit\n    }\n    if (*c &gt; 64 &amp;&amp; *c &lt; 91) {\n        *c = (*c - 64 + number) % 26 + 64;\n        // replace letter\n    }\n    printf(\"After: *c = %d\\n\", *c);\n}\n</code></pre>\n\n<p>I've made various log statements in various places from which I can tell that some condition checking fails and I <strong>don't</strong> enter the <code>if</code> block, while the other succeeds and I <strong>do</strong> enter the <code>if</code> block, but as soon as I run into the <code>*c = ...;</code> statement, the test crashes (also tried running the same code in a separate IDE, but the execution still suddenly stops).  </p>\n\n<p>Why would this happen?</p>\n"}, {"tags": ["c", "assembly", "linux-kernel", "hook", "clone"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1519236613, "post_id": 48912653, "comment_id": 84831739, "body": "<i>I am trying to hook [syscalls]</i> \u2014 You&#39;re not supposed to do that. Seriously. In order to get this far you must have hacked around several different mechanisms that exist specifically to <i>prevent</i> you from doing that, and it&#39;s very likely that you broke something in the process. Back up a level and describe your larger goals and maybe we can help you with <i>those</i>."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1519236788, "post_id": 48912653, "comment_id": 84831821, "body": "@zwol I&#39;m an IT Security Researcher. My job is to find ways of hacking systems to make them more secure. If you want to help do it. If you don&#39;t just you shouldn&#39;t comment."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 2, "creation_date": 1519237044, "post_id": 48912653, "comment_id": 84831946, "body": "I&#39;m trying to help by explaining to you that you have bent the Linux kernel well outside its design specifications already, therefore it&#39;s not surprising that it crashes, and there is probably a better way to do what you want.  You are in the &quot;<a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>&quot; cognitive trap."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1519237490, "post_id": 48912653, "comment_id": 84832161, "body": "I understand. But the true is that I am able to hide processes, to run a revershel shell, to patch the kernel and something more. Everything works stable. The problem is only related on the hook of sys_clone. I think I was clear on the post. Saying and sharing only the part which is crashing. Because if I remove the hook of sys_clone, everything works fine. So, what I think is that there&#39;s something different related to sys_clone. Because Kernel is not an script, it&#39;s ok or it&#39;s not ok."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1519237543, "post_id": 48912653, "comment_id": 84832187, "body": "I don&#39;t know which level to go down to show you&#39;re wrong."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 2, "creation_date": 1519237613, "post_id": 48912653, "comment_id": 84832229, "body": "You could be right.  But I think it is more likely that <code>clone</code> is especially sensitive to whatever it was you did wrong in the code you haven&#39;t shown us.  Regardless, I don&#39;t want you to go down any more levels, I want you to go <i>up</i> a few levels and explain what you are trying to accomplish by hooking clone in the first place."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1519237809, "post_id": 48912653, "comment_id": 84832332, "body": "You have the whole code in github. Check it, try it, do whatever you need to, and tell me what&#39;s wrong if you can. Please."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1519238204, "post_id": 48912653, "comment_id": 84832540, "body": "<a href=\"https://github.com/D1W0U/ARP-RootKit\" rel=\"nofollow noreferrer\">github.com/D1W0U/ARP-RootKit</a>"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1519239230, "post_id": 48912653, "comment_id": 84833087, "body": "A code dump does not tell me what you are trying to accomplish.  You have to use words in a natural language for that."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1519240698, "post_id": 48912653, "comment_id": 84833816, "body": "I&#39;m trying to hook sys_clone. And my question is, knowing I&#39;ve succesfully hooked more than 20 syscalls in the project, also sys_fork and sys_vfork that just call _do_fork, why sys_clone doesn&#39;t work. Just that."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1519242407, "post_id": 48912653, "comment_id": 84834728, "body": "You wrap target function call with <code>set_fs(KERNEL_DS);</code> / <code>set_fs(old_fs);</code>, this changes interpretation of the pointers passed as syscall parameters. Because neither <code>fork</code> nor <code>vfork</code> has parameters, such wrapping doesn&#39;t affect on them. But <code>clone64</code> <b>has parameters</b>, so you actually modify syscall&#39;s behaviour. Really, you use a wrapping mechanism, but doesn&#39;t know what it does?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1519242636, "post_id": 48912653, "comment_id": 84834863, "body": "But WHY are you trying to hook sys_clone? I still don&#39;t understand what the point of this exercise is."}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 2, "creation_date": 1519245010, "post_id": 48912653, "comment_id": 84836193, "body": "It&#39;s hard to answer this question (despite its importance or ontological issues). You made some arbitrary, and <i>not</i> documented in the question, changes to the Linux kernel. You found a problem that was described generically as &quot;segmentation fault&quot;. The code presented seems problematic: are the C types correct? Why swapping <code>fs</code> when the modern kernel uses <code>gs</code>? Have you considered KPTI? Have you took a look at <a href=\"https://elixir.bootlin.com/linux/v4.16-rc2/source/arch/x86/entry/entry_64.S\" rel=\"nofollow noreferrer\">entry_64.S</a> and <a href=\"https://elixir.bootlin.com/linux/v4.15.1/source/arch/x86/entry/common.c#L268\" rel=\"nofollow noreferrer\">common.c</a>?"}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1519245133, "post_id": 48912653, "comment_id": 84836260, "body": "Take a look <a href=\"https://0xax.gitbooks.io/linux-insides/content/SysCall/syscall-2.html\" rel=\"nofollow noreferrer\">here</a> in case you need to brush up on how syscalls work on 64-bit systems. The ABI is different <code>rcx</code> is used by <code>syscall</code>. Too much is missing in the question to understand how to answer it."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1519245593, "post_id": 48912653, "comment_id": 84836490, "body": "I think people are downvoting this question because it&#39;s not totally clear exactly what you did (or more importantly why).  Your problem is kind of too big to summarize into a good SO question.  This doesn&#39;t seem like a very good <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  Nobody has said anything about downvoting because they oppose white-hat hacking."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1519258579, "post_id": 48912653, "comment_id": 84841736, "body": "@Tsyvarev If you see, the SYSCALL64 macro uses value 1 in parameter user, and the function only uses my_set_fs and my_get_fs when user is 0."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1519258630, "post_id": 48912653, "comment_id": 84841748, "body": "@zwol I want to bypass the method to detect hidden PIDs used by <code>unhide</code> tool: <a href=\"http://www.unhide-forensics.info/\" rel=\"nofollow noreferrer\">unhide-forensics.info</a>"}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1519258869, "post_id": 48912653, "comment_id": 84841812, "body": "@MargaretBloom I can&#39;t post a whole month of development by the method I am using to be able to hook syscalls. But I can tell you that I create my own syscall table and I patch the kernel. The segmentation fault is given by the future command executions in bash. The kernel remains working. Which types are wrong? The kernel uses long for every parameter on x86_64 in syscalls. I don&#39;t swap in this case, because user parameter is 1. No I don&#39;t know what is KPTI. Maybe there&#39;s something of interest on those files to solve the problem."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1519259062, "post_id": 48912653, "comment_id": 84841862, "body": "@MargaretBloom maybe the problem is in <code>rcx</code>. That it returns to the incorrect address. I&#39;m trying to improve the question and give more information."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519259103, "post_id": 48912653, "comment_id": 84841875, "body": "@PeterCordes Okay. Thanks for your opinion. I&#39;m updating the question."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519269689, "post_id": 48912653, "comment_id": 84844496, "body": "But is bash or some other process <i>actually</i> receiving a SIGSEGV because your changes created a bad address in user-space?  Or does a system call return <code>-EFAULT</code> because of your changes?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 2, "creation_date": 1519288339, "post_id": 48912653, "comment_id": 84851813, "body": "@AbelRomeroP&#233;rez: In that discussion I am on the side with PeterCordes. You want to hook syscalls. You say <b>you know</b> that you are doing something unusual. OK. Then you should be ready to <b>debug hard</b>. I see, you have already done some part of debugging. Nice. But for ask on Stack Overflow you need more - you need <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Remove all <i>unnecessary</i> code and simplifies the rest as you can. Is replacing <code>SYSCALL64()</code> to <code>sys_clone()</code> in <code>my_clone64</code> implementation works? If no, then drop <code>SYSCALL64</code> completely. If yes, check that you finally call <code>sys_clone</code> with proper parameters. And so on."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519290353, "post_id": 48912653, "comment_id": 84852983, "body": "@PeterCordes Are the processes opened with clone() on the bash already executing before to load the rootkit. I mean: I have 2 bash with PuTTY, I load the rootkit in one session, and in the other I type: ls. Then it says Segmentation fault code dumped. I unload the rootkit in the other session. I re-type ls in the other, and it works."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1519290526, "post_id": 48912653, "comment_id": 84853069, "body": "@Tsyvarev Ok. But SYSCALL64 is the way to call the original syscall. I cloned the syscall tables and have 2 for the 64bit one and 2 for the 32bit compat. I patch the .text section to replace references to original and I patch with cloned ones. Then I use SYSCALL64 and <code>syscall</code> macro and function, respectively, to call those originals from <code>sys_call_table</code>. <code>my_sct</code> is the cloned one, where I do the hooking."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1519293923, "post_id": 48912653, "comment_id": 84855313, "body": "I understand that you need SYSCALL64 for your <i>real work</i>. But first you should check, that hook mechanism itself is working. That is why I ask you to replace <code>SYSCALL64()</code> call in your <code>my_clone64</code> implementation to <code>sys_clone()</code> call. Such way you will check that hooking works. If hooking doesn&#39;t work, then <code>SYSCALL64</code> is useless (at least, for <code>clone</code> syscall). If hooking works, then the problem in <code>SYSCALL64</code>. But as there is no asm code in your <code>SYSCALL64</code> implementation, you needn&#39;t to bother about wrong registers or so - you need just to check that you pass correct parameters."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1519294316, "post_id": 48912653, "comment_id": 84855577, "body": "@Tsyvarev okay, I just created a minimal example reproducing the error. Please check it. I updated the question. It&#39;s easy to get it working and reproduces the error in my real project."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1519295533, "post_id": 48912653, "comment_id": 84856411, "body": "Nice. Am I right, that in the updated example you don&#39;t use technique with patching the kernel&#39;s <code>.text</code> section, which  you have described in your previous comment? As the questions now has an example focused on the problem, I have voted for reopen it. (It is required 4 other votes for the question being completely opened, so answers can be written. But comments works anywhere.)"}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "edited": false, "score": 0, "creation_date": 1519295978, "post_id": 48912653, "comment_id": 84856691, "body": "Yes you are right, in the updated question I don&#39;t use the same method of hooking syscalls, because I tried with a simple minimal verification example, and the problem is the same, and giving a complete example in the same way I do in my real project would be a lot of work. But it&#39;s the same scenario. Something is wrong in <code>_do_fork</code> or I must do something with stack when calling original <code>sys_clone</code> from the handler. Thanks."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519306723, "post_id": 48912653, "comment_id": 84864000, "body": "Use <code>strace</code> and/or <code>gdb</code> on the bash process which is trying to fork <code>ls</code> to see what gets messed up that causes it to segfault.  Or if some system call is returning <code>-EFAULT</code> and there&#39;s no actual out-of-bounds memory access in user-space."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1519308254, "post_id": 48912653, "comment_id": 84865204, "body": "Also, run in a VM with kernel debugging if needed."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519312800, "post_id": 48912653, "comment_id": 84868639, "body": "@PeterCordes As I can not spawn commands when the hook is installed, I must run the <code>strace bash</code> before. Then I run <code>ls</code>, and sometimes works. Other times says that <code>wait</code> received a <code>SIGSEGV</code>. I&#39;m going to update the question for you to see that is some kind of implementation in the linux kernel, with the use of <code>_do_fork()</code> function. I think they implemented in the way that it can&#39;t be another call between <code>sys_clone</code> and <code>_do_fork</code>. Also all the functions that call <code>_do_fork</code> return inmediatly, there are no more calls."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1519313032, "post_id": 48912653, "comment_id": 84868810, "body": "@Jester That is my last option. Now, I&#39;m going to try to make a trampoline to <code>_do_fork</code> because I think there&#39;s some kind of implementation in the Linux Kernel that forces the need to call <code>_do_fork</code> only in one nested call."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519313633, "post_id": 48912653, "comment_id": 84869212, "body": "Use <code>strace -f</code> on bash to follow forks, so if it succeeds at all, the already-running strace will follow it.  IDK if GDB has a similar option to debug child processes.  If you ran <code>sleep 60</code>, you could try attaching to it from an already-running GDB, but probably it segfaults before it could make a sleep system call."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1519315904, "post_id": 48912653, "comment_id": 84870976, "body": "@PeterCordes ok, I will try with <code>strace -f</code> to see what outputs. In GDB there&#39;s <code>set follow-fork-mode parent|child</code> if I don&#39;t remember bad."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519360198, "post_id": 48912653, "comment_id": 84889197, "body": "@PeterCordes I&#39;ve updated the question with the result of your suggestion. You now can know what happens with and without <code>strace -f</code>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519366729, "post_id": 48912653, "comment_id": 84891083, "body": "So when running under <code>strace -f</code>, bash works fine even when your module is loaded?  Looks like you&#39;ve encountered a Heisenbug: a bug that only happens when you&#39;re not looking.  Inside the kernel, system call tracing does run a bunch of extra code, so maybe it&#39;s fixing something you break, or it just happens to work."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519371425, "post_id": 48912653, "comment_id": 84892979, "body": "@PeterCordes Yes, when running under <code>strace -f</code>, <code>bash</code>, works fine even my module is loaded. Oh that sounds interesting. So do you think that the problem because I can not hook <code>sys_clone</code> is because there&#39;s a bug in <code>_do_fork</code> ? I think it&#39;s <code>copy_process</code> the responsible to break it. And I think it happens when the <code>clone</code> includes a new stack. Should I contact Linux Kernel developers?"}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "edited": false, "score": 0, "creation_date": 1519382856, "post_id": 48912653, "comment_id": 84898438, "body": "No, I&#39;ve tested it printk-ing the address of newsp and it&#39;s called with 0 value and it crashes."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519495581, "post_id": 48965890, "comment_id": 84937646, "body": "Another option might be to tail-call the function with <code>jmp sys_clone</code>, rather than <code>call sys_clone</code> / <code>ret</code>.  So the stack would be in the same state, with your caller as the caller seen by <code>sys_clone</code>."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519496640, "post_id": 48965890, "comment_id": 84937971, "body": "Yeah, that&#39;s useful if you don&#39;t need to get the new process <code>pid</code>. But I need to catch it. Another option I&#39;m trying is to fix stack for be able to call <code>sys_clone</code> from <code>ptregs_sys_clone</code> in newer kernels, and <code>stub_sys_clone</code> in older. But still researching =)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519496777, "post_id": 48965890, "comment_id": 84938021, "body": "The example in your question doesn&#39;t show you doing anything with the return value.  I guess your real code has more instructions between the <code>call</code> and the <code>ret</code>."}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519496983, "post_id": 48965890, "comment_id": 84938093, "body": "I&#39;m going to fix the question. You&#39;re right. But in the answer I used... anyway I fix it. Yes, as I said the project is more big than the given here, I had to do a minimal verificable example because I was getting too much -1. In the real project I have nothing related to <code>sys_clone</code> hooking because I was developing it on the minimal verificable example. But I just returned directly from hook handler, to be cleaner in the problem: that common hooking way doesn&#39;t work, even simpler hook handler."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519497117, "post_id": 48965890, "comment_id": 84938145, "body": "Yup, just add a comment into the MCVE like <code>&quot;# do something with the PID in eax before returning\\n\\t&quot;</code>"}, {"owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519498840, "post_id": 48965890, "comment_id": 84938651, "body": "It&#39;s <code>stub_clone</code> not <code>stub_sys_clone</code> on Linux Kernel v4.0.1"}], "tags": [], "owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "is_accepted": true, "score": 1, "last_activity_date": 1519494902, "creation_date": 1519494902, "answer_id": 48965890, "question_id": 48912653, "link": "https://stackoverflow.com/questions/48912653/how-to-hook-sys-clone-in-newer-linux-kernel/48965890#48965890", "title": "How to hook sys_clone in newer Linux Kernel", "body": "<p>I found the answer.</p>\n\n<p>Just the problem of common hooking (aka replace syscall handlers in syscall table) is that actually (in the kernel 4.15.1 at least), there's defined an extra symbol called <code>ptregs_sys_clone</code>, which makes some tricks to finally <code>call/jmp</code> to <code>sys_clone</code>. And nesting calls is not an option, since the retaddr is checked to go from one path or another... so the solution I found, is to replace the reference to <code>sys_clone</code> in <code>ptregs_sys_clone</code>.</p>\n\n<p>The code as follows.</p>\n\n<p>core.c</p>\n\n<pre><code>#include &lt;linux/uaccess.h&gt;\n\nvoid **sys_call_table = NULL;\nasmlinkage long (*sys_read)(long a1, long a2, long a3, long a4, long a5, long a6) = NULL;\nasmlinkage long (*ptregs_sys_clone)(struct pt_regs *regs) = NULL;\nasmlinkage long (*sys_clone)(long a1, long a2, long a3, long a4, long a5, long a6) = NULL;\nasmlinkage long my_clone64(long a1, long a2, long a3, long a4, long a5, long a6);\n\nextern char *sct_str;\n\nvoid disable_wp(void) {\n        asm(\"cli\\n\\tmov\\t%cr0, %rax\\n\\tand\\t$0xfffffffffffeffff, %rax\\n\\tmov\\t%rax, %cr0\\n\\tsti\");\n}\n\nvoid enable_wp(void) {\n        asm(\"cli\\n\\tmov\\t%cr0, %rax\\n\\tor\\t$0x10000, %rax\\n\\tmov\\t%rax, %cr0\\n\\tsti\");\n}\n\nint patch_ptregs_syscall(void *addr, long newaddr, long *oldaddr) {\n        int i = 0, ret = 0, *p = NULL;\n        long vaddr = 0; // variable address\n\n        p = addr + 3; // point to offset in: lea offset(%rip), %register\n        //printk(\"value before patch = %lx\\n\", *p);\n        vaddr = (long)*p + addr + 7; // offset + %rip + lea' size\n        if (oldaddr) {\n                *oldaddr = vaddr;\n        }\n        printk(\"address %lx, ofsset %lx\\n\", vaddr, *p);\n        vaddr = newaddr - (long)addr - 7;\n        printk(\"new address %lx, new offset %lx\\n\", newaddr, vaddr);\n        disable_wp();\n        ret = probe_kernel_write(p, &amp;vaddr, sizeof(int));\n        enable_wp();\n        if (ret != 0) {\n                return -2;\n        }\n\n        return 0;\n}\n\nint install_hooks(void) {\n        int ret = 0;\n        mm_segment_t old_fs;\n\n        if (!sct_str) {\n                return -2;\n        }\n\n        kstrtoul(sct_str, 16, (unsigned long *) &amp;sys_call_table);\n        printk(\"sct: %lx\\n\", sys_call_table);\n\n        if (!sys_call_table) {\n                return -2;\n        }\n\n        sys_read = sys_call_table[__NR_read];\n        ptregs_sys_clone = sys_call_table[__NR_clone];\n\n        // hook sys_clone\n        patch_ptregs_syscall(ptregs_sys_clone, (long)my_clone64, (long *)&amp;sys_clone);\n\n        // wait user's ENTER\n        old_fs = get_fs();\n        set_fs(KERNEL_DS);\n        sys_read(0, (long)&amp;ret, 1, 0, 0, 0);\n        set_fs(old_fs);\n\n        // restore sys_clone\n        patch_ptregs_syscall(ptregs_sys_clone, (long)sys_clone, NULL);\n\n        return -1;\n}\n\nasmlinkage long my_clone64(long a1, long a2, long a3, long a4, long a5, long a6) {\n        pid_t pid = 0;\n\n        pid = sys_clone(a1, a2, a3, a4, a5, a6);\n        printk(\"pid %d\\n\", pid);\n        return pid;\n}\n</code></pre>\n\n<p>main.c:</p>\n\n<pre><code>#include &lt;linux/module.h&gt;\n\nextern int install_hooks(void);\n\nchar *sct_str;\n\nmodule_param(sct_str, charp, 0);\n\nint init_module(void) {\n        return install_hooks();\n}\n\nvoid cleanup_module(void) {\n}\n\nMODULE_LICENSE(\"GPL\");\n</code></pre>\n\n<p>Makefile</p>\n\n<pre><code>obj-m += so.o\n\nso-objs := main.o core-asm.o\n\nEXTRA_CFLAGS := -O0\n\nKERNEL_HEADERS = /lib/modules/$(shell uname -r)/build\n\nall:\n        make V=1 -C $(KERNEL_HEADERS) M=$(PWD) core.s\n        gcc -c core.s -o core-asm.o\n        make V=1 -C $(KERNEL_HEADERS) M=$(PWD) modules\n\nclean:\n        make V=1 -C $(KERNEL_HEADERS) M=$(PWD) clean\n</code></pre>\n\n<p>Good luck, and thanks for all your comments &amp; help.</p>\n"}], "owner": {"reputation": 371, "user_id": 4023034, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/1Xv6Q.jpg?s=128&g=1", "display_name": "Puffy", "link": "https://stackoverflow.com/users/4023034/puffy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 986, "favorite_count": 0, "accepted_answer_id": 48965890, "answer_count": 1, "score": -2, "last_activity_date": 1519497103, "creation_date": 1519236336, "last_edit_date": 1519497103, "question_id": 48912653, "link": "https://stackoverflow.com/questions/48912653/how-to-hook-sys-clone-in-newer-linux-kernel", "title": "How to hook sys_clone in newer Linux Kernel", "body": "<p>I am trying to hook <code>sys_clone</code>, to bypass a method used by the tool <code>unhide</code> <a href=\"http://www.unhide-forensics.info/\" rel=\"nofollow noreferrer\">http://www.unhide-forensics.info/</a>. The idea is to translate PIDs from real to fake, and fake to real, making the tool to see the hidden PIDs and the not hidden as continuous identifiers.\nI mean, this tool forks continuously and checks if in all the loops there's some PID that is busy and it's not visible.\nThe idea es to cheat this tool by giving continuous PIDs.</p>\n\n<p>The problem, is that when a program executes my hook handler for <code>sys_clone</code>, after returning, wait(&amp;status) gives a signal of SEGVFAULT.</p>\n\n<p>I'm following the same method that I'm using to hook all other syscalls, including <code>sys_fork</code>, <code>sys_vfork</code> and the others syscalls.</p>\n\n<p><code>sys_vfork</code> and <code>sys_fork</code> uses the same function <code>_do_fork()</code> to create the new process: \n<a href=\"https://elixir.bootlin.com/linux/v4.15.1/source/kernel/fork.c#L2148\" rel=\"nofollow noreferrer\">https://elixir.bootlin.com/linux/v4.15.1/source/kernel/fork.c#L2148</a></p>\n\n<p><a href=\"https://elixir.bootlin.com/linux/v4.15.1/source/kernel/fork.c#L2111\" rel=\"nofollow noreferrer\">https://elixir.bootlin.com/linux/v4.15.1/source/kernel/fork.c#L2111</a></p>\n\n<p><a href=\"https://elixir.bootlin.com/linux/v4.15.1/source/kernel/fork.c#L2123\" rel=\"nofollow noreferrer\">https://elixir.bootlin.com/linux/v4.15.1/source/kernel/fork.c#L2123</a></p>\n\n<p><strong>EDITED</strong>:\nI created a minimal working example, reproducing the bug, so you can test it better, and sorry because I didn't before:</p>\n\n<pre><code>#include &lt;linux/module.h&gt;\n#include &lt;linux/uaccess.h&gt;\n\nvoid **sys_call_table = NULL;\nasmlinkage long (*sys_read)(long a1, long a2, long a3, long a4, long a5, long a6) = NULL;\nasmlinkage long (*sys_clone)(long a1, long a2, long a3, long a4, long a5, long a6) = NULL;\nasmlinkage long my_clone64(long a1, long a2, long a3, long a4, long a5, long a6);\n\nchar *sct_str;\n\nmodule_param(sct_str, charp, 0);\n\ninline void disable_wp(void) {\n        asm(\"cli\\n\\tmov\\t%cr0, %rax\\n\\tand\\t$0xfffffffffffeffff, %rax\\n\\tmov\\t%rax, %cr0\\n\\tsti\");\n}\n\ninline void enable_wp(void) {\n        asm(\"cli\\n\\tmov\\t%cr0, %rax\\n\\tor\\t$0x10000, %rax\\n\\tmov\\t%rax, %cr0\\n\\tsti\");\n}\n\nint init_module(void) {\n        int ret = 0;\n        mm_segment_t old_fs;\n\n        kstrtoul(sct_str, 16, (unsigned long *) &amp;sys_call_table);\n        printk(\"%lx\\n\", sys_call_table);\n\n        if (!sys_call_table) {\n                return -1;\n        }\n\n        sys_read = sys_call_table[__NR_read];\n        sys_clone = sys_call_table[__NR_clone];\n\n        // hook sys_clone\n        printk(\"be\\n\");\n        disable_wp();\n        sys_call_table[__NR_clone] = my_clone64;\n        enable_wp();\n        printk(\"af\\n\");\n\n        // wait user's ENTER\n        old_fs = get_fs();\n        set_fs(KERNEL_DS);\n        sys_read(0, (long)&amp;ret, 1, 0, 0, 0);\n        set_fs(old_fs);\n\n        // restore sys_clone\n        disable_wp();\n        sys_call_table[__NR_clone] = sys_clone;\n        enable_wp();\n\n        return -1;\n}\n\nvoid cleanup_module(void) {\n}\n\n\nasmlinkage long my_clone64(long a1, long a2, long a3, long a4, long a5, long a6) {\n        long ret = 0;\n        printk(\"pid = %d\\n\", ret);\n        ret = sys_clone(a1, a2, a3, a4, a5, a6);\n        return ret;\n}\n\nMODULE_LICENSE(\"GPL\");\n</code></pre>\n\n<p>Use this <code>Makefile</code> to compile:</p>\n\n<pre><code>obj-m += so.o\n\nKERNEL_HEADERS = /lib/modules/$(shell uname -r)/build\n\nall:\n        make V=1 -C $(KERNEL_HEADERS) M=$(PWD) modules\n\nclean:\n        make V=1 -C $(KERNEL_HEADERS) M=$(PWD) clean\n</code></pre>\n\n<p>Compile with <code>make</code> and to load do:</p>\n\n<pre><code>diwou@diwou-VirtualBox:~/arpso$ sudo grep sys_call_table /proc/kallsyms\nffffffff9de00180 R sys_call_table\nffffffff9de01540 R ia32_sys_call_table\ndiwou@diwou-VirtualBox:~/arpso$ sudo insmod so.ko sct_str=\"ffffffff9de00180\"\n[NOW PRESS ENTER TO UNHOOK]\ninsmod: ERROR: could not insert module so.ko: Operation not permitted\ndiwou@diwou-VirtualBox:~/arpso$\n</code></pre>\n\n<p>The <code>Operattion not permitted</code> is due to the return code I use (<code>-1</code>) to automatically unload the module.</p>\n\n<p>Here is the output from the other session, when <code>sys_clone</code> is hooked. And I run <code>/bin/ls</code>:</p>\n\n<pre><code>diwou@diwou-VirtualBox:~$ ls\nViolaci\u00f3n de segmento (`core' generado)\n</code></pre>\n\n<p>After unhook <code>sys_clone</code> (by pressing ENTER) the command <code>ls</code> works again.</p>\n\n<p><strong>EDIT:</strong>\nIf you replace <code>my_clone64</code> by the following code, it happens the same. But if you change <code>call</code> by <code>jmp</code> it works:</p>\n\n<pre><code>asm(\n\".globl my_clone64\\n\\t\"\n\".type my_clone64, @function\\n\"\n\"my_clone64:\\n\\t\"\n\"call sys_clone(%rip)\\n\\t\"\n// do something with %rax\n\"ret\\n\\t\"\n\".size my_clone64, .-my_clone64\\n\\t\"\n);\n</code></pre>\n\n<p>That points to some kind of implementation in the Linux Kernel... am I right?</p>\n\n<p><strong>EDIT:</strong>\nIt's interesting that when I run <code>strace -f bash</code> in one ssh session, and <code>read(0,</code> waits for my input, then I load the LKM in another session, and I write <code>ls</code> in the <code>bash</code> being traced, and it works. I can see the output of the  <code>ls</code> command.\nBut if I open an ssh session, I load the LKM, and write <code>ls</code> on the <code>bash</code> without being traced, just a common ssh session, the output is segmentation fault:</p>\n\n<pre><code>clone(strace: Process 3233 attached\nchild_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0x7fa5f68be9d0) = 3233\n[...]\n[pid  3233] stat(\"arpso\", {st_mode=S_IFDIR|0775, st_size=4096, ...}) = 0\n[pid  3233] open(\"arpso\", O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC) = 3\n[pid  3233] fstat(3, {st_mode=S_IFDIR|0775, st_size=4096, ...}) = 0\n[pid  3233] getdents(3, /* 15 entries */, 32768) = 480\n[pid  3233] lstat(\"arpso/so.c\", {st_mode=S_IFREG|0664, st_size=1575, ...}) = 0\n[pid  3233] lstat(\"arpso/so.ko\", {st_mode=S_IFREG|0664, st_size=5760, ...}) = 0\n[pid  3233] lstat(\"arpso/modules.order\", {st_mode=S_IFREG|0664, st_size=31, ...}) = 0\n[pid  3233] lstat(\"arpso/Module.symvers\", {st_mode=S_IFREG|0664, st_size=0, ...}) = 0\n[pid  3233] lstat(\"arpso/so.o\", {st_mode=S_IFREG|0664, st_size=5440, ...}) = 0\n[pid  3233] lstat(\"arpso/so.mod.o\", {st_mode=S_IFREG|0664, st_size=2528, ...}) = 0\n[pid  3233] lstat(\"arpso/so.mod.c\", {st_mode=S_IFREG|0664, st_size=542, ...}) = 0\n[pid  3233] lstat(\"arpso/Makefile\", {st_mode=S_IFREG|0664, st_size=177, ...}) = 0\n[pid  3233] getdents(3, /* 0 entries */, 32768) = 0\n[pid  3233] close(3)                    = 0\n[...]\n+++ exited with 0 +++\ndiwou@diwou-VirtualBox:~$ ls\nViolaci\u00f3n de segmento (`core' generado)\ndiwou@diwou-VirtualBox:~$\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "linux", "signals", "posix"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519235232, "post_id": 48912261, "comment_id": 84830956, "body": "Are you sure this &quot;long loop&quot; is not just optimized away?"}, {"owner": {"reputation": 11, "user_id": 4271862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c45d3ca7570bb200bee96b3bdc6701d?s=128&d=identicon&r=PG&f=1", "display_name": "nikola12345", "link": "https://stackoverflow.com/users/4271862/nikola12345"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519235354, "post_id": 48912261, "comment_id": 84831015, "body": "You can compile with gcc and see output. Program is receiving <code>SIGXCPU</code> signals while the loop is running."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519235620, "post_id": 48912261, "comment_id": 84831169, "body": "@EugeneSh. Even if that&#39;s true, why would it work when he removes the <code>CLONE_NEWPID</code> flag?"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1519235645, "post_id": 48912261, "comment_id": 84831183, "body": "Works for me on Ubuntu 16.04, gcc 5.4.0, linux 4.4.0, both with and without CLONE_NEWPID. What distro/compiler/kernel are you using? Can you run <code>strace -f</code> and see if any signals at all are received by the child?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1519235863, "post_id": 48912261, "comment_id": 84831313, "body": "@Barmar Dunno.. some different timings... It was just a guess to sanitize the input."}, {"owner": {"reputation": 11, "user_id": 4271862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c45d3ca7570bb200bee96b3bdc6701d?s=128&d=identicon&r=PG&f=1", "display_name": "nikola12345", "link": "https://stackoverflow.com/users/4271862/nikola12345"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1519236370, "post_id": 48912261, "comment_id": 84831607, "body": "@MarkPlotnick are you sure the process gets killed after 3 seconds of hard limit?"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1519236889, "post_id": 48912261, "comment_id": 84831875, "body": "Yes. <code>[pid  5647] clone(strace: Process 5648 attached child_stack=0x7ffcca542770, flags=CLONE_NEWPID|SIGCHLD) = 5648  [pid  5648] setrlimit(RLIMIT_CPU, {rlim_cur=1, rlim_max=3}) = 0 [pid  5648] --- SIGXCPU {si_signo=SIGXCPU, si_code=SI_KERNEL} --- [pid  5648] --- SIGXCPU {si_signo=SIGXCPU, si_code=SI_KERNEL} --- [pid  5648] +++ killed by SIGKILL +++ [pid  5647] &lt;... wait4 resumed&gt; NULL, 0, NULL)      = 5648 --- SIGCHLD {si_signo=SIGCHLD, si_code=CLD_KILLED, si_pid=5648, si_uid=0, si_status=SIGKILL, si_utime=299, si_stime=0} ---</code>"}, {"owner": {"reputation": 11, "user_id": 4271862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c45d3ca7570bb200bee96b3bdc6701d?s=128&d=identicon&r=PG&f=1", "display_name": "nikola12345", "link": "https://stackoverflow.com/users/4271862/nikola12345"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1519237617, "post_id": 48912261, "comment_id": 84832231, "body": "@MarkPlotnick This means child is receiving <code>SIGXCPU</code>. Please see the edit."}, {"owner": {"reputation": 11, "user_id": 4271862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c45d3ca7570bb200bee96b3bdc6701d?s=128&d=identicon&r=PG&f=1", "display_name": "nikola12345", "link": "https://stackoverflow.com/users/4271862/nikola12345"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1519238115, "post_id": 48912261, "comment_id": 84832496, "body": "@MarkPlotnick Also when I run <code>strace</code> without <code>-f</code> flag it runs about 10 seconds, but when I run <code>strace -f</code> it runs 3 seconds."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1519239387, "post_id": 48912261, "comment_id": 84833158, "body": "I can reproduce that. Without strace -f, mine runs for 4 seconds. I&#39;ll look into it some more."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1519246792, "post_id": 48912261, "comment_id": 84837112, "body": "Minor nitpick: you cannot use printf() inside a signal handler, it is not async-safe. (it uses malloc, internally)"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 1, "creation_date": 1519323651, "post_id": 48912261, "comment_id": 84875747, "body": "I tried this: have <code>inside</code> call clone again, <code>clone(..., SIGCHLD)</code>, and do the setrlimit and loop in that second task. And things work! So I looked for anything that might explain if init, even in a pid namespace, is treated specially. I found this stackoverflow question, <a href=\"https://stackoverflow.com/questions/21031537/sigkill-init-process-pid-1\">SIGKILL init process (PID 1)</a>, which explains all we&#39;ve seen. &quot;the kernel will not deliver any fatal signal to init, and SIGKILL is not excepted. Applying ptrace(2) (the system call that strace uses) to process 1 apparently disables this protection.&quot;"}, {"owner": {"reputation": 11, "user_id": 4271862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c45d3ca7570bb200bee96b3bdc6701d?s=128&d=identicon&r=PG&f=1", "display_name": "nikola12345", "link": "https://stackoverflow.com/users/4271862/nikola12345"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1519332923, "post_id": 48912261, "comment_id": 84880839, "body": "@MarkPlotnick Ok, this pretty much resolves the problem, although we do not know if this is intended behaviour with ptrace. Thanks!"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1519416341, "post_id": 48912261, "comment_id": 84917621, "body": "How is the program becoming PID 1?"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1519429448, "post_id": 48912261, "comment_id": 84922471, "body": "@Barmar CLONE_NEWPID"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1519429582, "post_id": 48912261, "comment_id": 84922506, "body": "@MarkPlotnick Ahh, that&#39;s a new feature to me, didn&#39;t know about process namespaces."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1519477689, "post_id": 48912261, "comment_id": 84932173, "body": "loop is too short, incrementing integer 3e9 times is a very fast computation..."}], "owner": {"reputation": 11, "user_id": 4271862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c45d3ca7570bb200bee96b3bdc6701d?s=128&d=identicon&r=PG&f=1", "display_name": "nikola12345", "link": "https://stackoverflow.com/users/4271862/nikola12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519237569, "creation_date": 1519234954, "last_edit_date": 1519237569, "question_id": 48912261, "link": "https://stackoverflow.com/questions/48912261/linux-setrlimit-doesnt-kill-process", "title": "Linux setrlimit() doesn&#39;t kill process", "body": "<p>From man page of <code>setrlimit</code>, when <code>RLIMIT_CPU</code> limit is set, process should receive <code>SIGXCPU</code> every second once the soft limit is reached, and <code>SIGKILL</code> when the hard limit is reached.</p>\n\n<p>I have the following code where the child process is created using <code>clone()</code> call. Then <code>RLIMIT_CPU</code> is set followed by long loop, which should be terminated via <code>SIGKILL</code>. This seems to work with <code>SIGCHLD</code> flag set. However, when I use <code>SIGCHLD | CLONE_NEWPID</code> flags, the loop doesn't terminate.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>What happens on my machine: program writes <code>pid 1 interrupted</code> two times, and then execution freezes (loop is running and isn't killed) until loop is finished. This lasts about 10 seconds. When I remove <code>CLONE_NEWPID</code> program terminates after 3 seconds.</p>\n\n<pre><code>#define _GNU_SOURCE\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;strings.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;sys/resource.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sched.h&gt;\n\nint inside(void *arg)\n{\n    struct rlimit r = {1, 3};\n    setrlimit(RLIMIT_CPU, &amp;r);\n    for (long long i = 0; i &lt; 3e9; i++);\n    return 0;\n}\n\nvoid handler(int signal)\n{\n    printf(\"pid %d interrupted\\n\", getpid());\n    fflush(stdout);\n}\n\nvoid setup_signals(void)\n{\n    struct sigaction s;\n    bzero(&amp;s, sizeof s);\n    s.sa_handler = handler;\n    sigaction(SIGXCPU, &amp;s, NULL);\n}\n\nint main(void)\n{\n    const int stack_size = 1 &lt;&lt; 16;\n    char stack[stack_size];\n    setup_signals();\n    int pid = clone(inside, stack + stack_size, SIGCHLD | CLONE_NEWPID, NULL);\n    if (pid &lt; 0) return 1;\n    wait(NULL);\n    return 0;\n}\n</code></pre>\n\n<p>Why the child process is not killed (it gets killed if you remove <code>CLONE_NEWPID</code>)?</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 5, "creation_date": 1519234309, "post_id": 48911977, "comment_id": 84830432, "body": "<code>sscanf()</code> returns the number of specified values it successfully scans.   To understand why you&#39;re getting segfaults, you&#39;ll need to provide representative code."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1519234714, "post_id": 48911977, "comment_id": 84830657, "body": "It think that in general using <code>sscanf()</code> to parse a line from a file should not be done, but in fact you can do something like <code>switch (sscanf(line, &quot;%c%d%d&quot;, &amp;character, &amp;integers[0], &amp;integers[1])) { case 1: &#47;* just the first char *&#47; break; case 2: &#47;* first char and a single integer *&#47; break; case 3: &#47;* full set of items *&#47; break;</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1519235529, "post_id": 48911977, "comment_id": 84831106, "body": "For the general case where there isn&#39;t a small upper bound on the number of values on a line, consider the techniques in <a href=\"https://stackoverflow.com/questions/3975236/how-to-use-sscanf-in-loops\">Using <code>sscanf()</code> in a loop</a>."}], "answers": [{"comments": [{"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1519234421, "post_id": 48912077, "comment_id": 84830499, "body": "@Peter It in fact reads multiple characters, determined by the with. One is the default."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519234651, "post_id": 48912077, "comment_id": 84830617, "body": "@Kaz is correct. The confusing thing is that it has different semantincs than with <code>printf()</code> specifier."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1519234663, "post_id": 48912077, "comment_id": 84830625, "body": "@Kaz - you haven&#39;t specified width.  For <code>%c</code> as is, the width defaults to <code>1</code>."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1519235108, "post_id": 48912077, "comment_id": 84830891, "body": "@Peter Thanks for pointing that out, but I feel that since I already said that the width defaults to one in the very first revision of my answer, and in a comment replying to you, the topic of &quot;<code>%c</code> width defaults to one&quot; has now been beat to death.  Perhaps it is so momentous that it bears repetition?"}, {"owner": {"reputation": 3, "user_id": 7811446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6287c8585f6fc2db94ec3e3c6d4cb6?s=128&d=identicon&r=PG&f=1", "display_name": "Megan Peeler", "link": "https://stackoverflow.com/users/7811446/megan-peeler"}, "edited": false, "score": 0, "creation_date": 1519235244, "post_id": 48912077, "comment_id": 84830961, "body": "Thanks very much-- I had an issue with a pointer as well but this definitely clarified the function for me and I was able to fix the problem and store the variables properly."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "reply_to_user": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1519239361, "post_id": 48912077, "comment_id": 84833149, "body": "@coderredoc  <code>%c</code> is sometimes used for extracting a field (as a string) when the leading-whitespace-skipping behavior of <code>%s</code> is undesirable.  You zero-fill the target array; e.g. <code>char field[64] = { 0 }</code> and read no more than one less, which ensures null termination."}], "tags": [], "owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "is_accepted": true, "score": 2, "last_activity_date": 1519234733, "last_edit_date": 1519234733, "creation_date": 1519234269, "answer_id": 48912077, "question_id": 48911977, "link": "https://stackoverflow.com/questions/48911977/using-sscanf-for-an-unknown-number-of-variables/48912077#48912077", "title": "Using sscanf for an unknown number of variables", "body": "<p><code>sscanf</code> is probably up to this task, depending on the exact requirements and ranges of inputs.</p>\n\n<p>The key here is is that the <code>scanf</code> family functions returns a useful value which indicates how many conversions were made. This can be less than zero: the value <code>EOF</code> (a negative value) can be returned if the end of the input occurs or an I/O error, before the first conversion is even attempted.</p>\n\n<p>Note that the <code>%c</code> conversion specifier doesn't produce a null-terminated string. By default, it reads only one character and stores it through the argument pointer. E.g.</p>\n\n<pre><code>char ch;\nsscanf(\"abc\", \"%c\", &amp;ch);\n</code></pre>\n\n<p>this will write the character <code>'a'</code> into <code>ch</code>.</p>\n\n<p>Unless you have an iron-clad assurance that the first field is always one character wide, it's probably better to read it as a string with <code>%s</code>. Always use a maximum width with <code>%s</code> not to overflow the destination buffer. For instance:</p>\n\n<pre><code>char field1[64]; /* one larger than field width, for terminating null */\nsscanf(..., \"%63s\", field1, ...);\n</code></pre>\n\n<p><code>sscanf</code> doesn't perform any overflow checks on integers. If <code>%d</code> is used to scan a large negative or positive value that doesn't fit into <code>int</code>, the behavior is simply undefined according to ISO C. So, just like with <code>%s</code>, <code>%d</code> is best used with a field width limitation. For instance, <code>%4d</code> for reading a four digit year. Four decimal digits will not overflow <code>int</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 7811446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6287c8585f6fc2db94ec3e3c6d4cb6?s=128&d=identicon&r=PG&f=1", "display_name": "Megan Peeler", "link": "https://stackoverflow.com/users/7811446/megan-peeler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1351, "favorite_count": 0, "accepted_answer_id": 48912077, "answer_count": 1, "score": 0, "last_activity_date": 1519235099, "creation_date": 1519233963, "last_edit_date": 1519235099, "question_id": 48911977, "link": "https://stackoverflow.com/questions/48911977/using-sscanf-for-an-unknown-number-of-variables", "title": "Using sscanf for an unknown number of variables", "body": "<p>For a school assignment, I have to read in a string that has at least one but up to three variables(named command, one, and two). There is always a character at the beginning of the string, but it may or may not be followed by integers. The format could be like any of the following:</p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>i 5 17 \ni 3\np\nd 4\n</code></pre>\n\n<p>I am using fgets to read the string from the file, but I'm having trouble processing it. I've been trying to use sscanf, but I'm getting segfaults reading in a string that only has one or two variables instead of three. </p>\n\n<ul>\n<li>Is there a different function I should be using? </li>\n<li>Or is there a way to format sscanf to do what I need? </li>\n</ul>\n\n<p>I've tried <code>sscanf(buffer, \"%c %d %d\", command, one, two)</code> and several variations with no luck.</p>\n"}, {"tags": ["c", "memory-leaks", "gtk", "valgrind", "gtk2"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1519234911, "post_id": 48911820, "comment_id": 84830780, "body": "You need <code>G_DEBUG=gc-friendly</code> and <code>G_SLICE=always-malloc</code> in order for valgrind to work correctly with <code>GObject</code>. <a href=\"https://stackoverflow.com/a/48911999/1983495\">This answer also has some useful information</a>."}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 1, "creation_date": 1519291530, "post_id": 48911820, "comment_id": 84853680, "body": "Please please please, unless you really have a very good reason to do so (like maintaining a big and old application not worth migrating), don&#39;t use GTK+ 2. GTK+ 3 has been around for 7 years (!) and GTK+ 4 is likely to be released in 2019."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4918296"}, "reply_to_user": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1519318180, "post_id": 48911820, "comment_id": 84872617, "body": "@liberforce I will probably migrate the program to GTK+ 3. The reason I started with GTK+2 is simply because Slackware shipped Glade with a version that works with GTK+2."}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1519380046, "post_id": 48911820, "comment_id": 84897003, "body": "On distributions, glade is often packaged as <code>glade</code> or <code>glade3</code>, one version being for GTK+ 2, the other for GTK+ 3. What is tricky is that <code>glade3</code> is for GTK+ 2 (version &lt;= 3.8) and <code>glade</code> for GTK+ 3 (version &gt; 3.8) as shown on the <a href=\"https://glade.gnome.org/sources.html\" rel=\"nofollow noreferrer\">glade website</a>. So you should be able to find <a href=\"https://slackbuilds.org/result/?search=glade&amp;sv=\" rel=\"nofollow noreferrer\">glade for slackware</a>."}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519234093, "post_id": 48911999, "comment_id": 84830317, "body": "This might be true but <a href=\"https://stackoverflow.com/a/25342421/1983495\">valgrind will still report errors</a>."}, {"owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519234375, "post_id": 48911999, "comment_id": 84830481, "body": "@IharobAlAsimi maybe we should change tags to Valgrind instead of Gtk :/"}], "tags": [], "owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "is_accepted": false, "score": 2, "last_activity_date": 1519234920, "last_edit_date": 1519234920, "creation_date": 1519234021, "answer_id": 48911999, "question_id": 48911820, "link": "https://stackoverflow.com/questions/48911820/properly-deallocating-a-gtkbuilder-object/48911999#48911999", "title": "Properly deallocating a GtkBuilder Object", "body": "<p>After \"unreferencing\",  and since you didn't increase the reference count, i.e, the reference count has dropped to 0, then the object its freed. Using <code>g_free()</code> afterwards will be an error.</p>\n\n<p>From the <a href=\"https://developer.gnome.org/gobject/stable/gobject-The-Base-Object-Type.html#g-object-unref\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p><code>g_object_unref ()</code></p>\n  \n  <p><code>void g_object_unref (gpointer object)</code>;</p>\n  \n  <p>Decreases the reference count of object . <strong>When its reference count\n  drops to 0, the object is finalized (i.e. its memory is freed).</strong></p>\n  \n  <p>If the pointer to the <code>GObject</code> may be reused in future (for example, if\n  it is an instance variable of another object), it is recommended to\n  clear the pointer to <code>NULL</code> rather than retain a dangling pointer to a\n  potentially invalid <code>GObject</code> instance. Use <code>g_clear_object ()</code> for this.</p>\n</blockquote>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4918296"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1519291703, "creation_date": 1519233439, "last_edit_date": 1519291703, "question_id": 48911820, "link": "https://stackoverflow.com/questions/48911820/properly-deallocating-a-gtkbuilder-object", "title": "Properly deallocating a GtkBuilder Object", "body": "<p>I have the following GTK+ program</p>\n\n<pre><code>////////////////////////////////////////////////////\n// Example can be compiled with:\n// gcc gui.c `pkg-config --cflags --libs gtk+-2.0`\n//\n// GUI file from glade must be in same folder from\n// which the compiled binary is called.\n////////////////////////////////////////////////////\n\n#include &lt;gtk/gtk.h&gt;\n\nint main(int argc, char *argv[]) {\n    GtkBuilder *gtkBuilder = gtk_builder_new();\n\n    gtk_init(&amp;argc, &amp;argv);\n\n    gtk_builder_add_from_file(gtkBuilder, \"../gui.glade\", NULL);\n\n    gtk_builder_connect_signals(gtkBuilder, NULL);\n\n    gtk_widget_show(GTK_WIDGET(gtk_builder_get_object(gtkBuilder, \"main\")));\n\n    g_object_unref(G_OBJECT(gtkBuilder));\n\n//  g_free(gtkBuilder);\n\n    gtk_main();\n\n    return 0;\n}\n</code></pre>\n\n<p>and the corresponding XML Glade file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;interface&gt;\n  &lt;requires lib=\"gtk+\" version=\"2.24\"/&gt;\n  &lt;!-- interface-naming-policy project-wide --&gt;\n  &lt;object class=\"GtkWindow\" id=\"main\"&gt;\n    &lt;property name=\"width_request\"&gt;400&lt;/property&gt;\n    &lt;property name=\"height_request\"&gt;300&lt;/property&gt;\n    &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n    &lt;property name=\"default_width\"&gt;690&lt;/property&gt;\n    &lt;property name=\"default_height\"&gt;500&lt;/property&gt;\n    &lt;signal name=\"destroy\" handler=\"gtk_main_quit\" swapped=\"no\"/&gt;\n    &lt;child&gt;\n      &lt;placeholder/&gt;\n    &lt;/child&gt;\n  &lt;/object&gt;\n&lt;/interface&gt;\n</code></pre>\n\n<p>When I compile and run a memory check with Valgrind then it complains that the memory allocated for <code>GtkBuilder</code> is <em>possibly</em> lost. When I uncomment the <code>g_free()</code> instruction I get an error about an invalid call to <code>free()</code>.</p>\n\n<p>I know that the GTK+ framework itself has some leaks, i.e., it does not deallocate resources which it needs throughout its entire lifetime. Is <code>GtkBuilder</code> one of those resources that will be \"leaked\" or is there a way to release it properly without Valgrind complaining about it?</p>\n"}, {"tags": ["c", "obfuscation"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 4, "creation_date": 1519232203, "post_id": 48911360, "comment_id": 84829092, "body": "these macros just replace one thing with another - not hard to follow it through to see how"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1519232322, "post_id": 48911360, "comment_id": 84829176, "body": "Look up &quot;token pasting&quot;."}, {"owner": {"reputation": 169, "user_id": 4960856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/805862e7b973bcafed2b679209d54cfd?s=128&d=identicon&r=PG&f=1", "display_name": "hafeez", "link": "https://stackoverflow.com/users/4960856/hafeez"}, "edited": false, "score": 0, "creation_date": 1519232706, "post_id": 48911360, "comment_id": 84829417, "body": "It is just a macro with arguments gluing some of the arguments to form a string and not using the others to confuse the reader."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1519236024, "post_id": 48911360, "comment_id": 84831408, "body": "This is not useful to future SO users/visitors."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1533161439, "post_id": 48911360, "comment_id": 90250224, "body": "@MartinJames <a href=\"https://stackoverflow.com/questions/51641847/how-does-this-c-program-compile-and-run-there-is-no-main-and-the-macros-are-ve\">Wrong!</a>"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 4069072, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AGQeS.jpg?s=128&g=1", "display_name": "Fahad", "link": "https://stackoverflow.com/users/4069072/fahad"}, "edited": false, "score": 0, "creation_date": 1519322236, "post_id": 48911473, "comment_id": 84875027, "body": "Thanks for explaining. What is this technique called?"}], "tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": true, "score": 5, "last_activity_date": 1545505009, "last_edit_date": 1545505009, "creation_date": 1519232403, "answer_id": 48911473, "question_id": 48911360, "link": "https://stackoverflow.com/questions/48911360/obfuscate-c-code/48911473#48911473", "title": "Obfuscate C code", "body": "<p><code>_</code> is replaced by <code>____(m,i,n,u,a,l,s)</code></p>\n\n<p><code>____(m,i,n,u,a,l,s)</code> which is filtered through the macro <code>____(i,s,o,g,r,a,m)(i##r##s##o)</code></p>\n\n<p><code>i##r##s##o</code> pastes the arguments <code>i, r, s, o</code> together to form text.  <code>i = m</code>, <code>r = a</code>, <code>s = i</code>, <code>o = n</code>, thus you get <code>main</code></p>\n\n<p>This technique is called 'token pasting'.  It is not something you'll use everyday, but there are times where it can be very useful.  See GCC's <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Concatenation.html\" rel=\"nofollow noreferrer\">documentation</a> on token pasting.</p>\n"}], "owner": {"reputation": 49, "user_id": 4069072, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AGQeS.jpg?s=128&g=1", "display_name": "Fahad", "link": "https://stackoverflow.com/users/4069072/fahad"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "closed_date": 1519242332, "accepted_answer_id": 48911473, "answer_count": 1, "score": -4, "last_activity_date": 1545505009, "creation_date": 1519232092, "last_edit_date": 1519323631, "question_id": 48911360, "link": "https://stackoverflow.com/questions/48911360/obfuscate-c-code", "closed_reason": "Needs details or clarity", "title": "Obfuscate C code", "body": "<p>I came across this obfuscated code recently: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define _____(i,s,o,g,r,a,m)(i##r##s##o)\n#define _ _____(m,i,n,u,a,l,s)\n\nint _()\n{\n    printf(\"Hello World!\");\n    return 0;\n}\n</code></pre>\n\n<p>What is happening here? How is it that <code>_()</code> is <code>main()</code>?</p>\n\n<p>Edit:\nI was looking for the 'technical term' that has been used here.</p>\n"}, {"tags": ["c", "flowchart"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519229157, "post_id": 48910318, "comment_id": 84826892, "body": "Flowcharts are &quot;<i>languageless</i>&quot; or at least they should be. I think you need to understand what a flowchart is before searching for one on the internet and &quot;<i>translating</i>&quot; it."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 2, "creation_date": 1519229433, "post_id": 48910318, "comment_id": 84827054, "body": "Possibly C# where <code>&quot;C{0}\\t&quot;,i+1</code> is an output format mask and its interpolated value."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1519230982, "post_id": 48910318, "comment_id": 84828216, "body": "It&#39;s almost certainly some sort of typo.  As such, it is nigh on impossible for us to determine what should be there.  The context for the flowchart might disambiguate it, but otherwise, there&#39;s not much hope.  It appears to be something to do with printing headings; it might be intended to be some sort of subscripted column name, but the dashes are peculiar (they normally need to be on the next line, not the same line, so the flowchart seems misguided on that score).  Unless it is a classroom exercise, skip it and move onto another.  If it is a classroom exercise, consult the teacher."}, {"owner": {"reputation": 9070, "user_id": 79591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rFGtY.jpg?s=128&g=1", "display_name": "GrahamS", "link": "https://stackoverflow.com/users/79591/grahams"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1519239622, "post_id": 48910318, "comment_id": 84833269, "body": "@JonathanLeffler the dashes get put out at the end in the \u201cSum\u201d box. I think the idea is to draw a line across that is 8 dashes per column."}, {"owner": {"reputation": 6514, "user_id": 3540161, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1c13eac0931a8095e04bcfeaaed371e8?s=128&d=identicon&r=PG", "display_name": "Rolf", "link": "https://stackoverflow.com/users/3540161/rolf"}, "edited": false, "score": 0, "creation_date": 1519243364, "post_id": 48910318, "comment_id": 84835266, "body": "To me it is not clear what you are trying to accomplish here. If you are writing a random flowchart parser it might be a bit impractical to try to parse arbitrary text from arbitrary flowcharts around the net. The code below looks a bit like .Net but that&#39;s a guess."}, {"owner": {"reputation": 316, "user_id": 7389293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wWgS5.png?s=128&g=1", "display_name": "carloswm85", "link": "https://stackoverflow.com/users/7389293/carloswm85"}, "reply_to_user": {"reputation": 9070, "user_id": 79591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rFGtY.jpg?s=128&g=1", "display_name": "GrahamS", "link": "https://stackoverflow.com/users/79591/grahams"}, "edited": false, "score": 0, "creation_date": 1519258470, "post_id": 48910318, "comment_id": 84841701, "body": "I have more flowcharts from the same exercise sheet. I think they are all related. Is it a good idea to add the previous and the next flowcharts to this one so you can have a better landscape of the exercise?  I think that @GrahamS is likely pointing out the best possibility. The previous flowchart describes a program that makes a chart with not-fixed columns and rows."}, {"owner": {"reputation": 316, "user_id": 7389293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wWgS5.png?s=128&g=1", "display_name": "carloswm85", "link": "https://stackoverflow.com/users/7389293/carloswm85"}, "edited": false, "score": 0, "creation_date": 1519301551, "post_id": 48910318, "comment_id": 84860319, "body": "The answer to the meaning of &quot;C{0}\\t&quot; can be found <a href=\"https://stackoverflow.com/questions/530539/what-does-0-mean-when-found-in-a-string-in-c\">here</a>. I&#39;ll add what I could program using the hints you gave me guys to end of the initial question. I think I&#39;ve solved it. Thanks for your help, guys."}], "answers": [{"comments": [{"owner": {"reputation": 316, "user_id": 7389293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wWgS5.png?s=128&g=1", "display_name": "carloswm85", "link": "https://stackoverflow.com/users/7389293/carloswm85"}, "edited": false, "score": 0, "creation_date": 1519258634, "post_id": 48910481, "comment_id": 84841749, "body": "Probably C1 is column 1, and so on. I think that the flowchart is showing how to add headers to a chart. I will try to make it work in C and I will let you know my results. Thanks, pal."}], "tags": [], "owner": {"reputation": 9070, "user_id": 79591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rFGtY.jpg?s=128&g=1", "display_name": "GrahamS", "link": "https://stackoverflow.com/users/79591/grahams"}, "is_accepted": true, "score": 0, "last_activity_date": 1519294891, "last_edit_date": 1519294891, "creation_date": 1519229484, "answer_id": 48910481, "question_id": 48910318, "link": "https://stackoverflow.com/questions/48910318/what-is-the-meaning-of-c0-t-in-flowchart-flowchart-in-unknown-programming/48910481#48910481", "title": "What is the meaning of &quot;C{0}\\t&quot; in flowchart? (flowchart in unknown programming language, for implementation in C)", "body": "<p>I think <code>{0}</code> is intended as a placeholder for the 0th argument after the quotes. So..</p>\n\n<pre><code>\"C{0}\\t\", i+1\n</code></pre>\n\n<p>Produces \u201cC1\u201d then \u201cC2\u201d then \u201cC3\u201d etc separated by tab characters (<code>\\t</code>)</p>\n\n<p>The equivalent in C would be:</p>\n\n<pre><code>printf(\"C%d\\t\", i+1);\n</code></pre>\n"}], "owner": {"reputation": 316, "user_id": 7389293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wWgS5.png?s=128&g=1", "display_name": "carloswm85", "link": "https://stackoverflow.com/users/7389293/carloswm85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "closed_date": 1519243232, "accepted_answer_id": 48910481, "answer_count": 1, "score": 0, "last_activity_date": 1519302048, "creation_date": 1519228964, "last_edit_date": 1519302048, "question_id": 48910318, "link": "https://stackoverflow.com/questions/48910318/what-is-the-meaning-of-c0-t-in-flowchart-flowchart-in-unknown-programming", "closed_reason": "Needs more focus", "title": "What is the meaning of &quot;C{0}\\t&quot; in flowchart? (flowchart in unknown programming language, for implementation in C)", "body": "<p>I'm writing flowcharts in C. And I've come across with the printable value \"C{0}\\t\". It's in the fifth box.</p>\n\n<p>I got the flowchart from the internet. So I don't have means to ask the person who made it for additional information. I think that the flowchart is not intended to be used in a C programming class, but in another language, which I don't know.</p>\n\n<p>Any idea what is the meaning? How could I translate it into C?</p>\n\n<p><a href=\"https://i.stack.imgur.com/Da4vO.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Da4vO.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Do you know what language is? I can find also in the same exercise sheet things like these:</p>\n\n<pre><code>i&lt;array.GetLength(1)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>DisplayLastWithColSums(int[,] array)\n</code></pre>\n\n<p>Thanks in advance.</p>\n\n<hr>\n\n<p>I coded the following solution:</p>\n\n<pre><code>void main ()\n{\n    int i = 0, j = 0, k = 0, col = 10;\n    char sum_dashes[1000] ;\n\n    printf(\"\\n\\t\");\n\n    while (i &lt; col)\n    {\n        printf(\"C%i\\t\", i + 1);\n        i++;\n\n        while (j &lt; 8)\n        {\n            sum_dashes[k] = '-';\n            k++;\n            j++;\n        }\n\n        j = 0;\n\n    }\n\n    printf(\"\\n\\t\");\n    for (i = 0; i &lt; k; i++)\n    {\n        printf(\"%c\", sum_dashes[i]);\n    }\n\n\n}\n</code></pre>\n\n<p>That prints out the next result:</p>\n\n<pre><code>    C1    C2    C3    C4    C5    C6\n    ------------------------------------\n</code></pre>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1519228688, "post_id": 48910205, "comment_id": 84826543, "body": "If you don&#39;t want to calculate it, print something after every <code>fork</code> when it returns a number greater than 0"}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1519228688, "post_id": 48910205, "comment_id": 84826544, "body": "Why don&#39;t you just run it and check?"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1519228900, "post_id": 48910205, "comment_id": 84826700, "body": "You have that hypothesis and yet must have ignored it to get the answer 8..."}, {"owner": {"reputation": 19, "user_id": 9391920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e685495ea1ed4ab8ba9b6fbdce26d5c?s=128&d=identicon&r=PG&f=1", "display_name": "Yabatter95", "link": "https://stackoverflow.com/users/9391920/yabatter95"}, "edited": false, "score": 0, "creation_date": 1519229461, "post_id": 48910205, "comment_id": 84827078, "body": "I tried . And i get that (a part the main parent process) 15 processes are created . Is it correct ?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1519236258, "post_id": 48910205, "comment_id": 84831546, "body": "@Yabatter95 Is it correct?  Who knows - it&#39;s your code, you tell us."}], "answers": [{"comments": [{"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "edited": false, "score": 0, "creation_date": 1519236758, "post_id": 48910256, "comment_id": 84831806, "body": "Thanks for the very constructive downvote."}], "tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": false, "score": 0, "last_activity_date": 1519229465, "last_edit_date": 1519229465, "creation_date": 1519228756, "answer_id": 48910256, "question_id": 48910205, "link": "https://stackoverflow.com/questions/48910205/determine-the-number-of-child-processes-created-by-fork/48910256#48910256", "title": "Determine the number of child processes created by fork()", "body": "<p>Since <code>fork()</code> returns <code>0</code> in the child process, by printing a line for every child process that is created by <code>fork()</code> you can simply count the number of children that were created:</p>\n\n<pre><code>for (i = 0; i &lt; 4; i++) {\n    if (!fork()) {\n        printf(\"child created\\n\");\n        fflush(stdout);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9391920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e685495ea1ed4ab8ba9b6fbdce26d5c?s=128&d=identicon&r=PG&f=1", "display_name": "Yabatter95", "link": "https://stackoverflow.com/users/9391920/yabatter95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1049, "favorite_count": 0, "closed_date": 1519228950, "answer_count": 1, "score": 1, "last_activity_date": 1519236506, "creation_date": 1519228611, "last_edit_date": 1519236506, "question_id": 48910205, "link": "https://stackoverflow.com/questions/48910205/determine-the-number-of-child-processes-created-by-fork", "closed_reason": "Duplicate", "title": "Determine the number of child processes created by fork()", "body": "<p>We have this code in C, it creates child processes.</p>\n\n<p>The question is how many processes are created ?\nI calculated 8 processes, my friend 12. Who is right ?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main() {\n    int i;\n\n  for ( i = 0 ; i &lt; 4 ; i++ ) {\n      fork();\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>My hyphotesis is that the stack is copied from parent to child and every child resumes parent's code in the same point where it stopped.</p>\n"}, {"tags": ["c", "parallel-processing", "opencl", "pi", "approximation"], "answers": [{"comments": [{"owner": {"reputation": 100, "user_id": 7161699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/111732b50d5c4354076c6d2eaf17e985?s=128&d=identicon&r=PG&f=1", "display_name": "BodneyC", "link": "https://stackoverflow.com/users/7161699/bodneyc"}, "edited": false, "score": 0, "creation_date": 1519295332, "post_id": 48923488, "comment_id": 84856257, "body": "I completely blanked on the fact that the local barrier will have no effect on <code>space[]</code>. I&#39;ll split the function to get it working as you suggested, thanks for the answer."}, {"owner": {"reputation": 5977, "user_id": 1745695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b932c5253c45af61dc443fbc1b9c935c?s=128&d=identicon&r=PG", "display_name": "Dithermaster", "link": "https://stackoverflow.com/users/1745695/dithermaster"}, "edited": false, "score": 0, "creation_date": 1519476034, "post_id": 48923488, "comment_id": 84931737, "body": "Also, having <code>barrier</code> inside a conditional like that won&#39;t work correctly. The rules for barrier are that every work item in a work group must hit it. With the conditional you have, they won&#39;t."}], "tags": [], "owner": {"reputation": 46, "user_id": 9135439, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_bq0HCMNfBE/AAAAAAAAAAI/AAAAAAAAACg/HrIgY9GhsCI/photo.jpg?sz=128", "display_name": "Timur Magomedov", "link": "https://stackoverflow.com/users/9135439/timur-magomedov"}, "is_accepted": true, "score": 0, "last_activity_date": 1519290797, "creation_date": 1519290797, "answer_id": 48923488, "question_id": 48909359, "link": "https://stackoverflow.com/questions/48909359/opencl-c-leibniz-formula-for-pi/48923488#48923488", "title": "OpenCL, C - Leibniz Formula for Pi", "body": "<p>Maybe these are not most critical issues with the code but they can be the source of problem:</p>\n\n<ol>\n<li>You definetly should use <code>barrier(CLK_LOCAL_MEM_FENCE);</code> before local reduction. This can be avoided if only you know that work group size is equal or smaller than number of threads in wavefront running same instruction in parallel - 64 for AMD GPUs, 32 for NVidia GPUs.</li>\n<li>Global reduction must be done in multiple launches of kernel because <code>barrier()</code> works for work items of same work group only. Clear and 100% working way to insert a barrier into kernel is splittion it in two in the place where global barier is needed.</li>\n</ol>\n"}], "owner": {"reputation": 100, "user_id": 7161699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/111732b50d5c4354076c6d2eaf17e985?s=128&d=identicon&r=PG&f=1", "display_name": "BodneyC", "link": "https://stackoverflow.com/users/7161699/bodneyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 48923488, "answer_count": 1, "score": 0, "last_activity_date": 1519290797, "creation_date": 1519226115, "question_id": 48909359, "link": "https://stackoverflow.com/questions/48909359/opencl-c-leibniz-formula-for-pi", "title": "OpenCL, C - Leibniz Formula for Pi", "body": "<p>I'm trying to get some experience with <strong>OpenCL</strong>, the environment is setup and I can create and execute kernels. I am currently trying to compute pi in parallel using the <strong>Leibniz formula</strong> but have been receiving some strange results.</p>\n\n<p>The kernel is as follow: </p>\n\n<pre><code>__kernel void leibniz_cl(__global float *space, __global float *result, int chunk_size) \n{\n    __local float pi[THREADS_PER_WORKGROUP];\n    pi[get_local_id(0)] = 0.;\n\n    for (int i = 0; i &lt; chunk_size; i += THREADS_PER_WORKGROUP) {\n        // `idx` is the work item's `i` in the grander scheme\n        int idx = (get_group_id(0) * chunk_size) + get_local_id(0) + i;\n        float idx_f = 1 / ((2 * (float) idx) + 1);\n\n        // Make the fraction negative if needed\n        if(idx &amp; 1)\n            idx_f = -idx_f;\n\n        pi[get_local_id(0)] += idx_f;\n    }\n\n    // Reduction within workgroups (in `pi[]`)\n    for(int groupsize = THREADS_PER_WORKGROUP / 2; groupsize &gt; 0; groupsize &gt;&gt;= 1) { \n        if (get_local_id(0) &lt; groupsize) \n            pi[get_local_id(0)] += pi[get_local_id(0) + groupsize];\n\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n</code></pre>\n\n<p>If I end the function here and set <code>result</code> to <code>pi[get_local_id(0)]</code> for <code>!get_global_id(0)</code> (as in the reduction for the first group), printing <code>result</code> prints <code>-nan</code>.</p>\n\n<p>Remainder of kernel:</p>\n\n<pre><code>    // Reduction amongst workgroups (into `space[]`)\n    if(!get_local_id(0)) {\n        space[get_group_id(0)] = pi[get_local_id(0)];\n\n        for(int groupsize = get_num_groups(0) / 2; groupsize &gt; 0; groupsize &gt;&gt;= 1) { \n            if(get_group_id(0) &lt; groupsize)\n                space[get_group_id(0)] += space[get_group_id(0) + groupsize];\n\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n\n    barrier(CLK_LOCAL_MEM_FENCE);\n\n    if(get_global_id(0) == 0)\n        *result = space[get_group_id(0)] * 4;\n}\n</code></pre>\n\n<p>Returning <code>space[get_group_id(0)] * 4</code> returns either <code>-nan</code> or a very large number which clearly is not an approximation of pi.</p>\n\n<p>I can't decide if it is an OpenCL concept I'm missing or a parallel execution one in general. Any help is appreciated.</p>\n\n<p><strong>Links</strong></p>\n\n<p>Reduction template: <a href=\"https://stackoverflow.com/questions/20613013/opencl-float-sum-reduction#20614016\">OpenCL float sum reduction</a></p>\n\n<p>Leibniz Formula: <a href=\"https://www.wikiwand.com/en/Leibniz_formula_for_%CF%80\" rel=\"nofollow noreferrer\">https://www.wikiwand.com/en/Leibniz_formula_for_%CF%80</a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1519223176, "post_id": 48908303, "comment_id": 84822452, "body": "<a href=\"https://stackoverflow.com/a/38325926/2173917\"><code>fflush(stdin);</code> is undefined behavior, don&#39;t do it.</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1519223197, "post_id": 48908303, "comment_id": 84822466, "body": "<code>scanf(&quot;%ld&quot;,&amp;num)</code> is undefined behavior too, as <code>num</code> is <code>int</code>."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 5, "creation_date": 1519223268, "post_id": 48908303, "comment_id": 84822519, "body": "You seem to have overflowed the <code>int</code> value."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519223273, "post_id": 48908303, "comment_id": 84822527, "body": "<i>Can you guys tell me how to get the real result</i> - use calculator? Or pen-and-paper?"}, {"owner": {"reputation": 38927, "user_id": 279313, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4ab0299c28ce807a9ca21041ed6ef085?s=128&d=identicon&r=PG", "display_name": "Alex F", "link": "https://stackoverflow.com/users/279313/alex-f"}, "edited": false, "score": 0, "creation_date": 1519223409, "post_id": 48908303, "comment_id": 84822643, "body": "scanf(&quot;%d&quot;,&amp;num);"}, {"owner": {"reputation": 100, "user_id": 3668810, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001586968649/picture?type=large", "display_name": "berendeanicolae", "link": "https://stackoverflow.com/users/3668810/berendeanicolae"}, "edited": false, "score": 0, "creation_date": 1519223477, "post_id": 48908303, "comment_id": 84822692, "body": "<code>num</code> has to be <code>long long</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 100, "user_id": 3668810, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001586968649/picture?type=large", "display_name": "berendeanicolae", "link": "https://stackoverflow.com/users/3668810/berendeanicolae"}, "edited": false, "score": 0, "creation_date": 1519223501, "post_id": 48908303, "comment_id": 84822711, "body": "@berendeanicolae Why?"}, {"owner": {"reputation": 100, "user_id": 3668810, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001586968649/picture?type=large", "display_name": "berendeanicolae", "link": "https://stackoverflow.com/users/3668810/berendeanicolae"}, "edited": false, "score": 0, "creation_date": 1519223580, "post_id": 48908303, "comment_id": 84822768, "body": "because when you multiply int values, the result is calculated in a temporary int variable. then for the assignment a cast to long long occurs. but the result which does not fit in int was already computed so an overflow will happen"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 100, "user_id": 3668810, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001586968649/picture?type=large", "display_name": "berendeanicolae", "link": "https://stackoverflow.com/users/3668810/berendeanicolae"}, "edited": false, "score": 0, "creation_date": 1519223642, "post_id": 48908303, "comment_id": 84822823, "body": "@berendeanicolae So casting will be sufficient. The <code>num</code> itself is likely not overflowing (well, it&#39;s an assumption one should check)."}, {"owner": {"reputation": 17, "user_id": 9009893, "user_type": "registered", "profile_image": "https://graph.facebook.com/939731469516940/picture?type=large", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9009893/kenny"}, "reply_to_user": {"reputation": 100, "user_id": 3668810, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001586968649/picture?type=large", "display_name": "berendeanicolae", "link": "https://stackoverflow.com/users/3668810/berendeanicolae"}, "edited": false, "score": 0, "creation_date": 1519223702, "post_id": 48908303, "comment_id": 84822869, "body": "@berendeanicolae wow bro it work,thanks"}, {"owner": {"reputation": 17, "user_id": 9009893, "user_type": "registered", "profile_image": "https://graph.facebook.com/939731469516940/picture?type=large", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9009893/kenny"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1519223789, "post_id": 48908303, "comment_id": 84822936, "body": "@SouravGhosh bro can you tell me what is undefined behavior ? why cannot use fflush? i just know that one"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1519224627, "post_id": 48908303, "comment_id": 84823599, "body": "@Kenny check the link."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1519225423, "post_id": 48908303, "comment_id": 84824180, "body": "@Kenny Undefined behavior = doing something dangerous that isn&#39;t covered by the C language. Most often, but not always, undefined behavior manifests itself as some sort of severe run-time bug."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519226855, "post_id": 48908303, "comment_id": 84825200, "body": "See also <a href=\"https://stackoverflow.com/a/40637622/2410359\">Why write 1,000,000,000 as 1000*1000*1000</a>"}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1519225055, "post_id": 48908464, "comment_id": 84823917, "body": "Pedantically, <code>UINT64_C</code> gives a literal of type <code>uint_least64_t</code> and not <code>uint64_t</code>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1519226403, "post_id": 48908464, "comment_id": 84824869, "body": "Nice answer (as always). But I would make it clear that <code>(unsigned long long int) num * num * num</code> is only casting the first coefficient. The other two are implicitly converted."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 4, "last_activity_date": 1519225751, "last_edit_date": 1519225751, "creation_date": 1519223500, "answer_id": 48908464, "question_id": 48908303, "link": "https://stackoverflow.com/questions/48908303/c-how-to-print-calculated-numbers-that-have-15-digits/48908464#48908464", "title": "C - How to print calculated numbers that have 15 digits?", "body": "<p>One way to do it is:</p>\n\n<pre><code>#include &lt;inttypes.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    uint64_t x = 99999;\n    printf(\"%\" PRIu64 \"\\n\", x*x*x);\n}\n</code></pre>\n\n<p>You may also be able to do this with <code>unsigned long</code> or <code>unsigned long long</code> types, but these depend on your C implementation (the compiler you are using).</p>\n\n<p>The arithmetic you attempted overflowed the supported range of the <code>int</code> type you were using. When programming, it is important to ensure that the calculations you do will not overflow the range of the types you use.</p>\n\n<p>Additionally, you must be careful about types in C code:</p>\n\n<ul>\n<li><p>When using <code>scanf</code>, match the conversion specifier to the type. For example, when scanning a decimal numeral for an <code>int</code> object, you should use <code>%d</code>, not <code>%ld</code>. <code>%ld</code> is for <code>long int</code>.</p></li>\n<li><p>In <code>unsigned long long int total = num*num*num;</code>, the <code>unsigned long long int</code> affects the type of <code>total</code>. It does not affect the type used in the calculation <code>num*num*num</code>. In that expression, the type of <code>num</code> is used. To use <code>unsigned long long int</code> in the calculation, you would have to convert one or all of the operands to <code>unsigned long long int</code>, as by using a cast: <code>(unsigned long long int) num * num * num</code>.</p></li>\n<li><p>By assigning 99999 to a <code>uint64_t</code> object, which I named <code>x</code>, I ensured that <code>x*x*x</code> was calculated with <code>uint64_t</code> arithmetic. (<code>uint64_t</code> is a 64-bit unsigned integer.) Another way to do this would be with <code>UINT64_C(99999) * UINT64_C(99999) * UINT64_C(99999)</code>. <code>UINT64_C</code> is a macro defined in <code>stdint.h</code> that essentially means \u201ctreat this constant as having type <code>uint64_t</code> or wider (actually <code>uint_least64_t</code>).\u201d This could also be done with <code>UINT64_C(99999) * 99999 * 99999</code> because C will automatically convert the narrower-type integer operands to the wider-type integer operand. It could also be done with <code>(uint64_t) 99999 * 99999 * 99999</code>.</p></li>\n<li><p><code>PRIu64</code> is a macro that provides the right <code>printf</code> conversion specifier for <code>uint64_t</code>. It is defined in <code>inttypes.h</code>.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1519225231, "last_edit_date": 1519225231, "creation_date": 1519224909, "answer_id": 48908960, "question_id": 48908303, "link": "https://stackoverflow.com/questions/48908303/c-how-to-print-calculated-numbers-that-have-15-digits/48908960#48908960", "title": "C - How to print calculated numbers that have 15 digits?", "body": "<p>Bugs:</p>\n\n<ul>\n<li><code>%ld</code> on an <code>int</code> invokes undefined behavior.</li>\n<li><code>fflush(stdin)</code> invokes undefined behavior since stdin is an input stream.</li>\n<li><code>num*num*num</code> is carried out on operands that have type <code>int</code>, so you get overflow if you attempt <code>99999 * 99999 * 99999</code> since this is a larger number than 2<sup>31</sup>-1 (assuming 32 bit <code>int</code>). </li>\n</ul>\n\n<p>Fixed code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int num;\n    printf(\"Insert number : \");\n    scanf(\"%d\",&amp;num); getchar();\n    long long int total = (long long)num*num*num;\n    printf(\"Result : %llu\",total);\n    getchar();\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9009893, "user_type": "registered", "profile_image": "https://graph.facebook.com/939731469516940/picture?type=large", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9009893/kenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 48908464, "answer_count": 2, "score": 1, "last_activity_date": 1533161271, "creation_date": 1519223102, "last_edit_date": 1533161271, "question_id": 48908303, "link": "https://stackoverflow.com/questions/48908303/c-how-to-print-calculated-numbers-that-have-15-digits", "title": "C - How to print calculated numbers that have 15 digits?", "body": "<p>I tried to print the result of <code>99,999 * 99,999 * 99,999</code>, the result should have been <code>999,970,000,299,999</code> but what got printed instead was <code>18446744072244127711</code>. I tried to print <code>20000 * 20000 * 20000</code> and the result was pretty much the same. Can you guys tell me how to get the real result?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int num;\n\n    printf(\"Insert number : \");\n    scanf(\"%ld\", &amp;num);\n\n    fflush(stdin);\n\n    unsigned long long int total = num * num * num;\n    printf(\"Result : %llu\", total);\n\n    getchar();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1519224011, "post_id": 48908272, "comment_id": 84823125, "body": "Probably not the ideal task for <code>sscanf()</code>."}, {"owner": {"reputation": 287, "user_id": 668773, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/szllW.jpg?s=128&g=1", "display_name": "bluscape", "link": "https://stackoverflow.com/users/668773/bluscape"}, "edited": false, "score": 0, "creation_date": 1519225288, "post_id": 48908272, "comment_id": 84824089, "body": "Parsing between the comma&#39;s is a great idea and works well. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519226714, "post_id": 48908962, "comment_id": 84825112, "body": "An alternative to difficult to read formats is to take advantage of <i>string literal</i> concatenation.  <code>#define PFMT &quot;\\&quot;%[^\\&quot;]\\&quot;</code> <code>sscanf(ParamStr, PFMT &quot;,&quot; PFMT &quot;,&quot; PFMT &quot;,&quot; PFMT, ...</code>"}], "tags": [], "owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "is_accepted": true, "score": 4, "last_activity_date": 1519226469, "last_edit_date": 1519226469, "creation_date": 1519224918, "answer_id": 48908962, "question_id": 48908272, "link": "https://stackoverflow.com/questions/48908272/sscanf-how-should-i-handle-this/48908962#48908962", "title": "sscanf - How should I handle this?", "body": "<p>You can use the return value from <code>scanf</code> and use 2 different format strings:</p>\n\n<pre><code>// Try to scan all 4....\nint count = sscanf(ParamStr, \"\\\"%[^\\\"]\\\",\\\"%[^\\\"]\\\",\\\"%[^\\\"]\\\",\\\"%[^\\\"]\\\"\",\n    Param1, Param2, Param3, Param4);\n// Didn't get 4? Try for 3 using a different format string\nif (4 != count) {\n    count = sscanf(ParamStr, \"\\\"%[^\\\"]\\\",\\\"%[^\\\"]\\\",\\\"\\\",\\\"%[^\\\"]\\\"\", \n        Param1, Param2, Param4);\n}\n</code></pre>\n"}], "owner": {"reputation": 287, "user_id": 668773, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/szllW.jpg?s=128&g=1", "display_name": "bluscape", "link": "https://stackoverflow.com/users/668773/bluscape"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 48908962, "answer_count": 1, "score": 1, "last_activity_date": 1519226469, "creation_date": 1519223015, "last_edit_date": 1519223524, "question_id": 48908272, "link": "https://stackoverflow.com/questions/48908272/sscanf-how-should-i-handle-this", "title": "sscanf - How should I handle this?", "body": "<p>I'm trying to parse an ascii string using sscanf. The string looks like this:</p>\n\n<p>\"Param1\",\"Param2\",\"\",\"Param4\"</p>\n\n<p>The problem is that there could be a Param3 but it is not guaranteed. I'm also not interested in Param3 but must make provision for it in case it is present.</p>\n\n<p>I'm parsing the parameters in the following manner:</p>\n\n<pre><code>char ParamStr[] = \"\\\"Param1\\\",\\\"Param2\\\",\\\"\\\",\\\"Param4\\\"\";\nchar Param1[10];\nchar Param2[10];\nchar Param4[10];\n\nsscanf(ParamStr, \"\\\"%[^\\\"]\\\", \\\"%[^\\\"]\\\", \\\"%*[^\\\"]\\\", \\\"%[^\\\"]\\\"\", Param1, Param2, Param4);\n</code></pre>\n\n<p>But when I parse Param3, I get incorrect results for Param4.</p>\n\n<p>What is the correct way to handle a parameter like Param3 that is \"dynamic\"?</p>\n"}, {"tags": ["c", "windows", "winapi", "synchronization", "interprocess"], "comments": [{"owner": {"reputation": 18804, "user_id": 3225, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cplXg.png?s=128&g=1", "display_name": "kenny", "link": "https://stackoverflow.com/users/3225/kenny"}, "edited": false, "score": 2, "creation_date": 1519222956, "post_id": 48908127, "comment_id": 84822284, "body": "how about a named semaphore?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519222974, "post_id": 48908127, "comment_id": 84822290, "body": "This is not link-sharing service. Do you have a specific code and a question about it?"}, {"owner": {"reputation": 89, "user_id": 6461137, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8501212c3afc0b5c24a4afe823fb470b?s=128&d=identicon&r=PG&f=1", "display_name": "Larry The Blackbird", "link": "https://stackoverflow.com/users/6461137/larry-the-blackbird"}, "reply_to_user": {"reputation": 18804, "user_id": 3225, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cplXg.png?s=128&g=1", "display_name": "kenny", "link": "https://stackoverflow.com/users/3225/kenny"}, "edited": false, "score": 0, "creation_date": 1519223527, "post_id": 48908127, "comment_id": 84822729, "body": "@kenny Sure, but if I use function WaitForSingleObject() the process will continue as soon as only 1 different process has made it till the same line (leaving the rest of them unsync). And I think using WaitForMultipleObjects() doesn&#39;t make sense to use as I only have one thread per process-"}, {"owner": {"reputation": 18804, "user_id": 3225, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cplXg.png?s=128&g=1", "display_name": "kenny", "link": "https://stackoverflow.com/users/3225/kenny"}, "edited": false, "score": 0, "creation_date": 1519223937, "post_id": 48908127, "comment_id": 84823065, "body": "you can build something custom in shared memory, good luck! <a href=\"https://stackoverflow.com/questions/7894224/sharing-memory-between-two-applications\" title=\"sharing memory between two applications\">stackoverflow.com/questions/7894224/&hellip;</a>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1519225099, "post_id": 48908127, "comment_id": 84823955, "body": "@LarryTheBlackbird &#39;WaitForMultipleObjects()&#39; makes sense to me. All processes have at least one thread, so waiting on N single-threaded processes is waiting on N threads."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1519225245, "post_id": 48908127, "comment_id": 84824055, "body": "...or you could wait with WFSO and loop around until you have received N semaphore units."}, {"owner": {"reputation": 89, "user_id": 6461137, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8501212c3afc0b5c24a4afe823fb470b?s=128&d=identicon&r=PG&f=1", "display_name": "Larry The Blackbird", "link": "https://stackoverflow.com/users/6461137/larry-the-blackbird"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1519225384, "post_id": 48908127, "comment_id": 84824146, "body": "@MartinJames Sure but as the first input argument of the function I need to give the number of simultaneous threads and as the second the pointer to the handlers of those threads. So I cannot give lets say 5 and 1 thread as input arguments. Ill try with the semaphores"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1519227806, "post_id": 48908127, "comment_id": 84825831, "body": "question too general. exist huge count of different synchronization technique. which select - depend from concrete task/situation"}, {"owner": {"reputation": 89, "user_id": 6461137, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8501212c3afc0b5c24a4afe823fb470b?s=128&d=identicon&r=PG&f=1", "display_name": "Larry The Blackbird", "link": "https://stackoverflow.com/users/6461137/larry-the-blackbird"}, "edited": false, "score": 0, "creation_date": 1519229722, "post_id": 48908127, "comment_id": 84827271, "body": "Okay, I added some code, this should be enough. So basically I want that all my processes (independent on how many I run) wait till all of them have reached the line &quot;if(WaitForSingleObject(...) == WAIT_OBJECT_0)"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1519231960, "post_id": 48908127, "comment_id": 84828902, "body": "and so what ? code not match to your description. you implement some critical section. <i>wait till all of them have reached the line</i> - nothing common with code. and what sense in this impossible task"}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1519240625, "post_id": 48908127, "comment_id": 84833780, "body": "Do you want all the processes to be identical or is there one special process that starts the others and waits?  Also, did you mean &quot;communication&quot; in the question or &quot;synchronization&quot;?"}, {"owner": {"reputation": 89, "user_id": 6461137, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8501212c3afc0b5c24a4afe823fb470b?s=128&d=identicon&r=PG&f=1", "display_name": "Larry The Blackbird", "link": "https://stackoverflow.com/users/6461137/larry-the-blackbird"}, "reply_to_user": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1519286424, "post_id": 48908127, "comment_id": 84850867, "body": "@AdrianMcCarthy They are all the same. Just .exe files run from a batch script. I meant synchronization, meaning they all execute the critical section at the same time"}, {"owner": {"reputation": 1904, "user_id": 333153, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eIrA.jpg?s=128&g=1", "display_name": "endo64", "link": "https://stackoverflow.com/users/333153/endo64"}, "edited": false, "score": 0, "creation_date": 1612379524, "post_id": 48908127, "comment_id": 116751714, "body": "Even though it&#39;s not the best way, you can even use a lock file, a process first check if the .lock file is exists, wait it to be deleted or raise timeout error, if the .lock file doesn&#39;t exists it creates, so the other processes should wait.  A better way is create and keep open/lock that file, other processes should do also the same (and fail because it is lock). This way, if somehow the .lock file is not deleted (the process created the lock file crashed for example), second process will able to re-create it."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 6461137, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8501212c3afc0b5c24a4afe823fb470b?s=128&d=identicon&r=PG&f=1", "display_name": "Larry The Blackbird", "link": "https://stackoverflow.com/users/6461137/larry-the-blackbird"}, "edited": false, "score": 0, "creation_date": 1519286626, "post_id": 48914076, "comment_id": 84850980, "body": "Thanks for the replay. As I answered a few seconds ago, there is no starter process. I run the same code (the same exe file) from the batch file multiple times. The first one which reaches the critical sections code should wait for the rest of the processes. Basically they should wait eachother until all of the processes have reached the same line in the code"}], "tags": [], "owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "is_accepted": false, "score": 0, "last_activity_date": 1519241736, "creation_date": 1519241736, "answer_id": 48914076, "question_id": 48908127, "link": "https://stackoverflow.com/questions/48908127/interprocess-synchronization-on-windows/48914076#48914076", "title": "interprocess synchronization on windows", "body": "<ol>\n<li>The starter process creates a Windows event object for each of the others processes, then it creates the other (child) processes, passing each of them the handles of all of the event objects (e.g., on the command line).</li>\n<li>Each child process raises its own event.</li>\n<li>Each process waits (with WaitForMultipleObject) for <em>all</em> of the events to be raised.</li>\n</ol>\n\n<p>The starter process code looks something like this:</p>\n\n<pre><code>HANDLE handles[child_count];\nfor (int i = 0; i &lt; child_count; ++i) {\n  handles[i] = ::CreateEvent(nullptr, FALSE, FALSE, nullptr);\n}\nfor (int i = 0; i &lt; child_count ++i) {\n  LaunchChild(i, handles);\n}\nDWORD result = ::WaitForMultipleObjects(child_count, handles, /*all=*/TRUE, INFINITE);\nif (WAIT_OBJECT_0 &lt;= result &amp;&amp; result &lt; WAIT_OBJECT_0 + child_count) {\n  // All of the children have set their events!\n}\n</code></pre>\n\n<p>Where LaunchChild starts the child process, passing the child's number and the handles of all of the events on the command line.  Each child parses the command line info into a child_index and an array of HANDLEs.</p>\n\n<pre><code>void SyncWithSiblings(int child_index, HANDLE *handles) {\n  // Raise my own event:\n  ::SetEvent(handles[child_index]);\n  DWORD result = ::WaitForMultipleObjects(child_count, handles, /*all=*/TRUE, INFINITE);\n  if (WAIT_OBJECT_0 &lt;= result &amp;&amp; result &lt; WAIT_OBJECT_0 + child_count) {\n    // All of the siblings have set their events!\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 6461137, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8501212c3afc0b5c24a4afe823fb470b?s=128&d=identicon&r=PG&f=1", "display_name": "Larry The Blackbird", "link": "https://stackoverflow.com/users/6461137/larry-the-blackbird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 578, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519289295, "creation_date": 1519222603, "last_edit_date": 1519289295, "question_id": 48908127, "link": "https://stackoverflow.com/questions/48908127/interprocess-synchronization-on-windows", "title": "interprocess synchronization on windows", "body": "<p>Can anyone share some links or its own experience on the interprocess synchronization on windows. I run more instances of my program (each having 1 Thread) and want to synchronize them. I read bunch of functions related to it <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682411(v=vs.85).aspx\" rel=\"nofollow noreferrer\">link</a>, none seems to give an example on the interprocess communication (they all talk about the thread synchronization). So I want the process to wait until all the processes have reached the same line in the code.</p>\n\n<p>Here is what I am having so far:;</p>\n\n<pre><code>interprocess_mtx = CreateMutex(NULL, FALSE, TEXT(\"mtx_name\"));\nif (interprocess_mtx == NULL) {\n    return (int)GetLastError();\n}\n\nif (WaitForSingleObject(interprocess_mtx, 10000) == WAIT_OBJECT_0) {\n    // here comes the code that needs to be executed synchronously\n    ReleaseMutex(interprocess_mtx);\n}\n\nif (CloseHandle(interprocess_mtx) == 0){\n    return (int)GetLastError();\n}\n</code></pre>\n\n<p>Thanks</p>\n\n<p>// Edited\nSolution:\nI run the first .exe file, wait for some small time, then run the rest. The first process creates a named mutex, locks it, waits for e.g. 5 seconds and releases it. The rest of the exe files (processes) create the same named mutex, then lock the mutex and release immediately. The critical code section is executed after the release.</p>\n"}, {"tags": ["c", "integral", "calculus"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 3, "creation_date": 1519216534, "post_id": 48906002, "comment_id": 84817777, "body": "<code>1&#47;2</code> is always zero."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 7587471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a9e2bcf0fdae33814c67a3be67d506?s=128&d=identicon&r=PG", "display_name": "lil&#39; mathematician", "link": "https://stackoverflow.com/users/7587471/lil-mathematician"}, "edited": false, "score": 0, "creation_date": 1519226762, "post_id": 48906329, "comment_id": 84825138, "body": "Actually I came to C after using mostly Python, where 1/2 would return a float value. Anyway thanks! (It&#39;s kind of ironic how I can&#39;t upvote your comment because I don&#39;t have 15 rep.)"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 83, "user_id": 7587471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a9e2bcf0fdae33814c67a3be67d506?s=128&d=identicon&r=PG", "display_name": "lil&#39; mathematician", "link": "https://stackoverflow.com/users/7587471/lil-mathematician"}, "edited": false, "score": 1, "creation_date": 1519227213, "post_id": 48906329, "comment_id": 84825430, "body": "@lil&#39;mathematician -  I discovered the same thing with Python.  Its typing is dynamic, and by context, C&#39;s is definitely not.  Thanks. No worries on the up-click.  (But 2 points more will put you there :))"}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": true, "score": 5, "last_activity_date": 1519218507, "last_edit_date": 1519218507, "creation_date": 1519217207, "answer_id": 48906329, "question_id": 48906002, "link": "https://stackoverflow.com/questions/48906002/trapezoidal-riemann-sum-in-c/48906329#48906329", "title": "Trapezoidal Riemann Sum in C", "body": "<p>In this statement:</p>\n\n<pre><code>trapezoidal_riemann_sum += (1/2)*(dx)*(f(a + (j-1)*dx) + f(a + j*dx));\n</code></pre>\n\n<p><code>1/2</code> == zero, so the whole statement is zero.  Change at least the numerator, or the denominator to the form of a double to get a double value back. i.e. <code>1/2.0</code> or <code>1.0/2</code> or <code>1.0/2.0</code> will all work.</p>\n"}], "owner": {"reputation": 83, "user_id": 7587471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a9e2bcf0fdae33814c67a3be67d506?s=128&d=identicon&r=PG", "display_name": "lil&#39; mathematician", "link": "https://stackoverflow.com/users/7587471/lil-mathematician"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 911, "favorite_count": 0, "accepted_answer_id": 48906329, "answer_count": 1, "score": 3, "last_activity_date": 1519218507, "creation_date": 1519216230, "question_id": 48906002, "link": "https://stackoverflow.com/questions/48906002/trapezoidal-riemann-sum-in-c", "title": "Trapezoidal Riemann Sum in C", "body": "<p>I've been trying to do Riemann Sums to approximate integrals in C. In my code below, I'm trying to approximate by both the trapezoidal way and the rectangular way (The trapezoidal way should be better, obviously).</p>\n\n<p>I tried making an algorithm for this on paper, and I got the following:\nNOTE: N is the number of rectangles (or trapezoids) and dx is calculated using a, b and N ( dx = (b-a)/N ). f(x) = x^2</p>\n\n<p>Rectangular Method:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;a href=\"http://www.codecogs.com/eqnedit.php?latex=\\int_a^b&amp;space;x^2&amp;space;dx&amp;space;\\approx&amp;space;\\sum_{i=1}^N&amp;space;f(a&amp;space;&amp;plus;&amp;space;(i-1)dx)dx\" target=\"_blank\"&gt;&lt;img src=\"http://latex.codecogs.com/png.latex?\\int_a^b&amp;space;x^2&amp;space;dx&amp;space;\\approx&amp;space;\\sum_{i=1}^N&amp;space;f(a&amp;space;&amp;plus;&amp;space;(i-1)dx)dx\" title=\"\\int_a^b x^2 dx \\approx \\sum_{i=1}^N f(a + (i-1)dx)dx\" /&gt;&lt;/a&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Trapezoidal Method:\n<div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;a href=\"http://www.codecogs.com/eqnedit.php?latex=\\int_a^b&amp;space;x^2&amp;space;dx&amp;space;\\approx&amp;space;\\sum_{i=1}^N&amp;space;[f(a&amp;space;&amp;plus;&amp;space;(i-1)dx)&amp;space;&amp;plus;&amp;space;f(a&amp;space;&amp;plus;&amp;space;i\\cdot&amp;space;dx)]dx\" target=\"_blank\"&gt;&lt;img src=\"http://latex.codecogs.com/png.latex?\\int_a^b&amp;space;x^2&amp;space;dx&amp;space;\\approx&amp;space;\\sum_{i=1}^N&amp;space;[f(a&amp;space;&amp;plus;&amp;space;(i-1)dx)&amp;space;&amp;plus;&amp;space;f(a&amp;space;&amp;plus;&amp;space;i\\cdot&amp;space;dx)]dx\" title=\"\\int_a^b x^2 dx \\approx \\sum_{i=1}^N [f(a + (i-1)dx) + f(a + i\\cdot dx)]dx\" /&gt;&lt;/a&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Code (In the following code, f(x)=x^2 and F(x) is it's antiderivative (x^3/3):</p>\n\n<pre><code>int main() {\n    int no_of_rects;\n    double  a, b;\n\n    printf(\"Number of subdivisions = \");\n    scanf(\"%d\", &amp;no_of_rects);\n\n    printf(\"a = \");\n    scanf(\"%lf\", &amp;a);\n\n    printf(\"b = \");\n    scanf(\"%lf\", &amp;b);\n\n    double dx = (b-a)/no_of_rects;\n\n    double rectangular_riemann_sum = 0;\n\n    int i;\n    for (i=1;i&lt;=no_of_rects;i++) {\n        rectangular_riemann_sum +=  (f(a + (i-1)*dx)*dx);\n    }\n\n    double trapezoidal_riemann_sum = 0;\n\n    int j;\n    for (j=1;j&lt;=no_of_rects;j++) {\n        trapezoidal_riemann_sum += (1/2)*(dx)*(f(a + (j-1)*dx) + f(a + j*dx));\n        printf(\"trapezoidal_riemann_sum: %lf\\n\", trapezoidal_riemann_sum);\n    }\n\n    double exact_integral = F(b) - F(a);\n    double rect_error = exact_integral - rectangular_riemann_sum;\n    double trap_error = exact_integral - trapezoidal_riemann_sum;\n\n    printf(\"\\n\\nExact Integral: %lf\", exact_integral);\n    printf(\"\\nRectangular Riemann Sum: %lf\", rectangular_riemann_sum);\n    printf(\"\\nTrapezoidal Riemann Sum: %lf\", trapezoidal_riemann_sum);\n    printf(\"\\n\\nRectangular Error: %lf\", rect_error);\n    printf(\"\\nTrapezoidal Error: %lf\\n\", trap_error);\n\n    return 0;\n}\n</code></pre>\n\n<p>Where:</p>\n\n<pre><code>double f(double x) {\n    return x*x;\n}\n\ndouble F(double x) {\n    return x*x*x/3;\n}\n</code></pre>\n\n<p>I have included the math and stdio header files. What is happening is that the rectangular riemann sum is okay, but the trapezoidal riemann sum is always 0 for some reason.</p>\n\n<p>What is the problem? Is it something in my formulas? Or my code?\n(I am a newbie in C by the way)</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "file-handling"], "comments": [{"owner": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 0, "creation_date": 1519214723, "post_id": 48905449, "comment_id": 84816515, "body": "Please share your source, and tell us what went wrong... did you see any errors?"}, {"owner": {"reputation": 163, "user_id": 4662340, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ngr1C0UfiA8/AAAAAAAAAAI/AAAAAAAAABE/fmcbvPd4_oY/photo.jpg?sz=128", "display_name": "Venkat Rao", "link": "https://stackoverflow.com/users/4662340/venkat-rao"}, "edited": false, "score": 1, "creation_date": 1519214737, "post_id": 48905449, "comment_id": 84816527, "body": "<a href=\"http://www.includehelp.com/c-programs/capitalize-first-character-of-each-word-in-string.aspx\" rel=\"nofollow noreferrer\">includehelp.com/c-programs/&hellip;</a>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1519214808, "post_id": 48905449, "comment_id": 84816574, "body": "I am pretty sure that your course materials contains all info necessary to solve this. Have you tried going back to them?"}, {"owner": {"reputation": 2127, "user_id": 3233365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmZpG.jpg?s=128&g=1", "display_name": "Gerard H. Pille", "link": "https://stackoverflow.com/users/3233365/gerard-h-pille"}, "reply_to_user": {"reputation": 163, "user_id": 4662340, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ngr1C0UfiA8/AAAAAAAAAAI/AAAAAAAAABE/fmcbvPd4_oY/photo.jpg?sz=128", "display_name": "Venkat Rao", "link": "https://stackoverflow.com/users/4662340/venkat-rao"}, "edited": false, "score": 0, "creation_date": 1519215383, "post_id": 48905449, "comment_id": 84816993, "body": "@VenkatRao  You noticed that example gives a memory fault when you enter 101 characters?"}, {"owner": {"reputation": 163, "user_id": 4662340, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ngr1C0UfiA8/AAAAAAAAAAI/AAAAAAAAABE/fmcbvPd4_oY/photo.jpg?sz=128", "display_name": "Venkat Rao", "link": "https://stackoverflow.com/users/4662340/venkat-rao"}, "reply_to_user": {"reputation": 2127, "user_id": 3233365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmZpG.jpg?s=128&g=1", "display_name": "Gerard H. Pille", "link": "https://stackoverflow.com/users/3233365/gerard-h-pille"}, "edited": false, "score": 0, "creation_date": 1519215701, "post_id": 48905449, "comment_id": 84817220, "body": "that is because the length of character array is given to be 100 in the example @GerardH.Pille"}, {"owner": {"reputation": 2127, "user_id": 3233365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmZpG.jpg?s=128&g=1", "display_name": "Gerard H. Pille", "link": "https://stackoverflow.com/users/3233365/gerard-h-pille"}, "reply_to_user": {"reputation": 163, "user_id": 4662340, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ngr1C0UfiA8/AAAAAAAAAAI/AAAAAAAAABE/fmcbvPd4_oY/photo.jpg?sz=128", "display_name": "Venkat Rao", "link": "https://stackoverflow.com/users/4662340/venkat-rao"}, "edited": false, "score": 1, "creation_date": 1519216321, "post_id": 48905449, "comment_id": 84817631, "body": "@VenkatRao No, it&#39;s because they forget to check their input.  Very bad example."}, {"owner": {"reputation": 45, "user_id": 7580858, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/398c5650c96d993787d14855a30f7217?s=128&d=identicon&r=PG&f=1", "display_name": "SK ASIF ALI", "link": "https://stackoverflow.com/users/7580858/sk-asif-ali"}, "edited": false, "score": 0, "creation_date": 1519216555, "post_id": 48905449, "comment_id": 84817793, "body": "There is no error but it can&#39;t produce proper output that i am looking for."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1519216669, "post_id": 48905449, "comment_id": 84817866, "body": "<code>if (ch = = &#39; &#39;|| ch == &#39;\\n&#39;)</code>? Can you submit code that actually compiles please?"}, {"owner": {"reputation": 45, "user_id": 7580858, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/398c5650c96d993787d14855a30f7217?s=128&d=identicon&r=PG&f=1", "display_name": "SK ASIF ALI", "link": "https://stackoverflow.com/users/7580858/sk-asif-ali"}, "edited": false, "score": 0, "creation_date": 1519217434, "post_id": 48905449, "comment_id": 84818396, "body": "please ckeck it I give the actual code that i compiled."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1519219580, "post_id": 48905449, "comment_id": 84819901, "body": "<a href=\"https://en.wikipedia.org/wiki/Finite-state_machine\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Finite-state_machine</a>"}, {"owner": {"reputation": 2127, "user_id": 3233365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmZpG.jpg?s=128&g=1", "display_name": "Gerard H. Pille", "link": "https://stackoverflow.com/users/3233365/gerard-h-pille"}, "edited": false, "score": 0, "creation_date": 1519224607, "post_id": 48905449, "comment_id": 84823589, "body": "You are opening the file &quot;a+&quot;, meaning reading and appending. I don&#39;t think that allows you to write, modify the file, as you do with the fseek and fputc."}, {"owner": {"reputation": 2127, "user_id": 3233365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmZpG.jpg?s=128&g=1", "display_name": "Gerard H. Pille", "link": "https://stackoverflow.com/users/3233365/gerard-h-pille"}, "edited": false, "score": 0, "creation_date": 1519224725, "post_id": 48905449, "comment_id": 84823680, "body": "&quot;I give the actual code that i compiled&quot;.  No, you did not."}, {"owner": {"reputation": 2127, "user_id": 3233365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmZpG.jpg?s=128&g=1", "display_name": "Gerard H. Pille", "link": "https://stackoverflow.com/users/3233365/gerard-h-pille"}, "edited": false, "score": 1, "creation_date": 1519224887, "post_id": 48905449, "comment_id": 84823808, "body": "Just replace  &quot;a+&quot; by &quot;r+&quot; and your program works."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1519231587, "post_id": 48905449, "comment_id": 84828628, "body": "If every write to the file appends to the file, you&#39;ll never get the &#39;right&#39; result.  Therefore, the <code>a</code> in <code>&quot;a+&quot;</code> is completely wrong.  You need <code>&quot;r+&quot;</code> to avoid clobbering the data in the file, but that allows you to alter it.  Your algorithm isn&#39;t going to spot the <code>h</code> in <code>how are you</code>.  You need to think your word boundaries more carefully.  What should happen with &quot;<code>it won&#39;t work</code>&quot;?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519242910, "post_id": 48905449, "comment_id": 84835007, "body": "when calling <code>fopen()</code>, always check (!=NULL) the returned value to assure the operation was successful.  when calling <code>fseek()</code>, always check (!=-1) the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519243052, "post_id": 48905449, "comment_id": 84835078, "body": "regarding: <code>if(ch&gt;=97 &amp;&amp; ch&lt;=122)</code>  None of us want to search an ASCII table to determine which characters those number represent.  Suggest using <code>&#39;a&#39;</code> and <code>&#39;z&#39;</code>.   However, in the header file <code>ctype.h</code>  are the functions/macros <code>toupper()</code> and <code>isalpha()</code>  which will greatly simplify your code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519243294, "post_id": 48905449, "comment_id": 84835227, "body": "regarding: <code>if(ch==&#39; &#39; || ch==&#39;\\n&#39;)</code>  this overlooks the &lt;tab&gt; char (\\t)  Suggest using <code>isspace()</code> from the header file <code>ctype.h</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519243440, "post_id": 48905449, "comment_id": 84835315, "body": "regarding: <code>char ch;</code>  the returned type from <code>fgetc()</code> is an <code>int</code>, so the declaration should be: <code>int ch;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519243530, "post_id": 48905449, "comment_id": 84835374, "body": "the posted code is missing the statement: <code>#include &lt;ctype.h&gt;</code>  for functions like: <code>toupper()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519243667, "post_id": 48905449, "comment_id": 84835448, "body": "the return type from <code>main()</code> is always <code>int</code>, regardless of what visual studio will allow you to get away with"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519244963, "post_id": 48905449, "comment_id": 84836161, "body": "the posted code, even after the suggest corrections, does not properly handle <code>&#47;&#47;ch=fgetc(fp1)</code>  nor any other instances where some word is immediately preceded by anything other than &#39;white space&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1519248365, "post_id": 48915641, "comment_id": 84837884, "body": "surely this doesnt capitalize the first letter of the file"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1519250451, "post_id": 48915641, "comment_id": 84838857, "body": "@pm100,  True enough.  A simple state machine that is initialized to &#39;not in word&#39; and when it sees the first char changes state to &#39;in word&#39;, and back at the input of any not alpha character would be a much better algorithm.  However, I tried to stay with the algorithm used by the OP."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1519250775, "post_id": 48915641, "comment_id": 84839013, "body": "so it doesnt do #2 in your list then,"}, {"owner": {"reputation": 2127, "user_id": 3233365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmZpG.jpg?s=128&g=1", "display_name": "Gerard H. Pille", "link": "https://stackoverflow.com/users/3233365/gerard-h-pille"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1519251028, "post_id": 48915641, "comment_id": 84839126, "body": "@pm100 Very alert. Chapeau!"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1519252905, "post_id": 48915641, "comment_id": 84839938, "body": "This code has undefined behavior because you do not call <code>fseek()</code> for each change between reading from and writing to the file.  Furthermore, <code>main()</code> should return <code>0</code> for better portability (implicit <code>return 0</code> was introduced in C99 only). Finally, the initial of each word should be uppercased, including words that do not follow a space, as per the OP&#39;s example: <code>good morning.how are you?</code>. no space between <code>morning</code> and <code>how</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519253529, "post_id": 48915641, "comment_id": 84840173, "body": "I have added a version of the code that addresses the shortcomings of my first posted code and the shortcomings of the OPs algorithm"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519254013, "post_id": 48915641, "comment_id": 84840343, "body": "I have added the result of running my &#39;corrected&#39; code against a copy of that code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1519254230, "post_id": 48915641, "comment_id": 84840421, "body": "@chqrlie,  Notice there is no/zero/nada necessity to use a call to <code>fseek()</code> other than when the code is going to change some char in the input file.   If the user wants to use some obsolete C compiler, (like visual studio) then they can &#39;tweak&#39; the code so it runs on that obsolete compiler with no warnings, etc.  I see no reason for me to write the code to support any/every C compiler ever written."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1519289140, "post_id": 48915641, "comment_id": 84852248, "body": "@user3629249: I did not say you had to use <code>fseek()</code> for each byte read from the file, but you need an extra <code>fseek(fp, 0L, SEEK_CUR);</code> after the <code>fputc()</code> because you switch back from writing to reading. It is still a requirement as of C11 for proper operation, even if some current C libraries seem to work correctly without it."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": -1, "last_activity_date": 1519253855, "last_edit_date": 1519253855, "creation_date": 1519247888, "answer_id": 48915641, "question_id": 48905449, "link": "https://stackoverflow.com/questions/48905449/changing-the-case-of-the-first-letter-of-the-word-in-a-file-using-c/48915641#48915641", "title": "Changing the case of the first letter of the word in a file using C", "body": "<p>the following proposed code:</p>\n\n<ol>\n<li>cleanly compiles</li>\n<li>uses the OPs algorithm, warts and all</li>\n<li>properly checks for and handles any errors</li>\n<li>uses appropriate horizontal spacing: inside parens, after commas, after semicolons, around C operators for ease of readability and understanding</li>\n<li>documents why each header file is included</li>\n<li>comments the status at key points in the code</li>\n<li>incorporates the comments to the OPs question</li>\n<li>uses the facilities found in header file <code>ctype.h</code> to avoid crypic numbers, etc</li>\n<li>consistently indents the code, using 4 spaces for each indent level</li>\n</ol>\n\n<p>and now, the proposed code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;    // fopen(), perror(), fgetc(), fclose(),\n                      // fseek(), fputc(),\n                      // FILE, EOF\n#include &lt;stdlib.h&gt;   // exit(), EXIT_FAILURE\n#include &lt;ctype.h&gt;    // toupper(), isspace(), isalpha()\n\n\nint main( void )\n{\n    int ch;\n\n    FILE *fp1 = fopen( \"asiftext.txt\", \"r+\" );\n    if( !fp1 )\n    {\n        perror( \"fopen failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, fopen successful\n\n    while( ( ch = fgetc( fp1 ) ) != EOF )\n    {\n        if( !isspace( ch ) )\n        {\n            continue;\n        }\n\n        // when here, 'ch' is a 'white space' char\n        if( ( ch = fgetc( fp1 ) ) == EOF )\n        {\n            break;\n        }\n\n        // when here, 'ch' is possibly the\n        // first letter of a word\n        if( isalpha( ch ) )\n        {  // then 'ch' is alphabetic\n            // adjust file pointer\n            if( fseek( fp1, -1, SEEK_CUR ) )\n            {\n                perror( \"fseek failed\" );\n                fclose( fp1 );\n                exit( EXIT_FAILURE );\n            }\n\n            // implied else, fseek successful\n\n            // overwrite with uppercase char\n            fputc( toupper( ch ), fp1 );\n        }\n    }\n\n    fclose(fp1);\n}\n</code></pre>\n\n<p>The following proposed code implements a (two state) state machine and addresses the shortcomings of the OPs algorithm.</p>\n\n<pre><code>#include &lt;stdio.h&gt;    // fopen(), perror(), fgetc(), fclose(),\n                      // fseek(), fputc(),\n                      // FILE, EOF\n#include &lt;stdlib.h&gt;   // exit(), EXIT_FAILURE\n#include &lt;ctype.h&gt;    // toupper(), isspace(), isalpha()\n\nenum state { notInWord, InWord };\n\nint main( void )\n{\n    enum state currentState = notInWord;\n\n    int ch;\n\n    FILE *fp1 = fopen( \"asiftext.txt\", \"r+\" );\n    if( !fp1 )\n    {\n        perror( \"fopen failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, fopen successful\n\n\n    while(  (ch = fgetc( fp1 ) ) != EOF )\n    {\n        if( notInWord == currentState )\n        {\n            if( isalpha( ch ) )\n            {\n                currentState = InWord;\n\n                // adjust file pointer\n                if( fseek( fp1, -1, SEEK_CUR ) )\n                {\n                    perror( \"fseek failed\" );\n                    fclose( fp1 );\n                    exit( EXIT_FAILURE );\n                }\n\n                // implied else, fseek successful\n\n                // overwrite with uppercase char\n                fputc( toupper( ch ), fp1 );\n            }\n\n            else // not alpha\n            {\n                currentState = notInWord;\n            }\n        }\n\n        else  // currentState = InWord\n        {\n            if( !isalpha( ch ) )\n            {\n                currentState = notInWord;\n            }\n        }\n    }\n\n    fclose(fp1);\n}\n</code></pre>\n\n<p>here is the output from the corrected code when run against a copy of the corrected source code:</p>\n\n<pre><code>#Include &lt;Stdio.H&gt;    // Fopen(), Perror(), Fgetc(), Fclose(),\n                      // Fseek(), Fputc(),\n                      // FILE, EOF\n#Include &lt;Stdlib.H&gt;   // Exit(), EXIT_FAILURE\n#Include &lt;Ctype.H&gt;    // Toupper(), Isspace(), Isalpha()\n\nEnum State { NotInWord, InWord };\n\nInt Main( Void )\n{\n    Enum State CurrentState = NotInWord;\n\n    Int Ch;\n\n    FILE *Fp1 = Fopen( \"Asiftext.Txt\", \"R+\" );\n    If( !Fp1 )\n    {\n        Perror( \"Fopen Failed\" );\n        Exit( EXIT_FAILURE );\n    }\n\n    // Implied Else, Fopen Successful\n\n\n    While(  (Ch = Fgetc( Fp1 ) ) != EOF )\n    {\n        If( NotInWord == CurrentState )\n        {\n            If( Isalpha( Ch ) )\n            {\n                CurrentState = InWord;\n\n                // Adjust File Pointer\n                If( Fseek( Fp1, -1, SEEK_CUR ) )\n                {\n                    Perror( \"Fseek Failed\" );\n                    Fclose( Fp1 );\n                    Exit( EXIT_FAILURE );\n                }\n\n                // Implied Else, Fseek Successful\n\n                // Overwrite With Uppercase Char\n                Fputc( Toupper( Ch ), Fp1 );\n            }\n\n            Else // Not Alpha\n            {\n                CurrentState = NotInWord;\n            }\n        }\n\n        Else  // CurrentState = InWord\n        {\n            If( !Isalpha( Ch ) )\n            {\n                CurrentState = NotInWord;\n            }\n        }\n    }\n\n    Fclose(Fp1);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1519253164, "creation_date": 1519253164, "answer_id": 48916815, "question_id": 48905449, "link": "https://stackoverflow.com/questions/48905449/changing-the-case-of-the-first-letter-of-the-word-in-a-file-using-c/48916815#48916815", "title": "Changing the case of the first letter of the word in a file using C", "body": "<p>Modifying the file in place is a bad idea. Using standard streams for this is cumbersome and inefficient.</p>\n\n<p>Here is a simple filter that reads <code>stdin</code> and writes the modified words to <code>stdout</code>:</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void) {\n    int c, lastc = '\\n';\n\n    while ((c = getchar()) != EOF) {\n        if (!isalpha(lastc))\n            c = toupper(c);\n        putchar(c);\n        lastc = c;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Note that the above code works for ASCII text files. It may not work for non ASCII files, especially if they are encoded with a multi-byte encoding such as UTF-8.</p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1519263649, "creation_date": 1519263649, "answer_id": 48918288, "question_id": 48905449, "link": "https://stackoverflow.com/questions/48905449/changing-the-case-of-the-first-letter-of-the-word-in-a-file-using-c/48918288#48918288", "title": "Changing the case of the first letter of the word in a file using C", "body": "<p>One issue that also comes up when converting to title case is, \"What are the acceptable preceding characters to trigger capitalization of the first character in a word?\" Sometimes, as in your example, you may want <code>Morning.How</code> with <code>how</code> considered a separate word and capitalized. Other times, you may only want to consider words following a whitespace.</p>\n\n<p>You can tailor this by specifying a list of ending characters (<code>ends</code> below) that will be followed by a first character converted to caps. You can either set a macro defining a string constant, pass a second short string to your titlecase function, or just specify the <code>ends</code> list in your function itself.</p>\n\n<p>Generally, I wouldn't capitalize within a string made up by dot separators, but there is nothing wrong with it. That is where having the flexibility of an <code>ends</code> list pays dividends. You simply tailor the string to fit your needs. An example would be:</p>\n\n<pre><code>/** convert string to title case based on 'ends'.\n *  returns pointer to 'str' with words converted to \n *  initial uppercase if the word follows one of the \n *  characters specified in 'ends'.\n */\nchar *str2title (char *str)\n{\n    if (!str) return NULL;    /* handle NULL and empty-string */\n    if (!*str) return str;\n\n    char *p = str,            /* pointer to string */\n        *ends = \" \\t\\n.\",     /* set of acceptable ends */\n        last = ' ';           /* previous character seen */\n\n    for (; *p; p++) {                     /* loop over string */\n        for (char *e = ends; *e; e++)     /* loop over ends */\n            /* if last is end and current is lowercase */\n            if (last == *e &amp;&amp; ('a' &lt;= *p &amp;&amp; *p &lt;= 'z'))\n                *p += 'A' - 'a';          /* convert to upper */\n        last = *p;\n    }\n\n    return str;\n}\n</code></pre>\n\n<p>There are many ways to approach this problem. Learn from them all.</p>\n"}], "owner": {"reputation": 45, "user_id": 7580858, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/398c5650c96d993787d14855a30f7217?s=128&d=identicon&r=PG&f=1", "display_name": "SK ASIF ALI", "link": "https://stackoverflow.com/users/7580858/sk-asif-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1519263649, "creation_date": 1519214594, "last_edit_date": 1519252644, "question_id": 48905449, "link": "https://stackoverflow.com/questions/48905449/changing-the-case-of-the-first-letter-of-the-word-in-a-file-using-c", "title": "Changing the case of the first letter of the word in a file using C", "body": "<p>I am trying to change  the case of first letter of the word from a file using C.</p>\n\n<p>For example, if the file contains sentence: <code>good morning.how are you?</code>\nThen it will be changed to <code>Good Morning.How Are You?</code></p>\n\n<p>I tried a lot but cannot produce the desired result.\nCan anyone help me?  I use this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid main() {\n    FILE *fp1;\n    char ch;\n    int p;\n\n    fp1 = fopen(\"asiftext.txt\", \"a+\");\n    ch = fgetc(fp1);\n    if (ch &gt;= 'a' &amp;&amp; ch &lt;= 'z') {\n        fseek(fp1, -1, 1);\n        ch = toupper(ch);\n        fputc(ch, fp1);\n    }\n    while ((ch = fgetc(fp1)) != EOF) {\n        if (ch == ' ' || ch == '\\n') {\n            ch = fgetc(fp1);\n            if (ch == EOF)\n                break;\n            if (ch &gt;= 97 &amp;&amp; ch &lt;= 122) {\n                fseek(fp1, -1, 1);\n                fputc(ch - 32, fp1);\n            }\n        }\n    }\n    /*ch = fgetc(fp1);\n    p = ftell(fp1);\n    printf(\"p1=%d\", p);\n    printf(\"%c\\n\", ch);\n    fseek(fp1, -1, 1);\n    fputc(ch - 32,fp1);\n    ch = fgetc(fp1);\n    printf(\"c=%c\\n\", ch); */\n    fclose(fp1);\n}\n</code></pre>\n"}, {"tags": ["c", "multidimensional-array", "c-strings"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1519212738, "post_id": 48904795, "comment_id": 84815167, "body": "<code>List_Of_Words</code> is a pointer. But you never seem to make it actually <i>point</i> anywhere?"}, {"owner": {"reputation": 27, "user_id": 8960491, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-anyeraya9Yo/AAAAAAAAAAI/AAAAAAAAABk/awd_Ij3hZI8/photo.jpg?sz=128", "display_name": "Radium", "link": "https://stackoverflow.com/users/8960491/radium"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1519212873, "post_id": 48904795, "comment_id": 84815244, "body": "Had forgotten to put the malloc line there"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1519212950, "post_id": 48904795, "comment_id": 84815297, "body": "<code>List_Of_Words[0]</code> is uninitialized but you dereference it"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1519213015, "post_id": 48904795, "comment_id": 84815332, "body": "Also you give the wrong type to <code>printf(&quot;%s&quot;</code>, good compilers warn about this"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1519226275, "post_id": 48904795, "comment_id": 84824769, "body": "Why do you have &quot;<i>2D</i>&quot; in the question&#39;s title? To me this looks like you try to have a 1D array of strings."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8960491, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-anyeraya9Yo/AAAAAAAAAAI/AAAAAAAAABk/awd_Ij3hZI8/photo.jpg?sz=128", "display_name": "Radium", "link": "https://stackoverflow.com/users/8960491/radium"}, "edited": false, "score": 0, "creation_date": 1519216373, "post_id": 48905083, "comment_id": 84817673, "body": "allocating the memory before copying the word is not crashing the program anymore but the printf line is still causing problems, it hasnt gone past that.."}, {"owner": {"reputation": 27, "user_id": 8960491, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-anyeraya9Yo/AAAAAAAAAAI/AAAAAAAAABk/awd_Ij3hZI8/photo.jpg?sz=128", "display_name": "Radium", "link": "https://stackoverflow.com/users/8960491/radium"}, "edited": false, "score": 0, "creation_date": 1519216623, "post_id": 48905083, "comment_id": 84817834, "body": "Actually, NVM that, it started printing after restarting the compiler but its only printing out NULL instead of each individual words"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 27, "user_id": 8960491, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-anyeraya9Yo/AAAAAAAAAAI/AAAAAAAAABk/awd_Ij3hZI8/photo.jpg?sz=128", "display_name": "Radium", "link": "https://stackoverflow.com/users/8960491/radium"}, "edited": false, "score": 0, "creation_date": 1519217702, "post_id": 48905083, "comment_id": 84818571, "body": "Ahhh...I just noticed what else you&#39;d done wrong - you had <code>List_Index</code> in there instead of <code>i</code>"}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 1, "last_activity_date": 1519217677, "last_edit_date": 1519217677, "creation_date": 1519213513, "answer_id": 48905083, "question_id": 48904795, "link": "https://stackoverflow.com/questions/48904795/c-2d-arrays-of-string-of-unknown-length-crashing-when-accessing-the-elements/48905083#48905083", "title": "C 2D arrays of string of unknown length, Crashing when accessing the elements", "body": "<p>There's a number of problems with your code.</p>\n\n<p>You're firstly not allocating enough memory. <code>List_Of_Words</code> needs to be allocated enough memory for each word, which you're doing just fine. But each <code>List_Of_Words[]</code> also needs memory allocated to contain the words too.</p>\n\n<p>Then you're doing this, which is wrong because you're passing in a <code>char</code> as the first argument instead of a <code>char *</code></p>\n\n<pre><code>strcpy(*List_Of_Words[List_Index], Processed_Word);\n</code></pre>\n\n<p>Fixing this and the previous problem your code should look like</p>\n\n<pre><code>List_Of_Words[List_Index]=malloc(strlen(Processed_Word)+1);\nstrcpy(List_Of_Words[List_Index], Processed_Word);\n</code></pre>\n\n<p>or if available you can use <code>strdup</code> which combines the two lines into one</p>\n\n<pre><code>List_Of_Words[List_Index]=strdup(Processed_Word);\n</code></pre>\n\n<p>You repeat the over de-referencing problem when printing out the strings too, so it should look like</p>\n\n<pre><code>printf(\"%s\\n\", List_Of_Words[i]);\n</code></pre>\n\n<p>unless of course you're just printing out the first character in which case you should use the <code>%c</code> formatting code.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9390561, "user_type": "registered", "profile_image": "https://graph.facebook.com/1725710410795889/picture?type=large", "display_name": "Mahidhar Bandaru", "link": "https://stackoverflow.com/users/9390561/mahidhar-bandaru"}, "is_accepted": false, "score": 0, "last_activity_date": 1519214283, "last_edit_date": 1519214283, "creation_date": 1519213670, "answer_id": 48905137, "question_id": 48904795, "link": "https://stackoverflow.com/questions/48904795/c-2d-arrays-of-string-of-unknown-length-crashing-when-accessing-the-elements/48905137#48905137", "title": "C 2D arrays of string of unknown length, Crashing when accessing the elements", "body": "<p>The problem here is that you have defined what List_Of_Words is but forgot to allocate memory to it.</p>\n\n<p>Let r = total number of words you  want to store in List_Of_Words.</p>\n\n<p>The following line of code allocates r chunks of data type char* where each chunk will hold a word.</p>\n\n<pre><code>char **List_Of_Words = (char **)malloc(r * sizeof(char *));\n</code></pre>\n\n<p>The following line of code allocates c chunks of data type char where each chunk will hold a character and stores the data in it. Here c is the size of the processed_word to be stored.</p>\n\n<pre><code>Inside the loop:\n    int c = strlen(processed_word) + 1\n    List_Of_Words[i] = (char *)malloc(c * sizeof(char));\n    strcpy(List_Of_Words[i], processed_word);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": false, "score": 0, "last_activity_date": 1519214195, "creation_date": 1519214195, "answer_id": 48905319, "question_id": 48904795, "link": "https://stackoverflow.com/questions/48904795/c-2d-arrays-of-string-of-unknown-length-crashing-when-accessing-the-elements/48905319#48905319", "title": "C 2D arrays of string of unknown length, Crashing when accessing the elements", "body": "<p>This line</p>\n\n<pre><code>strcpy(*List_Of_Words[List_Index], Processed_Word);\n</code></pre>\n\n<p>does not allocate memory to the copy, it assumes you already have enough space allocated. If your system has <a href=\"https://linux.die.net/man/3/strdup\" rel=\"nofollow noreferrer\">strdup</a>, you can use that to allocate and copy the string (however, <code>strdup</code> is not portable - it's not in the C standard or the Posix standard).</p>\n\n<pre><code>List_Of_Words[List_Index] = strdup(Processed_Word);\n</code></pre>\n\n<p>If you don't have <code>strdup</code>, allocate memory before doing <code>strcpy</code>.</p>\n\n<pre><code>List_of_Words[List_Index] = malloc(strlen(Processed_Word) + 1); // + 1 for the \\0 at the end\nstrcpy(List_Of_Words[List_Index], Processed_Word);\n</code></pre>\n\n<p>Notice also that using subscripts is the same as doing a dereference. <code>List_of_Words[index]</code> is a <code>char*</code> i.e. it is already the string you want.  <code>*List_of_Words[index]</code> is a <code>char</code> i.e. it is the first character of the string at <code>List_of_Words[index]</code>. Treating a <code>char</code> as a pointer can only lead to trouble. You need to drop the <code>*</code> prefix from every use of <code>*List_of_Words[...]</code> in your code</p>\n"}, {"tags": [], "owner": {"reputation": 2285, "user_id": 903783, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000813825134/picture?type=large", "display_name": "George Birbilis", "link": "https://stackoverflow.com/users/903783/george-birbilis"}, "is_accepted": false, "score": 0, "last_activity_date": 1519218194, "creation_date": 1519218194, "answer_id": 48906649, "question_id": 48904795, "link": "https://stackoverflow.com/questions/48904795/c-2d-arrays-of-string-of-unknown-length-crashing-when-accessing-the-elements/48906649#48906649", "title": "C 2D arrays of string of unknown length, Crashing when accessing the elements", "body": "<p>You say \"//Processed_Word word is a word that has been read from a file, its in a loop.\" - Hope you don't have that List_of_Words malloc inside the loop. I'd expect you to do it outside the loop that reads the words once</p>\n\n<p>Also, I'd expect you to be allocating memory for each entry in the List_of_Words, but you don't seem to be doing it.</p>\n\n<p>A 2D array like the one you try to make is practically a 1D array (the one dimension) that holds references to other 1D arrays (the second dimension). The content cells exist at those other 1D arrays (the arrays of the last dimension if you have multiple ones).</p>\n"}], "owner": {"reputation": 27, "user_id": 8960491, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-anyeraya9Yo/AAAAAAAAAAI/AAAAAAAAABk/awd_Ij3hZI8/photo.jpg?sz=128", "display_name": "Radium", "link": "https://stackoverflow.com/users/8960491/radium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 48905083, "answer_count": 4, "score": 0, "last_activity_date": 1519218194, "creation_date": 1519212645, "last_edit_date": 1519214875, "question_id": 48904795, "link": "https://stackoverflow.com/questions/48904795/c-2d-arrays-of-string-of-unknown-length-crashing-when-accessing-the-elements", "title": "C 2D arrays of string of unknown length, Crashing when accessing the elements", "body": "<p>so I've been running into this error and I cant seem to find an answer for it so far, apologies if this question has been asked before.\nHeres the affected code:</p>\n\n<pre><code>char **List_Of_Words;\nint List_Index=0;\n\nList_Of_Words = malloc(Number_of_Words *sizeof(char*));\n\n//Processed_Word word is a word that has been read from a file, its in a loop.\nstrcpy(*List_Of_Words[List_Index], Processed_Word);\nList_Index++;\n\n\n//im looping through the array to print each word thats stored there\n for(int i = 0;i &lt; List_Index; i++)\n{\nprintf(\"%s\\n\", *List_Of_Words[List_Index]);\n} \n</code></pre>\n\n<p>When I debugged with Visual Studio, I get this error:</p>\n\n<pre><code>Unhandled exception at 0x01229240 in Wordcount.exe: 0xC0000005: Access violation writing location 0x00000030.\n</code></pre>\n\n<p>So, I'm assuming that my program is trying to access memory that it doesn't have access to. C is a new language for me so I don't really know how to deal with this. </p>\n"}, {"tags": ["c", "floating-point"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1519212249, "post_id": 48904533, "comment_id": 84814817, "body": "Mebbe you need &#39;double x = 78.352361;&#39; ??"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1519212540, "post_id": 48904533, "comment_id": 84815022, "body": "You said your STM32F777 has a double-precision floating point unit, but you realize, don&#39;t you, that by declaring your variable as <code>float</code> you&#39;re explicitly requesting <i>single</i> precision?"}, {"owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1519212555, "post_id": 48904533, "comment_id": 84815030, "body": "@MartinJames, if I take double, for example for x = 17.445652, I get 17.445651999999999 which is again what I don&#39;t want."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1519212610, "post_id": 48904533, "comment_id": 84815074, "body": "If you want fixed-point precision, floating-point is not for you. The workarounds are somewhat cumbersome but that&#39;s how it is. This is a common FAQ."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1519212616, "post_id": 48904533, "comment_id": 84815080, "body": "@AbhishekKumar it&#39;s floating-point!  That&#39;s pretty close.  How close do you want to get?"}, {"owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "edited": false, "score": 0, "creation_date": 1519212672, "post_id": 48904533, "comment_id": 84815121, "body": "Actually I want to store latitude and longitude value which have to be dead precise upto 6 digits after decimal place."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1519212725, "post_id": 48904533, "comment_id": 84815161, "body": "@AbhishekKumar Just so you know: you called this a &quot;really weird issue&quot;, but it&#39;s actually a perfectly normal issue.  Every programmer who has ever written floating-point code has encountered this issue at least once and been confused by it."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1519212808, "post_id": 48904533, "comment_id": 84815202, "body": "@AbhishekKumar the value is out by 0.000000000000001 !"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1519212890, "post_id": 48904533, "comment_id": 84815261, "body": "(1) Use <code>double</code>, not <code>float</code>.  (2) If you want 6 places past the decimal, print things out using <code>%.6f</code>, not <code>%f</code>. (There&#39;s more you may need to know eventually, but that&#39;s a good start.)"}, {"owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "edited": false, "score": 0, "creation_date": 1519212936, "post_id": 48904533, "comment_id": 84815289, "body": "Yup, I understand, but isn&#39;t there any way to solve this?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1519213029, "post_id": 48904533, "comment_id": 84815345, "body": "..which is about 50 nanometers in lat/long.  Imma pretty sure that&#39;s going to be precise enough."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1519213137, "post_id": 48904533, "comment_id": 84815404, "body": "@AbhishekKumar it can be solved by an infinite amount of RAM."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1519213223, "post_id": 48904533, "comment_id": 84815469, "body": "Consider the celestial sphere out to Pluto. Being out on a latitude of the order of magnitude of 1e-15 equates to 1cm ! Who gives a monkeys then?"}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 1, "creation_date": 1519213375, "post_id": 48904533, "comment_id": 84815581, "body": "@AbhishekKumar Do you understand what the sixth decimal place means in terms of latitude? The difference between 17.445652 and 17.445651 as a latitude is approximately 11 centimetres. If it is a longitude, it is also about 11 cm at the equator but gets smaller the further North or South you go. The difference between 17.445652 and 17.445651999999999 is 0.1 nanometres."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1519213387, "post_id": 48904533, "comment_id": 84815590, "body": "@Bathsheba that far out, it would be brass monkeys."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1519213455, "post_id": 48904533, "comment_id": 84815640, "body": "@JeremyP I guesstimated 50nm, but hey, what&#39;s a couple powers 10 between friends?"}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1519213534, "post_id": 48904533, "comment_id": 84815694, "body": "@MartinJames Ask Intel. :-)"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 1, "creation_date": 1519213904, "post_id": 48904533, "comment_id": 84815952, "body": "@JeremyP ..or maybe Volkswagen:)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1519214713, "post_id": 48904533, "comment_id": 84816508, "body": "Before you all tease this guy too much, let me tell you a story. I work with precise latitudes and longitudes all the time.  I work with one system that kept latitudes and longitudes with a precision that worked out to about 9mm at the equator.  It wasn&#39;t good enough.  We had to increase the precision.  We ended up doubling it (which gave us, theoretically, something like 2 attometers).  The problem was not that the customer needed better than 9mm absolute location accuracy, but that the quantization noise was perturbing their calculations.  Increasing the precision fixed it satisfactorily."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1519215534, "post_id": 48904533, "comment_id": 84817102, "body": "&quot;allocate&quot; means to obtain memory via <code>malloc</code> and friends; you keep saying &quot;allocated&quot; when you actually mean &quot;assigned&quot; (or &quot;initialized&quot;)"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 5, "creation_date": 1519215596, "post_id": 48904533, "comment_id": 84817148, "body": "I reopened this so it can be answered correctly. Please do not promiscuously mark floating-point questions as duplicates of <a href=\"https://stackoverflow.com/questions/48866943/cs-float-and-double-precision\">that question</a>. When a person has a specific issue that is not an exact duplicate, it should be addressed with a specific answer. There are many floating-point features, mechanisms, and techniques that deserve individual explanation, not a generic \u201cit is inaccurate, live with it\u201d answer."}, {"owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1519217253, "post_id": 48904533, "comment_id": 84818261, "body": "@M.M Sorry, I corrected the question content from &quot;allocated&quot; to &quot;assigned&quot;!"}, {"owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1519283974, "post_id": 48904533, "comment_id": 84849582, "body": "Thanks @Steve Summit for the great info, actually I am new to this project which basically deals with GPS and lat/lon. Can you please tell me how do you calculate the precision in terms of distance from the lat/lon degree value? Like what place after the decimal digit accounts for how much precision in terms of distance?"}, {"owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "reply_to_user": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1519283991, "post_id": 48904533, "comment_id": 84849597, "body": "Thanks @JeremyP for the great info, actually I am new to this project which basically deals with GPS and lat/lon. Can you please tell me how do you calculate the precision in terms of distance from the lat/lon degree value? Like what place after the decimal digit accounts for how much precision in terms of distance?"}], "answers": [{"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1519215896, "creation_date": 1519215896, "answer_id": 48905893, "question_id": 48904533, "link": "https://stackoverflow.com/questions/48904533/floating-point-precision-not-matching-for-the-value-what-was-actually-assigned/48905893#48905893", "title": "Floating point precision not matching for the value what was actually assigned?", "body": "<p>Floating point variables cannot store arbitrary real numbers, they can only store members of a particular subset (of cardinality slightly under 2^32 for a 32-bit IEEE float) of the real numbers.  The \"changes\" you see are because you assigned a value that is not one of the values that a <code>float</code> can store on your system. It was rounded to a value that can be stored.</p>\n\n<p>In order to store 6 decimal places perfectly, for latitude or longitude, you should use a 32-bit integer (representing 1 million times the value to store).</p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 5, "last_activity_date": 1519216868, "last_edit_date": 1519216868, "creation_date": 1519216439, "answer_id": 48906068, "question_id": 48904533, "link": "https://stackoverflow.com/questions/48904533/floating-point-precision-not-matching-for-the-value-what-was-actually-assigned/48906068#48906068", "title": "Floating point precision not matching for the value what was actually assigned?", "body": "<p>The most common floating-point format, IEEE 754, includes a basic 32-bit format and a basic 64-bit format, and these are commonly used for the <code>float</code> and <code>double</code> types in C. For brevity, I will call them <code>float</code> and <code>double</code> in this answer.</p>\n\n<p>Neither of these types can exactly represent non-integer numbers other than those that are multiples of a power of two (such as \u00bc, \u00be, 1/1024, 73/1048576). Every other number will be changed slightly when it is converted from decimal to <code>float</code> or <code>double</code>.</p>\n\n<p>However, the <code>float</code> has the property that rounding any decimal numeral with six significant digits (such as 1.2345 or 9.87654e23) to <code>float</code> and back to six significant decimal digits returns the original number (provided the number is within normal bounds of the format). In C, this number of digits is reported by the value <code>FLT_DIG</code>, which is defined by <code>float.h</code>. Since your number 78.352361 has eight significant digits, it is not guaranteed to survive a conversion to <code>float</code> and back.</p>\n\n<p>For <code>double</code>, at least 15 digits will survive a round trip, reported by <code>DBL_DIG</code>.</p>\n\n<p>Note that this is the number of decimal digits guaranteed to survive the rounding caused by <strong>one</strong> conversion to binary floating-point and back to the <strong>original</strong> number of decimal digits. If additional arithmetic is performed in floating-point, additional roundings occur, which may accumulate more error. And, if a value is formatted with more decimal digits than the original, then the result may differ from the original number. (For example, <code>.9f</code> produces \u201c.9\u201d when converted back to one decimal digit but \u201c0.899999976\u201d when converted to nine decimal digits.)</p>\n\n<p>Since <code>double</code> guarantees that 15 digits survive a round trip, your number 78.352361 would survive a conversion to <code>double</code> and back to eight significant digits unchanged. Additionally, there is enough precision to perform some arithmetic without accumulating so much error that it is visible in eight significant decimal digits. However, floating-point arithmetic can be tricky, and a complete error analysis depends on the operations you perform.</p>\n"}, {"comments": [{"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1519220934, "post_id": 48906199, "comment_id": 84820893, "body": "I&#39;d probably use an explicit width integer type. On this platform, <code>long int</code> is likely to be 32 bits, which is big enough for six or seven decimal places, but I would be more comfortable with <code>int32_t</code> or even <code>int64_t</code>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1519227076, "post_id": 48906199, "comment_id": 84825349, "body": "On <i>any</i> platform, <code>long int</code> is guaranteed to be at least 32 bits.  (That&#39;s why I chose it.)  The exact-width types like <code>int32_t</code> do have their uses, but for me this isn&#39;t one of them."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 1, "last_activity_date": 1519217161, "last_edit_date": 1519217161, "creation_date": 1519216825, "answer_id": 48906199, "question_id": 48904533, "link": "https://stackoverflow.com/questions/48904533/floating-point-precision-not-matching-for-the-value-what-was-actually-assigned/48906199#48906199", "title": "Floating point precision not matching for the value what was actually assigned?", "body": "<p>You asked, \"isn't there any way to solve this?\" There are basically two ways:</p>\n\n<ol>\n<li>Understand the limitations of floating point, and learn how to work within them.</li>\n<li>Use fixed point, not floating point.</li>\n</ol>\n\n<p>The essential thing to understand about floating point is that there's no such number as, say, 17.445652 decimal. There's no such number as 17.445651999999999, either. Internally, the actual binary floating-point number is somewhere in between. That's just the way it is. So if you're using floating point, and you want, say, six digits of precision, and if you're using a format which guarantees six digits of precision (which <code>double</code> does, sort of), you're always going to need to round appropriately.  (You may also have to remember not to get confused if, say, your debugger shows you an unrounded value.)</p>\n\n<p>Or, if for whatever reason rounding is unacceptable, you can use fixed point, but you'll have to do it by hand, since it's not built in to the language.  Multiply all your latitudes and longitudes by 1000000, and store them internally as <code>long int</code>, and when you print them back out, stick in a <code>'.'</code> 6 places from the end.  For example:</p>\n\n<pre><code>long int latitude = 17445652;    /* microdegrees */\n\nprintf(\"latitude = %ld.%06ld\\n\", latitude / 1000000, latitude % 1000000);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "edited": false, "score": 0, "creation_date": 1519306437, "post_id": 48926872, "comment_id": 84863811, "body": "Thanks for the great info :)"}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 1, "last_activity_date": 1519301698, "last_edit_date": 1519301698, "creation_date": 1519300789, "answer_id": 48926872, "question_id": 48904533, "link": "https://stackoverflow.com/questions/48904533/floating-point-precision-not-matching-for-the-value-what-was-actually-assigned/48926872#48926872", "title": "Floating point precision not matching for the value what was actually assigned?", "body": "<p>In a comment you asked,</p>\n\n<blockquote>\n  <p>Can you please tell me how do you calculate the precision in terms of distance from the lat/lon degree value? Like what place after the decimal digit accounts for how much precision in terms of distance?</p>\n</blockquote>\n\n<p>This is obviously a totally separate question, and I probably shouldn't answer it here, but it's a fun problem, so I can't resist.  You can actually work it out from first principles.</p>\n\n<p>A nautical mile was originally defined as one minute of longitude at the equator.  So the earth's circumference is 360 x 60 = 21600 nautical miles.  And a nautical mile is 1852 meters, so that's 40003200 meters, or 40003.2 kilometers.  And this is a nice result, because the meter was originally defined as, I think, 1/40000000 of the earth's circumference pole-to-pole, so we're on the right track.</p>\n\n<p>With the earth's circumference (which is obviously 360 degrees) in hand, we can work out these distances:</p>\n\n<pre><code>degrees     distance (m)\n1           111120\n0.1         11112\n0.01        1111.2\n0.001       111.12\n0.0001      11.112\n0.00001     1.1112\n0.000001    0.1111\n0.0000001   0.0111\n0.00000001  0.0011\n</code></pre>\n\n<p>So 0.000001 degrees is about 0.1 meter, or 10 centimeters.  And 0.00000001 degrees is about a millimeter.</p>\n\n<p>Those numbers all apply to longitude at the equator, or to latitude anywhere.  For longitudes not at the equator, multiply by the cosine of the latitude.  (For example, I live at latitude 42. Here, 0.000001 degrees of longitude is about 0.111 x 0.743 = 0.082 meters = 8 cm.)</p>\n\n<p>These are all approximate results.  The earth is not a perfect sphere, and when you start doing precise navigation, it turns out this can make quite a difference, though not too much to the numbers I've shown here.</p>\n"}], "owner": {"reputation": 946, "user_id": 5405191, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-4P9RvEs8-eM/AAAAAAAAAAI/AAAAAAAAAA4/sRL7T9ciO7U/photo.jpg?sz=128", "display_name": "Akay", "link": "https://stackoverflow.com/users/5405191/akay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 48906068, "answer_count": 4, "score": 0, "last_activity_date": 1519301698, "creation_date": 1519211928, "last_edit_date": 1519216480, "question_id": 48904533, "link": "https://stackoverflow.com/questions/48904533/floating-point-precision-not-matching-for-the-value-what-was-actually-assigned", "title": "Floating point precision not matching for the value what was actually assigned?", "body": "<p>I am working on STM32F777 mcu creating application on top of FreeRTOS. STM32F777 comes with double-precision floating point unit. I found this really annoying issue while using floating point units that when I assign a value to a float using a constant or something, for example:</p>\n\n<pre><code>float x = 78.352361;\n</code></pre>\n\n<p>the actual value that I see assigned to variable x when debugging came out to be: <strong>78.3523636</strong></p>\n\n<p>Similarly, when I assigned <strong>17.448636</strong> to the variable x, what I actually saw assigned when debugging was <strong>17.4486351</strong>.</p>\n\n<p>Any ideas, why this is happening and how to resolve this? I want correct precision to be maintained till 6 digits.</p>\n"}, {"tags": ["html", "c", "cgi-bin"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1519212429, "post_id": 48904351, "comment_id": 84814945, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4166423/default-html-form-focus-without-javascript\">Default html form focus without JavaScript</a>"}], "answers": [{"tags": [], "owner": {"reputation": 174, "user_id": 4218925, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/q5Wf5.jpg?s=128&g=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/4218925/lorenzo"}, "is_accepted": true, "score": 0, "last_activity_date": 1519213930, "creation_date": 1519213930, "answer_id": 48905223, "question_id": 48904351, "link": "https://stackoverflow.com/questions/48904351/have-password-field-and-a-next-button-displayed-via-c-cgi-bin-html-i-want-the-f/48905223#48905223", "title": "Have password field and a next button displayed via c/cgi-bin/html. I want the focus to be in the password field when screen is displayed", "body": "<p><code>&lt;script type=\"text/javascript\"&gt;document.getElementById(\"HTMLElementID\").focus();&lt;/script&gt;</code> where HTMLElementID=id of the field in the form (you must insert id=\"...\" on the field in the form)</p>\n\n<p>Put this before closing the body tag of the page.</p>\n"}], "owner": {"reputation": 3, "user_id": 9390359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4eec38ca023662ba59bb8f698618c08?s=128&d=identicon&r=PG&f=1", "display_name": "WarwickW", "link": "https://stackoverflow.com/users/9390359/warwickw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 48905223, "answer_count": 1, "score": 0, "last_activity_date": 1519213930, "creation_date": 1519211311, "question_id": 48904351, "link": "https://stackoverflow.com/questions/48904351/have-password-field-and-a-next-button-displayed-via-c-cgi-bin-html-i-want-the-f", "title": "Have password field and a next button displayed via c/cgi-bin/html. I want the focus to be in the password field when screen is displayed", "body": "<p><a href=\"https://i.stack.imgur.com/Zd9ZV.jpg\" rel=\"nofollow noreferrer\">Initial screen</a></p>\n\n<p>a user logging into the displayed screen has to press tab or click in the password field to get to the password field and type the password. I want to hav focus in the password input box when the screen is displayed so that the user can immediately type the password.</p>\n\n<p>I am using a cgi form in c with the HTML/cgi-bin command \nand the password line is defined with:\n\nThese along with other code not relevant to the problem results in the attached screen being displayed.\nI have found out how to preset a radio button selection and a checkbox but have not found how to give focus to a password or text field on display of the screen. The fact that I can get there with a tab indicates that the focus is somewhere, just not where it needs to be.\nAnyone able to help? As is probably obvious I have been using these sorts of commands for only a short time but learn quickly. So please do not flame me for my ignorance.</p>\n"}, {"tags": ["c", "mutex", "semaphore", "esp8266", "freertos"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1519217878, "post_id": 48904107, "comment_id": 84818701, "body": "What calls the callbacks?   Thread? Interrupt-handler direct?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1519218938, "post_id": 48904107, "comment_id": 84819439, "body": "<i>I am trying to make sure that when button1 triggers a task, button2 is not able to trigger its task.</i> and <i>I am using this code, does it do the job? what happens if the two interrupts fire simultaneously?</i>.  These are questions you should be able to determine the answers to yourself.  Run the code.  Debug it."}, {"owner": {"reputation": 303, "user_id": 1149478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272093f1c20b3841fc5596d0249192fd?s=128&d=identicon&r=PG", "display_name": "ageorgios", "link": "https://stackoverflow.com/users/1149478/ageorgios"}, "edited": false, "score": 0, "creation_date": 1519219652, "post_id": 48904107, "comment_id": 84819962, "body": "TO:James Interrupt handlers call the button callbacks. TO:ryyker I cannot create a race condition on demand."}, {"owner": {"reputation": 141, "user_id": 9367000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fb686e6566b52da4ea86e877cc6851e?s=128&d=identicon&r=PG&f=1", "display_name": "NeverToLow", "link": "https://stackoverflow.com/users/9367000/nevertolow"}, "edited": false, "score": 1, "creation_date": 1519220785, "post_id": 48904107, "comment_id": 84820810, "body": "@ageorgios: I think it is possible that a race condition can occure. You have to look what&#39;s happening inside the taskcreate. I think this function is not attomic. But it depends on the implementation. It&#39;s possile that FreeRTOS disables all ISRs after function call. You could think about using a mutex (in FreeRTOS: SemaphoreHandle_t xSemaphoreCreateBinary())."}], "owner": {"reputation": 303, "user_id": 1149478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272093f1c20b3841fc5596d0249192fd?s=128&d=identicon&r=PG", "display_name": "ageorgios", "link": "https://stackoverflow.com/users/1149478/ageorgios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519213688, "creation_date": 1519210506, "last_edit_date": 1519213688, "question_id": 48904107, "link": "https://stackoverflow.com/questions/48904107/freertos-interlock-with-two-buttons", "title": "FreeRTOS interlock with two buttons", "body": "<p>I am trying to make sure that when button1 triggers a task, button2 is not able to trigger its task.</p>\n\n<p>I am using this code, does it do the job? what happens if the two interrupts fire simultaneously?</p>\n\n<pre><code>void button1_callback(uint8_t gpio_num, button_event_t event) {\n    if (up_task_handle == NULL &amp;&amp; down_task_handle == NULL) {\n        xTaskCreate(button1_task, \"UP Task\", 128, NULL, 2, up_task_handle);\n    }\n}\n\nvoid button2_callback(uint8_t gpio_num, button_event_t event) {\nif (up_task_handle == NULL &amp;&amp; down_task_handle == NULL) {\n    xTaskCreate(button2_task, \"DOWN Task\", 128, NULL, 2, down_task_handle);\n}\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "linked-list", "valgrind", "gcc7"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1519210342, "post_id": 48904029, "comment_id": 84813509, "body": "you used valgrind but you didn&#39; try with a debugger?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1519210831, "post_id": 48904029, "comment_id": 84813908, "body": "<code>current = ( *head )-&gt;next;     previous = current;</code> The firsdt time (just before the loop) these are equal."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1519211327, "post_id": 48904029, "comment_id": 84814236, "body": "@MichaelWalz Sorry about that, I did not wonted to create a bigger Output. Fixed anyway."}, {"owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "edited": false, "score": 0, "creation_date": 1519211787, "post_id": 48904029, "comment_id": 84814508, "body": "@Michi, If it has been fixed write your own answer so that other people know about it."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1519211806, "post_id": 48904029, "comment_id": 84814519, "body": "In <code>deleteInList</code>: <code>previous = current</code> -&gt;  <code>previous = *head;</code>"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1519211944, "post_id": 48904029, "comment_id": 84814609, "body": "@MichaelWalz You are right. You could point this as an Answer if you wont so that I can I accept it."}], "answers": [{"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1519212186, "post_id": 48904578, "comment_id": 84814776, "body": "Hm, I am so angry on me. I should notice that."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1519212299, "post_id": 48904578, "comment_id": 84814847, "body": "@Michi I suggest you lear how to use your debugger. It&#39;s time well invested."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1519212697, "post_id": 48904578, "comment_id": 84815143, "body": "I was trying, but I need to learn <code>GDB</code> to understand it. I am not so good with debuggers. I will learn More about it."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 1, "last_activity_date": 1519212282, "last_edit_date": 1519212282, "creation_date": 1519212052, "answer_id": 48904578, "question_id": 48904029, "link": "https://stackoverflow.com/questions/48904029/linked-list-does-not-remove-the-second-2-record-in-list-but-works-fine-for-all/48904578#48904578", "title": "Linked list does not remove the second (2) record in list but works fine for all others", "body": "<p>In <code>deleteInList</code>:</p>\n\n<pre><code>  ...\n  if ((*head)-&gt;data == val) {\n    return searchInList(head);\n  }\n\n  current = (*head)-&gt;next;\n  //  previous = current;   &lt;&lt; this is wrong\n  previous = *head;         // this is correct\n\n  while (current) {\n    if (current-&gt;data == val) {\n  ...\n</code></pre>\n\n<p>In your original code <code>previous</code> is the same as <code>current</code> during the first iteration.</p>\n\n<p>BTW: the <code>searchInList</code> function does not what it's name suggests.</p>\n"}, {"tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": false, "score": 0, "last_activity_date": 1519213693, "creation_date": 1519213693, "answer_id": 48905142, "question_id": 48904029, "link": "https://stackoverflow.com/questions/48904029/linked-list-does-not-remove-the-second-2-record-in-list-but-works-fine-for-all/48905142#48905142", "title": "Linked list does not remove the second (2) record in list but works fine for all others", "body": "<p>[stylistic]</p>\n\n<ul>\n<li>You are using too many variables, which all need to be kept in-sync.</li>\n<li>You are creating special cases for the <code>*head</code> node, causing multiple code paths.</li>\n</ul>\n\n<p>Avoiding special cases will reduce the code to one loop, with one extra condition and one extra variable:</p>\n\n<hr>\n\n<pre><code>int deleteInList( struct node ** head, const int val ) \n{\nstruct node *current;\n\nfor( ; (current = *head); head = &amp;current-&gt;next) {\n        if (current-&gt;data != val) continue;\n        *head = current-&gt;next;\n        free(current);\n        return val;\n        }\n\nreturn -1;\n}\n</code></pre>\n"}], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 48904578, "answer_count": 2, "score": 0, "last_activity_date": 1519214204, "creation_date": 1519210276, "last_edit_date": 1519214204, "question_id": 48904029, "link": "https://stackoverflow.com/questions/48904029/linked-list-does-not-remove-the-second-2-record-in-list-but-works-fine-for-all", "title": "Linked list does not remove the second (2) record in list but works fine for all others", "body": "<p>I really do not understand what happens with my Program because it seems that it works fine when I try to remove any record found in linked List.</p>\n\n<p>The problem comes when I try to remove the record <code>2</code> it does not remove it and prints instead <code>0</code>.</p>\n\n<p>Here is the working program which can be verified:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct node{\n    int data;\n    struct node *next;\n};\n\nvoid printList( struct node  *head );\nvoid freeList ( struct node **head );\nvoid createList ( struct node **head, const int val );\nint searchInList( struct node **head);\nint deleteInList( struct node **head, const int val );\n\nint main ( void ){\n    struct node *head = NULL;\n\n    int listLen = 5;\n    int remove = 3;\n\n    createList ( &amp;head , listLen );\n    printf(\"\\t\\tBefore:\\n\");\n    printList( head );\n\n    if ( deleteInList( &amp;head, remove ) == -1 ){\n        printf(\"No result found!\\n\\t\\tNothing here to be deleted\\n\");\n    }else{\n        printf(\"\\t\\tAfter:\\n\");\n        printList( head );\n    }\n\n    freeList( &amp;head );\n}\n\nvoid printList( struct node *head ){\n    struct node *current = head;\n\n    while ( current != NULL ){\n        printf(\"Data = %d\\n\",  current-&gt;data );\n        current = current-&gt;next;\n    }\n    printf(\"\\n\\n\");\n}\n\nvoid freeList ( struct node **head ){\n    struct node *current = *head;\n    while ( current != NULL ){\n        struct node *tmp = current-&gt;next;\n        free( current );\n        current = tmp;\n    }\n}\n\nvoid createList ( struct node **head, const int val ){\n    struct node *current;\n    for( int i = val ; i &gt; 0 ; i-- ) {\n        current = malloc( sizeof( struct node ) );\n        current-&gt;data = i;\n        current-&gt;next  = *head;\n        *head = current;\n    }\n}\n\nint searchInList( struct node ** head) {\n    int retval = -1;\n    struct node *next = NULL;\n\n    if (*head == NULL) {\n        return -1;\n    }\n\n    next = (*head)-&gt;next;\n    retval = (*head)-&gt;data;\n    free(*head);\n    *head = next;\n\n    return retval;\n}\n\nint deleteInList( struct node ** head, const int val ) {\n    struct node *previous, *current;\n\n    if (*head == NULL) {\n        return -1;\n    }\n\n    if ( ( *head )-&gt;data == val ) {\n        return searchInList( head );\n    }\n\n    current = ( *head )-&gt;next;\n    previous = current;\n\n    while ( current ) {\n        if ( current-&gt;data == val ) {\n            previous-&gt;next = current-&gt;next;\n            free( current );\n            return val;\n        }\n\n        previous = current;\n        current  = current-&gt;next;\n    }\n    return -1;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>        Before:\nData = 1\nData = 2\nData = 3\nData = 4\nData = 5\n\n\n        After:\nData = 1\nData = 2\nData = 4\nData = 5\n</code></pre>\n\n<p>And the program looks fine, but if I replace <code>int remove = 3;</code> with <code>int remove = 2;</code> it does not work because i get:</p>\n\n<pre><code>Data = 1\nData = 2\nData = 3\nData = 4\nData = 5\n\n\n        After:\nData = 1\nData = 0\nData = 3\nData = 4\nData = 5\n</code></pre>\n\n<p>When the expected Output should be:</p>\n\n<pre><code>        After:\nData = 1\nData = 3\nData = 4\nData = 5\n</code></pre>\n\n<p>And looking at <code>Valgrind</code> I noticed that I have one <code>free</code> more:</p>\n\n<pre><code>==9107== HEAP SUMMARY:\n==9107==     in use at exit: 0 bytes in 0 blocks\n==9107==   total heap usage: 6 allocs, 7 frees, 1,104 bytes allocate\n</code></pre>\n\n<p>And I cannot figure out whats happening.</p>\n\n<p>Here is the whole <code>Valgrind</code> report:</p>\n\n<pre><code>==9107== Memcheck, a memory error detector\n==9107== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==9107== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\n==9107== Command: ./program\n==9107== \n        Before:\nData = 1\nData = 2\nData = 3\nData = 4\nData = 5\n\n\n        After:\nData = 1\n==9107== Invalid read of size 4\n==9107==    at 0x400714: printList (program.c:39)\n==9107==    by 0x4006D2: main (program.c:29)\n==9107==  Address 0x5204130 is 0 bytes inside a block of size 16 free'd\n==9107==    at 0x4C2EDEB: free (vg_replace_malloc.c:530)\n==9107==    by 0x4008C7: deleteInList (program.c:97)\n==9107==    by 0x4006AB: main (program.c:25)\n==9107==  Block was alloc'd at\n==9107==    at 0x4C2DB8F: malloc (vg_replace_malloc.c:299)\n==9107==    by 0x4007AA: createList (program.c:57)\n==9107==    by 0x400684: main (program.c:21)\n==9107== \nData = 2\n==9107== Invalid read of size 8\n==9107==    at 0x40072B: printList (program.c:40)\n==9107==    by 0x4006D2: main (program.c:29)\n==9107==  Address 0x5204138 is 8 bytes inside a block of size 16 free'd\n==9107==    at 0x4C2EDEB: free (vg_replace_malloc.c:530)\n==9107==    by 0x4008C7: deleteInList (program.c:97)\n==9107==    by 0x4006AB: main (program.c:25)\n==9107==  Block was alloc'd at\n==9107==    at 0x4C2DB8F: malloc (vg_replace_malloc.c:299)\n==9107==    by 0x4007AA: createList (program.c:57)\n==9107==    by 0x400684: main (program.c:21)\n==9107== \nData = 3\nData = 4\nData = 5\n\n\n==9107== Invalid read of size 8\n==9107==    at 0x400764: freeList (program.c:48)\n==9107==    by 0x4006DE: main (program.c:32)\n==9107==  Address 0x5204138 is 8 bytes inside a block of size 16 free'd\n==9107==    at 0x4C2EDEB: free (vg_replace_malloc.c:530)\n==9107==    by 0x4008C7: deleteInList (program.c:97)\n==9107==    by 0x4006AB: main (program.c:25)\n==9107==  Block was alloc'd at\n==9107==    at 0x4C2DB8F: malloc (vg_replace_malloc.c:299)\n==9107==    by 0x4007AA: createList (program.c:57)\n==9107==    by 0x400684: main (program.c:21)\n==9107== \n==9107== Invalid free() / delete / delete[] / realloc()\n==9107==    at 0x4C2EDEB: free (vg_replace_malloc.c:530)\n==9107==    by 0x400777: freeList (program.c:49)\n==9107==    by 0x4006DE: main (program.c:32)\n==9107==  Address 0x5204130 is 0 bytes inside a block of size 16 free'd\n==9107==    at 0x4C2EDEB: free (vg_replace_malloc.c:530)\n==9107==    by 0x4008C7: deleteInList (program.c:97)\n==9107==    by 0x4006AB: main (program.c:25)\n==9107==  Block was alloc'd at\n==9107==    at 0x4C2DB8F: malloc (vg_replace_malloc.c:299)\n==9107==    by 0x4007AA: createList (program.c:57)\n==9107==    by 0x400684: main (program.c:21)\n==9107== \n==9107== \n==9107== HEAP SUMMARY:\n==9107==     in use at exit: 0 bytes in 0 blocks\n==9107==   total heap usage: 6 allocs, 7 frees, 1,104 bytes allocated\n==9107== \n==9107== All heap blocks were freed -- no leaks are possible\n==9107== \n==9107== For counts of detected and suppressed errors, rerun with: -v\n==9107== ERROR SUMMARY: 4 errors from 4 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>I am on Linux mint 18.3 with <code>GCC-7</code></p>\n"}, {"tags": ["c", "time", "embedded", "stm32", "execution"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 251, "user_id": 8759433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b8o5t.jpg?s=128&g=1", "display_name": "Booma", "link": "https://stackoverflow.com/users/8759433/booma"}, "edited": false, "score": 0, "creation_date": 1519210223, "post_id": 48903510, "comment_id": 84813408, "body": "@Booma Are you serious? <code>while(i)</code> is the same as <code>while(i != 0)</code>."}, {"owner": {"reputation": 1255, "user_id": 797152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589f919cfbda3d80cd71fa93e65afb10?s=128&d=identicon&r=PG", "display_name": "aja", "link": "https://stackoverflow.com/users/797152/aja"}, "reply_to_user": {"reputation": 251, "user_id": 8759433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b8o5t.jpg?s=128&g=1", "display_name": "Booma", "link": "https://stackoverflow.com/users/8759433/booma"}, "edited": false, "score": 0, "creation_date": 1519210302, "post_id": 48903510, "comment_id": 84813474, "body": "@Booma while(i) is equivalent to while(i != 0)"}, {"owner": {"reputation": 251, "user_id": 8759433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b8o5t.jpg?s=128&g=1", "display_name": "Booma", "link": "https://stackoverflow.com/users/8759433/booma"}, "edited": false, "score": 0, "creation_date": 1519210333, "post_id": 48903510, "comment_id": 84813500, "body": "Sorry for that. Too long time ago that I actively used C and my teaching prof always told us to use full expressions -.-"}, {"owner": {"reputation": 1255, "user_id": 797152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589f919cfbda3d80cd71fa93e65afb10?s=128&d=identicon&r=PG", "display_name": "aja", "link": "https://stackoverflow.com/users/797152/aja"}, "reply_to_user": {"reputation": 251, "user_id": 8759433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b8o5t.jpg?s=128&g=1", "display_name": "Booma", "link": "https://stackoverflow.com/users/8759433/booma"}, "edited": false, "score": 0, "creation_date": 1519210567, "post_id": 48903510, "comment_id": 84813702, "body": "@Booma no worries...the problem with full expressions is that it is too easy to mistakenly code while(i = 0) ... which is a disaster"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1519220561, "post_id": 48903510, "comment_id": 84820663, "body": "swap count= and count2= add a mask the size of the timer if 16 bits then count=(count2-count1)&amp;0xFFFF; for example."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1519220684, "post_id": 48903510, "comment_id": 84820742, "body": "and understand your measurement is for that run/build, add or remove code dont be surprised if the time changes (add a nop or two or three to your bootstrap for example).  it is an stm32 so there is a cache in front of the flash you cant turn off, but there are times when it misses and you get the real flash exposed."}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "edited": false, "score": 0, "creation_date": 1519222736, "post_id": 48903510, "comment_id": 84822101, "body": "The code is incomplete, the definition of <code>MX_TIM2_Init()</code> is missing. We won&#39;t be able to help without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1255, "user_id": 797152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589f919cfbda3d80cd71fa93e65afb10?s=128&d=identicon&r=PG", "display_name": "aja", "link": "https://stackoverflow.com/users/797152/aja"}, "edited": false, "score": 0, "creation_date": 1519229435, "post_id": 48903510, "comment_id": 84827058, "body": "@aja That&#39;s a nonsense argument from the early 1980s. In the late 80s compilers started to give warnings for assignment in expressions, as they should. Since then, this is a none-issue."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1519242296, "post_id": 48903510, "comment_id": 84834669, "body": "also note that if this takes seconds to run your prescaler should be such that the timer doesnt roll more than a full cycle otherwise you are only getting the remainder not the whole time measurement.  start with a simpler experiment, read the time, do a small delay, read the time, print/save the two time measurements and view them.   change the delay, see the time measurements change.  then do the subtract, see that that works, then get more complicated..."}, {"owner": {"reputation": 970, "user_id": 1734303, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6ee80feb1a2c3ecd7c5f3e1ed8927419?s=128&d=identicon&r=PG", "display_name": "cowboydan", "link": "https://stackoverflow.com/users/1734303/cowboydan"}, "edited": false, "score": 0, "creation_date": 1519780864, "post_id": 48903510, "comment_id": 85046322, "body": "Unless I&#39;m missing something, count2 and count1 are uninitialized (and not clear - to me, if they are accessed by other functions. If you&#39;re lucky, they&#39;re initialized to 0, which explains why count2 and count1 are zero towards the end of the code"}], "answers": [{"comments": [{"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1519242413, "post_id": 48904076, "comment_id": 84834734, "body": "unless you know the timer is a 32 bit timer you need a mask along with the subtract to get the correct value.  (now - last)&amp;MASK."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1519290128, "post_id": 48904076, "comment_id": 84852843, "body": "@old_timer It happens to be a 32-bit timer, but I don&#39;t think it matters. Even assuming 16 bits the expression would still be valid, just as it would if the 32-bit timer happened to return values that fit in 16 bits. Also, your handle is very appropriate for this comment."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1519307319, "post_id": 48904076, "comment_id": 84864463, "body": "0x12 - 0xE0 = 0xFFFFFF32 which is the incorrect answer if this were an 8 bit counter but (0x12 - 0xE0)&amp;0xFF = 0x32 which is the correct answer, you have to ALWAYS mask if you want to use a free running timer to measure time by subtracting end from beginning for an up counter or beginning minus end for a down counter.Sometimes you can take a shortcut if you know the variables being used and instructions being generated are doing the masking for you otherwise you have to explicitly add the mask.If you optimize then you can always apply the mask and the optimizer will remove it as needed."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1519377807, "post_id": 48904076, "comment_id": 84895895, "body": "@old_timer That makes sense, I blame confusion. Thanks."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 1, "last_activity_date": 1519210423, "creation_date": 1519210423, "answer_id": 48904076, "question_id": 48903510, "link": "https://stackoverflow.com/questions/48903510/how-to-find-the-execution-time-in-stm32f3xx/48904076#48904076", "title": "How to find the execution time in stm32f3xx?", "body": "<p>This:</p>\n\n<pre><code>count=count2-count1;\ncount2= __HAL_TIM_GET_COUNTER(&amp;htim2);\n</code></pre>\n\n<p>makes no sense at all, you're subtracting from <code>count2</code> before refreshing it from the timer?</p>\n\n<p>It should perhaps be:</p>\n\n<pre><code>const uint32_t now = __HAL_TIM_GET_COUNTER(&amp;htim2);\ncount += now - last;\nlast = now;\n</code></pre>\n\n<p>With <code>uint32_t last = __HAL_TIM_GET_COUNTER(&amp;htim2);</code> before the loop.</p>\n"}, {"tags": [], "owner": {"reputation": 1638, "user_id": 453340, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/i8oYZ.png?s=128&g=1", "display_name": "Miro Samek", "link": "https://stackoverflow.com/users/453340/miro-samek"}, "is_accepted": false, "score": 1, "last_activity_date": 1519676162, "creation_date": 1519676162, "answer_id": 48996398, "question_id": 48903510, "link": "https://stackoverflow.com/questions/48903510/how-to-find-the-execution-time-in-stm32f3xx/48996398#48996398", "title": "How to find the execution time in stm32f3xx?", "body": "<p>Newer ARM Cortex-M3/4/7 devices provide a register called CYCLECOUNTER, which can be often inspected in a debugger even without using any additional timer/counter and without adding any instrumentation to the code. The technique is described for example in the IAR AppNote \"How to measure execution time with CYCLECOUNTER\" at:</p>\n\n<p><a href=\"https://www.iar.com/support/resources/articles/how-to-measure-execution-time-with-cyclecounter/\" rel=\"nofollow noreferrer\">https://www.iar.com/support/resources/articles/how-to-measure-execution-time-with-cyclecounter/</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9260553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f389a4b8314e442e42c06eb8e3d070e?s=128&d=identicon&r=PG&f=1", "display_name": "ballack", "link": "https://stackoverflow.com/users/9260553/ballack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1842, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519676162, "creation_date": 1519208757, "last_edit_date": 1519213818, "question_id": 48903510, "link": "https://stackoverflow.com/questions/48903510/how-to-find-the-execution-time-in-stm32f3xx", "title": "How to find the execution time in stm32f3xx?", "body": "<pre><code>#include \"main.h\"\n#include \"stm32f3xx_hal.h\"\n#include&lt;time.h&gt;\n\nTIM_HandleTypeDef htim2\nvoid SystemClock_Config(void);\nstatic void MX_GPIO_Init(void);\nstatic void MX_TIM2_Init(void);\nlong int count1,count2,count,i=5;\n\n\nint main(void)\n{\n    HAL_Init();\n\n    SystemClock_Config();\n\n    MX_GPIO_Init();\n    MX_TIM2_Init();\n    HAL_TIM_Base_Init(&amp;htim2);\n    HAL_TIM_Base_Start(&amp;htim2);\n\n    count1= __HAL_TIM_GET_COUNTER(&amp;htim2);\n\n    while (i)\n    {\n        HAL_GPIO_WritePin(GPIOB,GPIO_PIN_3,GPIO_PIN_SET);\n        HAL_Delay(50000);\n        HAL_GPIO_WritePin(GPIOB,GPIO_PIN_3,GPIO_PIN_RESET);\n        HAL_Delay(10000);       \n        i--;\n    } \n    count=count2-count1;\n    count2= __HAL_TIM_GET_COUNTER(&amp;htim2);\n}\n</code></pre>\n\n<p>The code output is always 0. I am unable to obtain the count values. can anyone tell me why it is not executing? I am using STM32F303k8 microcontroller. The count values are always zero, even though it takes few minutes to execute completely!!</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c", "mplab"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1519208563, "post_id": 48903387, "comment_id": 84812215, "body": "You need to read a whole line (possibly terminated by <code>\\n</code>) and then <code>sscanf</code> that line. But the question is too broad. Be more explicit."}, {"owner": {"reputation": 41, "user_id": 9300384, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/3df8473c2f67fd3f5e4406ab4f20026b?s=128&d=identicon&r=PG&f=1", "display_name": "Dim", "link": "https://stackoverflow.com/users/9300384/dim"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1519208712, "post_id": 48903387, "comment_id": 84812345, "body": "I dont mind if i will read it at once or separated. The problem is that sscanf doesnt work in xc8. I get (499) undefined symbol:"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1519209222, "post_id": 48903387, "comment_id": 84812695, "body": "If <code>sscanf</code> is not available on your platform, you need to parse the string yourself. Very basically: for scanning an <code>int</code> you need to read characters from the UART and put them into a buffer until you get a character different from <code>&#39;0&#39;..&#39;9&#39;</code>, then convert the string in the buffer to an <code>int</code> using e.g <code>atoi</code>. or <code>strtol</code>."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1519218239, "post_id": 48903387, "comment_id": 84818949, "body": "How does your protocol work?  What marks the end of that &#39;line&#39;?"}], "owner": {"reputation": 41, "user_id": 9300384, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/3df8473c2f67fd3f5e4406ab4f20026b?s=128&d=identicon&r=PG&f=1", "display_name": "Dim", "link": "https://stackoverflow.com/users/9300384/dim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 570, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519208381, "creation_date": 1519208381, "question_id": 48903387, "link": "https://stackoverflow.com/questions/48903387/read-from-uart-character-string-and-interger", "title": "Read from uart character,string and interger", "body": "<p>I'm using mplab(XC8-PIC18F45K22) and i need to printf char or string or interger.\nAlso i need to read this:</p>\n\n<p>My printf works very well!</p>\n\n<pre><code>  printf(\"%c, %s , %d , %f \",'C',\"String\", 1 , 2.5f);\n</code></pre>\n\n<p>But i cant read this line:\nscanf doesnt work in Xc8.</p>\n\n<p>The only thing that i can read from uart is character</p>\n\n<pre><code>char test=getch();\nsprintf(txt,\"You typed '%c'\",test);\nLCDPutStr(txt, 17);\n</code></pre>\n\n<p>How can i do the same for string or interger?</p>\n"}, {"tags": ["c", "ffmpeg", "video-processing"], "answers": [{"comments": [{"owner": {"reputation": 717, "user_id": 7785387, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eY4ka.jpg?s=128&g=1", "display_name": "tavalendo", "link": "https://stackoverflow.com/users/7785387/tavalendo"}, "edited": false, "score": 0, "creation_date": 1519219140, "post_id": 48903825, "comment_id": 84819561, "body": "Thanks! Very helpful."}], "tags": [], "owner": {"reputation": 61761, "user_id": 5726027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15e6b3536ef969cf3a9828a0542aac2?s=128&d=identicon&r=PG", "display_name": "Gyan", "link": "https://stackoverflow.com/users/5726027/gyan"}, "is_accepted": true, "score": 0, "last_activity_date": 1519209612, "creation_date": 1519209612, "answer_id": 48903825, "question_id": 48902338, "link": "https://stackoverflow.com/questions/48902338/vf-codecview-c-printing-motion-vectors-in-future-only/48903825#48903825", "title": "vf_codecview.c printing motion vectors in &#39;future&#39; only", "body": "<p>Doesn't appear to be the case</p>\n\n<p><code>source</code> can take on either positive or negative value.</p>\n\n<pre><code>/**\n * Where the current macroblock comes from; negative value when it comes\n * from the past, positive value when it comes from the future.\n * XXX: set exact relative ref frame reference instead of a +/- 1 \"direction\".\n */\nint32_t source;\n</code></pre>\n\n<p>In the call you linked to, we have</p>\n\n<pre><code>if ((direction == 0 &amp;&amp; (s-&gt;mv &amp; MV_P_FOR)  &amp;&amp; frame-&gt;pict_type == AV_PICTURE_TYPE_P) ||\n    (direction == 0 &amp;&amp; (s-&gt;mv &amp; MV_B_FOR)  &amp;&amp; frame-&gt;pict_type == AV_PICTURE_TYPE_B) ||\n    (direction == 1 &amp;&amp; (s-&gt;mv &amp; MV_B_BACK) &amp;&amp; frame-&gt;pict_type == AV_PICTURE_TYPE_B))\n    draw_arrow(frame-&gt;data[0], mv-&gt;dst_x, mv-&gt;dst_y, mv-&gt;src_x, mv-&gt;src_y,\n              frame-&gt;width, frame-&gt;height, frame-&gt;linesize[0],\n              100, 0, mv-&gt;source &gt; 0);\n</code></pre>\n\n<p>If the macroblock is predicted from a past frame, the last expression evaluates to and is passed as <code>0</code>, else <code>1</code>.</p>\n\n<p>The conditional clearly allows for both past- and future- predicted macroblocks.</p>\n\n<p>P.S. you are looking at the source for ver <code>2.5</code>, which is very old, at this point. Current version is at <a href=\"https://ffmpeg.org/doxygen/trunk/vf__codecview_8c_source.html#l00256\" rel=\"nofollow noreferrer\">https://ffmpeg.org/doxygen/trunk/vf__codecview_8c_source.html#l00256</a></p>\n"}], "owner": {"reputation": 717, "user_id": 7785387, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eY4ka.jpg?s=128&g=1", "display_name": "tavalendo", "link": "https://stackoverflow.com/users/7785387/tavalendo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 48903825, "answer_count": 1, "score": 0, "last_activity_date": 1519209612, "creation_date": 1519205415, "last_edit_date": 1519205907, "question_id": 48902338, "link": "https://stackoverflow.com/questions/48902338/vf-codecview-c-printing-motion-vectors-in-future-only", "title": "vf_codecview.c printing motion vectors in &#39;future&#39; only", "body": "<p>I am trying to understand the way ffmpeg draws motion vectors.</p>\n\n<p>I went through the <code>vf_codecview.c</code> file and saw the function <a href=\"https://ffmpeg.org/doxygen/2.5/vf__codecview_8c_source.html#l00209\" rel=\"nofollow noreferrer\"><code>draw_arrow</code></a> which takes only those vectors where <code>source &gt; 0</code> implying only those from the future.</p>\n\n<p>Does anyone know why is this? And what's the use of computing past and future, if ffmpeg through this file takes only the future?</p>\n"}, {"tags": ["c", "multidimensional-array"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1519204249, "post_id": 48901800, "comment_id": 84809086, "body": "I suggest you take a debugger and step thru the program. There is definitely something wrong with your indexes."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1519204635, "post_id": 48901800, "comment_id": 84809312, "body": "Is any student or subject name more than nine characters?"}, {"owner": {"reputation": 141, "user_id": 9367000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fb686e6566b52da4ea86e877cc6851e?s=128&d=identicon&r=PG&f=1", "display_name": "NeverToLow", "link": "https://stackoverflow.com/users/9367000/nevertolow"}, "edited": false, "score": 0, "creation_date": 1519204726, "post_id": 48901800, "comment_id": 84809378, "body": "Why don&#39;t you use subject[f]? I think subject is a char** and you want to have a char*... The two dimensional array is a Pointer to a Pointer. While you want to write in a char*."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9368425, "user_type": "registered", "profile_image": "https://graph.facebook.com/1560864553961543/picture?type=large", "display_name": "Aabshar Ahmed", "link": "https://stackoverflow.com/users/9368425/aabshar-ahmed"}, "edited": false, "score": 0, "creation_date": 1519283745, "post_id": 48902155, "comment_id": 84849455, "body": "i understand but it doesnt seem to have any difference to the result.. though i corrected it."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1519205334, "last_edit_date": 1519205334, "creation_date": 1519204916, "answer_id": 48902155, "question_id": 48901800, "link": "https://stackoverflow.com/questions/48901800/program-returning-garbage-values-even-after-declaring-variables-in-c/48902155#48902155", "title": "program returning garbage values even after declaring variables in c", "body": "<p>Besides the problem with length of names and subjects, this here is a major problem:</p>\n\n<pre><code>(subject+k)\n</code></pre>\n\n<p>You are probably misunderstanding the <code>subject[k]</code> and <code>*(subject + k)</code> equivalent.</p>\n\n<p>The variable <code>subject</code> is an array of arrays. That means <code>subject[i]</code> is an array (of <code>char</code> and can be used as a zero-terminated string).</p>\n\n<p>The expression <code>(subject + k)</code> is a pointer to the array in <code>subject[k]</code>. It's equal to <code>&amp;subject[k]</code> which have the type <code>char (*)[10]</code>. It's can not be used as a zero-terminated string without dereferencing. So either use <code>*(subject + k)</code> or the simple, less-to-write and easier-to-read <code>subject[k]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 9368425, "user_type": "registered", "profile_image": "https://graph.facebook.com/1560864553961543/picture?type=large", "display_name": "Aabshar Ahmed", "link": "https://stackoverflow.com/users/9368425/aabshar-ahmed"}, "edited": false, "score": 0, "creation_date": 1519282245, "post_id": 48902340, "comment_id": 84848737, "body": "it works now , but the code <code>for(j=a;j&lt;reference;j++)                 {                     printf(&quot;enter marks of %s\\n&quot;,(subject[k]));                     scanf(&quot;%d&quot;,(marks+j));                     k++;                 }</code>  returns one extra loop when i take subject and size more than 2."}, {"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "reply_to_user": {"reputation": 23, "user_id": 9368425, "user_type": "registered", "profile_image": "https://graph.facebook.com/1560864553961543/picture?type=large", "display_name": "Aabshar Ahmed", "link": "https://stackoverflow.com/users/9368425/aabshar-ahmed"}, "edited": false, "score": 0, "creation_date": 1519282576, "post_id": 48902340, "comment_id": 84848882, "body": "can you update the question with your current complete code?"}, {"owner": {"reputation": 23, "user_id": 9368425, "user_type": "registered", "profile_image": "https://graph.facebook.com/1560864553961543/picture?type=large", "display_name": "Aabshar Ahmed", "link": "https://stackoverflow.com/users/9368425/aabshar-ahmed"}, "edited": false, "score": 0, "creation_date": 1519283582, "post_id": 48902340, "comment_id": 84849360, "body": "i updated it. it works fine as long as i not enter the size more than 2."}, {"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "reply_to_user": {"reputation": 23, "user_id": 9368425, "user_type": "registered", "profile_image": "https://graph.facebook.com/1560864553961543/picture?type=large", "display_name": "Aabshar Ahmed", "link": "https://stackoverflow.com/users/9368425/aabshar-ahmed"}, "edited": false, "score": 0, "creation_date": 1519284041, "post_id": 48902340, "comment_id": 84849630, "body": "add this debug statement just before you prompt for the marks and I think you will see what is going on <code>printf(&quot;%d..%d\\n&quot;, j, reference);</code>"}, {"owner": {"reputation": 23, "user_id": 9368425, "user_type": "registered", "profile_image": "https://graph.facebook.com/1560864553961543/picture?type=large", "display_name": "Aabshar Ahmed", "link": "https://stackoverflow.com/users/9368425/aabshar-ahmed"}, "edited": false, "score": 0, "creation_date": 1519289760, "post_id": 48902340, "comment_id": 84852611, "body": "thankyou. the problem was with <code>reference=reference + j;</code> . so i changed it to <code>reference=sub+j</code>"}, {"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "reply_to_user": {"reputation": 23, "user_id": 9368425, "user_type": "registered", "profile_image": "https://graph.facebook.com/1560864553961543/picture?type=large", "display_name": "Aabshar Ahmed", "link": "https://stackoverflow.com/users/9368425/aabshar-ahmed"}, "edited": false, "score": 0, "creation_date": 1519290179, "post_id": 48902340, "comment_id": 84852872, "body": "Exactly !!  Good job figuring it out."}], "tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": true, "score": 0, "last_activity_date": 1519205419, "creation_date": 1519205419, "answer_id": 48902340, "question_id": 48901800, "link": "https://stackoverflow.com/questions/48901800/program-returning-garbage-values-even-after-declaring-variables-in-c/48902340#48902340", "title": "program returning garbage values even after declaring variables in c", "body": "<p>I think you also need to change</p>\n\n<pre><code>int marks[sub];\n</code></pre>\n\n<p>to</p>\n\n<pre><code>int marks[size * sub];\n</code></pre>\n\n<p>one mark for each subject for each student, correct?</p>\n"}], "owner": {"reputation": 23, "user_id": 9368425, "user_type": "registered", "profile_image": "https://graph.facebook.com/1560864553961543/picture?type=large", "display_name": "Aabshar Ahmed", "link": "https://stackoverflow.com/users/9368425/aabshar-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 48902340, "answer_count": 2, "score": 2, "last_activity_date": 1519289939, "creation_date": 1519203784, "last_edit_date": 1519289939, "question_id": 48901800, "link": "https://stackoverflow.com/questions/48901800/program-returning-garbage-values-even-after-declaring-variables-in-c", "title": "program returning garbage values even after declaring variables in c", "body": "<p><strong>how do i correct this</strong></p>\n\n<blockquote>\n  <p>i didn't use structure intentionally\n  this is a program to input student's name, subject and marks.\n  in the last block, the array (subject+f) 's 1st subscript is returning garbage values while the rest subscript are returning desired result.\n  i have also posted the image of output as link.</p>\n</blockquote>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nint main()\n\n{\n\nint size,i,k,sub,a=0,reference;\n\n\n    int temp,sorted;\n    char temp_s[10];\n    char temp_sb[10];\n\n    printf(\"enter the size of class\\n\");\n    scanf(\"%d\",&amp;size);\n    printf(\"how many subjects are there?\\n\");\n    scanf(\"%d\",&amp;sub);\n    reference = sub;\n    char name[size][20];\n    char subject[size*sub][20];\n    int marks[sub*size];\n    int total,subtotal,retotal;\n    for(k=0;k&lt;sub;k++)\n    {\n    printf(\"so what's  the no. %d subject\\n\",k+1);\n    scanf(\" %s\",(subject[k]));\n    }\n\n    for(i=0;i&lt;size;i++)\n        {\n\n            int j,k=0;\n            printf(\"Enter a name of student %d\\n\",i+1);\n            scanf(\" %s\",(name+i));\n\n\n                for(j=a;j&lt;reference;j++)\n                {\n                    printf(\"enter marks of %s\\n\",(subject[k]));\n                    scanf(\"%d\",(marks+j));\n                    k++;\n                }\n\n                a=j;\n                reference=sub+j;\n\n\n        }\n\n    reference=sub;\n    a=0;\n\n\n    printf(\"\\n list of students and marks:\\n\");\n    for(i=0;i&lt;size;i++)\n        {\n            int j,f=0;\n            printf(\"%s\\n\",(name+i));\n            for(j=a;j&lt;reference;j++)\n            {\n                 printf(\"%s %d\\n\",(subject[f]),(marks[j]));\n                 f++;\n            }\n            a=j;\n            reference=sub+j;\n\n        }\n}\n</code></pre>\n"}, {"tags": ["c", "arduino", "compare"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 6, "creation_date": 1519203925, "post_id": 48901772, "comment_id": 84808881, "body": "<code>cmd</code> is a <i>pointer</i> to a <code>char</code>. You try to compare <code>command</code> to the <i>pointer</i>. Now think a little, how can you get a single <code>char</code> element from a string?"}, {"owner": {"reputation": 141, "user_id": 9367000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fb686e6566b52da4ea86e877cc6851e?s=128&d=identicon&r=PG&f=1", "display_name": "NeverToLow", "link": "https://stackoverflow.com/users/9367000/nevertolow"}, "edited": false, "score": 0, "creation_date": 1519203948, "post_id": 48901772, "comment_id": 84808892, "body": "The programmer dude was faster. I agree that this will solve ayour problem."}, {"owner": {"reputation": 1999, "user_id": 95306, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e6fc63d053d69a2afea8e5fb120e639f?s=128&d=identicon&r=PG", "display_name": "Bob Jones", "link": "https://stackoverflow.com/users/95306/bob-jones"}, "edited": false, "score": 1, "creation_date": 1519245738, "post_id": 48901772, "comment_id": 84836568, "body": "The answer from iBug (see below) shows that my question was clear and easily understandable and not &quot;off topic&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1632, "user_id": 7462657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/da6cde7de38cf0b6686e85193273b12f?s=128&d=identicon&r=PG&f=1", "display_name": "xander", "link": "https://stackoverflow.com/users/7462657/xander"}, "edited": false, "score": 1, "creation_date": 1519204243, "post_id": 48901885, "comment_id": 84809081, "body": "For better understanding <code>char cmd = commandNames[i][1][0]</code> should also work."}, {"owner": {"reputation": 1999, "user_id": 95306, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e6fc63d053d69a2afea8e5fb120e639f?s=128&d=identicon&r=PG", "display_name": "Bob Jones", "link": "https://stackoverflow.com/users/95306/bob-jones"}, "edited": false, "score": 1, "creation_date": 1519245657, "post_id": 48901885, "comment_id": 84836523, "body": "Thanks - simple answer that worked immediately."}], "tags": [], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "is_accepted": true, "score": 2, "last_activity_date": 1519204286, "last_edit_date": 1519204286, "creation_date": 1519204079, "answer_id": 48901885, "question_id": 48901772, "link": "https://stackoverflow.com/questions/48901772/compare-c-char-and-char/48901885#48901885", "title": "Compare C char and char*", "body": "<p>It seems you're just comparing a character given from sorta input with a 1-char string. So you just dereference the pointer and compare the character:</p>\n\n<pre><code>command == *cmd\n           ^\n</code></pre>\n\n<p>And since <code>cmd</code> is of type <code>char*</code>, there's no need for type casting again, so I dropped the cast (<code>(char)</code>).</p>\n\n<p>As <a href=\"https://stackoverflow.com/questions/48901772/compare-c-char-and-char/48901885#comment84809081_48901885\">xander noted in comments</a>, <code>char cmd = commandNames[i][1][0]</code> is better in terms of readability.</p>\n\n<p>As a side note, <code>char *cmd = (char*)commandNames[i][1]</code> is some dangerous code. You're casting pointer to a string literal to a modifiable pointer (dropping the <code>const</code> modifier). Since you don't need to modify <code>cmd</code>, it's better to declare and define it as <code>const char*</code>, and drop the conversion on the right-hand side (RHS).</p>\n"}], "owner": {"reputation": 1999, "user_id": 95306, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/e6fc63d053d69a2afea8e5fb120e639f?s=128&d=identicon&r=PG", "display_name": "Bob Jones", "link": "https://stackoverflow.com/users/95306/bob-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 527, "favorite_count": 0, "closed_date": 1519215628, "accepted_answer_id": 48901885, "answer_count": 1, "score": 0, "last_activity_date": 1519204286, "creation_date": 1519203722, "question_id": 48901772, "link": "https://stackoverflow.com/questions/48901772/compare-c-char-and-char", "closed_reason": "Not suitable for this site", "title": "Compare C char and char*", "body": "<p>I have a two dimensional array (commandNames} that I am searching to find a match with a single char which is read from the Arduino Serial input. The comparison code isn't working.</p>\n\n<pre><code>const char* commandNames[COMMAND_COUNT][4] = {\n    { \"STOP\",           \"p\", \"M\", \"0\" },\n    { \"STOP LEFT\",      \"s\", \"M\", \"9\" },\n    { \"STOP RIGHT\",     \"S\", \"M\", \"10\" },\n    { \"FORWARD\",        \"f\", \"M\", \"1\" },\n...\n};\n\nchar command = Serial.read();\nfor (int i = 0; i &lt; COMMAND_COUNT; i++) {\n    char *cmd = (char*)commandNames[i][1];\n    if (command == (char)cmd) { &lt;-- Need help with this line \n... we have a match...\n</code></pre>\n\n<p>The line \"if (command == (char)cmd)\" is the problem.</p>\n"}, {"tags": ["c", "linux", "assembly", "x86-64", "cpu-registers"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1519205108, "post_id": 48901609, "comment_id": 84809621, "body": "The code is <a href=\"https://en.wikipedia.org/wiki/Relocation_(computing)\" rel=\"nofollow noreferrer\"><b>relocated</b></a>, that&#39;s where the <code>0x0x55555555463e</code> comes from."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1519205605, "post_id": 48901609, "comment_id": 84809948, "body": "Also in gdb disassemble the code at <code>55555555463e</code> and you&#39;ll see (not sure which is the appropriate command in gdb for disassembling)"}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519272176, "post_id": 48918184, "comment_id": 84845126, "body": "It&#39;s ambiguous what you mean by &quot;Nothing changes if you use 64-bit&quot;.  That sentence might mean &quot;the 64-bit version of <code>main</code> does all that crap to align the stack just like 32-bit&quot;.  That&#39;s not what you mean (I hope), so you should say &quot;64-bit takes advantage of the ABI guarantee that RSP is aligned on entry so it doesn&#39;t include gcc&#39;s funky stack-alignment code that copies the stack frame&quot;.  (The 32-bit ABI changed more recently to guaranteeing 16-byte alignment, and gcc doesn&#39;t assume it on entry to main in 32-bit mode)."}, {"owner": {"reputation": 930, "user_id": 9210255, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/00KKR.png?s=128&g=1", "display_name": "TigerTV.ru", "link": "https://stackoverflow.com/users/9210255/tigertv-ru"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1519282396, "post_id": 48918184, "comment_id": 84848798, "body": "@PeterCordes: When I say nothing changes for 64-bit, I mean that a standard function entry sequence exists in 64-bit and gdb behaves the same."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519306787, "post_id": 48918184, "comment_id": 84864052, "body": "That&#39;s what I thought, so your answer should say so.  If readers don&#39;t already know the details, there is ambiguity in your answer as written."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519310304, "post_id": 48918184, "comment_id": 84866716, "body": "You seem to be completely missing the point.  Of course GDB behaves the same, the ambiguity is whether 64-bit <code>main</code> is the same as 64-bit  <code>testFunc</code>, or whether 64-bit <code>main</code> is the same as 32-bit <code>main</code> (and thus <i>different</i> from 64-bit <code>testFunc</code>).  And this isn&#39;t GDB behaviour, it&#39;s GCC code-gen behaviour.  (The special stack-alignment stuff in 32-bit <code>main</code> is emitted even with -O3  <a href=\"https://godbolt.org/g/dzUjS1\" rel=\"nofollow noreferrer\">godbolt.org/g/dzUjS1</a>.  Or in any function which needs more than 16-byte alignment in 32 or 64-bit mode, e.g. with <code>__m256</code> locals that it needs to spill.)"}, {"owner": {"reputation": 930, "user_id": 9210255, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/00KKR.png?s=128&g=1", "display_name": "TigerTV.ru", "link": "https://stackoverflow.com/users/9210255/tigertv-ru"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519313467, "post_id": 48918184, "comment_id": 84869106, "body": "@PeterCordes: OP <code>But the breakpoint info after the gdb &quot;run&quot; command, it seems that the program stopped at 63e rather than 63a.</code> There is no <code>gcc</code>. What would be if the program is not compiled <code>gcc</code>?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519314415, "post_id": 48918184, "comment_id": 84869748, "body": "If the program was compiled with <code>clang</code> instead of <code>gcc</code>, it&#39;s <code>main</code> wouldn&#39;t be &quot;special&quot; and would have the same prologue as <code>testFunc</code>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519315222, "post_id": 48918184, "comment_id": 84870436, "body": "Or just look at the godbolt link in my previous comment, and flip the compiler over to clang in the dropdown."}, {"owner": {"reputation": 930, "user_id": 9210255, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/00KKR.png?s=128&g=1", "display_name": "TigerTV.ru", "link": "https://stackoverflow.com/users/9210255/tigertv-ru"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519319784, "post_id": 48918184, "comment_id": 84873623, "body": "@PeterCordes: Thanks for corrections, I changed all to be clearly. Any corrections else?"}, {"owner": {"reputation": 930, "user_id": 9210255, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/00KKR.png?s=128&g=1", "display_name": "TigerTV.ru", "link": "https://stackoverflow.com/users/9210255/tigertv-ru"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519320711, "post_id": 48918184, "comment_id": 84874238, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/165661/discussion-between-tigertv-ru-and-peter-cordes\">continue this discussion in chat</a>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1519321575, "post_id": 48918184, "comment_id": 84874690, "body": "Maybe worth pointing out that <code>*main</code> is the GDB syntax for setting a breakpoint at a specific address, instead of on a function name.  <code>main</code> in <code>*main</code> is treated as a function pointer, so you get the actual function pointer value to the first instruction of the prologue, instead of to code for the first source line in the function."}, {"owner": {"reputation": 930, "user_id": 9210255, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/00KKR.png?s=128&g=1", "display_name": "TigerTV.ru", "link": "https://stackoverflow.com/users/9210255/tigertv-ru"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519322951, "post_id": 48918184, "comment_id": 84875415, "body": "@PeterCordes: added"}], "tags": [], "owner": {"reputation": 930, "user_id": 9210255, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/00KKR.png?s=128&g=1", "display_name": "TigerTV.ru", "link": "https://stackoverflow.com/users/9210255/tigertv-ru"}, "is_accepted": true, "score": 1, "last_activity_date": 1519323137, "last_edit_date": 1519323137, "creation_date": 1519262819, "answer_id": 48918184, "question_id": 48901609, "link": "https://stackoverflow.com/questions/48901609/strange-behavior-in-amd64-instruction-pointer/48918184#48918184", "title": "Strange behavior in AMD64 Instruction pointer", "body": "<p>GDB sets breakpoints on useful code for a function if you don't set an asterisk. It omits all preparation for a function(prologue). To make it clear try to debug the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int i=10;\n    i++;\n    return 0;\n}\n</code></pre>\n\n<p>Gdb session:</p>\n\n<pre><code>(gdb) b main\nBreakpoint 1 at 0x80483e1\n(gdb) b *main\nBreakpoint 2 at 0x80483db\n(gdb) r\nStarting program: /home/src/main \n\nBreakpoint 2, 0x080483db in main ()\n(gdb) disas\nDump of assembler code for function main:\n=&gt; 0x080483db &lt;+0&gt;: push   ebp\n   0x080483dc &lt;+1&gt;: mov    ebp,esp\n   0x080483de &lt;+3&gt;: sub    esp,0x10\n   0x080483e1 &lt;+6&gt;: mov    DWORD PTR [ebp-0x4],0xa\n   0x080483e8 &lt;+13&gt;:    add    DWORD PTR [ebp-0x4],0x1\n   0x080483ec &lt;+17&gt;:    mov    eax,0x0\n   0x080483f1 &lt;+22&gt;:    leave  \n   0x080483f2 &lt;+23&gt;:    ret    \nEnd of assembler dump.\n(gdb) c\nContinuing.\n\nBreakpoint 1, 0x080483e1 in main ()\n(gdb) disas\nDump of assembler code for function main:\n   0x080483db &lt;+0&gt;: push   ebp\n   0x080483dc &lt;+1&gt;: mov    ebp,esp\n   0x080483de &lt;+3&gt;: sub    esp,0x10\n=&gt; 0x080483e1 &lt;+6&gt;: mov    DWORD PTR [ebp-0x4],0xa\n   0x080483e8 &lt;+13&gt;:    add    DWORD PTR [ebp-0x4],0x1\n   0x080483ec &lt;+17&gt;:    mov    eax,0x0\n   0x080483f1 &lt;+22&gt;:    leave  \n   0x080483f2 &lt;+23&gt;:    ret    \nEnd of assembler dump.\n</code></pre>\n\n<p>in this case, preparation to execute useful code of the function is  : </p>\n\n<pre><code>0x080483db &lt;+0&gt;: push   ebp\n0x080483dc &lt;+1&gt;: mov    ebp,esp\n0x080483de &lt;+3&gt;: sub    esp,0x10\n</code></pre>\n\n<p>first instruction in <code>main</code>:</p>\n\n<pre><code>int i=10;\n</code></pre>\n\n<p>compiled into:</p>\n\n<pre><code>mov    DWORD PTR [ebp-0x4],0xa\n</code></pre>\n\n<p>GDB set a breakpoint on the instruction, when we give the command <code>b main</code></p>\n\n<p>But if we use the command with an asterisk(pointer) <code>b *main</code> we set a breakpoint on the actual address of the function(on first instruction of  prologue).</p>\n\n<p>In OP case, if we set breakpoint by <code>break *main</code> and then <code>run</code>, the instruction pointer register(<code>rip</code>) will have the value <code>0x55555555463a</code></p>\n"}], "owner": {"reputation": 37, "user_id": 9229381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda5eb105fd4fbee94b100a046be3098?s=128&d=identicon&r=PG&f=1", "display_name": "Z. Sun", "link": "https://stackoverflow.com/users/9229381/z-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 1, "accepted_answer_id": 48918184, "answer_count": 1, "score": 1, "last_activity_date": 1519323137, "creation_date": 1519203232, "last_edit_date": 1519264879, "question_id": 48901609, "link": "https://stackoverflow.com/questions/48901609/strange-behavior-in-amd64-instruction-pointer", "title": "Strange behavior in AMD64 Instruction pointer", "body": "<p>I was reading Hacking: The Art of Exploitation by Jon Erickson, and followed the example in the book in my Kali Linux system (64 bit).</p>\n\n<p>I wrote a simple C program:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    int i;\n    for(i=0;i&lt;10;i++)\n    {\n       printf(\"Hello\");\n    }\n}\n</code></pre>\n\n<p>After using objdump and gdb to examine the executable, I found something strange.</p>\n\n<p><a href=\"https://i.stack.imgur.com/VMkUO.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VMkUO.jpg\" alt=\"Screenshot\"></a></p>\n\n<p>As the picture shows, the main function was in the \"0x000000000000063a\".</p>\n\n<p>But the breakpoint info after the gdb \"run\" command, it seems that the program stopped at 63e rather than 63a.</p>\n\n<p>Another peculiar thing is that the value in the instruction pointer (rip) was 0x55555555463e. \nShouldn't it be 0x000000000000063a?\nWhere do those <code>5</code>s come from?</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 3, "creation_date": 1519203258, "post_id": 48901482, "comment_id": 84808496, "body": "Interestingly, the compiler should actually ignore the values of the arguments used as array sizes unless you force it to consider them by adding <code>static</code> (e.g. <code>double x[static n]</code>). Despite <i>looking</i> like it does something (and not working in C++, and requiring the values to be valid/in-scope expressions), the form in the question is a bit useless. Annoying hole in the language."}, {"owner": {"reputation": 5586, "user_id": 3309610, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4329755c47f01a17242610d2fac65859?s=128&d=identicon&r=PG", "display_name": "bremen_matt", "link": "https://stackoverflow.com/users/3309610/bremen-matt"}, "reply_to_user": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 0, "creation_date": 1519240784, "post_id": 48901482, "comment_id": 84833861, "body": "I do not understand what the you are saying the word <code>static</code> would do... Would adding the keyword <code>static</code> make it a compile-time check?"}, {"owner": {"reputation": 203344, "user_id": 140719, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/84a6aa25ee85e948123d97b672135526?s=128&d=identicon&r=PG", "display_name": "sbi", "link": "https://stackoverflow.com/users/140719/sbi"}, "edited": false, "score": 0, "creation_date": 1519241543, "post_id": 48901482, "comment_id": 84834236, "body": "Relevant: <a href=\"https://stackoverflow.com/questions/4810664/how-do-i-use-arrays-in-c\">How do I use arrays in C++?</a>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1519275749, "post_id": 48901482, "comment_id": 84846242, "body": "In case you are unaware, it is possible to use C code in C++ projects, without &quot;converting the code to C++&quot;"}, {"owner": {"reputation": 717, "user_id": 5309828, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9b1d938c6c7dca82919b3e00d5d43c14?s=128&d=identicon&r=PG&f=1", "display_name": "a concerned citizen", "link": "https://stackoverflow.com/users/5309828/a-concerned-citizen"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1519282522, "post_id": 48901482, "comment_id": 84848846, "body": "@M.M OP said he just converted the extension of the file and failed when tried to compile."}, {"owner": {"reputation": 5586, "user_id": 3309610, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4329755c47f01a17242610d2fac65859?s=128&d=identicon&r=PG", "display_name": "bremen_matt", "link": "https://stackoverflow.com/users/3309610/bremen-matt"}, "edited": false, "score": 0, "creation_date": 1519285014, "post_id": 48901482, "comment_id": 84850126, "body": "I am aware that I can link the compiled files."}, {"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 0, "creation_date": 1519292316, "post_id": 48901482, "comment_id": 84854214, "body": "@bremen_matt the standard doesn&#39;t require that the array passed to the parameter <code>double x[n]</code> actually has <code>n</code> elements, or even that it is non-null. The <code>n</code> is basically just documentation and the declaration is equivalent to <code>double * x</code>. Adding that <code>static</code> activates the requirements you <i>expected</i> to be imposed on the original. (Whether the compiler is able to check and enforce this is another matter: it should be equally able to do it either way - not in the general case but flow analysis can catch simple usages - but in the first, it isn&#39;t really allowed to error out, only warn.)"}, {"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 0, "creation_date": 1519292492, "post_id": 48901482, "comment_id": 84854329, "body": "(That said, my comment only applies to the outermost array derivation: the inner array size in a multi-dimensional array must always mean something because otherwise it wouldn&#39;t be able to work out the pointer offsets.)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1519308994, "post_id": 48901482, "comment_id": 84865704, "body": "FWIW You can kind of do the same thing with templates in C++: <a href=\"http://coliru.stacked-crooked.com/a/014f48fe8421916a\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/014f48fe8421916a</a>"}, {"owner": {"reputation": 5586, "user_id": 3309610, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4329755c47f01a17242610d2fac65859?s=128&d=identicon&r=PG", "display_name": "bremen_matt", "link": "https://stackoverflow.com/users/3309610/bremen-matt"}, "edited": false, "score": 0, "creation_date": 1519309204, "post_id": 48901482, "comment_id": 84865829, "body": "Yep. That is ultimately the closest thing in the C++ sense, and preferred because it will do a compile-time check on the dimensions."}], "answers": [{"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1519203080, "post_id": 48901550, "comment_id": 84808377, "body": "I thought you had to use <code>[*]</code> for variable length array function parameters in C."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 3, "creation_date": 1519203344, "post_id": 48901550, "comment_id": 84808546, "body": "@Bathsheba: The first time I saw <code>[*]</code> was already in a context explaining why <code>[N]</code> worked there as well. But neither syntax is going to work in C++ - this is a C invention after C++ forked off."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1519203455, "post_id": 48901550, "comment_id": 84808603, "body": "I&#39;ve been naughty and made a C++ edit. If you don&#39;t like it please roll back. (And you can keep the upvote either way.)"}, {"owner": {"reputation": 5586, "user_id": 3309610, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4329755c47f01a17242610d2fac65859?s=128&d=identicon&r=PG", "display_name": "bremen_matt", "link": "https://stackoverflow.com/users/3309610/bremen-matt"}, "edited": false, "score": 0, "creation_date": 1519203943, "post_id": 48901550, "comment_id": 84808889, "body": "I don&#39;t think that a vector is the correct approach here because it wouldn&#39;t give you a compile-time check, whereas the C-version seems to. Perhaps an std::array?"}, {"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1519203943, "post_id": 48901550, "comment_id": 84808890, "body": "@Bathsheba the C++ edit is a good addition because it captures the fact that the &quot;array&quot; in C will automatically be passed by &quot;reference&quot;, whereas a vector in C++ would be copied by default if written out in the naive way, so this is indeed needed to replicate the C behaviour more closely."}, {"owner": {"reputation": 427, "user_id": 232163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6febc5764ddc4744e3c717250c2bc936?s=128&d=identicon&r=PG", "display_name": "Nye", "link": "https://stackoverflow.com/users/232163/nye"}, "edited": false, "score": 6, "creation_date": 1519207026, "post_id": 48901550, "comment_id": 84811030, "body": "Downvoted because simply restating the fact given in the question is not an answer to why. I suspect the answer is probably because it was added in C99 or later (long after C++ was created as a near-superset of C), but I don&#39;t know enough C for that to be anything more than speculation."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 427, "user_id": 232163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6febc5764ddc4744e3c717250c2bc936?s=128&d=identicon&r=PG", "display_name": "Nye", "link": "https://stackoverflow.com/users/232163/nye"}, "edited": false, "score": 4, "creation_date": 1519207575, "post_id": 48901550, "comment_id": 84811470, "body": "@Nye: There are parts of C99 that made it into C++, so that&#39;s not the reason. But C++ already had <code>std::vector</code> since 1998. It didn&#39;t need variable-length arrays."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 5586, "user_id": 3309610, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4329755c47f01a17242610d2fac65859?s=128&d=identicon&r=PG", "display_name": "bremen_matt", "link": "https://stackoverflow.com/users/3309610/bremen-matt"}, "edited": false, "score": 4, "creation_date": 1519215920, "post_id": 48901550, "comment_id": 84817387, "body": "@bremen_matt: How do you figure the C version could do a compile-time check on a runtime-variable-length array?"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1519222522, "post_id": 48901550, "comment_id": 84821961, "body": "@Bathsheba: An older answer which shows more about the <code>[*]</code> syntax : <a href=\"https://stackoverflow.com/a/29576308/15416\">stackoverflow.com/a/29576308/15416</a>"}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1519223438, "post_id": 48901550, "comment_id": 84822665, "body": "I&#39;d say a <code>span</code> bids fair to fill that role, in all cases where you don&#39;t actually need to resize the contiguous sequence. <a href=\"https://stackoverflow.com/questions/45723819/what-is-a-span-and-when-should-i-use-one\" title=\"what is a span and when should i use one\">stackoverflow.com/questions/45723819/&hellip;</a>"}, {"owner": {"reputation": 3529, "user_id": 2036035, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/746fc48544cf535f52f1247079e5a927?s=128&d=identicon&r=PG", "display_name": "hythis", "link": "https://stackoverflow.com/users/2036035/hythis"}, "edited": false, "score": 0, "creation_date": 1519231284, "post_id": 48901550, "comment_id": 84828409, "body": "@MSalters I don&#39;t see how this is the case, a VLA in this case really just means run time  statically allocated array, which can now exist on the stack. You can&#39;t do this in C++ despite it actually being pretty useful, forcing you to use dynamic allocation where it simply isn&#39;t necessary."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1519275491, "post_id": 48901550, "comment_id": 84846160, "body": "VLAs aren&#39;t in C++ because there is no way to make them interact nicely with templates, overload resolution and other C++ language features. The C++ language tries to forget about C arrays as much as possible due to their weird syntax and semantics"}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 38, "last_activity_date": 1519203429, "last_edit_date": 1519203429, "creation_date": 1519203042, "answer_id": 48901550, "question_id": 48901482, "link": "https://stackoverflow.com/questions/48901482/passing-array-to-a-function-and-why-it-does-not-work-in-c/48901550#48901550", "title": "Passing array to a function (and why it does not work in C++)", "body": "<p>The reason it works in C, but not in C++ is simply because it's C code and not C++. The two languages share a history, not a grammar.</p>\n\n<p>The C++ method to pass variable-sized arrays is <code>std::vector</code>, probably by <em>reference</em> if you intend to modify the vector in the function, or by <code>const</code> <em>reference</em> if you don't.</p>\n"}, {"comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 7, "creation_date": 1519222862, "post_id": 48901596, "comment_id": 84822196, "body": "You might want to add what version added that."}, {"owner": {"reputation": 191, "user_id": 6547788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26299c91d1c3a36b9ee668e644dc5af8?s=128&d=identicon&r=PG&f=1", "display_name": "TWhelan", "link": "https://stackoverflow.com/users/6547788/twhelan"}, "edited": false, "score": 12, "creation_date": 1519223312, "post_id": 48901596, "comment_id": 84822561, "body": "VLAs were added in C99, but left the standard (optional support) for C11."}], "tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": true, "score": 61, "last_activity_date": 1519203192, "creation_date": 1519203192, "answer_id": 48901596, "question_id": 48901482, "link": "https://stackoverflow.com/questions/48901482/passing-array-to-a-function-and-why-it-does-not-work-in-c/48901596#48901596", "title": "Passing array to a function (and why it does not work in C++)", "body": "<p>In C, it is possible to use function parameters to define the size of a variable length array parameter as long as the size comes before the array in the parameter list.  This is not supported in C++.</p>\n"}, {"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 5, "last_activity_date": 1519204000, "creation_date": 1519204000, "answer_id": 48901859, "question_id": 48901482, "link": "https://stackoverflow.com/questions/48901482/passing-array-to-a-function-and-why-it-does-not-work-in-c/48901859#48901859", "title": "Passing array to a function (and why it does not work in C++)", "body": "<p>All that it does (in C) is allow you to write indexing code in the called funcion without having to do the address calculation yourself, for example:</p>\n\n<pre><code>double d= xu_col[i*row_size + j]; //get element [i,j]\n</code></pre>\n\n<p>versus</p>\n\n<pre><code>double d= xu_col[i][j];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 366, "user_id": 8416530, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ujb6qwGGWHE/AAAAAAAAAAI/AAAAAAAAACo/MZ2dV0tp5bs/photo.jpg?sz=128", "display_name": "Jens Harms", "link": "https://stackoverflow.com/users/8416530/jens-harms"}, "is_accepted": false, "score": 11, "last_activity_date": 1519230972, "creation_date": 1519230972, "answer_id": 48911002, "question_id": 48901482, "link": "https://stackoverflow.com/questions/48901482/passing-array-to-a-function-and-why-it-does-not-work-in-c/48911002#48911002", "title": "Passing array to a function (and why it does not work in C++)", "body": "<blockquote>\n  <p>What I don't understand is why the compiler allows for sizing in the arrays. To the best of my understanding, either the sizes must be fixed (e.g. xu_col[9][7]) or undefined (e.g. xu_col[][]). In the above code, it appears that the sizes are not compile-time constants.</p>\n</blockquote>\n\n<p>You are right, the sizes are not compile-time constants. If you have a two-dimensional array, x[line][col] the compiler needs the number of elements in a line to calculate the address of an element. Look at get_char_2() and get_char_3() example code.</p>\n\n<p>If you use variable length arrays (VLAs) as function parameters you have to supply these number (see get_char_1 example). you can write:</p>\n\n<pre><code> my_func( x[][width] )\n</code></pre>\n\n<p>or you can write</p>\n\n<pre><code> my_func( x[999][width] )\n</code></pre>\n\n<blockquote>\n  <p>Is the compiler just ignoring the arguments here? or is it really doing a >compile-time check on the dimensions? </p>\n</blockquote>\n\n<p>The first number (999) will be ignored by the compiler. The second is needed. Without the line size, the compiler can not calculate addresses inside these 2D-array. \nThe compiler does not do run-time or compile-time checks for VLAs in C.</p>\n\n<pre><code>/* file: vla.c\n *\n * variable length array example\n *\n * compile with:\n *   \n *    gcc -g -Wall -o vla vla.c \n *\n */\n\n#include &lt;stdio.h&gt;\n#include &lt;wchar.h&gt;\n\n\n/* 4 Lines - each line has 8 wide-characters */\nwchar_t tab[][8] = {\n{ L\"12345678\" },\n{ L\"abcdefgh\" },\n{ L\"ijklmnop\" },\n{ L\"qrstuvwx\" }\n};\n\n/* memory layout:   \n   0x00:   0x0031  0x0032 0x0033  0x0034  0x0035  0x0036  0x0037  0x0038 \n   0x20:   0x0061  0x0062 0x0063  0x0064  0x0065  0x0066  0x0067  0x0068 \n   ...\n\n*/\n\n\n\n/* get character from table w/o variable length array and w/o type */\nchar get_char_3(int line, int col, int width, int typesize, void *ptr )\n{\nchar ch = * (char *) (ptr + width * typesize * line + col * typesize ); \n\nprintf(\"line:%d col:%d char:%c\\n\", line, col, ch ); \nreturn ch;\n}\n\n\n/* get character from table w/o variable length array */\nchar get_char_2(int line, int col, int width, wchar_t *ptr)\n{\nchar ch = (char) (ptr + width * line)[col]; \n\nprintf(\"line:%d col:%d char:%c\\n\", line, col, ch ); \nreturn ch;\n}\n\n/* get character from table : compiler does not know line length for \n   address calculation until you supply it (width). \n*/\nchar get_char_1(int line, int col, int width, wchar_t aptr[][width] )\n{\n/* run-time calculation: \n   (width * sizeof(char) * line)  + col \n     ???    KNOWN          KOWN     KNOWN\n*/\nchar ch = (char) aptr[line][col];\n\nprintf(\"line:%d col:%d char:%c\\n\", line, col, ch ); \nreturn ch;\n}\n\n\nint main(void)\n{\nchar ch;\n\nch = tab[1][7]; /* compiler knows line length */\nprintf(\"at 1,7 we have: %c\\n\",  ch );\n\n/* sizeof tab[0][0] == sizeof(wchar_t) */ \n\nch = get_char_1(1,7, sizeof(tab[0])/sizeof(tab[0][0]), tab);\nprintf(\"1 returned char: %c\\n\", ch );\n\nch = get_char_2(1,7, sizeof(tab[0])/sizeof(tab[0][0]), (wchar_t*)tab);\nprintf(\"2 returned char: %c\\n\", ch );\n\nch = get_char_3(1,7, sizeof(tab[0])/sizeof(tab[0][0]),\n        sizeof( wchar_t), tab);\nprintf(\"3 returned char: %c\\n\", ch );\n\nprintf(\"table size: %lu, line size: %lu,  element size: %lu\\n\",\n       sizeof(tab),\n       sizeof(tab[0]),\n       sizeof(tab[0][0])\n       );\n\nprintf(\"number of elements per lines: %lu\\n\",\n       sizeof(tab[0])/sizeof(tab[0][0]));\n\n\nprintf(\"number of lines: %lu\\n\",\n       sizeof(tab)/sizeof(tab[0]));\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 5, "last_activity_date": 1519249586, "last_edit_date": 1519249586, "creation_date": 1519249219, "answer_id": 48915943, "question_id": 48901482, "link": "https://stackoverflow.com/questions/48901482/passing-array-to-a-function-and-why-it-does-not-work-in-c/48915943#48915943", "title": "Passing array to a function (and why it does not work in C++)", "body": "<p>When a parameter is declared as having a single-dimensional array type, C ignores the given size and instead treats the parameter as a pointer to the element type.  For nested (multi-dimensional) arrays, such treatment is only applied to the outer array.  In C89, inner dimensions had to have fixed sizes, but in C99 the dimensions can be expressions.  If parameters which are needed to compute an array's size are not listed until after the array, it will be necessary to use a curious mixture of old and new syntax to declare the function, e.g.</p>\n\n<pre><code>int findNonzero(short dat[*][*], int rows, int cols);\nint findNonzero(dat, rows, cols)\n    int rows,cols;\n    short dat[static rows][cols];\n{\n    for (int i=0; i&lt;rows; i++)\n        for (int j=0; j&lt;cols; j++)\n            if (dat[i][j] != 0) return i;\n    return -1;\n}\n</code></pre>\n\n<p>Note that the array sizes are specified as <code>*</code> in the function prototype, and that the function definition does not specify types in the argument list but instead describes all the parameters' types between the argument list and the opening brace.  Note also that while the compiler is likely to ignore the number of rows in the array declaration, but a smart compiler may be able to use it to facilitate optimization.  Effectively, the weird \"static\" syntax invites the compiler to read any parts of the array, up to the given size, as it sees fit, whether or not the values are read by the code.  This may be helpful on some platforms where code might benefit from processing multiple items of the array at once.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1519275670, "post_id": 48919596, "comment_id": 84846214, "body": "<code>rectangular_array( ROWS, COLS, vector );</code> is a constraint violation for passing the wrong argument type. It&#39;s not legal."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1519276994, "post_id": 48919596, "comment_id": 84846657, "body": "@M.M Before I get all language-lawyerly with you: I give the solution to that in my second code sample, so use that if you prefer."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1519278063, "post_id": 48919596, "comment_id": 84847050, "body": "@M.M I added the language lawyering as a footnote."}], "tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 3, "last_activity_date": 1519279837, "last_edit_date": 1519279837, "creation_date": 1519273182, "answer_id": 48919596, "question_id": 48901482, "link": "https://stackoverflow.com/questions/48901482/passing-array-to-a-function-and-why-it-does-not-work-in-c/48919596#48919596", "title": "Passing array to a function (and why it does not work in C++)", "body": "<p>The difficulty with your code sample is that one of the function parameters is protoyped, <code>double xu_col[n_col][n_x + n_u]</code>, where <code>n_x</code> and <code>n_u</code> are variables, not constants.  If you just pass this as a <code>double[]</code> instead, some C++ compilers might allow a cast such as <code>double (&amp;table)[n_col][n_x + n_u] = (double(&amp;)[n_col][n_x + n_u])xu_col;</code> to work as a non-standard extension, but the portable approach would be to write accesses like <code>xu_col[i*(n_x+n_u) + j]</code>, which you could simplify with a helper function if that\u2019s too ugly.</p>\n\n<p>An alternative approach, probably more in keeping with the spirit of the STL, might be to write a minimal container class that knows its dimensions, stores elements in a linear array for efficiency.  Then you might declare <code>redim_array&lt;double&gt; table = redim_array&lt;double&gt;(xu_col, n_col*(n_x+n_u)).redim(n_col, n_x+n_u);</code> and access <code>table(i,j)</code>.</p>\n\n<p>Several of the other answers have described the syntax of variable-length arrays, but another aspect of your question is how it\u2019s legal to implicitly convert a rectangular\u00b9 two-dimensional array to a one-dimensional array.</p>\n\n<p>What happens is that the rectangular array is laid out as consecutive elements in memory, so it can degenerate to a pointer to the elements, and then the function parameter can interpret that as an array with a different geometry.</p>\n\n<p>Here\u2019s a short little program that demonstrates this behavior.</p>\n\n<pre><code>#include &lt;stddef.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define ROWS 2\n#define COLS 4\n#define ELEMS (ROWS*COLS)\n\nint flatten_array( const ptrdiff_t n, const int a[n] )\n{\n  int printed = 0;\n\n  for ( ptrdiff_t i = 0; i &lt; n; ++i )\n    printed += printf( \"%d \", a[i] );\n\n  return printed + printf(\"\\n\");\n}\n\nint rectangular_array( const ptrdiff_t m,\n                       const ptrdiff_t n,\n                       const int a[m][n] )\n{\n  int printed = 0;\n\n  for ( ptrdiff_t i = 0; i &lt; m; ++i ) {\n    for ( ptrdiff_t j = 0; j &lt; n; ++j )\n      printed += printf( \"%d \", a[i][j] );\n\n    printed += printf(\"\\n\");\n  }\n\n  return printed + printf(\"\\n\");\n}\n\nint main(void)\n{\n  static const int matrix[ROWS][COLS] = {\n    {11, 12, 13, 14},\n    {21, 22, 23, 24}\n  };\n  static const int vector[ELEMS] = {11, 12, 13, 14, 21, 22, 23, 24};\n\n  flatten_array( ELEMS, *(const int (*const)[ELEMS])matrix );\n  printf(\"\\n\");\n  rectangular_array( ROWS, COLS, *(const int (*const)[ROWS][COLS])vector );\n\n  return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>There\u2019s some language-lawyering in the comments below\u00b2 about whether passing the array arguments without the explicit casts is technically legal by standard.  I\u2019ve chosen to relegate that to a footnote and just delete the example with no casts.  In the real world, you will sometimes see code without the pointer-to-array-of-different-geometry cast, and it might generate a warning.  The memory layout of the two arrays is required by the standard to be the same.</p>\n\n<p>To convert to C++, you can use the pointer-conversion trick, or you now can code-golf it a bit by using references.</p>\n\n<p>Here is a C++ translation of the program above.  It requires all but the first dimension of the array being passed in to be <code>constexpr</code>, but some compilers support C99-style variable-length arrays as an extension.</p>\n\n<pre><code>#include &lt;stddef.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nconstexpr ptrdiff_t rows = 2;\nconstexpr ptrdiff_t cols = 4;\nconstexpr ptrdiff_t elems = rows * cols;\n\nint flatten_array( const ptrdiff_t n, const int a[] )\n{\n  int printed = 0;\n\n  for ( ptrdiff_t i = 0; i &lt; n; ++i )\n    printed += printf( \"%d \", a[i] );\n\n  return printed + printf(\"\\n\");\n}\n\nint rectangular_array( const ptrdiff_t n, const int a[][cols] )\n{\n  int printed = 0;\n\n  for ( ptrdiff_t i = 0; i &lt; n; ++i ) {\n    for ( ptrdiff_t j = 0; j &lt; cols; ++j )\n      printed += printf( \"%d \", a[i][j] );\n\n    printed += printf(\"\\n\");\n  }\n\n  return printed + printf(\"\\n\");\n}\n\nint main(void)\n{\n  static const int matrix[rows][cols] = {\n    {11, 12, 13, 14},\n    {21, 22, 23, 24}\n  };\n  static const int vector[elems] = {11, 12, 13, 14, 21, 22, 23, 24};\n\n  flatten_array( elems, (const int(&amp;)[elems])matrix );\n  printf(\"\\n\");\n  rectangular_array( rows, (const int(&amp;)[rows][cols])vector );\n\n  return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>\u00b9 C programmers sometimes call either arrays like <code>int matrix[ROWS][COLS]</code> or arrays like <code>char** argv</code> \u201ctwo-dimensional arrays.\u201d  Here, I call the former <em>rectangular</em> and the latter <em>ragged</em>.</p>\n\n<p>\u00b2 The constraint on function arguments in the C11 standard is \u2018Each argument shall have a type such that its value may be assigned to an object with the unqualified version of the type of its corresponding parameter.\u2019 Furthermore \u2018A declaration of a parameter as ''array of type'' shall be adjusted to ''qualified pointer to type''\u2019 and, if this applies recursively, a multidimensional array of some type will be adjusted to a flat pointer of that type.</p>\n"}, {"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519409582, "post_id": 48923473, "comment_id": 84914438, "body": "For those that downvoted this answer, WHY did you downvote it?"}, {"owner": {"reputation": 1868, "user_id": 2710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75634431b8b7bc8b37cc1673d7d789e9?s=128&d=identicon&r=PG", "display_name": "wbkang", "link": "https://stackoverflow.com/users/2710/wbkang"}, "edited": false, "score": 0, "creation_date": 1519687834, "post_id": 48923473, "comment_id": 85002902, "body": "I didnt downvote but it has more to do with VLAs rather than name mangling?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 1868, "user_id": 2710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75634431b8b7bc8b37cc1673d7d789e9?s=128&d=identicon&r=PG", "display_name": "wbkang", "link": "https://stackoverflow.com/users/2710/wbkang"}, "edited": false, "score": 1, "creation_date": 1519713321, "post_id": 48923473, "comment_id": 85009620, "body": "the original text of the question (when seems to have been drastically edited) ask why a function in a C library could not be found when the calling function is from a C++ program."}, {"owner": {"reputation": 1868, "user_id": 2710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75634431b8b7bc8b37cc1673d7d789e9?s=128&d=identicon&r=PG", "display_name": "wbkang", "link": "https://stackoverflow.com/users/2710/wbkang"}, "edited": false, "score": 0, "creation_date": 1519770353, "post_id": 48923473, "comment_id": 85043133, "body": "Well that&#39;s very silly. I think this happens quite frequently actually."}, {"owner": {"reputation": 356, "user_id": 3768532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/723cade780d5da806a1c12df7d83c8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Kidd", "link": "https://stackoverflow.com/users/3768532/steve-kidd"}, "edited": false, "score": 0, "creation_date": 1520078703, "post_id": 48923473, "comment_id": 85173030, "body": "The original question refers to a compiler error not a linker error so I cannot see how name mangling is relevant to THIS question. And if all code is compiled as C++ (which is implied by the question - switching file type to .cpp) then name mangling still won&#39;t be an issue."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1519290761, "creation_date": 1519290761, "answer_id": 48923473, "question_id": 48901482, "link": "https://stackoverflow.com/questions/48901482/passing-array-to-a-function-and-why-it-does-not-work-in-c/48923473#48923473", "title": "Passing array to a function (and why it does not work in C++)", "body": "<p>regarding the second part of your question:</p>\n\n<p><em>Why doesn't the same version work in C++? When I literally change the file extension from .c to .cpp and try to recompile, I get</em></p>\n\n<p>The source of that problem is that C++ mangles names.</p>\n\n<p>To avoid name mangling when running C++ and trying to access a C library.</p>\n\n<p>near the top of the header file for the C library, after the multiple inclusion guard insert:</p>\n\n<pre><code>#ifdef __cplusplus\nextern \"C\" {\n#endif\n</code></pre>\n\n<p>and near the end of the header file, before the <code>#endif</code> of the multiple inclusion guard, insert:</p>\n\n<pre><code>#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>That will eliminate the problem of functions in the assocated library file not being found</p>\n"}], "owner": {"reputation": 5586, "user_id": 3309610, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4329755c47f01a17242610d2fac65859?s=128&d=identicon&r=PG", "display_name": "bremen_matt", "link": "https://stackoverflow.com/users/3309610/bremen-matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8243, "favorite_count": 4, "accepted_answer_id": 48901596, "answer_count": 7, "score": 45, "last_activity_date": 1519498460, "creation_date": 1519202813, "last_edit_date": 1519212210, "question_id": 48901482, "link": "https://stackoverflow.com/questions/48901482/passing-array-to-a-function-and-why-it-does-not-work-in-c", "title": "Passing array to a function (and why it does not work in C++)", "body": "<p>I have come across some C code that compiles, but I do not understand why. Specifically, I have a C library that has a lot of code using this format:</p>\n\n<pre><code>void get_xu_col(int i_start,\n                int n,\n                double x[n],\n                int n_x,\n                int n_u,\n                int n_col,\n                double xu_col[n_col][n_x + n_u]){\n    ... \n}\n\nint main(){\n    ...\n    double xu_col[n_col][n_x + n_u];\n    get_xu_col( ..., xu_col );\n    ...\n}\n</code></pre>\n\n<p>What I don't understand is why the compiler allows for sizing in the arrays. To the best of my understanding, either the sizes must be fixed (e.g. <code>xu_col[9][7]</code>) or undefined (e.g. <code>xu_col[][]</code>). In the above code, it appears that the sizes are not compile-time constants.  </p>\n\n<p>Is the compiler just ignoring the arguments here? or is it really doing a compile-time check on the dimensions? </p>\n\n<p>If it is the latter, then it seems error-prone to pass the dimensions separately. </p>\n\n<p>The second part of the question is:</p>\n\n<p>Why doesn't the same version work in C++? When I literally change the file extension from <code>.c</code> to <code>.cpp</code> and try to recompile, I get </p>\n\n<pre><code>candidate function not viable: no known conversion from 'double [n_col][n_x + n_u]' to 'double (*)[n_x + n_u]' for 7th argument\nvoid get_xu_col(int i_start, int n, double x[n], int n_x, int n_u, int n_col, double xu_col[n_col][n_x + n_u]);\n</code></pre>\n\n<p>I would like to know which idiom I should use to convert this code to C++, since apparently the previous idiom was something that works in C, but not C++. </p>\n"}, {"tags": ["c", "linux", "linker", "ld"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1519209061, "post_id": 48901388, "comment_id": 84812582, "body": "You might be able to do it in ASM with <code>.orig</code> directive (I think that&#39;s the one). Also see <a href=\"https://stackoverflow.com/q/495262/608639\">Linking symbols to fixed addresses on Linux</a>, <a href=\"https://stackoverflow.com/q/25919859/608639\">Is there a way to load a Linux shared library into a specific memory location?</a>, <a href=\"https://stackoverflow.com/q/25172834/608639\">How to create static linked shared libraries</a>, etc. Also see <a href=\"https://gcc.gnu.org/ml/gcc-help/2008-10/msg00183.html\" rel=\"nofollow noreferrer\">relocatable code and object files and shared libraries</a> (see Ian lance Taylor&#39;s reply)."}, {"owner": {"reputation": 11893, "user_id": 12098405, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C7IUyuZ5qqE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rehqQyGdh463Xz2DY8S4TYPhnDvzA/photo.jpg?sz=128", "display_name": "dash-o", "link": "https://stackoverflow.com/users/12098405/dash-o"}, "edited": false, "score": 0, "creation_date": 1571844191, "post_id": 48901388, "comment_id": 103376947, "body": "Can you share how splay_tree_lookup is called/referenced. Which library provides the splut_tree_lookup  - how was it compiled ?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1571846868, "post_id": 48901388, "comment_id": 103378304, "body": "This is a duplicate of <a href=\"https://stackoverflow.com/questions/7865059/why-does-gcc-force-pic-for-x64-shared-libs\" title=\"why does gcc force pic for x64 shared libs\">stackoverflow.com/questions/7865059/&hellip;</a>  Note <a href=\"https://stackoverflow.com/a/7865081/4756299\">the answer there</a>:  PIC is effectively <i>required</i> on 64-bit shared objects on x86_64 systems."}, {"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 0, "creation_date": 1571875889, "post_id": 48901388, "comment_id": 103388469, "body": "<a href=\"https://stackoverflow.com/a/12139145/1162141\">stackoverflow.com/a/12139145/1162141</a> has a good example.  You could set up a struct with function pointers and then use the function pointers through a macro."}, {"owner": {"reputation": 3041, "user_id": 1927339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5d22c1debe70638c165948a4a99cc0?s=128&d=identicon&r=PG", "display_name": "James_pic", "link": "https://stackoverflow.com/users/1927339/james-pic"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1571924551, "post_id": 48901388, "comment_id": 103406913, "body": "@AndrewHenle I think a good &quot;this isn&#39;t possible because...&quot; answer would suffice for a bounty. I confess, I failed to find the related question you linked when I was investigating this myself."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1572189412, "post_id": 48901388, "comment_id": 103475803, "body": "You can&#39;t build a shared library on x86_64 without PIC. It won&#39;t work."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1571846939, "post_id": 58526860, "comment_id": 103378343, "body": "Recompiling the object files with <code>-fpic</code> is the <b>only</b> option.  PIC is required for x86_64 shared objects.  They won&#39;t work otherwise."}, {"owner": {"reputation": 1320, "user_id": 5495906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b319c1b73d80f4155fbdd4fcb81525?s=128&d=identicon&r=PG&f=1", "display_name": "LegendofPedro", "link": "https://stackoverflow.com/users/5495906/legendofpedro"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1571852380, "post_id": 58526860, "comment_id": 103380755, "body": "So it might still be possible with the <code>-m32</code> flag?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1571854444, "post_id": 58526860, "comment_id": 103381640, "body": "<i>So it might still be possible with the <code>-m32</code> flag?</i> Indeed.  PIC is not required for a 32-bit shared object on x86 systems, but I&#39;m not sure if recent, commonly-used  toolchains can build a 32-bit shared object.  Shouldn&#39;t be too hard to test, but I can&#39;t right now. <a href=\"https://en.wikipedia.org/wiki/Address_space_layout_randomization\" rel=\"nofollow noreferrer\">Address space layout randomization (ASLR)</a> might come into play, too."}, {"owner": {"reputation": 1320, "user_id": 5495906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b319c1b73d80f4155fbdd4fcb81525?s=128&d=identicon&r=PG&f=1", "display_name": "LegendofPedro", "link": "https://stackoverflow.com/users/5495906/legendofpedro"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1571856533, "post_id": 58526860, "comment_id": 103382517, "body": "Unfortunately, I can&#39;t test it either, but I recently went through linking hell trying to build <code>valgrind4win</code> and read a whole bunch about <code>ld</code>."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1571861166, "post_id": 58526860, "comment_id": 103384343, "body": "@AndrewHenle I understand that general loaders would require the object files be compiled with <code>-fPIC</code> when linking into a <code>.so</code>. But if you have a custom loader that wants to load the <code>.so</code> at a fixed address, <code>-fPIC</code> is not necessary. The question is can the GNU linker be used to create no relocatable so files?"}, {"owner": {"reputation": 3041, "user_id": 1927339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5d22c1debe70638c165948a4a99cc0?s=128&d=identicon&r=PG", "display_name": "James_pic", "link": "https://stackoverflow.com/users/1927339/james-pic"}, "edited": false, "score": 0, "creation_date": 1571925841, "post_id": 58526860, "comment_id": 103407663, "body": "You say &quot;you can partially link your library object files into a relocatable (PIC) library&quot;, but the subtlety is that relocatable =/=&gt; PIC. The code is already relocatable (it&#39;s got enough info for a linker to relink it at a new location), but isn&#39;t PIC, and can&#39;t be made PIC. I think it is possible with the <code>-m32</code> flag, but that would also be recompiling, and if you were going to recompile, you&#39;d just use <code>-fpic</code>. I guess I was hoping someone knew &quot;this one weird trick&quot; that would persuade the dynamic linker to always load code into the bottom 2GB, so relocations could be done safely."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 3041, "user_id": 1927339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5d22c1debe70638c165948a4a99cc0?s=128&d=identicon&r=PG", "display_name": "James_pic", "link": "https://stackoverflow.com/users/1927339/james-pic"}, "edited": false, "score": 0, "creation_date": 1572027657, "post_id": 58526860, "comment_id": 103446207, "body": "@James_pic I have no issues recompiling from source. But I don&#39;t want to use <code>-fpic</code>. This was part of a research project where we were working on custom compiler. PIC wouldn&#39;t work for the type of guarantees we were trying to provide in the compiler. Also, we wanted to make it work for 64 bit binaries. We also had our custom loader so relocations weren&#39;t an issue. I guess the question should have been can ld be made to work for non-standard linkers."}, {"owner": {"reputation": 3041, "user_id": 1927339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5d22c1debe70638c165948a4a99cc0?s=128&d=identicon&r=PG", "display_name": "James_pic", "link": "https://stackoverflow.com/users/1927339/james-pic"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1572097319, "post_id": 58526860, "comment_id": 103459467, "body": "@AjayBrahmakshatriya makes sense. I assumed you&#39;d asked the question for the same reason I was here (I&#39;d been given a binary blob and told &quot;integrate that&quot;), but it sounds like you&#39;ve got a subtly different set of problems."}], "tags": [], "owner": {"reputation": 1320, "user_id": 5495906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b319c1b73d80f4155fbdd4fcb81525?s=128&d=identicon&r=PG&f=1", "display_name": "LegendofPedro", "link": "https://stackoverflow.com/users/5495906/legendofpedro"}, "is_accepted": false, "score": -1, "last_activity_date": 1571856474, "last_edit_date": 1592644375, "creation_date": 1571846334, "answer_id": 58526860, "question_id": 48901388, "link": "https://stackoverflow.com/questions/48901388/create-non-pic-shared-libraries-with-ld/58526860#58526860", "title": "Create non-PIC shared libraries with ld", "body": "<p>Recompiling the library's object files with the <code>-fpic -shared</code> options would be the best option, if this is possible!</p>\n<hr />\n<p><code>man ld</code> says:</p>\n<blockquote>\n<p><code>-i</code>  Perform an incremental link (same as option -r).</p>\n<p><code>-r</code><br />\n<code>--relocatable</code></p>\n<p>Generate relocatable output---i.e., generate an output file that can in turn serve as input to <code>ld</code>.   This is often called partial linking.  As a side effect, in environments that support standard Unix magic numbers, this option also sets the output file\u2019s magic number to &quot;OMAGIC&quot;.   If this option is not  specified, an absolute file is produced.  When linking C++ programs, this option will not resolve references to constructors; to do that, use <code>-Ur</code>.</p>\n<p>When an input file does not have the same format as the output file, partial linking is only supported  if  that  input file does not contain any relocations.  Different output formats can have further restrictions; for example some &quot;a.out&quot;-based formats do not support partial linking with input files in other formats at all.</p>\n</blockquote>\n<p>I believe you can partially link your library object files into a relocatable (PIC) library, then link that library with your source code object file to make a shared library.</p>\n<pre><code>ld -r -o libfoo.so *.o\ncp libfoo.so /foodir/libfoo.so\ncd foodir\nclang -m32 -fpic -c foo.c\nclang -m32 -fpic -shared *.o -o foo.so\n</code></pre>\n<hr />\n<p>Regarding library base address:</p>\n<p>(Again from <code>man ld</code>)</p>\n<blockquote>\n<p><code>--section-start=sectionname=org</code></p>\n<p>Locate a section in the output file at the absolute address given by org. You may use this option as many times as necessary to locate multiple sections in the command line. org must be a single hexadecimal integer; for compatibility with other linkers, you may omit the leading 0x usually associated with hexadecimal values. Note: there should be no white space between sectionname, the equals sign (&quot;=&quot;), and org.</p>\n</blockquote>\n<p>You could perhaps move your library's <code>.text</code> section?</p>\n<blockquote>\n<p><code>--image-base value</code></p>\n<p>Use value as the base address of your program or dll. This is the lowest memory location that will be used when your program or dll is loaded. To reduce the need to relocate and improve performance of your dlls, each should have a unique base address and not overlap any other dlls. The default is 0x400000 for executables, and 0x10000000 for dlls. [This option is specific to the i386 PE targeted port of the linker]</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1572027824, "post_id": 58555848, "comment_id": 103446274, "body": "<i>with the expectation of it working without problems</i> -- if I understand correctly, these problems would be at load time. But we had our custom loader that didn&#39;t care about relocations. It would always load at a fixed address. I think it is reasonable in that case to have a .so not compiled with <code>-fPIC</code>. Also, as mentioned in another comment, I had no issues with recompiling. We had access to the source. But we were building a custom compiler and <code>-fPIC</code> just wouldn&#39;t be compatible with the kind of guarantees we were trying to provide in the compiler."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1572029262, "post_id": 58555848, "comment_id": 103446877, "body": "<code>-fPIC</code> would allow it to work. Isn&#39;t that the most important guarantee? Linux may decide to swap out code pages for <code>.so</code> but not place them in the backing store. When Linux &quot;swaps&quot; those code pages back in, it is pulling from the <code>.so</code> file directly. This is why I think there is low chances of it working, since when the pages get swapped back in, since it is not <code>-fPIC</code> compiled, its state may not be correct, since it won&#39;t be &quot;initialized&quot; by your dynamic loader on the swap in."}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 2, "last_activity_date": 1572032412, "last_edit_date": 1572032412, "creation_date": 1571995889, "answer_id": 58555848, "question_id": 48901388, "link": "https://stackoverflow.com/questions/48901388/create-non-pic-shared-libraries-with-ld/58555848#58555848", "title": "Create non-PIC shared libraries with ld", "body": "<p>It is not possible to dynamically load your existing non PIC objects with the expectation of it working without problems.</p>\n\n<p>If you cannot recompile the original code to create a proper shared library that supports PIC, then I suggest you create a service executable that links to a static library composed of those objects. The service executable can then provide IPC/RPC/REST API/shared memory/whatever to allow your object code to be used by your program.</p>\n\n<p>Then, you can author a shared library which is compiled with PIC that provides wrapper APIs that launches and communicates with the service executable to perform the actual work.</p>\n\n<p>On further thought, this wrapper API library may as well be static. The dynamic aspect of it is performed by launching the service executable.</p>\n"}], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 925, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1572032665, "creation_date": 1519202490, "last_edit_date": 1572032665, "question_id": 48901388, "link": "https://stackoverflow.com/questions/48901388/create-non-pic-shared-libraries-with-ld", "title": "Create non-PIC shared libraries with ld", "body": "<p>I have a bunch of object files that have been compiled without the <code>-fPIC</code> option. So the calls to the functions do not use <code>@PLT</code>. (source code is C and is compiled with <code>clang</code>).</p>\n\n<p>I want to link these object files into a shared library that I can load at runtime using <code>dlopen</code>. I need to do this because I have to do a lot of setup before the actual <code>.so</code> is loaded. </p>\n\n<p>But every time I try to link with the <code>-shared</code> option, I get the error - </p>\n\n<blockquote>\n  <p>relocation <code>R_X86_64_PC32</code> against symbol <code>splay_tree_lookup</code> can not be used when making a shared object; recompile with <code>-fPIC</code></p>\n</blockquote>\n\n<p>I have no issues recompiling from source. But I don't want to use <code>-fPIC</code>. This is part of a research project where we are working on a custom compiler. PIC wouldn't work for the type of guarantees we are trying to provide in the compiler.</p>\n\n<p>Is there some flag I can use with <code>ld</code> so that it generate load time relocating libraries. In fact I am okay with no relocations. I can provide a base address for the library and <code>dlopen</code> can fail if the virtual address is not available. </p>\n\n<p>The command I am using for compiling my <code>c</code> files are equivalent to - </p>\n\n<pre><code>clang -m64 -c foo.c\n</code></pre>\n\n<p>and for linking I am using</p>\n\n<pre><code>clang -m64 -shared *.o -o foo.so\n</code></pre>\n\n<p>I say equivalent because it is a custom compiler (forked off <code>clang</code>) and has some extra steps. But it is equivalent. </p>\n"}, {"tags": ["c", "xml", "libxml2"], "answers": [{"comments": [{"owner": {"reputation": 2165, "user_id": 1387866, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8c28745932169219a179d1ac9c5b642c?s=128&d=identicon&r=PG", "display_name": "user1387866", "link": "https://stackoverflow.com/users/1387866/user1387866"}, "edited": false, "score": 0, "creation_date": 1519204223, "post_id": 48901614, "comment_id": 84809063, "body": "True. What I am looking for, however, is a <b>valid</b> XML node for which <code>xmlNodeGetContent()</code> would return <code>NULL</code>. Does such a scenario exist?"}, {"owner": {"reputation": 2165, "user_id": 1387866, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8c28745932169219a179d1ac9c5b642c?s=128&d=identicon&r=PG", "display_name": "user1387866", "link": "https://stackoverflow.com/users/1387866/user1387866"}, "edited": false, "score": 0, "creation_date": 1519207237, "post_id": 48901614, "comment_id": 84811208, "body": "Thanks, but I am still unable to get a node for which <code>xmlNodeGetContent()</code> returns <code>NULL</code>. For example, in the XML document <code>&lt;?xml version=&quot;1.0&quot;?&gt;&lt;xs:schema xmlns:xs=&quot;http:&#47;&#47;www.w3.org&#47;2001&#47;XMLSchema&quot;&gt;&lt;xs:notation&#47;&gt;&lt;&#47;&zwnj;&#8203;xs:schema&gt;</code>, <code>xmlNodeGetContent()</code> returns non <code>NULL</code> for node <code>&lt;xs:notation&#47;&gt;</code>, even though the source code of <code>xmlNodeGetContent()</code> says that <code>NULL</code> is returned for <code>XML_NOTATION_NODE</code>. I suppose I am missing something obvious?"}, {"owner": {"reputation": 2165, "user_id": 1387866, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8c28745932169219a179d1ac9c5b642c?s=128&d=identicon&r=PG", "display_name": "user1387866", "link": "https://stackoverflow.com/users/1387866/user1387866"}, "edited": false, "score": 0, "creation_date": 1519222383, "post_id": 48901614, "comment_id": 84821859, "body": "An XML schema <b>is</b> XML. I tried with <code>&lt;xs:notation&#47;&gt;</code> because the source code you posted mentioned <code>XML_NOTATION_NODE</code> as causing <code>xmlNodeGetContent()</code>to return <code>NULL</code>.  If you can suggest any concrete XML example (schema or not), please let me know."}], "tags": [], "owner": {"reputation": 628, "user_id": 8939165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0gchW.jpg?s=128&g=1", "display_name": "Fabio_MO", "link": "https://stackoverflow.com/users/8939165/fabio-mo"}, "is_accepted": false, "score": 2, "last_activity_date": 1519205258, "last_edit_date": 1519205258, "creation_date": 1519203241, "answer_id": 48901614, "question_id": 48901026, "link": "https://stackoverflow.com/questions/48901026/can-xmlnodegetcontent-return-null/48901614#48901614", "title": "Can xmlNodeGetContent() return NULL?", "body": "<p>If the node passed to xmlNodeGetContent is NULL the return value will be NULL:</p>\n\n<pre><code>xmlNode *current_node = NULL;\nxmlChar *ret_val;\n\nret_val = xmlNodeGetContent(current_node);\n\nif(ret_val == NULL)\n    printf(\"ret_val is NULL\\n\");\n</code></pre>\n\n<p>If the node is a Valid xmlNode, the function could return NULL in different cases, you can check the function in tree.c:</p>\n\n<pre><code>xmlChar *xmlNodeGetContent(const xmlNode *cur)\n{\nif(cur == NULL)\n    return (NULL);\nswitch(cur-&gt;type)\n    {\n    case XML_DOCUMENT_FRAG_NODE:\n    case XML_ELEMENT_NODE:\n        {\n        xmlBufPtr buf;\n        xmlChar *ret;\n\n        buf = xmlBufCreateSize(64);\n        if(buf == NULL)\n            return (NULL);\n        xmlBufGetNodeContent(buf, cur);\n        ret = xmlBufDetach(buf);\n        xmlBufFree(buf);\n        return (ret);\n        }\n    case XML_ATTRIBUTE_NODE:\n        return (xmlGetPropNodeValueInternal((xmlAttrPtr)cur));\n    case XML_COMMENT_NODE:\n    case XML_PI_NODE:\n        if(cur-&gt;content != NULL)\n            return (xmlStrdup(cur-&gt;content));\n        return (NULL);\n    case XML_ENTITY_REF_NODE:\n        {\n        xmlEntityPtr ent;\n        xmlBufPtr buf;\n        xmlChar *ret;\n\n        /* lookup entity declaration */\n        ent = xmlGetDocEntity(cur-&gt;doc, cur-&gt;name);\n        if(ent == NULL)\n            return (NULL);\n\n        buf = xmlBufCreate();\n        if(buf == NULL)\n            return (NULL);\n\n        xmlBufGetNodeContent(buf, cur);\n\n        ret = xmlBufDetach(buf);\n        xmlBufFree(buf);\n        return (ret);\n        }\n    case XML_ENTITY_NODE:\n    case XML_DOCUMENT_TYPE_NODE:\n    case XML_NOTATION_NODE:\n    case XML_DTD_NODE:\n    case XML_XINCLUDE_START:\n    case XML_XINCLUDE_END:\n        return (NULL);\n    case XML_DOCUMENT_NODE:\n    #ifdef LIBXML_DOCB_ENABLED\n    case XML_DOCB_DOCUMENT_NODE:\n    #endif\n    case XML_HTML_DOCUMENT_NODE:\n        {\n        xmlBufPtr buf;\n        xmlChar *ret;\n\n        buf = xmlBufCreate();\n        if(buf == NULL)\n            return (NULL);\n\n        xmlBufGetNodeContent(buf, (xmlNodePtr)cur);\n\n        ret = xmlBufDetach(buf);\n        xmlBufFree(buf);\n        return (ret);\n        }\n    case XML_NAMESPACE_DECL:\n        {\n        xmlChar *tmp;\n\n        tmp = xmlStrdup(((xmlNsPtr)cur)-&gt;href);\n        return (tmp);\n        }\n    case XML_ELEMENT_DECL:\n        /* TODO !!! */\n        return (NULL);\n    case XML_ATTRIBUTE_DECL:\n        /* TODO !!! */\n        return (NULL);\n    case XML_ENTITY_DECL:\n        /* TODO !!! */\n        return (NULL);\n    case XML_CDATA_SECTION_NODE:\n    case XML_TEXT_NODE:\n        if(cur-&gt;content != NULL)\n            return (xmlStrdup(cur-&gt;content));\n        return (NULL);\n    }\nreturn (NULL);\n}\n</code></pre>\n"}], "owner": {"reputation": 2165, "user_id": 1387866, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/8c28745932169219a179d1ac9c5b642c?s=128&d=identicon&r=PG", "display_name": "user1387866", "link": "https://stackoverflow.com/users/1387866/user1387866"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1525, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1519208589, "creation_date": 1519201169, "last_edit_date": 1519208589, "question_id": 48901026, "link": "https://stackoverflow.com/questions/48901026/can-xmlnodegetcontent-return-null", "title": "Can xmlNodeGetContent() return NULL?", "body": "<p>libxml2 has function <code>xmlNodeGetContent()</code>, which is documented as follows in <a href=\"http://xmlsoft.org/html/libxml-tree.html#xmlNodeGetContent\" rel=\"nofollow noreferrer\">http://xmlsoft.org/html/libxml-tree.html#xmlNodeGetContent</a>:</p>\n\n<pre><code>xmlChar *xmlNodeGetContent  (const xmlNode * cur)\n</code></pre>\n\n<blockquote>\n  <p>Read the value of a node, this can be either the text carried directly by this node if it's a TEXT node or the aggregate string of the values carried by this node child's (TEXT and ENTITY_REF). Entity references are substituted.</p>\n  \n  <p>cur:  the node being read\n  Returns:    a new #xmlChar * or NULL if no content is available. It's up to the caller to free the memory with xmlFree().</p>\n</blockquote>\n\n<p>If <code>cur</code> is an empty node, for example <code>&lt;foo/&gt;</code> (or the equivalent <code>&lt;foo&gt;&lt;/foo&gt;</code>), then <code>xmlNodeGetContent()</code> returns an empty string, not <code>NULL</code>, and that is fine IMO.</p>\n\n<p>But then, in which case would <code>xmlNodeGetContent()</code> return <code>NULL</code>? What would be a minimalistic XML example where that would happen?</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1519198904, "post_id": 48900438, "comment_id": 84806216, "body": "Why the cast in the call to <code>strrchr</code> ?"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1519199577, "post_id": 48900438, "comment_id": 84806535, "body": "How is the memory for <code>file_name</code> being allocated because <code>strdup</code> uses <code>malloc</code>?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1519199786, "post_id": 48900438, "comment_id": 84806648, "body": "@PaulR - There are two <code>strrchr</code> overloads in the C++ version of the standard library. One for const pointers and one for non-const pointers. The cast may be to get the desired one. And the C version is a disgrace as far as const correctness goes."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 3, "creation_date": 1519199869, "post_id": 48900438, "comment_id": 84806695, "body": "This function just looks very dangerous to me. It is a confusing mix of const/non-const, owned/non-owned pointers. I don&#39;t even understand what it does. If the string has a <code>&#39;.&#39;</code> it returns a substring pointer otherwise it duplicates the entire string??"}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1519200628, "post_id": 48900438, "comment_id": 84807096, "body": "Fwiw, I suspect you want something more along the lines of: <code>const char* get_file_extension(const char* file_name) { \tif(auto e = std::strrchr(file_name, &#39;.&#39;)) \t\treturn e + 1;  \treturn &quot;&quot;; }</code>"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 1, "creation_date": 1519200868, "post_id": 48900438, "comment_id": 84807228, "body": "Do you realise you can usually compile code as C, and then link it into your C++ project using your linker?"}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 5, "last_activity_date": 1519199063, "creation_date": 1519199063, "answer_id": 48900534, "question_id": 48900438, "link": "https://stackoverflow.com/questions/48900438/does-strrchr-return-nullptr-instead-of-null-in-c/48900534#48900534", "title": "does strrchr return nullptr instead of NULL in C++?", "body": "<p><code>strrchr</code> returning <code>NULL</code> is an inaccurate statement. <code>NULL</code> is a macro that expands to a null pointer constant. A null pointer constant is implicitly convertible to a null pointer of any pointer type. What <code>strrchr</code> returns is a null pointer constant that is converted to a <code>char*</code> null pointer.</p>\n\n<p><code>nullptr</code> is also a null pointer constant, with some special properties. But most of them are immaterial to us. When you compare it to a null pointer, of any type, the comparison will yield true if the pointer is a null pointer.</p>\n\n<p>As a matter of fact, even <code>nullptr == NULL</code> is perfectly fine and will give you the sane result. </p>\n"}], "owner": {"reputation": 425, "user_id": 7772722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b49445411194373cd462132dbcf63a8d?s=128&d=identicon&r=PG&f=1", "display_name": "frozenca", "link": "https://stackoverflow.com/users/7772722/frozenca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "closed_date": 1519199094, "answer_count": 1, "score": 2, "last_activity_date": 1519199063, "creation_date": 1519198742, "question_id": 48900438, "link": "https://stackoverflow.com/questions/48900438/does-strrchr-return-nullptr-instead-of-null-in-c", "closed_reason": "Duplicate", "title": "does strrchr return nullptr instead of NULL in C++?", "body": "<p>I'm porting the program from C to C++ including this code:</p>\n\n<pre><code>char* get_file_extension(const char* file_name)\n{\n    char* e = strrchr((char*) file_name, '.');\n    if (e == NULL)\n    {\n        char* buf = strdup(file_name);\n        return buf;\n    }\n    return e + 1;\n}\n</code></pre>\n\n<p>Assuming that I'm only changing compiler to c++11, is it enough to just change <strong>NULL</strong> to <strong>nullptr</strong> in this case? Currently strrchr is from included header <strong>string.h</strong>, so I'm afraid if strrchr return <strong>NULL</strong> instead of <strong>nullptr</strong> and if(e == <strong>nullptr</strong>) check fail.</p>\n\n<p>Or should I change <strong>string.h</strong> to <strong>cstring</strong>?</p>\n"}, {"tags": ["c", "linux", "assembly", "nasm", "x86-64"], "comments": [{"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 9, "creation_date": 1519195750, "post_id": 48899696, "comment_id": 84804645, "body": "64-bit calling convention passes the first 6 integer class parameters in registers (not on the stack).There is a summary of the 64-bit calling convention here: <a href=\"https://en.wikipedia.org/wiki/X86_calling_conventions#System_V_AMD64_ABI\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/&hellip;</a> . You can find the complete 64-bit ABI here: <a href=\"https://www.uclibc.org/docs/psABI-x86_64.pdf\" rel=\"nofollow noreferrer\">uclibc.org/docs/psABI-x86_64.pdf</a>"}, {"owner": {"reputation": 567, "user_id": 6039151, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zB1h4.jpg?s=128&g=1", "display_name": "Kanan Jarrus", "link": "https://stackoverflow.com/users/6039151/kanan-jarrus"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 2, "creation_date": 1519197672, "post_id": 48899696, "comment_id": 84805565, "body": "@MichaelPetch Thank you very much and also for the links.     mov rax, rdi        ;load rax with x     mov rbx, rsi        ;load rbx with y"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1519203123, "post_id": 48899696, "comment_id": 84808406, "body": "@MichaelPetch, my fault. The instruction is correct. Didn&#39;t have enough coffee yet..."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1519203185, "post_id": 48899696, "comment_id": 84808448, "body": "Apologies for saying <code>mov rsp, rbp</code> should be deleted. It is correct."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1519230552, "post_id": 48901938, "comment_id": 84827875, "body": "The function signature takes <code>int</code> args; the caller is allowed to leave garbage in the high 32 bits of <code>rdi</code> and <code>rsi</code>, so it&#39;s incorrect as well as much slower to use 64-bit <code>div</code>.  It&#39;s also incorrect to use <code>div</code> instead of <code>idiv</code> after <code>cqo</code>.  (Related: see <a href=\"https://codegolf.stackexchange.com/questions/77270/greatest-common-divisor/77364#77364\">GCD in 9 bytes of x86-64 machine code</a>, or 10 bytes for unsigned.  13 bytes for 64-bit operand-size.  Optimized for code-size at the expense of performance, but with much simpler logic than this, and comments / explanation of why it works...)"}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519233446, "post_id": 48901938, "comment_id": 84829896, "body": "@PeterCordes Many thanks for the review. It seems that it&#39;s working now for negative numbers as well."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519233964, "post_id": 48901938, "comment_id": 84830239, "body": "<code>movsxd</code> is one way to solve the problem, but <i>much</i> better would be to either change the prototype to <code>int64_t</code> or change all register names to <code>e*x</code> instead of <code>r*x</code>.  Using 64-bit <code>idiv</code> on 32-bit operands is the worst of both worlds: larger code-size and <a href=\"https://stackoverflow.com/questions/40354978/why-is-this-c-code-faster-than-my-hand-written-assembly-for-testing-the-collat/40355466#40355466\">3x worse performance</a> for no benefit in terms of range of inputs accepted."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519234088, "post_id": 48901938, "comment_id": 84830313, "body": "Also, then you could use <code>esi</code> instead of <code>ecx</code> everywhere; you still need to copy <code>edi</code> to <code>eax</code> because <code>idiv</code> uses implicit inputs, but choosing <code>ecx</code> instead of <code>ebx</code> was a missed opportunity to drop the <code>mov</code> altogether."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519234332, "post_id": 48901938, "comment_id": 84830445, "body": "And BTW, you can use <code>imul</code> on signed values if you only want the low half of the result.  e.g. <code>imul rcx, rdi, 12345</code> is the same binary operation regardless of whether you interpret it as signed or unsigned.  You&#39;re thinking of the one-operand form which matches div/idiv, but your statement that you can&#39;t use <code>idiv</code> on signed inputs isn&#39;t quite true.  In fact you <i>usually</i> don&#39;t need a full 64x64 -&gt; 128b multiply, so 2 or 3 operand <code>imul</code> is the right choice because it&#39;s faster (1 uop) and all the operands are explicit (so it doesn&#39;t constrain register choice)."}], "tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": true, "score": 4, "last_activity_date": 1519240143, "last_edit_date": 1519240143, "creation_date": 1519204258, "answer_id": 48901938, "question_id": 48899696, "link": "https://stackoverflow.com/questions/48899696/pass-values-from-c-program-to-assembly-language/48901938#48901938", "title": "Pass values from C program to Assembly language", "body": "<h3>Passing arguments to <code>gcdasm()</code></h3>\n\n<p>The two <code>int</code> arguments are passed through registers, not the stack. The first and second arguments are passed in the lower-half of <code>rdi</code> and <code>rsi</code> (i.e.: <code>edi</code> and <code>esi</code>), respectively. So, by sign extending <code>edi</code> and <code>esi</code> into <code>rax</code> and <code>rbx</code> respectively, you load the passed arguments into those registers:</p>\n\n<pre><code>movsx rax, edi  ;load rax with x\nmovsx rbx, esi  ;load rbx with y\n</code></pre>\n\n<p>However, note that <code>rbx</code> is not a <em>scratch register</em>, therefore the <em>callee</em> needs to save it before modifying it and then restore it back before leaving the <code>gcdasm</code> function.</p>\n\n<p>You can simply replace <code>rbx</code> by <code>rcx</code> (which isn't a <em>callee-saved</em> register) everywhere in your code. You don't need <code>rbp</code> at all, so you can remove all the instructions where <code>rbp</code> appears.</p>\n\n<hr>\n\n<h3>Other problems</h3>\n\n<ul>\n<li><p>There is also a problem with the logic of the program with:</p>\n\n<pre><code>mov rax, rdx   ;reminder rdx as next dividend\n</code></pre>\n\n<p>Instead of this, the <em>divisor</em> (<code>rcx</code>) should become the <em>dividend</em> (<code>rax</code>) and the <em>remainder</em> (<code>rdx</code>) should become the <em>divisor</em> (<code>rcx</code>), that is:</p>\n\n<pre><code>mov rax, rcx\nmov rcx, rdx\n</code></pre></li>\n<li><p>When dividing <strong>signed</strong> values, you have to use the <code>idiv</code> instruction, not <code>div</code>.</p></li>\n</ul>\n\n<hr>\n\n<h3>Improvement</h3>\n\n<p>There are also some reasons regarding performance and code size to use <code>test rdx, rdx</code> instead of <code>cmp rdx, 0</code> for <a href=\"https://stackoverflow.com/a/33724806/8012646\">comparing <code>rdx</code> against zero</a>.</p>\n\n<hr>\n\n<p>With all that above in mind:</p>\n\n<pre><code>;gcdasm.nasm\nbits 64\nsection .text\nglobal gcdasm\ngcdasm:\n    movsx rax, edi          ;load rax with x\n    movsx rcx, esi          ;load rcx with y\ntop:\n    cmp rax, rcx            ;x(rax) has to be larger than y(rcx)\n    je exit                 ;if x=y then exit and return value y\n    jb xchange              ;if x&lt;y then swap x and y\nmodulo:\n    cqo                     ;sign extend RDX:RAX\n    idiv rcx                ;rdx:rax/rcx (signed values)\n    test rdx, rdx           ;check whether remainder is zero\n    je exit                 ;if reminder is 0 then exit return y\n    mov rax, rcx            ;divisor becomes dividend\n    mov rcx, rdx            ;remainder becomes divisor\n    jmp modulo              ;loop \nxchange:\n    xchg rax, rcx           ;swap x and y\n    jmp modulo\n\nexit:\n    mov rax, rcx            ;Return c program with the divisor y\n    ret\n</code></pre>\n"}], "owner": {"reputation": 567, "user_id": 6039151, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zB1h4.jpg?s=128&g=1", "display_name": "Kanan Jarrus", "link": "https://stackoverflow.com/users/6039151/kanan-jarrus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 1, "accepted_answer_id": 48901938, "answer_count": 1, "score": 5, "last_activity_date": 1519240143, "creation_date": 1519195550, "last_edit_date": 1519202222, "question_id": 48899696, "link": "https://stackoverflow.com/questions/48899696/pass-values-from-c-program-to-assembly-language", "title": "Pass values from C program to Assembly language", "body": "<p>I would like to pass values from C program to Assembly using the linked assembly method instead of inline assembly method in C.\nBelow is the Assembly program(GCD) which is am working on.</p>\n\n<pre><code>;gcdasm.nasm\nbits 64\nsection .text\nglobal gcdasm\ngcdasm:\n    push rbp\n    mov rbp, rsp\n    mov rax, [rbp+4]        ;load rax with x\n    mov rbx, [rbp+8]        ;load rbx with y\ntop:\n    cmp rax, rbx            ;x(rax) has to be larger than y(rbx)\n    je exit                 ;if x=y then exit and return value y\n    jb xchange              ;if x&lt;y then swap x and y\nmodulo:\n    cqo                     ;RDX:RAX sign extend\n    div rbx                 ;div rdx:rax with rbx\n    cmp rdx, 0              ;check remider if its 0\n    je exit                 ;if reminder is 0 then exit return return y\n    mov rax, rdx            ;reminder rdx as next dividend\n    jmp modulo              ;loop \nxchange:\n    xchg rax, rbx           ;swap x and y\n    jmp modulo\n\nexit:\n    mov rax, rbx            ;Return c program with the divisor y\n    mov rsp, rbp\n    pop rbp\n    ret\n</code></pre>\n\n<p>And this is the C program from with I am trying to pass the values to assembly program</p>\n\n<pre><code>//gcd.c\n#include&lt;stdio.h&gt;\n\nextern int gcdasm(int x, int y); \n\nint main(void){\n    int x=0;\n    int y=0;\n    int result=0;\n\n    x = 46; \n    y = 90; \n    printf(\"%d and %d have a gcd of %d\\n\", x,y,gcdasm(x,y));\n\n    x = 55;\n    y = 66;\n    printf(\"%d and %d have a gcd of %d\\n\", x,y,gcdasm(x,y));\n\n    return 0;\n}\n</code></pre>\n\n<p>When I compile using the below method and run it. I get either error <code>Floating point exception</code> or an empty prompt waiting for input</p>\n\n<pre><code>$ nasm -felf64 gcdasm.nasm -o gcdasm.o\n$ gcc gcdasm.o gcd.c -o gcd\n$ ./gcd \nFloating point exception\n$ ./gcd \n</code></pre>\n\n<p>I am unable to figure out the error. Kindly help me out.\nThank you. </p>\n"}, {"tags": ["c", "sockets", "tcp", "client-server", "sigpipe"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1519195691, "post_id": 48899626, "comment_id": 84804619, "body": "You aren&#39;t paying attention to what <code>read()</code> and <code>write()</code> return, which is always a serious problem.  You don&#39;t error check <code>socket()</code> or <code>connect()</code> (or <code>bind()</code> or <code>accept()</code>) either \u2014 ditto.  You copy <code>argv[1]</code> into <code>sendline</code> which really isn&#39;t necessary, but if you do the copying, you must check there&#39;s enough space.   Although the <code>read()</code> in the client is &#39;safe&#39;, you need to know how many bytes were received so you can print the correct number; you might have read 100 of 120 bytes, and the string won&#39;t be null-terminate.  You have to be very, very careful!"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1519195835, "post_id": 48899626, "comment_id": 84804683, "body": "To answer the headline question, you&#39;d have to handle SIGPIPE errors \u2014 or ignore them and pay attention to error returns from <code>write()</code>.  You can then close the connection and loop back for the next one.  You also aren&#39;t closing any file descriptors, so sooner or later you&#39;ll run out of them."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1519229133, "post_id": 48899626, "comment_id": 84826875, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/108183/how-to-prevent-sigpipes-or-handle-them-properly\">How to prevent SIGPIPEs (or handle them properly)</a>"}], "answers": [{"tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 2, "last_activity_date": 1519196222, "last_edit_date": 1519196222, "creation_date": 1519195877, "answer_id": 48899772, "question_id": 48899626, "link": "https://stackoverflow.com/questions/48899626/broken-pipe-for-c-socket-how-to-only-keep-server-running/48899772#48899772", "title": "Broken Pipe for C-Socket. How to only keep server running?", "body": "<ol>\n<li>Your client sends one request and reads one response.</li>\n<li>It then exits without closing the socket.</li>\n<li>Your server runs in a loop reading requests and sending responses.</li>\n<li>Your server ignores end of stream.</li>\n<li>Little or none of this code is error-checked.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "is_accepted": true, "score": 3, "last_activity_date": 1519235413, "last_edit_date": 1519235413, "creation_date": 1519198451, "answer_id": 48900375, "question_id": 48899626, "link": "https://stackoverflow.com/questions/48899626/broken-pipe-for-c-socket-how-to-only-keep-server-running/48900375#48900375", "title": "Broken Pipe for C-Socket. How to only keep server running?", "body": "<p>Your program has two problems:</p>\n\n<p>1) <code>read()</code> works differently than you think:</p>\n\n<p>Normally <code>read()</code> will read up to a certain number of <strong>bytes</strong> from some file or stream (e.g. socket).</p>\n\n<p>Because <code>read()</code> does not distinguish between different types of bytes (e.g. letters, the end-of-line marker or even the NUL byte) <code>read()</code> will not work like <code>fgets()</code> (reading line-wise).</p>\n\n<p><code>read()</code> is also allowed to \"split\" the data: If you do a <code>write(...\"Hello\\n\"...)</code> on the client the server may receive <code>\"Hel\"</code> the first time you call <code>read()</code> and the next time it receives <code>\"lo\\n\"</code>.</p>\n\n<p>And of course <code>read()</code> can concatenate data: Call <code>write(...\"Hello\\n\"...)</code> and <code>write(...\"World\\n\"...)</code> on the client and one single <code>read()</code> call may receive <code>\"Hello\\nWorld\\n\"</code>.</p>\n\n<p>And of course both effects may appear at the same time and you have to call <code>read()</code> three times receiving <code>\"Hel\"</code>, <code>\"lo\\nWo\"</code> and <code>\"rld\\n\"</code>.</p>\n\n<p>TTYs (= the console (keyboard) and serial ports) have a special feature (which may be switched off) that makes the <code>read()</code> call behave like <code>fgets()</code>. However <strong>only</strong> TTYs have such a feature!</p>\n\n<p>In the case of sockets <code>read()</code> will always wait for at least one byte to be received and return the (positive) number of bytes received as long as the connection is alive. As soon as <code>read()</code> returns zero or a negative value the connection has been dropped.</p>\n\n<p>You have to use a <code>while</code> loop that processes data until the connection has been dropped.</p>\n\n<p>You'll have to check the data received by <code>read()</code> if it contains the NUL byte to detect the \"end\" of the data - if \"your\" data is terminated by a NUL byte.</p>\n\n<p>2) As soon as the client drops the connection the handle returned by <code>accept()</code> is useless.</p>\n\n<p>You should close that handle to save memory and file descriptors (there is a limit on how many file descriptors you can have open at one time).</p>\n\n<p>Then you have to call <code>accept()</code> again to wait for the client to establish a new connection.</p>\n"}], "owner": {"reputation": 13, "user_id": 9085379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f2906153b0af0879744094796ba2a18?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/9085379/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 532, "favorite_count": 0, "accepted_answer_id": 48900375, "answer_count": 2, "score": 0, "last_activity_date": 1519235413, "creation_date": 1519195319, "last_edit_date": 1519220688, "question_id": 48899626, "link": "https://stackoverflow.com/questions/48899626/broken-pipe-for-c-socket-how-to-only-keep-server-running", "title": "Broken Pipe for C-Socket. How to only keep server running?", "body": "<p>In a simple program where I'm trying to send command-line inputs from client to server, I keep getting a \"Broken Pipe\" for the server side. I send a string to the server and the server returns the string as lower-case to the client. </p>\n\n<h3>Server:</h3>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;unistd.h&gt;\n\nint main()\n{\n\n    char str[100];\n    int listen_fd, comm_fd;\n\n    struct sockaddr_in servaddr;\n\n    listen_fd = socket(AF_INET, SOCK_STREAM, 0);\n\n    bzero( &amp;servaddr, sizeof(servaddr));\n\n    servaddr.sin_family = AF_INET;\n    servaddr.sin_addr.s_addr = htons(INADDR_ANY);\n    servaddr.sin_port = htons(37892);\n\n    bind(listen_fd, (struct sockaddr *) &amp;servaddr, sizeof(servaddr));\n\n    listen(listen_fd, 10);\n\n    comm_fd = accept(listen_fd, (struct sockaddr*) NULL, NULL);\n\n    while(1){\n                bzero( str, 100);\n                read(comm_fd,str,100);\n                for(int i = 0; i &lt; strlen(str); i++){\n\n                        str[i] = tolower(str[i]);\n\n                }\n                printf(\"Echoing back - %s\",str);\n                write(comm_fd, str, strlen(str)+1);\n        }\n}\n</code></pre>\n\n<h3>Client</h3>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;ctype.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc,char **argv)\n{\n    int sockfd,n;\n    char sendline[100];\n    char recvline[100];\n    struct sockaddr_in servaddr;\n\n    sockfd=socket(AF_INET,SOCK_STREAM,0);\n    bzero(&amp;servaddr,sizeof servaddr);\n\n    servaddr.sin_family=AF_INET;\n    servaddr.sin_port=htons(37892);\n\n    inet_pton(AF_INET,\"127.0.0.1\",&amp;(servaddr.sin_addr));\n\n    connect(sockfd,(struct sockaddr *)&amp;servaddr,sizeof(servaddr));\n\n\n    if(argc==1) printf(\"\\nNo arguments\");\n\n    if (1){\n        {\n                bzero( sendline, 100);\n                bzero( recvline, 100);\n                strcpy(sendline, argv[1]);\n                write(sockfd,sendline,strlen(sendline)+1);\n                read(sockfd,recvline,100);\n                printf(\"%s\",recvline);\n         }\n     }\n}\n</code></pre>\n\n<p>The problem I found was that when the client's side is done sending the string, the command line input does not work like <code>fgets()</code> where the loop will wait for another user input. If I change the <code>if(1)</code> in the client's side to a <code>while(1)</code>, it will obviously run an infinite loop as no new inputs are being added. \nThe dilemma is, how would I be able to keep the server's side running to continuously return the string to the client while processing single requests from the command line on the client's side?</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1519195328, "post_id": 48899393, "comment_id": 84804453, "body": "Check out <code>strerror()</code>. Also, check the manpage, it explains pretty well what the reasons for the fault could be. If I were you, I&#39;d first try it without forking, i.e. to read from the same process. At least, that avoids having to communicate valid addresses between the two processes, which is probably what you failed to do."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 1, "creation_date": 1519197048, "post_id": 48899393, "comment_id": 84805276, "body": "What makes you think that your child process has something at address 0x10? The error looks sensible. There is nothing there so it returns EFAULT."}, {"owner": {"reputation": 13, "user_id": 8767670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14dc895cd2bcd16c8b72820114b67811?s=128&d=identicon&r=PG&f=1", "display_name": "user217366", "link": "https://stackoverflow.com/users/8767670/user217366"}, "reply_to_user": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1519199091, "post_id": 48899393, "comment_id": 84806304, "body": "@UlrichEckhardt The advice of using <code>strerror()</code> and considering how addresses work has been helpful. I am indeed getting a <code>Bad address</code> error, and this is making it a bit easier to narrow down the problem. @Art After taking the address of the variable in the <code>target</code> program, I get a really big value, not just 0x10, so it was a good idea to check that out. My initial assumption was that the 0x10 would be relative to the start of the <code>target</code> program&#39;s ram. Do you have any links to where I can read about the proper way of doing this?"}, {"owner": {"reputation": 2451, "user_id": 1729784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d97a5cecaf61887679df1f79b59b157?s=128&d=identicon&r=PG", "display_name": "DaBler", "link": "https://stackoverflow.com/users/1729784/dabler"}, "edited": false, "score": 1, "creation_date": 1519214049, "post_id": 48899393, "comment_id": 84816046, "body": "Use <code>pmap -x $PID</code> to explore valid virtual address ranges."}], "owner": {"reputation": 13, "user_id": 8767670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14dc895cd2bcd16c8b72820114b67811?s=128&d=identicon&r=PG&f=1", "display_name": "user217366", "link": "https://stackoverflow.com/users/8767670/user217366"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 633, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1519194359, "creation_date": 1519194359, "question_id": 48899393, "link": "https://stackoverflow.com/questions/48899393/process-vm-readv-efault", "title": "process_vm_readv() EFAULT", "body": "<p>I'm trying to create a child process and access its memory, but all my tests are leading to an <code>EFAULT</code> error.</p>\n\n<pre><code>#define _GNU_SOURCE // needed for process_vm_readv\n#include &lt;stdio.h&gt;\n#include &lt;sys/uio.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(const int argc, char *const argv[]) {\n    struct iovec local[2];\n    struct iovec remote[1];\n    char buf1[10];\n    char buf2[10];\n    ssize_t nread;\n    pid_t pid; // PID of remote process\n    pid=fork();\n    if(pid==0) { // child process\n        execvp(\"./target\",argv);\n        return 0;\n    } else if(pid==-1) {\n        puts(\"Error creating child process!\");\n        return 0;\n    }\n    printf(\"This process: %d\\n\",getpid());\n    printf(\"Created process: %d\\n\",pid);\n    local[0].iov_base=buf1;\n    local[0].iov_len=10;\n    local[1].iov_base=buf2;\n    local[1].iov_len=10;\n    remote[0].iov_base=(void*)0x10; // address 0x10\n    remote[0].iov_len=20; // 20 bytes\n    nread=process_vm_readv(pid,local,2,remote,1,0);\n    if(nread==-1) {\n        printf(\"process_vm_readv error: \");\n        switch(errno) {\n            case EINVAL: puts(\"EINVAL\"); break;\n            case EFAULT: puts(\"EFAULT\"); break;\n            case ENOMEM: puts(\"ENOMEM\"); break;\n            case EPERM: puts(\"EPERM\"); break;\n            case ESRCH: puts(\"ESRCH\"); break;\n        }\n        return 1;\n    }\n    printf(\"%ld bytes read\\n\",nread);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "malloc", "valgrind"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1519194976, "post_id": 48899386, "comment_id": 84804293, "body": "your first <code>malloc</code> looks just fine.. valgrind is saying &quot;this is the spot where you allocated memory but never <code>free</code>d it&quot;. Whether you want to or not is up to you,, I know some high rep users here don&#39;t worry about manually cleaning up by relying on the OS to cleanup allocated memory once the process exits. Personally I always try to cleanup after myself."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1519195002, "post_id": 48899386, "comment_id": 84804304, "body": "Why <code>sizeof (void*)</code>? (which is <code>sizeof &quot;a pointer&quot;</code>) and not <code>void **items = malloc(array-&gt;capacity *  sizeof *items);</code>? There are no other issues with your allocation. As posted, earlier, if that is a valgrind <code>&#39;error&#39;</code>, then it makes little sense, if that is a failure to <code>free</code>, then that&#39;s all it is."}], "answers": [{"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 2, "last_activity_date": 1519195976, "last_edit_date": 1519195976, "creation_date": 1519195644, "answer_id": 48899722, "question_id": 48899386, "link": "https://stackoverflow.com/questions/48899386/valgrind-error-when-using-malloc/48899722#48899722", "title": "Valgrind error when using malloc", "body": "<p>As discussed above in the comments, it is unclear why you allocate <code>items</code> with:</p>\n\n<pre><code> void **items = malloc(sizeof(void *) * array-&gt;capacity *  sizeof *items);\n</code></pre>\n\n<p>(which essentially allocates 8x (an additional multiple of <code>sizeof \"a pointer\"</code>) number of pointers than would be required) </p>\n\n<p>Instead, if you are allocating <code>array-&gt;capacity</code> pointers for <code>items</code>, then use:</p>\n\n<pre><code>void **items = malloc(array-&gt;capacity * sizeof *items);\n</code></pre>\n\n<p>Your <code>valgrind</code> error does not look like an error, but the result of not calling <code>free</code> on the memory you allocate, leaving <code>valgrind</code> to report the bytes lost (still reachable on exit). You can easily free the memory on exit with a simple <code>destroyArray</code> function similar to:</p>\n\n<pre><code>void destroyArray (Array *array) {\n    for (int i = 0; i &lt; array-&gt;size; i++)\n        free (array-&gt;items[i]);\n    free (array-&gt;items);\n    free (array);\n}\n</code></pre>\n\n<p>Putting it altogether you could do something like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Array {\n    int capacity;\n    int size;\n    void **items;\n} Array;\n\nArray *createArray (int capacity) {\n    Array *array = malloc (sizeof *array);\n    array-&gt;capacity = capacity;\n    array-&gt;size = 0;\n    void **items = malloc(array-&gt;capacity *  sizeof *items);\n    if(items == NULL) {\n        exit(1);\n    }\n    array-&gt;items = items;\n    return array;\n}\n\nvoid destroyArray (Array *array) {\n    for (int i = 0; i &lt; array-&gt;size; i++)\n        free (array-&gt;items[i]);\n    free (array-&gt;items);\n    free (array);\n}\n\nint main (void) {\n\n    Array *a = createArray (10);\n    printf (\"%d capacity\\n\", a-&gt;capacity);\n    destroyArray (a);\n\n    return 0;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> you should also validate <code>Array *array = malloc (sizeof *array);</code> succeeded and <code>(array != NULL)</code> before attempting to use <code>array</code>)</p>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<pre><code>$ valgrind ./bin/allocstruct\n==5777== Memcheck, a memory error detector\n==5777== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==5777== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\n==5777== Command: ./bin/allocstruct\n==5777==\n10 capacity\n==5777==\n==5777== HEAP SUMMARY:\n==5777==     in use at exit: 0 bytes in 0 blocks\n==5777==   total heap usage: 2 allocs, 2 frees, 96 bytes allocated\n==5777==\n==5777== All heap blocks were freed -- no leaks are possible\n==5777==\n==5777== For counts of detected and suppressed errors, rerun with: -v\n==5777== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Look things over and let me know if this is what you were concerned with.</p>\n"}], "owner": {"reputation": 1360, "user_id": 6593789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-nfq6l0wyldk/AAAAAAAAAAI/AAAAAAAABY0/mHRz3aBVoLU/photo.jpg?sz=128", "display_name": "random_coder_101", "link": "https://stackoverflow.com/users/6593789/random-coder-101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 920, "favorite_count": 1, "accepted_answer_id": 48899722, "answer_count": 1, "score": 0, "last_activity_date": 1519195976, "creation_date": 1519194322, "question_id": 48899386, "link": "https://stackoverflow.com/questions/48899386/valgrind-error-when-using-malloc", "title": "Valgrind error when using malloc", "body": "<p>I am using valgrind to fix memory leaks in my C program, and there is one particular function that seems to be the source of most of the valgrind errors</p>\n\n<pre><code>typedef struct Array {\n    int capacity;\n    int size;\n    void **items;\n} Array;\n\nArray *createArray(int capacity) {\n    Array *array = malloc(sizeof(Array));\n    array-&gt;capacity = capacity;\n    array-&gt;size = 0;\n    void **items = malloc(sizeof(void *) * array-&gt;capacity *  sizeof *items);\n    if(items == NULL) {\n        exit(1);\n    }\n    array-&gt;items = items;\n    return array;\n}\n</code></pre>\n\n<p>The first line of the <code>createArray</code> function is throwing the following error in Valgrind</p>\n\n<p><code>1,296 (16 direct, 1,280 indirect) bytes in 1 blocks are definitely lost in loss record 34 of 42</code></p>\n\n<p>Am I not using malloc in the right way to allocate memory? </p>\n"}, {"tags": ["c", "windows-installer", "extract", "cab"], "comments": [{"owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "edited": false, "score": 0, "creation_date": 1519193950, "post_id": 48899235, "comment_id": 84803906, "body": "You asked for native C Msi* functions. But if it&#39;s sufficient to do it interactively you can look at the dark.exe from the WiX toolset. There is also source code available."}, {"owner": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "reply_to_user": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "edited": false, "score": 0, "creation_date": 1519194167, "post_id": 48899235, "comment_id": 84803987, "body": "I will see the source code (assume it is native). I cannot use external exe, as I need to read something in my custom DLL."}, {"owner": {"reputation": 52255, "user_id": 200936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/229997ce0b9f7c0adcc049fcd25113ef?s=128&d=identicon&r=PG", "display_name": "Christopher Painter", "link": "https://stackoverflow.com/users/200936/christopher-painter"}, "edited": false, "score": 0, "creation_date": 1519246454, "post_id": 48899235, "comment_id": 84836948, "body": "My answer below explains how you can query all the tables and extract assemble the directory tree of files.  If your willing to look at .NET   WiX/DTF has a InstallPackage::ExtractFiles()  method that does all this for you.  The source code is here: <a href=\"https://github.com/wixtoolset/Dtf/blob/master/src/WixToolset.Dtf.WindowsInstaller.Package/InstallPackage.cs\" rel=\"nofollow noreferrer\">github.com/wixtoolset/Dtf/blob/master/src/&hellip;</a>"}, {"owner": {"reputation": 52255, "user_id": 200936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/229997ce0b9f7c0adcc049fcd25113ef?s=128&d=identicon&r=PG", "display_name": "Christopher Painter", "link": "https://stackoverflow.com/users/200936/christopher-painter"}, "edited": false, "score": 0, "creation_date": 1519246507, "post_id": 48899235, "comment_id": 84836968, "body": "The DTF code should explain the process and every class it calls to interact with MSI has doco that says what the underlying Win32 API is that you would use in c++."}, {"owner": {"reputation": 34253, "user_id": 129130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/FJpdt.gif?s=128&g=1", "display_name": "Stein &#197;smul", "link": "https://stackoverflow.com/users/129130/stein-%c3%85smul"}, "edited": false, "score": 0, "creation_date": 1519664417, "post_id": 48899235, "comment_id": 84992101, "body": "Hmm, just saw this perfectly legit question down-voted. What on earth is that for? Let&#39;s upvote - this is a good question. You got good answers already, I added one with some info on the <b>Win32 functions</b> you can use below. Also, consider searching for <code>msi.chm</code> in your WiX installation folder or the Windows SDK - it is the MSI bible - the MSI SDK documentation itself. Much quicker to look things up in than the online MSDN version. And you get a sense of scope as well - how much content there really is to review."}], "answers": [{"comments": [{"owner": {"reputation": 15266, "user_id": 89999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26e95045ab2611253f7dcd8b71e2174c?s=128&d=identicon&r=PG", "display_name": "Michael Urman", "link": "https://stackoverflow.com/users/89999/michael-urman"}, "edited": false, "score": 1, "creation_date": 1519412458, "post_id": 48912919, "comment_id": 84915762, "body": "This is definitely the right first method to recommend. But as a point of nomenclature, this (/a) is performing an administrative installation instead of an advertised install (/j); see <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa367988\" rel=\"nofollow noreferrer\">Command-Line Options</a>."}, {"owner": {"reputation": 52255, "user_id": 200936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/229997ce0b9f7c0adcc049fcd25113ef?s=128&d=identicon&r=PG", "display_name": "Christopher Painter", "link": "https://stackoverflow.com/users/200936/christopher-painter"}, "edited": false, "score": 0, "creation_date": 1519415661, "post_id": 48912919, "comment_id": 84917287, "body": "Quite right. Between Phil, Michael, Stein and myself you aren&#39;t going to get any wrong answers in this question.  Your probably looking at 100 years of setup development expertise right there."}], "tags": [], "owner": {"reputation": 19184, "user_id": 3261150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0821e1dca957dda1214f1d273a08e161?s=128&d=identicon&r=PG&f=1", "display_name": "PhilDW", "link": "https://stackoverflow.com/users/3261150/phildw"}, "is_accepted": false, "score": 3, "last_activity_date": 1519237390, "creation_date": 1519237390, "answer_id": 48912919, "question_id": 48899235, "link": "https://stackoverflow.com/questions/48899235/how-extract-deployment-files-from-msi-database/48912919#48912919", "title": "How extract deployment files from MSI database", "body": "<p>The most straightforward to extract all the files to some location is to install the product in \"advertised\" mode. If you do a: </p>\n\n<p>msiexec /a [path to msi] TARGETDIR=[some folder] </p>\n\n<p>you'll see what happens. </p>\n\n<p>In C++ call MsiInstallProduct () with that command line. </p>\n"}, {"comments": [{"owner": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "edited": false, "score": 0, "creation_date": 1519367427, "post_id": 48915208, "comment_id": 84891343, "body": "I&#39;ve found out that virtual table <code>_Streams</code> holds the deployable files. I can also use structured-storage API directly on the MSI to get the files/CAB. Thanks!"}, {"owner": {"reputation": 52255, "user_id": 200936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/229997ce0b9f7c0adcc049fcd25113ef?s=128&d=identicon&r=PG", "display_name": "Christopher Painter", "link": "https://stackoverflow.com/users/200936/christopher-painter"}, "reply_to_user": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "edited": false, "score": 1, "creation_date": 1519373863, "post_id": 48915208, "comment_id": 84893991, "body": "It took me 6 months back in 2003 but I think the entire MSI SDK documentation is indexed in my brain.:)"}], "tags": [], "owner": {"reputation": 52255, "user_id": 200936, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/229997ce0b9f7c0adcc049fcd25113ef?s=128&d=identicon&r=PG", "display_name": "Christopher Painter", "link": "https://stackoverflow.com/users/200936/christopher-painter"}, "is_accepted": true, "score": 3, "last_activity_date": 1519246209, "creation_date": 1519246209, "answer_id": 48915208, "question_id": 48899235, "link": "https://stackoverflow.com/questions/48899235/how-extract-deployment-files-from-msi-database/48915208#48915208", "title": "How extract deployment files from MSI database", "body": "<p>Phil has given you the easy/simple answer but I thought I might give you a little more information since you've done some research.  Checkout:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa372919(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/aa372919(v=vs.85).aspx</a></p>\n\n<p>This is where the structured storage is.  You'll see something like Disk1.cab as the Name (PK) and binary data.  The data is a CAB file with the file entry in the cab matching the  File.File  column.  From there you can use the File.FileName column to get the short name and long name (you'll want the long name no doubt)  and do a joint to the Component table to get the directory table ID.</p>\n\n<p>You'll also need to recurse the directory table to build the tree of directories and know where to put the files.</p>\n\n<p>Fun stuff.  There's some libraries in C# that make this WAY simpler.  Or just call msiexec /a  as Phil says. :)</p>\n"}, {"tags": [], "owner": {"reputation": 34253, "user_id": 129130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/FJpdt.gif?s=128&g=1", "display_name": "Stein &#197;smul", "link": "https://stackoverflow.com/users/129130/stein-%c3%85smul"}, "is_accepted": false, "score": 2, "last_activity_date": 1533924286, "last_edit_date": 1533924286, "creation_date": 1519634295, "answer_id": 48984360, "question_id": 48899235, "link": "https://stackoverflow.com/questions/48899235/how-extract-deployment-files-from-msi-database/48984360#48984360", "title": "How extract deployment files from MSI database", "body": "<p>You have gotten many good answers already, including the use of <code>dark.exe</code> from the WiX toolkit. <strong>By downloading the WiX source code you should be able to get the code you need ready-made from there</strong>. I assume you may already have done this.</p>\n\n<p><strong>Chris</strong> has already linked to the <strong>DTF code</strong> you can check, but here is a link directly to <strong>dark.exe</strong> as well: <a href=\"https://github.com/wixtoolset/wix3/tree/develop/src/tools/dark\" rel=\"nofollow noreferrer\">https://github.com/wixtoolset/wix3/tree/develop/src/tools/dark</a>. I would try both. This is C#, you seem to want native.</p>\n\n<p><strong>UPDATE</strong>: Before I get to the Win32 features you can use, check out this little summary of the C# DTF features: <a href=\"https://stackoverflow.com/questions/298841/how-to-programmatically-read-the-properties-inside-an-msi-file/1061606#1061606\">How to programmatically read the properties inside an MSI file?</a></p>\n\n<p><strong>Native Win32 functions</strong>: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa368250(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><strong>The database functions</strong></a> to deal with an MSI file can be found on MSDN (this is to deal with the MSI file as a database). There are also <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa369426(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><strong>MSI Installer Functions</strong></a> (used to deal with the MSI file as an actual installer).</p>\n\n<p>You can certainly find good examples of native code for this with a good Google search. Have fun!</p>\n\n<hr>\n\n<p>BTW: It would help with a description of the actual problem you are trying to solve as well as what you need technically. There could - as always - be less involved ways to achieve what you need. Unless you are writing a security software or malware scanner or something super-involved.</p>\n\n<hr>\n\n<p>And so it is clear: WiX's <code>dark.exe</code> fully decompiles MSI files into WiX source files and the resource files used to build them - you can then text and binary compare the various types of content (<strong>text compare</strong> for tables, <strong>binary compare</strong> for binaries, etc...). The process to do so via command line is described in the following answer: <a href=\"https://stackoverflow.com/questions/48482545/how-can-i-compare-the-content-of-two-or-more-msi-files/48482546#48482546\">How can I compare the content of two (or more) MSI files?</a> (this is about comparing MSI files, but one option to do so is to decompile them - see section on <code>dark.exe</code> - just for reference for others who find your question).</p>\n\n<hr>\n\n<p>I like to link things together so we can find content easily at a later point in time. Strictly speaking it doesn't seem necessary here, you have what you need I think but others could perhaps benefit from some further links. Here are some related links:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/1547809/extract-msi-from-exe/24987512#24987512\">Extract MSI from EXE</a>.</li>\n<li><a href=\"https://stackoverflow.com/questions/5564619/what-is-the-purpose-of-administrative-installation-initiated-using-msiexec-a/5751980#5751980\">What is the purpose of administrative installation initiated using msiexec /a?</a></li>\n<li><a href=\"https://superuser.com/questions/307678/how-do-i-extract-files-from-an-msi-package/788227#788227\">How do I extract files from an MSI package?</a> (explains why you should not use 7-Zip to extract).</li>\n</ul>\n"}], "owner": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1672, "favorite_count": 0, "accepted_answer_id": 48915208, "answer_count": 3, "score": 0, "last_activity_date": 1533924286, "creation_date": 1519193590, "question_id": 48899235, "link": "https://stackoverflow.com/questions/48899235/how-extract-deployment-files-from-msi-database", "title": "How extract deployment files from MSI database", "body": "<p>MSI database contains set of tables, and I can successfully enumerate <code>File</code> table, which has all deployable file' meta-deta. What I need to extract is the actual contents of those files. <strong>msiexec</strong>, <strong>lessmsi</strong>, <strong>7-zip</strong> all can do it, but I couldn't find any source/API to do it.</p>\n\n<p>What I've discovered it that all other (resource) files are in <code>Binary</code> table, and <strong>Data</strong> field can be used to get content of those files (like icons, custom DLL etc). </p>\n\n<p>Further, I found and know that <code>Media</code> table contains information about the .CAB file (MSI has all content embedded with <code>&lt;MediaTemplate EmbedCab=\"yes\"/&gt;</code>. This simply means the CAB file contains the actual content. I probably need to read contents from \"Structured Storage\" of the .msi file.</p>\n\n<p>How to extract the contents of CAB/MSI file, using native C Msi* functions? </p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1549067383, "post_id": 48899016, "comment_id": 95784152, "body": "This is exactly what&#39;s happening."}], "tags": [], "owner": {"reputation": 2947, "user_id": 4411196, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Q6b8W.jpg?s=128&g=1", "display_name": "gtalarico", "link": "https://stackoverflow.com/users/4411196/gtalarico"}, "is_accepted": false, "score": 1, "last_activity_date": 1519192605, "creation_date": 1519192605, "answer_id": 48899016, "question_id": 48898892, "link": "https://stackoverflow.com/questions/48898892/if-else-if-else-statement-problems/48899016#48899016", "title": "if-else if-else statement problems", "body": "<p>Im not sure what language that is, but many languages don't support chained operator, so you would have break down the comparison like this: </p>\n\n<pre><code> if (0 &lt; a) and (a &lt;= 10); \n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/4090845/language-support-for-chained-comparison-operators-x-y-z\">Language support for chained comparison operators (x &lt; y &lt; z)</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9389137, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Cheng Jie", "link": "https://stackoverflow.com/users/9389137/cheng-jie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1549057570, "creation_date": 1519191903, "last_edit_date": 1549057570, "question_id": 48898892, "link": "https://stackoverflow.com/questions/48898892/if-else-if-else-statement-problems", "title": "if-else if-else statement problems", "body": "<p>If I write a code like this.It will print 1 obviously.</p>\n\n<pre><code>int a = 0;\nif (a == 0)\n    print(\"1\");\nelse if (0 &lt; a &lt;= 10)\n    print(\"2\");\nelse if (10 &lt; a &lt;= 100)          \n    print(\"3\");\nelse\n    print(\"4\");\n</code></pre>\n\n<p>Then I change the order of the first statement and the second statement, like this.</p>\n\n<pre><code>int a = 0;\nif (0 &lt; a &lt;= 10)\n    print(\"1\");\nelse if (a==0)\n    print(\"2\");\nelse if (10 &lt; a &lt;= 100)          \n    print(\"3\");\nelse\n    print(\"4\");\n</code></pre>\n\n<p>After compile, It still print 1. Why It doesn't print 2 ?</p>\n"}, {"tags": ["c", "cmake", "platformio"], "comments": [{"owner": {"reputation": 325, "user_id": 1207583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a3f676610de385c50d084f41fb5813?s=128&d=identicon&r=PG", "display_name": "frankleonrose", "link": "https://stackoverflow.com/users/1207583/frankleonrose"}, "edited": false, "score": 0, "creation_date": 1542048362, "post_id": 48898733, "comment_id": 93420479, "body": "PlatformIO is supposed to look in the {project-home}/lib directory when searching for include files. Did you put both dependencies under that directory."}, {"owner": {"reputation": 325, "user_id": 1207583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a3f676610de385c50d084f41fb5813?s=128&d=identicon&r=PG", "display_name": "frankleonrose", "link": "https://stackoverflow.com/users/1207583/frankleonrose"}, "edited": false, "score": 0, "creation_date": 1542048504, "post_id": 48898733, "comment_id": 93420523, "body": "Also, PlatformIO uses the <code>library.json</code> file in the <i>library</i> root to identify library dependencies. You could try to submit a PR to the primary library <a href=\"https://github.com/th0br0\" rel=\"nofollow noreferrer\">github.com/th0br0</a> with a <code>library.json</code> file that referred to the other library."}], "owner": {"reputation": 1998, "user_id": 4094489, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/egnIZ.jpg?s=128&g=1", "display_name": "Citrullin", "link": "https://stackoverflow.com/users/4094489/citrullin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 326, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1519192021, "creation_date": 1519190947, "last_edit_date": 1519192021, "question_id": 48898733, "link": "https://stackoverflow.com/questions/48898733/cant-resolve-library-dependencies", "title": "Can&#39;t resolve Library dependencies", "body": "<p>I got a platformio project. I want to include a library on a specific commit.</p>\n\n<p>So, I used the command line interface of platformio:</p>\n\n<pre><code>platformio lib --storage-dir lib install https://github.com/th0br0/iota.lib.c.git#fd193af198628759da39cf6a930fa352c012ba4b\n</code></pre>\n\n<p>That works fine. I just can now include the library on the following way:</p>\n\n<pre><code>#include &lt;iota/iota.h&gt;\n</code></pre>\n\n<p>But this library has also dependencies and these dependencies got not resolved. So, I also imported the dependencies of the dependencies:</p>\n\n<pre><code>platformio lib --storage-dir lib install https://github.com/th0br0/ccurl.git#c8cd1f87def10ebf0f31483dcc42c3b95473c982\n</code></pre>\n\n<p>In comparison to the other library, I cannot include this library via </p>\n\n<pre><code>#include &lt;curl.h&gt;\n</code></pre>\n\n<p>When I deploy my project, I see the second library will not included into the build project</p>\n\n<pre><code>Library Dependency Graph ( [BITLY_LINK] )\n|-- &lt;iota.lib.c&gt; #31d0a89\n|-- &lt;avr-enc28j60&gt;\n</code></pre>\n\n<p>[BITLY_LINK] pints to <a href=\"http://docs.platformio.org/en/latest/librarymanager/ldf.html\" rel=\"nofollow noreferrer\">http://docs.platformio.org/en/latest/librarymanager/ldf.html</a></p>\n\n<p>My CMakeLists: <a href=\"https://pastebin.com/eeY756SN\" rel=\"nofollow noreferrer\">https://pastebin.com/eeY756SN</a></p>\n\n<p>My CMakeListsPrivate: <a href=\"https://pastebin.com/14W23BxZ\" rel=\"nofollow noreferrer\">https://pastebin.com/14W23BxZ</a></p>\n\n<p>I included the following to CMakeListsPrivate:</p>\n\n<pre><code>include_directories(\"$ENV{HOME}/git/c/BlinkExample/lib/iota.lib.c/external/ccurl/src/lib\")\n</code></pre>\n\n<p>My IDE is now able to find curl.h, but I still get the compiler error.</p>\n\n<pre><code>src/main.c:7:18: fatal error: curl.h: No such file or directory\n</code></pre>\n\n<p>The complete output: <a href=\"https://pastebin.com/wb0BBdfx\" rel=\"nofollow noreferrer\">https://pastebin.com/wb0BBdfx</a></p>\n"}, {"tags": ["c", "operating-system"], "comments": [{"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1519186139, "post_id": 48897955, "comment_id": 84801513, "body": "Read <a href=\"http://man7.org/linux/man-pages/man2/fork.2.html\" rel=\"nofollow noreferrer\">fork()</a> sys call. Check out its return value for parent and child process."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1519191754, "post_id": 48897955, "comment_id": 84803080, "body": "<b>One</b> question per question. You&#39;ve got 2 questions with absolutely nothing connecting the 2, except that the piece of the code happens to be the same."}], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 5357221, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh5.googleusercontent.com/-zOcZuKobtk4/AAAAAAAAAAI/AAAAAAAABrs/izSzfYant-c/photo.jpg?sz=128", "display_name": "Guanfang Dong", "link": "https://stackoverflow.com/users/5357221/guanfang-dong"}, "edited": false, "score": 0, "creation_date": 1519186530, "post_id": 48898030, "comment_id": 84801596, "body": "Thank you, really helpful!"}], "tags": [], "owner": {"reputation": 97, "user_id": 9185003, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nJ6ki_1kVxs/AAAAAAAAAAI/AAAAAAAAAy8/3U7i5BzmXjs/photo.jpg?sz=128", "display_name": "Susmitha Kundukulam", "link": "https://stackoverflow.com/users/9185003/susmitha-kundukulam"}, "is_accepted": false, "score": 2, "last_activity_date": 1519186186, "creation_date": 1519186186, "answer_id": 48898030, "question_id": 48897955, "link": "https://stackoverflow.com/questions/48897955/how-many-stars-will-the-printed-from-the-execution-of-this-program/48898030#48898030", "title": "How many stars will the printed from the execution of this program?", "body": "<p>System call <a href=\"https://en.wikipedia.org/wiki/Fork_(system_call)\" rel=\"nofollow noreferrer\">fork()</a> is used to create processes. It takes no arguments and returns a process ID. </p>\n\n<p>The purpose of fork() is to create a new process, which becomes the child process of the caller. After a new child process is created, both processes will execute the next instruction following the fork() system call. </p>\n\n<p><strong>Return values of fork()</strong></p>\n\n<p>If fork() returns a <strong>negative value</strong>, the <strong>creation</strong> of a child process was <strong>unsuccessful</strong>.</p>\n\n<p>fork() returns a <strong>zero</strong> to the newly <strong>created child process</strong>.</p>\n\n<p>fork() returns a <strong>positive value</strong>, the <strong>process ID</strong> of the <strong>child</strong> process, to the parent.</p>\n\n<p>Refer : <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/fork.html\" rel=\"nofollow noreferrer\">http://pubs.opengroup.org/onlinepubs/009695399/functions/fork.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 333, "user_id": 5357221, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh5.googleusercontent.com/-zOcZuKobtk4/AAAAAAAAAAI/AAAAAAAABrs/izSzfYant-c/photo.jpg?sz=128", "display_name": "Guanfang Dong", "link": "https://stackoverflow.com/users/5357221/guanfang-dong"}, "edited": false, "score": 0, "creation_date": 1519188321, "post_id": 48898070, "comment_id": 84802034, "body": "Thank you so much. I read your link and watch this video <a href=\"https://www.youtube.com/watch?v=PwxTbksJ2fo\" rel=\"nofollow noreferrer\">youtube.com/watch?v=PwxTbksJ2fo</a> . I kind of understand what is going on. Really helpful. One thing I still want to know what is this related to my second part of question. What .bss .data .text and .rotate going to be? Thanks!"}, {"owner": {"reputation": 2876, "user_id": 9385656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebcde0684fd04332d139e8bb270b2875?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Gupta", "link": "https://stackoverflow.com/users/9385656/nishant-gupta"}, "reply_to_user": {"reputation": 333, "user_id": 5357221, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh5.googleusercontent.com/-zOcZuKobtk4/AAAAAAAAAAI/AAAAAAAABrs/izSzfYant-c/photo.jpg?sz=128", "display_name": "Guanfang Dong", "link": "https://stackoverflow.com/users/5357221/guanfang-dong"}, "edited": false, "score": 0, "creation_date": 1519188438, "post_id": 48898070, "comment_id": 84802058, "body": "If you can go through this link it will be very helpful: <a href=\"https://jvns.ca/blog/2014/09/06/how-to-read-an-executable/\" rel=\"nofollow noreferrer\">jvns.ca/blog/2014/09/06/how-to-read-an-executable</a>"}], "tags": [], "owner": {"reputation": 2876, "user_id": 9385656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebcde0684fd04332d139e8bb270b2875?s=128&d=identicon&r=PG&f=1", "display_name": "Nishant Gupta", "link": "https://stackoverflow.com/users/9385656/nishant-gupta"}, "is_accepted": true, "score": 2, "last_activity_date": 1519186495, "creation_date": 1519186495, "answer_id": 48898070, "question_id": 48897955, "link": "https://stackoverflow.com/questions/48897955/how-many-stars-will-the-printed-from-the-execution-of-this-program/48898070#48898070", "title": "How many stars will the printed from the execution of this program?", "body": "<p>System call Fork() is used to create processes.\nIt returns an integer which works like this:</p>\n\n<ol>\n<li>If fork() returns a negative value, the creation of a child process\nwas unsuccessful.</li>\n<li>fork() returns a zero to the newly created child process.</li>\n<li>fork() returns a positive value, the process ID of the child\nprocess, to the parent.</li>\n</ol>\n\n<p>Following is the example of a process tree diagram:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n   fork(); /* A */\n   ( fork()  /* B */ &amp;&amp;\n     fork()  /* C */ ) || /* B and C are grouped according to precedence */\n   fork(); /* D */\n   fork(); /* E */\n\n   printf(\"forked\\n\");\n   return 0;\n}\n</code></pre>\n\n<p>Diagram:\n<a href=\"https://i.stack.imgur.com/Hf5rN.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Hf5rN.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>For more clear explanation go to this link :\n<a href=\"https://www.geeksforgeeks.org/fork-and-binary-tree/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/fork-and-binary-tree/</a></p>\n"}], "owner": {"reputation": 333, "user_id": 5357221, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh5.googleusercontent.com/-zOcZuKobtk4/AAAAAAAAAAI/AAAAAAAABrs/izSzfYant-c/photo.jpg?sz=128", "display_name": "Guanfang Dong", "link": "https://stackoverflow.com/users/5357221/guanfang-dong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 48898070, "answer_count": 2, "score": -1, "last_activity_date": 1519191806, "creation_date": 1519185597, "last_edit_date": 1519191806, "question_id": 48897955, "link": "https://stackoverflow.com/questions/48897955/how-many-stars-will-the-printed-from-the-execution-of-this-program", "title": "How many stars will the printed from the execution of this program?", "body": "<p>This is a question for my mid-term. I know there gonna be 2 stars after running program. But I am not sure why. And this question wants me to draw a diagram to illustrate the reason. I am not sure how to draw it.</p>\n\n<p>Thanks for any help!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\n\nunsigned char i;\nint main() {\n    unsigned int fs;\n    for (i=0; i&lt;2; i++) {\n        fs = fork();\n        if (fs) { printf(\"*\\n\"); }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "function", "pointers", "malloc"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1519184315, "post_id": 48897800, "comment_id": 84801100, "body": "your pointer is passed by value."}, {"owner": {"reputation": 15, "user_id": 6222720, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8tNbgVQQ8WM/AAAAAAAAAAI/AAAAAAAARtY/fdDEz8sTad4/photo.jpg?sz=128", "display_name": "Ilya A", "link": "https://stackoverflow.com/users/6222720/ilya-a"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1519184689, "post_id": 48897800, "comment_id": 84801189, "body": "Thanks, I think I missed it. I need to pass pointer to a pointer?"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1519184972, "post_id": 48897800, "comment_id": 84801248, "body": "Yes, exactly so"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1519188131, "post_id": 48897800, "comment_id": 84801995, "body": "There is no such thing as allocating memory to a pointer."}], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 6059867, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fFwza.jpg?s=128&g=1", "display_name": "Alec C", "link": "https://stackoverflow.com/users/6059867/alec-c"}, "edited": false, "score": 2, "creation_date": 1519184997, "post_id": 48897867, "comment_id": 84801253, "body": "You&#39;d also have to change the function parameter <code>void func(int **newvar)</code>"}], "tags": [], "owner": {"reputation": 71, "user_id": 9301209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/858c777efaf3e214794653dc699aa6a1?s=128&d=identicon&r=PG&f=1", "display_name": "aokellermann", "link": "https://stackoverflow.com/users/9301209/aokellermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1519184903, "creation_date": 1519184903, "answer_id": 48897867, "question_id": 48897800, "link": "https://stackoverflow.com/questions/48897800/how-to-allocate-memory-to-an-pointer-passed-to-a-function/48897867#48897867", "title": "How to allocate memory to an pointer passed to a function?", "body": "<p>You have to pass the memory location of var to func like this</p>\n\n<pre><code>func(&amp;var);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": true, "score": 2, "last_activity_date": 1519185013, "creation_date": 1519185013, "answer_id": 48897878, "question_id": 48897800, "link": "https://stackoverflow.com/questions/48897800/how-to-allocate-memory-to-an-pointer-passed-to-a-function/48897878#48897878", "title": "How to allocate memory to an pointer passed to a function?", "body": "<p><em>After the function has exited, a value of the pointer 'var' did not change</em> ? if you want var to be changed then pass the <code>address</code> of <code>var</code> and in <code>func()</code> catch with <code>double pointer</code> as</p>\n\n<pre><code>int main(int argc, char *argv[]) {\n        int *var;\n        printf(\"before in %s : %p\\n\",__func__,var);\n        func(&amp;var); /* pass the address of var */\n        printf(\"after in  %s : %p\\n\",__func__,var);\n        //system(\"pause\");\n        return 0;\n}\n\nvoid func(int **newvar) {\n        int *tmp = malloc(sizeof(*newvar));\n        *newvar = tmp; /* it will change the var in calling function */\n        printf(\" in  %s : %p\\n\",__func__,*newvar);\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6222720, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8tNbgVQQ8WM/AAAAAAAAAAI/AAAAAAAARtY/fdDEz8sTad4/photo.jpg?sz=128", "display_name": "Ilya A", "link": "https://stackoverflow.com/users/6222720/ilya-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 48897878, "answer_count": 2, "score": 0, "last_activity_date": 1519185013, "creation_date": 1519184272, "question_id": 48897800, "link": "https://stackoverflow.com/questions/48897800/how-to-allocate-memory-to-an-pointer-passed-to-a-function", "title": "How to allocate memory to an pointer passed to a function?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid func(int *newvar);\n\nint main(int argc, char *argv[]) \n{\n    int *var;\n    func(var);\n\n    system(\"pause\");\n    return 0;\n}\n\nvoid func(int *newvar)\n{\n    int *tmp = malloc(sizeof(int));\n    newvar = tmp;\n}\n</code></pre>\n\n<p>After the function has exited, a value of the pointer 'var' did not change. What could be wrong in my code? </p>\n"}, {"tags": ["c", "compilation", "header"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1519188357, "post_id": 48897693, "comment_id": 84802041, "body": "Why are your files called header.c, header2.c, header3.c, ... when they are not headers?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1519195958, "post_id": 48897693, "comment_id": 84804753, "body": "How did you rule out using an IDE? There are some free (as in beer and as in liberty) ones out there. It would reduce the effort for building to the click of a button."}, {"owner": {"reputation": 71, "user_id": 9388798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2961bef8199da78625759384677762?s=128&d=identicon&r=PG&f=1", "display_name": "FooHAH", "link": "https://stackoverflow.com/users/9388798/foohah"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1519256667, "post_id": 48897693, "comment_id": 84841198, "body": "@Yunnosch (Im not sure there&#39;s a tagging function in SO) That&#39;s because I program on my school server, accessed through PUTTY as an SSH connection  and therefore  have nothing but a lunux terminal. Tried out Visual overnight, works great, now trying to find a way to connect this to my school server. Thx"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1519324920, "post_id": 48897693, "comment_id": 84876500, "body": "Good reason, thanks for explaining. You might want to improve your question by <a href=\"https://stackoverflow.com/posts/48897693/edit\">edit</a>ing this additional info into it."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 9388798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2961bef8199da78625759384677762?s=128&d=identicon&r=PG&f=1", "display_name": "FooHAH", "link": "https://stackoverflow.com/users/9388798/foohah"}, "edited": false, "score": 0, "creation_date": 1519256816, "post_id": 48897733, "comment_id": 84841247, "body": "Thanks for the overall explanation. Sorry I cant upvote due to low rep."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1519183616, "creation_date": 1519183616, "answer_id": 48897733, "question_id": 48897693, "link": "https://stackoverflow.com/questions/48897693/compiling-files-with-own-header-in-c/48897733#48897733", "title": "Compiling files with own header in C", "body": "<p>You could make a shell macro or script to execute the command, if it is too much effort to use shell history feature to re-execute the command. </p>\n\n<p>When your project starts to get complicated it's normal to use a <em>build system</em> in which you configure the build commands in the build system, and then you invoke the build system when you want to build. For example, write a Makefile that lists all the <code>.c</code> files using the right syntax for makefiles, and then type <code>make</code> each time you want to build.</p>\n\n<p>You could consider using an <em>Integrated Development Environment</em> which is a (usually) GUI that includes a build system and other useful features, in which case you just need to hit a key to build and run.</p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 9388798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2961bef8199da78625759384677762?s=128&d=identicon&r=PG&f=1", "display_name": "FooHAH", "link": "https://stackoverflow.com/users/9388798/foohah"}, "edited": false, "score": 0, "creation_date": 1519256767, "post_id": 48897787, "comment_id": 84841226, "body": "Thank you for the answer. Interesting wiki read. Sorry I cant upvote due to low rep."}, {"owner": {"reputation": 36, "user_id": 7989940, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A8SgC5dWLQA/AAAAAAAAAAI/AAAAAAAAAfA/4HB6cFw4gJg/photo.jpg?sz=128", "display_name": "Willian Lopes", "link": "https://stackoverflow.com/users/7989940/willian-lopes"}, "reply_to_user": {"reputation": 71, "user_id": 9388798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2961bef8199da78625759384677762?s=128&d=identicon&r=PG&f=1", "display_name": "FooHAH", "link": "https://stackoverflow.com/users/9388798/foohah"}, "edited": false, "score": 0, "creation_date": 1519273488, "post_id": 48897787, "comment_id": 84845543, "body": "No problem. As a new C programmer, know how to use makefile will help you a lot."}], "tags": [], "owner": {"reputation": 36, "user_id": 7989940, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A8SgC5dWLQA/AAAAAAAAAAI/AAAAAAAAAfA/4HB6cFw4gJg/photo.jpg?sz=128", "display_name": "Willian Lopes", "link": "https://stackoverflow.com/users/7989940/willian-lopes"}, "is_accepted": false, "score": 1, "last_activity_date": 1519184172, "creation_date": 1519184172, "answer_id": 48897787, "question_id": 48897693, "link": "https://stackoverflow.com/questions/48897693/compiling-files-with-own-header-in-c/48897787#48897787", "title": "Compiling files with own header in C", "body": "<p>I think you are looking for the make, that automates the execution of the files you are compiling. </p>\n\n<p>With the use of make, you don't need to write every time the commands like 'gcc test.c header1.c header2.c ...' in the terminal (if you type the commands directly to the terminal, yes, you will need to do this all the time, which is very redundant and costs lots of time). Using make, you only do this one time, and then all you have to do is run the make command.</p>\n\n<p>You can see more about makefile at <a href=\"https://en.wikibooks.org/wiki/Make\" rel=\"nofollow noreferrer\">https://en.wikibooks.org/wiki/Make</a>.\nI hope it can help you.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 9301209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/858c777efaf3e214794653dc699aa6a1?s=128&d=identicon&r=PG&f=1", "display_name": "aokellermann", "link": "https://stackoverflow.com/users/9301209/aokellermann"}, "is_accepted": false, "score": 0, "last_activity_date": 1519185754, "creation_date": 1519185754, "answer_id": 48897975, "question_id": 48897693, "link": "https://stackoverflow.com/questions/48897693/compiling-files-with-own-header-in-c/48897975#48897975", "title": "Compiling files with own header in C", "body": "<p>Writing a simple Makefile is very useful for compiling C programs. Here's an example</p>\n\n<pre><code>CC = gcc\nCFLAGS = -g -Wall\nOBJECTS = main.o cfile1.o cfile2.o cfile3.o\nrun: $(OBJECTS)\n    $(CC) $(CFLAGS) -o run $(OBJECTS)\n</code></pre>\n\n<p>Don't worry about header files when writing a Makefile; only worry about your \".c\" files. This example Makefile assumes that you want to compile main.c, cfile1.c, cfile2.c, and cfile3.c. When adding the C files to your Makefile, make sure to use \".o\" instead of \".c\". </p>\n\n<p>The Makefile should be in the same directory as your C files and must be named \"Makefile\" with a capital M. Simply type \"make\" to compile. Then run the program with \"./run\". </p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 9388798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2961bef8199da78625759384677762?s=128&d=identicon&r=PG&f=1", "display_name": "FooHAH", "link": "https://stackoverflow.com/users/9388798/foohah"}, "edited": false, "score": 0, "creation_date": 1519256716, "post_id": 48898317, "comment_id": 84841211, "body": "Thank you for the answer! Cleared detailed parts of my doubts and questions"}], "tags": [], "owner": {"reputation": 330, "user_id": 7897377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGGai.jpg?s=128&g=1", "display_name": "Cerulean Chelonii ", "link": "https://stackoverflow.com/users/7897377/cerulean-chelonii"}, "is_accepted": true, "score": 0, "last_activity_date": 1519189689, "last_edit_date": 1519189689, "creation_date": 1519188290, "answer_id": 48898317, "question_id": 48897693, "link": "https://stackoverflow.com/questions/48897693/compiling-files-with-own-header-in-c/48898317#48898317", "title": "Compiling files with own header in C", "body": "<p>It is often desirable to spread out your code across multiple files; this helps to ease code management. Header files provide a unified way to expose functions defined in libraries or source code files to other source code files without including the actual code for those functions. This way, the same header file can be included in multiple source code files without compiling the same code for each of those files. However, this means that the source code for functions in the header file must be given to the compiler also. As such, you have to give your <code>header.c</code> to the compiler each time you compile.</p>\n\n<p>This does mean that you will compile <code>header.c</code> each time you build your project, which is a bit redundant. One way around this is to compile the <code>header.c</code> into an <em>object file</em>, and then give that the compiler when you build:</p>\n\n<pre><code>gcc -c header.c -o header.o\ngcc header.o test.c\n</code></pre>\n\n<p>Furthermore, software developers often like to distribute their program functions to other developer but without providing the actaul code. To do this, they often use software libraries, which contain the compiled source code, along with header files to access this code. This is  probably a little more than what your looking for, so I'll leave you read up on it.</p>\n\n<p>All this is used not to reduce redundancy in your compiler commands, but in your compiled programs. To make programmers' lives easier building their programs, makefiles and IDEs are often used. These may be things you might have to read up on, but the other answers posted here should provide a good starting point. </p>\n"}], "owner": {"reputation": 71, "user_id": 9388798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2961bef8199da78625759384677762?s=128&d=identicon&r=PG&f=1", "display_name": "FooHAH", "link": "https://stackoverflow.com/users/9388798/foohah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 1, "accepted_answer_id": 48898317, "answer_count": 4, "score": 3, "last_activity_date": 1519190385, "creation_date": 1519183292, "last_edit_date": 1519190385, "question_id": 48897693, "link": "https://stackoverflow.com/questions/48897693/compiling-files-with-own-header-in-c", "title": "Compiling files with own header in C", "body": "<p>I am currently at the beginning stage of learning how to program in C, and I came across some questions regrading header files. For example</p>\n\n<blockquote>\n  <p>I have a header file named <code>header.h</code>, </p>\n  \n  <p>which has <code>int comp (int, int)</code> declared in <code>header.h</code> and</p>\n  \n  <p>defined in <code>header.c</code></p>\n</blockquote>\n\n<p>In such case, If i were to compile a test.c using the comp function, I would have to go like</p>\n\n<pre><code>gcc test.c header.c\n</code></pre>\n\n<p>First question: having to add header.c everytime I gcc seems too inconvenient and redundant. Is it a necessity? If not, is there a way I can get around it? If so, why? Or is it, in fact, not redundant compared to its usage, and am I just complaining?</p>\n\n<p>Second question: if I were to use multiple .c files with functions declared in header.h my gcc would have to go </p>\n\n<pre><code>gcc test.c header.c header2.c header3.c .....\n</code></pre>\n\n<p>and that again seems too redundant. (and from hereon, same questions as First question..)</p>\n\n<p>Thanks in advance. First time asking questions in SO. Please tell me if there is anyway I can improve the clarity of the question.</p>\n"}, {"tags": ["c", "recursion", "binary-search-tree"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519183573, "post_id": 48897657, "comment_id": 84800952, "body": "Perhaps <code>if (node==NULL){     return depth;} else{     return depth + Total_Depth(node-&gt;left, depth) + Total_Depth(node-&gt;right, depth); }</code>?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519183678, "post_id": 48897657, "comment_id": 84800976, "body": "@chux <code>return 0</code> is correct for a nonexistent node."}, {"owner": {"reputation": 441, "user_id": 9157984, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-vXi7w-SXd_s/AAAAAAAAAAI/AAAAAAAAABg/7vU84LLEviY/photo.jpg?sz=128", "display_name": "Md. Mostafizur Rahman Mafi", "link": "https://stackoverflow.com/users/9157984/md-mostafizur-rahman-mafi"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519183846, "post_id": 48897657, "comment_id": 84801008, "body": "@chux - you are not  incrementing the value of depth"}], "answers": [{"comments": [{"owner": {"reputation": 441, "user_id": 9157984, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-vXi7w-SXd_s/AAAAAAAAAAI/AAAAAAAAABg/7vU84LLEviY/photo.jpg?sz=128", "display_name": "Md. Mostafizur Rahman Mafi", "link": "https://stackoverflow.com/users/9157984/md-mostafizur-rahman-mafi"}, "edited": false, "score": 0, "creation_date": 1519184049, "post_id": 48897694, "comment_id": 84801050, "body": "@Ben Han- accept the answer if its help you so that community know the answer help you"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1519187136, "post_id": 48897694, "comment_id": 84801749, "body": "It would be helpful if you could explain why the OPs answer using post-increment is wrong."}], "tags": [], "owner": {"reputation": 441, "user_id": 9157984, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-vXi7w-SXd_s/AAAAAAAAAAI/AAAAAAAAABg/7vU84LLEviY/photo.jpg?sz=128", "display_name": "Md. Mostafizur Rahman Mafi", "link": "https://stackoverflow.com/users/9157984/md-mostafizur-rahman-mafi"}, "is_accepted": true, "score": 2, "last_activity_date": 1519190616, "last_edit_date": 1519190616, "creation_date": 1519183305, "answer_id": 48897694, "question_id": 48897657, "link": "https://stackoverflow.com/questions/48897657/finding-total-with-binary-search-tree-in-c/48897694#48897694", "title": "finding total with Binary Search Tree in C", "body": "<p>You call your recursion function with post-increment <strong>depth++</strong>.\nThe post-increment operator increments the variable after you use it, so it will only increment the variable after the recursive function is returned.\nFor this, in recursion function calling you should not use post-increment.</p>\n\n<p>So, you should replace your <strong>depth++</strong> with <strong>depth+1</strong>.</p>\n\n<pre><code>  return depth + Total_Depth(node-&gt;left, depth+1) + \n  Total_Depth(node-&gt;right, depth+1);\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6876535, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-n8K6des8dkU/AAAAAAAAAAI/AAAAAAAAA-c/wek-BlO3yGA/photo.jpg?sz=128", "display_name": "Ben Han", "link": "https://stackoverflow.com/users/6876535/ben-han"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 48897694, "answer_count": 1, "score": 0, "last_activity_date": 1519190616, "creation_date": 1519182955, "question_id": 48897657, "link": "https://stackoverflow.com/questions/48897657/finding-total-with-binary-search-tree-in-c", "title": "finding total with Binary Search Tree in C", "body": "<p>let's say I have BST with</p>\n\n<pre><code>          50\n         /  \\\n        30   70\n       / \\   / \\\n      20 40 60 80\n</code></pre>\n\n<p>My total depth should be 1 + 2 + 2 + 3 + 3 + 3 + 3= 17, and I have total depth function </p>\n\n<pre><code>int Total_Depth(struct node* node, int depth){\nif (node==NULL){\n    return 0;}\nelse{\n    return depth + Total_Depth(node-&gt;left, depth++) + Total_Depth(node-&gt;right, depth++);\n}\n</code></pre>\n\n<p>When I call Total_Depth function in main() <code>printf(\"%d\\n\", Total_Depth(root, 0))</code> I get 12 rather than 17. Can anyone explain me why this is the case? I can't really figure out a way to find total depth</p>\n"}, {"tags": ["javascript", "java", "c"], "comments": [{"owner": {"reputation": 507083, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 2, "creation_date": 1519182775, "post_id": 48897608, "comment_id": 84800781, "body": "Not in JavaScript, no. (As there are no integers in JS anyway). Can you please point to the talk where he said this, to give some context?"}, {"owner": {"reputation": 16300, "user_id": 4758494, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ywtVA.jpg?s=128&g=1", "display_name": "Hassan Imam", "link": "https://stackoverflow.com/users/4758494/hassan-imam"}, "edited": false, "score": 0, "creation_date": 1519183063, "post_id": 48897608, "comment_id": 84800834, "body": "This only will be true if addition results in an overflow, but I highly doubt it in the case of Javascript."}, {"owner": {"reputation": 1466, "user_id": 7152046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58aa1424f1487821eaed82b78bd4676?s=128&d=identicon&r=PG&f=1", "display_name": "Pavan Bahuguni", "link": "https://stackoverflow.com/users/7152046/pavan-bahuguni"}, "reply_to_user": {"reputation": 507083, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1519183837, "post_id": 48897608, "comment_id": 84801006, "body": "@Bergi Talk was The good parts of javascript. And you are right it&#39;s not possible in javascript, it&#39;s in languages that support int as a seperate type."}, {"owner": {"reputation": 507083, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1519184058, "post_id": 48897608, "comment_id": 84801052, "body": "In that case, he&#39;s referring to <a href=\"https://en.wikipedia.org/wiki/Integer_overflow\" rel=\"nofollow noreferrer\">integer overflow</a> that happens for fixed-width integer represetations."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1519197785, "post_id": 48897608, "comment_id": 84805631, "body": "<i>&quot;Good that we don&#39;t have int&quot;</i> is a misleading sentence: It&#39;s not the integer data type that is the problem. It&#39;s possible to have C implementation where overflow never happens, but many implementations choose not to as it&#39;s more faster that way due to hardware limitations."}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 2, "last_activity_date": 1519191944, "last_edit_date": 1592644375, "creation_date": 1519191944, "answer_id": 48898901, "question_id": 48897608, "link": "https://stackoverflow.com/questions/48897608/strange-properties-of-int/48898901#48898901", "title": "Strange properties of int", "body": "<p>In <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> there is a scenario which can lead to this kind of behavior.(For example: signed integer addition etc) Signed integer overflow is undefined behavior. Evaluation of an expression produces undefined behavior if the result is not a representable value of the expression's type. On many machines the undefined behavior turns out to be the fact - that it will turn <code>c</code> negative (talking in context of signed addition). This is signed integer overflow. An example must be something like</p>\n<pre><code>int a = INT_MAX;\nint b = INT_MAX;\nint c = a + b; //&lt;--- overflow.\n</code></pre>\n<p>Digging a bit further it is clear that overflow behavior is getting fixed to the max value of the type in case of <a href=\"/questions/tagged/javascript\" class=\"post-tag\" title=\"show questions tagged &#39;javascript&#39;\" rel=\"tag\">javascript</a>. So the scenario you showed is most probably not of <a href=\"/questions/tagged/javascript\" class=\"post-tag\" title=\"show questions tagged &#39;javascript&#39;\" rel=\"tag\">javascript</a>.</p>\n<p>In <a href=\"/questions/tagged/java\" class=\"post-tag\" title=\"show questions tagged &#39;java&#39;\" rel=\"tag\">java</a> when it overflows it goes back to the minimum value and start from there. For underflow the same happens but only the maximum value is reached and then it goes from there.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1519217112, "post_id": 48899215, "comment_id": 84818166, "body": "It would be more accurate to say that computer integers cannot model mathematics exactly when they overflow, or to otherwise phase this. Whether the handling is \u201cproper\u201d or not is a value judgement\u2014if the behavior works for a particular application, even most applications, and is used appropriately, and is a fast, economic solution, then it is proper. It is a tool that served its purpose. The fact that it has limits does not make it bad; all tools have limits."}], "tags": [], "owner": {"reputation": 11, "user_id": 9389221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c189319f4fffc7c499afdac460e5954a?s=128&d=identicon&r=PG&f=1", "display_name": "user9389221", "link": "https://stackoverflow.com/users/9389221/user9389221"}, "is_accepted": false, "score": 1, "last_activity_date": 1519193493, "creation_date": 1519193493, "answer_id": 48899215, "question_id": 48897608, "link": "https://stackoverflow.com/questions/48897608/strange-properties-of-int/48899215#48899215", "title": "Strange properties of int", "body": "<p>It is possible because the overflow condition in addition operation is not handled properly.\nSay in a system int takes 2 bytes of space.\nso the range supported is -32768 to +32767 or 0 to 65535</p>\n\n<pre><code>a=65534,b=4; \nc=a+b;\nc=3.\n\nb=65534,a=4; \nc=a+b;\nc=3.\n</code></pre>\n"}], "owner": {"reputation": 1466, "user_id": 7152046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58aa1424f1487821eaed82b78bd4676?s=128&d=identicon&r=PG&f=1", "display_name": "Pavan Bahuguni", "link": "https://stackoverflow.com/users/7152046/pavan-bahuguni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1519193493, "creation_date": 1519182530, "last_edit_date": 1519183643, "question_id": 48897608, "link": "https://stackoverflow.com/questions/48897608/strange-properties-of-int", "title": "Strange properties of int", "body": "<p>In one of his talks Douglas Crockford says, int have some strange properties and he goes ahead and explains,\nIt is possible to have two integers a and b, such that a > 0, b > 0.</p>\n\n<pre><code>c = a + b\n</code></pre>\n\n<p>And we can end up with a c possibly c &lt; a or b &lt; a.\nCan someone explain this with an example.</p>\n\n<p>This is a screenshot from his talk.\n<a href=\"https://i.stack.imgur.com/2z58Z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2z58Z.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "malloc", "free"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 3, "creation_date": 1519181623, "post_id": 48897471, "comment_id": 84800535, "body": "<code>myChar = (char**)malloc(sizeof(char*));</code> you allocate (space for) a single pointer, not 5."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1519184800, "post_id": 48897471, "comment_id": 84801215, "body": "Tip: <code>sizeof(char)</code> is garanteed to be <code>1</code>. No need to multiply by <code>1</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519186213, "post_id": 48897471, "comment_id": 84801535, "body": "Use <code>ptr = malloc(sizeof *ptr * nElmenets);</code>  Easy to code review and maintain."}, {"owner": {"reputation": 316, "user_id": 1246135, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0606d884a169b21358f4e361297bc332?s=128&d=identicon&r=PG", "display_name": "brneuro", "link": "https://stackoverflow.com/users/1246135/brneuro"}, "edited": false, "score": 0, "creation_date": 1519216597, "post_id": 48897471, "comment_id": 84817815, "body": "Thanks all, that&#39;s painfully obvious now."}], "answers": [{"comments": [{"owner": {"reputation": 316, "user_id": 1246135, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0606d884a169b21358f4e361297bc332?s=128&d=identicon&r=PG", "display_name": "brneuro", "link": "https://stackoverflow.com/users/1246135/brneuro"}, "edited": false, "score": 0, "creation_date": 1519216986, "post_id": 48897553, "comment_id": 84818081, "body": "Thanks for the answer. Regarding the casting the return from malloc, I am getting error: invalid conversion from \u2018void*\u2019 to \u2018char*\u2019 [-fpermissive] if I don&#39;t cast the return. I&#39;ll have to do some more reading in the thread you linked to fully understand why that is"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 316, "user_id": 1246135, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0606d884a169b21358f4e361297bc332?s=128&d=identicon&r=PG", "display_name": "brneuro", "link": "https://stackoverflow.com/users/1246135/brneuro"}, "edited": false, "score": 0, "creation_date": 1519217215, "post_id": 48897553, "comment_id": 84818233, "body": "@brneuro That probably means you&#39;re compiling as C++ instead of C."}, {"owner": {"reputation": 316, "user_id": 1246135, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0606d884a169b21358f4e361297bc332?s=128&d=identicon&r=PG", "display_name": "brneuro", "link": "https://stackoverflow.com/users/1246135/brneuro"}, "edited": false, "score": 0, "creation_date": 1519230325, "post_id": 48897553, "comment_id": 84827707, "body": "ah, indeed I am as I&#39;m working toward implementing some of this into a class."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1519182101, "creation_date": 1519182101, "answer_id": 48897553, "question_id": 48897471, "link": "https://stackoverflow.com/questions/48897471/making-valgrind-happy-vs-avoiding-segfault/48897553#48897553", "title": "making valgrind happy vs avoiding segfault", "body": "<p>You're not allocated enough memory:</p>\n\n<pre><code>myChar = (char**)malloc(sizeof(char*));\n</code></pre>\n\n<p>This allocates space for a single <code>char *</code>, but you treat this memory as if you allocated 5 (i.e. <code>nEl</code>) of them.</p>\n\n<p>As a result, you write past the end of allocated memory.  This is what Valgrind is alerting you of when it says \"Address 0x5204048 is 0 bytes after a block of size 8 alloc'd\".  Doing so invokes undefined behavior, which in this case manifests as a crash.</p>\n\n<p>If you want space for <code>nEl</code> pointers, allocate that amount of space:</p>\n\n<pre><code>myChar = malloc(sizeof(char*) * nEl);\n</code></pre>\n\n<p>Also, <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don't cast the return value of <code>malloc</code></a>.</p>\n"}], "owner": {"reputation": 316, "user_id": 1246135, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0606d884a169b21358f4e361297bc332?s=128&d=identicon&r=PG", "display_name": "brneuro", "link": "https://stackoverflow.com/users/1246135/brneuro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 48897553, "answer_count": 1, "score": 2, "last_activity_date": 1519182101, "creation_date": 1519181507, "question_id": 48897471, "link": "https://stackoverflow.com/questions/48897471/making-valgrind-happy-vs-avoiding-segfault", "title": "making valgrind happy vs avoiding segfault", "body": "<p>I'm new to C, trying to learn dynamic memory allocation for an array of char arrays, and not sure why I can't make valgrind happy with 0 errors also whilst avoiding a segfault. My example is based on this example: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/14786387/how-to-dynamically-allocate-memory-for-char-in-c\">How to dynamically allocate memory for char** in C</a></p>\n\n<p>From that example, I whipped up this test code below:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main (int argc, char* argv[]){\n        char **myChar;\n\n        int nEl = 5;\n        int nChars = 10;\n\n        myChar = (char**)malloc(sizeof(char*));\n        for (int it = 0; it &lt; nEl; it++) {\n                myChar[it] = (char*)malloc((nChars) * sizeof(char));\n        }\n\n        //for (int it = 0; it &lt; nEl; it++) {\n        //        free(myChar[it]);\n        //}\n        //free(myChar);\n\n        return 0;\n}\n</code></pre>\n\n<p>It compiles as is, runs without problem, exits with return 0x0, but valgrind complains:</p>\n\n<pre><code>4 errors in context 1 of 1:\nInvalid write of size 8\n   at 0x400583: main (in /home/username/Documents/personal/tmp/cprog2/test2)\n Address 0x5204048 is 0 bytes after a block of size 8 alloc'd\n   at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n   by 0x40054D: main (in /home/username/Documents/personal/tmp/cprog2/test2)\n\nERROR SUMMARY: 4 errors from 1 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Figuring that valgrind expects the malloc'd **myChar and myChar[it] to be free(), I uncomment the commented bits, but the program segfaults and valgrind says this:</p>\n\n<pre><code>4 errors in context 1 of 2:\nInvalid read of size 8\n   at 0x4005EF: main (in /home/username/Documents/personal/tmp/cprog2/test2)\n Address 0x5204048 is 0 bytes after a block of size 8 alloc'd\n   at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n   by 0x40058D: main (in /home/username/Documents/personal/tmp/cprog2/test2)\n\n\n4 errors in context 2 of 2:\nInvalid write of size 8\n   at 0x4005C3: main (in /home/username/Documents/personal/tmp/cprog2/test2)\n Address 0x5204048 is 0 bytes after a block of size 8 alloc'd\n   at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n   by 0x40058D: main (in /home/username/Documents/personal/tmp/cprog2/test2)\n\nERROR SUMMARY: 8 errors from 2 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Why can I not make valgrind happy and compile and run a working app?</p>\n"}, {"tags": ["c", "adc"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1519197194, "post_id": 48897323, "comment_id": 84805343, "body": "<a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a> I.e. please  add a comment to each of your lines, explaining (to yourself as well as other readers) what the line does. As a side effect, you might get help from readers which are good at C but do not know your device by heart."}], "answers": [{"tags": [], "owner": {"reputation": 727, "user_id": 2151810, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3c379fbde9efdc5a61f68aa0ac819d36?s=128&d=identicon&r=PG", "display_name": "andy", "link": "https://stackoverflow.com/users/2151810/andy"}, "is_accepted": true, "score": 0, "last_activity_date": 1521111890, "creation_date": 1521111890, "answer_id": 49297816, "question_id": 48897323, "link": "https://stackoverflow.com/questions/48897323/potentiometer-adc-practice-in-atmega128/49297816#49297816", "title": "potentiometer adc practice in atmega128", "body": "<p>First issue is your bit shifting, it should be <code>ADCSRA |= (1 &lt;&lt; ADSC)</code>. </p>\n\n<p>Next issue is results reading. You set fifth bit of ADMUX to 1, so ADLAR=1 and in that mode result is left adjusted so you should read ADCH. </p>\n\n<p>Moreover when you switch to 10-bit resolution, i.e. you start working with multi-byte results, be aware that reading only ADCL is not enough, see datasheet 23.3 for explanation: <em>\"Once ADCL is read, ADC access to data registers is blocked. This means that if ADCL has been read, and a conversion completes before ADCH is read, neither register is updated and the result from the conversion is lost. When ADCH is read, ADC access to the ADCH and ADCL Registers is re-enabled.\"</em></p>\n\n<p>Lastly, using hardcoded delays for reading is not good practice especially when you change code later to read ADC as fast as possible. In such case after conversion start you should check if ADIF flag is set or react with interrup when ADEN is set. Refer to datasheet for details.</p>\n"}], "owner": {"reputation": 23, "user_id": 8771962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c1e01bb0c08ed78aadb8bfbb851126?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Lee", "link": "https://stackoverflow.com/users/8771962/nicholas-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 49297816, "answer_count": 1, "score": 0, "last_activity_date": 1521111890, "creation_date": 1519180371, "last_edit_date": 1519182954, "question_id": 48897323, "link": "https://stackoverflow.com/questions/48897323/potentiometer-adc-practice-in-atmega128", "title": "potentiometer adc practice in atmega128", "body": "<p>I'm a beginner in this field. My goal is to change the output of 8 LEDs (which are connected to PORTA) according to the potentiometer. I have connected the middle line of the potentiometer to PF0, which is ADC0. I also connected the other two lines to the 5V and ground.</p>\n\n<p>I know there's no problem with the chip or connection because the LEDs are working just fine.</p>\n\n<p>But no matter how I change the code below (what I mean by changing is by slightly changing the ADMUX and ADCSRA registers) no output is shown!</p>\n\n<p>I am using atmega128 with 16MHZ clock. Below is the code that I'm trying to solve.</p>\n\n<pre><code>#include &lt;asf.h&gt;\n#include &lt;avr/io.h&gt;\n#define F_CPU 16000000L\n\nint init_board(void)\n{\n  DDRA=0xff;\n  PORTA=0x01;\n}\n\nint ADC_init(void)\n{\n  //ADCSRA\n  ADCSRA = 0b10000111;\n  //ADMUX\n  ADMUX = 0b01100000; // middle line connected to ADC0\n}\n\nint main (void)\n{   \n  init_board();\n  ADC_init();\n\n  ADCSRA |= (ADSC &gt;&gt; 1);\n  while(1)\n  {\n    if(ADSC == 0)\n    {\n      uint8_t disp_value = ADCL;\n      PORTA = disp_value; \n      delay_ms(200);\n      ADCSRA |= (ADSC &gt;&gt; 1);\n    }\n  }\n}\n</code></pre>\n\n<p>I have no idea why the code doesn't work.</p>\n\n<p>I suppose it's because it didn't set my register correctly, but I've followed all the instructions on the atmega128 datasheet.</p>\n"}, {"tags": ["c", "gcc", "makefile", "gnu-make"], "comments": [{"owner": {"reputation": 19253, "user_id": 657267, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1dcf516021abb964aecd6ae2386fd59d?s=128&d=identicon&r=PG", "display_name": "user657267", "link": "https://stackoverflow.com/users/657267/user657267"}, "edited": false, "score": 1, "creation_date": 1519193246, "post_id": 48897282, "comment_id": 84803631, "body": "<code>$(OBJDIR)&#47;%.$(OBJEXT): $(SRCDIR)&#47;%.$(SRCEXT)</code> expands to <code>bin&#47;obj&#47;list.o: src&#47;list.c</code>, not <code>bin&#47;obj&#47;list.o: src&#47;list&#47;list.c</code>, you can use <code>make -dR</code> to debug these kind of problems."}, {"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1519223731, "post_id": 48897282, "comment_id": 84822890, "body": "Do you want to assume that <code>foo.c</code> will always be in <code>src&#47;foo&#47;</code>, or that no two source files will have the same name?"}], "answers": [{"comments": [{"owner": {"reputation": 19253, "user_id": 657267, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1dcf516021abb964aecd6ae2386fd59d?s=128&d=identicon&r=PG", "display_name": "user657267", "link": "https://stackoverflow.com/users/657267/user657267"}, "edited": false, "score": 0, "creation_date": 1519193325, "post_id": 48898994, "comment_id": 84803662, "body": "This won&#39;t fix OPs issue."}, {"owner": {"reputation": 19253, "user_id": 657267, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1dcf516021abb964aecd6ae2386fd59d?s=128&d=identicon&r=PG", "display_name": "user657267", "link": "https://stackoverflow.com/users/657267/user657267"}, "edited": false, "score": 0, "creation_date": 1519194310, "post_id": 48898994, "comment_id": 84804039, "body": "Sorry should have been clearer, you have a valid point but it won&#39;t fix the rule not matching, I commented in the question."}], "tags": [], "owner": {"reputation": 1463, "user_id": 2299087, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KWtlB.jpg?s=128&g=1", "display_name": "James McPherson", "link": "https://stackoverflow.com/users/2299087/james-mcpherson"}, "is_accepted": true, "score": 0, "last_activity_date": 1519192477, "creation_date": 1519192477, "answer_id": 48898994, "question_id": 48897282, "link": "https://stackoverflow.com/questions/48897282/no-rule-to-make-target-bin-obj-list-o/48898994#48898994", "title": "No rule to make target &#39;bin/obj/list.o&#39;", "body": "<p><a href=\"https://www.gnu.org/software/make/manual/make.html#index-explicit-rules_002c-secondary-expansion-of\" rel=\"nofollow noreferrer\">https://www.gnu.org/software/make/manual/make.html#index-explicit-rules_002c-secondary-expansion-of</a> implies that <code>$^</code> is going to expand to <em>every</em> file found via $(SRCDIR)/%.$(SRCEXT).</p>\n\n<p>I suggest re-writing your rule to make the pattern matching somewhat more explicit:</p>\n\n<pre><code>$(OBJDIR)/%.o: $(SRCDIR)/%.c\n        @echo \"Compiling...\"\n        $(CC) $(CFLAGS) -c -o $@ $&lt;\n</code></pre>\n\n<p>so that you have a one-to-one relationship between the .c and .o files.</p>\n"}], "owner": {"reputation": 191, "user_id": 4926174, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b6872d512b379face640047f39845f63?s=128&d=identicon&r=PG&f=1", "display_name": "ms5991", "link": "https://stackoverflow.com/users/4926174/ms5991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 48898994, "answer_count": 1, "score": 0, "last_activity_date": 1519192477, "creation_date": 1519180112, "question_id": 48897282, "link": "https://stackoverflow.com/questions/48897282/no-rule-to-make-target-bin-obj-list-o", "title": "No rule to make target &#39;bin/obj/list.o&#39;", "body": "<p>I am trying to create a makefile that will be able to work for the specific file structure I'd like to have in my C project.  See the makefile below to look at the structure description.</p>\n\n<p>If I run <code>make bin/obj/list.o</code>, I get the output as indicated in the title, which is <code>make: *** No rule to make target 'bin/obj/list.o'. Stop.</code>.  </p>\n\n<p>Here is my makefile:</p>\n\n<pre><code># compiler\nCC                  := gcc\n\n# name of target file\nTARGET              := main_bin\nTEST_TARGET         := test_bin\n\n# directories and file info\nINCDIR              := inc\nSRCDIR              := src\nTARGETDIR           := bin\nOBJDIR              := $(TARGETDIR)/obj\nTESTDIR             := tests\nSRCEXT              := c\nOBJEXT              := o\n\n# flags and libraries\nCFLAGS              := -Wall -O3 -I $(INCDIR)\nCFLAGS_TEST         := -Wall -O3 -I $(INCDIR) -I $(TESTDIR)/$(INCDIR)\nLIB                 := -lm\n\n# Want a project structure like:\n#\n# root\n#   ---- README\n#   ---- LICENSE\n#   ---- MAKEFILE\n#   ---- .gitignore\n#   ---- src\n#           ---- main.c\n#           ---- dir1\n#               ---- source1.c\n#           ---- ...\n#           ---- dirN\n#               ---- sourceN.c\n#   ---- tests\n#           ---- test_main.c\n#           ---- inc\n#               ---- test1.h\n#               ---- ...\n#               ---- testN.h\n#           ---- tests1\n#               ---- test1.c\n#           ---- ...\n#           ---- testsN\n#               ---- testN.c\n#           ---- bin\n#               ---- test_executable\n#               ---- obj\n#                   ---- test_obj1.o\n#                   ---- ...\n#                   ---- test_objN.o\n#   ---- inc\n#           ---- header1.h\n#           ---- ...\n#           ---- headerN.h\n#   ---- bin\n#           ---- executable\n#           ---- obj\n#               ---- obj1.o\n#               ---- ...\n#               ---- objN.o\n#\n\n# find all src files that aren't in the root of the src directory\nSOURCES             := $(shell find $(SRCDIR) -mindepth 2 -type f -name '*.$(SRCEXT)')\n\n# find all src files that aren't in the root of the tests directory\nTEST_SOURCES        := $(shell find $(TESTDIR)/$(SRCDIR) -mindepth 2 -type f -name '*.$(SRCEXT)')\n\n# find the src file that is in the root of the src directory -- will contain main\nMAIN_SOURCE         := $(shell find $(SRCDIR) -maxdepth 1 -type f -name '*.$(SRCEXT)')\n\n# find the src file that is in the root of the tests directory -- will contain main for tests\nTEST_MAIN_SOURCE    := $(shell find $(TESTDIR)/$(SRCDIR) -maxdepth 1 -type f -name '*.$(SRCEXT)')\n\n# name the object files\nOBJECTS             := $(addprefix $(OBJDIR)/,$(notdir $(SOURCES:.$(SRCEXT)=.$(OBJEXT))))\nTEST_OBJECTS        := $(addprefix $(TESTDIR)/$(OBJDIR)/,$(notdir $(TEST_SOURCES:.$(SRCEXT)=.$(OBJEXT))))\n\n# compile target\nall: dirs $(TARGET)\n\n# default to all\ndefault: all\n\n# create obj and bin directories if they don't exist\ndirs:\n    mkdir -p $(TARGETDIR) \n    mkdir -p $(OBJDIR)\n    mkdir -p $(TESTDIR)/$(TARGETDIR) \n    mkdir -p $(TESTDIR)/$(OBJDIR)\n\n# the main program relies on the file containing main under src and the objects\n# link the object files into the executable\n$(TARGET): $(OBJECTS) $(MAIN_SOURCE)\n    @echo \"Linking...\"\n    $(CC) -o $(TARGETDIR)/$@ $^ $(LIB)\n\n# compile source files under the subdirectories of src into .o object files\n$(OBJDIR)/%.$(OBJEXT): $(SRCDIR)/%.$(SRCEXT)\n    @echo \"Compiling...\"\n    $(CC) $(CFLAGS) -c -o $@ $^\n\n# the test program relies on the file containing main under tests/src and the objects\n# link the object files into the executable\n$(TEST_TARGET): $(OBJECTS) $(TEST_OBJECTS) $(TEST_MAIN_SOURCE)\n    @echo \"Linking tests...\"\n    $(CC) -o $(TARGETDIR)/$@ $^ $(LIB)\n\n# compile test source files under the subdirectories of tests/src into .o object files\n$(TESTDIR)/$(OBJDIR)/%.$(OBJEXT): $(TESTDIR)/$(SRCDIR)/%.$(SRCEXT)\n    @echo \"Compiling tests...\"\n    $(CC) $(CFLAGS_TEST) -c -o $@ $^\n\n# build the tests\ntest: dirs $(TEST_TARGET)\n    $(TARGETDIR)/$(TEST_TARGET)\n\n# useful to debug makefile, see what variables eval to \nvars:\n    @echo \"CFLAGS:          $(CFLAGS)\"\n    @echo \"CFLAGS_TEST:     $(CFLAGS_TEST)\"\n    @echo \"OBJDIR:          $(OBJDIR)\"\n    @echo \"TESTDIR:     $(TESTDIR)\"\n    @echo \"SOURCES:     $(SOURCES)\"\n    @echo \"MAIN_SOURCE:     $(MAIN_SOURCE)\"\n    @echo \"OBJECTS:     $(OBJECTS)\"\n    @echo \"TEST_SOURCES:        $(TEST_SOURCES)\"\n    @echo \"TEST_MAIN_SOURCE:    $(TEST_MAIN_SOURCE)\"\n    @echo \"TEST_OBJECTS:        $(TEST_OBJECTS)\"\n\n# remove obj and bin\nclean:\n    @echo \"Cleaning...\"\n    rm -rf $(OBJDIR)\n    rm -rf $(TARGETDIR)\n    rm -rf $(TESTDIR)/$(TARGETDIR) \n    rm -rf $(TESTDIR)/$(OBJDIR)\n\n.PHONY: clean\n</code></pre>\n\n<p>Specifically, I think this line:</p>\n\n<pre><code># compile source files under the subdirectories of src into .o object files\n$(OBJDIR)/%.$(OBJEXT): $(SRCDIR)/%.$(SRCEXT)\n    @echo \"Compiling...\"\n    $(CC) $(CFLAGS) -c -o $@ $^\n</code></pre>\n\n<p>Should be the rule to make <code>bin/obj/list.o</code>.  I know that all my files exist, including <code>src/list/list.c</code> and <code>inc/list.h</code>.</p>\n\n<p>Does anyone know why this rule does not satisfy <code>bin/obj/list.o</code>?</p>\n"}, {"tags": ["c", "list", "linked-list"], "comments": [{"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "edited": false, "score": 1, "creation_date": 1519175429, "post_id": 48896707, "comment_id": 84799125, "body": "can you show us what you have tried so far?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519175507, "post_id": 48896707, "comment_id": 84799147, "body": "There are so many implementation of linked list, how should we know which one you are using? Please post code, better please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "edited": false, "score": 0, "creation_date": 1519175784, "post_id": 48896707, "comment_id": 84799208, "body": "This is a basic problem to do with parsing. Maybe googling some examples of parsing?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1519177479, "post_id": 48896707, "comment_id": 84799580, "body": "Welcome to Stack Overflow. Please note that the preferred way of saying &#39;thanks&#39; around here is by up-voting good questions and helpful answers (once you have enough reputation to do so), and by accepting the most helpful answer to any question you ask (which also gives you a small boost to your reputation). Please see the <a href=\"https://stackoverflow.com/tour\">About</a> page and also <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask questions here?</a> and <a href=\"http://stackoverflow.com/help/someone-answers\">What do I do when someone answers my question?</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1519177745, "post_id": 48896707, "comment_id": 84799652, "body": "Could there ever be more than 2 numbers on a line?  If there could be an arbitrary number of them, then you&#39;d need to use <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fgets.html\" rel=\"nofollow noreferrer\"><code>fgets()</code></a> or perhaps POSIX <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html\" rel=\"nofollow noreferrer\"><code>getline()</code></a> to read lines, and then follow the guidelines in <a href=\"https://stackoverflow.com/questions/3975236/how-to-use-sscanf-in-loops\">Using <code>sscanf()</code> in loops</a> to read the numbers from the string."}], "answers": [{"tags": [], "owner": {"reputation": 2783, "user_id": 782570, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cbbf87d7ce9ed596faa7e64231114991?s=128&d=identicon&r=PG&f=1", "display_name": "giusti", "link": "https://stackoverflow.com/users/782570/giusti"}, "is_accepted": true, "score": 1, "last_activity_date": 1519222559, "last_edit_date": 1519222559, "creation_date": 1519175888, "answer_id": 48896783, "question_id": 48896707, "link": "https://stackoverflow.com/questions/48896707/inserting-a-value-into-the-middle-of-a-linked-list-in-c/48896783#48896783", "title": "Inserting a value into the middle of a linked list in c", "body": "<p>Continue using <code>\"%s\"</code> or <code>\" %c\"</code> to read the command. Notice that there is a space before the <code>%c</code>: this is to consume the linebreak before reading the caracter (try it without the space and see what happens).</p>\n\n<p>When you read an <code>f</code> or a <code>d</code>, issue another <code>scanf(\"%d\", ...)</code> to get the number.</p>\n\n<p>For the <code>i</code>, you can simply issue a <code>scanf(\"%d%d\", ...)</code> and then check its return value. If it is <code>1</code>, then only one number was read. If it is <code>2</code>, then there were two integers.</p>\n\n<p>Do not forget to check for <code>EOF</code> when trying to read the next command.</p>\n"}], "owner": {"reputation": 135, "user_id": 9278761, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d986832959069c6aac01a9f3e3adb7b2?s=128&d=identicon&r=PG&f=1", "display_name": "ancd3ea4", "link": "https://stackoverflow.com/users/9278761/ancd3ea4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "accepted_answer_id": 48896783, "answer_count": 1, "score": -1, "last_activity_date": 1519222559, "creation_date": 1519175323, "last_edit_date": 1519175947, "question_id": 48896707, "link": "https://stackoverflow.com/questions/48896707/inserting-a-value-into-the-middle-of-a-linked-list-in-c", "title": "Inserting a value into the middle of a linked list in c", "body": "<p><img src=\"https://i.stack.imgur.com/Dk6CZ.png\" alt=\"Picture of Text\"></p>\n\n<p>In this image, I have to write a program that every time it reads in the letter <code>i</code>, it will insert the value after into the linked list. If it reaches a line where there are two numbers ex: <code>i 23 42</code>, it will input <code>42</code> after the <code>23</code> into the linked list. </p>\n\n<p>So if I print the linked list up to line 3 of the txt file, it should print <code>23, 78, 900</code>. When it reaches line four, it should print <code>23, 42, 78, 900</code>. </p>\n\n<p>I'm not sure how to have the program recognize that there are two values in the line instead of one to be able to input the second after the first value into the linked list.</p>\n\n<p>EDIT**</p>\n\n<pre><code>struct node * addToList(struct node *base, int data)\n{\n  struct node *newNode = NULL;\n\n  if (base == NULL)\n    {\n      base = malloc( sizeof(struct node));\n      // malloc defend\n      base-&gt;data = data;\n      base-&gt;next = NULL;\n      return base;\n    }\n\n  while (base-&gt;next != NULL)\n    {\n      base = base-&gt;next;\n    }\n  //Now at the end of the list\n  newNode = malloc( sizeof(struct node)); \n  //Defend against bad malloc\n  base-&gt;next = newNode; \n  newNode-&gt;data = data; \n  newNode-&gt;next = NULL;\n  return base;\n</code></pre>\n\n<p>'this next part is in main'</p>\n\n<pre><code>    while (fscanf(ifp, \"%s\", inBuf) != EOF)\n        {\n          fprintf(stdout, \"%s\\n\", inBuf);\n          data = atoi(inBuf);\n\n\n          if (NULL == root) \n        {\n          root = addToList(root, data);\n        }\n          else\n        { \n          temp = addToList(root, data);\n          if (NULL == temp)\n            {\n              printf(\"Failed to add - good bye\\n\");\n              return -1;\n            }\n        }\n</code></pre>\n\n<p>I'm attempting to create a new function to handle the insert</p>\n"}, {"tags": ["c", "optimization", "microcontroller", "volatile"], "comments": [{"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1519174619, "post_id": 48896609, "comment_id": 84798931, "body": "Can you examine the assembly or compiled code?"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1519174675, "post_id": 48896609, "comment_id": 84798943, "body": "I think we&#39;re going to need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. (You can&#39;t hand us all microcontrollers, but you should at least be able to hand us something that compiles, runs, and produces the effect you&#39;re asking about when you run it on your microcontroller.)"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 4, "creation_date": 1519176090, "post_id": 48896609, "comment_id": 84799269, "body": "Could it be that because you have no delays in the <code>while(1)</code> loop, you don&#39;t see the effect on the lcd because <code>blinker</code> toggles to fast?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1519176660, "post_id": 48896609, "comment_id": 84799386, "body": "What does your platform&#39;s documentation say about <code>volatile</code> and interrupt code? If it doesn&#39;t say it should work, then it&#39;s not required to."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 1, "creation_date": 1519176755, "post_id": 48896609, "comment_id": 84799406, "body": "please show the disassembly."}, {"owner": {"reputation": 1465, "user_id": 392485, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d7f8e7c51e4967fe2e8b8fb3dd0e3f8c?s=128&d=identicon&r=PG", "display_name": "Hugoagogo", "link": "https://stackoverflow.com/users/392485/hugoagogo"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1519177555, "post_id": 48896609, "comment_id": 84799603, "body": "@DavidSchwartz see <a href=\"http://www.ti.com/lit/ug/spnu151m/spnu151m.pdf\" rel=\"nofollow noreferrer\">ti.com/lit/ug/spnu151m/spnu151m.pdf</a> page 94."}, {"owner": {"reputation": 1465, "user_id": 392485, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d7f8e7c51e4967fe2e8b8fb3dd0e3f8c?s=128&d=identicon&r=PG", "display_name": "Hugoagogo", "link": "https://stackoverflow.com/users/392485/hugoagogo"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519177596, "post_id": 48896609, "comment_id": 84799610, "body": "@Pablo I am not sure how as the main loop is not toggling the value, the 250ms interrupt timer is."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519178024, "post_id": 48896609, "comment_id": 84799715, "body": "Could it be that the lcd is not fast enough to change every 250ms?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519178697, "post_id": 48896609, "comment_id": 84799875, "body": "It&#39;s been many years since I wrote arm assembler, I&#39;m very rusty. I checked both main functions (the &quot;works&quot; link and &quot;does not work&quot; link) and where <code>digit_blink</code> gets evaluated, the code is the same, the code of the interrupt handler is however different."}, {"owner": {"reputation": 1465, "user_id": 392485, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d7f8e7c51e4967fe2e8b8fb3dd0e3f8c?s=128&d=identicon&r=PG", "display_name": "Hugoagogo", "link": "https://stackoverflow.com/users/392485/hugoagogo"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1519180212, "post_id": 48896609, "comment_id": 84800185, "body": "@EricPostpischil, In my minimum code example I am toggling an LED and the same behavior occurs."}, {"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1519180290, "post_id": 48896609, "comment_id": 84800202, "body": "I&#39;d rather see a disassembly of optimized vs not optimized."}, {"owner": {"reputation": 1465, "user_id": 392485, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d7f8e7c51e4967fe2e8b8fb3dd0e3f8c?s=128&d=identicon&r=PG", "display_name": "Hugoagogo", "link": "https://stackoverflow.com/users/392485/hugoagogo"}, "reply_to_user": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1519180589, "post_id": 48896609, "comment_id": 84800267, "body": "@user58697 I have added an additional gist to the question."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519181762, "post_id": 48896609, "comment_id": 84800573, "body": "1) idea: For debugging purposes, replace <code>bool blinker</code> and instead, increment in the ISR and compare to a level like <code>if (blinker&amp;7 &gt;= 4)</code>.  Easier to see what might be happening 2) Are <code>set_lcd_to_thing_1()</code> or <code>set_lcd_to_thing_2()</code> synchronized to the timer in any way?  3)  If <code>volatile</code> defined out like <code>#define volatile</code> someplace?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1519183969, "post_id": 48896609, "comment_id": 84801035, "body": "in Standard C, your program has undefined behaviour because the ISR might write the bool simultaneously with it being read by the main thread. To have the code work properly, in Standard C, you need to declare the <code>bool</code> as <code>_Atomic</code> also, or disable interrupts while you are reading the <code>bool</code> in the main thread.  I don&#39;t know what behaviour your particular platform implements or expects in this regard."}], "answers": [{"comments": [{"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1519185812, "post_id": 48897848, "comment_id": 84801432, "body": "Note when you get around to examining the disassembly you will see that the volatile worked for both cases (first two cases, didnt bother with the third).  Your problem is elsewhere.  I think you need to completely re-write your question as so far it doesnt appear to be related to the volatile variable."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1519185931, "post_id": 48897848, "comment_id": 84801460, "body": "What does your scope show with respect to the gpio pin driving(/sinking) the led?  The function may just be adding enough time to allow you to visually see the led blink and that is all.  Do you have two leds?  Can you alternate them one on the other off, and vice versa?  Do they both appear to be on when &quot;not working&quot;?"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1519186284, "post_id": 48897848, "comment_id": 84801553, "body": "what happens when you change your interrupt rate to 1 second?  2 seconds?  etc?"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1519186732, "post_id": 48897848, "comment_id": 84801650, "body": "what if you dont run it so fast?  out of curiosity did you set the flash wait states to compensate for that flash speed?"}, {"owner": {"reputation": 1465, "user_id": 392485, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d7f8e7c51e4967fe2e8b8fb3dd0e3f8c?s=128&d=identicon&r=PG", "display_name": "Hugoagogo", "link": "https://stackoverflow.com/users/392485/hugoagogo"}, "edited": false, "score": 0, "creation_date": 1519196085, "post_id": 48897848, "comment_id": 84804816, "body": "I edited the question a bit, but I also seem to have solved the problem but I dont understand why. If I swap the line clearing the timer interrupt flag and the line that toggles the value, everything seems to work as expected."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 1465, "user_id": 392485, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d7f8e7c51e4967fe2e8b8fb3dd0e3f8c?s=128&d=identicon&r=PG", "display_name": "Hugoagogo", "link": "https://stackoverflow.com/users/392485/hugoagogo"}, "edited": false, "score": 0, "creation_date": 1519217523, "post_id": 48897848, "comment_id": 84818463, "body": "again it sounds like a race condition, the volatile did its job, that wasnt the problem."}, {"owner": {"reputation": 1465, "user_id": 392485, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d7f8e7c51e4967fe2e8b8fb3dd0e3f8c?s=128&d=identicon&r=PG", "display_name": "Hugoagogo", "link": "https://stackoverflow.com/users/392485/hugoagogo"}, "edited": false, "score": 1, "creation_date": 1519217821, "post_id": 48897848, "comment_id": 84818666, "body": "I think I found a clue here <a href=\"https://e2e.ti.com/support/microcontrollers/tiva_arm/f/908/t/306546\" rel=\"nofollow noreferrer\">e2e.ti.com/support/microcontrollers/tiva_arm/f/908/t/306546</a> and will add more detail on the problem and solution tomorrow, would you have any recommendations on what I should do to this question/answer to make sure it is useful to people in the future?"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 1465, "user_id": 392485, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d7f8e7c51e4967fe2e8b8fb3dd0e3f8c?s=128&d=identicon&r=PG", "display_name": "Hugoagogo", "link": "https://stackoverflow.com/users/392485/hugoagogo"}, "edited": false, "score": 0, "creation_date": 1519220343, "post_id": 48897848, "comment_id": 84820500, "body": "looks like it is already documented there, links are not useful to stackoverflow, as part of the question or of the answer.  you should confirm this was your issue as well.  and post an answer to your own question, will see if this question survives...should also isolate the assembly language from your links that are relevant to the volatile which they show was not the issue."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 1465, "user_id": 392485, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d7f8e7c51e4967fe2e8b8fb3dd0e3f8c?s=128&d=identicon&r=PG", "display_name": "Hugoagogo", "link": "https://stackoverflow.com/users/392485/hugoagogo"}, "edited": false, "score": 0, "creation_date": 1519220382, "post_id": 48897848, "comment_id": 84820522, "body": "My answer was not intended to survive, but dont think this question is really in a form to survive either. will see..."}], "tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 0, "last_activity_date": 1519184765, "creation_date": 1519184765, "answer_id": 48897848, "question_id": 48896609, "link": "https://stackoverflow.com/questions/48896609/changes-to-volatile-variable-only-occur-when-stepping-through-code-or-optimisati/48897848#48897848", "title": "Changes to volatile variable only occur when stepping through code or optimisation turned off", "body": "<p>You need to isolate the disassembly to just the relevant parts, and post them in this question do not use a link.</p>\n\n<p>Try something like this.</p>\n\n<pre><code>void set_lcd_to_thing_1( void );\nvoid set_lcd_to_thing_2( void );\nvolatile unsigned int blinker=0;\nvoid main()\n{\n    while (1)\n    {\n        if(blinker)\n        {\n            set_lcd_to_thing_1();\n        } else\n        {\n            set_lcd_to_thing_2();\n        }\n    }\n}\nvoid timer_interrupt()\n{\n    blinker = !blinker;\n}\n</code></pre>\n\n<p>gcc -O2 optimization.</p>\n\n<pre><code>00000000 &lt;timer_interrupt&gt;:\n   0:   e59f2010    ldr r2, [pc, #16]   ; 18 &lt;timer_interrupt+0x18&gt;\n   4:   e5923000    ldr r3, [r2]\n   8:   e2733001    rsbs    r3, r3, #1\n   c:   33a03000    movcc   r3, #0\n  10:   e5823000    str r3, [r2]\n  14:   e12fff1e    bx  lr\n  18:   00000000    \n\n00000000 &lt;main&gt;:\n   0:   e92d4010    push    {r4, lr}\n   4:   e59f4020    ldr r4, [pc, #32]   ; 2c &lt;main+0x2c&gt;\n   8:   e5943000    ldr r3, [r4]\n   c:   e3530000    cmp r3, #0\n  10:   0a000003    beq 24 &lt;main+0x24&gt;\n  14:   ebfffffe    bl  0 &lt;set_lcd_to_thing_1&gt;\n  18:   e5943000    ldr r3, [r4]\n  1c:   e3530000    cmp r3, #0\n  20:   1afffffb    bne 14 &lt;main+0x14&gt;\n  24:   ebfffffe    bl  0 &lt;set_lcd_to_thing_2&gt;\n  28:   eafffff6    b   8 &lt;main+0x8&gt;\n  2c:   00000000    \n</code></pre>\n\n<p>This is the object not the whole binary the zeros at the end of the function get filled in by the linker with the address to blinker.</p>\n\n<p>In this case it is clear that the volatile is working.</p>\n\n<p>For amusement save an instruction (and make it more readable) and remove the need for zeroing .bss.</p>\n\n<pre><code>void set_lcd_to_thing_1( void );\nvoid set_lcd_to_thing_2( void );\nvolatile unsigned int blinker;\nvoid main()\n{\n    blinker=0;\n    while (1)\n    {\n        if(blinker)\n        {\n            set_lcd_to_thing_1();\n        } else\n        {\n            set_lcd_to_thing_2();\n        }\n    }\n}\nvoid timer_interrupt()\n{\n    blinker = ~blinker;\n}\n</code></pre>\n\n<p>Optimized gives</p>\n\n<pre><code>00000000 &lt;timer_interrupt&gt;:\n   0:   e59f200c    ldr r2, [pc, #12]   ; 14 &lt;timer_interrupt+0x14&gt;\n   4:   e5923000    ldr r3, [r2]\n   8:   e1e03003    mvn r3, r3\n   c:   e5823000    str r3, [r2]\n  10:   e12fff1e    bx  lr\n  14:   00000000    \n\n00000000 &lt;main&gt;:\n   0:   e3a03000    mov r3, #0\n   4:   e92d4010    push    {r4, lr}\n   8:   e59f4024    ldr r4, [pc, #36]   ; 34 &lt;main+0x34&gt;\n   c:   e5843000    str r3, [r4]\n  10:   e5943000    ldr r3, [r4]\n  14:   e3530000    cmp r3, #0\n  18:   0a000003    beq 2c &lt;main+0x2c&gt;\n  1c:   ebfffffe    bl  0 &lt;set_lcd_to_thing_1&gt;\n  20:   e5943000    ldr r3, [r4]\n  24:   e3530000    cmp r3, #0\n  28:   1afffffb    bne 1c &lt;main+0x1c&gt;\n  2c:   ebfffffe    bl  0 &lt;set_lcd_to_thing_2&gt;\n  30:   eafffff6    b   10 &lt;main+0x10&gt;\n  34:   00000000    \n</code></pre>\n\n<p>If you simplify a version of your project, say one that doesnt necessarily function, but builds and the disassembly is contained.  Do you see the same kind of thing going on (dont expect two different compilers to produce the same code).</p>\n"}], "owner": {"reputation": 1465, "user_id": 392485, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d7f8e7c51e4967fe2e8b8fb3dd0e3f8c?s=128&d=identicon&r=PG", "display_name": "Hugoagogo", "link": "https://stackoverflow.com/users/392485/hugoagogo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1519196035, "creation_date": 1519174464, "last_edit_date": 1519196035, "question_id": 48896609, "link": "https://stackoverflow.com/questions/48896609/changes-to-volatile-variable-only-occur-when-stepping-through-code-or-optimisati", "title": "Changes to volatile variable only occur when stepping through code or optimisation turned off", "body": "<p>I am programing a TI TM4C microcontroller and stuck with some unusual behavior where the controller is not working as I expect it.</p>\n\n<p>I expect the volatile keyword to work such that any reads or writes carried out in either interrupts or the main loop, are read and written into ram preventing optimisation in local registers.</p>\n\n<p>In my code is set up roughly as follows.</p>\n\n<pre><code>volatile bool blinker=false;\n\nvoid main()\n    {\n    setupTimers();\n\n    while (1){\n        if (blinker){\n            set_lcd_to_thing_1();\n        } else {\n            set_lcd_to_thing_2();\n        }\n    }\n}\n\nvoid timer_interrupt(){ // Is run every 250ms\n    blinker = !blinker;\n    clear_interrupt_flag();\n}\n</code></pre>\n\n<p>This is what I would have thought of as a textbook example of where volatile should be used, as it needs to be ensured that the if statement does not get optimised away.</p>\n\n<p>However this code, works with optimisation turned off (which as I understand it means everything is treated as volatile), when optimisation is turned on however the blinking does not occur, curiously if I place a breakpoint in the interrupt I can see that the value is getting toggled, If I place the interrupt in the main loop it does not get toggled and is always false.</p>\n\n<p>Even more confusingly If I change my interrupt to the below, everything works as expected, even with optimisation.</p>\n\n<pre><code>void timer_interrupt(){ // Is run every 250ms\n    blinker = !blinker;\n    some_function_call();\n    clear_interrupt_flag();\n}\n</code></pre>\n\n<p>Digging further into this issue I have noticed that when debugging, if I step through the code line by line, the issue still occurs, however when I step through the code, line by line of assembly the led toggles correctly.</p>\n\n<hr>\n\n<p><strong>EDIT</strong></p>\n\n<p>As requested here is a cut down version. It requires tivaware, and should run on the EK-TM4C1294XL development board. I am using CCS version 7 to compile and flash the board.</p>\n\n<pre><code>/*################################################\n\nMinimum example, where volatile does not take effect\n\n#################################################*/\n\n#include &lt;stdint.h&gt;\n#include &lt;stdbool.h&gt;\n#include \"inc/hw_gpio.h\"\n#include \"inc/hw_types.h\"\n#include \"inc/hw_memmap.h\"\n#include \"inc/tm4c1294ncpdt.h\"\n#include \"driverlib/sysctl.h\"\n#include \"driverlib/pin_map.h\"\n#include \"driverlib/rom.h\"\n#include \"driverlib/rom_map.h\"\n#include \"driverlib/gpio.h\"\n#include \"driverlib/timer.h\"\n#include \"driverlib/interrupt.h\"\n#include \"drivers/pinout.h\"\n\n#define SYSCLOCK 120000000L\n\n// PORT L IO\n#define LED_2 GPIO_PIN_1\n\n// ****** Variables ******\nvolatile bool digit_blink = false;\nvolatile int fo = 0;\n\nvoid dummyfunc(void){\n    fo += 1;\n}\n\nvoid InitTimers(void){\n    SysCtlPeripheralEnable(SYSCTL_PERIPH_TIMER2);\n\n    // *** Timer2 Used to blink the display\n    TimerConfigure(TIMER2_BASE,TIMER_CFG_PERIODIC);\n    TimerLoadSet(TIMER2_BASE,TIMER_A,SYSCLOCK/4);//Period of 0.25 Seconds\n}\n\nvoid InitIO(void){\n    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOL); // Front Panel LEDs\n\n    // LED Setup\n    GPIOPinTypeGPIOOutput(GPIO_PORTL_BASE, LED_2);\n    GPIOPadConfigSet(GPIO_PORTL_BASE, LED_2,GPIO_STRENGTH_2MA, GPIO_PIN_TYPE_STD); //Set Output\n    GPIOPinWrite(GPIO_PORTL_BASE, LED_2 ,0);\n}\n\nint main(void)\n{\n    //\n    // Run from the PLL at 120 MHz.\n    //\n    MAP_SysCtlClockFreqSet((SYSCTL_XTAL_25MHZ |\n                           SYSCTL_OSC_MAIN |\n                           SYSCTL_USE_PLL |\n                           SYSCTL_CFG_VCO_480), SYSCLOCK);\n\n    PinoutSet(false,false); // Library function that sets up UART and USB IO.\n\n    InitTimers();\n    InitIO();\n\n    // Interrupts\n    IntEnable(INT_TIMER2A);\n    TimerIntEnable(TIMER2_BASE,TIMER_TIMA_TIMEOUT);\n\n    IntMasterEnable();\n    TimerEnable(TIMER2_BASE,TIMER_A);\n\n    while (1){\n        if (digit_blink)\n            GPIOPinWrite(GPIO_PORTL_BASE, LED_2,LED_2); // Write to LCD would be here\n        else\n            GPIOPinWrite(GPIO_PORTL_BASE, LED_2,0x0); // Write to LCD would be here\n    }\n}\n\n// Interrupts\nvoid Timer2IntHandler(void){ // Blinks a display segment\n    digit_blink = !digit_blink;\n    dummyfunc(); // If this line is commented the led will not blink.\n    TimerIntClear(TIMER2_BASE, TIMER_TIMA_TIMEOUT);\n}\n</code></pre>\n\n<hr>\n\n<p><strong>Edit 2</strong></p>\n\n<p>Disassembly without function commented optimised level 1 (works)\n<a href=\"https://gist.github.com/anonymous/40c58709cdac7dc76f0840e0cc9a5dbd\" rel=\"nofollow noreferrer\">https://gist.github.com/anonymous/40c58709cdac7dc76f0840e0cc9a5dbd</a></p>\n\n<p>Disassembly with function commented optimised level 1 (doesn't work)\n<a href=\"https://gist.github.com/anonymous/9c874e5810cd0241360f87161428cf0d\" rel=\"nofollow noreferrer\">https://gist.github.com/anonymous/9c874e5810cd0241360f87161428cf0d</a></p>\n\n<p>Disassembly with function commented not optimised (works)\n<a href=\"https://gist.github.com/anonymous/e0bf41ed4beb923c09651b09551809db\" rel=\"nofollow noreferrer\">https://gist.github.com/anonymous/e0bf41ed4beb923c09651b09551809db</a></p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 4, "creation_date": 1519170802, "post_id": 48896082, "comment_id": 84797930, "body": "You shouldn&#39;t store binary data as a string, because of problems like \\0 is the terminating string. Store the bytes in <code>uint8_t</code> arrays or <code>unsigned char</code> arrays, but do not treat them as strings. Also when you read a binary file, many bytes are just not printable and if you print  them, you will get &quot;garbage&quot; on the screen. It&#39;s better to print the hex representation of the bytes."}, {"owner": {"reputation": 2680, "user_id": 1404447, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a09616794142013529fb3b7881c41eca?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/1404447/tom"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519170877, "post_id": 48896082, "comment_id": 84797951, "body": "@Pablo Okay, but I can&#39;t print to stdout an array of uint8_t using puts or printf"}, {"owner": {"reputation": 884, "user_id": 9009404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be791318ce35f7966345ff4964a2025?s=128&d=identicon&r=PG&f=1", "display_name": "Uprooted", "link": "https://stackoverflow.com/users/9009404/uprooted"}, "edited": false, "score": 1, "creation_date": 1519170939, "post_id": 48896082, "comment_id": 84797971, "body": "no you can: <code>printf(&quot;%.*s&quot;, str_len, str_ptr);</code>"}, {"owner": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 2, "creation_date": 1519170953, "post_id": 48896082, "comment_id": 84797978, "body": "If you insist on printing gobbledygook to your terminal, (1) it&#39;s not actually a string, but (2) you can use <code>fwrite</code> to write arbitrary data to stdout as long as you remember how much data you have (because, again, it&#39;s not a string...there&#39;s no <code>arbitrarydatalen</code> function, and there can&#39;t be)."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1519170966, "post_id": 48896082, "comment_id": 84797982, "body": "When dealing with binary stream, it&#39;s better to print them in hex format, and you can use <code>printf</code> for that: <code>printf(&quot;%02x\\n&quot;, val);</code>"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 3, "creation_date": 1519171051, "post_id": 48896082, "comment_id": 84798000, "body": "&quot;How to use strings in C?&quot;  .. This is not how you use strings in C. Strings are character arrays of printable characters terminated with <code>NUL</code>, binary data does not have to fit that format at all."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1519171432, "post_id": 48896082, "comment_id": 84798091, "body": "@yano actually by definition, a string is a linear sequence of data, not necessarily characters."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 1, "creation_date": 1519171775, "post_id": 48896082, "comment_id": 84798162, "body": "@machine_1 C library specifies   &quot;A <i>string</i> is a contiguous sequence of characters terminated by and including the first null character.&quot;  Seems   to necessitate <i>characters</i>."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519172162, "post_id": 48896082, "comment_id": 84798255, "body": "@chux Yeah fine, but I meant the general meaning of the word."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1519172931, "post_id": 48896082, "comment_id": 84798466, "body": "@yano a character must not be printable to be part of a string. <code>&quot;Hello\\r\\b&quot;</code> is a valid string with 2 non-printable characters."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519174183, "post_id": 48896082, "comment_id": 84798802, "body": "@Pablo Carriage return and backspace? I consider those are printable whitespace characters. Printable characters are the only practical contents for C strings and their associated functions. Anything else, use a byte array."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519174351, "post_id": 48896082, "comment_id": 84798856, "body": "I meant <code>\\a</code> (BELL), not <code>\\b</code>. I don&#39;t consider them printable, <code>\\r</code> has no representation at all, the terminal puts the cursor at the beginning of the line, but it doesn&#39;t have to, it may as well ignore that. Same with BELL."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519174546, "post_id": 48896082, "comment_id": 84798909, "body": "<i>&quot;I want to read a whole file to a string and then output it to stdout.&quot;</i> There is nothing preventing you from doing that. You can easily get the file size with <code>stat</code> or with <code>fseek</code> and allocate a buffer sufficient for the file and the <code>fread</code> the file (or just <code>mmap</code> it) and write the buffer to <code>stdout</code> -- the problem is just as @Pablo describes. The file may contain characters that are not printable (e.g. values less than decimal <code>32</code> (space) or greater than <code>127</code> (<code>&#39;~&#39;</code>).. So you need to determine how to handle the output."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519175085, "post_id": 48896082, "comment_id": 84799042, "body": "@Pablo No, I don&#39;t consider a BELL to be printable. And I&#39;ve used exactly 0 BELLs in my C strings throughout my entire career. That goes for single backspaces and carriage returns as well. Argue the pedantics of my comment if you want, but there is no practical purpose to put anything but printable characters in a C string, which is the whole concept the OP needs to understand."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1519175314, "post_id": 48896082, "comment_id": 84799096, "body": "@yano I agree that having non printable characters in a string is not practical, but that doesn&#39;t make a sequence of chars as I posted less of a string. I also agree, arguing about that does not help the OP."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519193319, "post_id": 48896082, "comment_id": 84803658, "body": "@Pablo fair enough, I agree."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519172221, "post_id": 48896289, "comment_id": 84798272, "body": "Very good.  Except <code>fread(bytes, sizeof bytes &#47; sizeof *bytes, 1, fp) != 1</code> may be better as <code>fread(bytes, sizeof bytes, 1, fp) != 1</code>."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519172624, "post_id": 48896289, "comment_id": 84798371, "body": "@chux, I though of just doing <code>sizeof bytes</code> because <code>sizeof *bytes</code> is 1 anyway, but I wanted to have the correct way of having the number of elements of an array regardless of the type. If you think that the answer is more clear with having only <code>sizeof bytes</code>, let me know so that I can update the answer."}, {"owner": {"reputation": 2680, "user_id": 1404447, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a09616794142013529fb3b7881c41eca?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/1404447/tom"}, "edited": false, "score": 1, "creation_date": 1519175413, "post_id": 48896289, "comment_id": 84799120, "body": "@Pablo Thanks. The first example is what I want. I need to send binary files to stdout so other programs can read these binary data from stdin."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 3, "last_activity_date": 1519174969, "last_edit_date": 1519174969, "creation_date": 1519171872, "answer_id": 48896289, "question_id": 48896082, "link": "https://stackoverflow.com/questions/48896082/how-to-use-strings-in-c/48896289#48896289", "title": "How to use strings in C?", "body": "<p>Let's say  you have a binary file. Let's say you want to read 8 bytes from the\nfile.</p>\n\n<pre><code>FILE *fp = fopen(\"a\", \"rb\");\n\nif(fp == NULL)\n    return;\n\nunsigned char bytes[8];\nif(fread(bytes, sizeof bytes / sizeof *bytes, 1, fp) != 1)\n{\n    fprintf(stderr, \"could not read 8 bytes\\n\");\n    return;\n}\n\n// printing the bytes:\n\nfor(size_t i = 0; i &lt; sizeof bytes / sizeof *bytes; ++i)\n    printf(\"%02X \", bytes[i]);\n\nputs(\"\");\n\nfclose(fp);\n</code></pre>\n\n<p>I run this code reading the compiled binary (filename is <code>a</code>) of this same code, the first 8\nbytes are:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>7F 45 4C 46 02 01 01 00\n</code></pre>\n\n<p>As you can see there are bytes that have no representation and if I would print\nthat as a string, this would be the result:</p>\n\n<p><img src=\"https://i.stack.imgur.com/XA8Jx.png\" alt=\"\"></p>\n\n<p>which is less helpful, here I was lucky that there were at least printable\nintegers.</p>\n\n<p>And if you want to have also the printable characters printed as as well (like hex editors\ndo):</p>\n\n<pre><code>size_t n;\n// yes I swapped the number of items and the number of bytes here\n// for reading the whole file\nwhile((n = fread(bytes, 1, sizeof bytes / sizeof *bytes, fp)))\n{\n    size_t i;\n    for(i = 0; i &lt; n; ++i)\n        printf(\"%02X \", bytes[i]);\n\n    // if less than array size bytes read, to align output\n    printf(\"%*s\", (int) ((sizeof bytes / sizeof *bytes) - i)*3, \"\");\n    printf(\"%10s |\", \"\");\n\n    for(i = 0; i &lt; n; ++i)\n    {\n        if(isprint(bytes[i])) \n            printf(\"%c\", bytes[i]);\n        else\n            printf(\".\");\n    }\n\n    // same here as above\n    printf(\"%*s\", (int) ((sizeof bytes / sizeof *bytes) - i), \"\");\n    puts(\"|\");\n}\n</code></pre>\n\n<p>This outputs:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>7F 45 4C 46 02 01 01 00            |.ELF....|\n00 00 00 00 00 00 00 00            |........|\n03 00 3E 00 01 00 00 00            |..&gt;.....|\nA0 07 00 00 00 00 00 00            |........|\n40 00 00 00 00 00 00 00            |@.......|\nF0 23 00 00 00 00 00 00            |.#......|\n00 00 00 00 40 00 38 00            |....@.8.|\n09 00 40 00 23 00 22 00            |..@.#.\".|\n...\n00 6C 69 62 63 2E 73 6F            |.libc.so|\n2E 36 00 66 6F 70 65 6E            |.6.fopen|\n00 70 75 74 73 00 5F 5F            |.puts.__|\n73 74 61 63 6B 5F 63 68            |stack_ch|\n6B 5F 66 61 69 6C 00 70            |k_fail.p|\n75 74 63 68 61 72 00 70            |utchar.p|\n72 69 6E 74 66 00 66 63            |rintf.fc|\n6C 6F 73 65 00 5F 5F 63            |lose.__c|\n74 79 70 65 5F 62 5F 6C            |type_b_l|\n...\n39 01 00 00 00 00 00 00            |9.......|\n00 00 00 00 00 00 00 00            |........|\n01 00 00 00 00 00 00 00            |........|\n00 00 00 00 00 00 00 00            |........|\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "is_accepted": false, "score": 1, "last_activity_date": 1519173757, "last_edit_date": 1519173757, "creation_date": 1519173332, "answer_id": 48896457, "question_id": 48896082, "link": "https://stackoverflow.com/questions/48896082/how-to-use-strings-in-c/48896457#48896457", "title": "How to use strings in C?", "body": "<blockquote>\n  <p>I want to store binary data in strings and then output it.</p>\n</blockquote>\n\n<p>Once you have your binary data in a storage (in our case it is <code>char bin[]</code>)\nyou can make char ascii string out of it using <code>sprintf</code> :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n\n    int i;  \n    char bin[] = { 0, 1 , '1', '2', '3' , 0 , 7 }; \n    char str[256]; \n    char *buf2 = str;\n\n    size_t size =  sizeof(bin)*2;\n\n    for(i= 0; i &lt; size; i++  )\n    {\n        buf2 += sprintf(buf2, \"%02X\", bin[i]);\n    }\n\n    str[i] = 0; // terminate your string\n\n    printf(\"STRING: %s\", str);\n\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>STRING: 00013132330007\n</code></pre>\n"}], "owner": {"reputation": 2680, "user_id": 1404447, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a09616794142013529fb3b7881c41eca?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/1404447/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 1, "accepted_answer_id": 48896289, "answer_count": 2, "score": 1, "last_activity_date": 1528151294, "creation_date": 1519170649, "last_edit_date": 1528151294, "question_id": 48896082, "link": "https://stackoverflow.com/questions/48896082/how-to-use-strings-in-c", "title": "How to use strings in C?", "body": "<p>I am trying to learn how to write modern programs. I want to store binary data in strings and then output it. Why? For example I want to read a whole file to a string and then output it to stdout.</p>\n\n<p>How can I do it? Printf and puts stop outputting data after the first \\0</p>\n\n<p>And what should I use to store filenames so I can work with international characters? wchar_t?</p>\n"}, {"tags": ["c", "graphics", "embedded", "2d", "rendering"], "comments": [{"owner": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "edited": false, "score": 1, "creation_date": 1519172023, "post_id": 48896023, "comment_id": 84798218, "body": "Are you using a double buffered technique or are you directly writing to the bits from the loop? If I were you I&#39;d memcpy my array to the memory mapped portion of memory that represents the display."}, {"owner": {"reputation": 250, "user_id": 3006011, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bf21d7239544fd04d0eb8eb40751e4ed?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Martines Sanches", "link": "https://stackoverflow.com/users/3006011/erik-martines-sanches"}, "reply_to_user": {"reputation": 513, "user_id": 8293226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ccfWx.png?s=128&g=1", "display_name": "mustachioed", "link": "https://stackoverflow.com/users/8293226/mustachioed"}, "edited": false, "score": 0, "creation_date": 1519173797, "post_id": 48896023, "comment_id": 84798681, "body": "Thanks, I think your suggestion is right on track! Presently, inside my for loops I only &quot;set&quot; the appropriate bit within the (global) frame array. Only after that do I iterate over the frame array again to render it!"}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 2, "creation_date": 1519173878, "post_id": 48896023, "comment_id": 84798710, "body": "Performance-critical code on low-end embedded devices are rarely written in a high-level programming language like C, and instead in hand-optimized assembly. There is an <a href=\"https://www.youtube.com/watch?v=WpwlZgQPCpk&amp;list=PLNs6Jw4V4vlvafSs0H3Ww_M5nMm10m0UM\" rel=\"nofollow noreferrer\">absolute gem of a series</a> on YouTube about optimizing the Quake engine to run on a 16MHz Atari Falcon030."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1519174109, "post_id": 48896023, "comment_id": 84798783, "body": "I have an app with a similar OLED, and I make the frame buffer itself have the same bit-layout as the OLED...in fact, I even add extra bytes for command bytes so that my actual rendering function just blasts the whole buffer out to the I2C bus. Then I write my drawing primitives (mostly text in my case) write to that buffer in its native format."}, {"owner": {"reputation": 250, "user_id": 3006011, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bf21d7239544fd04d0eb8eb40751e4ed?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Martines Sanches", "link": "https://stackoverflow.com/users/3006011/erik-martines-sanches"}, "reply_to_user": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1519176595, "post_id": 48896023, "comment_id": 84799371, "body": "Thanks for the tip @meowgoesthedog, I&#39;ll have a look! I&#39;ve recently studied some (MIPS) assembly.   Someone also told me about jaged arrays and making rendering and processing asynchronous to stabilize frame rate..."}, {"owner": {"reputation": 250, "user_id": 3006011, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bf21d7239544fd04d0eb8eb40751e4ed?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Martines Sanches", "link": "https://stackoverflow.com/users/3006011/erik-martines-sanches"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1519176880, "post_id": 48896023, "comment_id": 84799440, "body": "@LeeDanielCrocker That sounds brilliant and badass. I will contemplate your actions inside my chamber and come back once I&#39;ve grasped the implications! I do believe I&#39;m at least laying out the frame buffer array the same way the OLED does, I&#39;ll experiment with your suggestions!"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 2, "creation_date": 1519201516, "post_id": 48896023, "comment_id": 84807572, "body": "Are you using floating point math for your algorithm?  That will really slow it down.  You need to post your code - the problem will be there."}, {"owner": {"reputation": 250, "user_id": 3006011, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bf21d7239544fd04d0eb8eb40751e4ed?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Martines Sanches", "link": "https://stackoverflow.com/users/3006011/erik-martines-sanches"}, "edited": false, "score": 0, "creation_date": 1519215760, "post_id": 48896023, "comment_id": 84817265, "body": "Integer math. Can&#39;t post due to school. I&#39;m just looking for general advice."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1519252545, "post_id": 48896023, "comment_id": 84839808, "body": "If you are looking for &quot;general advice&quot; the the question is by definition &quot;too broad&quot;."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 2, "creation_date": 1519253052, "post_id": 48896023, "comment_id": 84839993, "body": "The speed of your processor is entirely irrelevant; while you can probably generate the frame buffer very quickly in RAM, the display is not a direct presentation of that frame buffer.  If <a href=\"https://store.digilentinc.com/chipkit-basic-i-o-shield-input-output-expansion-add-on-board-with-oled-display-retired/\" rel=\"nofollow noreferrer\">this</a> is the board you are referring to, the display is on a relatively slow SPI bus, the time taken to update the display will depend on the SPI clock rate used.  That said you must be running it <i>very</i> slow to take as long as you suggest."}], "answers": [{"tags": [], "owner": {"reputation": 250, "user_id": 3006011, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bf21d7239544fd04d0eb8eb40751e4ed?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Martines Sanches", "link": "https://stackoverflow.com/users/3006011/erik-martines-sanches"}, "is_accepted": false, "score": 0, "last_activity_date": 1519301715, "creation_date": 1519301715, "answer_id": 48927174, "question_id": 48896023, "link": "https://stackoverflow.com/questions/48896023/rendering-on-an-embedded-device/48927174#48927174", "title": "Rendering on an embedded device", "body": "<p>It was a silly beginner's mistake relating to the way I set the bits in the frame array. No need to iterate, just address the bits in the frame array directly (with a little bit shifting to shift into the appropriate y position in each column, using a |= to avoid overwriting)!</p>\n"}], "owner": {"reputation": 250, "user_id": 3006011, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bf21d7239544fd04d0eb8eb40751e4ed?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Martines Sanches", "link": "https://stackoverflow.com/users/3006011/erik-martines-sanches"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519301715, "creation_date": 1519170269, "last_edit_date": 1519171372, "question_id": 48896023, "link": "https://stackoverflow.com/questions/48896023/rendering-on-an-embedded-device", "title": "Rendering on an embedded device", "body": "<p>I'm working with a Digilent Uno32 Chipkit and an I/O shield featuring a small 128*32px OLED display. I have a frame rate issue (render time depends on pixels drawn).</p>\n\n<p>My frame is an 512 long byte array, giving a total of 4096 bits (128*32).</p>\n\n<p>My pixel drawing function works in square time (I think), meaning it has to increment a for-loop (which iterates over pixels within columns) nested within another for-loop (which iterates over columns within the screen) to get to the (x,y) pixel position. (Screen is split into 4 horizontal pages.)</p>\n\n<p>I have implemented <a href=\"https://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm\" rel=\"nofollow noreferrer\">Bresenham's line algorithm (for all cases)</a> with which I've only drawn 8 lines.</p>\n\n<p>I have a timer (and interrupts) to update the screen every 0.1 seconds, but the screen renders slower that that.</p>\n\n<p>I'm looking for general advice how to get a decent framerate (30-60Hz) regardless of number of pixels drawn (it should be possible on an 80MHz device, Gameboy is lower than that!). Should I reconsider my approach? The line drawing algorithm? Should I look into data structures, hash tables or something similar?</p>\n"}, {"tags": ["c", "linux", "posix", "privileges"], "comments": [{"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "edited": false, "score": 0, "creation_date": 1519168989, "post_id": 48895619, "comment_id": 84797388, "body": "So, downvoter, what&#39;s wrong with the question? How could I improve it? Enquiring minds want to know. Or do you just enjoy randomly downvoting questions for no reason?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1519169974, "post_id": 48895619, "comment_id": 84797689, "body": "What gives you the impression that <code>setgroups</code> cannot be used to do this?"}, {"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1519170946, "post_id": 48895619, "comment_id": 84797972, "body": "@zwol - Because I tried it, and it fails with <code>EPERM</code>. Basically, you only get to make that call if you have CAP_SETGID, and since the program starting the set{u,g}id process is non-privileged and the user/group being set{u,g}id&#39;ed to is also non-privileged, no go."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1519171414, "post_id": 48895619, "comment_id": 84798085, "body": "Oh, huh. That ... might actually mean there&#39;s no way to do it. (I&#39;m not aware of any other system call that changes the supplementary groups list.) Do you have the ability to try the program on a different kernel, like one of the BSDs? &quot;I can do this on FooBSD&quot; is going to be an easier sell to the kernel devs than &quot;there&#39;s never been a way to do this but I want one&quot;."}, {"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1519171490, "post_id": 48895619, "comment_id": 84798106, "body": "@zwol - Turns out it&#39;s the way it is for a reason, and if FooBSD isn&#39;t that way, it should be: <a href=\"https://lwn.net/Articles/626665/\" rel=\"nofollow noreferrer\">lwn.net/Articles/626665</a>"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1519172193, "post_id": 48895619, "comment_id": 84798265, "body": "Ugh, I should have thought of that.  Thanks."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1519209252, "post_id": 48895619, "comment_id": 84812715, "body": "@Omnifarious: You do need either the CAP_SETUID or CAP_SETGID capability (which you can set for the specific executable using the <code>setcap</code> utility), or set the binary setuid or setgid root. I&#39;ve used both approaches successfully. To set supplementary groups based on an user name, use <code>initgroups()</code>. To keep things secure, I recommend putting this in a separate wrapper program, that examines the caller privileges/identity, stats and checks the target binary (path specified at compile time), and if acceptable, executes it as the desired user."}, {"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1519226196, "post_id": 48895619, "comment_id": 84824705, "body": "@NominalAnimal - That may not be an option for us. And since I&#39;m creating a new user namespace immediately after becoming the new user, I don&#39;t know that it&#39;s needed in this case anyway. Those other groups are basically all mapped to nobody. Perhaps you should write that up in an answer so I don&#39;t have to answer my own question here."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1519272325, "post_id": 48895619, "comment_id": 84845186, "body": "@Omnifarious: If you describe your findings and the reasons why you chose your solution, that would definitely be the better answer here. :)"}], "answers": [{"comments": [{"owner": {"reputation": 2477, "user_id": 799204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/CNmjQ.jpg?s=128&g=1", "display_name": "sourcejedi", "link": "https://stackoverflow.com/users/799204/sourcejedi"}, "edited": false, "score": 0, "creation_date": 1560007389, "post_id": 48930477, "comment_id": 99602693, "body": "Although, I am not sure the second para is correct. The point of the kernel fix in the linked article is that for unprivileged (non-CAP_SETGID) users &quot;it essentially become impossible to (1) play tricks with mappings to drop groups&quot;.  So I am not convinced the supplementary groups are getting remapped to &#39;nobody&#39;."}, {"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "reply_to_user": {"reputation": 2477, "user_id": 799204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/CNmjQ.jpg?s=128&g=1", "display_name": "sourcejedi", "link": "https://stackoverflow.com/users/799204/sourcejedi"}, "edited": false, "score": 0, "creation_date": 1560013350, "post_id": 48930477, "comment_id": 99604080, "body": "@sourcejedi - Note the &#39;in my particular case&#39; qualifier there."}, {"owner": {"reputation": 2477, "user_id": 799204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/CNmjQ.jpg?s=128&g=1", "display_name": "sourcejedi", "link": "https://stackoverflow.com/users/799204/sourcejedi"}, "edited": false, "score": 0, "creation_date": 1560016306, "post_id": 48930477, "comment_id": 99604746, "body": "If your kernel follows different rules than those in the linked source, it would be much clearer if you specified that. If your kernel follows the same rules, what is the special condition in these rules in which &quot;those supplementary groups get mapped to &#39;nobody&#39; anyway&quot;?"}, {"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "reply_to_user": {"reputation": 2477, "user_id": 799204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/CNmjQ.jpg?s=128&g=1", "display_name": "sourcejedi", "link": "https://stackoverflow.com/users/799204/sourcejedi"}, "edited": false, "score": 0, "creation_date": 1560024185, "post_id": 48930477, "comment_id": 99606356, "body": "@sourcejedi - Those aren&#39;t special rules. That is what happens when you create a user namespace when you aren&#39;t root. All uids but the one for you get mapped to the nobody, and the same for all gids but the one for you."}, {"owner": {"reputation": 2477, "user_id": 799204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/CNmjQ.jpg?s=128&g=1", "display_name": "sourcejedi", "link": "https://stackoverflow.com/users/799204/sourcejedi"}, "edited": false, "score": 1, "creation_date": 1560071337, "post_id": 48930477, "comment_id": 99612878, "body": "When you look from inside the namespace, the extra groups appear as the nobody. But when you look from outside the namespace, the process has not lost its supplementary groups.  Therefore, <i>if</i> the process still has visibility of an object which in reality (the outer namespace) belongs to one of those groups, the permissions of that group will still apply to the actions taken by the process. That might grant more permissions over the object - or it might grant <i>less</i> permissions.  The latter is why this approach is required."}, {"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "reply_to_user": {"reputation": 2477, "user_id": 799204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/CNmjQ.jpg?s=128&g=1", "display_name": "sourcejedi", "link": "https://stackoverflow.com/users/799204/sourcejedi"}, "edited": false, "score": 0, "creation_date": 1560094640, "post_id": 48930477, "comment_id": 99617490, "body": "@sourcejedi - Oh. Yeah, you&#39;re probably right. :-( Now I&#39;m worrying about security problems in something I wrote over a year ago."}], "tags": [], "owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "is_accepted": true, "score": 3, "last_activity_date": 1519311884, "last_edit_date": 1519311884, "creation_date": 1519311335, "answer_id": 48930477, "question_id": 48895619, "link": "https://stackoverflow.com/questions/48895619/how-do-i-drop-supplementary-groups-in-linux/48930477#48930477", "title": "How do I drop supplementary groups in Linux?", "body": "<p>The short answer is \"A process without CAP_SETGID can't.\". And it is <a href=\"https://lwn.net/Articles/626665/\" rel=\"nofollow noreferrer\">by design that setgroups can't be used to remove groups when the process has no privileges</a>. The previous link is to an excellent LWN article detailing why not.</p>\n\n<p>In my particular case, since I'm immediately creating a user namespace, those supplementary groups get mapped to 'nobody' anyway. And so it isn't very important. If it is important, you can use <a href=\"http://man7.org/linux/man-pages/man8/setcap.8.html\" rel=\"nofollow noreferrer\"><code>setcap(8)</code></a> to set capabilities on a wrapper executable that checks that it's being run by the expected user with the expected group permissions and then drops the groups and drops CAP_SETGID and runs the executable you really want to run. The command you would use to do this is:</p>\n\n<pre><code>sudo setcap cap_setgid+ep wrapper_exe\n</code></pre>\n\n<p>Be careful though, it's now possible that someone who has a shell on your system can use that executable to run some sort of privilege escalation attack if you did not write it very carefully.</p>\n"}], "owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 0, "accepted_answer_id": 48930477, "answer_count": 1, "score": 1, "last_activity_date": 1519330894, "creation_date": 1519167749, "last_edit_date": 1519330894, "question_id": 48895619, "link": "https://stackoverflow.com/questions/48895619/how-do-i-drop-supplementary-groups-in-linux", "title": "How do I drop supplementary groups in Linux?", "body": "<p>I have an executable that's <code>ug+s</code> to a non-root user and group. I would like it to leave all the supplementary groups it originally had behind. Is there a way to make this happen? It doesn't look like the <code>setgroups</code> call allows you to do this if you're not root. And when I try it, I get <code>EPERM</code>.</p>\n\n<p>It seems like there ought to be a way to lose privileges you previously possessed.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 1, "creation_date": 1519166117, "post_id": 48895296, "comment_id": 84796446, "body": "No. You could cast the result to something which really is 8 bits, though."}, {"owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "edited": false, "score": 0, "creation_date": 1519166135, "post_id": 48895296, "comment_id": 84796449, "body": "Is <code>int_fast8_t</code> really 32 bits? The name suggest 8 bit so it can only hold 127 as positive number. Casting to <code>(char)</code> should do the trick! Typically <code>char</code> is only 8 bits."}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "reply_to_user": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "edited": false, "score": 0, "creation_date": 1519166319, "post_id": 48895296, "comment_id": 84796530, "body": "@sg7: Depends on the platform. On my machine uint_fast16/32_t are 64 bits, though uint_fast8_t is 8."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "edited": false, "score": 1, "creation_date": 1519166788, "post_id": 48895296, "comment_id": 84796679, "body": "@sg7 it means &quot;A type which is at least 8 bits and is the fastest for holding 8-bit data&quot;. It could be any size 8 or greater, and it has the properties of its actual size (not the properties of an 8-bit integer)"}], "answers": [{"tags": [], "owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "is_accepted": false, "score": 1, "last_activity_date": 1519166683, "creation_date": 1519166683, "answer_id": 48895443, "question_id": 48895296, "link": "https://stackoverflow.com/questions/48895296/int-fast-types-and-value-overflow/48895443#48895443", "title": "int_fast_ types and value overflow", "body": "<p>Nope. All the fast types really are are typedefs. For example, stdint.h on my machine includes</p>\n\n<pre><code>/* Fast types.  */\n\n/* Signed.  */\ntypedef signed char     int_fast8_t;\n#if __WORDSIZE == 64\ntypedef long int        int_fast16_t;\ntypedef long int        int_fast32_t;\ntypedef long int        int_fast64_t;\n#else\ntypedef int         int_fast16_t;\ntypedef int         int_fast32_t;\n__extension__\ntypedef long long int       int_fast64_t;\n#endif\n\n/* Unsigned.  */\ntypedef unsigned char       uint_fast8_t;\n#if __WORDSIZE == 64\ntypedef unsigned long int   uint_fast16_t;\ntypedef unsigned long int   uint_fast32_t;\ntypedef unsigned long int   uint_fast64_t;\n#else\ntypedef unsigned int        uint_fast16_t;\ntypedef unsigned int        uint_fast32_t;\n__extension__\ntypedef unsigned long long int  uint_fast64_t;\n#endif\n</code></pre>\n\n<p>The closest you can come without a significant performance penalty is probably casting the result to an 8-bit type.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519168234, "post_id": 48895456, "comment_id": 84797150, "body": "Note there is no <i>overflow</i> involved here, just <i>conversion</i>."}, {"owner": {"reputation": 5436, "user_id": 3161139, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/EePWR.jpg?s=128&g=1", "display_name": "Antonin GAVREL", "link": "https://stackoverflow.com/users/3161139/antonin-gavrel"}, "edited": false, "score": 0, "creation_date": 1519168492, "post_id": 48895456, "comment_id": 84797233, "body": "Upvoted this because I didnt know about uint_fast8_t :) Thank you for the nice explanation as well~"}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": false, "score": 2, "last_activity_date": 1519172431, "last_edit_date": 1519172431, "creation_date": 1519166772, "answer_id": 48895456, "question_id": 48895296, "link": "https://stackoverflow.com/questions/48895296/int-fast-types-and-value-overflow/48895456#48895456", "title": "int_fast_ types and value overflow", "body": "<p>It is absolutely possible for the result to exceed 127. <code>int_fast8_t</code> (and <code>uint_fast8_t</code> and all the rest) set an explicit minimum size for the value, but it could be larger, and the compiler will not prevent it from exceeding the stated 8 bit bounds (it behaves exactly like the larger type it represents, the \"8ness\" of it isn't relevant at runtime), only guarantee it can definitely represent all values in said 8 bit range.</p>\n\n<p>If you need it to explicitly truncate/wrap to 8 bit values, either use (or cast to) <code>int8_t</code> to restrict the representable range (though <a href=\"https://stackoverflow.com/q/18195715/364696\">overflow wouldn't be defined</a>), or explicitly use masks to perform the same work yourself when needed.</p>\n"}, {"comments": [{"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1519170053, "post_id": 48895473, "comment_id": 84797703, "body": "unsigned char (or char for that matter) is only 8 bits if CHAR_BIT == 8. There is no type in C which is guaranteed to exist and be 8-bits."}, {"owner": {"reputation": 5436, "user_id": 3161139, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/EePWR.jpg?s=128&g=1", "display_name": "Antonin GAVREL", "link": "https://stackoverflow.com/users/3161139/antonin-gavrel"}, "reply_to_user": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1519228339, "post_id": 48895473, "comment_id": 84826246, "body": "Hi @nemequ, are you sure? I have never heard of any situation where char size differs from 8 bits."}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 1, "creation_date": 1519233873, "post_id": 48895473, "comment_id": 84830166, "body": "Yes. They&#39;re very rare in anything even remotely modern (4 and 6 bits was common up to ~ 1970), but AFAIK some specialized processors do still use something other than 8 bits. More importantly, the C standard does not require 8 bits, otherwise why include a CHAR_BIT macro?"}], "tags": [], "owner": {"reputation": 5436, "user_id": 3161139, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/EePWR.jpg?s=128&g=1", "display_name": "Antonin GAVREL", "link": "https://stackoverflow.com/users/3161139/antonin-gavrel"}, "is_accepted": false, "score": 1, "last_activity_date": 1519166860, "creation_date": 1519166860, "answer_id": 48895473, "question_id": 48895296, "link": "https://stackoverflow.com/questions/48895296/int-fast-types-and-value-overflow/48895473#48895473", "title": "int_fast_ types and value overflow", "body": "<p>Just use unsigned char if you want to manipulate 8 bits (unsigned char is one byte long) you will work on  0 to 0xFF (255) unsigned range</p>\n"}, {"comments": [{"owner": {"reputation": 896, "user_id": 6488109, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cpnSP.jpg?s=128&g=1", "display_name": "Papipone", "link": "https://stackoverflow.com/users/6488109/papipone"}, "edited": false, "score": 0, "creation_date": 1519167282, "post_id": 48895474, "comment_id": 84796862, "body": "int8_t, int16_t, int32_t, int64_t are not guaranteed to be defined on every platform?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 896, "user_id": 6488109, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cpnSP.jpg?s=128&g=1", "display_name": "Papipone", "link": "https://stackoverflow.com/users/6488109/papipone"}, "edited": false, "score": 2, "creation_date": 1519167842, "post_id": 48895474, "comment_id": 84797038, "body": "@Papipone That is true, yet OP does not appear to be on such an esoteric machine.  If we venture to non-8-bit <code>char</code>, we might as well consider <i>sign magnitude</i> and <i>one&#39;s complement</i>, and traps.  Likely beyond OP&#39;&#39;s need."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1519168151, "last_edit_date": 1519168151, "creation_date": 1519166876, "answer_id": 48895474, "question_id": 48895296, "link": "https://stackoverflow.com/questions/48895296/int-fast-types-and-value-overflow/48895474#48895474", "title": "int_fast_ types and value overflow", "body": "<pre><code>int_fast8_t a = 64;\na *= 2;\n</code></pre>\n\n<blockquote>\n  <p>If a is interpreted as a \"regular\" int (32 bits), is it possible that a exceed 127 and be not equal to -128?</p>\n</blockquote>\n\n<p>Yes.  It very likely <code>a * 2</code> will save in <code>a</code> as 128.  I would expect this on all processors unless the processor was an 8-bit one.</p>\n\n<blockquote>\n  <p>Is there some kind of mechanism which enforces that the value of an <code>int_fast_n_t</code> never overflow ?</p>\n</blockquote>\n\n<p>No.  Signed integer overflow is still possible as well as values outside the [-128...127] range.</p>\n\n<blockquote>\n  <p>I do not want a to be greater than 127</p>\n</blockquote>\n\n<p>Use <code>int8_t</code>.  The value save will never exceed 127, yet code still has <em>implementation defined behavior</em> in setting a 128 to an <code>int8_t</code>.  This often results in -128 (values wrap mod 256), yet other values are possible (this is uncommon).</p>\n\n<pre><code>int8_t a = 64;\na *= 2;\n</code></pre>\n\n<hr>\n\n<p>If assignment to <code>int8_t</code> is not available or has unexpected <em>implementation defined behavior</em>, code could force the wrapping itself:</p>\n\n<pre><code>int_fast8_t a = foo();  // a takes on some value\na %= 256; \nif (a &lt; -128) a += 256;\nelse if (a &gt; 127) a -= 256;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519167957, "post_id": 48895512, "comment_id": 84797079, "body": "&quot;<code>int8_t</code> to guarantee 8 bit int&quot; is true yet <code>int8_t b = 128;</code> is not specified to store -128.  Although that is very common."}, {"owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519168617, "post_id": 48895512, "comment_id": 84797270, "body": "@chux Thank you for the comment. My understanding is that  <code>int8_t</code> has to have two\u2019s complement representation as per standard. And the following source: <code>https:&#47;&#47;en.wikibooks.org&#47;wiki&#47;C_Programming&#47;stdint.h</code> specifies the range as <code>&lt;-128,127&gt;</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519169178, "post_id": 48895512, "comment_id": 84797450, "body": "The issue is not  about  <code>int8_t</code>.  The concern is <i>conversion</i> of a value, like 128, that is outside the target range [-128...127] - which is <i>implementation defined behavior</i>.  Even with <code>int8_t</code> specified as you say, a complier <i>could</i> assign 127 (or other values) to <code>int8_t c</code>.  I doubt such compilers practically exist except for hostile ones, that are designed to stress test code."}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1519169709, "post_id": 48895512, "comment_id": 84797600, "body": "<code>int8_t</code> is optional in C99/C11; does POSIX specify that it must exist? Also, the representation of signed integers is not defined; two&#39;s complement is pretty universal on modern CPUs, but not technically required."}, {"owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "reply_to_user": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 2, "creation_date": 1519170244, "post_id": 48895512, "comment_id": 84797772, "body": "@nemequ <code>int8_t is optional in C99&#47;C11;</code> TRUE. However, POSIX requires <code>int8_t</code> to be defined, source: <a href=\"https://www.unix.com/man-page/posix/7posix/stdint.h/\" rel=\"nofollow noreferrer\">unix.com/man-page/posix/7posix/stdint.h</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519180440, "post_id": 48895512, "comment_id": 84800233, "body": "Hmmm, strange POSIX makes <code>(u)int64_t</code> optional, yet  <code>(u)int8,16,32_t</code>, <code>uint_least8,16,32,64_t</code>, <code>uint_least8,16,32,64_t</code> required."}], "tags": [], "owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "is_accepted": false, "score": 1, "last_activity_date": 1519167956, "last_edit_date": 1519167956, "creation_date": 1519167123, "answer_id": 48895512, "question_id": 48895296, "link": "https://stackoverflow.com/questions/48895296/int-fast-types-and-value-overflow/48895512#48895512", "title": "int_fast_ types and value overflow", "body": "<p>From the C(99) <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.20.1.1p1\" rel=\"nofollow noreferrer\">standard</a>:</p>\n\n<blockquote>\n  <p>The typedef name intN_t designates a signed integer type with width N\n  , no padding bits, and a two\u2019s complement representation. Thus, int8_t\n  denotes a signed integer type with a width of exactly 8 bits.</p>\n</blockquote>\n\n<p>So use <code>int8_t</code> to guarantee 8 bit int.</p>\n\n<p>A compliant C99/C11 compiler on a POSIX platform must have <code>int8_t</code>.</p>\n"}], "owner": {"reputation": 896, "user_id": 6488109, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cpnSP.jpg?s=128&g=1", "display_name": "Papipone", "link": "https://stackoverflow.com/users/6488109/papipone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 48895474, "answer_count": 5, "score": 1, "last_activity_date": 1519172431, "creation_date": 1519165883, "last_edit_date": 1519166375, "question_id": 48895296, "link": "https://stackoverflow.com/questions/48895296/int-fast-types-and-value-overflow", "title": "int_fast_ types and value overflow", "body": "<p>If I understand well, <code>int_fast_n_t</code> types are guaranteed to be at least <code>n</code> bits long. Depending on the compiler and the architecture of the computer these types can also be defined on more than <code>n</code> bits. For instance, a <code>int_fast_8_t</code> could be interpreted as a 32 bits <code>int</code>. </p>\n\n<p>Is there some kind of mechanism which enforces that the value of an <code>int_fast_n_t</code> never overflow even if the true type is defined on more than <code>n</code> bits?</p>\n\n<p>Consider the following code for example:</p>\n\n<pre><code>int main(){\n    int_fast8_t a = 64;\n    a *= 2; // -128\n    return 0;\n}\n</code></pre>\n\n<p>I do not want <code>a</code> to be greater than <code>127</code>. If <code>a</code> is interpreted as a \"regular\" <code>int</code> (32 bits), is it possible that <code>a</code> exceed <code>127</code> and be not equal to <code>-128</code>?</p>\n\n<p>Thanks for your answers.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1519164825, "post_id": 48895018, "comment_id": 84795970, "body": "The <code>*</code> in <code>init_device*(&amp;params)</code> makes no sense."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 3, "creation_date": 1519164871, "post_id": 48895018, "comment_id": 84795994, "body": "does this even compile? Try <code>init_device(&amp;params);</code>. If you still segfault after that you&#39;ll need to post some code."}, {"owner": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "edited": false, "score": 3, "creation_date": 1519167107, "post_id": 48895018, "comment_id": 84796796, "body": "<code>...alloca</code> sounds like <code>alloca()</code> will be used. This allocates memory within the current stackframe only which is released on function exit."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 1, "creation_date": 1519174347, "post_id": 48895018, "comment_id": 84798854, "body": "Don&#39;t make changes that invalidate answers. If you have a different question, please ask a different question."}, {"owner": {"reputation": 2337, "user_id": 2356635, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a5797203c9697ebe2570a58b5bdc2b1d?s=128&d=identicon&r=PG", "display_name": "Sam D20", "link": "https://stackoverflow.com/users/2356635/sam-d20"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1519174689, "post_id": 48895018, "comment_id": 84798945, "body": "@MooingDuck I am unable to ask a new question with the typo fixed due to post duplication, and I can&#39;t delete this question because of the responses it has received. How do I ask my question properly?"}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 1, "creation_date": 1519177423, "post_id": 48895018, "comment_id": 84799566, "body": "@ByronS: I&#39;d start by reading <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>, and making a good question, rather than fixing a single typo"}], "answers": [{"comments": [{"owner": {"reputation": 2337, "user_id": 2356635, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a5797203c9697ebe2570a58b5bdc2b1d?s=128&d=identicon&r=PG", "display_name": "Sam D20", "link": "https://stackoverflow.com/users/2356635/sam-d20"}, "edited": false, "score": 0, "creation_date": 1519174272, "post_id": 48895351, "comment_id": 84798826, "body": "Whoops. That was a typo. My apologies. The actual code I used is identical to what you&#39;ve posted."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1519166170, "creation_date": 1519166170, "answer_id": 48895351, "question_id": 48895018, "link": "https://stackoverflow.com/questions/48895018/exporting-allocation-function-to-subroutine-resulting-in-segmentation-fault/48895351#48895351", "title": "Exporting allocation function to subroutine resulting in segmentation fault.", "body": "<blockquote>\n  <p>Am I doing something wrong,</p>\n</blockquote>\n\n<p>Yes.  <code>init_device*(&amp;params);</code> looks like code is taking the function address <code>init_device</code> and multiplying it by the address of <code>params</code>.  then tossing the product.  Function <code>init_device()</code> is not called.</p>\n\n<p>Remove the <code>*</code> and simple call as suggested by <a href=\"https://stackoverflow.com/questions/48895018/exporting-allocation-function-to-subroutine-resulting-in-segmentation-fault/48895351#comment84795994_48895018\">@yano</a></p>\n\n<pre><code>init_device(&amp;params);\n</code></pre>\n\n<p>Also declare/define functions before calling them.</p>\n\n<pre><code>void init_device(snd_pcm_hw_params_t** params);\n\nint main(){\n  snd_pcm_hw_params_t* params; \n  init_device(&amp;params); \n}\n</code></pre>\n\n<hr>\n\n<p>Be sure to enable all compiler warnings to save you time.</p>\n"}], "owner": {"reputation": 2337, "user_id": 2356635, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a5797203c9697ebe2570a58b5bdc2b1d?s=128&d=identicon&r=PG", "display_name": "Sam D20", "link": "https://stackoverflow.com/users/2356635/sam-d20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "closed_date": 1519209457, "answer_count": 1, "score": 0, "last_activity_date": 1519174330, "creation_date": 1519164330, "last_edit_date": 1519174330, "question_id": 48895018, "link": "https://stackoverflow.com/questions/48895018/exporting-allocation-function-to-subroutine-resulting-in-segmentation-fault", "closed_reason": "Not suitable for this site", "title": "Exporting allocation function to subroutine resulting in segmentation fault.", "body": "<p>I have a device that requires a structure pointer be passed to an allocation function like such: </p>\n\n<pre><code>int main(){\n  snd_pcm_hw_params_t* params; \n\n  snd_pcm_hw_params_alloca(&amp;params); \n}\n</code></pre>\n\n<p>I would like to wrap their allocation function into my own function like so: </p>\n\n<pre><code>int main(){\n  snd_pcm_hw_params_t* params; \n\n  init_device*(&amp;params); \n}\n\nvoid init_device(snd_pcm_hw_params_t** params){\n  snd_pcm_hw_params_alloca(params); \n}\n</code></pre>\n\n<p>However, doing so yields a segmentation fault. Am I doing something wrong, or is it perhaps intrinsic to the allocation function provided to me?</p>\n"}, {"tags": ["c", "alarm", "setjmp"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519164475, "post_id": 48895014, "comment_id": 84795840, "body": "Your <code>i</code> should be <code>volatile sig_atomic_t</code>. Also why are you using the <code>setjmp</code>/<code>longjmp</code> ? This can be achieved in much cleaner way...Also you are not supposed to use library functions in signal handlers."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519164788, "post_id": 48895014, "comment_id": 84795955, "body": "For reference: <a href=\"https://stackoverflow.com/questions/21542077/c-sigalrm-alarm-to-display-message-every-second\" title=\"c sigalrm alarm to display message every second\">stackoverflow.com/questions/21542077/&hellip;</a>"}, {"owner": {"reputation": 79, "user_id": 7795562, "user_type": "registered", "profile_image": "https://graph.facebook.com/1434464229938604/picture?type=large", "display_name": "Varouzan Knouni", "link": "https://stackoverflow.com/users/7795562/varouzan-knouni"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519165496, "post_id": 48895014, "comment_id": 84796229, "body": "@EugeneSh. This is not the program I am working on. It is just the part I am having trouble with. <code>setjmp&#47;longjmp</code> is indeed unnecessary here but I do need it."}], "answers": [{"tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 2, "last_activity_date": 1519167391, "creation_date": 1519167391, "answer_id": 48895557, "question_id": 48895014, "link": "https://stackoverflow.com/questions/48895014/cant-get-alarm-to-work-more-than-twice/48895557#48895557", "title": "can&#39;t get alarm() to work more than twice", "body": "<p>Your program might work as you expected on some POSIXy operating systems -- in fact, it <em>does</em> work as you expected on the computer I'm typing this on.  However, it relies on a bunch of unspecified behavior relating to signals, and I think you've tripped over one of them: I think that on your computer, a signal is \"blocked\" \u2014 it can't be delivered again \u2014 while its handler is executing, and also, jumping out of the handler with <code>longjmp</code> does <em>not</em> unblock the signal.  So you go around the loop once and then the second SIGALRM is never delivered because it's blocked.  There are several other, related problems.</p>\n\n<p>You can nail down all of the unspecified behavior and make the program reliable on all POSIXy operating systems, but you have to use different functions to set things up: <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/sigsetjmp.html\" rel=\"nofollow noreferrer\"><code>sigsetjmp</code></a> and <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/sigaction.html\" rel=\"nofollow noreferrer\"><code>sigaction</code></a>.  You should also get rid of the busy-waiting by using <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/sigsuspend.html\" rel=\"nofollow noreferrer\"><code>sigsuspend</code></a> instead.  A corrected program would look something like this:</p>\n\n<pre><code>#define _XOPEN_SOURCE 700\n#include &lt;signal.h&gt;\n#include &lt;setjmp.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nstatic jmp_buf mark;\n\nstatic void\nhandle_SIGALRM(int sig)\n{\n  static int signal_count;\n\n  signal_count++;\n  printf(\"SIGALRM #%u\\n\", signal_count);\n  siglongjmp(mark, signal_count);\n}\n\nint\nmain(void)\n{\n  sigset_t mask, omask;\n  sigemptyset(&amp;mask);\n  sigaddset(&amp;mask, SIGALRM);\n  if (sigprocmask(SIG_BLOCK, &amp;mask, &amp;omask)) {\n    perror(\"sigprocmask\");\n    return 1;\n  }\n\n  struct sigaction sa;\n  sigfillset(&amp;sa.sa_mask);\n  sa.sa_flags = 0; // DO interrupt blocking system calls\n  sa.sa_handler = handle_SIGALRM;\n  if (sigaction(SIGALRM, &amp;sa, 0)) {\n    perror(\"sigaction\");\n    return 1;\n  }\n\n  if (sigsetjmp(mark, 1) &gt;= 4)\n    return 0;\n  alarm(1);\n  sigsuspend(&amp;omask);\n\n  perror(\"shouldn't ever get here\");\n  return 1;\n}\n</code></pre>\n\n<p>I should probably say a few words about signal safety: In <em>this</em> program, it <em>is</em> safe to call <code>printf</code> and <code>siglongjmp</code> from the signal handler, because I have arranged for the SIGALRM <em>only</em> to be deliverable while the main thread of execution is blocked on <code>sigsuspend</code>.  (That's what the call to <code>sigprocmask</code> up top does.)  If you had anything to do in your main thread of execution <em>besides</em> sleep waiting for the signal to arrive, you would have to be <a href=\"http://man7.org/linux/man-pages/man7/signal-safety.7.html\" rel=\"nofollow noreferrer\">much more careful</a> about what you did in the signal handler, and I would  advocate for using <a href=\"https://lwn.net/Articles/176911/\" rel=\"nofollow noreferrer\"><code>pselect</code></a> and/or the <a href=\"https://www.sitepoint.com/the-self-pipe-trick-explained/\" rel=\"nofollow noreferrer\">self-pipe trick</a> instead of jumping out of the handler, if at all possible.</p>\n"}], "owner": {"reputation": 79, "user_id": 7795562, "user_type": "registered", "profile_image": "https://graph.facebook.com/1434464229938604/picture?type=large", "display_name": "Varouzan Knouni", "link": "https://stackoverflow.com/users/7795562/varouzan-knouni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 48895557, "answer_count": 1, "score": 2, "last_activity_date": 1519167391, "creation_date": 1519164315, "question_id": 48895014, "link": "https://stackoverflow.com/questions/48895014/cant-get-alarm-to-work-more-than-twice", "title": "can&#39;t get alarm() to work more than twice", "body": "<pre><code>static void AlarmHandler(int sig) ;\nint i=0;\njmp_buf mark;\n\nint main(int argc, char * argv[]){\n setjmp(mark);\n signal(SIGALRM, AlarmHandler); \n alarm(2); \n while(1);\n return 0;\n}\n\nstatic void AlarmHandler(int sig) { \n  signal(SIGALRM, SIG_IGN);           \n  printf(\"I am in AlarmHandler:  %d \\n\",i);\n  i++;\n  longjmp(mark, 0);\n} \n</code></pre>\n\n<p>When I run this code the program goes through the AlarmHandler only once and then it just stays trapped inside the while loop. Can someone explain why?</p>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 5, "creation_date": 1519161697, "post_id": 48894393, "comment_id": 84794666, "body": "<code>top-&gt;value</code> is on <code>getUserInput()</code>&#39;s stack - you need to allocate memory for it... try using <code>strdup()</code>. Also, watch out because <code>scanf()</code> is not safe... try entering 40 characters."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519161921, "post_id": 48894393, "comment_id": 84794757, "body": "The <code>value</code> variable is only valid when <code>getUserInput</code> hasn&#39;t returned. Once this function returns, <code>top-&gt;value</code> points to an invalid location. Change your struct to have an array, <code>char value[20];</code> and the use <code>strncpy(newstackptr-&gt;value, val, sizeof newstackptr-&gt;value); newstackptr-&gt;value[sizeof(newstackptr-&gt;value) - 1] = 0;</code> instead."}, {"owner": {"reputation": 21, "user_id": 6367683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe0b247076168ab1cc28784355373d8?s=128&d=identicon&r=PG&f=1", "display_name": "akira kato", "link": "https://stackoverflow.com/users/6367683/akira-kato"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519164150, "post_id": 48894393, "comment_id": 84795713, "body": "@Pablo So replace char <i>value; with char value[20]; and replace the inside of push() with  struct v</i> newstackptr=malloc(sizeof(*newstackptr)); newstackptr-&gt;next = top; strncpy(newstackptr-&gt;value, val, sizeof newstackptr-&gt;value);  newstackptr-&gt;value[sizeof(newstackptr-&gt;value) - 1] = 0; newstackptr-&gt;ibase= ibas; newstackptr-&gt;obase= obas; top = newstackptr;"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519168821, "post_id": 48894393, "comment_id": 84797334, "body": "Sorry, the comment section is not meant for to much code without backticks, edit your question and post that in the question."}], "owner": {"reputation": 21, "user_id": 6367683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe0b247076168ab1cc28784355373d8?s=128&d=identicon&r=PG&f=1", "display_name": "akira kato", "link": "https://stackoverflow.com/users/6367683/akira-kato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "closed_date": 1519161772, "answer_count": 0, "score": 0, "last_activity_date": 1519161720, "creation_date": 1519161619, "last_edit_date": 1519161720, "question_id": 48894393, "link": "https://stackoverflow.com/questions/48894393/c-printf-for-string-prints-garbage-why", "closed_reason": "Duplicate", "title": "C printf for string prints garbage. Why?", "body": "<p>When I try to printf the value, which is a string, it does fine when it is in the push() function but when I run the same command in the main function, it prints garbage. For example if I enter A for the prompt \"Enter Value of number: \", I get A printed in the push() but garbage like ?P( from the main function. </p>\n\n<pre><code>struct v\n{\n    char *value;\n    int ibase;\n    int obase;\n    struct v* next;\n};\nstruct v* top = NULL;\n\nvoid push(char* val, int ibas, int obas)\n{\n    struct v* newstackptr=malloc(sizeof(*newstackptr));\n    newstackptr-&gt;next = top;\n    newstackptr-&gt;value= val;\n    printf(\"%s\",val);//&lt;-prints just fine\n    printf(\"\\n%s\", newstackptr-&gt;value);//&lt;-prints just fine\n    newstackptr-&gt;ibase= ibas;\n    newstackptr-&gt;obase= obas;\n    top = newstackptr;\n    printf(\"\\n%s\", top-&gt;value);//&lt;-prints just fine\n}\n\nvoid getUserInput(){\n    int ibase,obase;\n    printf(\"Enter Value of number: \");\n    char value[20];\n    scanf(\"%s\",value);\n    printf(\"\\nEnter the initial base: \");\n    scanf(\"%d\",&amp;ibase);\n    printf(\"\\nEnter the output base: \");\n    scanf(\"%d\",&amp;obase);\n    printf(\"\\n\");\n    push(value,ibase,obase);\n}\nchar* getValue(){\n    return top-&gt;value;\n}\nint main(){\n    getUserInput();\n    printf(\"%s\",top-&gt;value);//&lt;-this returns garbage\n    printf(\"%s\",getValue());//&lt;-this returns garbage\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["javascript", "c", "file", "web", "output"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1519161538, "post_id": 48894269, "comment_id": 84794594, "body": "How are we supposed to help you when you don&#39;t show us how the files are written? They could be in any of a 1000 formats, or none at all."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1519161619, "post_id": 48894269, "comment_id": 84794627, "body": "Little detail given, but Javascript won&#39;t allow you to open files if they don&#39;t &quot;belong&quot;. Otherwise a Javascript in a web page could read your whole drive. It&#39;s a security issue."}, {"owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "edited": false, "score": 1, "creation_date": 1519161735, "post_id": 48894269, "comment_id": 84794683, "body": "This is an <a href=\"https://meta.stackexchange.com/a/66378/369817\">XY problem</a>."}, {"owner": {"reputation": 5298, "user_id": 4241278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53f687af42c3e779a0f2ee98d5fe3bb4?s=128&d=identicon&r=PG", "display_name": "deamentiaemundi", "link": "https://stackoverflow.com/users/4241278/deamentiaemundi"}, "edited": false, "score": 0, "creation_date": 1519161951, "post_id": 48894269, "comment_id": 84794771, "body": "Several common browsers support <code>FileReader</code> (fro example Mozilla: <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/FileReader\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/API/FileReader</a> but not IE, as it seems)"}, {"owner": {"reputation": 1728, "user_id": 8331815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f14851208419c4973d3a75f344780abf?s=128&d=identicon&r=PG&f=1", "display_name": "SourceOverflow", "link": "https://stackoverflow.com/users/8331815/sourceoverflow"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519162694, "post_id": 48894269, "comment_id": 84795079, "body": "@WeatherVane He could use Node.js and run a local server that has access to these files. (in that case use the module \u2018fs\u2018 and maybe a filewatcher)"}], "answers": [{"comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1519252039, "post_id": 48896590, "comment_id": 84839598, "body": "Server-side Javascript has full filesystem access. Javascript isn&#39;t just for browsers anymore."}, {"owner": {"reputation": 1, "user_id": 9388490, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ken Neumann", "link": "https://stackoverflow.com/users/9388490/ken-neumann"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1519260694, "post_id": 48896590, "comment_id": 84842291, "body": "@LeeDanielCrocker Yeah, PHP its just a suggestion."}], "tags": [], "owner": {"reputation": 1, "user_id": 9388490, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ken Neumann", "link": "https://stackoverflow.com/users/9388490/ken-neumann"}, "is_accepted": false, "score": 0, "last_activity_date": 1519174328, "creation_date": 1519174328, "answer_id": 48896590, "question_id": 48894269, "link": "https://stackoverflow.com/questions/48894269/reading-c-programs-output-files-in-javascript/48896590#48896590", "title": "Reading C program&#39;s output files in javascript", "body": "<p>You can't read it in JavaScript because it doesn't have access to whatever is in your filesystem, so you could either make your C program output the files with HTML markup and append to the same HTML file or put your web app on a server and use a backend technology (like Apache &amp; PHP) to interpret those files and display them however you want.</p>\n"}], "owner": {"reputation": 1, "user_id": 9385144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/667c5d5085834093ab9dc5d78411bb09?s=128&d=identicon&r=PG&f=1", "display_name": "sheli", "link": "https://stackoverflow.com/users/9385144/sheli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1519174328, "creation_date": 1519161059, "question_id": 48894269, "link": "https://stackoverflow.com/questions/48894269/reading-c-programs-output-files-in-javascript", "title": "Reading C program&#39;s output files in javascript", "body": "<p>I'm trying to connect two programs I wrote- one is a c program that outputs files to my local disk and the other is a web program that's supposed to show the content of this files on screen by reading them from my disk. I've tried different methods to read those files but it all failed. Any help and suggestions will be appriciated. </p>\n"}, {"tags": ["c", "bootloader", "u-boot"], "comments": [{"owner": {"reputation": 26, "user_id": 9334960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-z9iGJQBqWZQ/AAAAAAAAAAI/AAAAAAAAABs/KLzWlRNv5zk/photo.jpg?sz=128", "display_name": "shaikh kamal", "link": "https://stackoverflow.com/users/9334960/shaikh-kamal"}, "edited": false, "score": 0, "creation_date": 1519451314, "post_id": 48894245, "comment_id": 84926180, "body": "Problem is that I should copy the u-boot image from the eMMC flash to DDR location at 0x60000000. We need CMD17 which will read the no of blocks from the emmc flash and copy to DDR, since I&#39;m hard coded this CMD17, I should not do this. Still I need inputs from the expert ."}, {"owner": {"reputation": 26, "user_id": 9334960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-z9iGJQBqWZQ/AAAAAAAAAAI/AAAAAAAAABs/KLzWlRNv5zk/photo.jpg?sz=128", "display_name": "shaikh kamal", "link": "https://stackoverflow.com/users/9334960/shaikh-kamal"}, "edited": false, "score": 0, "creation_date": 1525167600, "post_id": 48894245, "comment_id": 87245536, "body": "Problem is resolved,   since struct image_header *header;       header = (struct image_header *)(CONFIG_SYS_TEXT_BASE -  sizeof(struct image_header));, now header is pointing to (0x600000000 -0x0000040) =0x5FFFFFC0, SPL copied the u-boot data to DDR location 0x5FFFFFC0, system will start u-boot at DDR location 0x600000000 i.e u-boot header is 64 bytes and actual u-boot data present at 0x600000000. header(64 bytes)[0x5FFFFFC0 + data[0x600000000], able to get u-boot console"}], "owner": {"reputation": 26, "user_id": 9334960, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-z9iGJQBqWZQ/AAAAAAAAAAI/AAAAAAAAABs/KLzWlRNv5zk/photo.jpg?sz=128", "display_name": "shaikh kamal", "link": "https://stackoverflow.com/users/9334960/shaikh-kamal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2043, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519450935, "creation_date": 1519160979, "last_edit_date": 1519450935, "question_id": 48894245, "link": "https://stackoverflow.com/questions/48894245/booting-u-boot-from-emmc-flash", "title": "Booting u-boot from eMMc flash", "body": "<p>I would like to boot an U-boot image from eMMC flash user data partition, done some changes in spl(second program loader) of u-boot source code to add this support I mean <strong>fsbl</strong>(First stage boot loader) load the u-boot image from emmc flash to DRAM and boot from there and should get the u-boot prompt.</p>\n\n<p>Before this initialise the eMMC user-data partition and U-boot load and start at specific address defined by <strong>CONFIG_SYS_TEXT_BASE</strong>=0x60000000. Using flashing tool able to flash the u-boot image into emmc user-data partition.</p>\n\n<p>Able to see the u-boot contents at memory location 0x60000000 in memory window of ds5 with help of jtag with simple application which will read the data from the emmc flash to DDR location 0x60000000. \n<strong>My doubt:</strong> Do we need to copy u-boot image from emmc userdata flash to DRAM location 0x60000000? </p>\n\n<p><strong>2nd Doubt:</strong></p>\n\n<p>I modified below code to make the fsbl load the u-boot image from eMMC flash to DRAM and boot from there.</p>\n\n<pre><code>spl_mmc_load_image(struct spl_image_info *spl_image,\n                       struct spl_boot_device *bootdev)\n{\n        struct mmc *mmc = NULL;\n        u32 boot_mode;\n        int err = 0;\n        __maybe_unused int part;\n\n        err = spl_mmc_find_device(&amp;mmc, bootdev-&gt;boot_device);\n        if (err)\n                return err;\n\n        err = mmc_init(mmc);\n        if (err) {\n#ifdef CONFIG_SPL_LIBCOMMON_SUPPORT\n                printf(\"spl: mmc init failed with error: %d\\n\", err);\n#endif\n                return err;\n        }\n\n        boot_mode = spl_boot_mode(bootdev-&gt;boot_device);\n        err = -EINVAL;\n        switch (boot_mode) {\n        case MMCSD_MODE_EMMCBOOT:\n                        /*\n                         * We need to check what the partition is configured to.\n                         * 1 and 2 match up to boot0 / boot1 and 7 is user data\n                         * which is the first physical partition (0).\n                         */\n                        part = (mmc-&gt;part_config &gt;&gt; 3) &amp; PART_ACCESS_MASK;\n\n                        if (part == 7)\n                                part = 0;\n\n                        if (CONFIG_IS_ENABLED(MMC_TINY))\n                                err = mmc_switch_part(mmc, part);\n                        else\n                 err = blk_dselect_hwpart(mmc_get_blk_desc(mmc), part);\n\n                        if (err) {\n#ifdef CONFIG_SPL_LIBCOMMON_SUPPORT\n                                puts(\"spl: mmc partition switch failed\\n\");\n#endif\n                                return err;\n                        }\n                        /* Fall through */\n        case MMCSD_MODE_RAW:\n                debug(\"spl: mmc boot mode: raw\\n\");\n\n                if (!spl_start_uboot()) {\n                        err = mmc_load_image_raw_os(spl_image, mmc);\n                        if (!err)\n                                return err;\n                }\n\n                err = mmc_load_image_raw_partition(spl_image, mmc,\n                        CONFIG_SYS_MMCSD_RAW_MODE_U_BOOT_PARTITION);\n                if (!err)\n                        return err;\n#ifdef CONFIG_SYS_MMCSD_RAW_MODE_U_BOOT_USE_SECTOR\n                err = mmc_load_image_raw_sector(spl_image, mmc,\n                        CONFIG_SYS_MMCSD_RAW_MODE_U_BOOT_SECTOR);\n                if (!err)\n                        return err;\n\n}\n</code></pre>\n\n<p>Inside this function: mmc_load_image_raw_sector() under u-boot-src/common/spl/spl_mmc.c  </p>\n\n<pre><code>   count = blk_dread(mmc_get_blk_desc(mmc), sector, 1, header);\n</code></pre>\n\n<p>count is always zero . \n       Interanlly blk_dread is calling the CMD16(set the block length) and CMD17(Reading blocks) are failing.\n       For CMD16 set block lenght=512 and reading no of blocks= some no xxx manually gave to pass through the count value.\n       My main intention fsbl load the u-boot and booting , get the u-boot prompt.\n       Finally reached to below code under u-boot-src/common/spl/spl_mmc.c</p>\n\n<pre><code>    debug(\"loaded - jumping to U-Boot...\");\n    spl_board_prepare_for_boot();\n    jump_to_image_no_args(&amp;spl_image);\n\n    After this fsbl reseting .....\n</code></pre>\n\n<p><strong>3rd doubt:</strong></p>\n\n<p>Can I use this code for copying u-boot image from emmc flash to RAM, which is preset in u-boot source?</p>\n\n<pre><code>    function name void copy_uboot_to_ram(void)\n</code></pre>\n\n<p>present under arch/arm/mach-exynos/spl_boot.c</p>\n\n<pre><code>ifdef CONFIG_SUPPORT_EMMC_BOOT\n        case BOOT_MODE_EMMC:\n                /* Set the FSYS1 clock divisor value for EMMC boot */\n                emmc_boot_clk_div_set();\n\n                copy_bl2_from_emmc = get_irom_func(EMMC44_INDEX);\n                end_bootop_from_emmc = get_irom_func(EMMC44_END_INDEX);\n\n                copy_bl2_from_emmc(BL2_SIZE_BLOC_COUNT, CONFIG_SYS_TEXT_BASE);\n                end_bootop_from_emmc();\n                break;\n</code></pre>\n"}, {"tags": ["c", "visual-studio-2017"], "comments": [{"owner": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 0, "creation_date": 1519161148, "post_id": 48894212, "comment_id": 84794381, "body": "libpthread is typically for *nix. Did you find a Windows version?"}, {"owner": {"reputation": 7927, "user_id": 5214807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aq31b.jpg?s=128&g=1", "display_name": "Saleem", "link": "https://stackoverflow.com/users/5214807/saleem"}, "edited": false, "score": 2, "creation_date": 1519161264, "post_id": 48894212, "comment_id": 84794439, "body": "pthread is for Linux POSIX threads and is not bundled with Visual Studio. If you are looking to create threads on windows, look for <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms682453(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a> or use OpenMP"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3340067"}, "edited": false, "score": 0, "creation_date": 1519170197, "post_id": 48894212, "comment_id": 84797750, "body": "If you want to sort of avoid this problem, you should be able to use a Linux VM."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 9387929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc7ea002fd032252d762367ddbd6875?s=128&d=identicon&r=PG&f=1", "display_name": "Jbags", "link": "https://stackoverflow.com/users/9387929/jbags"}, "edited": false, "score": 0, "creation_date": 1519162955, "post_id": 48894513, "comment_id": 84795186, "body": "Maybe I&#39;m just dumb, but I can&#39;t seem to be able to download anything from <a href=\"ftp://sourceware.org/pub/pthreads-win32/\" rel=\"nofollow noreferrer\">sourceware.org/pub/pthreads-win32</a>  I can click on everything, but not able to download the zips."}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "reply_to_user": {"reputation": 133, "user_id": 9387929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc7ea002fd032252d762367ddbd6875?s=128&d=identicon&r=PG&f=1", "display_name": "Jbags", "link": "https://stackoverflow.com/users/9387929/jbags"}, "edited": false, "score": 0, "creation_date": 1519165296, "post_id": 48894513, "comment_id": 84796157, "body": "<a href=\"ftp://sourceware.org/pub/pthreads-win32/pthreads-w32-2-9-1-release.zip\" rel=\"nofollow noreferrer\">sourceware.org/pub/pthreads-win32/&hellip;</a> works for me."}], "tags": [], "owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "is_accepted": true, "score": 3, "last_activity_date": 1519162114, "creation_date": 1519162114, "answer_id": 48894513, "question_id": 48894212, "link": "https://stackoverflow.com/questions/48894212/visual-studio-2017-how-to-make-include-pthread-h-work/48894513#48894513", "title": "Visual Studio 2017, How to make #include &lt;pthread.h&gt; work?", "body": "<p>Windows doesn't natively support pthreads.</p>\n\n<p>There is <a href=\"https://sourceware.org/pthreads-win32/\" rel=\"nofollow noreferrer\">an implementation of pthreads for Windows</a> you could use. If you're just trying to get some code running on Windows ASAP it may be your best bet.</p>\n\n<p>If you can modify the code, you might want to take a look at what pthread functions you are actually using; if all you need is a mutex a few #ifdefs around pthreads/winapi may be a better way to go.</p>\n\n<p>There are also some projects which implement compatibility layers that aren't as expressive as the full pthreads API, but are more than enough for most projects. <a href=\"https://tinycthread.github.io/\" rel=\"nofollow noreferrer\">TinyCThread</a> is one option (which I maintain, so take the recommendation with a grain of salt) which implements the C11 threads API.</p>\n\n<p>Other options include:</p>\n\n<ul>\n<li><a href=\"https://developer.gnome.org/glib/stable/glib-Threads.html\" rel=\"nofollow noreferrer\">GLib</a></li>\n<li><a href=\"http://docs.libuv.org/en/v1.x/guide/threads.html\" rel=\"nofollow noreferrer\">libuv</a></li>\n</ul>\n\n<p><a href=\"http://www.openmp.org/\" rel=\"nofollow noreferrer\">OpenMP</a> could also be a good choice. It is really easy to use, but operates at a higher level and so it may require a more substantial rewrite.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 9844608, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hRT2CheXJJQ/AAAAAAAAAAI/AAAAAAAALgU/_lTNNcSHe1w/photo.jpg?sz=128", "display_name": "Manoj M", "link": "https://stackoverflow.com/users/9844608/manoj-m"}, "is_accepted": false, "score": 5, "last_activity_date": 1527221993, "creation_date": 1527221993, "answer_id": 50521497, "question_id": 48894212, "link": "https://stackoverflow.com/questions/48894212/visual-studio-2017-how-to-make-include-pthread-h-work/50521497#50521497", "title": "Visual Studio 2017, How to make #include &lt;pthread.h&gt; work?", "body": "<p>For Visual Studio 2017, I've installed through NuGet Packages.</p>\n\n<p>Try below steps,</p>\n\n<ol>\n<li>Go to Project > 'Manage NuGet Packages'</li>\n<li>Browse > search for 'pthread' > install</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 1647, "user_id": 5715298, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SGJRF.jpg?s=128&g=1", "display_name": "Anatoly Strashkevich", "link": "https://stackoverflow.com/users/5715298/anatoly-strashkevich"}, "edited": false, "score": 2, "creation_date": 1549096188, "post_id": 53011807, "comment_id": 95788495, "body": "this is fastest way"}, {"owner": {"reputation": 261, "user_id": 2711095, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/7368af136f81aa20f9dce82e3566478a?s=128&d=identicon&r=PG&f=1", "display_name": "TraceKira", "link": "https://stackoverflow.com/users/2711095/tracekira"}, "edited": false, "score": 1, "creation_date": 1553942303, "post_id": 53011807, "comment_id": 97579007, "body": "I get an error &quot;1&gt;c:\\users\\timo\\source\\repos\\consoleapplication1\\packages\\p&zwnj;&#8203;threads.2.9.1.4\\buil&zwnj;&#8203;d\\native\\include\\pth&zwnj;&#8203;read.h(320): error C2011: &#39;timespec&#39;: &#39;struct&#39; type redefinition 1&gt;c:\\program files (x86)\\windows kits\\10\\include\\10.0.17763.0\\ucrt\\time.h(39): note: see declaration of &#39;timespec&#39;&quot;"}, {"owner": {"reputation": 1234, "user_id": 1800813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fb3a8592a129e3d4d61d0e6849ad625c?s=128&d=identicon&r=PG", "display_name": "David Gausmann", "link": "https://stackoverflow.com/users/1800813/david-gausmann"}, "reply_to_user": {"reputation": 261, "user_id": 2711095, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/7368af136f81aa20f9dce82e3566478a?s=128&d=identicon&r=PG&f=1", "display_name": "TraceKira", "link": "https://stackoverflow.com/users/2711095/tracekira"}, "edited": false, "score": 0, "creation_date": 1587401041, "post_id": 53011807, "comment_id": 108491744, "body": "@TraceKira I got the same error. There seems to be a bug in pthread.h. If you make a comment out of that specification there, everything is fine again."}], "tags": [], "owner": {"reputation": 665, "user_id": 8118046, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5tkLVmtXla0/AAAAAAAAAAI/AAAAAAAADg0/et3EKKpsdvw/photo.jpg?sz=128", "display_name": "Bala Ganesh", "link": "https://stackoverflow.com/users/8118046/bala-ganesh"}, "is_accepted": false, "score": 25, "last_activity_date": 1540577265, "last_edit_date": 1540577265, "creation_date": 1540567241, "answer_id": 53011807, "question_id": 48894212, "link": "https://stackoverflow.com/questions/48894212/visual-studio-2017-how-to-make-include-pthread-h-work/53011807#53011807", "title": "Visual Studio 2017, How to make #include &lt;pthread.h&gt; work?", "body": "<p>In Visual Studio 2017</p>\n\n<ol>\n<li><p>Project -> Manage Nuget Packages</p></li>\n<li><p>In browse Tab search for 'pthread'</p></li>\n<li><p>Select Install[Search Results in Nuget packages]</p></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/KHtuH.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/KHtuH.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 459, "user_id": 1823476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73cbbfd5b03884ffa9b83035cc0cd80?s=128&d=identicon&r=PG", "display_name": "chrset", "link": "https://stackoverflow.com/users/1823476/chrset"}, "is_accepted": false, "score": 3, "last_activity_date": 1580314502, "creation_date": 1580314502, "answer_id": 59971257, "question_id": 48894212, "link": "https://stackoverflow.com/questions/48894212/visual-studio-2017-how-to-make-include-pthread-h-work/59971257#59971257", "title": "Visual Studio 2017, How to make #include &lt;pthread.h&gt; work?", "body": "<p>If you have <em>vcpkg</em> installed, then you can just do:</p>\n\n<pre><code>vcpkg.exe install pthread\n</code></pre>\n\n<p>That will download some code from <a href=\"https://sourceforge.net/projects/pthreads4w\" rel=\"nofollow noreferrer\">https://sourceforge.net/projects/pthreads4w</a>, compile it and install it in your system. If <em>vcpkg</em> is setup correctly on your machine, Visual Studio should use these files automatically.</p>\n"}], "owner": {"reputation": 133, "user_id": 9387929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc7ea002fd032252d762367ddbd6875?s=128&d=identicon&r=PG&f=1", "display_name": "Jbags", "link": "https://stackoverflow.com/users/9387929/jbags"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32894, "favorite_count": 5, "accepted_answer_id": 48894513, "answer_count": 4, "score": 13, "last_activity_date": 1580314502, "creation_date": 1519160813, "last_edit_date": 1519160901, "question_id": 48894212, "link": "https://stackoverflow.com/questions/48894212/visual-studio-2017-how-to-make-include-pthread-h-work", "title": "Visual Studio 2017, How to make #include &lt;pthread.h&gt; work?", "body": "<p>I feel like I've been searching for hours today on how to make <code>#include &lt;pthread.h&gt;</code> work in Visual Studio 2017 on Windows 10 and haven't come across an answer that has worked. Can someone please instruct me how to get this to work? </p>\n\n<p>The error I receive is: cannot open source file \"pthread.h\"</p>\n"}, {"tags": ["c", "gcc", "arm", "alignment"], "answers": [{"comments": [{"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 1, "creation_date": 1519161357, "post_id": 48894312, "comment_id": 84794491, "body": "I think you mean <code>uint64_t* s_u64 = ...</code> (missing *)."}], "tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": true, "score": 5, "last_activity_date": 1519164483, "last_edit_date": 1519164483, "creation_date": 1519161274, "answer_id": 48894312, "question_id": 48894189, "link": "https://stackoverflow.com/questions/48894189/getting-around-cast-increases-required-alignment-order-message/48894312#48894312", "title": "Getting around &quot;cast increases required alignment order&quot; message", "body": "<pre><code>uint64_t *s_u64 = calloc( (max_sa_len + sizeof(uint64_t) - 1) / sizeof(uint64_t), \n    sizeof(uint64_t));\ns = s_u64; // if you need to address by byte as well \n...\ns_u64[1] = hton64(val &amp; 0xffff);\n</code></pre>\n"}], "owner": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 951, "favorite_count": 1, "accepted_answer_id": 48894312, "answer_count": 1, "score": 4, "last_activity_date": 1519164483, "creation_date": 1519160706, "question_id": 48894189, "link": "https://stackoverflow.com/questions/48894189/getting-around-cast-increases-required-alignment-order-message", "title": "Getting around &quot;cast increases required alignment order&quot; message", "body": "<p>I have some code which looks similar to the following:</p>\n\n<pre><code>void somefunc(uint64_t val) {\n    uint8_t *p;\n    uint8_t *s;\n\n    s = calloc( (max_sa_len + sizeof(uint64_t) - 1) / sizeof(uint64_t), sizeof(uint64_t));\n    // s must be 8 byte aligned here\n    p = (s + sizeof(uint64_t)); \n    // p must be 8 byte aligned here\n\n    *(uint64_t)*p = hton64(val &amp; 0xffff);\n...\n}\n</code></pre>\n\n<p>And when I compile I get:</p>\n\n<pre><code>file.c:400:10: error: cast increases required alignment of target type [-Werror=cast-align]\n</code></pre>\n\n<p>Is there a clean way to get around this warning?   <code>s</code>, and therefore <code>p</code> <em>must</em> be aligned to 64 bit addresses, this it's not a real error.  I tried adding a <code>p=__builtin_assume_alinged(p,8);</code> to the code but it did not fix the error. \nI'm getting this error with an arm32 (v7) gcc cross compiler, v 4.7.0</p>\n"}, {"tags": ["string", "arrays", "c"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 3, "creation_date": 1519162285, "post_id": 48894514, "comment_id": 84794912, "body": "what types are <code>a</code> and <code>b</code>? <code>int</code>?"}, {"owner": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 0, "creation_date": 1519162401, "post_id": 48894514, "comment_id": 84794978, "body": "declare <code>a</code> and <code>b</code> as <code>char a, b;</code>"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1519162996, "post_id": 48894514, "comment_id": 84795206, "body": "Your first line is not valid C, and this is not a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1519163061, "post_id": 48894514, "comment_id": 84795234, "body": "@usr2564301: Its perfectly valid in C, just obsolescent."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1519164266, "post_id": 48894514, "comment_id": 84795760, "body": "Well, my C compiler rejects it out of hand \u2013 and when explicitly declaring it an <code>int</code>, it spits out lots of additional errors (something something <i>incompatible pointer type</i>)."}], "answers": [{"comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1519164294, "post_id": 48894701, "comment_id": 84795766, "body": "Should you not precise that a <i>missing</i> type here in a declaration makes it default to <code>int</code>? (And then only in compilers old enough to not mark this as an error...)"}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 1, "last_activity_date": 1519162981, "creation_date": 1519162981, "answer_id": 48894701, "question_id": 48894514, "link": "https://stackoverflow.com/questions/48894514/problem-in-printing-specific-character-of-an-array-after-using-strcat-function/48894701#48894701", "title": "Problem in printing specific character of an array after using strcat() function", "body": "<p>The problem is that you've declared <code>a</code> and <code>b</code> as <code>int</code> arrays, but you're using them as <code>char</code> arrays.  This <em>should</em> give you a warning from your compiler (always use -Wall or the equivalent on you compiler and pay attention to the warnings).</p>\n\n<p>The fix is simple; declare them as <code>char</code>:</p>\n\n<pre><code>char a[80000], b[40000];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "is_accepted": true, "score": 2, "last_activity_date": 1519165768, "creation_date": 1519165768, "answer_id": 48895280, "question_id": 48894514, "link": "https://stackoverflow.com/questions/48894514/problem-in-printing-specific-character-of-an-array-after-using-strcat-function/48895280#48895280", "title": "Problem in printing specific character of an array after using strcat() function", "body": "<p>The reason for your printout is that the compiler treats <code>a</code> and <code>b</code> as an integer arrays since you have not specified the type. Older compilers would let you go away with it and default the type to <code>int</code>. </p>\n\n<p>So you effectively declared <code>int a[80000]; int b[40000];</code> For your program to work as you expected you should declare them with <code>char</code> type:</p>\n\n<pre><code>char a[80000], b[40000];\n</code></pre>\n\n<p>Now explanation for your <strong>\"LVE\"</strong> output. This is actually quite logical.\nYou have to understand how your array <code>a</code> sits in the memory:</p>\n\n<pre><code> LORD VOLD EMOR T\\0\n 1234 1234 1234 12??\n a[0] a[1] a[2] a[4]\n</code></pre>\n\n<p>The explanation follows:</p>\n\n<p>Every element of <code>a</code> is an <code>int</code> which occupies 4 bytes in the memory. You initialized the <code>ints</code> with the characters (your letters). Every <code>int</code> 'consumed' <code>4</code> characters.</p>\n\n<p>Since you are not printing <code>a[0]</code> as <code>int</code> but you use <code>%c</code> so <code>printf</code> takes just first BYTE out of <code>a[0]</code> and prints <code>L</code>.</p>\n\n<p><code>a[1]</code> starts in memory from <code>V</code> so <code>V</code> would be printed.</p>\n\n<p><code>a[2]</code> starts in memory from <code>E</code> so <code>E</code> would be printed.</p>\n\n<p>I hope it helps.</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://computerscience.stackexchange.com"], "markdown_extensions": ["MathJax", "Prettify"], "launch_date": 1439905020, "open_beta_date": 1332272936, "closed_beta_date": 1331060400, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/cs/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/cs/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/cs/Img/apple-touch-icon.png", "audience": "students, researchers and practitioners of computer science", "site_url": "https://cs.stackexchange.com", "api_site_parameter": "cs", "logo_url": "https://cdn.sstatic.net/Sites/cs/Img/logo.png", "name": "Computer Science", "site_type": "main_site"}, "on_date": 1519162117, "question_id": 88358}, "owner": {"reputation": 13, "user_id": 8843232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XnM0e.jpg?s=128&g=1", "display_name": "imreverse", "link": "https://stackoverflow.com/users/8843232/imreverse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 48895280, "answer_count": 2, "score": 0, "last_activity_date": 1519165768, "creation_date": 1519160448, "question_id": 48894514, "link": "https://stackoverflow.com/questions/48894514/problem-in-printing-specific-character-of-an-array-after-using-strcat-function", "title": "Problem in printing specific character of an array after using strcat() function", "body": "<pre><code>    a[80000], b[40000];\n    scanf(\"%s %s\", a, b);\n    strcat(a,b);\n    printf(\"%c%c%c\", a[0], a[1], a[2]);\n</code></pre>\n\n<p>Let's say if I input <em>a</em> = \"<strong>LORD</strong>\" and <em>b</em> = \"<strong>VOLDEMORT</strong>\" (without quotes), and concatenated both strings, to make \"<strong>LORDVOLDEMORT</strong>\".\nThen, I would like to print first 3 characters from the concatenated string. So, in my opninion, the output result should be, \"<strong>LOR</strong>\" <em>(first 3 characters of the concatenated string)</em>, on the otherhand the result my compiler is showing is, \"<strong>LVE</strong>\".\nWhere am I wrong?\nI'm new to the C language.</p>\n"}, {"tags": ["c++", "c", "arrays"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1519160386, "post_id": 48894106, "comment_id": 84794003, "body": "What do you expect the values to be?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1519160403, "post_id": 48894106, "comment_id": 84794013, "body": "As local (automatic) variables defined in a function: neither is initialised."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 4, "creation_date": 1519160414, "post_id": 48894106, "comment_id": 84794022, "body": "You have not initialized array."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 5, "creation_date": 1519160443, "post_id": 48894106, "comment_id": 84794038, "body": "C or C++? The latter doesn&#39;t even have variable-length arrays."}, {"owner": {"reputation": 5781, "user_id": 8746007, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Wr8CIbEqJ4w/AAAAAAAAAAI/AAAAAAAAAFE/Ym-NjswzViM/photo.jpg?sz=128", "display_name": "Killzone Kid", "link": "https://stackoverflow.com/users/8746007/killzone-kid"}, "edited": false, "score": 3, "creation_date": 1519160485, "post_id": 48894106, "comment_id": 84794063, "body": "You are not initialising array, what you see is leftover garbage"}, {"owner": {"reputation": 27, "user_id": 7657088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fded2fa9dd6f1f8450e44e1d5bd50e2a?s=128&d=identicon&r=PG&f=1", "display_name": "irrelevent", "link": "https://stackoverflow.com/users/7657088/irrelevent"}, "edited": false, "score": 0, "creation_date": 1519160503, "post_id": 48894106, "comment_id": 84794071, "body": "im using c++ and g++ compiler"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1519160506, "post_id": 48894106, "comment_id": 84794072, "body": "Also note that variable length arrays can&#39;t be initialized. You can assign values to the array elements using loop of <code>memset</code> function. And VLAs are not supported in C++."}, {"owner": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "edited": false, "score": 1, "creation_date": 1519160552, "post_id": 48894106, "comment_id": 84794096, "body": "How does the first one even compile on c++? It would have to be a const int"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "edited": false, "score": 0, "creation_date": 1519160675, "post_id": 48894106, "comment_id": 84794150, "body": "@Zebrafish the added code suggests it is C++."}, {"owner": {"reputation": 27, "user_id": 7657088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fded2fa9dd6f1f8450e44e1d5bd50e2a?s=128&d=identicon&r=PG&f=1", "display_name": "irrelevent", "link": "https://stackoverflow.com/users/7657088/irrelevent"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 0, "creation_date": 1519160804, "post_id": 48894106, "comment_id": 84794212, "body": "@juanchopanza the 2nd one is correct"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1519160869, "post_id": 48894106, "comment_id": 84794246, "body": "@irrelevent Why is it correct?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1519160920, "post_id": 48894106, "comment_id": 84794266, "body": "The first loop (in the &quot;edit&quot; code) starts with <code>i</code> and the second loop starts at <code>0</code>. That will use uninitialized entries in the array unless <code>i</code> is 0."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1519160967, "post_id": 48894106, "comment_id": 84794290, "body": "<a href=\"http://en.cppreference.com/w/c/language/array_initialization\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/language/array_initialization</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2486888"}, "edited": false, "score": 0, "creation_date": 1519173371, "post_id": 48894106, "comment_id": 84798582, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/31739792/is-uninitialized-local-variable-the-fastest-random-number-generator\">Is uninitialized local variable the fastest random number generator?</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2486888"}, "edited": false, "score": 0, "creation_date": 1519173438, "post_id": 48894106, "comment_id": 84798598, "body": "Also: <a href=\"https://stackoverflow.com/questions/1887097/why-arent-variable-length-arrays-part-of-the-c-standard\" title=\"why arent variable length arrays part of the c standard\">stackoverflow.com/questions/1887097/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1519160683, "post_id": 48894177, "comment_id": 84794152, "body": "Note that you can&#39;t initialize VLAs."}, {"owner": {"reputation": 27, "user_id": 7657088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fded2fa9dd6f1f8450e44e1d5bd50e2a?s=128&d=identicon&r=PG&f=1", "display_name": "irrelevent", "link": "https://stackoverflow.com/users/7657088/irrelevent"}, "edited": false, "score": 0, "creation_date": 1519160705, "post_id": 48894177, "comment_id": 84794163, "body": "i edited my post im initializing the array in the loop later on"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 27, "user_id": 7657088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fded2fa9dd6f1f8450e44e1d5bd50e2a?s=128&d=identicon&r=PG&f=1", "display_name": "irrelevent", "link": "https://stackoverflow.com/users/7657088/irrelevent"}, "edited": false, "score": 0, "creation_date": 1519160750, "post_id": 48894177, "comment_id": 84794190, "body": "@irrelevent; That&#39;s called assignment, not initialization."}, {"owner": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "edited": false, "score": 0, "creation_date": 1519161062, "post_id": 48894177, "comment_id": 84794336, "body": "Are arrays defined in the global namespace zero initalised like all other variables?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 8834, "user_id": 4696802, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/AkVoc.jpg?s=128&g=1", "display_name": "Zebrafish", "link": "https://stackoverflow.com/users/4696802/zebrafish"}, "edited": false, "score": 0, "creation_date": 1519161127, "post_id": 48894177, "comment_id": 84794377, "body": "@Zebrafish If defined at file scope or <code>static</code>, then yes all array elements are zero initialized."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1519160641, "creation_date": 1519160641, "answer_id": 48894177, "question_id": 48894106, "link": "https://stackoverflow.com/questions/48894106/difference-between-initializing-an-array/48894177#48894177", "title": "Difference Between initializing an array", "body": "<p>In neither of your two cases is the array initialized.</p>\n\n<p>Without an explicit initializer, the contents of an array (or any variable) are <strong>indeterminate</strong>.  You can't predict what those values will be.  And if one of those values happens to be a trap representation, you invoke undefined behavior if you attempt to read that value.</p>\n\n<p>If you want your array to have a particular set of values to start, you need to set those values explicitly, either with an initializer or by assignment.</p>\n"}], "owner": {"reputation": 27, "user_id": 7657088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fded2fa9dd6f1f8450e44e1d5bd50e2a?s=128&d=identicon&r=PG&f=1", "display_name": "irrelevent", "link": "https://stackoverflow.com/users/7657088/irrelevent"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "closed_date": 1519177820, "answer_count": 1, "score": -4, "last_activity_date": 1533372081, "creation_date": 1519160314, "last_edit_date": 1533372081, "question_id": 48894106, "link": "https://stackoverflow.com/questions/48894106/difference-between-initializing-an-array", "closed_reason": "Not suitable for this site", "title": "Difference Between initializing an array", "body": "<p>I have been getting a weird output if I initialize an array using a variable instead of a constant\nthe two code below produces a different output for me.</p>\n\n<pre><code>int x =7;\nint arr[x];\n</code></pre>\n\n<p>and </p>\n\n<pre><code>int arr[7];\n</code></pre>\n\n<p>the first one generates this output </p>\n\n<pre><code>78  9  73  32  6422216  50  42\n</code></pre>\n\n<p>and the 2nd one</p>\n\n<pre><code>78  9  73  54  29  50  42\n</code></pre>\n\n<p>I need to use the size of an vector for the array size.\nI have tried making the variable constant but it doesn't makes a difference.</p>\n\n<p>edit\nusing the array here</p>\n\n<pre><code>int arr[size];\nfor(int j=i;j&lt;nums.size();j++)\n    arr[j+1]=nums[j];\narr[i]=nums[signs.size()];\nfor(int j=0;j&lt;nums.size();j++)\n    nums[j]=arr[j];\n</code></pre>\n"}, {"tags": ["c", "backslash"], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519159932, "post_id": 48893888, "comment_id": 84793752, "body": "Similarly for a string literal: <code>char s[] = &quot;one \\two&quot;;</code> with the <b>backslash</b> at the end of one line and the <b>two</b> at the start of the next line. Not as shown in comment where <code>\\t</code> would be a tab character."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519177956, "post_id": 48893888, "comment_id": 84799694, "body": "@WeatherVane: but that form of string literal became obsolete with C90 which allows string literals to be concatenated.  Such code has been obsolete for every single year of the current millennium \u2014 and arguably a good while longer."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 4, "last_activity_date": 1519159395, "creation_date": 1519159395, "answer_id": 48893888, "question_id": 48893862, "link": "https://stackoverflow.com/questions/48893862/backslash-meaning-in-the-c-context/48893888#48893888", "title": "backslash meaning in the C context", "body": "<p>A <code>#define</code> directive exists by default on a single line.  The backslashes are escaping the newline character at the end of the line so that the following line is included as part of the <code>#define</code>.</p>\n\n<p>So if you have this in your code:</p>\n\n<pre><code>timer_wait_us(timerNum, time)\n</code></pre>\n\n<p>It is replaced with:</p>\n\n<pre><code>timer_set_us(timerNum, time, 0);\ntimer_start(timerNum);\ntimer_wait(timerNum)\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9387816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2167a03d1352cdb9badf97a3779769fc?s=128&d=identicon&r=PG&f=1", "display_name": "Vencent", "link": "https://stackoverflow.com/users/9387816/vencent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1519159395, "creation_date": 1519159300, "last_edit_date": 1519159309, "question_id": 48893862, "link": "https://stackoverflow.com/questions/48893862/backslash-meaning-in-the-c-context", "title": "backslash meaning in the C context", "body": "<p>I am reading the C code related to the hardware. I didn't understand the backslash() in the context. what the relationship between the functions?</p>\n\n<pre><code>#define timer_wait_us(timerNum, time) \\\n        timer_set_us(timerNum, time, 0); \\\n        timer_start(timerNum); \\\n        timer_wait(timerNum)\n</code></pre>\n"}, {"tags": ["c", "arrays", "matrix", "memcpy"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519159503, "post_id": 48893797, "comment_id": 84793508, "body": "How do <code>malloc2D</code> and <code>malloc3D</code> work? Can you post them?  The problem I see, is that <code>memcpy</code> copies byte by byte the content from the location pointed to by <code>matrix2D</code> into the location pointed to by <code>matrix3D</code>. If <code>matrix3D[i]</code> and <code>matrix2d[j]</code> were initialized with a <code>malloc</code>, then you are 1. losing the pointer <code>matrix3D[i]</code> by overwriting with <code>matrix2D[j]</code>, you would end up with double free issues."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1519159603, "post_id": 48893797, "comment_id": 84793575, "body": "What is <code>malloc2D</code> and <code>malloc3D</code>? You are probably not allocating the size correctly. Ie: <code>sizeof(float)</code> instead of <code>sizeof(float **)</code>. Similarly <code>float* matrix1D = malloc(dim1*dim2*dim3);</code> is probably wrong. I don&#39;t see <code>sizeof(float)</code>."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1519159687, "post_id": 48893797, "comment_id": 84793625, "body": "just in general, keep in mind that runs with &quot;no segmentation faults&quot; doesn&#39;t mean all is well."}, {"owner": {"reputation": 51, "user_id": 6031103, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10207459856688331/picture?type=large", "display_name": "Ashley Gold", "link": "https://stackoverflow.com/users/6031103/ashley-gold"}, "edited": false, "score": 0, "creation_date": 1519161004, "post_id": 48893797, "comment_id": 84794307, "body": "I put the malloc functions up. Like I said, I was under the impression that they were right because they were given, but I wouldn&#39;t be surprised if they weren&#39;t."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1519171650, "post_id": 48893797, "comment_id": 84798140, "body": "This setup of contiguous allocation plus a pointer block is just a massive waste of memory, it&#39;s not any cheaper to follow a bunch of pointers than it is to do arithmetic to find the location"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1519178172, "post_id": 48893797, "comment_id": 84799749, "body": "Related to, but wholly separate from, <a href=\"https://stackoverflow.com/questions/48856272/modifying-function-that-mallocs-a-2d-array-to-a-3d-array-in-c\">Modifying function that mallocs a 2D array to a 3D array in C</a> \u2014 with the same OP."}], "answers": [{"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 2, "last_activity_date": 1519161528, "creation_date": 1519161528, "answer_id": 48894370, "question_id": 48893797, "link": "https://stackoverflow.com/questions/48893797/copy-a-2d-matrix-to-a-3d-matrix-using-memcpy-in-c/48894370#48894370", "title": "Copy a 2D matrix to a 3D matrix using memcpy in C", "body": "<p>The only way to use a single <code>memcpy</code> to copy a 2d array into a 3d array is if the data for each of the 2d and 3d arrays are flat in memory.</p>\n\n<p>The allocation functions you were provided show that the data for each are contiguous. Therefore, you need to copy the data section of the 2d array into the data section of the 3d array.</p>\n\n<p>Since the data is contiguous, it follows that the data section is located at the address of the first element of the arrays. Hence, the data section for the 2d array begins at <code>&amp;matrix2D[0][0]</code>, and the data section for the 3d array begins at <code>&amp;matrix3D[0][0][0]</code>. Given the semantics of array syntax, these expressions are the same as <code>matrix2D[0]</code> and <code>matrix3D[0][0]</code>, respectively.</p>\n\n<p>Assuming that <code>matrix1D</code> is initialized properly:</p>\n\n<pre><code>memcpy(matrix2D[0], matrix1D, dim1*dim2*dim3*sizeof(float));\nmemcpy(matrix3D[0][0], matrix2D[0], dim1*dim2*dim3*sizeof(float));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 6031103, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10207459856688331/picture?type=large", "display_name": "Ashley Gold", "link": "https://stackoverflow.com/users/6031103/ashley-gold"}, "edited": false, "score": 0, "creation_date": 1519188714, "post_id": 48895791, "comment_id": 84802136, "body": "Thank you for taking the time to explain this extensively. I understand what you mean about the void* pointer arithmetic, however I didn&#39;t change it because it was given and we are specifically asked not to mess with the given code.  This explanation helped me to understand allocation and freeing much better."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1519178074, "last_edit_date": 1519178074, "creation_date": 1519168765, "answer_id": 48895791, "question_id": 48893797, "link": "https://stackoverflow.com/questions/48893797/copy-a-2d-matrix-to-a-3d-matrix-using-memcpy-in-c/48895791#48895791", "title": "Copy a 2D matrix to a 3D matrix using memcpy in C", "body": "<p>I've seen this allocation code a couple of times, and I always point out that\nwhile it's a clever way of allocating space for double/triple pointers, you\nmight encounter problems when not used carefully.</p>\n\n<p>Let's take a look at <code>malloc2D</code>:</p>\n\n<pre><code>void** malloc2D(size_t rows, size_t cols, size_t sizeOfType){\n    void* block = malloc(sizeOfType * rows * cols);\n    void** matrix = malloc(sizeof(void*) * rows);\n    for (int row = 0; row &lt; rows; ++row) {\n        matrix[row] = block + cols * row * sizeOfType;\n    }//for\n    return matrix;\n}\n</code></pre>\n\n<p>Like I've pointed out before, <a href=\"https://stackoverflow.com/a/46238658/1480131\"><code>void*</code> pointer arithmetic is illegal</a> in C,\nGNU C has an extension for that. But let's assume this works as intended:</p>\n\n<p>The first <code>malloc</code> reserves <code>rows  * cols</code> spaces for objects of size\n<code>sizeOfType</code>. The second <code>malloc</code> reserves space for <code>rows</code> pointers. The memory\nlayout of this is (the arrows represent: pointer points to):</p>\n\n<p><img src=\"https://i.stack.imgur.com/85wHf.png\" alt=\"\"></p>\n\n<p>Note that <code>block</code> and <code>matrix</code> and different memory locations, the <code>matrix[i]</code>\n(<code>i</code>th row)\npoint to the start of a sequence at <code>block[j]</code> (start of a new colum, multiple\nof <code>cols</code>).</p>\n\n<p>The <code>malloc3D</code> is basically doing the same but multiple times (<code>depth</code> times).\nThe basic memory layout is is similar with one more layer of\npointers<sup>1</sup>:</p>\n\n<p><img src=\"https://i.stack.imgur.com/I4Bb3.png\" alt=\"\"></p>\n\n<p>Note that <code>block</code>, <code>matrix</code> and <code>matrix2</code> are different memory locations, the\n<code>matrix2[i]</code> point to the start of a sequence at <code>matrix[j]</code> and the\n<code>matrix[j]</code> points to the start of a sequence at <code>block[k]</code>.</p>\n\n<p>Now when you do:</p>\n\n<pre><code>memcpy(matrix3D, matrix2D, dim1*dim2*dim3*sizeof(float));\n</code></pre>\n\n<p>you are <strong>not</strong> copying the contents pointed to by <code>matrix2D</code> into the contents pointed\nto by <code>matrix3D</code>; the contents of <code>matrix2D</code> are not <code>float</code>s, they are\npointers! So you are in fact copying the pointers of <code>matrix2D</code> in <code>matrix3D</code>.\nThat will cause trouble because the pointers are not of the same type (see the\ngraphs): <code>matrix2D</code> pointers point to <code>float*</code> and <code>matrix3D</code> pointers point to\n<code>float**</code>, so when you dereference them, you will get wrong results, because you\nare dereferencing from incorrect addresses. As jxh points out in <a href=\"https://stackoverflow.com/a/48894370/1480131\">his/her answer</a>, this would\nonly work when the values are flat in memory, but they are not, even though\n<code>block</code> is flatt, but you are not accessing <code>block</code> directly, you are accessing\nit through pointers.</p>\n\n<p>That means that</p>\n\n<pre><code>free3D(matrix3D);\nfree2D(matrix2D);\n</code></pre>\n\n<p>will get you into trouble, because the first <code>free</code> does not free the memory\nreserved by <code>malloc3D</code>, as it has been overwritten by the <code>memcpy</code>. <code>free2D</code>\nwould attempt to free the same memory which you are not allowed to.</p>\n\n<p>You would have to go down to the <code>block</code> level and use <code>memcpy</code> there, for\nexample this is OK:</p>\n\n<pre><code>for(int i = 0; i &lt; rows; ++i)\n    memcpy(matrix3D[0][i], matrix2D[i], cols * sizeof(float));\n</code></pre>\n\n<hr>\n\n<p><strong>Fotenotes</strong></p>\n\n<p><sup>1</sup>Because of the limited space in the graph, I use <code>depth == 2</code>, so\nthat's why <code>matrix2+1</code> points to <code>matrix+2</code>.</p>\n"}], "owner": {"reputation": 51, "user_id": 6031103, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10207459856688331/picture?type=large", "display_name": "Ashley Gold", "link": "https://stackoverflow.com/users/6031103/ashley-gold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519178074, "creation_date": 1519158989, "last_edit_date": 1519160959, "question_id": 48893797, "link": "https://stackoverflow.com/questions/48893797/copy-a-2d-matrix-to-a-3d-matrix-using-memcpy-in-c", "title": "Copy a 2D matrix to a 3D matrix using memcpy in C", "body": "<p>I was instructed to copy all elements from my 2d array, <code>matrix2D</code>, to my 3d array <code>matrix3D</code> using a single <code>memcpy</code> command and then print out the 3d array (separating elements with a comma, rows with a semicolon and each 2d matrix with a new line). Before that, the program takes in user input for dimensions of the 3d matrix, and then all the data to go into the matrix (floats). My functions <code>malloc2d</code> and <code>malloc3d</code> are working correctly and I am getting no segmentation faults, but when I attempt to <code>memcpy</code> the data and then print the 3d matrix, nothing is printing. Here is the code:</p>\n\n<pre><code>#include \"utilities.h\"\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void){\n    unsigned int dim1,dim2,dim3;\n    printf(\"Dimensionality of 3-D matrix ===&gt;\");\n    scanf(\"%u\",&amp;dim1); //takes user input for dimensions\n    scanf(\"%u\",&amp;dim2); //takes user input for dimensions\n    scanf(\"%u\",&amp;dim3); //takes user input for dimensions\n\n    //allocating memory for 3d, 2d and 1d matrices\n    float*** matrix3D = malloc3D((unsigned int)(dim1), (unsigned int)(dim2), (unsigned int)(dim3), sizeof(float));\n    float** matrix2D = malloc2D(dim1, dim2*dim3, sizeof(float));\n    float* matrix1D = malloc(dim1*dim2*dim3);\n\n    for(int i = 0; i&lt;(dim1*dim2*dim3); i++){ //taking user input floats\n        fscanf(stdin, \"%f\", &amp;matrix1D[i]);\n    }//for\n\n    for(int i = 0; i&lt;(dim1*dim2*dim3); i++){//writing contents of 1d matrix to 2d matrix\n        matrix2D[i/(dim2*dim3)][i%(dim2*dim3)] = matrix1D[i];\n    }//for\n\n    for (int i = 0; i &lt; dim1; i++){//printing out 2d array as asked\n        for (int j = 0; j &lt; (dim2*dim3); j++){\n            printf(\"%0.2f\", matrix2D[i][j]);\n            if(j==((dim2*dim3)-1)){\n                printf(\";\");\n            }//if\n            else{\n                printf(\",\");\n            }//else\n        }//for\n    }//for\n\n    printf(\"\\n\"); //new line for readability \n\n    memcpy(matrix3D, matrix2D, dim1*dim2*dim3*sizeof(float));    \n\n    for (int i = 0; i &lt; dim1; i++){//printing out 3d array as asked\n        for (int j = 0; j &lt; dim2; j++){\n            for(int k = 0; k &lt; dim3; k++){\n                printf(\"%0.2f\", matrix3D[i][j][k]);\n                if(j==((dim2)-1)){\n                    printf(\";\");\n                }//if\n                else if(k==((dim3)-1)){\n                    printf(\"\\n\");\n                }//else if\n                else{\n                    printf(\",\");\n                }//else\n            }//for\n        }//for\n    }//for\n\n    free3D(matrix3D);\n    free2D(matrix2D);\n    free(matrix1D);\n\n} //main\n</code></pre>\n\n<p>The example input and output given is (I have everything printing except the last 2 lines - the 3d matrix):</p>\n\n<p><a href=\"https://i.stack.imgur.com/NHJtg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NHJtg.png\" alt=\"example input/output\"></a></p>\n\n<p>Here are malloc2D, malloc3D, free2D and free3D. I was under the impression they were right because they were given to us after none of us were able to get it.</p>\n\n<pre><code>void** malloc2D(size_t rows, size_t cols, size_t sizeOfType){\n    void* block = malloc(sizeOfType * rows * cols);\n    void** matrix = malloc(sizeof(void*) * rows);\n    for (int row = 0; row &lt; rows; ++row) {\n        matrix[row] = block + cols * row * sizeOfType;\n    }//for\n    return matrix;\n}//malloc2D\n\nvoid free2D(void*** matrix){\n    free((*matrix)[0]);\n    free((*matrix));\n    *matrix = NULL;\n}//free2D\n\nvoid*** malloc3D(size_t depth, size_t rows, size_t cols, size_t sizeOfType){\n    void* block = malloc(sizeOfType * rows * cols * depth);\n    void** matrix = malloc(sizeof(void*) * rows * depth);\n    void*** matrix2 = malloc(sizeof(void**) * depth);\n    for (int depth1 = 0; depth1 &lt; depth; ++depth1) {\n        matrix2[depth1] = (void**)(matrix + depth * rows * sizeof(void**));\n        for(int row = 0; row &lt; rows; ++row){\n            matrix[depth1 * rows + row] = block + (depth1 * rows + row) * cols * sizeOfType;\n        }//for\n    }//for\n    return matrix2;\n}//malloc3D\n\nvoid free3D(void**** matrix){\n    free((*matrix)[0][0]);\n    free((*matrix)[0]);\n    free((*matrix));\n    *matrix = NULL;\n}//free3D\n</code></pre>\n"}, {"tags": ["c", "numbers", "currency"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 10, "creation_date": 1519157923, "post_id": 48893538, "comment_id": 84792686, "body": "A standard warning: <b><a href=\"https://stackoverflow.com/questions/3730019/why-not-use-double-or-float-to-represent-currency\">Do not</a></b> use floating point representation for currency."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1519158246, "post_id": 48893538, "comment_id": 84792858, "body": "Take @EugeneSh. advice seriously, you can write 500000 lines of code and then realize that you screwed everything because you used floating point for currency. Well maybe you wont, but I did and it was really sad."}, {"owner": {"reputation": 11, "user_id": 9387717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bc8e534c5e82ed8d34a21ee385fd59b?s=128&d=identicon&r=PG&f=1", "display_name": "Ether_904", "link": "https://stackoverflow.com/users/9387717/ether-904"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1519158470, "post_id": 48893538, "comment_id": 84792973, "body": "@EugeneSh. Understood, will fix accordingly. Thanks for the link + advice"}, {"owner": {"reputation": 11, "user_id": 9387717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bc8e534c5e82ed8d34a21ee385fd59b?s=128&d=identicon&r=PG&f=1", "display_name": "Ether_904", "link": "https://stackoverflow.com/users/9387717/ether-904"}, "edited": false, "score": 1, "creation_date": 1519161773, "post_id": 48893538, "comment_id": 84794698, "body": "Thanks for the help user3121023, that helped a ton, I&#39;m as close to being done as i&#39;ve been so far. Updating code section on the original post."}], "owner": {"reputation": 11, "user_id": 9387717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bc8e534c5e82ed8d34a21ee385fd59b?s=128&d=identicon&r=PG&f=1", "display_name": "Ether_904", "link": "https://stackoverflow.com/users/9387717/ether-904"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519162001, "creation_date": 1519157851, "last_edit_date": 1519162001, "question_id": 48893538, "link": "https://stackoverflow.com/questions/48893538/mathematical-approach-to-converting-a-number-to-a-currency", "title": "Mathematical Approach to Converting a number to a currency", "body": "<p>I am working on a project for my computer science course that is focusing on the C language, and I almost almost done, I just can't figure out why the currency convert function at the bottom drops some of the zeros in the numbers it prints. I am pretty new to C, and learning as I go, so I apologize if this code is not optimized and/or pretty for experienced eyes. Any suggestions on changes are welcome. Below is example print to show my problem, and my code.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Please enter seed number:  5\n\n  Running 26 Times\n     7374270.50 to Dollars:  $7,374,270\n     -643185.56 to Dollars: -$643,185\n     7907977.50 to Dollars:  $7,907,977\n     -810537.94 to Dollars: -$810,537\n    -3670141.50 to Dollars: -$3,670,141\n    -4847146.50 to Dollars: -$4,847,146\n    -1805439.50 to Dollars: -$1,805,439\n    -7718499.50 to Dollars: -$7,718,499\n      209791.62 to Dollars:  $209,791\n    -3349182.00 to Dollars: -$3,349,182\n     7803616.50 to Dollars:  $7,803,616\n     7607553.50 to Dollars:  $7,607,553\n     -232233.81 to Dollars: -$232,233\n     4807206.50 to Dollars:  $4,807,206\n    -4712548.00 to Dollars: -$4,712,548\n     -253349.20 to Dollars: -$253,349\n    -7257441.50 to Dollars: -$7,257,441\n    -5146261.50 to Dollars: -$5,146,261\n     -324208.03 to Dollars: -$324,208\n     3437480.75 to Dollars:  $3,437,480\n     -295008.59 to Dollars: -$295,8\n      118086.98 to Dollars:  $118,86\n     1243459.88 to Dollars:  $1,243,459\n     5947147.50 to Dollars:  $5,947,147\n     3280724.00 to Dollars:  $3,280,724\n    -2176277.75 to Dollars: -$2,176,277   \n</code></pre>\n\n<p><sup></sup></p>\n\n<pre><code>&gt; #include &lt;stdio.h&gt;\n&gt; #include &lt;stdlib.h&gt;\n&gt; #include &lt;math.h&gt;\n&gt; #include &lt;time.h&gt; /*extra includes are allowed (and required)*/\n&gt; \n&gt; void currencyConvert(int money, int cents); void\n&gt; PrettyPrintMoney(float money, int cents); /*extra functions are\n&gt; allowed to be declared*/\n&gt; \n&gt; const int MAX_NUMBER_OF_LOOPS = 30; //do not change this line const\n&gt; int MIN_DOLLAR_AMOUNT = -8000000; //do not change this line const int\n&gt; MAX_DOLLAR_AMOUNT =  8000000; //do not change this line const int\n&gt; TOTAL_LENGTH = 15; //do not change this line\n&gt; \n&gt; int main(void) {   unsigned int intSeed = 0;   unsigned int intLoops =\n&gt; 0;   int randGenerated = 0;   int money = 0;   int cents = 0;   time_t\n&gt; t;   /*extra variables are allowed to be defined*/    printf(\"Please\n&gt; enter seed number: \");    scanf(\"%u\", &amp;intSeed);\n&gt;    \n&gt;       srand(intSeed);\n&gt;       intLoops = rand()%30 + 1;    printf(\"\\n  Running %d Times\", intLoops);\n&gt;        //printf(\"\\n%u\", intLoops); srand(t + intLoops);\n&gt; \n&gt; while (intLoops &gt; 0){\n&gt;      randGenerated = rand() % 16000001 + (-8000000);   cents = rand() % 100;   money = randGenerated;   PrettyPrintMoney(money, cents);  \n&gt; currencyConvert(money, cents);   intLoops = intLoops -1; \n&gt;      }   return 0; } //end main void PrettyPrintMoney(float money, int cents)//float fltMoneyIn) { ; if (money &lt; 0 &amp;&amp; money &lt; -999999){  \n&gt; printf(\"\\n%15.f.%02d to Dollars: -$\", money, cents); } if (money &lt; 0\n&gt; &amp;&amp; money &gt; -999999){   printf(\"\\n%15.f.%02d to Dollars:   -$\", money,\n&gt; cents); } if (money &gt; 0 &amp;&amp; money &gt; 999999){   printf(\"\\n%15.f.%02d to\n&gt; Dollars:  $\", money, cents); } if (money &gt; 0 &amp;&amp; money &lt; 999999){  \n&gt; printf(\"\\n%15.f.%02d to Dollars:    $\", money, cents); }   return; }\n&gt; //end PrettyPrintMoney\n&gt; \n&gt; // Change money to currency (commas) void currencyConvert (int\n&gt; money,int cents){\n&gt;       int order_of_magnitude = (money == 0) ? 1 : (int)pow( 10, ((int)floor(log10(abs(money))) / 3) * 3 ) ;\n&gt;   \n&gt;       printf( \"%d\", abs(money / order_of_magnitude ), cents) ;\n&gt;   \n&gt;     for( money = abs( money ) % order_of_magnitude, order_of_magnitude /= 1000;\n&gt;         order_of_magnitude &gt; 0;\n&gt;         money %= order_of_magnitude, order_of_magnitude /= 1000 )\n&gt;         {\n&gt;         printf( \",%03d\", abs(money / order_of_magnitude) ) ;\n&gt;         \n&gt;     } printf(\".%02d\", cents);    }\n&gt;   \n&gt; \n&gt; \n&gt; /*extra functions are allowed to be defined*/\n</code></pre>\n"}, {"tags": ["c", "function", "pointers", "memory-management", "linked-list"], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1519157316, "post_id": 48893149, "comment_id": 84792370, "body": "Note that <code>0</code> is not the <code>NULL</code> pointer. So it should be <code>temp-&gt;next = NULL;</code> instead. Because otherwise it&#39;s not possible to tell form the code you posted whether <code>next</code> is a pointer or an integer."}], "tags": [], "owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "is_accepted": false, "score": 2, "last_activity_date": 1519156270, "creation_date": 1519156270, "answer_id": 48893149, "question_id": 48892992, "link": "https://stackoverflow.com/questions/48892992/linked-list-delete-tail-function/48893149#48893149", "title": "Linked List, delete tail function", "body": "<p>You should assign 0 to <code>temp-&gt;next</code> pointer when <code>for</code> loop was executed. By this you indicate that this element is last one.</p>\n\n<pre><code>for (temp = list-&gt;head; temp-&gt;next != list-&gt;tail; temp = temp-&gt;next)\n    ;\n\ntemp-&gt;next = 0; // &lt;---\n\nretval = list-&gt;tail-&gt;data;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 54921, "user_id": 294949, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3326427b9c2edc60ad293fdf51c5ba4c?s=128&d=identicon&r=PG&f=1", "display_name": "danh", "link": "https://stackoverflow.com/users/294949/danh"}, "is_accepted": true, "score": 2, "last_activity_date": 1519156592, "creation_date": 1519156592, "answer_id": 48893228, "question_id": 48892992, "link": "https://stackoverflow.com/questions/48892992/linked-list-delete-tail-function/48893228#48893228", "title": "Linked List, delete tail function", "body": "<p>A tail delete needs to be managed from the node <em>before</em> the tail.  If you don't have a back pointer in the list (doubly linked), then you'll need to walk forward to the tail.</p>\n\n<p>Untested, tail delete (with no back pointer) should look like this.</p>\n\n<pre><code>LinkedList *node = list-&gt;head;\nLinkedList *next = node-&gt;next;\n\nwhile(next != list-&gt;tail) {  // walk to the end\n    node = next;\n    next = node-&gt;next;\n}\n// now node is the node before the tail and next is the tail\nint retval = next-&gt;data;\nfree(next);\n// this is why we needed to walk here\nnode-&gt;next = NULL;\n</code></pre>\n"}], "owner": {"reputation": 176, "user_id": 7977841, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh5.googleusercontent.com/-rkl8hwKkAXQ/AAAAAAAAAAI/AAAAAAAAAJ8/ed869wCN4H4/photo.jpg?sz=128", "display_name": "elMentat", "link": "https://stackoverflow.com/users/7977841/elmentat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1216, "favorite_count": 0, "accepted_answer_id": 48893228, "answer_count": 2, "score": 1, "last_activity_date": 1519156592, "creation_date": 1519155600, "question_id": 48892992, "link": "https://stackoverflow.com/questions/48892992/linked-list-delete-tail-function", "title": "Linked List, delete tail function", "body": "<p>I am trying to build a head delete and tail delete function for Linked Lists. </p>\n\n<p>I have succeeded in head delete, but my tail delete function does not actually delete the tail.</p>\n\n<p>First, how my Linked List is created:</p>\n\n<pre><code>typedef struct node\n{\n    int data;\n    struct node *next;\n\n} node;\n\ntypedef struct LinkedList\n{\n    node *head;\n    node *tail;\n\n} LinkedList;\n\nnode *createNode(int data)\n{\n    node *new_node;\n\n    if ((new_node = malloc(sizeof(node))) == NULL)\n        return NULL;\n\n    new_node-&gt;data = data;\n    new_node-&gt;next = NULL;\n\n    return new_node;\n}\n\nLinkedList *createLinkedList(void)\n{\n    LinkedList *LL;\n\n    if ((LL = calloc(1, sizeof(LinkedList))) == NULL)\n        return NULL;\n\n    return LL;\n}\n\nvoid tailInsert(LinkedList *LL, int data)\n{\n\n    if (LL == NULL)\n        return;\n\n    if (LL-&gt;tail == NULL)\n    {\n        LL-&gt;head = LL-&gt;tail = createNode(data);\n        return;\n    }\n\n    LL-&gt;tail-&gt;next = createNode(data);\n    LL-&gt;tail = LL-&gt;tail-&gt;next;\n\n}\n</code></pre>\n\n<p>These are the two functions:</p>\n\n<p>This one does not work:</p>\n\n<pre><code>int tail_Delete(LinkedList *list)\n{\n    int retval;\n    node *temp;\n\n    if (list == NULL || list-&gt;head == NULL)\n        return EMPTY_LIST_ERR;\n\n    // if only one node\n    if (list-&gt;head-&gt;next == NULL)\n    {\n        retval = list-&gt;head-&gt;data;\n        free(list-&gt;head);\n        list-&gt;head = NULL;\n        list-&gt;tail = NULL;\n        return retval;\n    }\n\n    // make temp the node before the tail\n    for (temp = list-&gt;head; temp-&gt;next != list-&gt;tail; temp = temp-&gt;next)\n        ;\n\n    retval = list-&gt;tail-&gt;data;\n\n    free(list-&gt;tail);\n\n    list-&gt;tail = temp;\n\n    return retval;\n}\n</code></pre>\n\n<p>This one does work:</p>\n\n<pre><code>int head_delete(LinkedList *list)\n{\n    int retval;\n    node *temp;\n\n    if (list == NULL || list-&gt;head == NULL)\n        return EMPTY_LIST_ERR;\n\n    retval = list-&gt;head-&gt;data;\n\n    temp = list-&gt;head-&gt;next;\n\n    free (list-&gt;head);\n\n    list-&gt;head = temp;\n\n    if (list-&gt;head == NULL)\n        list-&gt;tail = NULL;\n\n    return retval;\n}\n</code></pre>\n\n<p>Print function and main:</p>\n\n<pre><code>void print_Linked_list(LinkedList *LL)\n{\n    node *temp;\n\n    if (LL == NULL || LL-&gt;head == NULL)\n        return;\n\n    for (temp = LL-&gt;head; temp != NULL; temp = temp-&gt;next)\n        printf(\"%d%c\", temp-&gt;data, (temp-&gt;next == NULL) ? '\\n' : ' ');\n\n}\n\nint main(void)\n{\n    LinkedList *LL;\n    int val;\n\n    LL = createLinkedList();\n\n    tailInsert(LL, 1);\n    tailInsert(LL, 2);\n    tailInsert(LL, 3);\n\n    print_Linked_list(LL);\n\n    val = tail_Delete(LL);\n    //val = head_delete(LL);\n\n    printf(\"%d\\n\", val);\n\n    print_Linked_list(LL);\n\n    return 0;\n}\n</code></pre>\n\n<p>Output for head_delete:</p>\n\n<pre><code>1 2 3\nDeleted node: 1\n2 3\n</code></pre>\n\n<p>Output for tail_delete:</p>\n\n<pre><code>1 2 3\nDeleted node: 3\n1 2 3\n</code></pre>\n\n<p>It may be a simple mistake, but they seem to be practically equivalent functions.</p>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["c", "struct", "segmentation-fault"], "comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 0, "creation_date": 1519155850, "post_id": 48892988, "comment_id": 84791622, "body": "@snr: You need to allocate the memory to hold the <code>char*</code> itself too."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1519156016, "post_id": 48892988, "comment_id": 84791695, "body": "you need to strdup(val) too"}, {"owner": {"reputation": 21, "user_id": 6367683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe0b247076168ab1cc28784355373d8?s=128&d=identicon&r=PG&f=1", "display_name": "akira kato", "link": "https://stackoverflow.com/users/6367683/akira-kato"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1519157198, "post_id": 48892988, "comment_id": 84792315, "body": "@ShadowRanger I&#39;m not quite sure if i follow. So i need to allocate memory for char* inside the struct? (char *value=malloc(sizeof(char));)"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1519159499, "post_id": 48892988, "comment_id": 84793505, "body": "...and for the struct itself. You declare a pointer, but it just points to random memory until you give it some."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1519161314, "post_id": 48892988, "comment_id": 84794469, "body": "@akirakato: I was responding to snr, who (now deleted) claimed the <code>char*</code> was fine because what it points to had backing storage, while the <code>int</code>s were broken. I was saying that the pointer itself (not what it points to) needed to be allocated, just like the other members of the struct. In any event, his comment was deleted, so it&#39;s irrelevant. Point is, at the very least you need to allocate the struct, and in any real code you&#39;d probably want to copy the string (including allocation, e.g. via <code>strdup</code>) rather than assuming it will live for the life of the stack."}], "answers": [{"tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": false, "score": 0, "last_activity_date": 1519155777, "creation_date": 1519155777, "answer_id": 48893035, "question_id": 48892988, "link": "https://stackoverflow.com/questions/48892988/segmentation-fault-11-for-c/48893035#48893035", "title": "Segmentation fault: 11 for C", "body": "<p>You declare <code>newstackptr</code>, but never allocate it, so it has undefined contents, and when you assign its attributes, you're writing to effectively random memory. You need to allocate it:</p>\n\n<pre><code>struct v* newstackptr = malloc(sizeof(*newstackptr));\n</code></pre>\n\n<p>and you should be increasing the warning level on your compiler in general (e.g. passing <code>-Wall</code> when compiling for <code>gcc</code>/<code>clang</code>), because this sort of error should be trivially identifiable by your compiler.</p>\n"}], "owner": {"reputation": 21, "user_id": 6367683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe0b247076168ab1cc28784355373d8?s=128&d=identicon&r=PG&f=1", "display_name": "akira kato", "link": "https://stackoverflow.com/users/6367683/akira-kato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "closed_date": 1519155926, "answer_count": 1, "score": 0, "last_activity_date": 1519155777, "creation_date": 1519155581, "question_id": 48892988, "link": "https://stackoverflow.com/questions/48892988/segmentation-fault-11-for-c", "closed_reason": "Duplicate", "title": "Segmentation fault: 11 for C", "body": "<p>This part of the code keeps on giving me segmentation fault. It's a stack structure. For testing I just made a global variable top to keep track of the stack. There's no problem in the logic when I implement it in c++ so I'm not sure why there's an error. Thanks.</p>\n\n<pre><code>struct v\n{\n  char *value;\n  int ibase;\n  int obase;\n  struct v* next;\n};\nstruct v* top = NULL;\n\nvoid push(char* val, int ibas, int obas)\n{\n  struct v* newstackptr;\n  newstackptr-&gt;next = top;\n  newstackptr-&gt;value= val;\n  newstackptr-&gt;ibase= ibas;\n  newstackptr-&gt;obase= obas;\n  top = newstackptr;\n}\n\nint main(){\nchar* value=\"111\";\npush(value,2,8);\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519155124, "post_id": 48892823, "comment_id": 84791235, "body": "Shows us the code of <code>amalgamateArtistsAndSongs</code>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519155273, "post_id": 48892823, "comment_id": 84791307, "body": "and how you call <code>amalgamateArtistsAndSongs</code>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519156286, "post_id": 48892823, "comment_id": 84791861, "body": "Your function and variables names are so long that putting them in backticks make it difficult to read, put them in code blocks. I&#39;ve previously fixed that on you answer, please don&#39;t put them back with backticks. Thank you"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519156335, "post_id": 48892823, "comment_id": 84791894, "body": "<code>strcat(amalgamatedSongs[pos],&quot;\\0&quot;);</code> is not necessary, <code>strcat</code> will write the \\0-terminating byte."}], "answers": [{"tags": [], "owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "is_accepted": false, "score": 0, "last_activity_date": 1519155521, "creation_date": 1519155521, "answer_id": 48892976, "question_id": 48892823, "link": "https://stackoverflow.com/questions/48892823/c-easiest-way-to-combine-and-alter-2-2d-arrays-of-strings-into-larger-2d-array/48892976#48892976", "title": "C - easiest way to combine and alter 2 2D arrays of strings into larger 2D array", "body": "<p>Your title is misleading. While true you are in fact messing with 2D arrays, it is more idiomatic and better understood to say you are messing with <strong>arrays of strings</strong>.</p>\n\n<p>To combine strings, use <a href=\"http://man7.org/linux/man-pages/man3/strcpy.3.html\" rel=\"nofollow noreferrer\">strcpy()</a> and <a href=\"http://man7.org/linux/man-pages/man3/strcat.3.html\" rel=\"nofollow noreferrer\">strcat()</a>.</p>\n\n<p>To do it for an array of things, use a loop.</p>\n\n<pre><code>for (int n = 0; n &lt; num_items; n++)\n{\n  strcpy( amalgamatedSongs[ n ], artists[ n ] );\n  strcat( amalgamatedSongs[ n ], \" - \" );\n  strcat( amalgamatedSongs[ n ], ... );\n}\n</code></pre>\n\n<p>When in doubt, learn to read the docs. <a href=\"http://en.cppreference.com/w/c\" rel=\"nofollow noreferrer\">cppreference.com</a> has a very good reference.</p>\n"}, {"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1519157508, "creation_date": 1519157508, "answer_id": 48893447, "question_id": 48892823, "link": "https://stackoverflow.com/questions/48892823/c-easiest-way-to-combine-and-alter-2-2d-arrays-of-strings-into-larger-2d-array/48893447#48893447", "title": "C - easiest way to combine and alter 2 2D arrays of strings into larger 2D array", "body": "<p>This function</p>\n\n<pre><code>int amalgamateArtistsAndSongs (char amalgamatedSongs[][163],\n    char artists[][80],char songsOfAnArtists[][80],\n    int numOfSongs[],int pos)\n{\n    int i;\n\n    for (i=0;i&lt;numOfSongs;i++)\n    {\n       strcpy(amalgamatedSongs[pos],artists[]);\n       strcat(amalgamatedSongs[pos],\" - \");\n       strcat(amalgamatedSongs[pos],songsOfAnArtists[i]);\n       strcat(amalgamatedSongs[pos],\"\\0\");\n       pos++;\n    }\n\n    return pos;\n}\n</code></pre>\n\n<p>is incorrect: <code>numOfSongs</code> is a pointer to an array, the for loop will continue to loop until <code>i</code> gets to the integer value\nof the addresses where <code>numOfSongs</code> is pointing to and you definitely will overflow\n<code>amalgamatedSongs</code>. The compiler must have given a warning for this. The correct\ncondition should be <code>i &lt; numOfSongs[pos]</code>.</p>\n\n<p>Also</p>\n\n<pre><code> strcpy(amalgamatedSongs[pos],artists[]);\n</code></pre>\n\n<p>is a syntax error, you should get sometging like this:</p>\n\n<pre><code>error: expected expression before \u2018]\u2019 token\n  strcpy(amalgamatedSongs[pos],artists[]);\n                                       ^\n</code></pre>\n\n<p>You probably want</p>\n\n<pre><code> strcpy(amalgamatedSongs[pos], artists[pos]);\n</code></pre>\n\n<p>This</p>\n\n<pre><code>   strcat(amalgamatedSongs[pos],\"\\0\");\n</code></pre>\n\n<p>is not needed, because <code>strcat</code> writes the <code>'\\0'</code>-terminating byte.</p>\n\n<p>A problem with this series of <code>strcat</code> is that you don't know if the whole strings fits in\n<code>amalgamatedSongs[pos]</code>, you may overflow the buffer. You would have to use <code>strncpy</code> and <code>strncat</code> and manually set the\n<code>'\\0'</code>-terminating between each call. It's a lot of work, I'd concatenate the strings using\n<code>snprintf</code>:</p>\n\n<pre><code>int amalgamateArtistsAndSongs (char amalgamatedSongs[][163],\n    char artists[][80],char songsOfAnArtists[][80],\n    int numOfSongs[],int pos)\n{\n    int i;\n\n    for (i=0;i&lt;numOfSongs;i++)\n    {\n        snprintf(amalgamatedSongs[pos], 163, \"%s - %s\",\n            artists[pos], songsOfAnArtists[i]);\n\n       pos++;\n    }\n\n    return pos;\n}\n</code></pre>\n\n<p><code>snprintf</code> will write at most 163 characters <strong>including</strong> the <code>'\\0'</code>-terminating byte. If the\ncombination <strong>artist - song</strong> is to long for 162 characters, <code>snprintf</code> will only write 162 characters\nand set the <code>'\\0'</code>-terminating byte, thus you don't overflow the buffer.</p>\n\n<blockquote>\n  <p><em>man printf</em></p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint snprintf(char *str, size_t size, const char *format, ...);\nint vsnprintf(char *str, size_t size, const char *format, va_list ap);\n</code></pre>\n  \n  <p>The functions <code>snprintf()</code> and <code>vsnprintf()</code> write at most <code>size</code> bytes (including the terminating null byte (<code>'\\0'</code>)) to <code>str</code>.</p>\n</blockquote>\n"}], "owner": {"reputation": 119, "user_id": 8662399, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a0fb144a0aabe92cbcb43b9958edeb83?s=128&d=identicon&r=PG&f=1", "display_name": "erykkk", "link": "https://stackoverflow.com/users/8662399/erykkk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 48893447, "answer_count": 2, "score": 0, "last_activity_date": 1519157508, "creation_date": 1519154946, "last_edit_date": 1519156168, "question_id": 48892823, "link": "https://stackoverflow.com/questions/48892823/c-easiest-way-to-combine-and-alter-2-2d-arrays-of-strings-into-larger-2d-array", "title": "C - easiest way to combine and alter 2 2D arrays of strings into larger 2D array", "body": "<p>I would like to create a function for my program which takes 2 2D arrays, the first containing the name of an artist and the second containing the songs of said artists, place the artist name at the start of the array, followed by a \" - \", then followed by the song name as such:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Artist1 - Song 1.\n\nArtist1 - Song 2.\n\n..\n\n..\n\nArtist4 - Song 3.\n</code></pre>\n\n<p>I have created the prototype for such function: </p>\n\n<pre><code>int amalgamateArtistsAndSongs (char amalgamatedSongs[][163],char artists[][80],\n        char songsOfAnArtists[][80],int numOfSongs[],int pos);\n</code></pre>\n\n<p>Declarations of arrays:</p>\n\n<pre><code>    //The array containing artists names\n    char artists[4][80];\n    //The array containing the sorted artists\n    char sortedArtists[4][80];\n    //Songs for Artist 1\n    char songsArtist1[3][80];\n    //Songs for Artist 2\n    char songsArtist2[3][80];\n    //Songs for Artist 3\n    char songsArtist3[3][80];\n    //Songs for Artist 4\n    char songsArtist4[3][80];\n    //Array which holds amalgamated artist and song names -&gt; (Artists - Song Name).\n    char amalgamatedSongs[12][163];\n    //The total number of artists (Note it can be less than 4)\n    int numOfArtists = 0;\n    //The total number of songs for each artist (Note that less than 3 songs can be provided for each artist)\n    int numSongsPerArtist[4] = {0,0,0,0};\n</code></pre>\n\n<p>I have included <code>int numSongsPerArtist;</code> because it can occur that an artist has less than 3 songs, as to avoid Artistx - \"blank\" appearing in <code>amalgamatedSongs[][]</code></p>\n\n<p>I have attempted to create this function using <code>strcpy()</code> and <code>strcat()</code>, but it doesn't seem to work the way I would like it to:</p>\n\n<pre><code>int amalgamateArtistsAndSongs (char amalgamatedSongs[][163],char artists[][80],char songsOfAnArtists[][80],int numOfSongs[],int pos)\n{\n    int i;\n\n    for (i=0;i&lt;numOfSongs;i++)\n    {\n       strcpy(amalgamatedSongs[pos],artists[]);\n       strcat(amalgamatedSongs[pos],\" - \");\n       strcat(amalgamatedSongs[pos],songsOfAnArtists[i]);\n       strcat(amalgamatedSongs[pos],\"\\0\");\n       pos++;\n    }\n\n    return pos;\n}\n</code></pre>\n\n<p>I am using <code>int pos;</code> to indicate to the next call of the function where the in <code>amalgamatedSongs[][]</code> the previous call of the function left off (where the last artist - song was placed).</p>\n\n<p>This is how the function is called </p>\n\n<pre><code>amalgamateArtistsAndSongs(amalgamatedSongs,artists[1],\n        songsArtist2,numSongsPerArtist[1],pos);\n</code></pre>\n\n<p>To clarify:</p>\n\n<p>If </p>\n\n<pre><code>artists[][80] = {\"artist1\",\"artist2\",\"artist3\",\"artist4\"};\nsongsArtist1[][80] = {\"a\",\"b\",\"c\"};\nsongsArtist2[][80] = {\"aa\",\"bb\",\"cc\"};\nsongsArtist3[][80] = {\"aaa\",\"bbb\"};\nsongsArtist4[][80] = {\"aaaa\"};\n</code></pre>\n\n<p>Then (after using the <code>amalgamateArtistsAndSongs()</code> function)</p>\n\n<pre><code>amalgamatedSongs[][163] = {\"artist1 - a\",\"artist1 - b\",\"artist1 - c\",\n\"artist2 - aa\",\"artist2 - bb\",\"artist2 - cc\",\"artist3 - aaa\",\"artist3 - bbb\",\n\"artist4 - aaaa\"};\n</code></pre>\n"}, {"tags": ["c", "pointers", "c-strings"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 3, "creation_date": 1519154486, "post_id": 48892704, "comment_id": 84790926, "body": "&quot;I don&#39;t understand how there isn&#39;t an error while compiling since the pointer ptr_str is pointing directly to the text and not to the first character of the text.&quot; It <i>does</i> point to the first character."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1519154596, "post_id": 48892704, "comment_id": 84790975, "body": "So what is the &quot;<i>text</i>&quot; according to you? How would the pointer point to the <i>text</i>?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1519154600, "post_id": 48892704, "comment_id": 84790979, "body": "What does it even mean to &quot;point to text&quot; rather than to the first character? How do you think computer memory is laid out?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519154728, "post_id": 48892704, "comment_id": 84791051, "body": "Don&#39;t do <code>printf(ptr_str);</code>, do <code>puts(ptr_str)</code> or <code>printf(&quot;%s\\n&quot;, ptr_str)</code>. <code>printf</code> expects the format as the first argument, if <code>ptr_str</code> were for example <code>&quot;10% of 100 is 10&quot;</code>, <code>printf(ptr_str)</code> would fail"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519154773, "post_id": 48892704, "comment_id": 84791067, "body": "@Pablo, it would be UB in fact. Some compilers warn about it."}, {"owner": {"reputation": 85, "user_id": 1699147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fad6c3d69941413a0c52869d1d7f6a3?s=128&d=identicon&r=PG", "display_name": "H&#233;lder Lima", "link": "https://stackoverflow.com/users/1699147/h%c3%a9lder-lima"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1519154793, "post_id": 48892704, "comment_id": 84791081, "body": "@tkausl If it is pointing to the first character, where is the whole string stored?"}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1519155249, "post_id": 48892704, "comment_id": 84791297, "body": "@H&#233;lderLima: a string is just a contiguous sequence of bytes. The second character is stored just after the first."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1519164436, "post_id": 48892704, "comment_id": 84795818, "body": "If the &#39;H&#39; is stored at memory address 2000, then the &#39;e&#39; better be at address 2001, the first &#39;l&#39; at 2002, etc., and there must be a 0 at 2012 or thereabouts to mark the end."}], "answers": [{"comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1519156993, "post_id": 48892793, "comment_id": 84792220, "body": "I don&#39;t know why but you skipped the decaying part. Is it intentional?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1519157801, "post_id": 48892793, "comment_id": 84792619, "body": "@coderredoc OP seems to already know that part. See the second example in the question (and the comment &quot;<i>where is the whole string stored?</i>&quot;)."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1519157949, "post_id": 48892793, "comment_id": 84792698, "body": "Ah I see but anyway I felt to clarify the thing and also standard also says whatever we know in this context that&#39;s why mentioned it. Will keep my answer as well."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 5, "last_activity_date": 1519154838, "creation_date": 1519154838, "answer_id": 48892793, "question_id": 48892704, "link": "https://stackoverflow.com/questions/48892704/shouldnt-it-be-impossible-to-point-directly-to-text-in-c/48892793#48892793", "title": "Shouldn&#39;t it be impossible to point directly to text in C?", "body": "<p>Your code works because string literals are essentially static arrays.</p>\n\n<pre><code>ptr_str = \"Hello World\";\n</code></pre>\n\n<p>is treated by the compiler as if it were</p>\n\n<pre><code>static char __tmp_0[] = {'H', 'e', 'l', 'l', 'o', ' ', 'W', 'o', 'r', 'l', 'd', '\\0' };\nptr_str = __tmp_0;\n</code></pre>\n\n<p>(except trying to modify the contents of a string literal has undefined behavior).</p>\n\n<p>You can even apply <code>sizeof</code> to a string literal and you'll get the size of the array: <code>sizeof \"Hello\"</code> is 6, for example.</p>\n"}, {"comments": [{"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1519155350, "post_id": 48892828, "comment_id": 84791349, "body": "This isn&#39;t entirely correct because a string literal is an array. The &#39;value&#39; is the array, not the address of the first character. See melpomene&#39;s answer."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1519155553, "post_id": 48892828, "comment_id": 84791451, "body": "ptr_str is a char pointer - it contains the address of the &#39;H&#39;. It know nothing about arrays. The rhs value was assigned to the lhs, that value was the address of the &#39;H&#39;"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 1, "creation_date": 1519155623, "post_id": 48892828, "comment_id": 84791485, "body": "The array &#39;decays&#39; into a pointer in this context. But it&#39;s misleading to say that the literal <i>is</i> a pointer."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1519155696, "post_id": 48892828, "comment_id": 84791534, "body": "how about that tweak to the text"}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1519155889, "post_id": 48892828, "comment_id": 84791636, "body": "Yeah that&#39;s fine"}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 0, "last_activity_date": 1519155683, "last_edit_date": 1519155683, "creation_date": 1519154978, "answer_id": 48892828, "question_id": 48892704, "link": "https://stackoverflow.com/questions/48892704/shouldnt-it-be-impossible-to-point-directly-to-text-in-c/48892828#48892828", "title": "Shouldn&#39;t it be impossible to point directly to text in C?", "body": "<p>In the context of assignment to a char pointer the 'value' of a string literal is the address of its first character.</p>\n\n<p>so</p>\n\n<pre><code>  ptr_str = \"Hello World\";\n</code></pre>\n\n<p>sets ptr_str to the address of the 'H'</p>\n"}, {"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 0, "last_activity_date": 1519156634, "last_edit_date": 1519156634, "creation_date": 1519155834, "answer_id": 48893051, "question_id": 48892704, "link": "https://stackoverflow.com/questions/48892704/shouldnt-it-be-impossible-to-point-directly-to-text-in-c/48893051#48893051", "title": "Shouldn&#39;t it be impossible to point directly to text in C?", "body": "<p>Why won't the first one work? It will work as you have seen.</p>\n\n<p>String literals are arrays. From \u00a7<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.4.5p6\" rel=\"nofollow noreferrer\">6.4.5p6</a> <code>C11</code> Standard <code>N1570</code></p>\n\n<blockquote>\n  <p>The multibyte character sequence is then used to initialize an array of static storage duration and length just sufficient to contain the sequence. For character string literals, the array elements have type char, and are initialized with the individual bytes of the multibyte character sequence.</p>\n</blockquote>\n\n<p>Now in the first case <em><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p3\" rel=\"nofollow noreferrer\">literal array decayed into pointer to first element</a></em> - so decayed pointer will basically be pointing to <code>'H'</code>. You assigned that pointer to <code>ptr_str</code>. Now <code>printf</code> will expect a format specifier and the corresponding argument. Here it will be <code>%s</code> and corresponding argument would be <code>char*</code>. And <code>printf</code> will print every character until it reached the <code>\\0</code>. That's all it happened. This is how you ended up <em>pointing directly to the text</em>.</p>\n\n<p>Note that second case is quite different from first case in that - second case a copy is being made which can be modified (Trying to modify the first one would be undefined behavior). We are <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.9p14\" rel=\"nofollow noreferrer\">basically initializing a <code>char</code> array</a> with the content of the string literal. </p>\n"}], "owner": {"reputation": 85, "user_id": 1699147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fad6c3d69941413a0c52869d1d7f6a3?s=128&d=identicon&r=PG", "display_name": "H&#233;lder Lima", "link": "https://stackoverflow.com/users/1699147/h%c3%a9lder-lima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 1, "accepted_answer_id": 48892793, "answer_count": 3, "score": 0, "last_activity_date": 1519156634, "creation_date": 1519154439, "question_id": 48892704, "link": "https://stackoverflow.com/questions/48892704/shouldnt-it-be-impossible-to-point-directly-to-text-in-c", "title": "Shouldn&#39;t it be impossible to point directly to text in C?", "body": "<p>I am learning C and I came across the pointers.\nEven though I learned more with this tutorial than from the textbook I still wonder about the char pointers.</p>\n\n<p>If I program this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    char *ptr_str;\n\n    ptr_str = \"Hello World\";\n\n    printf(ptr_str);\n\n    return 0;\n\n}\n</code></pre>\n\n<p>The result is</p>\n\n<pre><code>Hello World\n</code></pre>\n\n<p>I don't understand how there isn't an error while compiling since the pointer ptr_str is pointing directly to the text and not to the first character of the text. I thought that only this would work</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    char *ptr_str;\n    char var_str[] = \"Hello World\";\n\n    ptr_str = var_str;\n\n    printf(ptr_str);\n\n    return 0;\n\n}\n</code></pre>\n\n<p>So in the first example how was I pointing directly to the text?</p>\n"}, {"tags": ["c", "int"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1519154506, "post_id": 48892669, "comment_id": 84790934, "body": "<code>long tField[sizeof(tField)&#47;sizeof(int)];</code>. That makes no sense, how can the compiler know <code>sizeof(tField)</code> when it hasn&#39;t been completely declared yet? And <code>sizeof(int)</code> is also wrong, it should be <code>sizeof(long)</code>."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1519154506, "post_id": 48892669, "comment_id": 84790935, "body": "<code>long a</code> and <code>long b</code> are merely longs, but you are trying to access them as if they were arrays"}, {"owner": {"reputation": 3, "user_id": 9387494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HpU67wRP8Bo/AAAAAAAAAAI/AAAAAAAAAxM/ybWFP4pnOfg/photo.jpg?sz=128", "display_name": "VkinOe", "link": "https://stackoverflow.com/users/9387494/vkinoe"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519156502, "post_id": 48892669, "comment_id": 84791970, "body": "@Pablo 1. yeah that was a typo.. 2.but sizeof int works and gives the correct value."}, {"owner": {"reputation": 3, "user_id": 9387494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HpU67wRP8Bo/AAAAAAAAAAI/AAAAAAAAAxM/ybWFP4pnOfg/photo.jpg?sz=128", "display_name": "VkinOe", "link": "https://stackoverflow.com/users/9387494/vkinoe"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1519156621, "post_id": 48892669, "comment_id": 84792029, "body": "@ChristianGibbons ok i changed them to this: <code>long *a</code> and <code>long *b</code>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519157632, "post_id": 48892669, "comment_id": 84792533, "body": "I don&#39;t know your compiler does not give you an error for this. My gcc (6.4.0) gives me an error for <code>int x[sizeof x &#47; sizeof(int)];</code>: <i>error: <code>x</code> undeclared (first use in this function)</i>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519157759, "post_id": 48892669, "comment_id": 84792599, "body": "And <code>int len=sizeof(sField)&#47;sizeof(int);</code> is also wrong, you&#39;re constantly passing the incorrect types. Correct version is: <code>size_t len = sizeof(sField)&#47;sizeof(long);</code> and even better <code>size_t len = sizeof sField &#47; sizeof *sField;</code>"}, {"owner": {"reputation": 3, "user_id": 9387494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HpU67wRP8Bo/AAAAAAAAAAI/AAAAAAAAAxM/ybWFP4pnOfg/photo.jpg?sz=128", "display_name": "VkinOe", "link": "https://stackoverflow.com/users/9387494/vkinoe"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519210453, "post_id": 48892669, "comment_id": 84813599, "body": "@Pablo it does give me an error, like i said it was a typo it should be <code>long tField[sizeof(&gt;s&lt;Field)&#47;sizeof(int)]</code>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519212457, "post_id": 48892669, "comment_id": 84814963, "body": "Ok, typo about <code>sField</code>, the type you are using is still wrong, you should use <code>&#47;sizeof(long)</code>. It recommend using <code>long tField[sizeof sField &#47; sizeof *sField];</code> <b>THAT</b> gives you the correct amount of elements. I recommend to avoid <code>sizeof(&lt;type&gt;)</code> whenever you can do <code>sizeof variable</code>. The former is easier to get wrong, the latter is more robust and will yield correct results every time."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519212764, "post_id": 48892669, "comment_id": 84815176, "body": "<code>&#47;sizeof(int)</code> would give you the correct amount only when <code>long</code> and <code>int</code> have the same size. On my system <code>long</code> is 8 bytes long, <code>int</code> is 4. The way you did it, I would end up with an array twice as long as needed and the <code>for</code>-loop would overflow the buffer."}], "answers": [{"tags": [], "owner": {"reputation": 169, "user_id": 4960856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/805862e7b973bcafed2b679209d54cfd?s=128&d=identicon&r=PG&f=1", "display_name": "hafeez", "link": "https://stackoverflow.com/users/4960856/hafeez"}, "is_accepted": true, "score": 0, "last_activity_date": 1519155115, "creation_date": 1519155115, "answer_id": 48892860, "question_id": 48892669, "link": "https://stackoverflow.com/questions/48892669/i-get-the-error-invalid-types-long-intint-for-array-subscript/48892860#48892860", "title": "I get the error: &quot;invalid types &#39;long int[int] for array subscript&quot;", "body": "<p>The <code>targetField</code> and <code>sourceField</code> arguments of the function are not arrays and you are accessing them as arrays.\nAlso <code>long</code> is not unsigned, you may be assigning too large value to it.</p>\n\n<p>Try this</p>\n\n<pre><code>long copyField(long targetField[], long sourceField[], int length);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9387494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HpU67wRP8Bo/AAAAAAAAAAI/AAAAAAAAAxM/ybWFP4pnOfg/photo.jpg?sz=128", "display_name": "VkinOe", "link": "https://stackoverflow.com/users/9387494/vkinoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 48892860, "answer_count": 1, "score": 0, "last_activity_date": 1519155115, "creation_date": 1519154314, "question_id": 48892669, "link": "https://stackoverflow.com/questions/48892669/i-get-the-error-invalid-types-long-intint-for-array-subscript", "title": "I get the error: &quot;invalid types &#39;long int[int] for array subscript&quot;", "body": "<p>in computer science we were given a few exercises to learn c coding.\nOne of those exercises was to create a function copyField which is given 3 arguments: targetField sourceField and the Length of the field.</p>\n\n<p>We should create a function that takes the sourceField (has to have long-values)\nand copies it into targetField.</p>\n\n<p>My code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n//declaration of the function\nlong copyField(long targetField, long sourceField, int length);\n\nint main(void){\n\n  //sField will be variable afterwards\n  /*sField equals sourceField; tField equals targetField; \n  len equals Length of sField \n  */\n\n  long sField[]={12341234,2343233,3432424,4235252354,53254234};\n  long tField[sizeof(tField)/sizeof(int)];\n  int len=sizeof(sField)/sizeof(int);\n\n /*commented because I have to fix the error first\n  copyField(tField,sField,len);\n */\n\n //print out the targetField\n\n  for(int i=0;i&lt;=sizeof(tField)/sizeof(int);i++){\n    printf(\"%d\",sField[i]);\n  }\n\n  return(0);\n\n}\n\n//function\nlong copyField(long a,long  b,int c){\n\n  //for i &lt; length of sField \n\n  for(int i=0;i&lt;c;i++){\n    /*targetField should be filled with the content\n    of sourceField\n    */\n    a[i]=b[i];\n  }\n\n}\n</code></pre>\n\n<p>Can you help me fix this problem? I'm kinda new to c it's been just a couple of weeks now so I hope you can help me...</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1519154217, "post_id": 48892612, "comment_id": 84790817, "body": "Please write code as though humans will read it."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519154364, "post_id": 48892612, "comment_id": 84790877, "body": "Note that the way you are using <code>malloc()</code> makes it look like you don&#39;t understand what <code>malloc()</code> is for. Likely your <code>strncpy()</code> migh be a little bit wrong. I just never use it, because IMHO it&#39;s better to use <code>memcpy()</code> and  write the <code>&#39;\\0&#39;</code> by hand."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519154445, "post_id": 48892612, "comment_id": 84790907, "body": "In <code>strncat(word,&amp;buf[i], 1);</code> the buffer data is unintialised so you can&#39;t use that. Use <code>strncpy</code>. Oh whoops mybad - that&#39;s conditional on being a later loop."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519154513, "post_id": 48892612, "comment_id": 84790939, "body": "@WeatherVane And doesn&#39;t that just copy 1 byte? So the code would iterate every time the whole string just to append a single byte. Isn&#39;t it a lot better to keep current string length somewhere and just append the single character at the right position?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1519154644, "post_id": 48892612, "comment_id": 84791013, "body": "This is mystery to me \u2014 <code>word = (char *) malloc(sizeof(char) * 50); &#47;*...*&#47; free(word); word = (char *) malloc(sizeof(char) * 50);</code>"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 1, "creation_date": 1519154826, "post_id": 48892612, "comment_id": 84791096, "body": "Use <code>strtok</code> .."}, {"owner": {"reputation": 1646, "user_id": 3904492, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ak0QY.jpg?s=128&g=1", "display_name": "Starlord", "link": "https://stackoverflow.com/users/3904492/starlord"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1519154976, "post_id": 48892612, "comment_id": 84791167, "body": "@MFisherKDX That seems like a much simpler solution than I managed to make. I will try that."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519155100, "post_id": 48892612, "comment_id": 84791224, "body": "@Starlord however you process <code>buf</code> you still need to initialise <code>word</code> which is not done by <code>malloc</code> or by <code>strncat</code>."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1519155216, "post_id": 48892612, "comment_id": 84791279, "body": "the reason for the garbage is that  you have not zero terminated you strings. Since your code is impossible to follow its hard to point to where it should be done. use strtok"}, {"owner": {"reputation": 1646, "user_id": 3904492, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ak0QY.jpg?s=128&g=1", "display_name": "Starlord", "link": "https://stackoverflow.com/users/3904492/starlord"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519155535, "post_id": 48892612, "comment_id": 84791440, "body": "@WeatherVane Thanks for pointing that out. I think strok is the way to go. @ pm100 the manual says strncat should always put &#39;\\0&#39; at the end of appending a string."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519155857, "post_id": 48892612, "comment_id": 84791624, "body": "Yes it does, but the <i>target</i> to which it is concatenated must be a valid zero-terminated C string."}, {"owner": {"reputation": 1646, "user_id": 3904492, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ak0QY.jpg?s=128&g=1", "display_name": "Starlord", "link": "https://stackoverflow.com/users/3904492/starlord"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519156100, "post_id": 48892612, "comment_id": 84791740, "body": "@WeatherVane aha. Now I know. Thanks all"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1519156201, "post_id": 48892612, "comment_id": 84791802, "body": "... which you could acheive with <code>word = malloc(50); *word = &#39;\\0&#39;;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519157529, "post_id": 48893130, "comment_id": 84792475, "body": "That&#39;s true, I&#39;ll delete my first comment: I gave UV before commenting anyway."}], "tags": [], "owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "is_accepted": true, "score": 2, "last_activity_date": 1519157435, "last_edit_date": 1519157435, "creation_date": 1519156183, "answer_id": 48893130, "question_id": 48892612, "link": "https://stackoverflow.com/questions/48892612/dividing-up-a-char-array-to-different-values-in-struct/48893130#48893130", "title": "Dividing up a char array to different values in struct", "body": "<blockquote>\n  <p>But there are problems. 1 it is nasty. 2 When printing the struct in\n  the end i recieve garbage output after the string.</p>\n</blockquote>\n\n<p>The \"garbage\" prints, as have been noted in the comments, are because you are not properly null terminating your strings.  For instance, you are not initializing <code>word</code> to an empty string (single null character) before calling <code>strncat</code>.</p>\n\n<blockquote>\n  <p>Any better ways to do this?</p>\n</blockquote>\n\n<p>Most certainly.  I'd suggest using <code>strtok</code> as so:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct received {\n    char what[50];\n    char from[50];\n    int value;\n};\n\nint main(void)\n{\n  char buf[] = \"leadervalue host 9569\";\n  struct received leaderRec; \n  /* Initialize leaderRec here */      \n  memset(&amp;leaderRec, 0, sizeof(leaderRec));\n\n  char *s = strdup(buf);\n  char *p = strtok(s, \" \");\n  if (p != NULL) {\n     strncpy(leaderRec.what, p, sizeof(leaderRec.what));\n     p = strtok(NULL, \" \");\n  }\n  if (p != NULL) {\n     strncpy(leaderRec.from, p, sizeof(leaderRec.from));\n     p = strtok(NULL, \" \");\n  }\n  if (p != NULL) {\n     leaderRec.value = atoi(p);\n  }\n  free(s);\n\n  printf(\"%s %s %d\\n\", leaderRec.what, leaderRec.from, leaderRec.value);\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1646, "user_id": 3904492, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ak0QY.jpg?s=128&g=1", "display_name": "Starlord", "link": "https://stackoverflow.com/users/3904492/starlord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 48893130, "answer_count": 1, "score": 0, "last_activity_date": 1519172254, "creation_date": 1519154027, "last_edit_date": 1519172254, "question_id": 48892612, "link": "https://stackoverflow.com/questions/48892612/dividing-up-a-char-array-to-different-values-in-struct", "title": "Dividing up a char array to different values in struct", "body": "<p>Through a tcp socket I get a string like this: \"SmallTitle fromhost 9595\". </p>\n\n<p><strong>Upon reciving it I would like to divide it in to a struct so it's easier to work with.</strong> </p>\n\n<p>This is what I have come up with. But there are problems. 1 it is nasty. 2 When printing the struct in the end i recieve garbage output after the string. See output example at the bottom. Should not printf stop at '\\0'? Then it might be missing such.   </p>\n\n<pre><code>struct recieved {\n    char what[50];\n    char from[50];\n    int value;\n};\n\n\nint main(int argc, char const *argv[]) {\n    struct recieved leaderRec;\n\n    char *word;\n    char buf[] = \"leadervalue host 9569\"; //Example recieved input from socket.\n\n    word = (char *) malloc(sizeof(char) * 50);\n    int i = 0;\n    int count = 1;\n\n    do{\n        if((buf[i] == ' ') || (buf[i+1] == '\\0')){\n            //End of word\n            //word[strlend(word)+1] = '\\0';\n            //printf(\"%s\\n\", word);\n            if(count == 3){\n                //The value is here\n                //get the last number\n                strncat(word,&amp;buf[i], 1);\n                leaderRec.value = atoi(word);\n                //printf(\"%d\\n\", value);\n            }\n\n            if(count == 1)\n                strncpy(leaderRec.what, word, strlen(word));\n            else if(count == 2)\n                strncpy(leaderRec.from, word, strlen(word));\n            free(word);\n            word = (char *) malloc(sizeof(char) * 50);\n            count++;\n        }\n        else {\n            //printf(\"%d\\n\",i );\n            //printf(\"%s\\n\", &amp;buf[i]);\n            strncat(word,&amp;buf[i], 1);\n        }\n        //printf(\"%s\", &amp;buf[i]);\n        //printf(\"%d -\", i);\n        i++;\n    } while(buf[i] != '\\0');\n\n    printf(\"%s\\n\", leaderRec.what);\n    printf(\"%s\\n\", leaderRec.from);\n    printf(\"%d\\n\", leaderRec.value);\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>leadervalue\nhost__vdso_get\n9569\n</code></pre>\n\n<p>Any better ways to do this?\nHow would I avoid the garbage output at the second print in the example output?</p>\n"}, {"tags": ["c", "execvp"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1519153228, "post_id": 48892389, "comment_id": 84790334, "body": "<code>char *commande;</code> is an uninitialized pointer. You can&#39;t use it in the <code>scanf</code> until you allocate some memory for it."}, {"owner": {"reputation": 163, "user_id": 6823899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff350e21c6ca08039a039aac7a3c2de2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6823899/phil"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1519153284, "post_id": 48892389, "comment_id": 84790359, "body": "but commande is the only one working, it&#39;s the other argv[] that doesn&#39;t seem to work"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1519153294, "post_id": 48892389, "comment_id": 84790363, "body": "the obvious question is - did you use your debugger to look at argv and make sure it has what you expect to be in it"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1519153376, "post_id": 48892389, "comment_id": 84790401, "body": "Using uninitialized pointer is <i>Undefined Behavior</i>. Anything can happen, including program seeming to work right. Debugging further is basically pointless, until you fix UB."}, {"owner": {"reputation": 163, "user_id": 6823899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff350e21c6ca08039a039aac7a3c2de2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6823899/phil"}, "edited": false, "score": 0, "creation_date": 1519153406, "post_id": 48892389, "comment_id": 84790419, "body": "it should be, i&#39;m passing it the same way i&#39;m doing with commande, otherwise how would I pass the values?"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1519153452, "post_id": 48892389, "comment_id": 84790440, "body": "what <code>wait(2)</code> does ?"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1519153517, "post_id": 48892389, "comment_id": 84790468, "body": "Another thing, always check return value of <i>scanf</i> family of functions. If there is parse error (or some other error), then the variables in parameters will be unset, and your program will do funny things, and debugging is kind of pointless. For learning/experimental/quick&amp;dirty code, you can just exit the program on parse error, for real programs you&#39;d have to do something more complex."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1519153332, "creation_date": 1519153332, "answer_id": 48892440, "question_id": 48892389, "link": "https://stackoverflow.com/questions/48892389/execvp-not-executing-args/48892440#48892440", "title": "Execvp not executing args", "body": "<p>You have <em>multiple</em> problems. Here are a couple of them:</p>\n\n<pre><code>argv[x] = malloc(100);\n...\nargv[x] = tempo;\n</code></pre>\n\n<p>First you make <code>argv[x]</code> point to some memory you allocate, then you make <code>argv[x]</code> point to where <code>tempo</code> is pointing, making you lose the original memory.</p>\n\n<p>And about <code>tempo</code>:</p>\n\n<pre><code>char *tempo;\n...\nscanf(\"%s\", tempo);\n</code></pre>\n\n<p>You have an uninitialized pointer. Where it is pointing is <em>indeterminate</em> and will seem almost random. Dereferencing this pointer, which happens when you call <code>scanf</code>, leads to <em>undefined behavior</em>.</p>\n\n<p>Both of these issue can be solved by passing <code>argv[x]</code> directly to your <code>scanf</code> call:</p>\n\n<pre><code>scanf(\"%99s\", argv[x]);  // No more than 99 characters (excluding terminator)\n</code></pre>\n\n<hr>\n\n<p>And you have the very same problem not once, but <em>twice</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 163, "user_id": 6823899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff350e21c6ca08039a039aac7a3c2de2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6823899/phil"}, "edited": false, "score": 0, "creation_date": 1519153859, "post_id": 48892509, "comment_id": 84790631, "body": "I&#39;ll try your code, but commande is the only one working actually, try my code with arguments set to 0, it&#39;s when I try to add arguments that it doesn&#39;t work"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 163, "user_id": 6823899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff350e21c6ca08039a039aac7a3c2de2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6823899/phil"}, "edited": false, "score": 0, "creation_date": 1519153992, "post_id": 48892509, "comment_id": 84790706, "body": "my last line points out that you need the same fix in that loop too. Basically after your first scanf everything else is moot. You are in UB land, you cannot reason about UB,"}, {"owner": {"reputation": 163, "user_id": 6823899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff350e21c6ca08039a039aac7a3c2de2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6823899/phil"}, "edited": false, "score": 0, "creation_date": 1519154078, "post_id": 48892509, "comment_id": 84790747, "body": "Yeah it works, I corrected both commande and the loop, but it&#39;s wierd that it was working for commande but not the args ... !"}, {"owner": {"reputation": 163, "user_id": 6823899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff350e21c6ca08039a039aac7a3c2de2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6823899/phil"}, "edited": false, "score": 0, "creation_date": 1519154141, "post_id": 48892509, "comment_id": 84790779, "body": "Thanks a lot ! I thought it could be array assignation problem, but since commande was working I thought it had to be something else"}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": true, "score": 1, "last_activity_date": 1519153626, "creation_date": 1519153626, "answer_id": 48892509, "question_id": 48892389, "link": "https://stackoverflow.com/questions/48892389/execvp-not-executing-args/48892509#48892509", "title": "Execvp not executing args", "body": "<p>this code</p>\n\n<pre><code>   argv[0] = malloc(100);\n    argv[0] = commande;\n</code></pre>\n\n<p>should set off alarm bells immediately. You assign something toe argv[0], then in the next line set it to something else. That cannot be correct</p>\n\n<p>you need</p>\n\n<pre><code>char commande[100]; // we will assume 100 is enough\nscanf(\"%s\", commande);\nargv[0] = strdup(commande); // strdup maybe not needed, buts lets be safe\n</code></pre>\n\n<p>and the same change inside your arg loop</p>\n"}], "owner": {"reputation": 163, "user_id": 6823899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff350e21c6ca08039a039aac7a3c2de2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6823899/phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 1, "accepted_answer_id": 48892509, "answer_count": 2, "score": 0, "last_activity_date": 1519153626, "creation_date": 1519153105, "question_id": 48892389, "link": "https://stackoverflow.com/questions/48892389/execvp-not-executing-args", "title": "Execvp not executing args", "body": "<p>I can't get execvp to execute the args, this code only works if I set the number of args to 0.  I've been trying to change lines here and there for 2 hours and checking other similar questions but nothing is working, maybe someone got an idea?  </p>\n\n<pre><code>void executeProgram()\n{\n    char *argv[20];\n    printf(\"Please enter command or program name:\");\n    char *commande;\n    scanf(\"%s\", commande);\n    argv[0] = malloc(100);\n    argv[0] = commande;\n    int nbArgZ = -1;\n    while(nbArgZ &lt; 0){\n            printf(\"Please enter number of arguments:\");\n            scanf(\"%d\", &amp;nbArgZ);\n    }\n    int x;\n    int y =1;\n    for(x = 1; x &lt; nbArgZ+1; x++){\n            char *tempo;\n            argv[x] = malloc(100);\n            printf(\"Argument %d : \", x);\n            scanf(\"%s\", tempo);\n            argv[x] = tempo;\n            y++;\n    }\n    argv[y] = NULL;\n    int pid = fork();\n    if ( pid == 0 ) {\n            execvp(argv[0], argv);\n    }\n    wait(2);\n    printf( \"End of execution\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 1, "creation_date": 1519151845, "post_id": 48892066, "comment_id": 84789602, "body": "Yes, that&#39;s <i>all</i> that&#39;s required. A function doesn&#39;t have to be non-trivial, or be useful, or even <i>work</i> to be recursive. It just has to call itself."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1519151891, "post_id": 48892066, "comment_id": 84789622, "body": "Yes, a function is recursive, when it calls itself."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519151900, "post_id": 48892066, "comment_id": 84789629, "body": "The problem you stated will not benefit from recursion. Printing array is a naturally linear problem. So this code is close enough to the ideal solution. But you can, for example, make a very slight change in it to print the array backwards. That&#39;s fun."}, {"owner": {"reputation": 16685, "user_id": 2289509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F51FU.jpg?s=128&g=1", "display_name": "Elazar", "link": "https://stackoverflow.com/users/2289509/elazar"}, "edited": false, "score": 0, "creation_date": 1519151953, "post_id": 48892066, "comment_id": 84789653, "body": "It does break the problem to a smaller one - the index is closer to the end each call."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 3, "creation_date": 1519151960, "post_id": 48892066, "comment_id": 84789658, "body": "Oooh, that static variable is ugly, though. Forget trying to call this function later on something else."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519152032, "post_id": 48892066, "comment_id": 84789708, "body": "Yeah.. you could utilize <code>n</code> in a better way..."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1519152075, "post_id": 48892066, "comment_id": 84789732, "body": "if you mean &#39;is this a good use of recursion?&#39; then the answer is no. This code is more obscure than its simple non recursive cousin. And it introduces potential bug with its static variable (which is there to disguise the recursion)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519152115, "post_id": 48892066, "comment_id": 84789752, "body": "The edit did not make it any better."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1519152121, "post_id": 48892066, "comment_id": 84789754, "body": "Instead of making your code simple - this recursion is a overhead."}, {"owner": {"reputation": 215, "user_id": 8144664, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/40826018fe61540f54c064f54988c8ca?s=128&d=identicon&r=PG&f=1", "display_name": "LoveOfLearning", "link": "https://stackoverflow.com/users/8144664/loveoflearning"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519152139, "post_id": 48892066, "comment_id": 84789765, "body": "@Eugene Sh. But got rid of the static int, didn&#39;t it?"}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1519152146, "post_id": 48892066, "comment_id": 84789770, "body": "@EugeneSh. Tail recursion is recursion.  In some style guides for some programming languages, tail recursion is the recommended way to visit all of the members of a list."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1519152198, "post_id": 48892066, "comment_id": 84789797, "body": "@Truth-seek , no it moved the static to a different scope, which is even worse"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1519152200, "post_id": 48892066, "comment_id": 84789798, "body": "@jameslarge In <i>functional</i> languages. Yes. Because they don&#39;t have loops :)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1519183638, "post_id": 48892066, "comment_id": 84800961, "body": "Note that the discussion here is all about direct recursion. You can also have indirectly recursive functions where function A calls function B and function B calls function A.  This is less common but perfectly permissible, and still recursive"}], "answers": [{"tags": [], "owner": {"reputation": 8660, "user_id": 5749570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2d0247d580de0aae4511d84551f10?s=128&d=identicon&r=PG&f=1", "display_name": "VHS", "link": "https://stackoverflow.com/users/5749570/vhs"}, "is_accepted": false, "score": 1, "last_activity_date": 1519152192, "creation_date": 1519152192, "answer_id": 48892183, "question_id": 48892066, "link": "https://stackoverflow.com/questions/48892066/is-a-function-recursive-if-it-calls-itself-trivially/48892183#48892183", "title": "Is a function recursive if it calls itself TRIVIALLY", "body": "<p>Regardless of the number of lines in a function, it is recursive if it calls itself.</p>\n\n<pre><code>void print(int A[], int n) {\n   if(n == 0) \n      printf(\"%d\", *A);\n   print(++A, --n);\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16685, "user_id": 2289509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F51FU.jpg?s=128&g=1", "display_name": "Elazar", "link": "https://stackoverflow.com/users/2289509/elazar"}, "is_accepted": true, "score": 2, "last_activity_date": 1519152709, "last_edit_date": 1519152709, "creation_date": 1519152260, "answer_id": 48892197, "question_id": 48892066, "link": "https://stackoverflow.com/questions/48892066/is-a-function-recursive-if-it-calls-itself-trivially/48892197#48892197", "title": "Is a function recursive if it calls itself TRIVIALLY", "body": "<p>Yes, this is a recursive function, since it calls itself.</p>\n\n<p>Additionally, the function does break the problem to smaller problems - in this case, precisely one smaller problem: printing the array starting from index <code>i+1</code> instead from index <code>i</code>. Since the bound is greater than <code>i</code>, the problem is smaller.</p>\n\n<p>In other words, the recursion is <em>well founded</em>: the value of <code>n-i</code> is decreasing at each call, and the edge case of <code>n-i==0</code> is handled trivially, not recursively.</p>\n"}, {"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 1, "last_activity_date": 1519152327, "creation_date": 1519152327, "answer_id": 48892217, "question_id": 48892066, "link": "https://stackoverflow.com/questions/48892066/is-a-function-recursive-if-it-calls-itself-trivially/48892217#48892217", "title": "Is a function recursive if it calls itself TRIVIALLY", "body": "<p>Instead of using <code>static</code> variable you can pass the <code>starting</code> element address and <code>last</code> elements address of the array and do the same task.</p>\n\n<pre><code>void print(int *A_start, int *A_end) {\n        if(A_start &lt; A_end) { /* call the function itself until A_start not reaches A_end */\n                printf(\"%d \", *A_start);\n                A_start++;\n                print(A_start,A_end);\n        }\n}\n\nint main() {\n        int A[3]={3, 5, 2};\n        int ele = sizeof(A)/sizeof(A[0]);\n        print(A,A+ele);\n        return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 4, "last_activity_date": 1519154940, "last_edit_date": 1519154940, "creation_date": 1519153578, "answer_id": 48892493, "question_id": 48892066, "link": "https://stackoverflow.com/questions/48892066/is-a-function-recursive-if-it-calls-itself-trivially/48892493#48892493", "title": "Is a function recursive if it calls itself TRIVIALLY", "body": "<blockquote>\n  <p>Can the function in this code be consider recursive?</p>\n</blockquote>\n\n<p>Yes, recursion occurs when the function can call itself, either directly <em>or</em> indirectly. </p>\n\n<blockquote>\n  <p>Is this a fine way to use recursion?</p>\n</blockquote>\n\n<p>No.  Although some compilers may optimize the code, code risks incurring <code>n</code> levels of recursion and causing <a href=\"https://stackoverflow.com/\">stack overflow</a></p>\n\n<p>A better alternative is to <em>halve</em> the problem.  This breaks the problem in 2 at each step.</p>\n\n<pre><code>void print(int A[], int n, int i) {\n  if (i&lt;n) {\n    A += i; n -= i;  // zero offset A and n\n\n    int mid = n/2;\n    print(A, mid, 0);              // print left side of A\n    printf(\"%d \", A[mid]);         // print middle of A\n    int right = n - mid - 1; \n    print(A + mid + 1, right, 0);  // print right side of A\n  }\n}\n</code></pre>\n\n<p>If <code>n</code> was 1000, the above could incur a recursion depth of log2(1000) or about 10 instead of 1000.  An unbounded <code>n</code> is a reason  recursion can be abused.  Insure that the recursion depth is not excessive.</p>\n\n<hr>\n\n<p>Notice that parameter <code>i</code> is not really needed.</p>\n\n<pre><code>void printA(int A[], size_t n) {\n  if (n &gt; 0) {\n    size_t mid = n/2;\n    printA(A, mid);              // print left side of A\n    printf(\"%d \", A[mid]);       // print middle of A\n    size_t right = n - mid - 1; \n    printA(A + mid + 1, right);  // print right side of A\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 215, "user_id": 8144664, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/40826018fe61540f54c064f54988c8ca?s=128&d=identicon&r=PG&f=1", "display_name": "LoveOfLearning", "link": "https://stackoverflow.com/users/8144664/loveoflearning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 1, "accepted_answer_id": 48892197, "answer_count": 4, "score": 2, "last_activity_date": 1519154940, "creation_date": 1519151741, "last_edit_date": 1519152439, "question_id": 48892066, "link": "https://stackoverflow.com/questions/48892066/is-a-function-recursive-if-it-calls-itself-trivially", "title": "Is a function recursive if it calls itself TRIVIALLY", "body": "<p>I was asked to write a recursive code to print an array. A friend showed me this code:</p>\n\n<pre><code>include &lt;stdio.h&gt;\nint i=0;\n\nvoid print(int A[], int n)\n{\n    if(i&lt;n)\n    {\n        printf(\"%d \", A[i]);\n        i++;\n        print(A, n);\n    }\n}\n\nint main()\n{\n    int A[3]={3, 5, 2};\n    print(A, 3);\n    return 0;\n}\n</code></pre>\n\n<p>Technically, it is recursive because the function calls itself, but I think <em>trivially</em> !! It does not break the problem into smaller problems or anything like that. So, it felt like <em>cheating</em>. Faking as if it is recursion.</p>\n\n<p>Can the function in this code be consider recursive? Is this a fine way to use recursion?</p>\n\n<p>What about in this form:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid print(int A[], int n, int i)\n{\n    if(i&lt;n)\n    {\n        printf(\"%d \", A[i]);\n        print(A, n, i+1);\n    }\n}\n\nint main()\n{\n    int A[3]={3, 5, 2}, i=0;\n    print(A, 3, i);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "text", "space", "word-count"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519151538, "post_id": 48892003, "comment_id": 84789398, "body": "I doubt that <code>chars[i] == EOF</code> at any point. Please post how you populated <code>chars</code>."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519151702, "post_id": 48892003, "comment_id": 84789512, "body": "<code>EOF</code> is not a valid character in a string, in fact you won&#39;t find it in a string. <code>EOF</code> is value that functions like <code>fgetc</code> return for indication of end-of-file."}, {"owner": {"reputation": 8660, "user_id": 5749570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2d0247d580de0aae4511d84551f10?s=128&d=identicon&r=PG&f=1", "display_name": "VHS", "link": "https://stackoverflow.com/users/5749570/vhs"}, "edited": false, "score": 0, "creation_date": 1519151737, "post_id": 48892003, "comment_id": 84789537, "body": "Do you have trailing spaces in those lines? If you do, you need to get rid of those."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519151748, "post_id": 48892003, "comment_id": 84789543, "body": "@Pablo, you used almost the same words I did in my answer."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519151769, "post_id": 48892003, "comment_id": 84789553, "body": "@IharobAlAsimi yes I noticed that."}, {"owner": {"reputation": 313, "user_id": 7246352, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/3efff3ef82f70be0f9f0ef8d1d08cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "Lukali", "link": "https://stackoverflow.com/users/7246352/lukali"}, "edited": false, "score": 0, "creation_date": 1519151935, "post_id": 48892003, "comment_id": 84789643, "body": "I have previously done char[i] != &#39;\\0&#39;, and it was the same outcome I believe I will switch it back to &#39;\\0&#39;."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519151974, "post_id": 48892003, "comment_id": 84789670, "body": "<code>char[i] != &#39;\\0&#39;</code> is correct, because <code>&#39;\\0&#39;</code> marks the end of the string."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519152019, "post_id": 48892003, "comment_id": 84789693, "body": "@Lukali Guessing will not solve the problem, it will only &quot;<i>appear to have solved it</i>&quot;, if you don&#39;t find the <b>REAL</b> reason for the unexpected outcome, it will happen again."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519152035, "post_id": 48892003, "comment_id": 84789712, "body": "@Pablo The thing is, <i>is <code>&#39;\\0&#39;</code> really present in the array?</i>. Something that is impossible to guess from the current question."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519152207, "post_id": 48892003, "comment_id": 84789800, "body": "@IharobAlAsimi yes, we don&#39;t know that, but that doesn&#39;t change the fact, that the correct way of checking for the end of the strings is by looking for the <code>&#39;\\0&#39;</code>-terminating byte, regardless of whether it is in the buffer or not. If it&#39;s not in the buffer, then the caller is using the function wrong."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519152665, "post_id": 48892003, "comment_id": 84790033, "body": "&quot; it doesn&#39;t count the words correctly.&quot; --&gt; post the definition of <code>chars</code> and a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 313, "user_id": 7246352, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/3efff3ef82f70be0f9f0ef8d1d08cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "Lukali", "link": "https://stackoverflow.com/users/7246352/lukali"}, "edited": false, "score": 0, "creation_date": 1519152686, "post_id": 48892003, "comment_id": 84790045, "body": "My chars are populated like this: chars[BUF_SIZE], where BUF_SIZE is 500 characters. So I count the chars  and then it puts the next batch of 500 from the file. So at the end of the file, some of the array will be empty if last batch is less than 500."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1519152811, "post_id": 48892003, "comment_id": 84790117, "body": "@Lukali Rather than describe the code, better and clearer to post it -in the question.  Sample input is useful too."}, {"owner": {"reputation": 313, "user_id": 7246352, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/3efff3ef82f70be0f9f0ef8d1d08cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "Lukali", "link": "https://stackoverflow.com/users/7246352/lukali"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519304345, "post_id": 48892003, "comment_id": 84862175, "body": "@chux I have included the code now, thank you for your help."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519305908, "post_id": 48892003, "comment_id": 84863417, "body": "@Lukali, The <code>&#39;\\0&#39;</code> will not be in the file either. Instead try <code>i &lt; readSize</code>."}, {"owner": {"reputation": 313, "user_id": 7246352, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/3efff3ef82f70be0f9f0ef8d1d08cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "Lukali", "link": "https://stackoverflow.com/users/7246352/lukali"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519313453, "post_id": 48892003, "comment_id": 84869094, "body": "@IharobAlAsimi Thanks for that suggestion I have tried that and it did give me a more accurate count. I have one more issue though, the last word in my file is not counted because there is no space after it in the file. there is nothing after that word, so how would I determine if its a word in such case? I tried to use buf[i] == NULL as an alternative case, but it only makes sense for it not to work. I could just add one to word count automatically, but some files might have that extra space. I thought maybe at the end there&#39;s /n, but then there is /n after some &#39; &#39; too..."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519314192, "post_id": 48892003, "comment_id": 84869580, "body": "You should check that <code>readSize &gt; 0</code> which means that there is at least one word, so you initialize the counter to one, then count the spaces. Note that after counting the first word, if there is a space then there are two words, so after counting the first word, counting spaces is effectively the same as counting words. Please note that things like <code>&#39;\\0&#39;</code> or <code>NULL</code> are set by programmers, and they are not stored in files, nor automatically set by the compiler. When you write <code>char buffer[10]</code>; all 10 values of buffer are &quot;<i>uninitialized</i>&quot;!!!"}, {"owner": {"reputation": 313, "user_id": 7246352, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/3efff3ef82f70be0f9f0ef8d1d08cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "Lukali", "link": "https://stackoverflow.com/users/7246352/lukali"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519314909, "post_id": 48892003, "comment_id": 84870158, "body": "@IharobAlAsimi If there is one word, then I can add one to the word count, but then it would be incorrect for any file which has a word and then a space after it before it ends? It looks like I am just going to have to make a random choice here..."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519315122, "post_id": 48892003, "comment_id": 84870343, "body": "You should remove superflous spaces too, just think about it and it makes sense. A space not followed by a non-space should not be counted. For example, a space followed by another space, should be ignored. When I said counting spaces I meant counting them correctly."}, {"owner": {"reputation": 313, "user_id": 7246352, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/3efff3ef82f70be0f9f0ef8d1d08cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "Lukali", "link": "https://stackoverflow.com/users/7246352/lukali"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519315685, "post_id": 48892003, "comment_id": 84870812, "body": "@IharobAlAsimi okay but if I put &#39;if (chars[i] == &#39; &#39; &amp;&amp; buf[i+1] != &#39; &#39;)&#39;, it does indeed count correctly if there is a double gap, but when I changed the file so that there is a space after the last word, or more like the dot after that sentence, my word count was one up even though it should be one less. It would indeed count correctly now if there is nothing after the last dot, but not if there is one space. EDIT: assuming i added one if file wasn&#39;t empty."}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 7246352, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/3efff3ef82f70be0f9f0ef8d1d08cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "Lukali", "link": "https://stackoverflow.com/users/7246352/lukali"}, "edited": false, "score": 0, "creation_date": 1519152063, "post_id": 48892050, "comment_id": 84789722, "body": "what if I had char[i] != &#39;\\0&#39; ? Its just that I have been given the array of those chars already, so I&#39;d like to use that array instead of reading the file to get the chars. I&#39;ve just checked and I get the same character count when I use &#39;\\0&#39;."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 313, "user_id": 7246352, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/3efff3ef82f70be0f9f0ef8d1d08cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "Lukali", "link": "https://stackoverflow.com/users/7246352/lukali"}, "edited": false, "score": 0, "creation_date": 1519153791, "post_id": 48892050, "comment_id": 84790589, "body": "@Lukali If you don&#39;t show your code, it&#39;s impossible to further help you."}, {"owner": {"reputation": 313, "user_id": 7246352, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/3efff3ef82f70be0f9f0ef8d1d08cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "Lukali", "link": "https://stackoverflow.com/users/7246352/lukali"}, "edited": false, "score": 0, "creation_date": 1519304311, "post_id": 48892050, "comment_id": 84862152, "body": "I&#39;ve included it now if you&#39;ve got time to take a look maybe, thank you."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 4, "last_activity_date": 1519151675, "creation_date": 1519151675, "answer_id": 48892050, "question_id": 48892003, "link": "https://stackoverflow.com/questions/48892003/why-is-my-character-count-incorrect/48892050#48892050", "title": "Why is my character count incorrect?", "body": "<p>I am writing this answer because I think, I know what your confusion is. But note that you did not explain how you read the file, I'll give an example and explain why we test <code>!= EOF</code>, which is not a character that you read from a file.</p>\n\n<p>It appears that you think <code>EOF</code> is a character that is stored in the file, well it's not. If you just want to count words you can do something like</p>\n\n<pre><code>int chr;\nwhile ((chr = fgetc(file)) != EOF)\n    count += (chr == ' ') ? 1 : 0;\n</code></pre>\n\n<p>note that <code>chr</code> MUST be of type <code>int</code> because <code>EOF</code> is of type <code>int</code>, but it's certainly not present in the file! It's returned by functions like <code>fgetc()</code> to indicate that there is nothing more to read, note that an attempt to read must be made in order for it to return it.</p>\n\n<p>Oops, also note that my sample code will not count the last word. But that's for you to figure out. </p>\n\n<p>Also, this would count multiple spaces as \"<em>words</em>\" something that you should also workout.</p>\n"}], "owner": {"reputation": 313, "user_id": 7246352, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/3efff3ef82f70be0f9f0ef8d1d08cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "Lukali", "link": "https://stackoverflow.com/users/7246352/lukali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 2, "accepted_answer_id": 48892050, "answer_count": 1, "score": 4, "last_activity_date": 1533139746, "creation_date": 1519151469, "last_edit_date": 1533139746, "question_id": 48892003, "link": "https://stackoverflow.com/questions/48892003/why-is-my-character-count-incorrect", "title": "Why is my character count incorrect?", "body": "<p>The following code gets the number of words:</p>\n\n<pre><code>int count = 0;\nfor (int i = 0; chars[i] != EOF; i++)\n{\n    if (chars[i] == ' ')\n    {\n         count++;\n    }\n}\n</code></pre>\n\n<p>My problem is, that it doesn't count the words correctly. </p>\n\n<p>For example, if my <code>file.txt</code> has the following text in it:</p>\n\n<pre>\nspaced-out there's I'd like\n</pre>\n\n<p>It says I have <code>6 words</code>, when according to <em>MS Word</em> I'd have <code>4</code>. </p>\n\n<pre>\nspaced-out and in\n</pre>\n\n<p>Gives me a word count of <code>4</code>.</p>\n\n<pre>\nspaced out and in\n</pre>\n\n<p>Gives me a word count of <code>6</code></p>\n\n<p>I'm sorry if this question has been answered before, Google doesn't take into account the special characters in the search, so it is hard to find the answer to coding. I'd preferably have the words just by identifying if it's a space or not.</p>\n\n<p>I tried looking for answers but no one seemed to have the same problem exactly. I know that the <code>.txt</code> files might end in <code>/r/n</code> in Windows, but then that should be part of one word. For example:</p>\n\n<pre>\nspaced out and in/r/n\n</pre>\n\n<p>I believe it should still give me <code>4</code> words. Also when I add <code>|| chars[i] == '\\n'</code> as:</p>\n\n<pre><code>for (int i = 0; chars[i] != EOF || chars[i] == '\\n'; i++)\n</code></pre>\n\n<p>I get even more words, <code>8</code> for the line </p>\n\n<pre>\nspaced out and in\n</pre>\n\n<p>I am doing this on a Linux-based server, but on an SSH client on Windows. The characters come from a <code>.txt</code> file.</p>\n\n<hr>\n\n<p>Edit: Okay, here is the code, I avoided the <code>#include</code> when posting it.</p>\n\n<pre><code>#define BUF_SIZE 500            \n#define OUTPUT_MODE 0700        \n\nint main(int argc, char *argv[])\n{\n    int input, output;\n    int readSize = 1, writeSize;            \n    char chars[BUF_SIZE];   \n    int count = 0;\n\n    input = open(argv[1], O_RDONLY);                \n\n    output = creat(argv[2], OUTPUT_MODE);   \n\n    while (readSize &gt; 0)                \n    {\n        readSize = read(input, chars, BUF_SIZE); \n        if (readSize &lt; 0)       \n        exit(4);\n\n        for (int i = 0; chars[i] != '\\0'; i++)\n        {\n            if (chars[i] == ' ')\n            {\n                count++;\n            }\n        }\n\n        writeSize = write(output, chars, readSize);     \n        if (writeSize &lt;= 0)             \n        {\n            close(input);       \n            close(output);\n            printf(\"%d words\\n\", count);\n            exit(5);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "visual-studio-2017"], "comments": [{"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "edited": false, "score": 3, "creation_date": 1519151490, "post_id": 48891977, "comment_id": 84789377, "body": "Looks like you are trying to execute the DLL.  You need an .EXE that calls the DLL...it won&#39;t execute by itself.  You probably should have a DLL project with the .c and .h file, and an .exe project with the .cpp file.  You also don&#39;t need the extra <code>extern &quot;C&quot;</code> in the .cpp file.  The header file contains the appropriate wrapper."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519152112, "post_id": 48891977, "comment_id": 84789749, "body": "You also are writing C code but compiling it as C++. Don&#39;t do that. Write either C++ code of rename the <code>.cpp</code> file into a <code>.c</code> file."}, {"owner": {"reputation": 5, "user_id": 3999184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5544f430222eab0fb025b6401487c8d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Krishna", "link": "https://stackoverflow.com/users/3999184/sai-krishna"}, "reply_to_user": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "edited": false, "score": 0, "creation_date": 1519159114, "post_id": 48891977, "comment_id": 84793280, "body": "@MarkTolonen yeah earlier i have tried the same(a DLL project with the .c and .h file, and an .exe project with the .cpp file), but the problem in my case is: I have a third party application which compiles my cpp file in to a dll file with help of visual studio.(a dll file is generated in the background and used for further process, a batch is scripted fr compilation). So it works fine in earlier case(where i provide the linker settings) but in the second case I don&#39;t know where to provide the linker settings so on running the application it gives me linking error."}], "owner": {"reputation": 5, "user_id": 3999184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5544f430222eab0fb025b6401487c8d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Krishna", "link": "https://stackoverflow.com/users/3999184/sai-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 326, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519151361, "creation_date": 1519151361, "question_id": 48891977, "link": "https://stackoverflow.com/questions/48891977/trying-to-create-a-dll-file-from-both-c-and-cpp-files-in-visual-studio-2017", "title": "trying to create a dll file from both c and cpp files in visual studio 2017", "body": "<p>I am trying to create a .dll file which uses both c and c++ functions in visual studio. \nI have tried this so far,<br>\n<strong>create new project visual c++ -->windows Desktop wizard --> application type(.dll) and empty project.</strong><br>\nand included the following files </p>\n\n<p>cfunctions.h file</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#if defined (WIN32)\n#if defined(FUNCTIONS_STATIC)\n#define FUNCTIONS_API\n#else\n#if defined(FUNCTIONS_EXPORTS)\n#define FUNCTIONS_API __declspec(dllexport)\n#else\n#define FUNCTIONS_API __declspec(dllimport)\n#endif\n#endif\n#else\n#define FUNCTIONS_API\n#endif\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nFUNCTIONS_API double PowerOf2(double UserNumber);\nFUNCTIONS_API double PowerOf3(double UserNumber);\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>cfunctions.c file </p>\n\n<pre><code>#define FUNCTIONS_EXPORTS\n#include \"cfunctions.h\"\n\ndouble PowerOf2(double UserNumber)\n{\n    return UserNumber * UserNumber;\n}\n\ndouble PowerOf3(double UserNumber)\n{\n    return UserNumber * UserNumber * UserNumber;\n}\n</code></pre>\n\n<p>.cpp file </p>\n\n<pre><code>   #include &lt;stdio.h&gt;\n    extern \"C\"\n    {\n       #include \"cfunctions.h\"\n    }\n    int main()\n    {\n\n        double p2 = 10.0;\n        double p3 = 5.0;\n        printf(\"The number %.2f to the power of 2 is %.2f. \\n\", p2, PowerOf2(p2));\n        printf(\"The number %.2f to the power of 3 is %.2f. \\n\", p3, PowerOf3(p3));\n        getchar();\n        return 0;\n    }\n</code></pre>\n\n<p>when i try to run the project it throws an error </p>\n\n<p><strong>unable to start program ..\\xxx\\project_name.dll<br>\nxxxx\\project_name.dll is not a valid win 32  application</strong></p>\n"}]